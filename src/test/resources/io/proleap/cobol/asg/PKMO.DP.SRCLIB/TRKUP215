000010******************************************************************00001000
000020 IDENTIFICATION DIVISION.                                         00002000
000030******************************************************************00003000
000040                                                                  00004000
000050 PROGRAM-ID.   TRKUP215.                                          00005000
000060 AUTHOR.       MARGARET MORRISON.                                 00006000
000070 INSTALLATION. KOHLS DEPARTMENT STORES.                           00007000
000080 DATE-WRITTEN. JULY, 1999.                                        00008000
000090 DATE-COMPILED.                                                   00009000
000100                                                                  00010000
000110******************************************************************00011000
000120*  THIS PROGRAM UPDATES THE CONTAINER MANIFEST TABLES AND CREATES*00012000
000130*  1.)  DETAIL EXTRACT WORK TABLE                                *00013000
000140*  2.)  ERROR REPORT EXTRACT WORK TABLE                          *00014000
000150*  3.)  CONTAINER RULES EXTRACT WORK TABLE                       *00015000
000160*  CHECKPOINT RESTART LOGIC IS ALSO USED.                        *00016000
000170******************************************************************00017000
000180* A CHANGE HAS BEEN MADE TO USE THE FOLLOWING FIELDS FROM THE     00018000
000190* VARIOUS INPUT RECORD TYPES TO RETRIGGER DC SPLITS:              00019000
000200*  CONTAINER LEVEL: TRIP ID  (VOYAGE)                             00020000
000210*                   POE DELIVERY TMST (ETA)                       00021000
000220*                   CARR SCAC CD                                  00022000
000230*                   IMPORT VEHICLE NAME (VESSEL)                  00023000
000240*                   TRIP TYPE CD (AIR/OCEAN)                      00024000
000250*                   DEST POE CD                                   00025000
000260*                   SIZE CD      (CONTAINER SIZE)                 00026000
000270*  PO LEVEL:        CARTON CNT                                    00027000
000280*                   UNIT QTY                                      00028000
000290*  UPC LEVEL:       UPC CARTON CNT                                00029000
000300*                   UPC CBMT QTY                                  00030000
000310*                   UPC WT KGRM QTY                               00031000
000320*                   UPC UNIT QTY                                  00032000
000330*                   ASN PACKAGING CD (BULK/PEPACK)                00033000
000340* THE FIELDS AT THE CONTAINER LEVEL ARE NEW AND WERE NOT USED     00034000
000350* BEFORE, THE FIELDS AT THE PO AND UPC LEVEL WERE ALREADY BEING   00035000
000360* USED WITH OTHER NOT LISTED FIELDS THAT ARE NO LONGER BEING USED.00036000
000370* NO CHANGES WERE MADE TO DC SPLIT LOGIC FOR ANY OTHER LEVELS.    00037000
000380******************************************************************00038011
000390* CHANGED   NAME/TK           WR/PRB    DESCRIPTION               00039012
000400* ----------------------------------------------------------------00040012
000410* 01/23/14  SUBASH T/TKMAPP5  PRB43475  CHANGES MADE TO PREVENT   00041012
000420*           (COGNIZANT)       INVALID PACKAGING CODE BEING MOVED  00042012
000430*                             TO IMCNUP-ASN-PKGNG-CDE TO AVOID    00043012
000440*                             TRK212 FAILURE WITH SQL CODE # -545.00044012
000450*                                                                 00045012
000460*                             PRB44626  CHANGES MADE TO COMPARE   00046012
000470*                             THE OUTER PACK QUANTITY COMING IN   00047012
000480*                             INPUT ASN FILE WITH THE OUTER PACK  00048012
000490*                             QUANTITY PRESENT IN TPURITM TABLE   00049012
000500*                             (INSTEAD OF TUPC TABLE).            00050012
000510*                                       ADDED 'WITH UR' IN ALL    00051012
000520*                             THE SELECT QUERIES USED IN THE      00052012
000530*                             PROGRAM.                            00053012
000540******************************************************************00054000
000550 ENVIRONMENT DIVISION.                                            00055000
000560******************************************************************00056000
000570                                                                  00057000
000580 CONFIGURATION SECTION.                                           00058000
000590                                                                  00059000
000600 SOURCE-COMPUTER.        IBM-3090.                                00060000
000610 OBJECT-COMPUTER.        IBM-3090.                                00061000
000620                                                                  00062000
000630 INPUT-OUTPUT SECTION.                                            00063000
000640                                                                  00064000
000650 FILE-CONTROL.                                                    00065000
000660                                                                  00066000
000670     SELECT TR023-CONTAINER-FILE                                  00067000
000680         ASSIGN TO INP01.                                         00068000
000690                                                                  00069000
000700     SELECT CONTROL-CARD-1                                        00070000
000710         ASSIGN TO INP02.                                         00071000
000720******************************************************************00072000
000730 DATA DIVISION.                                                   00073000
000740******************************************************************00074000
000750                                                                  00075000
000760 FILE SECTION.                                                    00076000
000770                                                                  00077000
000780 FD  TR023-CONTAINER-FILE                                         00078000
000790     RECORDING MODE IS F                                          00079000
000800     LABEL RECORDS ARE STANDARD                                   00080000
000810     BLOCK CONTAINS 0 RECORDS.                                    00081000
000820                                                                  00082000
000830*01  TR023-CONTAINER-RECORD          PIC X(355).                  00083000
000840 01  TR023-CONTAINER-RECORD          PIC X(400).                  00084000
000850                                                                  00085000
000860 FD  CONTROL-CARD-1                                               00086000
000870     RECORDING MODE F                                             00087000
000880     BLOCK CONTAINS 0 RECORDS                                     00088000
000890     LABEL RECORDS ARE OMITTED.                                   00089000
000900 01  CONTROL-CARD-REC                 PIC  X(80).                 00090000
000910                                                                  00091000
000920******************************************************************00092000
000930 WORKING-STORAGE SECTION.                                         00093000
000940******************************************************************00094000
000950                                                                  00095000
000960******************************************************************00096000
000970*  DB2 FORMATTED MESSAGE AREA                                     00097000
000980******************************************************************00098000
000990     COPY DPWS004.                                                00099000
001000                                                                  00100000
001010******************************************************************00101000
001020*  COMMUNICATIONS AREA FOR DB2                                    00102000
001030******************************************************************00103000
001040     EXEC SQL                                                     00104000
001050          INCLUDE SQLCA                                           00105000
001060     END-EXEC.                                                    00106000
001070                                                                  00107000
001080******************************************************************00108000
001090*  DB2 TABLE DECLARATION - IMPORT CONTAINER TABLE.                00109000
001100*      (TIMCNTK)                                                  00110000
001110******************************************************************00111000
001120     EXEC SQL                                                     00112000
001130          INCLUDE TIMCNTK                                         00113000
001140     END-EXEC.                                                    00114000
001150                                                                  00115000
001160******************************************************************00116000
001170*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO TABLE.             00117000
001180*      (TIMCNPO)                                                  00118000
001190******************************************************************00119000
001200     EXEC SQL                                                     00120000
001210          INCLUDE TIMCNPO                                         00121000
001220     END-EXEC.                                                    00122000
001230                                                                  00123000
001240******************************************************************00124000
001250*  DB2 TABLE DECLARATION - IMPORT CONTAINER UPC TABLE.            00125000
001260*      (TIMCNUP)                                                  00126000
001270******************************************************************00127000
001280     EXEC SQL                                                     00128000
001290          INCLUDE TIMCNUP                                         00129000
001300     END-EXEC.                                                    00130000
001310                                                                  00131000
001320******************************************************************00132000
001330*  DB2 TABLE DECLARATION - IMPORT CONTAINER CARTON TABLE.         00133000
001340*      (TRT_IMPRT_CART)                                           00134000
001350******************************************************************00135000
001360     EXEC SQL                                                     00136000
001370          INCLUDE TRT00008                                        00137000
001380     END-EXEC.                                                    00138000
001390                                                                  00139000
001400******************************************************************00140000
001410*  DB2 TABLE DECLARATION - IMPORT CONTAINER SEAL TABLE.           00141000
001420*      (TRT_IMPRT_SEAL)                                           00142000
001430******************************************************************00143000
001440     EXEC SQL                                                     00144000
001450          INCLUDE TRT00006                                        00145000
001460     END-EXEC.                                                    00146000
001470                                                                  00147000
001480******************************************************************00148000
001490*  DB2 TABLE DECLARATION - IMPORT CONTAINER AUDIT TABLE.          00149000
001500*      (TAUCNTK)                                                  00150000
001510******************************************************************00151000
001520     EXEC SQL                                                     00152000
001530          INCLUDE TAUCNTK                                         00153000
001540     END-EXEC.                                                    00154000
001550                                                                  00155000
001560******************************************************************00156000
001570*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO AUDIT TABLE.       00157000
001580*      (TAUCNPO)                                                  00158000
001590******************************************************************00159000
001600     EXEC SQL                                                     00160000
001610          INCLUDE TAUCNPO                                         00161000
001620     END-EXEC.                                                    00162000
001630                                                                  00163000
001640******************************************************************00164000
001650*  DB2 TABLE DECLARATION - IMPORT CONTAINER UPC AUDIT TABLE.      00165000
001660*      (TAUCNUP)                                                  00166000
001670******************************************************************00167000
001680     EXEC SQL                                                     00168000
001690          INCLUDE TAUCNUP                                         00169000
001700     END-EXEC.                                                    00170000
001710                                                                  00171000
001720******************************************************************00172000
001730*  DB2 TABLE DECLARATION - IMPORT CONTAINER SEAL AUDIT TABLE.     00173000
001740*      (TRT_AUD_IMPRT_SEAL)                                       00174000
001750******************************************************************00175000
001760     EXEC SQL                                                     00176000
001770          INCLUDE TRT00007                                        00177000
001780     END-EXEC.                                                    00178000
001790                                                                  00179000
001800******************************************************************00180000
001810*  DB2 TABLE DECLARATION - IMPORT CONTAINER CARTON AUDIT TABLE.   00181000
001820*      (TRT_AUD_IMPRT_CART)                                       00182000
001830******************************************************************00183000
001840     EXEC SQL                                                     00184000
001850          INCLUDE TRT00009                                        00185000
001860     END-EXEC.                                                    00186000
001870                                                                  00187000
001880******************************************************************00188000
001890*  DB2 TABLE DECLARATION - IMPORT ORIGIN CODE TABLE.              00189000
001900*      (TRT_IMPRT_ORGN)                                           00190000
001910******************************************************************00191000
001920     EXEC SQL                                                     00192000
001930          INCLUDE TRT00010                                        00193000
001940     END-EXEC.                                                    00194000
001950                                                                  00195000
001960******************************************************************00196000
001970*  DB2 TABLE DECLARATION - IMPORT AUDIT ORIGIN CODE TABLE.        00197000
001980*      (TRT_AUD_IMPRT_ORGN)                                       00198000
001990******************************************************************00199000
002000     EXEC SQL                                                     00200000
002010          INCLUDE TRT00011                                        00201000
002020     END-EXEC.                                                    00202000
002030                                                                  00203000
002040******************************************************************00204000
002050*  DB2 TABLE DECLARATION - PURCHASE ORDER TABLE.                  00205000
002060*      (TPURCHS)                                                  00206000
002070******************************************************************00207000
002080     EXEC SQL                                                     00208000
002090          INCLUDE TPURCHS                                         00209000
002100     END-EXEC.                                                    00210000
002110                                                                  00211000
002120******************************************************************00212000
002130*  DB2 TABLE DECLARATION - CUSTOMS PURCHASE ORDER TABLE           00213000
002140*      (TIMCSPO)                                                  00214000
002150******************************************************************00215000
002160     EXEC SQL                                                     00216000
002170          INCLUDE TIMCSPO                                         00217000
002180     END-EXEC.                                                    00218000
002190                                                                  00219000
002200******************************************************************00220000
002210*  DB2 TABLE DECLARATION - CUSTOMS CONTAINER TABLE                00221000
002220*      (TIMCSCN)                                                  00222000
002230******************************************************************00223000
002240     EXEC SQL                                                     00224000
002250          INCLUDE TIMCSCN                                         00225000
002260     END-EXEC.                                                    00226000
002270                                                                  00227000
002280******************************************************************00228000
002290*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO RELEASE TABLE      00229000
002300*      (TIMCNRL)                                                  00230000
002310******************************************************************00231000
002320     EXEC SQL                                                     00232000
002330          INCLUDE TIMCNRL                                         00233000
002340     END-EXEC.                                                    00234000
002350                                                                  00235000
002360******************************************************************00236000
002370*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO RELEASE AUDIT TABLE00237000
002380*      (TAUCNRL)                                                  00238000
002390******************************************************************00239000
002400     EXEC SQL                                                     00240000
002410          INCLUDE TAUCNRL                                         00241000
002420     END-EXEC.                                                    00242000
002430                                                                  00243000
002440******************************************************************00244000
002450*  DB2 TABLE DECLARATION - SKXREF TABLE.                          00245000
002460*      (TSKXREF)                                                  00246000
002470******************************************************************00247000
002480     EXEC SQL                                                     00248000
002490          INCLUDE TSKXREF                                         00249000
002500     END-EXEC.                                                    00250000
002510                                                                  00251000
002520******************************************************************00252000
002530*  DB2 TABLE DECLARATION - UPC SKU TABLE.                         00253000
002540*      (TUPCSKU)                                                  00254000
002550******************************************************************00255000
002560     EXEC SQL                                                     00256000
002570          INCLUDE TUPCSKU                                         00257000
002580     END-EXEC.                                                    00258000
002590                                                                  00259000
002600******************************************************************00260000
002610*  DB2 TABLE DECLARATION - UPC TABLE.                             00261000
002620*      (TUPC)                                                     00262000
002630******************************************************************00263000
002640     EXEC SQL                                                     00264000
002650          INCLUDE TUPC                                            00265000
002660     END-EXEC.                                                    00266000
002670                                                                  00267000
002680******************************************************************00268000
002690*  DB2 TABLE DECLARATION - PURCHASE ORDER ITEM TABLE.             00269000
002700*      (TPURITM)                                                  00270000
002710******************************************************************00271000
002720     EXEC SQL                                                     00272000
002730          INCLUDE TPURITM                                         00273000
002740     END-EXEC.                                                    00274000
002750                                                                  00275000
002760******************************************************************00276000
002770*  DB2 TABLE DECLARATION - PURCHASE ORDER PREPACK TABLE.          00277000
002780*      (TPOPRPK)                                                  00278000
002790******************************************************************00279000
002800     EXEC SQL                                                     00280000
002810          INCLUDE TPOPRPK                                         00281000
002820     END-EXEC.                                                    00282000
002830                                                                  00283000
002840******************************************************************00284000
002850*  DB2 TABLE DECLARATION -  IMPORT FOB TABLE.                     00285000
002860*      (TIMFOB)                                                   00286000
002870******************************************************************00287000
002880     EXEC SQL                                                     00288000
002890          INCLUDE TIMFOB                                          00289000
002900     END-EXEC.                                                    00290000
002910                                                                  00291000
002920******************************************************************00292000
002930*  DB2 TABLE DECLARATION -  IMPORT POE TABLE.                     00293000
002940*      (TIMPOE)                                                   00294000
002950******************************************************************00295000
002960     EXEC SQL                                                     00296000
002970          INCLUDE TIMPOE                                          00297000
002980     END-EXEC.                                                    00298000
002990                                                                  00299000
003000******************************************************************00300000
003010*  DB2 TABLE DECLARATION -  COUNTRY TABLE.                        00301000
003020*      (TCNTRY)                                                   00302000
003030******************************************************************00303000
003040     EXEC SQL                                                     00304000
003050          INCLUDE TCNTRY                                          00305000
003060     END-EXEC.                                                    00306000
003070                                                                  00307000
003080******************************************************************00308000
003090*  DB2 TABLE DECLARATION - DETAIL/ERROR REPORT EXTRACT WORK TABLE 00309000
003100*      (TOUTTR5)                                                  00310000
003110******************************************************************00311000
003120     EXEC SQL                                                     00312000
003130          INCLUDE TOUTTR5                                         00313000
003140     END-EXEC.                                                    00314000
003150                                                                  00315000
003160******************************************************************00316000
003170*  DB2 TABLE DECLARATION - TROUBLE NOTIFICATION WORK TABLE        00317000
003180*      (TOUTTM1)                                                  00318000
003190******************************************************************00319000
003200     EXEC SQL                                                     00320000
003210          INCLUDE TOUTTM1                                         00321000
003220     END-EXEC.                                                    00322000
003230                                                                  00323000
003240******************************************************************00324000
003250*  DB2 TABLE DECLARATION - IMPORT RULES WORK TABLE                00325000
003260*      (TRTW_CONTNR_RUL)                                          00326000
003270******************************************************************00327000
003280     EXEC SQL                                                     00328000
003290          INCLUDE TRT00033                                        00329000
003300     END-EXEC.                                                    00330000
003310                                                                  00331000
003320******************************************************************00332000
003330*  DB2 TABLE DECLARATION - SCM MQ SERIES MSG WORK TABLE           00333000
003340*      (TRTW_CONTNR_CKPR)                                         00334000
003350******************************************************************00335000
003360     EXEC SQL                                                     00336000
003370          INCLUDE TRT00039                                        00337000
003380     END-EXEC.                                                    00338000
003390                                                                  00339000
003400******************************************************************00340000
003410*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)00341000
003420*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT     00342000
003430*  INTERVALS.                                                     00343000
003440******************************************************************00344000
003450     EXEC SQL                                                     00345000
003460         INCLUDE TCKRSTCN                                         00346000
003470     END-EXEC.                                                    00347000
003480                                                                  00348000
003490******************************************************************00349000
003500*  DB2 TABLE DECLARATION - CHECKPOINT RESTART         (TCKRSTINF) 00350000
003510*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT     00351000
003520*  INTERVALS.                                                     00352000
003530******************************************************************00353000
003540     EXEC SQL                                                     00354000
003550         INCLUDE TCKRSTIN                                         00355000
003560     END-EXEC.                                                    00356000
003570                                                                  00357000
003580******************************************************************00358000
003590*    EDITED CONTAINER MANIFEST DATA LAYOUT                        00359000
003600******************************************************************00360000
003610     COPY TRRD023.                                                00361000
003620 EJECT                                                            00362000
003630                                                                  00363000
003640******************************************************************00364000
003650*    CONTAINER RULES FILE LAYOUT                                  00365000
003660******************************************************************00366000
003670     COPY TRRD265.                                                00367000
003680 EJECT                                                            00368000
003690                                                                  00369000
003700******************************************************************00370000
003710*    ARRIVAL RECYCLE RECORD LAYOUT                                00371000
003720******************************************************************00372000
003730     COPY TRRD016.                                                00373000
003740 EJECT                                                            00374000
003750                                                                  00375000
003760******************************************************************00376000
003770*    DELIVERY REYCLE RECORD LAYOUT                                00377000
003780******************************************************************00378000
003790     COPY TRRD018.                                                00379000
003800 EJECT                                                            00380000
003810                                                                  00381000
003820******************************************************************00382000
003830*  CONTAINER REPORT RECORD LAYOUT - EXTRACT FOR THE DETAIL AND   *00383000
003840*  ERROR REPORTS.  IT IS USED TO FORMAT THE DETAIL AND ERROR     *00384000
003850*  RECORDS.  THEY ARE THEN INSERTED TO TOUTTR5, A DB2 WORK TABLE.*00385000
003860*  LATER IT IS USED IN OTHER PROGRAMS TO CREATE A DETAIL REPORT  *00386000
003870*  AND AN ERROR REPORT OF CONTAINER RECORDS.                     *00387000
003880******************************************************************00388000
003890     COPY TRRD211.                                                00389000
003900 EJECT                                                            00390000
003910                                                                  00391000
003920******************************************************************00392000
003930*    SUPPLY CHAIN MANAGEMENT MQ MESSAGE RECORD                    00393000
003940******************************************************************00394000
003950     COPY TRRD405.                                                00395000
003960 EJECT                                                            00396000
003970                                                                  00397000
003980******************************************************************00398000
003990*  COPYBOOK FOR TOUTTM1 WORK TABLE - TROUBLE NOTIFICATION EXTRACT*00399000
004000******************************************************************00400000
004010     COPY TMRD606.                                                00401000
004020 EJECT                                                            00402000
004030                                                                  00403000
004040     COPY DPWS500.                                                00404000
004050 EJECT                                                            00405000
004060                                                                  00406000
004070 01  CC-CONTROL-CARD-1.                                           00407000
004080     05  CC-JOB-NAME                  PIC X(08).                  00408000
004090     05  FILLER                       PIC X(72).                  00409000
004100                                                                  00410000
004110 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00411000
004120                                                   COMP SYNC.     00412000
004130 01  PA-PROGRAM-ACCUMULATORS.                                     00413000
004140     05  PA-TOTALS.                                               00414000
004150         10 PA-TOTAL-COMMITS          PIC  S9(13)  VALUE +0       00415000
004160                                                     COMP-3.      00416000
004170         10 PA-TOTAL-REPORT-COUNT     PIC  S9(13)  VALUE +0       00417000
004180                                                     COMP-3.      00418000
004190         10 PA-TOTAL-RULE-COUNT       PIC  S9(13)  VALUE +0       00419000
004200                                                     COMP-3.      00420000
004210         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0       00421000
004220                                                     COMP-3.      00422000
004230         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0       00423000
004240                                                     COMP-3.      00424000
004250         10 PA-TOT-RECS-INSERTED      PIC  S9(13)  VALUE +0       00425000
004260                                                     COMP-3.      00426000
004270         10 PA-TOT-CNTK-RECS-INSERT   PIC  S9(13)  VALUE +0       00427000
004280                                                     COMP-3.      00428000
004290         10 PA-TOT-CNPO-RECS-INSERT   PIC  S9(13)  VALUE +0       00429000
004300                                                     COMP-3.      00430000
004310         10 PA-TOT-CNUP-RECS-INSERT   PIC  S9(13)  VALUE +0       00431000
004320                                                     COMP-3.      00432000
004330         10 PA-TOT-CNCT-RECS-INSERT   PIC  S9(13)  VALUE +0       00433000
004340                                                     COMP-3.      00434000
004350         10 PA-TOT-CNSL-RECS-INSERT   PIC  S9(13)  VALUE +0       00435000
004360                                                     COMP-3.      00436000
004370         10 PA-TOT-TOUTTM1-INSERTS    PIC  S9(13)  VALUE +0       00437000
004380                                                     COMP-3.      00438000
004390         10 PA-TOT-ACNTK-RECS-INSERT  PIC  S9(13)  VALUE +0       00439000
004400                                                     COMP-3.      00440000
004410         10 PA-TOT-ACNPO-RECS-INSERT  PIC  S9(13)  VALUE +0       00441000
004420                                                     COMP-3.      00442000
004430         10 PA-TOT-ACNUP-RECS-INSERT  PIC  S9(13)  VALUE +0       00443000
004440                                                     COMP-3.      00444000
004450         10 PA-TOT-ACNCT-RECS-INSERT  PIC  S9(13)  VALUE +0       00445000
004460                                                     COMP-3.      00446000
004470         10 PA-TOT-ACNSL-RECS-INSERT  PIC  S9(13)  VALUE +0       00447000
004480                                                     COMP-3.      00448000
004490         10 PA-TOT-CNRL-RECS-INSERT   PIC  S9(13)  VALUE +0       00449000
004500                                                     COMP-3.      00450000
004510         10 PA-TOT-ACNRL-RECS-INSERT  PIC  S9(13)  VALUE +0       00451000
004520                                                     COMP-3.      00452000
004530         10 PA-TOT-RECS-DELETED       PIC  S9(13)  VALUE +0       00453000
004540                                                     COMP-3.      00454000
004550         10 PA-TOT-CNTK-RECS-DELETED  PIC  S9(13)  VALUE +0       00455000
004560                                                     COMP-3.      00456000
004570         10 PA-TOT-CNPO-RECS-DELETED  PIC  S9(13)  VALUE +0       00457000
004580                                                     COMP-3.      00458000
004590         10 PA-TOT-CNUP-RECS-DELETED  PIC  S9(13)  VALUE +0       00459000
004600                                                     COMP-3.      00460000
004610         10 PA-TOT-CNCT-RECS-DELETED  PIC  S9(13)  VALUE +0       00461000
004620                                                     COMP-3.      00462000
004630         10 PA-TOT-CNSL-RECS-DELETED  PIC  S9(13)  VALUE +0       00463000
004640                                                     COMP-3.      00464000
004650         10 PA-TOT-CNRL-RECS-DELETED  PIC  S9(13)  VALUE +0       00465000
004660                                                     COMP-3.      00466000
004670         10 PA-TOT-RECS-SELECTED      PIC  S9(13)  VALUE +0       00467000
004680                                                     COMP-3.      00468000
004690         10 PA-TOT-CNTK-RECS-SELECT   PIC  S9(13)  VALUE +0       00469000
004700                                                     COMP-3.      00470000
004710         10 PA-TOT-CNPO-RECS-SELECT   PIC  S9(13)  VALUE +0       00471000
004720                                                     COMP-3.      00472000
004730         10 PA-TOT-CNUP-RECS-SELECT   PIC  S9(13)  VALUE +0       00473000
004740                                                     COMP-3.      00474000
004750         10 PA-TOT-CNCT-RECS-SELECT   PIC  S9(13)  VALUE +0       00475000
004760                                                     COMP-3.      00476000
004770         10 PA-TOT-CNSL-RECS-SELECT   PIC  S9(13)  VALUE +0       00477000
004780                                                     COMP-3.      00478000
004790         10 PA-TOT-CNRL-RECS-SELECT   PIC  S9(13)  VALUE +0       00479000
004800                                                     COMP-3.      00480000
004810         10 PA-TOT-RECS-CHANGED       PIC  S9(13)  VALUE +0       00481000
004820                                                     COMP-3.      00482000
004830         10 PA-TOT-CNTK-CHANGES       PIC  S9(13)  VALUE +0       00483000
004840                                                     COMP-3.      00484000
004850         10 PA-TOT-CNPO-CHANGES       PIC  S9(13)  VALUE +0       00485000
004860                                                     COMP-3.      00486000
004870         10 PA-TOT-CNUP-CHANGES       PIC  S9(13)  VALUE +0       00487000
004880                                                     COMP-3.      00488000
004890         10 PA-TOT-CNCT-CHANGES       PIC  S9(13)  VALUE +0       00489000
004900                                                     COMP-3.      00490000
004910         10 PA-TOT-CNSL-CHANGES       PIC  S9(13)  VALUE +0       00491000
004920                                                     COMP-3.      00492000
004930         10 PA-TOT-RECS-CHANGED-B     PIC  S9(13)  VALUE +0       00493000
004940                                                     COMP-3.      00494000
004950         10 PA-TOT-CNTK-CHANGES-B     PIC  S9(13)  VALUE +0       00495000
004960                                                     COMP-3.      00496000
004970         10 PA-TOT-CNPO-CHANGES-B     PIC  S9(13)  VALUE +0       00497000
004980                                                     COMP-3.      00498000
004990         10 PA-TOT-CNUP-CHANGES-B     PIC  S9(13)  VALUE +0       00499000
005000                                                     COMP-3.      00500000
005010         10 PA-TOT-CNCT-CHANGES-B     PIC  S9(13)  VALUE +0       00501000
005020                                                     COMP-3.      00502000
005030         10 PA-TOT-CNSL-CHANGES-B     PIC  S9(13)  VALUE +0       00503000
005040                                                     COMP-3.      00504000
005050         10 PA-TOT-RECS-CHANGED-Z     PIC  S9(13)  VALUE +0       00505000
005060                                                     COMP-3.      00506000
005070         10 PA-TOT-CNPO-CHANGES-Z     PIC  S9(13)  VALUE +0       00507000
005080                                                     COMP-3.      00508000
005090         10 PA-TOT-CNUP-CHANGES-Z     PIC  S9(13)  VALUE +0       00509000
005100                                                     COMP-3.      00510000
005110         10 PA-TOT-CNCT-CHANGES-Z     PIC  S9(13)  VALUE +0       00511000
005120                                                     COMP-3.      00512000
005130         10 PA-TOT-CNSL-CHANGES-Z     PIC  S9(13)  VALUE +0       00513000
005140                                                     COMP-3.      00514000
005150         10 PA-TOT-RECS-DELETED-E     PIC  S9(13)  VALUE +0       00515000
005160                                                     COMP-3.      00516000
005170         10 PA-TOT-CNPO-DELETES-E     PIC  S9(13)  VALUE +0       00517000
005180                                                     COMP-3.      00518000
005190         10 PA-TOT-CNUP-DELETES-E     PIC  S9(13)  VALUE +0       00519000
005200                                                     COMP-3.      00520000
005210         10 PA-TOT-CNCT-DELETES-E     PIC  S9(13)  VALUE +0       00521000
005220                                                     COMP-3.      00522000
005230         10 PA-TOT-CNSL-DELETES-E     PIC  S9(13)  VALUE +0       00523000
005240                                                     COMP-3.      00524000
005250         10 PA-ENTR-ID-SELECTS        PIC  S9(13)  VALUE +0       00525000
005260                                                     COMP-3.      00526000
005270         10 PA-MULTI-ENTR-ID-SELECTS  PIC  S9(13)  VALUE +0       00527000
005280                                                     COMP-3.      00528000
005290                                                                  00529000
005300 01  PS-PROGRAM-SWITCHES.                                         00530000
005310     05  PS-END-OF-FILE-SW             PIC  X(01)    VALUE 'N'.   00531000
005320         88  PS-END-OF-FILE                          VALUE 'Y'.   00532000
005330         88  PS-END-OF-FILE-NO                       VALUE 'N'.   00533000
005340     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   00534000
005350         88  NORMAL-RUN                              VALUE '0'.   00535000
005360         88  RESTART-RUN                             VALUE '9'.   00536000
005370     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.   00537000
005380         88  COMMITS-TAKEN                           VALUE 'T'.   00538000
005390         88  NO-COMMITS-TAKEN                        VALUE 'N'.   00539000
005400     05  PS-EDI-RECORD-SW              PIC  X(01)    VALUE 'N'.   00540000
005410         88  PS-EDI-RECORD                           VALUE 'Y'.   00541000
005420         88  PS-EDI-RECORD-NO                        VALUE 'N'.   00542000
005430     05  PS-GOOD-RECORD-SW             PIC  X(01)    VALUE 'N'.   00543000
005440         88  PS-GOOD-RECORD                          VALUE 'Y'.   00544000
005450         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   00545000
005460     05  PS-EOC-CONPO-CURSOR-SW        PIC  X(01)    VALUE 'N'.   00546000
005470         88  PS-EOC-CONPO-CURSOR                     VALUE 'Y'.   00547000
005480         88  PS-EOC-CONPO-CURSOR-NO                  VALUE 'N'.   00548000
005490     05  PS-EOC-CONUP-CURSOR-SW        PIC  X(01)    VALUE 'N'.   00549000
005500         88  PS-EOC-CONUP-CURSOR                     VALUE 'Y'.   00550000
005510         88  PS-EOC-CONUP-CURSOR-NO                  VALUE 'N'.   00551000
005520     05  PS-EOC-CNCART-CURSOR-SW       PIC  X(01)    VALUE 'N'.   00552000
005530         88  PS-EOC-CNCART-CURSOR                    VALUE 'Y'.   00553000
005540         88  PS-EOC-CNCART-CURSOR-NO                 VALUE 'N'.   00554000
005550     05  PS-EOC-CNSEAL-CURSOR-SW       PIC  X(01)    VALUE 'N'.   00555000
005560         88  PS-EOC-CNSEAL-CURSOR                    VALUE 'Y'.   00556000
005570         88  PS-EOC-CNSEAL-CURSOR-NO                 VALUE 'N'.   00557000
005580     05  PS-EOC-PO-UPC-CART-CURSOR-SW  PIC X(01)     VALUE 'N'.   00558000
005590         88  PS-EOC-PO-UPC-CART-CURSOR               VALUE 'Y'.   00559000
005600         88  PS-EOC-PO-UPC-CART-CURSOR-NO            VALUE 'N'.   00560000
005610     05  PS-EOC-UPC-CURSOR-SW          PIC  X(01)    VALUE 'N'.   00561000
005620         88  PS-EOC-UPC-CURSOR                       VALUE 'Y'.   00562000
005630         88  PS-EOC-UPC-CURSOR-NO                    VALUE 'N'.   00563000
005640     05  PS-EOC-CARTON-CURSOR-SW       PIC  X(01)    VALUE 'N'.   00564000
005650         88  PS-EOC-CARTON-CURSOR                    VALUE 'Y'.   00565000
005660         88  PS-EOC-CARTON-CURSOR-NO                 VALUE 'N'.   00566000
005670     05  PS-EOC-SEAL-CURSOR-SW         PIC  X(01)    VALUE 'N'.   00567000
005680         88  PS-EOC-SEAL-CURSOR                      VALUE 'Y'.   00568000
005690         88  PS-EOC-SEAL-CURSOR-NO                   VALUE 'N'.   00569000
005700     05 PS-EOC-RECYCLE-CURSOR-SW       PIC  X(01)    VALUE 'N'.   00570000
005710         88  PS-EOC-RECYCLE-CURSOR                   VALUE 'Y'.   00571000
005720         88  PS-EOC-RECYCLE-CURSOR-NO                VALUE 'N'.   00572000
005730     05  PS-CNTK-FOUND-SW              PIC  X(01)    VALUE 'N'.   00573000
005740         88  PS-CNTK-FOUND                           VALUE 'Y'.   00574000
005750         88  PS-CNTK-NOT-FOUND                       VALUE 'N'.   00575000
005760     05  PS-CNPO-FOUND-SW              PIC  X(01)    VALUE 'N'.   00576000
005770         88  PS-CNPO-FOUND                           VALUE 'Y'.   00577000
005780         88  PS-CNPO-NOT-FOUND                       VALUE 'N'.   00578000
005790     05  PS-CNUP-FOUND-SW              PIC  X(01)    VALUE 'N'.   00579000
005800         88  PS-CNUP-FOUND                           VALUE 'Y'.   00580000
005810         88  PS-CNUP-NOT-FOUND                       VALUE 'N'.   00581000
005820     05  PS-CNCT-FOUND-SW              PIC  X(01)    VALUE 'N'.   00582000
005830         88  PS-CNCT-FOUND                           VALUE 'Y'.   00583000
005840         88  PS-CNCT-NOT-FOUND                       VALUE 'N'.   00584000
005850     05  PS-CNCT-DELETE-E-FOUND-SW     PIC  X(01)    VALUE 'N'.   00585000
005860         88  PS-CNCT-DELETE-E-FOUND                  VALUE 'Y'.   00586000
005870         88  PS-CNCT-DELETE-E-NOT-FOUND              VALUE 'N'.   00587000
005880     05  PS-CNSL-FOUND-SW              PIC  X(01)    VALUE 'N'.   00588000
005890         88  PS-CNSL-FOUND                           VALUE 'Y'.   00589000
005900         88  PS-CNSL-NOT-FOUND                       VALUE 'N'.   00590000
005910     05  PS-CART-DUP-FOUND-SW          PIC  X(01)    VALUE 'N'.   00591000
005920         88  PS-CART-DUP-FOUND                       VALUE 'Y'.   00592000
005930         88  PS-CART-DUP-NOT-FOUND                   VALUE 'N'.   00593000
005940     05  PS-CNPO-OLD-FOUND-SW          PIC  X(01)    VALUE 'N'.   00594000
005950         88  PS-CNPO-OLD-FOUND                       VALUE 'Y'.   00595000
005960         88  PS-CNPO-OLD-NOT-FOUND                   VALUE 'N'.   00596000
005970     05  PS-CNUP-OLD-FOUND-SW          PIC  X(01)    VALUE 'N'.   00597000
005980         88  PS-CNUP-OLD-FOUND                       VALUE 'Y'.   00598000
005990         88  PS-CNUP-OLD-NOT-FOUND                   VALUE 'N'.   00599000
006000     05  PS-CNCT-OLD-FOUND-SW          PIC  X(01)    VALUE 'N'.   00600000
006010         88  PS-CNCT-OLD-FOUND                       VALUE 'Y'.   00601000
006020         88  PS-CNCT-OLD-NOT-FOUND                   VALUE 'N'.   00602000
006030     05  PS-CNSL-OLD-FOUND-SW          PIC  X(01)    VALUE 'N'.   00603000
006040         88  PS-CNSL-OLD-FOUND                       VALUE 'Y'.   00604000
006050         88  PS-CNSL-OLD-NOT-FOUND                   VALUE 'N'.   00605000
006060     05  PS-PURCHS-FOUND-SW            PIC  X(01)    VALUE 'N'.   00606000
006070         88  PS-PURCHS-FOUND                         VALUE 'Y'.   00607000
006080         88  PS-PURCHS-NOT-FOUND                     VALUE 'N'.   00608000
006090     05  PS-PURITM1-FOUND-SW           PIC  X(01)    VALUE 'N'.   00609000
006100         88  PS-PURITM1-FOUND                        VALUE 'Y'.   00610000
006110         88  PS-PURITM1-NOT-FOUND                    VALUE 'N'.   00611000
006120     05  PS-PURITM2-FOUND-SW           PIC  X(01)    VALUE 'N'.   00612000
006130         88  PS-PURITM2-FOUND                        VALUE 'Y'.   00613000
006140         88  PS-PURITM2-NOT-FOUND                    VALUE 'N'.   00614000
006150     05  PS-TIMCNRL-FOUND-SW           PIC  X(01)    VALUE 'Y'.   00615000
006160         88  PS-TIMCNRL-FOUND                        VALUE 'Y'.   00616000
006170         88  PS-TIMCNRL-NOT-FOUND                    VALUE 'N'.   00617000
006180     05  PS-SAME-INPUT-FIELDS-SW       PIC  X(01)    VALUE 'N'.   00618000
006190         88  PS-SAME-INPUT-FIELDS                    VALUE 'Y'.   00619000
006200         88  PS-NOT-SAME-INPUT-FIELDS                VALUE 'N'.   00620000
006210     05  PS-SAME-COMMIT-FIELDS-SW      PIC  X(01)    VALUE 'N'.   00621000
006220         88  PS-SAME-COMMIT-FIELDS                   VALUE 'Y'.   00622000
006230         88  PS-NOT-SAME-COMMIT-FIELDS               VALUE 'N'.   00623000
006240     05  PS-GOOD-ACNTK-INSERT-SW       PIC  X(01)    VALUE 'N'.   00624000
006250         88  PS-GOOD-ACNTK-INSERT                    VALUE 'Y'.   00625000
006260         88  PS-NOT-GOOD-ACNTK-INSERT                VALUE 'N'.   00626000
006270     05  PS-GOOD-ACNPO-INSERT-SW       PIC  X(01)    VALUE 'N'.   00627000
006280         88  PS-GOOD-ACNPO-INSERT                    VALUE 'Y'.   00628000
006290         88  PS-NOT-GOOD-ACNPO-INSERT                VALUE 'N'.   00629000
006300     05  PS-GOOD-ACNUP-INSERT-SW       PIC  X(01)    VALUE 'N'.   00630000
006310         88  PS-GOOD-ACNUP-INSERT                    VALUE 'Y'.   00631000
006320         88  PS-NOT-GOOD-ACNUP-INSERT                VALUE 'N'.   00632000
006330     05  PS-GOOD-ACNCT-INSERT-SW       PIC  X(01)    VALUE 'N'.   00633000
006340         88  PS-GOOD-ACNCT-INSERT                    VALUE 'Y'.   00634000
006350         88  PS-NOT-GOOD-ACNCT-INSERT                VALUE 'N'.   00635000
006360     05  PS-GOOD-ACNSL-INSERT-SW       PIC  X(01)    VALUE 'N'.   00636000
006370         88  PS-GOOD-ACNSL-INSERT                    VALUE 'Y'.   00637000
006380         88  PS-NOT-GOOD-ACNSL-INSERT                VALUE 'N'.   00638000
006390     05  PS-GOOD-CNTK-INSERT-SW        PIC  X(01)    VALUE 'N'.   00639000
006400         88  PS-GOOD-CNTK-INSERT                     VALUE 'Y'.   00640000
006410         88  PS-GOOD-CNTK-INSERT-NO                  VALUE 'N'.   00641000
006420     05  PS-GOOD-CNPO-INSERT-SW        PIC  X(01)    VALUE 'N'.   00642000
006430         88  PS-GOOD-CNPO-INSERT                     VALUE 'Y'.   00643000
006440         88  PS-GOOD-CNPO-INSERT-NO                  VALUE 'N'.   00644000
006450     05  PS-GOOD-CNUP-INSERT-SW        PIC  X(01)    VALUE 'N'.   00645000
006460         88  PS-GOOD-CNUP-INSERT                     VALUE 'Y'.   00646000
006470         88  PS-GOOD-CNUP-INSERT-NO                  VALUE 'N'.   00647000
006480     05  PS-GOOD-CNCT-INSERT-SW        PIC  X(01)    VALUE 'N'.   00648000
006490         88  PS-GOOD-CNCT-INSERT                     VALUE 'Y'.   00649000
006500         88  PS-GOOD-CNCT-INSERT-NO                  VALUE 'N'.   00650000
006510     05  PS-GOOD-CNSL-INSERT-SW        PIC  X(01)    VALUE 'N'.   00651000
006520         88  PS-GOOD-CNSL-INSERT                     VALUE 'Y'.   00652000
006530         88  PS-GOOD-CNSL-INSERT-NO                  VALUE 'N'.   00653000
006540     05  PS-GOOD-CNTK-DELETE-SW        PIC  X(01)    VALUE 'N'.   00654000
006550         88  PS-GOOD-CNTK-DELETE                     VALUE 'Y'.   00655000
006560         88  PS-GOOD-CNTK-DELETE-NO                  VALUE 'N'.   00656000
006570     05  PS-GOOD-CNPO-DELETE-SW        PIC  X(01)    VALUE 'N'.   00657000
006580         88  PS-GOOD-CNPO-DELETE                     VALUE 'Y'.   00658000
006590         88  PS-GOOD-CNPO-DELETE-NO                  VALUE 'N'.   00659000
006600     05  PS-GOOD-CNUP-DELETE-SW        PIC  X(01)    VALUE 'N'.   00660000
006610         88  PS-GOOD-CNUP-DELETE                     VALUE 'Y'.   00661000
006620         88  PS-GOOD-CNUP-DELETE-NO                  VALUE 'N'.   00662000
006630     05  PS-GOOD-CNCT-DELETE-SW        PIC  X(01)    VALUE 'N'.   00663000
006640         88  PS-GOOD-CNCT-DELETE                     VALUE 'Y'.   00664000
006650         88  PS-GOOD-CNCT-DELETE-NO                  VALUE 'N'.   00665000
006660     05  PS-GOOD-CNSL-DELETE-SW        PIC  X(01)    VALUE 'N'.   00666000
006670         88  PS-GOOD-CNSL-DELETE                     VALUE 'Y'.   00667000
006680         88  PS-GOOD-CNSL-DELETE-NO                  VALUE 'N'.   00668000
006690     05  PS-NEW-CONTAINER-SW           PIC  X(01)    VALUE 'N'.   00669000
006700         88  PS-NEW-CONTAINER                        VALUE 'Y'.   00670000
006710         88  PS-NEW-CONTAINER-NO                     VALUE 'N'.   00671000
006720     05  PS-NEW-PO-SW                  PIC  X(01)    VALUE 'N'.   00672000
006730         88  PS-NEW-PO                               VALUE 'Y'.   00673000
006740         88  PS-NEW-PO-NO                            VALUE 'N'.   00674000
006750     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.   00675000
006760         88  PS-NEW-UPC                              VALUE 'Y'.   00676000
006770         88  PS-NEW-UPC-NO                           VALUE 'N'.   00677000
006780     05  PS-NEW-CARTON-SW              PIC  X(01)    VALUE 'N'.   00678000
006790         88  PS-NEW-CARTON                           VALUE 'Y'.   00679000
006800         88  PS-NEW-CARTON-NO                        VALUE 'N'.   00680000
006810     05  PS-NEW-SEAL-SW                PIC  X(01)    VALUE 'N'.   00681000
006820         88  PS-NEW-SEAL                             VALUE 'Y'.   00682000
006830         88  PS-NEW-SEAL-NO                          VALUE 'N'.   00683000
006840     05  PS-VALID-FOB-CDE-SW           PIC X(01)     VALUE 'Y'.   00684000
006850         88  PS-VALID-FOB-CDE                        VALUE 'Y'.   00685000
006860         88  PS-INVALID-FOB-CDE                      VALUE 'N'.   00686000
006870     05  PS-VALID-ORGN-CDE-SW          PIC X(01)     VALUE 'Y'.   00687000
006880         88  PS-VALID-ORGN-CDE                       VALUE 'Y'.   00688000
006890         88  PS-INVALID-ORGN-CDE                     VALUE 'N'.   00689000
006900     05  PS-VALID-POE-CDE-SW           PIC X(01)     VALUE 'Y'.   00690000
006910         88  PS-VALID-POE-CDE                        VALUE 'Y'.   00691000
006920         88  PS-INVALID-POE-CDE                      VALUE 'N'.   00692000
006930     05  PS-VALID-CNTRY-CDE-SW         PIC X(01)     VALUE 'Y'.   00693000
006940         88  PS-VALID-CNTRY-CDE                      VALUE 'Y'.   00694000
006950         88  PS-INVALID-CNTRY-CDE                    VALUE 'N'.   00695000
006960     05  PS-TPURCHS-ACTIVE-SW          PIC X(01)     VALUE 'N'.   00696000
006970         88  PS-TPURCHS-ACTIVE                       VALUE 'Y'.   00697000
006980         88  PS-TPURCHS-ACTIVE-NO                    VALUE 'N'.   00698000
006990     05  PS-CHANGE-ADD-B-SW            PIC  X(01)    VALUE 'N'.   00699000
007000         88  PS-CHANGE-ADD-B                         VALUE 'Y'.   00700000
007010         88  PS-CHANGE-ADD-B-NO                      VALUE 'N'.   00701000
007020     05  PS-CHANGE-ADD-Z-SW            PIC  X(01)    VALUE 'N'.   00702000
007030         88  PS-CHANGE-ADD-Z                         VALUE 'Y'.   00703000
007040         88  PS-CHANGE-ADD-Z-NO                      VALUE 'N'.   00704000
007050     05  PS-DELETE-DELV-ARV-MSG-SW     PIC  X(01)    VALUE 'N'.   00705000
007060         88  PS-DELETE-DELV-ARV-MSG                  VALUE 'Y'.   00706000
007070         88  PS-DELETE-DELV-ARV-MSG-NO               VALUE 'N'.   00707000
007080     05  PS-DELETE-DELV-MSG-SW         PIC  X(01)    VALUE 'N'.   00708000
007090         88  PS-DELETE-DELV-MSG                      VALUE 'Y'.   00709000
007100         88  PS-DELETE-DELV-MSG-NO                   VALUE 'N'.   00710000
007110     05  PS-DELETE-ARV-MSG-SW          PIC  X(01)    VALUE 'N'.   00711000
007120         88  PS-DELETE-ARV-MSG                       VALUE 'Y'.   00712000
007130         88  PS-DELETE-ARV-MSG-NO                    VALUE 'N'.   00713000
007140     05  PS-CHANGE-FOUND-CNTR-SW       PIC  X(01)    VALUE 'N'.   00714000
007150         88  PS-CHANGE-FOUND-CNTR                    VALUE 'Y'.   00715000
007160         88  PS-CHANGE-FOUND-CNTR-NO                 VALUE 'N'.   00716000
007170*CHG102494 - START                                                00717008
007180     05  PS-TIMCNUP-RECORD-FOUND-SW    PIC  X(01)    VALUE 'N'.   00718005
007190         88  PS-TIMCNUP-RECORD-FOUND                 VALUE 'Y'.   00719005
007200         88  PS-TIMCNUP-RECORD-FOUND-NO              VALUE 'N'.   00720005
007210*CHG102494 - END                                                  00721008
007220     05  PS-CHANGE-FOUND-PO-SW         PIC  X(01)    VALUE 'N'.   00722000
007230         88  PS-CHANGE-FOUND-PO                      VALUE 'Y'.   00723000
007240         88  PS-CHANGE-FOUND-PO-NO                   VALUE 'N'.   00724000
007250     05  PS-CHANGE-FOUND-UPC-SW        PIC  X(01)    VALUE 'N'.   00725000
007260         88  PS-CHANGE-FOUND-UPC                     VALUE 'Y'.   00726000
007270         88  PS-CHANGE-FOUND-UPC-NO                  VALUE 'N'.   00727000
007280     05  PS-CHANGE-FOUND-CNCART-SW     PIC  X(01)    VALUE 'N'.   00728000
007290         88  PS-CHANGE-FOUND-CNCART                  VALUE 'Y'.   00729000
007300         88  PS-CHANGE-FOUND-CNCART-NO               VALUE 'N'.   00730000
007310     05  PS-CHANGE-FOUND-CNSEAL-SW     PIC  X(01)    VALUE 'N'.   00731000
007320         88  PS-CHANGE-FOUND-CNSEAL                  VALUE 'Y'.   00732000
007330         88  PS-CHANGE-FOUND-CNSEAL-NO               VALUE 'N'.   00733000
007340     05  PS-CHANGE-FOUND-SW            PIC  X(01)    VALUE 'N'.   00734000
007350         88  PS-CHANGE-FOUND                         VALUE 'Y'.   00735000
007360         88  PS-CHANGE-FOUND-NO                      VALUE 'N'.   00736000
007370     05  PS-CREATE-ISARDA-SW           PIC  X(01)    VALUE 'Y'.   00737000
007380         88  PS-CREATE-ISARDA                        VALUE 'Y'.   00738000
007390         88  PS-CREATE-ISARDA-NO                     VALUE 'N'.   00739000
007400     05  PS-CREATE-ISARDD-SW           PIC  X(01)    VALUE 'Y'.   00740000
007410         88  PS-CREATE-ISARDD                        VALUE 'Y'.   00741000
007420         88  PS-CREATE-ISARDD-NO                     VALUE 'N'.   00742000
007430     05  PS-VALID-POE-CDE-EXIST-SW     PIC  X(01)    VALUE 'Y'.   00743000
007440         88  PS-VALID-POE-CDE-EXIST                  VALUE 'Y'.   00744000
007450         88  PS-VALID-POE-CDE-EXIST-NO               VALUE 'N'.   00745000
007460     05  PS-UPC-OUTR-PACKS-WNG-SW      PIC  X(01)    VALUE 'N'.   00746000
007470         88  PS-UPC-OUTR-PACKS-WNG                   VALUE 'Y'.   00747000
007480         88  PS-UPC-OUTR-PACKS-WNG-NO                VALUE 'N'.   00748000
007490     05  PS-LANDED-PO-FOUND-SW         PIC  X(01)    VALUE 'N'.   00749000
007500         88  PS-LANDED-PO-FOUND                      VALUE 'Y'.   00750000
007510         88  PS-LANDED-PO-NOT-FOUND                  VALUE 'N'.   00751000
007520     05  PS-LANDED-PO-IN-CONTNR-SW     PIC  X(01)    VALUE 'N'.   00752000
007530         88  PS-LANDED-PO-IN-CONTNR                  VALUE 'Y'.   00753000
007540         88  PS-LANDED-PO-NOT-IN-CONTNR              VALUE 'N'.   00754000
007550     05  PS-IMPORT-PO-IN-CONTNR-SW     PIC  X(01)    VALUE 'N'.   00755000
007560         88  PS-IMPORT-PO-IN-CONTNR                  VALUE 'Y'.   00756000
007570         88  PS-IMPORT-PO-NOT-IN-CONTNR              VALUE 'N'.   00757000
007580     05  PS-LOAD-PRINT-TABLE-SW        PIC  X(01)    VALUE 'N'.   00758000
007590         88  PS-LOAD-PRINT-TABLE                     VALUE 'Y'.   00759000
007600         88  PS-LOAD-PRINT-TABLE-NO                  VALUE 'N'.   00760000
007610     05  PS-CNTK-PREV-SENT-ERR-SW      PIC  X(01)    VALUE 'N'.   00761000
007620         88  PS-CNTK-PREV-SENT-ERR                   VALUE 'Y'.   00762000
007630         88  PS-CNTK-PREV-SENT-ERR-NO                VALUE 'N'.   00763000
007640     05  PS-CNPO-PREV-SENT-ERR-SW      PIC  X(01)    VALUE 'N'.   00764000
007650         88  PS-CNPO-PREV-SENT-ERR                   VALUE 'Y'.   00765000
007660         88  PS-CNPO-PREV-SENT-ERR-NO                VALUE 'N'.   00766000
007670     05  PS-CNUP-PREV-SENT-ERR-SW      PIC  X(01)    VALUE 'N'.   00767000
007680         88  PS-CNUP-PREV-SENT-ERR                   VALUE 'Y'.   00768000
007690         88  PS-CNUP-PREV-SENT-ERR-NO                VALUE 'N'.   00769000
007700     05  PS-CNCT-PREV-SENT-ERR-SW      PIC  X(01)    VALUE 'N'.   00770000
007710         88  PS-CNCT-PREV-SENT-ERR                   VALUE 'Y'.   00771000
007720         88  PS-CNCT-PREV-SENT-ERR-NO                VALUE 'N'.   00772000
007730     05  PS-ORGN-FOUND-SW              PIC  X(01)    VALUE 'N'.   00773000
007740         88  PS-ORGN-FOUND                           VALUE 'Y'.   00774000
007750         88  PS-ORGN-NOT-FOUND                       VALUE 'N'.   00775000
007760     05  PS-RESET-DC-SPLIT-CNTR-SW     PIC  X(01)    VALUE 'N'.   00776000
007770         88  PS-RESET-DC-SPLIT-CNTR                  VALUE 'Y'.   00777000
007780         88  PS-DONT-RESET-DC-SPLIT-CNTR             VALUE 'N'.   00778000
007790     05  PS-RESET-DC-SPLIT-DETL-SW     PIC  X(01)    VALUE 'N'.   00779000
007800         88  PS-RESET-DC-SPLIT-DETL                  VALUE 'Y'.   00780000
007810         88  PS-DONT-RESET-DC-SPLIT-DETL             VALUE 'N'.   00781000
007820     05  PS-E-DELETE-SW                PIC  X(01)    VALUE 'N'.   00782000
007830         88  PS-E-DELETE                             VALUE 'Y'.   00783000
007840         88  PS-NOT-E-DELETE                         VALUE 'N'.   00784000
007850     05  PS-ORGN-CODE-CHANGED-SW       PIC  X(01)    VALUE 'N'.   00785000
007860         88  PS-ORGN-CODE-CHANGED                    VALUE 'Y'.   00786000
007870         88  PS-ORGN-CODE-NOT-CHANGED                VALUE 'N'.   00787000
007880                                                                  00788000
007890 01  PC-PROGRAM-CONSTANTS.                                        00789000
007900     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          00790000
007910         'TRKUP215'.                                              00791000
007920     05  PC-10                       PIC X(02)     VALUE '10'.    00792000
007930     05  PC-11                       PIC X(02)     VALUE '11'.    00793000
007940     05  PC-20                       PIC X(02)     VALUE '20'.    00794000
007950     05  PC-21                       PIC X(02)     VALUE '21'.    00795000
007960     05  PC-30                       PIC X(02)     VALUE '30'.    00796000
007970     05  PC-31                       PIC X(02)     VALUE '31'.    00797000
007980     05  PC-32                       PIC X(02)     VALUE '32'.    00798000
007990     05  PC-40                       PIC X(02)     VALUE '40'.    00799000
008000     05  PC-50                       PIC X(02)     VALUE '50'.    00800000
008010     05  PC-51                       PIC X(02)     VALUE '51'.    00801000
008020     05  PC-52                       PIC X(02)     VALUE '52'.    00802000
008030     05  PC-60                       PIC X(02)     VALUE '60'.    00803000
008040     05  PC-70                       PIC X(02)     VALUE '70'.    00804000
008050     05  PC-A                        PIC X(01)     VALUE 'A'.     00805000
008060     05  PC-B                        PIC X(01)     VALUE 'B'.     00806000
008070     05  PC-C                        PIC X(01)     VALUE 'C'.     00807000
008080     05  PC-D                        PIC X(01)     VALUE 'D'.     00808000
008090     05  PC-E                        PIC X(01)     VALUE 'E'.     00809000
008100     05  PC-I                        PIC X(01)     VALUE 'I'.     00810000
008110     05  PC-M                        PIC X(01)     VALUE 'M'.     00811000
008120     05  PC-N                        PIC X(01)     VALUE 'N'.     00812000
008130     05  PC-O                        PIC X(01)     VALUE 'O'.     00813000
008140     05  PC-R                        PIC X(01)     VALUE 'R'.     00814000
008150     05  PC-S                        PIC X(01)     VALUE 'S'.     00815000
008160     05  PC-U                        PIC X(01)     VALUE 'U'.     00816000
008170     05  PC-Y                        PIC X(01)     VALUE 'Y'.     00817000
008180     05  PC-Z                        PIC X(01)     VALUE 'Z'.     00818000
008190     05  PC-AC                       PIC X(02)     VALUE 'AC'.    00819000
008200     05  PC-AP                       PIC X(02)     VALUE 'AP'.    00820000
008210     05  PC-CA                       PIC X(02)     VALUE 'CA'.    00821000
008220     05  PC-CD                       PIC X(02)     VALUE 'CD'.    00822000
008230     05  PC-CM                       PIC X(02)     VALUE 'CM'.    00823000
008240     05  PC-CN                       PIC X(02)     VALUE 'CN'.    00824000
008250     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.   00825000
008260     05  PC-ISARDD                   PIC X(07)     VALUE          00826000
008270                                                   'ISA RDD'.     00827000
008280     05  PC-ISARDA                   PIC X(07)     VALUE          00828000
008290                                                   'ISA RDA'.     00829000
008300     05  PC-IEARDD                   PIC X(07)     VALUE          00830000
008310                                                   'IEA RDD'.     00831000
008320     05  PC-IEARDA                   PIC X(07)     VALUE          00832000
008330                                                   'IEA RDA'.     00833000
008340     05  PC-CVYA                     PIC X(06)     VALUE 'CVYA  '.00834000
008350     05  PC-CVYB                     PIC X(06)     VALUE 'CVYB  '.00835000
008360     05  PC-CONA                     PIC X(06)     VALUE 'CONA  '.00836000
008370     05  PC-CONB                     PIC X(06)     VALUE 'CONB  '.00837000
008380     05  PC-CONPOA                   PIC X(06)     VALUE 'CONPOA'.00838000
008390     05  PC-CONPOB                   PIC X(06)     VALUE 'CONPOB'.00839000
008400     05  PC-CONPOC                   PIC X(06)     VALUE 'CONPOC'.00840000
008410     05  PC-CONUPA                   PIC X(06)     VALUE 'CONUPA'.00841000
008420     05  PC-CONUPB                   PIC X(06)     VALUE 'CONUPB'.00842000
008430     05  PC-CONUPC                   PIC X(06)     VALUE 'CONUPC'.00843000
008440     05  PC-CNCART                   PIC X(06)     VALUE 'CNCART'.00844000
008450     05  PC-CNSEAL                   PIC X(06)     VALUE 'CNSEAL'.00845000
008460     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   00846000
008470     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   00847000
008480     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.   00848000
008490     05  PC-IEA                      PIC X(03)     VALUE 'IEA'.   00849000
008500     05  PC-POL                      PIC X(03)     VALUE 'POL'.   00850000
008510     05  PC-POR                      PIC X(03)     VALUE 'POR'.   00851000
008520     05  PC-CMN                      PIC X(03)     VALUE 'CMN'.   00852000
008530     05  PC-CON                      PIC X(03)     VALUE 'CON'.   00853000
008540     05  PC-DASH                     PIC X(01)     VALUE '-'.     00854000
008550     05  PC-SLASH                    PIC X(01)     VALUE '/'.     00855000
008560     05  PC-SPACE                    PIC X(01)     VALUE ' '.     00856000
008570     05  PC-LOW-VALUE                PIC X(01)     VALUE          00857000
008580                                                   LOW-VALUES.    00858000
008590     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE          00859000
008600                                     '9999-09-09-00.00.00.000000'.00860000
008610     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          00861000
008620                                     '0001-01-01-00.00.00.000000'.00862000
008630     05  PC-DEFAULT-DTE              PIC X(10)     VALUE          00863000
008640                                     '0001-01-01'.                00864000
008650     05  PC-DEFAULT-DTE-NO-DASHES    PIC X(08)     VALUE          00865000
008660                                     '00010101'.                  00866000
008670     05  PC-DEFAULT-NINES-DTE        PIC X(10)     VALUE          00867000
008680                                     '9999-09-09'.                00868000
008690     05  PC-DEFAULT-NINES-TIME       PIC X(08)     VALUE          00869000
008700                                     '09.09.09'.                  00870000
008710     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       00871000
008720                                                     COMP-3.      00872000
008730     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     00873000
008740     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     00874000
008750     05  PC-HEX-15                   PIC X(01)     VALUE ''.     00875000
008760     05  PC-MAX-TABLE-ROWS           PIC S9(03)    VALUE +100     00876000
008770                                                     COMP-3.      00877000
008780                                                                  00878000
008790 01  PV-PROGRAM-VARIABLES.                                        00879000
008800                                                                  00880000
008810     05  PV-HOLD-TR023-REC-TYP-CONPO PIC X(400)  VALUE SPACE.     00881000
008820     05  PV-INDX-1                   PIC 9(5)    VALUE 0.         00882000
008830     05  PV-INDX-2                   PIC 9(5)    VALUE 0.         00883000
008840     05  PV-NULL-UPC                 PIC S9(4)   COMP VALUE +0.   00884000
008850     05  PV-NULL-CART                PIC S9(4)   COMP VALUE +0.   00885000
008860     05  PV-HOLD-CONTNR-ID           PIC X(12)     VALUE SPACE.   00886000
008870     05  PV-HOLD-ACTL-DPRTR-DTE-MOM  PIC X(08)     VALUE SPACES.  00887000
008880     05  PV-HOLD-ACTL-DPRTR-TM-MOM   PIC X(04)     VALUE SPACES.  00888000
008890     05  PV-PREPK-TYP-CDE            PIC X(01)     VALUE SPACES.  00889000
008900     05  PV-HOLD-PO-NBR              PIC S9(09)    VALUE ZEROS    00890000
008910                                                   COMP.          00891000
008920     05  PV-HOLD-TRN-TYP             PIC X(01)     VALUE SPACES.  00892000
008930     05  PV-HOLD-3RD-PARTY-CDE       PIC X(06)     VALUE SPACES.  00893000
008940     05  PV-PREV-ORGN-SHPD-FR-CDE PIC X(4)    VALUE SPACES.       00894000
008950                                                                  00895000
008960     05  PV-HOLD-CONPO-EXTL-REF-NBR  PIC X(15)     VALUE SPACES.  00896000
008970                                                                  00897000
008980     05  PV-CALC-OUTR-PACK-PCT       PIC S9(3)V9(2) VALUE +0      00898000
008990                                                    COMP.         00899000
009000     05  PV-CALC-UNTS-CTNS-PCT       PIC S9(3)V9(2) VALUE +0      00900000
009010                                                    COMP.         00901000
009020     05  PV-POPRPK-UNT-QTY           PIC S9(09)    VALUE +0       00902000
009030                                                   COMP.          00903000
009040     05  PV-PO-PREPK-ID              PIC S9(04)    VALUE +0       00904000
009050                                                   COMP.          00905000
009060     05  PV-PREPACK-UNTS             PIC S9(13)    VALUE +0       00906000
009070                                                   COMP-3.        00907000
009080     05  PV-BULK-UNTS                PIC S9(13)    VALUE +0       00908000
009090                                                   COMP-3.        00909000
009100     05  PV-PREPACK-CTNS             PIC S9(13)    VALUE +0       00910000
009110                                                   COMP-3.        00911000
009120     05  PV-CALC-UNTS-CTNS           PIC S9(13)    VALUE +0       00912000
009130                                                   COMP-3.        00913000
009140     05  PV-PACK-SKU-NBR             PIC S9(08)    VALUE +0       00914000
009150                                                   COMP-3.        00915000
009160     05  PV-PACK-UPC-NBR             PIC S9(15)    VALUE +0       00916000
009170                                                   COMP-3.        00917000
009180     05  PV-BULK-SKU-NBR             PIC S9(08)    VALUE +0       00918000
009190                                                   COMP-3.        00919000
009200     05  PV-BULK-UPC-NBR             PIC S9(15)    VALUE +0       00920000
009210                                                   COMP-3.        00921000
009220     05  PV-OUTR-PACK-QTY            PIC S9(09)    VALUE ZEROES.  00922000
009230     05  PV-HOLD-FOB-CDE             PIC X(05)     VALUE SPACES.  00923000
009240     05  PV-HOLD-POE-CDE             PIC X(04)     VALUE SPACES.  00924000
009250     05  PV-HOLD-ORGN-CDE            PIC X(05)     VALUE SPACES.  00925000
009260     05  PV-HOLD-ORGN-TYP-CDE        PIC X(03)     VALUE SPACES.  00926000
009270     05  PV-HOLD-TRIP-TYP-CDE        PIC X(01)     VALUE SPACES.  00927000
009280     05  PV-HOLD-CNTRY-CDE           PIC X(03)     VALUE SPACES.  00928000
009290     05  PV-HOLD-CONTNR-SEQ-NBR      PIC S9(04)    VALUE +0       00929000
009300                                                   COMP.          00930000
009310     05  PV-HOLD-ORGN-SHPD-FR-CDE    PIC X(03)     VALUE SPACES.  00931000
009320     05  PV-CONTNR-SEQ-NBR-MAX       PIC S9(04)    VALUE +0       00932000
009330                                                   COMP.          00933000
009340     05  PV-TR265-CONTNR-SEQ-NBR-PREV PIC S9(04)   VALUE +0       00934000
009350                                                   COMP.          00935000
009360     05  PV-TR265-FOB-CDE            PIC X(05)     VALUE SPACES.  00936000
009370     05  PV-TR265-POE-CDE            PIC X(04)     VALUE SPACES.  00937000
009380     05  PV-COMPARE-MOM-FOB-CDE      PIC X(05)     VALUE SPACES.  00938000
009390     05  PV-COMPARE-MOM-POE-CDE      PIC X(04)     VALUE SPACES.  00939000
009400     05  PV-COMPARE-TRIP-TYP-CDE     PIC X(01)     VALUE SPACES.  00940000
009410     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0       00941000
009420                                                   COMP.          00942000
009430     05  PV-FUNC-CDE                 PIC X(01)     VALUE SPACE.   00943000
009440     05  PV-VEND-ID-QUAL             PIC X(02)     VALUE SPACES.  00944000
009450     05  PV-VEND-ID                  PIC X(15)     VALUE SPACES.  00945000
009460     05  PV-IMCNPO-CSTM-ENTR-ID      PIC X(12)     VALUE SPACES.  00946000
009470     05  PV-HOLD-UPC-NBR             PIC S9(15)V   VALUE ZEROS    00947000
009480                                                   COMP-3.        00948000
009490     05  PV-HOLD-SSCC-NBR            PIC X(48)     VALUE SPACES.  00949000
009500     05  PV-HOLD-SEAL-NBR            PIC X(15)     VALUE SPACES.  00950000
009510     05  PV-HOLD-LAST-REC-TYP        PIC X(03)     VALUE SPACES.  00951000
009520     05  PV-PREV-REC-TYP-CDE         PIC X(06)     VALUE SPACES.  00952000
009530                                                                  00953000
009540     05  PV-EDIT-DATA-VALUE-FIELD.                                00954000
009550         10  PV-EDIT-VALUE-1         PIC ZZZZZZZZZ9.              00955000
009560         10  PV-EDIT-SLASH           PIC X(01)     VALUE '/'.     00956000
009570         10  PV-EDIT-VALUE-2         PIC ZZZZZZZZ9.               00957000
009580                                                                  00958000
009590     05  PV-TRN-TYP-CDE              PIC X(01).                   00959000
009600         88  PV-TRN-TYP-ADD                        VALUE 'A'.     00960000
009610         88  PV-TRN-TYP-CHG                        VALUE 'C'.     00961000
009620         88  PV-TRN-TYP-DEL                        VALUE 'D'.     00962000
009630                                                                  00963000
009640     05  PV-REC-TYP-CDE              PIC X(06).                   00964000
009650         88  PV-REC-TYP-CNTR                       VALUE 'CNTR  '.00965000
009660         88  PV-REC-TYP-CONPO                      VALUE 'CONPO '.00966000
009670         88  PV-REC-TYP-CONUPC                     VALUE 'CONUPC'.00967000
009680         88  PV-REC-TYP-CNCART                     VALUE 'CNCART'.00968000
009690         88  PV-REC-TYP-CNSEAL                     VALUE 'CNSEAL'.00969000
009700                                                                  00970000
009710     05  PV-EDI-RECORDS              PIC  X(03).                  00971000
009720         88  EDI-RECORD                            VALUE 'CTT',   00972000
009730                                                         'IEA',   00973000
009740                                                         'ISA'.   00974000
009750         88  EDI-IEA-RECORD                        VALUE 'IEA'.   00975000
009760     05  PV-UPC-NBR-NOT-FOUND-SW     PIC X(01)     VALUE 'N'.     00976000
009770         88  PV-UPC-NBR-NOT-FOUND                  VALUE 'Y'.     00977000
009780         88  PV-UPC-NBR-NOT-FOUND-NO               VALUE 'N'.     00978000
009790                                                                  00979000
009800     05  PV-NULL-INDICATORS.                                      00980000
009810         10  PV-IMCNPO-PO-NBR-NULL           PIC S9(04) VALUE +0  00981000
009820                                                        COMP.     00982000
009830         10  PV-IMCNPO-EXTL-REF-NBR-NULL     PIC S9(04) VALUE +0  00983000
009840                                                        COMP.     00984000
009850         10  PV-IMCNPO-CONTNR-ID-NULL        PIC S9(04) VALUE +0  00985000
009860                                                        COMP.     00986000
009870         10  PV-IMCNPO-BKR-FRGT-RLSE-CDE-NL  PIC S9(04) VALUE +0  00987000
009880                                                        COMP.     00988000
009890         10  PV-IMCNPO-DO-RCVD-CDE-NULL      PIC S9(04) VALUE +0  00989000
009900                                                        COMP.     00990000
009910         10  PV-IMCNPO-CONTNR-PU-CDE-NULL    PIC S9(04) VALUE +0  00991000
009920                                                        COMP.     00992000
009930         10  PV-IMCNPO-ACTL-POE-DELY-CDE-NL  PIC S9(04) VALUE +0  00993000
009940                                                        COMP.     00994000
009950         10  PV-IMCNPO-DVN-CDE-NULL          PIC S9(04) VALUE +0  00995000
009960                                                        COMP.     00996000
009970         10  PV-IMCNPO-DCONSLR-RET-CDE-NULL  PIC S9(04) VALUE +0  00997000
009980                                                        COMP.     00998000
009990                                                                  00999000
010000***DELIVERY ORDER HOLD FIELDS                                     01000000
010010     05  PV-HOLD-BKR-FRGT-RLSE-TMST  PIC X(26)     VALUE SPACES.  01001000
010020     05  PV-HOLD-DO-TO-DCONSLR-TMST  PIC X(26)     VALUE SPACES.  01002000
010030     05  PV-HOLD-DO-RCVD-TMST        PIC X(26)     VALUE SPACES.  01003000
010040     05  PV-HOLD-CONTNR-PU-TMST      PIC X(26)     VALUE SPACES.  01004000
010050     05  PV-HOLD-DVN-TMST            PIC X(26)     VALUE SPACES.  01005000
010060     05  PV-HOLD-DCONSLR-RET-TMST    PIC X(26)     VALUE SPACES.  01006000
010070     05  PV-HOLD-DCONSLR-SCAC-ID     PIC X(04)     VALUE SPACES.  01007000
010080     05  PV-HOLD-BKR-FRGT-RLSE-CDE   PIC X(01)     VALUE SPACES.  01008000
010090     05  PV-HOLD-DO-RCVD-CDE         PIC X(01)     VALUE SPACES.  01009000
010100     05  PV-HOLD-CONTNR-PU-CDE       PIC X(01)     VALUE SPACES.  01010000
010110     05  PV-HOLD-DVN-CDE             PIC X(01)     VALUE SPACES.  01011000
010120     05  PV-HOLD-DCONSLR-RET-CDE     PIC X(01)     VALUE SPACES.  01012000
010130                                                                  01013000
010140***ARRIVAL HOLD FIELDS                                            01014000
010150     05  PV-HOLD-ACTL-DEST-POE-CDE   PIC X(04)     VALUE SPACES.  01015000
010160     05  PV-HOLD-ACTL-POE-DELY-TMST  PIC X(26)     VALUE SPACES.  01016000
010170     05  PV-HOLD-ACTL-LBD-NM         PIC X(30)     VALUE SPACES.  01017000
010180     05  PV-HOLD-ACTL-LBD-TMST       PIC X(26)     VALUE SPACES.  01018000
010190     05  PV-HOLD-ACTL-POE-DELY-CDE   PIC X(01)     VALUE SPACES.  01019000
010200                                                                  01020000
010210     05  PV-HOLD-CURSOR-PO-NBR       PIC S9(09)    VALUE ZEROES   01021000
010220                                                   COMP.          01022000
010230     05  PV-HOLD-CURSOR-UPC-NBR      PIC S9(15)V   VALUE ZEROES   01023000
010240                                                   COMP-3.        01024000
010250     05  PV-HOLD-CURSOR-SEAL-NBR     PIC  X(15)    VALUE SPACES.  01025000
010260                                                                  01026000
010270     05  PV-CURSOR-PO-NBR            PIC S9(09)    VALUE ZEROES   01027000
010280                                                   COMP.          01028000
010290     05  PV-CURSOR-UPC-NBR           PIC S9(15)V   VALUE ZEROES   01029000
010300                                                   COMP-3.        01030000
010310     05  PV-CURSOR-SSCC-NBR          PIC  X(48)    VALUE SPACES.  01031000
010320                                                                  01032000
010330     05  PV-CURSOR-SEAL-NBR          PIC  X(15)    VALUE SPACES.  01033000
010340                                                                  01034000
010350     05  PV-SELECT-PO-NBR            PIC S9(09)    VALUE ZEROES   01035000
010360                                                   COMP.          01036000
010370     05  PV-TMST                     PIC X(26)     VALUE SPACES.  01037000
010380     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  01038000
010390     05  PV-FORMATED-DB2-TMST        PIC X(26)     VALUE SPACES.  01039000
010400     05  PV-DOC-RCVD-ORGN-TMST-OLD   PIC X(26)     VALUE SPACES.  01040000
010410     05  PV-DOC-RCVD-ORGN-TMST-NEW   PIC X(26)     VALUE SPACES.  01041000
010420     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  01042000
010430     05  PV-CURRENT-TMST-RULES       PIC X(26)     VALUE SPACES.  01043000
010440     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACES.  01044000
010450     05  PV-CONT-INPUT-COUNT         PIC 9(09)     VALUE ZERO     01045000
010460                                                    COMP-3.       01046000
010470     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       01047000
010480                                                    COMP SYNC.    01048000
010490     05  PV-CARTON-REC-COUNT-BULK    PIC 9(09)     VALUE ZERO     01049000
010500                                                    COMP-3.       01050000
010510     05  PV-CARTON-REC-COUNT-TOTAL   PIC 9(09)     VALUE ZERO     01051000
010520                                                    COMP-3.       01052000
010530     05  PV-CARTON-COUNT-PER-PO      PIC 9(09)     VALUE ZERO     01053000
010540                                                    COMP-3.       01054000
010550                                                                  01055000
010560     05  PV-HOLD-CONPO-PO-RCVD-DELY-DTE   PIC X(10).              01056000
010570     05  PV-FORMAT-TMST.                                          01057000
010580         10  PV-FORMAT-TMST-DTE.                                  01058000
010590             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE '0000'.  01059000
010600             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     01060000
010610             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE '00'.    01061000
010620             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     01062000
010630             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE '00'.    01063000
010640             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     01064000
010650         10  PV-FORMAT-TMST-TM.                                   01065000
010660             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE '00'.    01066000
010670             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     01067000
010680             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE '00'.    01068000
010690             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          01069000
010700                                                     '.00.000000'.01070000
010710     05  PV-FORMAT-PO-RCVD-DELY-DTE.                              01071000
010720         10  PV-FORMAT-RCVD-DTE-CY  PIC X(04)  VALUE SPACES.      01072000
010730         10  PV-FORMAT-RCVD-DTE-MM  PIC X(02)  VALUE SPACES.      01073000
010740         10  PV-FORMAT-RCVD-DTE-DD  PIC X(02)  VALUE SPACES.      01074000
010750                                                                  01075000
010760 01  PV-HOLD-ISA-REC.                                             01076000
010770     05  FILLER                      PIC X(150)    VALUE SPACES.  01077000
010780     05  PV-HOLD-ISA-FILE-ID         PIC X(09)     VALUE SPACES.  01078000
010790     05  PV-HOLD-ISA-ENT-ID          PIC 9(09)     VALUE ZEROES.  01079000
010800     05  FILLER                      PIC X(132)    VALUE SPACES.  01080000
010810                                                                  01081000
010820 01  PV-PO-UPC-CART-TABLE.                                        01082000
010830     05  PV-PO-UPC-CART-TABLE-ENTRY OCCURS 20000 TIMES            01083000
010840                                INDEXED BY PO-INDX.               01084000
010850         10  PV-TABLE-PO-NBR         PIC 9(09).                   01085000
010860         10  PV-TABLE-UPC-NBR        PIC 9(15).                   01086000
010870         10  PV-TABLE-SSCC-NBR       PIC X(48).                   01087000
010880                                                                  01088000
010890 01  PV-SEAL-TABLE.                                               01089000
010900     05  PV-SEAL-TABLE-ENTRY OCCURS 1000 TIMES                    01090000
010910                                INDEXED BY SEAL-INDX.             01091000
010920         10  PV-TABLE-SEAL-NBR       PIC X(15).                   01092000
010930                                                                  01093000
010940 01  PV-PRINT-TABLE.                                              01094000
010950     05  PV-PRINT-TABLE-ENTRY OCCURS 100 TIMES                    01095000
010960                                INDEXED BY PRINT-INDX.            01096000
010970         10  PV-PRINT-TABLE-PART1    PIC X(254).                  01097000
010980         10  PV-PRINT-TABLE-PART2    PIC X(254).                  01098000
010990                                                                  01099000
011000 01  CKPT-RESTART-INFO.                                           01100000
011010     05  CR-INPUT-FILE-SW            PIC X(01)     VALUE 'I'.     01101000
011020         88  INPUT-CONTAINER-FILE                  VALUE 'I'.     01102000
011030     05  CR-CONTAINER-RECS-WORKED    PIC 9(09)     VALUE ZERO.    01103000
011040                                                                  01104000
011050     05  CR-TOTAL-COMMITS            PIC 9(13)     VALUE ZERO.    01105000
011060     05  CR-TOTAL-REPORT-COUNT       PIC 9(13)     VALUE ZERO.    01106000
011070     05  CR-TOTAL-RULE-COUNT         PIC 9(13)     VALUE ZERO.    01107000
011080     05  CR-TOTAL-ERROR-COUNT        PIC 9(13)     VALUE ZERO.    01108000
011090     05  CR-TOTAL-DETAIL-COUNT       PIC 9(13)     VALUE ZERO.    01109000
011100     05  CR-TOT-RECS-INSERTED        PIC 9(13)     VALUE ZERO.    01110000
011110     05  CR-TOT-TOUTTM1-INSERTS      PIC 9(13)     VALUE ZERO.    01111000
011120     05  CR-TOT-CNTK-RECS-INSERT     PIC 9(13)     VALUE ZERO.    01112000
011130     05  CR-TOT-CNPO-RECS-INSERT     PIC 9(13)     VALUE ZERO.    01113000
011140     05  CR-TOT-CNUP-RECS-INSERT     PIC 9(13)     VALUE ZERO.    01114000
011150     05  CR-TOT-CNCT-RECS-INSERT     PIC 9(13)     VALUE ZERO.    01115000
011160     05  CR-TOT-CNSL-RECS-INSERT     PIC 9(13)     VALUE ZERO.    01116000
011170     05  CR-TOT-CNRL-RECS-INSERT     PIC 9(13)     VALUE ZERO.    01117000
011180     05  CR-TOT-ACNRL-RECS-INSERT    PIC 9(13)     VALUE ZERO.    01118000
011190     05  CR-TOT-ACNTK-RECS-INSERT    PIC 9(13)     VALUE ZERO.    01119000
011200     05  CR-TOT-ACNPO-RECS-INSERT    PIC 9(13)     VALUE ZERO.    01120000
011210     05  CR-TOT-ACNUP-RECS-INSERT    PIC 9(13)     VALUE ZERO.    01121000
011220     05  CR-TOT-ACNCT-RECS-INSERT    PIC 9(13)     VALUE ZERO.    01122000
011230     05  CR-TOT-ACNSL-RECS-INSERT    PIC 9(13)     VALUE ZERO.    01123000
011240     05  CR-TOT-RECS-DELETED         PIC 9(13)     VALUE ZERO.    01124000
011250     05  CR-TOT-CNTK-RECS-DELETED    PIC 9(13)     VALUE ZERO.    01125000
011260     05  CR-TOT-CNPO-RECS-DELETED    PIC 9(13)     VALUE ZERO.    01126000
011270     05  CR-TOT-CNUP-RECS-DELETED    PIC 9(13)     VALUE ZERO.    01127000
011280     05  CR-TOT-CNCT-RECS-DELETED    PIC 9(13)     VALUE ZERO.    01128000
011290     05  CR-TOT-CNSL-RECS-DELETED    PIC 9(13)     VALUE ZERO.    01129000
011300     05  CR-TOT-CNRL-RECS-DELETED    PIC 9(13)     VALUE ZERO.    01130000
011310     05  CR-TOT-RECS-SELECTED        PIC 9(13)     VALUE ZERO.    01131000
011320     05  CR-TOT-CNTK-RECS-SELECT     PIC 9(13)     VALUE ZERO.    01132000
011330     05  CR-TOT-CNPO-RECS-SELECT     PIC 9(13)     VALUE ZERO.    01133000
011340     05  CR-TOT-CNUP-RECS-SELECT     PIC 9(13)     VALUE ZERO.    01134000
011350     05  CR-TOT-CNCT-RECS-SELECT     PIC 9(13)     VALUE ZERO.    01135000
011360     05  CR-TOT-CNSL-RECS-SELECT     PIC 9(13)     VALUE ZERO.    01136000
011370     05  CR-TOT-CNRL-RECS-SELECT     PIC 9(13)     VALUE ZERO.    01137000
011380     05  CR-TOT-RECS-CHANGED         PIC 9(13)     VALUE ZERO.    01138000
011390     05  CR-TOT-CNTK-CHANGES         PIC 9(13)     VALUE ZERO.    01139000
011400     05  CR-TOT-CNPO-CHANGES         PIC 9(13)     VALUE ZERO.    01140000
011410     05  CR-TOT-CNUP-CHANGES         PIC 9(13)     VALUE ZERO.    01141000
011420     05  CR-TOT-CNCT-CHANGES         PIC 9(13)     VALUE ZERO.    01142000
011430     05  CR-TOT-CNSL-CHANGES         PIC 9(13)     VALUE ZERO.    01143000
011440     05  CR-TOT-RECS-CHANGED-B       PIC 9(13)     VALUE ZERO.    01144000
011450     05  CR-TOT-CNTK-CHANGES-B       PIC 9(13)     VALUE ZERO.    01145000
011460     05  CR-TOT-CNPO-CHANGES-B       PIC 9(13)     VALUE ZERO.    01146000
011470     05  CR-TOT-CNUP-CHANGES-B       PIC 9(13)     VALUE ZERO.    01147000
011480     05  CR-TOT-CNCT-CHANGES-B       PIC 9(13)     VALUE ZERO.    01148000
011490     05  CR-TOT-CNSL-CHANGES-B       PIC 9(13)     VALUE ZERO.    01149000
011500     05  CR-TOT-RECS-CHANGED-Z       PIC 9(13)     VALUE ZERO.    01150000
011510     05  CR-TOT-CNPO-CHANGES-Z       PIC 9(13)     VALUE ZERO.    01151000
011520     05  CR-TOT-CNUP-CHANGES-Z       PIC 9(13)     VALUE ZERO.    01152000
011530     05  CR-TOT-CNCT-CHANGES-Z       PIC 9(13)     VALUE ZERO.    01153000
011540     05  CR-TOT-CNSL-CHANGES-Z       PIC 9(13)     VALUE ZERO.    01154000
011550     05  CR-TOT-RECS-DELETED-E       PIC 9(13)     VALUE ZERO.    01155000
011560     05  CR-TOT-CNPO-DELETES-E       PIC 9(13)     VALUE ZERO.    01156000
011570     05  CR-TOT-CNUP-DELETES-E       PIC 9(13)     VALUE ZERO.    01157000
011580     05  CR-TOT-CNCT-DELETES-E       PIC 9(13)     VALUE ZERO.    01158000
011590     05  CR-TOT-CNSL-DELETES-E       PIC 9(13)     VALUE ZERO.    01159000
011600     05  CR-CREATE-ISARDA-SW         PIC  X(01)    VALUE 'Y'.     01160000
011610         88  CR-CREATE-ISARDA                      VALUE 'Y'.     01161000
011620         88  CR-CREATE-ISARDA-NO                   VALUE 'N'.     01162000
011630     05  CR-CREATE-ISARDD-SW         PIC  X(01)    VALUE 'Y'.     01163000
011640         88  CR-CREATE-ISARDD                      VALUE 'Y'.     01164000
011650         88  CR-CREATE-ISARDD-NO                   VALUE 'N'.     01165000
011660                                                                  01166000
011670*                                                                 01167000
011680*  CURSOR DECLARATION TO OBTAIN CONTAINER PO INFORMATION FOR      01168000
011690*  CONTAINER LEVEL DELETES                                        01169000
011700*                                                                 01170000
011710     EXEC SQL                                                     01171000
011720          DECLARE CONPO_CUR CURSOR FOR                            01172000
011730             SELECT CONTNR_ID,                                    01173000
011740                    CONTNR_SEQ_NBR,                               01174000
011750                    PO_NBR,                                       01175000
011760                    CSTM_ENTR_ID,                                 01176000
011770                    MSTR_BOL_NBR,                                 01177000
011780                    HSE_BOL_NBR,                                  01178000
011790                    LTR_OF_CR_NBR,                                01179000
011800                    PO_RCVD_DELY_TMST,                            01180000
011810                    PO_C_O_PROD_CDE,                              01181000
011820                    PO_CART_CNT,                                  01182000
011830                    PO_CBMT_QTY,                                  01183000
011840                    PO_WT_KGRM_QTY,                               01184000
011850                    PO_UNT_QTY,                                   01185000
011860                    CRE_BY_USR_ID,                                01186000
011870                    CRE_TMST,                                     01187000
011880                    LAST_UPD_BY_USR_ID,                           01188000
011890                    LAST_UPD_TMST,                                01189000
011900                    EXTL_REF_NBR,                                 01190000
011910                    BKR_FRGT_RLSE_CDE,                            01191000
011920                    DO_RCVD_CDE,                                  01192000
011930                    CONTNR_PU_CDE,                                01193000
011940                    ACTL_POE_DELY_CDE,                            01194000
011950                    DVN_CDE,                                      01195000
011960                    DCONSLR_RET_CDE,                              01196000
011970                    SPLT_XMIT_CDE,                                01197000
011980                    DOC_RCVD_ORGN_TMST                            01198000
011990               FROM TIMCNPO                                       01199000
012000              WHERE CONTNR_ID        = :TR023-CNTR-CONTNR-ID      01200000
012010                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    01201000
012020              WITH UR                                             01202000
012030      END-EXEC.                                                   01203000
012040                                                                  01204000
012050*                                                                 01205000
012060*  CURSOR DECLARATION TO OBTAIN CONTAINER PO INFORMATION FOR      01206000
012070*  CONTAINER LEVEL RECYCLE RECORDS                                01207000
012080*                                                                 01208000
012090     EXEC SQL                                                     01209000
012100          DECLARE RECYCLE_CUR CURSOR FOR                          01210000
012110             SELECT  C.DO_RCVD_TMST                               01211000
012120                    ,C.DCONSLR_SCAC_ID                            01212000
012130                    ,C.CONTNR_PU_TMST                             01213000
012140                    ,C.DVN_TMST                                   01214000
012150                    ,C.BKR_FRGT_RLSE_TMST                         01215000
012160                    ,C.DCONSLR_RET_TMST                           01216000
012170                    ,C.ACTL_POE_DELY_TMST                         01217000
012180                    ,C.ACTL_DEST_POE_CDE                          01218000
012190                    ,C.MOM_TRIP_TYP_CDE                           01219000
012200                    ,C.MOM_CARR_SCAC_ID                           01220000
012210                    ,C.MOM_IMPRT_TRIP_ID                          01221000
012220                    ,C.MOM_IMPRT_VEH_NM                           01222000
012230                    ,C.MOM_DEST_POE_CDE                           01223000
012240                    ,P.PO_NBR                                     01224000
012250                    ,P.EXTL_REF_NBR                               01225000
012260                    ,P.CONTNR_ID                                  01226000
012270                    ,COALESCE(P.BKR_FRGT_RLSE_CDE,' ')            01227000
012280                    ,COALESCE(P.DO_RCVD_CDE,' ')                  01228000
012290                    ,COALESCE(P.CONTNR_PU_CDE,' ')                01229000
012300                    ,COALESCE(P.ACTL_POE_DELY_CDE,' ')            01230000
012310                    ,COALESCE(P.DVN_CDE,' ')                      01231000
012320                    ,COALESCE(P.DCONSLR_RET_CDE,' ')              01232000
012330               FROM  TIMCNTK C                                    01233000
012340          LEFT JOIN  TIMCNPO P                                    01234000
012350                 ON  C.CONTNR_ID        = P.CONTNR_ID             01235000
012360                AND  C.CONTNR_SEQ_NBR   = P.CONTNR_SEQ_NBR        01236000
012370              WHERE  C.CONTNR_ID        = :TR023-CNTR-CONTNR-ID   01237000
012380                AND  C.CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR  01238000
012390            WITH UR                                               01239000
012400      END-EXEC.                                                   01240000
012410                                                                  01241000
012420*                                                                 01242000
012430*  CURSOR DECLARATION TO OBTAIN CONTAINER UPC INFORMATION FOR     01243000
012440*  CONTAINER LEVEL DELETES                                        01244000
012450*                                                                 01245000
012460     EXEC SQL                                                     01246000
012470          DECLARE CONUP_CUR CURSOR FOR                            01247000
012480             SELECT CONTNR_ID,                                    01248000
012490                    CONTNR_SEQ_NBR,                               01249000
012500                    PO_NBR,                                       01250000
012510                    UPC_NBR,                                      01251000
012520                    PO_LNE_NBR,                                   01252000
012530                    UPC_CART_CNT,                                 01253000
012540                    UPC_CBMT_QTY,                                 01254000
012550                    UPC_WT_KGRM_QTY,                              01255000
012560                    UPC_UNT_QTY,                                  01256000
012570                    CRE_BY_USR_ID,                                01257000
012580                    CRE_TMST,                                     01258000
012590                    LAST_UPD_BY_USR_ID,                           01259000
012600                    LAST_UPD_TMST,                                01260000
012610                    SKU_NBR,                                      01261000
012620                    ASN_PKGNG_CDE                                 01262000
012630               FROM TIMCNUP                                       01263000
012640              WHERE CONTNR_ID        = :TR023-CNTR-CONTNR-ID      01264000
012650                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    01265000
012660              WITH UR                                             01266000
012670     END-EXEC.                                                    01267000
012680                                                                  01268000
012690*                                                                 01269000
012700*  CURSOR DECLARATION TO OBTAIN CONTAINER CARTON INFORMATION FOR  01270000
012710*  CONTAINER LEVEL DELETES                                        01271000
012720*                                                                 01272000
012730     EXEC SQL                                                     01273000
012740          DECLARE CNCART_CUR CURSOR FOR                           01274000
012750             SELECT CONTNR_ID,                                    01275000
012760                    CONTNR_SEQ_NBR,                               01276000
012770                    PO_NBR,                                       01277000
012780                    UPC_NBR,                                      01278000
012790                    SSCC_ID,                                      01279000
012800                    CRE_BY_USR_ID,                                01280000
012810                    CRE_TMST,                                     01281000
012820                    UNT_QTY,                                      01282000
012830                    LAST_UPD_BY_USR_ID,                           01283000
012840                    LAST_UPD_TMST                                 01284000
012850               FROM TRT_IMPRT_CART                                01285000
012860              WHERE CONTNR_ID        = :TR023-CNTR-CONTNR-ID      01286000
012870                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    01287000
012880              WITH UR                                             01288000
012890     END-EXEC.                                                    01289000
012900                                                                  01290000
012910*                                                                 01291000
012920*  CURSOR DECLARATION TO OBTAIN CONTAINER SEAL INFORMATION FOR    01292000
012930*  CONTAINER LEVEL DELETES                                        01293000
012940*                                                                 01294000
012950     EXEC SQL                                                     01295000
012960          DECLARE CNSEAL_CUR CURSOR FOR                           01296000
012970             SELECT CONTNR_ID,                                    01297000
012980                    CONTNR_SEQ_NBR,                               01298000
012990                    SEAL_NBR,                                     01299000
013000                    CRE_TMST,                                     01300000
013010                    CRE_BY_USR_ID,                                01301000
013020                    LAST_UPD_TMST,                                01302000
013030                    LAST_UPD_BY_USR_ID                            01303000
013040               FROM TRT_IMPRT_SEAL                                01304000
013050              WHERE CONTNR_ID        = :TR023-CNTR-CONTNR-ID      01305000
013060                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    01306000
013070              WITH UR                                             01307000
013080     END-EXEC.                                                    01308000
013090                                                                  01309000
013100*                                                                 01310000
013110*  CURSOR DECLARATION TO OBTAIN PO, UPC, AND CARTON INFORMATION   01311000
013120*  FOR THE INTERNAL PO/UPC/CARTON TABLE.                          01312000
013130*                                                                 01313000
013140     EXEC SQL                                                     01314000
013150          DECLARE PO_UPC_CART_CUR CURSOR WITH HOLD FOR            01315000
013160             SELECT DISTINCT                                      01316000
013170                    A.PO_NBR                                      01317000
013180                   ,B.UPC_NBR                                     01318000
013190                   ,C.SSCC_ID                                     01319000
013200               FROM TIMCNPO  A                                    01320000
013210                LEFT OUTER JOIN                                   01321000
013220                    TIMCNUP  B                                    01322000
013230                     ON A.CONTNR_ID      =  B.CONTNR_ID           01323000
013240                    AND A.CONTNR_SEQ_NBR =  B.CONTNR_SEQ_NBR      01324000
013250                    AND A.PO_NBR         =  B.PO_NBR              01325000
013260                LEFT OUTER JOIN                                   01326000
013270                    TRT_IMPRT_CART C                              01327000
013280                     ON B.CONTNR_ID      =  C.CONTNR_ID           01328000
013290                    AND B.CONTNR_SEQ_NBR =  C.CONTNR_SEQ_NBR      01329000
013300                    AND B.PO_NBR         =  C.PO_NBR              01330000
013310                    AND B.UPC_NBR        =  C.UPC_NBR             01331000
013320              WHERE A.CONTNR_ID      = :IMCNTK-CONTNR-ID          01332000
013330                AND A.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR     01333000
013340           ORDER BY A.PO_NBR                                      01334000
013350                   ,B.UPC_NBR                                     01335000
013360                   ,C.SSCC_ID                                     01336000
013370     END-EXEC.                                                    01337000
013380                                                                  01338000
013390*                                                                 01339000
013400*  CURSOR DECLARATION TO OBTAIN UPC INFORMATION FOR THE INTERNAL  01340000
013410*  PO/UPC/CARTON TABLE.                                           01341000
013420*                                                                 01342000
013430     EXEC SQL                                                     01343000
013440          DECLARE UPC_CUR CURSOR WITH HOLD FOR                    01344000
013450             SELECT DISTINCT                                      01345000
013460                    A.CONTNR_ID,                                  01346000
013470                    A.CONTNR_SEQ_NBR,                             01347000
013480                    A.PO_NBR,                                     01348000
013490                    A.VS_NBR,                                     01349000
013500                    A.UPC_NBR,                                    01350000
013510                    A.PO_LNE_NBR,                                 01351000
013520                    A.UPC_CART_CNT,                               01352000
013530                    A.UPC_CBMT_QTY,                               01353000
013540                    A.UPC_WT_KGRM_QTY,                            01354000
013550                    A.UPC_UNT_QTY,                                01355000
013560                    A.CRE_BY_USR_ID,                              01356000
013570                    A.CRE_TMST,                                   01357000
013580                    A.LAST_UPD_BY_USR_ID,                         01358000
013590                    A.LAST_UPD_TMST,                              01359000
013600                    A.SKU_NBR,                                    01360000
013610                    A.ASN_PKGNG_CDE                               01361000
013620             FROM   TIMCNUP  A                                    01362000
013630            WHERE   A.CONTNR_ID       = :IMCNTK-CONTNR-ID         01363000
013640              AND   A.CONTNR_SEQ_NBR  = :IMCNTK-CONTNR-SEQ-NBR    01364000
013650              AND   A.PO_NBR          = :PV-CURSOR-PO-NBR         01365000
013660              ORDER BY A.PO_NBR,                                  01366000
013670                       A.UPC_NBR                                  01367000
013680     END-EXEC.                                                    01368000
013690                                                                  01369000
013700*                                                                 01370000
013710*  CURSOR DECLARATION TO OBTAIN CARTON INFORMATION FOR THE        01371000
013720*  INTERNAL PO/UPC/CARTON TABLE.                                  01372000
013730*                                                                 01373000
013740     EXEC SQL                                                     01374000
013750          DECLARE CARTON_CUR CURSOR WITH HOLD FOR                 01375000
013760             SELECT DISTINCT                                      01376000
013770                    A.CONTNR_ID,                                  01377000
013780                    A.CONTNR_SEQ_NBR,                             01378000
013790                    A.PO_NBR,                                     01379000
013800                    A.UPC_NBR,                                    01380000
013810                    A.SSCC_ID,                                    01381000
013820                    A.CRE_BY_USR_ID,                              01382000
013830                    A.CRE_TMST,                                   01383000
013840                    A.UNT_QTY,                                    01384000
013850                    A.LAST_UPD_BY_USR_ID,                         01385000
013860                    A.LAST_UPD_TMST                               01386000
013870             FROM   TRT_IMPRT_CART  A                             01387000
013880            WHERE   A.CONTNR_ID       = :IMCNTK-CONTNR-ID         01388000
013890              AND   A.CONTNR_SEQ_NBR  = :IMCNTK-CONTNR-SEQ-NBR    01389000
013900              AND   A.PO_NBR          = :PV-CURSOR-PO-NBR         01390000
013910              AND   A.UPC_NBR         = :PV-CURSOR-UPC-NBR        01391000
013920              ORDER BY A.PO_NBR,                                  01392000
013930                       A.UPC_NBR,                                 01393000
013940                       A.SSCC_ID                                  01394000
013950     END-EXEC.                                                    01395000
013960 EJECT                                                            01396000
013970                                                                  01397000
013980*  CURSOR DECLARATION TO OBTAIN CONTAINER SEAL INFORMATION FOR    01398000
013990*  THE INTERNAL CONTAINER SEAL TABLE.                             01399000
014000*                                                                 01400000
014010     EXEC SQL                                                     01401000
014020          DECLARE SEAL_CUR CURSOR WITH HOLD FOR                   01402000
014030             SELECT DISTINCT                                      01403000
014040                    A.SEAL_NBR                                    01404000
014050               FROM TRT_IMPRT_SEAL A                              01405000
014060              WHERE A.CONTNR_ID      = :IMCNTK-CONTNR-ID          01406000
014070                AND A.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR     01407000
014080           ORDER BY A.SEAL_NBR                                    01408000
014090     END-EXEC.                                                    01409000
014100                                                                  01410000
014110*---------------------------------------------------------------* 01411000
014120*    CURSOR DECLARATION FOR SELECTING POE CODE AIR              * 01412000
014130*---------------------------------------------------------------* 01413000
014140                                                                  01414000
014150     EXEC SQL                                                     01415000
014160          DECLARE  POE-CSR-AIR CURSOR                             01416000
014170              FOR  SELECT DISTINCT                                01417000
014180                   A.POE_CDE                                      01418000
014190             FROM  TIMPOE  A                                      01419000
014200            WHERE  A.STD_IATA_CDE  =  :PV-HOLD-POE-CDE            01420000
014210              AND  A.STAT_CDE      =  'A'                         01421000
014220         ORDER BY  POE_CDE                                        01422000
014230            WITH UR                                               01423000
014240     END-EXEC.                                                    01424000
014250                                                                  01425000
014260 EJECT                                                            01426000
014270*---------------------------------------------------------------* 01427000
014280*    CURSOR DECLARATION FOR SELECTING POE CODE OCEAN            * 01428000
014290*---------------------------------------------------------------* 01429000
014300                                                                  01430000
014310     EXEC SQL                                                     01431000
014320          DECLARE  POE-CSR-OCEAN CURSOR                           01432000
014330              FOR  SELECT DISTINCT                                01433000
014340                   A.POE_CDE                                      01434000
014350             FROM  TIMPOE  A                                      01435000
014360            WHERE  A.POE_STD_EDI_CDE  = :PV-HOLD-POE-CDE          01436000
014370              AND  A.STAT_CDE         = 'A'                       01437000
014380         ORDER BY  POE_CDE                                        01438000
014390            WITH UR                                               01439000
014400     END-EXEC.                                                    01440000
014410                                                                  01441000
014420 EJECT                                                            01442000
014430*---------------------------------------------------------------* 01443000
014440*    CURSOR DECLARATION FOR SELECTING POE CODE AIR - DECON      * 01444000
014450*---------------------------------------------------------------* 01445000
014460                                                                  01446000
014470     EXEC SQL                                                     01447000
014480          DECLARE  POE-CSR-AIR-DCN CURSOR                         01448000
014490              FOR  SELECT DISTINCT                                01449000
014500                   A.POE_CDE                                      01450000
014510             FROM  TIMPOE  A                                      01451000
014520            WHERE  A.STD_IATA_CDE  =  :PV-COMPARE-MOM-POE-CDE     01452000
014530              AND  A.STAT_CDE      =  'A'                         01453000
014540         ORDER BY  POE_CDE                                        01454000
014550            WITH UR                                               01455000
014560     END-EXEC.                                                    01456000
014570                                                                  01457000
014580 EJECT                                                            01458000
014590*---------------------------------------------------------------* 01459000
014600*    CURSOR DECLARATION FOR SELECTING POE CODE OCEAN - DECON    * 01460000
014610*---------------------------------------------------------------* 01461000
014620                                                                  01462000
014630     EXEC SQL                                                     01463000
014640          DECLARE  POE-CSR-OCEAN-DCN CURSOR                       01464000
014650              FOR  SELECT DISTINCT                                01465000
014660                   A.POE_CDE                                      01466000
014670             FROM  TIMPOE  A                                      01467000
014680            WHERE  A.POE_STD_EDI_CDE  = :PV-COMPARE-MOM-POE-CDE   01468000
014690              AND  A.STAT_CDE         = 'A'                       01469000
014700         ORDER BY  POE_CDE                                        01470000
014710            WITH UR                                               01471000
014720     END-EXEC.                                                    01472000
014730                                                                  01473000
014740 EJECT                                                            01474000
014750******************************************************************01475000
014760 LINKAGE SECTION.                                                 01476000
014770******************************************************************01477000
014780                                                                  01478000
014790******************************************************************01479000
014800 PROCEDURE DIVISION.                                              01480000
014810******************************************************************01481000
014820******************************************************************01482000
014830*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *01483000
014840******************************************************************01484000
014850 0000-PROGRAM-MAINLINE.                                           01485000
014860                                                                  01486000
014870     PERFORM 1000-INITIALIZE.                                     01487000
014880                                                                  01488000
014890     PERFORM 2000-PROCESS-CONT-RECORDS                            01489000
014900         UNTIL PS-END-OF-FILE.                                    01490000
014910                                                                  01491000
014920     PERFORM 8000-EOJ-ROUTINE.                                    01492000
014930     STOP RUN.                                                    01493000
014940                                                                  01494000
014950******************************************************************01495000
014960*  1000-INITIALIZE -  OPENS INPUT FILE, INITIALIZES FIELDS AND   *01496000
014970*  OTHER BEGINNING OF JOB PROCESSES.                             *01497000
014980******************************************************************01498000
014990 1000-INITIALIZE.                                                 01499000
015000                                                                  01500000
015010     OPEN INPUT TR023-CONTAINER-FILE.                             01501000
015020                                                                  01502000
015030     OPEN INPUT CONTROL-CARD-1.                                   01503000
015040     INITIALIZE CC-CONTROL-CARD-1.                                01504000
015050     READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1.                  01505000
015060     DISPLAY 'CONTROL CARD => ' CC-JOB-NAME.                      01506000
015070     CLOSE CONTROL-CARD-1.                                        01507000
015080                                                                  01508000
015090     PERFORM 4000-GET-CHECKPOINT-CNTL.                            01509000
015100     MOVE PV-CKPT-STAT-CODE TO PS-RUN-TYPE-SW.                    01510000
015110                                                                  01511000
015120     IF RESTART-RUN                                               01512000
015130         DISPLAY '****************'                               01513000
015140         DISPLAY '** RESTARTING **'                               01514000
015150         DISPLAY '****************'                               01515000
015160         PERFORM 4110-CHECKPOINT-RESTART                          01516000
015170     ELSE                                                         01517000
015180         PERFORM 1010-CONTINUE-INITIALIZE                         01518000
015190     END-IF.                                                      01519000
015200                                                                  01520000
015210     PERFORM 4020-SET-COMMIT-TIME.                                01521000
015220                                                                  01522000
015230******************************************************************01523000
015240* CONTINUE THE INITIALIZATION PROCESS.                           *01524000
015250******************************************************************01525000
015260 1010-CONTINUE-INITIALIZE.                                        01526000
015270                                                                  01527000
015280     SET PS-GOOD-RECORD-NO TO TRUE.                               01528000
015290                                                                  01529000
015300     PERFORM 5590-INIT-ARV-DELV-HOLD-FIELDS.                      01530000
015310                                                                  01531000
015320     PERFORM 5595-INIT-ARV-DELV-CDE-HOLD.                         01532000
015330                                                                  01533000
015340     PERFORM 6000-READ-CONTAINER-FILE                             01534000
015350         UNTIL PS-GOOD-RECORD OR                                  01535000
015360               PS-END-OF-FILE                                     01536000
015370     SET PS-GOOD-RECORD-NO TO TRUE.                               01537000
015380     INITIALIZE OUTTR5-CONTNR-RPTS-2-ODR.                         01538000
015390                                                                  01539000
015400 EJECT                                                            01540000
015410******************************************************************01541000
015420* MAIN PROCESSING PARAGRAPH.                                     *01542000
015430* THE INCOMING RECORD TYPE CODE IS EVALUATED AND PROCESSED AS    *01543000
015440* FOLLOWS:                                                       *01544000
015450*  REC-TYP-CNTR (CONSISTS OF CVYA OR CVYB, AND CONA & CONB ---   *01545000
015460*       WHICH ARE PASSED FROM EDIT PROGRAM AS 'CNTR' REC TYPE)   *01546000
015470*       THESE RECORD TYPES PERFORM THE CONTAINER LEVEL           *01547000
015480*       PROCESSING PARAGRAPHS (PARA 3000- THRU 3050-) DEPENDING  *01548000
015490*       ON WHAT TRANS TYPE THEY ARE (ADD, CHANGE, OR DELETE).    *01549000
015500*                                                                *01550000
015510*  REC-TYP-CONPO (CONSISTS OF CONPOA, CONPOB, & CONPOC ---       *01551000
015520*       WHICH ARE PASSED FROM EDIT PROGRAM AS 'CONPO' REC TYPE)  *01552000
015530*       THESE RECORD TYPES PERFORM THE PO LEVEL PROCESSING       *01553000
015540*       PARAGRAPHS (PARA 3100- THRU 3175-) DEPENDING ON WHAT     *01554000
015550*       TRANS TYPE THEY ARE (ADD, CHANGE, OR DELETE).            *01555000
015560*                                                                *01556000
015570*  REC-TYP-CONUPC (CONSISTS OF CONUPA, CONUPB, AND CONUPC ---    *01557000
015580*       WHICH ARE PASSED FROM EDIT PROGRAM AS 'CONUPC' REC TYPE) *01558000
015590*       THESE RECORD TYPES PERFORM THE UPC LEVEL PROCESSING      *01559000
015600*       PARAGRAPHS (PARA 3300- THRU 3375-) DEPENDING ON WHAT     *01560000
015610*       TRAN TYPE THEY ARE (ADD, CHANGE, OR DELETE).             *01561000
015620*                                                                *01562000
015630*  REC-TYP-CNCART -- THIS RECORD TYPE PERFORMS THE CONTAINER     *01563000
015640*       CARTON LEVEL PROCESSING PARAGRAPHS.                      *01564000
015650*                                                                *01565000
015660*  REC-TYP-CNSEAL -- THIS RECORD TYPE PERFORMS THE CONTAINER     *01566000
015670*       SEAL LEVEL PROCESSING PARAGRAPHS.                        *01567000
015680******************************************************************01568000
015690 2000-PROCESS-CONT-RECORDS.                                       01569000
015700                                                                  01570000
015710     MOVE TR023-CNTR-REC-TYP-CDE TO PV-REC-TYP-CDE.               01571000
015720                                                                  01572000
015730     EVALUATE TRUE                                                01573000
015740        WHEN PV-REC-TYP-CNTR                                      01574000
015750            SET PS-CHANGE-ADD-B-NO TO TRUE                        01575000
015760            SET PS-LOAD-PRINT-TABLE-NO TO TRUE                    01576000
015770            SET PS-LANDED-PO-NOT-IN-CONTNR TO TRUE                01577000
015780            SET PS-LANDED-PO-NOT-FOUND TO TRUE                    01578000
015790            SET PS-IMPORT-PO-NOT-IN-CONTNR TO TRUE                01579000
015800            PERFORM 3000-PROCESS-CNTR-REC                         01580000
015810                                                                  01581000
015820        WHEN PV-REC-TYP-CONPO                                     01582000
015830            PERFORM 3100-PROCESS-CONPO-REC                        01583000
015840                                                                  01584000
015850        WHEN PV-REC-TYP-CONUPC                                    01585000
015860            PERFORM 3300-PROCESS-CONUPC-REC                       01586000
015870                                                                  01587000
015880        WHEN PV-REC-TYP-CNCART                                    01588000
015890            PERFORM 3600-PROCESS-CNCART-REC                       01589000
015900                                                                  01590000
015910        WHEN PV-REC-TYP-CNSEAL                                    01591000
015920            PERFORM 3700-PROCESS-CNSEAL-REC                       01592000
015930     END-EVALUATE.                                                01593000
015940                                                                  01594000
015950     PERFORM 5507-CHECK-COMMIT-FIELDS.                            01595000
015960                                                                  01596000
015970     IF PS-NOT-SAME-COMMIT-FIELDS OR PS-END-OF-FILE               01597000
015980         IF PS-IMPORT-PO-IN-CONTNR                                01598000
015990             PERFORM 6215-UNLOAD-PRINT-TABLE                      01599000
016000         END-IF                                                   01600000
016010     END-IF.                                                      01601000
016020                                                                  01602000
016030     IF PS-NOT-SAME-COMMIT-FIELDS OR                              01603000
016040        PS-END-OF-FILE                                            01604000
016050         IF PV-HOLD-TRN-TYP = PC-C                                01605000
016060           IF PS-CHANGE-ADD-B                                     01606000
016070               SET PS-CHANGE-ADD-B-NO TO TRUE                     01607000
016080           ELSE                                                   01608000
016090               PERFORM 3400-TABLE-COMPARE-CHECK                   01609000
016100               PERFORM 3800-SEAL-TABLE-COMPARE-CHECK              01610000
016110           END-IF                                                 01611000
016120                                                                  01612000
016130           IF PS-CHANGE-FOUND-NO                                  01613000
016140               PERFORM 3490-NO-CHG-WRN-MSG                        01614000
016150           ELSE                                                   01615000
016160               SET PS-CHANGE-FOUND-NO TO TRUE                     01616000
016170           END-IF                                                 01617000
016180         END-IF                                                   01618000
016190                                                                  01619000
016200         PERFORM 4100-COMMIT-CHECK                                01620000
016210     END-IF.                                                      01621000
016220                                                                  01622000
016230******************************************************************01623000
016240* PROCESS THE CNTR CONTAINER LEVEL RECORD.                       *01624000
016250* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *01625000
016260******************************************************************01626000
016270 3000-PROCESS-CNTR-REC.                                           01627000
016280                                                                  01628000
016290     PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD.                        01629000
016300                                                                  01630000
016310     INITIALIZE PV-PRINT-TABLE.                                   01631000
016320     SET PRINT-INDX TO +1.                                        01632000
016330                                                                  01633000
016340     MOVE TR023-CNTR-TRN-TYP TO PV-TRN-TYP-CDE.                   01634000
016350                                                                  01635000
016360     EVALUATE TRUE                                                01636000
016370         WHEN PV-TRN-TYP-ADD                                      01637000
016380             PERFORM 3020-PROCESS-CNTR-ADD                        01638000
016390                                                                  01639000
016400         WHEN PV-TRN-TYP-CHG                                      01640000
016410             PERFORM 3010-PROCESS-CNTR-CHANGE                     01641000
016420                                                                  01642000
016430         WHEN PV-TRN-TYP-DEL                                      01643000
016440             PERFORM 3030-PROCESS-CNTR-DELETE                     01644000
016450             PERFORM 3035-CHECK-SPIN-FIELDS                       01645000
016460     END-EVALUATE.                                                01646000
016470                                                                  01647000
016480     IF PS-NEW-CONTAINER  OR                                      01648000
016490        PS-END-OF-FILE                                            01649000
016500         SET PS-NEW-CONTAINER-NO TO TRUE                          01650000
016510         SET PS-GOOD-RECORD-NO TO TRUE                            01651000
016520     ELSE                                                         01652000
016530         PERFORM 6000-READ-CONTAINER-FILE                         01653000
016540             UNTIL PS-GOOD-RECORD      OR                         01654000
016550                   PS-END-OF-FILE                                 01655000
016560         SET PS-GOOD-RECORD-NO TO TRUE                            01656000
016570     END-IF.                                                      01657000
016580                                                                  01658000
016590******************************************************************01659000
016600* PROCESS CNTR CHANGE TRANSACTIONS.                              *01660000
016610******************************************************************01661000
016620 3010-PROCESS-CNTR-CHANGE.                                        01662000
016630                                                                  01663000
016640     INITIALIZE PV-PO-UPC-CART-TABLE.                             01664000
016650     SET PO-INDX TO +1.                                           01665000
016660                                                                  01666000
016670     INITIALIZE PV-SEAL-TABLE.                                    01667000
016680     SET SEAL-INDX TO +1.                                         01668000
016690                                                                  01669000
016700     PERFORM 5600-FORMAT-ACTL-DPRTR-TMST.                         01670000
016710     PERFORM 7250-SELECT-TIMCNTK.                                 01671000
016720                                                                  01672000
016730     IF PS-CNTK-FOUND                                             01673000
016740         PERFORM 3012-CONTINUE-CNTR-CHANGE                        01674000
016750     ELSE                                                         01675000
016760         MOVE PC-WARNING           TO TR211-ERROR-TYPE            01676000
016770         MOVE TR023-CNTR-CONTNR-ID TO TR211-DATA-VALUE            01677000
016780         MOVE 'CONTAINER LEVEL'    TO TR211-DATA-IN-ERROR         01678000
016790         MOVE 'CHANGE SENT -- CONTNR NOT FOUND - CONTNR ADDED'    01679000
016800                                   TO TR211-ERROR-MSG             01680000
016810         SET PS-CHANGE-ADD-B TO TRUE                              01681000
016820         SET PS-CHANGE-FOUND TO TRUE                              01682000
016830         PERFORM 5800-LOAD-CVYA-TO-REPORT                         01683000
016840         ADD +1 TO PA-TOT-CNTK-CHANGES-B                          01684000
016850         ADD +1 TO PA-TOT-RECS-CHANGED-B                          01685000
016860         PERFORM 3020-PROCESS-CNTR-ADD                            01686000
016870     END-IF.                                                      01687000
016880                                                                  01688000
016890******************************************************************01689000
016900* PROCESS CNTR CHANGE TRANSACTIONS.                              *01690000
016910******************************************************************01691000
016920 3012-CONTINUE-CNTR-CHANGE.                                       01692000
016930                                                                  01693000
016940     PERFORM 7630-MOVE-TIMCNTK-TO-TAUCNTK.                        01694000
016950     SET PS-CHANGE-FOUND-CNTR-NO  TO TRUE.                        01695000
016960                                                                  01696000
016970     PERFORM 5520-MOVE-CNTR-TO-DCLGEN.                            01697000
016980                                                                  01698000
016990     PERFORM 3014-COMPARE-FOR-CNTR-CHANGES.                       01699000
017000     IF PS-CHANGE-FOUND-CNTR                                      01700000
017010         PERFORM 5660-MOVE-ARV-DELV-DCLGEN-FLDS                   01701000
017020         PERFORM 7155-DELETE-TIMCNTK-CHG                          01702000
017030         PERFORM 7050-INSERT-TAUCNTK                              01703000
017040         PERFORM 7100-SET-CURRENT-TMST                            01704000
017050         PERFORM 5670-MOVE-ARV-DELV-HOLD                          01705000
017060         MOVE IMCNTK-CONTNR-SEQ-NBR TO PV-HOLD-CONTNR-SEQ-NBR     01706000
017070         PERFORM 7000-INSERT-TIMCNTK                              01707000
017080         IF PS-GOOD-CNTK-INSERT                                   01708000
017090             PERFORM 5700-MOVE-CNTK-DETAIL                        01709000
017100             PERFORM 3900-BUILD-CONTNR-RULES-FILE                 01710000
017110         ELSE                                                     01711000
017120             PERFORM 3050-PROCESS-CONTAINER-ERROR                 01712000
017130                 UNTIL PS-NEW-CONTAINER  OR                       01713000
017140                       PS-END-OF-FILE                             01714000
017150         END-IF                                                   01715000
017160         ADD +1 TO PA-TOT-CNTK-CHANGES                            01716000
017170         ADD +1 TO PA-TOT-RECS-CHANGED                            01717000
017180     END-IF.                                                      01718000
017190                                                                  01719000
017200     PERFORM 5590-INIT-ARV-DELV-HOLD-FIELDS.                      01720000
017210                                                                  01721000
017220******************************************************************01722000
017230* COMPARE THE INPUT FIELDS THAT WERE LOADED INTO THE TIMCNTK     *01723000
017240* DCLGEN FIELDS AGAINST THE TIMCNTK FIELDS THAT WERE LOADED INTO *01724000
017250* THE TAUCNTK FIELDS TO SEE IF A CHANGE HAS OCCURRED.            *01725000
017260******************************************************************01726000
017270 3014-COMPARE-FOR-CNTR-CHANGES.                                   01727000
017280                                                                  01728000
017290     IF (AUCNTK-CONSLR-SCAC-ID     NOT EQUAL                      01729000
017300                                  IMCNTK-CONSLR-SCAC-ID)      OR  01730000
017310        (AUCNTK-MOM-IMPRT-TRIP-ID  NOT EQUAL                      01731000
017320                                  IMCNTK-MOM-IMPRT-TRIP-ID)   OR  01732000
017330        (AUCNTK-MOM-POE-DELY-TMST  NOT EQUAL                      01733000
017340                                  IMCNTK-MOM-POE-DELY-TMST)   OR  01734000
017350        (AUCNTK-MOM-CARR-SCAC-ID   NOT EQUAL                      01735000
017360                                  IMCNTK-MOM-CARR-SCAC-ID)    OR  01736000
017370        (AUCNTK-MOM-FOB-CDE        NOT EQUAL                      01737000
017380                                  IMCNTK-MOM-FOB-CDE)         OR  01738000
017390        (AUCNTK-MOM-IMPRT-VEH-NM   NOT EQUAL                      01739000
017400                                  IMCNTK-MOM-IMPRT-VEH-NM)    OR  01740000
017410        (AUCNTK-MOM-TRIP-TYP-CDE   NOT EQUAL                      01741000
017420                                  IMCNTK-MOM-TRIP-TYP-CDE)    OR  01742000
017430        (AUCNTK-MOM-DEST-POE-CDE   NOT EQUAL                      01743000
017440                                  IMCNTK-MOM-DEST-POE-CDE)    OR  01744000
017450        (AUCNTK-MOM-POR-CDE        NOT EQUAL                      01745000
017460                                  IMCNTK-MOM-POR-CDE)         OR  01746000
017470        (AUCNTK-MOM-POL-CDE        NOT EQUAL                      01747000
017480                                  IMCNTK-MOM-POL-CDE)         OR  01748000
017490        (AUCNTK-FDR-IMPRT-TRIP-ID  NOT EQUAL                      01749000
017500                                  IMCNTK-FDR-IMPRT-TRIP-ID)   OR  01750000
017510        (AUCNTK-FDR-DPRTR-TMST     NOT EQUAL                      01751000
017520                                  IMCNTK-FDR-DPRTR-TMST)      OR  01752000
017530        (AUCNTK-FDR-POE-DELY-TMST  NOT EQUAL                      01753000
017540                                  IMCNTK-FDR-POE-DELY-TMST)   OR  01754000
017550        (AUCNTK-FDR-CARR-SCAC-ID   NOT EQUAL                      01755000
017560                                  IMCNTK-FDR-CARR-SCAC-ID)    OR  01756000
017570        (AUCNTK-FDR-FOB-CDE        NOT EQUAL                      01757000
017580                                  IMCNTK-FDR-FOB-CDE)         OR  01758000
017590        (AUCNTK-FDR-IMPRT-VEH-NM   NOT EQUAL                      01759000
017600                                  IMCNTK-FDR-IMPRT-VEH-NM)    OR  01760000
017610        (AUCNTK-FDR-TRIP-TYP-CDE   NOT EQUAL                      01761000
017620                                  IMCNTK-FDR-TRIP-TYP-CDE)    OR  01762000
017630        (AUCNTK-FDR-DEST-POE-CDE   NOT EQUAL                      01763000
017640                                  IMCNTK-FDR-DEST-POE-CDE)    OR  01764000
017650        (AUCNTK-FDR-POR-CDE        NOT EQUAL                      01765000
017660                                  IMCNTK-FDR-POR-CDE)         OR  01766000
017670        (AUCNTK-FDR-POL-CDE        NOT EQUAL                      01767000
017680                                  IMCNTK-FDR-POL-CDE)         OR  01768000
017690        (AUCNTK-SIZE-CDE           NOT EQUAL                      01769000
017700                                  IMCNTK-SIZE-CDE)            OR  01770000
017710        (AUCNTK-CART-CNT           NOT EQUAL                      01771000
017720                                  IMCNTK-CART-CNT)            OR  01772000
017730        (AUCNTK-CBMT-QTY           NOT EQUAL                      01773000
017740                                  IMCNTK-CBMT-QTY)            OR  01774000
017750        (AUCNTK-WT-KGRM-QTY        NOT EQUAL                      01775000
017760                                  IMCNTK-WT-KGRM-QTY)         OR  01776000
017770        (AUCNTK-UNT-QTY            NOT EQUAL                      01777000
017780                                  IMCNTK-UNT-QTY)             OR  01778000
017790        (AUCNTK-ORGN-SHPD-FR-CDE   NOT EQUAL                      01779000
017800                                  IMCNTK-ORGN-SHPD-FR-CDE)    OR  01780000
017810        (AUCNTK-ORGN-SHPD-TO-CDE   NOT EQUAL                      01781000
017820                                  IMCNTK-ORGN-SHPD-TO-CDE)    OR  01782000
017830        (AUCNTK-EST-LBD-NM         NOT EQUAL                      01783000
017840                                  IMCNTK-EST-LBD-NM)          OR  01784000
017850        (AUCNTK-EST-LBD-TMST       NOT EQUAL                      01785000
017860                                  IMCNTK-EST-LBD-TMST)        OR  01786000
017870        (AUCNTK-DAT-SRC-ENT-ID     NOT EQUAL                      01787000
017880                                  IMCNTK-DAT-SRC-ENT-ID)          01788000
017890        SET PS-CHANGE-FOUND-CNTR TO TRUE                          01789000
017900        SET PS-CHANGE-FOUND      TO TRUE                          01790000
017910     END-IF.                                                      01791000
017920* THIS SWITCH DETERMINES WHETHER THE SPLIT_XMIT_CDE ON THE        01792000
017930* TIMCNPO WILL BE RESET WHEN THE PO'S FOR THIS CONTAINER ARE      01793000
017940* PROCESSED ALONG WITH THE DCONSLR_RLSE_CDE ON THE TIMCNRL.       01794000
017950* CHANGES TO FIELDS AT THE CONPO AND UPC LEVEL COULD ALSO         01795000
017960* TRIGGER A RESET OF THESE FIELDS.                                01796000
017970     SET PS-DONT-RESET-DC-SPLIT-CNTR TO TRUE.                     01797000
017980     IF (AUCNTK-MOM-IMPRT-TRIP-ID  NOT EQUAL                      01798000
017990                                  IMCNTK-MOM-IMPRT-TRIP-ID)   OR  01799000
018000        (AUCNTK-MOM-POE-DELY-TMST  NOT EQUAL                      01800000
018010                                  IMCNTK-MOM-POE-DELY-TMST)   OR  01801000
018020        (AUCNTK-MOM-CARR-SCAC-ID   NOT EQUAL                      01802000
018030                                  IMCNTK-MOM-CARR-SCAC-ID)    OR  01803000
018040        (AUCNTK-MOM-IMPRT-VEH-NM   NOT EQUAL                      01804000
018050                                  IMCNTK-MOM-IMPRT-VEH-NM)    OR  01805000
018060        (AUCNTK-MOM-TRIP-TYP-CDE   NOT EQUAL                      01806000
018070                                  IMCNTK-MOM-TRIP-TYP-CDE)    OR  01807000
018080        (AUCNTK-MOM-DEST-POE-CDE   NOT EQUAL                      01808000
018090                                  IMCNTK-MOM-DEST-POE-CDE)    OR  01809000
018100        (AUCNTK-SIZE-CDE           NOT EQUAL                      01810000
018110                                  IMCNTK-SIZE-CDE)                01811000
018120        SET PS-RESET-DC-SPLIT-CNTR TO TRUE                        01812000
018130     END-IF.                                                      01813000
018140                                                                  01814000
018150* THIS SWITCH DETERMINES WHETHER A DELETE AND RE-ADD OF SAILED    01815000
018160* (AND POSSIBLY DOCS RECEIVE) SCM MESSAGES NEEDS TO CREATED.      01816000
018170     SET PS-ORGN-CODE-NOT-CHANGED    TO TRUE.                     01817000
018180     IF (AUCNTK-ORGN-SHPD-FR-CDE   NOT EQUAL                      01818000
018190                                  IMCNTK-ORGN-SHPD-FR-CDE)        01819000
018200        MOVE AUCNTK-ORGN-SHPD-FR-CDE                              01820000
018210             TO PV-PREV-ORGN-SHPD-FR-CDE                          01821000
018220        SET PS-ORGN-CODE-CHANGED TO TRUE                          01822000
018230     END-IF.                                                      01823000
018240                                                                  01824000
018250******************************************************************01825000
018260* PROCESS CNTR CONTAINER RECORD ADD TRANSACTIONS.                *01826000
018270******************************************************************01827000
018280 3020-PROCESS-CNTR-ADD.                                           01828000
018290                                                                  01829000
018300     PERFORM 5600-FORMAT-ACTL-DPRTR-TMST.                         01830000
018310     PERFORM 7250-SELECT-TIMCNTK.                                 01831000
018320     IF PS-CNTK-FOUND                                             01832000
018330         SET PS-CNTK-PREV-SENT-ERR TO TRUE                        01833000
018340         MOVE PC-ERROR    TO TR211-ERROR-TYPE                     01834000
018350         MOVE 'CONTNR ID' TO TR211-DATA-IN-ERROR                  01835000
018360         MOVE TR023-CNTR-CONTNR-ID                                01836000
018370                          TO TR211-DATA-VALUE                     01837000
018380         MOVE 'ADD SENT, CONTNR PREVIOUSLY SENT-NOT PROCESSED'    01838000
018390                          TO TR211-ERROR-MSG                      01839000
018400         SET PS-EDI-RECORD-NO TO TRUE                             01840000
018410         PERFORM 3050-PROCESS-CONTAINER-ERROR                     01841000
018420             UNTIL PS-NEW-CONTAINER  OR                           01842000
018430                   PS-END-OF-FILE                                 01843000
018440         SET PS-CNTK-PREV-SENT-ERR-NO TO TRUE                     01844000
018450     ELSE                                                         01845000
018460         INITIALIZE DCLTIMCNTK                                    01846000
018470         PERFORM 7100-SET-CURRENT-TMST                            01847000
018480         MOVE PV-CURRENT-TMST TO IMCNTK-CRE-TMST                  01848000
018490         PERFORM 5520-MOVE-CNTR-TO-DCLGEN                         01849000
018500         PERFORM 5670-MOVE-ARV-DELV-HOLD                          01850000
018510         PERFORM 7290-SELECT-CONTNR-SEQ-NBR-MAX                   01851000
018520         MOVE PV-CONTNR-SEQ-NBR-MAX TO PV-HOLD-CONTNR-SEQ-NBR     01852000
018530         PERFORM 7000-INSERT-TIMCNTK                              01853000
018540         IF PS-GOOD-CNTK-INSERT                                   01854000
018550             PERFORM 5700-MOVE-CNTK-DETAIL                        01855000
018560             PERFORM 3900-BUILD-CONTNR-RULES-FILE                 01856000
018570         ELSE                                                     01857000
018580             PERFORM 3050-PROCESS-CONTAINER-ERROR                 01858000
018590                 UNTIL PS-NEW-CONTAINER  OR                       01859000
018600                       PS-END-OF-FILE                             01860000
018610         END-IF                                                   01861000
018620     END-IF.                                                      01862000
018630                                                                  01863000
018640******************************************************************01864000
018650* ALL DELETE PROCESSING IS PERFORMED FROM THE CONTAINER LEVEL.   *01865000
018660* ALL LEVELS FOR A CONTAINER ARE DELETED TOGETHER.  AUDITING IS  *01866000
018670* DONE AT ALL THE LEVELS BEFORE THE DELETE FOR THAT LEVEL OCCURS.*01867000
018680* CURSORS ARE USED FOR DELETING THE PO AND UPC LEVELS.           *01868000
018690******************************************************************01869000
018700 3030-PROCESS-CNTR-DELETE.                                        01870000
018710                                                                  01871000
018720     PERFORM 5600-FORMAT-ACTL-DPRTR-TMST.                         01872000
018730     PERFORM 7250-SELECT-TIMCNTK.                                 01873000
018740     IF PS-CNTK-FOUND                                             01874000
018750         PERFORM 7630-MOVE-TIMCNTK-TO-TAUCNTK                     01875000
018760         PERFORM 7050-INSERT-TAUCNTK                              01876000
018770         PERFORM 5665-SET-ARVL-DELV-WNG-MSGS                      01877000
018780         PERFORM 7288-SELECT-CONTNR-SEQ-NBR                       01878000
018790         PERFORM 7570-OPEN-RECYCLE-CURSOR                         01879000
018800         PERFORM 3135-PROCESS-RECYCLE-CREATE                      01880000
018810             UNTIL PS-EOC-RECYCLE-CURSOR                          01881000
018820         SET PS-EOC-RECYCLE-CURSOR-NO TO TRUE                     01882000
018830         PERFORM 7150-DELETE-TIMCNTK                              01883000
018840         PERFORM 3060-SCM-CNTR-DELETE                             01884000
018850                                                                  01885000
018860         IF PS-GOOD-CNTK-DELETE                                   01886000
018870          IF TR023-CNTR-TRN-TYP = PC-D                            01887000
018880              MOVE TR023-CNTR-CONTNR-ID TO TR211-CONTNR-ID        01888000
018890              MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM TO               01889000
018900                         TR211-ACTL-DPRTR-DTE-MOM                 01890000
018910              MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM  TO               01891000
018920                         TR211-ACTL-DPRTR-TM-MOM                  01892000
018930              MOVE TR023-CNTR-TRN-TYP   TO TR211-TRN-TYP          01893000
018940              MOVE TR023-CNTR-DAT-SRC-ENT-ID     TO               01894000
018950                                           TR211-DAT-SRC-ENT-ID   01895000
018960              MOVE SPACES               TO TR211-DATA-IN-ERROR    01896000
018970                                           TR211-DATA-VALUE       01897000
018980                                           TR211-ERROR-TYPE       01898000
018990                                           TR211-ERROR-MSG        01899000
019000                                           TR211-REC-TYP-CVYA     01900000
019010              MOVE PC-CVYA              TO TR211-REC-TYP-CVYA-CDE 01901000
019020              MOVE TR023-CNTR-SEQ-NBR   TO TR211-SEQ-NBR-CVYA     01902000
019030              MOVE TR023-CNTR-PROCESS-SEQ-NBR-1                   01903000
019040                                        TO TR211-PROCESS-SEQ-NBR  01904000
019050              PERFORM 6200-WRITE-LOAD-REPORT                      01905000
019060              PERFORM 3040-CHECK-DELV-ARV-WNG-MSG                 01906000
019070              PERFORM 3900-BUILD-CONTNR-RULES-FILE                01907000
019080          END-IF                                                  01908000
019090         END-IF                                                   01909000
019100         PERFORM 7300-OPEN-CONPO-CURSOR                           01910000
019110         PERFORM 3130-PROCESS-CONPO-DELETE                        01911000
019120             UNTIL PS-EOC-CONPO-CURSOR                            01912000
019130         SET PS-EOC-CONPO-CURSOR-NO TO TRUE                       01913000
019140     ELSE                                                         01914000
019150         MOVE PC-ERROR             TO TR211-ERROR-TYPE            01915000
019160         MOVE TR023-CNTR-CONTNR-ID TO TR211-DATA-VALUE            01916000
019170         MOVE 'CONTAINER LEVEL'    TO TR211-DATA-IN-ERROR         01917000
019180         MOVE 'DELETE SENT -CONTNR NOT FOUND - NOT DELETED'       01918000
019190                                   TO TR211-ERROR-MSG             01919000
019200         PERFORM 5800-LOAD-CVYA-TO-REPORT                         01920000
019210     END-IF.                                                      01921000
019220                                                                  01922000
019230     SET PS-DELETE-DELV-ARV-MSG-NO TO TRUE.                       01923000
019240     SET PS-DELETE-DELV-MSG-NO     TO TRUE.                       01924000
019250     SET PS-DELETE-ARV-MSG-NO      TO TRUE.                       01925000
019260                                                                  01926000
019270******************************************************************01927000
019280* ON A DELETE CHECK INPUT FIELDS TO SEE IF RECORDS NEED TO       *01928000
019290* BE BYPASSED ON READ.                                           *01929000
019300* THE DELETE PROCESSING DELETES ALL LEVELS FOR A CONTAINER BY    *01930000
019310* ONLY READING THE TRANSACTIONS FIRST RECORD.  ONCE IT IS        *01931000
019320* FINISHED DELETING THE CONTAINER, WE NEED TO SPIN PAST THE REST *01932000
019330* OF THE DELETED CONTAINER'S RECORDS TO GET TO THE NEXT CONTAINER*01933000
019340******************************************************************01934000
019350 3035-CHECK-SPIN-FIELDS.                                          01935000
019360                                                                  01936000
019370     IF TR023-CNTR-CONTNR-ID          =  PV-HOLD-CONTNR-ID   AND  01937000
019380        TR023-CNTR-ACTL-DPRTR-DTE-MOM =                           01938000
019390                                  PV-HOLD-ACTL-DPRTR-DTE-MOM AND  01939000
019400        TR023-CNTR-ACTL-DPRTR-TM-MOM  =                           01940000
019410                                  PV-HOLD-ACTL-DPRTR-TM-MOM  AND  01941000
019420        PV-HOLD-TRN-TYP               =  PC-D                     01942000
019430         SET PS-EDI-RECORD-NO TO TRUE                             01943000
019440         PERFORM 6000-READ-CONTAINER-FILE                         01944000
019450             UNTIL TR023-CNTR-CONTNR-ID           NOT =           01945000
019460                         PV-HOLD-CONTNR-ID              OR        01946000
019470                   TR023-CNTR-ACTL-DPRTR-DTE-MOM  NOT =           01947000
019480                         PV-HOLD-ACTL-DPRTR-DTE-MOM     OR        01948000
019490                   TR023-CNTR-ACTL-DPRTR-TM-MOM   NOT =           01949000
019500                         PV-HOLD-ACTL-DPRTR-TM-MOM      OR        01950000
019510                   TR023-CNTR-TRN-TYP             NOT =           01951000
019520                         PV-HOLD-TRN-TYP                OR        01952000
019530                   PS-EDI-RECORD                        OR        01953000
019540                   PS-END-OF-FILE                                 01954000
019550         SET PS-GOOD-RECORD-NO TO TRUE                            01955000
019560         SET PS-NEW-CONTAINER  TO TRUE                            01956000
019570     END-IF.                                                      01957000
019580                                                                  01958000
019590     IF PS-EDI-RECORD AND PS-END-OF-FILE-NO                       01959000
019600         PERFORM 6000-READ-CONTAINER-FILE                         01960000
019610             UNTIL PS-GOOD-RECORD OR PS-END-OF-FILE               01961000
019620     END-IF.                                                      01962000
019630                                                                  01963000
019640******************************************************************01964000
019650* CHECK THE DELIVERY ORDER AND ARRIVAL WARNING MESSAGE SWITCHES  *01965000
019660* TO SEE IF A WARNING MESSAGE SHOULD BE PRINTED.                 *01966000
019670******************************************************************01967000
019680 3040-CHECK-DELV-ARV-WNG-MSG.                                     01968000
019690                                                                  01969000
019700     EVALUATE TRUE                                                01970000
019710         WHEN PS-DELETE-DELV-ARV-MSG                              01971000
019720           IF PS-LANDED-PO-NOT-FOUND                              01972000
019730             MOVE PC-WARNING           TO TR211-ERROR-TYPE        01973000
019740             MOVE TR023-CNTR-CONTNR-ID TO TR211-DATA-VALUE        01974000
019750             MOVE 'CONTAINER LEVEL'    TO TR211-DATA-IN-ERROR     01975000
019760             MOVE 'DELETED CONTAINER, DELIVERY & ARRIVAL RECYCLED'01976000
019770                                       TO TR211-ERROR-MSG         01977000
019780             PERFORM 5800-LOAD-CVYA-TO-REPORT                     01978000
019790           END-IF                                                 01979000
019800                                                                  01980000
019810         WHEN PS-DELETE-DELV-MSG                                  01981000
019820             MOVE PC-WARNING           TO TR211-ERROR-TYPE        01982000
019830             MOVE TR023-CNTR-CONTNR-ID TO TR211-DATA-VALUE        01983000
019840             MOVE 'CONTAINER LEVEL'    TO TR211-DATA-IN-ERROR     01984000
019850             MOVE 'DELETED CONTAINER, DELIVERY RECYCLED'          01985000
019860                                       TO TR211-ERROR-MSG         01986000
019870             PERFORM 5800-LOAD-CVYA-TO-REPORT                     01987000
019880                                                                  01988000
019890         WHEN PS-DELETE-ARV-MSG                                   01989000
019900           IF PS-LANDED-PO-NOT-FOUND                              01990000
019910             MOVE PC-WARNING           TO TR211-ERROR-TYPE        01991000
019920             MOVE TR023-CNTR-CONTNR-ID TO TR211-DATA-VALUE        01992000
019930             MOVE 'CONTAINER LEVEL'    TO TR211-DATA-IN-ERROR     01993000
019940             MOVE 'DELETED CONTAINER, ARRIVAL RECYCLED'           01994000
019950                                       TO TR211-ERROR-MSG         01995000
019960             PERFORM 5800-LOAD-CVYA-TO-REPORT                     01996000
019970           END-IF                                                 01997000
019980     END-EVALUATE.                                                01998000
019990                                                                  01999000
020000                                                                  02000000
020010******************************************************************02001000
020020* THERE WAS A CONTAINER LEVEL ERROR -- BYPASS THE PO AND UPC     *02002000
020030* RECORDS THAT ARE RELATED TO THIS CONTAINER NUMBER.             *02003000
020040******************************************************************02004000
020050 3050-PROCESS-CONTAINER-ERROR.                                    02005000
020060                                                                  02006000
020070     IF PS-EDI-RECORD-NO                                          02007000
020080         PERFORM 3500-CHECK-MOVE-TO-REPORT                        02008000
020090     END-IF.                                                      02009000
020100                                                                  02010000
020110     PERFORM 6000-READ-CONTAINER-FILE.                            02011000
020120                                                                  02012000
020130     IF PS-EDI-RECORD                                             02013000
020140         CONTINUE                                                 02014000
020150     ELSE                                                         02015000
020160         IF (TR023-CNTR-CONTNR-ID          NOT EQUAL              02016000
020170             PV-HOLD-CONTNR-ID)                   OR              02017000
020180            (TR023-CNTR-ACTL-DPRTR-DTE-MOM NOT EQUAL              02018000
020190             PV-HOLD-ACTL-DPRTR-DTE-MOM)          OR              02019000
020200            (TR023-CNTR-ACTL-DPRTR-TM-MOM  NOT EQUAL              02020000
020210             PV-HOLD-ACTL-DPRTR-TM-MOM)           OR              02021000
020220            (TR023-CNTR-TRN-TYP            NOT EQUAL              02022000
020230             PV-HOLD-TRN-TYP)                                     02023000
020240              SET PS-NEW-CONTAINER TO TRUE                        02024000
020250              PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD                02025000
020260         END-IF                                                   02026000
020270     END-IF.                                                      02027000
020280                                                                  02028000
020290******************************************************************02029000
020300* ADD CONTAINER 'DELETE'  REC TO DB2 WORKTABLE TRTW_CONTNR_CKPR  *02030000
020310* TO EVENTUALLY BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES. *02031000
020320******************************************************************02032000
020330 3060-SCM-CNTR-DELETE.                                            02033000
020340     INITIALIZE TR405-MESSAGE-LAYOUT.                             02034000
020350     MOVE 'D'                        TO TR405-ACTN-CDE.           02035000
020360     MOVE 'CONTNR DELETED'           TO TR405-EVENT-TYP.          02036000
020370     MOVE ZERO                       TO TR405-PO-NBR.             02037000
020380     MOVE TR023-CONPO-CONTNR-ID      TO TR405-CONTNR-ID.          02038000
020390     MOVE IMCNTK-CONTNR-SEQ-NBR      TO TR405-CONTNR-SEQ-NBR.     02039000
020400     MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT.        02040000
020410     PERFORM 7099-INSERT-SCM-MESSAGE.                             02041000
020420                                                                  02042000
020430******************************************************************02043000
020440* PROCESS THE CONPO CONTAINER PURCHASE ORDER LEVEL RECORDS.      *02044000
020450* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *02045000
020460******************************************************************02046000
020470 3100-PROCESS-CONPO-REC.                                          02047000
020480                                                                  02048000
020490     PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD.                        02049000
020500                                                                  02050000
020510     MOVE TR023-CONPO-PO-NBR TO PV-SELECT-PO-NBR.                 02051000
020520     MOVE TR023-CONPO-EXTL-REF-NBR                                02052000
020530                             TO PV-HOLD-CONPO-EXTL-REF-NBR.       02053000
020540                                                                  02054000
020550     PERFORM 7097-SELECT-PO-TYP-CDE.                              02055000
020560     IF PURCHS-PO-TYP-CDE EQUAL                                   02056000
020580                  ('IM' OR 'IE' OR 'IF' OR 'LD' OR 'LE')          02058012
020590         CONTINUE                                                 02059000
020600     ELSE                                                         02060000
020610         MOVE PC-WARNING           TO TR211-ERROR-TYPE            02061000
020620         MOVE TR023-CONPO-PO-NBR   TO TR211-DATA-VALUE            02062000
020630         MOVE 'PO LEVEL'           TO TR211-DATA-IN-ERROR         02063000
020640         MOVE 'PO IS DOMESTIC'     TO TR211-ERROR-MSG             02064000
020650         PERFORM 5820-LOAD-CONPOA-TO-REPORT                       02065000
020660     END-IF.                                                      02066000
020670                                                                  02067000
020680     MOVE TR023-CONPO-TRN-TYP TO PV-TRN-TYP-CDE.                  02068000
020690                                                                  02069000
020700     EVALUATE TRUE                                                02070000
020710         WHEN PV-TRN-TYP-ADD                                      02071000
020720             PERFORM 3120-PROCESS-CONPO-ADD                       02072000
020730                                                                  02073000
020740         WHEN PV-TRN-TYP-CHG                                      02074000
020750             PERFORM 3110-PROCESS-CONPO-CHANGE                    02075000
020760     END-EVALUATE.                                                02076000
020770                                                                  02077000
020780     IF PS-NEW-PO   OR                                            02078000
020790        PS-END-OF-FILE                                            02079000
020800         SET PS-NEW-PO-NO      TO TRUE                            02080000
020810         SET PS-GOOD-RECORD-NO TO TRUE                            02081000
020820     ELSE                                                         02082000
020830         PERFORM 6000-READ-CONTAINER-FILE                         02083000
020840             UNTIL PS-GOOD-RECORD      OR                         02084000
020850                   PS-END-OF-FILE                                 02085000
020860         SET PS-GOOD-RECORD-NO TO TRUE                            02086000
020870     END-IF.                                                      02087000
020880                                                                  02088000
020890******************************************************************02089000
020900* PROCESS CONPO CHANGE TRANSACTIONS.                             *02090000
020910******************************************************************02091000
020920 3110-PROCESS-CONPO-CHANGE.                                       02092000
020930                                                                  02093000
020940     PERFORM 7255-SELECT-TIMCNPO.                                 02094000
020950                                                                  02095000
020960     IF PS-CNPO-FOUND                                             02096000
020970         PERFORM 3112-CONTINUE-CONPO-CHANGE                       02097000
020980     ELSE                                                         02098000
020990         IF PS-CNTK-FOUND                                         02099000
021000*            MOVE PC-WARNING           TO TR211-ERROR-TYPE        02100000
021010*            MOVE TR023-CONPO-PO-NBR   TO TR211-DATA-VALUE        02101000
021020*            MOVE 'PO LEVEL'           TO TR211-DATA-IN-ERROR     02102000
021030*            MOVE 'CHANGE SENT - PO NOT FOUND - PO ADDED'         02103000
021040*                                      TO TR211-ERROR-MSG         02104000
021050             SET PS-CHANGE-ADD-Z       TO TRUE                    02105000
021060*            PERFORM 5820-LOAD-CONPOA-TO-REPORT                   02106000
021070             ADD +1 TO PA-TOT-CNPO-CHANGES-Z                      02107000
021080             ADD +1 TO PA-TOT-RECS-CHANGED-Z                      02108000
021090         ELSE                                                     02109000
021100             SET PS-CHANGE-ADD-B       TO TRUE                    02110000
021110             ADD +1 TO PA-TOT-CNPO-CHANGES-B                      02111000
021120             ADD +1 TO PA-TOT-RECS-CHANGED-B                      02112000
021130         END-IF                                                   02113000
021140         SET PS-CHANGE-FOUND TO TRUE                              02114000
021150         PERFORM 7288-SELECT-CONTNR-SEQ-NBR                       02115000
021160         PERFORM 3120-PROCESS-CONPO-ADD                           02116000
021170         IF PS-CHANGE-ADD-B-NO                                    02117000
021180             PERFORM 3116-LOAD-PO-UPC-TABLE-PO                    02118000
021190         END-IF                                                   02119000
021200         SET PS-CHANGE-ADD-Z-NO TO TRUE                           02120000
021210     END-IF.                                                      02121000
021220                                                                  02122000
021230******************************************************************02123000
021240* PROCESS CONPO CHANGE TRANSACTIONS.                             *02124000
021250******************************************************************02125000
021260 3112-CONTINUE-CONPO-CHANGE.                                      02126000
021270                                                                  02127000
021280     PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO.                        02128000
021290                                                                  02129000
021300                                                                  02130000
021310     SET PS-CHANGE-FOUND-PO-NO TO TRUE.                           02131000
021320                                                                  02132000
021330     PERFORM 3175-TPURCHS-EDITS.                                  02133000
021340     PERFORM 5530-MOVE-CONPO-TO-DCLGEN.                           02134000
021350                                                                  02135000
021360     SET PS-DONT-RESET-DC-SPLIT-DETL TO TRUE.                     02136000
021370     PERFORM 3114-COMPARE-FOR-CONPO-CHANGES.                      02137000
021380* IF A CHANGE WAS MADE TO THE IMCNTK-ORGN-SHPD-FR-CDE THE         02138000
021390* PROGRAM WILL CREATE A DELETE RELATIONSHIP FOR THIS PO           02139000
021400* FOR THE OLD ORGN CODE AND AN ADD OF CONTAINER SAILED (AND       02140000
021410* POSSIBLY DOCS RECEIVED) FOR THE NEW ORGN CODE.                  02141000
021420     IF PS-ORGN-CODE-CHANGED                                      02142000
021430       AND PS-CHANGE-FOUND-PO-NO                                  02143000
021440         MOVE PV-CURRENT-TMST       TO IMCNPO-LAST-UPD-TMST       02144000
021450         PERFORM 5680-MOVE-ARV-DELV-CDE-HOLD                      02145000
021460         PERFORM 7288-SELECT-CONTNR-SEQ-NBR                       02146000
021470         MOVE IMCNPO-CONTNR-SEQ-NBR TO PV-HOLD-CONTNR-SEQ-NBR     02147000
021480         PERFORM 7330-SELECT-FOR-CNPO-ENTR-ID                     02148000
021490         PERFORM 3126-SCM-CONPO-CHANGE.                           02149000
021500     IF PS-CHANGE-FOUND-PO                                        02150000
021510         PERFORM 5675-MOVE-ARV-DELV-CDE-FIELDS                    02151000
021520         PERFORM 7165-DELETE-TIMCNPO-CHG                          02152000
021530         PERFORM 7060-INSERT-TAUCNPO                              02153000
021540         PERFORM 7100-SET-CURRENT-TMST                            02154000
021550         MOVE PV-CURRENT-TMST       TO IMCNPO-LAST-UPD-TMST       02155000
021560         PERFORM 5680-MOVE-ARV-DELV-CDE-HOLD                      02156000
021570         PERFORM 7288-SELECT-CONTNR-SEQ-NBR                       02157000
021580         MOVE IMCNPO-CONTNR-SEQ-NBR TO PV-HOLD-CONTNR-SEQ-NBR     02158000
021590         PERFORM 7330-SELECT-FOR-CNPO-ENTR-ID                     02159000
021600         PERFORM 3126-SCM-CONPO-CHANGE                            02160000
021610         IF PS-RESET-DC-SPLIT-DETL                                02161000
021620           OR PS-RESET-DC-SPLIT-CNTR                              02162000
021630           MOVE SPACES TO IMCNPO-SPLT-XMIT-CDE                    02163000
021640         END-IF                                                   02164000
021650         PERFORM 7010-INSERT-TIMCNPO                              02165000
021660         IF PS-GOOD-CNPO-INSERT                                   02166000
021670             PERFORM 5705-MOVE-CNPO-DETAIL                        02167000
021680             PERFORM 7033-SELECT-TIMCNRL                          02168000
021690             IF PS-TIMCNRL-FOUND                                  02169000
021700               IF (IMCNRL-DCONSLR-RLSE-CDE = PC-R OR PC-Y)        02170000
021710                 AND PS-RESET-DC-SPLIT-DETL                       02171000
021720                   PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL           02172000
021730                   MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE           02173000
021740                   PERFORM 7034-UPDATE-TIMCNRL                    02174000
021750               END-IF                                             02175000
021760             END-IF                                               02176000
021770         ELSE                                                     02177000
021780             PERFORM 3150-PROCESS-PO-ERROR                        02178000
021790                 UNTIL PS-NEW-PO   OR                             02179000
021800                       PS-END-OF-FILE                             02180000
021810         END-IF                                                   02181000
021820         ADD +1 TO PA-TOT-CNPO-CHANGES                            02182000
021830         ADD +1 TO PA-TOT-RECS-CHANGED                            02183000
021840     ELSE                                                         02184000
021850       IF PS-RESET-DC-SPLIT-CNTR                                  02185000
021860         IF IMCNPO-SPLT-XMIT-CDE NOT EQUAL SPACES                 02186000
021870             PERFORM 7060-INSERT-TAUCNPO                          02187000
021880             PERFORM 7259-UPDATE-TIMCNPO                          02188000
021890         END-IF                                                   02189000
021900         PERFORM 7033-SELECT-TIMCNRL                              02190000
021910         IF PS-TIMCNRL-FOUND                                      02191000
021920           IF IMCNRL-DCONSLR-RLSE-CDE = PC-R OR PC-Y              02192000
021930               PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL               02193000
021940               MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE               02194000
021950               PERFORM 7034-UPDATE-TIMCNRL                        02195000
021960           END-IF                                                 02196000
021970         END-IF                                                   02197000
021980       END-IF                                                     02198000
021990     END-IF.                                                      02199000
022000                                                                  02200000
022010     PERFORM 5595-INIT-ARV-DELV-CDE-HOLD.                         02201000
022020                                                                  02202000
022030     IF PS-NEW-PO-NO                                              02203000
022040         PERFORM 3116-LOAD-PO-UPC-TABLE-PO                        02204000
022050     END-IF.                                                      02205000
022060                                                                  02206000
022070******************************************************************02207000
022080* COMPARE THE INPUT FIELDS THAT WERE LOADED INTO THE TIMCNPO     *02208000
022090* DCLGEN FIELDS AGAINST THE TIMCNPO FIELDS THAT WERE LOADED INTO *02209000
022100* THE TAUCNPO FIELDS TO SEE IF A CHANGE HAS OCCURRED.            *02210000
022110******************************************************************02211000
022120 3114-COMPARE-FOR-CONPO-CHANGES.                                  02212000
022130                                                                  02213000
022140     IF (AUCNPO-EXTL-REF-NBR       NOT EQUAL                      02214000
022150                                  IMCNPO-EXTL-REF-NBR)        OR  02215000
022160        (AUCNPO-MSTR-BOL-NBR       NOT EQUAL                      02216000
022170                                  IMCNPO-MSTR-BOL-NBR)        OR  02217000
022180        (AUCNPO-HSE-BOL-NBR        NOT EQUAL                      02218000
022190                                  IMCNPO-HSE-BOL-NBR)         OR  02219000
022200        (AUCNPO-LTR-OF-CR-NBR      NOT EQUAL                      02220000
022210                                  IMCNPO-LTR-OF-CR-NBR)       OR  02221000
022220        (AUCNPO-PO-RCVD-DELY-TMST  NOT EQUAL                      02222000
022230                                  IMCNPO-PO-RCVD-DELY-TMST)   OR  02223000
022240        (AUCNPO-PO-C-O-PROD-CDE    NOT EQUAL                      02224000
022250                                  IMCNPO-PO-C-O-PROD-CDE)     OR  02225000
022260        (AUCNPO-DOC-RCVD-ORGN-TMST NOT EQUAL                      02226000
022270                                  IMCNPO-DOC-RCVD-ORGN-TMST)  OR  02227000
022280        (AUCNPO-PO-CART-CNT        NOT EQUAL                      02228000
022290                                  IMCNPO-PO-CART-CNT)         OR  02229000
022300        (AUCNPO-PO-CBMT-QTY        NOT EQUAL                      02230000
022310                                  IMCNPO-PO-CBMT-QTY)         OR  02231000
022320        (AUCNPO-PO-WT-KGRM-QTY     NOT EQUAL                      02232000
022330                                  IMCNPO-PO-WT-KGRM-QTY)      OR  02233000
022340        (AUCNPO-PO-UNT-QTY         NOT EQUAL                      02234000
022350                                  IMCNPO-PO-UNT-QTY)              02235000
022360        SET PS-CHANGE-FOUND-PO   TO TRUE                          02236000
022370        SET PS-CHANGE-FOUND      TO TRUE                          02237000
022380     END-IF.                                                      02238000
022390     IF (AUCNPO-PO-CART-CNT        NOT EQUAL                      02239000
022400                                  IMCNPO-PO-CART-CNT)         OR  02240000
022410        (AUCNPO-PO-UNT-QTY         NOT EQUAL                      02241000
022420                                  IMCNPO-PO-UNT-QTY)              02242000
022430        SET PS-RESET-DC-SPLIT-DETL TO TRUE                        02243000
022440     END-IF.                                                      02244000
022450                                                                  02245000
022460******************************************************************02246000
022470* LOAD THE PO / UPC TABLE WITH THE PURCHASE ORDER NUMBER.        *02247000
022480******************************************************************02248000
022490 3116-LOAD-PO-UPC-TABLE-PO.                                       02249000
022500                                                                  02250000
022510* THIS CHECK WAS ADDED TO ELIMINATE A PROBLEM WHERE 2 CCONPO      02251000
022520* TRANSACTIONS WOULD COME INTO THE PROGRAM BACK TO BACK WHICH     02252000
022530* CAUSED AN ABEND.  THIS CHANGE WILL CAUSE THE SECOND CCONPO      02253000
022540* TO OVERLAY THE PREVIOUS ONE IN THE PO/UPC TABLE WITH ALL '9'S   02254000
022550* IN THE PV-TABLE-UPC-NBR AND PV-TABLE-SSCC-NBR FIELDS OF THE     02255000
022560* FIRST PO. THIS SHOULD CAUSE THE PO NOT TO BE E-DELETED, BUT     02256000
022570* ALL OF THE UPC'S AND CARTONS BELOW THIS PO WILL BE.             02257000
022580************************************************************      02258000
022590     IF PV-HOLD-TR023-REC-TYP-CONPO(1:6) = 'CCONPO'               02259000
022600      AND PO-INDX > 1                                             02260000
022610       SET PO-INDX DOWN BY +1                                     02261000
022620       MOVE ALL '9' TO PV-TABLE-UPC-NBR  (PO-INDX)                02262000
022630                       PV-TABLE-SSCC-NBR (PO-INDX)                02263000
022640       SET PO-INDX UP BY +1.                                      02264000
022650************************************************************      02265000
022660     MOVE TR023-CONPO-PO-NBR TO PV-TABLE-PO-NBR (PO-INDX).        02266000
022670     SET PO-INDX UP BY +1.                                        02267000
022680                                                                  02268000
022690******************************************************************02269000
022700* PROCESS CONPO CONTAINER PO RECORD ADD TRANSACTIONS.            *02270000
022710******************************************************************02271000
022720 3120-PROCESS-CONPO-ADD.                                          02272000
022730                                                                  02273000
022740     IF TR023-CONPO-TRN-TYP = PC-A                                02274000
022750         PERFORM 7255-SELECT-TIMCNPO                              02275000
022760     END-IF.                                                      02276000
022770                                                                  02277000
022780     IF PS-CNPO-FOUND                                             02278000
022790         SET PS-CNPO-PREV-SENT-ERR TO TRUE                        02279000
022800         MOVE PC-ERROR      TO TR211-ERROR-TYPE                   02280000
022810         MOVE IMCNPO-PO-NBR TO TR211-DATA-VALUE                   02281000
022820         MOVE 'PO NUMBER'   TO TR211-DATA-IN-ERROR                02282000
022830         MOVE 'ADD SENT, PO PREVIOUSLY SENT - NOT PROCESSED'      02283000
022840                            TO TR211-ERROR-MSG                    02284000
022850         SET PS-EDI-RECORD-NO TO TRUE                             02285000
022860         PERFORM 3150-PROCESS-PO-ERROR                            02286000
022870             UNTIL PS-NEW-PO   OR                                 02287000
022880                   PS-END-OF-FILE                                 02288000
022890         SET PS-CNPO-PREV-SENT-ERR-NO TO TRUE                     02289000
022900     ELSE                                                         02290000
022910         INITIALIZE DCLTIMCNPO                                    02291000
022920         PERFORM 7100-SET-CURRENT-TMST                            02292000
022930         MOVE PV-CURRENT-TMST TO IMCNPO-CRE-TMST                  02293000
022940                                 IMCNPO-LAST-UPD-TMST             02294000
022950         MOVE SPACES          TO IMCNPO-SPLT-XMIT-CDE             02295000
022960         PERFORM 5530-MOVE-CONPO-TO-DCLGEN                        02296000
022970         PERFORM 5597-INIT-TIMCNPO-CDES                           02297000
022980         PERFORM 3175-TPURCHS-EDITS                               02298000
022990                                                                  02299000
023000*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  02300000
023010*PROBLEM AND IS TEMPORARY                                         02301000
023020         IF TR023-CONPO-TRN-TYP = PC-C                            02302000
023030             PERFORM 7256-SELECT-TIMCNPO-OLD                      02303000
023040             IF PS-CNPO-OLD-FOUND                                 02304000
023050                 PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO             02305000
023060                 PERFORM 7060-INSERT-TAUCNPO                      02306000
023070                 PERFORM 7160-DELETE-TIMCNPO                      02307000
023080                 MOVE SPACES TO IMCNPO-SPLT-XMIT-CDE              02308000
023090                 PERFORM 5530-MOVE-CONPO-TO-DCLGEN                02309000
023100                 MOVE IMCNPO-CONTNR-SEQ-NBR TO                    02310000
023110                       PV-HOLD-CONTNR-SEQ-NBR                     02311000
023120             END-IF                                               02312000
023130         END-IF                                                   02313000
023140*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  02314000
023150*PROBLEM AND IS TEMPORARY                                         02315000
023160                                                                  02316000
023170         PERFORM 7330-SELECT-FOR-CNPO-ENTR-ID                     02317000
023180         PERFORM 3125-SCM-CONPO-ADD                               02318000
023190                                                                  02319000
023200         PERFORM 7010-INSERT-TIMCNPO                              02320000
023210         IF PS-GOOD-CNPO-INSERT                                   02321000
023220             IF PS-TPURCHS-ACTIVE                                 02322000
023230                 INITIALIZE TM606-RECORD                          02323000
023240                  MOVE PC-CN TO TM606-EXTR-PRCG-APPL-CDE          02324000
023250                  PERFORM 7040-INSERT-TOUTTM1                     02325000
023260             END-IF                                               02326000
023270             PERFORM 5705-MOVE-CNPO-DETAIL                        02327000
023280             IF TR023-CONPO-TRN-TYP = PC-A OR                     02328000
023290                PS-CHANGE-ADD-B OR                                02329000
023300                PS-CHANGE-ADD-Z                                   02330000
023310                 PERFORM 3140-PROCESS-TIMCNRL                     02331000
023320             END-IF                                               02332000
023330         ELSE                                                     02333000
023340             PERFORM 3150-PROCESS-PO-ERROR                        02334000
023350                 UNTIL PS-NEW-PO   OR                             02335000
023360                       PS-END-OF-FILE                             02336000
023370         END-IF                                                   02337000
023380     END-IF.                                                      02338000
023390                                                                  02339000
023400******************************************************************02340000
023410* ADD CONTAINTER PO 'ADD' REC  TO DB2 WORKTABLE TRTW_CONTNR_CKPR *02341000
023420* TO EVENTUALLY BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES. *02342000
023430******************************************************************02343000
023440 3125-SCM-CONPO-ADD.                                              02344000
023450     IF TR023-CONPO-ACTL-DPRTR-DTE > SPACE                        02345000
023460       INITIALIZE TR405-MESSAGE-LAYOUT                            02346000
023470       MOVE 'A'                        TO TR405-ACTN-CDE          02347000
023480       MOVE 'CONTNR SAILED'            TO TR405-EVENT-TYP         02348000
023490       MOVE TR023-CONPO-PO-NBR         TO TR405-PO-NBR            02349000
023500       MOVE TR023-CONPO-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR      02350000
023510       MOVE TR023-CONPO-CONTNR-ID      TO TR405-CONTNR-ID         02351000
023520       MOVE PV-HOLD-CONTNR-SEQ-NBR     TO TR405-CONTNR-SEQ-NBR    02352000
023530       MOVE TR023-CONPO-ACTL-DPRTR-DTE TO TR405-EVENT-DTE         02353000
023540       MOVE IMCNTK-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE 02354000
023550       MOVE IMCNPO-CSTM-ENTR-ID         TO TR405-CSTM-ENTR-ID     02355000
023560       MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT       02356000
023570       PERFORM 7099-INSERT-SCM-MESSAGE.                           02357000
023580                                                                  02358000
023590     IF TR023-CONPO-DOC-RCVD-ORGN-DTE NOT =                       02359000
023600       PC-DEFAULT-DTE-NO-DASHES                                   02360000
023610       INITIALIZE TR405-MESSAGE-LAYOUT                            02361000
023620       MOVE 'A'                        TO TR405-ACTN-CDE          02362000
023630       MOVE 'DOCS RECEIVED BY CONSOL'  TO TR405-EVENT-TYP         02363000
023640       MOVE TR023-CONPO-PO-NBR         TO TR405-PO-NBR            02364000
023650       MOVE TR023-CONPO-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR      02365000
023660       MOVE TR023-CONPO-CONTNR-ID      TO TR405-CONTNR-ID         02366000
023670       MOVE PV-HOLD-CONTNR-SEQ-NBR     TO TR405-CONTNR-SEQ-NBR    02367000
023680       MOVE IMCNTK-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE 02368000
023690       MOVE TR023-CONPO-DOC-RCVD-ORGN-DTE TO TR405-EVENT-DTE      02369000
023700       MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT       02370000
023710       PERFORM 7099-INSERT-SCM-MESSAGE.                           02371000
023720                                                                  02372000
023730******************************************************************02373000
023740* ADD CONTAINTER PO 'ADD' REC  TO DB2 WORKTABLE TRTW_CONTNR_CKPR *02374000
023750* TO EVENTUALLY BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES. *02375000
023760******************************************************************02376000
023770 3126-SCM-CONPO-CHANGE.                                           02377000
023780     IF PS-ORGN-CODE-CHANGED                                      02378000
023790* IF THE ORGN HAS CHANGED, THE PROGRAM SENDS A DELETE OF THE      02379000
023800* CONTAINER RELATIONSHIP WITH THE OLD ORGN CODE AND AN ADD        02380000
023810* WITH THE NEW ORGN CODE AND AN ADD OF THE DOCS RECEIVED IF THE   02381000
023820* DOCS RECEIVED DATE IN NOT DEFAULT.                              02382000
023830       INITIALIZE TR405-MESSAGE-LAYOUT                            02383000
023840       MOVE 'D'                        TO TR405-ACTN-CDE          02384000
023850       MOVE 'CONTNR RELATIONSHIP DEL'  TO TR405-EVENT-TYP         02385000
023860       MOVE IMCNPO-PO-NBR              TO TR405-PO-NBR            02386000
023870       MOVE IMCNPO-EXTL-REF-NBR        TO TR405-EXTL-REF-NBR      02387000
023880       MOVE IMCNTK-CONTNR-ID           TO TR405-CONTNR-ID         02388000
023890       MOVE IMCNTK-CONTNR-SEQ-NBR      TO TR405-CONTNR-SEQ-NBR    02389000
023900* OLD ORGN CODE                                                   02390000
023910       MOVE PV-PREV-ORGN-SHPD-FR-CDE   TO TR405-ORGN-SHPD-FR-CDE  02391000
023920       MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT       02392000
023930       PERFORM 7099-INSERT-SCM-MESSAGE                            02393000
023940       INITIALIZE TR405-MESSAGE-LAYOUT                            02394000
023950       MOVE 'A'                        TO TR405-ACTN-CDE          02395000
023960       MOVE 'CONTNR SAILED'            TO TR405-EVENT-TYP         02396000
023970       MOVE TR023-CONPO-PO-NBR         TO TR405-PO-NBR            02397000
023980       MOVE TR023-CONPO-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR      02398000
023990       MOVE TR023-CONPO-CONTNR-ID      TO TR405-CONTNR-ID         02399000
024000* NEW ORGN CODE                                                   02400000
024010       MOVE PV-HOLD-ORGN-SHPD-FR-CDE   TO TR405-CONTNR-SEQ-NBR    02401000
024020       MOVE TR023-CONPO-ACTL-DPRTR-DTE TO TR405-EVENT-DTE         02402000
024030       MOVE IMCNTK-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE 02403000
024040       MOVE IMCNPO-CSTM-ENTR-ID         TO TR405-CSTM-ENTR-ID     02404000
024050       MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT       02405000
024060       PERFORM 7099-INSERT-SCM-MESSAGE                            02406000
024070       IF PV-DOC-RCVD-ORGN-TMST-NEW (1:10) NOT = PC-DEFAULT-DTE   02407000
024080         INITIALIZE TR405-MESSAGE-LAYOUT                          02408000
024090         MOVE 'DOCS RECEIVED BY CONSOL'  TO TR405-EVENT-TYP       02409000
024100         MOVE TR023-CONPO-PO-NBR         TO TR405-PO-NBR          02410000
024110         MOVE TR023-CONPO-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR    02411000
024120         MOVE TR023-CONPO-DOC-RCVD-ORGN-DTE TO TR405-EVENT-DTE    02412000
024130         MOVE TR023-CONPO-CONTNR-ID      TO TR405-CONTNR-ID       02413000
024140         MOVE PV-HOLD-CONTNR-SEQ-NBR     TO TR405-CONTNR-SEQ-NBR  02414000
024150* NEW ORGN CODE                                                   02415000
024160         MOVE PV-HOLD-ORGN-SHPD-FR-CDE                            02416000
024170              TO TR405-ORGN-SHPD-FR-CDE                           02417000
024180         MOVE 'A'                      TO TR405-ACTN-CDE          02418000
024190         MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT     02419000
024200         PERFORM 7099-INSERT-SCM-MESSAGE                          02420000
024210       END-IF                                                     02421000
024220     ELSE                                                         02422000
024230     IF PV-DOC-RCVD-ORGN-TMST-OLD (1:10) NOT =                    02423000
024240       PV-DOC-RCVD-ORGN-TMST-NEW                                  02424000
024250       INITIALIZE TR405-MESSAGE-LAYOUT                            02425000
024260       MOVE 'DOCS RECEIVED BY CONSOL'  TO TR405-EVENT-TYP         02426000
024270       MOVE TR023-CONPO-PO-NBR         TO TR405-PO-NBR            02427000
024280       MOVE TR023-CONPO-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR      02428000
024290       MOVE TR023-CONPO-DOC-RCVD-ORGN-DTE TO TR405-EVENT-DTE      02429000
024300       MOVE TR023-CONPO-CONTNR-ID      TO TR405-CONTNR-ID         02430000
024310       MOVE PV-HOLD-CONTNR-SEQ-NBR     TO TR405-CONTNR-SEQ-NBR    02431000
024320       MOVE PV-HOLD-ORGN-SHPD-FR-CDE    TO TR405-ORGN-SHPD-FR-CDE 02432000
024330       IF PV-DOC-RCVD-ORGN-TMST-OLD (1:10) = PC-DEFAULT-DTE       02433000
024340         MOVE 'A'                      TO TR405-ACTN-CDE          02434000
024350         MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT     02435000
024360         PERFORM 7099-INSERT-SCM-MESSAGE                          02436000
024370       ELSE                                                       02437000
024380        IF PV-DOC-RCVD-ORGN-TMST-NEW (1:10) = PC-DEFAULT-DTE      02438000
024390         MOVE 'D'                      TO TR405-ACTN-CDE          02439000
024400         MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT     02440000
024410         PERFORM 7099-INSERT-SCM-MESSAGE                          02441000
024420        ELSE                                                      02442000
024430         MOVE 'C'                      TO TR405-ACTN-CDE          02443000
024440         MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT     02444000
024450         PERFORM 7099-INSERT-SCM-MESSAGE.                         02445000
024460                                                                  02446000
024470                                                                  02447000
024480******************************************************************02448000
024490* DELETE CONTAINER PO RECORD FROM CONTAINER PO TABLE (TIMCNPO).  *02449000
024500* THIS DELETE IS PERFORMED FROM THE CONTAINER LEVEL.             *02450000
024510******************************************************************02451000
024520 3130-PROCESS-CONPO-DELETE.                                       02452000
024530                                                                  02453000
024540     PERFORM 7320-FETCH-CONPO-CURSOR.                             02454000
024550                                                                  02455000
024560     IF PS-EOC-CONPO-CURSOR                                       02456000
024570         PERFORM 7310-CLOSE-CONPO-CURSOR                          02457000
024580     ELSE                                                         02458000
024590         IF SQLCODE = +0                                          02459000
024600             MOVE IMCNPO-PO-NBR TO PV-HOLD-PO-NBR                 02460000
024610             PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO                 02461000
024620             PERFORM 7060-INSERT-TAUCNPO                          02462000
024630             IF PS-GOOD-ACNPO-INSERT                              02463000
024640                 PERFORM 7160-DELETE-TIMCNPO                      02464000
024650                 INITIALIZE TM606-RECORD                          02465000
024660                 MOVE PC-CD TO TM606-EXTR-PRCG-APPL-CDE           02466000
024670                 PERFORM 7040-INSERT-TOUTTM1                      02467000
024680                 PERFORM 7500-OPEN-CONUP-CURSOR                   02468000
024690                 PERFORM 3330-PROCESS-CONUPC-DELETE               02469000
024700                     UNTIL PS-EOC-CONUP-CURSOR                    02470000
024710                 SET PS-EOC-CONUP-CURSOR-NO TO TRUE               02471000
024720             END-IF                                               02472000
024730         ELSE                                                     02473000
024740             MOVE PC-ERROR           TO TR211-ERROR-TYPE          02474000
024750             MOVE TR023-CONPO-PO-NBR TO TR211-DATA-VALUE          02475000
024760             MOVE 'PO NUMBER'        TO TR211-DATA-IN-ERROR       02476000
024770             MOVE 'DELETE SENT - PO NOT FOUND - NOT DELETED'      02477000
024780                                     TO TR211-ERROR-MSG           02478000
024790             PERFORM 5820-LOAD-CONPOA-TO-REPORT                   02479000
024800         END-IF                                                   02480000
024810     END-IF.                                                      02481000
024820                                                                  02482000
024830******************************************************************02483000
024840* CREATE CONTAINER PO ARRIVAL/DELIVERY RECYCLE RECORDS.          *02484000
024850* THIS DELETE IS PERFORMED FROM THE CONTAINER LEVEL.             *02485000
024860******************************************************************02486000
024870 3135-PROCESS-RECYCLE-CREATE.                                     02487000
024880                                                                  02488000
024890     PERFORM 7580-FETCH-RECYCLE-CURSOR.                           02489000
024900                                                                  02490000
024910     IF PS-EOC-RECYCLE-CURSOR                                     02491000
024920         PERFORM 7575-CLOSE-RECYCLE-CURSOR                        02492000
024930     ELSE                                                         02493000
024940         IF SQLCODE = +0                                          02494000
024950             IF IMCNPO-ACTL-POE-DELY-CDE  = PC-Y  AND             02495000
024960                IMCNTK-ACTL-POE-DELY-TMST > PC-DEFAULT-TMST       02496000
024970                 PERFORM 5720-MOVE-RECYCLE-ADURD                  02497000
024980                 PERFORM 7200-INSERT-LOAD-RPT-TABLE               02498000
024990             END-IF                                               02499000
025000             IF IMCNPO-DO-RCVD-CDE        = PC-Y  AND             02500000
025010                IMCNTK-DO-RCVD-TMST       > PC-DEFAULT-TMST       02501000
025020                 PERFORM 5725-MOVE-RECYCLE-DPURD                  02502000
025030                 PERFORM 7200-INSERT-LOAD-RPT-TABLE               02503000
025040             END-IF                                               02504000
025050             IF IMCNPO-CONTNR-PU-CDE      = PC-Y  AND             02505000
025060                IMCNTK-CONTNR-PU-TMST     > PC-DEFAULT-TMST       02506000
025070                 PERFORM 5730-MOVE-RECYCLE-DLVRD                  02507000
025080                 PERFORM 7200-INSERT-LOAD-RPT-TABLE               02508000
025090             END-IF                                               02509000
025100             IF IMCNPO-BKR-FRGT-RLSE-CDE  = PC-Y  AND             02510000
025110                IMCNTK-BKR-FRGT-RLSE-TMST > PC-DEFAULT-TMST       02511000
025120                 PERFORM 5735-MOVE-RECYCLE-CRPRD                  02512000
025130                 PERFORM 7200-INSERT-LOAD-RPT-TABLE               02513000
025140             END-IF                                               02514000
025150             IF IMCNPO-DCONSLR-RET-CDE   = PC-Y   AND             02515000
025160                IMCNTK-DCONSLR-RET-TMST  > PC-DEFAULT-TMST        02516000
025170                 PERFORM 5740-MOVE-RECYCLE-RTNRD                  02517000
025180                 PERFORM 7200-INSERT-LOAD-RPT-TABLE               02518000
025190             END-IF                                               02519000
025200             IF IMCNPO-DVN-CDE           = PC-Y   AND             02520000
025210                IMCNTK-DVN-TMST          > PC-DEFAULT-TMST        02521000
025220                 PERFORM 5745-MOVE-RECYCLE-DVNRD                  02522000
025230                 PERFORM 7200-INSERT-LOAD-RPT-TABLE               02523000
025240             END-IF                                               02524000
025250         END-IF                                                   02525000
025260     END-IF.                                                      02526000
025270                                                                  02527000
025280******************************************************************02528000
025290* PROCESS IMPORT CONTAINER RELEASE INFORMATION.                  *02529000
025300******************************************************************02530000
025310 3140-PROCESS-TIMCNRL.                                            02531000
025320                                                                  02532000
025330     SET PS-TIMCNRL-NOT-FOUND TO TRUE.                            02533000
025340     PERFORM 7033-SELECT-TIMCNRL.                                 02534000
025350     IF PS-TIMCNRL-FOUND                                          02535000
025360         PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL                     02536000
025370         PERFORM 7190-DELETE-TIMCNRL                              02537000
025380     END-IF.                                                      02538000
025390                                                                  02539000
025400     INITIALIZE DCLTIMCNRL.                                       02540000
025410     MOVE IMCNPO-CONTNR-ID        TO IMCNRL-CONTNR-ID.            02541000
025420     MOVE PV-HOLD-CONTNR-SEQ-NBR  TO IMCNRL-CONTNR-SEQ-NBR.       02542000
025430     MOVE IMCNPO-PO-NBR           TO IMCNRL-PO-NBR.               02543000
025440     MOVE PC-N                    TO IMCNRL-DCONSLR-RLSE-CDE.     02544000
025450     MOVE PC-DEFAULT-NINES-DTE    TO IMCNRL-DCONSLR-REQR-DTE      02545000
025460                                     IMCNRL-DCONSLR-ACTL-DTE.     02546000
025470     MOVE PC-DEFAULT-NINES-TIME   TO IMCNRL-DCONSLR-ACTL-TM.      02547000
025480     PERFORM 7100-SET-CURRENT-TMST.                               02548000
025490     MOVE PV-CURRENT-TMST         TO IMCNRL-CRE-TMST              02549000
025500                                     IMCNRL-LAST-UPD-TMST.        02550000
025510     MOVE PC-CURRENT-PROGRAM-NAME TO IMCNRL-CRE-BY-UID            02551000
025520                                     IMCNRL-LAST-UPD-BY-UID.      02552000
025530     PERFORM 7035-INSERT-TIMCNRL.                                 02553000
025540                                                                  02554000
025550******************************************************************02555000
025560* THERE WAS A PO LEVEL ERROR -- BYPASS THE VENDOR STYLE AND UPC  *02556000
025570* RECORDS THAT ARE RELATED TO THIS PO.                           *02557000
025580******************************************************************02558000
025590 3150-PROCESS-PO-ERROR.                                           02559000
025600                                                                  02560000
025610     IF PS-EDI-RECORD-NO                                          02561000
025620         PERFORM 3500-CHECK-MOVE-TO-REPORT                        02562000
025630     END-IF.                                                      02563000
025640                                                                  02564000
025650     PERFORM 6000-READ-CONTAINER-FILE.                            02565000
025660                                                                  02566000
025670     IF PS-EDI-RECORD                                             02567000
025680         CONTINUE                                                 02568000
025690     ELSE                                                         02569000
025700         IF (TR023-CONPO-CONTNR-ID      NOT EQUAL                 02570000
025710             PV-HOLD-CONTNR-ID)                OR                 02571000
025720            (TR023-CONPO-ACTL-DPRTR-DTE NOT EQUAL                 02572000
025730             PV-HOLD-ACTL-DPRTR-DTE-MOM)       OR                 02573000
025740            (TR023-CONPO-ACTL-DPRTR-TM  NOT EQUAL                 02574000
025750             PV-HOLD-ACTL-DPRTR-TM-MOM)        OR                 02575000
025760            (TR023-CONPO-TRN-TYP        NOT EQUAL                 02576000
025770             PV-HOLD-TRN-TYP)                  OR                 02577000
025780            (TR023-CONPO-PO-NBR         NOT EQUAL                 02578000
025790             PV-HOLD-PO-NBR)                                      02579000
025800              SET PS-NEW-PO TO TRUE                               02580000
025810              PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD                02581000
025820         END-IF                                                   02582000
025830     END-IF.                                                      02583000
025840                                                                  02584000
025850******************************************************************02585000
025860* PERFORM EDITS FOR PO AGAINST TPURCHS.                          *02586000
025870******************************************************************02587000
025880 3175-TPURCHS-EDITS.                                              02588000
025890                                                                  02589000
025900     PERFORM 7295-SELECT-TPURCHS.                                 02590000
025910     SET PS-TPURCHS-ACTIVE-NO TO TRUE.                            02591000
025920                                                                  02592000
025930     IF PS-PURCHS-FOUND                                           02593000
025940       IF PURCHS-STATUS-CDE NOT = (PC-AC AND PC-AP)               02594000
025950           MOVE PC-WARNING    TO TR211-ERROR-TYPE                 02595000
025960           MOVE IMCNPO-PO-NBR TO TR211-DATA-VALUE                 02596000
025970           MOVE 'PO NUMBER'   TO TR211-DATA-IN-ERROR              02597000
025980*          MOVE 'PO NOT ACTIVE OR APPROVED ON MAINFRAME'          02598000
025990           MOVE 'PO NOT ACTIVE OR APPROVED ON KOHLS SYSTEM'       02599000
026000                              TO TR211-ERROR-MSG                  02600000
026010           PERFORM 5820-LOAD-CONPOA-TO-REPORT                     02601000
026020       ELSE                                                       02602000
026030           IF PURCHS-STATUS-CDE = (PC-AC OR PC-AP)                02603000
026040               SET PS-TPURCHS-ACTIVE TO TRUE                      02604000
026050           END-IF                                                 02605000
026060       END-IF                                                     02606000
026070     ELSE                                                         02607000
026080         MOVE PC-WARNING            TO TR211-ERROR-TYPE           02608000
026090         MOVE IMCNPO-PO-NBR         TO TR211-DATA-VALUE           02609000
026100         MOVE 'PO NUMBER'           TO TR211-DATA-IN-ERROR        02610000
026110*        MOVE 'PO NOT ON MAINFRAME' TO TR211-ERROR-MSG            02611000
026120         MOVE 'PO NOT ON KOHLS SYSTEM'  TO TR211-ERROR-MSG        02612000
026130         PERFORM 5820-LOAD-CONPOA-TO-REPORT                       02613000
026140     END-IF.                                                      02614000
026150                                                                  02615000
026160******************************************************************02616000
026170* PROCESS CONUPC CONTAINER UPC LEVEL RECORDS.                    *02617000
026180* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *02618000
026190******************************************************************02619000
026200 3300-PROCESS-CONUPC-REC.                                         02620000
026210                                                                  02621000
026220     PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD.                        02622000
026230                                                                  02623000
026240     MOVE TR023-CONUPC-TRN-TYP TO PV-TRN-TYP-CDE.                 02624000
026250                                                                  02625000
026260     EVALUATE TRUE                                                02626000
026270         WHEN PV-TRN-TYP-ADD                                      02627000
026280             PERFORM 3320-PROCESS-CONUPC-ADD                      02628000
026290                                                                  02629000
026300         WHEN PV-TRN-TYP-CHG                                      02630000
026310             PERFORM 3310-PROCESS-CONUPC-CHANGE                   02631000
026320     END-EVALUATE.                                                02632000
026330                                                                  02633000
026340     IF PS-NEW-UPC  OR                                            02634000
026350        PS-END-OF-FILE                                            02635000
026360         SET PS-NEW-UPC-NO     TO TRUE                            02636000
026370         SET PS-GOOD-RECORD-NO TO TRUE                            02637000
026380     ELSE                                                         02638000
026390         PERFORM 6000-READ-CONTAINER-FILE                         02639000
026400             UNTIL PS-GOOD-RECORD      OR                         02640000
026410                   PS-END-OF-FILE                                 02641000
026420         SET PS-GOOD-RECORD-NO TO TRUE                            02642000
026430     END-IF.                                                      02643000
026440                                                                  02644000
026450******************************************************************02645000
026460* PROCESS CONUPC CHANGE TRANSACTIONS.                            *02646000
026470******************************************************************02647000
026480 3310-PROCESS-CONUPC-CHANGE.                                      02648000
026490                                                                  02649000
026500     PERFORM 7265-SELECT-TIMCNUP.                                 02650000
026510                                                                  02651000
026520     IF PS-CNUP-FOUND                                             02652000
026530         PERFORM 3312-CONTINUE-CONUPC-CHANGE                      02653000
026540     ELSE                                                         02654000
026550         IF PS-CNTK-FOUND OR                                      02655000
026560            PS-CNPO-FOUND                                         02656000
026570*            MOVE PC-WARNING           TO TR211-ERROR-TYPE        02657000
026580*            MOVE TR023-CONUPC-UPC-NBR TO TR211-DATA-VALUE        02658000
026590*            MOVE 'UPC LEVEL'          TO TR211-DATA-IN-ERROR     02659000
026600*            MOVE 'CHANGE SENT - UPC NOT FOUND - UPC ADDED'       02660000
026610*                                      TO TR211-ERROR-MSG         02661000
026620             SET PS-CHANGE-ADD-Z       TO TRUE                    02662000
026630*            PERFORM 5840-LOAD-CONUPA-TO-REPORT                   02663000
026640             ADD +1 TO PA-TOT-CNUP-CHANGES-Z                      02664000
026650             ADD +1 TO PA-TOT-RECS-CHANGED-Z                      02665000
026660         ELSE                                                     02666000
026670             SET PS-CHANGE-ADD-B       TO TRUE                    02667000
026680             ADD +1 TO PA-TOT-CNUP-CHANGES-B                      02668000
026690             ADD +1 TO PA-TOT-RECS-CHANGED-B                      02669000
026700         END-IF                                                   02670000
026710         SET PS-CHANGE-FOUND TO TRUE                              02671000
026720         PERFORM 7288-SELECT-CONTNR-SEQ-NBR                       02672000
026730         PERFORM 3320-PROCESS-CONUPC-ADD                          02673000
026740         IF PS-CHANGE-ADD-B-NO                                    02674000
026750             PERFORM 3316-LOAD-PO-UPC-TABLE-UPC                   02675000
026760         END-IF                                                   02676000
026770         SET PS-CHANGE-ADD-Z-NO TO TRUE                           02677000
026780     END-IF.                                                      02678000
026790                                                                  02679000
026800******************************************************************02680000
026810* PROCESS CONUPC CHANGE TRANSACTIONS.                            *02681000
026820******************************************************************02682000
026830 3312-CONTINUE-CONUPC-CHANGE.                                     02683000
026840                                                                  02684000
026850     PERFORM 7645-MOVE-TIMCNUP-TO-TAUCNUP.                        02685000
026860                                                                  02686000
026870     SET PS-CHANGE-FOUND-UPC-NO TO TRUE.                          02687000
026880                                                                  02688000
026890     IF PURCHS-PKGNG-CDE = PC-B OR PC-C OR PC-S OR PC-SPACE       02689000
026900         PERFORM 3375-TPURITM-EDITS-UPC                           02690000
026910     END-IF.                                                      02691000
026920     PERFORM 5550-MOVE-CONUPC-TO-DCLGEN.                          02692000
026930     PERFORM 3376-TPURCHS-EDITS-PKG-CDE.                          02693000
026940                                                                  02694000
026950     IF PURCHS-PKGNG-CDE = PC-B OR PC-C OR PC-S OR PC-SPACE       02695000
026960         PERFORM 3380-UPC-BULK-EDITS                              02696000
026970     ELSE                                                         02697000
026980         IF (PURCHS-PKGNG-CDE = PC-I OR PC-M) AND                 02698000
026990            (IMCNUP-ASN-PKGNG-CDE = 'AS')                         02699000
027000             PERFORM 3385-UPC-PREPACK-EDITS                       02700000
027010         END-IF                                                   02701000
027020     END-IF.                                                      02702000
027030                                                                  02703000
027040     SET PS-DONT-RESET-DC-SPLIT-DETL TO TRUE.                     02704000
027050     PERFORM 3314-COMPARE-FOR-CONUPC-CHANGE.                      02705000
027060     IF PS-CHANGE-FOUND-UPC                                       02706000
027070         PERFORM 7185-DELETE-TIMCNUP-CHG                          02707000
027080         PERFORM 7080-INSERT-TAUCNUP                              02708000
027090         PERFORM 7100-SET-CURRENT-TMST                            02709000
027100         MOVE IMCNUP-CONTNR-SEQ-NBR TO PV-HOLD-CONTNR-SEQ-NBR     02710000
027110         PERFORM 7030-INSERT-TIMCNUP                              02711000
027120         IF PS-GOOD-CNUP-INSERT                                   02712000
027130             PERFORM 5715-MOVE-CNUP-DETAIL                        02713000
027140             PERFORM 7255-SELECT-TIMCNPO                          02714000
027150             IF PS-CNPO-FOUND                                     02715000
027160                AND PS-RESET-DC-SPLIT-DETL                        02716000
027170                AND IMCNPO-SPLT-XMIT-CDE NOT EQUAL SPACES         02717000
027180                 PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO             02718000
027190                 PERFORM 7060-INSERT-TAUCNPO                      02719000
027200                 PERFORM 7259-UPDATE-TIMCNPO                      02720000
027210             END-IF                                               02721000
027220             PERFORM 7033-SELECT-TIMCNRL                          02722000
027230             IF PS-TIMCNRL-FOUND                                  02723000
027240               IF (IMCNRL-DCONSLR-RLSE-CDE = PC-R OR PC-Y)        02724000
027250                 AND PS-RESET-DC-SPLIT-DETL                       02725000
027260                   PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL           02726000
027270                   MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE           02727000
027280                   PERFORM 7034-UPDATE-TIMCNRL                    02728000
027290               END-IF                                             02729000
027300             END-IF                                               02730000
027310         ELSE                                                     02731000
027320             PERFORM 3350-PROCESS-UPC-ERROR                       02732000
027330                 UNTIL PS-NEW-UPC  OR                             02733000
027340                       PS-END-OF-FILE                             02734000
027350         END-IF                                                   02735000
027360         ADD +1 TO PA-TOT-RECS-CHANGED                            02736000
027370         ADD +1 TO PA-TOT-CNUP-CHANGES                            02737000
027380     END-IF.                                                      02738000
027390                                                                  02739000
027400     IF PS-NEW-UPC-NO                                             02740000
027410         PERFORM 3316-LOAD-PO-UPC-TABLE-UPC                       02741000
027420     END-IF.                                                      02742000
027430                                                                  02743000
027440******************************************************************02744000
027450* COMPARE THE INPUT FIELDS THAT WERE LOADED INTO THE TIMCNUP     *02745000
027460* DCLGEN FIELDS AGAINST THE TIMCNUP FIELDS THAT WERE LOADED INTO *02746000
027470* THE TAUCNUP FIELDS TO SEE IF A CHANGE HAS OCCURRED.            *02747000
027480******************************************************************02748000
027490 3314-COMPARE-FOR-CONUPC-CHANGE.                                  02749000
027500                                                                  02750000
027510     IF (AUCNUP-PO-LNE-NBR         NOT EQUAL                      02751000
027520                                  IMCNUP-PO-LNE-NBR)          OR  02752000
027530        (AUCNUP-UPC-CART-CNT       NOT EQUAL                      02753000
027540                                  IMCNUP-UPC-CART-CNT)        OR  02754000
027550        (AUCNUP-UPC-CBMT-QTY       NOT EQUAL                      02755000
027560                                  IMCNUP-UPC-CBMT-QTY)        OR  02756000
027570        (AUCNUP-UPC-WT-KGRM-QTY    NOT EQUAL                      02757000
027580                                  IMCNUP-UPC-WT-KGRM-QTY)     OR  02758000
027590        (AUCNUP-UPC-UNT-QTY        NOT EQUAL                      02759000
027600                                  IMCNUP-UPC-UNT-QTY)         OR  02760000
027610        (AUCNUP-SKU-NBR            NOT EQUAL                      02761000
027620                                  IMCNUP-SKU-NBR)             OR  02762000
027630        (AUCNUP-ASN-PKGNG-CDE      NOT EQUAL                      02763000
027640                                  IMCNUP-ASN-PKGNG-CDE)           02764000
027650        SET PS-CHANGE-FOUND-UPC  TO TRUE                          02765000
027660        SET PS-CHANGE-FOUND      TO TRUE                          02766000
027670     END-IF.                                                      02767000
027680     IF (AUCNUP-UPC-CART-CNT       NOT EQUAL                      02768000
027690                                  IMCNUP-UPC-CART-CNT)        OR  02769000
027700        (AUCNUP-UPC-CBMT-QTY       NOT EQUAL                      02770000
027710                                  IMCNUP-UPC-CBMT-QTY)        OR  02771000
027720        (AUCNUP-UPC-WT-KGRM-QTY    NOT EQUAL                      02772000
027730                                  IMCNUP-UPC-WT-KGRM-QTY)     OR  02773000
027740        (AUCNUP-UPC-UNT-QTY        NOT EQUAL                      02774000
027750                                  IMCNUP-UPC-UNT-QTY)         OR  02775000
027760        (AUCNUP-ASN-PKGNG-CDE      NOT EQUAL                      02776000
027770                                  IMCNUP-ASN-PKGNG-CDE)           02777000
027780        SET PS-RESET-DC-SPLIT-DETL TO TRUE                        02778000
027790     END-IF.                                                      02779000
027800                                                                  02780000
027810******************************************************************02781000
027820* LOAD THE PO / UPC TABLE WITH THE UPC NUMBER.                   *02782000
027830******************************************************************02783000
027840 3316-LOAD-PO-UPC-TABLE-UPC.                                      02784000
027850                                                                  02785000
027860     SET PO-INDX TO +1.                                           02786000
027870                                                                  02787000
027880     SEARCH PV-PO-UPC-CART-TABLE-ENTRY VARYING PO-INDX            02788000
027890         AT END                                                   02789000
027900           CONTINUE                                               02790000
027910        WHEN TR023-CONUPC-PO-NBR EQUAL PV-TABLE-PO-NBR (PO-INDX)  02791000
027920            IF PV-TABLE-UPC-NBR (PO-INDX) EQUAL ZEROES            02792000
027930                MOVE TR023-CONUPC-UPC-NBR      TO                 02793000
027940                         PV-TABLE-UPC-NBR (PO-INDX)               02794000
027950            ELSE                                                  02795000
027960                PERFORM UNTIL PV-TABLE-PO-NBR (PO-INDX)           02796000
027970                               EQUAL ZEROES OR                    02797000
027980                               PO-INDX > 20000                    02798000
027990                    SET PO-INDX UP BY +1                          02799000
028000                END-PERFORM                                       02800000
028010                MOVE TR023-CONUPC-PO-NBR         TO               02801000
028020                          PV-TABLE-PO-NBR (PO-INDX)               02802000
028030                MOVE TR023-CONUPC-UPC-NBR        TO               02803000
028040                          PV-TABLE-UPC-NBR (PO-INDX)              02804000
028050            END-IF                                                02805000
028060     END-SEARCH.                                                  02806000
028070                                                                  02807000
028080     SET PO-INDX UP BY +1.                                        02808000
028090                                                                  02809000
028100******************************************************************02810000
028110* PROCESS CONUPC CONTAINER UPC RECORD ADD TRANSACTIONS.          *02811000
028120******************************************************************02812000
028130 3320-PROCESS-CONUPC-ADD.                                         02813000
028140                                                                  02814000
028150     IF TR023-CONUPC-TRN-TYP = PC-A                               02815000
028160         PERFORM 7265-SELECT-TIMCNUP                              02816000
028170     END-IF.                                                      02817000
028180                                                                  02818000
028190     IF PS-CNUP-FOUND                                             02819000
028200         SET PS-CNUP-PREV-SENT-ERR TO TRUE                        02820000
028210         MOVE PC-ERROR        TO TR211-ERROR-TYPE                 02821000
028220         MOVE IMCNUP-UPC-NBR  TO TR211-DATA-VALUE                 02822000
028230         MOVE 'UPC NUMBER '   TO TR211-DATA-IN-ERROR              02823000
028240         MOVE 'ADD SENT, UPC PREVIOUSLY SENT - NOT PROCESSED'     02824000
028250                              TO TR211-ERROR-MSG                  02825000
028260         SET PS-EDI-RECORD-NO TO TRUE                             02826000
028270         PERFORM 3350-PROCESS-UPC-ERROR                           02827000
028280             UNTIL PS-NEW-UPC  OR                                 02828000
028290                   PS-END-OF-FILE                                 02829000
028300         SET PS-CNUP-PREV-SENT-ERR-NO TO TRUE                     02830000
028310     ELSE                                                         02831000
028320         INITIALIZE DCLTIMCNUP                                    02832000
028330         PERFORM 7100-SET-CURRENT-TMST                            02833000
028340         MOVE PV-CURRENT-TMST TO IMCNUP-CRE-TMST                  02834000
028350         PERFORM 5550-MOVE-CONUPC-TO-DCLGEN                       02835000
028360         IF PURCHS-PKGNG-CDE = PC-B OR PC-C OR PC-S OR PC-SPACE   02836000
028370             PERFORM 3375-TPURITM-EDITS-UPC                       02837000
028380         END-IF                                                   02838000
028390         PERFORM 3376-TPURCHS-EDITS-PKG-CDE                       02839000
028400                                                                  02840000
028410         IF PURCHS-PKGNG-CDE = PC-B OR PC-C OR PC-S OR PC-SPACE   02841000
028420             PERFORM 3380-UPC-BULK-EDITS                          02842000
028430         ELSE                                                     02843000
028440             IF (PURCHS-PKGNG-CDE = PC-I OR PC-M) AND             02844000
028450                (IMCNUP-ASN-PKGNG-CDE = 'AS')                     02845000
028460                 PERFORM 3385-UPC-PREPACK-EDITS                   02846000
028470             END-IF                                               02847000
028480         END-IF                                                   02848000
028490                                                                  02849000
028500*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  02850000
028510*PROBLEM AND IS TEMPORARY                                         02851000
028520         IF TR023-CONUPC-TRN-TYP = PC-C                           02852000
028530             PERFORM 7267-SELECT-TIMCNUP-OLD                      02853000
028540             IF PS-CNUP-OLD-FOUND                                 02854000
028550                 PERFORM 7645-MOVE-TIMCNUP-TO-TAUCNUP             02855000
028560                 PERFORM 7080-INSERT-TAUCNUP                      02856000
028570                 PERFORM 7180-DELETE-TIMCNUP                      02857000
028580                 PERFORM 5550-MOVE-CONUPC-TO-DCLGEN               02858000
028590                 MOVE IMCNUP-CONTNR-SEQ-NBR TO                    02859000
028600                       PV-HOLD-CONTNR-SEQ-NBR                     02860000
028610             END-IF                                               02861000
028620         END-IF                                                   02862000
028630*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  02863000
028640*PROBLEM AND IS TEMPORARY                                         02864000
028650                                                                  02865000
028660         PERFORM 7030-INSERT-TIMCNUP                              02866000
028670         IF PS-GOOD-CNUP-INSERT                                   02867000
028680             PERFORM 5715-MOVE-CNUP-DETAIL                        02868000
028690             PERFORM 7255-SELECT-TIMCNPO                          02869000
028700             IF PS-CNPO-FOUND AND                                 02870000
028710                IMCNPO-SPLT-XMIT-CDE NOT EQUAL SPACES             02871000
028720                 PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO             02872000
028730                 PERFORM 7060-INSERT-TAUCNPO                      02873000
028740                 PERFORM 7259-UPDATE-TIMCNPO                      02874000
028750             END-IF                                               02875000
028760             PERFORM 7033-SELECT-TIMCNRL                          02876000
028770             IF PS-TIMCNRL-FOUND                                  02877000
028780               IF IMCNRL-DCONSLR-RLSE-CDE = PC-R OR PC-Y          02878000
028790                   PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL           02879000
028800                   MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE           02880000
028810                   PERFORM 7034-UPDATE-TIMCNRL                    02881000
028820               END-IF                                             02882000
028830             END-IF                                               02883000
028840         ELSE                                                     02884000
028850             PERFORM 3350-PROCESS-UPC-ERROR                       02885000
028860                 UNTIL PS-NEW-UPC  OR                             02886000
028870                       PS-END-OF-FILE                             02887000
028880         END-IF                                                   02888000
028890     END-IF.                                                      02889000
028900                                                                  02890000
028910******************************************************************02891000
028920* DELETE CONTAINER UPC RECORD FROM CONTAINER UPC TABLE (TIMCNUP).*02892000
028930* THIS DELETE IS PERFORMED FROM THE CONTAINER LEVEL.             *02893000
028940******************************************************************02894000
028950 3330-PROCESS-CONUPC-DELETE.                                      02895000
028960                                                                  02896000
028970     PERFORM 7520-FETCH-CONUP-CURSOR.                             02897000
028980                                                                  02898000
028990     IF PS-EOC-CONUP-CURSOR                                       02899000
029000         PERFORM 7510-CLOSE-CONUP-CURSOR                          02900000
029010     ELSE                                                         02901000
029020         IF SQLCODE = +0                                          02902000
029030             MOVE IMCNUP-PO-NBR  TO PV-HOLD-PO-NBR                02903000
029040             MOVE IMCNUP-UPC-NBR TO PV-HOLD-UPC-NBR               02904000
029050             PERFORM 7645-MOVE-TIMCNUP-TO-TAUCNUP                 02905000
029060             PERFORM 7080-INSERT-TAUCNUP                          02906000
029070             IF PS-GOOD-ACNUP-INSERT                              02907000
029080                 PERFORM 7180-DELETE-TIMCNUP                      02908000
029090                 PERFORM 7585-OPEN-CNCART-CURSOR                  02909000
029100                 PERFORM 3630-PROCESS-CNCART-DELETE               02910000
029110                     UNTIL PS-EOC-CNCART-CURSOR                   02911000
029120                 SET PS-EOC-CNCART-CURSOR-NO TO TRUE              02912000
029130             END-IF                                               02913000
029140             PERFORM 7615-OPEN-CNSEAL-CURSOR                      02914000
029150             PERFORM 3730-PROCESS-CNSEAL-DELETE                   02915000
029160                 UNTIL PS-EOC-CNSEAL-CURSOR                       02916000
029170             SET PS-EOC-CNSEAL-CURSOR-NO TO TRUE                  02917000
029180         ELSE                                                     02918000
029190             MOVE PC-ERROR             TO TR211-ERROR-TYPE        02919000
029200             MOVE TR023-CONUPC-UPC-NBR TO TR211-DATA-VALUE        02920000
029210             MOVE 'UPC NUMBER'         TO TR211-DATA-IN-ERROR     02921000
029220             MOVE 'DELETE SENT - UPC NOT FOUND - NOT DELETED'     02922000
029230                                       TO TR211-ERROR-MSG         02923000
029240             PERFORM 5840-LOAD-CONUPA-TO-REPORT                   02924000
029250         END-IF                                                   02925000
029260     END-IF.                                                      02926000
029270                                                                  02927000
029280******************************************************************02928000
029290* THERE WAS A UPC LEVEL ERROR - BYPASS THE UPC RECORDS THAT ARE  *02929000
029300* RELATED TO THIS UPC.                                           *02930000
029310******************************************************************02931000
029320 3350-PROCESS-UPC-ERROR.                                          02932000
029330                                                                  02933000
029340     IF PS-EDI-RECORD-NO                                          02934000
029350         PERFORM 3500-CHECK-MOVE-TO-REPORT                        02935000
029360     END-IF.                                                      02936000
029370                                                                  02937000
029380     PERFORM 6000-READ-CONTAINER-FILE.                            02938000
029390                                                                  02939000
029400     IF PS-EDI-RECORD                                             02940000
029410         CONTINUE                                                 02941000
029420     ELSE                                                         02942000
029430         IF (TR023-CONUPC-CONTNR-ID      NOT EQUAL                02943000
029440             PV-HOLD-CONTNR-ID)                OR                 02944000
029450            (TR023-CONUPC-ACTL-DPRTR-DTE NOT EQUAL                02945000
029460             PV-HOLD-ACTL-DPRTR-DTE-MOM)       OR                 02946000
029470            (TR023-CONUPC-ACTL-DPRTR-TM  NOT EQUAL                02947000
029480             PV-HOLD-ACTL-DPRTR-TM-MOM)        OR                 02948000
029490            (TR023-CONUPC-TRN-TYP        NOT EQUAL                02949000
029500             PV-HOLD-TRN-TYP)                  OR                 02950000
029510            (TR023-CONUPC-PO-NBR         NOT EQUAL                02951000
029520             PV-HOLD-PO-NBR)                   OR                 02952000
029530            (TR023-CONUPC-UPC-NBR        NOT EQUAL                02953000
029540             PV-HOLD-UPC-NBR)                                     02954000
029550              SET PS-NEW-UPC TO TRUE                              02955000
029560              PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD                02956000
029570         END-IF                                                   02957000
029580     END-IF.                                                      02958000
029590                                                                  02959000
029600******************************************************************02960000
029610* PERFORM EDITS FOR UPC AGAINST TPURITM.                         *02961000
029620******************************************************************02962000
029630 3375-TPURITM-EDITS-UPC.                                          02963000
029640                                                                  02964000
029650     SET PV-UPC-NBR-NOT-FOUND-NO TO TRUE.                         02965000
029660     PERFORM 7299-SELECT-TPURITM2.                                02966000
029670     IF PS-PURITM2-FOUND                                          02967000
029680         MOVE PURITM-APP-PO-LNE-NBR TO IMCNUP-PO-LNE-NBR          02968000
029690         IF SQLCODE = -811                                        02969000
029700             MOVE PC-WARNING     TO TR211-ERROR-TYPE              02970000
029710             MOVE IMCNUP-UPC-NBR TO TR211-DATA-VALUE              02971000
029720             MOVE 'UPC NUMBER'   TO TR211-DATA-IN-ERROR           02972000
029730*            MOVE 'UPC ON MULTIPLE PO LINES ON MAINFRAME'         02973000
029740             MOVE 'UPC ON MULTIPLE PO LINES ON KOHLS SYSTEM'      02974000
029750                                 TO TR211-ERROR-MSG               02975000
029760             PERFORM 5840-LOAD-CONUPA-TO-REPORT                   02976000
029770             MOVE ZEROS TO IMCNUP-PO-LNE-NBR                      02977000
029780         END-IF                                                   02978000
029790     ELSE                                                         02979000
029800         PERFORM 7298-SELECT-TPURITM1                             02980000
029810         IF PS-PURITM1-FOUND                                      02981000
029820             MOVE PC-WARNING     TO TR211-ERROR-TYPE              02982000
029830             MOVE IMCNUP-UPC-NBR TO TR211-DATA-VALUE              02983000
029840             MOVE 'UPC NUMBER'   TO TR211-DATA-IN-ERROR           02984000
029850*            MOVE 'UPC NOT ACTIVE OR APPROVED ON MAINFRAME PO'    02985000
029860             MOVE 'UPC NOT ACTIVE OR APPROVED ON KOHLS SYSTEM'    02986000
029870                                 TO TR211-ERROR-MSG               02987000
029880             PERFORM 5840-LOAD-CONUPA-TO-REPORT                   02988000
029890             IF PURITM-STATUS-CDE = PC-CA OR PC-CM                02989000
029900                 MOVE PURITM-APP-PO-LNE-NBR TO IMCNUP-PO-LNE-NBR  02990000
029910             ELSE                                                 02991000
029920                 MOVE ZEROS TO IMCNUP-PO-LNE-NBR                  02992000
029930             END-IF                                               02993000
029940         ELSE                                                     02994000
029950             MOVE PC-WARNING     TO TR211-ERROR-TYPE              02995000
029960             MOVE IMCNUP-UPC-NBR TO TR211-DATA-VALUE              02996000
029970             MOVE 'UPC NUMBER'   TO TR211-DATA-IN-ERROR           02997000
029980             MOVE 'UPC NOT ON KOHLS PO'                           02998000
029990                                 TO TR211-ERROR-MSG               02999000
030000             PERFORM 5840-LOAD-CONUPA-TO-REPORT                   03000000
030010             MOVE ZEROS TO IMCNUP-PO-LNE-NBR                      03001000
030020             SET PV-UPC-NBR-NOT-FOUND TO TRUE                     03002000
030030         END-IF                                                   03003000
030040     END-IF.                                                      03004000
030050                                                                  03005000
030060******************************************************************03006000
030070* PERFORM EDITS FOR INPUT PACKAGE CODE VERSUS TPURCHS            *03007000
030080******************************************************************03008000
030090 3376-TPURCHS-EDITS-PKG-CDE.                                      03009000
030100     IF TR023-CONUPC-ASN-PKG-CDE = 'AS'                           03010000
030110         IF (PURCHS-PKGNG-CDE = PC-I                              03011000
030120               OR PURCHS-PKGNG-CDE = PC-M)                        03012000
030130             PERFORM 7360-SELECT-TPOPRPK-PREPK-ID                 03013000
030140             PERFORM 7358-VALIDATE-TPOPRPK-UPC-INFO               03014000
030150         ELSE                                                     03015000
030160             INITIALIZE TR211-DATA-VALUE                          03016000
030170             MOVE PC-WARNING             TO TR211-ERROR-TYPE      03017000
030180             MOVE TR023-CONUPC-ASN-PKG-CDE TO TR211-DATA-VALUE    03018000
030190             MOVE 'ASN PKG CDE    '      TO TR211-DATA-IN-ERROR   03019000
030200             MOVE 'UPC PKG TYP NOT = KOHLS PO'                    03020000
030210                                         TO TR211-ERROR-MSG       03021000
030220             PERFORM 5840-LOAD-CONUPA-TO-REPORT                   03022000
030230         END-IF                                                   03023000
030240     END-IF.                                                      03024000
030250                                                                  03025000
030260                                                                  03026000
030270     IF TR023-CONUPC-ASN-PKG-CDE = 'EA'                           03027000
030280         IF (PURCHS-PKGNG-CDE = PC-B                              03028000
030290               OR PURCHS-PKGNG-CDE = PC-C                         03029000
030300               OR PURCHS-PKGNG-CDE = PC-S                         03030000
030310               OR PURCHS-PKGNG-CDE = PC-SPACE                     03031000
030320               OR PURCHS-PKGNG-CDE = PC-LOW-VALUE)                03032000
030330             PERFORM 7357-SELECT-TPURITM-UPC-INFO                 03033000
030340         ELSE                                                     03034000
030350             PERFORM 7360-SELECT-TPOPRPK-PREPK-ID                 03035000
030360             IF PV-PO-PREPK-ID > ZERO                             03036000
030370                 MOVE 'AS' TO IMCNUP-ASN-PKGNG-CDE                03037000
030380             END-IF                                               03038000
030390             INITIALIZE TR211-DATA-VALUE                          03039000
030400             MOVE PC-WARNING             TO TR211-ERROR-TYPE      03040000
030410             MOVE TR023-CONUPC-ASN-PKG-CDE TO TR211-DATA-VALUE    03041000
030420             MOVE 'ASN PKG CDE    '      TO TR211-DATA-IN-ERROR   03042000
030430             MOVE 'UPC PKG TYP NOT = KOHLS PO'                    03043000
030440                                         TO TR211-ERROR-MSG       03044000
030450             PERFORM 5840-LOAD-CONUPA-TO-REPORT                   03045000
030460         END-IF                                                   03046000
030470     END-IF.                                                      03047000
030480                                                                  03048000
030490     IF TR023-CONUPC-ASN-PKG-CDE = 'AS'                           03049000
030500           OR TR023-CONUPC-ASN-PKG-CDE = 'EA'                     03050000
030510         CONTINUE                                                 03051000
030520     ELSE                                                         03052000
030530         IF PURCHS-PKGNG-CDE = PC-I                               03053000
030540               OR PURCHS-PKGNG-CDE = PC-M                         03054000
030550             MOVE 'AS' TO IMCNUP-ASN-PKGNG-CDE                    03055000
030560             PERFORM 7360-SELECT-TPOPRPK-PREPK-ID                 03056000
030570             PERFORM 7358-VALIDATE-TPOPRPK-UPC-INFO               03057000
030580         ELSE                                                     03058000
030590             IF PURCHS-PKGNG-CDE = PC-B                           03059000
030600                   OR PURCHS-PKGNG-CDE = PC-C                     03060000
030610                   OR PURCHS-PKGNG-CDE = PC-S                     03061000
030620                   OR PURCHS-PKGNG-CDE = PC-SPACE                 03062000
030630                   OR PURCHS-PKGNG-CDE = PC-LOW-VALUE             03063000
030640                 MOVE 'EA' TO IMCNUP-ASN-PKGNG-CDE                03064000
030650                 PERFORM 7357-SELECT-TPURITM-UPC-INFO             03065000
030660             ELSE                                                 03066000
030670                 MOVE SPACES TO IMCNUP-ASN-PKGNG-CDE              03067000
030680             END-IF                                               03068000
030690         END-IF                                                   03069000
030700     END-IF.                                                      03070000
030710                                                                  03071000
030720******************************************************************03072000
030730* PERFORM SPECIAL EDITS FOR BULK UPC RECORDS.                    *03073000
030740******************************************************************03074000
030750 3380-UPC-BULK-EDITS.                                             03075000
030760                                                                  03076000
030770     PERFORM 7350-SELECT-TUPC-INFO.                               03077000
030780     IF (IMCNUP-UPC-CART-CNT = ZERO)   AND                        03078000
030790        (IMCNUP-UPC-UNT-QTY > UPC-OUTR-PK-QTY)                    03079000
030800         INITIALIZE TR211-DATA-VALUE                              03080000
030810         MOVE PC-WARNING             TO TR211-ERROR-TYPE          03081000
030820         MOVE UPC-OUTR-PK-QTY        TO TR211-DATA-VALUE          03082000
030830         MOVE 'OUTR PACK KOHLS'      TO TR211-DATA-IN-ERROR       03083000
030840         MOVE 'CARTON COUNT ZERO & UNITS EXCEED SKU OTR PACK QTY' 03084000
030850                                     TO TR211-ERROR-MSG           03085000
030860         PERFORM 5840-LOAD-CONUPA-TO-REPORT                       03086000
030870     END-IF.                                                      03087000
030880                                                                  03088000
030890     IF (IMCNUP-UPC-CART-CNT = ZERO)   AND                        03089000
030900        (IMCNUP-UPC-UNT-QTY < UPC-OUTR-PK-QTY)                    03090000
030910         INITIALIZE TR211-DATA-VALUE                              03091000
030920         MOVE PC-WARNING             TO TR211-ERROR-TYPE          03092000
030930         MOVE UPC-OUTR-PK-QTY        TO TR211-DATA-VALUE          03093000
030940         MOVE 'OUTR PACK KOHLS'      TO TR211-DATA-IN-ERROR       03094000
030950         MOVE 'BULK UNITS < OUTR PACK QTY'                        03095000
030960                                     TO TR211-ERROR-MSG           03096000
030970         PERFORM 5840-LOAD-CONUPA-TO-REPORT                       03097000
030980     END-IF.                                                      03098000
030990                                                                  03099000
031000     IF (PURCHS-NEW-STR-PO-IND = PC-Y) AND                        03100000
031010        (IMCNUP-UPC-CART-CNT = 0)                                 03101000
031020         CONTINUE                                                 03102000
031030     ELSE                                                         03103000
031040         PERFORM 3382-PROCESS-OUTR-PCK-ERR                        03104000
031050     END-IF.                                                      03105000
031060                                                                  03106000
031070******************************************************************03107000
031080* PERFORM PROCESSING FOR BULK OUTER PACK ERRORS.                 *03108000
031090******************************************************************03109000
031100 3382-PROCESS-OUTR-PCK-ERR.                                       03110000
031110                                                                  03111000
031120*** 02/22/13 - BUD - OUTR-PK-QTY FROM TUPC TO TPURITM PBI-20443   03112000
031130*** START                                                         03113000
031140                                                                  03114000
031150     IF IMCNUP-UPC-UNT-QTY = ZERO                                 03115000
031160         MOVE PC-WARNING           TO TR211-ERROR-TYPE            03116000
031170         MOVE IMCNUP-UPC-UNT-QTY   TO TR211-DATA-VALUE            03117000
031180         MOVE 'UPC UNIT QTY'       TO TR211-DATA-IN-ERROR         03118000
031190         MOVE 'UPC UNIT QUANTITY EQUAL ZERO'                      03119000
031200                                   TO TR211-ERROR-MSG             03120000
031210         PERFORM 5840-LOAD-CONUPA-TO-REPORT                       03121000
031220     END-IF.                                                      03122000
031230                                                                  03123000
031240     IF PURITM-OUTR-PK-QTY = ZERO                                 03124000
031250         MOVE PC-WARNING             TO TR211-ERROR-TYPE          03125000
031260         MOVE PURITM-OUTR-PK-QTY     TO TR211-DATA-VALUE          03126000
031270         MOVE 'OUTR PACK QTY  '      TO TR211-DATA-IN-ERROR       03127000
031280         MOVE 'VEND OUTR PACK QTY EQUAL ZERO'                     03128000
031290                                     TO TR211-ERROR-MSG           03129000
031300         PERFORM 5840-LOAD-CONUPA-TO-REPORT                       03130000
031310     END-IF.                                                      03131000
031320                                                                  03132000
031330     IF IMCNUP-UPC-UNT-QTY     > +0  AND                          03133000
031340        IMCNUP-UPC-CART-CNT    > +0  AND                          03134000
031350        PURITM-OUTR-PK-QTY     > +0                               03135000
031360                                                                  03136000
031370         COMPUTE PV-OUTR-PACK-QTY ROUNDED =                       03137000
031380                 IMCNUP-UPC-UNT-QTY / IMCNUP-UPC-CART-CNT         03138000
031390         IF PV-OUTR-PACK-QTY NOT = PURITM-OUTR-PK-QTY             03139000
031400             COMPUTE PV-CALC-OUTR-PACK-PCT =                      03140000
031410              (1 - (PV-OUTR-PACK-QTY / PURITM-OUTR-PK-QTY))       03141000
031420             IF PV-CALC-OUTR-PACK-PCT < +0                        03142000
031430                 MULTIPLY -1 BY PV-CALC-OUTR-PACK-PCT             03143000
031440             END-IF                                               03144000
031450             IF PV-CALC-OUTR-PACK-PCT > .10                       03145000
031460                 MOVE PC-WARNING     TO TR211-ERROR-TYPE          03146000
031470                 INITIALIZE TR211-DATA-VALUE                      03147000
031480                 INITIALIZE PV-EDIT-DATA-VALUE-FIELD              03148000
031490                 MOVE PV-OUTR-PACK-QTY TO PV-EDIT-VALUE-1         03149000
031500                 MOVE PC-SLASH         TO PV-EDIT-SLASH           03150000
031510                 MOVE PURITM-OUTR-PK-QTY  TO PV-EDIT-VALUE-2      03151000
031520                                                                  03152000
031530                 STRING PV-EDIT-VALUE-1                           03153000
031540                        PC-SLASH                                  03154000
031550                        PV-EDIT-VALUE-2                           03155000
031560                    DELIMITED BY SIZE                             03156000
031570                    INTO TR211-DATA-VALUE                         03157000
031580                 MOVE 'OTRPK CNSL/KHLS'   TO TR211-DATA-IN-ERROR  03158000
031590                 MOVE 'CONSOLDATR OTRPK NOT = KOHLS OTRPK'        03159000
031600                                          TO TR211-ERROR-MSG      03160000
031610                 PERFORM 5840-LOAD-CONUPA-TO-REPORT               03161000
031620                 SET PS-UPC-OUTR-PACKS-WNG TO TRUE                03162000
031630             END-IF                                               03163000
031640         END-IF                                                   03164000
031650     END-IF.                                                      03165000
031660*** 02/22/13 - BUD - OUTR-PK-QTY FROM TUPC TO TPURITM PBI-20443   03166000
031670*** END                                                           03167000
031680                                                                  03168000
031690******************************************************************03169000
031700* PERFORM SPECIAL EDITS FOR PREPACK UPC RECORDS.                 *03170000
031710******************************************************************03171000
031720 3385-UPC-PREPACK-EDITS.                                          03172000
031730                                                                  03173000
031740     MOVE IMCNUP-UPC-UNT-QTY TO PV-PREPACK-UNTS.                  03174000
031750     IF PV-PREPACK-UNTS = +0                                      03175000
031760         INITIALIZE TR211-REC-TYP-CONUPA                          03176000
031770         MOVE PC-WARNING             TO TR211-ERROR-TYPE          03177000
031780         MOVE PV-PREPACK-UNTS        TO TR211-DATA-VALUE          03178000
031790         MOVE 'PRPCK UNTS '          TO TR211-DATA-IN-ERROR       03179000
031800         MOVE 'PREPACK UNITS EQUAL ZERO'                          03180000
031810                                     TO TR211-ERROR-MSG           03181000
031820         PERFORM 5840-LOAD-CONUPA-TO-REPORT                       03182000
031830     END-IF.                                                      03183000
031840                                                                  03184000
031850     MOVE IMCNUP-UPC-CART-CNT TO PV-PREPACK-CTNS.                 03185000
031860     IF PV-PREPACK-CTNS = +0                                      03186000
031870         INITIALIZE TR211-REC-TYP-CONUPA                          03187000
031880         MOVE PC-WARNING             TO TR211-ERROR-TYPE          03188000
031890         MOVE PV-PREPACK-CTNS        TO TR211-DATA-VALUE          03189000
031900         MOVE 'PRPCK CTNS '          TO TR211-DATA-IN-ERROR       03190000
031910         MOVE 'PREPACK CARTONS EQUAL ZERO'                        03191000
031920                                     TO TR211-ERROR-MSG           03192000
031930         PERFORM 5840-LOAD-CONUPA-TO-REPORT                       03193000
031940     END-IF.                                                      03194000
031950                                                                  03195000
031960     PERFORM 7355-SELECT-TPOPRPK-INFO.                            03196003
031970     IF PV-POPRPK-UNT-QTY = +0                                    03197000
031980         MOVE PC-WARNING             TO TR211-ERROR-TYPE          03198000
031990         MOVE PV-POPRPK-UNT-QTY      TO TR211-DATA-VALUE          03199000
032000         MOVE 'POPRPK UNT QTY '      TO TR211-DATA-IN-ERROR       03200000
032010         MOVE 'PREPACK UNIT QUANTITY EQUAL ZERO'                  03201000
032020                                     TO TR211-ERROR-MSG           03202000
032030         PERFORM 5840-LOAD-CONUPA-TO-REPORT                       03203000
032040     END-IF.                                                      03204000
032050                                                                  03205000
032060     IF PV-PREPACK-UNTS        > +0  AND                          03206000
032070        PV-PREPACK-CTNS        > +0  AND                          03207000
032080        PV-POPRPK-UNT-QTY      > +0                               03208000
032090                                                                  03209000
032100         COMPUTE PV-CALC-UNTS-CTNS ROUNDED =                      03210000
032110                (PV-PREPACK-UNTS / PV-PREPACK-CTNS)               03211000
032120         IF PV-CALC-UNTS-CTNS NOT = PV-POPRPK-UNT-QTY             03212000
032130             INITIALIZE PV-CALC-UNTS-CTNS-PCT                     03213000
032140             COMPUTE PV-CALC-UNTS-CTNS-PCT =                      03214000
032150              (1 - (PV-CALC-UNTS-CTNS / PV-POPRPK-UNT-QTY))       03215000
032160             IF PV-CALC-UNTS-CTNS-PCT < +0                        03216000
032170                 MULTIPLY -1 BY PV-CALC-UNTS-CTNS-PCT             03217000
032180             END-IF                                               03218000
032190             IF PV-CALC-UNTS-CTNS-PCT > .10                       03219000
032200                 INITIALIZE TR211-REC-TYP-CONUPA                  03220000
032210                 MOVE PC-WARNING     TO TR211-ERROR-TYPE          03221000
032220                 INITIALIZE TR211-DATA-VALUE                      03222000
032230                 INITIALIZE PV-EDIT-DATA-VALUE-FIELD              03223000
032240                 MOVE PV-CALC-UNTS-CTNS TO PV-EDIT-VALUE-1        03224000
032250                 MOVE PC-SLASH TO PV-EDIT-SLASH                   03225000
032260                 MOVE PV-POPRPK-UNT-QTY TO PV-EDIT-VALUE-2        03226000
032270                 STRING PV-EDIT-VALUE-1                           03227000
032280                        PC-SLASH                                  03228000
032290                        PV-EDIT-VALUE-2                           03229000
032300                    DELIMITED BY SIZE                             03230000
032310                    INTO TR211-DATA-VALUE                         03231000
032320                 MOVE 'CALC/OTRPK UNTS'  TO                       03232000
032330                                         TR211-DATA-IN-ERROR      03233000
032340                 MOVE 'CALC UNTS/CTN NOT = PCK UNTS/CTN'          03234000
032350                                         TO TR211-ERROR-MSG       03235000
032360                 PERFORM 5840-LOAD-CONUPA-TO-REPORT               03236000
032370             END-IF                                               03237000
032380         END-IF                                                   03238000
032390     END-IF.                                                      03239000
032400                                                                  03240000
032410******************************************************************03241000
032420* DETERMINE IF IT'S TIME TO PROCESS THE PO/UPC/CARTON INTERNAL   *03242000
032430* TABLE                                                          *03243000
032440******************************************************************03244000
032450 3400-TABLE-COMPARE-CHECK.                                        03245000
032460                                                                  03246000
032470     PERFORM 7525-OPEN-PO-UPC-CART-CURSOR.                        03247000
032480     PERFORM 7535-FETCH-PO-UPC-CART-CURSOR.                       03248000
032490                                                                  03249000
032500     IF PS-EOC-PO-UPC-CART-CURSOR                                 03250000
032510         PERFORM 7530-CLOSE-PO-UPC-CART-CURSOR                    03251000
032520     ELSE                                                         03252000
032530         MOVE PV-CURSOR-PO-NBR TO PV-HOLD-CURSOR-PO-NBR           03253000
032540         MOVE PV-CURSOR-UPC-NBR TO PV-HOLD-CURSOR-UPC-NBR         03254000
032550         PERFORM 3410-TABLE-CURSOR-COMPARE                        03255000
032560             UNTIL PS-EOC-PO-UPC-CART-CURSOR                      03256000
032570         SET PS-EOC-PO-UPC-CART-CURSOR-NO TO TRUE                 03257000
032580     END-IF.                                                      03258000
032590                                                                  03259000
032600******************************************************************03260000
032610* COMPARE THE PO'S AND UPCS ON THE INTERNAL TABLE (WHICH WAS     *03261000
032620* LOADED WITH INPUT DATA) WITH THE ONES IN THE CURSOR FROM THE   *03262000
032630* TIMCNPO AND TIMCNUP TABLES.  THE OBJECTIVE OF THE COMPARE IS   *03263000
032640* TO IDENTIFY THE PO'S AND/OR UPC'S ON THE DB2 TABLES (THESE     *03264000
032650* ROWS WOULD BE IN THE CURSOR) THAT WERE NOT SENT WITH THE INPUT *03265000
032660* CHANGE TRANSACTION (THESE RECORDS WOULD BE IN THE INTERNAL     *03266000
032670* TABLE) AND DELETE THESE ROWS FROM THE TIMCNPO AND TIMCNUP      *03267000
032680* TABLES.  THESE RECORDS ARE REFERED TO AS 'E' DELETES.          *03268000
032690******************************************************************03269000
032700 3410-TABLE-CURSOR-COMPARE.                                       03270000
032710                                                                  03271000
032720     SET PO-INDX       TO +1.                                     03272000
032730     SEARCH PV-PO-UPC-CART-TABLE-ENTRY VARYING PO-INDX            03273000
032740                                                                  03274000
032750                                                                  03275000
032760        AT END                                                    03276000
032770          PERFORM 3420-PROCESS-SEARCH-AT-END-ERR                  03277000
032780          PERFORM 7530-CLOSE-PO-UPC-CART-CURSOR                   03278000
032790                                                                  03279000
032800        WHEN PV-TABLE-PO-NBR (PO-INDX) EQUAL ZEROES               03280000
032810            PERFORM 3430-PROCESS-PO-E-DELETE-REC                  03281000
032820            IF PV-CURSOR-PO-NBR NOT EQUAL                         03282000
032830               PV-HOLD-CURSOR-PO-NBR                              03283000
032840                MOVE PV-CURSOR-PO-NBR TO                          03284000
032850                      PV-HOLD-CURSOR-PO-NBR                       03285000
032860                PERFORM 7535-FETCH-PO-UPC-CART-CURSOR             03286000
032870                    UNTIL (PV-CURSOR-PO-NBR NOT =                 03287000
032880                           PV-HOLD-CURSOR-PO-NBR)    OR           03288000
032890                           PS-EOC-PO-UPC-CART-CURSOR              03289000
032900                IF PS-EOC-PO-UPC-CART-CURSOR                      03290000
032910                    PERFORM 7530-CLOSE-PO-UPC-CART-CURSOR         03291000
032920                END-IF                                            03292000
032930            ELSE                                                  03293000
032940                PERFORM UNTIL (PV-CURSOR-PO-NBR NOT EQUAL         03294000
032950                               PV-HOLD-CURSOR-PO-NBR)    OR       03295000
032960                               PS-EOC-PO-UPC-CART-CURSOR          03296000
032970                  MOVE PV-CURSOR-PO-NBR TO                        03297000
032980                       PV-HOLD-CURSOR-PO-NBR                      03298000
032990                  PERFORM 7535-FETCH-PO-UPC-CART-CURSOR           03299000
033000                  IF PS-EOC-PO-UPC-CART-CURSOR                    03300000
033010                      PERFORM 7530-CLOSE-PO-UPC-CART-CURSOR       03301000
033020                  END-IF                                          03302000
033030                END-PERFORM                                       03303000
033040            END-IF                                                03304000
033050                                                                  03305000
033060        WHEN PV-TABLE-PO-NBR (PO-INDX) EQUAL                      03306000
033070             PV-CURSOR-PO-NBR                                     03307000
033080            MOVE PV-CURSOR-PO-NBR  TO                             03308000
033090                 PV-HOLD-CURSOR-PO-NBR                            03309000
033100            PERFORM UNTIL (PV-CURSOR-PO-NBR NOT EQUAL             03310000
033110                           PV-HOLD-CURSOR-PO-NBR)     OR          03311000
033120                           PS-EOC-PO-UPC-CART-CURSOR              03312000
033130                                                                  03313000
033140               SEARCH PV-PO-UPC-CART-TABLE-ENTRY VARYING PO-INDX  03314000
033150                     AT END                                       03315000
033160                       PERFORM 3420-PROCESS-SEARCH-AT-END-ERR     03316000
033170                       PERFORM 7530-CLOSE-PO-UPC-CART-CURSOR      03317000
033180                                                                  03318000
033190                     WHEN PV-TABLE-UPC-NBR (PO-INDX) = ZEROES     03319000
033200               SET PV-INDX-1 TO PO-INDX                           03320000
033210               SET PV-INDX-2 TO PO-INDX                           03321000
033220               ADD 1 TO PV-INDX-2                                 03322000
033230                       IF PV-CURSOR-PO-NBR =                      03323000
033240                               PV-TABLE-PO-NBR (PO-INDX)          03324000
033250                           OR PV-TABLE-PO-NBR (PO-INDX) = ZEROES  03325000
033260                         PERFORM 3450-PROCESS-UPC-E-DELETE-REC    03326000
033270                         MOVE PV-CURSOR-PO-NBR TO                 03327000
033280                                   PV-HOLD-CURSOR-PO-NBR          03328000
033290                         PERFORM 7535-FETCH-PO-UPC-CART-CURSOR    03329000
033300                         SET PO-INDX TO +1                        03330000
033310                         IF PS-EOC-PO-UPC-CART-CURSOR             03331000
033320                             PERFORM                              03332000
033330                                 7530-CLOSE-PO-UPC-CART-CURSOR    03333000
033340                         END-IF                                   03334000
033350                       END-IF                                     03335000
033360                                                                  03336000
033370                     WHEN (PV-CURSOR-UPC-NBR EQUAL                03337000
033380                             PV-TABLE-UPC-NBR (PO-INDX))          03338000
033390                               AND                                03339000
033400                          (PV-CURSOR-PO-NBR EQUAL                 03340000
033410                             PV-TABLE-PO-NBR (PO-INDX))           03341000
033420                         MOVE PV-CURSOR-PO-NBR TO                 03342000
033430                                PV-HOLD-CURSOR-PO-NBR             03343000
033440                         MOVE PV-CURSOR-UPC-NBR TO                03344000
033450                                PV-HOLD-CURSOR-UPC-NBR            03345000
033460                         SET PO-INDX TO +1                        03346000
033470                         PERFORM UNTIL (PV-CURSOR-UPC-NBR         03347000
033480                           NOT EQUAL PV-HOLD-CURSOR-UPC-NBR)      03348000
033490                           OR PS-EOC-PO-UPC-CART-CURSOR           03349000
033500                                                                  03350000
033510                           SEARCH PV-PO-UPC-CART-TABLE-ENTRY      03351000
033520                                  VARYING PO-INDX                 03352000
033530                            AT END                                03353000
033540                              PERFORM                             03354000
033550                                   3420-PROCESS-SEARCH-AT-END-ERR 03355000
033560                              PERFORM                             03356000
033570                                    7530-CLOSE-PO-UPC-CART-CURSOR 03357000
033580                            WHEN PV-TABLE-SSCC-NBR (PO-INDX)      03358000
033590                                  = SPACES                        03359000
033600                              AND ((PV-CURSOR-UPC-NBR EQUAL       03360000
033610                                    PV-TABLE-UPC-NBR (PO-INDX))   03361000
033620                                 AND                              03362000
033630                                   (PV-CURSOR-PO-NBR EQUAL        03363000
033640                                   PV-TABLE-PO-NBR (PO-INDX)))    03364000
033650                              OR                                  03365000
033660                                 PV-TABLE-PO-NBR (PO-INDX) = ZERO 03366000
033670                                                                  03367000
033680***                          ********************************     03368000
033690***                          * IF NO CARTS ON DB2 TABLE, GO *     03369000
033700***                          * FETCH CURSOR.                *     03370000
033710***                          ********************************     03371000
033720                             IF PV-CURSOR-SSCC-NBR = SPACES       03372000
033730                               CONTINUE                           03373000
033740                             ELSE                                 03374000
033750                               PERFORM                            03375000
033760                                3455-PROCESS-CART-E-DELETE-REC    03376000
033770                             END-IF                               03377000
033780                             MOVE PV-CURSOR-UPC-NBR TO            03378000
033790                                   PV-HOLD-CURSOR-UPC-NBR         03379000
033800                             PERFORM 7535-FETCH-PO-UPC-CART-CURSOR03380000
033810                             SET PO-INDX TO +1                    03381000
033820                             IF PS-EOC-PO-UPC-CART-CURSOR         03382000
033830                                 PERFORM                          03383000
033840                                   7530-CLOSE-PO-UPC-CART-CURSOR  03384000
033850                             END-IF                               03385000
033860                                                                  03386000
033870                            WHEN (PV-CURSOR-SSCC-NBR EQUAL        03387000
033880                                  PV-TABLE-SSCC-NBR (PO-INDX))    03388000
033890                                  AND                             03389000
033900                                 (PV-CURSOR-UPC-NBR EQUAL         03390000
033910                                  PV-TABLE-UPC-NBR (PO-INDX))     03391000
033920                                  AND                             03392000
033930                                 (PV-CURSOR-PO-NBR EQUAL          03393000
033940                                  PV-TABLE-PO-NBR (PO-INDX))      03394000
033950                                MOVE PV-CURSOR-UPC-NBR TO         03395000
033960                                     PV-HOLD-CURSOR-UPC-NBR       03396000
033970                                PERFORM                           03397000
033980                                    7535-FETCH-PO-UPC-CART-CURSOR 03398000
033990                                SET PO-INDX TO +1                 03399000
034000                                IF PS-EOC-PO-UPC-CART-CURSOR      03400000
034010                                    PERFORM                       03401000
034020                                    7530-CLOSE-PO-UPC-CART-CURSOR 03402000
034030                                END-IF                            03403000
034040                           END-SEARCH                             03404000
034050                         END-PERFORM                              03405000
034060                   END-SEARCH                                     03406000
034070               END-PERFORM                                        03407000
034080     END-SEARCH.                                                  03408000
034090                                                                  03409000
034100******************************************************************03410000
034110* THE INTERNAL PO/UPC/CARTON TABLE HAS EXCEEDED ITS SIZE LIMIT.  *03411000
034120* NOTE:  SOME PO/UPC/CARTONS THAT SHOULD HAVE BEEN DELETED MAY   *03412000
034130* NOT HAVE BEEN DELETED.                                         *03413000
034140******************************************************************03414000
034150 3420-PROCESS-SEARCH-AT-END-ERR.                                  03415000
034160                                                                  03416000
034170     INITIALIZE TR211-REC-TYP-CONPOA.                             03417000
034180                                                                  03418000
034190     MOVE PC-ERROR                      TO TR211-ERROR-TYPE.      03419000
034200     MOVE TR023-CONPO-CONTNR-ID         TO TR211-CONTNR-ID.       03420000
034210     MOVE TR023-CONPO-ACTL-DPRTR-DTE    TO                        03421000
034220                                       TR211-ACTL-DPRTR-DTE-MOM.  03422000
034230     MOVE TR023-CONPO-ACTL-DPRTR-TM     TO                        03423000
034240                                       TR211-ACTL-DPRTR-TM-MOM.   03424000
034250     MOVE TR023-CONPO-DAT-SRC-ENT-ID    TO TR211-DAT-SRC-ENT-ID.  03425000
034260                                                                  03426000
034270     MOVE SPACES                        TO TR211-REC-TYP-CVYA     03427000
034280                                           TR211-DATA-IN-ERROR    03428000
034290                                           TR211-DATA-VALUE       03429000
034300                                           TR211-TRN-TYP.         03430000
034310     MOVE 'CALL PROGRAMMING- INTERNAL TABLE SIZE EXCEEDED'        03431000
034320                                        TO TR211-ERROR-MSG.       03432000
034330     PERFORM 6200-WRITE-LOAD-REPORT.                              03433000
034340                                                                  03434000
034350******************************************************************03435000
034360* THE PURCHASE ORDER ROW ON THE TIMCNPO TABLE WAS NOT SENT ON THE*03436000
034370* CHANGE TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF THE    *03437000
034380* DB2 TABLE.                                                     *03438000
034390******************************************************************03439000
034400 3430-PROCESS-PO-E-DELETE-REC.                                    03440000
034410                                                                  03441000
034420     MOVE PV-CURSOR-PO-NBR  TO IMCNPO-PO-NBR.                     03442000
034430     PERFORM 7257-SELECT-TIMCNPO-CHG.                             03443000
034440     PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO.                        03444000
034450     PERFORM 7165-DELETE-TIMCNPO-CHG.                             03445000
034460     PERFORM 3495-SCM-CONPO-DELETE.                               03446000
034470     PERFORM 7060-INSERT-TAUCNPO.                                 03447000
034480     PERFORM 3460-DISPLAY-E-PO.                                   03448000
034490     ADD +1 TO PA-TOT-CNPO-DELETES-E.                             03449000
034500     ADD +1 TO PA-TOT-RECS-DELETED-E.                             03450000
034510     SET PS-E-DELETE TO TRUE.                                     03451000
034520     SET PS-TIMCNRL-NOT-FOUND TO TRUE.                            03452000
034530     PERFORM 7033-SELECT-TIMCNRL.                                 03453000
034540     IF PS-TIMCNRL-FOUND                                          03454000
034550       PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL                       03455000
034560       PERFORM 7190-DELETE-TIMCNRL.                               03456000
034570                                                                  03457000
034580     PERFORM 7555-OPEN-UPC-CURSOR.                                03458000
034590     PERFORM 7565-FETCH-UPC-CURSOR.                               03459000
034600     IF PS-EOC-UPC-CURSOR                                         03460000
034610         PERFORM 7560-CLOSE-UPC-CURSOR                            03461000
034620     ELSE                                                         03462000
034630         PERFORM UNTIL PS-EOC-UPC-CURSOR                          03463000
034640            PERFORM 7645-MOVE-TIMCNUP-TO-TAUCNUP                  03464000
034650            PERFORM 7185-DELETE-TIMCNUP-CHG                       03465000
034660            PERFORM 7080-INSERT-TAUCNUP                           03466000
034670            PERFORM 3480-DISPLAY-E-UPC                            03467000
034680            PERFORM 7565-FETCH-UPC-CURSOR                         03468000
034690            ADD +1 TO PA-TOT-CNUP-DELETES-E                       03469000
034700            ADD +1 TO PA-TOT-RECS-DELETED-E                       03470000
034710            IF PS-EOC-UPC-CURSOR                                  03471000
034720                PERFORM 7560-CLOSE-UPC-CURSOR                     03472000
034730            END-IF                                                03473000
034740         END-PERFORM                                              03474000
034750     END-IF.                                                      03475000
034760                                                                  03476000
034770     PERFORM 7600-OPEN-CARTON-CURSOR.                             03477000
034780     PERFORM 7610-FETCH-CARTON-CURSOR.                            03478000
034790     IF PS-EOC-CARTON-CURSOR                                      03479000
034800         PERFORM 7605-CLOSE-CARTON-CURSOR                         03480000
034810     ELSE                                                         03481000
034820         PERFORM UNTIL PS-EOC-CARTON-CURSOR                       03482000
034830            PERFORM 7655-MOVE-CARTON-TO-AUDIT                     03483000
034840            PERFORM 7195-DELETE-CARTON-CHG                        03484000
034850            PERFORM 7085-INSERT-AUDIT-CARTON                      03485000
034860            PERFORM 3485-DISPLAY-E-CARTON                         03486000
034870            PERFORM 7610-FETCH-CARTON-CURSOR                      03487000
034880            ADD +1 TO PA-TOT-CNCT-DELETES-E                       03488000
034890            ADD +1 TO PA-TOT-RECS-DELETED-E                       03489000
034900            IF PS-EOC-CARTON-CURSOR                               03490000
034910                PERFORM 7605-CLOSE-CARTON-CURSOR                  03491000
034920            END-IF                                                03492000
034930         END-PERFORM                                              03493000
034940     END-IF.                                                      03494000
034950******************************************************************03495000
034960* THE UPC ROW ON THE TIMCNUP TABLE WAS NOT SENT ON THE CHANGE    *03496000
034970* TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF THE DB2       *03497000
034980* TABLE.                                                         *03498000
034990******************************************************************03499000
035000 3450-PROCESS-UPC-E-DELETE-REC.                                   03500000
035010                                                                  03501000
035020     MOVE PV-CURSOR-PO-NBR  TO IMCNUP-PO-NBR.                     03502000
035030     MOVE PV-CURSOR-UPC-NBR TO IMCNUP-UPC-NBR.                    03503000
035040*CHG102494 - START                                                03504008
035050     SET PS-TIMCNUP-RECORD-FOUND-NO TO TRUE.                      03505007
035060*CHG102494 - END                                                  03506008
035070     PERFORM 7270-SELECT-TIMCNUP-CHG.                             03507000
035080*CHG102494 - START                                                03508008
035090     IF PS-TIMCNUP-RECORD-FOUND                                   03509005
035100        PERFORM 7645-MOVE-TIMCNUP-TO-TAUCNUP                      03510007
035110        PERFORM 7185-DELETE-TIMCNUP-CHG                           03511007
035120        PERFORM 7080-INSERT-TAUCNUP                               03512007
035130        PERFORM 3480-DISPLAY-E-UPC                                03513007
035140        ADD +1 TO PA-TOT-CNUP-DELETES-E                           03514007
035150        ADD +1 TO PA-TOT-RECS-DELETED-E                           03515007
035160     END-IF.                                                      03516005
035170*CHG102494 - END                                                  03517008
035180                                                                  03518000
035190     PERFORM 7600-OPEN-CARTON-CURSOR.                             03519000
035200     PERFORM 7610-FETCH-CARTON-CURSOR.                            03520000
035210     IF PS-EOC-CARTON-CURSOR                                      03521000
035220         PERFORM 7605-CLOSE-CARTON-CURSOR                         03522000
035230     ELSE                                                         03523000
035240         PERFORM UNTIL PS-EOC-CARTON-CURSOR                       03524000
035250            PERFORM 7655-MOVE-CARTON-TO-AUDIT                     03525000
035260            PERFORM 7195-DELETE-CARTON-CHG                        03526000
035270            PERFORM 7085-INSERT-AUDIT-CARTON                      03527000
035280            PERFORM 3485-DISPLAY-E-CARTON                         03528000
035290            PERFORM 7610-FETCH-CARTON-CURSOR                      03529000
035300            ADD +1 TO PA-TOT-CNCT-DELETES-E                       03530000
035310            ADD +1 TO PA-TOT-RECS-DELETED-E                       03531000
035320            IF PS-EOC-CARTON-CURSOR                               03532000
035330                PERFORM 7605-CLOSE-CARTON-CURSOR                  03533000
035340            END-IF                                                03534000
035350         END-PERFORM                                              03535000
035360     END-IF.                                                      03536000
035370******************************************************************03537000
035380* THE CARTON ROW ON THE TRT_IMPRT_CART TABLE WAS NOT SENT ON THE *03538000
035390* CHANGE TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF THE    *03539000
035400* DB2 TABLE.                                                     *03540000
035410******************************************************************03541000
035420 3455-PROCESS-CART-E-DELETE-REC.                                  03542000
035430                                                                  03543000
035440     MOVE PV-CURSOR-PO-NBR  TO TRT00008-PO-NBR.                   03544000
035450     MOVE PV-CURSOR-UPC-NBR TO TRT00008-UPC-NBR.                  03545000
035460     MOVE PV-CURSOR-SSCC-NBR TO TRT00008-SSCC-ID.                 03546000
035470     SET PS-CNCT-DELETE-E-NOT-FOUND TO TRUE.                      03547000
035480     PERFORM 7225-SELECT-CARTON-CHG.                              03548000
035490     IF PS-CNCT-DELETE-E-FOUND                                    03549000
035500         PERFORM 7655-MOVE-CARTON-TO-AUDIT                        03550000
035510         PERFORM 7195-DELETE-CARTON-CHG                           03551000
035520         PERFORM 7085-INSERT-AUDIT-CARTON                         03552000
035530         PERFORM 3485-DISPLAY-E-CARTON                            03553000
035540         ADD +1 TO PA-TOT-CNCT-DELETES-E                          03554000
035550         ADD +1 TO PA-TOT-RECS-DELETED-E                          03555000
035560     END-IF.                                                      03556000
035570                                                                  03557000
035580******************************************************************03558000
035590* DISPLAY THE PURCHASE ORDER 'E' DELETE INFORMATION.             *03559000
035600******************************************************************03560000
035610 3460-DISPLAY-E-PO.                                               03561000
035620                                                                  03562000
035630     DISPLAY '**********************************'.                03563000
035640     DISPLAY '** TIMCNPO  E RECORD DELETE     **'.                03564000
035650     DISPLAY '** TIMCNPO CONTNR ID   = ' IMCNPO-CONTNR-ID.        03565000
035660     DISPLAY '** TIMCNPO PO NBR      = ' IMCNPO-PO-NBR.           03566000
035670     DISPLAY '**********************************'.                03567000
035680                                                                  03568000
035690******************************************************************03569000
035700* DISPLAY THE UPC 'E' DELETE INFORMATION.                        *03570000
035710******************************************************************03571000
035720 3480-DISPLAY-E-UPC.                                              03572000
035730                                                                  03573000
035740     DISPLAY '**********************************'.                03574000
035750     DISPLAY '** TIMCNUP  E  RECORD DELETE    **'.                03575000
035760     DISPLAY '** TIMCNUP CONTNR ID   = ' IMCNUP-CONTNR-ID.        03576000
035770     DISPLAY '** TIMCNUP PO NBR      = ' IMCNUP-PO-NBR.           03577000
035780     DISPLAY '** TIMCNUP UPC NBR     = ' IMCNUP-UPC-NBR.          03578000
035790     DISPLAY '**********************************'.                03579000
035800                                                                  03580000
035810******************************************************************03581000
035820* DISPLAY THE CARTON 'E' DELETE INFORMATION.                     *03582000
035830******************************************************************03583000
035840 3485-DISPLAY-E-CARTON.                                           03584000
035850                                                                  03585000
035860     DISPLAY '**********************************'.                03586000
035870     DISPLAY '** CARTON   E  RECORD DELETE    **'.                03587000
035880     DISPLAY '** CARTON  CONTNR ID   = ' TRT00008-CONTNR-ID.      03588000
035890     DISPLAY '** CARTON  PO NBR      = ' TRT00008-PO-NBR.         03589000
035900     DISPLAY '** CARTON  UPC NBR     = ' TRT00008-UPC-NBR.        03590000
035910     DISPLAY '** CARTON  SSCC ID     = ' TRT00008-SSCC-ID.        03591000
035920     DISPLAY '**********************************'.                03592000
035930                                                                  03593000
035940******************************************************************03594000
035950* CHECK TO SEE IF ANYTHING REALLY CHANGED ON THE CONTNR RECORDS. *03595000
035960* IF NO CHANGES, WRITE WARNING MESSAGE TO ERROR REPORT.          *03596000
035970******************************************************************03597000
035980 3490-NO-CHG-WRN-MSG.                                             03598000
035990                                                                  03599000
036000     INITIALIZE TR211-RECORD.                                     03600000
036010     INITIALIZE TR211-REC-TYP-CVYA.                               03601000
036020     MOVE PC-WARNING            TO TR211-ERROR-TYPE.              03602000
036030     MOVE 'CONTNR ID'           TO TR211-DATA-IN-ERROR.           03603000
036040     MOVE IMCNTK-CONTNR-ID      TO TR211-DATA-VALUE               03604000
036050                                   TR211-CONTNR-ID.               03605000
036060     MOVE 'CHANGE SENT & NOTHING CHANGED - NOT PROCESSED'         03606000
036070                                TO TR211-ERROR-MSG.               03607000
036080     MOVE PC-CVYA               TO TR211-REC-TYP-CVYA-CDE.        03608000
036090     MOVE PC-10                 TO TR211-SEQ-NBR-CVYA.            03609000
036100     MOVE PC-C                  TO TR211-TRN-TYP.                 03610000
036110                                                                  03611000
036120     MOVE IMCNTK-MOM-DPRTR-TMST (1:4)                             03612000
036130                                TO TR211-ACTL-DPRTR-DTE-MOM (1:4).03613000
036140     MOVE IMCNTK-MOM-DPRTR-TMST (6:2)                             03614000
036150                                TO TR211-ACTL-DPRTR-DTE-MOM (5:2).03615000
036160     MOVE IMCNTK-MOM-DPRTR-TMST (9:2)                             03616000
036170                                TO TR211-ACTL-DPRTR-DTE-MOM (7:2).03617000
036180     MOVE IMCNTK-MOM-DPRTR-TMST (12:2)                            03618000
036190                                TO TR211-ACTL-DPRTR-TM-MOM (1:2). 03619000
036200     MOVE IMCNTK-MOM-DPRTR-TMST (15:2)                            03620000
036210                                TO TR211-ACTL-DPRTR-TM-MOM (3:2). 03621000
036220     MOVE IMCNTK-MOM-IMPRT-VEH-NM TO TR211-CVYA-IMP-VEH-NM-MOM.   03622000
036230     MOVE IMCNTK-MOM-FOB-CDE    TO TR211-CVYA-ACTL-FOB-CDE-MOM.   03623000
036240     MOVE IMCNTK-MOM-DEST-POE-CDE                                 03624000
036250                                TO TR211-CVYA-DEST-POE-CDE-MOM.   03625000
036260     MOVE IMCNTK-MOM-TRIP-TYP-CDE                                 03626000
036270                                TO TR211-CVYA-TRIP-TYP-CDE-MOM.   03627000
036280     MOVE IMCNTK-MOM-POE-DELY-TMST (1:4)                          03628000
036290                     TO TR211-CVYA-EST-POE-DELY-DTE (1:4).        03629000
036300     MOVE IMCNTK-MOM-POE-DELY-TMST (6:2)                          03630000
036310                     TO TR211-CVYA-EST-POE-DELY-DTE (5:2).        03631000
036320     MOVE IMCNTK-MOM-POE-DELY-TMST (9:2)                          03632000
036330                     TO TR211-CVYA-EST-POE-DELY-DTE (7:2).        03633000
036340     MOVE IMCNTK-MOM-POE-DELY-TMST (12:2)                         03634000
036350                     TO TR211-CVYA-EST-POE-DELY-TM (1:2).         03635000
036360     MOVE IMCNTK-MOM-POE-DELY-TMST (15:2)                         03636000
036370                     TO TR211-CVYA-EST-POE-DELY-TM (3:2).         03637000
036380     MOVE IMCNTK-MOM-IMPRT-TRIP-ID     TO                         03638000
036390                        TR211-CVYA-IMPRT-TRIP-ID.                 03639000
036400     MOVE IMCNTK-MOM-CARR-SCAC-ID      TO                         03640000
036410                        TR211-CVYA-CARR-SCAC-ID.                  03641000
036420     MOVE IMCNTK-MOM-POR-CDE    TO TR211-CVYA-POR-CDE-MOM.        03642000
036430     MOVE IMCNTK-MOM-POL-CDE    TO TR211-CVYA-POL-CDE-MOM.        03643000
036440     MOVE IMCNTK-EST-LBD-NM     TO TR211-CVYA-EST-LBD-NM.         03644000
036450                                                                  03645000
036460     MOVE IMCNTK-EST-LBD-TMST (1:4)                               03646000
036470                     TO TR211-CVYA-EST-LBD-DTE (1:4).             03647000
036480     MOVE IMCNTK-EST-LBD-TMST (6:2)                               03648000
036490                     TO TR211-CVYA-EST-LBD-DTE (5:2).             03649000
036500     MOVE IMCNTK-EST-LBD-TMST (9:2)                               03650000
036510                     TO TR211-CVYA-EST-LBD-DTE (7:2).             03651000
036520     MOVE IMCNTK-EST-LBD-TMST (12:2)                              03652000
036530                     TO TR211-CVYA-EST-LBD-TM (1:2).              03653000
036540     MOVE IMCNTK-EST-LBD-TMST (15:2)                              03654000
036550                     TO TR211-CVYA-EST-LBD-TM (3:2).              03655000
036560     MOVE IMCNTK-DAT-SRC-ENT-ID TO TR211-DAT-SRC-ENT-ID.          03656000
036570                                                                  03657000
036580     MOVE TR023-CNTR-PROCESS-SEQ-NBR-1 TO                         03658000
036590                                       TR211-PROCESS-SEQ-NBR.     03659000
036600                                                                  03660000
036610     PERFORM 6200-WRITE-LOAD-REPORT.                              03661000
036620                                                                  03662000
036630******************************************************************03663000
036640* ADD CNTNR PO 'DELETE' RECORD TO DB2 WORKTABLE TRTW_CONTNR_CKPR *03664000
036650* TO EVENTUALLY BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES. *03665000
036660******************************************************************03666000
036670 3495-SCM-CONPO-DELETE.                                           03667000
036680     INITIALIZE TR405-MESSAGE-LAYOUT.                             03668000
036690     MOVE 'D'                        TO TR405-ACTN-CDE.           03669000
036700     MOVE 'CONTNR RELATIONSHIP DEL'  TO TR405-EVENT-TYP.          03670000
036710     MOVE IMCNPO-PO-NBR              TO TR405-PO-NBR.             03671000
036720     MOVE IMCNPO-EXTL-REF-NBR        TO TR405-EXTL-REF-NBR.       03672000
036730     MOVE IMCNTK-CONTNR-ID           TO TR405-CONTNR-ID.          03673000
036740     MOVE IMCNTK-CONTNR-SEQ-NBR      TO TR405-CONTNR-SEQ-NBR.     03674000
036750     MOVE IMCNTK-ORGN-SHPD-FR-CDE    TO TR405-ORGN-SHPD-FR-CDE.   03675000
036760     MOVE TR405-MESSAGE-LAYOUT TO TRT00039-CKPR-REC-1-TXT.        03676000
036770     PERFORM 7099-INSERT-SCM-MESSAGE.                             03677000
036780                                                                  03678000
036790******************************************************************03679000
036800* INSERT ERROR  RECORDS INTO THE ERROR/DETAIL REPORT TABLE       *03680000
036810* DEPENDING ON THE RECORD TYPE CODE.                             *03681000
036820******************************************************************03682000
036830 3500-CHECK-MOVE-TO-REPORT.                                       03683000
036840                                                                  03684000
036850     MOVE TR023-CNTR-REC-TYP-CDE TO PV-REC-TYP-CDE.               03685000
036860                                                                  03686000
036870     EVALUATE TRUE                                                03687000
036880         WHEN PV-REC-TYP-CNTR                                     03688000
036890             PERFORM 5800-LOAD-CVYA-TO-REPORT                     03689000
036900             IF TR023-CNTR-PROCESS-SEQ-NBR-2 > ZEROS              03690000
036910                 PERFORM 5805-LOAD-CVYB-TO-REPORT                 03691000
036920             END-IF                                               03692000
036930             PERFORM 5810-LOAD-CONA-TO-REPORT                     03693000
036940             PERFORM 5815-LOAD-CONB-TO-REPORT                     03694000
036950                                                                  03695000
036960         WHEN PV-REC-TYP-CONPO                                    03696000
036970             PERFORM 5820-LOAD-CONPOA-TO-REPORT                   03697000
036980             PERFORM 5825-LOAD-CONPOB-TO-REPORT                   03698000
036990             PERFORM 5830-LOAD-CONPOC-TO-REPORT                   03699000
037000                                                                  03700000
037010         WHEN PV-REC-TYP-CONUPC                                   03701000
037020             PERFORM 5840-LOAD-CONUPA-TO-REPORT                   03702000
037030             PERFORM 5845-LOAD-CONUPB-TO-REPORT                   03703000
037040             PERFORM 5850-LOAD-CONUPC-TO-REPORT                   03704000
037050                                                                  03705000
037060         WHEN PV-REC-TYP-CNCART                                   03706000
037070             PERFORM 5860-LOAD-CNCART-TO-REPORT                   03707000
037080                                                                  03708000
037090         WHEN PV-REC-TYP-CNSEAL                                   03709000
037100             PERFORM 5865-LOAD-CNSEAL-TO-REPORT                   03710000
037110     END-EVALUATE.                                                03711000
037120                                                                  03712000
037130******************************************************************03713000
037140* PROCESS CNCART CONTAINER CARTON LEVEL RECORDS.                 *03714000
037150* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *03715000
037160******************************************************************03716000
037170 3600-PROCESS-CNCART-REC.                                         03717000
037180                                                                  03718000
037190     PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD.                        03719000
037200                                                                  03720000
037210     MOVE TR023-CNCART-TRN-TYP TO PV-TRN-TYP-CDE.                 03721000
037220                                                                  03722000
037230     ADD +1 TO PV-CARTON-REC-COUNT-TOTAL.                         03723000
037240                                                                  03724000
037250     IF TR023-CNCART-PO-NBR = PV-HOLD-PO-NBR                      03725000
037260       IF PURCHS-PO-TYP-CDE = ('IM' OR 'IE' OR 'IF')              03726012
037270           CONTINUE                                               03727000
037280       ELSE                                                       03728000
037290           ADD +1 TO PV-CARTON-COUNT-PER-PO                       03729000
037300       END-IF                                                     03730000
037310     END-IF.                                                      03731000
037320                                                                  03732000
037330     EVALUATE TRUE                                                03733000
037340         WHEN PV-TRN-TYP-ADD                                      03734000
037350             PERFORM 3620-PROCESS-CNCART-ADD                      03735000
037360                                                                  03736000
037370         WHEN PV-TRN-TYP-CHG                                      03737000
037380             PERFORM 3610-PROCESS-CNCART-CHANGE                   03738000
037390     END-EVALUATE.                                                03739000
037400                                                                  03740000
037410     IF PS-NEW-CARTON OR                                          03741000
037420        PS-END-OF-FILE                                            03742000
037430         SET PS-NEW-CARTON-NO  TO TRUE                            03743000
037440         SET PS-GOOD-RECORD-NO TO TRUE                            03744000
037450     ELSE                                                         03745000
037460         PERFORM 6000-READ-CONTAINER-FILE                         03746000
037470             UNTIL PS-GOOD-RECORD      OR                         03747000
037480                   PS-END-OF-FILE                                 03748000
037490         SET PS-GOOD-RECORD-NO TO TRUE                            03749000
037500         PERFORM 3682-BULK-EDITS-ODDLOT-CARTON                    03750000
037510                                                                  03751000
037520         IF PURCHS-PO-TYP-CDE = ('IM' OR 'IE' OR 'IF')            03752012
037530             CONTINUE                                             03753000
037540         ELSE                                                     03754000
037550             PERFORM 3690-LANDED-PO-CART-EDIT                     03755000
037560         END-IF                                                   03756000
037570     END-IF.                                                      03757000
037580                                                                  03758000
037590******************************************************************03759000
037600* PROCESS CNCART CHANGE TRANSACTIONS.                            *03760000
037610******************************************************************03761000
037620 3610-PROCESS-CNCART-CHANGE.                                      03762000
037630                                                                  03763000
037640     PERFORM 7210-SELECT-CARTON.                                  03764000
037650                                                                  03765000
037660     IF PS-CNCT-FOUND                                             03766000
037670         PERFORM 3612-CONTINUE-CNCART-CHANGE                      03767000
037680     ELSE                                                         03768000
037690         IF PS-CNTK-FOUND OR                                      03769000
037700            PS-CNPO-FOUND OR                                      03770000
037710            PS-CNUP-FOUND                                         03771000
037720*            MOVE PC-WARNING         TO TR211-ERROR-TYPE          03772000
037730*            MOVE TR023-CNCART-SSCC-NBR TO TR211-DATA-VALUE       03773000
037740*            MOVE 'CARTON LEVEL'     TO TR211-DATA-IN-ERROR       03774000
037750*            MOVE                                                 03775000
037760*             'CHANGE SENT - CARTON NOT FOUND - CARTON ADDED'     03776000
037770*                                    TO TR211-ERROR-MSG           03777000
037780             SET PS-CHANGE-ADD-Z     TO TRUE                      03778000
037790*            PERFORM 5860-LOAD-CNCART-TO-REPORT                   03779000
037800             ADD +1 TO PA-TOT-CNCT-CHANGES-Z                      03780000
037810             ADD +1 TO PA-TOT-RECS-CHANGED-Z                      03781000
037820         ELSE                                                     03782000
037830             SET PS-CHANGE-ADD-B       TO TRUE                    03783000
037840             ADD +1 TO PA-TOT-CNCT-CHANGES-B                      03784000
037850             ADD +1 TO PA-TOT-RECS-CHANGED-B                      03785000
037860         END-IF                                                   03786000
037870         SET PS-CHANGE-FOUND TO TRUE                              03787000
037880         PERFORM 7288-SELECT-CONTNR-SEQ-NBR                       03788000
037890         PERFORM 3620-PROCESS-CNCART-ADD                          03789000
037900         IF PS-CHANGE-ADD-B-NO                                    03790000
037910             PERFORM 3616-LOAD-PO-UPC-CART-TAB-CART               03791000
037920         END-IF                                                   03792000
037930         SET PS-CHANGE-ADD-Z-NO TO TRUE                           03793000
037940     END-IF.                                                      03794000
037950                                                                  03795000
037960******************************************************************03796000
037970* PROCESS CNCART CHANGE TRANSACTIONS.                            *03797000
037980******************************************************************03798000
037990 3612-CONTINUE-CNCART-CHANGE.                                     03799000
038000                                                                  03800000
038010     PERFORM 7655-MOVE-CARTON-TO-AUDIT.                           03801000
038020                                                                  03802000
038030     SET PS-CHANGE-FOUND-CNCART-NO TO TRUE.                       03803000
038040                                                                  03804000
038050     PERFORM 5560-MOVE-CNCART-TO-DCLGEN.                          03805000
038060                                                                  03806000
038070     IF PURCHS-PKGNG-CDE = PC-B OR PC-C OR PC-S OR PC-SPACE       03807000
038080         PERFORM 3680-BULK-EDITS-CARTON                           03808000
038090     ELSE                                                         03809000
038100         IF (PURCHS-PKGNG-CDE = PC-I OR PC-M) AND                 03810000
038110            (IMCNUP-ASN-PKGNG-CDE = 'AS')                         03811000
038120             PERFORM 3685-PREPACK-EDITS-CARTON                    03812000
038130         END-IF                                                   03813000
038140     END-IF.                                                      03814000
038150                                                                  03815000
038160     PERFORM 3614-COMPARE-FOR-CNCART-CHANGE.                      03816000
038170     IF PS-CHANGE-FOUND-CNCART                                    03817000
038180         PERFORM 7195-DELETE-CARTON-CHG                           03818000
038190         PERFORM 7085-INSERT-AUDIT-CARTON                         03819000
038200         PERFORM 7100-SET-CURRENT-TMST                            03820000
038210         MOVE TRT00008-CONTNR-SEQ-NBR TO PV-HOLD-CONTNR-SEQ-NBR   03821000
038220         PERFORM 7045-INSERT-CARTON                               03822000
038230         IF PS-GOOD-CNCT-INSERT                                   03823000
038240             PERFORM 5716-MOVE-CNCT-DETAIL                        03824000
038250             PERFORM 7255-SELECT-TIMCNPO                          03825000
038260             IF PS-CNPO-FOUND AND                                 03826000
038270                IMCNPO-SPLT-XMIT-CDE NOT EQUAL SPACES             03827000
038280                 PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO             03828000
038290                 PERFORM 7060-INSERT-TAUCNPO                      03829000
038300                 PERFORM 7259-UPDATE-TIMCNPO                      03830000
038310             END-IF                                               03831000
038320             PERFORM 7033-SELECT-TIMCNRL                          03832000
038330             IF PS-TIMCNRL-FOUND                                  03833000
038340               IF IMCNRL-DCONSLR-RLSE-CDE = PC-R OR PC-Y          03834000
038350                   PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL           03835000
038360                   MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE           03836000
038370                   PERFORM 7034-UPDATE-TIMCNRL                    03837000
038380               END-IF                                             03838000
038390             END-IF                                               03839000
038400         ELSE                                                     03840000
038410             PERFORM 3650-PROCESS-CARTON-ERROR                    03841000
038420                 UNTIL PS-NEW-CARTON OR                           03842000
038430                       PS-END-OF-FILE                             03843000
038440         END-IF                                                   03844000
038450         ADD +1 TO PA-TOT-RECS-CHANGED                            03845000
038460         ADD +1 TO PA-TOT-CNCT-CHANGES                            03846000
038470     END-IF.                                                      03847000
038480                                                                  03848000
038490     IF PS-NEW-CARTON-NO                                          03849000
038500         PERFORM 3616-LOAD-PO-UPC-CART-TAB-CART                   03850000
038510     END-IF.                                                      03851000
038520                                                                  03852000
038530******************************************************************03853000
038540* COMPARE THE INPUT FIELDS THAT WERE LOADED INTO TRT_IMPRT_CART  *03854000
038550* DCLGEN FIELDS AGAINST THE TRT_IMPRT_CART FIELDS THAT WERE      *03855000
038560* LOADED INTO THE TRT_AUD_IMPRT_CART FIELDS TO SEE IF A CHANGE   *03856000
038570* HAS OCCURRED.                                                  *03857000
038580******************************************************************03858000
038590 3614-COMPARE-FOR-CNCART-CHANGE.                                  03859000
038600                                                                  03860000
038610     IF TRT00009-UNT-QTY NOT EQUAL TRT00008-UNT-QTY               03861000
038620         SET PS-CHANGE-FOUND-CNCART TO TRUE                       03862000
038630         SET PS-CHANGE-FOUND        TO TRUE                       03863000
038640     END-IF.                                                      03864000
038650                                                                  03865000
038660******************************************************************03866000
038670* LOAD THE PO/UPC/CARTON TABLE WITH THE CONTAINER CARTON NUMBER  *03867000
038680******************************************************************03868000
038690 3616-LOAD-PO-UPC-CART-TAB-CART.                                  03869000
038700                                                                  03870000
038710     SET PO-INDX TO +1.                                           03871000
038720                                                                  03872000
038730     SEARCH PV-PO-UPC-CART-TABLE-ENTRY VARYING PO-INDX            03873000
038740         AT END                                                   03874000
038750           CONTINUE                                               03875000
038760       WHEN TR023-CNCART-PO-NBR EQUAL PV-TABLE-PO-NBR (PO-INDX)   03876000
038770              AND                                                 03877000
038780            TR023-CNCART-UPC-NBR EQUAL PV-TABLE-UPC-NBR (PO-INDX) 03878000
038790            IF PV-TABLE-SSCC-NBR (PO-INDX) EQUAL SPACES           03879000
038800                MOVE TR023-CNCART-SSCC-NBR      TO                03880000
038810                         PV-TABLE-SSCC-NBR (PO-INDX)              03881000
038820            ELSE                                                  03882000
038830                PERFORM UNTIL PV-TABLE-PO-NBR (PO-INDX)           03883000
038840                               EQUAL ZEROES OR                    03884000
038850                               PO-INDX > 20000                    03885000
038860                    SET PO-INDX UP BY +1                          03886000
038870                END-PERFORM                                       03887000
038880                MOVE TR023-CNCART-PO-NBR         TO               03888000
038890                          PV-TABLE-PO-NBR (PO-INDX)               03889000
038900                MOVE TR023-CNCART-UPC-NBR        TO               03890000
038910                          PV-TABLE-UPC-NBR (PO-INDX)              03891000
038920                MOVE TR023-CNCART-SSCC-NBR       TO               03892000
038930                          PV-TABLE-SSCC-NBR (PO-INDX)             03893000
038940            END-IF                                                03894000
038950     END-SEARCH.                                                  03895000
038960                                                                  03896000
038970     SET PO-INDX UP BY +1.                                        03897000
038980                                                                  03898000
038990******************************************************************03899000
039000* PROCESS CNCART CONTAINER CARTON RECORD ADD TRANSACTIONS.       *03900000
039010******************************************************************03901000
039020 3620-PROCESS-CNCART-ADD.                                         03902000
039030                                                                  03903000
039040     IF TR023-CNCART-TRN-TYP = PC-A                               03904000
039050         PERFORM 7210-SELECT-CARTON                               03905000
039060     END-IF.                                                      03906000
039070                                                                  03907000
039080     IF PS-CNCT-FOUND                                             03908000
039090         SET PS-CNCT-PREV-SENT-ERR TO TRUE                        03909000
039100         MOVE PC-ERROR         TO TR211-ERROR-TYPE                03910000
039110         MOVE TRT00008-SSCC-ID TO TR211-DATA-VALUE                03911000
039120         MOVE 'SSCC ID'        TO TR211-DATA-IN-ERROR             03912000
039130         MOVE 'ADD SENT, SSCC PREVIOUSLY SENT - NOT PROCESSED'    03913000
039140                              TO TR211-ERROR-MSG                  03914000
039150         SET PS-EDI-RECORD-NO  TO TRUE                            03915000
039160         PERFORM 3650-PROCESS-CARTON-ERROR                        03916000
039170             UNTIL PS-NEW-CARTON  OR                              03917000
039180                   PS-END-OF-FILE                                 03918000
039190         SET PS-CNCT-PREV-SENT-ERR-NO TO TRUE                     03919000
039200     ELSE                                                         03920000
039210         PERFORM 7215-SELECT-CARTON-DUPLICATES                    03921000
039220         IF PS-CART-DUP-FOUND                                     03922000
039230             MOVE PC-WARNING       TO TR211-ERROR-TYPE            03923000
039240             MOVE TRT00008-SSCC-ID TO TR211-DATA-VALUE            03924000
039250             MOVE 'SSCC ID'        TO TR211-DATA-IN-ERROR         03925000
039260             MOVE                                                 03926000
039270             'DUPLICATE SSCC FOR SAME CONT/PO BUT DIFFERENT UPC'  03927000
039280                                   TO TR211-ERROR-MSG             03928000
039290             PERFORM 5860-LOAD-CNCART-TO-REPORT                   03929000
039300             PERFORM 5560-MOVE-CNCART-TO-DCLGEN                   03930000
039310         ELSE                                                     03931000
039320             INITIALIZE DCLTRT00008                               03932000
039330             PERFORM 7100-SET-CURRENT-TMST                        03933000
039340             MOVE PV-CURRENT-TMST TO TRT00008-CRE-TMST            03934000
039350             PERFORM 5560-MOVE-CNCART-TO-DCLGEN                   03935000
039360             IF PURCHS-PKGNG-CDE = PC-B OR PC-C OR PC-S OR        03936000
039370                                   PC-SPACE                       03937000
039380                 PERFORM 3680-BULK-EDITS-CARTON                   03938000
039390             ELSE                                                 03939000
039400                 IF (PURCHS-PKGNG-CDE = PC-I OR PC-M) AND         03940000
039410                    (IMCNUP-ASN-PKGNG-CDE = 'AS')                 03941000
039420                     PERFORM 3685-PREPACK-EDITS-CARTON            03942000
039430                 END-IF                                           03943000
039440             END-IF                                               03944000
039450         END-IF                                                   03945000
039460                                                                  03946000
039470*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  03947000
039480*PROBLEM AND IS TEMPORARY                                         03948000
039490*        IF TR023-CNCART-TRN-TYP = PC-C                           03949000
039500*            PERFORM 7220-SELECT-CARTON-OLD                       03950000
039510*            IF PS-CNCT-OLD-FOUND                                 03951000
039520*                PERFORM 7655-MOVE-CARTON-TO-AUDIT                03952000
039530*                PERFORM 7085-INSERT-AUDIT-CARTON                 03953000
039540*                PERFORM 7187-DELETE-CARTON                       03954000
039550*                PERFORM 5560-MOVE-CNCART-TO-DCLGEN               03955000
039560*                MOVE TRT00008-CONTNR-SEQ-NBR TO                  03956000
039570*                      PV-HOLD-CONTNR-SEQ-NBR                     03957000
039580*            END-IF                                               03958000
039590*        END-IF                                                   03959000
039600*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  03960000
039610*PROBLEM AND IS TEMPORARY                                         03961000
039620                                                                  03962000
039630         PERFORM 7045-INSERT-CARTON                               03963000
039640         IF PS-GOOD-CNCT-INSERT                                   03964000
039650             PERFORM 5716-MOVE-CNCT-DETAIL                        03965000
039660             PERFORM 7255-SELECT-TIMCNPO                          03966000
039670             IF PS-CNPO-FOUND AND                                 03967000
039680                IMCNPO-SPLT-XMIT-CDE NOT EQUAL SPACES             03968000
039690                 PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO             03969000
039700                 PERFORM 7060-INSERT-TAUCNPO                      03970000
039710                 PERFORM 7259-UPDATE-TIMCNPO                      03971000
039720             END-IF                                               03972000
039730             PERFORM 7033-SELECT-TIMCNRL                          03973000
039740             IF PS-TIMCNRL-FOUND                                  03974000
039750               IF IMCNRL-DCONSLR-RLSE-CDE = PC-R OR PC-Y          03975000
039760                   PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL           03976000
039770                   MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE           03977000
039780                   PERFORM 7034-UPDATE-TIMCNRL                    03978000
039790               END-IF                                             03979000
039800             END-IF                                               03980000
039810         ELSE                                                     03981000
039820             PERFORM 3650-PROCESS-CARTON-ERROR                    03982000
039830                 UNTIL PS-NEW-CARTON OR                           03983000
039840                       PS-END-OF-FILE                             03984000
039850         END-IF                                                   03985000
039860     END-IF.                                                      03986000
039870                                                                  03987000
039880******************************************************************03988000
039890* DELETE CONTAINER CARTON RECORD FROM CONTAINER CARTON TABLE     *03989000
039900* (TRT_IMPRT_CART).  THIS DELETE IS PERFORMED FROM THE CONTAINER *03990000
039910* LEVEL.                                                         *03991000
039920******************************************************************03992000
039930 3630-PROCESS-CNCART-DELETE.                                      03993000
039940                                                                  03994000
039950     PERFORM 7595-FETCH-CNCART-CURSOR.                            03995000
039960                                                                  03996000
039970     IF PS-EOC-CNCART-CURSOR                                      03997000
039980         PERFORM 7590-CLOSE-CNCART-CURSOR                         03998000
039990     ELSE                                                         03999000
040000         IF SQLCODE = +0                                          04000000
040010             MOVE TRT00008-PO-NBR   TO PV-HOLD-PO-NBR             04001000
040020             MOVE TRT00008-UPC-NBR  TO PV-HOLD-UPC-NBR            04002000
040030             MOVE TRT00008-SSCC-ID  TO PV-HOLD-SSCC-NBR           04003000
040040             PERFORM 7655-MOVE-CARTON-TO-AUDIT                    04004000
040050             PERFORM 7085-INSERT-AUDIT-CARTON                     04005000
040060             IF PS-GOOD-ACNUP-INSERT                              04006000
040070                 PERFORM 7187-DELETE-CARTON                       04007000
040080             END-IF                                               04008000
040090         ELSE                                                     04009000
040100             MOVE PC-ERROR             TO TR211-ERROR-TYPE        04010000
040110             MOVE TR023-CNCART-SSCC-NBR TO TR211-DATA-VALUE       04011000
040120             MOVE 'SSCC NUMBER'        TO TR211-DATA-IN-ERROR     04012000
040130             MOVE 'DELETE SENT - SSCC NOT FOUND - NOT DELETED'    04013000
040140                                       TO TR211-ERROR-MSG         04014000
040150             PERFORM 5860-LOAD-CNCART-TO-REPORT                   04015000
040160         END-IF                                                   04016000
040170     END-IF.                                                      04017000
040180                                                                  04018000
040190******************************************************************04019000
040200* THERE WAS A CARTON LEVEL ERROR - BYPASS THE CARTON RECORDS     *04020000
040210* THAT ARE RELATED TO THIS UPC/CARTON.                           *04021000
040220******************************************************************04022000
040230 3650-PROCESS-CARTON-ERROR.                                       04023000
040240                                                                  04024000
040250     IF PS-EDI-RECORD-NO                                          04025000
040260         PERFORM 3500-CHECK-MOVE-TO-REPORT                        04026000
040270     END-IF.                                                      04027000
040280                                                                  04028000
040290     PERFORM 6000-READ-CONTAINER-FILE.                            04029000
040300                                                                  04030000
040310     IF PS-EDI-RECORD                                             04031000
040320         CONTINUE                                                 04032000
040330     ELSE                                                         04033000
040340         IF (TR023-CNCART-CONTNR-ID      NOT EQUAL                04034000
040350             PV-HOLD-CONTNR-ID)                OR                 04035000
040360            (TR023-CNCART-ACTL-DPRTR-DTE NOT EQUAL                04036000
040370             PV-HOLD-ACTL-DPRTR-DTE-MOM)       OR                 04037000
040380            (TR023-CNCART-ACTL-DPRTR-TM  NOT EQUAL                04038000
040390             PV-HOLD-ACTL-DPRTR-TM-MOM)        OR                 04039000
040400            (TR023-CNCART-TRN-TYP        NOT EQUAL                04040000
040410             PV-HOLD-TRN-TYP)                  OR                 04041000
040420            (TR023-CNCART-PO-NBR         NOT EQUAL                04042000
040430             PV-HOLD-PO-NBR)                   OR                 04043000
040440            (TR023-CNCART-UPC-NBR        NOT EQUAL                04044000
040450             PV-HOLD-UPC-NBR)                  OR                 04045000
040460            (TR023-CNCART-SSCC-NBR       NOT EQUAL                04046000
040470             PV-HOLD-SSCC-NBR)                                    04047000
040480              SET PS-NEW-CARTON TO TRUE                           04048000
040490              PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD                04049000
040500         END-IF                                                   04050000
040510     END-IF.                                                      04051000
040520                                                                  04052000
040530******************************************************************04053000
040540* PERFORM EDIT FOR NUMBER OF CARTONS SENT                        *04054000
040550******************************************************************04055000
040560 3655-EDIT-CARTONS-SENT.                                          04056000
040570                                                                  04057000
040580     IF PURCHS-PKGNG-CDE = PC-B OR PC-C OR PC-S OR PC-SPACE       04058000
040590         IF IMCNUP-UPC-CART-CNT < PV-CARTON-REC-COUNT-TOTAL       04059000
040600             MOVE PC-WARNING    TO TR211-ERROR-TYPE               04060000
040610             INITIALIZE TR211-DATA-VALUE                          04061000
040620             INITIALIZE PV-EDIT-DATA-VALUE-FIELD                  04062000
040630             MOVE IMCNUP-UPC-CART-CNT       TO PV-EDIT-VALUE-1    04063000
040640             MOVE PC-SLASH                  TO PV-EDIT-SLASH      04064000
040650             MOVE PV-CARTON-REC-COUNT-TOTAL TO PV-EDIT-VALUE-2    04065000
040660             STRING PV-EDIT-VALUE-1                               04066000
040670                    PC-SLASH                                      04067000
040680                    PV-EDIT-VALUE-2                               04068000
040690                DELIMITED BY SIZE                                 04069000
040700                INTO TR211-DATA-VALUE                             04070000
040710             MOVE 'UPC CARTS/CARTS'   TO TR211-DATA-IN-ERROR      04071000
040720        MOVE 'BULK UPC CARTON COUNT < TOTAL OF SSCC IDS SENT'     04072000
040730                                      TO TR211-ERROR-MSG          04073000
040740             PERFORM 5870-LOAD-CNCART-TO-REPORT-PRV               04074000
040750         ELSE                                                     04075000
040760             IF IMCNUP-UPC-CART-CNT > PV-CARTON-REC-COUNT-TOTAL   04076000
040770                 MOVE PC-WARNING    TO TR211-ERROR-TYPE           04077000
040780                 INITIALIZE TR211-DATA-VALUE                      04078000
040790                 INITIALIZE PV-EDIT-DATA-VALUE-FIELD              04079000
040800                 MOVE IMCNUP-UPC-CART-CNT       TO PV-EDIT-VALUE-104080000
040810                 MOVE PC-SLASH                  TO PV-EDIT-SLASH  04081000
040820                 MOVE PV-CARTON-REC-COUNT-TOTAL TO PV-EDIT-VALUE-204082000
040830                 STRING PV-EDIT-VALUE-1                           04083000
040840                        PC-SLASH                                  04084000
040850                        PV-EDIT-VALUE-2                           04085000
040860                    DELIMITED BY SIZE                             04086000
040870                    INTO TR211-DATA-VALUE                         04087000
040880                 MOVE 'UPC CARTS/CARTS'   TO TR211-DATA-IN-ERROR  04088000
040890        MOVE 'BULK UPC CARTON COUNT > TOTAL OF SSCC IDS SENT'     04089000
040900                                          TO TR211-ERROR-MSG      04090000
040910                 PERFORM 5870-LOAD-CNCART-TO-REPORT-PRV           04091000
040920             END-IF                                               04092000
040930         END-IF                                                   04093000
040940     ELSE                                                         04094000
040950         IF (PURCHS-PKGNG-CDE = PC-I OR PC-M) AND                 04095000
040960            (IMCNUP-ASN-PKGNG-CDE = 'AS')                         04096000
040970             IF IMCNUP-UPC-CART-CNT < PV-CARTON-REC-COUNT-TOTAL   04097000
040980                 MOVE PC-WARNING    TO TR211-ERROR-TYPE           04098000
040990                 INITIALIZE TR211-DATA-VALUE                      04099000
041000                 INITIALIZE PV-EDIT-DATA-VALUE-FIELD              04100000
041010                 MOVE IMCNUP-UPC-CART-CNT    TO PV-EDIT-VALUE-1   04101000
041020                 MOVE PC-SLASH               TO PV-EDIT-SLASH     04102000
041030                 MOVE PV-CARTON-REC-COUNT-TOTAL                   04103000
041040                                             TO PV-EDIT-VALUE-2   04104000
041050                 STRING PV-EDIT-VALUE-1                           04105000
041060                        PC-SLASH                                  04106000
041070                        PV-EDIT-VALUE-2                           04107000
041080                    DELIMITED BY SIZE                             04108000
041090                    INTO TR211-DATA-VALUE                         04109000
041100                 MOVE 'UPC CARTS/CARTS'   TO TR211-DATA-IN-ERROR  04110000
041110        MOVE 'PACK UPC CARTON COUNT < TOTAL OF SSCC IDS SENT'     04111000
041120                                          TO TR211-ERROR-MSG      04112000
041130                 PERFORM 5870-LOAD-CNCART-TO-REPORT-PRV           04113000
041140             ELSE                                                 04114000
041150               IF IMCNUP-UPC-CART-CNT > PV-CARTON-REC-COUNT-TOTAL 04115000
041160                  MOVE PC-WARNING    TO TR211-ERROR-TYPE          04116000
041170                  INITIALIZE TR211-DATA-VALUE                     04117000
041180                  INITIALIZE PV-EDIT-DATA-VALUE-FIELD             04118000
041190                  MOVE IMCNUP-UPC-CART-CNT TO PV-EDIT-VALUE-1     04119000
041200                  MOVE PC-SLASH            TO PV-EDIT-SLASH       04120000
041210                  MOVE PV-CARTON-REC-COUNT-TOTAL                  04121000
041220                                           TO PV-EDIT-VALUE-2     04122000
041230                  STRING PV-EDIT-VALUE-1                          04123000
041240                         PC-SLASH                                 04124000
041250                         PV-EDIT-VALUE-2                          04125000
041260                     DELIMITED BY SIZE                            04126000
041270                     INTO TR211-DATA-VALUE                        04127000
041280                  MOVE 'UPC CARTS/CARTS'   TO TR211-DATA-IN-ERROR 04128000
041290        MOVE 'PACK UPC CARTON COUNT > TOTAL OF SSCC IDS SENT'     04129000
041300                                          TO TR211-ERROR-MSG      04130000
041310                  PERFORM 5870-LOAD-CNCART-TO-REPORT-PRV          04131000
041320               END-IF                                             04132000
041330             END-IF                                               04133000
041340         END-IF                                                   04134000
041350     END-IF.                                                      04135000
041360                                                                  04136000
041370     MOVE ZEROES TO PV-CARTON-REC-COUNT-TOTAL.                    04137000
041380                                                                  04138000
041390******************************************************************04139000
041400* PERFORM SPECIAL EDITS FOR BULK UPC RECORDS - CARTON LEVEL.     *04140000
041410******************************************************************04141000
041420 3680-BULK-EDITS-CARTON.                                          04142000
041430                                                                  04143000
041440     MOVE TRT00008-UNT-QTY TO PV-BULK-UNTS.                       04144000
041450     IF PV-BULK-UNTS = +0                                         04145000
041460         INITIALIZE TR211-REC-TYP-CNCART                          04146000
041470         MOVE PC-WARNING             TO TR211-ERROR-TYPE          04147000
041480         MOVE PV-PREPACK-UNTS        TO TR211-DATA-VALUE          04148000
041490         MOVE 'BULK UNTS  '          TO TR211-DATA-IN-ERROR       04149000
041500         MOVE 'BULK UNITS EQUAL ZERO - CARTON'                    04150000
041510                                     TO TR211-ERROR-MSG           04151000
041520         PERFORM 5860-LOAD-CNCART-TO-REPORT                       04152000
041530     END-IF.                                                      04153000
041540                                                                  04154000
041550*    PERFORM 7350-SELECT-TUPC-INFO.                               04155000
041560*    IF TRT00008-UNT-QTY NOT EQUAL UPC-OUTR-PK-QTY                04156000
041570     IF TRT00008-UNT-QTY NOT EQUAL PURITM-OUTR-PK-QTY             04157000
041580         ADD +1 TO PV-CARTON-REC-COUNT-BULK                       04158000
041590     END-IF.                                                      04159000
041600                                                                  04160000
041610******************************************************************04161000
041620* PERFORM SPECIAL EDITS FOR BULK UPC RECORDS - CARTON LEVEL.     *04162000
041630******************************************************************04163000
041640 3682-BULK-EDITS-ODDLOT-CARTON.                                   04164000
041650                                                                  04165000
041660     IF (TR023-CNTR-REC-TYP-CDE = PC-CNCART AND                   04166000
041670         TR023-CNCART-UPC-NBR EQUAL PV-HOLD-UPC-NBR AND           04167000
041680         PS-END-OF-FILE-NO)                                       04168000
041690         CONTINUE                                                 04169000
041700     ELSE                                                         04170000
041710         IF PV-CARTON-REC-COUNT-BULK > +1                         04171000
041720             MOVE PC-WARNING     TO TR211-ERROR-TYPE              04172000
041730             INITIALIZE TR211-DATA-VALUE                          04173000
041740             INITIALIZE PV-EDIT-DATA-VALUE-FIELD                  04174000
041750             MOVE TRT00008-UNT-QTY TO PV-EDIT-VALUE-1             04175000
041760             MOVE PC-SLASH         TO PV-EDIT-SLASH               04176000
041770*            MOVE UPC-OUTR-PK-QTY  TO PV-EDIT-VALUE-2             04177000
041780             MOVE PURITM-OUTR-PK-QTY                              04178000
041790                                   TO PV-EDIT-VALUE-2             04179000
041800             STRING PV-EDIT-VALUE-1                               04180000
041810                    PC-SLASH                                      04181000
041820                    PV-EDIT-VALUE-2                               04182000
041830                DELIMITED BY SIZE                                 04183000
041840                INTO TR211-DATA-VALUE                             04184000
041850             MOVE 'OTRPK CNSL/KHLS'   TO TR211-DATA-IN-ERROR      04185000
041860         MOVE 'BULK SSCC UNTS NOT=OUTR PACK QTY ON MAINFRAME PO'  04186000
041870                                      TO TR211-ERROR-MSG          04187000
041880             PERFORM 5870-LOAD-CNCART-TO-REPORT-PRV               04188000
041890         ELSE                                                     04189000
041900             IF PV-CARTON-REC-COUNT-BULK = +1                     04190000
041910              IF PS-UPC-OUTR-PACKS-WNG                            04191000
041920                 MOVE PC-WARNING     TO TR211-ERROR-TYPE          04192000
041930                 INITIALIZE TR211-DATA-VALUE                      04193000
041940                 INITIALIZE PV-EDIT-DATA-VALUE-FIELD              04194000
041950                 MOVE TRT00008-UNT-QTY TO PV-EDIT-VALUE-1         04195000
041960                 MOVE PC-SLASH         TO PV-EDIT-SLASH           04196000
041970*                MOVE UPC-OUTR-PK-QTY  TO PV-EDIT-VALUE-2         04197000
041980                 MOVE PURITM-OUTR-PK-QTY                          04198000
041990                                       TO PV-EDIT-VALUE-2         04199000
042000                 STRING PV-EDIT-VALUE-1                           04200000
042010                        PC-SLASH                                  04201000
042020                        PV-EDIT-VALUE-2                           04202000
042030                    DELIMITED BY SIZE                             04203000
042040                    INTO TR211-DATA-VALUE                         04204000
042050                 MOVE 'OTRPK CNSL/KHLS'    TO TR211-DATA-IN-ERROR 04205000
042060                 MOVE 'ODDLOT CARTON SENT' TO TR211-ERROR-MSG     04206000
042070                 PERFORM 5870-LOAD-CNCART-TO-REPORT-PRV           04207000
042080              END-IF                                              04208000
042090             END-IF                                               04209000
042100         END-IF                                                   04210000
042110     END-IF.                                                      04211000
042120                                                                  04212000
042130******************************************************************04213000
042140* PERFORM SPECIAL EDITS FOR PREPACK UPC RECORDS - CARTON LEVEL.  *04214000
042150******************************************************************04215000
042160 3685-PREPACK-EDITS-CARTON.                                       04216000
042170                                                                  04217000
042180     MOVE TRT00008-UNT-QTY TO PV-PREPACK-UNTS.                    04218000
042190     IF PV-PREPACK-UNTS = +0                                      04219000
042200         INITIALIZE TR211-REC-TYP-CNCART                          04220000
042210         MOVE PC-WARNING             TO TR211-ERROR-TYPE          04221000
042220         MOVE PV-PREPACK-UNTS        TO TR211-DATA-VALUE          04222000
042230         MOVE 'PRPCK UNTS '          TO TR211-DATA-IN-ERROR       04223000
042240         MOVE 'PREPACK UNITS EQUAL ZERO - CARTON'                 04224000
042250                                     TO TR211-ERROR-MSG           04225000
042260         PERFORM 5860-LOAD-CNCART-TO-REPORT                       04226000
042270     END-IF.                                                      04227000
042280                                                                  04228000
042290     IF PV-PREPACK-UNTS        > +0  AND                          04229000
042300        PV-POPRPK-UNT-QTY      > +0                               04230000
042310        IF PV-PREPACK-UNTS NOT EQUAL PV-POPRPK-UNT-QTY            04231000
042320            INITIALIZE TR211-REC-TYP-CNCART                       04232000
042330            MOVE PC-WARNING TO TR211-ERROR-TYPE                   04233000
042340            INITIALIZE TR211-DATA-VALUE                           04234000
042350            INITIALIZE PV-EDIT-DATA-VALUE-FIELD                   04235000
042360            MOVE PV-PREPACK-UNTS TO PV-EDIT-VALUE-1               04236000
042370            MOVE PC-SLASH TO PV-EDIT-SLASH                        04237000
042380            MOVE PV-POPRPK-UNT-QTY TO PV-EDIT-VALUE-2             04238000
042390            STRING PV-EDIT-VALUE-1                                04239000
042400                   PC-SLASH                                       04240000
042410                   PV-EDIT-VALUE-2                                04241000
042420               DELIMITED BY SIZE                                  04242000
042430               INTO TR211-DATA-VALUE                              04243000
042440            MOVE 'SENT/OTRPK UNTS'  TO                            04244000
042450                                    TR211-DATA-IN-ERROR           04245000
042460            MOVE 'SSCC CARTON UNTS NOT=PCK UNTS ON MAINFRAME'     04246000
042470                                    TO TR211-ERROR-MSG            04247000
042480            PERFORM 5860-LOAD-CNCART-TO-REPORT                    04248000
042490        END-IF                                                    04249000
042500     END-IF.                                                      04250000
042510                                                                  04251000
042520******************************************************************04252000
042530* PERFORM SPECIAL EDIT FOR PO/CARTON RECORDS - CARTON LEVEL.     *04253000
042540******************************************************************04254000
042550 3690-LANDED-PO-CART-EDIT.                                        04255000
042560                                                                  04256000
042570     IF (TR023-CNTR-REC-TYP-CDE = PC-CNCART AND                   04257000
042580         TR023-CNCART-PO-NBR EQUAL PV-HOLD-PO-NBR) OR             04258000
042590        (TR023-CNTR-REC-TYP-CDE = PC-CONUPC AND                   04259000
042600         TR023-CNCART-PO-NBR EQUAL PV-HOLD-PO-NBR)                04260000
042610         CONTINUE                                                 04261000
042620     ELSE                                                         04262000
042630         IF PV-CARTON-COUNT-PER-PO NOT = IMCNPO-PO-CART-CNT       04263000
042640             MOVE PC-WARNING     TO TR211-ERROR-TYPE              04264000
042650             INITIALIZE TR211-DATA-VALUE                          04265000
042660             INITIALIZE PV-EDIT-DATA-VALUE-FIELD                  04266000
042670             MOVE PV-CARTON-COUNT-PER-PO TO PV-EDIT-VALUE-1       04267000
042680             MOVE PC-SLASH               TO PV-EDIT-SLASH         04268000
042690             MOVE IMCNPO-PO-CART-CNT     TO PV-EDIT-VALUE-2       04269000
042700             STRING PV-EDIT-VALUE-1                               04270000
042710                    PC-SLASH                                      04271000
042720                    PV-EDIT-VALUE-2                               04272000
042730                DELIMITED BY SIZE                                 04273000
042740                INTO TR211-DATA-VALUE                             04274000
042750             MOVE 'SSCC CTN/PO CTN'   TO TR211-DATA-IN-ERROR      04275000
042760            MOVE 'SSCC CARTON UNTS NOT= ASN PO LANDED CARTON UNTS'04276000
042770                                      TO TR211-ERROR-MSG          04277000
042780             PERFORM 5875-LOAD-CONPO-TO-REPORT-PRV                04278000
042790         END-IF                                                   04279000
042800     END-IF.                                                      04280000
042810                                                                  04281000
042820******************************************************************04282000
042830* PROCESS CNSEAL CONTAINER SEAL LEVEL RECORDS.                   *04283000
042840* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *04284000
042850******************************************************************04285000
042860 3700-PROCESS-CNSEAL-REC.                                         04286000
042870                                                                  04287000
042880     PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD.                        04288000
042890                                                                  04289000
042900     MOVE TR023-CNSEAL-TRN-TYP TO PV-TRN-TYP-CDE.                 04290000
042910                                                                  04291000
042920     EVALUATE TRUE                                                04292000
042930         WHEN PV-TRN-TYP-ADD                                      04293000
042940             PERFORM 3720-PROCESS-CNSEAL-ADD                      04294000
042950                                                                  04295000
042960         WHEN PV-TRN-TYP-CHG                                      04296000
042970             PERFORM 3710-PROCESS-CNSEAL-CHANGE                   04297000
042980     END-EVALUATE.                                                04298000
042990                                                                  04299000
043000     IF PS-NEW-SEAL OR                                            04300000
043010        PS-END-OF-FILE                                            04301000
043020         SET PS-NEW-SEAL-NO    TO TRUE                            04302000
043030         SET PS-GOOD-RECORD-NO TO TRUE                            04303000
043040     ELSE                                                         04304000
043050         PERFORM 6000-READ-CONTAINER-FILE                         04305000
043060             UNTIL PS-GOOD-RECORD      OR                         04306000
043070                   PS-END-OF-FILE                                 04307000
043080         SET PS-GOOD-RECORD-NO TO TRUE                            04308000
043090     END-IF.                                                      04309000
043100                                                                  04310000
043110******************************************************************04311000
043120* PROCESS CNSEAL CHANGE TRANSACTIONS.                            *04312000
043130******************************************************************04313000
043140 3710-PROCESS-CNSEAL-CHANGE.                                      04314000
043150                                                                  04315000
043160     PERFORM 7230-SELECT-SEAL.                                    04316000
043170                                                                  04317000
043180     IF PS-CNSL-FOUND                                             04318000
043190         PERFORM 3712-CONTINUE-CNSEAL-CHANGE                      04319000
043200     ELSE                                                         04320000
043210         IF PS-CNTK-FOUND OR                                      04321000
043220            PS-CNPO-FOUND OR                                      04322000
043230            PS-CNUP-FOUND                                         04323000
043240             MOVE PC-WARNING         TO TR211-ERROR-TYPE          04324000
043250             MOVE TR023-CNSEAL-CONTNR-SEAL-NBR TO                 04325000
043260                                        TR211-DATA-VALUE          04326000
043270             MOVE 'SEAL LEVEL'       TO TR211-DATA-IN-ERROR       04327000
043280             MOVE                                                 04328000
043290              'CHANGE SENT - SEAL NOT FOUND - SEAL ADDED'         04329000
043300                                     TO TR211-ERROR-MSG           04330000
043310             SET PS-CHANGE-ADD-Z     TO TRUE                      04331000
043320             PERFORM 5865-LOAD-CNSEAL-TO-REPORT                   04332000
043330             ADD +1 TO PA-TOT-CNSL-CHANGES-Z                      04333000
043340             ADD +1 TO PA-TOT-RECS-CHANGED-Z                      04334000
043350         ELSE                                                     04335000
043360             SET PS-CHANGE-ADD-B       TO TRUE                    04336000
043370             ADD +1 TO PA-TOT-CNSL-CHANGES-B                      04337000
043380             ADD +1 TO PA-TOT-RECS-CHANGED-B                      04338000
043390         END-IF                                                   04339000
043400         SET PS-CHANGE-FOUND TO TRUE                              04340000
043410         PERFORM 7288-SELECT-CONTNR-SEQ-NBR                       04341000
043420         PERFORM 3720-PROCESS-CNSEAL-ADD                          04342000
043430         IF PS-CHANGE-ADD-B-NO                                    04343000
043440             PERFORM 3716-LOAD-SEAL-TABLE                         04344000
043450         END-IF                                                   04345000
043460         SET PS-CHANGE-ADD-Z-NO TO TRUE                           04346000
043470     END-IF.                                                      04347000
043480                                                                  04348000
043490******************************************************************04349000
043500* PROCESS CNSEAL CHANGE TRANSACTIONS.                            *04350000
043510******************************************************************04351000
043520 3712-CONTINUE-CNSEAL-CHANGE.                                     04352000
043530                                                                  04353000
043540     SET PS-CHANGE-FOUND-CNSEAL-NO TO TRUE.                       04354000
043550     ADD +1 TO PA-TOT-RECS-CHANGED.                               04355000
043560     ADD +1 TO PA-TOT-CNSL-CHANGES.                               04356000
043570                                                                  04357000
043580     IF PS-NEW-SEAL-NO                                            04358000
043590         PERFORM 3716-LOAD-SEAL-TABLE                             04359000
043600     END-IF.                                                      04360000
043610                                                                  04361000
043620******************************************************************04362000
043630* LOAD THE SEAL TABLE WITH THE CONTAINER SEAL NUMBER.            *04363000
043640******************************************************************04364000
043650 3716-LOAD-SEAL-TABLE.                                            04365000
043660                                                                  04366000
043670     MOVE TR023-CNSEAL-CONTNR-SEAL-NBR TO                         04367000
043680                              PV-TABLE-SEAL-NBR (SEAL-INDX).      04368000
043690     SET SEAL-INDX UP BY +1.                                      04369000
043700                                                                  04370000
043710******************************************************************04371000
043720* PROCESS CNSEAL CONTAINER SEAL RECORD ADD TRANSACTIONS.         *04372000
043730******************************************************************04373000
043740 3720-PROCESS-CNSEAL-ADD.                                         04374000
043750                                                                  04375000
043760     IF TR023-CNSEAL-TRN-TYP = PC-A                               04376000
043770         PERFORM 7230-SELECT-SEAL                                 04377000
043780     END-IF.                                                      04378000
043790                                                                  04379000
043800     IF PS-CNSL-FOUND                                             04380000
043810       IF PS-LANDED-PO-NOT-FOUND                                  04381000
043820           MOVE PC-ERROR          TO TR211-ERROR-TYPE             04382000
043830           MOVE TRT00006-SEAL-NBR TO TR211-DATA-VALUE             04383000
043840           MOVE 'SEAL NUMBER '    TO TR211-DATA-IN-ERROR          04384000
043850*MAM       MOVE 'DUPLICATE SEAL NUMBER FOR THE SAME CONTAINER'    04385000
043860           MOVE 'ADD SENT, SEAL PREVIOUSLY SENT - NOT PROCESSED'  04386000
043870                                  TO TR211-ERROR-MSG              04387000
043880           SET PS-EDI-RECORD-NO   TO TRUE                         04388000
043890           PERFORM 3750-PROCESS-SEAL-ERROR                        04389000
043900               UNTIL PS-NEW-SEAL  OR                              04390000
043910                     PS-END-OF-FILE                               04391000
043920       ELSE                                                       04392000
043930           PERFORM 3750-PROCESS-SEAL-ERROR                        04393000
043940               UNTIL PS-NEW-SEAL  OR                              04394000
043950                     PS-END-OF-FILE                               04395000
043960       END-IF                                                     04396000
043970     ELSE                                                         04397000
043980         INITIALIZE DCLTRT00006                                   04398000
043990         PERFORM 7100-SET-CURRENT-TMST                            04399000
044000         MOVE PV-CURRENT-TMST TO TRT00006-CRE-TMST                04400000
044010         PERFORM 5570-MOVE-CNSEAL-TO-DCLGEN                       04401000
044020                                                                  04402000
044030*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  04403000
044040*PROBLEM AND IS TEMPORARY                                         04404000
044050*        IF TR023-CNSEAL-TRN-TYP = PC-C                           04405000
044060*            PERFORM 7230-SELECT-SEAL-OLD                         04406000
044070*            IF PS-CNSL-OLD-FOUND                                 04407000
044080*                PERFORM 7660-MOVE-SEAL-TO-AUDIT                  04408000
044090*                PERFORM 7095-INSERT-AUDIT-SEAL                   04409000
044100*                PERFORM 7197-DELETE-SEAL                         04410000
044110*                PERFORM 5570-MOVE-CNSEAL-TO-DCLGEN               04411000
044120*                MOVE TRT00006-CONTNR-SEQ-NBR TO                  04412000
044130*                      PV-HOLD-CONTNR-SEQ-NBR                     04413000
044140*            END-IF                                               04414000
044150*        END-IF                                                   04415000
044160*THE CODE WITHIN THESE COMMENTS WAS ADDED TO RESOLVE A TABLE KEY  04416000
044170*PROBLEM AND IS TEMPORARY                                         04417000
044180                                                                  04418000
044190         PERFORM 7090-INSERT-SEAL                                 04419000
044200         IF PS-GOOD-CNSL-INSERT                                   04420000
044210             PERFORM 5717-MOVE-CNSL-DETAIL                        04421000
044220             PERFORM 7255-SELECT-TIMCNPO                          04422000
044230             IF PS-CNPO-FOUND AND                                 04423000
044240                IMCNPO-SPLT-XMIT-CDE NOT EQUAL SPACES             04424000
044250                 PERFORM 7635-MOVE-TIMCNPO-TO-TAUCNPO             04425000
044260                 PERFORM 7060-INSERT-TAUCNPO                      04426000
044270                 PERFORM 7259-UPDATE-TIMCNPO                      04427000
044280             END-IF                                               04428000
044290             PERFORM 7033-SELECT-TIMCNRL                          04429000
044300             IF PS-TIMCNRL-FOUND                                  04430000
044310               IF IMCNRL-DCONSLR-RLSE-CDE = PC-R OR PC-Y          04431000
044320                   PERFORM 7650-MOVE-TIMCNRL-TO-TAUCNRL           04432000
044330                   MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE           04433000
044340                   PERFORM 7034-UPDATE-TIMCNRL                    04434000
044350               END-IF                                             04435000
044360             END-IF                                               04436000
044370         ELSE                                                     04437000
044380             PERFORM 3750-PROCESS-SEAL-ERROR                      04438000
044390                 UNTIL PS-NEW-SEAL OR                             04439000
044400                       PS-END-OF-FILE                             04440000
044410         END-IF                                                   04441000
044420     END-IF.                                                      04442000
044430                                                                  04443000
044440******************************************************************04444000
044450* DELETE CONTAINER SEAL RECORD FROM CONTAINER SEAL TABLE         *04445000
044460* (TRT_IMPRT_SEAL).  THIS DELETE IS PERFORMED FROM THE CONTAINER *04446000
044470* LEVEL.                                                         *04447000
044480******************************************************************04448000
044490 3730-PROCESS-CNSEAL-DELETE.                                      04449000
044500                                                                  04450000
044510     PERFORM 7625-FETCH-CNSEAL-CURSOR.                            04451000
044520                                                                  04452000
044530     IF PS-EOC-CNSEAL-CURSOR                                      04453000
044540         PERFORM 7620-CLOSE-CNSEAL-CURSOR                         04454000
044550     ELSE                                                         04455000
044560         IF SQLCODE = +0                                          04456000
044570             MOVE TRT00006-SEAL-NBR TO PV-HOLD-SEAL-NBR           04457000
044580             PERFORM 7660-MOVE-SEAL-TO-AUDIT                      04458000
044590             PERFORM 7095-INSERT-AUDIT-SEAL                       04459000
044600             PERFORM 7197-DELETE-SEAL                             04460000
044610         ELSE                                                     04461000
044620             MOVE PC-ERROR             TO TR211-ERROR-TYPE        04462000
044630             MOVE TR023-CNSEAL-CONTNR-SEAL-NBR TO                 04463000
044640                                       TR211-DATA-VALUE           04464000
044650             MOVE 'SEAL NUMBER'        TO TR211-DATA-IN-ERROR     04465000
044660             MOVE 'DELETE SENT - SEAL NOT FOUND - NOT DELETED'    04466000
044670                                       TO TR211-ERROR-MSG         04467000
044680             PERFORM 5865-LOAD-CNSEAL-TO-REPORT                   04468000
044690         END-IF                                                   04469000
044700     END-IF.                                                      04470000
044710                                                                  04471000
044720******************************************************************04472000
044730* THERE WAS A CONTAINER SEAL LEVEL ERROR - BYPASS THE SEAL       *04473000
044740* RECORDS THAT ARE RELATED TO THIS CONTAINER/SEAL.               *04474000
044750******************************************************************04475000
044760 3750-PROCESS-SEAL-ERROR.                                         04476000
044770                                                                  04477000
044780     IF PS-EDI-RECORD-NO                                          04478000
044790         PERFORM 3500-CHECK-MOVE-TO-REPORT                        04479000
044800     END-IF.                                                      04480000
044810                                                                  04481000
044820     PERFORM 6000-READ-CONTAINER-FILE.                            04482000
044830                                                                  04483000
044840     IF PS-EDI-RECORD                                             04484000
044850         CONTINUE                                                 04485000
044860     ELSE                                                         04486000
044870         IF (TR023-CNSEAL-CONTNR-ID      NOT EQUAL                04487000
044880             PV-HOLD-CONTNR-ID)                OR                 04488000
044890            (TR023-CNSEAL-ACTL-DPRTR-DTE NOT EQUAL                04489000
044900             PV-HOLD-ACTL-DPRTR-DTE-MOM)       OR                 04490000
044910            (TR023-CNSEAL-ACTL-DPRTR-TM  NOT EQUAL                04491000
044920             PV-HOLD-ACTL-DPRTR-TM-MOM)        OR                 04492000
044930            (TR023-CNSEAL-TRN-TYP        NOT EQUAL                04493000
044940             PV-HOLD-TRN-TYP)                  OR                 04494000
044950            (TR023-CNSEAL-CONTNR-SEAL-NBR NOT EQUAL               04495000
044960             PV-HOLD-SEAL-NBR)                                    04496000
044970              SET PS-NEW-SEAL TO TRUE                             04497000
044980              PERFORM 5500-MOVE-KEY-FIELDS-TO-HOLD                04498000
044990         END-IF                                                   04499000
045000     END-IF.                                                      04500000
045010                                                                  04501000
045020******************************************************************04502000
045030* DETERMINE IF IT'S TIME TO PROCESS THE SEAL INTERNAL TABLE      *04503000
045040******************************************************************04504000
045050 3800-SEAL-TABLE-COMPARE-CHECK.                                   04505000
045060                                                                  04506000
045070     PERFORM 7540-OPEN-SEAL-CURSOR.                               04507000
045080     PERFORM 7550-FETCH-SEAL-CURSOR.                              04508000
045090                                                                  04509000
045100     IF PS-EOC-SEAL-CURSOR                                        04510000
045110         PERFORM 7545-CLOSE-SEAL-CURSOR                           04511000
045120     ELSE                                                         04512000
045130         MOVE PV-CURSOR-SEAL-NBR TO PV-HOLD-SEAL-NBR              04513000
045140         PERFORM 3810-SEAL-TABLE-CURSOR-COMPARE                   04514000
045150             UNTIL PS-EOC-SEAL-CURSOR                             04515000
045160         SET PS-EOC-SEAL-CURSOR-NO TO TRUE                        04516000
045170     END-IF.                                                      04517000
045180                                                                  04518000
045190******************************************************************04519000
045200* COMPARE THE CONTAINER SEALS ON THE INTERNAL TABLE (WHICH WAS   *04520000
045210* LOADED WITH INPUT DATA) WITH THE ONES IN THE CURSOR FROM THE   *04521000
045220* TRT_IMPRT_SEAL TABLE.  THE OBJECTIVE OF THE COMPARE IS         *04522000
045230* TO IDENTIFY THE CONTAINER SEALS ON THE DB2 TABLES (THESE       *04523000
045240* ROWS WOULD BE IN THE CURSOR) THAT WERE NOT SENT WITH THE INPUT *04524000
045250* CHANGE TRANSACTION (THESE RECORDS WOULD BE IN THE INTERNAL     *04525000
045260* TABLE) AND DELETE THESE ROWS FROM THE TRT_IMPRT_SEAL TABLE.    *04526000
045270* THESE RECORDS ARE REFERED TO AS 'E' DELETES.                   *04527000
045280******************************************************************04528000
045290 3810-SEAL-TABLE-CURSOR-COMPARE.                                  04529000
045300                                                                  04530000
045310     SET SEAL-INDX     TO +1.                                     04531000
045320     SEARCH PV-SEAL-TABLE-ENTRY VARYING SEAL-INDX                 04532000
045330                                                                  04533000
045340        AT END                                                    04534000
045350          PERFORM 3820-SEAL-SEARCH-AT-END-ERR                     04535000
045360          PERFORM 7545-CLOSE-SEAL-CURSOR                          04536000
045370                                                                  04537000
045380        WHEN PV-TABLE-SEAL-NBR (SEAL-INDX) EQUAL SPACES           04538000
045390            PERFORM 3830-PROCESS-SEAL-E-DELETE-REC                04539000
045400            IF PV-CURSOR-SEAL-NBR NOT EQUAL                       04540000
045410               PV-HOLD-CURSOR-SEAL-NBR                            04541000
045420                MOVE PV-CURSOR-SEAL-NBR TO                        04542000
045430                      PV-HOLD-CURSOR-SEAL-NBR                     04543000
045440                PERFORM 7550-FETCH-SEAL-CURSOR                    04544000
045450                    UNTIL (PV-CURSOR-SEAL-NBR NOT =               04545000
045460                           PV-HOLD-CURSOR-SEAL-NBR) OR            04546000
045470                           PS-EOC-SEAL-CURSOR                     04547000
045480                IF PS-EOC-SEAL-CURSOR                             04548000
045490                    PERFORM 7545-CLOSE-SEAL-CURSOR                04549000
045500                END-IF                                            04550000
045510            ELSE                                                  04551000
045520                PERFORM UNTIL (PV-CURSOR-SEAL-NBR NOT EQUAL       04552000
045530                               PV-HOLD-CURSOR-SEAL-NBR) OR        04553000
045540                               PS-EOC-SEAL-CURSOR                 04554000
045550                  MOVE PV-CURSOR-SEAL-NBR TO                      04555000
045560                       PV-HOLD-CURSOR-SEAL-NBR                    04556000
045570                  PERFORM 7550-FETCH-SEAL-CURSOR                  04557000
045580                  IF PS-EOC-SEAL-CURSOR                           04558000
045590                      PERFORM 7545-CLOSE-SEAL-CURSOR              04559000
045600                  END-IF                                          04560000
045610                END-PERFORM                                       04561000
045620            END-IF                                                04562000
045630                                                                  04563000
045640        WHEN PV-TABLE-SEAL-NBR (SEAL-INDX) EQUAL                  04564000
045650             PV-CURSOR-SEAL-NBR                                   04565000
045660               MOVE PV-CURSOR-SEAL-NBR TO PV-HOLD-CURSOR-SEAL-NBR 04566000
045670               PERFORM UNTIL (PV-CURSOR-SEAL-NBR NOT EQUAL        04567000
045680                              PV-HOLD-CURSOR-SEAL-NBR) OR         04568000
045690                              PS-EOC-SEAL-CURSOR                  04569000
045700                 MOVE PV-CURSOR-SEAL-NBR TO                       04570000
045710                      PV-HOLD-CURSOR-SEAL-NBR                     04571000
045720                 PERFORM 7550-FETCH-SEAL-CURSOR                   04572000
045730                 IF PS-EOC-SEAL-CURSOR                            04573000
045740                     PERFORM 7545-CLOSE-SEAL-CURSOR               04574000
045750                 END-IF                                           04575000
045760               END-PERFORM                                        04576000
045770     END-SEARCH.                                                  04577000
045780                                                                  04578000
045790******************************************************************04579000
045800* THE INTERNAL CONTAINER SEAL TABLE HAS EXCEEDED ITS SIZE LIMIT. *04580000
045810* NOTE:  SOME CONTAINER SEALS THAT SHOULD HAVE BEEN DELETED MAY  *04581000
045820* NOT HAVE BEEN DELETED.                                         *04582000
045830******************************************************************04583000
045840 3820-SEAL-SEARCH-AT-END-ERR.                                     04584000
045850                                                                  04585000
045860     INITIALIZE TR211-REC-TYP-CNSEAL.                             04586000
045870                                                                  04587000
045880     MOVE PC-ERROR                      TO TR211-ERROR-TYPE.      04588000
045890     MOVE TR023-CNSEAL-CONTNR-ID        TO TR211-CONTNR-ID.       04589000
045900     MOVE TR023-CNSEAL-ACTL-DPRTR-DTE   TO                        04590000
045910                                       TR211-ACTL-DPRTR-DTE-MOM.  04591000
045920     MOVE TR023-CNSEAL-ACTL-DPRTR-TM    TO                        04592000
045930                                       TR211-ACTL-DPRTR-TM-MOM.   04593000
045940     MOVE TR023-CNSEAL-DAT-SRC-ENT-ID   TO TR211-DAT-SRC-ENT-ID.  04594000
045950                                                                  04595000
045960     MOVE SPACES                        TO TR211-REC-TYP-CNSEAL   04596000
045970                                           TR211-DATA-IN-ERROR    04597000
045980                                           TR211-DATA-VALUE       04598000
045990                                           TR211-TRN-TYP.         04599000
046000     MOVE 'CALL PROGRAMMING-INTERNAL SEAL TABLE SIZE EXCEEDED'    04600000
046010                                        TO TR211-ERROR-MSG.       04601000
046020     PERFORM 6200-WRITE-LOAD-REPORT.                              04602000
046030                                                                  04603000
046040******************************************************************04604000
046050* THE CONTAINER SEAL ROW ON THE TRT_IMPRT_SEAL TABLE WAS NOT SENT*04605000
046060* ON THE CHANGE TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF *04606000
046070* THE DB2 TABLE.                                                 *04607000
046080******************************************************************04608000
046090 3830-PROCESS-SEAL-E-DELETE-REC.                                  04609000
046100     MOVE PV-CURSOR-SEAL-NBR  TO TRT00006-SEAL-NBR.               04610000
046110     PERFORM 7240-SELECT-SEAL-CHG.                                04611000
046120     PERFORM 7660-MOVE-SEAL-TO-AUDIT.                             04612000
046130     PERFORM 7198-DELETE-SEAL-CHG.                                04613000
046140     PERFORM 7095-INSERT-AUDIT-SEAL.                              04614000
046150     PERFORM 3840-DISPLAY-E-SEAL.                                 04615000
046160     ADD +1 TO PA-TOT-CNSL-DELETES-E.                             04616000
046170     ADD +1 TO PA-TOT-RECS-DELETED-E.                             04617000
046180                                                                  04618000
046190******************************************************************04619000
046200* DISPLAY THE CONTAINER SEAL 'E' DELETE INFORMATION.             *04620000
046210******************************************************************04621000
046220 3840-DISPLAY-E-SEAL.                                             04622000
046230                                                                  04623000
046240     DISPLAY '**********************************'.                04624000
046250     DISPLAY '** TIMSEAL  E RECORD DELETE     **'.                04625000
046260     DISPLAY '** TIMSEAL CONTNR ID   = ' TRT00006-CONTNR-ID.      04626000
046270     DISPLAY '** TIMSEAL SEAL NBR    = ' TRT00006-SEAL-NBR.       04627000
046280     DISPLAY '**********************************'.                04628000
046290                                                                  04629000
046300******************************************************************04630000
046310* BUILD CONTAINER RULES FILE FOR DECONSOLIDATOR CONTROL          *04631000
046320* PROCESSING.                                                    *04632000
046330******************************************************************04633000
046340 3900-BUILD-CONTNR-RULES-FILE.                                    04634000
046350                                                                  04635000
046360     IF (IMCNTK-DVN-TMST = PC-DEFAULT-TMST AND                    04636000
046370         TR023-CNTR-TRN-TYP = PC-C)  OR                           04637000
046380         TR023-CNTR-TRN-TYP = PC-A   OR                           04638000
046390         TR023-CNTR-TRN-TYP = PC-D                                04639000
046400         PERFORM 3910-BUILD-CONTNR-RULE-RECORDS                   04640000
046410     END-IF.                                                      04641000
046420                                                                  04642000
046430******************************************************************04643000
046440* BUILD CONTAINER RULES FILE FOR DECONSOLIDATOR CONTROL          *04644000
046450* PROCESSING.                                                    *04645000
046460******************************************************************04646000
046470 3910-BUILD-CONTNR-RULE-RECORDS.                                  04647000
046480                                                                  04648000
046490     INITIALIZE TR265-CONTNR-RULES-REC.                           04649000
046500                                                                  04650000
046510     PERFORM 7110-SET-RULES-CURRENT-TMST.                         04651000
046520     MOVE PV-CURRENT-TMST-RULES   TO TR265-CONTNR-CURRENT-TMST.   04652000
046530                                                                  04653000
046540     EVALUATE TRUE                                                04654000
046550         WHEN TR023-CNTR-TRN-TYP-ADD                              04655000
046560             MOVE PC-A TO TR265-CONTNR-TRN-TYP                    04656000
046570         WHEN TR023-CNTR-TRN-TYP-CHG                              04657000
046580             IF PS-CHANGE-ADD-B                                   04658000
046590                 MOVE PC-A TO TR265-CONTNR-TRN-TYP                04659000
046600             ELSE                                                 04660000
046610                 MOVE PC-C TO TR265-CONTNR-TRN-TYP                04661000
046620             END-IF                                               04662000
046630         WHEN TR023-CNTR-TRN-TYP-DEL                              04663000
046640             MOVE PC-D TO TR265-CONTNR-TRN-TYP                    04664000
046650     END-EVALUATE.                                                04665000
046660                                                                  04666000
046670     MOVE PC-CMN                  TO TR265-CONTNR-REC-SRC.        04667000
046680     MOVE IMCNTK-CONTNR-ID        TO TR265-CONTNR-ID.             04668000
046690     MOVE IMCNTK-DAT-SRC-ENT-ID   TO TR265-CONTNR-DAT-SRC-ENTID.  04669000
046700     MOVE IMCNTK-DVN-TMST         TO TR265-CONTNR-DVN-TMST.       04670000
046710     MOVE PV-HOLD-ISA-FILE-ID     TO TR265-CONTNR-FILE-ID.        04671000
046720     MOVE TR023-CNTR-SHIPT-ID     TO TR265-CONTNR-SHIPT-ID.       04672000
046730                                                                  04673000
046740     MOVE PV-HOLD-CONTNR-SEQ-NBR  TO TR265-CONTNR-SEQ-NBR-CUR.    04674000
046750     MOVE PV-TR265-CONTNR-SEQ-NBR-PREV TO                         04675000
046760                                     TR265-CONTNR-SEQ-NBR-PREV.   04676000
046770     MOVE IMCNTK-MOM-IMPRT-TRIP-ID                                04677000
046780                                  TO TR265-CONTNR-TRIP-ID-CUR.    04678000
046790     MOVE IMCNTK-MOM-DPRTR-TMST   TO                              04679000
046800                                  TR265-CONTNR-DPRTR-TMST-CUR.    04680000
046810     MOVE IMCNTK-MOM-POE-DELY-TMST TO                             04681000
046820                                  TR265-CONTNR-POE-DELY-TMST-CUR. 04682000
046830     MOVE IMCNTK-MOM-IMPRT-VEH-NM TO TR265-CONTNR-VEH-NM-CUR.     04683000
046840                                                                  04684000
046850     IF IMCNTK-MOM-FOB-CDE > SPACES                               04685000
046860         MOVE IMCNTK-MOM-FOB-CDE TO PV-COMPARE-MOM-FOB-CDE        04686000
046870         MOVE IMCNTK-MOM-TRIP-TYP-CDE TO PV-COMPARE-TRIP-TYP-CDE  04687000
046880         PERFORM 7780-EDIT-FOB-CDE-DCN                            04688000
046890         MOVE PV-TR265-FOB-CDE    TO TR265-CONTNR-FOB-CDE-CUR     04689000
046900     END-IF.                                                      04690000
046910                                                                  04691000
046920     IF IMCNTK-MOM-DEST-POE-CDE > SPACES                          04692000
046930         MOVE IMCNTK-MOM-DEST-POE-CDE TO PV-COMPARE-MOM-POE-CDE   04693000
046940         MOVE IMCNTK-MOM-TRIP-TYP-CDE TO PV-COMPARE-TRIP-TYP-CDE  04694000
046950         PERFORM 7690-EDIT-POE-CDE-DCN                            04695000
046960         MOVE PV-TR265-POE-CDE    TO TR265-CONTNR-POE-CDE-CUR     04696000
046970     END-IF.                                                      04697000
046980                                                                  04698000
046990     IF TR023-CNTR-TRN-TYP = PC-C AND PS-CHANGE-ADD-B-NO          04699000
047000         MOVE AUCNTK-CONTNR-SEQ-NBR   TO TR265-CONTNR-SEQ-NBR-PREV04700000
047010         MOVE AUCNTK-MOM-IMPRT-TRIP-ID                            04701000
047020                                      TO TR265-CONTNR-TRIP-ID-PREV04702000
047030         MOVE AUCNTK-MOM-DPRTR-TMST   TO                          04703000
047040                                      TR265-CONTNR-DPRTR-TMST-PREV04704000
047050         MOVE AUCNTK-MOM-POE-DELY-TMST TO                         04705000
047060                                    TR265-CONTNR-POE-DELY-TMST-PRV04706000
047070         MOVE AUCNTK-MOM-IMPRT-VEH-NM TO TR265-CONTNR-VEH-NM-PREV 04707000
047080                                                                  04708000
047090         IF AUCNTK-MOM-FOB-CDE > SPACES                           04709000
047100             MOVE AUCNTK-MOM-FOB-CDE TO PV-COMPARE-MOM-FOB-CDE    04710000
047110             MOVE AUCNTK-MOM-TRIP-TYP-CDE TO                      04711000
047120                                    PV-COMPARE-TRIP-TYP-CDE       04712000
047130             PERFORM 7780-EDIT-FOB-CDE-DCN                        04713000
047140             MOVE PV-TR265-FOB-CDE TO TR265-CONTNR-FOB-CDE-PREV   04714000
047150         END-IF                                                   04715000
047160                                                                  04716000
047170         IF AUCNTK-MOM-DEST-POE-CDE > SPACES                      04717000
047180             MOVE AUCNTK-MOM-DEST-POE-CDE                         04718000
047190                                      TO PV-COMPARE-MOM-POE-CDE   04719000
047200             MOVE AUCNTK-MOM-TRIP-TYP-CDE TO                      04720000
047210                                    PV-COMPARE-TRIP-TYP-CDE       04721000
047220             PERFORM 7690-EDIT-POE-CDE-DCN                        04722000
047230             MOVE PV-TR265-POE-CDE TO TR265-CONTNR-POE-CDE-PREV   04723000
047240         END-IF                                                   04724000
047250                                                                  04725000
047260     END-IF.                                                      04726000
047270                                                                  04727000
047280     MOVE TR265-COMMON-FIELDS1  TO TRT00033-RUL-REC-1-TXT.        04728000
047290     MOVE TR265-COMMON-FIELDS2  TO TRT00033-RUL-REC-2-TXT.        04729000
047300     PERFORM 7199-INSERT-LOAD-RULE-TABLE.                         04730000
047310                                                                  04731000
047320     MOVE ZEROES TO PV-TR265-CONTNR-SEQ-NBR-PREV.                 04732000
047330                                                                  04733000
047340******************************************************************04734000
047350*    SELECT CHECKPOINT RESTART CONTROL INFORMATION.              *04735000
047360******************************************************************04736000
047370 4000-GET-CHECKPOINT-CNTL.                                        04737000
047380                                                                  04738000
047390     PERFORM WITH TEST AFTER                                      04739000
047400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     04740000
047410         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             04741000
047420                 SQLCODE = ZERO                                   04742000
047430                                                                  04743000
047440         EXEC SQL                                                 04744000
047450           SELECT  CKPT_STAT_CODE                                 04745000
047460             INTO :PV-CKPT-STAT-CODE                              04746000
047470             FROM  TCKRSTCNTL                                     04747000
047480            WHERE  JOB_NAME = :CC-JOB-NAME                        04748000
047490              AND  PLAN_NAME = :PC-CURRENT-PROGRAM-NAME           04749000
047500            WITH UR                                               04750000
047510         END-EXEC                                                 04751000
047520                                                                  04752000
047530         EVALUATE TRUE                                            04753000
047540             WHEN SQLCODE = ZERO                                  04754000
047550             WHEN SQLCODE = -904                                  04755000
047560             WHEN SQLCODE = -913                                  04756000
047570                  CONTINUE                                        04757000
047580                                                                  04758000
047590             WHEN SQLWARN0 NOT EQUAL SPACE                        04759000
047600             WHEN SQLCODE NOT EQUAL ZERO                          04760000
047610                 DISPLAY '**************************************' 04761000
047620                 DISPLAY '** ABEND                            **' 04762000
047630                 DISPLAY '** PROGRAM = TRKUP215               **' 04763000
047640                 DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT- **' 04764000
047650                 DISPLAY '**                  CNTL            **' 04765000
047660                 DISPLAY '** SELECT FROM TCKRSTCNTL           **' 04766000
047670                 DISPLAY '**CKPT-STAT-CODE ='                     04767000
047680                 DISPLAY              TCKRSTCNTL-CKPT-STAT-CODE   04768000
047690                 DISPLAY '**************************************' 04769000
047700                 PERFORM 9100-SQL-ABEND                           04770000
047710         END-EVALUATE                                             04771000
047720     END-PERFORM.                                                 04772000
047730                                                                  04773000
047740     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    04774000
047750         SQLCODE NOT = ZERO                                       04775000
047760         DISPLAY '****************************************'       04776000
047770         DISPLAY '** MAX RETRIES EXCEEDED ON SELECT     **'       04777000
047780         DISPLAY '** FROM TCKRSTCNTL                    **'       04778000
047790         DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT-CNTL*'       04779000
047800         DISPLAY '****************************************'       04780000
047810         PERFORM 9100-SQL-ABEND                                   04781000
047820     END-IF.                                                      04782000
047830                                                                  04783000
047840 EJECT                                                            04784000
047850******************************************************************04785000
047860*    SELECT CHECKPOINT RESTART WORKING STORAGE DESCRIPTION INFO  *04786000
047870******************************************************************04787000
047880 4010-GET-CHECKPOINT-INFO.                                        04788000
047890                                                                  04789000
047900     PERFORM                                                      04790000
047910         WITH TEST AFTER                                          04791000
047920         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     04792000
047930         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            04793000
047940                 SQLCODE = ZERO                                   04794000
047950                                                                  04795000
047960         EXEC SQL                                                 04796000
047970           SELECT WORK_STRG_DESC                                  04797000
047980           INTO :TCKRSTINF-WORK-STRG-DESC                         04798000
047990           FROM TCKRSTINF                                         04799000
048000           WHERE JOB_NAME = :CC-JOB-NAME                          04800000
048010             AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME             04801000
048020           WITH UR                                                04802000
048030         END-EXEC                                                 04803000
048040                                                                  04804000
048050         EVALUATE TRUE                                            04805000
048060             WHEN SQLCODE = ZERO                                  04806000
048070             WHEN SQLCODE = -904                                  04807000
048080             WHEN SQLCODE = -913                                  04808000
048090                  CONTINUE                                        04809000
048100                                                                  04810000
048110             WHEN SQLWARN0 NOT EQUAL SPACE                        04811000
048120             WHEN SQLCODE NOT EQUAL ZERO                          04812000
048130                 DISPLAY '**************************************' 04813000
048140                 DISPLAY '** ABEND                            **' 04814000
048150                 DISPLAY '** PROGRAM = TRKUP215               **' 04815000
048160                 DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT- **' 04816000
048170                 DISPLAY '**                  INFO            **' 04817000
048180                 DISPLAY '** SELECT FROM TCKRSTINF            **' 04818000
048190                 DISPLAY '**************************************' 04819000
048200                 PERFORM 9100-SQL-ABEND                           04820000
048210         END-EVALUATE                                             04821000
048220     END-PERFORM.                                                 04822000
048230                                                                  04823000
048240     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    04824000
048250         SQLCODE NOT = ZERO                                       04825000
048260         DISPLAY '****************************************'       04826000
048270         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       04827000
048280         DISPLAY '** SELECT FROM TCKRSTINF              **'       04828000
048290         DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT-INFO*'       04829000
048300         DISPLAY '****************************************'       04830000
048310         PERFORM 9100-SQL-ABEND                                   04831000
048320     END-IF.                                                      04832000
048330                                                                  04833000
048340 EJECT                                                            04834000
048350******************************************************************04835000
048360*    SET THE TIME FOR THE NEXT CHECKPOINT.                       *04836000
048370******************************************************************04837000
048380 4020-SET-COMMIT-TIME.                                            04838000
048390                                                                  04839000
048400      EXEC SQL                                                    04840000
048410          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    04841000
048420          INTO :PV-HOLD-TMST                                      04842000
048430          FROM TCKRSTCNTL                                         04843000
048440          WHERE JOB_NAME = :CC-JOB-NAME                           04844000
048450            AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              04845000
048460          WITH UR                                                 04846000
048470      END-EXEC.                                                   04847000
048480                                                                  04848000
048490     EVALUATE TRUE                                                04849000
048500         WHEN SQLWARN0 NOT EQUAL SPACE                            04850000
048510         WHEN SQLCODE NOT EQUAL ZERO                              04851000
048520     DISPLAY '**********************************'                 04852000
048530     DISPLAY '** ABEND **'                                        04853000
048540     DISPLAY '** PROGRAM = TRKUP215 **'                           04854000
048550     DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME**'              04855000
048560     DISPLAY '**UNSUCESSFUL SET OF COMMIT INTERVAL**'             04856000
048570     DISPLAY 'IMCNTK CONTNR ID       = ' IMCNTK-CONTNR-ID         04857000
048580     DISPLAY 'IMCNTK SAIL DATE       = ' IMCNTK-MOM-DPRTR-TMST    04858000
048590     DISPLAY 'CONTAINER INPUT COUNT  = ' PV-CONT-INPUT-COUNT      04859000
048600     DISPLAY 'CNTK RECS INSERT COUNT = ' PA-TOT-CNTK-RECS-INSERT  04860000
048610     DISPLAY 'CNPO RECS INSERT COUNT = ' PA-TOT-CNPO-RECS-INSERT  04861000
048620     DISPLAY 'CNUP RECS INSERT COUNT = ' PA-TOT-CNUP-RECS-INSERT  04862000
048630     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-RECS-INSERT 04863000
048640     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-RECS-INSERT 04864000
048650     DISPLAY 'ACNUP REC INSERT COUNT = ' PA-TOT-ACNUP-RECS-INSERT 04865000
048660     DISPLAY 'CNRL RECS INSERT COUNT = ' PA-TOT-CNRL-RECS-INSERT  04866000
048670     DISPLAY 'ACNRL REC INSERT COUNT = ' PA-TOT-ACNRL-RECS-INSERT 04867000
048680     DISPLAY 'CNCT RECS INSERT COUNT = ' PA-TOT-CNCT-RECS-INSERT  04868000
048690     DISPLAY 'ACNCT REC INSERT COUNT = ' PA-TOT-ACNCT-RECS-INSERT 04869000
048700     DISPLAY 'CNSL RECS INSERT COUNT = ' PA-TOT-CNSL-RECS-INSERT  04870000
048710     DISPLAY 'ACNSL REC INSERT COUNT = ' PA-TOT-ACNSL-RECS-INSERT 04871000
048720     DISPLAY 'TOTAL RECS INSERTED    = ' PA-TOT-RECS-INSERTED     04872000
048730     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS   04873000
048740     DISPLAY 'CNTK RECS DELETE COUNT = ' PA-TOT-CNTK-RECS-DELETED 04874000
048750     DISPLAY 'CNPO RECS DELETE COUNT = ' PA-TOT-CNPO-RECS-DELETED 04875000
048760     DISPLAY 'CNUP RECS DELETE COUNT = ' PA-TOT-CNUP-RECS-DELETED 04876000
048770     DISPLAY 'CNRL RECS DELETE COUNT = ' PA-TOT-CNRL-RECS-DELETED 04877000
048780     DISPLAY 'CNCT RECS DELETE COUNT = ' PA-TOT-CNCT-RECS-DELETED 04878000
048790     DISPLAY 'CNSL RECS DELETE COUNT = ' PA-TOT-CNSL-RECS-DELETED 04879000
048800     DISPLAY 'TOTAL RECS DELETED     = ' PA-TOT-RECS-DELETED      04880000
048810     DISPLAY 'CNTK RECS SELECT COUNT = ' PA-TOT-CNTK-RECS-SELECT  04881000
048820     DISPLAY 'CNPO RECS SELECT COUNT = ' PA-TOT-CNPO-RECS-SELECT  04882000
048830     DISPLAY 'CNUP RECS SELECT COUNT = ' PA-TOT-CNUP-RECS-SELECT  04883000
048840     DISPLAY 'CNRL RECS SELECT COUNT = ' PA-TOT-CNRL-RECS-SELECT  04884000
048850     DISPLAY 'CNCT RECS SELECT COUNT = ' PA-TOT-CNCT-RECS-SELECT  04885000
048860     DISPLAY 'CNSL RECS SELECT COUNT = ' PA-TOT-CNSL-RECS-SELECT  04886000
048870     DISPLAY 'TOTAL RECS SELECTED    = ' PA-TOT-RECS-SELECTED     04887000
048880     DISPLAY 'CNTK CHANGE ADDS - B   = ' PA-TOT-CNTK-CHANGES-B    04888000
048890     DISPLAY 'CNPO CHANGE ADDS - B   = ' PA-TOT-CNPO-CHANGES-B    04889000
048900     DISPLAY 'CNUP CHANGE ADDS - B   = ' PA-TOT-CNUP-CHANGES-B    04890000
048910     DISPLAY 'CNCT CHANGE ADDS - B   = ' PA-TOT-CNCT-CHANGES-B    04891000
048920     DISPLAY 'CNSL CHANGE ADDS - B   = ' PA-TOT-CNSL-CHANGES-B    04892000
048930     DISPLAY 'TOTAL CHANGE ADDS- B   = ' PA-TOT-RECS-CHANGED-B    04893000
048940     DISPLAY 'CNPO CHANGE ADDS - Z   = ' PA-TOT-CNPO-CHANGES-Z    04894000
048950     DISPLAY 'CNUP CHANGE ADDS - Z   = ' PA-TOT-CNUP-CHANGES-Z    04895000
048960     DISPLAY 'CNCT CHANGE ADDS - Z   = ' PA-TOT-CNCT-CHANGES-Z    04896000
048970     DISPLAY 'CNSL CHANGE ADDS - Z   = ' PA-TOT-CNSL-CHANGES-Z    04897000
048980     DISPLAY 'TOTAL CHANGE ADDS- Z   = ' PA-TOT-RECS-CHANGED-Z    04898000
048990     DISPLAY 'CNPO DELETES     - E   = ' PA-TOT-CNPO-DELETES-E    04899000
049000     DISPLAY 'CNUP DELETES     - E   = ' PA-TOT-CNUP-DELETES-E    04900000
049010     DISPLAY 'CNCT DELETES     - E   = ' PA-TOT-CNCT-DELETES-E    04901000
049020     DISPLAY 'CNSL DELETES     - E   = ' PA-TOT-CNSL-DELETES-E    04902000
049030     DISPLAY 'TOTAL DELETES    - E   = ' PA-TOT-RECS-DELETED-E    04903000
049040     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         04904000
049050     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     04905000
049060     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    04906000
049070     DISPLAY 'TOTAL REPORT COUNT     = ' PA-TOTAL-REPORT-COUNT    04907000
049080     DISPLAY 'TOTAL RULE COUNT       = ' PA-TOTAL-RULE-COUNT      04908000
049090     DISPLAY '**********************************'                 04909000
049100                                                                  04910000
049110             PERFORM 9100-SQL-ABEND                               04911000
049120     END-EVALUATE.                                                04912000
049130                                                                  04913000
049140     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    04914000
049150         SQLCODE NOT = ZERO                                       04915000
049160         DISPLAY '****************************************'       04916000
049170         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       04917000
049180         DISPLAY '** SELECT FROM TCKRSTCNTL             **'       04918000
049190         DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME   **'       04919000
049200         DISPLAY '****************************************'       04920000
049210         PERFORM 9100-SQL-ABEND                                   04921000
049220     END-IF.                                                      04922000
049230                                                                  04923000
049240 EJECT                                                            04924000
049250******************************************************************04925000
049260*    CHECK TO SEE IF A COMMIT SHOULD BE TAKEN.                   *04926000
049270******************************************************************04927000
049280 4100-COMMIT-CHECK.                                               04928000
049290                                                                  04929000
049300     EXEC SQL                                                     04930000
049310       SET :PV-TMST = CURRENT TIMESTAMP                           04931000
049320     END-EXEC.                                                    04932000
049330                                                                  04933000
049340     EVALUATE TRUE                                                04934000
049350         WHEN SQLWARN0 NOT EQUAL SPACE                            04935000
049360         WHEN SQLCODE NOT EQUAL ZERO                              04936000
049370     DISPLAY '**********************************'                 04937000
049380     DISPLAY '** ABEND **'                                        04938000
049390     DISPLAY '** PROGRAM = TRKUP215***'                           04939000
049400     DISPLAY '** PARAGRAPH = 4100-COMMIT-CHECK**'                 04940000
049410     DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'                  04941000
049420     DISPLAY 'IMCNTK CONTNR ID      = ' IMCNTK-CONTNR-ID          04942000
049430     DISPLAY 'IMCNTK SAIL DATE       = ' IMCNTK-MOM-DPRTR-TMST    04943000
049440     DISPLAY 'CONTAINER INPUT COUNT  = ' PV-CONT-INPUT-COUNT      04944000
049450     DISPLAY 'CNTK RECS INSERT COUNT = ' PA-TOT-CNTK-RECS-INSERT  04945000
049460     DISPLAY 'CNPO RECS INSERT COUNT = ' PA-TOT-CNPO-RECS-INSERT  04946000
049470     DISPLAY 'CNUP RECS INSERT COUNT = ' PA-TOT-CNUP-RECS-INSERT  04947000
049480     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-RECS-INSERT 04948000
049490     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-RECS-INSERT 04949000
049500     DISPLAY 'ACNUP REC INSERT COUNT = ' PA-TOT-ACNUP-RECS-INSERT 04950000
049510     DISPLAY 'CNRL RECS INSERT COUNT = ' PA-TOT-CNRL-RECS-INSERT  04951000
049520     DISPLAY 'ACNRL REC INSERT COUNT = ' PA-TOT-ACNRL-RECS-INSERT 04952000
049530     DISPLAY 'CNCT RECS INSERT COUNT = ' PA-TOT-CNCT-RECS-INSERT  04953000
049540     DISPLAY 'ACNCT REC INSERT COUNT = ' PA-TOT-ACNCT-RECS-INSERT 04954000
049550     DISPLAY 'CNSL RECS INSERT COUNT = ' PA-TOT-CNSL-RECS-INSERT  04955000
049560     DISPLAY 'ACNSL REC INSERT COUNT = ' PA-TOT-ACNSL-RECS-INSERT 04956000
049570     DISPLAY 'TOTAL RECS INSERTED    = ' PA-TOT-RECS-INSERTED     04957000
049580     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS   04958000
049590     DISPLAY 'CNTK RECS DELETE COUNT = ' PA-TOT-CNTK-RECS-DELETED 04959000
049600     DISPLAY 'CNPO RECS DELETE COUNT = ' PA-TOT-CNPO-RECS-DELETED 04960000
049610     DISPLAY 'CNUP RECS DELETE COUNT = ' PA-TOT-CNUP-RECS-DELETED 04961000
049620     DISPLAY 'CNRL RECS DELETE COUNT = ' PA-TOT-CNRL-RECS-DELETED 04962000
049630     DISPLAY 'CNCT RECS DELETE COUNT = ' PA-TOT-CNCT-RECS-DELETED 04963000
049640     DISPLAY 'CNSL RECS DELETE COUNT = ' PA-TOT-CNSL-RECS-DELETED 04964000
049650     DISPLAY 'TOTAL RECS DELETED     = ' PA-TOT-RECS-DELETED      04965000
049660     DISPLAY 'CNTK RECS SELECT COUNT = ' PA-TOT-CNTK-RECS-SELECT  04966000
049670     DISPLAY 'CNPO RECS SELECT COUNT = ' PA-TOT-CNPO-RECS-SELECT  04967000
049680     DISPLAY 'CNUP RECS SELECT COUNT = ' PA-TOT-CNUP-RECS-SELECT  04968000
049690     DISPLAY 'CNRL RECS SELECT COUNT = ' PA-TOT-CNRL-RECS-SELECT  04969000
049700     DISPLAY 'CNCT RECS SELECT COUNT = ' PA-TOT-CNCT-RECS-SELECT  04970000
049710     DISPLAY 'CNSL RECS SELECT COUNT = ' PA-TOT-CNSL-RECS-SELECT  04971000
049720     DISPLAY 'TOTAL RECS SELECTED    = ' PA-TOT-RECS-SELECTED     04972000
049730     DISPLAY 'CNTK CHANGE ADDS - B   = ' PA-TOT-CNTK-CHANGES-B    04973000
049740     DISPLAY 'CNPO CHANGE ADDS - B   = ' PA-TOT-CNPO-CHANGES-B    04974000
049750     DISPLAY 'CNUP CHANGE ADDS - B   = ' PA-TOT-CNUP-CHANGES-B    04975000
049760     DISPLAY 'CNCT CHANGE ADDS - B   = ' PA-TOT-CNCT-CHANGES-B    04976000
049770     DISPLAY 'CNSL CHANGE ADDS - B   = ' PA-TOT-CNSL-CHANGES-B    04977000
049780     DISPLAY 'TOTAL CHANGE ADDS- B   = ' PA-TOT-RECS-CHANGED-B    04978000
049790     DISPLAY 'CNPO CHANGE ADDS - Z   = ' PA-TOT-CNPO-CHANGES-Z    04979000
049800     DISPLAY 'CNUP CHANGE ADDS - Z   = ' PA-TOT-CNUP-CHANGES-Z    04980000
049810     DISPLAY 'CNCT CHANGE ADDS - Z   = ' PA-TOT-CNCT-CHANGES-Z    04981000
049820     DISPLAY 'CNSL CHANGE ADDS - Z   = ' PA-TOT-CNSL-CHANGES-Z    04982000
049830     DISPLAY 'TOTAL CHANGE ADDS- Z   = ' PA-TOT-RECS-CHANGED-Z    04983000
049840     DISPLAY 'CNPO DELETES     - E   = ' PA-TOT-CNPO-DELETES-E    04984000
049850     DISPLAY 'CNUP DELETES     - E   = ' PA-TOT-CNUP-DELETES-E    04985000
049860     DISPLAY 'CNCT DELETES     - E   = ' PA-TOT-CNCT-DELETES-E    04986000
049870     DISPLAY 'CNSL DELETES     - E   = ' PA-TOT-CNSL-DELETES-E    04987000
049880     DISPLAY 'TOTAL DELETES    - E   = ' PA-TOT-RECS-DELETED-E    04988000
049890     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         04989000
049900     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     04990000
049910     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    04991000
049920     DISPLAY 'TOTAL REPORT COUNT     = ' PA-TOTAL-REPORT-COUNT    04992000
049930     DISPLAY 'TOTAL RULE COUNT       = ' PA-TOTAL-RULE-COUNT      04993000
049940     DISPLAY '**********************************'                 04994000
049950                                                                  04995000
049960             PERFORM 9100-SQL-ABEND                               04996000
049970     END-EVALUATE.                                                04997000
049980                                                                  04998000
049990     IF PV-TMST > PV-HOLD-TMST                                    04999000
050000         IF NO-COMMITS-TAKEN                                      05000000
050010             MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE         05001000
050020             PERFORM 4200-UPDATE-TCKRSTCNTL                       05002000
050030             SET COMMITS-TAKEN TO TRUE                            05003000
050040         END-IF                                                   05004000
050050        PERFORM 4210-UPDATE-TCKRSTINF                             05005000
050060        PERFORM 4300-COMMIT                                       05006000
050070        DISPLAY 'COMMIT TAKEN AT '                                05007000
050080        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)05008000
050090         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)05009000
050100        DISPLAY 'IMCNTK CONTNR ID       = ' IMCNTK-CONTNR-ID      05010000
050110        DISPLAY 'IMCNTK SAIL DATE       = ' IMCNTK-MOM-DPRTR-TMST 05011000
050120        DISPLAY 'CONTAINER INPUT COUNT  = ' PV-CONT-INPUT-COUNT   05012000
050130        DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS      05013000
050140        DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT  05014000
050150        DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT 05015000
050160        DISPLAY 'TOTAL REPORT COUNT     = ' PA-TOTAL-REPORT-COUNT 05016000
050170        DISPLAY 'TOTAL RULE COUNT       = ' PA-TOTAL-RULE-COUNT   05017000
050180        PERFORM 4020-SET-COMMIT-TIME                              05018000
050190     END-IF.                                                      05019000
050200                                                                  05020000
050210 EJECT                                                            05021000
050220******************************************************************05022000
050230*    CHECK TO SEE IF A CHECKPOINT RESTART SHOULD BE DONE.        *05023000
050240******************************************************************05024000
050250 4110-CHECKPOINT-RESTART.                                         05025000
050260                                                                  05026000
050270     PERFORM 4010-GET-CHECKPOINT-INFO.                            05027000
050280     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.     05028000
050290                                                                  05029000
050300     DISPLAY '***********************************************'.   05030000
050310     DISPLAY '** TRKUP215 CHECKPOINT RESTART **'.                 05031000
050320     DISPLAY '** CONTAINER RECS BYPASSED ON RESTART = '.          05032000
050330     DISPLAY  CR-CONTAINER-RECS-WORKED.                           05033000
050340     DISPLAY '***********************************************'.   05034000
050350                                                                  05035000
050360     IF INPUT-CONTAINER-FILE                                      05036000
050370         PERFORM 6000-READ-CONTAINER-FILE                         05037000
050380             CR-CONTAINER-RECS-WORKED TIMES                       05038000
050390                                                                  05039000
050400         MOVE CR-TOTAL-COMMITS         TO PA-TOTAL-COMMITS        05040000
050410         MOVE CR-TOTAL-REPORT-COUNT    TO PA-TOTAL-REPORT-COUNT   05041000
050420         MOVE CR-TOTAL-RULE-COUNT      TO PA-TOTAL-RULE-COUNT     05042000
050430         MOVE CR-TOTAL-ERROR-COUNT     TO PA-TOTAL-ERROR-COUNT    05043000
050440         MOVE CR-TOTAL-DETAIL-COUNT    TO PA-TOTAL-DETAIL-COUNT   05044000
050450         MOVE CR-TOT-RECS-INSERTED     TO PA-TOT-RECS-INSERTED    05045000
050460         MOVE CR-TOT-TOUTTM1-INSERTS   TO PA-TOT-TOUTTM1-INSERTS  05046000
050470         MOVE CR-TOT-CNTK-RECS-INSERT  TO PA-TOT-CNTK-RECS-INSERT 05047000
050480         MOVE CR-TOT-CNPO-RECS-INSERT  TO PA-TOT-CNPO-RECS-INSERT 05048000
050490         MOVE CR-TOT-CNUP-RECS-INSERT  TO PA-TOT-CNUP-RECS-INSERT 05049000
050500         MOVE CR-TOT-CNRL-RECS-INSERT  TO PA-TOT-CNRL-RECS-INSERT 05050000
050510         MOVE CR-TOT-CNCT-RECS-INSERT  TO PA-TOT-CNCT-RECS-INSERT 05051000
050520         MOVE CR-TOT-CNSL-RECS-INSERT  TO PA-TOT-CNSL-RECS-INSERT 05052000
050530         MOVE CR-TOT-ACNTK-RECS-INSERT TO PA-TOT-ACNTK-RECS-INSERT05053000
050540         MOVE CR-TOT-ACNPO-RECS-INSERT TO PA-TOT-ACNPO-RECS-INSERT05054000
050550         MOVE CR-TOT-ACNUP-RECS-INSERT TO PA-TOT-ACNUP-RECS-INSERT05055000
050560         MOVE CR-TOT-ACNRL-RECS-INSERT TO PA-TOT-ACNRL-RECS-INSERT05056000
050570         MOVE CR-TOT-ACNCT-RECS-INSERT TO PA-TOT-ACNCT-RECS-INSERT05057000
050580         MOVE CR-TOT-ACNSL-RECS-INSERT TO PA-TOT-ACNSL-RECS-INSERT05058000
050590         MOVE CR-TOT-RECS-DELETED      TO PA-TOT-RECS-DELETED     05059000
050600         MOVE CR-TOT-CNTK-RECS-DELETED TO PA-TOT-CNTK-RECS-DELETED05060000
050610         MOVE CR-TOT-CNPO-RECS-DELETED TO PA-TOT-CNPO-RECS-DELETED05061000
050620         MOVE CR-TOT-CNUP-RECS-DELETED TO PA-TOT-CNUP-RECS-DELETED05062000
050630         MOVE CR-TOT-CNRL-RECS-DELETED TO PA-TOT-CNRL-RECS-DELETED05063000
050640         MOVE CR-TOT-CNCT-RECS-DELETED TO PA-TOT-CNCT-RECS-DELETED05064000
050650         MOVE CR-TOT-CNSL-RECS-DELETED TO PA-TOT-CNSL-RECS-DELETED05065000
050660         MOVE CR-TOT-RECS-SELECTED     TO PA-TOT-RECS-SELECTED    05066000
050670         MOVE CR-TOT-CNTK-RECS-SELECT  TO PA-TOT-CNTK-RECS-SELECT 05067000
050680         MOVE CR-TOT-CNPO-RECS-SELECT  TO PA-TOT-CNPO-RECS-SELECT 05068000
050690         MOVE CR-TOT-CNUP-RECS-SELECT  TO PA-TOT-CNUP-RECS-SELECT 05069000
050700         MOVE CR-TOT-CNRL-RECS-SELECT  TO PA-TOT-CNRL-RECS-SELECT 05070000
050710         MOVE CR-TOT-CNCT-RECS-SELECT  TO PA-TOT-CNCT-RECS-SELECT 05071000
050720         MOVE CR-TOT-CNSL-RECS-SELECT  TO PA-TOT-CNSL-RECS-SELECT 05072000
050730         MOVE CR-TOT-RECS-CHANGED      TO PA-TOT-RECS-CHANGED     05073000
050740         MOVE CR-TOT-CNTK-CHANGES      TO PA-TOT-CNTK-CHANGES     05074000
050750         MOVE CR-TOT-CNPO-CHANGES      TO PA-TOT-CNPO-CHANGES     05075000
050760         MOVE CR-TOT-CNUP-CHANGES      TO PA-TOT-CNUP-CHANGES     05076000
050770         MOVE CR-TOT-CNCT-CHANGES      TO PA-TOT-CNCT-CHANGES     05077000
050780         MOVE CR-TOT-CNSL-CHANGES      TO PA-TOT-CNSL-CHANGES     05078000
050790         MOVE CR-TOT-RECS-CHANGED-B    TO PA-TOT-RECS-CHANGED-B   05079000
050800         MOVE CR-TOT-CNTK-CHANGES-B    TO PA-TOT-CNTK-CHANGES-B   05080000
050810         MOVE CR-TOT-CNPO-CHANGES-B    TO PA-TOT-CNPO-CHANGES-B   05081000
050820         MOVE CR-TOT-CNUP-CHANGES-B    TO PA-TOT-CNUP-CHANGES-B   05082000
050830         MOVE CR-TOT-CNCT-CHANGES-B    TO PA-TOT-CNCT-CHANGES-B   05083000
050840         MOVE CR-TOT-CNSL-CHANGES-B    TO PA-TOT-CNSL-CHANGES-B   05084000
050850         MOVE CR-TOT-RECS-CHANGED-Z    TO PA-TOT-RECS-CHANGED-Z   05085000
050860         MOVE CR-TOT-CNPO-CHANGES-Z    TO PA-TOT-CNPO-CHANGES-Z   05086000
050870         MOVE CR-TOT-CNUP-CHANGES-Z    TO PA-TOT-CNUP-CHANGES-Z   05087000
050880         MOVE CR-TOT-CNCT-CHANGES-Z    TO PA-TOT-CNCT-CHANGES-Z   05088000
050890         MOVE CR-TOT-CNSL-CHANGES-Z    TO PA-TOT-CNSL-CHANGES-Z   05089000
050900         MOVE CR-TOT-RECS-DELETED-E    TO PA-TOT-RECS-DELETED-E   05090000
050910         MOVE CR-TOT-CNPO-DELETES-E    TO PA-TOT-CNPO-DELETES-E   05091000
050920         MOVE CR-TOT-CNUP-DELETES-E    TO PA-TOT-CNUP-DELETES-E   05092000
050930         MOVE CR-TOT-CNCT-DELETES-E    TO PA-TOT-CNCT-DELETES-E   05093000
050940         MOVE CR-TOT-CNSL-DELETES-E    TO PA-TOT-CNSL-DELETES-E   05094000
050950     ELSE                                                         05095000
050960         MOVE CR-CONTAINER-RECS-WORKED TO PV-CONT-INPUT-COUNT     05096000
050970         SET PS-END-OF-FILE TO TRUE                               05097000
050980     END-IF.                                                      05098000
050990                                                                  05099000
051000 EJECT                                                            05100000
051010******************************************************************05101000
051020*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *05102000
051030*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *05103000
051040******************************************************************05104000
051050 4200-UPDATE-TCKRSTCNTL.                                          05105000
051060                                                                  05106000
051070     PERFORM WITH TEST AFTER                                      05107000
051080             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 05108000
051090             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         05109000
051100                     SQLCODE = ZERO                               05110000
051110                                                                  05111000
051120         EXEC SQL                                                 05112000
051130             UPDATE TCKRSTCNTL                                    05113000
051140             SET CKPT_STAT_CODE = :PV-CKPT-STAT-CODE              05114000
051150             WHERE JOB_NAME = :CC-JOB-NAME                        05115000
051160               AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME           05116000
051170         END-EXEC                                                 05117000
051180                                                                  05118000
051190         EVALUATE TRUE                                            05119000
051200             WHEN SQLCODE = ZERO                                  05120000
051210             WHEN SQLCODE = -904                                  05121000
051220             WHEN SQLCODE = -913                                  05122000
051230                  CONTINUE                                        05123000
051240                                                                  05124000
051250             WHEN SQLWARN0 NOT EQUAL SPACE                        05125000
051260             WHEN SQLCODE NOT EQUAL ZERO                          05126000
051270                 DISPLAY '**************************************' 05127000
051280                 DISPLAY '** ABEND                            **' 05128000
051290                 DISPLAY '** PROGRAM = TRKUP215               **' 05129000
051300                 DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL*' 05130000
051310                 DISPLAY '** UPDATE TCKRSTCNTL                **' 05131000
051320                 DISPLAY '**' PV-CKPT-STAT-CODE                   05132000
051330                 DISPLAY '**************************************' 05133000
051340                 PERFORM 9100-SQL-ABEND                           05134000
051350         END-EVALUATE                                             05135000
051360     END-PERFORM.                                                 05136000
051370                                                                  05137000
051380     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05138000
051390         SQLCODE NOT = ZERO                                       05139000
051400         DISPLAY '****************************************'       05140000
051410         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       05141000
051420         DISPLAY '** UPDATE TO TCKRSTCNTL               **'       05142000
051430         DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL **'       05143000
051440         DISPLAY '**' PV-CKPT-STAT-CODE                           05144000
051450         DISPLAY '****************************************'       05145000
051460         PERFORM 9100-SQL-ABEND                                   05146000
051470     END-IF.                                                      05147000
051480                                                                  05148000
051490 EJECT                                                            05149000
051500******************************************************************05150000
051510*    UPDATES THE CHECKPOINT RESTART INFO TABLE.  THE WORKING     *05151000
051520*    STORAGE DESCRIPTION FIELD IS UPDATED WITH THE CURRENT INPUT *05152000
051530*    FILE RECORD COUNTS AND THE FILE PROCESSOR INDICATOR.        *05153000
051540******************************************************************05154000
051550 4210-UPDATE-TCKRSTINF.                                           05155000
051560                                                                  05156000
051570     MOVE PV-CONT-INPUT-COUNT      TO CR-CONTAINER-RECS-WORKED.   05157000
051580     MOVE PA-TOTAL-COMMITS         TO CR-TOTAL-COMMITS.           05158000
051590     MOVE PA-TOTAL-REPORT-COUNT    TO CR-TOTAL-REPORT-COUNT.      05159000
051600     MOVE PA-TOTAL-RULE-COUNT      TO CR-TOTAL-RULE-COUNT.        05160000
051610     MOVE PA-TOTAL-ERROR-COUNT     TO CR-TOTAL-ERROR-COUNT.       05161000
051620     MOVE PA-TOTAL-DETAIL-COUNT    TO CR-TOTAL-DETAIL-COUNT.      05162000
051630     MOVE PA-TOT-RECS-INSERTED     TO CR-TOT-RECS-INSERTED.       05163000
051640     MOVE PA-TOT-TOUTTM1-INSERTS   TO CR-TOT-TOUTTM1-INSERTS.     05164000
051650     MOVE PA-TOT-CNTK-RECS-INSERT  TO CR-TOT-CNTK-RECS-INSERT.    05165000
051660     MOVE PA-TOT-CNPO-RECS-INSERT  TO CR-TOT-CNPO-RECS-INSERT.    05166000
051670     MOVE PA-TOT-CNUP-RECS-INSERT  TO CR-TOT-CNUP-RECS-INSERT.    05167000
051680     MOVE PA-TOT-CNRL-RECS-INSERT  TO CR-TOT-CNRL-RECS-INSERT.    05168000
051690     MOVE PA-TOT-CNCT-RECS-INSERT  TO CR-TOT-CNCT-RECS-INSERT.    05169000
051700     MOVE PA-TOT-CNSL-RECS-INSERT  TO CR-TOT-CNSL-RECS-INSERT.    05170000
051710     MOVE PA-TOT-ACNRL-RECS-INSERT TO CR-TOT-ACNRL-RECS-INSERT.   05171000
051720     MOVE PA-TOT-ACNTK-RECS-INSERT TO CR-TOT-ACNTK-RECS-INSERT.   05172000
051730     MOVE PA-TOT-ACNPO-RECS-INSERT TO CR-TOT-ACNPO-RECS-INSERT.   05173000
051740     MOVE PA-TOT-ACNUP-RECS-INSERT TO CR-TOT-ACNUP-RECS-INSERT.   05174000
051750     MOVE PA-TOT-ACNCT-RECS-INSERT TO CR-TOT-ACNCT-RECS-INSERT.   05175000
051760     MOVE PA-TOT-ACNSL-RECS-INSERT TO CR-TOT-ACNSL-RECS-INSERT.   05176000
051770     MOVE PA-TOT-RECS-DELETED      TO CR-TOT-RECS-DELETED.        05177000
051780     MOVE PA-TOT-CNTK-RECS-DELETED TO CR-TOT-CNTK-RECS-DELETED.   05178000
051790     MOVE PA-TOT-CNPO-RECS-DELETED TO CR-TOT-CNPO-RECS-DELETED.   05179000
051800     MOVE PA-TOT-CNUP-RECS-DELETED TO CR-TOT-CNUP-RECS-DELETED.   05180000
051810     MOVE PA-TOT-CNRL-RECS-DELETED TO CR-TOT-CNRL-RECS-DELETED.   05181000
051820     MOVE PA-TOT-CNCT-RECS-DELETED TO CR-TOT-CNCT-RECS-DELETED.   05182000
051830     MOVE PA-TOT-CNSL-RECS-DELETED TO CR-TOT-CNSL-RECS-DELETED.   05183000
051840     MOVE PA-TOT-RECS-SELECTED     TO CR-TOT-RECS-SELECTED.       05184000
051850     MOVE PA-TOT-CNTK-RECS-SELECT  TO CR-TOT-CNTK-RECS-SELECT.    05185000
051860     MOVE PA-TOT-CNPO-RECS-SELECT  TO CR-TOT-CNPO-RECS-SELECT.    05186000
051870     MOVE PA-TOT-CNUP-RECS-SELECT  TO CR-TOT-CNUP-RECS-SELECT.    05187000
051880     MOVE PA-TOT-CNRL-RECS-SELECT  TO CR-TOT-CNRL-RECS-SELECT.    05188000
051890     MOVE PA-TOT-CNCT-RECS-SELECT  TO CR-TOT-CNCT-RECS-SELECT.    05189000
051900     MOVE PA-TOT-CNSL-RECS-SELECT  TO CR-TOT-CNSL-RECS-SELECT.    05190000
051910     MOVE PA-TOT-RECS-CHANGED      TO CR-TOT-RECS-CHANGED.        05191000
051920     MOVE PA-TOT-CNTK-CHANGES      TO CR-TOT-CNTK-CHANGES.        05192000
051930     MOVE PA-TOT-CNPO-CHANGES      TO CR-TOT-CNPO-CHANGES.        05193000
051940     MOVE PA-TOT-CNUP-CHANGES      TO CR-TOT-CNUP-CHANGES.        05194000
051950     MOVE PA-TOT-CNCT-CHANGES      TO CR-TOT-CNCT-CHANGES.        05195000
051960     MOVE PA-TOT-CNSL-CHANGES      TO CR-TOT-CNSL-CHANGES.        05196000
051970     MOVE PA-TOT-RECS-CHANGED-B    TO CR-TOT-RECS-CHANGED-B.      05197000
051980     MOVE PA-TOT-CNTK-CHANGES-B    TO CR-TOT-CNTK-CHANGES-B.      05198000
051990     MOVE PA-TOT-CNPO-CHANGES-B    TO CR-TOT-CNPO-CHANGES-B.      05199000
052000     MOVE PA-TOT-CNUP-CHANGES-B    TO CR-TOT-CNUP-CHANGES-B.      05200000
052010     MOVE PA-TOT-CNCT-CHANGES-B    TO CR-TOT-CNCT-CHANGES-B.      05201000
052020     MOVE PA-TOT-CNSL-CHANGES-B    TO CR-TOT-CNSL-CHANGES-B.      05202000
052030     MOVE PA-TOT-RECS-CHANGED-Z    TO CR-TOT-RECS-CHANGED-Z.      05203000
052040     MOVE PA-TOT-CNPO-CHANGES-Z    TO CR-TOT-CNPO-CHANGES-Z.      05204000
052050     MOVE PA-TOT-CNUP-CHANGES-Z    TO CR-TOT-CNUP-CHANGES-Z.      05205000
052060     MOVE PA-TOT-CNCT-CHANGES-Z    TO CR-TOT-CNCT-CHANGES-Z.      05206000
052070     MOVE PA-TOT-CNSL-CHANGES-Z    TO CR-TOT-CNSL-CHANGES-Z.      05207000
052080     MOVE PA-TOT-RECS-DELETED-E    TO CR-TOT-RECS-DELETED-E.      05208000
052090     MOVE PA-TOT-CNPO-DELETES-E    TO CR-TOT-CNPO-DELETES-E.      05209000
052100     MOVE PA-TOT-CNUP-DELETES-E    TO CR-TOT-CNUP-DELETES-E.      05210000
052110     MOVE PA-TOT-CNCT-DELETES-E    TO CR-TOT-CNCT-DELETES-E.      05211000
052120     MOVE PA-TOT-CNSL-DELETES-E    TO CR-TOT-CNSL-DELETES-E.      05212000
052130                                                                  05213000
052140     MOVE CKPT-RESTART-INFO   TO TCKRSTINF-WORK-STRG-DESC-TEXT.   05214000
052150     MOVE 4022                TO TCKRSTINF-WORK-STRG-DESC-LEN.    05215000
052160                                                                  05216000
052170     PERFORM WITH TEST AFTER                                      05217000
052180             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 05218000
052190             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         05219000
052200                     SQLCODE = ZERO                               05220000
052210                                                                  05221000
052220         EXEC SQL                                                 05222000
052230             UPDATE TCKRSTINF                                     05223000
052240             SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC     05224000
052250             WHERE JOB_NAME = :CC-JOB-NAME                        05225000
052260               AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME           05226000
052270         END-EXEC                                                 05227000
052280                                                                  05228000
052290         EVALUATE TRUE                                            05229000
052300             WHEN SQLCODE = ZERO                                  05230000
052310             WHEN SQLCODE = -904                                  05231000
052320             WHEN SQLCODE = -913                                  05232000
052330                  CONTINUE                                        05233000
052340                                                                  05234000
052350             WHEN SQLWARN0 NOT EQUAL SPACE                        05235000
052360             WHEN SQLCODE NOT EQUAL ZERO                          05236000
052370                 DISPLAY '**************************************' 05237000
052380                 DISPLAY '** ABEND                            **' 05238000
052390                 DISPLAY '** PROGRAM = TRKUP215               **' 05239000
052400                 DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF**' 05240000
052410                 DISPLAY '** UPDATE TCKRSTINF                 **' 05241000
052420                 DISPLAY '**' TCKRSTINF-WORK-STRG-DESC            05242000
052430                 DISPLAY '**************************************' 05243000
052440                 PERFORM 9100-SQL-ABEND                           05244000
052450         END-EVALUATE                                             05245000
052460     END-PERFORM.                                                 05246000
052470                                                                  05247000
052480     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05248000
052490         SQLCODE NOT = ZERO                                       05249000
052500         DISPLAY '****************************************'       05250000
052510         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       05251000
052520         DISPLAY '** UPDATE TCKRSTINF                   **'       05252000
052530         DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF  **'       05253000
052540         DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                    05254000
052550         DISPLAY '****************************************'       05255000
052560         PERFORM 9100-SQL-ABEND                                   05256000
052570     END-IF.                                                      05257000
052580                                                                  05258000
052590 EJECT                                                            05259000
052600******************************************************************05260000
052610*  ISSUES AN SQL COMMIT AFTER A LOGICAL UNIT OF WORK HAS BEEN    *05261000
052620*  COMPLETED.                                                    *05262000
052630******************************************************************05263000
052640 4300-COMMIT.                                                     05264000
052650                                                                  05265000
052660     EXEC SQL                                                     05266000
052670         COMMIT                                                   05267000
052680     END-EXEC.                                                    05268000
052690                                                                  05269000
052700     EVALUATE TRUE                                                05270000
052710         WHEN SQLWARN0 NOT EQUAL SPACE                            05271000
052720         WHEN SQLCODE NOT EQUAL ZERO                              05272000
052730     DISPLAY '**********************************'                 05273000
052740     DISPLAY 'IMCNTK CONTNR ID       = ' IMCNTK-CONTNR-ID         05274000
052750     DISPLAY 'IMCNTK SAIL DATE       = ' IMCNTK-MOM-DPRTR-TMST    05275000
052760     DISPLAY 'CONTAINER INPUT COUNT  = ' PV-CONT-INPUT-COUNT      05276000
052770     DISPLAY 'CNTK RECS INSERT COUNT = ' PA-TOT-CNTK-RECS-INSERT  05277000
052780     DISPLAY 'CNPO RECS INSERT COUNT = ' PA-TOT-CNPO-RECS-INSERT  05278000
052790     DISPLAY 'CNUP RECS INSERT COUNT = ' PA-TOT-CNUP-RECS-INSERT  05279000
052800     DISPLAY 'CNRL RECS INSERT COUNT = ' PA-TOT-CNRL-RECS-INSERT  05280000
052810     DISPLAY 'CNCT RECS INSERT COUNT = ' PA-TOT-CNCT-RECS-INSERT  05281000
052820     DISPLAY 'CNSL RECS INSERT COUNT = ' PA-TOT-CNSL-RECS-INSERT  05282000
052830     DISPLAY 'ACNRL REC INSERT COUNT = ' PA-TOT-ACNRL-RECS-INSERT 05283000
052840     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-RECS-INSERT 05284000
052850     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-RECS-INSERT 05285000
052860     DISPLAY 'ACNUP REC INSERT COUNT = ' PA-TOT-ACNUP-RECS-INSERT 05286000
052870     DISPLAY 'ACNCT REC INSERT COUNT = ' PA-TOT-ACNCT-RECS-INSERT 05287000
052880     DISPLAY 'ACNSL REC INSERT COUNT = ' PA-TOT-ACNSL-RECS-INSERT 05288000
052890     DISPLAY 'TOTAL RECS INSERTED    = ' PA-TOT-RECS-INSERTED     05289000
052900     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS   05290000
052910     DISPLAY 'CNTK RECS DELETE COUNT = ' PA-TOT-CNTK-RECS-DELETED 05291000
052920     DISPLAY 'CNPO RECS DELETE COUNT = ' PA-TOT-CNPO-RECS-DELETED 05292000
052930     DISPLAY 'CNUP RECS DELETE COUNT = ' PA-TOT-CNUP-RECS-DELETED 05293000
052940     DISPLAY 'CNRL RECS DELETE COUNT = ' PA-TOT-CNRL-RECS-DELETED 05294000
052950     DISPLAY 'CNCT RECS DELETE COUNT = ' PA-TOT-CNCT-RECS-DELETED 05295000
052960     DISPLAY 'CNSL RECS DELETE COUNT = ' PA-TOT-CNSL-RECS-DELETED 05296000
052970     DISPLAY 'TOTAL RECS DELETED     = ' PA-TOT-RECS-DELETED      05297000
052980     DISPLAY 'CNTK RECS SELECT COUNT = ' PA-TOT-CNTK-RECS-SELECT  05298000
052990     DISPLAY 'CNPO RECS SELECT COUNT = ' PA-TOT-CNPO-RECS-SELECT  05299000
053000     DISPLAY 'CNUP RECS SELECT COUNT = ' PA-TOT-CNUP-RECS-SELECT  05300000
053010     DISPLAY 'CNRL RECS SELECT COUNT = ' PA-TOT-CNRL-RECS-SELECT  05301000
053020     DISPLAY 'CNCT RECS SELECT COUNT = ' PA-TOT-CNCT-RECS-SELECT  05302000
053030     DISPLAY 'CNSL RECS SELECT COUNT = ' PA-TOT-CNSL-RECS-SELECT  05303000
053040     DISPLAY 'TOTAL RECS SELECTED    = ' PA-TOT-RECS-SELECTED     05304000
053050     DISPLAY 'CNTK CHANGE ADDS - B   = ' PA-TOT-CNTK-CHANGES-B    05305000
053060     DISPLAY 'CNPO CHANGE ADDS - B   = ' PA-TOT-CNPO-CHANGES-B    05306000
053070     DISPLAY 'CNUP CHANGE ADDS - B   = ' PA-TOT-CNUP-CHANGES-B    05307000
053080     DISPLAY 'CNCT CHANGE ADDS - B   = ' PA-TOT-CNCT-CHANGES-B    05308000
053090     DISPLAY 'CNSL CHANGE ADDS - B   = ' PA-TOT-CNSL-CHANGES-B    05309000
053100     DISPLAY 'TOTAL CHANGE ADDS- B   = ' PA-TOT-RECS-CHANGED-B    05310000
053110     DISPLAY 'CNPO CHANGE ADDS - Z   = ' PA-TOT-CNPO-CHANGES-Z    05311000
053120     DISPLAY 'CNUP CHANGE ADDS - Z   = ' PA-TOT-CNUP-CHANGES-Z    05312000
053130     DISPLAY 'CNCT CHANGE ADDS - Z   = ' PA-TOT-CNCT-CHANGES-Z    05313000
053140     DISPLAY 'CNSL CHANGE ADDS - Z   = ' PA-TOT-CNSL-CHANGES-Z    05314000
053150     DISPLAY 'TOTAL CHANGE ADDS- Z   = ' PA-TOT-RECS-CHANGED-Z    05315000
053160     DISPLAY 'CNPO DELETES     - E   = ' PA-TOT-CNPO-DELETES-E    05316000
053170     DISPLAY 'CNUP DELETES     - E   = ' PA-TOT-CNUP-DELETES-E    05317000
053180     DISPLAY 'CNCT DELETES     - E   = ' PA-TOT-CNCT-DELETES-E    05318000
053190     DISPLAY 'CNSL DELETES     - E   = ' PA-TOT-CNSL-DELETES-E    05319000
053200     DISPLAY 'TOTAL DELETES    - E   = ' PA-TOT-RECS-DELETED-E    05320000
053210     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         05321000
053220     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     05322000
053230     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    05323000
053240     DISPLAY 'TOTAL REPORT COUNT     = ' PA-TOTAL-REPORT-COUNT    05324000
053250     DISPLAY 'TOTAL RULE COUNT       = ' PA-TOTAL-RULE-COUNT      05325000
053260     DISPLAY '**********************************'                 05326000
053270     DISPLAY '** ABEND **'                                        05327000
053280     DISPLAY '** PROGRAM = TRKUP215 **'                           05328000
053290     DISPLAY '** PARAGRAPH = 4300-COMMIT**'                       05329000
053300     DISPLAY '**UNSUCCESSFUL COMMIT**'                            05330000
053310     DISPLAY '**********************************'                 05331000
053320             PERFORM 9100-SQL-ABEND                               05332000
053330         WHEN SQLCODE EQUAL ZERO                                  05333000
053340             ADD +1 TO PA-TOTAL-COMMITS                           05334000
053350     END-EVALUATE.                                                05335000
053360                                                                  05336000
053370 EJECT                                                            05337000
053380******************************************************************05338000
053390* MOVE RECORD KEY FIELDS TO HOLD AREA.                           *05339000
053400******************************************************************05340000
053410 5500-MOVE-KEY-FIELDS-TO-HOLD.                                    05341000
053420                                                                  05342000
053430     MOVE TR023-CNTR-CONTNR-ID       TO PV-HOLD-CONTNR-ID.        05343000
053440     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM TO                        05344000
053450                                     PV-HOLD-ACTL-DPRTR-DTE-MOM.  05345000
053460     MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM  TO                        05346000
053470                                     PV-HOLD-ACTL-DPRTR-TM-MOM.   05347000
053480     MOVE TR023-CNTR-TRN-TYP         TO PV-HOLD-TRN-TYP.          05348000
053490                                                                  05349000
053500     MOVE TR023-CNTR-REC-TYP-CDE     TO PV-REC-TYP-CDE.           05350000
053510     MOVE TR023-CNTR-3RD-PARTY-CDE   TO PV-HOLD-3RD-PARTY-CDE.    05351000
053520                                                                  05352000
053530     EVALUATE TRUE                                                05353000
053540         WHEN PV-REC-TYP-CONPO                                    05354000
053550             MOVE TR023-CONPO-PO-NBR   TO PV-HOLD-PO-NBR          05355000
053560             MOVE +0 TO PV-CARTON-COUNT-PER-PO                    05356000
053570         WHEN PV-REC-TYP-CONUPC                                   05357000
053580             MOVE TR023-CONUPC-PO-NBR  TO PV-HOLD-PO-NBR          05358000
053590             MOVE TR023-CONUPC-UPC-NBR TO PV-HOLD-UPC-NBR         05359000
053600             MOVE +0 TO PV-CARTON-REC-COUNT-BULK                  05360000
053610             SET PS-UPC-OUTR-PACKS-WNG-NO TO TRUE                 05361000
053620         WHEN PV-REC-TYP-CNCART                                   05362000
053630             MOVE TR023-CNCART-PO-NBR   TO PV-HOLD-PO-NBR         05363000
053640             MOVE TR023-CNCART-UPC-NBR  TO PV-HOLD-UPC-NBR        05364000
053650             MOVE TR023-CNCART-SSCC-NBR TO PV-HOLD-SSCC-NBR       05365000
053660         WHEN PV-REC-TYP-CNSEAL                                   05366000
053670             MOVE TR023-CNSEAL-CONTNR-SEAL-NBR TO                 05367000
053680                               PV-HOLD-SEAL-NBR                   05368000
053690     END-EVALUATE.                                                05369000
053700                                                                  05370000
053710******************************************************************05371000
053720* CHECK HOLD FIELDS TO SEE IF A COMMIT NEEDS TO BE TAKEN.        *05372000
053730******************************************************************05373000
053740 5507-CHECK-COMMIT-FIELDS.                                        05374000
053750                                                                  05375000
053760     IF TR023-CNTR-CONTNR-ID          = PV-HOLD-CONTNR-ID     AND 05376000
053770        TR023-CNTR-ACTL-DPRTR-DTE-MOM =                           05377000
053780                                   PV-HOLD-ACTL-DPRTR-DTE-MOM AND 05378000
053790        TR023-CNTR-ACTL-DPRTR-TM-MOM  =                           05379000
053800                                   PV-HOLD-ACTL-DPRTR-TM-MOM  AND 05380000
053810        TR023-CNTR-TRN-TYP            = PV-HOLD-TRN-TYP           05381000
053820         SET PS-SAME-COMMIT-FIELDS TO TRUE                        05382000
053830     ELSE                                                         05383000
053840         SET PS-NOT-SAME-COMMIT-FIELDS TO TRUE                    05384000
053850     END-IF.                                                      05385000
053860                                                                  05386000
053870******************************************************************05387000
053880* MOVE CNTR INPUT FIELDS TO HOST VARIABLE FIELDS FOR TIMCNTK.    *05388000
053890******************************************************************05389000
053900 5520-MOVE-CNTR-TO-DCLGEN.                                        05390000
053910                                                                  05391000
053920     MOVE TR023-CNTR-CONTNR-ID     TO  IMCNTK-CONTNR-ID.          05392000
053930     MOVE TR023-CNTR-EST-LBD-NM    TO  IMCNTK-EST-LBD-NM.         05393000
053940                                                                  05394000
053950     MOVE TR023-CNTR-EST-LBD-DTE (1:4) TO PV-FORMAT-TMST-DTE-CY.  05395000
053960     MOVE TR023-CNTR-EST-LBD-DTE (5:2) TO PV-FORMAT-TMST-DTE-MM.  05396000
053970     MOVE TR023-CNTR-EST-LBD-DTE (7:2) TO PV-FORMAT-TMST-DTE-DD.  05397000
053980     MOVE TR023-CNTR-EST-LBD-TM  (1:2) TO PV-FORMAT-TMST-TM-HH.   05398000
053990     MOVE TR023-CNTR-EST-LBD-TM  (3:2) TO PV-FORMAT-TMST-TM-MM.   05399000
054000     MOVE PV-FORMAT-TMST               TO IMCNTK-EST-LBD-TMST.    05400000
054010                                                                  05401000
054020     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM (1:4) TO                  05402000
054030                                        PV-FORMAT-TMST-DTE-CY     05403000
054040     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM (5:2) TO                  05404000
054050                                        PV-FORMAT-TMST-DTE-MM     05405000
054060     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM (7:2) TO                  05406000
054070                                        PV-FORMAT-TMST-DTE-DD     05407000
054080     MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM  (1:2) TO                  05408000
054090                                        PV-FORMAT-TMST-TM-HH      05409000
054100     MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM  (3:2) TO                  05410000
054110                                        PV-FORMAT-TMST-TM-MM      05411000
054120     MOVE PV-FORMAT-TMST               TO IMCNTK-MOM-DPRTR-TMST.  05412000
054130                                                                  05413000
054140                                                                  05414000
054150     MOVE TR023-CNTR-IMPRT-TRIP-ID-MOM TO                         05415000
054160                                     IMCNTK-MOM-IMPRT-TRIP-ID.    05416000
054170                                                                  05417000
054180     MOVE TR023-CNTR-EST-POE-DELY-DT-MOM (1:4) TO                 05418000
054190                                    PV-FORMAT-TMST-DTE-CY.        05419000
054200     MOVE TR023-CNTR-EST-POE-DELY-DT-MOM (5:2) TO                 05420000
054210                                    PV-FORMAT-TMST-DTE-MM.        05421000
054220     MOVE TR023-CNTR-EST-POE-DELY-DT-MOM (7:2) TO                 05422000
054230                                    PV-FORMAT-TMST-DTE-DD.        05423000
054240     MOVE TR023-CNTR-EST-POE-DELY-TM-MOM (1:2) TO                 05424000
054250                                    PV-FORMAT-TMST-TM-HH.         05425000
054260     MOVE TR023-CNTR-EST-POE-DELY-TM-MOM (3:2) TO                 05426000
054270                                    PV-FORMAT-TMST-TM-MM.         05427000
054280     IF PV-FORMAT-TMST-TM-HH = SPACES                             05428000
054290        MOVE '00' TO PV-FORMAT-TMST-TM-HH                         05429000
054300     END-IF.                                                      05430000
054310     IF PV-FORMAT-TMST-TM-MM = SPACES                             05431000
054320        MOVE '00' TO PV-FORMAT-TMST-TM-MM                         05432000
054330     END-IF.                                                      05433000
054340     MOVE PV-FORMAT-TMST            TO IMCNTK-MOM-POE-DELY-TMST.  05434000
054350                                                                  05435000
054360     MOVE TR023-CNTR-CARR-SCAC-ID-MOM TO IMCNTK-MOM-CARR-SCAC-ID. 05436000
054370     MOVE TR023-CNTR-IMP-VEH-NM-MOM   TO IMCNTK-MOM-IMPRT-VEH-NM. 05437000
054380     MOVE TR023-CNTR-TRIP-TYP-CDE-MOM TO IMCNTK-MOM-TRIP-TYP-CDE  05438000
054390                                         PV-HOLD-TRIP-TYP-CDE.    05439000
054400                                                                  05440000
054410     MOVE TR023-CNTR-DEST-POE-CDE-MOM TO IMCNTK-MOM-DEST-POE-CDE  05441000
054420                                         PV-HOLD-POE-CDE.         05442000
054430     IF PV-HOLD-POE-CDE > SPACES                                  05443000
054440         PERFORM 5610-EDIT-POE-CDE                                05444000
054450         IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND            05445000
054460             PS-INVALID-POE-CDE                                   05446000
054470              MOVE PC-WARNING      TO TR211-ERROR-TYPE            05447000
054480              MOVE 'DEST POE CDE'  TO TR211-DATA-IN-ERROR         05448000
054490              MOVE PV-HOLD-POE-CDE TO TR211-DATA-VALUE            05449000
054500              MOVE 'INVALID POE CODE ON KOHLS SYSTEM' TO          05450000
054510                                      TR211-ERROR-MSG             05451000
054520              PERFORM 5800-LOAD-CVYA-TO-REPORT                    05452000
054530         END-IF                                                   05453000
054540     END-IF.                                                      05454000
054550                                                                  05455000
054560     MOVE TR023-CNTR-ACTL-FOB-CDE-MOM TO IMCNTK-MOM-FOB-CDE       05456000
054570                                         PV-HOLD-FOB-CDE.         05457000
054580     IF PV-HOLD-FOB-CDE > SPACES                                  05458000
054590         PERFORM 5615-EDIT-FOB-CDE                                05459000
054600          IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND           05460000
054610              PS-INVALID-FOB-CDE                                  05461000
054620               SET PS-LOAD-PRINT-TABLE TO TRUE                    05462000
054630               MOVE PC-WARNING      TO TR211-ERROR-TYPE           05463000
054640               MOVE 'MOM FOB CDE'   TO TR211-DATA-IN-ERROR        05464000
054650               MOVE PV-HOLD-FOB-CDE TO TR211-DATA-VALUE           05465000
054660               MOVE 'INVALID FOB CODE ON KOHLS SYSTEM' TO         05466000
054670                                       TR211-ERROR-MSG            05467000
054680               PERFORM 5800-LOAD-CVYA-TO-REPORT                   05468000
054690          ELSE                                                    05469000
054700               PERFORM 7292-SELECT-FOB-POE-CDE                    05470000
054710               IF PS-VALID-POE-CDE-EXIST-NO                       05471000
054720                   SET PS-LOAD-PRINT-TABLE TO TRUE                05472000
054730                   MOVE PC-WARNING      TO TR211-ERROR-TYPE       05473000
054740                   MOVE 'DEST POE CDE'  TO TR211-DATA-IN-ERROR    05474000
054750                   MOVE PV-HOLD-POE-CDE TO TR211-DATA-VALUE       05475000
054760                   MOVE 'UNEXPECTED POE CODE SENT' TO             05476000
054770                                  TR211-ERROR-MSG                 05477000
054780                   PERFORM 5800-LOAD-CVYA-TO-REPORT               05478000
054790               END-IF                                             05479000
054800          END-IF                                                  05480000
054810     END-IF.                                                      05481000
054820                                                                  05482000
054830     MOVE TR023-CNTR-POR-CDE-MOM TO IMCNTK-MOM-POR-CDE            05483000
054840                                    PV-HOLD-ORGN-CDE.             05484000
054850     MOVE PC-POR TO PV-HOLD-ORGN-TYP-CDE.                         05485000
054860     IF PV-HOLD-ORGN-CDE > SPACES                                 05486000
054870         PERFORM 5630-EDIT-ORGN-CDE                               05487000
054880          IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND           05488000
054890              PS-INVALID-ORGN-CDE                                 05489000
054900               SET PS-LOAD-PRINT-TABLE TO TRUE                    05490000
054910               MOVE PC-WARNING       TO TR211-ERROR-TYPE          05491000
054920               MOVE 'MOM POR CDE'    TO TR211-DATA-IN-ERROR       05492000
054930               MOVE PV-HOLD-ORGN-CDE TO TR211-DATA-VALUE          05493000
054940               MOVE 'INVALID POR CODE ON KOHLS SYSTEM' TO         05494000
054950                                       TR211-ERROR-MSG            05495000
054960               PERFORM 5800-LOAD-CVYA-TO-REPORT                   05496000
054970     END-IF.                                                      05497000
054980                                                                  05498000
054990     MOVE TR023-CNTR-POL-CDE-MOM TO IMCNTK-MOM-POL-CDE            05499000
055000                                    PV-HOLD-ORGN-CDE.             05500000
055010     MOVE PC-POL TO PV-HOLD-ORGN-TYP-CDE.                         05501000
055020     IF PV-HOLD-ORGN-CDE > SPACES                                 05502000
055030         PERFORM 5630-EDIT-ORGN-CDE                               05503000
055040          IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND           05504000
055050              PS-INVALID-ORGN-CDE                                 05505000
055060               SET PS-LOAD-PRINT-TABLE TO TRUE                    05506000
055070               MOVE PC-WARNING       TO TR211-ERROR-TYPE          05507000
055080               MOVE 'MOM POL CDE'    TO TR211-DATA-IN-ERROR       05508000
055090               MOVE PV-HOLD-ORGN-CDE TO TR211-DATA-VALUE          05509000
055100               MOVE 'INVALID POL CODE ON KOHLS SYSTEM' TO         05510000
055110                                       TR211-ERROR-MSG            05511000
055120               PERFORM 5800-LOAD-CVYA-TO-REPORT                   05512000
055130     END-IF.                                                      05513000
055140                                                                  05514000
055150*CVYB_____________________________________________________________05515000
055160     MOVE TR023-CNTR-IMPRT-TRIP-ID-FDR TO                         05516000
055170                                      IMCNTK-FDR-IMPRT-TRIP-ID.   05517000
055180                                                                  05518000
055190     MOVE TR023-CNTR-ACTL-DPRTR-DTE-FDR (1:4) TO                  05519000
055200                                        PV-FORMAT-TMST-DTE-CY.    05520000
055210     MOVE TR023-CNTR-ACTL-DPRTR-DTE-FDR (5:2) TO                  05521000
055220                                        PV-FORMAT-TMST-DTE-MM.    05522000
055230     MOVE TR023-CNTR-ACTL-DPRTR-DTE-FDR (7:2) TO                  05523000
055240                                        PV-FORMAT-TMST-DTE-DD.    05524000
055250     MOVE TR023-CNTR-ACTL-DPRTR-TM-FDR  (1:2) TO                  05525000
055260                                        PV-FORMAT-TMST-TM-HH.     05526000
055270     MOVE TR023-CNTR-ACTL-DPRTR-TM-FDR  (3:2) TO                  05527000
055280                                        PV-FORMAT-TMST-TM-MM.     05528000
055290     MOVE PV-FORMAT-TMST TO IMCNTK-FDR-DPRTR-TMST.                05529000
055300                                                                  05530000
055310                                                                  05531000
055320     MOVE TR023-CNTR-EST-POE-DELY-DT-FDR (1:4) TO                 05532000
055330                                    PV-FORMAT-TMST-DTE-CY.        05533000
055340     MOVE TR023-CNTR-EST-POE-DELY-DT-FDR (5:2) TO                 05534000
055350                                    PV-FORMAT-TMST-DTE-MM.        05535000
055360     MOVE TR023-CNTR-EST-POE-DELY-DT-FDR (7:2) TO                 05536000
055370                                    PV-FORMAT-TMST-DTE-DD.        05537000
055380     MOVE TR023-CNTR-EST-POE-DELY-TM-FDR (1:2) TO                 05538000
055390                                    PV-FORMAT-TMST-TM-HH.         05539000
055400     MOVE TR023-CNTR-EST-POE-DELY-TM-FDR (3:2) TO                 05540000
055410                                    PV-FORMAT-TMST-TM-MM.         05541000
055420     MOVE PV-FORMAT-TMST            TO IMCNTK-FDR-POE-DELY-TMST.  05542000
055430                                                                  05543000
055440                                                                  05544000
055450                                                                  05545000
055460     MOVE TR023-CNTR-CARR-SCAC-ID-FDR TO IMCNTK-FDR-CARR-SCAC-ID. 05546000
055470     MOVE TR023-CNTR-IMP-VEH-NM-FDR   TO IMCNTK-FDR-IMPRT-VEH-NM. 05547000
055480     MOVE TR023-CNTR-TRIP-TYP-CDE-FDR TO IMCNTK-FDR-TRIP-TYP-CDE  05548000
055490                                         PV-HOLD-TRIP-TYP-CDE.    05549000
055500                                                                  05550000
055510     MOVE TR023-CNTR-DEST-POE-CDE-FDR TO IMCNTK-FDR-DEST-POE-CDE  05551000
055520                                         PV-HOLD-POE-CDE.         05552000
055530     IF PV-HOLD-POE-CDE > SPACES                                  05553000
055540         PERFORM 5610-EDIT-POE-CDE                                05554000
055550         IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND            05555000
055560             PS-INVALID-POE-CDE                                   05556000
055570              MOVE PC-WARNING      TO TR211-ERROR-TYPE            05557000
055580              MOVE 'DEST POE CDE'  TO TR211-DATA-IN-ERROR         05558000
055590              MOVE PV-HOLD-POE-CDE TO TR211-DATA-VALUE            05559000
055600              MOVE 'INVALID POE CODE ON KOHLS SYSTEM' TO          05560000
055610                                      TR211-ERROR-MSG             05561000
055620              PERFORM 5805-LOAD-CVYB-TO-REPORT                    05562000
055630         END-IF                                                   05563000
055640     END-IF.                                                      05564000
055650                                                                  05565000
055660     MOVE TR023-CNTR-ACTL-FOB-CDE-FDR TO IMCNTK-FDR-FOB-CDE       05566000
055670                                         PV-HOLD-FOB-CDE.         05567000
055680     IF PV-HOLD-FOB-CDE > SPACES                                  05568000
055690         PERFORM 5615-EDIT-FOB-CDE                                05569000
055700          IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND           05570000
055710              PS-INVALID-FOB-CDE                                  05571000
055720               SET PS-LOAD-PRINT-TABLE TO TRUE                    05572000
055730               MOVE PC-WARNING      TO TR211-ERROR-TYPE           05573000
055740               MOVE 'FDR FOB CDE'   TO TR211-DATA-IN-ERROR        05574000
055750               MOVE PV-HOLD-FOB-CDE TO TR211-DATA-VALUE           05575000
055760               MOVE 'INVALID FOB CODE ON KOHLS SYSTEM' TO         05576000
055770                                       TR211-ERROR-MSG            05577000
055780               PERFORM 5805-LOAD-CVYB-TO-REPORT                   05578000
055790          ELSE                                                    05579000
055800               PERFORM 7292-SELECT-FOB-POE-CDE                    05580000
055810               IF PS-VALID-POE-CDE-EXIST-NO                       05581000
055820                   SET PS-LOAD-PRINT-TABLE TO TRUE                05582000
055830                   MOVE PC-WARNING      TO TR211-ERROR-TYPE       05583000
055840                   MOVE 'DEST POE CDE'  TO TR211-DATA-IN-ERROR    05584000
055850                   MOVE PV-HOLD-POE-CDE TO TR211-DATA-VALUE       05585000
055860                   MOVE 'UNEXPECTED POE CODE SENT' TO             05586000
055870                                  TR211-ERROR-MSG                 05587000
055880                   PERFORM 5805-LOAD-CVYB-TO-REPORT               05588000
055890               END-IF                                             05589000
055900          END-IF                                                  05590000
055910     END-IF.                                                      05591000
055920                                                                  05592000
055930     MOVE TR023-CNTR-POL-CDE-FDR TO IMCNTK-FDR-POL-CDE            05593000
055940                                    PV-HOLD-ORGN-CDE.             05594000
055950     MOVE PC-POL TO PV-HOLD-ORGN-TYP-CDE.                         05595000
055960     IF PV-HOLD-ORGN-CDE > SPACES                                 05596000
055970         PERFORM 5630-EDIT-ORGN-CDE                               05597000
055980          IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND           05598000
055990              PS-INVALID-ORGN-CDE                                 05599000
056000               SET PS-LOAD-PRINT-TABLE TO TRUE                    05600000
056010               MOVE PC-WARNING       TO TR211-ERROR-TYPE          05601000
056020               MOVE 'FDR POL CDE'    TO TR211-DATA-IN-ERROR       05602000
056030               MOVE PV-HOLD-ORGN-CDE TO TR211-DATA-VALUE          05603000
056040               MOVE 'INVALID POL CODE ON KOHLS SYSTEM' TO         05604000
056050                                       TR211-ERROR-MSG            05605000
056060               PERFORM 5805-LOAD-CVYB-TO-REPORT                   05606000
056070     END-IF.                                                      05607000
056080                                                                  05608000
056090     MOVE TR023-CNTR-POR-CDE-FDR TO IMCNTK-FDR-POR-CDE            05609000
056100                                    PV-HOLD-ORGN-CDE.             05610000
056110     MOVE PC-POR TO PV-HOLD-ORGN-TYP-CDE.                         05611000
056120     IF PV-HOLD-ORGN-CDE > SPACES                                 05612000
056130         PERFORM 5630-EDIT-ORGN-CDE                               05613000
056140          IF (PV-HOLD-TRIP-TYP-CDE = PC-A OR PC-O)  AND           05614000
056150              PS-INVALID-ORGN-CDE                                 05615000
056160               SET PS-LOAD-PRINT-TABLE TO TRUE                    05616000
056170               MOVE PC-WARNING       TO TR211-ERROR-TYPE          05617000
056180               MOVE 'FDR POR CDE'    TO TR211-DATA-IN-ERROR       05618000
056190               MOVE PV-HOLD-ORGN-CDE TO TR211-DATA-VALUE          05619000
056200               MOVE 'INVALID POR CODE ON KOHLS SYSTEM' TO         05620000
056210                                       TR211-ERROR-MSG            05621000
056220               PERFORM 5805-LOAD-CVYB-TO-REPORT                   05622000
056230     END-IF.                                                      05623000
056240                                                                  05624000
056250*CONA FIELDS ____________________________________________________ 05625000
056260                                                                  05626000
056270     MOVE TR023-CNTR-DAT-SRC-ENT-ID   TO IMCNTK-DAT-SRC-ENT-ID.   05627000
056280     MOVE TR023-CNTR-CONSOL-SCAC-ID   TO IMCNTK-CONSLR-SCAC-ID.   05628000
056290                                                                  05629000
056300     IF TR023-CNTR-CART-CNT NOT NUMERIC                           05630000
056310         MOVE ZEROS                   TO IMCNTK-CART-CNT          05631000
056320     ELSE                                                         05632000
056330         MOVE TR023-CNTR-CART-CNT     TO IMCNTK-CART-CNT          05633000
056340     END-IF.                                                      05634000
056350                                                                  05635000
056360     IF TR023-CNTR-UNT-QTY NOT NUMERIC                            05636000
056370         MOVE ZEROS                   TO IMCNTK-UNT-QTY           05637000
056380     ELSE                                                         05638000
056390         MOVE TR023-CNTR-UNT-QTY      TO IMCNTK-UNT-QTY           05639000
056400     END-IF.                                                      05640000
056410                                                                  05641000
056420     IF TR023-CNTR-CBMT-QTY NOT NUMERIC                           05642000
056430         MOVE ZEROS                   TO IMCNTK-CBMT-QTY          05643000
056440     ELSE                                                         05644000
056450         MOVE TR023-CNTR-CBMT-QTY     TO IMCNTK-CBMT-QTY          05645000
056460     END-IF.                                                      05646000
056470                                                                  05647000
056480     IF TR023-CNTR-WT-KGRM-QTY NOT NUMERIC                        05648000
056490         MOVE ZEROS                   TO IMCNTK-WT-KGRM-QTY       05649000
056500     ELSE                                                         05650000
056510         MOVE TR023-CNTR-WT-KGRM-QTY  TO IMCNTK-WT-KGRM-QTY       05651000
056520     END-IF.                                                      05652000
056530                                                                  05653000
056540**CONB FIELDS__________________________________________________   05654000
056550                                                                  05655000
056560     MOVE TR023-CNTR-ORGN-SHPD-FR-CDE TO IMCNTK-ORGN-SHPD-FR-CDE. 05656000
056570     MOVE TR023-CNTR-ORGN-SHPD-TO-CDE TO IMCNTK-ORGN-SHPD-TO-CDE. 05657000
056580     MOVE TR023-CNTR-SIZE-CDE         TO IMCNTK-SIZE-CDE.         05658000
056590                                                                  05659000
056600******************************************************************05660000
056610* MOVE CONPO INPUT FIELDS TO HOST VARIABLE FIELDS FOR TIMCNPO.   *05661000
056620******************************************************************05662000
056630 5530-MOVE-CONPO-TO-DCLGEN.                                       05663000
056640                                                                  05664000
056650**CONPOA FIELDS **                                                05665000
056660                                                                  05666000
056670     MOVE TR023-CONPO-CONTNR-ID        TO IMCNPO-CONTNR-ID.       05667000
056680                                                                  05668000
056690     MOVE TR023-CONPO-PO-RCVD-DELY-DTE (1:4)  TO                  05669000
056700                                       PV-FORMAT-TMST-DTE-CY.     05670000
056710     MOVE TR023-CONPO-PO-RCVD-DELY-DTE (5:2)  TO                  05671000
056720                                       PV-FORMAT-TMST-DTE-MM.     05672000
056730     MOVE TR023-CONPO-PO-RCVD-DELY-DTE (7:2)  TO                  05673000
056740                                       PV-FORMAT-TMST-DTE-DD.     05674000
056750     MOVE PV-FORMAT-TMST-DTE (1:10) TO                            05675000
056760                                   PV-HOLD-CONPO-PO-RCVD-DELY-DTE.05676000
056770     MOVE ZEROES                    TO PV-FORMAT-TMST-TM-HH.      05677000
056780     MOVE ZEROES                    TO PV-FORMAT-TMST-TM-MM.      05678000
056790     MOVE PV-FORMAT-TMST            TO IMCNPO-PO-RCVD-DELY-TMST.  05679000
056800                                                                  05680000
056810                                                                  05681000
056820     MOVE TR023-CONPO-PO-NBR           TO IMCNPO-PO-NBR.          05682000
056830                                                                  05683000
056840     MOVE TR023-CONPO-EXTL-REF-NBR     TO IMCNPO-EXTL-REF-NBR.    05684000
056850                                                                  05685000
056860     IF TR023-CONPO-CART-CNT NOT NUMERIC                          05686000
056870         MOVE ZEROS                    TO IMCNPO-PO-CART-CNT      05687000
056880     ELSE                                                         05688000
056890         MOVE TR023-CONPO-CART-CNT     TO IMCNPO-PO-CART-CNT      05689000
056900     END-IF.                                                      05690000
056910                                                                  05691000
056920     IF TR023-CONPO-UNT-QTY NOT NUMERIC                           05692000
056930         MOVE ZEROS                    TO IMCNPO-PO-UNT-QTY       05693000
056940     ELSE                                                         05694000
056950         MOVE TR023-CONPO-UNT-QTY      TO IMCNPO-PO-UNT-QTY       05695000
056960     END-IF.                                                      05696000
056970                                                                  05697000
056980     IF TR023-CONPO-CBMT-QTY NOT NUMERIC                          05698000
056990         MOVE ZEROS                    TO IMCNPO-PO-CBMT-QTY      05699000
057000     ELSE                                                         05700000
057010         MOVE TR023-CONPO-CBMT-QTY TO IMCNPO-PO-CBMT-QTY          05701000
057020     END-IF.                                                      05702000
057030                                                                  05703000
057040     IF TR023-CONPO-WT-KGRM-QTY NOT NUMERIC                       05704000
057050         MOVE ZEROS                    TO IMCNPO-PO-WT-KGRM-QTY   05705000
057060     ELSE                                                         05706000
057070         MOVE TR023-CONPO-WT-KGRM-QTY  TO IMCNPO-PO-WT-KGRM-QTY   05707000
057080     END-IF.                                                      05708000
057090                                                                  05709000
057100**CONPOB FIELDS **                                                05710000
057110                                                                  05711000
057120     MOVE TR023-CONPO-LTR-OF-CR-NBR    TO IMCNPO-LTR-OF-CR-NBR.   05712000
057130     MOVE TR023-CONPO-HSE-BOL-NBR      TO IMCNPO-HSE-BOL-NBR.     05713000
057140                                                                  05714000
057150**CONPOC FIELDS **                                                05715000
057160                                                                  05716000
057170     MOVE TR023-CONPO-MSTR-BOL-NBR     TO IMCNPO-MSTR-BOL-NBR.    05717000
057180                                                                  05718000
057190     MOVE TR023-CONPO-PO-C-O-PROD-CDE  TO IMCNPO-PO-C-O-PROD-CDE  05719000
057200                                          PV-HOLD-CNTRY-CDE.      05720000
057210     MOVE TR023-CONPO-DOC-RCVD-ORGN-DTE (1:4)  TO                 05721000
057220                                        PV-FORMAT-TMST-DTE-CY.    05722000
057230     MOVE TR023-CONPO-DOC-RCVD-ORGN-DTE (5:2)  TO                 05723000
057240                                        PV-FORMAT-TMST-DTE-MM.    05724000
057250     MOVE TR023-CONPO-DOC-RCVD-ORGN-DTE (7:2)  TO                 05725000
057260                                        PV-FORMAT-TMST-DTE-DD.    05726000
057270     MOVE TR023-CONPO-DOC-RCVD-ORGN-TM (1:2)   TO                 05727000
057280                                        PV-FORMAT-TMST-TM-HH.     05728000
057290     MOVE TR023-CONPO-DOC-RCVD-ORGN-TM (3:2)   TO                 05729000
057300                                        PV-FORMAT-TMST-TM-MM.     05730000
057310     MOVE IMCNPO-DOC-RCVD-ORGN-TMST TO  PV-DOC-RCVD-ORGN-TMST-OLD.05731000
057320     MOVE PV-FORMAT-TMST            TO  IMCNPO-DOC-RCVD-ORGN-TMST 05732000
057330                                        PV-DOC-RCVD-ORGN-TMST-NEW.05733000
057340                                                                  05734000
057350                                                                  05735000
057360     PERFORM 5620-EDIT-CNTRY-CDE.                                 05736000
057370                                                                  05737000
057380******************************************************************05738000
057390* MOVE CONUPC INPUT FIELDS TO HOST VARIABLE FIELDS FOR TIMCNUP.  *05739000
057400******************************************************************05740000
057410 5550-MOVE-CONUPC-TO-DCLGEN.                                      05741000
057420                                                                  05742000
057430**CONUPA FIELDS                                                   05743000
057440     MOVE TR023-CONUPC-CONTNR-ID       TO IMCNUP-CONTNR-ID.       05744000
057450     MOVE TR023-CONUPC-VS-NBR          TO IMCNUP-VS-NBR.          05745000
057460     MOVE TR023-CONUPC-PO-NBR          TO IMCNUP-PO-NBR.          05746000
057470     MOVE TR023-CONUPC-UPC-NBR         TO IMCNUP-UPC-NBR.         05747000
057480     MOVE TR023-CONUPC-ASN-PKG-CDE     TO IMCNUP-ASN-PKGNG-CDE    05748000
057490                                                                  05749000
057500     IF TR023-CONUPC-CART-CNT NOT NUMERIC                         05750000
057510         MOVE ZEROS                    TO IMCNUP-UPC-CART-CNT     05751000
057520     ELSE                                                         05752000
057530         MOVE TR023-CONUPC-CART-CNT    TO IMCNUP-UPC-CART-CNT     05753000
057540     END-IF.                                                      05754000
057550                                                                  05755000
057560     IF TR023-CONUPC-UNT-QTY NOT NUMERIC                          05756000
057570         MOVE ZEROS                    TO IMCNUP-UPC-UNT-QTY      05757000
057580     ELSE                                                         05758000
057590         MOVE TR023-CONUPC-UNT-QTY     TO IMCNUP-UPC-UNT-QTY      05759000
057600     END-IF.                                                      05760000
057610                                                                  05761000
057620**CONUPB FIELDS______________________________________________     05762000
057630                                                                  05763000
057640     IF TR023-CONUPC-CBMT-QTY NOT NUMERIC                         05764000
057650         MOVE ZEROS                    TO IMCNUP-UPC-CBMT-QTY     05765000
057660     ELSE                                                         05766000
057670         MOVE TR023-CONUPC-CBMT-QTY    TO IMCNUP-UPC-CBMT-QTY     05767000
057680     END-IF.                                                      05768000
057690                                                                  05769000
057700     IF TR023-CONUPC-WT-KGRM-QTY NOT NUMERIC                      05770000
057710         MOVE ZEROS                    TO IMCNUP-UPC-WT-KGRM-QTY  05771000
057720     ELSE                                                         05772000
057730         MOVE TR023-CONUPC-WT-KGRM-QTY TO IMCNUP-UPC-WT-KGRM-QTY  05773000
057740     END-IF.                                                      05774000
057750                                                                  05775000
057760     IF TR023-CONUPC-SKU NOT NUMERIC                              05776000
057770         MOVE ZEROS                    TO IMCNUP-SKU-NBR          05777000
057780     ELSE                                                         05778000
057790         MOVE TR023-CONUPC-SKU         TO IMCNUP-SKU-NBR          05779000
057800     END-IF.                                                      05780000
057810                                                                  05781000
057820**CONUPC FIELDS______________________________________________     05782000
057830                                                                  05783000
057840     MOVE TR023-CONUPC-SKU TO IMCNUP-SKU-NBR.                     05784000
057850     MOVE TR023-CONUPC-ASN-PKG-CDE TO IMCNUP-ASN-PKGNG-CDE.       05785000
057860                                                                  05786000
057870******************************************************************05787000
057880* MOVE CNCART INPUT FIELDS TO HOST VARIABLE FIELDS FOR           *05788000
057890* TRT_IMPRT_CART.                                                *05789000
057900******************************************************************05790000
057910 5560-MOVE-CNCART-TO-DCLGEN.                                      05791000
057920                                                                  05792000
057930**CNCART FIELDS                                                   05793000
057940     MOVE TR023-CNCART-CONTNR-ID       TO TRT00008-CONTNR-ID.     05794000
057950     MOVE TR023-CNCART-PO-NBR          TO TRT00008-PO-NBR.        05795000
057960     MOVE TR023-CNCART-UPC-NBR         TO TRT00008-UPC-NBR.       05796000
057970     MOVE TR023-CNCART-SSCC-NBR        TO TRT00008-SSCC-ID.       05797000
057980                                                                  05798000
057990     IF TR023-CNCART-UNT-QTY NOT NUMERIC                          05799000
058000         MOVE ZEROS                    TO TRT00008-UNT-QTY        05800000
058010     ELSE                                                         05801000
058020         MOVE TR023-CNCART-UNT-QTY     TO TRT00008-UNT-QTY        05802000
058030     END-IF.                                                      05803000
058040                                                                  05804000
058050******************************************************************05805000
058060* MOVE CNSEAL INPUT FIELDS TO HOST VARIABLE FIELDS FOR           *05806000
058070* TRT_IMPRT_SEAL.                                                *05807000
058080******************************************************************05808000
058090 5570-MOVE-CNSEAL-TO-DCLGEN.                                      05809000
058100                                                                  05810000
058110**CNSEAL FIELDS                                                   05811000
058120     MOVE TR023-CNSEAL-CONTNR-ID       TO TRT00006-CONTNR-ID.     05812000
058130     MOVE TR023-CNSEAL-CONTNR-SEAL-NBR TO TRT00006-SEAL-NBR.      05813000
058140                                                                  05814000
058150******************************************************************05815000
058160* INITIALIZE THE COMMON FIELDS ON THE ERROR RECORD.              *05816000
058170******************************************************************05817000
058180 5585-INIT-COMMON-ERROR-FIELDS.                                   05818000
058190                                                                  05819000
058200     MOVE SPACES         TO TR211-CVYA-EST-POE-DELY-DTE           05820000
058210                            TR211-CVYA-EST-POE-DELY-TM            05821000
058220                            TR211-CVYA-IMPRT-TRIP-ID              05822000
058230                            TR211-CVYA-CARR-SCAC-ID.              05823000
058240                                                                  05824000
058250******************************************************************05825000
058260* INITIALIZE THE ARRIVAL AND DELIVERY ORDER HOLD FIELDS.         *05826000
058270******************************************************************05827000
058280 5590-INIT-ARV-DELV-HOLD-FIELDS.                                  05828000
058290                                                                  05829000
058300     MOVE PC-DEFAULT-TMST TO PV-HOLD-BKR-FRGT-RLSE-TMST           05830000
058310                             PV-HOLD-DO-TO-DCONSLR-TMST           05831000
058320                             PV-HOLD-DO-RCVD-TMST                 05832000
058330                             PV-HOLD-CONTNR-PU-TMST               05833000
058340                             PV-HOLD-DVN-TMST                     05834000
058350                             PV-HOLD-DCONSLR-RET-TMST             05835000
058360                             PV-HOLD-ACTL-POE-DELY-TMST           05836000
058370                             PV-HOLD-ACTL-LBD-TMST.               05837000
058380                                                                  05838000
058390     MOVE SPACES          TO PV-HOLD-ACTL-DEST-POE-CDE            05839000
058400                             PV-HOLD-ACTL-LBD-NM                  05840000
058410                             PV-HOLD-DCONSLR-SCAC-ID.             05841000
058420                                                                  05842000
058430******************************************************************05843000
058440* INITIALIZE THE ARRIVAL AND DELIVERY ORDER HOLD FIELDS.         *05844000
058450******************************************************************05845000
058460 5595-INIT-ARV-DELV-CDE-HOLD.                                     05846000
058470                                                                  05847000
058480     MOVE SPACES TO PV-HOLD-BKR-FRGT-RLSE-CDE                     05848000
058490                    PV-HOLD-DO-RCVD-CDE                           05849000
058500                    PV-HOLD-CONTNR-PU-CDE                         05850000
058510                    PV-HOLD-DVN-CDE                               05851000
058520                    PV-HOLD-DCONSLR-RET-CDE                       05852000
058530                    PV-HOLD-ACTL-POE-DELY-CDE.                    05853000
058540                                                                  05854000
058550******************************************************************05855000
058560* INITIALIZE THE ARRIVAL AND DELIVERY ORDER HOLD FIELDS.         *05856000
058570******************************************************************05857000
058580 5597-INIT-TIMCNPO-CDES.                                          05858000
058590                                                                  05859000
058600     MOVE SPACES TO IMCNPO-BKR-FRGT-RLSE-CDE                      05860000
058610                    IMCNPO-DO-RCVD-CDE                            05861000
058620                    IMCNPO-CONTNR-PU-CDE                          05862000
058630                    IMCNPO-DVN-CDE                                05863000
058640                    IMCNPO-DCONSLR-RET-CDE                        05864000
058650                    IMCNPO-ACTL-POE-DELY-CDE.                     05865000
058660                                                                  05866000
058670******************************************************************05867000
058680* FORMAT THE ACTUAL DEPARTURE TIMESTAMP.                         *05868000
058690******************************************************************05869000
058700 5600-FORMAT-ACTL-DPRTR-TMST.                                     05870000
058710                                                                  05871000
058720     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM (1:4)  TO                 05872000
058730                          PV-FORMAT-TMST-DTE-CY.                  05873000
058740     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM (5:2)  TO                 05874000
058750                          PV-FORMAT-TMST-DTE-MM.                  05875000
058760     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM (7:2)  TO                 05876000
058770                          PV-FORMAT-TMST-DTE-DD.                  05877000
058780                                                                  05878000
058790     IF TR023-CNTR-ACTL-DPRTR-TM-MOM EQUAL SPACES                 05879000
058800         MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH                05880000
058810                              PV-FORMAT-TMST-TM-MM                05881000
058820     ELSE                                                         05882000
058830         MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM (1:2)   TO             05883000
058840                              PV-FORMAT-TMST-TM-HH                05884000
058850         MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM (3:2)   TO             05885000
058860                              PV-FORMAT-TMST-TM-MM                05886000
058870     END-IF.                                                      05887000
058880                                                                  05888000
058890     MOVE PV-FORMAT-TMST TO PV-FORMATED-DB2-TMST.                 05889000
058900                                                                  05890000
058910******************************************************************05891000
058920* EDIT THE POE CODE.                                             *05892000
058930******************************************************************05893000
058940 5610-EDIT-POE-CDE.                                               05894000
058950                                                                  05895000
058960     IF PV-HOLD-POE-CDE = SPACES                                  05896000
058970         CONTINUE                                                 05897000
058980     ELSE                                                         05898000
058990*        EVALUATE TRUE                                            05899000
059000*            WHEN PV-HOLD-TRIP-TYP-CDE = PC-A                     05900000
059010*THESE NEXT 3 PARAGRAPHS ARE NOT BEING USED.  AME 10/2007        *05901000
059020*DURING LANDED/AIR ASN PROJECT THE KOHL'S GROUP WORKING WITH     *05902000
059030*AVERY AGREED THAT AVERY COULD SEND SCHEDULE D CODES, OCEAN PORT *05903000
059040*CODES, INSTEAD OF IATA CODES, AIRPORT CODES, FOR THE AIR ASN.   *05904000
059050*OTHER PROGRAMS CHANGED TRKCS165, TRKCS188, TRKCS162, TRKCS190,  *05905000
059060*TRKCS189, TRKCS167, TRKCS181, TRKCS192, TRKCS183.               *05906000
059070*                PERFORM 7280-OPEN-POE-CURSOR-AIR                 05907000
059080*                PERFORM 7282-FETCH-POE-CURSOR-AIR                05908000
059090*                PERFORM 7281-CLOSE-POE-CURSOR-AIR                05909000
059100*                                                                 05910000
059110*            WHEN PV-HOLD-TRIP-TYP-CDE = PC-O                     05911000
059120                 PERFORM 7283-OPEN-POE-CURSOR-OCEAN               05912000
059130                 PERFORM 7285-FETCH-POE-CURSOR-OCEAN              05913000
059140                 PERFORM 7284-CLOSE-POE-CURSOR-OCEAN              05914000
059150**       END-EVALUATE                                             05915000
059160     END-IF.                                                      05916000
059170                                                                  05917000
059180******************************************************************05918000
059190* EDIT THE FOB CODE.                                             *05919000
059200******************************************************************05920000
059210 5615-EDIT-FOB-CDE.                                               05921000
059220                                                                  05922000
059230     IF PV-HOLD-FOB-CDE = SPACES                                  05923000
059240         CONTINUE                                                 05924000
059250     ELSE                                                         05925000
059260         EVALUATE TRUE                                            05926000
059270             WHEN PV-HOLD-TRIP-TYP-CDE = PC-A                     05927000
059280                 PERFORM 7293-SELECT-FOB-AIR                      05928000
059290                                                                  05929000
059300             WHEN PV-HOLD-TRIP-TYP-CDE = PC-O                     05930000
059310                 PERFORM 7294-SELECT-FOB-OCEAN                    05931000
059320         END-EVALUATE                                             05932000
059330     END-IF.                                                      05933000
059340                                                                  05934000
059350******************************************************************05935000
059360* EDIT THE COUNTRY OF PRODUCTION CODE.                           *05936000
059370******************************************************************05937000
059380 5620-EDIT-CNTRY-CDE.                                             05938000
059390                                                                  05939000
059400     IF IMCNPO-PO-C-O-PROD-CDE = SPACES                           05940000
059410         CONTINUE                                                 05941000
059420     ELSE                                                         05942000
059430         IF PS-LANDED-PO-NOT-FOUND                                05943000
059440            PERFORM 7275-SELECT-CNTRY-CDE                         05944000
059450            IF PS-INVALID-CNTRY-CDE                               05945000
059460                MOVE PC-WARNING     TO TR211-ERROR-TYPE           05946000
059470                MOVE 'PO CNTRY CDE' TO TR211-DATA-IN-ERROR        05947000
059480                MOVE TR023-CONPO-PO-C-O-PROD-CDE       TO         05948000
059490                                       TR211-DATA-VALUE           05949000
059500                MOVE 'INVALID CNTRY CODE ON KOHLS SYSTEM' TO      05950000
059510                                       TR211-ERROR-MSG            05951000
059520                PERFORM 5830-LOAD-CONPOC-TO-REPORT                05952000
059530            END-IF                                                05953000
059540         END-IF                                                   05954000
059550     END-IF.                                                      05955000
059560                                                                  05956000
059570******************************************************************05957000
059580* EDIT THE POL AND POR ORIGIN CODES.                             *05958000
059590******************************************************************05959000
059600 5630-EDIT-ORGN-CDE.                                              05960000
059610                                                                  05961000
059620     IF PV-HOLD-ORGN-CDE = SPACES                                 05962000
059630         CONTINUE                                                 05963000
059640     ELSE                                                         05964000
059650         EVALUATE TRUE                                            05965000
059660             WHEN PV-HOLD-TRIP-TYP-CDE = PC-A                     05966000
059670                 PERFORM 7296-SELECT-ORGN-AIR                     05967000
059680                                                                  05968000
059690             WHEN PV-HOLD-TRIP-TYP-CDE = PC-O                     05969000
059700                 PERFORM 7297-SELECT-ORGN-OCEAN                   05970000
059710         END-EVALUATE                                             05971000
059720     END-IF.                                                      05972000
059730                                                                  05973000
059740******************************************************************05974000
059750* DETERMINE WHAT TYPE OF DELETE IS BEING PROCESSED AND THEN MOVE *05975000
059760* THE CONTAINER DELIVERY ORDER AND ARRIVAL FIELDS TO THE         *05976000
059770* APPROPRIATE HOLD FIELDS.                                       *05977000
059780******************************************************************05978000
059790 5660-MOVE-ARV-DELV-DCLGEN-FLDS.                                  05979000
059800                                                                  05980000
059810     MOVE IMCNTK-BKR-FRGT-RLSE-TMST TO                            05981000
059820                               PV-HOLD-BKR-FRGT-RLSE-TMST.        05982000
059830     MOVE IMCNTK-DO-RCVD-TMST       TO                            05983000
059840                               PV-HOLD-DO-RCVD-TMST.              05984000
059850     MOVE IMCNTK-CONTNR-PU-TMST     TO                            05985000
059860                               PV-HOLD-CONTNR-PU-TMST.            05986000
059870     MOVE IMCNTK-DVN-TMST           TO                            05987000
059880                               PV-HOLD-DVN-TMST.                  05988000
059890     MOVE IMCNTK-DCONSLR-RET-TMST   TO                            05989000
059900                               PV-HOLD-DCONSLR-RET-TMST.          05990000
059910     MOVE IMCNTK-DCONSLR-SCAC-ID    TO                            05991000
059920                               PV-HOLD-DCONSLR-SCAC-ID.           05992000
059930     MOVE IMCNTK-ACTL-DEST-POE-CDE  TO                            05993000
059940                               PV-HOLD-ACTL-DEST-POE-CDE.         05994000
059950     MOVE IMCNTK-ACTL-POE-DELY-TMST TO                            05995000
059960                               PV-HOLD-ACTL-POE-DELY-TMST.        05996000
059970     MOVE IMCNTK-ACTL-LBD-NM        TO                            05997000
059980                               PV-HOLD-ACTL-LBD-NM.               05998000
059990     MOVE IMCNTK-ACTL-LBD-TMST      TO                            05999000
060000                               PV-HOLD-ACTL-LBD-TMST.             06000000
060010                                                                  06001000
060020******************************************************************06002000
060030* SET THE APPROPRIATE SWITCHES TO PRINT ARRIVAL OR DELIVERY      *06003000
060040* MESSAGES.                                                      *06004000
060050******************************************************************06005000
060060 5665-SET-ARVL-DELV-WNG-MSGS.                                     06006000
060070                                                                  06007000
060080     IF ((IMCNTK-BKR-FRGT-RLSE-TMST NOT = PC-DEFAULT-TMST) OR     06008000
060090         (IMCNTK-DVN-TMST           NOT = PC-DEFAULT-TMST) OR     06009000
060100         (IMCNTK-DCONSLR-RET-TMST   NOT = PC-DEFAULT-TMST) OR     06010000
060110         (IMCNTK-DO-RCVD-TMST       NOT = PC-DEFAULT-TMST) OR     06011000
060120         (IMCNTK-CONTNR-PU-TMST     NOT = PC-DEFAULT-TMST) OR     06012000
060130         (IMCNTK-DCONSLR-SCAC-ID    NOT = SPACES))        AND     06013000
060140        ((IMCNTK-ACTL-DEST-POE-CDE  NOT = SPACES)          OR     06014000
060150         (IMCNTK-ACTL-POE-DELY-TMST NOT = PC-DEFAULT-TMST) OR     06015000
060160         (IMCNTK-ACTL-LBD-NM        NOT = SPACES)          OR     06016000
060170         (IMCNTK-ACTL-LBD-TMST      NOT = PC-DEFAULT-TMST))       06017000
060180          SET PS-DELETE-DELV-ARV-MSG TO TRUE                      06018000
060190     ELSE                                                         06019000
060200     IF (IMCNTK-BKR-FRGT-RLSE-TMST NOT = PC-DEFAULT-TMST) OR      06020000
060210        (IMCNTK-DVN-TMST           NOT = PC-DEFAULT-TMST) OR      06021000
060220        (IMCNTK-DCONSLR-RET-TMST   NOT = PC-DEFAULT-TMST) OR      06022000
060230        (IMCNTK-DO-RCVD-TMST       NOT = PC-DEFAULT-TMST) OR      06023000
060240        (IMCNTK-CONTNR-PU-TMST     NOT = PC-DEFAULT-TMST) OR      06024000
060250        (IMCNTK-DCONSLR-SCAC-ID    NOT = SPACES)                  06025000
060260         SET PS-DELETE-DELV-MSG TO TRUE                           06026000
060270     ELSE                                                         06027000
060280     IF (IMCNTK-ACTL-DEST-POE-CDE  NOT = SPACES)          OR      06028000
060290        (IMCNTK-ACTL-POE-DELY-TMST NOT = PC-DEFAULT-TMST) OR      06029000
060300        (IMCNTK-ACTL-LBD-NM        NOT = SPACES)          OR      06030000
060310        (IMCNTK-ACTL-LBD-TMST      NOT = PC-DEFAULT-TMST)         06031000
060320         SET PS-DELETE-ARV-MSG TO TRUE                            06032000
060330     END-IF                                                       06033000
060340     END-IF                                                       06034000
060350     END-IF.                                                      06035000
060360                                                                  06036000
060370******************************************************************06037000
060380* MOVE THE ARRIVAL AND DELIVERY ORDER HOLD FIELDS TO THE TIMCNTK *06038000
060390* DCLGEN FIELDS PRIOR TO INSERTING A ROW.                        *06039000
060400******************************************************************06040000
060410 5670-MOVE-ARV-DELV-HOLD.                                         06041000
060420                                                                  06042000
060430     IF PV-HOLD-BKR-FRGT-RLSE-TMST = SPACES                       06043000
060440         MOVE PC-DEFAULT-TMST TO IMCNTK-BKR-FRGT-RLSE-TMST        06044000
060450     ELSE                                                         06045000
060460         MOVE PV-HOLD-BKR-FRGT-RLSE-TMST   TO                     06046000
060470                                 IMCNTK-BKR-FRGT-RLSE-TMST        06047000
060480     END-IF.                                                      06048000
060490                                                                  06049000
060500     IF PV-HOLD-DO-TO-DCONSLR-TMST = SPACES                       06050000
060510         MOVE PC-DEFAULT-TMST TO IMCNTK-DO-TO-DCONSLR-TMST        06051000
060520     ELSE                                                         06052000
060530         MOVE PV-HOLD-DO-TO-DCONSLR-TMST   TO                     06053000
060540                                 IMCNTK-DO-TO-DCONSLR-TMST        06054000
060550     END-IF.                                                      06055000
060560                                                                  06056000
060570     IF PV-HOLD-DVN-TMST = SPACES                                 06057000
060580         MOVE PC-DEFAULT-TMST TO IMCNTK-DVN-TMST                  06058000
060590     ELSE                                                         06059000
060600         MOVE PV-HOLD-DVN-TMST             TO                     06060000
060610                                 IMCNTK-DVN-TMST                  06061000
060620     END-IF.                                                      06062000
060630                                                                  06063000
060640     IF PV-HOLD-DCONSLR-RET-TMST = SPACES                         06064000
060650         MOVE PC-DEFAULT-TMST TO IMCNTK-DCONSLR-RET-TMST          06065000
060660     ELSE                                                         06066000
060670         MOVE PV-HOLD-DCONSLR-RET-TMST     TO                     06067000
060680                                 IMCNTK-DCONSLR-RET-TMST          06068000
060690     END-IF.                                                      06069000
060700                                                                  06070000
060710     MOVE PV-HOLD-DCONSLR-SCAC-ID          TO                     06071000
060720                                 IMCNTK-DCONSLR-SCAC-ID           06072000
060730                                                                  06073000
060740     IF PV-HOLD-DO-RCVD-TMST = SPACES                             06074000
060750         MOVE PC-DEFAULT-TMST TO IMCNTK-DO-RCVD-TMST              06075000
060760     ELSE                                                         06076000
060770         MOVE PV-HOLD-DO-RCVD-TMST         TO                     06077000
060780                                 IMCNTK-DO-RCVD-TMST              06078000
060790     END-IF.                                                      06079000
060800                                                                  06080000
060810     IF PV-HOLD-CONTNR-PU-TMST = SPACES                           06081000
060820         MOVE PC-DEFAULT-TMST TO IMCNTK-CONTNR-PU-TMST            06082000
060830     ELSE                                                         06083000
060840         MOVE PV-HOLD-CONTNR-PU-TMST       TO                     06084000
060850                                 IMCNTK-CONTNR-PU-TMST            06085000
060860     END-IF.                                                      06086000
060870                                                                  06087000
060880     MOVE PV-HOLD-ACTL-DEST-POE-CDE        TO                     06088000
060890                                 IMCNTK-ACTL-DEST-POE-CDE.        06089000
060900                                                                  06090000
060910     IF PV-HOLD-ACTL-POE-DELY-TMST = SPACES                       06091000
060920         MOVE PC-DEFAULT-TMST TO IMCNTK-ACTL-POE-DELY-TMST        06092000
060930     ELSE                                                         06093000
060940        MOVE PV-HOLD-ACTL-POE-DELY-TMST    TO                     06094000
060950                                 IMCNTK-ACTL-POE-DELY-TMST        06095000
060960     END-IF.                                                      06096000
060970                                                                  06097000
060980     MOVE PV-HOLD-ACTL-LBD-NM TO IMCNTK-ACTL-LBD-NM.              06098000
060990                                                                  06099000
061000     IF PV-HOLD-ACTL-LBD-TMST = SPACES                            06100000
061010         MOVE PC-DEFAULT-TMST TO IMCNTK-ACTL-LBD-TMST             06101000
061020     ELSE                                                         06102000
061030         MOVE PV-HOLD-ACTL-LBD-TMST        TO                     06103000
061040                                 IMCNTK-ACTL-LBD-TMST             06104000
061050     END-IF.                                                      06105000
061060                                                                  06106000
061070******************************************************************06107000
061080* MOVE THE CONTAINER PO ARRIVAL AND DELIVERY CODE FIELDS TO THE  *06108000
061090* APPROPRIATE HOLD FIELDS PRIOR TO DELETING THE TIMCNPO ROW.     *06109000
061100******************************************************************06110000
061110 5675-MOVE-ARV-DELV-CDE-FIELDS.                                   06111000
061120                                                                  06112000
061130     MOVE IMCNPO-BKR-FRGT-RLSE-CDE TO                             06113000
061140                               PV-HOLD-BKR-FRGT-RLSE-CDE.         06114000
061150     MOVE IMCNPO-DO-RCVD-CDE       TO                             06115000
061160                               PV-HOLD-DO-RCVD-CDE.               06116000
061170     MOVE IMCNPO-CONTNR-PU-CDE     TO                             06117000
061180                               PV-HOLD-CONTNR-PU-CDE.             06118000
061190     MOVE IMCNPO-ACTL-POE-DELY-CDE TO                             06119000
061200                               PV-HOLD-ACTL-POE-DELY-CDE.         06120000
061210     MOVE IMCNPO-DVN-CDE           TO                             06121000
061220                               PV-HOLD-DVN-CDE.                   06122000
061230     MOVE IMCNPO-DCONSLR-RET-CDE   TO                             06123000
061240                               PV-HOLD-DCONSLR-RET-CDE.           06124000
061250                                                                  06125000
061260******************************************************************06126000
061270* MOVE THE ARRIVAL AND DELIVERY CODE HOLD FIELDS TO THE TIMCNPO  *06127000
061280* DCLGEN FIELDS PRIOR TO INSERTING A ROW.                        *06128000
061290******************************************************************06129000
061300 5680-MOVE-ARV-DELV-CDE-HOLD.                                     06130000
061310                                                                  06131000
061320     MOVE PV-HOLD-BKR-FRGT-RLSE-CDE TO                            06132000
061330                                 IMCNPO-BKR-FRGT-RLSE-CDE.        06133000
061340     MOVE PV-HOLD-DO-RCVD-CDE       TO                            06134000
061350                                 IMCNPO-DO-RCVD-CDE.              06135000
061360     MOVE PV-HOLD-CONTNR-PU-CDE     TO                            06136000
061370                                 IMCNPO-CONTNR-PU-CDE.            06137000
061380     MOVE PV-HOLD-ACTL-POE-DELY-CDE TO                            06138000
061390                                 IMCNPO-ACTL-POE-DELY-CDE.        06139000
061400     MOVE PV-HOLD-DVN-CDE           TO                            06140000
061410                                 IMCNPO-DVN-CDE.                  06141000
061420     MOVE PV-HOLD-DCONSLR-RET-CDE   TO                            06142000
061430                                 IMCNPO-DCONSLR-RET-CDE.          06143000
061440                                                                  06144000
061450***************************************************************** 06145000
061460* MOVE FIELDS FOR CONTAINER DETAIL LINE.                        * 06146000
061470***************************************************************** 06147000
061480 5700-MOVE-CNTK-DETAIL.                                           06148000
061490                                                                  06149000
061500     MOVE SPACES               TO TR211-DATA-IN-ERROR             06150000
061510                                  TR211-DATA-VALUE                06151000
061520                                  TR211-ERROR-TYPE                06152000
061530                                  TR211-ERROR-MSG.                06153000
061540                                                                  06154000
061550     PERFORM 5800-LOAD-CVYA-TO-REPORT.                            06155000
061560                                                                  06156000
061570     IF TR023-CNTR-PROCESS-SEQ-NBR-2 > ZEROES                     06157000
061580         PERFORM 5805-LOAD-CVYB-TO-REPORT                         06158000
061590     END-IF.                                                      06159000
061600                                                                  06160000
061610     PERFORM 5810-LOAD-CONA-TO-REPORT.                            06161000
061620     PERFORM 5815-LOAD-CONB-TO-REPORT.                            06162000
061630                                                                  06163000
061640***************************************************************** 06164000
061650* MOVE FIELDS FOR PO DETAIL LINE.                               * 06165000
061660***************************************************************** 06166000
061670 5705-MOVE-CNPO-DETAIL.                                           06167000
061680                                                                  06168000
061690     MOVE SPACES               TO TR211-DATA-IN-ERROR             06169000
061700                                  TR211-DATA-VALUE                06170000
061710                                  TR211-ERROR-TYPE                06171000
061720                                  TR211-ERROR-MSG.                06172000
061730                                                                  06173000
061740     PERFORM 5820-LOAD-CONPOA-TO-REPORT.                          06174000
061750     PERFORM 5825-LOAD-CONPOB-TO-REPORT.                          06175000
061760     PERFORM 5830-LOAD-CONPOC-TO-REPORT.                          06176000
061770                                                                  06177000
061780***************************************************************** 06178000
061790* MOVE FIELDS FOR UPC DETAIL LINE.                              * 06179000
061800***************************************************************** 06180000
061810 5715-MOVE-CNUP-DETAIL.                                           06181000
061820                                                                  06182000
061830     MOVE SPACES               TO TR211-DATA-IN-ERROR             06183000
061840                                  TR211-DATA-VALUE                06184000
061850                                  TR211-ERROR-TYPE                06185000
061860                                  TR211-ERROR-MSG.                06186000
061870                                                                  06187000
061880     PERFORM 5840-LOAD-CONUPA-TO-REPORT.                          06188000
061890     PERFORM 5845-LOAD-CONUPB-TO-REPORT.                          06189000
061900     PERFORM 5850-LOAD-CONUPC-TO-REPORT.                          06190000
061910                                                                  06191000
061920***************************************************************** 06192000
061930* MOVE FIELDS FOR CONTAINER CARTON DETAIL LINE.                 * 06193000
061940***************************************************************** 06194000
061950 5716-MOVE-CNCT-DETAIL.                                           06195000
061960                                                                  06196000
061970     MOVE SPACES               TO TR211-DATA-IN-ERROR             06197000
061980                                  TR211-DATA-VALUE                06198000
061990                                  TR211-ERROR-TYPE                06199000
062000                                  TR211-ERROR-MSG.                06200000
062010                                                                  06201000
062020     PERFORM 5860-LOAD-CNCART-TO-REPORT.                          06202000
062030                                                                  06203000
062040***************************************************************** 06204000
062050* MOVE FIELDS FOR CONTAINER SEAL DETAIL LINE.                   * 06205000
062060***************************************************************** 06206000
062070 5717-MOVE-CNSL-DETAIL.                                           06207000
062080                                                                  06208000
062090     MOVE SPACES               TO TR211-DATA-IN-ERROR             06209000
062100                                  TR211-DATA-VALUE                06210000
062110                                  TR211-ERROR-TYPE                06211000
062120                                  TR211-ERROR-MSG.                06212000
062130                                                                  06213000
062140     PERFORM 5865-LOAD-CNSEAL-TO-REPORT.                          06214000
062150                                                                  06215000
062160***************************************************************** 06216000
062170* MOVE FIELDS FOR RECYCLE ARRIVAL RECORDS.                      * 06217000
062180***************************************************************** 06218000
062190 5720-MOVE-RECYCLE-ADURD.                                         06219000
062200                                                                  06220000
062210     PERFORM 5750-CREATE-ISA-RECORDS.                             06221000
062220     INITIALIZE TR016-REC-TYP-ADURD.                              06222000
062230     SET TR016-ADURD-TRN-TYP-ADD                                  06223000
062240         TR016-ADURD-REC-TYP-CDE-ADURDA                           06224000
062250         TR016-ADURD-SEQ-NBR-30      TO TRUE.                     06225000
062260     MOVE IMCNPO-PO-NBR              TO TR016-ADURD-PO-NBR.       06226000
062270     MOVE IMCNPO-EXTL-REF-NBR        TO TR016-ADURD-EXTL-REF-NBR. 06227000
062280     MOVE IMCNTK-MOM-TRIP-TYP-CDE    TO                           06228000
062290                              TR016-ADURD-TRIP-TYP-CDE-MOM.       06229000
062300     MOVE IMCNTK-MOM-CARR-SCAC-ID    TO TR016-ADURD-CARR-SCAC-ID. 06230000
062310     MOVE IMCNTK-MOM-IMPRT-TRIP-ID   TO TR016-ADURD-IMPRT-TRIP-ID.06231000
062320     MOVE IMCNTK-MOM-IMPRT-VEH-NM    TO TR016-ADURD-IMPRT-VEH-NM. 06232000
062330     MOVE IMCNTK-ACTL-DEST-POE-CDE   TO                           06233000
062340                              TR016-ADURD-ACTL-DEST-POE-CDE.      06234000
062350     MOVE IMCNTK-ACTL-POE-DELY-TMST (1:4)                         06235000
062360                                     TO                           06236000
062370                              TR016-ADURD-ACTL-POE-DELY-DTE (1:4).06237000
062380     MOVE IMCNTK-ACTL-POE-DELY-TMST (6:2)                         06238000
062390                                     TO                           06239000
062400                              TR016-ADURD-ACTL-POE-DELY-DTE (5:2).06240000
062410     MOVE IMCNTK-ACTL-POE-DELY-TMST (9:2)                         06241000
062420                                     TO                           06242000
062430                              TR016-ADURD-ACTL-POE-DELY-DTE (7:2).06243000
062440     MOVE IMCNTK-ACTL-POE-DELY-TMST (12:2)                        06244000
062450                                     TO                           06245000
062460                              TR016-ADURD-ACTL-POE-DELY-TM  (1:2).06246000
062470     MOVE IMCNTK-ACTL-POE-DELY-TMST (15:2)                        06247000
062480                                     TO                           06248000
062490                              TR016-ADURD-ACTL-POE-DELY-TM  (3:2).06249000
062500     MOVE SPACE                      TO TR016-ADURD-CONSOL-END    06250000
062510                                        TR016-ADURD-EDI.          06251000
062520     MOVE PC-HEX-15                  TO TR016-ADURD-EDI-SEG-END.  06252000
062530     MOVE PV-HOLD-ISA-FILE-ID        TO TR016-ADURD-FILE-ID.      06253000
062540     MOVE PV-HOLD-ISA-ENT-ID         TO TR016-ADURD-ENT-ID.       06254000
062550     MOVE TR016-REC-TYP-ADURD        TO OUTTR5-CONTNR-RPTS-1-ODR. 06255000
062560                                                                  06256000
062570                                                                  06257000
062580***************************************************************** 06258000
062590* MOVE FIELDS FOR RECYCLE DELIVERY RECORDS.                     * 06259000
062600***************************************************************** 06260000
062610 5725-MOVE-RECYCLE-DPURD.                                         06261000
062620                                                                  06262000
062630     PERFORM 5750-CREATE-ISA-RECORDS.                             06263000
062640     INITIALIZE TR018-REC-TYP-DPURD.                              06264000
062650     SET TR018-DPURD-TRN-TYP-ADD                                  06265000
062660         TR018-DPURD-REC-TYP-CDE-DPURDD                           06266000
062670         TR018-DPURD-SEQ-NBR-15      TO TRUE.                     06267000
062680     MOVE IMCNPO-CONTNR-ID           TO TR018-DPURD-CONTNR-ID.    06268000
062690     MOVE IMCNPO-EXTL-REF-NBR        TO TR018-DPURD-EXTL-REF-NBR. 06269000
062700     MOVE IMCNPO-PO-NBR              TO TR018-DPURD-PO-NBR.       06270000
062710     MOVE IMCNTK-MOM-IMPRT-VEH-NM    TO TR018-DPURD-IMPRT-VEH-NM. 06271000
062720     MOVE IMCNTK-MOM-DEST-POE-CDE    TO                           06272000
062730                              TR018-DPURD-POE-STD-EDI-CDE.        06273000
062740     MOVE IMCNTK-DO-RCVD-TMST (1:4)  TO                           06274000
062750                              TR018-DPURD-DELY-ORD-RCVD-DTE (1:4).06275000
062760     MOVE IMCNTK-DO-RCVD-TMST (6:2)  TO                           06276000
062770                              TR018-DPURD-DELY-ORD-RCVD-DTE (5:2).06277000
062780     MOVE IMCNTK-DO-RCVD-TMST (9:2)  TO                           06278000
062790                              TR018-DPURD-DELY-ORD-RCVD-DTE (7:2).06279000
062800     MOVE IMCNTK-DO-RCVD-TMST (12:2) TO                           06280000
062810                              TR018-DPURD-DELY-ORD-RCVD-TM  (1:2).06281000
062820     MOVE IMCNTK-DO-RCVD-TMST (15:2) TO                           06282000
062830                              TR018-DPURD-DELY-ORD-RCVD-TM  (3:2).06283000
062840     MOVE IMCNTK-DCONSLR-SCAC-ID     TO                           06284000
062850                              TR018-DPURD-DCONSLR-SCAC-ID.        06285000
062860     MOVE SPACE                      TO TR018-DPURD-CONSOL-END    06286000
062870                                        TR018-DPURD-EDI.          06287000
062880     MOVE PC-HEX-15                  TO TR018-DPURD-EDI-SEG-END.  06288000
062890     MOVE PV-HOLD-ISA-FILE-ID        TO TR018-DPURD-FILE-ID.      06289000
062900     MOVE PV-HOLD-ISA-ENT-ID         TO TR018-DPURD-ENT-ID.       06290000
062910     MOVE TR018-REC-TYP-DPURD        TO OUTTR5-CONTNR-RPTS-1-ODR. 06291000
062920                                                                  06292000
062930***************************************************************** 06293000
062940* MOVE FIELDS FOR RECYCLE CONTAINER PICKED UP RECORDS.          * 06294000
062950***************************************************************** 06295000
062960 5730-MOVE-RECYCLE-DLVRD.                                         06296000
062970                                                                  06297000
062980     PERFORM 5750-CREATE-ISA-RECORDS.                             06298000
062990     INITIALIZE TR018-REC-TYP-DLVRD.                              06299000
063000     SET TR018-DLVRD-TRN-TYP-ADD                                  06300000
063010         TR018-DLVRD-REC-TYP-CDE-DLVRDD                           06301000
063020         TR018-DLVRD-SEQ-NBR-35      TO TRUE.                     06302000
063030     MOVE IMCNPO-CONTNR-ID           TO TR018-DLVRD-CONTNR-ID.    06303000
063040     MOVE IMCNPO-EXTL-REF-NBR        TO TR018-DLVRD-EXTL-REF-NBR. 06304000
063050     MOVE IMCNPO-PO-NBR              TO TR018-DLVRD-PO-NBR.       06305000
063060     MOVE IMCNTK-MOM-IMPRT-VEH-NM    TO TR018-DLVRD-IMPRT-VEH-NM. 06306000
063070     MOVE IMCNTK-MOM-DEST-POE-CDE    TO                           06307000
063080                              TR018-DLVRD-POE-STD-EDI-CDE.        06308000
063090     MOVE IMCNTK-CONTNR-PU-TMST (1:4)  TO                         06309000
063100                              TR018-DLVRD-CONTNR-PCKUP-DTE  (1:4).06310000
063110     MOVE IMCNTK-CONTNR-PU-TMST (6:2)  TO                         06311000
063120                              TR018-DLVRD-CONTNR-PCKUP-DTE  (5:2).06312000
063130     MOVE IMCNTK-CONTNR-PU-TMST (9:2)  TO                         06313000
063140                              TR018-DLVRD-CONTNR-PCKUP-DTE  (7:2).06314000
063150     MOVE IMCNTK-CONTNR-PU-TMST (12:2) TO                         06315000
063160                              TR018-DLVRD-CONTNR-PCKUP-TM   (1:2).06316000
063170     MOVE IMCNTK-CONTNR-PU-TMST (15:2) TO                         06317000
063180                              TR018-DLVRD-CONTNR-PCKUP-TM   (3:2).06318000
063190     MOVE IMCNTK-DCONSLR-SCAC-ID     TO                           06319000
063200                              TR018-DLVRD-DCONSLR-SCAC-ID.        06320000
063210     MOVE SPACE                      TO TR018-DLVRD-CONSOL-END    06321000
063220                                        TR018-DLVRD-EDI.          06322000
063230     MOVE PC-HEX-15                  TO TR018-DLVRD-EDI-SEG-END.  06323000
063240     MOVE PV-HOLD-ISA-FILE-ID        TO TR018-DLVRD-FILE-ID.      06324000
063250     MOVE PV-HOLD-ISA-ENT-ID         TO TR018-DLVRD-ENT-ID.       06325000
063260     MOVE TR018-REC-TYP-DLVRD        TO OUTTR5-CONTNR-RPTS-1-ODR. 06326000
063270                                                                  06327000
063280***************************************************************** 06328000
063290* MOVE FIELDS FOR RECYCLE CONTAINER READY FOR PICKUP RECORDS.   * 06329000
063300***************************************************************** 06330000
063310 5735-MOVE-RECYCLE-CRPRD.                                         06331000
063320                                                                  06332000
063330     PERFORM 5750-CREATE-ISA-RECORDS.                             06333000
063340     INITIALIZE TR018-REC-TYP-CRPRD.                              06334000
063350     SET TR018-CRPRD-TRN-TYP-ADD                                  06335000
063360         TR018-CRPRD-REC-TYP-CDE-CRPRDD                           06336000
063370         TR018-CRPRD-SEQ-NBR-25      TO TRUE.                     06337000
063380     MOVE IMCNPO-CONTNR-ID           TO TR018-CRPRD-CONTNR-ID.    06338000
063390     MOVE IMCNPO-EXTL-REF-NBR        TO TR018-CRPRD-EXTL-REF-NBR. 06339000
063400     MOVE IMCNPO-PO-NBR              TO TR018-CRPRD-PO-NBR.       06340000
063410     MOVE IMCNTK-MOM-IMPRT-VEH-NM    TO TR018-CRPRD-IMPRT-VEH-NM. 06341000
063420     MOVE IMCNTK-MOM-DEST-POE-CDE    TO                           06342000
063430                              TR018-CRPRD-POE-STD-EDI-CDE.        06343000
063440     MOVE IMCNTK-BKR-FRGT-RLSE-TMST (1:4)  TO                     06344000
063450                              TR018-CRPRD-FRGT-RLSE-DTE     (1:4).06345000
063460     MOVE IMCNTK-BKR-FRGT-RLSE-TMST (6:2)  TO                     06346000
063470                              TR018-CRPRD-FRGT-RLSE-DTE     (5:2).06347000
063480     MOVE IMCNTK-BKR-FRGT-RLSE-TMST (9:2)  TO                     06348000
063490                              TR018-CRPRD-FRGT-RLSE-DTE     (7:2).06349000
063500     MOVE IMCNTK-BKR-FRGT-RLSE-TMST (12:2) TO                     06350000
063510                              TR018-CRPRD-FRGT-RLSE-TM      (1:2).06351000
063520     MOVE IMCNTK-BKR-FRGT-RLSE-TMST (15:2) TO                     06352000
063530                              TR018-CRPRD-FRGT-RLSE-TM      (3:2).06353000
063540     MOVE IMCNTK-DCONSLR-SCAC-ID     TO                           06354000
063550                              TR018-CRPRD-DCONSLR-SCAC-ID.        06355000
063560     MOVE SPACE                      TO TR018-CRPRD-CONSOL-END    06356000
063570                                        TR018-CRPRD-EDI.          06357000
063580     MOVE PC-HEX-15                  TO TR018-CRPRD-EDI-SEG-END.  06358000
063590     MOVE PV-HOLD-ISA-FILE-ID        TO TR018-CRPRD-FILE-ID.      06359000
063600     MOVE PV-HOLD-ISA-ENT-ID         TO TR018-CRPRD-ENT-ID.       06360000
063610     MOVE TR018-REC-TYP-CRPRD        TO OUTTR5-CONTNR-RPTS-1-ODR. 06361000
063620                                                                  06362000
063630***************************************************************** 06363000
063640* MOVE FIELDS FOR RECYCLE CONTAINER RETURNED RECORDS.           * 06364000
063650***************************************************************** 06365000
063660 5740-MOVE-RECYCLE-RTNRD.                                         06366000
063670                                                                  06367000
063680     PERFORM 5750-CREATE-ISA-RECORDS.                             06368000
063690     INITIALIZE TR018-REC-TYP-RTNRD.                              06369000
063700     SET TR018-RTNRD-TRN-TYP-ADD                                  06370000
063710         TR018-RTNRD-REC-TYP-CDE-RTNRDD                           06371000
063720         TR018-RTNRD-SEQ-NBR-55      TO TRUE.                     06372000
063730     MOVE IMCNPO-CONTNR-ID           TO TR018-RTNRD-CONTNR-ID.    06373000
063740     MOVE IMCNPO-EXTL-REF-NBR        TO TR018-RTNRD-EXTL-REF-NBR. 06374000
063750     MOVE IMCNPO-PO-NBR              TO TR018-RTNRD-PO-NBR.       06375000
063760     MOVE IMCNTK-MOM-IMPRT-VEH-NM    TO TR018-RTNRD-IMPRT-VEH-NM. 06376000
063770     MOVE IMCNTK-MOM-DEST-POE-CDE    TO                           06377000
063780                              TR018-RTNRD-POE-STD-EDI-CDE.        06378000
063790     MOVE IMCNTK-DCONSLR-RET-TMST (1:4)  TO                       06379000
063800                              TR018-RTNRD-CONTNR-RETURN-DTE (1:4).06380000
063810     MOVE IMCNTK-DCONSLR-RET-TMST (6:2)  TO                       06381000
063820                              TR018-RTNRD-CONTNR-RETURN-DTE (5:2).06382000
063830     MOVE IMCNTK-DCONSLR-RET-TMST (9:2)  TO                       06383000
063840                              TR018-RTNRD-CONTNR-RETURN-DTE (7:2).06384000
063850     MOVE IMCNTK-DCONSLR-RET-TMST (12:2) TO                       06385000
063860                              TR018-RTNRD-CONTNR-RETURN-TM  (1:2).06386000
063870     MOVE IMCNTK-DCONSLR-RET-TMST (15:2) TO                       06387000
063880                              TR018-RTNRD-CONTNR-RETURN-TM  (3:2).06388000
063890     MOVE IMCNTK-DCONSLR-SCAC-ID     TO                           06389000
063900                              TR018-RTNRD-DCONSLR-SCAC-ID.        06390000
063910     MOVE SPACE                      TO TR018-RTNRD-CONSOL-END    06391000
063920                                        TR018-RTNRD-EDI.          06392000
063930     MOVE PC-HEX-15                  TO TR018-RTNRD-EDI-SEG-END.  06393000
063940     MOVE PV-HOLD-ISA-FILE-ID        TO TR018-RTNRD-FILE-ID.      06394000
063950     MOVE PV-HOLD-ISA-ENT-ID         TO TR018-RTNRD-ENT-ID.       06395000
063960     MOVE TR018-REC-TYP-RTNRD        TO OUTTR5-CONTNR-RPTS-1-ODR. 06396000
063970                                                                  06397000
063980***************************************************************** 06398000
063990* MOVE FIELDS FOR RECYCLE CONTAINER DEVANNED RECORDS.           * 06399000
064000***************************************************************** 06400000
064010 5745-MOVE-RECYCLE-DVNRD.                                         06401000
064020                                                                  06402000
064030     PERFORM 5750-CREATE-ISA-RECORDS.                             06403000
064040     INITIALIZE TR018-REC-TYP-DVNRD.                              06404000
064050     SET TR018-DVNRD-TRN-TYP-ADD                                  06405000
064060         TR018-DVNRD-REC-TYP-CDE-DVNRDD                           06406000
064070         TR018-DVNRD-SEQ-NBR-45      TO TRUE.                     06407000
064080     MOVE IMCNPO-CONTNR-ID           TO TR018-DVNRD-CONTNR-ID.    06408000
064090     MOVE IMCNPO-EXTL-REF-NBR        TO TR018-DVNRD-EXTL-REF-NBR. 06409000
064100     MOVE IMCNPO-PO-NBR              TO TR018-DVNRD-PO-NBR.       06410000
064110     MOVE IMCNTK-MOM-IMPRT-VEH-NM    TO TR018-DVNRD-IMPRT-VEH-NM. 06411000
064120     MOVE IMCNTK-MOM-DEST-POE-CDE    TO                           06412000
064130                              TR018-DVNRD-POE-STD-EDI-CDE.        06413000
064140     MOVE IMCNTK-DVN-TMST     (1:4)  TO                           06414000
064150                              TR018-DVNRD-CONTNR-DEVAN-DTE  (1:4).06415000
064160     MOVE IMCNTK-DVN-TMST     (6:2)  TO                           06416000
064170                              TR018-DVNRD-CONTNR-DEVAN-DTE  (5:2).06417000
064180     MOVE IMCNTK-DVN-TMST     (9:2)  TO                           06418000
064190                              TR018-DVNRD-CONTNR-DEVAN-DTE  (7:2).06419000
064200     MOVE IMCNTK-DVN-TMST     (12:2) TO                           06420000
064210                              TR018-DVNRD-CONTNR-DEVAN-TM   (1:2).06421000
064220     MOVE IMCNTK-DVN-TMST     (15:2) TO                           06422000
064230                              TR018-DVNRD-CONTNR-DEVAN-TM   (3:2).06423000
064240     MOVE IMCNTK-DCONSLR-SCAC-ID     TO                           06424000
064250                              TR018-DVNRD-DCONSLR-SCAC-ID.        06425000
064260     MOVE SPACE                      TO TR018-DVNRD-CONSOL-END    06426000
064270                                        TR018-DVNRD-EDI.          06427000
064280     MOVE PC-HEX-15                  TO TR018-DVNRD-EDI-SEG-END.  06428000
064290     MOVE PV-HOLD-ISA-FILE-ID        TO TR018-DVNRD-FILE-ID.      06429000
064300     MOVE PV-HOLD-ISA-ENT-ID         TO TR018-DVNRD-ENT-ID.       06430000
064310     MOVE TR018-REC-TYP-DVNRD        TO OUTTR5-CONTNR-RPTS-1-ODR. 06431000
064320                                                                  06432000
064330***************************************************************** 06433000
064340* CREATE THE ISA/IEA RECYCLE RECORDS.                           * 06434000
064350***************************************************************** 06435000
064360 5750-CREATE-ISA-RECORDS.                                         06436000
064370                                                                  06437000
064380     IF CR-CREATE-ISARDA                                          06438000
064390         INITIALIZE OUTTR5-CONTNR-RPTS-1-ODR                      06439000
064400         MOVE PV-HOLD-ISA-REC  TO OUTTR5-CONTNR-RPTS-1-ODR        06440000
064410         MOVE PC-ISARDA        TO OUTTR5-CONTNR-RPTS-1-ODR (1:7)  06441000
064420         PERFORM 7200-INSERT-LOAD-RPT-TABLE                       06442000
064430         SET CR-CREATE-ISARDA-NO  TO TRUE                         06443000
064440     END-IF.                                                      06444000
064450                                                                  06445000
064460     IF CR-CREATE-ISARDD                                          06446000
064470         INITIALIZE OUTTR5-CONTNR-RPTS-1-ODR                      06447000
064480         MOVE PV-HOLD-ISA-REC  TO OUTTR5-CONTNR-RPTS-1-ODR        06448000
064490         MOVE PC-ISARDD        TO OUTTR5-CONTNR-RPTS-1-ODR (1:7)  06449000
064500         PERFORM 7200-INSERT-LOAD-RPT-TABLE                       06450000
064510         SET CR-CREATE-ISARDD-NO  TO TRUE                         06451000
064520     END-IF.                                                      06452000
064530                                                                  06453000
064540***************************************************************** 06454000
064550* CREATE THE IEA RECYCLE RECORDS.                               * 06455000
064560***************************************************************** 06456000
064570 5760-CREATE-IEA-RECORDS.                                         06457000
064580                                                                  06458000
064590     IF CR-CREATE-ISARDA-NO                                       06459000
064600         INITIALIZE OUTTR5-CONTNR-RPTS-1-ODR                      06460000
064610         MOVE PC-IEARDA       TO OUTTR5-CONTNR-RPTS-1-ODR (1:7)   06461000
064620         MOVE PV-HOLD-ISA-FILE-ID                                 06462000
064630                              TO OUTTR5-CONTNR-RPTS-1-ODR (151:9) 06463000
064640         MOVE PV-HOLD-ISA-ENT-ID                                  06464000
064650                              TO OUTTR5-CONTNR-RPTS-1-ODR (160:9) 06465000
064660         PERFORM 7200-INSERT-LOAD-RPT-TABLE                       06466000
064670     END-IF.                                                      06467000
064680                                                                  06468000
064690     IF CR-CREATE-ISARDD-NO                                       06469000
064700         INITIALIZE OUTTR5-CONTNR-RPTS-1-ODR                      06470000
064710         MOVE PC-IEARDD       TO OUTTR5-CONTNR-RPTS-1-ODR (1:7)   06471000
064720         MOVE PV-HOLD-ISA-FILE-ID                                 06472000
064730                              TO OUTTR5-CONTNR-RPTS-1-ODR (151:9) 06473000
064740         MOVE PV-HOLD-ISA-ENT-ID                                  06474000
064750                              TO OUTTR5-CONTNR-RPTS-1-ODR (160:9) 06475000
064760         PERFORM 7200-INSERT-LOAD-RPT-TABLE                       06476000
064770     END-IF.                                                      06477000
064780                                                                  06478000
064790******************************************************************06479000
064800* LOAD CVYA RECORD INFORMATION FROM INPUT FIELDS FOR ERROR OR    *06480000
064810* DETAIL RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.     *06481000
064820******************************************************************06482000
064830 5800-LOAD-CVYA-TO-REPORT.                                        06483000
064840                                                                  06484000
064850     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06485000
064860                                                                  06486000
064870     MOVE PC-CVYA                  TO TR211-REC-TYP-CVYA-CDE.     06487000
064880     MOVE PC-10                    TO TR211-SEQ-NBR-CVYA.         06488000
064890                                                                  06489000
064900     MOVE TR023-CNTR-IMP-VEH-NM-MOM TO TR211-CVYA-IMP-VEH-NM-MOM. 06490000
064910     MOVE TR023-CNTR-ACTL-FOB-CDE-MOM  TO                         06491000
064920                    TR211-CVYA-ACTL-FOB-CDE-MOM.                  06492000
064930     MOVE TR023-CNTR-DEST-POE-CDE-MOM  TO                         06493000
064940                    TR211-CVYA-DEST-POE-CDE-MOM.                  06494000
064950     MOVE TR023-CNTR-TRIP-TYP-CDE-MOM  TO                         06495000
064960                    TR211-CVYA-TRIP-TYP-CDE-MOM.                  06496000
064970     MOVE TR023-CNTR-POR-CDE-MOM TO TR211-CVYA-POR-CDE-MOM.       06497000
064980     MOVE TR023-CNTR-POL-CDE-MOM TO TR211-CVYA-POL-CDE-MOM.       06498000
064990     MOVE TR023-CNTR-EST-LBD-NM  TO TR211-CVYA-EST-LBD-NM.        06499000
065000                                                                  06500000
065010     MOVE TR023-CNTR-EST-LBD-DTE TO TR211-CVYA-EST-LBD-DTE.       06501000
065020     MOVE TR023-CNTR-EST-LBD-TM  TO TR211-CVYA-EST-LBD-TM.        06502000
065030     MOVE TR023-CNTR-DAT-SRC-ENT-ID    TO                         06503000
065040                                    TR211-DAT-SRC-ENT-ID.         06504000
065050     MOVE TR023-CNTR-EST-POE-DELY-DT-MOM   TO                     06505000
065060                        TR211-CVYA-EST-POE-DELY-DTE.              06506000
065070     MOVE TR023-CNTR-EST-POE-DELY-TM-MOM   TO                     06507000
065080                        TR211-CVYA-EST-POE-DELY-TM.               06508000
065090                                                                  06509000
065100     MOVE TR023-CNTR-IMPRT-TRIP-ID-MOM     TO                     06510000
065110                        TR211-CVYA-IMPRT-TRIP-ID.                 06511000
065120     MOVE TR023-CNTR-CARR-SCAC-ID-MOM      TO                     06512000
065130                        TR211-CVYA-CARR-SCAC-ID.                  06513000
065140                                                                  06514000
065150     MOVE TR023-CNTR-PROCESS-SEQ-NBR-1 TO                         06515000
065160                                       TR211-PROCESS-SEQ-NBR.     06516000
065170                                                                  06517000
065180     PERFORM 6200-WRITE-LOAD-REPORT.                              06518000
065190                                                                  06519000
065200******************************************************************06520000
065210* LOAD CVYB RECORD INFORMATION FROM INPUT FIELDS FOR ERROR/DETAIL*06521000
065220* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06522000
065230******************************************************************06523000
065240 5805-LOAD-CVYB-TO-REPORT.                                        06524000
065250                                                                  06525000
065260     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06526000
065270                                                                  06527000
065280     MOVE PC-CVYB                  TO TR211-REC-TYP-CVYB-CDE.     06528000
065290     MOVE PC-11                    TO TR211-SEQ-NBR-CVYB.         06529000
065300                                                                  06530000
065310     MOVE TR023-CNTR-ACTL-DPRTR-DTE-FDR TO                        06531000
065320                   TR211-CVYB-ACTL-DPRTR-DTE-FDR.                 06532000
065330     MOVE TR023-CNTR-ACTL-DPRTR-TM-FDR  TO                        06533000
065340                   TR211-CVYB-ACTL-DPRTR-TM-FDR.                  06534000
065350     MOVE TR023-CNTR-IMP-VEH-NM-FDR TO TR211-CVYB-IMP-VEH-NM-FDR. 06535000
065360     MOVE TR023-CNTR-ACTL-FOB-CDE-FDR  TO                         06536000
065370                   TR211-CVYB-ACTL-FOB-CDE-FDR.                   06537000
065380     MOVE TR023-CNTR-DEST-POE-CDE-FDR  TO                         06538000
065390                   TR211-CVYB-DEST-POE-CDE-FDR.                   06539000
065400     MOVE TR023-CNTR-TRIP-TYP-CDE-FDR  TO                         06540000
065410                   TR211-CVYB-TRIP-TYP-CDE-FDR.                   06541000
065420     MOVE TR023-CNTR-POR-CDE-FDR TO TR211-CVYB-POR-CDE-FDR.       06542000
065430     MOVE TR023-CNTR-POL-CDE-FDR TO TR211-CVYB-POL-CDE-FDR.       06543000
065440     MOVE TR023-CNTR-DAT-SRC-ENT-ID        TO                     06544000
065450                                    TR211-DAT-SRC-ENT-ID.         06545000
065460     MOVE TR023-CNTR-EST-POE-DELY-DT-FDR   TO                     06546000
065470                        TR211-CVYB-EST-POE-DELY-DTE.              06547000
065480     MOVE TR023-CNTR-EST-POE-DELY-TM-FDR   TO                     06548000
065490                        TR211-CVYB-EST-POE-DELY-TM.               06549000
065500                                                                  06550000
065510     MOVE TR023-CNTR-IMPRT-TRIP-ID-FDR     TO                     06551000
065520                        TR211-CVYB-IMPRT-TRIP-ID.                 06552000
065530     MOVE TR023-CNTR-CARR-SCAC-ID-FDR      TO                     06553000
065540                        TR211-CVYB-CARR-SCAC-ID.                  06554000
065550                                                                  06555000
065560                                                                  06556000
065570     MOVE TR023-CNTR-PROCESS-SEQ-NBR-2 TO                         06557000
065580                                       TR211-PROCESS-SEQ-NBR.     06558000
065590                                                                  06559000
065600     PERFORM 6200-WRITE-LOAD-REPORT.                              06560000
065610                                                                  06561000
065620******************************************************************06562000
065630* LOAD CONA RECORD INFORMATION FROM INPUT FIELDS FOR ERROR/DETAIL*06563000
065640* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06564000
065650******************************************************************06565000
065660 5810-LOAD-CONA-TO-REPORT.                                        06566000
065670                                                                  06567000
065680     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06568000
065690                                                                  06569000
065700     MOVE PC-CONA                  TO TR211-REC-TYP-CONA-CDE.     06570000
065710     MOVE PC-20                    TO TR211-SEQ-NBR-CONA.         06571000
065720                                                                  06572000
065730     MOVE TR023-CNTR-CONSOL-SCAC-ID TO                            06573000
065740                                      TR211-CONA-CONSOL-SCAC-ID.  06574000
065750                                                                  06575000
065760     MOVE TR023-CNTR-CART-CNT      TO TR211-CONA-CART-CNT.        06576000
065770     MOVE TR023-CNTR-UNT-QTY       TO TR211-CONA-UNT-QTY.         06577000
065780     MOVE TR023-CNTR-CBMT-QTY      TO TR211-CONA-CBMT-QTY.        06578000
065790     MOVE TR023-CNTR-WT-KGRM-QTY   TO TR211-CONA-WT-KGRM-QTY.     06579000
065800     MOVE TR023-CNTR-DAT-SRC-ENT-ID    TO                         06580000
065810                                    TR211-DAT-SRC-ENT-ID.         06581000
065820     MOVE TR023-CNTR-PROCESS-SEQ-NBR-3 TO                         06582000
065830                                       TR211-PROCESS-SEQ-NBR.     06583000
065840                                                                  06584000
065850     PERFORM 6200-WRITE-LOAD-REPORT.                              06585000
065860                                                                  06586000
065870******************************************************************06587000
065880* LOAD CONB RECORD INFORMATION FROM INPUT FIELDS FOR ERROR/DETAIL*06588000
065890* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06589000
065900******************************************************************06590000
065910 5815-LOAD-CONB-TO-REPORT.                                        06591000
065920                                                                  06592000
065930     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06593000
065940                                                                  06594000
065950     MOVE PC-CONB                  TO TR211-REC-TYP-CONB-CDE.     06595000
065960     MOVE PC-21                    TO TR211-SEQ-NBR-CONB.         06596000
065970                                                                  06597000
065980     MOVE TR023-CNTR-ORGN-SHPD-FR-CDE TO                          06598000
065990                                   TR211-CONB-ORGN-SHPD-FR-CDE.   06599000
066000     MOVE TR023-CNTR-ORGN-SHPD-TO-CDE TO                          06600000
066010                                   TR211-CONB-ORGN-SHPD-TO-CDE.   06601000
066020                                                                  06602000
066030     MOVE TR023-CNTR-SIZE-CDE         TO TR211-CONB-SIZE-CDE.     06603000
066040     MOVE TR023-CNTR-TRIP-TYP-CDE-MOM TO                          06604000
066050                                   TR211-CONB-TRIP-TYP-CDE.       06605000
066060     MOVE TR023-CNTR-DAT-SRC-ENT-ID    TO                         06606000
066070                                    TR211-DAT-SRC-ENT-ID.         06607000
066080     MOVE TR023-CNTR-PROCESS-SEQ-NBR-4 TO                         06608000
066090                                       TR211-PROCESS-SEQ-NBR.     06609000
066100                                                                  06610000
066110     PERFORM 6200-WRITE-LOAD-REPORT.                              06611000
066120                                                                  06612000
066130******************************************************************06613000
066140* LOAD CONPOA RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06614000
066150* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06615000
066160******************************************************************06616000
066170 5820-LOAD-CONPOA-TO-REPORT.                                      06617000
066180                                                                  06618000
066190     PERFORM 5585-INIT-COMMON-ERROR-FIELDS.                       06619000
066200                                                                  06620000
066210     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06621000
066220                                                                  06622000
066230     MOVE PC-CONPOA                  TO TR211-REC-TYP-CONPOA-CDE. 06623000
066240     MOVE PC-30                      TO TR211-SEQ-NBR-CONPOA.     06624000
066250                                                                  06625000
066260     MOVE TR023-CONPO-EXTL-REF-NBR   TO TR211-CONPOA-EXTL-REF-NBR.06626000
066270     MOVE TR023-CONPO-PO-NBR         TO TR211-CONPOA-PO-NBR.      06627000
066280     MOVE TR023-CONPO-PO-RCVD-DELY-DTE TO                         06628000
066290                                  TR211-CONPOA-PO-ACTL-DELY-DTE.  06629000
066300                                                                  06630000
066310     MOVE TR023-CONPO-CART-CNT       TO TR211-CONPOA-CART-CNT.    06631000
066320     MOVE TR023-CONPO-UNT-QTY        TO TR211-CONPOA-UNT-QTY.     06632000
066330     MOVE TR023-CONPO-CBMT-QTY       TO TR211-CONPOA-CBMT-QTY.    06633000
066340     MOVE TR023-CONPO-WT-KGRM-QTY    TO                           06634000
066350                                  TR211-CONPOA-WT-KGRM-QTY.       06635000
066360     MOVE TR023-CONPO-DAT-SRC-ENT-ID   TO                         06636000
066370                                    TR211-DAT-SRC-ENT-ID.         06637000
066380                                                                  06638000
066390     MOVE TR023-CONPO-PROCESS-SEQ-NBR-1 TO                        06639000
066400                                        TR211-PROCESS-SEQ-NBR.    06640000
066410                                                                  06641000
066420     PERFORM 6200-WRITE-LOAD-REPORT.                              06642000
066430                                                                  06643000
066440******************************************************************06644000
066450* LOAD CONPOB RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06645000
066460* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06646000
066470******************************************************************06647000
066480 5825-LOAD-CONPOB-TO-REPORT.                                      06648000
066490                                                                  06649000
066500     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06650000
066510                                                                  06651000
066520     MOVE PC-CONPOB                  TO TR211-REC-TYP-CONPOB-CDE. 06652000
066530     MOVE PC-31                      TO TR211-SEQ-NBR-CONPOB.     06653000
066540                                                                  06654000
066550     MOVE TR023-CONPO-PO-NBR         TO TR211-CONPOB-PO-NBR.      06655000
066560     MOVE TR023-CONPO-PO-RCVD-DELY-DTE  TO                        06656000
066570                      TR211-CONPOB-PO-ACTL-DELY-DTE.              06657000
066580     MOVE TR023-CONPO-LTR-OF-CR-NBR     TO                        06658000
066590                      TR211-CONPOB-LTR-OF-CR-NBR.                 06659000
066600     MOVE TR023-CONPO-HSE-BOL-NBR TO TR211-CONPOB-HSE-BOL-NBR.    06660000
066610     MOVE TR023-CONPO-DAT-SRC-ENT-ID   TO                         06661000
066620                                    TR211-DAT-SRC-ENT-ID.         06662000
066630                                                                  06663000
066640     MOVE TR023-CONPO-PROCESS-SEQ-NBR-2 TO                        06664000
066650                                        TR211-PROCESS-SEQ-NBR.    06665000
066660                                                                  06666000
066670     PERFORM 6200-WRITE-LOAD-REPORT.                              06667000
066680                                                                  06668000
066690******************************************************************06669000
066700* LOAD CONPOC RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06670000
066710* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06671000
066720******************************************************************06672000
066730 5830-LOAD-CONPOC-TO-REPORT.                                      06673000
066740                                                                  06674000
066750     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06675000
066760                                                                  06676000
066770     MOVE PC-CONPOC                  TO TR211-REC-TYP-CONPOC-CDE. 06677000
066780     MOVE PC-32                      TO TR211-SEQ-NBR-CONPOC.     06678000
066790                                                                  06679000
066800     MOVE TR023-CONPO-PO-NBR         TO TR211-CONPOC-PO-NBR.      06680000
066810     MOVE TR023-CONPO-PO-RCVD-DELY-DTE TO                         06681000
066820                      TR211-CONPOC-PO-ACTL-DELY-DTE.              06682000
066830     MOVE TR023-CONPO-MSTR-BOL-NBR TO TR211-CONPOC-MSTR-BOL-NBR.  06683000
066840     MOVE TR023-CONPO-PO-C-O-PROD-CDE  TO                         06684000
066850                      TR211-CONPOC-PO-C-O-PROD-CDE.               06685000
066860                                                                  06686000
066870     MOVE TR023-CONPO-DOC-RCVD-ORGN-DTE TO                        06687000
066880                      TR211-CONPOC-DOC-RCVD-ORGN-DTE.             06688000
066890     MOVE TR023-CONPO-DOC-RCVD-ORGN-TM  TO                        06689000
066900                      TR211-CONPOC-DOC-RCVD-ORGN-TM.              06690000
066910                                                                  06691000
066920     MOVE TR023-CONPO-DAT-SRC-ENT-ID   TO                         06692000
066930                                    TR211-DAT-SRC-ENT-ID.         06693000
066940                                                                  06694000
066950     MOVE TR023-CONPO-PROCESS-SEQ-NBR-3 TO                        06695000
066960                                        TR211-PROCESS-SEQ-NBR.    06696000
066970                                                                  06697000
066980     PERFORM 6200-WRITE-LOAD-REPORT.                              06698000
066990                                                                  06699000
067000******************************************************************06700000
067010* LOAD CONUPA RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06701000
067020* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06702000
067030******************************************************************06703000
067040 5840-LOAD-CONUPA-TO-REPORT.                                      06704000
067050                                                                  06705000
067060     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06706000
067070                                                                  06707000
067080     MOVE PC-CONUPA                  TO TR211-REC-TYP-CONUPA-CDE. 06708000
067090     MOVE PC-50                      TO TR211-SEQ-NBR-CONUPA.     06709000
067100                                                                  06710000
067110     MOVE TR023-CONUPC-PO-NBR        TO TR211-CONUPA-PO-NBR.      06711000
067120     MOVE TR023-CONUPC-VS-NBR        TO TR211-CONUPA-VS-NBR.      06712000
067130     MOVE TR023-CONUPC-UPC-NBR       TO TR211-CONUPA-UPC-NBR.     06713000
067140     MOVE TR023-CONUPC-CART-CNT      TO TR211-CONUPA-CART-CNT.    06714000
067150     MOVE TR023-CONUPC-UNT-QTY       TO TR211-CONUPA-UNT-QTY.     06715000
067160                                                                  06716000
067170********  BUD 2/27/14 *********                                   06717000
067180     IF PURCHS-PKGNG-CDE = 'M' OR 'I'                             06718000
067190         MOVE PV-PREPK-TYP-CDE       TO TR211-CONUPA-PACK-TYPE    06719000
067200     ELSE                                                         06720000
067210         MOVE PURCHS-PKGNG-CDE       TO TR211-CONUPA-PACK-TYPE    06721000
067220     END-IF.                                                      06722000
067230********  BUD 2/27/14 *********                                   06723000
067240                                                                  06724000
067250     MOVE PV-PO-PREPK-ID             TO TR211-CONUPA-PACK-ID.     06725000
067260                                                                  06726000
067270     MOVE TR023-CONUPC-DAT-SRC-ENT-ID                             06727000
067280                                     TO TR211-DAT-SRC-ENT-ID.     06728000
067290                                                                  06729000
067300     MOVE TR023-CONUPC-PROCESS-SEQ-NBR-1 TO                       06730000
067310                                        TR211-PROCESS-SEQ-NBR.    06731000
067320     IF TR023-CONUPC-SKU NUMERIC                                  06732000
067330         MOVE TR023-CONUPC-SKU           TO                       06733000
067340                                        TR211-CONUPA-SKU          06734000
067350     ELSE                                                         06735000
067360         MOVE ZEROES                     TO                       06736000
067370                                        TR211-CONUPA-SKU.         06737000
067380                                                                  06738000
067390     IF TR211-ERROR-TYPE EQUAL SPACES                             06739000
067400         MOVE IMCNUP-ASN-PKGNG-CDE TO TR211-CONUPA-ASN-PKG-CDE    06740000
067410     ELSE                                                         06741000
067420         MOVE TR023-CONUPC-ASN-PKG-CDE TO                         06742000
067430                                    TR211-CONUPA-ASN-PKG-CDE      06743000
067440     END-IF.                                                      06744000
067450                                                                  06745000
067460     PERFORM 6200-WRITE-LOAD-REPORT.                              06746000
067470                                                                  06747000
067480******************************************************************06748000
067490* LOAD CONUPB RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06749000
067500* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06750000
067510******************************************************************06751000
067520 5845-LOAD-CONUPB-TO-REPORT.                                      06752000
067530                                                                  06753000
067540     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06754000
067550                                                                  06755000
067560     MOVE PC-CONUPB                  TO TR211-REC-TYP-CONUPB-CDE. 06756000
067570     MOVE PC-51                      TO TR211-SEQ-NBR-CONUPB.     06757000
067580                                                                  06758000
067590     MOVE TR023-CONUPC-PO-NBR        TO TR211-CONUPB-PO-NBR.      06759000
067600     MOVE TR023-CONUPC-UPC-NBR       TO TR211-CONUPB-UPC-NBR.     06760000
067610     MOVE TR023-CONUPC-CBMT-QTY      TO TR211-CONUPB-CBMT-QTY.    06761000
067620     MOVE TR023-CONUPC-WT-KGRM-QTY   TO TR211-CONUPB-WT-KGRM-QTY. 06762000
067630     MOVE TR023-CONUPC-DAT-SRC-ENT-ID                             06763000
067640                                     TO TR211-DAT-SRC-ENT-ID.     06764000
067650     MOVE TR023-CONUPC-PROCESS-SEQ-NBR-2 TO                       06765000
067660                                        TR211-PROCESS-SEQ-NBR.    06766000
067670                                                                  06767000
067680     PERFORM 6200-WRITE-LOAD-REPORT.                              06768000
067690                                                                  06769000
067700******************************************************************06770000
067710* LOAD CONUPC RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06771000
067720* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06772000
067730******************************************************************06773000
067740 5850-LOAD-CONUPC-TO-REPORT.                                      06774000
067750                                                                  06775000
067760     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06776000
067770                                                                  06777000
067780     MOVE PC-CONUPC                  TO TR211-REC-TYP-CONUPC-CDE. 06778000
067790     MOVE PC-52                      TO TR211-SEQ-NBR-CONUPC.     06779000
067800                                                                  06780000
067810     MOVE TR023-CONUPC-PO-NBR        TO TR211-CONUPC-PO-NBR.      06781000
067820     MOVE TR023-CONUPC-UPC-NBR       TO TR211-CONUPC-UPC-NBR.     06782000
067830     MOVE TR023-CONUPC-VS-NBR        TO TR211-CONUPC-VS-NBR.      06783000
067840     MOVE TR023-CONUPC-DAT-SRC-ENT-ID                             06784000
067850                                    TO TR211-DAT-SRC-ENT-ID.      06785000
067860     MOVE TR023-CONUPC-PROCESS-SEQ-NBR-3 TO                       06786000
067870                                        TR211-PROCESS-SEQ-NBR.    06787000
067880                                                                  06788000
067890     PERFORM 6200-WRITE-LOAD-REPORT.                              06789000
067900                                                                  06790000
067910******************************************************************06791000
067920* MOVE COMMON DATA FOR ERROR/DETAIL REPORT RECORDS.              *06792000
067930******************************************************************06793000
067940 5855-SETUP-COMMON-REPORT-DATA.                                   06794000
067950                                                                  06795000
067960     IF PS-CHANGE-ADD-B                                           06796000
067970           MOVE PC-B                  TO TR211-TRN-TYP            06797000
067980*      IF TR211-ERROR-TYPE = SPACES                               06798000
067990*          MOVE PC-B                  TO TR211-TRN-TYP            06799000
068000*      ELSE                                                       06800000
068010*          MOVE TR023-CNTR-TRN-TYP    TO TR211-TRN-TYP            06801000
068020*      END-IF                                                     06802000
068030     ELSE                                                         06803000
068040         IF PS-CHANGE-ADD-Z                                       06804000
068050             MOVE PC-Z                TO TR211-TRN-TYP            06805000
068060         ELSE                                                     06806000
068070             MOVE TR023-CNTR-TRN-TYP  TO TR211-TRN-TYP            06807000
068080         END-IF                                                   06808000
068090     END-IF.                                                      06809000
068100                                                                  06810000
068110     IF TR023-CNTR-CONTNR-ID = PV-HOLD-CONTNR-ID                  06811000
068120                                                                  06812000
068130        MOVE TR023-CNTR-CONTNR-ID     TO TR211-CONTNR-ID          06813000
068140        MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM    TO                  06814000
068150                                    TR211-ACTL-DPRTR-DTE-MOM      06815000
068160        MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM     TO                  06816000
068170                                    TR211-ACTL-DPRTR-TM-MOM       06817000
068180                                                                  06818000
068190        MOVE TR023-CNTR-3RD-PARTY-CDE TO TR211-3RD-PARTY-CDE      06819000
068200     ELSE                                                         06820000
068210        MOVE PV-HOLD-CONTNR-ID TO TR211-CONTNR-ID                 06821000
068220        MOVE PV-HOLD-ACTL-DPRTR-DTE-MOM TO                        06822000
068230                                    TR211-ACTL-DPRTR-DTE-MOM      06823000
068240        MOVE PV-HOLD-ACTL-DPRTR-TM-MOM TO                         06824000
068250                                    TR211-ACTL-DPRTR-TM-MOM       06825000
068260                                                                  06826000
068270        MOVE PV-HOLD-3RD-PARTY-CDE TO TR211-3RD-PARTY-CDE         06827000
068280     END-IF.                                                      06828000
068290******************************************************************06829000
068300* LOAD CNCART RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06830000
068310* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06831000
068320******************************************************************06832000
068330 5860-LOAD-CNCART-TO-REPORT.                                      06833000
068340                                                                  06834000
068350     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06835000
068360                                                                  06836000
068370     MOVE PC-CNCART                  TO TR211-REC-TYP-CNCART-CDE. 06837000
068380     MOVE PC-60                      TO TR211-SEQ-NBR-CNCART.     06838000
068390                                                                  06839000
068400     MOVE TR023-CNCART-PO-NBR        TO TR211-CNCART-PO-NBR.      06840000
068410     MOVE TR023-CNCART-UPC-NBR       TO TR211-CNCART-UPC-NBR.     06841000
068420     MOVE TR023-CNCART-SSCC-NBR      TO TR211-CNCART-SSCC-NBR.    06842000
068430     MOVE TR023-CNCART-UNT-QTY       TO TR211-CNCART-UNT-QTY.     06843000
068440     MOVE TR023-CNCART-DAT-SRC-ENT-ID                             06844000
068450                                    TO TR211-DAT-SRC-ENT-ID.      06845000
068460     MOVE TR023-CNCART-PROCESS-SEQ-NBR-1 TO                       06846000
068470                                        TR211-PROCESS-SEQ-NBR.    06847000
068480                                                                  06848000
068490     PERFORM 6200-WRITE-LOAD-REPORT.                              06849000
068500                                                                  06850000
068510******************************************************************06851000
068520* LOAD CNSEAL RECORD INFORMATION FROM INPUT FIELDS FOR ERR/DETAIL*06852000
068530* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06853000
068540******************************************************************06854000
068550 5865-LOAD-CNSEAL-TO-REPORT.                                      06855000
068560                                                                  06856000
068570     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06857000
068580                                                                  06858000
068590     MOVE PC-CNSEAL                  TO TR211-REC-TYP-CNSEAL-CDE. 06859000
068600     MOVE PC-70                      TO TR211-SEQ-NBR-CNSEAL.     06860000
068610                                                                  06861000
068620     MOVE TR023-CNSEAL-CONTNR-SEAL-NBR TO                         06862000
068630                                   TR211-CNSEAL-CONTNR-SEAL-NBR.  06863000
068640     MOVE TR023-CNSEAL-DAT-SRC-ENT-ID                             06864000
068650                                    TO TR211-DAT-SRC-ENT-ID.      06865000
068660     MOVE TR023-CNSEAL-PROCESS-SEQ-NBR-1 TO                       06866000
068670                                        TR211-PROCESS-SEQ-NBR.    06867000
068680                                                                  06868000
068690     PERFORM 6200-WRITE-LOAD-REPORT.                              06869000
068700                                                                  06870000
068710******************************************************************06871000
068720* LOAD PREVIOUS INPUT  CNCART RECORD INFORMATION FOR ERROR/DETAIL*06872000
068730* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06873000
068740******************************************************************06874000
068750 5870-LOAD-CNCART-TO-REPORT-PRV.                                  06875000
068760                                                                  06876000
068770     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06877000
068780                                                                  06878000
068790     MOVE PC-CNCART                  TO TR211-REC-TYP-CNCART-CDE. 06879000
068800     MOVE PC-60                      TO TR211-SEQ-NBR-CNCART.     06880000
068810                                                                  06881000
068820     MOVE TRT00008-PO-NBR            TO TR211-CNCART-PO-NBR.      06882000
068830     MOVE TRT00008-UPC-NBR           TO TR211-CNCART-UPC-NBR.     06883000
068840     MOVE TRT00008-SSCC-ID           TO TR211-CNCART-SSCC-NBR.    06884000
068850     MOVE TRT00008-UNT-QTY           TO TR211-CNCART-UNT-QTY.     06885000
068860                                                                  06886000
068870     MOVE TR023-CNCART-DAT-SRC-ENT-ID                             06887000
068880                                    TO TR211-DAT-SRC-ENT-ID.      06888000
068890     MOVE TR023-CNCART-PROCESS-SEQ-NBR-1 TO                       06889000
068900                                        TR211-PROCESS-SEQ-NBR.    06890000
068910                                                                  06891000
068920     PERFORM 6200-WRITE-LOAD-REPORT.                              06892000
068930                                                                  06893000
068940******************************************************************06894000
068950* LOAD PREVIOUS INPUT  CONPO  RECORD INFORMATION FOR ERROR/DETAIL*06895000
068960* RECORD AND WRITE RECORD TO ERROR/DETAIL WORK TABLE.            *06896000
068970******************************************************************06897000
068980 5875-LOAD-CONPO-TO-REPORT-PRV.                                   06898000
068990                                                                  06899000
069000     PERFORM 5585-INIT-COMMON-ERROR-FIELDS.                       06900000
069010                                                                  06901000
069020     PERFORM 5855-SETUP-COMMON-REPORT-DATA.                       06902000
069030                                                                  06903000
069040     MOVE PC-CONPOA                 TO TR211-REC-TYP-CONPOA-CDE.  06904000
069050     MOVE PC-30                     TO TR211-SEQ-NBR-CONPOA.      06905000
069060                                                                  06906000
069070     MOVE IMCNPO-EXTL-REF-NBR TO TR211-CONPOA-EXTL-REF-NBR.       06907000
069080     MOVE IMCNPO-PO-NBR       TO TR211-CONPOA-PO-NBR.             06908000
069090                                                                  06909000
069100     MOVE IMCNPO-PO-RCVD-DELY-TMST (1:4) TO                       06910000
069110                           PV-FORMAT-RCVD-DTE-CY.                 06911000
069120     MOVE IMCNPO-PO-RCVD-DELY-TMST (6:2) TO                       06912000
069130                           PV-FORMAT-RCVD-DTE-MM.                 06913000
069140     MOVE IMCNPO-PO-RCVD-DELY-TMST (9:2) TO                       06914000
069150                           PV-FORMAT-RCVD-DTE-DD.                 06915000
069160     MOVE PV-FORMAT-PO-RCVD-DELY-DTE TO                           06916000
069170                           TR211-CONPOA-PO-ACTL-DELY-DTE.         06917000
069180                                                                  06918000
069190     MOVE IMCNPO-PO-CART-CNT     TO TR211-CONPOA-CART-CNT.        06919000
069200     MOVE IMCNPO-PO-UNT-QTY      TO TR211-CONPOA-UNT-QTY.         06920000
069210     MOVE IMCNPO-PO-CBMT-QTY     TO TR211-CONPOA-CBMT-QTY.        06921000
069220     MOVE IMCNPO-PO-WT-KGRM-QTY  TO                               06922000
069230                              TR211-CONPOA-WT-KGRM-QTY.           06923000
069240     MOVE TR023-CONPO-DAT-SRC-ENT-ID TO                           06924000
069250                                    TR211-DAT-SRC-ENT-ID.         06925000
069260                                                                  06926000
069270     MOVE TR023-CONPO-PROCESS-SEQ-NBR-1 TO                        06927000
069280                                        TR211-PROCESS-SEQ-NBR.    06928000
069290                                                                  06929000
069300     PERFORM 6200-WRITE-LOAD-REPORT.                              06930000
069310                                                                  06931000
069320******************************************************************06932000
069330* READ THE CONTAINER FILE                                        *06933000
069340******************************************************************06934000
069350 6000-READ-CONTAINER-FILE.                                        06935000
069360                                                                  06936000
069370     MOVE TR023-REC-TYP-CONPO TO PV-HOLD-TR023-REC-TYP-CONPO.     06937000
069380     READ TR023-CONTAINER-FILE                                    06938000
069390         INTO TR023-REC-TYP-CNTR                                  06939000
069400         AT END                                                   06940000
069410           SET PS-END-OF-FILE TO TRUE.                            06941000
069420                                                                  06942000
069430     IF (PV-PREV-REC-TYP-CDE = 'CNCART  ')  AND                   06943000
069440        (TR023-CNTR-REC-TYP-CDE NOT EQUAL 'CNCART  ') AND         06944000
069450         PS-CNTK-PREV-SENT-ERR-NO  AND                            06945000
069460         PS-CNPO-PREV-SENT-ERR-NO  AND                            06946000
069470         PS-CNUP-PREV-SENT-ERR-NO  AND                            06947000
069480         PS-CNCT-PREV-SENT-ERR-NO                                 06948000
069490          PERFORM 3655-EDIT-CARTONS-SENT                          06949000
069500     END-IF.                                                      06950000
069510                                                                  06951000
069520     MOVE TR023-CNTR-REC-TYP-CDE TO PV-PREV-REC-TYP-CDE.          06952000
069530                                                                  06953000
069540     IF PS-END-OF-FILE                                            06954000
069550         PERFORM 5760-CREATE-IEA-RECORDS                          06955000
069560     ELSE                                                         06956000
069570         ADD +1 TO PV-CONT-INPUT-COUNT                            06957000
069580         MOVE TR023-CONTAINER-RECORD (1:3) TO PV-EDI-RECORDS      06958000
069590                                        PV-HOLD-LAST-REC-TYP      06959000
069600         IF EDI-RECORD                                            06960000
069610           SET PS-EDI-RECORD      TO TRUE                         06961000
069620           IF PV-EDI-RECORDS = PC-ISA                             06962000
069630               MOVE TR023-CONTAINER-RECORD TO PV-HOLD-ISA-REC     06963000
069640               PERFORM 5760-CREATE-IEA-RECORDS                    06964000
069650               SET CR-CREATE-ISARDA                               06965000
069660                   CR-CREATE-ISARDD  TO TRUE                      06966000
069670           END-IF                                                 06967000
069680         ELSE                                                     06968000
069690             SET PS-GOOD-RECORD   TO TRUE                         06969000
069700             SET PS-EDI-RECORD-NO TO TRUE                         06970000
069710         END-IF                                                   06971000
069720     END-IF.                                                      06972000
069730                                                                  06973000
069740***************************************************************** 06974000
069750* SETUP THE ERROR OR DETAIL RECORD PRIOR TO INSERTING TO THE    * 06975000
069760* WORK TABLE  (TOUTTR5).                                        * 06976000
069770***************************************************************** 06977000
069780 6200-WRITE-LOAD-REPORT.                                          06978000
069790                                                                  06979000
069800     IF TR211-ERROR-TYPE EQUAL SPACES                             06980000
069810         MOVE PC-D                    TO TR211-RPT-TYP            06981000
069820         ADD +1                       TO PA-TOTAL-DETAIL-COUNT    06982000
069830     ELSE                                                         06983000
069840         MOVE PC-E                    TO TR211-RPT-TYP            06984000
069850         ADD +1                       TO PA-TOTAL-ERROR-COUNT     06985000
069860     END-IF.                                                      06986000
069870                                                                  06987000
069880     IF PS-LOAD-PRINT-TABLE AND TR211-RPT-TYP EQUAL PC-E          06988000
069890         PERFORM 6210-LOAD-PRINT-TABLE                            06989000
069900         SET PS-LOAD-PRINT-TABLE-NO TO TRUE                       06990000
069910     ELSE                                                         06991000
069920         MOVE TR211-COMMON-FIELDS   TO OUTTR5-CONTNR-RPTS-1-ODR   06992000
069930         MOVE TR211-COMMON-FIELDS-PAR-2                           06993000
069940                                    TO OUTTR5-CONTNR-RPTS-2-ODR   06994000
069950         PERFORM 7200-INSERT-LOAD-RPT-TABLE                       06995000
069960     END-IF.                                                      06996000
069970                                                                  06997000
069980***************************************************************** 06998000
069990* LOAD NON LANDED MESSAGES TO WORKING STORAGE PRINT TABLE.      * 06999000
070000***************************************************************** 07000000
070010 6210-LOAD-PRINT-TABLE.                                           07001000
070020                                                                  07002000
070030     IF PRINT-INDX > PC-MAX-TABLE-ROWS                            07003000
070040         MOVE PC-WARNING      TO TR211-ERROR-TYPE                 07004000
070050         MOVE 'MSG TABLE  '   TO TR211-DATA-IN-ERROR              07005000
070060         MOVE 'TABLE FULL'    TO TR211-DATA-VALUE                 07006000
070070         MOVE 'ERR/WNG MESSAGE TABLE IS FULL-CONTACT PROGRAMMING' 07007000
070080                              TO TR211-ERROR-MSG                  07008000
070090         PERFORM 5800-LOAD-CVYA-TO-REPORT                         07009000
070100     ELSE                                                         07010000
070110        MOVE TR211-COMMON-FIELDS TO                               07011000
070120              PV-PRINT-TABLE-PART1 (PRINT-INDX)                   07012000
070130        MOVE TR211-COMMON-FIELDS-PAR-2 TO                         07013000
070140              PV-PRINT-TABLE-PART2 (PRINT-INDX)                   07014000
070150        SET PRINT-INDX UP BY +1                                   07015000
070160     END-IF.                                                      07016000
070170                                                                  07017000
070180***************************************************************** 07018000
070190* UNLOAD/PRINT NON LANDED MESSAGES FROM WORKING STORAGE PRINT   * 07019000
070200* TABLE.                                                        * 07020000
070210***************************************************************** 07021000
070220 6215-UNLOAD-PRINT-TABLE.                                         07022000
070230                                                                  07023000
070240     SET PRINT-INDX TO +1.                                        07024000
070250                                                                  07025000
070260     PERFORM UNTIL (PV-PRINT-TABLE-PART1 (PRINT-INDX) = SPACES)   07026000
070270                     OR (PRINT-INDX > PC-MAX-TABLE-ROWS)          07027000
070280          MOVE PV-PRINT-TABLE-PART1 (PRINT-INDX)                  07028000
070290                 TO OUTTR5-CONTNR-RPTS-1-ODR                      07029000
070300          MOVE PV-PRINT-TABLE-PART2 (PRINT-INDX)                  07030000
070310                 TO OUTTR5-CONTNR-RPTS-2-ODR                      07031000
070320          PERFORM 7200-INSERT-LOAD-RPT-TABLE                      07032000
070330          SET PRINT-INDX UP BY +1                                 07033000
070340     END-PERFORM.                                                 07034000
070350                                                                  07035000
070360******************************************************************07036000
070370* INSERT A ROW INTO THE CONTAINER TABLE  (TIMCNTK).              *07037000
070380******************************************************************07038000
070390 7000-INSERT-TIMCNTK.                                             07039000
070400                                                                  07040000
070410     PERFORM                                                      07041000
070420         WITH TEST AFTER                                          07042000
070430         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07043000
070440         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07044000
070450                 SQLCODE = ZERO                                   07045000
070460                                                                  07046000
070470         EXEC SQL                                                 07047000
070480             INSERT INTO TIMCNTK                                  07048000
070490                   (CONTNR_ID,                                    07049000
070500                    CONTNR_SEQ_NBR,                               07050000
070510                    CONSLR_SCAC_ID,                               07051000
070520                    MOM_IMPRT_TRIP_ID,                            07052000
070530                    MOM_DPRTR_TMST,                               07053000
070540                    MOM_POE_DELY_TMST,                            07054000
070550                    MOM_CARR_SCAC_ID,                             07055000
070560                    MOM_FOB_CDE,                                  07056000
070570                    MOM_IMPRT_VEH_NM,                             07057000
070580                    MOM_TRIP_TYP_CDE,                             07058000
070590                    MOM_DEST_POE_CDE,                             07059000
070600                    FDR_IMPRT_TRIP_ID,                            07060000
070610                    FDR_DPRTR_TMST,                               07061000
070620                    FDR_POE_DELY_TMST,                            07062000
070630                    FDR_CARR_SCAC_ID,                             07063000
070640                    FDR_FOB_CDE,                                  07064000
070650                    FDR_IMPRT_VEH_NM,                             07065000
070660                    FDR_TRIP_TYP_CDE,                             07066000
070670                    FDR_DEST_POE_CDE,                             07067000
070680                    SIZE_CDE,                                     07068000
070690                    CART_CNT,                                     07069000
070700                    CBMT_QTY,                                     07070000
070710                    WT_KGRM_QTY,                                  07071000
070720                    UNT_QTY,                                      07072000
070730                    ORGN_SHPD_FR_CDE,                             07073000
070740                    ORGN_SHPD_TO_CDE,                             07074000
070750                    EST_LBD_NM,                                   07075000
070760                    EST_LBD_TMST,                                 07076000
070770                    BKR_FRGT_RLSE_TMST,                           07077000
070780                    DO_TO_DCONSLR_TMST,                           07078000
070790                    DO_RCVD_TMST,                                 07079000
070800                    CONTNR_PU_TMST,                               07080000
070810                    ACTL_POE_DELY_TMST,                           07081000
070820                    ACTL_DEST_POE_CDE,                            07082000
070830                    ACTL_LBD_NM,                                  07083000
070840                    ACTL_LBD_TMST,                                07084000
070850                    DAT_SRC_ENT_ID,                               07085000
070860                    CRE_BY_USR_ID,                                07086000
070870                    CRE_TMST,                                     07087000
070880                    LAST_UPD_BY_USR_ID,                           07088000
070890                    LAST_UPD_TMST,                                07089000
070900                    DVN_TMST,                                     07090000
070910                    DCONSLR_RET_TMST,                             07091000
070920                    DCONSLR_SCAC_ID,                              07092000
070930                    MOM_POL_CDE,                                  07093000
070940                    FDR_POL_CDE,                                  07094000
070950                    MOM_POR_CDE,                                  07095000
070960                    FDR_POR_CDE)                                  07096000
070970             VALUES                                               07097000
070980                  (:IMCNTK-CONTNR-ID,                             07098000
070990                   :PV-HOLD-CONTNR-SEQ-NBR,                       07099000
071000                   :IMCNTK-CONSLR-SCAC-ID,                        07100000
071010                   :IMCNTK-MOM-IMPRT-TRIP-ID,                     07101000
071020                   :IMCNTK-MOM-DPRTR-TMST,                        07102000
071030                   :IMCNTK-MOM-POE-DELY-TMST,                     07103000
071040                   :IMCNTK-MOM-CARR-SCAC-ID,                      07104000
071050                   :IMCNTK-MOM-FOB-CDE,                           07105000
071060                   :IMCNTK-MOM-IMPRT-VEH-NM,                      07106000
071070                   :IMCNTK-MOM-TRIP-TYP-CDE,                      07107000
071080                   :IMCNTK-MOM-DEST-POE-CDE,                      07108000
071090                   :IMCNTK-FDR-IMPRT-TRIP-ID,                     07109000
071100                   :IMCNTK-FDR-DPRTR-TMST,                        07110000
071110                   :IMCNTK-FDR-POE-DELY-TMST,                     07111000
071120                   :IMCNTK-FDR-CARR-SCAC-ID,                      07112000
071130                   :IMCNTK-FDR-FOB-CDE,                           07113000
071140                   :IMCNTK-FDR-IMPRT-VEH-NM,                      07114000
071150                   :IMCNTK-FDR-TRIP-TYP-CDE,                      07115000
071160                   :IMCNTK-FDR-DEST-POE-CDE,                      07116000
071170                   :IMCNTK-SIZE-CDE,                              07117000
071180                   :IMCNTK-CART-CNT,                              07118000
071190                   :IMCNTK-CBMT-QTY,                              07119000
071200                   :IMCNTK-WT-KGRM-QTY,                           07120000
071210                   :IMCNTK-UNT-QTY,                               07121000
071220                   :IMCNTK-ORGN-SHPD-FR-CDE,                      07122000
071230                   :IMCNTK-ORGN-SHPD-TO-CDE,                      07123000
071240                   :IMCNTK-EST-LBD-NM,                            07124000
071250                   :IMCNTK-EST-LBD-TMST,                          07125000
071260                   :IMCNTK-BKR-FRGT-RLSE-TMST,                    07126000
071270                   :IMCNTK-DO-TO-DCONSLR-TMST,                    07127000
071280                   :IMCNTK-DO-RCVD-TMST,                          07128000
071290                   :IMCNTK-CONTNR-PU-TMST,                        07129000
071300                   :IMCNTK-ACTL-POE-DELY-TMST,                    07130000
071310                   :IMCNTK-ACTL-DEST-POE-CDE,                     07131000
071320                   :IMCNTK-ACTL-LBD-NM,                           07132000
071330                   :IMCNTK-ACTL-LBD-TMST,                         07133000
071340                   :IMCNTK-DAT-SRC-ENT-ID,                        07134000
071350                   :PC-CURRENT-PROGRAM-NAME,                      07135000
071360                   :IMCNTK-CRE-TMST,                              07136000
071370                   :PC-CURRENT-PROGRAM-NAME,                      07137000
071380                    CURRENT TIMESTAMP,                            07138000
071390                   :IMCNTK-DVN-TMST,                              07139000
071400                   :IMCNTK-DCONSLR-RET-TMST,                      07140000
071410                   :IMCNTK-DCONSLR-SCAC-ID,                       07141000
071420                   :IMCNTK-MOM-POL-CDE,                           07142000
071430                   :IMCNTK-FDR-POL-CDE,                           07143000
071440                   :IMCNTK-MOM-POR-CDE,                           07144000
071450                   :IMCNTK-FDR-POR-CDE)                           07145000
071460         END-EXEC                                                 07146000
071470                                                                  07147000
071480         EVALUATE TRUE                                            07148000
071490             WHEN SQLCODE = ZERO                                  07149000
071500                 ADD +1 TO PA-TOT-CNTK-RECS-INSERT                07150000
071510                 ADD +1 TO PA-TOT-RECS-INSERTED                   07151000
071520                 SET PS-GOOD-CNTK-INSERT     TO TRUE              07152000
071530                                                                  07153000
071540             WHEN SQLCODE = -803                                  07154000
071550                 SET PS-GOOD-CNTK-INSERT-NO     TO TRUE           07155000
071560                 MOVE IMCNTK-CONTNR-ID   TO TR211-DATA-VALUE      07156000
071570                 MOVE PC-ERROR           TO TR211-ERROR-TYPE      07157000
071580                 MOVE 'CONTNR LEVEL'     TO TR211-DATA-IN-ERROR   07158000
071590                 MOVE 'DUPLICATE CONTNR' TO TR211-ERROR-MSG       07159000
071600                                                                  07160000
071610             WHEN SQLWARN0 NOT EQUAL SPACE                        07161000
071620             WHEN SQLCODE NOT EQUAL ZERO                          07162000
071630                 DISPLAY '**************************************' 07163000
071640                 DISPLAY '** ABEND                            **' 07164000
071650                 DISPLAY '** PROGRAM = TRKUP215               **' 07165000
071660                 DISPLAY '** PARAGRAPH = 7000-INSERT-TIMCNTK  **' 07166000
071670                 DISPLAY '** INSERT INTO TIMCNTK              **' 07167000
071680                 DISPLAY '*CONTNR ID = ' IMCNTK-CONTNR-ID         07168000
071690                 DISPLAY '*SAIL DATE = ' IMCNTK-MOM-DPRTR-TMST    07169000
071700                 DISPLAY '**************************************' 07170000
071710                 PERFORM 9100-SQL-ABEND                           07171000
071720         END-EVALUATE                                             07172000
071730     END-PERFORM.                                                 07173000
071740                                                                  07174000
071750     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07175000
071760         (SQLCODE NOT = ZERO AND                                  07176000
071770          SQLCODE NOT = -803)                                     07177000
071780         DISPLAY '****************************************'       07178000
071790         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07179000
071800         DISPLAY '** INSERT TO TIMCNTK                  **'       07180000
071810         DISPLAY '** PARAGRAPH = 7000-INSERT-TIMCNTK    **'       07181000
071820         DISPLAY '** CONTNR ID = ' IMCNTK-CONTNR-ID               07182000
071830         DISPLAY '** SAIL DATE = ' IMCNTK-MOM-DPRTR-TMST          07183000
071840         DISPLAY '****************************************'       07184000
071850         PERFORM 9100-SQL-ABEND                                   07185000
071860     END-IF.                                                      07186000
071870                                                                  07187000
071880 EJECT                                                            07188000
071890******************************************************************07189000
071900* INSERT A ROW INTO THE CONTAINER PO TABLE  (TIMCNPO).           *07190000
071910******************************************************************07191000
071920 7010-INSERT-TIMCNPO.                                             07192000
071930                                                                  07193000
071940     PERFORM                                                      07194000
071950         WITH TEST AFTER                                          07195000
071960         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07196000
071970         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07197000
071980                 SQLCODE = ZERO                                   07198000
071990                                                                  07199000
072000         EXEC SQL                                                 07200000
072010             INSERT INTO TIMCNPO                                  07201000
072020                   (CONTNR_ID,                                    07202000
072030                    CONTNR_SEQ_NBR,                               07203000
072040                    PO_NBR,                                       07204000
072050                    CSTM_ENTR_ID,                                 07205000
072060                    MSTR_BOL_NBR,                                 07206000
072070                    HSE_BOL_NBR,                                  07207000
072080                    LTR_OF_CR_NBR,                                07208000
072090                    PO_RCVD_DELY_TMST,                            07209000
072100                    PO_C_O_PROD_CDE,                              07210000
072110                    PO_CART_CNT,                                  07211000
072120                    PO_CBMT_QTY,                                  07212000
072130                    PO_WT_KGRM_QTY,                               07213000
072140                    PO_UNT_QTY,                                   07214000
072150                    CRE_BY_USR_ID,                                07215000
072160                    CRE_TMST,                                     07216000
072170                    LAST_UPD_BY_USR_ID,                           07217000
072180                    LAST_UPD_TMST,                                07218000
072190                    EXTL_REF_NBR,                                 07219000
072200                    BKR_FRGT_RLSE_CDE,                            07220000
072210                    DO_RCVD_CDE,                                  07221000
072220                    CONTNR_PU_CDE,                                07222000
072230                    ACTL_POE_DELY_CDE,                            07223000
072240                    DVN_CDE,                                      07224000
072250                    DCONSLR_RET_CDE,                              07225000
072260                    SPLT_XMIT_CDE,                                07226000
072270                    DOC_RCVD_ORGN_TMST)                           07227000
072280                                                                  07228000
072290             VALUES                                               07229000
072300                  (:IMCNPO-CONTNR-ID,                             07230000
072310                   :PV-HOLD-CONTNR-SEQ-NBR,                       07231000
072320                   :IMCNPO-PO-NBR,                                07232000
072330                   :IMCNPO-CSTM-ENTR-ID,                          07233000
072340                   :IMCNPO-MSTR-BOL-NBR,                          07234000
072350                   :IMCNPO-HSE-BOL-NBR,                           07235000
072360                   :IMCNPO-LTR-OF-CR-NBR,                         07236000
072370                   :IMCNPO-PO-RCVD-DELY-TMST,                     07237000
072380                   :IMCNPO-PO-C-O-PROD-CDE,                       07238000
072390                   :IMCNPO-PO-CART-CNT,                           07239000
072400                   :IMCNPO-PO-CBMT-QTY,                           07240000
072410                   :IMCNPO-PO-WT-KGRM-QTY,                        07241000
072420                   :IMCNPO-PO-UNT-QTY,                            07242000
072430                   :PC-CURRENT-PROGRAM-NAME,                      07243000
072440                   :IMCNPO-CRE-TMST,                              07244000
072450                   :PC-CURRENT-PROGRAM-NAME,                      07245000
072460                   :IMCNPO-LAST-UPD-TMST,                         07246000
072470                   :IMCNPO-EXTL-REF-NBR,                          07247000
072480                   :IMCNPO-BKR-FRGT-RLSE-CDE,                     07248000
072490                   :IMCNPO-DO-RCVD-CDE,                           07249000
072500                   :IMCNPO-CONTNR-PU-CDE,                         07250000
072510                   :IMCNPO-ACTL-POE-DELY-CDE,                     07251000
072520                   :IMCNPO-DVN-CDE,                               07252000
072530                   :IMCNPO-DCONSLR-RET-CDE,                       07253000
072540                   :IMCNPO-SPLT-XMIT-CDE,                         07254000
072550                   :IMCNPO-DOC-RCVD-ORGN-TMST)                    07255000
072560         END-EXEC                                                 07256000
072570                                                                  07257000
072580         EVALUATE TRUE                                            07258000
072590             WHEN SQLCODE = ZERO                                  07259000
072600                 ADD +1 TO PA-TOT-CNPO-RECS-INSERT                07260000
072610                 ADD +1 TO PA-TOT-RECS-INSERTED                   07261000
072620                 SET PS-GOOD-CNPO-INSERT    TO TRUE               07262000
072630                                                                  07263000
072640             WHEN SQLCODE = -803                                  07264000
072650                 SET PS-GOOD-CNPO-INSERT-NO TO TRUE               07265000
072660                 MOVE PC-ERROR           TO TR211-ERROR-TYPE      07266000
072670                 MOVE IMCNPO-PO-NBR      TO TR211-DATA-VALUE      07267000
072680                 MOVE 'PO LEVEL'         TO TR211-DATA-IN-ERROR   07268000
072690                 MOVE 'DUPLICATE PO'     TO TR211-ERROR-MSG       07269000
072700                                                                  07270000
072710             WHEN SQLWARN0 NOT EQUAL SPACE                        07271000
072720             WHEN SQLCODE NOT EQUAL ZERO                          07272000
072730                 DISPLAY '**************************************' 07273000
072740                 DISPLAY '** ABEND                            **' 07274000
072750                 DISPLAY '** PROGRAM = TRKUP215               **' 07275000
072760                 DISPLAY '** PARAGRAPH = 7010-INSERT-TIMCNPO  **' 07276000
072770                 DISPLAY '** INSERT INTO TIMCNPO              **' 07277000
072780                 DISPLAY '*IMCNPO-CONTNR-ID = ' IMCNPO-CONTNR-ID  07278000
072790                 DISPLAY '*IMCNPO-PO-NBR    = ' IMCNPO-PO-NBR     07279000
072800                 DISPLAY '**************************************' 07280000
072810                 PERFORM 9100-SQL-ABEND                           07281000
072820         END-EVALUATE                                             07282000
072830     END-PERFORM.                                                 07283000
072840                                                                  07284000
072850     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07285000
072860         (SQLCODE NOT = ZERO AND                                  07286000
072870          SQLCODE NOT = -803)                                     07287000
072880         DISPLAY '****************************************'       07288000
072890         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07289000
072900         DISPLAY '** INSERT TO TIMCNPO                  **'       07290000
072910         DISPLAY '** PARAGRAPH = 7010-INSERT-TIMCNPO    **'       07291000
072920         DISPLAY '* IMCNPO-CONTNR-ID = ' IMCNPO-CONTNR-ID         07292000
072930         DISPLAY '* IMCNPO-PO-NBR    = ' IMCNPO-PO-NBR            07293000
072940         DISPLAY '****************************************'       07294000
072950         PERFORM 9100-SQL-ABEND                                   07295000
072960     END-IF.                                                      07296000
072970                                                                  07297000
072980******************************************************************07298000
072990* INSERT A ROW INTO THE CONTAINER UPC TABLE  (TIMCNUP).          *07299000
073000******************************************************************07300000
073010 7030-INSERT-TIMCNUP.                                             07301000
073020                                                                  07302000
073030     PERFORM                                                      07303000
073040         WITH TEST AFTER                                          07304000
073050         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07305000
073060         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07306000
073070                 SQLCODE = ZERO                                   07307000
073080                                                                  07308000
073090         EXEC SQL                                                 07309000
073100             INSERT INTO TIMCNUP                                  07310000
073110                   (CONTNR_ID,                                    07311000
073120                    CONTNR_SEQ_NBR,                               07312000
073130                    PO_NBR,                                       07313000
073140                    VS_NBR,                                       07314000
073150                    UPC_NBR,                                      07315000
073160                    PO_LNE_NBR,                                   07316000
073170                    UPC_CART_CNT,                                 07317000
073180                    UPC_CBMT_QTY,                                 07318000
073190                    UPC_WT_KGRM_QTY,                              07319000
073200                    UPC_UNT_QTY,                                  07320000
073210                    CRE_BY_USR_ID,                                07321000
073220                    CRE_TMST,                                     07322000
073230                    LAST_UPD_BY_USR_ID,                           07323000
073240                    LAST_UPD_TMST,                                07324000
073250                    SKU_NBR,                                      07325000
073260                    ASN_PKGNG_CDE)                                07326000
073270             VALUES                                               07327000
073280                  (:IMCNUP-CONTNR-ID,                             07328000
073290                   :PV-HOLD-CONTNR-SEQ-NBR,                       07329000
073300                   :IMCNUP-PO-NBR,                                07330000
073310                   :IMCNUP-VS-NBR,                                07331000
073320                   :IMCNUP-UPC-NBR,                               07332000
073330                   :IMCNUP-PO-LNE-NBR,                            07333000
073340                   :IMCNUP-UPC-CART-CNT,                          07334000
073350                   :IMCNUP-UPC-CBMT-QTY,                          07335000
073360                   :IMCNUP-UPC-WT-KGRM-QTY,                       07336000
073370                   :IMCNUP-UPC-UNT-QTY,                           07337000
073380                   :PC-CURRENT-PROGRAM-NAME,                      07338000
073390                   :IMCNUP-CRE-TMST,                              07339000
073400                   :PC-CURRENT-PROGRAM-NAME,                      07340000
073410                    CURRENT TIMESTAMP,                            07341000
073420                   :IMCNUP-SKU-NBR,                               07342000
073430                   :IMCNUP-ASN-PKGNG-CDE)                         07343000
073440         END-EXEC                                                 07344000
073450                                                                  07345000
073460         EVALUATE TRUE                                            07346000
073470             WHEN SQLCODE = ZERO                                  07347000
073480                 ADD +1 TO PA-TOT-CNUP-RECS-INSERT                07348000
073490                 ADD +1 TO PA-TOT-RECS-INSERTED                   07349000
073500                 SET PS-GOOD-CNUP-INSERT    TO TRUE               07350000
073510                                                                  07351000
073520             WHEN SQLCODE = -803                                  07352000
073530                 SET PS-GOOD-CNUP-INSERT-NO TO TRUE               07353000
073540                 MOVE PC-ERROR           TO TR211-ERROR-TYPE      07354000
073550                 MOVE IMCNUP-UPC-NBR     TO TR211-DATA-VALUE      07355000
073560                 MOVE 'UPC LEVEL'        TO TR211-DATA-IN-ERROR   07356000
073570                 MOVE 'DUPLICATE UPC   ' TO TR211-ERROR-MSG       07357000
073580                                                                  07358000
073590             WHEN SQLWARN0 NOT EQUAL SPACE                        07359000
073600             WHEN SQLCODE NOT EQUAL ZERO                          07360000
073610                 DISPLAY '**************************************' 07361000
073620                 DISPLAY '** ABEND                            **' 07362000
073630                 DISPLAY '** PROGRAM = TRKUP215               **' 07363000
073640                 DISPLAY '** PARAGRAPH = 7030-INSERT-TIMCNUP  **' 07364000
073650                 DISPLAY '** INSERT INTO TIMCNUP              **' 07365000
073660                 DISPLAY '** CONTNR ID      = ' IMCNUP-CONTNR-ID  07366000
073670                 DISPLAY '** PO NUMBER      = ' IMCNUP-PO-NBR     07367000
073680                 DISPLAY '** UPC NUMBER     = ' IMCNUP-UPC-NBR    07368000
073690                 DISPLAY '**************************************' 07369000
073700                 PERFORM 9100-SQL-ABEND                           07370000
073710         END-EVALUATE                                             07371000
073720     END-PERFORM.                                                 07372000
073730                                                                  07373000
073740     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07374000
073750         (SQLCODE NOT = ZERO AND                                  07375000
073760          SQLCODE NOT = -803)                                     07376000
073770         DISPLAY '****************************************'       07377000
073780         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07378000
073790         DISPLAY '** INSERT TO TIMCNUP                  **'       07379000
073800         DISPLAY '** PARAGRAPH = 7030-INSERT-TIMCNUP    **'       07380000
073810         DISPLAY '** CONTNR ID      = ' IMCNUP-CONTNR-ID          07381000
073820         DISPLAY '** PO NUMBER      = ' IMCNUP-PO-NBR             07382000
073830         DISPLAY '** UPC NUMBER     = ' IMCNUP-UPC-NBR            07383000
073840         DISPLAY '****************************************'       07384000
073850         PERFORM 9100-SQL-ABEND                                   07385000
073860     END-IF.                                                      07386000
073870                                                                  07387000
073880******************************************************************07388000
073890* SELECT A ROW FROM THE IMPORT CONTAINER RELEASE TABLE (TIMCNRL).*07389000
073900******************************************************************07390000
073910 7033-SELECT-TIMCNRL.                                             07391000
073920                                                                  07392000
073930     PERFORM                                                      07393000
073940         WITH TEST AFTER                                          07394000
073950         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07395000
073960         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07396000
073970                 SQLCODE = ZERO                     OR            07397000
073980                 SQLCODE = -811                     OR            07398000
073990                 SQLCODE = +100                                   07399000
074000                                                                  07400000
074010         EXEC SQL                                                 07401000
074020             SELECT CONTNR_ID,                                    07402000
074030                    CONTNR_SEQ_NBR,                               07403000
074040                    PO_NBR,                                       07404000
074050                    DCONSLR_RLSE_CDE,                             07405000
074060                    DCONSLR_REQR_DTE,                             07406000
074070                    DCONSLR_ACTL_DTE,                             07407000
074080                    DCONSLR_ACTL_TM,                              07408000
074090                    CRE_TMST,                                     07409000
074100                    CRE_BY_UID,                                   07410000
074110                    LAST_UPD_BY_UID,                              07411000
074120                    LAST_UPD_TMST,                                07412000
074130                    DCONSLR_ENT_ID                                07413000
074140              INTO :IMCNRL-CONTNR-ID,                             07414000
074150                   :IMCNRL-CONTNR-SEQ-NBR,                        07415000
074160                   :IMCNRL-PO-NBR,                                07416000
074170                   :IMCNRL-DCONSLR-RLSE-CDE,                      07417000
074180                   :IMCNRL-DCONSLR-REQR-DTE,                      07418000
074190                   :IMCNRL-DCONSLR-ACTL-DTE,                      07419000
074200                   :IMCNRL-DCONSLR-ACTL-TM,                       07420000
074210                   :IMCNRL-CRE-TMST,                              07421000
074220                   :IMCNRL-CRE-BY-UID,                            07422000
074230                   :IMCNRL-LAST-UPD-BY-UID,                       07423000
074240                   :IMCNRL-LAST-UPD-TMST,                         07424000
074250                   :IMCNRL-DCONSLR-ENT-ID                         07425000
074260               FROM TIMCNRL                                       07426000
074270              WHERE CONTNR_ID        = :IMCNPO-CONTNR-ID          07427000
074280                AND PO_NBR           = :IMCNPO-PO-NBR             07428000
074290              WITH UR                                             07429000
074300         END-EXEC                                                 07430000
074310                                                                  07431000
074320         EVALUATE TRUE                                            07432000
074330             WHEN SQLCODE = ZERO                                  07433000
074340             WHEN SQLCODE = -811                                  07434000
074350                 SET PS-TIMCNRL-FOUND TO TRUE                     07435000
074360                 ADD +1 TO PA-TOT-CNRL-RECS-SELECT                07436000
074370                 ADD +1 TO PA-TOT-RECS-SELECTED                   07437000
074380                                                                  07438000
074390             WHEN SQLCODE = +100                                  07439000
074400                 SET PS-TIMCNRL-NOT-FOUND TO TRUE                 07440000
074410                                                                  07441000
074420             WHEN SQLWARN0 NOT EQUAL SPACE                        07442000
074430             WHEN SQLCODE NOT EQUAL ZERO                          07443000
074440                 DISPLAY '**************************************' 07444000
074450                 DISPLAY '** ABEND                            **' 07445000
074460                 DISPLAY '** PROGRAM = TRKUP215               **' 07446000
074470                 DISPLAY '** PARAGRAPH = 7033-SELECT-TIMCNRL  **' 07447000
074480                 DISPLAY '** SELECT TIMCNRL                   **' 07448000
074490                 DISPLAY '** CONTNR ID       = '                  07449000
074500                 DISPLAY            IMCNPO-CONTNR-ID              07450000
074510                 DISPLAY '** PO NUMBER       = '                  07451000
074520                 DISPLAY            IMCNPO-PO-NBR                 07452000
074530                 DISPLAY '**************************************' 07453000
074540                 PERFORM 9100-SQL-ABEND                           07454000
074550         END-EVALUATE                                             07455000
074560     END-PERFORM.                                                 07456000
074570                                                                  07457000
074580     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07458000
074590         (SQLCODE NOT = ZERO AND                                  07459000
074600          SQLCODE NOT = -811 AND                                  07460000
074610          SQLCODE NOT = +100)                                     07461000
074620         DISPLAY '****************************************'       07462000
074630         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07463000
074640         DISPLAY '** SELECT FROM TIMCNRL                **'       07464000
074650         DISPLAY '** PARAGRAPH = 7033-SELECT-TIMCNRL    **'       07465000
074660         DISPLAY '** CONTNR ID      = ' IMCNPO-CONTNR-ID          07466000
074670         DISPLAY '** PO NUMBER      = ' IMCNPO-PO-NBR             07467000
074680         DISPLAY '****************************************'       07468000
074690         PERFORM 9100-SQL-ABEND                                   07469000
074700     END-IF.                                                      07470000
074710                                                                  07471000
074720 EJECT                                                            07472000
074730                                                                  07473000
074740******************************************************************07474000
074750* UPDATE A ROW ON THE IMPORT CONTAINER RELEASE TABLE (TIMCNRL).  *07475000
074760******************************************************************07476000
074770 7034-UPDATE-TIMCNRL.                                             07477000
074780                                                                  07478000
074790     PERFORM WITH TEST AFTER                                      07479000
074800             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 07480000
074810             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         07481000
074820                     SQLCODE = ZERO                               07482000
074830                                                                  07483000
074840         EXEC SQL                                                 07484000
074850             UPDATE TIMCNRL                                       07485000
074860             SET DCONSLR_RLSE_CDE = :IMCNRL-DCONSLR-RLSE-CDE      07486000
074870                ,LAST_UPD_BY_UID  = :PC-CURRENT-PROGRAM-NAME      07487000
074880                ,LAST_UPD_TMST    = :PV-CURRENT-TMST              07488000
074890                ,DCONSLR_ACTL_DTE = :PC-DEFAULT-NINES-DTE         07489000
074900                ,DCONSLR_ACTL_TM  = :PC-DEFAULT-NINES-TIME        07490000
074910             WHERE CONTNR_ID      = :IMCNPO-CONTNR-ID             07491000
074920               AND PO_NBR         = :IMCNPO-PO-NBR                07492000
074930         END-EXEC                                                 07493000
074940                                                                  07494000
074950         EVALUATE TRUE                                            07495000
074960             WHEN SQLCODE = ZERO                                  07496000
074970             WHEN SQLCODE = -904                                  07497000
074980             WHEN SQLCODE = -913                                  07498000
074990                  CONTINUE                                        07499000
075000                                                                  07500000
075010             WHEN SQLWARN0 NOT EQUAL SPACE                        07501000
075020             WHEN SQLCODE NOT EQUAL ZERO                          07502000
075030                 DISPLAY '**************************************' 07503000
075040                 DISPLAY '** ABEND                            **' 07504000
075050                 DISPLAY '** PROGRAM = TRKUP215               **' 07505000
075060                 DISPLAY '** PARAGRAPH = 7034-UPDATE-TIMCNRL  **' 07506000
075070                 DISPLAY '** UPDATE TIMCNRL                   **' 07507000
075080                 DISPLAY '** CONTAINER ID = ' IMCNPO-CONTNR-ID    07508000
075090                 DISPLAY '** PO NUMBER    = ' IMCNPO-PO-NBR       07509000
075100                 DISPLAY '**************************************' 07510000
075110                 PERFORM 9100-SQL-ABEND                           07511000
075120         END-EVALUATE                                             07512000
075130     END-PERFORM.                                                 07513000
075140                                                                  07514000
075150     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07515000
075160         SQLCODE NOT = ZERO                                       07516000
075170         DISPLAY '****************************************'       07517000
075180         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07518000
075190         DISPLAY '** UPDATE TO TCKRSTCNTL               **'       07519000
075200         DISPLAY '** PARAGRAPH = 7034-UPDATE-TIMCNRL    **'       07520000
075210         DISPLAY '** CONTAINER ID = ' IMCNPO-CONTNR-ID            07521000
075220         DISPLAY '** PO NUMBER    = ' IMCNPO-PO-NBR               07522000
075230         DISPLAY '****************************************'       07523000
075240         PERFORM 9100-SQL-ABEND                                   07524000
075250     END-IF.                                                      07525000
075260                                                                  07526000
075270 EJECT                                                            07527000
075280******************************************************************07528000
075290* INSERT A ROW INTO THE IMPORT CONTAINER RELEASE TABLE (TIMCNRL).*07529000
075300******************************************************************07530000
075310 7035-INSERT-TIMCNRL.                                             07531000
075320                                                                  07532000
075330     PERFORM                                                      07533000
075340         WITH TEST AFTER                                          07534000
075350         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07535000
075360         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07536000
075370                 SQLCODE = ZERO                                   07537000
075380                                                                  07538000
075390         EXEC SQL                                                 07539000
075400             INSERT INTO TIMCNRL                                  07540000
075410                   (CONTNR_ID,                                    07541000
075420                    CONTNR_SEQ_NBR,                               07542000
075430                    PO_NBR,                                       07543000
075440                    DCONSLR_RLSE_CDE,                             07544000
075450                    DCONSLR_REQR_DTE,                             07545000
075460                    DCONSLR_ACTL_DTE,                             07546000
075470                    DCONSLR_ACTL_TM,                              07547000
075480                    CRE_TMST,                                     07548000
075490                    CRE_BY_UID,                                   07549000
075500                    LAST_UPD_TMST,                                07550000
075510                    LAST_UPD_BY_UID,                              07551000
075520                    DCONSLR_ENT_ID)                               07552000
075530             VALUES                                               07553000
075540                  (:IMCNRL-CONTNR-ID,                             07554000
075550                   :IMCNRL-CONTNR-SEQ-NBR,                        07555000
075560                   :IMCNRL-PO-NBR,                                07556000
075570                   :IMCNRL-DCONSLR-RLSE-CDE,                      07557000
075580                   :IMCNRL-DCONSLR-REQR-DTE,                      07558000
075590                   :IMCNRL-DCONSLR-ACTL-DTE,                      07559000
075600                   :IMCNRL-DCONSLR-ACTL-TM,                       07560000
075610                   :IMCNRL-CRE-TMST,                              07561000
075620                   :IMCNRL-CRE-BY-UID,                            07562000
075630                   :IMCNRL-LAST-UPD-TMST,                         07563000
075640                   :IMCNRL-LAST-UPD-BY-UID,                       07564000
075650                   :IMCNRL-DCONSLR-ENT-ID)                        07565000
075660         END-EXEC                                                 07566000
075670                                                                  07567000
075680         EVALUATE TRUE                                            07568000
075690             WHEN SQLCODE = ZERO                                  07569000
075700                 ADD +1 TO PA-TOT-CNRL-RECS-INSERT                07570000
075710                 ADD +1 TO PA-TOT-RECS-INSERTED                   07571000
075720                                                                  07572000
075730             WHEN SQLCODE = -803                                  07573000
075740                 MOVE PC-ERROR           TO TR211-ERROR-TYPE      07574000
075750                 MOVE IMCNRL-CONTNR-ID   TO TR211-DATA-VALUE      07575000
075760                 MOVE 'TIMCNRL'         TO TR211-DATA-IN-ERROR    07576000
075770                 MOVE 'DUPLICATE TIMCNRL ROW' TO TR211-ERROR-MSG  07577000
075780                                                                  07578000
075790             WHEN SQLWARN0 NOT EQUAL SPACE                        07579000
075800             WHEN SQLCODE NOT EQUAL ZERO                          07580000
075810                 DISPLAY '**************************************' 07581000
075820                 DISPLAY '** ABEND                            **' 07582000
075830                 DISPLAY '** PROGRAM = TRKUP215               **' 07583000
075840                 DISPLAY '** PARAGRAPH = 7035-INSERT-TIMCNRL  **' 07584000
075850                 DISPLAY '** INSERT INTO TIMCNRL              **' 07585000
075860                 DISPLAY '*IMCNRL-CONTNR-ID = ' IMCNRL-CONTNR-ID  07586000
075870                 DISPLAY '*IMCNRL-PO-NBR    = ' IMCNRL-PO-NBR     07587000
075880                 DISPLAY '**************************************' 07588000
075890                 PERFORM 9100-SQL-ABEND                           07589000
075900         END-EVALUATE                                             07590000
075910     END-PERFORM.                                                 07591000
075920                                                                  07592000
075930     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07593000
075940         (SQLCODE NOT = ZERO AND                                  07594000
075950          SQLCODE NOT = -803)                                     07595000
075960         DISPLAY '****************************************'       07596000
075970         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07597000
075980         DISPLAY '** INSERT TO TIMCNRL                  **'       07598000
075990         DISPLAY '** PARAGRAPH = 7035-INSERT-TIMCNRL    **'       07599000
076000         DISPLAY '* IMCNRL-CONTNR-ID = ' IMCNRL-CONTNR-ID         07600000
076010         DISPLAY '* IMCNRL-PO-NBR    = ' IMCNRL-PO-NBR            07601000
076020         DISPLAY '****************************************'       07602000
076030         PERFORM 9100-SQL-ABEND                                   07603000
076040     END-IF.                                                      07604000
076050                                                                  07605000
076060******************************************************************07606000
076070* INSERT A ROW INTO THE IMPORT CONTR/PO RELEASE AUDIT TABLE      *07607000
076080******************************************************************07608000
076090 7037-INSERT-TAUCNRL.                                             07609000
076100                                                                  07610000
076110     PERFORM                                                      07611000
076120         WITH TEST AFTER                                          07612000
076130         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07613000
076140         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07614000
076150                 SQLCODE = ZERO                                   07615000
076160                                                                  07616000
076170         EXEC SQL                                                 07617000
076180             INSERT INTO TAUCNRL                                  07618000
076190                   (CONTNR_ID,                                    07619000
076200                    CONTNR_SEQ_NBR,                               07620000
076210                    PO_NBR,                                       07621000
076220                    DCONSLR_RLSE_CDE,                             07622000
076230                    DCONSLR_REQR_DTE,                             07623000
076240                    DCONSLR_ACTL_DTE,                             07624000
076250                    DCONSLR_ACTL_TM,                              07625000
076260                    CRE_TMST,                                     07626000
076270                    CRE_BY_UID,                                   07627000
076280                    AUD_FUNC_CDE,                                 07628000
076290                    AUD_TMST,                                     07629000
076300                    LAST_UPD_TMST,                                07630000
076310                    LAST_UPD_BY_UID,                              07631000
076320                    DCONSLR_ENT_ID)                               07632000
076330             VALUES                                               07633000
076340                  (:AUCNRL-CONTNR-ID,                             07634000
076350                   :AUCNRL-CONTNR-SEQ-NBR,                        07635000
076360                   :AUCNRL-PO-NBR,                                07636000
076370                   :AUCNRL-DCONSLR-RLSE-CDE,                      07637000
076380                   :AUCNRL-DCONSLR-REQR-DTE,                      07638000
076390                   :AUCNRL-DCONSLR-ACTL-DTE,                      07639000
076400                   :AUCNRL-DCONSLR-ACTL-TM,                       07640000
076410                   :AUCNRL-CRE-TMST,                              07641000
076420                   :AUCNRL-CRE-BY-UID,                            07642000
076430                   :AUCNRL-AUD-FUNC-CDE,                          07643000
076440                   :AUCNRL-AUD-TMST,                              07644000
076450                   :AUCNRL-LAST-UPD-TMST,                         07645000
076460                   :AUCNRL-LAST-UPD-BY-UID,                       07646000
076470                   :AUCNRL-DCONSLR-ENT-ID)                        07647000
076480         END-EXEC                                                 07648000
076490                                                                  07649000
076500         EVALUATE TRUE                                            07650000
076510             WHEN SQLCODE = ZERO                                  07651000
076520                 ADD +1 TO PA-TOT-ACNRL-RECS-INSERT               07652000
076530                 ADD +1 TO PA-TOT-RECS-INSERTED                   07653000
076540                                                                  07654000
076550             WHEN SQLWARN0 NOT EQUAL SPACE                        07655000
076560             WHEN SQLCODE NOT EQUAL ZERO                          07656000
076570                 DISPLAY '**************************************' 07657000
076580                 DISPLAY '** ABEND                            **' 07658000
076590                 DISPLAY '** PROGRAM = TRKUP215               **' 07659000
076600                 DISPLAY '** PARAGRAPH = 7037-INSERT-TAUCNRL  **' 07660000
076610                 DISPLAY '** INSERT INTO TAUCNRL              **' 07661000
076620                 DISPLAY '* CONTNR ID      = ' AUCNRL-CONTNR-ID   07662000
076630                 DISPLAY '* PO NUMBER        ' AUCNRL-PO-NBR      07663000
076640                 DISPLAY '**************************************' 07664000
076650                 PERFORM 9100-SQL-ABEND                           07665000
076660         END-EVALUATE                                             07666000
076670     END-PERFORM.                                                 07667000
076680                                                                  07668000
076690     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07669000
076700         (SQLCODE NOT = ZERO AND                                  07670000
076710          SQLCODE NOT = -803)                                     07671000
076720         DISPLAY '****************************************'       07672000
076730         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07673000
076740         DISPLAY '** INSERT TO TAUCNRL                  **'       07674000
076750         DISPLAY '** PARAGRAPH = 7037-INSERT-TAUCNRL    **'       07675000
076760         DISPLAY '* AUCNRL-CONTNR-ID = ' AUCNRL-CONTNR-ID         07676000
076770         DISPLAY '* AUCNRL-PO-NBR    = ' AUCNRL-PO-NBR            07677000
076780         DISPLAY '****************************************'       07678000
076790         PERFORM 9100-SQL-ABEND                                   07679000
076800     END-IF.                                                      07680000
076810                                                                  07681000
076820******************************************************************07682000
076830* INSERT A ROW IN TOUTTM1 - TROUBLE NOTIFICATION EXTRACT WORK    *07683000
076840* TABLE.                                                         *07684000
076850******************************************************************07685000
076860 7040-INSERT-TOUTTM1.                                             07686000
076870                                                                  07687000
076880     MOVE PC-CN               TO TM606-DATA-SOURCE.               07688000
076890     MOVE PC-DEFAULT-DTE      TO TM606-STRT-FCTRY-DTE             07689000
076900                                 TM606-LAST-FCTRY-DTE             07690000
076910                                 TM606-PO-BKG-DELY-DTE            07691000
076920                                 TM606-PO-RCVD-DELY-DTE           07692000
076930                                 TM606-EST-DPRTR-DTE              07693000
076940                                 TM606-MOM-POE-DELY-DTE.          07694000
076950     MOVE PC-DEFAULT-TMST     TO TM606-PURCHS-LAST-UPD-TMST       07695000
076960                                 TM606-PLNSHP-LAST-UPD-TMST       07696000
076970                                 TM606-IMBKPO-LAST-UPD-TMST       07697000
076980                                 TM606-IMRCPO-LAST-UPD-TMST       07698000
076990                                 TM606-IMCNPO-LAST-UPD-TMST.      07699000
077000                                                                  07700000
077010     MOVE IMCNPO-PO-NBR       TO TM606-PO-NBR.                    07701000
077020     MOVE IMCNPO-CONTNR-ID    TO TM606-CONTNR-ID.                 07702000
077030     MOVE PV-HOLD-CONTNR-SEQ-NBR                                  07703000
077040                              TO TM606-CONTNR-SEQ-NBR.            07704000
077050     MOVE IMCNTK-MOM-DPRTR-TMST (1:10)                            07705000
077060                              TO TM606-EST-DPRTR-DTE.             07706000
077070     MOVE IMCNPO-LAST-UPD-TMST                                    07707000
077080                              TO TM606-IMCNPO-LAST-UPD-TMST.      07708000
077090                                                                  07709000
077100     MOVE TM606-PO-NBR    TO OUTTM1-PO-NBR.                       07710000
077110     MOVE TM606-ODR       TO OUTTM1-TRBL-ODR.                     07711000
077120     MOVE TM606-TMST-ODR  TO OUTTM1-TRBL-TMST-ODR.                07712000
077130                                                                  07713000
077140     PERFORM                                                      07714000
077150         WITH TEST AFTER                                          07715000
077160         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07716000
077170         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07717000
077180                 SQLCODE = ZERO                     OR            07718000
077190                 SQLCODE = -803                                   07719000
077200                                                                  07720000
077210         EXEC SQL                                                 07721000
077220             INSERT INTO TOUTTM1                                  07722000
077230                 (PO_NBR                                          07723000
077240                 ,TRBL_ODR                                        07724000
077250                 ,TRBL_TMST_ODR                                   07725000
077260                  )                                               07726000
077270                VALUES                                            07727000
077280                 (:OUTTM1-PO-NBR                                  07728000
077290                 ,:OUTTM1-TRBL-ODR                                07729000
077300                 ,:OUTTM1-TRBL-TMST-ODR                           07730000
077310                 )                                                07731000
077320         END-EXEC                                                 07732000
077330                                                                  07733000
077340         EVALUATE TRUE                                            07734000
077350             WHEN SQLCODE = ZERO                                  07735000
077360                 ADD +1 TO PA-TOT-TOUTTM1-INSERTS                 07736000
077370                                                                  07737000
077380             WHEN SQLCODE = -803                                  07738000
077390                 CONTINUE                                         07739000
077400                                                                  07740000
077410             WHEN SQLWARN0 NOT EQUAL SPACE                        07741000
077420             WHEN SQLCODE NOT EQUAL ZERO                          07742000
077430                 DISPLAY '**************************************' 07743000
077440                 DISPLAY '** ABEND                            **' 07744000
077450                 DISPLAY '** PROGRAM = TRKUP215               **' 07745000
077460                 DISPLAY '** PARAGRAPH = 7040-INSERT-TOUTTM1  **' 07746000
077470                 DISPLAY '** INSERT INTO TOUTTM1              **' 07747000
077480                 DISPLAY '** PO NUMBER    = '  TM606-PO-NBR-X     07748000
077490                 DISPLAY '** CONTNR ID    = '  TM606-CONTNR-ID    07749000
077500                 DISPLAY '** SEQ NUMBER   = '                     07750000
077510                 DISPLAY                  TM606-CONTNR-SEQ-NBR-X  07751000
077520                 DISPLAY '**************************************' 07752000
077530                 PERFORM 9100-SQL-ABEND                           07753000
077540         END-EVALUATE                                             07754000
077550     END-PERFORM.                                                 07755000
077560                                                                  07756000
077570     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07757000
077580         (SQLCODE NOT = ZERO AND                                  07758000
077590          SQLCODE NOT = -803)                                     07759000
077600         DISPLAY '****************************************'       07760000
077610         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07761000
077620         DISPLAY '** INSERT TO TOUTTM1                  **'       07762000
077630         DISPLAY '** PARAGRAPH = 7040-INSERT-TOUTTM1    **'       07763000
077640         DISPLAY '** PO NUMBER    = '  TM606-PO-NBR-X             07764000
077650         DISPLAY '** CONTNR ID    = '  TM606-CONTNR-ID            07765000
077660         DISPLAY '** SEQ NUMBER   = '                             07766000
077670         DISPLAY                  TM606-CONTNR-SEQ-NBR-X          07767000
077680         DISPLAY '****************************************'       07768000
077690         PERFORM 9100-SQL-ABEND                                   07769000
077700     END-IF.                                                      07770000
077710                                                                  07771000
077720******************************************************************07772000
077730* INSERT A ROW INTO THE CONTAINER CARTON TABLE (TRT_IMPRT_CART). *07773000
077740******************************************************************07774000
077750 7045-INSERT-CARTON.                                              07775000
077760                                                                  07776000
077770     PERFORM                                                      07777000
077780         WITH TEST AFTER                                          07778000
077790         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07779000
077800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07780000
077810                 SQLCODE = ZERO                                   07781000
077820                                                                  07782000
077830         EXEC SQL                                                 07783000
077840             INSERT INTO TRT_IMPRT_CART                           07784000
077850                   (CONTNR_ID,                                    07785000
077860                    CONTNR_SEQ_NBR,                               07786000
077870                    PO_NBR,                                       07787000
077880                    UPC_NBR,                                      07788000
077890                    SSCC_ID,                                      07789000
077900                    CRE_BY_USR_ID,                                07790000
077910                    CRE_TMST,                                     07791000
077920                    UNT_QTY,                                      07792000
077930                    LAST_UPD_BY_USR_ID,                           07793000
077940                    LAST_UPD_TMST)                                07794000
077950             VALUES                                               07795000
077960                  (:TRT00008-CONTNR-ID,                           07796000
077970                   :PV-HOLD-CONTNR-SEQ-NBR,                       07797000
077980                   :TRT00008-PO-NBR,                              07798000
077990                   :TRT00008-UPC-NBR,                             07799000
078000                   :TRT00008-SSCC-ID,                             07800000
078010                   :PC-CURRENT-PROGRAM-NAME,                      07801000
078020                    CURRENT TIMESTAMP,                            07802000
078030                   :TRT00008-UNT-QTY,                             07803000
078040                   :PC-CURRENT-PROGRAM-NAME,                      07804000
078050                    CURRENT TIMESTAMP)                            07805000
078060         END-EXEC                                                 07806000
078070                                                                  07807000
078080         EVALUATE TRUE                                            07808000
078090             WHEN SQLCODE = ZERO                                  07809000
078100                 ADD +1 TO PA-TOT-CNCT-RECS-INSERT                07810000
078110                 ADD +1 TO PA-TOT-RECS-INSERTED                   07811000
078120                 SET PS-GOOD-CNCT-INSERT    TO TRUE               07812000
078130                                                                  07813000
078140             WHEN SQLCODE = -803                                  07814000
078150                 SET PS-GOOD-CNCT-INSERT-NO TO TRUE               07815000
078160                 MOVE PC-ERROR           TO TR211-ERROR-TYPE      07816000
078170                 MOVE TRT00008-SSCC-ID   TO TR211-DATA-VALUE      07817000
078180                 MOVE 'CARTON LEVEL'     TO TR211-DATA-IN-ERROR   07818000
078190                 MOVE 'DUPLICATE CARTON' TO TR211-ERROR-MSG       07819000
078200                                                                  07820000
078210             WHEN SQLWARN0 NOT EQUAL SPACE                        07821000
078220             WHEN SQLCODE NOT EQUAL ZERO                          07822000
078230                 DISPLAY '**************************************' 07823000
078240                 DISPLAY '** ABEND                            **' 07824000
078250                 DISPLAY '** PROGRAM = TRKUP215               **' 07825000
078260                 DISPLAY '** PARAGRAPH = 7045-INSERT-CARTON   **' 07826000
078270                 DISPLAY '** INSERT INTO TRT_IMPRT_CART       **' 07827000
078280                 DISPLAY '** CONTNR ID   = ' TRT00008-CONTNR-ID   07828000
078290                 DISPLAY '** PO NUMBER   = ' TRT00008-PO-NBR      07829000
078300                 DISPLAY '** UPC NUMBER  = ' TRT00008-UPC-NBR     07830000
078310                 DISPLAY '** SSCC NUMBER = ' TRT00008-SSCC-ID     07831000
078320                 DISPLAY '**************************************' 07832000
078330                 PERFORM 9100-SQL-ABEND                           07833000
078340         END-EVALUATE                                             07834000
078350     END-PERFORM.                                                 07835000
078360                                                                  07836000
078370     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07837000
078380         (SQLCODE NOT = ZERO AND                                  07838000
078390          SQLCODE NOT = -803)                                     07839000
078400         DISPLAY '****************************************'       07840000
078410         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07841000
078420         DISPLAY '** INSERT TO TRT_IMPRT_CART           **'       07842000
078430         DISPLAY '** PARAGRAPH = 7045-INSERT-CARTON     **'       07843000
078440         DISPLAY '** CONTNR ID      = ' TRT00008-CONTNR-ID        07844000
078450         DISPLAY '** PO NUMBER      = ' TRT00008-PO-NBR           07845000
078460         DISPLAY '** UPC NUMBER     = ' TRT00008-UPC-NBR          07846000
078470         DISPLAY '** SSCC NUMBER    = ' TRT00008-SSCC-ID          07847000
078480         DISPLAY '****************************************'       07848000
078490         PERFORM 9100-SQL-ABEND                                   07849000
078500     END-IF.                                                      07850000
078510                                                                  07851000
078520******************************************************************07852000
078530* INSERT A ROW INTO THE CONTAINER AUDIT TABLE  (TAUCNTK).        *07853000
078540******************************************************************07854000
078550 7050-INSERT-TAUCNTK.                                             07855000
078560                                                                  07856000
078570     PERFORM                                                      07857000
078580         WITH TEST AFTER                                          07858000
078590         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07859000
078600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            07860000
078610                 SQLCODE = ZERO                                   07861000
078620                                                                  07862000
078630         EXEC SQL                                                 07863000
078640             INSERT INTO TAUCNTK                                  07864000
078650                   (CONTNR_ID,                                    07865000
078660                    CONTNR_SEQ_NBR,                               07866000
078670                    CONSLR_SCAC_ID,                               07867000
078680                    MOM_IMPRT_TRIP_ID,                            07868000
078690                    MOM_DPRTR_TMST,                               07869000
078700                    MOM_POE_DELY_TMST,                            07870000
078710                    MOM_CARR_SCAC_ID,                             07871000
078720                    MOM_FOB_CDE,                                  07872000
078730                    MOM_IMPRT_VEH_NM,                             07873000
078740                    MOM_TRIP_TYP_CDE,                             07874000
078750                    MOM_DEST_POE_CDE,                             07875000
078760                    FDR_IMPRT_TRIP_ID,                            07876000
078770                    FDR_DPRTR_TMST,                               07877000
078780                    FDR_POE_DELY_TMST,                            07878000
078790                    FDR_CARR_SCAC_ID,                             07879000
078800                    FDR_FOB_CDE,                                  07880000
078810                    FDR_IMPRT_VEH_NM,                             07881000
078820                    FDR_TRIP_TYP_CDE,                             07882000
078830                    FDR_DEST_POE_CDE,                             07883000
078840                    SIZE_CDE,                                     07884000
078850                    CART_CNT,                                     07885000
078860                    CBMT_QTY,                                     07886000
078870                    WT_KGRM_QTY,                                  07887000
078880                    UNT_QTY,                                      07888000
078890                    ORGN_SHPD_FR_CDE,                             07889000
078900                    ORGN_SHPD_TO_CDE,                             07890000
078910                    EST_LBD_NM,                                   07891000
078920                    EST_LBD_TMST,                                 07892000
078930                    RISU_DO_RSN_CDE,                              07893000
078940                    BKR_FRGT_RLSE_TMST,                           07894000
078950                    DO_TO_DCONSLR_TMST,                           07895000
078960                    DO_RCVD_TMST,                                 07896000
078970                    CONTNR_PU_TMST,                               07897000
078980                    DAT_SRC_ENT_ID,                               07898000
078990                    LAST_UPD_BY_USR_ID,                           07899000
079000                    LAST_UPD_TMST,                                07900000
079010                    AUD_FUNC_CDE,                                 07901000
079020                    AUD_TMST,                                     07902000
079030                    ACTL_POE_DELY_TMST,                           07903000
079040                    ACTL_DEST_POE_CDE,                            07904000
079050                    ACTL_LBD_NM,                                  07905000
079060                    ACTL_LBD_TMST,                                07906000
079070                    DVN_TMST,                                     07907000
079080                    DCONSLR_SCAC_ID,                              07908000
079090                    DCONSLR_RET_TMST,                             07909000
079100                    MOM_POL_CDE,                                  07910000
079110                    FDR_POL_CDE,                                  07911000
079120                    MOM_POR_CDE,                                  07912000
079130                    FDR_POR_CDE)                                  07913000
079140             VALUES                                               07914000
079150                  (:AUCNTK-CONTNR-ID,                             07915000
079160                   :AUCNTK-CONTNR-SEQ-NBR,                        07916000
079170                   :AUCNTK-CONSLR-SCAC-ID,                        07917000
079180                   :AUCNTK-MOM-IMPRT-TRIP-ID,                     07918000
079190                   :AUCNTK-MOM-DPRTR-TMST,                        07919000
079200                   :AUCNTK-MOM-POE-DELY-TMST,                     07920000
079210                   :AUCNTK-MOM-CARR-SCAC-ID,                      07921000
079220                   :AUCNTK-MOM-FOB-CDE,                           07922000
079230                   :AUCNTK-MOM-IMPRT-VEH-NM,                      07923000
079240                   :AUCNTK-MOM-TRIP-TYP-CDE,                      07924000
079250                   :AUCNTK-MOM-DEST-POE-CDE,                      07925000
079260                   :AUCNTK-FDR-IMPRT-TRIP-ID,                     07926000
079270                   :AUCNTK-FDR-DPRTR-TMST,                        07927000
079280                   :AUCNTK-FDR-POE-DELY-TMST,                     07928000
079290                   :AUCNTK-FDR-CARR-SCAC-ID,                      07929000
079300                   :AUCNTK-FDR-FOB-CDE,                           07930000
079310                   :AUCNTK-FDR-IMPRT-VEH-NM,                      07931000
079320                   :AUCNTK-FDR-TRIP-TYP-CDE,                      07932000
079330                   :AUCNTK-FDR-DEST-POE-CDE,                      07933000
079340                   :AUCNTK-SIZE-CDE,                              07934000
079350                   :AUCNTK-CART-CNT,                              07935000
079360                   :AUCNTK-CBMT-QTY,                              07936000
079370                   :AUCNTK-WT-KGRM-QTY,                           07937000
079380                   :AUCNTK-UNT-QTY,                               07938000
079390                   :AUCNTK-ORGN-SHPD-FR-CDE,                      07939000
079400                   :AUCNTK-ORGN-SHPD-TO-CDE,                      07940000
079410                   :AUCNTK-EST-LBD-NM,                            07941000
079420                   :AUCNTK-EST-LBD-TMST,                          07942000
079430                   :AUCNTK-RISU-DO-RSN-CDE,                       07943000
079440                   :AUCNTK-BKR-FRGT-RLSE-TMST,                    07944000
079450                   :AUCNTK-DO-TO-DCONSLR-TMST,                    07945000
079460                   :AUCNTK-DO-RCVD-TMST,                          07946000
079470                   :AUCNTK-CONTNR-PU-TMST,                        07947000
079480                   :AUCNTK-DAT-SRC-ENT-ID,                        07948000
079490                   :AUCNTK-LAST-UPD-BY-USR-ID,                    07949000
079500                   :AUCNTK-LAST-UPD-TMST,                         07950000
079510                   :AUCNTK-AUD-FUNC-CDE,                          07951000
079520                   :AUCNTK-AUD-TMST,                              07952000
079530                   :AUCNTK-ACTL-POE-DELY-TMST,                    07953000
079540                   :AUCNTK-ACTL-DEST-POE-CDE,                     07954000
079550                   :AUCNTK-ACTL-LBD-NM,                           07955000
079560                   :AUCNTK-ACTL-LBD-TMST,                         07956000
079570                   :AUCNTK-DVN-TMST,                              07957000
079580                   :AUCNTK-DCONSLR-SCAC-ID,                       07958000
079590                   :AUCNTK-DCONSLR-RET-TMST,                      07959000
079600                   :AUCNTK-MOM-POL-CDE,                           07960000
079610                   :AUCNTK-FDR-POL-CDE,                           07961000
079620                   :AUCNTK-MOM-POR-CDE,                           07962000
079630                   :AUCNTK-FDR-POR-CDE)                           07963000
079640         END-EXEC                                                 07964000
079650                                                                  07965000
079660         EVALUATE TRUE                                            07966000
079670             WHEN SQLCODE = ZERO                                  07967000
079680                 ADD +1 TO PA-TOT-ACNTK-RECS-INSERT               07968000
079690                 ADD +1 TO PA-TOT-RECS-INSERTED                   07969000
079700                 SET PS-GOOD-ACNTK-INSERT TO TRUE                 07970000
079710                                                                  07971000
079720             WHEN SQLWARN0 NOT EQUAL SPACE                        07972000
079730             WHEN SQLCODE NOT EQUAL ZERO                          07973000
079740                 DISPLAY '**************************************' 07974000
079750                 DISPLAY '** ABEND                            **' 07975000
079760                 DISPLAY '** PROGRAM = TRKUP215               **' 07976000
079770                 DISPLAY '** PARAGRAPH = 7050-INSERT-TAUCNTK  **' 07977000
079780                 DISPLAY '** INSERT INTO TAUCNTK              **' 07978000
079790                 DISPLAY '** CONTNR ID  = ' AUCNTK-CONTNR-ID      07979000
079800                 DISPLAY '** SAIL DATE  = ' AUCNTK-MOM-DPRTR-TMST 07980000
079810                 DISPLAY '**************************************' 07981000
079820                 PERFORM 9100-SQL-ABEND                           07982000
079830         END-EVALUATE                                             07983000
079840     END-PERFORM.                                                 07984000
079850                                                                  07985000
079860     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07986000
079870         SQLCODE NOT = ZERO                                       07987000
079880         DISPLAY '****************************************'       07988000
079890         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       07989000
079900         DISPLAY '** INSERT TO TAUCNTK                  **'       07990000
079910         DISPLAY '** PARAGRAPH = 7050-INSERT-TAUCNTK    **'       07991000
079920         DISPLAY '** CONTNR ID  = ' AUCNTK-CONTNR-ID              07992000
079930         DISPLAY '** SAIL DATE  = ' AUCNTK-MOM-DPRTR-TMST         07993000
079940         DISPLAY '****************************************'       07994000
079950         PERFORM 9100-SQL-ABEND                                   07995000
079960     END-IF.                                                      07996000
079970                                                                  07997000
079980******************************************************************07998000
079990* INSERT A ROW INTO THE AUDIT CONTAINER PO TABLE (TAUCNPO).      *07999000
080000******************************************************************08000000
080010 7060-INSERT-TAUCNPO.                                             08001000
080020                                                                  08002000
080030     PERFORM                                                      08003000
080040         WITH TEST AFTER                                          08004000
080050         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08005000
080060         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08006000
080070                 SQLCODE = ZERO                                   08007000
080080                                                                  08008000
080090         EXEC SQL                                                 08009000
080100             INSERT INTO TAUCNPO                                  08010000
080110                   (CONTNR_ID,                                    08011000
080120                    CONTNR_SEQ_NBR,                               08012000
080130                    PO_NBR,                                       08013000
080140                    CSTM_ENTR_ID,                                 08014000
080150                    MSTR_BOL_NBR,                                 08015000
080160                    HSE_BOL_NBR,                                  08016000
080170                    LTR_OF_CR_NBR,                                08017000
080180                    PO_RCVD_DELY_TMST,                            08018000
080190                    PO_C_O_PROD_CDE,                              08019000
080200                    PO_CART_CNT,                                  08020000
080210                    PO_CBMT_QTY,                                  08021000
080220                    PO_WT_KGRM_QTY,                               08022000
080230                    PO_UNT_QTY,                                   08023000
080240                    LAST_UPD_BY_USR_ID,                           08024000
080250                    LAST_UPD_TMST,                                08025000
080260                    AUD_FUNC_CDE,                                 08026000
080270                    AUD_TMST,                                     08027000
080280                    EXTL_REF_NBR,                                 08028000
080290                    BKR_FRGT_RLSE_CDE,                            08029000
080300                    DO_RCVD_CDE,                                  08030000
080310                    CONTNR_PU_CDE,                                08031000
080320                    ACTL_POE_DELY_CDE,                            08032000
080330                    DVN_CDE,                                      08033000
080340                    DCONSLR_RET_CDE,                              08034000
080350                    SPLT_XMIT_CDE,                                08035000
080360                    DOC_RCVD_ORGN_TMST)                           08036000
080370             VALUES                                               08037000
080380                  (:AUCNPO-CONTNR-ID,                             08038000
080390                   :AUCNPO-CONTNR-SEQ-NBR,                        08039000
080400                   :AUCNPO-PO-NBR,                                08040000
080410                   :AUCNPO-CSTM-ENTR-ID,                          08041000
080420                   :AUCNPO-MSTR-BOL-NBR,                          08042000
080430                   :AUCNPO-HSE-BOL-NBR,                           08043000
080440                   :AUCNPO-LTR-OF-CR-NBR,                         08044000
080450                   :AUCNPO-PO-RCVD-DELY-TMST,                     08045000
080460                   :AUCNPO-PO-C-O-PROD-CDE,                       08046000
080470                   :AUCNPO-PO-CART-CNT,                           08047000
080480                   :AUCNPO-PO-CBMT-QTY,                           08048000
080490                   :AUCNPO-PO-WT-KGRM-QTY,                        08049000
080500                   :AUCNPO-PO-UNT-QTY,                            08050000
080510                   :AUCNPO-LAST-UPD-BY-USR-ID,                    08051000
080520                   :AUCNPO-LAST-UPD-TMST,                         08052000
080530                   :PV-FUNC-CDE,                                  08053000
080540                    CURRENT TIMESTAMP,                            08054000
080550                   :AUCNPO-EXTL-REF-NBR,                          08055000
080560                   :AUCNPO-BKR-FRGT-RLSE-CDE,                     08056000
080570                   :AUCNPO-DO-RCVD-CDE,                           08057000
080580                   :AUCNPO-CONTNR-PU-CDE,                         08058000
080590                   :AUCNPO-ACTL-POE-DELY-CDE,                     08059000
080600                   :AUCNPO-DVN-CDE,                               08060000
080610                   :AUCNPO-DCONSLR-RET-CDE,                       08061000
080620                   :AUCNPO-SPLT-XMIT-CDE,                         08062000
080630                   :AUCNPO-DOC-RCVD-ORGN-TMST)                    08063000
080640         END-EXEC                                                 08064000
080650                                                                  08065000
080660         EVALUATE TRUE                                            08066000
080670             WHEN SQLCODE = ZERO                                  08067000
080680                 ADD +1 TO PA-TOT-ACNPO-RECS-INSERT               08068000
080690                 ADD +1 TO PA-TOT-RECS-INSERTED                   08069000
080700                 SET PS-GOOD-ACNPO-INSERT TO TRUE                 08070000
080710                                                                  08071000
080720             WHEN SQLWARN0 NOT EQUAL SPACE                        08072000
080730             WHEN SQLCODE NOT EQUAL ZERO                          08073000
080740                 DISPLAY '**************************************' 08074000
080750                 DISPLAY '** ABEND                            **' 08075000
080760                 DISPLAY '** PROGRAM = TRKUP215               **' 08076000
080770                 DISPLAY '** INSERT INTO TAUCNPO              **' 08077000
080780                 DISPLAY '** PARAGRAPH = 7060-INSERT-TAUCNPO  **' 08078000
080790                 DISPLAY '** CONTNR ID   = ' AUCNPO-CONTNR-ID     08079000
080800                 DISPLAY '** PO NUMBER   = ' AUCNPO-PO-NBR        08080000
080810                 DISPLAY '**************************************' 08081000
080820                 PERFORM 9100-SQL-ABEND                           08082000
080830         END-EVALUATE                                             08083000
080840     END-PERFORM.                                                 08084000
080850                                                                  08085000
080860     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08086000
080870         (SQLCODE NOT = ZERO AND                                  08087000
080880          SQLCODE NOT = -803)                                     08088000
080890         DISPLAY '****************************************'       08089000
080900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08090000
080910         DISPLAY '** INSERT TO TAUCNPO                  **'       08091000
080920         DISPLAY '** PARAGRAPH = 7060-INSERT-TAUCNPO    **'       08092000
080930         DISPLAY '** CONTNR ID = ' AUCNPO-CONTNR-ID               08093000
080940         DISPLAY '** PO NUMBER = ' AUCNPO-PO-NBR                  08094000
080950         DISPLAY '****************************************'       08095000
080960         PERFORM 9100-SQL-ABEND                                   08096000
080970     END-IF.                                                      08097000
080980                                                                  08098000
080990******************************************************************08099000
081000* INSERT A ROW INTO THE AUDIT CONTAINER UPC TABLE  (TAUCNUP).    *08100000
081010******************************************************************08101000
081020 7080-INSERT-TAUCNUP.                                             08102000
081030                                                                  08103000
081040     PERFORM                                                      08104000
081050         WITH TEST AFTER                                          08105000
081060         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08106000
081070         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08107000
081080                 SQLCODE = ZERO                                   08108000
081090                                                                  08109000
081100         EXEC SQL                                                 08110000
081110             INSERT INTO TAUCNUP                                  08111000
081120                   (CONTNR_ID,                                    08112000
081130                    CONTNR_SEQ_NBR,                               08113000
081140                    PO_NBR,                                       08114000
081150                    VS_NBR,                                       08115000
081160                    UPC_NBR,                                      08116000
081170                    PO_LNE_NBR,                                   08117000
081180                    UPC_CART_CNT,                                 08118000
081190                    UPC_CBMT_QTY,                                 08119000
081200                    UPC_WT_KGRM_QTY,                              08120000
081210                    UPC_UNT_QTY,                                  08121000
081220                    LAST_UPD_BY_USR_ID,                           08122000
081230                    LAST_UPD_TMST,                                08123000
081240                    AUD_FUNC_CDE,                                 08124000
081250                    AUD_TMST,                                     08125000
081260                    SKU_NBR,                                      08126000
081270                    ASN_PKGNG_CDE)                                08127000
081280             VALUES                                               08128000
081290                  (:AUCNUP-CONTNR-ID,                             08129000
081300                   :AUCNUP-CONTNR-SEQ-NBR,                        08130000
081310                   :AUCNUP-PO-NBR,                                08131000
081320                   :AUCNUP-VS-NBR,                                08132000
081330                   :AUCNUP-UPC-NBR,                               08133000
081340                   :AUCNUP-PO-LNE-NBR,                            08134000
081350                   :AUCNUP-UPC-CART-CNT,                          08135000
081360                   :AUCNUP-UPC-CBMT-QTY,                          08136000
081370                   :AUCNUP-UPC-WT-KGRM-QTY,                       08137000
081380                   :AUCNUP-UPC-UNT-QTY,                           08138000
081390                   :AUCNUP-LAST-UPD-BY-USR-ID,                    08139000
081400                   :AUCNUP-LAST-UPD-TMST,                         08140000
081410                   :PV-FUNC-CDE,                                  08141000
081420                    CURRENT TIMESTAMP,                            08142000
081430                   :AUCNUP-SKU-NBR,                               08143000
081440                   :AUCNUP-ASN-PKGNG-CDE)                         08144000
081450         END-EXEC                                                 08145000
081460                                                                  08146000
081470         EVALUATE TRUE                                            08147000
081480             WHEN SQLCODE = ZERO                                  08148000
081490                 ADD +1 TO PA-TOT-ACNUP-RECS-INSERT               08149000
081500                 ADD +1 TO PA-TOT-RECS-INSERTED                   08150000
081510                 SET PS-GOOD-ACNUP-INSERT TO TRUE                 08151000
081520                                                                  08152000
081530             WHEN SQLCODE = -904                                  08153000
081540             WHEN SQLCODE = -913                                  08154000
081550                 CONTINUE                                         08155000
081560                                                                  08156000
081570             WHEN SQLWARN0 NOT EQUAL SPACE                        08157000
081580             WHEN SQLCODE NOT EQUAL ZERO                          08158000
081590                 DISPLAY '**************************************' 08159000
081600                 DISPLAY '** ABEND                            **' 08160000
081610                 DISPLAY '** PROGRAM = TRKUP215               **' 08161000
081620                 DISPLAY '** PARAGRAPH = 7080-INSERT-TAUCNUP  **' 08162000
081630                 DISPLAY '** INSERT INTO TAUCNUP              **' 08163000
081640                 DISPLAY '** CONTNR ID    = ' AUCNUP-CONTNR-ID    08164000
081650                 DISPLAY '** PO NUMBER    = ' AUCNUP-PO-NBR       08165000
081660                 DISPLAY '** UPC NUMBER   = ' AUCNUP-UPC-NBR      08166000
081670                 DISPLAY '**************************************' 08167000
081680                 PERFORM 9100-SQL-ABEND                           08168000
081690         END-EVALUATE                                             08169000
081700     END-PERFORM.                                                 08170000
081710                                                                  08171000
081720     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08172000
081730         (SQLCODE NOT = ZERO AND                                  08173000
081740          SQLCODE NOT = -803)                                     08174000
081750         DISPLAY '****************************************'       08175000
081760         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08176000
081770         DISPLAY '** INSERT TO TAUCNUP                  **'       08177000
081780         DISPLAY '** PARAGRAPH = 7080-INSERT-TAUCNUP    **'       08178000
081790         DISPLAY '** CONTNR ID   = ' AUCNUP-CONTNR-ID             08179000
081800         DISPLAY '** PO NUMBER   = ' AUCNUP-PO-NBR                08180000
081810         DISPLAY '** UPC NUMBER  = ' AUCNUP-UPC-NBR               08181000
081820         DISPLAY '****************************************'       08182000
081830         PERFORM 9100-SQL-ABEND                                   08183000
081840     END-IF.                                                      08184000
081850                                                                  08185000
081860 EJECT                                                            08186000
081870******************************************************************08187000
081880* INSERT A ROW INTO THE AUDIT CONTAINER CARTON TABLE             *08188000
081890* (TRT_AUD_IMPRT_CART).                                          *08189000
081900******************************************************************08190000
081910 7085-INSERT-AUDIT-CARTON.                                        08191000
081920                                                                  08192000
081930     PERFORM                                                      08193000
081940         WITH TEST AFTER                                          08194000
081950         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08195000
081960         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08196000
081970                 SQLCODE = ZERO                                   08197000
081980                                                                  08198000
081990         EXEC SQL                                                 08199000
082000             INSERT INTO TRT_AUD_IMPRT_CART                       08200000
082010                   (CONTNR_ID,                                    08201000
082020                    CONTNR_SEQ_NBR,                               08202000
082030                    PO_NBR,                                       08203000
082040                    UPC_NBR,                                      08204000
082050                    SSCC_ID,                                      08205000
082060                    UNT_QTY,                                      08206000
082070                    LAST_UPD_BY_USR_ID,                           08207000
082080                    LAST_UPD_TMST,                                08208000
082090                    AUD_FUNC_CDE,                                 08209000
082100                    AUD_TMST)                                     08210000
082110             VALUES                                               08211000
082120                  (:TRT00009-CONTNR-ID,                           08212000
082130                   :TRT00009-CONTNR-SEQ-NBR,                      08213000
082140                   :TRT00009-PO-NBR,                              08214000
082150                   :TRT00009-UPC-NBR,                             08215000
082160                   :TRT00009-SSCC-ID,                             08216000
082170                   :TRT00009-UNT-QTY,                             08217000
082180                   :TRT00009-LAST-UPD-BY-USR-ID,                  08218000
082190                   :TRT00009-LAST-UPD-TMST,                       08219000
082200                   :PV-FUNC-CDE,                                  08220000
082210                   :TRT00009-AUD-TMST)                            08221000
082220         END-EXEC                                                 08222000
082230                                                                  08223000
082240         EVALUATE TRUE                                            08224000
082250             WHEN SQLCODE = ZERO                                  08225000
082260                 ADD +1 TO PA-TOT-ACNCT-RECS-INSERT               08226000
082270                 ADD +1 TO PA-TOT-RECS-INSERTED                   08227000
082280                 SET PS-GOOD-ACNCT-INSERT TO TRUE                 08228000
082290                                                                  08229000
082300             WHEN SQLCODE = -904                                  08230000
082310             WHEN SQLCODE = -913                                  08231000
082320                 CONTINUE                                         08232000
082330                                                                  08233000
082340             WHEN SQLWARN0 NOT EQUAL SPACE                        08234000
082350             WHEN SQLCODE NOT EQUAL ZERO                          08235000
082360                 DISPLAY '**************************************' 08236000
082370                 DISPLAY '** ABEND                            **' 08237000
082380                 DISPLAY '** PROGRAM = TRKUP215               **' 08238000
082390                 DISPLAY '** PARAGRAPH = 7085-INSERT-AUDIT-CART*' 08239000
082400                 DISPLAY '** INSERT INTO TRT_AUD_IMPRT_CART   **' 08240000
082410                 DISPLAY '** CONTNR ID    = ' TRT00009-CONTNR-ID  08241000
082420                 DISPLAY '** PO NUMBER    = ' TRT00009-PO-NBR     08242000
082430                 DISPLAY '** UPC NUMBER   = ' TRT00009-UPC-NBR    08243000
082440                 DISPLAY '** SSCC NUMBER  = ' TRT00009-SSCC-ID    08244000
082450                 DISPLAY '**************************************' 08245000
082460                 PERFORM 9100-SQL-ABEND                           08246000
082470         END-EVALUATE                                             08247000
082480     END-PERFORM.                                                 08248000
082490                                                                  08249000
082500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08250000
082510         (SQLCODE NOT = ZERO AND                                  08251000
082520          SQLCODE NOT = -803)                                     08252000
082530         DISPLAY '****************************************'       08253000
082540         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08254000
082550         DISPLAY '** INSERT TO TRT_AUD_IMPRT_CART       **'       08255000
082560         DISPLAY '** PARAGRAPH = 7085-INSERT-AUDIT-CARTON*'       08256000
082570         DISPLAY '** CONTNR ID   = ' TRT00009-CONTNR-ID           08257000
082580         DISPLAY '** PO NUMBER   = ' TRT00009-PO-NBR              08258000
082590         DISPLAY '** UPC NUMBER  = ' TRT00009-UPC-NBR             08259000
082600         DISPLAY '** SSCC NUMBER = ' TRT00009-SSCC-ID             08260000
082610         DISPLAY '****************************************'       08261000
082620         PERFORM 9100-SQL-ABEND                                   08262000
082630     END-IF.                                                      08263000
082640                                                                  08264000
082650 EJECT                                                            08265000
082660******************************************************************08266000
082670* INSERT A ROW INTO THE CONTAINER SEAL TABLE (TRT_IMPRT_SEAL).   *08267000
082680******************************************************************08268000
082690 7090-INSERT-SEAL.                                                08269000
082700                                                                  08270000
082710     PERFORM                                                      08271000
082720         WITH TEST AFTER                                          08272000
082730         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08273000
082740         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08274000
082750                 SQLCODE = ZERO                                   08275000
082760                                                                  08276000
082770         EXEC SQL                                                 08277000
082780             INSERT INTO TRT_IMPRT_SEAL                           08278000
082790                   (CONTNR_ID,                                    08279000
082800                    CONTNR_SEQ_NBR,                               08280000
082810                    SEAL_NBR,                                     08281000
082820                    CRE_TMST,                                     08282000
082830                    CRE_BY_USR_ID,                                08283000
082840                    LAST_UPD_TMST,                                08284000
082850                    LAST_UPD_BY_USR_ID)                           08285000
082860             VALUES                                               08286000
082870                  (:TRT00006-CONTNR-ID,                           08287000
082880                   :PV-HOLD-CONTNR-SEQ-NBR,                       08288000
082890                   :TRT00006-SEAL-NBR,                            08289000
082900                    CURRENT TIMESTAMP,                            08290000
082910                   :PC-CURRENT-PROGRAM-NAME,                      08291000
082920                    CURRENT TIMESTAMP,                            08292000
082930                   :PC-CURRENT-PROGRAM-NAME)                      08293000
082940         END-EXEC                                                 08294000
082950                                                                  08295000
082960         EVALUATE TRUE                                            08296000
082970             WHEN SQLCODE = ZERO                                  08297000
082980                 ADD +1 TO PA-TOT-CNSL-RECS-INSERT                08298000
082990                 ADD +1 TO PA-TOT-RECS-INSERTED                   08299000
083000                 SET PS-GOOD-CNSL-INSERT    TO TRUE               08300000
083010                                                                  08301000
083020             WHEN SQLCODE = -803                                  08302000
083030                 SET PS-GOOD-CNSL-INSERT-NO TO TRUE               08303000
083040                 MOVE PC-ERROR           TO TR211-ERROR-TYPE      08304000
083050                 MOVE TRT00006-SEAL-NBR  TO TR211-DATA-VALUE      08305000
083060                 MOVE 'SEAL LEVEL'       TO TR211-DATA-IN-ERROR   08306000
083070                 MOVE 'DUPLICATE SEAL'   TO TR211-ERROR-MSG       08307000
083080                                                                  08308000
083090             WHEN SQLWARN0 NOT EQUAL SPACE                        08309000
083100             WHEN SQLCODE NOT EQUAL ZERO                          08310000
083110                 DISPLAY '**************************************' 08311000
083120                 DISPLAY '** ABEND                            **' 08312000
083130                 DISPLAY '** PROGRAM = TRKUP215               **' 08313000
083140                 DISPLAY '** PARAGRAPH = 7090-INSERT-SEAL     **' 08314000
083150                 DISPLAY '** INSERT INTO TRT_IMPRT_SEAL       **' 08315000
083160                 DISPLAY '** CONTNR ID = ' TRT00006-CONTNR-ID     08316000
083170                 DISPLAY '** PO NUMBER = ' TRT00006-SEAL-NBR      08317000
083180                 DISPLAY '**************************************' 08318000
083190                 PERFORM 9100-SQL-ABEND                           08319000
083200         END-EVALUATE                                             08320000
083210     END-PERFORM.                                                 08321000
083220                                                                  08322000
083230     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08323000
083240         (SQLCODE NOT = ZERO AND                                  08324000
083250          SQLCODE NOT = -803)                                     08325000
083260         DISPLAY '****************************************'       08326000
083270         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08327000
083280         DISPLAY '** INSERT TO TRT_IMPRT_SEAL           **'       08328000
083290         DISPLAY '** PARAGRAPH = 7090-INSERT-SEAL       **'       08329000
083300         DISPLAY '** CONTNR ID      = ' TRT00006-CONTNR-ID        08330000
083310         DISPLAY '** PO NUMBER      = ' TRT00006-SEAL-NBR         08331000
083320         DISPLAY '****************************************'       08332000
083330         PERFORM 9100-SQL-ABEND                                   08333000
083340     END-IF.                                                      08334000
083350                                                                  08335000
083360******************************************************************08336000
083370* INSERT A ROW INTO THE AUDIT CONTAINER SEAL TABLE               *08337000
083380* (TRT_AUD_IMPRT_SEAL)                                           *08338000
083390******************************************************************08339000
083400 7095-INSERT-AUDIT-SEAL.                                          08340000
083410                                                                  08341000
083420     PERFORM                                                      08342000
083430         WITH TEST AFTER                                          08343000
083440         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08344000
083450         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08345000
083460                 SQLCODE = ZERO                                   08346000
083470                                                                  08347000
083480         EXEC SQL                                                 08348000
083490             INSERT INTO TRT_AUD_IMPRT_SEAL                       08349000
083500                   (CONTNR_ID,                                    08350000
083510                    CONTNR_SEQ_NBR,                               08351000
083520                    SEAL_NBR,                                     08352000
083530                    LAST_UPD_TMST,                                08353000
083540                    LAST_UPD_BY_USR_ID,                           08354000
083550                    AUD_FUNC_CDE,                                 08355000
083560                    AUD_TMST)                                     08356000
083570             VALUES                                               08357000
083580                  (:TRT00007-CONTNR-ID,                           08358000
083590                   :TRT00007-CONTNR-SEQ-NBR,                      08359000
083600                   :TRT00007-SEAL-NBR,                            08360000
083610                   :TRT00007-LAST-UPD-TMST,                       08361000
083620                   :TRT00007-LAST-UPD-BY-USR-ID,                  08362000
083630                   :PV-FUNC-CDE,                                  08363000
083640                    CURRENT TIMESTAMP)                            08364000
083650         END-EXEC                                                 08365000
083660                                                                  08366000
083670         EVALUATE TRUE                                            08367000
083680             WHEN SQLCODE = ZERO                                  08368000
083690                 ADD +1 TO PA-TOT-ACNSL-RECS-INSERT               08369000
083700                 ADD +1 TO PA-TOT-RECS-INSERTED                   08370000
083710                 SET PS-GOOD-ACNSL-INSERT TO TRUE                 08371000
083720                                                                  08372000
083730             WHEN SQLCODE = -904                                  08373000
083740             WHEN SQLCODE = -913                                  08374000
083750                 CONTINUE                                         08375000
083760                                                                  08376000
083770             WHEN SQLWARN0 NOT EQUAL SPACE                        08377000
083780             WHEN SQLCODE NOT EQUAL ZERO                          08378000
083790                 DISPLAY '**************************************' 08379000
083800                 DISPLAY '** ABEND                            **' 08380000
083810                 DISPLAY '** PROGRAM = TRKUP215               **' 08381000
083820                 DISPLAY '** PARAGRAPH = 7095-INSERT-AUDIT-SEAL*' 08382000
083830                 DISPLAY '** INSERT INTO TRT_AUD_IMPRT_SEAL   **' 08383000
083840                 DISPLAY '** CONTNR ID    = ' TRT00007-CONTNR-ID  08384000
083850                 DISPLAY '** SEAL NUMBER  = ' TRT00007-SEAL-NBR   08385000
083860                 DISPLAY '**************************************' 08386000
083870                 PERFORM 9100-SQL-ABEND                           08387000
083880         END-EVALUATE                                             08388000
083890     END-PERFORM.                                                 08389000
083900                                                                  08390000
083910     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08391000
083920         (SQLCODE NOT = ZERO AND                                  08392000
083930          SQLCODE NOT = -803)                                     08393000
083940         DISPLAY '****************************************'       08394000
083950         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08395000
083960         DISPLAY '** INSERT TO TRT_AUD_IMPRT_SEAL       **'       08396000
083970         DISPLAY '** PARAGRAPH = 7095-INSERT-AUDIT-SEAL **'       08397000
083980         DISPLAY '** CONTNR ID   = ' TRT00007-CONTNR-ID           08398000
083990         DISPLAY '** SEAL NUMBER = ' TRT00007-SEAL-NBR            08399000
084000         DISPLAY '****************************************'       08400000
084010         PERFORM 9100-SQL-ABEND                                   08401000
084020     END-IF.                                                      08402000
084030                                                                  08403000
084040 EJECT                                                            08404000
084050******************************************************************08405000
084060* SELECT PO TYPE CODE FROM PURCHASE ORDER TABLE (TPURCHS).       *08406000
084070******************************************************************08407000
084080 7097-SELECT-PO-TYP-CDE.                                          08408000
084090                                                                  08409000
084100     PERFORM                                                      08410000
084110         WITH TEST AFTER                                          08411000
084120         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08412000
084130         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08413000
084140                 SQLCODE = ZERO                     OR            08414000
084150                 SQLCODE = +100                                   08415000
084160                                                                  08416000
084170         EXEC SQL                                                 08417000
084180             SELECT PO_TYP_CDE                                    08418000
084190              INTO :PURCHS-PO-TYP-CDE                             08419000
084200                                                                  08420000
084210               FROM TPURCHS                                       08421000
084220              WHERE PO_NBR           = :PV-SELECT-PO-NBR          08422000
084230                AND VER_STATUS_CDE   = 'A'                        08423000
084240              WITH UR                                             08424000
084250         END-EXEC                                                 08425000
084260                                                                  08426000
084270         EVALUATE TRUE                                            08427000
084280             WHEN SQLCODE = ZERO                                  08428000
084290                 IF PURCHS-PO-TYP-CDE = ('IM' OR 'IE' OR 'IF')    08429012
084300                     SET PS-LANDED-PO-NOT-FOUND TO TRUE           08430000
084310                     SET PS-IMPORT-PO-IN-CONTNR TO TRUE           08431000
084320                 ELSE                                             08432000
084330                     SET PS-LANDED-PO-FOUND TO TRUE               08433000
084340                     SET PS-LANDED-PO-IN-CONTNR TO TRUE           08434000
084350                 END-IF                                           08435000
084360             WHEN SQLCODE = +100                                  08436000
084370                 SET PS-LANDED-PO-NOT-FOUND TO TRUE               08437000
084380                                                                  08438000
084390             WHEN SQLWARN0 NOT EQUAL SPACE                        08439000
084400             WHEN SQLCODE NOT EQUAL ZERO                          08440000
084410                 DISPLAY '**************************************' 08441000
084420                 DISPLAY '** ABEND                            **' 08442000
084430                 DISPLAY '** PROGRAM = TRKUP215               **' 08443000
084440                 DISPLAY '** PARAGRAPH = 7097-SELECT-PO-TYP-CDE*' 08444000
084450                 DISPLAY '** SELECT FROM TPURCHS              **' 08445000
084460                 DISPLAY '** PO NUMBER      = ' TR023-CONPO-PO-NBR08446000
084470                 DISPLAY '**************************************' 08447000
084480                 PERFORM 9100-SQL-ABEND                           08448000
084490         END-EVALUATE                                             08449000
084500     END-PERFORM.                                                 08450000
084510                                                                  08451000
084520     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08452000
084530         (SQLCODE NOT = ZERO AND                                  08453000
084540             SQLCODE NOT = +100)                                  08454000
084550         DISPLAY '****************************************'       08455000
084560         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08456000
084570         DISPLAY '** SELECT FROM TPURCHS                **'       08457000
084580         DISPLAY '** PARAGRAPH = 7097-SELECT-PO-TYP-CDE **'       08458000
084590         DISPLAY '** PO NUMBER = ' TR023-CONPO-PO-NBR             08459000
084600         DISPLAY '****************************************'       08460000
084610         PERFORM 9100-SQL-ABEND                                   08461000
084620     END-IF.                                                      08462000
084630                                                                  08463000
084640 EJECT                                                            08464000
084650******************************************************************08465000
084660* INSERT ROW INTO TRTW_CONTNR_RUL, THE DB2 WORK TABLE FOR THE    *08466000
084670* SCM MQ PO TRIGGER FILE.                                        *08467000
084680******************************************************************08468000
084690 EJECT                                                            08469000
084700 7099-INSERT-SCM-MESSAGE.                                         08470000
084710                                                                  08471000
084720     PERFORM                                                      08472000
084730         WITH TEST AFTER                                          08473000
084740         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08474000
084750         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08475000
084760                 SQLCODE = ZERO                                   08476000
084770                                                                  08477000
084780         EXEC SQL                                                 08478000
084790              INSERT INTO TRTW_CONTNR_CKPR                        08479000
084800                  (CKPR_REC_1_TXT)                                08480000
084810                 VALUES  (:TRT00039-CKPR-REC-1-TXT)               08481000
084820         END-EXEC                                                 08482000
084830                                                                  08483000
084840         EVALUATE TRUE                                            08484000
084850                                                                  08485000
084860             WHEN SQLCODE = ZERO                                  08486000
084870                 CONTINUE                                         08487000
084880                                                                  08488000
084890             WHEN SQLWARN0 NOT EQUAL SPACE                        08489000
084900             WHEN SQLCODE NOT EQUAL ZERO                          08490000
084910                 DISPLAY '**************************************' 08491000
084920                 DISPLAY '** ABEND                            **' 08492000
084930                 DISPLAY '** PROGRAM = TRKUP215               **' 08493000
084940                 DISPLAY '** PARAGRAPH = 7099-INSERT-SCM-     **' 08494000
084950                 DISPLAY '**                  MESSAGE         **' 08495000
084960                 DISPLAY '** INSERT TRTW_CONTNR_CKPR          **' 08496000
084970                 DISPLAY '** TR405-RECORD = '                     08497000
084980                 DISPLAY '*'    TR405-ACTN-CDE                    08498000
084990                 DISPLAY '*'    TR405-EVENT-TYP                   08499000
085000                 DISPLAY '*'    TR405-PO-NBR                      08500000
085010                 DISPLAY '*'    TR405-EXTL-REF-NBR                08501000
085020                 DISPLAY '**************************************' 08502000
085030                 PERFORM 9100-SQL-ABEND                           08503000
085040         END-EVALUATE                                             08504000
085050     END-PERFORM.                                                 08505000
085060                                                                  08506000
085070     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08507000
085080         SQLCODE NOT = ZERO                                       08508000
085090         DISPLAY '****************************************'       08509000
085100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08510000
085110         DISPLAY '** INSERT INTO TRTW_CONTNR_CKPR       **'       08511000
085120         DISPLAY '** PARAGRAPH = 7099-INSERT-SCM-MESSAGE**'       08512000
085130         DISPLAY '** TR405-RECORD = '                             08513000
085140         DISPLAY '*'    TR405-ACTN-CDE                            08514000
085150         DISPLAY '*'    TR405-EVENT-TYP                           08515000
085160         DISPLAY '*'    TR405-PO-NBR                              08516000
085170         DISPLAY '*'    TR405-EXTL-REF-NBR                        08517000
085180         DISPLAY '****************************************'       08518000
085190         PERFORM 9100-SQL-ABEND                                   08519000
085200     END-IF.                                                      08520000
085210                                                                  08521000
085220 EJECT                                                            08522000
085230******************************************************************08523000
085240* SET THE CURRENT TIMESTAMP.                                     *08524000
085250******************************************************************08525000
085260 7100-SET-CURRENT-TMST.                                           08526000
085270                                                                  08527000
085280          EXEC SQL                                                08528000
085290              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            08529000
085300          END-EXEC                                                08530000
085310                                                                  08531000
085320         EVALUATE TRUE                                            08532000
085330             WHEN SQLCODE = ZERO                                  08533000
085340                 CONTINUE                                         08534000
085350                                                                  08535000
085360             WHEN SQLWARN0 NOT EQUAL SPACE                        08536000
085370             WHEN SQLCODE NOT EQUAL ZERO                          08537000
085380                 DISPLAY '**************************************' 08538000
085390                 DISPLAY '** ABEND                            **' 08539000
085400                 DISPLAY '** PROGRAM = TRKUP215               **' 08540000
085410                 DISPLAY '** PARAGRAPH = 7100-SET-CURRENT-TMST**' 08541000
085420                 DISPLAY '** SET CURRENT TIMESTAMP            **' 08542000
085430                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   08543000
085440                 DISPLAY '**************************************' 08544000
085450                 PERFORM 9100-SQL-ABEND                           08545000
085460         END-EVALUATE.                                            08546000
085470                                                                  08547000
085480******************************************************************08548000
085490* SET THE CURRENT TIMESTAMP FOR DECONSOLIDATOR RULES PROCESSING  *08549000
085500******************************************************************08550000
085510 7110-SET-RULES-CURRENT-TMST.                                     08551000
085520                                                                  08552000
085530          EXEC SQL                                                08553000
085540              SET :PV-CURRENT-TMST-RULES = CURRENT TIMESTAMP      08554000
085550          END-EXEC                                                08555000
085560                                                                  08556000
085570         EVALUATE TRUE                                            08557000
085580             WHEN SQLCODE = ZERO                                  08558000
085590                 CONTINUE                                         08559000
085600                                                                  08560000
085610             WHEN SQLWARN0 NOT EQUAL SPACE                        08561000
085620             WHEN SQLCODE NOT EQUAL ZERO                          08562000
085630              DISPLAY '**************************************'    08563000
085640              DISPLAY '** ABEND                            **'    08564000
085650              DISPLAY '** PROGRAM = TRKUP215               **'    08565000
085660              DISPLAY '** PARAGRAPH = 7110-SET-RULES-CURRENT-TMST'08566000
085670              DISPLAY '** SET CURRENT TIMESTAMP            **'    08567000
085680              DISPLAY '** CURRENT TMST = ' PV-CURRENT-TMST-RULES  08568000
085690              DISPLAY '**************************************'    08569000
085700              PERFORM 9100-SQL-ABEND                              08570000
085710         END-EVALUATE.                                            08571000
085720                                                                  08572000
085730******************************************************************08573000
085740* DELETE A ROW FROM THE CONTAINER TABLE  (TIMCNTK).              *08574000
085750******************************************************************08575000
085760 7150-DELETE-TIMCNTK.                                             08576000
085770                                                                  08577000
085780     PERFORM                                                      08578000
085790         WITH TEST AFTER                                          08579000
085800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08580000
085810         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08581000
085820                 SQLCODE = ZERO                                   08582000
085830                                                                  08583000
085840         EXEC SQL                                                 08584000
085850              DELETE                                              08585000
085860                FROM TIMCNTK                                      08586000
085870               WHERE CONTNR_ID      =  :PV-HOLD-CONTNR-ID         08587000
085880                 AND CONTNR_SEQ_NBR =  :PV-HOLD-CONTNR-SEQ-NBR    08588000
085890                 AND MOM_DPRTR_TMST =  :PV-FORMATED-DB2-TMST      08589000
085900         END-EXEC                                                 08590000
085910                                                                  08591000
085920         EVALUATE TRUE                                            08592000
085930             WHEN SQLCODE = ZERO                                  08593000
085940                 ADD +1 TO PA-TOT-CNTK-RECS-DELETED               08594000
085950                 ADD +1 TO PA-TOT-RECS-DELETED                    08595000
085960                 SET PS-GOOD-CNTK-DELETE TO TRUE                  08596000
085970                                                                  08597000
085980             WHEN SQLCODE = +100                                  08598000
085990                 SET PS-GOOD-CNTK-DELETE-NO TO TRUE               08599000
086000                                                                  08600000
086010             WHEN SQLWARN0 NOT EQUAL SPACE                        08601000
086020             WHEN SQLCODE NOT EQUAL ZERO                          08602000
086030                 DISPLAY '**************************************' 08603000
086040                 DISPLAY '** ABEND                            **' 08604000
086050                 DISPLAY '** PROGRAM = TRKUP215               **' 08605000
086060                 DISPLAY '** PARAGRAPH = 7150-DELETE-TIMCNTK  **' 08606000
086070                 DISPLAY '** DELETE TIMCNTK                   **' 08607000
086080                 DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID 08608000
086090                 DISPLAY '** CONTNR SEQ NBR = '                   08609000
086100                 DISPLAY                  PV-HOLD-CONTNR-SEQ-NBR  08610000
086110                 DISPLAY '** SAIL DATE      = '                   08611000
086120                 DISPLAY                  PV-FORMATED-DB2-TMST    08612000
086130                 DISPLAY '**************************************' 08613000
086140                 PERFORM 9100-SQL-ABEND                           08614000
086150         END-EVALUATE                                             08615000
086160     END-PERFORM.                                                 08616000
086170                                                                  08617000
086180     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08618000
086190         (SQLCODE NOT = ZERO AND                                  08619000
086200          SQLCODE NOT = +100)                                     08620000
086210         DISPLAY '****************************************'       08621000
086220         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08622000
086230         DISPLAY '** DELETE FROM TIMCNTK                **'       08623000
086240         DISPLAY '** PARAGRAPH = 7150-DELETE-TIMCNTK    **'       08624000
086250         DISPLAY '** CONTNR ID       = ' PV-HOLD-CONTNR-ID        08625000
086260         DISPLAY '** CONTNR SEQ NBR  = ' PV-HOLD-CONTNR-SEQ-NBR   08626000
086270         DISPLAY '** SAIL DATE       = ' PV-FORMATED-DB2-TMST     08627000
086280         DISPLAY '****************************************'       08628000
086290         PERFORM 9100-SQL-ABEND                                   08629000
086300     END-IF.                                                      08630000
086310                                                                  08631000
086320 EJECT                                                            08632000
086330******************************************************************08633000
086340* DELETE A ROW FROM THE CONTAINER TABLE  (TIMCNTK).              *08634000
086350******************************************************************08635000
086360 7155-DELETE-TIMCNTK-CHG.                                         08636000
086370                                                                  08637000
086380     PERFORM                                                      08638000
086390         WITH TEST AFTER                                          08639000
086400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08640000
086410         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08641000
086420                 SQLCODE = ZERO                                   08642000
086430                                                                  08643000
086440         EXEC SQL                                                 08644000
086450              DELETE                                              08645000
086460                FROM TIMCNTK                                      08646000
086470               WHERE CONTNR_ID      =  :IMCNTK-CONTNR-ID          08647000
086480                 AND CONTNR_SEQ_NBR =  :IMCNTK-CONTNR-SEQ-NBR     08648000
086490                 AND MOM_DPRTR_TMST =  :PV-FORMATED-DB2-TMST      08649000
086500         END-EXEC                                                 08650000
086510                                                                  08651000
086520         EVALUATE TRUE                                            08652000
086530             WHEN SQLCODE = ZERO                                  08653000
086540                 ADD +1 TO PA-TOT-CNTK-RECS-DELETED               08654000
086550                 ADD +1 TO PA-TOT-RECS-DELETED                    08655000
086560                 SET PS-GOOD-CNTK-DELETE TO TRUE                  08656000
086570                                                                  08657000
086580             WHEN SQLCODE = +100                                  08658000
086590                 SET PS-GOOD-CNTK-DELETE-NO TO TRUE               08659000
086600                                                                  08660000
086610             WHEN SQLWARN0 NOT EQUAL SPACE                        08661000
086620             WHEN SQLCODE NOT EQUAL ZERO                          08662000
086630                 DISPLAY '**************************************' 08663000
086640                 DISPLAY '** ABEND                            **' 08664000
086650                 DISPLAY '** PROGRAM = TRKUP215               **' 08665000
086660                 DISPLAY '** PARAGRAPH = 7155-DELETE-TIMCNTK  **' 08666000
086670                 DISPLAY '** DELETE TIMCNTK                   **' 08667000
086680                 DISPLAY '** CONTNR ID      = ' IMCNTK-CONTNR-ID  08668000
086690                 DISPLAY '** CONTNR SEQ NBR = '                   08669000
086700                 DISPLAY                   IMCNTK-CONTNR-SEQ-NBR  08670000
086710                 DISPLAY '** SAIL DATE      = '                   08671000
086720                 DISPLAY                  PV-FORMATED-DB2-TMST    08672000
086730                 DISPLAY '**************************************' 08673000
086740                 PERFORM 9100-SQL-ABEND                           08674000
086750         END-EVALUATE                                             08675000
086760     END-PERFORM.                                                 08676000
086770                                                                  08677000
086780     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08678000
086790         (SQLCODE NOT = ZERO AND                                  08679000
086800          SQLCODE NOT = +100)                                     08680000
086810         DISPLAY '****************************************'       08681000
086820         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08682000
086830         DISPLAY '** DELETE FROM TIMCNTK                **'       08683000
086840         DISPLAY '** PARAGRAPH = 7155-DELETE-TIMCNTK-CHG**'       08684000
086850         DISPLAY '** CONTNR ID       = ' IMCNTK-CONTNR-ID         08685000
086860         DISPLAY '** CONTNR SEQ NBR  = ' IMCNTK-CONTNR-SEQ-NBR    08686000
086870         DISPLAY '** SAIL DATE       = ' PV-FORMATED-DB2-TMST     08687000
086880         DISPLAY '****************************************'       08688000
086890         PERFORM 9100-SQL-ABEND                                   08689000
086900     END-IF.                                                      08690000
086910                                                                  08691000
086920 EJECT                                                            08692000
086930******************************************************************08693000
086940* DELETE A ROW FROM THE CONTAINER PO TABLE  (TIMCNPO).           *08694000
086950******************************************************************08695000
086960 7160-DELETE-TIMCNPO.                                             08696000
086970                                                                  08697000
086980     PERFORM                                                      08698000
086990         WITH TEST AFTER                                          08699000
087000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08700000
087010         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08701000
087020                 SQLCODE = ZERO                                   08702000
087030                                                                  08703000
087040         EXEC SQL                                                 08704000
087050              DELETE                                              08705000
087060                FROM TIMCNPO                                      08706000
087070               WHERE CONTNR_ID      =  :PV-HOLD-CONTNR-ID         08707000
087080                 AND CONTNR_SEQ_NBR =  :PV-HOLD-CONTNR-SEQ-NBR    08708000
087090                 AND PO_NBR         =  :PV-HOLD-PO-NBR            08709000
087100         END-EXEC                                                 08710000
087110                                                                  08711000
087120         EVALUATE TRUE                                            08712000
087130             WHEN SQLCODE = ZERO                                  08713000
087140                 ADD +1 TO PA-TOT-CNPO-RECS-DELETED               08714000
087150                 ADD +1 TO PA-TOT-RECS-DELETED                    08715000
087160                 SET PS-GOOD-CNPO-DELETE TO TRUE                  08716000
087170                                                                  08717000
087180             WHEN SQLCODE = +100                                  08718000
087190                 SET PS-GOOD-CNPO-DELETE-NO TO TRUE               08719000
087200                                                                  08720000
087210             WHEN SQLWARN0 NOT EQUAL SPACE                        08721000
087220             WHEN SQLCODE NOT EQUAL ZERO                          08722000
087230                 DISPLAY '**************************************' 08723000
087240                 DISPLAY '** ABEND                            **' 08724000
087250                 DISPLAY '** PROGRAM = TRKUP215               **' 08725000
087260                 DISPLAY '** PARAGRAPH = 7160-DELETE-TIMCNPO  **' 08726000
087270                 DISPLAY '** DELETE TIMCNPO                   **' 08727000
087280                 DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID 08728000
087290                 DISPLAY '** CONTNR SEQ NBR = '                   08729000
087300                 DISPLAY                 PV-HOLD-CONTNR-SEQ-NBR   08730000
087310                 DISPLAY '** PO NBR         = ' PV-HOLD-PO-NBR    08731000
087320                 DISPLAY '**************************************' 08732000
087330                 PERFORM 9100-SQL-ABEND                           08733000
087340         END-EVALUATE                                             08734000
087350     END-PERFORM.                                                 08735000
087360                                                                  08736000
087370     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08737000
087380         (SQLCODE NOT = ZERO AND                                  08738000
087390          SQLCODE NOT = +100)                                     08739000
087400         DISPLAY '****************************************'       08740000
087410         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08741000
087420         DISPLAY '** DELETE FROM TIMCNPO                **'       08742000
087430         DISPLAY '** PARAGRAPH = 7160-DELETE-TIMCNPO    **'       08743000
087440         DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID         08744000
087450         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    08745000
087460         DISPLAY '** PO NBR         = ' PV-HOLD-PO-NBR            08746000
087470         DISPLAY '****************************************'       08747000
087480         PERFORM 9100-SQL-ABEND                                   08748000
087490     END-IF.                                                      08749000
087500                                                                  08750000
087510 EJECT                                                            08751000
087520******************************************************************08752000
087530* DELETE A ROW FROM THE TIMCNPO TABLE FOR CHANGE TRANSACTIONS.   *08753000
087540******************************************************************08754000
087550 7165-DELETE-TIMCNPO-CHG.                                         08755000
087560                                                                  08756000
087570     PERFORM                                                      08757000
087580         WITH TEST AFTER                                          08758000
087590         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08759000
087600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08760000
087610                 SQLCODE = ZERO                                   08761000
087620                                                                  08762000
087630         EXEC SQL                                                 08763000
087640              DELETE                                              08764000
087650                FROM TIMCNPO                                      08765000
087660               WHERE CONTNR_ID      =  :IMCNTK-CONTNR-ID          08766000
087670                 AND CONTNR_SEQ_NBR =  :IMCNTK-CONTNR-SEQ-NBR     08767000
087680                 AND PO_NBR         =  :IMCNPO-PO-NBR             08768000
087690         END-EXEC                                                 08769000
087700                                                                  08770000
087710         EVALUATE TRUE                                            08771000
087720             WHEN SQLCODE = ZERO                                  08772000
087730                 ADD +1 TO PA-TOT-CNPO-RECS-DELETED               08773000
087740                 ADD +1 TO PA-TOT-RECS-DELETED                    08774000
087750                                                                  08775000
087760             WHEN SQLCODE = +100                                  08776000
087770                 CONTINUE                                         08777000
087780                                                                  08778000
087790             WHEN SQLWARN0 NOT EQUAL SPACE                        08779000
087800             WHEN SQLCODE NOT EQUAL ZERO                          08780000
087810                 DISPLAY '**************************************' 08781000
087820                 DISPLAY '** ABEND                            **' 08782000
087830                 DISPLAY '** PROGRAM = TRKUP215               **' 08783000
087840                 DISPLAY '** PARAGRAPH = 7165-DELETE-TIMCNPO-CHG' 08784000
087850                 DISPLAY '** DELETE TIMCNPO                   **' 08785000
087860                 DISPLAY '** CONTNR ID      = ' IMCNTK-CONTNR-ID  08786000
087870                 DISPLAY '** CONTNR SEQ NBR = '                   08787000
087880                 DISPLAY                 IMCNTK-CONTNR-SEQ-NBR    08788000
087890                 DISPLAY '** PO NBR         = ' IMCNPO-PO-NBR     08789000
087900                 DISPLAY '**************************************' 08790000
087910                 PERFORM 9100-SQL-ABEND                           08791000
087920         END-EVALUATE                                             08792000
087930     END-PERFORM.                                                 08793000
087940                                                                  08794000
087950     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08795000
087960         (SQLCODE NOT = ZERO AND                                  08796000
087970          SQLCODE NOT = +100)                                     08797000
087980         DISPLAY '****************************************'       08798000
087990         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08799000
088000         DISPLAY '** DELETE FROM TIMCNPO                **'       08800000
088010         DISPLAY '** PARAGRAPH = 7165-DELETE-TIMCNPO-CHG**'       08801000
088020         DISPLAY '** CONTNR ID      = ' IMCNTK-CONTNR-ID          08802000
088030         DISPLAY '** CONTNR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR     08803000
088040         DISPLAY '** PO NBR         = ' IMCNPO-PO-NBR             08804000
088050         DISPLAY '****************************************'       08805000
088060         PERFORM 9100-SQL-ABEND                                   08806000
088070     END-IF.                                                      08807000
088080                                                                  08808000
088090 EJECT                                                            08809000
088100******************************************************************08810000
088110* DELETE A ROW FROM THE CONTAINER UPC TABLE  (TIMCNUP).          *08811000
088120******************************************************************08812000
088130 7180-DELETE-TIMCNUP.                                             08813000
088140                                                                  08814000
088150     PERFORM                                                      08815000
088160         WITH TEST AFTER                                          08816000
088170         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08817000
088180         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08818000
088190                 SQLCODE = ZERO                                   08819000
088200                                                                  08820000
088210         EXEC SQL                                                 08821000
088220              DELETE                                              08822000
088230                FROM TIMCNUP                                      08823000
088240               WHERE CONTNR_ID      =  :PV-HOLD-CONTNR-ID         08824000
088250                 AND CONTNR_SEQ_NBR =  :PV-HOLD-CONTNR-SEQ-NBR    08825000
088260                 AND PO_NBR         =  :PV-HOLD-PO-NBR            08826000
088270                 AND UPC_NBR        =  :PV-HOLD-UPC-NBR           08827000
088280         END-EXEC                                                 08828000
088290                                                                  08829000
088300         EVALUATE TRUE                                            08830000
088310             WHEN SQLCODE = ZERO                                  08831000
088320                 ADD +1 TO PA-TOT-CNUP-RECS-DELETED               08832000
088330                 ADD +1 TO PA-TOT-RECS-DELETED                    08833000
088340                 SET PS-GOOD-CNUP-DELETE    TO TRUE               08834000
088350                                                                  08835000
088360             WHEN SQLCODE = +100                                  08836000
088370                 SET PS-GOOD-CNUP-DELETE-NO TO TRUE               08837000
088380                                                                  08838000
088390             WHEN SQLWARN0 NOT EQUAL SPACE                        08839000
088400             WHEN SQLCODE NOT EQUAL ZERO                          08840000
088410                 DISPLAY '**************************************' 08841000
088420                 DISPLAY '** ABEND                            **' 08842000
088430                 DISPLAY '** PROGRAM = TRKUP215               **' 08843000
088440                 DISPLAY '** PARAGRAPH = 7180-DELETE-TIMCNUP  **' 08844000
088450                 DISPLAY '** DELETE TIMCNUP                   **' 08845000
088460                 DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID 08846000
088470                 DISPLAY '** CONTNR SEQ NBR = '                   08847000
088480                 DISPLAY                PV-HOLD-CONTNR-SEQ-NBR    08848000
088490                 DISPLAY '** PO NBR         = ' PV-HOLD-PO-NBR    08849000
088500                 DISPLAY '** UPC NBR        = ' PV-HOLD-UPC-NBR   08850000
088510                 DISPLAY '**************************************' 08851000
088520                 PERFORM 9100-SQL-ABEND                           08852000
088530         END-EVALUATE                                             08853000
088540     END-PERFORM.                                                 08854000
088550                                                                  08855000
088560     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08856000
088570         (SQLCODE NOT = ZERO AND                                  08857000
088580          SQLCODE NOT = +100)                                     08858000
088590         DISPLAY '****************************************'       08859000
088600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08860000
088610         DISPLAY '** DELETE FROM TIMCNUP                **'       08861000
088620         DISPLAY '** PARAGRAPH = 7180-DELETE-TIMCNUP    **'       08862000
088630         DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID         08863000
088640         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    08864000
088650         DISPLAY '** PO NBR         = ' PV-HOLD-PO-NBR            08865000
088660         DISPLAY '** UPC NBR        = ' PV-HOLD-UPC-NBR           08866000
088670         DISPLAY '****************************************'       08867000
088680         PERFORM 9100-SQL-ABEND                                   08868000
088690     END-IF.                                                      08869000
088700                                                                  08870000
088710 EJECT                                                            08871000
088720******************************************************************08872000
088730* DELETE A ROW FROM THE TIMCNUP TABLE FOR CHANGE TRANSACTIONS.   *08873000
088740******************************************************************08874000
088750 7185-DELETE-TIMCNUP-CHG.                                         08875000
088760                                                                  08876000
088770     PERFORM                                                      08877000
088780         WITH TEST AFTER                                          08878000
088790         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08879000
088800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08880000
088810                 SQLCODE = ZERO                                   08881000
088820                                                                  08882000
088830         EXEC SQL                                                 08883000
088840              DELETE                                              08884000
088850                FROM TIMCNUP                                      08885000
088860               WHERE CONTNR_ID      =  :IMCNTK-CONTNR-ID          08886000
088870                 AND CONTNR_SEQ_NBR =  :IMCNTK-CONTNR-SEQ-NBR     08887000
088880                 AND PO_NBR         =  :IMCNUP-PO-NBR             08888000
088890                 AND UPC_NBR        =  :IMCNUP-UPC-NBR            08889000
088900         END-EXEC                                                 08890000
088910                                                                  08891000
088920         EVALUATE TRUE                                            08892000
088930             WHEN SQLCODE = ZERO                                  08893000
088940                 ADD +1 TO PA-TOT-CNUP-RECS-DELETED               08894000
088950                 ADD +1 TO PA-TOT-RECS-DELETED                    08895000
088960                                                                  08896000
088970             WHEN SQLCODE = +100                                  08897000
088980                 CONTINUE                                         08898000
088990                                                                  08899000
089000             WHEN SQLWARN0 NOT EQUAL SPACE                        08900000
089010             WHEN SQLCODE NOT EQUAL ZERO                          08901000
089020                 DISPLAY '**************************************' 08902000
089030                 DISPLAY '** ABEND                            **' 08903000
089040                 DISPLAY '** PROGRAM = TRKUP215               **' 08904000
089050                 DISPLAY '** PARAGRAPH =                      **' 08905000
089060                 DISPLAY '**        7185-DELETE-TIMCNUP-CHG   **' 08906000
089070                 DISPLAY '** DELETE TIMCNUP                   **' 08907000
089080                 DISPLAY '** CONTNR ID    =' IMCNTK-CONTNR-ID     08908000
089090                 DISPLAY '** CONTNR SEQ   =' IMCNTK-CONTNR-SEQ-NBR08909000
089100                 DISPLAY '** PO NBR       =' IMCNUP-PO-NBR        08910000
089110                 DISPLAY '** UPC NUMBER   =' IMCNUP-UPC-NBR       08911000
089120                 DISPLAY '**************************************' 08912000
089130                 PERFORM 9100-SQL-ABEND                           08913000
089140         END-EVALUATE                                             08914000
089150     END-PERFORM.                                                 08915000
089160                                                                  08916000
089170     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08917000
089180         (SQLCODE NOT = ZERO AND                                  08918000
089190          SQLCODE NOT = +100)                                     08919000
089200         DISPLAY '****************************************'       08920000
089210         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08921000
089220         DISPLAY '** DELETE FROM TIMCNUP                **'       08922000
089230         DISPLAY '** PARAGRAPH = 7185-DELETE-TIMCNUP-CHG**'       08923000
089240         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            08924000
089250         DISPLAY '** CONTNR SEQ   = ' IMCNTK-CONTNR-SEQ-NBR       08925000
089260         DISPLAY '** PO NUMBER    = ' IMCNUP-PO-NBR               08926000
089270         DISPLAY '** UPC NUMBER   = ' IMCNUP-UPC-NBR              08927000
089280         DISPLAY '****************************************'       08928000
089290         PERFORM 9100-SQL-ABEND                                   08929000
089300     END-IF.                                                      08930000
089310                                                                  08931000
089320 EJECT                                                            08932000
089330******************************************************************08933000
089340* DELETE A ROW FROM THE CONTAINER CARTON TABLE (TRT_IMPRT_CART). *08934000
089350******************************************************************08935000
089360 7187-DELETE-CARTON.                                              08936000
089370                                                                  08937000
089380     PERFORM                                                      08938000
089390         WITH TEST AFTER                                          08939000
089400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08940000
089410         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            08941000
089420                 SQLCODE = ZERO                                   08942000
089430                                                                  08943000
089440         EXEC SQL                                                 08944000
089450              DELETE                                              08945000
089460                FROM TRT_IMPRT_CART                               08946000
089470               WHERE CONTNR_ID      =  :PV-HOLD-CONTNR-ID         08947000
089480                 AND CONTNR_SEQ_NBR =  :PV-HOLD-CONTNR-SEQ-NBR    08948000
089490                 AND PO_NBR         =  :PV-HOLD-PO-NBR            08949000
089500                 AND UPC_NBR        =  :PV-HOLD-UPC-NBR           08950000
089510                 AND SSCC_ID        =  :PV-HOLD-SSCC-NBR          08951000
089520         END-EXEC                                                 08952000
089530                                                                  08953000
089540         EVALUATE TRUE                                            08954000
089550             WHEN SQLCODE = ZERO                                  08955000
089560                 ADD +1 TO PA-TOT-CNCT-RECS-DELETED               08956000
089570                 ADD +1 TO PA-TOT-RECS-DELETED                    08957000
089580                 SET PS-GOOD-CNCT-DELETE    TO TRUE               08958000
089590                                                                  08959000
089600             WHEN SQLCODE = +100                                  08960000
089610                 SET PS-GOOD-CNCT-DELETE-NO TO TRUE               08961000
089620                                                                  08962000
089630             WHEN SQLWARN0 NOT EQUAL SPACE                        08963000
089640             WHEN SQLCODE NOT EQUAL ZERO                          08964000
089650                 DISPLAY '**************************************' 08965000
089660                 DISPLAY '** ABEND                            **' 08966000
089670                 DISPLAY '** PROGRAM = TRKUP215               **' 08967000
089680                 DISPLAY '** PARAGRAPH = 7187-DELETE-CARTON   **' 08968000
089690                 DISPLAY '** DELETE TRT_IMPRT_CART            **' 08969000
089700                 DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID 08970000
089710                 DISPLAY '** CONTNR SEQ NBR = '                   08971000
089720                 DISPLAY                PV-HOLD-CONTNR-SEQ-NBR    08972000
089730                 DISPLAY '** PO NBR         = ' PV-HOLD-PO-NBR    08973000
089740                 DISPLAY '** UPC NBR        = ' PV-HOLD-UPC-NBR   08974000
089750                 DISPLAY '** SSCC NBR       = ' PV-HOLD-SSCC-NBR  08975000
089760                 DISPLAY '**************************************' 08976000
089770                 PERFORM 9100-SQL-ABEND                           08977000
089780         END-EVALUATE                                             08978000
089790     END-PERFORM.                                                 08979000
089800                                                                  08980000
089810     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08981000
089820         (SQLCODE NOT = ZERO AND                                  08982000
089830          SQLCODE NOT = +100)                                     08983000
089840         DISPLAY '****************************************'       08984000
089850         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       08985000
089860         DISPLAY '** DELETE FROM TRT_IMPRT_CART         **'       08986000
089870         DISPLAY '** PARAGRAPH = 7187-DELETE-CARTON     **'       08987000
089880         DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID         08988000
089890         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    08989000
089900         DISPLAY '** PO NBR         = ' PV-HOLD-PO-NBR            08990000
089910         DISPLAY '** UPC NBR        = ' PV-HOLD-UPC-NBR           08991000
089920         DISPLAY '** SSCC NBR       = ' PV-HOLD-SSCC-NBR          08992000
089930         DISPLAY '****************************************'       08993000
089940         PERFORM 9100-SQL-ABEND                                   08994000
089950     END-IF.                                                      08995000
089960                                                                  08996000
089970 EJECT                                                            08997000
089980******************************************************************08998000
089990* DELETE A ROW FROM THE TIMCNRL TABLE.                           *08999000
090000******************************************************************09000000
090010 7190-DELETE-TIMCNRL.                                             09001000
090020                                                                  09002000
090030     PERFORM                                                      09003000
090040         WITH TEST AFTER                                          09004000
090050         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09005000
090060         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09006000
090070                 SQLCODE = ZERO                                   09007000
090080                                                                  09008000
090090         EXEC SQL                                                 09009000
090100              DELETE                                              09010000
090110                FROM TIMCNRL                                      09011000
090120               WHERE CONTNR_ID      =  :IMCNRL-CONTNR-ID          09012000
090130                 AND PO_NBR         =  :IMCNRL-PO-NBR             09013000
090140         END-EXEC                                                 09014000
090150                                                                  09015000
090160         EVALUATE TRUE                                            09016000
090170             WHEN SQLCODE = ZERO                                  09017000
090180                 ADD +1 TO PA-TOT-CNRL-RECS-DELETED               09018000
090190                 ADD +1 TO PA-TOT-RECS-DELETED                    09019000
090200                                                                  09020000
090210             WHEN SQLCODE = +100                                  09021000
090220                 CONTINUE                                         09022000
090230                                                                  09023000
090240             WHEN SQLWARN0 NOT EQUAL SPACE                        09024000
090250             WHEN SQLCODE NOT EQUAL ZERO                          09025000
090260                 DISPLAY '**************************************' 09026000
090270                 DISPLAY '** ABEND                            **' 09027000
090280                 DISPLAY '** PROGRAM = TRKUP215               **' 09028000
090290                 DISPLAY '** PARAGRAPH =                      **' 09029000
090300                 DISPLAY '**        7190-DELETE-TIMCNRL       **' 09030000
090310                 DISPLAY '** DELETE TIMCNRL                   **' 09031000
090320                 DISPLAY '** CONTNR ID    =' IMCNRL-CONTNR-ID     09032000
090330                 DISPLAY '** PO NBR       =' IMCNRL-PO-NBR        09033000
090340                 DISPLAY '**************************************' 09034000
090350                 PERFORM 9100-SQL-ABEND                           09035000
090360         END-EVALUATE                                             09036000
090370     END-PERFORM.                                                 09037000
090380                                                                  09038000
090390     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09039000
090400         (SQLCODE NOT = ZERO AND                                  09040000
090410          SQLCODE NOT = +100)                                     09041000
090420         DISPLAY '****************************************'       09042000
090430         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09043000
090440         DISPLAY '** DELETE FROM TIMCNRL                **'       09044000
090450         DISPLAY '** PARAGRAPH = 7190-DELETE-TIMCNRL    **'       09045000
090460         DISPLAY '** CONTNR ID    = ' IMCNRL-CONTNR-ID            09046000
090470         DISPLAY '** PO NUMBER    = ' IMCNRL-PO-NBR               09047000
090480         DISPLAY '****************************************'       09048000
090490         PERFORM 9100-SQL-ABEND                                   09049000
090500     END-IF.                                                      09050000
090510                                                                  09051000
090520 EJECT                                                            09052000
090530******************************************************************09053000
090540* DELETE A ROW FROM THE TRT_IMPRT_CART TABLE FOR CHANGE          *09054000
090550* TRANSACTIONS.                                                  *09055000
090560******************************************************************09056000
090570 7195-DELETE-CARTON-CHG.                                          09057000
090580                                                                  09058000
090590     PERFORM                                                      09059000
090600         WITH TEST AFTER                                          09060000
090610         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09061000
090620         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09062000
090630                 SQLCODE = ZERO                                   09063000
090640                                                                  09064000
090650         EXEC SQL                                                 09065000
090660              DELETE                                              09066000
090670                FROM TRT_IMPRT_CART                               09067000
090680               WHERE CONTNR_ID      =  :IMCNTK-CONTNR-ID          09068000
090690                 AND CONTNR_SEQ_NBR =  :IMCNTK-CONTNR-SEQ-NBR     09069000
090700                 AND PO_NBR         =  :TRT00008-PO-NBR           09070000
090710                 AND UPC_NBR        =  :TRT00008-UPC-NBR          09071000
090720                 AND SSCC_ID        =  :TRT00008-SSCC-ID          09072000
090730         END-EXEC                                                 09073000
090740                                                                  09074000
090750         EVALUATE TRUE                                            09075000
090760             WHEN SQLCODE = ZERO                                  09076000
090770                 ADD +1 TO PA-TOT-CNCT-RECS-DELETED               09077000
090780                 ADD +1 TO PA-TOT-RECS-DELETED                    09078000
090790                                                                  09079000
090800             WHEN SQLCODE = +100                                  09080000
090810                 CONTINUE                                         09081000
090820                                                                  09082000
090830             WHEN SQLWARN0 NOT EQUAL SPACE                        09083000
090840             WHEN SQLCODE NOT EQUAL ZERO                          09084000
090850                 DISPLAY '**************************************' 09085000
090860                 DISPLAY '** ABEND                            **' 09086000
090870                 DISPLAY '** PROGRAM = TRKUP215               **' 09087000
090880                 DISPLAY '** PARAGRAPH =                      **' 09088000
090890                 DISPLAY '**        7195-DELETE-CARTON-CHG    **' 09089000
090900                 DISPLAY '** DELETE TRT_IMPRT_CART            **' 09090000
090910                 DISPLAY '** CONTNR ID    =' IMCNTK-CONTNR-ID     09091000
090920                 DISPLAY '** CONTNR SEQ   =' IMCNTK-CONTNR-SEQ-NBR09092000
090930                 DISPLAY '** PO NBR       =' TRT00008-PO-NBR      09093000
090940                 DISPLAY '** UPC NUMBER   =' TRT00008-UPC-NBR     09094000
090950                 DISPLAY '** SSCC NUMBER  =' TRT00008-SSCC-ID     09095000
090960                 DISPLAY '**************************************' 09096000
090970                 PERFORM 9100-SQL-ABEND                           09097000
090980         END-EVALUATE                                             09098000
090990     END-PERFORM.                                                 09099000
091000                                                                  09100000
091010     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09101000
091020         (SQLCODE NOT = ZERO AND                                  09102000
091030          SQLCODE NOT = +100)                                     09103000
091040         DISPLAY '****************************************'       09104000
091050         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09105000
091060         DISPLAY '** DELETE FROM TRT_IMPRT_CART         **'       09106000
091070         DISPLAY '** PARAGRAPH = 7195-DELETE-CARTON-CHG **'       09107000
091080         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            09108000
091090         DISPLAY '** CONTNR SEQ   = ' IMCNTK-CONTNR-SEQ-NBR       09109000
091100         DISPLAY '** PO NUMBER    = ' TRT00008-PO-NBR             09110000
091110         DISPLAY '** UPC NUMBER   = ' TRT00008-UPC-NBR            09111000
091120         DISPLAY '** SSCC NUMBER  = ' TRT00008-SSCC-ID            09112000
091130         DISPLAY '****************************************'       09113000
091140         PERFORM 9100-SQL-ABEND                                   09114000
091150     END-IF.                                                      09115000
091160                                                                  09116000
091170 EJECT                                                            09117000
091180******************************************************************09118000
091190* DELETE A ROW FROM THE CONTAINER SEAL TABLE (TRT_IMPRT_SEAL).   *09119000
091200******************************************************************09120000
091210 7197-DELETE-SEAL.                                                09121000
091220                                                                  09122000
091230     PERFORM                                                      09123000
091240         WITH TEST AFTER                                          09124000
091250         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09125000
091260         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09126000
091270                 SQLCODE = ZERO                                   09127000
091280                                                                  09128000
091290         EXEC SQL                                                 09129000
091300              DELETE                                              09130000
091310                FROM TRT_IMPRT_SEAL                               09131000
091320               WHERE CONTNR_ID      =  :PV-HOLD-CONTNR-ID         09132000
091330                 AND CONTNR_SEQ_NBR =  :PV-HOLD-CONTNR-SEQ-NBR    09133000
091340                 AND SEAL_NBR       =  :PV-HOLD-SEAL-NBR          09134000
091350         END-EXEC                                                 09135000
091360                                                                  09136000
091370         EVALUATE TRUE                                            09137000
091380             WHEN SQLCODE = ZERO                                  09138000
091390                 ADD +1 TO PA-TOT-CNSL-RECS-DELETED               09139000
091400                 ADD +1 TO PA-TOT-RECS-DELETED                    09140000
091410                 SET PS-GOOD-CNSL-DELETE    TO TRUE               09141000
091420                                                                  09142000
091430             WHEN SQLCODE = +100                                  09143000
091440                 SET PS-GOOD-CNSL-DELETE-NO TO TRUE               09144000
091450                                                                  09145000
091460             WHEN SQLWARN0 NOT EQUAL SPACE                        09146000
091470             WHEN SQLCODE NOT EQUAL ZERO                          09147000
091480                 DISPLAY '**************************************' 09148000
091490                 DISPLAY '** ABEND                            **' 09149000
091500                 DISPLAY '** PROGRAM = TRKUP215               **' 09150000
091510                 DISPLAY '** PARAGRAPH = 7197-DELETE-SEAL     **' 09151000
091520                 DISPLAY '** DELETE TRT_IMPRT_SEAL            **' 09152000
091530                 DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID 09153000
091540                 DISPLAY '** CONTNR SEQ NBR = '                   09154000
091550                 DISPLAY                PV-HOLD-CONTNR-SEQ-NBR    09155000
091560                 DISPLAY '** SEAL NBR       = ' PV-HOLD-SEAL-NBR  09156000
091570                 DISPLAY '**************************************' 09157000
091580                 PERFORM 9100-SQL-ABEND                           09158000
091590         END-EVALUATE                                             09159000
091600     END-PERFORM.                                                 09160000
091610                                                                  09161000
091620     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09162000
091630         (SQLCODE NOT = ZERO AND                                  09163000
091640          SQLCODE NOT = +100)                                     09164000
091650         DISPLAY '****************************************'       09165000
091660         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09166000
091670         DISPLAY '** DELETE FROM TRT_IMPRT_SEAL         **'       09167000
091680         DISPLAY '** PARAGRAPH = 7197-DELETE-SEAL       **'       09168000
091690         DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID         09169000
091700         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    09170000
091710         DISPLAY '** SEAL NBR       = ' PV-HOLD-SEAL-NBR          09171000
091720         DISPLAY '****************************************'       09172000
091730         PERFORM 9100-SQL-ABEND                                   09173000
091740     END-IF.                                                      09174000
091750                                                                  09175000
091760 EJECT                                                            09176000
091770******************************************************************09177000
091780* DELETE A ROW FROM THE TRT_IMPRT_SEAL TABLE FOR CHANGE          *09178000
091790* TRANSACTIONS.                                                  *09179000
091800******************************************************************09180000
091810 7198-DELETE-SEAL-CHG.                                            09181000
091820                                                                  09182000
091830     PERFORM                                                      09183000
091840         WITH TEST AFTER                                          09184000
091850         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09185000
091860         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09186000
091870                 SQLCODE = ZERO                                   09187000
091880                                                                  09188000
091890         EXEC SQL                                                 09189000
091900              DELETE                                              09190000
091910                FROM TRT_IMPRT_SEAL                               09191000
091920               WHERE CONTNR_ID      =  :IMCNTK-CONTNR-ID          09192000
091930                 AND CONTNR_SEQ_NBR =  :IMCNTK-CONTNR-SEQ-NBR     09193000
091940                 AND SEAL_NBR       =  :TRT00006-SEAL-NBR         09194000
091950         END-EXEC                                                 09195000
091960                                                                  09196000
091970         EVALUATE TRUE                                            09197000
091980             WHEN SQLCODE = ZERO                                  09198000
091990                 ADD +1 TO PA-TOT-CNSL-RECS-DELETED               09199000
092000                 ADD +1 TO PA-TOT-RECS-DELETED                    09200000
092010                                                                  09201000
092020             WHEN SQLCODE = +100                                  09202000
092030                 CONTINUE                                         09203000
092040                                                                  09204000
092050             WHEN SQLWARN0 NOT EQUAL SPACE                        09205000
092060             WHEN SQLCODE NOT EQUAL ZERO                          09206000
092070                 DISPLAY '**************************************' 09207000
092080                 DISPLAY '** ABEND                            **' 09208000
092090                 DISPLAY '** PROGRAM = TRKUP215               **' 09209000
092100                 DISPLAY '** PARAGRAPH =                      **' 09210000
092110                 DISPLAY '**        7198-DELETE-SEAL-CHG      **' 09211000
092120                 DISPLAY '** DELETE TRT_IMPRT_SEAL            **' 09212000
092130                 DISPLAY '** CONTNR ID    =' IMCNTK-CONTNR-ID     09213000
092140                 DISPLAY '** CONTNR SEQ   =' IMCNTK-CONTNR-SEQ-NBR09214000
092150                 DISPLAY '** SEAL NUMBER  =' TRT00006-SEAL-NBR    09215000
092160                 DISPLAY '**************************************' 09216000
092170                 PERFORM 9100-SQL-ABEND                           09217000
092180         END-EVALUATE                                             09218000
092190     END-PERFORM.                                                 09219000
092200                                                                  09220000
092210     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09221000
092220         (SQLCODE NOT = ZERO AND                                  09222000
092230          SQLCODE NOT = +100)                                     09223000
092240         DISPLAY '****************************************'       09224000
092250         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09225000
092260         DISPLAY '** DELETE FROM TRT_IMPRT_SEAL         **'       09226000
092270         DISPLAY '** PARAGRAPH = 7198-DELETE-SEAL-CHG   **'       09227000
092280         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            09228000
092290         DISPLAY '** CONTNR SEQ   = ' IMCNTK-CONTNR-SEQ-NBR       09229000
092300         DISPLAY '** SEAL NUMBER  = ' TRT00006-SEAL-NBR           09230000
092310         DISPLAY '****************************************'       09231000
092320         PERFORM 9100-SQL-ABEND                                   09232000
092330     END-IF.                                                      09233000
092340                                                                  09234000
092350 EJECT                                                            09235000
092360******************************************************************09236000
092370* INSERT ROW INTO TRTW_CONTNR_RUL, THE DB2 WORK TABLE FOR THE    *09237000
092380* ERROR AND DETAIL RULE EXTRACT.                                 *09238000
092390******************************************************************09239000
092400 7199-INSERT-LOAD-RULE-TABLE.                                     09240000
092410                                                                  09241000
092420     PERFORM                                                      09242000
092430         WITH TEST AFTER                                          09243000
092440         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09244000
092450         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09245000
092460                 SQLCODE = ZERO                                   09246000
092470                                                                  09247000
092480         EXEC SQL                                                 09248000
092490              INSERT INTO TRTW_CONTNR_RUL                         09249000
092500                  (RUL_REC_1_TXT,                                 09250000
092510                   RUL_REC_2_TXT)                                 09251000
092520                 VALUES  (:TRT00033-RUL-REC-1-TXT,                09252000
092530                          :TRT00033-RUL-REC-2-TXT)                09253000
092540         END-EXEC                                                 09254000
092550                                                                  09255000
092560         EVALUATE TRUE                                            09256000
092570                                                                  09257000
092580             WHEN SQLCODE = ZERO                                  09258000
092590                 ADD +1 TO PA-TOTAL-RULE-COUNT                    09259000
092600                                                                  09260000
092610             WHEN SQLWARN0 NOT EQUAL SPACE                        09261000
092620             WHEN SQLCODE NOT EQUAL ZERO                          09262000
092630                 DISPLAY '**************************************' 09263000
092640                 DISPLAY '** ABEND                            **' 09264000
092650                 DISPLAY '** PROGRAM = TRKUP215               **' 09265000
092660                 DISPLAY '** PARAGRAPH = 7199-INSERT-LOAD-    **' 09266000
092670                 DISPLAY '**                  RULE-TABLE      **' 09267000
092680                 DISPLAY '** INSERT TRTW_CONTNR_RUL           **' 09268000
092690                 DISPLAY '** TRT00033-RECORD = '                  09269000
092700                 DISPLAY '*'           TRT00033-RUL-REC-1-TXT     09270000
092710                 DISPLAY '**************************************' 09271000
092720                 PERFORM 9100-SQL-ABEND                           09272000
092730         END-EVALUATE                                             09273000
092740     END-PERFORM.                                                 09274000
092750                                                                  09275000
092760     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09276000
092770         SQLCODE NOT = ZERO                                       09277000
092780         DISPLAY '****************************************'       09278000
092790         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09279000
092800         DISPLAY '** INSERT INTO TRTW_CONTNR_RUL        **'       09280000
092810         DISPLAY '** PARAGRAPH = 7199-INSERT-LOAD-RULE-TABLE'     09281000
092820         DISPLAY '** TRT00033-RECORD = '                          09282000
092830         DISPLAY '*'           TRT00033-RUL-REC-1-TXT             09283000
092840         DISPLAY '****************************************'       09284000
092850         PERFORM 9100-SQL-ABEND                                   09285000
092860     END-IF.                                                      09286000
092870                                                                  09287000
092880 EJECT                                                            09288000
092890******************************************************************09289000
092900* INSERT ROW INTO TOUTTR5, THE DB2 WORK TABLE FOR THE ERROR      *09290000
092910* AND DETAIL REPORTS EXTRACT.                                    *09291000
092920******************************************************************09292000
092930 7200-INSERT-LOAD-RPT-TABLE.                                      09293000
092940                                                                  09294000
092950     PERFORM                                                      09295000
092960         WITH TEST AFTER                                          09296000
092970         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09297000
092980         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09298000
092990                 SQLCODE = ZERO                                   09299000
093000                                                                  09300000
093010         EXEC SQL                                                 09301000
093020              INSERT INTO TOUTTR5                                 09302000
093030                  (CONTNR_RPTS_1_ODR,                             09303000
093040                   CONTNR_RPTS_2_ODR)                             09304000
093050                 VALUES  (:OUTTR5-CONTNR-RPTS-1-ODR,              09305000
093060                          :OUTTR5-CONTNR-RPTS-2-ODR)              09306000
093070         END-EXEC                                                 09307000
093080                                                                  09308000
093090         EVALUATE TRUE                                            09309000
093100             WHEN SQLCODE = ZERO                                  09310000
093110                 ADD +1 TO PA-TOTAL-REPORT-COUNT                  09311000
093120                                                                  09312000
093130             WHEN SQLWARN0 NOT EQUAL SPACE                        09313000
093140             WHEN SQLCODE NOT EQUAL ZERO                          09314000
093150                 DISPLAY '**************************************' 09315000
093160                 DISPLAY '** ABEND                            **' 09316000
093170                 DISPLAY '** PROGRAM = TRKUP215               **' 09317000
093180                 DISPLAY '** PARAGRAPH = 7200-INSERT-LOAD-    **' 09318000
093190                 DISPLAY '**                  RPT-TABLE       **' 09319000
093200                 DISPLAY '** INSERT TOUTTR5                   **' 09320000
093210                 DISPLAY '** OUTTR5-RECORD  = '                   09321000
093220                 DISPLAY '*'           OUTTR5-CONTNR-RPTS-1-ODR   09322000
093230                 DISPLAY '**************************************' 09323000
093240                 PERFORM 9100-SQL-ABEND                           09324000
093250         END-EVALUATE                                             09325000
093260     END-PERFORM.                                                 09326000
093270                                                                  09327000
093280     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09328000
093290         SQLCODE NOT = ZERO                                       09329000
093300         DISPLAY '****************************************'       09330000
093310         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09331000
093320         DISPLAY '** INSERT INTO TOUTTR5                **'       09332000
093330         DISPLAY '** PARAGRAPH = 7200-INSERT-LOAD-RPT-TABLE'      09333000
093340         DISPLAY '** OUTTR5-RECORD  = ' OUTTR5-CONTNR-RPTS-1-ODR  09334000
093350         DISPLAY '****************************************'       09335000
093360         PERFORM 9100-SQL-ABEND                                   09336000
093370     END-IF.                                                      09337000
093380                                                                  09338000
093390 EJECT                                                            09339000
093400******************************************************************09340000
093410* SELECT A ROW FROM THE CONTAINER CARTON TABLE (TRT_IMPRT_CART)  *09341000
093420******************************************************************09342000
093430 7210-SELECT-CARTON.                                              09343000
093440                                                                  09344000
093450     PERFORM                                                      09345000
093460         WITH TEST AFTER                                          09346000
093470         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09347000
093480         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09348000
093490                 SQLCODE = ZERO                     OR            09349000
093500                 SQLCODE = +100                                   09350000
093510                                                                  09351000
093520         EXEC SQL                                                 09352000
093530             SELECT CONTNR_ID,                                    09353000
093540                    CONTNR_SEQ_NBR,                               09354000
093550                    PO_NBR,                                       09355000
093560                    UPC_NBR,                                      09356000
093570                    SSCC_ID,                                      09357000
093580                    CRE_BY_USR_ID,                                09358000
093590                    CRE_TMST,                                     09359000
093600                    UNT_QTY,                                      09360000
093610                    LAST_UPD_BY_USR_ID,                           09361000
093620                    LAST_UPD_TMST                                 09362000
093630              INTO :TRT00008-CONTNR-ID,                           09363000
093640                   :TRT00008-CONTNR-SEQ-NBR,                      09364000
093650                   :TRT00008-PO-NBR,                              09365000
093660                   :TRT00008-UPC-NBR,                             09366000
093670                   :TRT00008-SSCC-ID,                             09367000
093680                   :TRT00008-CRE-BY-USR-ID,                       09368000
093690                   :TRT00008-CRE-TMST,                            09369000
093700                   :TRT00008-UNT-QTY,                             09370000
093710                   :TRT00008-LAST-UPD-BY-USR-ID,                  09371000
093720                   :TRT00008-LAST-UPD-TMST                        09372000
093730                                                                  09373000
093740               FROM TRT_IMPRT_CART                                09374000
093750              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          09375000
093760                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     09376000
093770                AND PO_NBR           = :PV-HOLD-PO-NBR            09377000
093780                AND UPC_NBR          = :PV-HOLD-UPC-NBR           09378000
093790                AND SSCC_ID          = :TR023-CNCART-SSCC-NBR     09379000
093800              WITH UR                                             09380000
093810         END-EXEC                                                 09381000
093820                                                                  09382000
093830         EVALUATE TRUE                                            09383000
093840             WHEN SQLCODE = ZERO                                  09384000
093850                 SET PS-CNCT-FOUND TO TRUE                        09385000
093860                 ADD +1 TO PA-TOT-CNCT-RECS-SELECT                09386000
093870                 ADD +1 TO PA-TOT-RECS-SELECTED                   09387000
093880                                                                  09388000
093890             WHEN SQLCODE = +100                                  09389000
093900                 SET PS-CNCT-NOT-FOUND TO TRUE                    09390000
093910                                                                  09391000
093920             WHEN SQLWARN0 NOT EQUAL SPACE                        09392000
093930             WHEN SQLCODE NOT EQUAL ZERO                          09393000
093940                 DISPLAY '**************************************' 09394000
093950                 DISPLAY '** ABEND                            **' 09395000
093960                 DISPLAY '** PROGRAM = TRKUP215               **' 09396000
093970                 DISPLAY '** PARAGRAPH = 7210-SELECT-CARTON   **' 09397000
093980                 DISPLAY '** SELECT TRT_IMPRT_CART            **' 09398000
093990                 DISPLAY '** CONTNR ID = ' TR023-CNCART-CONTNR-ID 09399000
094000                 DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR       09400000
094010                 DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR      09401000
094020                 DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR     09402000
094030                 DISPLAY '**************************************' 09403000
094040                 PERFORM 9100-SQL-ABEND                           09404000
094050         END-EVALUATE                                             09405000
094060     END-PERFORM.                                                 09406000
094070                                                                  09407000
094080     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09408000
094090         (SQLCODE NOT = ZERO AND                                  09409000
094100             SQLCODE NOT = +100)                                  09410000
094110         DISPLAY '****************************************'       09411000
094120         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09412000
094130         DISPLAY '** SELECT FROM TRT_IMPRT_CART         **'       09413000
094140         DISPLAY '** PARAGRAPH = 7210-SELECT-CARTON     **'       09414000
094150         DISPLAY '** CONTNR ID       = ' TR023-CNTR-CONTNR-ID     09415000
094160         DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR               09416000
094170         DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR              09417000
094180         DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR             09418000
094190         DISPLAY '**************************************'         09419000
094200         PERFORM 9100-SQL-ABEND                                   09420000
094210                                                                  09421000
094220     END-IF.                                                      09422000
094230                                                                  09423000
094240 EJECT                                                            09424000
094250******************************************************************09425000
094260* SELECT A ROW FROM THE CONTAINER CARTON TABLE (TRT_IMPRT_CART)  *09426000
094270******************************************************************09427000
094280 7215-SELECT-CARTON-DUPLICATES.                                   09428000
094290                                                                  09429000
094300     PERFORM                                                      09430000
094310         WITH TEST AFTER                                          09431000
094320         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09432000
094330         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09433000
094340                 SQLCODE = ZERO                     OR            09434000
094350                 SQLCODE = +100                     OR            09435000
094360                 SQLCODE = -811                                   09436000
094370                                                                  09437000
094380         EXEC SQL                                                 09438000
094390             SELECT CONTNR_ID,                                    09439000
094400                    CONTNR_SEQ_NBR,                               09440000
094410                    PO_NBR,                                       09441000
094420                    UPC_NBR,                                      09442000
094430                    SSCC_ID,                                      09443000
094440                    CRE_BY_USR_ID,                                09444000
094450                    CRE_TMST,                                     09445000
094460                    UNT_QTY,                                      09446000
094470                    LAST_UPD_BY_USR_ID,                           09447000
094480                    LAST_UPD_TMST                                 09448000
094490              INTO :TRT00008-CONTNR-ID,                           09449000
094500                   :TRT00008-CONTNR-SEQ-NBR,                      09450000
094510                   :TRT00008-PO-NBR,                              09451000
094520                   :TRT00008-UPC-NBR,                             09452000
094530                   :TRT00008-SSCC-ID,                             09453000
094540                   :TRT00008-CRE-BY-USR-ID,                       09454000
094550                   :TRT00008-CRE-TMST,                            09455000
094560                   :TRT00008-UNT-QTY,                             09456000
094570                   :TRT00008-LAST-UPD-BY-USR-ID,                  09457000
094580                   :TRT00008-LAST-UPD-TMST                        09458000
094590                                                                  09459000
094600               FROM TRT_IMPRT_CART                                09460000
094610              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          09461000
094620                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     09462000
094630                AND PO_NBR           = :PV-HOLD-PO-NBR            09463000
094640                AND UPC_NBR         ^= :PV-HOLD-UPC-NBR           09464000
094650                AND SSCC_ID          = :PV-HOLD-SSCC-NBR          09465000
094660              WITH UR                                             09466000
094670         END-EXEC                                                 09467000
094680                                                                  09468000
094690         EVALUATE TRUE                                            09469000
094700             WHEN SQLCODE = ZERO                                  09470000
094710             WHEN SQLCODE = -811                                  09471000
094720                 SET PS-CART-DUP-FOUND TO TRUE                    09472000
094730                 ADD +1 TO PA-TOT-CNCT-RECS-SELECT                09473000
094740                 ADD +1 TO PA-TOT-RECS-SELECTED                   09474000
094750                                                                  09475000
094760             WHEN SQLCODE = +100                                  09476000
094770                 SET PS-CART-DUP-NOT-FOUND TO TRUE                09477000
094780                                                                  09478000
094790             WHEN SQLWARN0 NOT EQUAL SPACE                        09479000
094800             WHEN SQLCODE NOT EQUAL ZERO                          09480000
094810                 DISPLAY '**************************************' 09481000
094820                 DISPLAY '** ABEND                            **' 09482000
094830                 DISPLAY '** PROGRAM = TRKUP215               **' 09483000
094840                 DISPLAY '** PARAGRAPH = 7215-SELECT-CARTON-  **' 09484000
094850                 DISPLAY '**             DUPLICATES           **' 09485000
094860                 DISPLAY '** SELECT TRT_IMPRT_CART            **' 09486000
094870                 DISPLAY '** CONTNR ID = ' TR023-CNCART-CONTNR-ID 09487000
094880                 DISPLAY '** CONTNR SEQ NBR = '                   09488000
094890                 DISPLAY                   IMCNTK-CONTNR-SEQ-NBR  09489000
094900                 DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR       09490000
094910                 DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR      09491000
094920                 DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR     09492000
094930                 DISPLAY '**************************************' 09493000
094940                 PERFORM 9100-SQL-ABEND                           09494000
094950         END-EVALUATE                                             09495000
094960     END-PERFORM.                                                 09496000
094970                                                                  09497000
094980     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09498000
094990         (SQLCODE NOT = ZERO AND                                  09499000
095000          SQLCODE NOT = +100 AND                                  09500000
095010          SQLCODE NOT = -811)                                     09501000
095020         DISPLAY '****************************************'       09502000
095030         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09503000
095040         DISPLAY '** SELECT FROM TRT_IMPRT_CART         **'       09504000
095050         DISPLAY '** PARAGRAPH = 7215-SELECT-CARTON-    **'       09505000
095060         DISPLAY '**             DUPLICATES             **'       09506000
095070         DISPLAY '** CONTNR ID       = ' TR023-CNTR-CONTNR-ID     09507000
095080         DISPLAY '** CONTNR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR     09508000
095090         DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR               09509000
095100         DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR              09510000
095110         DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR             09511000
095120         DISPLAY '**************************************'         09512000
095130         PERFORM 9100-SQL-ABEND                                   09513000
095140                                                                  09514000
095150     END-IF.                                                      09515000
095160                                                                  09516000
095170 EJECT                                                            09517000
095180******************************************************************09518000
095190* SELECT A ROW FROM THE CONTAINER CARTON TABLE (TRT_IMPRT_CART)_ *09519000
095200******************************************************************09520000
095210 7220-SELECT-CARTON-OLD.                                          09521000
095220                                                                  09522000
095230     PERFORM                                                      09523000
095240         WITH TEST AFTER                                          09524000
095250         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09525000
095260         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09526000
095270                 SQLCODE = ZERO                     OR            09527000
095280                 SQLCODE = +100                                   09528000
095290                                                                  09529000
095300         EXEC SQL                                                 09530000
095310             SELECT CONTNR_ID,                                    09531000
095320                    CONTNR_SEQ_NBR,                               09532000
095330                    PO_NBR,                                       09533000
095340                    UPC_NBR,                                      09534000
095350                    SSCC_ID,                                      09535000
095360                    CRE_BY_USR_ID,                                09536000
095370                    CRE_TMST,                                     09537000
095380                    UNT_QTY,                                      09538000
095390                    LAST_UPD_BY_USR_ID,                           09539000
095400                    LAST_UPD_TMST                                 09540000
095410              INTO :TRT00008-CONTNR-ID,                           09541000
095420                   :TRT00008-CONTNR-SEQ-NBR,                      09542000
095430                   :TRT00008-PO-NBR,                              09543000
095440                   :TRT00008-UPC-NBR,                             09544000
095450                   :TRT00008-SSCC-ID,                             09545000
095460                   :TRT00008-CRE-BY-USR-ID,                       09546000
095470                   :TRT00008-CRE-TMST,                            09547000
095480                   :TRT00008-UNT-QTY,                             09548000
095490                   :TRT00008-LAST-UPD-BY-USR-ID,                  09549000
095500                   :TRT00008-LAST-UPD-TMST                        09550000
095510                                                                  09551000
095520               FROM TRT_IMPRT_CART                                09552000
095530              WHERE CONTNR_ID        = :PV-HOLD-CONTNR-ID         09553000
095540                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    09554000
095550                AND PO_NBR           = :PV-HOLD-PO-NBR            09555000
095560                AND UPC_NBR          = :PV-HOLD-UPC-NBR           09556000
095570                AND SSCC_ID          = :PV-HOLD-SSCC-NBR          09557000
095580              WITH UR                                             09558000
095590         END-EXEC                                                 09559000
095600                                                                  09560000
095610         EVALUATE TRUE                                            09561000
095620             WHEN SQLCODE = ZERO                                  09562000
095630                 SET PS-CNCT-OLD-FOUND TO TRUE                    09563000
095640                 ADD +1 TO PA-TOT-CNCT-RECS-SELECT                09564000
095650                 ADD +1 TO PA-TOT-RECS-SELECTED                   09565000
095660                                                                  09566000
095670             WHEN SQLCODE = +100                                  09567000
095680                 SET PS-CNCT-OLD-NOT-FOUND TO TRUE                09568000
095690                                                                  09569000
095700             WHEN SQLWARN0 NOT EQUAL SPACE                        09570000
095710             WHEN SQLCODE NOT EQUAL ZERO                          09571000
095720                 DISPLAY '**************************************' 09572000
095730                 DISPLAY '** ABEND                            **' 09573000
095740                 DISPLAY '** PROGRAM = TRKUP215               **' 09574000
095750                 DISPLAY '** PARAGRAPH = 7220-SELECT-CARTON-OLD*' 09575000
095760                 DISPLAY '** SELECT TRT_IMPRT_CART            **' 09576000
095770                 DISPLAY '** CONTNR ID   = ' PV-HOLD-CONTNR-ID    09577000
095780                 DISPLAY '** CONTNR SEQ NBR = '                   09578000
095790                 DISPLAY             PV-HOLD-CONTNR-SEQ-NBR       09579000
095800                 DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR       09580000
095810                 DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR      09581000
095820                 DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR     09582000
095830                 DISPLAY '**************************************' 09583000
095840                 PERFORM 9100-SQL-ABEND                           09584000
095850         END-EVALUATE                                             09585000
095860     END-PERFORM.                                                 09586000
095870                                                                  09587000
095880     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09588000
095890         (SQLCODE NOT = ZERO AND                                  09589000
095900             SQLCODE NOT = +100)                                  09590000
095910         DISPLAY '****************************************'       09591000
095920         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09592000
095930         DISPLAY '** SELECT FROM TRT_IMPRT_CART         **'       09593000
095940         DISPLAY '** PARAGRAPH = 7220-SELECT-CARTON-OLD **'       09594000
095950         DISPLAY '** CONTNR ID   = ' PV-HOLD-CONTNR-ID            09595000
095960         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    09596000
095970         DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR               09597000
095980         DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR              09598000
095990         DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR             09599000
096000         DISPLAY '**************************************'         09600000
096010         PERFORM 9100-SQL-ABEND                                   09601000
096020     END-IF.                                                      09602000
096030                                                                  09603000
096040 EJECT                                                            09604000
096050******************************************************************09605000
096060* SELECT A ROW FROM THE CONTAINER CARTON TABLE (TRT_IMPRT_CART). *09606000
096070******************************************************************09607000
096080 7225-SELECT-CARTON-CHG.                                          09608000
096090                                                                  09609000
096100     PERFORM                                                      09610000
096110         WITH TEST AFTER                                          09611000
096120         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09612000
096130         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09613000
096140                 SQLCODE = ZERO                     OR            09614000
096150                 SQLCODE = +100                                   09615000
096160                                                                  09616000
096170         EXEC SQL                                                 09617000
096180             SELECT CONTNR_ID,                                    09618000
096190                    CONTNR_SEQ_NBR,                               09619000
096200                    PO_NBR,                                       09620000
096210                    UPC_NBR,                                      09621000
096220                    SSCC_ID,                                      09622000
096230                    CRE_BY_USR_ID,                                09623000
096240                    CRE_TMST,                                     09624000
096250                    UNT_QTY,                                      09625000
096260                    LAST_UPD_BY_USR_ID,                           09626000
096270                    LAST_UPD_TMST                                 09627000
096280              INTO :TRT00008-CONTNR-ID,                           09628000
096290                   :TRT00008-CONTNR-SEQ-NBR,                      09629000
096300                   :TRT00008-PO-NBR,                              09630000
096310                   :TRT00008-UPC-NBR,                             09631000
096320                   :TRT00008-SSCC-ID,                             09632000
096330                   :TRT00008-CRE-BY-USR-ID,                       09633000
096340                   :TRT00008-CRE-TMST,                            09634000
096350                   :TRT00008-UNT-QTY,                             09635000
096360                   :TRT00008-LAST-UPD-BY-USR-ID,                  09636000
096370                   :TRT00008-LAST-UPD-TMST                        09637000
096380                                                                  09638000
096390               FROM TRT_IMPRT_CART                                09639000
096400              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          09640000
096410                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     09641000
096420                AND PO_NBR           = :TRT00008-PO-NBR           09642000
096430                AND UPC_NBR          = :TRT00008-UPC-NBR          09643000
096440                AND SSCC_ID          = :TRT00008-SSCC-ID          09644000
096450              WITH UR                                             09645000
096460         END-EXEC                                                 09646000
096470                                                                  09647000
096480         EVALUATE TRUE                                            09648000
096490             WHEN SQLCODE = ZERO                                  09649000
096500                 SET PS-CNCT-DELETE-E-FOUND TO TRUE               09650000
096510                 ADD +1 TO PA-TOT-CNCT-RECS-SELECT                09651000
096520                 ADD +1 TO PA-TOT-RECS-SELECTED                   09652000
096530                                                                  09653000
096540             WHEN SQLCODE = +100                                  09654000
096550                 SET PS-CNCT-DELETE-E-NOT-FOUND TO TRUE           09655000
096560                                                                  09656000
096570             WHEN SQLWARN0 NOT EQUAL SPACE                        09657000
096580             WHEN SQLCODE NOT EQUAL ZERO                          09658000
096590                 DISPLAY '**************************************' 09659000
096600                 DISPLAY '** ABEND                            **' 09660000
096610                 DISPLAY '** PROGRAM = TRKUP215               **' 09661000
096620                 DISPLAY '** PARAGRAPH = 7225-SELECT-CARTON-CHG*' 09662000
096630                 DISPLAY '** SELECT TRT_IMPRT_CART            **' 09663000
096640                 DISPLAY '** CONTNR ID = ' TR023-CNCART-CONTNR-ID 09664000
096650                 DISPLAY '** CONTNR SEQ NBR = '                   09665000
096660                 DISPLAY             IMCNTK-CONTNR-SEQ-NBR        09666000
096670                 DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR       09667000
096680                 DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR      09668000
096690                 DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR     09669000
096700                 DISPLAY '**************************************' 09670000
096710                 PERFORM 9100-SQL-ABEND                           09671000
096720         END-EVALUATE                                             09672000
096730     END-PERFORM.                                                 09673000
096740                                                                  09674000
096750     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09675000
096760         (SQLCODE NOT = ZERO AND                                  09676000
096770             SQLCODE NOT = +100)                                  09677000
096780         DISPLAY '****************************************'       09678000
096790         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09679000
096800         DISPLAY '** SELECT FROM TRT_IMPRT_CART         **'       09680000
096810         DISPLAY '** PARAGRAPH = 7225-SELECT-CARTON-CHG **'       09681000
096820         DISPLAY '** CONTNR ID       = ' TR023-CNTR-CONTNR-ID     09682000
096830         DISPLAY '** CONTNR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR     09683000
096840         DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR               09684000
096850         DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR              09685000
096860         DISPLAY '** SSCC NUMBER = ' PV-HOLD-SSCC-NBR             09686000
096870         DISPLAY '**************************************'         09687000
096880         PERFORM 9100-SQL-ABEND                                   09688000
096890                                                                  09689000
096900     END-IF.                                                      09690000
096910                                                                  09691000
096920 EJECT                                                            09692000
096930******************************************************************09693000
096940* SELECT A ROW FROM THE CONTAINER SEAL TABLE (TRT_IMPRT_SEAL)    *09694000
096950******************************************************************09695000
096960 7230-SELECT-SEAL.                                                09696000
096970                                                                  09697000
096980     PERFORM                                                      09698000
096990         WITH TEST AFTER                                          09699000
097000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09700000
097010         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09701000
097020                 SQLCODE = ZERO                     OR            09702000
097030                 SQLCODE = +100                                   09703000
097040                                                                  09704000
097050         EXEC SQL                                                 09705000
097060             SELECT CONTNR_ID,                                    09706000
097070                    CONTNR_SEQ_NBR,                               09707000
097080                    SEAL_NBR,                                     09708000
097090                    CRE_TMST,                                     09709000
097100                    CRE_BY_USR_ID,                                09710000
097110                    LAST_UPD_TMST,                                09711000
097120                    LAST_UPD_BY_USR_ID                            09712000
097130              INTO :TRT00006-CONTNR-ID,                           09713000
097140                   :TRT00006-CONTNR-SEQ-NBR,                      09714000
097150                   :TRT00006-SEAL-NBR,                            09715000
097160                   :TRT00006-CRE-TMST,                            09716000
097170                   :TRT00006-CRE-BY-USR-ID,                       09717000
097180                   :TRT00006-LAST-UPD-TMST,                       09718000
097190                   :TRT00006-LAST-UPD-BY-USR-ID                   09719000
097200                                                                  09720000
097210               FROM TRT_IMPRT_SEAL                                09721000
097220              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          09722000
097230                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     09723000
097240                AND SEAL_NBR         = :PV-HOLD-SEAL-NBR          09724000
097250              WITH UR                                             09725000
097260         END-EXEC                                                 09726000
097270                                                                  09727000
097280         EVALUATE TRUE                                            09728000
097290             WHEN SQLCODE = ZERO                                  09729000
097300                 SET PS-CNSL-FOUND TO TRUE                        09730000
097310                 ADD +1 TO PA-TOT-CNSL-RECS-SELECT                09731000
097320                 ADD +1 TO PA-TOT-RECS-SELECTED                   09732000
097330                                                                  09733000
097340             WHEN SQLCODE = +100                                  09734000
097350                 SET PS-CNSL-NOT-FOUND TO TRUE                    09735000
097360                                                                  09736000
097370             WHEN SQLWARN0 NOT EQUAL SPACE                        09737000
097380             WHEN SQLCODE NOT EQUAL ZERO                          09738000
097390                 DISPLAY '**************************************' 09739000
097400                 DISPLAY '** ABEND                            **' 09740000
097410                 DISPLAY '** PROGRAM = TRKUP215               **' 09741000
097420                 DISPLAY '** PARAGRAPH = 7230-SELECT-SEAL     **' 09742000
097430                 DISPLAY '** SELECT TRT_IMPRT_SEAL            **' 09743000
097440                 DISPLAY '** CONTNR ID = ' TR023-CNSEAL-CONTNR-ID 09744000
097450                 DISPLAY '** CONTNR SEQ NBR = '                   09745000
097460                 DISPLAY              IMCNTK-CONTNR-SEQ-NBR       09746000
097470                 DISPLAY '** SEAL NUMBER = ' PV-HOLD-SEAL-NBR     09747000
097480                 DISPLAY '**************************************' 09748000
097490                 PERFORM 9100-SQL-ABEND                           09749000
097500         END-EVALUATE                                             09750000
097510     END-PERFORM.                                                 09751000
097520                                                                  09752000
097530     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09753000
097540         (SQLCODE NOT = ZERO AND                                  09754000
097550             SQLCODE NOT = +100)                                  09755000
097560         DISPLAY '****************************************'       09756000
097570         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09757000
097580         DISPLAY '** SELECT FROM TRT_IMPRT_SEAL         **'       09758000
097590         DISPLAY '** PARAGRAPH = 7230-SELECT-SEAL       **'       09759000
097600         DISPLAY '** CONTNR ID       = ' TR023-CNTR-CONTNR-ID     09760000
097610         DISPLAY '** CONTNR SEQ NBR  = ' IMCNTK-CONTNR-SEQ-NBR    09761000
097620         DISPLAY '** SEAL NUMBER = ' PV-HOLD-SEAL-NBR             09762000
097630         DISPLAY '**************************************'         09763000
097640         PERFORM 9100-SQL-ABEND                                   09764000
097650                                                                  09765000
097660     END-IF.                                                      09766000
097670                                                                  09767000
097680 EJECT                                                            09768000
097690******************************************************************09769000
097700* SELECT A ROW FROM THE CONTAINER SEAL TABLE (TRT_IMPRT_SEAL)    *09770000
097710******************************************************************09771000
097720 7235-SELECT-SEAL-OLD.                                            09772000
097730                                                                  09773000
097740     PERFORM                                                      09774000
097750         WITH TEST AFTER                                          09775000
097760         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09776000
097770         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09777000
097780                 SQLCODE = ZERO                     OR            09778000
097790                 SQLCODE = +100                                   09779000
097800                                                                  09780000
097810         EXEC SQL                                                 09781000
097820             SELECT CONTNR_ID,                                    09782000
097830                    CONTNR_SEQ_NBR,                               09783000
097840                    SEAL_NBR,                                     09784000
097850                    CRE_TMST,                                     09785000
097860                    CRE_BY_USR_ID,                                09786000
097870                    LAST_UPD_TMST,                                09787000
097880                    LAST_UPD_BY_USR_ID                            09788000
097890              INTO :TRT00006-CONTNR-ID,                           09789000
097900                   :TRT00006-CONTNR-SEQ-NBR,                      09790000
097910                   :TRT00006-SEAL-NBR,                            09791000
097920                   :TRT00006-CRE-TMST,                            09792000
097930                   :TRT00006-CRE-BY-USR-ID,                       09793000
097940                   :TRT00006-LAST-UPD-TMST,                       09794000
097950                   :TRT00006-LAST-UPD-BY-USR-ID                   09795000
097960                                                                  09796000
097970               FROM TRT_IMPRT_SEAL                                09797000
097980              WHERE CONTNR_ID        = :PV-HOLD-CONTNR-ID         09798000
097990                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    09799000
098000                AND SEAL_NBR         = :PV-HOLD-SEAL-NBR          09800000
098010              WITH UR                                             09801000
098020         END-EXEC                                                 09802000
098030                                                                  09803000
098040         EVALUATE TRUE                                            09804000
098050             WHEN SQLCODE = ZERO                                  09805000
098060                 SET PS-CNSL-OLD-FOUND TO TRUE                    09806000
098070                 ADD +1 TO PA-TOT-CNSL-RECS-SELECT                09807000
098080                 ADD +1 TO PA-TOT-RECS-SELECTED                   09808000
098090                                                                  09809000
098100             WHEN SQLCODE = +100                                  09810000
098110                 SET PS-CNSL-OLD-NOT-FOUND TO TRUE                09811000
098120                                                                  09812000
098130             WHEN SQLWARN0 NOT EQUAL SPACE                        09813000
098140             WHEN SQLCODE NOT EQUAL ZERO                          09814000
098150                 DISPLAY '**************************************' 09815000
098160                 DISPLAY '** ABEND                            **' 09816000
098170                 DISPLAY '** PROGRAM = TRKUP215               **' 09817000
098180                 DISPLAY '** PARAGRAPH = 7235-SELECT-SEAL-OLD **' 09818000
098190                 DISPLAY '** SELECT TRT_IMPRT_SEAL            **' 09819000
098200                 DISPLAY '** CONTNR ID   = ' PV-HOLD-CONTNR-ID    09820000
098210                 DISPLAY '** CONTNR SEQ NBR = '                   09821000
098220                 DISPLAY             PV-HOLD-CONTNR-SEQ-NBR       09822000
098230                 DISPLAY '** SEAL NUMBER = ' PV-HOLD-SEAL-NBR     09823000
098240                 DISPLAY '**************************************' 09824000
098250                 PERFORM 9100-SQL-ABEND                           09825000
098260         END-EVALUATE                                             09826000
098270     END-PERFORM.                                                 09827000
098280                                                                  09828000
098290     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09829000
098300         (SQLCODE NOT = ZERO AND                                  09830000
098310             SQLCODE NOT = +100)                                  09831000
098320         DISPLAY '****************************************'       09832000
098330         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09833000
098340         DISPLAY '** SELECT FROM TRT_IMPRT_SEAL         **'       09834000
098350         DISPLAY '** PARAGRAPH = 7235-SELECT-SEAL-OLD   **'       09835000
098360         DISPLAY '** CONTNR ID   = ' PV-HOLD-CONTNR-ID            09836000
098370         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    09837000
098380         DISPLAY '** SEAL NUMBER = ' PV-HOLD-SEAL-NBR             09838000
098390         DISPLAY '**************************************'         09839000
098400         PERFORM 9100-SQL-ABEND                                   09840000
098410     END-IF.                                                      09841000
098420                                                                  09842000
098430 EJECT                                                            09843000
098440******************************************************************09844000
098450* SELECT A ROW FROM THE CONTAINER SEAL TABLE (TRT_IMPRT_SEAL).   *09845000
098460******************************************************************09846000
098470 7240-SELECT-SEAL-CHG.                                            09847000
098480                                                                  09848000
098490     PERFORM                                                      09849000
098500         WITH TEST AFTER                                          09850000
098510         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09851000
098520         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09852000
098530                 SQLCODE = ZERO                     OR            09853000
098540                 SQLCODE = +100                                   09854000
098550                                                                  09855000
098560         EXEC SQL                                                 09856000
098570             SELECT CONTNR_ID,                                    09857000
098580                    CONTNR_SEQ_NBR,                               09858000
098590                    SEAL_NBR,                                     09859000
098600                    CRE_TMST,                                     09860000
098610                    CRE_BY_USR_ID,                                09861000
098620                    LAST_UPD_TMST,                                09862000
098630                    LAST_UPD_BY_USR_ID                            09863000
098640              INTO :TRT00006-CONTNR-ID,                           09864000
098650                   :TRT00006-CONTNR-SEQ-NBR,                      09865000
098660                   :TRT00006-SEAL-NBR,                            09866000
098670                   :TRT00006-CRE-TMST,                            09867000
098680                   :TRT00006-CRE-BY-USR-ID,                       09868000
098690                   :TRT00006-LAST-UPD-TMST,                       09869000
098700                   :TRT00006-LAST-UPD-BY-USR-ID                   09870000
098710                                                                  09871000
098720               FROM TRT_IMPRT_SEAL                                09872000
098730              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          09873000
098740                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     09874000
098750                AND SEAL_NBR         = :PV-CURSOR-SEAL-NBR        09875000
098760              WITH UR                                             09876000
098770         END-EXEC                                                 09877000
098780                                                                  09878000
098790         EVALUATE TRUE                                            09879000
098800             WHEN SQLCODE = ZERO                                  09880000
098810                 SET PS-CNSL-FOUND TO TRUE                        09881000
098820                 ADD +1 TO PA-TOT-CNSL-RECS-SELECT                09882000
098830                 ADD +1 TO PA-TOT-RECS-SELECTED                   09883000
098840                                                                  09884000
098850             WHEN SQLCODE = +100                                  09885000
098860                 SET PS-CNSL-NOT-FOUND TO TRUE                    09886000
098870                                                                  09887000
098880             WHEN SQLWARN0 NOT EQUAL SPACE                        09888000
098890             WHEN SQLCODE NOT EQUAL ZERO                          09889000
098900                 DISPLAY '**************************************' 09890000
098910                 DISPLAY '** ABEND                            **' 09891000
098920                 DISPLAY '** PROGRAM = TRKUP215               **' 09892000
098930                 DISPLAY '** PARAGRAPH = 7240-SELECT-SEAL-CHG **' 09893000
098940                 DISPLAY '** SELECT TRT_IMPRT_SEAL            **' 09894000
098950                 DISPLAY '** CONTNR ID = ' TR023-CNSEAL-CONTNR-ID 09895000
098960                 DISPLAY '** CONTNR SEQ NBR = '                   09896000
098970                 DISPLAY             IMCNTK-CONTNR-SEQ-NBR        09897000
098980                 DISPLAY '** SEAL NUMBER = ' PV-HOLD-SEAL-NBR     09898000
098990                 DISPLAY '**************************************' 09899000
099000                 PERFORM 9100-SQL-ABEND                           09900000
099010         END-EVALUATE                                             09901000
099020     END-PERFORM.                                                 09902000
099030                                                                  09903000
099040     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09904000
099050         (SQLCODE NOT = ZERO AND                                  09905000
099060             SQLCODE NOT = +100)                                  09906000
099070         DISPLAY '****************************************'       09907000
099080         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09908000
099090         DISPLAY '** SELECT FROM TRT_IMPRT_SEAL         **'       09909000
099100         DISPLAY '** PARAGRAPH = 7240-SELECT-SEAL-CHG   **'       09910000
099110         DISPLAY '** CONTNR ID       = ' TR023-CNTR-CONTNR-ID     09911000
099120         DISPLAY '** CONTNR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR     09912000
099130         DISPLAY '** SEAL NUMBER = ' PV-HOLD-SEAL-NBR             09913000
099140         DISPLAY '**************************************'         09914000
099150         PERFORM 9100-SQL-ABEND                                   09915000
099160     END-IF.                                                      09916000
099170                                                                  09917000
099180 EJECT                                                            09918000
099190******************************************************************09919000
099200* SELECT A ROW FROM THE CONTAINER TABLE  (TIMCNTK).              *09920000
099210******************************************************************09921000
099220 7250-SELECT-TIMCNTK.                                             09922000
099230                                                                  09923000
099240     PERFORM                                                      09924000
099250         WITH TEST AFTER                                          09925000
099260         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09926000
099270         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09927000
099280                 SQLCODE = ZERO                     OR            09928000
099290                 SQLCODE = +100                                   09929000
099300                                                                  09930000
099310         EXEC SQL                                                 09931000
099320             SELECT CONTNR_ID,                                    09932000
099330                    CONTNR_SEQ_NBR,                               09933000
099340                    CONSLR_SCAC_ID,                               09934000
099350                    MOM_IMPRT_TRIP_ID,                            09935000
099360                    MOM_DPRTR_TMST,                               09936000
099370                    MOM_POE_DELY_TMST,                            09937000
099380                    MOM_CARR_SCAC_ID,                             09938000
099390                    MOM_FOB_CDE,                                  09939000
099400                    MOM_IMPRT_VEH_NM,                             09940000
099410                    MOM_TRIP_TYP_CDE,                             09941000
099420                    MOM_DEST_POE_CDE,                             09942000
099430                    FDR_IMPRT_TRIP_ID,                            09943000
099440                    FDR_DPRTR_TMST,                               09944000
099450                    FDR_POE_DELY_TMST,                            09945000
099460                    FDR_CARR_SCAC_ID,                             09946000
099470                    FDR_FOB_CDE,                                  09947000
099480                    FDR_IMPRT_VEH_NM,                             09948000
099490                    FDR_TRIP_TYP_CDE,                             09949000
099500                    FDR_DEST_POE_CDE,                             09950000
099510                    SIZE_CDE,                                     09951000
099520                    CART_CNT,                                     09952000
099530                    CBMT_QTY,                                     09953000
099540                    WT_KGRM_QTY,                                  09954000
099550                    UNT_QTY,                                      09955000
099560                    ORGN_SHPD_FR_CDE,                             09956000
099570                    ORGN_SHPD_TO_CDE,                             09957000
099580                    EST_LBD_NM,                                   09958000
099590                    EST_LBD_TMST,                                 09959000
099600                    RISU_DO_RSN_CDE,                              09960000
099610                    BKR_FRGT_RLSE_TMST,                           09961000
099620                    DO_TO_DCONSLR_TMST,                           09962000
099630                    DO_RCVD_TMST,                                 09963000
099640                    CONTNR_PU_TMST,                               09964000
099650                    DAT_SRC_ENT_ID,                               09965000
099660                    CRE_BY_USR_ID,                                09966000
099670                    CRE_TMST,                                     09967000
099680                    LAST_UPD_BY_USR_ID,                           09968000
099690                    LAST_UPD_TMST,                                09969000
099700                    ACTL_POE_DELY_TMST,                           09970000
099710                    ACTL_DEST_POE_CDE,                            09971000
099720                    ACTL_LBD_NM,                                  09972000
099730                    ACTL_LBD_TMST,                                09973000
099740                    DVN_TMST,                                     09974000
099750                    DCONSLR_SCAC_ID,                              09975000
099760                    DCONSLR_RET_TMST,                             09976000
099770                    MOM_POL_CDE,                                  09977000
099780                    FDR_POL_CDE,                                  09978000
099790                    MOM_POR_CDE,                                  09979000
099800                    FDR_POR_CDE,                                  09980000
099810                    MOM_DPRTR_TMST                                09981000
099820              INTO :IMCNTK-CONTNR-ID,                             09982000
099830                   :IMCNTK-CONTNR-SEQ-NBR,                        09983000
099840                   :IMCNTK-CONSLR-SCAC-ID,                        09984000
099850                   :IMCNTK-MOM-IMPRT-TRIP-ID,                     09985000
099860                   :IMCNTK-MOM-DPRTR-TMST,                        09986000
099870                   :IMCNTK-MOM-POE-DELY-TMST,                     09987000
099880                   :IMCNTK-MOM-CARR-SCAC-ID,                      09988000
099890                   :IMCNTK-MOM-FOB-CDE,                           09989000
099900                   :IMCNTK-MOM-IMPRT-VEH-NM,                      09990000
099910                   :IMCNTK-MOM-TRIP-TYP-CDE,                      09991000
099920                   :IMCNTK-MOM-DEST-POE-CDE,                      09992000
099930                   :IMCNTK-FDR-IMPRT-TRIP-ID,                     09993000
099940                   :IMCNTK-FDR-DPRTR-TMST,                        09994000
099950                   :IMCNTK-FDR-POE-DELY-TMST,                     09995000
099960                   :IMCNTK-FDR-CARR-SCAC-ID,                      09996000
099970                   :IMCNTK-FDR-FOB-CDE,                           09997000
099980                   :IMCNTK-FDR-IMPRT-VEH-NM,                      09998000
099990                   :IMCNTK-FDR-TRIP-TYP-CDE,                      09999000
100000                   :IMCNTK-FDR-DEST-POE-CDE,                      10000000
100010                   :IMCNTK-SIZE-CDE,                              10001000
100020                   :IMCNTK-CART-CNT,                              10002000
100030                   :IMCNTK-CBMT-QTY,                              10003000
100040                   :IMCNTK-WT-KGRM-QTY,                           10004000
100050                   :IMCNTK-UNT-QTY,                               10005000
100060                   :IMCNTK-ORGN-SHPD-FR-CDE,                      10006000
100070                   :IMCNTK-ORGN-SHPD-TO-CDE,                      10007000
100080                   :IMCNTK-EST-LBD-NM,                            10008000
100090                   :IMCNTK-EST-LBD-TMST,                          10009000
100100                   :IMCNTK-RISU-DO-RSN-CDE,                       10010000
100110                   :IMCNTK-BKR-FRGT-RLSE-TMST,                    10011000
100120                   :IMCNTK-DO-TO-DCONSLR-TMST,                    10012000
100130                   :IMCNTK-DO-RCVD-TMST,                          10013000
100140                   :IMCNTK-CONTNR-PU-TMST,                        10014000
100150                   :IMCNTK-DAT-SRC-ENT-ID,                        10015000
100160                   :IMCNTK-CRE-BY-USR-ID,                         10016000
100170                   :IMCNTK-CRE-TMST,                              10017000
100180                   :IMCNTK-LAST-UPD-BY-USR-ID,                    10018000
100190                   :IMCNTK-LAST-UPD-TMST,                         10019000
100200                   :IMCNTK-ACTL-POE-DELY-TMST,                    10020000
100210                   :IMCNTK-ACTL-DEST-POE-CDE,                     10021000
100220                   :IMCNTK-ACTL-LBD-NM,                           10022000
100230                   :IMCNTK-ACTL-LBD-TMST,                         10023000
100240                   :IMCNTK-DVN-TMST,                              10024000
100250                   :IMCNTK-DCONSLR-SCAC-ID,                       10025000
100260                   :IMCNTK-DCONSLR-RET-TMST,                      10026000
100270                   :IMCNTK-MOM-POL-CDE,                           10027000
100280                   :IMCNTK-FDR-POL-CDE,                           10028000
100290                   :IMCNTK-MOM-POR-CDE,                           10029000
100300                   :IMCNTK-FDR-POR-CDE,                           10030000
100310                   :IMCNTK-MOM-DPRTR-TMST                         10031000
100320                                                                  10032000
100330               FROM TIMCNTK                                       10033000
100340              WHERE CONTNR_ID        = :TR023-CNTR-CONTNR-ID      10034000
100350                AND MOM_DPRTR_TMST   = :PV-FORMATED-DB2-TMST      10035000
100360              WITH UR                                             10036000
100370         END-EXEC                                                 10037000
100380                                                                  10038000
100390         EVALUATE TRUE                                            10039000
100400             WHEN SQLCODE = ZERO                                  10040000
100410                 SET PS-CNTK-FOUND TO TRUE                        10041000
100420                 ADD +1 TO PA-TOT-CNTK-RECS-SELECT                10042000
100430                 ADD +1 TO PA-TOT-RECS-SELECTED                   10043000
100440                                                                  10044000
100450             WHEN SQLCODE = +100                                  10045000
100460                 SET PS-CNTK-NOT-FOUND TO TRUE                    10046000
100470                                                                  10047000
100480             WHEN SQLWARN0 NOT EQUAL SPACE                        10048000
100490             WHEN SQLCODE NOT EQUAL ZERO                          10049000
100500                 DISPLAY '**************************************' 10050000
100510                 DISPLAY '** ABEND                            **' 10051000
100520                 DISPLAY '** PROGRAM = TRKUP215               **' 10052000
100530                 DISPLAY '** PARAGRAPH = 7250-SELECT-TIMCNTK  **' 10053000
100540                 DISPLAY '** SELECT TIMCNTK                   **' 10054000
100550                 DISPLAY '** CONTNR ID       = '                  10055000
100560                 DISPLAY            TR023-CNTR-CONTNR-ID          10056000
100570                 DISPLAY '** ACTL DPRTR TMST = '                  10057000
100580                 DISPLAY            PV-FORMATED-DB2-TMST          10058000
100590                 DISPLAY '**************************************' 10059000
100600                 PERFORM 9100-SQL-ABEND                           10060000
100610         END-EVALUATE                                             10061000
100620     END-PERFORM.                                                 10062000
100630                                                                  10063000
100640     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10064000
100650         (SQLCODE NOT = ZERO AND                                  10065000
100660             SQLCODE NOT = +100)                                  10066000
100670         DISPLAY '****************************************'       10067000
100680         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10068000
100690         DISPLAY '** SELECT FROM TIMCNTK                **'       10069000
100700         DISPLAY '** PARAGRAPH = 7250-SELECT-TIMCNTK    **'       10070000
100710         DISPLAY '** CONTNR ID       = ' TR023-CNTR-CONTNR-ID     10071000
100720         DISPLAY '** ACTL DPRTR TMST = ' PV-FORMATED-DB2-TMST     10072000
100730         DISPLAY '****************************************'       10073000
100740         PERFORM 9100-SQL-ABEND                                   10074000
100750     END-IF.                                                      10075000
100760                                                                  10076000
100770 EJECT                                                            10077000
100780******************************************************************10078000
100790* SELECT A ROW FROM THE CONTAINER PURCHASE ORDER TABLE (TIMCNPO).*10079000
100800******************************************************************10080000
100810 7255-SELECT-TIMCNPO.                                             10081000
100820                                                                  10082000
100830     PERFORM                                                      10083000
100840         WITH TEST AFTER                                          10084000
100850         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10085000
100860         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            10086000
100870                 SQLCODE = ZERO                     OR            10087000
100880                 SQLCODE = +100                                   10088000
100890                                                                  10089000
100900         EXEC SQL                                                 10090000
100910             SELECT CONTNR_ID,                                    10091000
100920                    CONTNR_SEQ_NBR,                               10092000
100930                    PO_NBR,                                       10093000
100940                    CSTM_ENTR_ID,                                 10094000
100950                    MSTR_BOL_NBR,                                 10095000
100960                    HSE_BOL_NBR,                                  10096000
100970                    LTR_OF_CR_NBR,                                10097000
100980                    PO_RCVD_DELY_TMST,                            10098000
100990                    PO_C_O_PROD_CDE,                              10099000
101000                    PO_CART_CNT,                                  10100000
101010                    PO_CBMT_QTY,                                  10101000
101020                    PO_WT_KGRM_QTY,                               10102000
101030                    PO_UNT_QTY,                                   10103000
101040                    CRE_BY_USR_ID,                                10104000
101050                    CRE_TMST,                                     10105000
101060                    LAST_UPD_BY_USR_ID,                           10106000
101070                    LAST_UPD_TMST,                                10107000
101080                    EXTL_REF_NBR,                                 10108000
101090                    BKR_FRGT_RLSE_CDE,                            10109000
101100                    DO_RCVD_CDE,                                  10110000
101110                    CONTNR_PU_CDE,                                10111000
101120                    ACTL_POE_DELY_CDE,                            10112000
101130                    DVN_CDE,                                      10113000
101140                    DCONSLR_RET_CDE,                              10114000
101150                    SPLT_XMIT_CDE,                                10115000
101160                    DOC_RCVD_ORGN_TMST                            10116000
101170              INTO :IMCNPO-CONTNR-ID,                             10117000
101180                   :IMCNPO-CONTNR-SEQ-NBR,                        10118000
101190                   :IMCNPO-PO-NBR,                                10119000
101200                   :IMCNPO-CSTM-ENTR-ID,                          10120000
101210                   :IMCNPO-MSTR-BOL-NBR,                          10121000
101220                   :IMCNPO-HSE-BOL-NBR,                           10122000
101230                   :IMCNPO-LTR-OF-CR-NBR,                         10123000
101240                   :IMCNPO-PO-RCVD-DELY-TMST,                     10124000
101250                   :IMCNPO-PO-C-O-PROD-CDE,                       10125000
101260                   :IMCNPO-PO-CART-CNT,                           10126000
101270                   :IMCNPO-PO-CBMT-QTY,                           10127000
101280                   :IMCNPO-PO-WT-KGRM-QTY,                        10128000
101290                   :IMCNPO-PO-UNT-QTY,                            10129000
101300                   :IMCNPO-CRE-BY-USR-ID,                         10130000
101310                   :IMCNPO-CRE-TMST,                              10131000
101320                   :IMCNPO-LAST-UPD-BY-USR-ID,                    10132000
101330                   :IMCNPO-LAST-UPD-TMST,                         10133000
101340                   :IMCNPO-EXTL-REF-NBR,                          10134000
101350                   :IMCNPO-BKR-FRGT-RLSE-CDE,                     10135000
101360                   :IMCNPO-DO-RCVD-CDE,                           10136000
101370                   :IMCNPO-CONTNR-PU-CDE,                         10137000
101380                   :IMCNPO-ACTL-POE-DELY-CDE,                     10138000
101390                   :IMCNPO-DVN-CDE,                               10139000
101400                   :IMCNPO-DCONSLR-RET-CDE,                       10140000
101410                   :IMCNPO-SPLT-XMIT-CDE,                         10141000
101420                   :IMCNPO-DOC-RCVD-ORGN-TMST                     10142000
101430               FROM TIMCNPO                                       10143000
101440              WHERE CONTNR_ID        = :TR023-CONPO-CONTNR-ID     10144000
101450                AND PO_NBR           = :PV-HOLD-PO-NBR            10145000
101460                AND EXTL_REF_NBR     =                            10146000
101470                                    :PV-HOLD-CONPO-EXTL-REF-NBR   10147000
101480              WITH UR                                             10148000
101490         END-EXEC                                                 10149000
101500                                                                  10150000
101510         EVALUATE TRUE                                            10151000
101520             WHEN SQLCODE = ZERO                                  10152000
101530                 SET PS-CNPO-FOUND TO TRUE                        10153000
101540                 ADD +1 TO PA-TOT-CNPO-RECS-SELECT                10154000
101550                 ADD +1 TO PA-TOT-RECS-SELECTED                   10155000
101560                                                                  10156000
101570             WHEN SQLCODE = +100                                  10157000
101580                 SET PS-CNPO-NOT-FOUND TO TRUE                    10158000
101590                                                                  10159000
101600             WHEN SQLWARN0 NOT EQUAL SPACE                        10160000
101610             WHEN SQLCODE NOT EQUAL ZERO                          10161000
101620                 DISPLAY '**************************************' 10162000
101630                 DISPLAY '** ABEND                            **' 10163000
101640                 DISPLAY '** PROGRAM = TRKUP215               **' 10164000
101650                 DISPLAY '** PARAGRAPH = 7255-SELECT-TIMCNPO  **' 10165000
101660                 DISPLAY '** SELECT TIMCNPO                   **' 10166000
101670                 DISPLAY '** CONTNR ID       = '                  10167000
101680                 DISPLAY            TR023-CONPO-CONTNR-ID         10168000
101690                 DISPLAY '** PO NUMBER       = '                  10169000
101700                 DISPLAY            PV-HOLD-PO-NBR                10170000
101710                 DISPLAY '** EXTL REF NBR    = '                  10171000
101720                 DISPLAY            TR023-CONPO-EXTL-REF-NBR      10172000
101730                 DISPLAY '**************************************' 10173000
101740                 PERFORM 9100-SQL-ABEND                           10174000
101750         END-EVALUATE                                             10175000
101760     END-PERFORM.                                                 10176000
101770                                                                  10177000
101780     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10178000
101790         (SQLCODE NOT = ZERO AND                                  10179000
101800             SQLCODE NOT = +100)                                  10180000
101810         DISPLAY '****************************************'       10181000
101820         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10182000
101830         DISPLAY '** SELECT FROM TIMCNPO                **'       10183000
101840         DISPLAY '** PARAGRAPH = 7255-SELECT-TIMCNPO    **'       10184000
101850         DISPLAY '** CONTNR ID      = ' TR023-CONPO-CONTNR-ID     10185000
101860         DISPLAY '** PO NUMBER      = ' PV-HOLD-PO-NBR            10186000
101870         DISPLAY '** EXTL REF NBR   = ' TR023-CONPO-EXTL-REF-NBR  10187000
101880         DISPLAY '****************************************'       10188000
101890         PERFORM 9100-SQL-ABEND                                   10189000
101900     END-IF.                                                      10190000
101910                                                                  10191000
101920 EJECT                                                            10192000
101930******************************************************************10193000
101940* SELECT A ROW FROM THE CONTAINER PURCHASE ORDER TABLE (TIMCNPO).*10194000
101950******************************************************************10195000
101960 7256-SELECT-TIMCNPO-OLD.                                         10196000
101970                                                                  10197000
101980     PERFORM                                                      10198000
101990         WITH TEST AFTER                                          10199000
102000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10200000
102010         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            10201000
102020                 SQLCODE = ZERO                     OR            10202000
102030                 SQLCODE = +100                                   10203000
102040                                                                  10204000
102050         EXEC SQL                                                 10205000
102060             SELECT CONTNR_ID,                                    10206000
102070                    CONTNR_SEQ_NBR,                               10207000
102080                    PO_NBR,                                       10208000
102090                    CSTM_ENTR_ID,                                 10209000
102100                    MSTR_BOL_NBR,                                 10210000
102110                    HSE_BOL_NBR,                                  10211000
102120                    LTR_OF_CR_NBR,                                10212000
102130                    PO_RCVD_DELY_TMST,                            10213000
102140                    PO_C_O_PROD_CDE,                              10214000
102150                    PO_CART_CNT,                                  10215000
102160                    PO_CBMT_QTY,                                  10216000
102170                    PO_WT_KGRM_QTY,                               10217000
102180                    PO_UNT_QTY,                                   10218000
102190                    CRE_BY_USR_ID,                                10219000
102200                    CRE_TMST,                                     10220000
102210                    LAST_UPD_BY_USR_ID,                           10221000
102220                    LAST_UPD_TMST,                                10222000
102230                    EXTL_REF_NBR,                                 10223000
102240                    BKR_FRGT_RLSE_CDE,                            10224000
102250                    DO_RCVD_CDE,                                  10225000
102260                    CONTNR_PU_CDE,                                10226000
102270                    ACTL_POE_DELY_CDE,                            10227000
102280                    DVN_CDE,                                      10228000
102290                    DCONSLR_RET_CDE,                              10229000
102300                    SPLT_XMIT_CDE,                                10230000
102310                    DOC_RCVD_ORGN_TMST                            10231000
102320              INTO :IMCNPO-CONTNR-ID,                             10232000
102330                   :IMCNPO-CONTNR-SEQ-NBR,                        10233000
102340                   :IMCNPO-PO-NBR,                                10234000
102350                   :IMCNPO-CSTM-ENTR-ID,                          10235000
102360                   :IMCNPO-MSTR-BOL-NBR,                          10236000
102370                   :IMCNPO-HSE-BOL-NBR,                           10237000
102380                   :IMCNPO-LTR-OF-CR-NBR,                         10238000
102390                   :IMCNPO-PO-RCVD-DELY-TMST,                     10239000
102400                   :IMCNPO-PO-C-O-PROD-CDE,                       10240000
102410                   :IMCNPO-PO-CART-CNT,                           10241000
102420                   :IMCNPO-PO-CBMT-QTY,                           10242000
102430                   :IMCNPO-PO-WT-KGRM-QTY,                        10243000
102440                   :IMCNPO-PO-UNT-QTY,                            10244000
102450                   :IMCNPO-CRE-BY-USR-ID,                         10245000
102460                   :IMCNPO-CRE-TMST,                              10246000
102470                   :IMCNPO-LAST-UPD-BY-USR-ID,                    10247000
102480                   :IMCNPO-LAST-UPD-TMST,                         10248000
102490                   :IMCNPO-EXTL-REF-NBR,                          10249000
102500                   :IMCNPO-BKR-FRGT-RLSE-CDE,                     10250000
102510                   :IMCNPO-DO-RCVD-CDE,                           10251000
102520                   :IMCNPO-CONTNR-PU-CDE,                         10252000
102530                   :IMCNPO-ACTL-POE-DELY-CDE,                     10253000
102540                   :IMCNPO-DVN-CDE,                               10254000
102550                   :IMCNPO-DCONSLR-RET-CDE,                       10255000
102560                   :IMCNPO-SPLT-XMIT-CDE,                         10256000
102570                   :IMCNPO-DOC-RCVD-ORGN-TMST                     10257000
102580                                                                  10258000
102590               FROM TIMCNPO                                       10259000
102600              WHERE CONTNR_ID        = :PV-HOLD-CONTNR-ID         10260000
102610                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    10261000
102620                AND PO_NBR           = :PV-HOLD-PO-NBR            10262000
102630              WITH UR                                             10263000
102640         END-EXEC                                                 10264000
102650                                                                  10265000
102660         EVALUATE TRUE                                            10266000
102670             WHEN SQLCODE = ZERO                                  10267000
102680                 ADD +1 TO PA-TOT-CNPO-RECS-SELECT                10268000
102690                 ADD +1 TO PA-TOT-RECS-SELECTED                   10269000
102700                 SET PS-CNPO-OLD-FOUND TO TRUE                    10270000
102710                                                                  10271000
102720             WHEN SQLCODE = +100                                  10272000
102730                 SET PS-CNPO-OLD-NOT-FOUND TO TRUE                10273000
102740                                                                  10274000
102750             WHEN SQLWARN0 NOT EQUAL SPACE                        10275000
102760             WHEN SQLCODE NOT EQUAL ZERO                          10276000
102770                 DISPLAY '**************************************' 10277000
102780                 DISPLAY '** ABEND                            **' 10278000
102790                 DISPLAY '** PROGRAM = TRKUP215               **' 10279000
102800                 DISPLAY '** PARAGRAPH = 7256-SELECT-TIMCNPO-OLD' 10280000
102810                 DISPLAY '** SELECT TIMCNPO                   **' 10281000
102820                 DISPLAY '** CONTNR ID       = '                  10282000
102830                 DISPLAY            PV-HOLD-CONTNR-ID             10283000
102840                 DISPLAY '** CONTNR SEQ NBR  = '                  10284000
102850                 DISPLAY            PV-HOLD-CONTNR-SEQ-NBR        10285000
102860                 DISPLAY '** PO NUMBER       = '                  10286000
102870                 DISPLAY            PV-HOLD-PO-NBR                10287000
102880                 DISPLAY '**************************************' 10288000
102890                 PERFORM 9100-SQL-ABEND                           10289000
102900         END-EVALUATE                                             10290000
102910     END-PERFORM.                                                 10291000
102920                                                                  10292000
102930     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10293000
102940         (SQLCODE NOT = ZERO AND                                  10294000
102950             SQLCODE NOT = +100)                                  10295000
102960         DISPLAY '****************************************'       10296000
102970         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10297000
102980         DISPLAY '** SELECT FROM TIMCNPO                **'       10298000
102990         DISPLAY '** PARAGRAPH = 7256-SELECT-TIMCNPO-OLD**'       10299000
103000         DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID         10300000
103010         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    10301000
103020         DISPLAY '** PO NUMBER      = ' PV-HOLD-PO-NBR            10302000
103030         DISPLAY '****************************************'       10303000
103040         PERFORM 9100-SQL-ABEND                                   10304000
103050     END-IF.                                                      10305000
103060                                                                  10306000
103070 EJECT                                                            10307000
103080******************************************************************10308000
103090* SELECT A ROW FROM THE CONTAINER PURCHASE ORDER TABLE (TIMCNPO).*10309000
103100******************************************************************10310000
103110 7257-SELECT-TIMCNPO-CHG.                                         10311000
103120                                                                  10312000
103130     PERFORM                                                      10313000
103140         WITH TEST AFTER                                          10314000
103150         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10315000
103160         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            10316000
103170                 SQLCODE = ZERO                     OR            10317000
103180                 SQLCODE = +100                                   10318000
103190                                                                  10319000
103200         EXEC SQL                                                 10320000
103210             SELECT CONTNR_ID,                                    10321000
103220                    CONTNR_SEQ_NBR,                               10322000
103230                    PO_NBR,                                       10323000
103240                    CSTM_ENTR_ID,                                 10324000
103250                    MSTR_BOL_NBR,                                 10325000
103260                    HSE_BOL_NBR,                                  10326000
103270                    LTR_OF_CR_NBR,                                10327000
103280                    PO_RCVD_DELY_TMST,                            10328000
103290                    PO_C_O_PROD_CDE,                              10329000
103300                    PO_CART_CNT,                                  10330000
103310                    PO_CBMT_QTY,                                  10331000
103320                    PO_WT_KGRM_QTY,                               10332000
103330                    PO_UNT_QTY,                                   10333000
103340                    CRE_BY_USR_ID,                                10334000
103350                    CRE_TMST,                                     10335000
103360                    LAST_UPD_BY_USR_ID,                           10336000
103370                    LAST_UPD_TMST,                                10337000
103380                    EXTL_REF_NBR,                                 10338000
103390                    BKR_FRGT_RLSE_CDE,                            10339000
103400                    DO_RCVD_CDE,                                  10340000
103410                    CONTNR_PU_CDE,                                10341000
103420                    ACTL_POE_DELY_CDE,                            10342000
103430                    DVN_CDE,                                      10343000
103440                    DCONSLR_RET_CDE,                              10344000
103450                    SPLT_XMIT_CDE,                                10345000
103460                    DOC_RCVD_ORGN_TMST                            10346000
103470              INTO :IMCNPO-CONTNR-ID,                             10347000
103480                   :IMCNPO-CONTNR-SEQ-NBR,                        10348000
103490                   :IMCNPO-PO-NBR,                                10349000
103500                   :IMCNPO-CSTM-ENTR-ID,                          10350000
103510                   :IMCNPO-MSTR-BOL-NBR,                          10351000
103520                   :IMCNPO-HSE-BOL-NBR,                           10352000
103530                   :IMCNPO-LTR-OF-CR-NBR,                         10353000
103540                   :IMCNPO-PO-RCVD-DELY-TMST,                     10354000
103550                   :IMCNPO-PO-C-O-PROD-CDE,                       10355000
103560                   :IMCNPO-PO-CART-CNT,                           10356000
103570                   :IMCNPO-PO-CBMT-QTY,                           10357000
103580                   :IMCNPO-PO-WT-KGRM-QTY,                        10358000
103590                   :IMCNPO-PO-UNT-QTY,                            10359000
103600                   :IMCNPO-CRE-BY-USR-ID,                         10360000
103610                   :IMCNPO-CRE-TMST,                              10361000
103620                   :IMCNPO-LAST-UPD-BY-USR-ID,                    10362000
103630                   :IMCNPO-LAST-UPD-TMST,                         10363000
103640                   :IMCNPO-EXTL-REF-NBR,                          10364000
103650                   :IMCNPO-BKR-FRGT-RLSE-CDE,                     10365000
103660                   :IMCNPO-DO-RCVD-CDE,                           10366000
103670                   :IMCNPO-CONTNR-PU-CDE,                         10367000
103680                   :IMCNPO-ACTL-POE-DELY-CDE,                     10368000
103690                   :IMCNPO-DVN-CDE,                               10369000
103700                   :IMCNPO-DCONSLR-RET-CDE,                       10370000
103710                   :IMCNPO-SPLT-XMIT-CDE,                         10371000
103720                   :IMCNPO-DOC-RCVD-ORGN-TMST                     10372000
103730                                                                  10373000
103740               FROM TIMCNPO                                       10374000
103750              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          10375000
103760                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     10376000
103770                AND PO_NBR           = :IMCNPO-PO-NBR             10377000
103780              WITH UR                                             10378000
103790         END-EXEC                                                 10379000
103800                                                                  10380000
103810         EVALUATE TRUE                                            10381000
103820             WHEN SQLCODE = ZERO                                  10382000
103830                 ADD +1 TO PA-TOT-CNPO-RECS-SELECT                10383000
103840                 ADD +1 TO PA-TOT-RECS-SELECTED                   10384000
103850                                                                  10385000
103860             WHEN SQLCODE = +100                                  10386000
103870                 PERFORM 7258-TIMCNPO-SELECT-ERROR                10387000
103880                                                                  10388000
103890             WHEN SQLWARN0 NOT EQUAL SPACE                        10389000
103900             WHEN SQLCODE NOT EQUAL ZERO                          10390000
103910                 DISPLAY '**************************************' 10391000
103920                 DISPLAY '** ABEND                            **' 10392000
103930                 DISPLAY '** PROGRAM = TRKUP215               **' 10393000
103940                 DISPLAY '** PARAGRAPH = 7257-SELECT-TIMCNPO-CHG' 10394000
103950                 DISPLAY '** SELECT TIMCNPO                   **' 10395000
103960                 DISPLAY '** CONTNR ID       = ' IMCNTK-CONTNR-ID 10396000
103970                 DISPLAY '** CONTNR SEQ NBR  = '                  10397000
103980                 DISPLAY            IMCNTK-CONTNR-SEQ-NBR         10398000
103990                 DISPLAY '** PO NUMBER       = ' IMCNPO-PO-NBR    10399000
104000                 DISPLAY '**************************************' 10400000
104010                 PERFORM 9100-SQL-ABEND                           10401000
104020         END-EVALUATE                                             10402000
104030     END-PERFORM.                                                 10403000
104040                                                                  10404000
104050     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10405000
104060         (SQLCODE NOT = ZERO AND                                  10406000
104070             SQLCODE NOT = +100)                                  10407000
104080         DISPLAY '****************************************'       10408000
104090         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10409000
104100         DISPLAY '** SELECT FROM TIMCNPO                **'       10410000
104110         DISPLAY '** PARAGRAPH = 7257-SELECT-TIMCNPO-CHG**'       10411000
104120         DISPLAY '** CONTNR ID      = ' IMCNTK-CONTNR-ID          10412000
104130         DISPLAY '** CONTNR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR     10413000
104140         DISPLAY '** PO NUMBER      = ' IMCNPO-PO-NBR             10414000
104150         DISPLAY '****************************************'       10415000
104160         PERFORM 9100-SQL-ABEND                                   10416000
104170     END-IF.                                                      10417000
104180                                                                  10418000
104190 EJECT                                                            10419000
104200******************************************************************10420000
104210* A TIMCNPO SELECT ERROR WAS ENCOUNTERED.                        *10421000
104220******************************************************************10422000
104230 7258-TIMCNPO-SELECT-ERROR.                                       10423000
104240                                                                  10424000
104250     INITIALIZE TR211-RECORD.                                     10425000
104260     INITIALIZE TR211-REC-TYP-CONPOA.                             10426000
104270                                                                  10427000
104280     MOVE PC-ERROR              TO TR211-ERROR-TYPE.              10428000
104290     MOVE 'PO NUMBER'           TO TR211-DATA-IN-ERROR.           10429000
104300     MOVE PV-CURSOR-PO-NBR      TO TR211-DATA-VALUE               10430000
104310                                   TR211-CONPOA-PO-NBR.           10431000
104320     MOVE 'CONTACT PROGRAMMING - SEE PARAGRAPH 3440'              10432000
104330                                TO TR211-ERROR-MSG.               10433000
104340     MOVE PC-E                  TO TR211-TRN-TYP.                 10434000
104350     MOVE PC-CONPOA             TO TR211-REC-TYP-CONPOA-CDE.      10435000
104360     MOVE PC-30                 TO TR211-SEQ-NBR-CONPOA.          10436000
104370     MOVE IMCNPO-CONTNR-ID      TO TR211-CONTNR-ID                10437000
104380     MOVE IMCNPO-PO-NBR         TO TR211-CONPOA-PO-NBR.           10438000
104390                                                                  10439000
104400     PERFORM 6200-WRITE-LOAD-REPORT.                              10440000
104410                                                                  10441000
104420******************************************************************10442000
104430* UPDATE A ROW ON THE CONTAINER PO TABLE (TIMCNPO).              *10443000
104440******************************************************************10444000
104450 7259-UPDATE-TIMCNPO.                                             10445000
104460                                                                  10446000
104470     PERFORM WITH TEST AFTER                                      10447000
104480             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 10448000
104490             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         10449000
104500                     SQLCODE = ZERO                               10450000
104510                                                                  10451000
104520         EXEC SQL                                                 10452000
104530             UPDATE TIMCNPO                                       10453000
104540             SET  SPLT_XMIT_CDE      = :PC-SPACE                  10454000
104550                 ,LAST_UPD_BY_USR_ID = :PC-CURRENT-PROGRAM-NAME   10455000
104560                 ,LAST_UPD_TMST      = :PV-CURRENT-TMST           10456000
104570             WHERE CONTNR_ID      = :IMCNPO-CONTNR-ID             10457000
104580               AND PO_NBR         = :IMCNPO-PO-NBR                10458000
104590         END-EXEC                                                 10459000
104600                                                                  10460000
104610         EVALUATE TRUE                                            10461000
104620             WHEN SQLCODE = ZERO                                  10462000
104630             WHEN SQLCODE = -904                                  10463000
104640             WHEN SQLCODE = -913                                  10464000
104650                  CONTINUE                                        10465000
104660                                                                  10466000
104670             WHEN SQLWARN0 NOT EQUAL SPACE                        10467000
104680             WHEN SQLCODE NOT EQUAL ZERO                          10468000
104690                 DISPLAY '**************************************' 10469000
104700                 DISPLAY '** ABEND                            **' 10470000
104710                 DISPLAY '** PROGRAM = TRKUP215               **' 10471000
104720                 DISPLAY '** PARAGRAPH = 7259-UPDATE-TIMCNPO  **' 10472000
104730                 DISPLAY '** UPDATE TIMCNPO                   **' 10473000
104740                 DISPLAY '** CONTAINER ID = ' IMCNPO-CONTNR-ID    10474000
104750                 DISPLAY '** PO NUMBER    = ' IMCNPO-PO-NBR       10475000
104760                 DISPLAY '**************************************' 10476000
104770                 PERFORM 9100-SQL-ABEND                           10477000
104780         END-EVALUATE                                             10478000
104790     END-PERFORM.                                                 10479000
104800                                                                  10480000
104810     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10481000
104820         SQLCODE NOT = ZERO                                       10482000
104830         DISPLAY '****************************************'       10483000
104840         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10484000
104850         DISPLAY '** UPDATE TIMCNPO                     **'       10485000
104860         DISPLAY '** PARAGRAPH = 7259-UPDATE-TIMCNPO    **'       10486000
104870         DISPLAY '** CONTAINER ID = ' IMCNPO-CONTNR-ID            10487000
104880         DISPLAY '** PO NUMBER    = ' IMCNPO-PO-NBR               10488000
104890         DISPLAY '****************************************'       10489000
104900         PERFORM 9100-SQL-ABEND                                   10490000
104910     END-IF.                                                      10491000
104920                                                                  10492000
104930 EJECT                                                            10493000
104940******************************************************************10494000
104950* SELECT A ROW FROM THE CONTAINER UPC TABLE (TIMCNUP).           *10495000
104960******************************************************************10496000
104970 7265-SELECT-TIMCNUP.                                             10497000
104980                                                                  10498000
104990     PERFORM                                                      10499000
105000         WITH TEST AFTER                                          10500000
105010         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10501000
105020         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            10502000
105030                 SQLCODE = ZERO                     OR            10503000
105040                 SQLCODE = +100                                   10504000
105050                                                                  10505000
105060         EXEC SQL                                                 10506000
105070             SELECT CONTNR_ID,                                    10507000
105080                    CONTNR_SEQ_NBR,                               10508000
105090                    PO_NBR,                                       10509000
105100                    UPC_NBR,                                      10510000
105110                    PO_LNE_NBR,                                   10511000
105120                    UPC_CART_CNT,                                 10512000
105130                    UPC_CBMT_QTY,                                 10513000
105140                    UPC_WT_KGRM_QTY,                              10514000
105150                    UPC_UNT_QTY,                                  10515000
105160                    CRE_BY_USR_ID,                                10516000
105170                    CRE_TMST,                                     10517000
105180                    LAST_UPD_BY_USR_ID,                           10518000
105190                    LAST_UPD_TMST,                                10519000
105200                    SKU_NBR,                                      10520000
105210                    ASN_PKGNG_CDE                                 10521000
105220              INTO :IMCNUP-CONTNR-ID,                             10522000
105230                   :IMCNUP-CONTNR-SEQ-NBR,                        10523000
105240                   :IMCNUP-PO-NBR,                                10524000
105250                   :IMCNUP-UPC-NBR,                               10525000
105260                   :IMCNUP-PO-LNE-NBR,                            10526000
105270                   :IMCNUP-UPC-CART-CNT,                          10527000
105280                   :IMCNUP-UPC-CBMT-QTY,                          10528000
105290                   :IMCNUP-UPC-WT-KGRM-QTY,                       10529000
105300                   :IMCNUP-UPC-UNT-QTY,                           10530000
105310                   :IMCNUP-CRE-BY-USR-ID,                         10531000
105320                   :IMCNUP-CRE-TMST,                              10532000
105330                   :IMCNUP-LAST-UPD-BY-USR-ID,                    10533000
105340                   :IMCNUP-LAST-UPD-TMST,                         10534000
105350                   :IMCNUP-SKU-NBR,                               10535000
105360                   :IMCNUP-ASN-PKGNG-CDE                          10536000
105370                                                                  10537000
105380               FROM TIMCNUP                                       10538000
105390              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          10539000
105400                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     10540000
105410                AND PO_NBR           = :PV-HOLD-PO-NBR            10541000
105420                AND UPC_NBR          = :PV-HOLD-UPC-NBR           10542000
105430              WITH UR                                             10543000
105440         END-EXEC                                                 10544000
105450                                                                  10545000
105460         EVALUATE TRUE                                            10546000
105470             WHEN SQLCODE = ZERO                                  10547000
105480                 ADD +1 TO PA-TOT-CNUP-RECS-SELECT                10548000
105490                 ADD +1 TO PA-TOT-RECS-SELECTED                   10549000
105500                 SET PS-CNUP-FOUND     TO TRUE                    10550000
105510                                                                  10551000
105520             WHEN SQLCODE = +100                                  10552000
105530                 SET PS-CNUP-NOT-FOUND TO TRUE                    10553000
105540                                                                  10554000
105550             WHEN SQLWARN0 NOT EQUAL SPACE                        10555000
105560             WHEN SQLCODE NOT EQUAL ZERO                          10556000
105570                 DISPLAY '**************************************' 10557000
105580                 DISPLAY '** ABEND                            **' 10558000
105590                 DISPLAY '** PROGRAM = TRKUP215               **' 10559000
105600                 DISPLAY '** PARAGRAPH = 7265-SELECT-TIMCNUP  **' 10560000
105610                 DISPLAY '** SELECT FROM TIMCNUP              **' 10561000
105620                 DISPLAY '** CONTNR ID = ' TR023-CONUPC-CONTNR-ID 10562000
105630                 DISPLAY '** CONTNR SEQ NBR = '                   10563000
105640                 DISPLAY                PV-HOLD-CONTNR-SEQ-NBR    10564000
105650                 DISPLAY '** PO NUMBER   = ' PV-HOLD-PO-NBR       10565000
105660                 DISPLAY '** UPC NUMBER  = ' PV-HOLD-UPC-NBR      10566000
105670                 DISPLAY '**************************************' 10567000
105680                 PERFORM 9100-SQL-ABEND                           10568000
105690         END-EVALUATE                                             10569000
105700     END-PERFORM.                                                 10570000
105710                                                                  10571000
105720     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10572000
105730         (SQLCODE NOT = ZERO AND                                  10573000
105740             SQLCODE NOT = +100)                                  10574000
105750         DISPLAY '****************************************'       10575000
105760         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10576000
105770         DISPLAY '** SELECT FROM TIMCNUP                **'       10577000
105780         DISPLAY '** PARAGRAPH = 7265-SELECT-TIMCNUP    **'       10578000
105790         DISPLAY '** CONTNR ID      = ' TR023-CONUPC-CONTNR-ID    10579000
105800         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    10580000
105810         DISPLAY '** PO NUMBER      = ' PV-HOLD-PO-NBR            10581000
105820         DISPLAY '** UPC NUMBER     = ' PV-HOLD-UPC-NBR           10582000
105830         DISPLAY '****************************************'       10583000
105840         PERFORM 9100-SQL-ABEND                                   10584000
105850     END-IF.                                                      10585000
105860                                                                  10586000
105870 EJECT                                                            10587000
105880******************************************************************10588000
105890* SELECT A ROW FROM THE CONTAINER UPC TABLE (TIMCNUP).           *10589000
105900******************************************************************10590000
105910 7267-SELECT-TIMCNUP-OLD.                                         10591000
105920                                                                  10592000
105930     PERFORM                                                      10593000
105940         WITH TEST AFTER                                          10594000
105950         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10595000
105960         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            10596000
105970                 SQLCODE = ZERO                     OR            10597000
105980                 SQLCODE = +100                                   10598000
105990                                                                  10599000
106000         EXEC SQL                                                 10600000
106010             SELECT CONTNR_ID,                                    10601000
106020                    CONTNR_SEQ_NBR,                               10602000
106030                    PO_NBR,                                       10603000
106040                    UPC_NBR,                                      10604000
106050                    PO_LNE_NBR,                                   10605000
106060                    UPC_CART_CNT,                                 10606000
106070                    UPC_CBMT_QTY,                                 10607000
106080                    UPC_WT_KGRM_QTY,                              10608000
106090                    UPC_UNT_QTY,                                  10609000
106100                    CRE_BY_USR_ID,                                10610000
106110                    CRE_TMST,                                     10611000
106120                    LAST_UPD_BY_USR_ID,                           10612000
106130                    LAST_UPD_TMST,                                10613000
106140                    SKU_NBR,                                      10614000
106150                    ASN_PKGNG_CDE                                 10615000
106160              INTO :IMCNUP-CONTNR-ID,                             10616000
106170                   :IMCNUP-CONTNR-SEQ-NBR,                        10617000
106180                   :IMCNUP-PO-NBR,                                10618000
106190                   :IMCNUP-UPC-NBR,                               10619000
106200                   :IMCNUP-PO-LNE-NBR,                            10620000
106210                   :IMCNUP-UPC-CART-CNT,                          10621000
106220                   :IMCNUP-UPC-CBMT-QTY,                          10622000
106230                   :IMCNUP-UPC-WT-KGRM-QTY,                       10623000
106240                   :IMCNUP-UPC-UNT-QTY,                           10624000
106250                   :IMCNUP-CRE-BY-USR-ID,                         10625000
106260                   :IMCNUP-CRE-TMST,                              10626000
106270                   :IMCNUP-LAST-UPD-BY-USR-ID,                    10627000
106280                   :IMCNUP-LAST-UPD-TMST,                         10628000
106290                   :IMCNUP-SKU-NBR,                               10629000
106300                   :IMCNUP-ASN-PKGNG-CDE                          10630000
106310                                                                  10631000
106320               FROM TIMCNUP                                       10632000
106330              WHERE CONTNR_ID        = :PV-HOLD-CONTNR-ID         10633000
106340                AND CONTNR_SEQ_NBR   = :PV-HOLD-CONTNR-SEQ-NBR    10634000
106350                AND PO_NBR           = :PV-HOLD-PO-NBR            10635000
106360                AND UPC_NBR          = :PV-HOLD-UPC-NBR           10636000
106370              WITH UR                                             10637000
106380         END-EXEC                                                 10638000
106390                                                                  10639000
106400         EVALUATE TRUE                                            10640000
106410             WHEN SQLCODE = ZERO                                  10641000
106420                 ADD +1 TO PA-TOT-CNUP-RECS-SELECT                10642000
106430                 ADD +1 TO PA-TOT-RECS-SELECTED                   10643000
106440                 SET PS-CNUP-OLD-FOUND TO TRUE                    10644000
106450                                                                  10645000
106460             WHEN SQLCODE = +100                                  10646000
106470                 SET PS-CNUP-OLD-NOT-FOUND TO TRUE                10647000
106480                                                                  10648000
106490             WHEN SQLWARN0 NOT EQUAL SPACE                        10649000
106500             WHEN SQLCODE NOT EQUAL ZERO                          10650000
106510                 DISPLAY '**************************************' 10651000
106520                 DISPLAY '** ABEND                            **' 10652000
106530                 DISPLAY '** PROGRAM = TRKUP215               **' 10653000
106540                 DISPLAY '** PARAGRAPH = 7267-SELECT-TIMCNUP-OLD' 10654000
106550                 DISPLAY '** SELECT FROM TIMCNUP              **' 10655000
106560                 DISPLAY '** CONTNR ID = ' PV-HOLD-CONTNR-ID      10656000
106570                 DISPLAY '** CONTNR SEQ NBR = '                   10657000
106580                 DISPLAY                 PV-HOLD-CONTNR-SEQ-NBR   10658000
106590                 DISPLAY '** PO NUMBER  = ' PV-HOLD-PO-NBR        10659000
106600                 DISPLAY '** UPC NUMBER = ' PV-HOLD-UPC-NBR       10660000
106610                 DISPLAY '**************************************' 10661000
106620                 PERFORM 9100-SQL-ABEND                           10662000
106630         END-EVALUATE                                             10663000
106640     END-PERFORM.                                                 10664000
106650                                                                  10665000
106660     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10666000
106670         (SQLCODE NOT = ZERO AND                                  10667000
106680             SQLCODE NOT = +100)                                  10668000
106690         DISPLAY '****************************************'       10669000
106700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10670000
106710         DISPLAY '** SELECT FROM TIMCNUP                **'       10671000
106720         DISPLAY '** PARAGRAPH = 7267-SELECT-TIMCNUP-OLD**'       10672000
106730         DISPLAY '** CONTNR ID      = ' PV-HOLD-CONTNR-ID         10673000
106740         DISPLAY '** CONTNR SEQ NBR = ' PV-HOLD-CONTNR-SEQ-NBR    10674000
106750         DISPLAY '** PO NUMBER      = ' PV-HOLD-PO-NBR            10675000
106760         DISPLAY '** UPC NUMBER     = ' PV-HOLD-UPC-NBR           10676000
106770         DISPLAY '****************************************'       10677000
106780         PERFORM 9100-SQL-ABEND                                   10678000
106790     END-IF.                                                      10679000
106800                                                                  10680000
106810 EJECT                                                            10681000
106820******************************************************************10682000
106830* SELECT A ROW FROM THE CONTAINER UPC TABLE (TIMCNUP).           *10683000
106840******************************************************************10684000
106850 7270-SELECT-TIMCNUP-CHG.                                         10685000
106860                                                                  10686000
106870     PERFORM                                                      10687000
106880         WITH TEST AFTER                                          10688000
106890         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10689000
106900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            10690000
106910                 SQLCODE = ZERO                     OR            10691000
106920                 SQLCODE = +100                                   10692000
106930                                                                  10693000
106940         EXEC SQL                                                 10694000
106950             SELECT CONTNR_ID,                                    10695000
106960                    CONTNR_SEQ_NBR,                               10696000
106970                    PO_NBR,                                       10697000
106980                    UPC_NBR,                                      10698000
106990                    PO_LNE_NBR,                                   10699000
107000                    UPC_CART_CNT,                                 10700000
107010                    UPC_CBMT_QTY,                                 10701000
107020                    UPC_WT_KGRM_QTY,                              10702000
107030                    UPC_UNT_QTY,                                  10703000
107040                    CRE_BY_USR_ID,                                10704000
107050                    CRE_TMST,                                     10705000
107060                    LAST_UPD_BY_USR_ID,                           10706000
107070                    LAST_UPD_TMST,                                10707000
107080                    SKU_NBR,                                      10708000
107090                    ASN_PKGNG_CDE                                 10709000
107100              INTO :IMCNUP-CONTNR-ID,                             10710000
107110                   :IMCNUP-CONTNR-SEQ-NBR,                        10711000
107120                   :IMCNUP-PO-NBR,                                10712000
107130                   :IMCNUP-UPC-NBR,                               10713000
107140                   :IMCNUP-PO-LNE-NBR,                            10714000
107150                   :IMCNUP-UPC-CART-CNT,                          10715000
107160                   :IMCNUP-UPC-CBMT-QTY,                          10716000
107170                   :IMCNUP-UPC-WT-KGRM-QTY,                       10717000
107180                   :IMCNUP-UPC-UNT-QTY,                           10718000
107190                   :IMCNUP-CRE-BY-USR-ID,                         10719000
107200                   :IMCNUP-CRE-TMST,                              10720000
107210                   :IMCNUP-LAST-UPD-BY-USR-ID,                    10721000
107220                   :IMCNUP-LAST-UPD-TMST,                         10722000
107230                   :IMCNUP-SKU-NBR,                               10723000
107240                   :IMCNUP-ASN-PKGNG-CDE                          10724000
107250                                                                  10725000
107260               FROM TIMCNUP                                       10726000
107270              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          10727000
107280                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     10728000
107290                AND PO_NBR           = :IMCNUP-PO-NBR             10729000
107300                AND UPC_NBR          = :IMCNUP-UPC-NBR            10730000
107310              WITH UR                                             10731000
107320         END-EXEC                                                 10732000
107330                                                                  10733000
107340         EVALUATE TRUE                                            10734000
107350             WHEN SQLCODE = ZERO                                  10735000
107360                 ADD +1 TO PA-TOT-CNUP-RECS-SELECT                10736000
107370                 ADD +1 TO PA-TOT-RECS-SELECTED                   10737000
107380*CHG102494 - START                                                10738008
107390                 SET PS-TIMCNUP-RECORD-FOUND TO TRUE              10739005
107400*CHG102494 - END                                                  10740008
107410                                                                  10741000
107420             WHEN SQLCODE = +100                                  10742000
107430                 CONTINUE                                         10743000
107440                                                                  10744000
107450             WHEN SQLWARN0 NOT EQUAL SPACE                        10745000
107460             WHEN SQLCODE NOT EQUAL ZERO                          10746000
107470                 DISPLAY '**************************************' 10747000
107480                 DISPLAY '** ABEND                            **' 10748000
107490                 DISPLAY '** PROGRAM = TRKUP215               **' 10749000
107500                 DISPLAY '** PARAGRAPH = 7270-SELECT-TIMCNUP-CHG' 10750000
107510                 DISPLAY '** SELECT FROM TIMCNUP              **' 10751000
107520                 DISPLAY '** CONTNR ID = ' IMCNTK-CONTNR-ID       10752000
107530                 DISPLAY '** CONTNR SEQ NBR = '                   10753000
107540                 DISPLAY                 IMCNTK-CONTNR-SEQ-NBR    10754000
107550                 DISPLAY '** PO NUMBER  = ' PV-CURSOR-PO-NBR      10755000
107560                 DISPLAY '** UPC NUMBER = ' PV-CURSOR-UPC-NBR     10756000
107570                 DISPLAY '**************************************' 10757000
107580                 PERFORM 9100-SQL-ABEND                           10758000
107590         END-EVALUATE                                             10759000
107600     END-PERFORM.                                                 10760000
107610                                                                  10761000
107620     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10762000
107630         (SQLCODE NOT = ZERO AND                                  10763000
107640             SQLCODE NOT = +100)                                  10764000
107650         DISPLAY '****************************************'       10765000
107660         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10766000
107670         DISPLAY '** SELECT FROM TIMCNUP                **'       10767000
107680         DISPLAY '** PARAGRAPH = 7270-SELECT-TIMCNUP-CHG**'       10768000
107690         DISPLAY '** CONTNR ID      = ' IMCNTK-CONTNR-ID          10769000
107700         DISPLAY '** CONTNR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR     10770000
107710         DISPLAY '** PO NUMBER      = ' PV-CURSOR-PO-NBR          10771000
107720         DISPLAY '** UPC NUMBER     = ' PV-CURSOR-UPC-NBR         10772000
107730         DISPLAY '****************************************'       10773000
107740         PERFORM 9100-SQL-ABEND                                   10774000
107750     END-IF.                                                      10775000
107760                                                                  10776000
107770                                                                  10777000
107780******************************************************************10778000
107790* SELECT COUNTRY CODE.                                           *10779000
107800******************************************************************10780000
107810 7275-SELECT-CNTRY-CDE.                                           10781000
107820                                                                  10782000
107830     PERFORM                                                      10783000
107840         WITH TEST AFTER                                          10784000
107850         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10785000
107860         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            10786000
107870                 SQLCODE = ZERO                     OR            10787000
107880                 SQLCODE = +100                                   10788000
107890                                                                  10789000
107900         EXEC SQL                                                 10790000
107910             SELECT A.CNTRY_CDE                                   10791000
107920              INTO :CNTRY-CNTRY-CDE                               10792000
107930               FROM TCNTRY  A                                     10793000
107940              WHERE A.CNTRY_CDE   =   :PV-HOLD-CNTRY-CDE          10794000
107950                AND A.STAT_CDE    =   'A'                         10795000
107960              WITH UR                                             10796000
107970         END-EXEC                                                 10797000
107980                                                                  10798000
107990         EVALUATE TRUE                                            10799000
108000             WHEN SQLCODE = ZERO                                  10800000
108010                 SET PS-VALID-CNTRY-CDE    TO TRUE                10801000
108020                                                                  10802000
108030             WHEN SQLCODE = +100                                  10803000
108040                 SET PS-INVALID-CNTRY-CDE  TO TRUE                10804000
108050                                                                  10805000
108060             WHEN SQLWARN0 NOT EQUAL SPACE                        10806000
108070             WHEN SQLCODE NOT EQUAL ZERO                          10807000
108080                 DISPLAY '**************************************' 10808000
108090                 DISPLAY '** ABEND                            **' 10809000
108100                 DISPLAY '** PROGRAM = TRKUP215               **' 10810000
108110                 DISPLAY '** PARAGRAPH = 7275-SELECT-CNTRY-CDE**' 10811000
108120                 DISPLAY '** SELECT TCNTRY CNTRY CDE          **' 10812000
108130                 DISPLAY '** CONTNR ID  = ' IMCNTK-CONTNR-ID      10813000
108140                 DISPLAY '** SAIL DATE  = ' IMCNTK-MOM-DPRTR-TMST 10814000
108150                 DISPLAY '** CNTRY CODE = ' PV-HOLD-CNTRY-CDE     10815000
108160                 DISPLAY '**************************************' 10816000
108170                 PERFORM 9100-SQL-ABEND                           10817000
108180         END-EVALUATE                                             10818000
108190     END-PERFORM.                                                 10819000
108200                                                                  10820000
108210     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10821000
108220         (SQLCODE NOT = ZERO    AND                               10822000
108230             SQLCODE NOT = +100)                                  10823000
108240         DISPLAY '****************************************'       10824000
108250         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10825000
108260         DISPLAY '** SELECT FROM TCNTRY                 **'       10826000
108270         DISPLAY '** PARAGRAPH = 7275-SELECT-CNTRY-CDE  **'       10827000
108280         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            10828000
108290         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       10829000
108300         DISPLAY '** CNTRY CODE   = ' PV-HOLD-CNTRY-CDE           10830000
108310         DISPLAY '****************************************'       10831000
108320         PERFORM 9100-SQL-ABEND                                   10832000
108330     END-IF.                                                      10833000
108340                                                                  10834000
108350 EJECT                                                            10835000
108360******************************************************************10836000
108370*THIS PARAGRAPH IS NOT BEING USED.  AME 10/2007                  *10837000
108380*   OPEN THE POE CODE AIR CURSOR                                 *10838000
108390******************************************************************10839000
108400 7280-OPEN-POE-CURSOR-AIR.                                        10840000
108410                                                                  10841000
108420     PERFORM                                                      10842000
108430         WITH TEST AFTER                                          10843000
108440         VARYING PV-RETRY-COUNTER                                 10844000
108450         FROM 1 BY 1                                              10845000
108460         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10846000
108470                   OR (SQLCODE = ZERO))                           10847000
108480                                                                  10848000
108490         EXEC SQL                                                 10849000
108500              OPEN POE-CSR-AIR                                    10850000
108510         END-EXEC                                                 10851000
108520                                                                  10852000
108530         EVALUATE TRUE                                            10853000
108540             WHEN SQLCODE = ZERO                                  10854000
108550                 CONTINUE                                         10855000
108560             WHEN SQLWARN0 NOT EQUAL SPACE                        10856000
108570             WHEN SQLCODE NOT EQUAL ZERO                          10857000
108580                 DISPLAY '**************************************' 10858000
108590                 DISPLAY '** ABEND                            **' 10859000
108600                 DISPLAY '** PROGRAM = TRKUP215               **' 10860000
108610                 DISPLAY '** PARAGRAPH = 7280-OPEN-POE-CSR-AIR *' 10861000
108620                 DISPLAY '** OPEN POE CODE AIR CURSOR         **' 10862000
108630                 DISPLAY '**************************************' 10863000
108640                 PERFORM 9100-SQL-ABEND                           10864000
108650         END-EVALUATE                                             10865000
108660     END-PERFORM.                                                 10866000
108670                                                                  10867000
108680     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10868000
108690         (SQLCODE NOT = ZERO)                                     10869000
108700         DISPLAY '****************************************'       10870000
108710         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10871000
108720         DISPLAY '** OPEN POE CODE AIR CURSOR           **'       10872000
108730         DISPLAY '** PARAGRAPH = 7280-OPEN-POE-CURSOR-AIR*'       10873000
108740         DISPLAY '****************************************'       10874000
108750         PERFORM 9100-SQL-ABEND                                   10875000
108760     END-IF.                                                      10876000
108770                                                                  10877000
108780 EJECT                                                            10878000
108790******************************************************************10879000
108800*   CLOSE THE POE CODE AIR CURSOR                                *10880000
108810*THIS PARAGRAPH IS NOT BEING USED.  AME 10/2007                  *10881000
108820******************************************************************10882000
108830 7281-CLOSE-POE-CURSOR-AIR.                                       10883000
108840                                                                  10884000
108850     PERFORM                                                      10885000
108860         WITH TEST AFTER                                          10886000
108870         VARYING PV-RETRY-COUNTER                                 10887000
108880         FROM 1 BY 1                                              10888000
108890         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10889000
108900                   OR (SQLCODE = ZERO))                           10890000
108910                                                                  10891000
108920         EXEC SQL                                                 10892000
108930             CLOSE POE-CSR-AIR                                    10893000
108940         END-EXEC                                                 10894000
108950                                                                  10895000
108960         EVALUATE TRUE                                            10896000
108970             WHEN SQLCODE = ZERO                                  10897000
108980                 CONTINUE                                         10898000
108990             WHEN SQLWARN0 NOT EQUAL SPACE                        10899000
109000             WHEN SQLCODE NOT EQUAL ZERO                          10900000
109010                 DISPLAY '**************************************' 10901000
109020                 DISPLAY '** ABEND                            **' 10902000
109030                 DISPLAY '** PROGRAM = TRKUP215               **' 10903000
109040                 DISPLAY '** PARAGRAPH = 7281-CLOSE-POE-CSR-AIR*' 10904000
109050                 DISPLAY '** CLOSE POE CODE AIR CURSOR        **' 10905000
109060                 DISPLAY '**************************************' 10906000
109070                 PERFORM 9100-SQL-ABEND                           10907000
109080         END-EVALUATE                                             10908000
109090     END-PERFORM.                                                 10909000
109100                                                                  10910000
109110     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10911000
109120         (SQLCODE NOT = ZERO)                                     10912000
109130         DISPLAY '****************************************'       10913000
109140         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10914000
109150         DISPLAY '** CLOSE POE CODE AIR CURSOR          **'       10915000
109160         DISPLAY '** PARAGRAPH = 7281-CLOSE-POE-CSR-AIR **'       10916000
109170         DISPLAY '****************************************'       10917000
109180         PERFORM 9100-SQL-ABEND                                   10918000
109190     END-IF.                                                      10919000
109200                                                                  10920000
109210 EJECT                                                            10921000
109220******************************************************************10922000
109230*    FETCH THE POE CODE AIR CURSOR                               *10923000
109240*THIS PARAGRAPH IS NOT BEING USED.  AME 10/2007                  *10924000
109250******************************************************************10925000
109260 7282-FETCH-POE-CURSOR-AIR.                                       10926000
109270                                                                  10927000
109280     EXEC SQL                                                     10928000
109290          FETCH POE-CSR-AIR                                       10929000
109300          INTO  :IMPOE-POE-CDE                                    10930000
109310     END-EXEC.                                                    10931000
109320                                                                  10932000
109330     EVALUATE TRUE                                                10933000
109340         WHEN SQLCODE = ZERO                                      10934000
109350         WHEN SQLCODE = -811                                      10935000
109360             MOVE IMPOE-POE-CDE TO PV-TR265-POE-CDE               10936000
109370                                                                  10937000
109380         WHEN SQLCODE = +100                                      10938000
109390             MOVE SPACES TO PV-TR265-POE-CDE                      10939000
109400                                                                  10940000
109410         WHEN SQLWARN0 NOT EQUAL SPACE                            10941000
109420         WHEN SQLCODE NOT EQUAL ZERO                              10942000
109430             DISPLAY '**************************************'     10943000
109440             DISPLAY '** ABEND                            **'     10944000
109450             DISPLAY '** PROGRAM = TRKUP215               **'     10945000
109460             DISPLAY '** PARAGRAPH = 7282-FETCH-POE-CSR-AIR*'     10946000
109470             DISPLAY '** FETCH TIMPOE POE CODE AIR        **'     10947000
109480             DISPLAY '** POE CDE AIR = ' PV-HOLD-POE-CDE          10948000
109490             DISPLAY '**************************************'     10949000
109500             PERFORM 9100-SQL-ABEND                               10950000
109510     END-EVALUATE.                                                10951000
109520                                                                  10952000
109530     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10953000
109540         (SQLCODE NOT = ZERO    AND                               10954000
109550          SQLCODE NOT = -811    AND                               10955000
109560          SQLCODE NOT = +100)                                     10956000
109570         DISPLAY '****************************************'       10957000
109580         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       10958000
109590         DISPLAY '** FETCH FROM TIMPOE                  **'       10959000
109600         DISPLAY '** PARAGRAPH = 7282-FETCH-POE-CSR-AIR **'       10960000
109610         DISPLAY '** POE CDE AIR = ' PV-HOLD-POE-CDE              10961000
109620         DISPLAY '****************************************'       10962000
109630         PERFORM 9100-SQL-ABEND                                   10963000
109640     END-IF.                                                      10964000
109650                                                                  10965000
109660 EJECT                                                            10966000
109670******************************************************************10967000
109680*   OPEN THE POE CODE OCEAN CURSOR                               *10968000
109690******************************************************************10969000
109700 7283-OPEN-POE-CURSOR-OCEAN.                                      10970000
109710                                                                  10971000
109720     PERFORM                                                      10972000
109730         WITH TEST AFTER                                          10973000
109740         VARYING PV-RETRY-COUNTER                                 10974000
109750         FROM 1 BY 1                                              10975000
109760         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10976000
109770                   OR (SQLCODE = ZERO))                           10977000
109780                                                                  10978000
109790         EXEC SQL                                                 10979000
109800              OPEN POE-CSR-OCEAN                                  10980000
109810         END-EXEC                                                 10981000
109820                                                                  10982000
109830         EVALUATE TRUE                                            10983000
109840             WHEN SQLCODE = ZERO                                  10984000
109850                 CONTINUE                                         10985000
109860             WHEN SQLWARN0 NOT EQUAL SPACE                        10986000
109870             WHEN SQLCODE NOT EQUAL ZERO                          10987000
109880                 DISPLAY '**************************************' 10988000
109890                 DISPLAY '** ABEND                            **' 10989000
109900                 DISPLAY '** PROGRAM = TRKUP215               **' 10990000
109910                 DISPLAY '** PARAGRAPH = 7283-OPEN-POE-CSR-OCN**' 10991000
109920                 DISPLAY '** OPEN POE CODE OCEAN CURSOR       **' 10992000
109930                 DISPLAY '**************************************' 10993000
109940                 PERFORM 9100-SQL-ABEND                           10994000
109950         END-EVALUATE                                             10995000
109960     END-PERFORM.                                                 10996000
109970                                                                  10997000
109980     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10998000
109990         (SQLCODE NOT = ZERO)                                     10999000
110000         DISPLAY '****************************************'       11000000
110010         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11001000
110020         DISPLAY '** OPEN POE CODE OCEAN CURSOR         **'       11002000
110030         DISPLAY '** PARAGRAPH = 7283-OPEN-POE-CURSOR-OCN*'       11003000
110040         DISPLAY '****************************************'       11004000
110050         PERFORM 9100-SQL-ABEND                                   11005000
110060     END-IF.                                                      11006000
110070                                                                  11007000
110080 EJECT                                                            11008000
110090******************************************************************11009000
110100*   CLOSE THE POE CODE OCEAN CURSOR                              *11010000
110110******************************************************************11011000
110120 7284-CLOSE-POE-CURSOR-OCEAN.                                     11012000
110130                                                                  11013000
110140     PERFORM                                                      11014000
110150         WITH TEST AFTER                                          11015000
110160         VARYING PV-RETRY-COUNTER                                 11016000
110170         FROM 1 BY 1                                              11017000
110180         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11018000
110190                   OR (SQLCODE = ZERO))                           11019000
110200                                                                  11020000
110210         EXEC SQL                                                 11021000
110220             CLOSE POE-CSR-OCEAN                                  11022000
110230         END-EXEC                                                 11023000
110240                                                                  11024000
110250         EVALUATE TRUE                                            11025000
110260             WHEN SQLCODE = ZERO                                  11026000
110270                 CONTINUE                                         11027000
110280             WHEN SQLWARN0 NOT EQUAL SPACE                        11028000
110290             WHEN SQLCODE NOT EQUAL ZERO                          11029000
110300                 DISPLAY '**************************************' 11030000
110310                 DISPLAY '** ABEND                            **' 11031000
110320                 DISPLAY '** PROGRAM = TRKUP215               **' 11032000
110330                 DISPLAY '** PARAGRAPH = 7284-CLOSE-POE-CSR-OCN*' 11033000
110340                 DISPLAY '** CLOSE POE CODE OCEAN CURSOR      **' 11034000
110350                 DISPLAY '**************************************' 11035000
110360                 PERFORM 9100-SQL-ABEND                           11036000
110370         END-EVALUATE                                             11037000
110380     END-PERFORM.                                                 11038000
110390                                                                  11039000
110400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11040000
110410         (SQLCODE NOT = ZERO)                                     11041000
110420         DISPLAY '****************************************'       11042000
110430         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11043000
110440         DISPLAY '** CLOSE POE CODE OCEAN CURSOR        **'       11044000
110450         DISPLAY '** PARAGRAPH = 7284-CLOSE-POE-CSR-OCN **'       11045000
110460         DISPLAY '****************************************'       11046000
110470         PERFORM 9100-SQL-ABEND                                   11047000
110480     END-IF.                                                      11048000
110490                                                                  11049000
110500 EJECT                                                            11050000
110510******************************************************************11051000
110520*    FETCH THE POE CODE OCEAN CURSOR                             *11052000
110530******************************************************************11053000
110540 7285-FETCH-POE-CURSOR-OCEAN.                                     11054000
110550                                                                  11055000
110560     EXEC SQL                                                     11056000
110570          FETCH POE-CSR-OCEAN                                     11057000
110580          INTO  :IMPOE-POE-CDE                                    11058000
110590     END-EXEC.                                                    11059000
110600                                                                  11060000
110610     EVALUATE TRUE                                                11061000
110620         WHEN SQLCODE = ZERO                                      11062000
110630         WHEN SQLCODE = -811                                      11063000
110640             MOVE IMPOE-POE-CDE TO PV-TR265-POE-CDE               11064000
110650                                                                  11065000
110660         WHEN SQLCODE = +100                                      11066000
110670             MOVE SPACES TO PV-TR265-POE-CDE                      11067000
110680                                                                  11068000
110690                                                                  11069000
110700         WHEN SQLWARN0 NOT EQUAL SPACE                            11070000
110710         WHEN SQLCODE NOT EQUAL ZERO                              11071000
110720             DISPLAY '**************************************'     11072000
110730             DISPLAY '** ABEND                            **'     11073000
110740             DISPLAY '** PROGRAM = TRKUP215               **'     11074000
110750             DISPLAY '** PARAGRAPH = 7285-FETCH-POE-CSR-OCN*'     11075000
110760             DISPLAY '** FETCH TIMPOE POE CODE OCEAN      **'     11076000
110770             DISPLAY '** POE CDE OCEAN  = ' PV-HOLD-POE-CDE       11077000
110780             DISPLAY '**************************************'     11078000
110790             PERFORM 9100-SQL-ABEND                               11079000
110800     END-EVALUATE.                                                11080000
110810                                                                  11081000
110820     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11082000
110830         (SQLCODE NOT = ZERO    AND                               11083000
110840          SQLCODE NOT = -811    AND                               11084000
110850          SQLCODE NOT = +100)                                     11085000
110860         DISPLAY '****************************************'       11086000
110870         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11087000
110880         DISPLAY '** FETCH FROM TIMPOE                  **'       11088000
110890         DISPLAY '** PARAGRAPH = 7285-FETCH-POE-CSR-OCN **'       11089000
110900         DISPLAY '** POE CDE OCEAN = ' PV-HOLD-POE-CDE            11090000
110910         DISPLAY '****************************************'       11091000
110920         PERFORM 9100-SQL-ABEND                                   11092000
110930     END-IF.                                                      11093000
110940                                                                  11094000
110950 EJECT                                                            11095000
110960******************************************************************11096000
110970* SELECT THE CONTAINER SEQUENCE NUMBER FROM THE CONTAINER TABLE. *11097000
110980******************************************************************11098000
110990 7288-SELECT-CONTNR-SEQ-NBR.                                      11099000
111000                                                                  11100000
111010     PERFORM                                                      11101000
111020         WITH TEST AFTER                                          11102000
111030         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11103000
111040         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11104000
111050                 SQLCODE = ZERO                                   11105000
111060                                                                  11106000
111070         EXEC SQL                                                 11107000
111080             SELECT CONTNR_SEQ_NBR                                11108000
111090                   ,ORGN_SHPD_FR_CDE                              11109000
111100              INTO :PV-HOLD-CONTNR-SEQ-NBR                        11110000
111110                  ,:PV-HOLD-ORGN-SHPD-FR-CDE                      11111000
111120               FROM TIMCNTK                                       11112000
111130              WHERE CONTNR_ID        = :TR023-CNTR-CONTNR-ID      11113000
111140                AND MOM_DPRTR_TMST   = :PV-FORMATED-DB2-TMST      11114000
111150              WITH UR                                             11115000
111160         END-EXEC                                                 11116000
111170                                                                  11117000
111180         EVALUATE TRUE                                            11118000
111190             WHEN SQLCODE = ZERO                                  11119000
111200                 CONTINUE                                         11120000
111210                                                                  11121000
111220             WHEN SQLWARN0 NOT EQUAL SPACE                        11122000
111230             WHEN SQLCODE NOT EQUAL ZERO                          11123000
111240                 DISPLAY '**************************************' 11124000
111250                 DISPLAY '** ABEND                            **' 11125000
111260                 DISPLAY '** PROGRAM = TRKUP215               **' 11126000
111270                 DISPLAY '** PARAGRAPH = 7288-SELECT-SEQ-NBR  **' 11127000
111280                 DISPLAY '** SELECT TIMCNTK FOR CONT SEQ NBR. **' 11128000
111290                 DISPLAY '** ROW NOT THERE.                   **' 11129000
111300                 DISPLAY '** CONTNR ID = ' TR023-CNTR-CONTNR-ID   11130000
111310                 DISPLAY '** SAIL DATE = '                        11131000
111320                                    TR023-CNTR-ACTL-DPRTR-DTE-MOM 11132000
111330                 DISPLAY '**************************************' 11133000
111340                 PERFORM 9100-SQL-ABEND                           11134000
111350         END-EVALUATE                                             11135000
111360     END-PERFORM.                                                 11136000
111370                                                                  11137000
111380     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11138000
111390         SQLCODE NOT = ZERO                                       11139000
111400         DISPLAY '****************************************'       11140000
111410         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11141000
111420         DISPLAY '** SELECT FROM TIMCNTK                **'       11142000
111430         DISPLAY '** PARAGRAPH = 7288-SELECT-SEQ-NBR    **'       11143000
111440         DISPLAY '** CONTNR ID = ' TR023-CNTR-CONTNR-ID           11144000
111450         DISPLAY '** SAIL DATE = ' TR023-CNTR-ACTL-DPRTR-DTE-MOM  11145000
111460         DISPLAY '****************************************'       11146000
111470         PERFORM 9100-SQL-ABEND                                   11147000
111480     END-IF.                                                      11148000
111490                                                                  11149000
111500 EJECT                                                            11150000
111510******************************************************************11151000
111520* SELECT THE MAXIMUM CONTAINER SEQUENCE NUMBER FROM THE          *11152000
111530* CONTAINER TABLE  (TIMCNTK).                                    *11153000
111540******************************************************************11154000
111550 7290-SELECT-CONTNR-SEQ-NBR-MAX.                                  11155000
111560                                                                  11156000
111570     PERFORM                                                      11157000
111580         WITH TEST AFTER                                          11158000
111590         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11159000
111600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11160000
111610                 SQLCODE = ZERO                     OR            11161000
111620                 SQLCODE = -305                     OR            11162000
111630                 SQLCODE = +100                                   11163000
111640                                                                  11164000
111650         EXEC SQL                                                 11165000
111660          SELECT                                                  11166000
111670               (CASE                                              11167000
111680                 WHEN MAX(COALESCE(B.CONTNR_SEQ_NBR,0)) >         11168000
111690                      MAX(COALESCE(A.CONTNR_SEQ_NBR,0))           11169000
111700                  THEN  MAX(COALESCE(B.CONTNR_SEQ_NBR,0))         11170000
111710                 WHEN MAX(COALESCE(A.CONTNR_SEQ_NBR,0)) >         11171000
111720                      MAX(COALESCE(B.CONTNR_SEQ_NBR,0))           11172000
111730                  THEN  MAX(COALESCE(A.CONTNR_SEQ_NBR,0))         11173000
111740                 WHEN MAX(COALESCE(A.CONTNR_SEQ_NBR,0)) =         11174000
111750                      MAX(COALESCE(B.CONTNR_SEQ_NBR,0))           11175000
111760                  THEN  MAX(COALESCE(A.CONTNR_SEQ_NBR,0))         11176000
111770                END)                                              11177000
111780            INTO :PV-CONTNR-SEQ-NBR-MAX                           11178000
111790            FROM TIMCNTK B                                        11179000
111800            FULL OUTER JOIN TAUCNTK A                             11180000
111810              ON  A.CONTNR_ID      = B.CONTNR_ID                  11181000
111820            WHERE A.CONTNR_ID      = :IMCNTK-CONTNR-ID            11182000
111830               OR B.CONTNR_ID      = :IMCNTK-CONTNR-ID            11183000
111840            WITH UR                                               11184000
111850         END-EXEC                                                 11185000
111860                                                                  11186000
111870                                                                  11187000
111880         EVALUATE TRUE                                            11188000
111890             WHEN SQLCODE = ZERO                                  11189000
111900                 MOVE PV-CONTNR-SEQ-NBR-MAX TO                    11190000
111910                      PV-TR265-CONTNR-SEQ-NBR-PREV                11191000
111920                 ADD +1 TO PV-CONTNR-SEQ-NBR-MAX                  11192000
111930                                                                  11193000
111940             WHEN SQLCODE  = +100                                 11194000
111950             WHEN SQLCODE  = -305                                 11195000
111960                 MOVE +1 TO PV-CONTNR-SEQ-NBR-MAX                 11196000
111970                                                                  11197000
111980             WHEN SQLWARN0 NOT EQUAL SPACE                        11198000
111990             WHEN SQLCODE NOT EQUAL ZERO                          11199000
112000                 DISPLAY '**************************************' 11200000
112010                 DISPLAY '** ABEND                            **' 11201000
112020                 DISPLAY '** PROGRAM = TRKUP215               **' 11202000
112030                 DISPLAY '** PARAGRAPH = 7290-SELECT-CONTNR-  **' 11203000
112040                 DISPLAY '**                  SEQ-NBR-MAX     **' 11204000
112050                 DISPLAY '** SELECT TIMCNTK                   **' 11205000
112060                 DISPLAY '** CONTNR ID =' IMCNTK-CONTNR-ID        11206000
112070                 DISPLAY '**************************************' 11207000
112080                 PERFORM 9100-SQL-ABEND                           11208000
112090         END-EVALUATE                                             11209000
112100     END-PERFORM.                                                 11210000
112110                                                                  11211000
112120     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11212000
112130         (SQLCODE NOT = ZERO               AND                    11213000
112140             SQLCODE NOT = -305            AND                    11214000
112150             SQLCODE NOT = +100)                                  11215000
112160         DISPLAY '****************************************'       11216000
112170         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11217000
112180         DISPLAY '** SELECT FROM TIMCNTK                **'       11218000
112190         DISPLAY '** PARAGRAPH = 7290-SELECT-CONTNR-SEQ **'       11219000
112200         DISPLAY '**                  NBR-MAX           **'       11220000
112210         DISPLAY '** CONTNR ID    =' IMCNTK-CONTNR-ID             11221000
112220         DISPLAY '****************************************'       11222000
112230         PERFORM 9100-SQL-ABEND                                   11223000
112240     END-IF.                                                      11224000
112250                                                                  11225000
112260 EJECT                                                            11226000
112270******************************************************************11227000
112280* SELECT FOB POE CODE FOR POE VALIDATION                         *11228000
112290******************************************************************11229000
112300 7292-SELECT-FOB-POE-CDE.                                         11230000
112310                                                                  11231000
112320     PERFORM                                                      11232000
112330         WITH TEST AFTER                                          11233000
112340         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11234000
112350         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11235000
112360                 SQLCODE = ZERO                     OR            11236000
112370                 SQLCODE = -811                     OR            11237000
112380                 SQLCODE = +100                                   11238000
112390                                                                  11239000
112400         EXEC SQL                                                 11240000
112410             SELECT A.FOB_CDE                                     11241000
112420              INTO :IMFOB-FOB-CDE                                 11242000
112430               FROM TIMFOB  A                                     11243000
112440                  , TIMPOE  B                                     11244000
112450              WHERE A.FOB_STD_EDI_CDE = :PV-HOLD-FOB-CDE          11245000
112460                AND A.STAT_CDE    =   'A'                         11246000
112470                AND A.POE_CDE     =   B.POE_CDE                   11247000
112480                AND B.STAT_CDE    =   'A'                         11248000
112490                AND B.POE_STD_EDI_CDE = :PV-HOLD-POE-CDE          11249000
112500              WITH UR                                             11250000
112510         END-EXEC                                                 11251000
112520                                                                  11252000
112530         EVALUATE TRUE                                            11253000
112540             WHEN SQLCODE = ZERO                                  11254000
112550             WHEN SQLCODE = -811                                  11255000
112560                 SET PS-VALID-POE-CDE-EXIST    TO TRUE            11256000
112570                                                                  11257000
112580             WHEN SQLCODE = +100                                  11258000
112590                 SET PS-VALID-POE-CDE-EXIST-NO TO TRUE            11259000
112600                                                                  11260000
112610             WHEN SQLWARN0 NOT EQUAL SPACE                        11261000
112620             WHEN SQLCODE NOT EQUAL ZERO                          11262000
112630                 DISPLAY '**************************************' 11263000
112640                 DISPLAY '** ABEND                            **' 11264000
112650                 DISPLAY '** PROGRAM = TRKUP215               **' 11265000
112660                 DISPLAY '** PARAGRAPH = 7292-SELECT-FOB-POE  **' 11266000
112670                 DISPLAY '** SELECT TIMFOB POE CODE           **' 11267000
112680                 DISPLAY '** CONTNR ID   = ' IMCNTK-CONTNR-ID     11268000
112690                 DISPLAY '** SAIL DATE   = ' IMCNTK-MOM-DPRTR-TMST11269000
112700                 DISPLAY '** FOB CODE    = ' PV-HOLD-FOB-CDE      11270000
112710                 DISPLAY '** POE CODE    = ' PV-HOLD-POE-CDE      11271000
112720                 DISPLAY '**************************************' 11272000
112730                 PERFORM 9100-SQL-ABEND                           11273000
112740         END-EVALUATE                                             11274000
112750     END-PERFORM.                                                 11275000
112760                                                                  11276000
112770     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11277000
112780         (SQLCODE NOT = ZERO    AND                               11278000
112790          SQLCODE NOT = -811    AND                               11279000
112800          SQLCODE NOT = +100)                                     11280000
112810         DISPLAY '****************************************'       11281000
112820         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11282000
112830         DISPLAY '** SELECT FROM TIMFOB                 **'       11283000
112840         DISPLAY '** PARAGRAPH = 7292-SELECT-FOB-POE-CDE**'       11284000
112850         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            11285000
112860         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       11286000
112870         DISPLAY '** FOB CODE     = ' PV-HOLD-FOB-CDE             11287000
112880         DISPLAY '****************************************'       11288000
112890         PERFORM 9100-SQL-ABEND                                   11289000
112900     END-IF.                                                      11290000
112910                                                                  11291000
112920 EJECT                                                            11292000
112930******************************************************************11293000
112940* SELECT FOB CODE FOR AIR.                                       *11294000
112950******************************************************************11295000
112960 7293-SELECT-FOB-AIR.                                             11296000
112970                                                                  11297000
112980     PERFORM                                                      11298000
112990         WITH TEST AFTER                                          11299000
113000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11300000
113010         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11301000
113020                 SQLCODE = ZERO                     OR            11302000
113030                 SQLCODE = -811                     OR            11303000
113040                 SQLCODE = +100                                   11304000
113050                                                                  11305000
113060         EXEC SQL                                                 11306000
113070             SELECT A.FOB_CDE                                     11307000
113080              INTO :IMFOB-FOB-CDE                                 11308000
113090               FROM TIMFOB  A                                     11309000
113100              WHERE A.FOB_CDE     =   :PV-HOLD-FOB-CDE            11310000
113110                AND A.STAT_CDE    =   'A'                         11311000
113120              WITH UR                                             11312000
113130         END-EXEC                                                 11313000
113140                                                                  11314000
113150         EVALUATE TRUE                                            11315000
113160             WHEN SQLCODE = ZERO                                  11316000
113170             WHEN SQLCODE = -811                                  11317000
113180                 SET PS-VALID-FOB-CDE    TO TRUE                  11318000
113190                                                                  11319000
113200             WHEN SQLCODE = +100                                  11320000
113210                 SET PS-INVALID-FOB-CDE  TO TRUE                  11321000
113220                                                                  11322000
113230             WHEN SQLWARN0 NOT EQUAL SPACE                        11323000
113240             WHEN SQLCODE NOT EQUAL ZERO                          11324000
113250                 DISPLAY '**************************************' 11325000
113260                 DISPLAY '** ABEND                            **' 11326000
113270                 DISPLAY '** PROGRAM = TRKUP215               **' 11327000
113280                 DISPLAY '** PARAGRAPH = 7293-SELECT-FOB-AIR  **' 11328000
113290                 DISPLAY '** SELECT TIMFOB FOB CODE           **' 11329000
113300                 DISPLAY '** CONTNR ID   = ' IMCNTK-CONTNR-ID     11330000
113310                 DISPLAY '** SAIL DATE   = ' IMCNTK-MOM-DPRTR-TMST11331000
113320                 DISPLAY '** FOB CODE    = ' PV-HOLD-FOB-CDE      11332000
113330                 DISPLAY '**************************************' 11333000
113340                 PERFORM 9100-SQL-ABEND                           11334000
113350         END-EVALUATE                                             11335000
113360     END-PERFORM.                                                 11336000
113370                                                                  11337000
113380     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11338000
113390         (SQLCODE NOT = ZERO    AND                               11339000
113400          SQLCODE NOT = -811    AND                               11340000
113410          SQLCODE NOT = +100)                                     11341000
113420         DISPLAY '****************************************'       11342000
113430         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11343000
113440         DISPLAY '** SELECT FROM TIMFOB                 **'       11344000
113450         DISPLAY '** PARAGRAPH = 7293-SELECT-FOB-AIR    **'       11345000
113460         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            11346000
113470         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       11347000
113480         DISPLAY '** FOB CODE     = ' PV-HOLD-FOB-CDE             11348000
113490         DISPLAY '****************************************'       11349000
113500         PERFORM 9100-SQL-ABEND                                   11350000
113510     END-IF.                                                      11351000
113520                                                                  11352000
113530 EJECT                                                            11353000
113540******************************************************************11354000
113550* SELECT FOB CODE FOR OCEAN.                                     *11355000
113560******************************************************************11356000
113570 7294-SELECT-FOB-OCEAN.                                           11357000
113580                                                                  11358000
113590     PERFORM                                                      11359000
113600         WITH TEST AFTER                                          11360000
113610         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11361000
113620         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11362000
113630                 SQLCODE = ZERO                     OR            11363000
113640                 SQLCODE = -811                     OR            11364000
113650                 SQLCODE = +100                                   11365000
113660                                                                  11366000
113670         EXEC SQL                                                 11367000
113680             SELECT A.FOB_CDE                                     11368000
113690              INTO :IMFOB-FOB-CDE                                 11369000
113700               FROM TIMFOB  A                                     11370000
113710              WHERE A.FOB_STD_EDI_CDE  = :PV-HOLD-FOB-CDE         11371000
113720                AND A.STAT_CDE         = 'A'                      11372000
113730              WITH UR                                             11373000
113740         END-EXEC                                                 11374000
113750                                                                  11375000
113760         EVALUATE TRUE                                            11376000
113770             WHEN SQLCODE = ZERO                                  11377000
113780             WHEN SQLCODE = -811                                  11378000
113790                 SET PS-VALID-FOB-CDE    TO TRUE                  11379000
113800                                                                  11380000
113810             WHEN SQLCODE = +100                                  11381000
113820                 SET PS-INVALID-FOB-CDE  TO TRUE                  11382000
113830                                                                  11383000
113840             WHEN SQLWARN0 NOT EQUAL SPACE                        11384000
113850             WHEN SQLCODE NOT EQUAL ZERO                          11385000
113860                 DISPLAY '**************************************' 11386000
113870                 DISPLAY '** ABEND                            **' 11387000
113880                 DISPLAY '** PROGRAM = TRKUP215               **' 11388000
113890                 DISPLAY '** PARAGRAPH = 7294-SELECT-FOB-OCEAN**' 11389000
113900                 DISPLAY '** SELECT TIMFOB FOB CODE           **' 11390000
113910                 DISPLAY '** CONTNR ID   = ' IMCNTK-CONTNR-ID     11391000
113920                 DISPLAY '** SAIL DATE   = ' IMCNTK-MOM-DPRTR-TMST11392000
113930                 DISPLAY '** FOB CODE    = ' PV-HOLD-FOB-CDE      11393000
113940                 DISPLAY '**************************************' 11394000
113950                 PERFORM 9100-SQL-ABEND                           11395000
113960         END-EVALUATE                                             11396000
113970     END-PERFORM.                                                 11397000
113980                                                                  11398000
113990     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11399000
114000         (SQLCODE NOT = ZERO    AND                               11400000
114010          SQLCODE NOT = -811 AND                                  11401000
114020          SQLCODE NOT = +100)                                     11402000
114030         DISPLAY '****************************************'       11403000
114040         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11404000
114050         DISPLAY '** SELECT FROM TIMFOB                 **'       11405000
114060         DISPLAY '** PARAGRAPH = 7294-SELECT-FOB-OCEAN  **'       11406000
114070         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            11407000
114080         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       11408000
114090         DISPLAY '** FOB CODE     = ' PV-HOLD-FOB-CDE             11409000
114100         DISPLAY '****************************************'       11410000
114110         PERFORM 9100-SQL-ABEND                                   11411000
114120     END-IF.                                                      11412000
114130                                                                  11413000
114140 EJECT                                                            11414000
114150******************************************************************11415000
114160* SELECT A ROW FROM THE PURCHASE ORDER TABLE  (TPURCHS).         *11416000
114170******************************************************************11417000
114180 7295-SELECT-TPURCHS.                                             11418000
114190                                                                  11419000
114200     PERFORM                                                      11420000
114210         WITH TEST AFTER                                          11421000
114220         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11422000
114230         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11423000
114240                 SQLCODE = ZERO                     OR            11424000
114250                 SQLCODE = +100                                   11425000
114260                                                                  11426000
114270         EXEC SQL                                                 11427000
114280             SELECT PO_NBR,                                       11428000
114290                    STATUS_CDE,                                   11429000
114300                    PKGNG_CDE,                                    11430000
114310                    NEW_STR_PO_IND                                11431000
114320              INTO :PURCHS-PO-NBR,                                11432000
114330                   :PURCHS-STATUS-CDE,                            11433000
114340                   :PURCHS-PKGNG-CDE,                             11434000
114350                   :PURCHS-NEW-STR-PO-IND                         11435000
114360                                                                  11436000
114370               FROM TPURCHS                                       11437000
114380              WHERE PO_NBR           = :IMCNPO-PO-NBR             11438000
114390                AND VER_STATUS_CDE   = 'A'                        11439000
114400              WITH UR                                             11440000
114410         END-EXEC                                                 11441000
114420                                                                  11442000
114430         EVALUATE TRUE                                            11443000
114440             WHEN SQLCODE = ZERO                                  11444000
114450                 SET PS-PURCHS-FOUND TO TRUE                      11445000
114460                                                                  11446000
114470             WHEN SQLCODE = +100                                  11447000
114480                 SET PS-PURCHS-NOT-FOUND TO TRUE                  11448000
114490                                                                  11449000
114500             WHEN SQLWARN0 NOT EQUAL SPACE                        11450000
114510             WHEN SQLCODE NOT EQUAL ZERO                          11451000
114520                 DISPLAY '**************************************' 11452000
114530                 DISPLAY '** ABEND                            **' 11453000
114540                 DISPLAY '** PROGRAM = TRKUP215               **' 11454000
114550                 DISPLAY '** PARAGRAPH = 7295-SELECT-TPURCHS  **' 11455000
114560                 DISPLAY '** SELECT FROM TPURCHS              **' 11456000
114570                 DISPLAY '** PO NUMBER      = ' IMCNPO-PO-NBR     11457000
114580                 DISPLAY '**************************************' 11458000
114590                 PERFORM 9100-SQL-ABEND                           11459000
114600         END-EVALUATE                                             11460000
114610     END-PERFORM.                                                 11461000
114620                                                                  11462000
114630     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11463000
114640         (SQLCODE NOT = ZERO AND                                  11464000
114650             SQLCODE NOT = +100)                                  11465000
114660         DISPLAY '****************************************'       11466000
114670         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11467000
114680         DISPLAY '** SELECT FROM TPURCHS                **'       11468000
114690         DISPLAY '** PARAGRAPH = 7295-SELECT-TPURCHS    **'       11469000
114700         DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR                  11470000
114710         DISPLAY '****************************************'       11471000
114720         PERFORM 9100-SQL-ABEND                                   11472000
114730     END-IF.                                                      11473000
114740                                                                  11474000
114750 EJECT                                                            11475000
114760******************************************************************11476000
114770* SELECT POL AND POR CODES FOR AIR.                              *11477000
114780******************************************************************11478000
114790 7296-SELECT-ORGN-AIR.                                            11479000
114800                                                                  11480000
114810     PERFORM                                                      11481000
114820         WITH TEST AFTER                                          11482000
114830         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11483000
114840         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11484000
114850                 SQLCODE = ZERO                     OR            11485000
114860                 SQLCODE = -811                     OR            11486000
114870                 SQLCODE = +100                                   11487000
114880                                                                  11488000
114890         EXEC SQL                                                 11489000
114900             SELECT A.IMPRT_ORGN_CDE                              11490000
114910              INTO :TRT00010-IMPRT-ORGN-CDE                       11491000
114920               FROM TRT_IMPRT_ORGN  A                             11492000
114930              WHERE A.IMPRT_ORGN_CDE = :PV-HOLD-ORGN-CDE          11493000
114940                AND A.STAT_CDE    =   'A'                         11494000
114950                AND A.IMPRT_ORGN_TYP_CDE = :PV-HOLD-ORGN-TYP-CDE  11495000
114960              WITH UR                                             11496000
114970         END-EXEC                                                 11497000
114980                                                                  11498000
114990         EVALUATE TRUE                                            11499000
115000             WHEN SQLCODE = ZERO                                  11500000
115010             WHEN SQLCODE = -811                                  11501000
115020                 SET PS-VALID-ORGN-CDE   TO TRUE                  11502000
115030                                                                  11503000
115040             WHEN SQLCODE = +100                                  11504000
115050                 SET PS-INVALID-ORGN-CDE TO TRUE                  11505000
115060                                                                  11506000
115070             WHEN SQLWARN0 NOT EQUAL SPACE                        11507000
115080             WHEN SQLCODE NOT EQUAL ZERO                          11508000
115090                 DISPLAY '**************************************' 11509000
115100                 DISPLAY '** ABEND                            **' 11510000
115110                 DISPLAY '** PROGRAM = TRKUP215               **' 11511000
115120                 DISPLAY '** PARAGRAPH = 7296-SELECT-ORGN-AIR **' 11512000
115130                 DISPLAY '** SELECT FROM TRT_IMPRT_ORGN       **' 11513000
115140                 DISPLAY '** CONTNR ID   = ' IMCNTK-CONTNR-ID     11514000
115150                 DISPLAY '** SAIL DATE   = ' IMCNTK-MOM-DPRTR-TMST11515000
115160                 DISPLAY '** ORIGIN CODE = ' PV-HOLD-ORGN-CDE     11516000
115170                 DISPLAY '**************************************' 11517000
115180                 PERFORM 9100-SQL-ABEND                           11518000
115190         END-EVALUATE                                             11519000
115200     END-PERFORM.                                                 11520000
115210                                                                  11521000
115220     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11522000
115230         (SQLCODE NOT = ZERO    AND                               11523000
115240          SQLCODE NOT = -811    AND                               11524000
115250          SQLCODE NOT = +100)                                     11525000
115260         DISPLAY '****************************************'       11526000
115270         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11527000
115280         DISPLAY '** SELECT FROM TRT_IMPRT_ORGN         **'       11528000
115290         DISPLAY '** PARAGRAPH = 7296-SELECT-ORGN-AIR   **'       11529000
115300         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            11530000
115310         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       11531000
115320         DISPLAY '** ORIGIN CODE  = ' PV-HOLD-ORGN-CDE            11532000
115330         DISPLAY '****************************************'       11533000
115340         PERFORM 9100-SQL-ABEND                                   11534000
115350     END-IF.                                                      11535000
115360                                                                  11536000
115370 EJECT                                                            11537000
115380******************************************************************11538000
115390* SELECT POL AND POR CODES FOR OCEAN.                            *11539000
115400******************************************************************11540000
115410 7297-SELECT-ORGN-OCEAN.                                          11541000
115420                                                                  11542000
115430     PERFORM                                                      11543000
115440         WITH TEST AFTER                                          11544000
115450         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11545000
115460         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11546000
115470                 SQLCODE = ZERO                     OR            11547000
115480                 SQLCODE = -811                     OR            11548000
115490                 SQLCODE = +100                                   11549000
115500                                                                  11550000
115510         EXEC SQL                                                 11551000
115520             SELECT A.IMPRT_ORGN_CDE                              11552000
115530              INTO :TRT00010-IMPRT-ORGN-CDE                       11553000
115540               FROM TRT_IMPRT_ORGN  A                             11554000
115550              WHERE A.STD_EDI_CDE  = :PV-HOLD-ORGN-CDE            11555000
115560                AND A.STAT_CDE     = 'A'                          11556000
115570                AND A.IMPRT_ORGN_TYP_CDE = :PV-HOLD-ORGN-TYP-CDE  11557000
115580              WITH UR                                             11558000
115590         END-EXEC                                                 11559000
115600                                                                  11560000
115610         EVALUATE TRUE                                            11561000
115620             WHEN SQLCODE = ZERO                                  11562000
115630             WHEN SQLCODE = -811                                  11563000
115640                 SET PS-VALID-ORGN-CDE   TO TRUE                  11564000
115650                                                                  11565000
115660             WHEN SQLCODE = +100                                  11566000
115670                 SET PS-INVALID-ORGN-CDE TO TRUE                  11567000
115680                                                                  11568000
115690             WHEN SQLWARN0 NOT EQUAL SPACE                        11569000
115700             WHEN SQLCODE NOT EQUAL ZERO                          11570000
115710                 DISPLAY '**************************************' 11571000
115720                 DISPLAY '** ABEND                            **' 11572000
115730                 DISPLAY '** PROGRAM = TRKUP215               **' 11573000
115740                 DISPLAY '** PARAGRAPH = 7297-SELECT-ORGN-OCEAN*' 11574000
115750                 DISPLAY '** SELECT TRT_IMPRT_ORGN            **' 11575000
115760                 DISPLAY '** CONTNR ID   = ' IMCNTK-CONTNR-ID     11576000
115770                 DISPLAY '** SAIL DATE   = ' IMCNTK-MOM-DPRTR-TMST11577000
115780                 DISPLAY '** ORIGIN CODE = ' PV-HOLD-ORGN-CDE     11578000
115790                 DISPLAY '**************************************' 11579000
115800                 PERFORM 9100-SQL-ABEND                           11580000
115810         END-EVALUATE                                             11581000
115820     END-PERFORM.                                                 11582000
115830                                                                  11583000
115840     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11584000
115850         (SQLCODE NOT = ZERO    AND                               11585000
115860          SQLCODE NOT = -811 AND                                  11586000
115870          SQLCODE NOT = +100)                                     11587000
115880         DISPLAY '****************************************'       11588000
115890         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11589000
115900         DISPLAY '** SELECT FROM TRT_IMPRT_ORGN         **'       11590000
115910         DISPLAY '** PARAGRAPH = 7297-SELECT-ORGN-CDE   **'       11591000
115920         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            11592000
115930         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       11593000
115940         DISPLAY '** ORIGIN CODE  = ' PV-HOLD-ORGN-CDE            11594000
115950         DISPLAY '****************************************'       11595000
115960         PERFORM 9100-SQL-ABEND                                   11596000
115970     END-IF.                                                      11597000
115980                                                                  11598000
115990 EJECT                                                            11599000
116000******************************************************************11600000
116010* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *11601000
116020******************************************************************11602000
116030 7298-SELECT-TPURITM1.                                            11603000
116040                                                                  11604000
116050     PERFORM                                                      11605000
116060         WITH TEST AFTER                                          11606000
116070         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11607000
116080         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11608000
116090                 SQLCODE = ZERO                     OR            11609000
116100                 SQLCODE = +100                     OR            11610000
116110                 SQLCODE = -811                                   11611000
116120                                                                  11612000
116130         EXEC SQL                                                 11613000
116140             SELECT A.STATUS_CDE                                  11614000
116150                   ,A.APP_PO_LNE_NBR                              11615000
116160                   ,A.ITM_NBR                                     11616000
116170                   ,A.PO_PREPK_ID                                 11617000
116180                   ,A.OUTR_PK_QTY                                 11618000
116190               INTO :PURITM-STATUS-CDE                            11619000
116200                   ,:PURITM-APP-PO-LNE-NBR                        11620000
116210                   ,:PURITM-ITM-NBR                               11621000
116220                   ,:PV-PO-PREPK-ID                               11622000
116230                   ,:PURITM-OUTR-PK-QTY                           11623000
116240               FROM TPURITM  A                                    11624000
116250                   ,TUPCSKU  B                                    11625000
116260              WHERE B.UPC_NBR        = :IMCNUP-UPC-NBR            11626000
116270                AND B.ITEM_NBR       = A.ITM_NBR                  11627000
116280                AND A.PO_NBR         = :IMCNUP-PO-NBR             11628000
116290                AND A.VER_STATUS_CDE = 'A'                        11629000
116300                AND A.STATUS_CDE    NOT IN ('AC', 'AP', 'RV')     11630000
116310              WITH UR                                             11631000
116320         END-EXEC                                                 11632000
116330                                                                  11633000
116340         EVALUATE TRUE                                            11634000
116350             WHEN SQLCODE = ZERO                                  11635000
116360             WHEN SQLCODE = -811                                  11636000
116370                 SET PS-PURITM1-FOUND TO TRUE                     11637000
116380                                                                  11638000
116390             WHEN SQLCODE = +100                                  11639000
116400                 SET PS-PURITM1-NOT-FOUND TO TRUE                 11640000
116410                 MOVE ZEROES TO PV-PO-PREPK-ID                    11641000
116420                                                                  11642000
116430             WHEN SQLWARN0 NOT EQUAL SPACE                        11643000
116440             WHEN SQLCODE NOT EQUAL ZERO                          11644000
116450                 DISPLAY '**************************************' 11645000
116460                 DISPLAY '** ABEND                            **' 11646000
116470                 DISPLAY '** PROGRAM = TRKUP215               **' 11647000
116480                 DISPLAY '** PARAGRAPH = 7298-SELECT-TPURITM1 **' 11648000
116490                 DISPLAY '** SELECT FROM TPURITM              **' 11649000
116500                 DISPLAY '** PO NUMBER   = ' IMCNUP-PO-NBR        11650000
116510                 DISPLAY '** UPC NUMBER  = ' IMCNUP-UPC-NBR       11651000
116520                 DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE    11652000
116530                 DISPLAY '**************************************' 11653000
116540                 PERFORM 9100-SQL-ABEND                           11654000
116550         END-EVALUATE                                             11655000
116560     END-PERFORM.                                                 11656000
116570                                                                  11657000
116580     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11658000
116590         (SQLCODE NOT = ZERO    AND                               11659000
116600             SQLCODE NOT = +100 AND                               11660000
116610             SQLCODE NOT = -811)                                  11661000
116620         DISPLAY '****************************************'       11662000
116630         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11663000
116640         DISPLAY '** SELECT FROM TPURITM                **'       11664000
116650         DISPLAY '** PARAGRAPH = 7298-SELECT-TPURITM1   **'       11665000
116660         DISPLAY '** PO NUMBER   = ' IMCNUP-PO-NBR                11666000
116670         DISPLAY '** UPC NUMBER  = ' IMCNUP-UPC-NBR               11667000
116680         DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            11668000
116690         DISPLAY '****************************************'       11669000
116700         PERFORM 9100-SQL-ABEND                                   11670000
116710     END-IF.                                                      11671000
116720                                                                  11672000
116730 EJECT                                                            11673000
116740******************************************************************11674000
116750* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *11675000
116760******************************************************************11676000
116770 7299-SELECT-TPURITM2.                                            11677000
116780                                                                  11678000
116790     PERFORM                                                      11679000
116800         WITH TEST AFTER                                          11680000
116810         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11681000
116820         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11682000
116830                 SQLCODE = ZERO                     OR            11683000
116840                 SQLCODE = +100                     OR            11684000
116850                 SQLCODE = -811                                   11685000
116860                                                                  11686000
116870         EXEC SQL                                                 11687000
116880             SELECT A.STATUS_CDE                                  11688000
116890                  , A.APP_PO_LNE_NBR                              11689000
116900                  , A.ITM_NBR                                     11690000
116910                  , A.PO_PREPK_ID                                 11691000
116920                  , A.OUTR_PK_QTY                                 11692000
116930               INTO :PURITM-STATUS-CDE                            11693000
116940                  , :PURITM-APP-PO-LNE-NBR                        11694000
116950                  , :PURITM-ITM-NBR                               11695000
116960                  , :PV-PO-PREPK-ID                               11696000
116970                  , :PURITM-OUTR-PK-QTY                           11697000
116980               FROM TPURITM  A                                    11698000
116990                   ,TUPCSKU  B                                    11699000
117000              WHERE B.UPC_NBR        = :IMCNUP-UPC-NBR            11700000
117010                AND B.ITEM_NBR       = A.ITM_NBR                  11701000
117020                AND A.PO_NBR         = :IMCNUP-PO-NBR             11702000
117030                AND A.VER_STATUS_CDE = 'A'                        11703000
117040                AND A.STATUS_CDE    IN ('AC', 'AP', 'RV')         11704000
117050              WITH UR                                             11705000
117060         END-EXEC                                                 11706000
117070                                                                  11707000
117080         EVALUATE TRUE                                            11708000
117090             WHEN SQLCODE = ZERO                                  11709000
117100             WHEN SQLCODE = -811                                  11710000
117110                 SET PS-PURITM2-FOUND TO TRUE                     11711000
117120                                                                  11712000
117130             WHEN SQLCODE = +100                                  11713000
117140                 SET PS-PURITM2-NOT-FOUND TO TRUE                 11714000
117150                 MOVE ZEROES TO PV-PO-PREPK-ID                    11715000
117160                                                                  11716000
117170             WHEN SQLWARN0 NOT EQUAL SPACE                        11717000
117180             WHEN SQLCODE NOT EQUAL ZERO                          11718000
117190                 DISPLAY '**************************************' 11719000
117200                 DISPLAY '** ABEND                            **' 11720000
117210                 DISPLAY '** PROGRAM = TRKUP215               **' 11721000
117220                 DISPLAY '** PARAGRAPH = 7299-SELECT-TPURITM2 **' 11722000
117230                 DISPLAY '** SELECT FROM TPURITM              **' 11723000
117240                 DISPLAY '** PO NUMBER   = ' IMCNUP-PO-NBR        11724000
117250                 DISPLAY '** UPC NUMBER  = ' IMCNUP-UPC-NBR       11725000
117260                 DISPLAY '**************************************' 11726000
117270                 PERFORM 9100-SQL-ABEND                           11727000
117280         END-EVALUATE                                             11728000
117290     END-PERFORM.                                                 11729000
117300                                                                  11730000
117310     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11731000
117320         (SQLCODE NOT = ZERO    AND                               11732000
117330             SQLCODE NOT = +100 AND                               11733000
117340             SQLCODE NOT = -811)                                  11734000
117350         DISPLAY '****************************************'       11735000
117360         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11736000
117370         DISPLAY '** SELECT FROM TPURITM                **'       11737000
117380         DISPLAY '** PARAGRAPH = 7299-SELECT-TPURITM2   **'       11738000
117390         DISPLAY '** PO NUMBER   = ' IMCNUP-PO-NBR                11739000
117400         DISPLAY '** UPC NUMBER  = ' IMCNUP-UPC-NBR               11740000
117410         DISPLAY '****************************************'       11741000
117420         PERFORM 9100-SQL-ABEND                                   11742000
117430     END-IF.                                                      11743000
117440                                                                  11744000
117450 EJECT                                                            11745000
117460******************************************************************11746000
117470* OPEN THE CONTAINER PO CURSOR.                                  *11747000
117480******************************************************************11748000
117490 7300-OPEN-CONPO-CURSOR.                                          11749000
117500                                                                  11750000
117510     EXEC SQL                                                     11751000
117520          OPEN CONPO_CUR                                          11752000
117530     END-EXEC.                                                    11753000
117540                                                                  11754000
117550     EVALUATE TRUE                                                11755000
117560         WHEN SQLWARN0 NOT EQUAL SPACE                            11756000
117570         WHEN SQLCODE NOT EQUAL ZERO                              11757000
117580             DISPLAY '** ABEND **'                                11758000
117590             DISPLAY '** PROGRAM = TRKUP215 **'                   11759000
117600             DISPLAY '** PARAGRAPH = 7300-OPEN-CONPO-CURSOR **'   11760000
117610             PERFORM 9100-SQL-ABEND                               11761000
117620     END-EVALUATE.                                                11762000
117630                                                                  11763000
117640******************************************************************11764000
117650* CLOSE THE CONTAINER PO CURSOR.                                 *11765000
117660******************************************************************11766000
117670 7310-CLOSE-CONPO-CURSOR.                                         11767000
117680                                                                  11768000
117690     EXEC SQL                                                     11769000
117700         CLOSE CONPO_CUR                                          11770000
117710     END-EXEC.                                                    11771000
117720                                                                  11772000
117730     EVALUATE TRUE                                                11773000
117740         WHEN SQLWARN0 NOT EQUAL SPACE                            11774000
117750         WHEN SQLCODE NOT EQUAL ZERO                              11775000
117760             DISPLAY '** ABEND **'                                11776000
117770             DISPLAY '** PROGRAM = TRKUP215 **'                   11777000
117780             DISPLAY '** PARAGRAPH = 7310-CLOSE-CONPO-CURSOR**'   11778000
117790             PERFORM 9100-SQL-ABEND                               11779000
117800     END-EVALUATE.                                                11780000
117810                                                                  11781000
117820******************************************************************11782000
117830* FETCH THE CONTAINER PO CURSOR                                  *11783000
117840******************************************************************11784000
117850 7320-FETCH-CONPO-CURSOR.                                         11785000
117860                                                                  11786000
117870     EXEC SQL                                                     11787000
117880          FETCH CONPO_CUR                                         11788000
117890              INTO :IMCNPO-CONTNR-ID,                             11789000
117900                   :IMCNPO-CONTNR-SEQ-NBR,                        11790000
117910                   :IMCNPO-PO-NBR,                                11791000
117920                   :IMCNPO-CSTM-ENTR-ID,                          11792000
117930                   :IMCNPO-MSTR-BOL-NBR,                          11793000
117940                   :IMCNPO-HSE-BOL-NBR,                           11794000
117950                   :IMCNPO-LTR-OF-CR-NBR,                         11795000
117960                   :IMCNPO-PO-RCVD-DELY-TMST,                     11796000
117970                   :IMCNPO-PO-C-O-PROD-CDE,                       11797000
117980                   :IMCNPO-PO-CART-CNT,                           11798000
117990                   :IMCNPO-PO-CBMT-QTY,                           11799000
118000                   :IMCNPO-PO-WT-KGRM-QTY,                        11800000
118010                   :IMCNPO-PO-UNT-QTY,                            11801000
118020                   :IMCNPO-CRE-BY-USR-ID,                         11802000
118030                   :IMCNPO-CRE-TMST,                              11803000
118040                   :IMCNPO-LAST-UPD-BY-USR-ID,                    11804000
118050                   :IMCNPO-LAST-UPD-TMST,                         11805000
118060                   :IMCNPO-EXTL-REF-NBR,                          11806000
118070                   :IMCNPO-BKR-FRGT-RLSE-CDE,                     11807000
118080                   :IMCNPO-DO-RCVD-CDE,                           11808000
118090                   :IMCNPO-CONTNR-PU-CDE,                         11809000
118100                   :IMCNPO-ACTL-POE-DELY-CDE,                     11810000
118110                   :IMCNPO-DVN-CDE,                               11811000
118120                   :IMCNPO-DCONSLR-RET-CDE,                       11812000
118130                   :IMCNPO-SPLT-XMIT-CDE,                         11813000
118140                   :IMCNPO-DOC-RCVD-ORGN-TMST                     11814000
118150     END-EXEC.                                                    11815000
118160                                                                  11816000
118170     EVALUATE TRUE                                                11817000
118180         WHEN SQLCODE = ZERO                                      11818000
118190              CONTINUE                                            11819000
118200                                                                  11820000
118210         WHEN SQLCODE = +100                                      11821000
118220              SET PS-EOC-CONPO-CURSOR          TO TRUE            11822000
118230                                                                  11823000
118240         WHEN SQLWARN0 NOT EQUAL SPACE                            11824000
118250         WHEN SQLCODE NOT EQUAL ZERO                              11825000
118260             DISPLAY '** ABEND                              **'   11826000
118270             DISPLAY '** PROGRAM = TRKUP215                 **'   11827000
118280             DISPLAY '** PARAGRAPH = 7320-FETCH-CONPO-CURSOR**'   11828000
118290             PERFORM 9100-SQL-ABEND                               11829000
118300     END-EVALUATE.                                                11830000
118310                                                                  11831000
118320 EJECT                                                            11832000
118330                                                                  11833000
118340******************************************************************11834000
118350* RETRIEVE THE CSTM_ENTR_ID FROM THE CUSTOMS TABLES TO POPULATE   11835000
118360* THE CSTM_ENTR_ID FIELD FOR AN INSERT ON TIMCNPO.                11836000
118370******************************************************************11837000
118380 7330-SELECT-FOR-CNPO-ENTR-ID.                                    11838000
118390                                                                  11839000
118400     INITIALIZE PV-IMCNPO-CSTM-ENTR-ID.                           11840000
118410                                                                  11841000
118420     PERFORM                                                      11842000
118430         WITH TEST AFTER                                          11843000
118440         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11844000
118450         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11845000
118460                 SQLCODE = ZERO                     OR            11846000
118470                 SQLCODE = +100                     OR            11847000
118480                 SQLCODE = -811                                   11848000
118490                                                                  11849000
118500         EXEC SQL                                                 11850000
118510             SELECT DISTINCT                                      11851000
118520                   A.CSTM_ENTR_ID                                 11852000
118530              INTO :PV-IMCNPO-CSTM-ENTR-ID                        11853000
118540              FROM TIMCSPO   A                                    11854000
118550                 , TIMCSCN   B                                    11855000
118560             WHERE A.CSTM_ENTR_ID = B.CSTM_ENTR_ID                11856000
118570               AND A.PO_NBR = :IMCNPO-PO-NBR                      11857000
118580               AND B.CONTNR_ID = :IMCNPO-CONTNR-ID                11858000
118590             WITH UR                                              11859000
118600         END-EXEC                                                 11860000
118610                                                                  11861000
118620         EVALUATE TRUE                                            11862000
118630             WHEN SQLCODE = ZERO                                  11863000
118640                   ADD +1 TO PA-ENTR-ID-SELECTS                   11864000
118650                   MOVE PV-IMCNPO-CSTM-ENTR-ID  TO                11865000
118660                             IMCNPO-CSTM-ENTR-ID                  11866000
118670                   DISPLAY 'SINGLE HIT CSTM ENTR ID'              11867000
118680                   DISPLAY 'CSTM ENTR ID =' PV-IMCNPO-CSTM-ENTR-ID11868000
118690                   DISPLAY 'CNTNR ID     =' IMCNPO-CONTNR-ID      11869000
118700                   DISPLAY 'PO NBR       =' IMCNPO-PO-NBR         11870000
118710             WHEN SQLCODE = -811                                  11871000
118720                 PERFORM 7335-SELECT-MINIMUM-ENTR-ID              11872000
118730                 IF PS-LANDED-PO-NOT-FOUND                        11873000
118740                     PERFORM 7345-MULTIPLE-ENTR-ID-ERR            11874000
118750                 END-IF                                           11875000
118760                                                                  11876000
118770             WHEN SQLCODE = +100                                  11877000
118780                 CONTINUE                                         11878000
118790                   DISPLAY 'SQLCODE = 100'                        11879000
118800                   DISPLAY 'CSTM ENTR ID =' PV-IMCNPO-CSTM-ENTR-ID11880000
118810                   DISPLAY 'CNTNR ID     =' IMCNPO-CONTNR-ID      11881000
118820                   DISPLAY 'PO NBR       =' IMCNPO-PO-NBR         11882000
118830                                                                  11883000
118840             WHEN SQLWARN0 NOT EQUAL SPACE                        11884000
118850             WHEN SQLCODE NOT EQUAL ZERO                          11885000
118860             DISPLAY '*******************************************'11886000
118870             DISPLAY '** ABEND                                 **'11887000
118880             DISPLAY '** PROGRAM = TRKUP215                    **'11888000
118890             DISPLAY '** PARAGRAPH = 7330-SELECT-FOR-CNPO-ENTR-ID'11889000
118900             DISPLAY '** SELECT FROM TIMCSPO AND TIMCSCN       **'11890000
118910             DISPLAY '** CNTNR ID     =' IMCNPO-CONTNR-ID         11891000
118920             DISPLAY '** PO NBR       =' IMCNPO-PO-NBR            11892000
118930             DISPLAY '*******************************************'11893000
118940             PERFORM 9100-SQL-ABEND                               11894000
118950         END-EVALUATE                                             11895000
118960     END-PERFORM.                                                 11896000
118970                                                                  11897000
118980     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11898000
118990         (SQLCODE NOT = ZERO    AND                               11899000
119000             SQLCODE NOT = +100 AND                               11900000
119010             SQLCODE NOT = -811)                                  11901000
119020         DISPLAY '****************************************'       11902000
119030         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11903000
119040         DISPLAY '** SELECT FROM TIMCSPO AND TIMCSCN    **'       11904000
119050         DISPLAY '** PARAGRAPH = 7330-SELECT-FOR-CNPO-ENTR-ID'    11905000
119060         DISPLAY '** CNTNR ID  = ' IMCNPO-CONTNR-ID               11906000
119070         DISPLAY '** PO NBR    = ' IMCNPO-PO-NBR                  11907000
119080         DISPLAY '****************************************'       11908000
119090         PERFORM 9100-SQL-ABEND                                   11909000
119100     END-IF.                                                      11910000
119110                                                                  11911000
119120 EJECT                                                            11912000
119130                                                                  11913000
119140******************************************************************11914000
119150* THERE SHOULD ONLY BE ONE PO/CONTAINER FOR A CSTM_ENTR_ID, BUT   11915000
119160* BUT THIS IS A BUSINESS RULE, NOT A PART OF THE DB2 INDICES. A   11916000
119170* FEW PO/CONTAINERS ARE ON MORE THAN ONE ENTRY FROM EXPEDITOR'S,  11917000
119180* SO POPULATE THE CSTM_ENTR_ID FIELD ON THE TIMCNPO INSERT WITH   11918000
119190* THE LOWEST CSTM_ENTR_ID FOUND, THEN WRITE A WRN LEVEL MESSAGE   11919000
119200* TO THE ERROR REPORT.                                            11920000
119210******************************************************************11921000
119220 7335-SELECT-MINIMUM-ENTR-ID.                                     11922000
119230                                                                  11923000
119240     PERFORM                                                      11924000
119250         WITH TEST AFTER                                          11925000
119260         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11926000
119270         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            11927000
119280                 SQLCODE = ZERO                                   11928000
119290                                                                  11929000
119300         EXEC SQL                                                 11930000
119310             SELECT MIN (A.CSTM_ENTR_ID)                          11931000
119320              INTO :PV-IMCNPO-CSTM-ENTR-ID                        11932000
119330              FROM TIMCSPO   A                                    11933000
119340                 , TIMCSCN   B                                    11934000
119350             WHERE A.CSTM_ENTR_ID = B.CSTM_ENTR_ID                11935000
119360               AND A.PO_NBR = :IMCNPO-PO-NBR                      11936000
119370             WITH UR                                              11937000
119380         END-EXEC                                                 11938000
119390                                                                  11939000
119400         EVALUATE TRUE                                            11940000
119410             WHEN SQLCODE = ZERO                                  11941000
119420                   ADD +1 TO PA-MULTI-ENTR-ID-SELECTS             11942000
119430                   MOVE PV-IMCNPO-CSTM-ENTR-ID  TO                11943000
119440                             IMCNPO-CSTM-ENTR-ID                  11944000
119450                   DISPLAY 'MULTI HIT CSTM ENTR ID'               11945000
119460                   DISPLAY 'CSTM ENTR ID =' PV-IMCNPO-CSTM-ENTR-ID11946000
119470                   DISPLAY 'CNTNR ID     =' IMCNPO-CONTNR-ID      11947000
119480                   DISPLAY 'PO NBR       =' IMCNPO-PO-NBR         11948000
119490                                                                  11949000
119500             WHEN SQLWARN0 NOT EQUAL SPACE                        11950000
119510             WHEN SQLCODE NOT EQUAL ZERO                          11951000
119520             DISPLAY '*******************************************'11952000
119530             DISPLAY '** ABEND                                 **'11953000
119540             DISPLAY '** PROGRAM = TRKUP215                    **'11954000
119550             DISPLAY '** PARAGRAPH = 7335-SELECT-MINIMUM-ENTR-ID' 11955000
119560             DISPLAY '** SELECT FROM TIMCSPO AND TIMCSCN       **'11956000
119570             DISPLAY '** CNTNR ID     =' IMCNPO-CONTNR-ID         11957000
119580             DISPLAY '** PO NBR       =' IMCNPO-PO-NBR            11958000
119590             DISPLAY '**************************************'     11959000
119600             PERFORM 9100-SQL-ABEND                               11960000
119610         END-EVALUATE                                             11961000
119620     END-PERFORM.                                                 11962000
119630                                                                  11963000
119640     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11964000
119650         SQLCODE NOT = ZERO                                       11965000
119660         DISPLAY '****************************************'       11966000
119670         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11967000
119680         DISPLAY '** SELECT FROM TIMCSPO AND TIMCSCN    **'       11968000
119690         DISPLAY '** PARAGRAPH = 7335-SELECT-MINIMUM-ENTR-ID'     11969000
119700         DISPLAY '** CNTNR ID  = ' IMCNPO-CONTNR-ID               11970000
119710         DISPLAY '** PO NBR    = ' IMCNPO-PO-NBR                  11971000
119720         DISPLAY '****************************************'       11972000
119730         PERFORM 9100-SQL-ABEND                                   11973000
119740     END-IF.                                                      11974000
119750                                                                  11975000
119760 EJECT                                                            11976000
119770                                                                  11977000
119780******************************************************************11978000
119790* WRITE OUT A WARNING LEVEL ERROR MESSAGE TO THE ERROR REPORT    *11979000
119800* IF MULTIPLE CSTMS ENTRIES FOR A PO/CONTAINER EXIST.            *11980000
119810******************************************************************11981000
119820 7345-MULTIPLE-ENTR-ID-ERR.                                       11982000
119830                                                                  11983000
119840        MOVE PC-WARNING            TO TR211-ERROR-TYPE.           11984000
119850        MOVE IMCNPO-PO-NBR         TO TR211-DATA-VALUE.           11985000
119860        MOVE 'PO NUMBER'           TO TR211-DATA-IN-ERROR.        11986000
119870        MOVE 'PO/CONTAINER HAS MULTIPLE CUSTOM ENTRIES'           11987000
119880                                   TO TR211-ERROR-MSG.            11988000
119890        PERFORM 5820-LOAD-CONPOA-TO-REPORT.                       11989000
119900                                                                  11990000
119910        MOVE PC-WARNING            TO TR211-ERROR-TYPE.           11991000
119920        MOVE IMCNPO-CONTNR-ID      TO TR211-DATA-VALUE.           11992000
119930        MOVE 'CONTAINER ID'        TO TR211-DATA-IN-ERROR.        11993000
119940        MOVE 'PO/CONTAINER HAS MULTIPLE CUSTOM ENTRIES'           11994000
119950                                   TO TR211-ERROR-MSG.            11995000
119960        PERFORM 5820-LOAD-CONPOA-TO-REPORT.                       11996000
119970                                                                  11997000
119980 EJECT                                                            11998000
119990                                                                  11999000
120000******************************************************************12000000
120010* SELECT VENDOR OUTER PACK QTY.                                  *12001000
120020******************************************************************12002000
120030 7350-SELECT-TUPC-INFO.                                           12003000
120040                                                                  12004000
120050     IF PURITM-ITM-NBR NUMERIC                                    12005000
120060     EXEC SQL                                                     12006000
120070             SELECT B.OUTR_PK_QTY                                 12007000
120080             INTO   :UPC-OUTR-PK-QTY                              12008000
120090             FROM   TSKXREF A,                                    12009000
120100                    TUPC    B                                     12010000
120110             WHERE A.ITM_NBR        =  :PURITM-ITM-NBR            12011000
120120             AND   A.INTR_UPC_ID    =  B.INTR_UPC_ID              12012000
120130             AND   B.UPC_TYP_CDE    = 'I'                         12013000
120140             WITH UR                                              12014000
120150     END-EXEC                                                     12015000
120160     ELSE                                                         12016000
120170       MOVE +100 TO SQLCODE                                       12017000
120180       DISPLAY '** PARAGRAPH = 7350-SELECT-TUPC-INFO**'           12018000
120190       DISPLAY '** BYPASSED NON-NUMERIC PURITM-ITM-NBR'           12019000
120200     END-IF.                                                      12020000
120210                                                                  12021000
120220     EVALUATE TRUE                                                12022000
120230         WHEN SQLCODE = ZERO                                      12023000
120240             CONTINUE                                             12024000
120250                                                                  12025000
120260         WHEN SQLCODE = +100                                      12026000
120270             MOVE 0 TO UPC-OUTR-PK-QTY                            12027000
120280                                                                  12028000
120290         WHEN SQLWARN0 NOT EQUAL SPACE                            12029000
120300         WHEN SQLCODE NOT EQUAL ZERO                              12030000
120310             DISPLAY '** ABEND **'                                12031000
120320             DISPLAY '** PROGRAM = TRKUP215 **'                   12032000
120330             DISPLAY '** PARAGRAPH = 7350-SELECT-TUPC-INFO**'     12033000
120340             DISPLAY '** PURITM-ITM-NBR = ' PURITM-ITM-NBR        12034000
120350             PERFORM 9100-SQL-ABEND                               12035000
120360     END-EVALUATE.                                                12036000
120370                                                                  12037000
120380******************************************************************12038000
120390* SELECT PURCHASE ORDER PREPACK INFORMATION.                     *12039000
120400******************************************************************12040000
120410 7355-SELECT-TPOPRPK-INFO.                                        12041000
120420                                                                  12042000
120430     EXEC SQL                                                     12043000
120440           SELECT                                                 12044000
120450                  OTPK_UNT_QTY                                    12045000
120460                , INPK_UNT_QTY                                    12046000
120470                , PREPK_TYP_CDE                                   12047000
120480             INTO                                                 12048000
120490                 :POPRPK-OTPK-UNT-QTY                             12049000
120500               , :POPRPK-INPK-UNT-QTY                             12050000
120510               , :PV-PREPK-TYP-CDE                                12051000
120520             FROM                                                 12052000
120530                  TPOPRPK                                         12053000
120540            WHERE PO_NBR      =  :IMCNUP-PO-NBR                   12054000
120550              AND PO_PREPK_ID =  :PV-PO-PREPK-ID                  12055000
120560              AND PREPK_UPC_NBR = :IMCNUP-UPC-NBR                 12056000
120570            WITH UR                                               12057000
120580     END-EXEC                                                     12058000
120590                                                                  12059000
120600     EVALUATE TRUE                                                12060000
120610         WHEN SQLCODE = ZERO                                      12061000
120620             IF PV-PREPK-TYP-CDE = PC-I                           12062000
120630                 MOVE POPRPK-OTPK-UNT-QTY TO PV-POPRPK-UNT-QTY    12063000
120640             ELSE                                                 12064000
120650                 MOVE POPRPK-INPK-UNT-QTY TO PV-POPRPK-UNT-QTY    12065000
120660             END-IF                                               12066000
120670                                                                  12067000
120680         WHEN SQLCODE = +100                                      12068000
120690         WHEN SQLCODE = -811                                      12069000
120700             MOVE 0 TO PV-POPRPK-UNT-QTY                          12070000
120710                                                                  12071000
120720         WHEN SQLWARN0 NOT EQUAL SPACE                            12072000
120730         WHEN SQLCODE NOT EQUAL ZERO                              12073000
120740             DISPLAY '** ABEND **'                                12074000
120750             DISPLAY '** PROGRAM = TRKUP215 **'                   12075000
120760             DISPLAY '** PARAGRAPH = 7355-SELECT-TPOPRPK-INFO**'  12076000
120770             DISPLAY '** PO NBR     = ' IMCNUP-PO-NBR             12077000
120780             DISPLAY '** PREPACK ID = ' PV-PO-PREPK-ID            12078000
120790             PERFORM 9100-SQL-ABEND                               12079000
120800     END-EVALUATE.                                                12080000
120810                                                                  12081000
120820                                                                  12082000
120830******************************************************************12083000
120840* SELECT PURCHASE ORDER SKU PREPACK INFORMATION.                 *12084000
120850******************************************************************12085000
120860 7356-SELECT-TPOPRPK-SKU-INFO.                                    12086000
120870                                                                  12087000
120880     MOVE TR023-CONUPC-UPC-NBR TO PV-PACK-UPC-NBR.                12088000
120890     MOVE TR023-CONUPC-SKU TO PV-PACK-SKU-NBR.                    12089000
120900                                                                  12090000
120910     EXEC SQL                                                     12091000
120920           SELECT                                                 12092000
120930                  PREPK_DESC                                      12093000
120940             INTO                                                 12094000
120950                 :POPRPK-PREPK-DESC                               12095000
120960             FROM                                                 12096000
120970                  TPOPRPK                                         12097000
120980            WHERE PO_NBR        = :IMCNUP-PO-NBR                  12098000
120990              AND PREPK_UPC_NBR = :PV-PACK-UPC-NBR                12099000
121000              AND PK_SKU_NBR    = :PV-PACK-SKU-NBR                12100000
121010            WITH UR                                               12101000
121020     END-EXEC                                                     12102000
121030                                                                  12103000
121040     EVALUATE TRUE                                                12104000
121050         WHEN SQLCODE = ZERO                                      12105000
121060             CONTINUE                                             12106000
121070                                                                  12107000
121080         WHEN SQLCODE = +100                                      12108000
121090             IF PURCHS-PO-TYP-CDE = ('IM' OR 'IE' OR 'IF')        12109012
121100                 MOVE PC-WARNING         TO TR211-ERROR-TYPE      12110000
121110                 INITIALIZE TR211-DATA-VALUE                      12111000
121120                 MOVE TR023-CONUPC-SKU   TO TR211-DATA-VALUE      12112000
121130                 MOVE 'SKU NUMBER'       TO TR211-DATA-IN-ERROR   12113000
121140                 MOVE 'PACK SKU NOT ON KOHLS PO'                  12114000
121150                                         TO TR211-ERROR-MSG       12115000
121160                 PERFORM 5840-LOAD-CONUPA-TO-REPORT               12116000
121170             END-IF                                               12117000
121180         WHEN SQLWARN0 NOT EQUAL SPACE                            12118000
121190         WHEN SQLCODE NOT EQUAL ZERO                              12119000
121200             DISPLAY '** ABEND **'                                12120000
121210             DISPLAY '** PROGRAM = TRKUP215 **'                   12121000
121220             DISPLAY                                              12122000
121230                 '** PARAGRAPH = 7356-SELECT-TPOPRPK-SKU-INFO**'  12123000
121240             DISPLAY '** PO NBR     = ' IMCNUP-PO-NBR             12124000
121250             DISPLAY '** UPC CODE   = ' TR023-CONUPC-UPC-NBR      12125000
121260             DISPLAY '** SKU NUMBER = ' TR023-CONUPC-SKU          12126000
121270             PERFORM 9100-SQL-ABEND                               12127000
121280     END-EVALUATE.                                                12128000
121290                                                                  12129000
121300******************************************************************12130000
121310* SELECT PURCHASE ORDER UPC BULK INFORMATION.                    *12131000
121320******************************************************************12132000
121330 7357-SELECT-TPURITM-UPC-INFO.                                    12133000
121340                                                                  12134000
121350     MOVE TR023-CONUPC-UPC-NBR TO PV-BULK-UPC-NBR.                12135000
121360     MOVE TR023-CONUPC-SKU TO PV-BULK-SKU-NBR.                    12136000
121370                                                                  12137000
121380         EXEC SQL                                                 12138000
121390             SELECT SKU.UPC_DESC                                  12139000
121400               INTO :TUPCSKU-UPC-DESC                             12140000
121410               FROM TPURITM  ITM                                  12141000
121420                   ,TUPCSKU  SKU                                  12142000
121430                   ,TSKXREF  XREF                                 12143000
121440              WHERE ITM.PO_NBR   = :IMCNUP-PO-NBR                 12144000
121450                AND ITM.ITM_NBR  = SKU.ITEM_NBR                   12145000
121460                AND SKU.UPC_NBR  = :PV-BULK-UPC-NBR               12146000
121470                AND ITM.ITM_NBR  = XREF.ITM_NBR                   12147000
121480                AND XREF.SKU     = :PV-BULK-SKU-NBR               12148000
121490              WITH UR                                             12149000
121500         END-EXEC                                                 12150000
121510                                                                  12151000
121520     EVALUATE TRUE                                                12152000
121530         WHEN SQLCODE = ZERO                                      12153000
121540         WHEN SQLCODE = -811                                      12154000
121550             CONTINUE                                             12155000
121560                                                                  12156000
121570         WHEN SQLCODE = +100                                      12157000
121580             INITIALIZE TR211-DATA-VALUE                          12158000
121590             MOVE PC-WARNING             TO TR211-ERROR-TYPE      12159000
121600             IF PV-UPC-NBR-NOT-FOUND                              12160000
121610                 CONTINUE                                         12161000
121620             ELSE                                                 12162000
121630                 IF PURCHS-PO-TYP-CDE = ('IM' OR 'IE' OR 'IF')    12163012
121640                     MOVE TR023-CONUPC-SKU TO TR211-DATA-VALUE    12164000
121650                     MOVE 'SKU NUMBER'     TO TR211-DATA-IN-ERROR 12165000
121660                     MOVE 'BULK SKU NOT ON KOHLS PO'              12166000
121670                                           TO TR211-ERROR-MSG     12167000
121680                     PERFORM 5840-LOAD-CONUPA-TO-REPORT           12168000
121690                 END-IF                                           12169000
121700             END-IF                                               12170000
121710                                                                  12171000
121720                                                                  12172000
121730         WHEN SQLWARN0 NOT EQUAL SPACE                            12173000
121740         WHEN SQLCODE NOT EQUAL ZERO                              12174000
121750             DISPLAY '** ABEND **'                                12175000
121760             DISPLAY '** PROGRAM = TRKUP215 **'                   12176000
121770             DISPLAY                                              12177000
121780                 '** PARAGRAPH = 7357-SELECT-TPURITM-UPC-INFO**'  12178000
121790             DISPLAY '** PO NBR     = ' IMCNUP-PO-NBR             12179000
121800             DISPLAY '** UPC CODE   = ' TR023-CONUPC-UPC-NBR      12180000
121810             DISPLAY '** SKU NUMBER = ' TR023-CONUPC-SKU          12181000
121820             PERFORM 9100-SQL-ABEND                               12182000
121830     END-EVALUATE.                                                12183000
121840                                                                  12184000
121850******************************************************************12185000
121860* VALIDATE PURCHASE ORDER SKU PREPACK INFORMATION.               *12186000
121870******************************************************************12187000
121880 7358-VALIDATE-TPOPRPK-UPC-INFO.                                  12188000
121890                                                                  12189000
121900     MOVE TR023-CONUPC-UPC-NBR TO PV-PACK-UPC-NBR.                12190000
121910                                                                  12191000
121920     EXEC SQL                                                     12192000
121930           SELECT                                                 12193000
121940                  PREPK_DESC                                      12194000
121950             INTO                                                 12195000
121960                 :POPRPK-PREPK-DESC                               12196000
121970             FROM                                                 12197000
121980                  TPOPRPK                                         12198000
121990            WHERE PO_NBR        = :IMCNUP-PO-NBR                  12199000
122000              AND PREPK_UPC_NBR = :PV-PACK-UPC-NBR                12200000
122010            WITH UR                                               12201000
122020     END-EXEC                                                     12202000
122030                                                                  12203000
122040     EVALUATE TRUE                                                12204000
122050         WHEN SQLCODE = ZERO                                      12205000
122060             PERFORM 7356-SELECT-TPOPRPK-SKU-INFO                 12206000
122070                                                                  12207000
122080         WHEN SQLCODE = +100                                      12208000
122090             INITIALIZE TR211-DATA-VALUE                          12209000
122100             MOVE PC-WARNING             TO TR211-ERROR-TYPE      12210000
122110             MOVE TR023-CONUPC-UPC-NBR   TO TR211-DATA-VALUE      12211000
122120             MOVE 'UPC NUMBER'           TO TR211-DATA-IN-ERROR   12212000
122130             MOVE 'UPC NOT ON KOHLS PO'  TO TR211-ERROR-MSG       12213000
122140             PERFORM 5850-LOAD-CONUPC-TO-REPORT                   12214000
122150                                                                  12215000
122160         WHEN SQLCODE NOT EQUAL ZERO                              12216000
122170             DISPLAY '** ABEND **'                                12217000
122180             DISPLAY '** PROGRAM = TRKUP215 **'                   12218000
122190             DISPLAY                                              12219000
122200                 '** PARAGRAPH = 7358-VALIDATE-TPOPRPK-UPC-INFO**'12220000
122210             DISPLAY '** PO NBR     = ' IMCNUP-PO-NBR             12221000
122220             DISPLAY '** UPC CODE   = ' TR023-CONUPC-UPC-NBR      12222000
122230             PERFORM 9100-SQL-ABEND                               12223000
122240     END-EVALUATE.                                                12224000
122250******************************************************************12225000
122260* SELECT TPOPRPK PO PREPACK ID.                                  *12226000
122270******************************************************************12227000
122280 7360-SELECT-TPOPRPK-PREPK-ID.                                    12228000
122290                                                                  12229000
122300     MOVE TR023-CONUPC-UPC-NBR TO PV-PACK-UPC-NBR.                12230000
122310                                                                  12231000
122320     EXEC SQL                                                     12232000
122330           SELECT                                                 12233000
122340                  PO_PREPK_ID                                     12234000
122350                 ,PREPK_TYP_CDE                                   12235001
122360             INTO                                                 12236000
122370                 :PV-PO-PREPK-ID                                  12237000
122380               , :PV-PREPK-TYP-CDE                                12238001
122390             FROM                                                 12239000
122400                  TPOPRPK                                         12240000
122410            WHERE PO_NBR        = :IMCNUP-PO-NBR                  12241000
122420              AND PREPK_UPC_NBR = :PV-PACK-UPC-NBR                12242000
122430           WITH UR                                                12243000
122440     END-EXEC                                                     12244000
122450                                                                  12245000
122460     EVALUATE TRUE                                                12246000
122470         WHEN SQLCODE = ZERO                                      12247000
122480         WHEN SQLCODE = -811                                      12248000
122490             CONTINUE                                             12249000
122500                                                                  12250000
122510         WHEN SQLCODE = +100                                      12251000
122520             MOVE ZEROES TO PV-PO-PREPK-ID                        12252000
122530                                                                  12253000
122540         WHEN SQLCODE NOT EQUAL ZERO                              12254000
122550             DISPLAY '** ABEND **'                                12255000
122560             DISPLAY '** PROGRAM = TRKUP215 **'                   12256000
122570             DISPLAY                                              12257000
122580                 '** PARAGRAPH = 7360-SELECT-TPOPRPK-PO-PREPK-ID*'12258000
122590             DISPLAY '** PO NBR     = ' IMCNUP-PO-NBR             12259000
122600             DISPLAY '** UPC CODE   = ' TR023-CONUPC-UPC-NBR      12260000
122610             PERFORM 9100-SQL-ABEND                               12261000
122620     END-EVALUATE.                                                12262000
122630******************************************************************12263000
122640* OPEN THE CONTAINER UPC CURSOR.                                 *12264000
122650******************************************************************12265000
122660 7500-OPEN-CONUP-CURSOR.                                          12266000
122670                                                                  12267000
122680     EXEC SQL                                                     12268000
122690          OPEN CONUP_CUR                                          12269000
122700     END-EXEC.                                                    12270000
122710                                                                  12271000
122720     EVALUATE TRUE                                                12272000
122730         WHEN SQLWARN0 NOT EQUAL SPACE                            12273000
122740         WHEN SQLCODE NOT EQUAL ZERO                              12274000
122750             DISPLAY '** ABEND **'                                12275000
122760             DISPLAY '** PROGRAM = TRKUP215 **'                   12276000
122770             DISPLAY '** PARAGRAPH = 7500-OPEN-CONUP-CURSOR **'   12277000
122780             PERFORM 9100-SQL-ABEND                               12278000
122790     END-EVALUATE.                                                12279000
122800                                                                  12280000
122810******************************************************************12281000
122820* CLOSE THE CONTAINER UPC CURSOR.                                *12282000
122830******************************************************************12283000
122840 7510-CLOSE-CONUP-CURSOR.                                         12284000
122850                                                                  12285000
122860     EXEC SQL                                                     12286000
122870         CLOSE CONUP_CUR                                          12287000
122880     END-EXEC.                                                    12288000
122890                                                                  12289000
122900     EVALUATE TRUE                                                12290000
122910         WHEN SQLWARN0 NOT EQUAL SPACE                            12291000
122920         WHEN SQLCODE NOT EQUAL ZERO                              12292000
122930             DISPLAY '** ABEND **'                                12293000
122940             DISPLAY '** PROGRAM = TRKUP215 **'                   12294000
122950             DISPLAY '** PARAGRAPH = 7510-CLOSE-CONUP-CURSOR**'   12295000
122960             PERFORM 9100-SQL-ABEND                               12296000
122970     END-EVALUATE.                                                12297000
122980                                                                  12298000
122990******************************************************************12299000
123000* FETCH THE CONTAINER UPC CURSOR.                                *12300000
123010******************************************************************12301000
123020 7520-FETCH-CONUP-CURSOR.                                         12302000
123030                                                                  12303000
123040     EXEC SQL                                                     12304000
123050          FETCH CONUP_CUR                                         12305000
123060              INTO :IMCNUP-CONTNR-ID,                             12306000
123070                   :IMCNUP-CONTNR-SEQ-NBR,                        12307000
123080                   :IMCNUP-PO-NBR,                                12308000
123090                   :IMCNUP-UPC-NBR,                               12309000
123100                   :IMCNUP-PO-LNE-NBR,                            12310000
123110                   :IMCNUP-UPC-CART-CNT,                          12311000
123120                   :IMCNUP-UPC-CBMT-QTY,                          12312000
123130                   :IMCNUP-UPC-WT-KGRM-QTY,                       12313000
123140                   :IMCNUP-UPC-UNT-QTY,                           12314000
123150                   :IMCNUP-CRE-BY-USR-ID,                         12315000
123160                   :IMCNUP-CRE-TMST,                              12316000
123170                   :IMCNUP-LAST-UPD-BY-USR-ID,                    12317000
123180                   :IMCNUP-LAST-UPD-TMST,                         12318000
123190                   :IMCNUP-SKU-NBR,                               12319000
123200                   :IMCNUP-ASN-PKGNG-CDE                          12320000
123210     END-EXEC.                                                    12321000
123220                                                                  12322000
123230     EVALUATE TRUE                                                12323000
123240         WHEN SQLCODE = ZERO                                      12324000
123250              CONTINUE                                            12325000
123260         WHEN SQLCODE = +100                                      12326000
123270              SET PS-EOC-CONUP-CURSOR          TO TRUE            12327000
123280                                                                  12328000
123290         WHEN SQLWARN0 NOT EQUAL SPACE                            12329000
123300         WHEN SQLCODE NOT EQUAL ZERO                              12330000
123310             DISPLAY '** ABEND **'                                12331000
123320             DISPLAY '** PROGRAM = TRKUP215 **'                   12332000
123330             DISPLAY '** PARAGRAPH = 7520-FETCH-CONUP-CURSOR**'   12333000
123340             PERFORM 9100-SQL-ABEND                               12334000
123350     END-EVALUATE.                                                12335000
123360                                                                  12336000
123370 EJECT                                                            12337000
123380******************************************************************12338000
123390* OPEN THE PO / UPC / CARTON CURSOR.                             *12339000
123400******************************************************************12340000
123410 7525-OPEN-PO-UPC-CART-CURSOR.                                    12341000
123420                                                                  12342000
123430     EXEC SQL                                                     12343000
123440          OPEN PO_UPC_CART_CUR                                    12344000
123450     END-EXEC.                                                    12345000
123460                                                                  12346000
123470     EVALUATE TRUE                                                12347000
123480         WHEN SQLWARN0 NOT EQUAL SPACE                            12348000
123490         WHEN SQLCODE NOT EQUAL ZERO                              12349000
123500             DISPLAY '** ABEND **'                                12350000
123510             DISPLAY '** PROGRAM = TRKUP215 **'                   12351000
123520             DISPLAY '** PARAGRAPH = 7525-OPEN-PO-UPC-CART-CUR*'  12352000
123530             PERFORM 9100-SQL-ABEND                               12353000
123540     END-EVALUATE.                                                12354000
123550                                                                  12355000
123560******************************************************************12356000
123570* CLOSE THE PO / UPC / CARTON CURSOR.                            *12357000
123580******************************************************************12358000
123590 7530-CLOSE-PO-UPC-CART-CURSOR.                                   12359000
123600                                                                  12360000
123610     EXEC SQL                                                     12361000
123620         CLOSE PO_UPC_CART_CUR                                    12362000
123630     END-EXEC.                                                    12363000
123640                                                                  12364000
123650     EVALUATE TRUE                                                12365000
123660         WHEN SQLWARN0 NOT EQUAL SPACE                            12366000
123670         WHEN SQLCODE NOT EQUAL ZERO                              12367000
123680             DISPLAY '** ABEND **'                                12368000
123690             DISPLAY '** PROGRAM = TRKUP215 **'                   12369000
123700             DISPLAY '** PARAGRAPH = 7530-CLOSE-PO-UPC-CART-CUR*' 12370000
123710             PERFORM 9100-SQL-ABEND                               12371000
123720     END-EVALUATE.                                                12372000
123730                                                                  12373000
123740******************************************************************12374000
123750* FETCH THE PO / UPC / CARTON CURSOR.                            *12375000
123760******************************************************************12376000
123770 7535-FETCH-PO-UPC-CART-CURSOR.                                   12377000
123780                                                                  12378000
123790     INITIALIZE  PV-NULL-UPC                                      12379000
123800                 PV-NULL-CART.                                    12380000
123810                                                                  12381000
123820     EXEC SQL                                                     12382000
123830          FETCH PO_UPC_CART_CUR                                   12383000
123840              INTO :PV-CURSOR-PO-NBR,                             12384000
123850                   :PV-CURSOR-UPC-NBR:PV-NULL-UPC,                12385000
123860                   :PV-CURSOR-SSCC-NBR:PV-NULL-CART               12386000
123870     END-EXEC.                                                    12387000
123880                                                                  12388000
123890     EVALUATE TRUE                                                12389000
123900         WHEN SQLCODE = ZERO                                      12390000
123910              SET PS-EOC-PO-UPC-CART-CURSOR-NO   TO TRUE          12391000
123920              IF PV-NULL-UPC = 0                                  12392000
123930                CONTINUE                                          12393000
123940              ELSE                                                12394000
123950                MOVE ZERO   TO PV-CURSOR-UPC-NBR                  12395000
123960              END-IF                                              12396000
123970              IF PV-NULL-CART = 0                                 12397000
123980                CONTINUE                                          12398000
123990              ELSE                                                12399000
124000                MOVE SPACES TO PV-CURSOR-SSCC-NBR                 12400000
124010              END-IF                                              12401000
124020                                                                  12402000
124030         WHEN SQLCODE = +100                                      12403000
124040              SET PS-EOC-PO-UPC-CART-CURSOR TO TRUE               12404000
124050                                                                  12405000
124060         WHEN SQLWARN0 NOT EQUAL SPACE                            12406000
124070         WHEN SQLCODE NOT EQUAL ZERO                              12407000
124080             DISPLAY '** ABEND **'                                12408000
124090             DISPLAY '** PROGRAM = TRKUP215 **'                   12409000
124100             DISPLAY '** PARAGRAPH = 7535-FETCH-PO-UPC-CART-CUR*' 12410000
124110             PERFORM 9100-SQL-ABEND                               12411000
124120     END-EVALUATE.                                                12412000
124130                                                                  12413000
124140 EJECT                                                            12414000
124150******************************************************************12415000
124160* OPEN THE CONTAINER SEAL CURSOR.                                *12416000
124170******************************************************************12417000
124180 7540-OPEN-SEAL-CURSOR.                                           12418000
124190                                                                  12419000
124200     EXEC SQL                                                     12420000
124210          OPEN SEAL_CUR                                           12421000
124220     END-EXEC.                                                    12422000
124230                                                                  12423000
124240     EVALUATE TRUE                                                12424000
124250         WHEN SQLWARN0 NOT EQUAL SPACE                            12425000
124260         WHEN SQLCODE NOT EQUAL ZERO                              12426000
124270             DISPLAY '** ABEND **'                                12427000
124280             DISPLAY '** PROGRAM = TRKUP215 **'                   12428000
124290             DISPLAY '** PARAGRAPH = 7540-OPEN-SEAL-CURSOR*'      12429000
124300             PERFORM 9100-SQL-ABEND                               12430000
124310     END-EVALUATE.                                                12431000
124320                                                                  12432000
124330******************************************************************12433000
124340* CLOSE THE CONTAINER SEAL CURSOR.                               *12434000
124350******************************************************************12435000
124360 7545-CLOSE-SEAL-CURSOR.                                          12436000
124370                                                                  12437000
124380     EXEC SQL                                                     12438000
124390         CLOSE SEAL_CUR                                           12439000
124400     END-EXEC.                                                    12440000
124410                                                                  12441000
124420     EVALUATE TRUE                                                12442000
124430         WHEN SQLWARN0 NOT EQUAL SPACE                            12443000
124440         WHEN SQLCODE NOT EQUAL ZERO                              12444000
124450             DISPLAY '** ABEND **'                                12445000
124460             DISPLAY '** PROGRAM = TRKUP215 **'                   12446000
124470             DISPLAY '** PARAGRAPH = 7545-CLOSE-SEAL-CURSOR*'     12447000
124480             PERFORM 9100-SQL-ABEND                               12448000
124490     END-EVALUATE.                                                12449000
124500                                                                  12450000
124510******************************************************************12451000
124520* FETCH THE CONTAINER SEAL CURSOR.                               *12452000
124530******************************************************************12453000
124540 7550-FETCH-SEAL-CURSOR.                                          12454000
124550                                                                  12455000
124560     EXEC SQL                                                     12456000
124570          FETCH SEAL_CUR                                          12457000
124580              INTO :PV-CURSOR-SEAL-NBR                            12458000
124590     END-EXEC.                                                    12459000
124600                                                                  12460000
124610     EVALUATE TRUE                                                12461000
124620         WHEN SQLCODE = ZERO                                      12462000
124630              SET PS-EOC-SEAL-CURSOR-NO TO TRUE                   12463000
124640                                                                  12464000
124650         WHEN SQLCODE = +100                                      12465000
124660              SET PS-EOC-SEAL-CURSOR    TO TRUE                   12466000
124670                                                                  12467000
124680         WHEN SQLWARN0 NOT EQUAL SPACE                            12468000
124690         WHEN SQLCODE NOT EQUAL ZERO                              12469000
124700             DISPLAY '** ABEND **'                                12470000
124710             DISPLAY '** PROGRAM = TRKUP215 **'                   12471000
124720             DISPLAY '** PARAGRAPH = 7550-FETCH-SEAL-CURSOR*'     12472000
124730             PERFORM 9100-SQL-ABEND                               12473000
124740     END-EVALUATE.                                                12474000
124750                                                                  12475000
124760 EJECT                                                            12476000
124770******************************************************************12477000
124780* OPEN THE UPC CURSOR.                                           *12478000
124790******************************************************************12479000
124800 7555-OPEN-UPC-CURSOR.                                            12480000
124810                                                                  12481000
124820     EXEC SQL                                                     12482000
124830          OPEN UPC_CUR                                            12483000
124840     END-EXEC.                                                    12484000
124850                                                                  12485000
124860     EVALUATE TRUE                                                12486000
124870         WHEN SQLWARN0 NOT EQUAL SPACE                            12487000
124880         WHEN SQLCODE NOT EQUAL ZERO                              12488000
124890             DISPLAY '** ABEND                           **'      12489000
124900             DISPLAY '** PROGRAM = TRKUP215              **'      12490000
124910             DISPLAY '** PARAGRAPH = 7555-OPEN-UPC-CURSOR**'      12491000
124920             PERFORM 9100-SQL-ABEND                               12492000
124930     END-EVALUATE.                                                12493000
124940                                                                  12494000
124950******************************************************************12495000
124960* CLOSE THE UPC CURSOR.                                          *12496000
124970******************************************************************12497000
124980 7560-CLOSE-UPC-CURSOR.                                           12498000
124990                                                                  12499000
125000     EXEC SQL                                                     12500000
125010         CLOSE UPC_CUR                                            12501000
125020     END-EXEC.                                                    12502000
125030                                                                  12503000
125040     EVALUATE TRUE                                                12504000
125050         WHEN SQLWARN0 NOT EQUAL SPACE                            12505000
125060         WHEN SQLCODE NOT EQUAL ZERO                              12506000
125070             DISPLAY '** ABEND                            **'     12507000
125080             DISPLAY '** PROGRAM = TRKUP215               **'     12508000
125090             DISPLAY '** PARAGRAPH = 7560-CLOSE-UPC-CURSOR**'     12509000
125100             PERFORM 9100-SQL-ABEND                               12510000
125110     END-EVALUATE.                                                12511000
125120                                                                  12512000
125130******************************************************************12513000
125140* FETCH THE UPC CURSOR.                                          *12514000
125150******************************************************************12515000
125160 7565-FETCH-UPC-CURSOR.                                           12516000
125170                                                                  12517000
125180     EXEC SQL                                                     12518000
125190          FETCH UPC_CUR                                           12519000
125200              INTO :IMCNUP-CONTNR-ID,                             12520000
125210                   :IMCNUP-CONTNR-SEQ-NBR,                        12521000
125220                   :IMCNUP-PO-NBR,                                12522000
125230                   :IMCNUP-VS-NBR,                                12523000
125240                   :IMCNUP-UPC-NBR,                               12524000
125250                   :IMCNUP-PO-LNE-NBR,                            12525000
125260                   :IMCNUP-UPC-CART-CNT,                          12526000
125270                   :IMCNUP-UPC-CBMT-QTY,                          12527000
125280                   :IMCNUP-UPC-WT-KGRM-QTY,                       12528000
125290                   :IMCNUP-UPC-UNT-QTY,                           12529000
125300                   :IMCNUP-CRE-BY-USR-ID,                         12530000
125310                   :IMCNUP-CRE-TMST,                              12531000
125320                   :IMCNUP-LAST-UPD-BY-USR-ID,                    12532000
125330                   :IMCNUP-LAST-UPD-TMST,                         12533000
125340                   :IMCNUP-SKU-NBR,                               12534000
125350                   :IMCNUP-ASN-PKGNG-CDE                          12535000
125360     END-EXEC.                                                    12536000
125370                                                                  12537000
125380     EVALUATE TRUE                                                12538000
125390         WHEN SQLCODE = ZERO                                      12539000
125400              SET PS-EOC-UPC-CURSOR-NO    TO TRUE                 12540000
125410                                                                  12541000
125420         WHEN SQLCODE = +100                                      12542000
125430              SET PS-EOC-UPC-CURSOR       TO TRUE                 12543000
125440                                                                  12544000
125450         WHEN SQLWARN0 NOT EQUAL SPACE                            12545000
125460         WHEN SQLCODE NOT EQUAL ZERO                              12546000
125470             DISPLAY '** ABEND                            **'     12547000
125480             DISPLAY '** PROGRAM = TRKUP215               **'     12548000
125490             DISPLAY '** PARAGRAPH = 7565-FETCH-UPC-CURSOR**'     12549000
125500             PERFORM 9100-SQL-ABEND                               12550000
125510     END-EVALUATE.                                                12551000
125520                                                                  12552000
125530 EJECT                                                            12553000
125540******************************************************************12554000
125550* OPEN THE RECYCLE CURSOR.                                       *12555000
125560******************************************************************12556000
125570 7570-OPEN-RECYCLE-CURSOR.                                        12557000
125580                                                                  12558000
125590     EXEC SQL                                                     12559000
125600          OPEN RECYCLE_CUR                                        12560000
125610     END-EXEC.                                                    12561000
125620                                                                  12562000
125630     EVALUATE TRUE                                                12563000
125640         WHEN SQLWARN0 NOT EQUAL SPACE                            12564000
125650         WHEN SQLCODE NOT EQUAL ZERO                              12565000
125660             DISPLAY '** ABEND                                **' 12566000
125670             DISPLAY '** PROGRAM = TRKUP215                   **' 12567000
125680             DISPLAY '** PARAGRAPH = 7570-OPEN-RECYCLE-CURSOR **' 12568000
125690             PERFORM 9100-SQL-ABEND                               12569000
125700     END-EVALUATE.                                                12570000
125710                                                                  12571000
125720******************************************************************12572000
125730* CLOSE THE RECYCLE CURSOR.                                      *12573000
125740******************************************************************12574000
125750 7575-CLOSE-RECYCLE-CURSOR.                                       12575000
125760                                                                  12576000
125770     EXEC SQL                                                     12577000
125780          CLOSE RECYCLE_CUR                                       12578000
125790     END-EXEC.                                                    12579000
125800                                                                  12580000
125810     EVALUATE TRUE                                                12581000
125820         WHEN SQLWARN0 NOT EQUAL SPACE                            12582000
125830         WHEN SQLCODE NOT EQUAL ZERO                              12583000
125840             DISPLAY '** ABEND                                 **'12584000
125850             DISPLAY '** PROGRAM = TRKUP215                    **'12585000
125860             DISPLAY '** PARAGRAPH = 7575-CLOSE-RECYCLE-CURSOR **'12586000
125870             PERFORM 9100-SQL-ABEND                               12587000
125880     END-EVALUATE.                                                12588000
125890                                                                  12589000
125900******************************************************************12590000
125910* FETCH THE RECYCLE CURSOR.                                      *12591000
125920******************************************************************12592000
125930 7580-FETCH-RECYCLE-CURSOR.                                       12593000
125940                                                                  12594000
125950     EXEC SQL                                                     12595000
125960          FETCH RECYCLE_CUR                                       12596000
125970              INTO :IMCNTK-DO-RCVD-TMST                           12597000
125980                  ,:IMCNTK-DCONSLR-SCAC-ID                        12598000
125990                  ,:IMCNTK-CONTNR-PU-TMST                         12599000
126000                  ,:IMCNTK-DVN-TMST                               12600000
126010                  ,:IMCNTK-BKR-FRGT-RLSE-TMST                     12601000
126020                  ,:IMCNTK-DCONSLR-RET-TMST                       12602000
126030                  ,:IMCNTK-ACTL-POE-DELY-TMST                     12603000
126040                  ,:IMCNTK-ACTL-DEST-POE-CDE                      12604000
126050                  ,:IMCNTK-MOM-TRIP-TYP-CDE                       12605000
126060                  ,:IMCNTK-MOM-CARR-SCAC-ID                       12606000
126070                  ,:IMCNTK-MOM-IMPRT-TRIP-ID                      12607000
126080                  ,:IMCNTK-MOM-IMPRT-VEH-NM                       12608000
126090                  ,:IMCNTK-MOM-DEST-POE-CDE                       12609000
126100                  ,:IMCNPO-PO-NBR                                 12610000
126110                   :PV-IMCNPO-PO-NBR-NULL                         12611000
126120                  ,:IMCNPO-EXTL-REF-NBR                           12612000
126130                   :PV-IMCNPO-EXTL-REF-NBR-NULL                   12613000
126140                  ,:IMCNPO-CONTNR-ID                              12614000
126150                   :PV-IMCNPO-CONTNR-ID-NULL                      12615000
126160                  ,:IMCNPO-BKR-FRGT-RLSE-CDE                      12616000
126170                   :PV-IMCNPO-BKR-FRGT-RLSE-CDE-NL                12617000
126180                  ,:IMCNPO-DO-RCVD-CDE                            12618000
126190                   :PV-IMCNPO-DO-RCVD-CDE-NULL                    12619000
126200                  ,:IMCNPO-CONTNR-PU-CDE                          12620000
126210                   :PV-IMCNPO-CONTNR-PU-CDE-NULL                  12621000
126220                  ,:IMCNPO-ACTL-POE-DELY-CDE                      12622000
126230                   :PV-IMCNPO-ACTL-POE-DELY-CDE-NL                12623000
126240                  ,:IMCNPO-DVN-CDE                                12624000
126250                   :PV-IMCNPO-DVN-CDE-NULL                        12625000
126260                  ,:IMCNPO-DCONSLR-RET-CDE                        12626000
126270                   :PV-IMCNPO-DCONSLR-RET-CDE-NULL                12627000
126280     END-EXEC.                                                    12628000
126290                                                                  12629000
126300     EVALUATE TRUE                                                12630000
126310         WHEN SQLCODE = ZERO                                      12631000
126320              SET PS-EOC-RECYCLE-CURSOR-NO TO TRUE                12632000
126330                                                                  12633000
126340         WHEN SQLCODE = +100                                      12634000
126350              SET PS-EOC-RECYCLE-CURSOR    TO TRUE                12635000
126360                                                                  12636000
126370         WHEN SQLWARN0 NOT EQUAL SPACE                            12637000
126380         WHEN SQLCODE NOT EQUAL ZERO                              12638000
126390             DISPLAY '** ABEND                                 **'12639000
126400             DISPLAY '** PROGRAM = TRKUP215                    **'12640000
126410             DISPLAY '** PARAGRAPH = 7580-FETCH-RECYCLE-CURSOR **'12641000
126420             PERFORM 9100-SQL-ABEND                               12642000
126430     END-EVALUATE.                                                12643000
126440                                                                  12644000
126450 EJECT                                                            12645000
126460******************************************************************12646000
126470* OPEN THE CONTAINER CARTON CURSOR.                              *12647000
126480******************************************************************12648000
126490 7585-OPEN-CNCART-CURSOR.                                         12649000
126500                                                                  12650000
126510     EXEC SQL                                                     12651000
126520          OPEN CNCART_CUR                                         12652000
126530     END-EXEC.                                                    12653000
126540                                                                  12654000
126550     EVALUATE TRUE                                                12655000
126560         WHEN SQLWARN0 NOT EQUAL SPACE                            12656000
126570         WHEN SQLCODE NOT EQUAL ZERO                              12657000
126580             DISPLAY '** ABEND **'                                12658000
126590             DISPLAY '** PROGRAM = TRKUP215 **'                   12659000
126600             DISPLAY '** PARAGRAPH = 7585-OPEN-CNCART-CURSOR**'   12660000
126610             PERFORM 9100-SQL-ABEND                               12661000
126620     END-EVALUATE.                                                12662000
126630                                                                  12663000
126640******************************************************************12664000
126650* CLOSE THE CONTAINER CARTON CURSOR.                             *12665000
126660******************************************************************12666000
126670 7590-CLOSE-CNCART-CURSOR.                                        12667000
126680                                                                  12668000
126690     EXEC SQL                                                     12669000
126700         CLOSE CNCART_CUR                                         12670000
126710     END-EXEC.                                                    12671000
126720                                                                  12672000
126730     EVALUATE TRUE                                                12673000
126740         WHEN SQLWARN0 NOT EQUAL SPACE                            12674000
126750         WHEN SQLCODE NOT EQUAL ZERO                              12675000
126760             DISPLAY '** ABEND **'                                12676000
126770             DISPLAY '** PROGRAM = TRKUP215 **'                   12677000
126780             DISPLAY '** PARAGRAPH = 7590-CLOSE-CNCART-CURSOR*'   12678000
126790             PERFORM 9100-SQL-ABEND                               12679000
126800     END-EVALUATE.                                                12680000
126810                                                                  12681000
126820******************************************************************12682000
126830* FETCH THE CONTAINER CARTON CURSOR.                             *12683000
126840******************************************************************12684000
126850 7595-FETCH-CNCART-CURSOR.                                        12685000
126860                                                                  12686000
126870     EXEC SQL                                                     12687000
126880          FETCH CNCART_CUR                                        12688000
126890              INTO :TRT00008-CONTNR-ID,                           12689000
126900                   :TRT00008-CONTNR-SEQ-NBR,                      12690000
126910                   :TRT00008-PO-NBR,                              12691000
126920                   :TRT00008-UPC-NBR,                             12692000
126930                   :TRT00008-SSCC-ID,                             12693000
126940                   :TRT00008-CRE-BY-USR-ID,                       12694000
126950                   :TRT00008-CRE-TMST,                            12695000
126960                   :TRT00008-UNT-QTY,                             12696000
126970                   :TRT00008-LAST-UPD-BY-USR-ID,                  12697000
126980                   :TRT00008-LAST-UPD-TMST                        12698000
126990     END-EXEC.                                                    12699000
127000                                                                  12700000
127010     EVALUATE TRUE                                                12701000
127020         WHEN SQLCODE = ZERO                                      12702000
127030              CONTINUE                                            12703000
127040         WHEN SQLCODE = +100                                      12704000
127050              SET PS-EOC-CNCART-CURSOR  TO TRUE                   12705000
127060                                                                  12706000
127070         WHEN SQLWARN0 NOT EQUAL SPACE                            12707000
127080         WHEN SQLCODE NOT EQUAL ZERO                              12708000
127090             DISPLAY '** ABEND **'                                12709000
127100             DISPLAY '** PROGRAM = TRKUP215 **'                   12710000
127110             DISPLAY '** PARAGRAPH = 7595-FETCH-CNCART-CURSOR*'   12711000
127120             PERFORM 9100-SQL-ABEND                               12712000
127130     END-EVALUATE.                                                12713000
127140                                                                  12714000
127150 EJECT                                                            12715000
127160******************************************************************12716000
127170* OPEN THE CARTON CURSOR.                                        *12717000
127180******************************************************************12718000
127190 7600-OPEN-CARTON-CURSOR.                                         12719000
127200                                                                  12720000
127210     EXEC SQL                                                     12721000
127220          OPEN CARTON_CUR                                         12722000
127230     END-EXEC.                                                    12723000
127240                                                                  12724000
127250     EVALUATE TRUE                                                12725000
127260         WHEN SQLWARN0 NOT EQUAL SPACE                            12726000
127270         WHEN SQLCODE NOT EQUAL ZERO                              12727000
127280             DISPLAY '** ABEND                           **'      12728000
127290             DISPLAY '** PROGRAM = TRKUP215              **'      12729000
127300             DISPLAY '** PARAGRAPH = 7600-OPEN-CARTON-CUR**'      12730000
127310             PERFORM 9100-SQL-ABEND                               12731000
127320     END-EVALUATE.                                                12732000
127330                                                                  12733000
127340******************************************************************12734000
127350* CLOSE THE CARTON CURSOR.                                       *12735000
127360******************************************************************12736000
127370 7605-CLOSE-CARTON-CURSOR.                                        12737000
127380                                                                  12738000
127390     EXEC SQL                                                     12739000
127400         CLOSE CARTON_CUR                                         12740000
127410     END-EXEC.                                                    12741000
127420                                                                  12742000
127430     EVALUATE TRUE                                                12743000
127440         WHEN SQLWARN0 NOT EQUAL SPACE                            12744000
127450         WHEN SQLCODE NOT EQUAL ZERO                              12745000
127460             DISPLAY '** ABEND                            **'     12746000
127470             DISPLAY '** PROGRAM = TRKUP215               **'     12747000
127480             DISPLAY '** PARAGRAPH = 7605-CLOSE-CARTON-CUR**'     12748000
127490             PERFORM 9100-SQL-ABEND                               12749000
127500     END-EVALUATE.                                                12750000
127510                                                                  12751000
127520******************************************************************12752000
127530* FETCH THE CARTON CURSOR.                                       *12753000
127540******************************************************************12754000
127550 7610-FETCH-CARTON-CURSOR.                                        12755000
127560                                                                  12756000
127570     EXEC SQL                                                     12757000
127580          FETCH CARTON_CUR                                        12758000
127590              INTO :TRT00008-CONTNR-ID,                           12759000
127600                   :TRT00008-CONTNR-SEQ-NBR,                      12760000
127610                   :TRT00008-PO-NBR,                              12761000
127620                   :TRT00008-UPC-NBR,                             12762000
127630                   :TRT00008-SSCC-ID,                             12763000
127640                   :TRT00008-CRE-BY-USR-ID,                       12764000
127650                   :TRT00008-CRE-TMST,                            12765000
127660                   :TRT00008-UNT-QTY,                             12766000
127670                   :TRT00008-LAST-UPD-BY-USR-ID,                  12767000
127680                   :TRT00008-LAST-UPD-TMST                        12768000
127690     END-EXEC.                                                    12769000
127700                                                                  12770000
127710     EVALUATE TRUE                                                12771000
127720         WHEN SQLCODE = ZERO                                      12772000
127730              SET PS-EOC-CARTON-CURSOR-NO TO TRUE                 12773000
127740                                                                  12774000
127750         WHEN SQLCODE = +100                                      12775000
127760              SET PS-EOC-CARTON-CURSOR    TO TRUE                 12776000
127770                                                                  12777000
127780         WHEN SQLWARN0 NOT EQUAL SPACE                            12778000
127790         WHEN SQLCODE NOT EQUAL ZERO                              12779000
127800             DISPLAY '** ABEND                            **'     12780000
127810             DISPLAY '** PROGRAM = TRKUP215               **'     12781000
127820             DISPLAY '** PARAGRAPH = 7610-FETCH-CARTON-CUR**'     12782000
127830             PERFORM 9100-SQL-ABEND                               12783000
127840     END-EVALUATE.                                                12784000
127850                                                                  12785000
127860 EJECT                                                            12786000
127870******************************************************************12787000
127880* OPEN THE CONTAINER SEAL CURSOR.                                *12788000
127890******************************************************************12789000
127900 7615-OPEN-CNSEAL-CURSOR.                                         12790000
127910                                                                  12791000
127920     EXEC SQL                                                     12792000
127930          OPEN CNSEAL_CUR                                         12793000
127940     END-EXEC.                                                    12794000
127950                                                                  12795000
127960     EVALUATE TRUE                                                12796000
127970         WHEN SQLWARN0 NOT EQUAL SPACE                            12797000
127980         WHEN SQLCODE NOT EQUAL ZERO                              12798000
127990             DISPLAY '** ABEND **'                                12799000
128000             DISPLAY '** PROGRAM = TRKUP215 **'                   12800000
128010             DISPLAY '** PARAGRAPH = 7615-OPEN-CNSEAL-CURSOR**'   12801000
128020             PERFORM 9100-SQL-ABEND                               12802000
128030     END-EVALUATE.                                                12803000
128040                                                                  12804000
128050******************************************************************12805000
128060* CLOSE THE CONTAINER SEAL CURSOR.                               *12806000
128070******************************************************************12807000
128080 7620-CLOSE-CNSEAL-CURSOR.                                        12808000
128090                                                                  12809000
128100     EXEC SQL                                                     12810000
128110         CLOSE CNSEAL_CUR                                         12811000
128120     END-EXEC.                                                    12812000
128130                                                                  12813000
128140     EVALUATE TRUE                                                12814000
128150         WHEN SQLWARN0 NOT EQUAL SPACE                            12815000
128160         WHEN SQLCODE NOT EQUAL ZERO                              12816000
128170             DISPLAY '** ABEND **'                                12817000
128180             DISPLAY '** PROGRAM = TRKUP215 **'                   12818000
128190             DISPLAY '** PARAGRAPH = 7590-CLOSE-CNCART-CURSOR*'   12819000
128200             PERFORM 9100-SQL-ABEND                               12820000
128210     END-EVALUATE.                                                12821000
128220                                                                  12822000
128230******************************************************************12823000
128240* FETCH THE CONTAINER SEAL CURSOR.                               *12824000
128250******************************************************************12825000
128260 7625-FETCH-CNSEAL-CURSOR.                                        12826000
128270                                                                  12827000
128280     EXEC SQL                                                     12828000
128290          FETCH CNSEAL_CUR                                        12829000
128300              INTO :TRT00006-CONTNR-ID,                           12830000
128310                   :TRT00006-CONTNR-SEQ-NBR,                      12831000
128320                   :TRT00006-SEAL-NBR,                            12832000
128330                   :TRT00006-CRE-TMST,                            12833000
128340                   :TRT00006-CRE-BY-USR-ID,                       12834000
128350                   :TRT00006-LAST-UPD-TMST,                       12835000
128360                   :TRT00006-LAST-UPD-BY-USR-ID                   12836000
128370     END-EXEC.                                                    12837000
128380                                                                  12838000
128390     EVALUATE TRUE                                                12839000
128400         WHEN SQLCODE = ZERO                                      12840000
128410              CONTINUE                                            12841000
128420         WHEN SQLCODE = +100                                      12842000
128430              SET PS-EOC-CNSEAL-CURSOR       TO TRUE              12843000
128440                                                                  12844000
128450         WHEN SQLWARN0 NOT EQUAL SPACE                            12845000
128460         WHEN SQLCODE NOT EQUAL ZERO                              12846000
128470             DISPLAY '** ABEND **'                                12847000
128480             DISPLAY '** PROGRAM = TRKUP215 **'                   12848000
128490             DISPLAY '** PARAGRAPH = 7625-FETCH-CNSEAL-CURSOR*'   12849000
128500             PERFORM 9100-SQL-ABEND                               12850000
128510     END-EVALUATE.                                                12851000
128520                                                                  12852000
128530 EJECT                                                            12853000
128540******************************************************************12854000
128550* SETUP THE TAUCNTK DCLGEN FIELDS PRIOR TO INSERT                *12855000
128560******************************************************************12856000
128570 7630-MOVE-TIMCNTK-TO-TAUCNTK.                                    12857000
128580                                                                  12858000
128590     INITIALIZE DCLTAUCNTK.                                       12859000
128600                                                                  12860000
128610     MOVE IMCNTK-CONTNR-ID           TO AUCNTK-CONTNR-ID.         12861000
128620     MOVE IMCNTK-CONTNR-SEQ-NBR      TO AUCNTK-CONTNR-SEQ-NBR.    12862000
128630     MOVE IMCNTK-CONSLR-SCAC-ID      TO AUCNTK-CONSLR-SCAC-ID.    12863000
128640     MOVE IMCNTK-MOM-IMPRT-TRIP-ID   TO AUCNTK-MOM-IMPRT-TRIP-ID. 12864000
128650     MOVE IMCNTK-MOM-DPRTR-TMST      TO AUCNTK-MOM-DPRTR-TMST.    12865000
128660     MOVE IMCNTK-MOM-POE-DELY-TMST   TO AUCNTK-MOM-POE-DELY-TMST. 12866000
128670     MOVE IMCNTK-MOM-CARR-SCAC-ID    TO AUCNTK-MOM-CARR-SCAC-ID.  12867000
128680     MOVE IMCNTK-MOM-FOB-CDE         TO AUCNTK-MOM-FOB-CDE.       12868000
128690     MOVE IMCNTK-MOM-IMPRT-VEH-NM    TO AUCNTK-MOM-IMPRT-VEH-NM.  12869000
128700     MOVE IMCNTK-MOM-TRIP-TYP-CDE    TO AUCNTK-MOM-TRIP-TYP-CDE.  12870000
128710     MOVE IMCNTK-MOM-DEST-POE-CDE    TO AUCNTK-MOM-DEST-POE-CDE.  12871000
128720     MOVE IMCNTK-FDR-IMPRT-TRIP-ID   TO AUCNTK-FDR-IMPRT-TRIP-ID. 12872000
128730     MOVE IMCNTK-FDR-DPRTR-TMST      TO AUCNTK-FDR-DPRTR-TMST.    12873000
128740     MOVE IMCNTK-FDR-POE-DELY-TMST   TO AUCNTK-FDR-POE-DELY-TMST. 12874000
128750     MOVE IMCNTK-FDR-CARR-SCAC-ID    TO AUCNTK-FDR-CARR-SCAC-ID.  12875000
128760     MOVE IMCNTK-FDR-FOB-CDE         TO AUCNTK-FDR-FOB-CDE.       12876000
128770     MOVE IMCNTK-FDR-IMPRT-VEH-NM    TO AUCNTK-FDR-IMPRT-VEH-NM.  12877000
128780     MOVE IMCNTK-FDR-TRIP-TYP-CDE    TO AUCNTK-FDR-TRIP-TYP-CDE.  12878000
128790     MOVE IMCNTK-FDR-DEST-POE-CDE    TO AUCNTK-FDR-DEST-POE-CDE.  12879000
128800     MOVE IMCNTK-SIZE-CDE            TO AUCNTK-SIZE-CDE.          12880000
128810     MOVE IMCNTK-CART-CNT            TO AUCNTK-CART-CNT.          12881000
128820     MOVE IMCNTK-CBMT-QTY            TO AUCNTK-CBMT-QTY.          12882000
128830     MOVE IMCNTK-WT-KGRM-QTY         TO AUCNTK-WT-KGRM-QTY.       12883000
128840     MOVE IMCNTK-UNT-QTY             TO AUCNTK-UNT-QTY.           12884000
128850     MOVE IMCNTK-ORGN-SHPD-FR-CDE    TO AUCNTK-ORGN-SHPD-FR-CDE.  12885000
128860     MOVE IMCNTK-ORGN-SHPD-TO-CDE    TO AUCNTK-ORGN-SHPD-TO-CDE.  12886000
128870     MOVE IMCNTK-EST-LBD-NM          TO AUCNTK-EST-LBD-NM.        12887000
128880     MOVE IMCNTK-EST-LBD-TMST        TO AUCNTK-EST-LBD-TMST.      12888000
128890     MOVE IMCNTK-RISU-DO-RSN-CDE     TO AUCNTK-RISU-DO-RSN-CDE.   12889000
128900     MOVE IMCNTK-BKR-FRGT-RLSE-TMST  TO AUCNTK-BKR-FRGT-RLSE-TMST.12890000
128910     MOVE IMCNTK-DO-TO-DCONSLR-TMST  TO AUCNTK-DO-TO-DCONSLR-TMST.12891000
128920     MOVE IMCNTK-DO-RCVD-TMST        TO AUCNTK-DO-RCVD-TMST.      12892000
128930     MOVE IMCNTK-CONTNR-PU-TMST      TO AUCNTK-CONTNR-PU-TMST.    12893000
128940     MOVE IMCNTK-DAT-SRC-ENT-ID      TO AUCNTK-DAT-SRC-ENT-ID.    12894000
128950     MOVE IMCNTK-LAST-UPD-BY-USR-ID  TO AUCNTK-LAST-UPD-BY-USR-ID.12895000
128960     MOVE IMCNTK-LAST-UPD-TMST       TO AUCNTK-LAST-UPD-TMST.     12896000
128970     MOVE IMCNTK-ACTL-POE-DELY-TMST  TO AUCNTK-ACTL-POE-DELY-TMST.12897000
128980     MOVE IMCNTK-ACTL-DEST-POE-CDE   TO AUCNTK-ACTL-DEST-POE-CDE. 12898000
128990     MOVE IMCNTK-ACTL-LBD-NM         TO AUCNTK-ACTL-LBD-NM.       12899000
129000     MOVE IMCNTK-ACTL-LBD-TMST       TO AUCNTK-ACTL-LBD-TMST.     12900000
129010     MOVE IMCNTK-DVN-TMST            TO AUCNTK-DVN-TMST.          12901000
129020     MOVE IMCNTK-DCONSLR-SCAC-ID     TO AUCNTK-DCONSLR-SCAC-ID.   12902000
129030     MOVE IMCNTK-DCONSLR-RET-TMST    TO AUCNTK-DCONSLR-RET-TMST.  12903000
129040     MOVE IMCNTK-MOM-POL-CDE         TO AUCNTK-MOM-POL-CDE.       12904000
129050     MOVE IMCNTK-FDR-POL-CDE         TO AUCNTK-FDR-POL-CDE.       12905000
129060     MOVE IMCNTK-MOM-POR-CDE         TO AUCNTK-MOM-POR-CDE.       12906000
129070     MOVE IMCNTK-FDR-POR-CDE         TO AUCNTK-FDR-POR-CDE.       12907000
129080                                                                  12908000
129090     IF TR023-CNTR-TRN-TYP = PC-D                                 12909000
129100         MOVE PC-D                   TO AUCNTK-AUD-FUNC-CDE       12910000
129110                                        PV-FUNC-CDE               12911000
129120     ELSE                                                         12912000
129130         MOVE PC-U                   TO AUCNTK-AUD-FUNC-CDE       12913000
129140                                        PV-FUNC-CDE               12914000
129150     END-IF.                                                      12915000
129160                                                                  12916000
129170     PERFORM 7100-SET-CURRENT-TMST.                               12917000
129180     MOVE PV-CURRENT-TMST            TO AUCNTK-AUD-TMST.          12918000
129190                                                                  12919000
129200 EJECT                                                            12920000
129210******************************************************************12921000
129220* SETUP THE TAUCNPO DCLGEN FIELDS PRIOR TO INSERT                *12922000
129230******************************************************************12923000
129240 7635-MOVE-TIMCNPO-TO-TAUCNPO.                                    12924000
129250                                                                  12925000
129260     INITIALIZE DCLTAUCNPO.                                       12926000
129270                                                                  12927000
129280     MOVE IMCNPO-CONTNR-ID           TO AUCNPO-CONTNR-ID.         12928000
129290     MOVE IMCNPO-CONTNR-SEQ-NBR      TO AUCNPO-CONTNR-SEQ-NBR.    12929000
129300     MOVE IMCNPO-PO-NBR              TO AUCNPO-PO-NBR.            12930000
129310     MOVE IMCNPO-EXTL-REF-NBR        TO AUCNPO-EXTL-REF-NBR.      12931000
129320     MOVE IMCNPO-CSTM-ENTR-ID        TO AUCNPO-CSTM-ENTR-ID.      12932000
129330     MOVE IMCNPO-MSTR-BOL-NBR        TO AUCNPO-MSTR-BOL-NBR.      12933000
129340     MOVE IMCNPO-HSE-BOL-NBR         TO AUCNPO-HSE-BOL-NBR.       12934000
129350     MOVE IMCNPO-LTR-OF-CR-NBR       TO AUCNPO-LTR-OF-CR-NBR.     12935000
129360     MOVE IMCNPO-PO-RCVD-DELY-TMST   TO AUCNPO-PO-RCVD-DELY-TMST. 12936000
129370     MOVE IMCNPO-PO-C-O-PROD-CDE     TO AUCNPO-PO-C-O-PROD-CDE.   12937000
129380     MOVE IMCNPO-PO-CART-CNT         TO AUCNPO-PO-CART-CNT.       12938000
129390     MOVE IMCNPO-PO-CBMT-QTY         TO AUCNPO-PO-CBMT-QTY.       12939000
129400     MOVE IMCNPO-PO-WT-KGRM-QTY      TO AUCNPO-PO-WT-KGRM-QTY.    12940000
129410     MOVE IMCNPO-PO-UNT-QTY          TO AUCNPO-PO-UNT-QTY.        12941000
129420     MOVE IMCNPO-LAST-UPD-BY-USR-ID  TO AUCNPO-LAST-UPD-BY-USR-ID.12942000
129430     MOVE IMCNPO-LAST-UPD-TMST       TO AUCNPO-LAST-UPD-TMST.     12943000
129440     MOVE IMCNPO-BKR-FRGT-RLSE-CDE   TO AUCNPO-BKR-FRGT-RLSE-CDE. 12944000
129450     MOVE IMCNPO-DO-RCVD-CDE         TO AUCNPO-DO-RCVD-CDE.       12945000
129460     MOVE IMCNPO-CONTNR-PU-CDE       TO AUCNPO-CONTNR-PU-CDE.     12946000
129470     MOVE IMCNPO-ACTL-POE-DELY-CDE   TO AUCNPO-ACTL-POE-DELY-CDE. 12947000
129480     MOVE IMCNPO-DVN-CDE             TO AUCNPO-DVN-CDE.           12948000
129490     MOVE IMCNPO-DCONSLR-RET-CDE     TO AUCNPO-DCONSLR-RET-CDE.   12949000
129500     MOVE IMCNPO-SPLT-XMIT-CDE       TO AUCNPO-SPLT-XMIT-CDE.     12950000
129510     MOVE IMCNPO-DOC-RCVD-ORGN-TMST  TO AUCNPO-DOC-RCVD-ORGN-TMST.12951000
129520                                                                  12952000
129530     IF TR023-CONPO-TRN-TYP = PC-D                                12953000
129540         MOVE PC-D                   TO AUCNPO-AUD-FUNC-CDE       12954000
129550                                        PV-FUNC-CDE               12955000
129560     ELSE                                                         12956000
129570         MOVE PC-U                   TO AUCNPO-AUD-FUNC-CDE       12957000
129580                                        PV-FUNC-CDE               12958000
129590     END-IF.                                                      12959000
129600                                                                  12960000
129610     PERFORM 7100-SET-CURRENT-TMST.                               12961000
129620     MOVE PV-CURRENT-TMST            TO AUCNPO-AUD-TMST.          12962000
129630                                                                  12963000
129640 EJECT                                                            12964000
129650******************************************************************12965000
129660* SETUP THE TAUCNUP DCLGEN FIELDS PRIOR TO INSERT                *12966000
129670******************************************************************12967000
129680 7645-MOVE-TIMCNUP-TO-TAUCNUP.                                    12968000
129690                                                                  12969000
129700     INITIALIZE DCLTAUCNUP.                                       12970000
129710                                                                  12971000
129720     MOVE IMCNUP-CONTNR-ID           TO AUCNUP-CONTNR-ID.         12972000
129730     MOVE IMCNUP-CONTNR-SEQ-NBR      TO AUCNUP-CONTNR-SEQ-NBR.    12973000
129740     MOVE IMCNUP-PO-NBR              TO AUCNUP-PO-NBR.            12974000
129750     MOVE IMCNUP-UPC-NBR             TO AUCNUP-UPC-NBR.           12975000
129760     MOVE IMCNUP-PO-LNE-NBR          TO AUCNUP-PO-LNE-NBR.        12976000
129770     MOVE IMCNUP-UPC-CART-CNT        TO AUCNUP-UPC-CART-CNT.      12977000
129780     MOVE IMCNUP-UPC-CBMT-QTY        TO AUCNUP-UPC-CBMT-QTY.      12978000
129790     MOVE IMCNUP-UPC-WT-KGRM-QTY     TO AUCNUP-UPC-WT-KGRM-QTY.   12979000
129800     MOVE IMCNUP-UPC-UNT-QTY         TO AUCNUP-UPC-UNT-QTY.       12980000
129810     MOVE IMCNUP-LAST-UPD-BY-USR-ID  TO AUCNUP-LAST-UPD-BY-USR-ID.12981000
129820     MOVE IMCNUP-LAST-UPD-TMST       TO AUCNUP-LAST-UPD-TMST.     12982000
129830     MOVE IMCNUP-SKU-NBR             TO AUCNUP-SKU-NBR.           12983000
129840     MOVE IMCNUP-ASN-PKGNG-CDE       TO AUCNUP-ASN-PKGNG-CDE.     12984000
129850                                                                  12985000
129860     IF TR023-CONUPC-TRN-TYP = PC-D                               12986000
129870         MOVE PC-D                   TO AUCNUP-AUD-FUNC-CDE       12987000
129880                                        PV-FUNC-CDE               12988000
129890     ELSE                                                         12989000
129900         MOVE PC-U                   TO AUCNUP-AUD-FUNC-CDE       12990000
129910                                        PV-FUNC-CDE               12991000
129920     END-IF.                                                      12992000
129930                                                                  12993000
129940     PERFORM 7100-SET-CURRENT-TMST.                               12994000
129950     MOVE PV-CURRENT-TMST            TO AUCNUP-AUD-TMST.          12995000
129960                                                                  12996000
129970 EJECT                                                            12997000
129980                                                                  12998000
129990******************************************************************12999000
130000* SETUP THE TAUCNRL DCLGEN FIELDS PRIOR TO INSERT                *13000000
130010******************************************************************13001000
130020 7650-MOVE-TIMCNRL-TO-TAUCNRL.                                    13002000
130030                                                                  13003000
130040     INITIALIZE DCLTAUCNRL.                                       13004000
130050                                                                  13005000
130060     MOVE IMCNRL-CONTNR-ID        TO AUCNRL-CONTNR-ID.            13006000
130070     MOVE IMCNRL-CONTNR-SEQ-NBR   TO AUCNRL-CONTNR-SEQ-NBR.       13007000
130080     MOVE IMCNRL-PO-NBR           TO AUCNRL-PO-NBR.               13008000
130090     MOVE IMCNRL-DCONSLR-RLSE-CDE TO AUCNRL-DCONSLR-RLSE-CDE.     13009000
130100     MOVE IMCNRL-DCONSLR-REQR-DTE TO AUCNRL-DCONSLR-REQR-DTE      13010000
130110     MOVE IMCNRL-DCONSLR-ACTL-DTE TO AUCNRL-DCONSLR-ACTL-DTE.     13011000
130120     MOVE IMCNRL-DCONSLR-ACTL-TM  TO AUCNRL-DCONSLR-ACTL-TM.      13012000
130130     MOVE IMCNRL-CRE-TMST         TO AUCNRL-CRE-TMST.             13013000
130140     MOVE IMCNRL-CRE-BY-UID       TO AUCNRL-CRE-BY-UID.           13014000
130150     MOVE IMCNRL-LAST-UPD-TMST    TO AUCNRL-LAST-UPD-TMST.        13015000
130160     MOVE IMCNRL-LAST-UPD-BY-UID  TO AUCNRL-LAST-UPD-BY-UID.      13016000
130170     MOVE IMCNRL-DCONSLR-ENT-ID   TO AUCNRL-DCONSLR-ENT-ID.       13017000
130180                                                                  13018000
130190     PERFORM 7100-SET-CURRENT-TMST.                               13019000
130200     MOVE PV-CURRENT-TMST         TO AUCNRL-AUD-TMST.             13020000
130210                                                                  13021000
130220     IF TR023-CNTR-TRN-TYP = PC-D                                 13022000
130230       OR PS-E-DELETE                                             13023000
130240         MOVE PC-D                TO AUCNRL-AUD-FUNC-CDE          13024000
130250     ELSE                                                         13025000
130260         MOVE PC-U                TO AUCNRL-AUD-FUNC-CDE          13026000
130270     END-IF.                                                      13027000
130280     SET PS-NOT-E-DELETE TO TRUE.                                 13028000
130290                                                                  13029000
130300     PERFORM 7037-INSERT-TAUCNRL.                                 13030000
130310                                                                  13031000
130320******************************************************************13032000
130330* SETUP THE TRT_AUD_IMPRT_CART DCLGEN FIELDS PRIOR TO INSERT     *13033000
130340******************************************************************13034000
130350 7655-MOVE-CARTON-TO-AUDIT.                                       13035000
130360                                                                  13036000
130370     INITIALIZE DCLTRT00009.                                      13037000
130380                                                                  13038000
130390     MOVE TRT00008-CONTNR-ID           TO TRT00009-CONTNR-ID.     13039000
130400     MOVE TRT00008-CONTNR-SEQ-NBR      TO TRT00009-CONTNR-SEQ-NBR.13040000
130410     MOVE TRT00008-PO-NBR              TO TRT00009-PO-NBR.        13041000
130420     MOVE TRT00008-UPC-NBR             TO TRT00009-UPC-NBR.       13042000
130430     MOVE TRT00008-SSCC-ID             TO TRT00009-SSCC-ID.       13043000
130440     MOVE TRT00008-UNT-QTY             TO TRT00009-UNT-QTY.       13044000
130450     MOVE TRT00008-LAST-UPD-BY-USR-ID  TO                         13045000
130460                                     TRT00009-LAST-UPD-BY-USR-ID. 13046000
130470     MOVE TRT00008-LAST-UPD-TMST       TO TRT00009-LAST-UPD-TMST. 13047000
130480                                                                  13048000
130490     IF TR023-CNCART-TRN-TYP = PC-D                               13049000
130500         MOVE PC-D                   TO TRT00009-AUD-FUNC-CDE     13050000
130510                                        PV-FUNC-CDE               13051000
130520     ELSE                                                         13052000
130530         MOVE PC-U                   TO TRT00009-AUD-FUNC-CDE     13053000
130540                                        PV-FUNC-CDE               13054000
130550     END-IF.                                                      13055000
130560                                                                  13056000
130570     PERFORM 7100-SET-CURRENT-TMST.                               13057000
130580     MOVE PV-CURRENT-TMST            TO TRT00009-AUD-TMST.        13058000
130590                                                                  13059000
130600 EJECT                                                            13060000
130610                                                                  13061000
130620******************************************************************13062000
130630* SETUP THE TRT_AUD_IMPRT_SEAL DCLGEN FIELDS PRIOR TO INSERT     *13063000
130640******************************************************************13064000
130650 7660-MOVE-SEAL-TO-AUDIT.                                         13065000
130660                                                                  13066000
130670     INITIALIZE DCLTRT00007.                                      13067000
130680                                                                  13068000
130690     MOVE TRT00006-CONTNR-ID       TO TRT00007-CONTNR-ID.         13069000
130700     MOVE TRT00006-CONTNR-SEQ-NBR  TO TRT00007-CONTNR-SEQ-NBR.    13070000
130710     MOVE TRT00006-SEAL-NBR        TO TRT00007-SEAL-NBR.          13071000
130720     MOVE TRT00006-LAST-UPD-BY-USR-ID TO                          13072000
130730                                   TRT00007-LAST-UPD-BY-USR-ID.   13073000
130740     MOVE TRT00006-LAST-UPD-TMST   TO TRT00007-LAST-UPD-TMST.     13074000
130750                                                                  13075000
130760     IF TR023-CNSEAL-TRN-TYP = PC-D                               13076000
130770         MOVE PC-D                   TO TRT00007-AUD-FUNC-CDE     13077000
130780                                        PV-FUNC-CDE               13078000
130790     ELSE                                                         13079000
130800         MOVE PC-U                   TO TRT00007-AUD-FUNC-CDE     13080000
130810                                        PV-FUNC-CDE               13081000
130820     END-IF.                                                      13082000
130830                                                                  13083000
130840     PERFORM 7100-SET-CURRENT-TMST.                               13084000
130850     MOVE PV-CURRENT-TMST            TO TRT00007-AUD-TMST.        13085000
130860                                                                  13086000
130870 EJECT                                                            13087000
130880                                                                  13088000
130890******************************************************************13089000
130900* EDIT THE POE CODE FOR DECON CONTROL PANEL                      *13090000
130910******************************************************************13091000
130920 7690-EDIT-POE-CDE-DCN.                                           13092000
130930                                                                  13093000
130940*THESE NEXT 3 PARAGRAPHS ARE NOT BEING USED.  AME 10/2007        *13094000
130950*DURING LANDED/AIR ASN PROJECT THE KOHL'S GROUP WORKING WITH     *13095000
130960*AVERY AGREED THAT AVERY COULD SEND SCHEDULE D CODES, OCEAN PORT *13096000
130970*CODES, INSTEAD OF IATA CODES, AIRPORT CODES, FOR THE AIR ASN.   *13097000
130980*OTHER PROGRAMS CHANGED TRKCS165, TRKCS188, TRKCS162, TRKCS190,  *13098000
130990*TRKCS189, TRKCS167, TRKCS181, TRKCS192.                         *13099000
131000*    EVALUATE TRUE                                                13100000
131010*        WHEN PV-COMPARE-TRIP-TYP-CDE = PC-A                      13101000
131020*            PERFORM 7770-OPEN-POE-CURSOR-AIR-DCN                 13102000
131030*            PERFORM 7772-FETCH-POE-CURSOR-AIR-DCN                13103000
131040*            PERFORM 7771-CLOSE-POE-CURSOR-AIR-DCN                13104000
131050*                                                                 13105000
131060*        WHEN PV-COMPARE-TRIP-TYP-CDE = PC-O                      13106000
131070             PERFORM 7773-OPEN-POE-CURSOR-OCEAN-DCN.              13107000
131080             PERFORM 7775-FETCH-POE-CURSOR-OCN-DCN.               13108000
131090             PERFORM 7774-CLOSE-POE-CURSOR-OCN-DCN.               13109000
131100*    END-EVALUATE.                                                13110000
131110                                                                  13111000
131120******************************************************************13112000
131130*THIS PARAGRAPH IS NOT BEING USED.  AME 10/2007                  *13113000
131140*   OPEN THE POE CODE AIR CURSOR FOR CONTROL DECON PANEL         *13114000
131150******************************************************************13115000
131160 7770-OPEN-POE-CURSOR-AIR-DCN.                                    13116000
131170                                                                  13117000
131180     PERFORM                                                      13118000
131190         WITH TEST AFTER                                          13119000
131200         VARYING PV-RETRY-COUNTER                                 13120000
131210         FROM 1 BY 1                                              13121000
131220         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13122000
131230                   OR (SQLCODE = ZERO))                           13123000
131240                                                                  13124000
131250         EXEC SQL                                                 13125000
131260              OPEN POE-CSR-AIR-DCN                                13126000
131270         END-EXEC                                                 13127000
131280                                                                  13128000
131290         EVALUATE TRUE                                            13129000
131300             WHEN SQLCODE = ZERO                                  13130000
131310                 CONTINUE                                         13131000
131320             WHEN SQLWARN0 NOT EQUAL SPACE                        13132000
131330             WHEN SQLCODE NOT EQUAL ZERO                          13133000
131340                 DISPLAY '**************************************' 13134000
131350                 DISPLAY '** ABEND                            **' 13135000
131360                 DISPLAY '** PROGRAM = TRKUP215               **' 13136000
131370              DISPLAY '** PARAGRAPH = 7700-OPEN-POE-CSR-AIR-DCN*' 13137000
131380                 DISPLAY '** OPEN POE CODE AIR CURSOR - DECON **' 13138000
131390                 DISPLAY '**************************************' 13139000
131400                 PERFORM 9100-SQL-ABEND                           13140000
131410         END-EVALUATE                                             13141000
131420     END-PERFORM.                                                 13142000
131430                                                                  13143000
131440     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13144000
131450         (SQLCODE NOT = ZERO)                                     13145000
131460         DISPLAY '****************************************'       13146000
131470         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13147000
131480         DISPLAY '** OPEN POE CODE AIR CURSOR - DECON   **'       13148000
131490         DISPLAY '** PARAGRAPH = 7700-OPEN-POE-CURSOR-AIR-DCN'    13149000
131500         DISPLAY '****************************************'       13150000
131510         PERFORM 9100-SQL-ABEND                                   13151000
131520     END-IF.                                                      13152000
131530                                                                  13153000
131540 EJECT                                                            13154000
131550******************************************************************13155000
131560*THIS PARAGRAPH IS NOT BEING USED.  AME 10/2007                  *13156000
131570*   CLOSE THE POE CODE AIR CURSOR FOR DECON CONTROL PANEL        *13157000
131580******************************************************************13158000
131590 7771-CLOSE-POE-CURSOR-AIR-DCN.                                   13159000
131600                                                                  13160000
131610     PERFORM                                                      13161000
131620         WITH TEST AFTER                                          13162000
131630         VARYING PV-RETRY-COUNTER                                 13163000
131640         FROM 1 BY 1                                              13164000
131650         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13165000
131660                   OR (SQLCODE = ZERO))                           13166000
131670                                                                  13167000
131680         EXEC SQL                                                 13168000
131690             CLOSE POE-CSR-AIR-DCN                                13169000
131700         END-EXEC                                                 13170000
131710                                                                  13171000
131720         EVALUATE TRUE                                            13172000
131730             WHEN SQLCODE = ZERO                                  13173000
131740                 CONTINUE                                         13174000
131750             WHEN SQLWARN0 NOT EQUAL SPACE                        13175000
131760             WHEN SQLCODE NOT EQUAL ZERO                          13176000
131770                 DISPLAY '**************************************' 13177000
131780                 DISPLAY '** ABEND                            **' 13178000
131790                 DISPLAY '** PROGRAM = TRKUP215               **' 13179000
131800              DISPLAY '** PARAGRAPH = 7781-CLOSE-POE-CSR-AIR-DCN' 13180000
131810                 DISPLAY '** CLOSE POE CODE AIR CURSOR - DECON**' 13181000
131820                 DISPLAY '**************************************' 13182000
131830                 PERFORM 9100-SQL-ABEND                           13183000
131840         END-EVALUATE                                             13184000
131850     END-PERFORM.                                                 13185000
131860                                                                  13186000
131870     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13187000
131880         (SQLCODE NOT = ZERO)                                     13188000
131890         DISPLAY '****************************************'       13189000
131900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13190000
131910         DISPLAY '** CLOSE POE CODE AIR CURSOR - DECON  **'       13191000
131920         DISPLAY '** PARAGRAPH = 7781-CLOSE-POE-CSR-AIR-DCN'      13192000
131930         DISPLAY '****************************************'       13193000
131940         PERFORM 9100-SQL-ABEND                                   13194000
131950     END-IF.                                                      13195000
131960                                                                  13196000
131970 EJECT                                                            13197000
131980******************************************************************13198000
131990*THIS PARAGRAPH IS NOT BEING USED.  AME 10/2007                  *13199000
132000*    FETCH THE POE CODE AIR CURSOR FOR DECON CONTROL PANEL       *13200000
132010******************************************************************13201000
132020 7772-FETCH-POE-CURSOR-AIR-DCN.                                   13202000
132030                                                                  13203000
132040     EXEC SQL                                                     13204000
132050          FETCH POE-CSR-AIR-DCN                                   13205000
132060          INTO  :IMPOE-POE-CDE                                    13206000
132070     END-EXEC.                                                    13207000
132080                                                                  13208000
132090     EVALUATE TRUE                                                13209000
132100         WHEN SQLCODE = ZERO                                      13210000
132110         WHEN SQLCODE = -811                                      13211000
132120             SET PS-VALID-POE-CDE    TO TRUE                      13212000
132130             MOVE IMPOE-POE-CDE TO PV-TR265-POE-CDE               13213000
132140                                                                  13214000
132150         WHEN SQLCODE = +100                                      13215000
132160             SET PS-INVALID-POE-CDE  TO TRUE                      13216000
132170             MOVE SPACES TO PV-TR265-POE-CDE                      13217000
132180                                                                  13218000
132190         WHEN SQLWARN0 NOT EQUAL SPACE                            13219000
132200         WHEN SQLCODE NOT EQUAL ZERO                              13220000
132210             DISPLAY '**************************************'     13221000
132220             DISPLAY '** ABEND                            **'     13222000
132230             DISPLAY '** PROGRAM = TRKUP215               **'     13223000
132240             DISPLAY '** PARAGRAPH = 7772-FETCH-POE-CSR-AIR-DCN'  13224000
132250             DISPLAY '** FETCH TIMPOE POE CODE AIR - DECON**'     13225000
132260             DISPLAY '** POE CDE AIR = ' PV-HOLD-POE-CDE          13226000
132270             DISPLAY '**************************************'     13227000
132280             PERFORM 9100-SQL-ABEND                               13228000
132290     END-EVALUATE.                                                13229000
132300                                                                  13230000
132310     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13231000
132320         (SQLCODE NOT = ZERO    AND                               13232000
132330          SQLCODE NOT = -811    AND                               13233000
132340          SQLCODE NOT = +100)                                     13234000
132350         DISPLAY '****************************************'       13235000
132360         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13236000
132370         DISPLAY '** FETCH FROM TIMPOE                  **'       13237000
132380         DISPLAY '** PARAGRAPH = 7772-FETCH-POE-CSR-AIR-DCN'      13238000
132390         DISPLAY '** POE CDE AIR = ' PV-HOLD-POE-CDE              13239000
132400         DISPLAY '****************************************'       13240000
132410         PERFORM 9100-SQL-ABEND                                   13241000
132420     END-IF.                                                      13242000
132430                                                                  13243000
132440 EJECT                                                            13244000
132450******************************************************************13245000
132460*   OPEN THE POE CODE OCEAN CURSOR FOR DECON CONTROL PANEL       *13246000
132470******************************************************************13247000
132480 7773-OPEN-POE-CURSOR-OCEAN-DCN.                                  13248000
132490                                                                  13249000
132500     PERFORM                                                      13250000
132510         WITH TEST AFTER                                          13251000
132520         VARYING PV-RETRY-COUNTER                                 13252000
132530         FROM 1 BY 1                                              13253000
132540         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13254000
132550                   OR (SQLCODE = ZERO))                           13255000
132560                                                                  13256000
132570         EXEC SQL                                                 13257000
132580              OPEN POE-CSR-OCEAN-DCN                              13258000
132590         END-EXEC                                                 13259000
132600                                                                  13260000
132610         EVALUATE TRUE                                            13261000
132620             WHEN SQLCODE = ZERO                                  13262000
132630                 CONTINUE                                         13263000
132640             WHEN SQLWARN0 NOT EQUAL SPACE                        13264000
132650             WHEN SQLCODE NOT EQUAL ZERO                          13265000
132660                 DISPLAY '**************************************' 13266000
132670                 DISPLAY '** ABEND                            **' 13267000
132680                 DISPLAY '** PROGRAM = TRKUP215               **' 13268000
132690               DISPLAY '** PARAGRAPH = 7773-OPEN-POE-CSR-OCN-DCN' 13269000
132700                 DISPLAY '** OPEN POE CODE OCEAN CURSOR- DECON**' 13270000
132710                 DISPLAY '**************************************' 13271000
132720                 PERFORM 9100-SQL-ABEND                           13272000
132730         END-EVALUATE                                             13273000
132740     END-PERFORM.                                                 13274000
132750                                                                  13275000
132760     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13276000
132770         (SQLCODE NOT = ZERO)                                     13277000
132780         DISPLAY '****************************************'       13278000
132790         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13279000
132800         DISPLAY '** OPEN POE CODE OCEAN CURSOR - DECON **'       13280000
132810         DISPLAY '** PARAGRAPH = 7773-OPEN-POE-CURSOR-OCN-DCN'    13281000
132820         DISPLAY '****************************************'       13282000
132830         PERFORM 9100-SQL-ABEND                                   13283000
132840     END-IF.                                                      13284000
132850                                                                  13285000
132860 EJECT                                                            13286000
132870******************************************************************13287000
132880*   CLOSE THE POE CODE OCEAN CURSOR FOR DECON CONTROL PANEL      *13288000
132890******************************************************************13289000
132900 7774-CLOSE-POE-CURSOR-OCN-DCN.                                   13290000
132910                                                                  13291000
132920     PERFORM                                                      13292000
132930         WITH TEST AFTER                                          13293000
132940         VARYING PV-RETRY-COUNTER                                 13294000
132950         FROM 1 BY 1                                              13295000
132960         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13296000
132970                   OR (SQLCODE = ZERO))                           13297000
132980                                                                  13298000
132990         EXEC SQL                                                 13299000
133000             CLOSE POE-CSR-OCEAN-DCN                              13300000
133010         END-EXEC                                                 13301000
133020                                                                  13302000
133030         EVALUATE TRUE                                            13303000
133040             WHEN SQLCODE = ZERO                                  13304000
133050                 CONTINUE                                         13305000
133060             WHEN SQLWARN0 NOT EQUAL SPACE                        13306000
133070             WHEN SQLCODE NOT EQUAL ZERO                          13307000
133080                 DISPLAY '**************************************' 13308000
133090                 DISPLAY '** ABEND                            **' 13309000
133100                 DISPLAY '** PROGRAM = TRKUP215               **' 13310000
133110              DISPLAY '** PARAGRAPH = 7774-CLOSE-POE-CSR-OCN-DCN' 13311000
133120                 DISPLAY '** CLOSE POE CODE OCEAN CURSOR-DECON**' 13312000
133130                 DISPLAY '**************************************' 13313000
133140                 PERFORM 9100-SQL-ABEND                           13314000
133150         END-EVALUATE                                             13315000
133160     END-PERFORM.                                                 13316000
133170                                                                  13317000
133180     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13318000
133190         (SQLCODE NOT = ZERO)                                     13319000
133200         DISPLAY '****************************************'       13320000
133210         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13321000
133220         DISPLAY '** CLOSE POE CODE OCEAN CURSOR-DECON  **'       13322000
133230         DISPLAY '** PARAGRAPH = 7774-CLOSE-POE-CSR-OCN-DCN'      13323000
133240         DISPLAY '****************************************'       13324000
133250         PERFORM 9100-SQL-ABEND                                   13325000
133260     END-IF.                                                      13326000
133270                                                                  13327000
133280 EJECT                                                            13328000
133290******************************************************************13329000
133300*    FETCH THE POE CODE OCEAN CURSOR FOR DECON CONTROL PANEL     *13330000
133310******************************************************************13331000
133320 7775-FETCH-POE-CURSOR-OCN-DCN.                                   13332000
133330                                                                  13333000
133340     EXEC SQL                                                     13334000
133350          FETCH POE-CSR-OCEAN-DCN                                 13335000
133360          INTO  :IMPOE-POE-CDE                                    13336000
133370     END-EXEC.                                                    13337000
133380                                                                  13338000
133390     EVALUATE TRUE                                                13339000
133400         WHEN SQLCODE = ZERO                                      13340000
133410         WHEN SQLCODE = -811                                      13341000
133420             MOVE IMPOE-POE-CDE TO PV-TR265-POE-CDE               13342000
133430                                                                  13343000
133440         WHEN SQLCODE = +100                                      13344000
133450             MOVE SPACES TO PV-TR265-POE-CDE                      13345000
133460                                                                  13346000
133470                                                                  13347000
133480         WHEN SQLWARN0 NOT EQUAL SPACE                            13348000
133490         WHEN SQLCODE NOT EQUAL ZERO                              13349000
133500             DISPLAY '**************************************'     13350000
133510             DISPLAY '** ABEND                            **'     13351000
133520             DISPLAY '** PROGRAM = TRKUP215               **'     13352000
133530             DISPLAY '** PARAGRAPH = 7775-FETCH-POE-CSR-OCN-DCN'  13353000
133540             DISPLAY '** FETCH TIMPOE POE CODE OCEAN - DECON'     13354000
133550             DISPLAY '** POE CDE OCEAN  = ' PV-HOLD-POE-CDE       13355000
133560             DISPLAY '**************************************'     13356000
133570             PERFORM 9100-SQL-ABEND                               13357000
133580     END-EVALUATE.                                                13358000
133590                                                                  13359000
133600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13360000
133610         (SQLCODE NOT = ZERO    AND                               13361000
133620          SQLCODE NOT = -811    AND                               13362000
133630          SQLCODE NOT = +100)                                     13363000
133640         DISPLAY '****************************************'       13364000
133650         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13365000
133660         DISPLAY '** FETCH FROM TIMPOE                  **'       13366000
133670         DISPLAY '** PARAGRAPH = 7775-FETCH-POE-CSR-OCN-DCN'      13367000
133680         DISPLAY '** POE CDE OCEAN = ' PV-HOLD-POE-CDE            13368000
133690         DISPLAY '****************************************'       13369000
133700         PERFORM 9100-SQL-ABEND                                   13370000
133710     END-IF.                                                      13371000
133720                                                                  13372000
133730 EJECT                                                            13373000
133740******************************************************************13374000
133750* EDIT THE FOB CODE FOR DECON CONTROL PANEL CHANGES              *13375000
133760******************************************************************13376000
133770 7780-EDIT-FOB-CDE-DCN.                                           13377000
133780                                                                  13378000
133790     EVALUATE TRUE                                                13379000
133800         WHEN PV-COMPARE-TRIP-TYP-CDE = PC-A                      13380000
133810             PERFORM 7781-SELECT-FOB-AIR-DCN                      13381000
133820                                                                  13382000
133830         WHEN PV-COMPARE-TRIP-TYP-CDE = PC-O                      13383000
133840             PERFORM 7782-SELECT-FOB-OCEAN-DCN                    13384000
133850     END-EVALUATE.                                                13385000
133860                                                                  13386000
133870******************************************************************13387000
133880* SELECT FOB CODE FOR AIR - DECON CONTROL PANEL CHANGES          *13388000
133890******************************************************************13389000
133900 7781-SELECT-FOB-AIR-DCN.                                         13390000
133910                                                                  13391000
133920     PERFORM                                                      13392000
133930         WITH TEST AFTER                                          13393000
133940         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     13394000
133950         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            13395000
133960                 SQLCODE = ZERO                     OR            13396000
133970                 SQLCODE = -811                     OR            13397000
133980                 SQLCODE = +100                                   13398000
133990                                                                  13399000
134000         EXEC SQL                                                 13400000
134010             SELECT A.FOB_CDE                                     13401000
134020              INTO :IMFOB-FOB-CDE                                 13402000
134030               FROM TIMFOB  A                                     13403000
134040              WHERE A.FOB_CDE     =   :PV-COMPARE-MOM-FOB-CDE     13404000
134050                AND A.STAT_CDE    =   'A'                         13405000
134060             WITH UR                                              13406000
134070         END-EXEC                                                 13407000
134080                                                                  13408000
134090         EVALUATE TRUE                                            13409000
134100             WHEN SQLCODE = ZERO                                  13410000
134110             WHEN SQLCODE = -811                                  13411000
134120                 MOVE IMFOB-FOB-CDE TO PV-TR265-FOB-CDE           13412000
134130                                                                  13413000
134140             WHEN SQLCODE = +100                                  13414000
134150                 MOVE SPACES TO PV-TR265-FOB-CDE                  13415000
134160                                                                  13416000
134170             WHEN SQLWARN0 NOT EQUAL SPACE                        13417000
134180             WHEN SQLCODE NOT EQUAL ZERO                          13418000
134190                 DISPLAY '**************************************' 13419000
134200                 DISPLAY '** ABEND                            **' 13420000
134210                 DISPLAY '** PROGRAM = TRKUP215               **' 13421000
134220                 DISPLAY '** PARAGRAPH = 7781-SELECT-FOB-AIR-DCN' 13422000
134230                 DISPLAY '** SELECT TIMFOB FOB CODE - DECON   **' 13423000
134240                 DISPLAY '** CONTNR ID   = ' AUCNTK-CONTNR-ID     13424000
134250                 DISPLAY '** SAIL DATE   = ' AUCNTK-MOM-DPRTR-TMST13425000
134260                 DISPLAY '** FOB CODE    = ' AUCNTK-MOM-FOB-CDE   13426000
134270                 DISPLAY '**************************************' 13427000
134280                 PERFORM 9100-SQL-ABEND                           13428000
134290         END-EVALUATE                                             13429000
134300     END-PERFORM.                                                 13430000
134310                                                                  13431000
134320     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13432000
134330         (SQLCODE NOT = ZERO    AND                               13433000
134340          SQLCODE NOT = -811    AND                               13434000
134350          SQLCODE NOT = +100)                                     13435000
134360         DISPLAY '****************************************'       13436000
134370         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13437000
134380         DISPLAY '** SELECT FROM TIMFOB                 **'       13438000
134390         DISPLAY '** PARAGRAPH = 7781-SELECT-FOB-AIR-DCN**'       13439000
134400         DISPLAY '** CONTNR ID    = ' AUCNTK-CONTNR-ID            13440000
134410         DISPLAY '** SAIL DATE    = ' AUCNTK-MOM-DPRTR-TMST       13441000
134420         DISPLAY '** FOB CODE     = ' AUCNTK-MOM-FOB-CDE          13442000
134430         DISPLAY '****************************************'       13443000
134440         PERFORM 9100-SQL-ABEND                                   13444000
134450     END-IF.                                                      13445000
134460                                                                  13446000
134470 EJECT                                                            13447000
134480******************************************************************13448000
134490* SELECT FOB CODE FOR OCEAN - DECON CONTROL PANEL CHANGES        *13449000
134500******************************************************************13450000
134510 7782-SELECT-FOB-OCEAN-DCN.                                       13451000
134520                                                                  13452000
134530     PERFORM                                                      13453000
134540         WITH TEST AFTER                                          13454000
134550         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     13455000
134560         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            13456000
134570                 SQLCODE = ZERO                     OR            13457000
134580                 SQLCODE = -811                     OR            13458000
134590                 SQLCODE = +100                                   13459000
134600                                                                  13460000
134610         EXEC SQL                                                 13461000
134620             SELECT A.FOB_CDE                                     13462000
134630              INTO :IMFOB-FOB-CDE                                 13463000
134640               FROM TIMFOB  A                                     13464000
134650              WHERE A.FOB_STD_EDI_CDE  = :PV-COMPARE-MOM-FOB-CDE  13465000
134660                AND A.STAT_CDE         = 'A'                      13466000
134670              WITH UR                                             13467000
134680         END-EXEC                                                 13468000
134690                                                                  13469000
134700         EVALUATE TRUE                                            13470000
134710             WHEN SQLCODE = ZERO                                  13471000
134720             WHEN SQLCODE = -811                                  13472000
134730                 MOVE IMFOB-FOB-CDE TO PV-TR265-FOB-CDE           13473000
134740                                                                  13474000
134750             WHEN SQLCODE = +100                                  13475000
134760                 MOVE SPACES TO PV-TR265-FOB-CDE                  13476000
134770                                                                  13477000
134780             WHEN SQLWARN0 NOT EQUAL SPACE                        13478000
134790             WHEN SQLCODE NOT EQUAL ZERO                          13479000
134800                 DISPLAY '**************************************' 13480000
134810                 DISPLAY '** ABEND                            **' 13481000
134820                 DISPLAY '** PROGRAM = TRKUP215               **' 13482000
134830              DISPLAY '** PARAGRAPH = 7772-SELECT-FOB-OCEAN-DCN'  13483000
134840                 DISPLAY '** SELECT TIMFOB FOB CODE - DECON   **' 13484000
134850                 DISPLAY '** CONTNR ID   = ' AUCNTK-CONTNR-ID     13485000
134860                 DISPLAY '** SAIL DATE   = ' AUCNTK-MOM-DPRTR-TMST13486000
134870                 DISPLAY '** FOB CODE    = ' AUCNTK-MOM-FOB-CDE   13487000
134880                 DISPLAY '**************************************' 13488000
134890                 PERFORM 9100-SQL-ABEND                           13489000
134900         END-EVALUATE                                             13490000
134910     END-PERFORM.                                                 13491000
134920                                                                  13492000
134930     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13493000
134940         (SQLCODE NOT = ZERO    AND                               13494000
134950          SQLCODE NOT = -811 AND                                  13495000
134960          SQLCODE NOT = +100)                                     13496000
134970         DISPLAY '****************************************'       13497000
134980         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       13498000
134990         DISPLAY '** SELECT FROM TIMFOB                 **'       13499000
135000         DISPLAY '** PARAGRAPH = 7782-SELECT-FOB-OCEAN-DCN'       13500000
135010         DISPLAY '** CONTNR ID    = ' AUCNTK-CONTNR-ID            13501000
135020         DISPLAY '** SAIL DATE    = ' AUCNTK-MOM-DPRTR-TMST       13502000
135030         DISPLAY '** FOB CODE     = ' AUCNTK-MOM-FOB-CDE          13503000
135040         DISPLAY '****************************************'       13504000
135050         PERFORM 9100-SQL-ABEND                                   13505000
135060     END-IF.                                                      13506000
135070                                                                  13507000
135080 EJECT                                                            13508000
135090******************************************************************13509000
135100* TAKES A FINAL COMMIT, CLOSES THE INPUT FILE, AND DISPLAYS      *13510000
135110* MISCELLANEOUS JOB SUMMARY INFORMATION.                         *13511000
135120******************************************************************13512000
135130 8000-EOJ-ROUTINE.                                                13513000
135140                                                                  13514000
135150     PERFORM 4300-COMMIT.                                         13515000
135160     DISPLAY 'COMMIT TAKEN AT '.                                  13516000
135170     DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)   13517000
135180      '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2).  13518000
135190                                                                  13519000
135200     CLOSE TR023-CONTAINER-FILE.                                  13520000
135210                                                                  13521000
135220     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              13522000
135230     PERFORM 4200-UPDATE-TCKRSTCNTL.                              13523000
135240                                                                  13524000
135250     DISPLAY '*************************************************'. 13525000
135260     DISPLAY '**           TRKUP215 SUMMARY                  **'. 13526000
135270     DISPLAY 'CONTAINER INPUT COUNT  = ' PV-CONT-INPUT-COUNT.     13527000
135280     DISPLAY 'CNTK RECS INSERT COUNT = ' PA-TOT-CNTK-RECS-INSERT. 13528000
135290     DISPLAY 'CNPO RECS INSERT COUNT = ' PA-TOT-CNPO-RECS-INSERT. 13529000
135300     DISPLAY 'CNUP RECS INSERT COUNT = ' PA-TOT-CNUP-RECS-INSERT. 13530000
135310     DISPLAY 'CNRL RECS INSERT COUNT = ' PA-TOT-CNRL-RECS-INSERT. 13531000
135320     DISPLAY 'CNCT RECS INSERT COUNT = ' PA-TOT-CNCT-RECS-INSERT. 13532000
135330     DISPLAY 'CNSL RECS INSERT COUNT = ' PA-TOT-CNSL-RECS-INSERT. 13533000
135340     DISPLAY 'ACNRL REC INSERT COUNT = ' PA-TOT-ACNRL-RECS-INSERT.13534000
135350     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-RECS-INSERT.13535000
135360     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-RECS-INSERT.13536000
135370     DISPLAY 'ACNUP REC INSERT COUNT = ' PA-TOT-ACNUP-RECS-INSERT.13537000
135380     DISPLAY 'ACNCT REC INSERT COUNT = ' PA-TOT-ACNCT-RECS-INSERT.13538000
135390     DISPLAY 'ACNSL REC INSERT COUNT = ' PA-TOT-ACNSL-RECS-INSERT.13539000
135400     DISPLAY 'TOTAL RECORDS INSERTED = ' PA-TOT-RECS-INSERTED.    13540000
135410     DISPLAY 'TOTAL TOUTTM1 INSERTED = ' PA-TOT-TOUTTM1-INSERTS.  13541000
135420     DISPLAY '-------------------------------------------------'. 13542000
135430     DISPLAY 'CNTK RECS DELETE COUNT = ' PA-TOT-CNTK-RECS-DELETED.13543000
135440     DISPLAY 'CNPO RECS DELETE COUNT = ' PA-TOT-CNPO-RECS-DELETED.13544000
135450     DISPLAY 'CNUP RECS DELETE COUNT = ' PA-TOT-CNUP-RECS-DELETED.13545000
135460     DISPLAY 'CNRL RECS DELETE COUNT = ' PA-TOT-CNRL-RECS-DELETED.13546000
135470     DISPLAY 'CNCT RECS DELETE COUNT = ' PA-TOT-CNCT-RECS-DELETED.13547000
135480     DISPLAY 'CNSL RECS DELETE COUNT = ' PA-TOT-CNSL-RECS-DELETED.13548000
135490     DISPLAY 'TOTAL RECORDS DELETED  = ' PA-TOT-RECS-DELETED.     13549000
135500     DISPLAY '-------------------------------------------------'. 13550000
135510     DISPLAY 'CNTK RECS SELECT COUNT = ' PA-TOT-CNTK-RECS-SELECT. 13551000
135520     DISPLAY 'CNPO RECS SELECT COUNT = ' PA-TOT-CNPO-RECS-SELECT. 13552000
135530     DISPLAY 'CNUP RECS SELECT COUNT = ' PA-TOT-CNUP-RECS-SELECT. 13553000
135540     DISPLAY 'CNRL RECS SELECT COUNT = ' PA-TOT-CNRL-RECS-SELECT. 13554000
135550     DISPLAY 'CNCT RECS SELECT COUNT = ' PA-TOT-CNCT-RECS-SELECT. 13555000
135560     DISPLAY 'CNSL RECS SELECT COUNT = ' PA-TOT-CNSL-RECS-SELECT. 13556000
135570     DISPLAY 'TOTAL RECORDS SELECTED = ' PA-TOT-RECS-SELECTED.    13557000
135580     DISPLAY '-------------------------------------------------'. 13558000
135590     DISPLAY 'CNTK CHANGE ADDS - B   = ' PA-TOT-CNTK-CHANGES-B.   13559000
135600     DISPLAY 'CNPO CHANGE ADDS - B   = ' PA-TOT-CNPO-CHANGES-B.   13560000
135610     DISPLAY 'CNUP CHANGE ADDS - B   = ' PA-TOT-CNUP-CHANGES-B.   13561000
135620     DISPLAY 'CNCT CHANGE ADDS - B   = ' PA-TOT-CNCT-CHANGES-B.   13562000
135630     DISPLAY 'CNSL CHANGE ADDS - B   = ' PA-TOT-CNSL-CHANGES-B.   13563000
135640     DISPLAY 'TOTAL CHANGE ADDS- B   = ' PA-TOT-RECS-CHANGED-B.   13564000
135650     DISPLAY '-------------------------------------------------'. 13565000
135660     DISPLAY 'CNPO CHANGE ADDS - Z   = ' PA-TOT-CNPO-CHANGES-Z.   13566000
135670     DISPLAY 'CNUP CHANGE ADDS - Z   = ' PA-TOT-CNUP-CHANGES-Z.   13567000
135680     DISPLAY 'CNCT CHANGE ADDS - Z   = ' PA-TOT-CNCT-CHANGES-Z.   13568000
135690     DISPLAY 'CNSL CHANGE ADDS - Z   = ' PA-TOT-CNSL-CHANGES-Z.   13569000
135700     DISPLAY 'TOTAL CHANGE ADDS- Z   = ' PA-TOT-RECS-CHANGED-Z.   13570000
135710     DISPLAY '-------------------------------------------------'. 13571000
135720     DISPLAY 'CNPO DELETES     - E   = ' PA-TOT-CNPO-DELETES-E.   13572000
135730     DISPLAY 'CNUP DELETES     - E   = ' PA-TOT-CNUP-DELETES-E.   13573000
135740     DISPLAY 'CNCT DELETES     - E   = ' PA-TOT-CNCT-DELETES-E.   13574000
135750     DISPLAY 'CNSL DELETES     - E   = ' PA-TOT-CNSL-DELETES-E.   13575000
135760     DISPLAY 'TOTAL DELETES    - E   = ' PA-TOT-RECS-DELETED-E.   13576000
135770     DISPLAY '-------------------------------------------------'. 13577000
135780     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS.        13578000
135790     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.    13579000
135800     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.   13580000
135810     DISPLAY 'TOTAL REPORT COUNT     = ' PA-TOTAL-REPORT-COUNT.   13581000
135820     DISPLAY 'TOTAL RULE COUNT       = ' PA-TOTAL-RULE-COUNT.     13582000
135830     DISPLAY '*************************************************'. 13583000
135840     DISPLAY 'TOT CNPO ENTR ID SELS = ' PA-ENTR-ID-SELECTS.       13584000
135850     DISPLAY 'MUL CNPO ENTR ID SELS = ' PA-MULTI-ENTR-ID-SELECTS. 13585000
135860                                                                  13586000
135870 EJECT                                                            13587000
135880******************************************************************13588000
135890* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *13589000
135900* ERROR OR WARNING CODE OCCURS.                                  *13590000
135910******************************************************************13591000
135920 9100-SQL-ABEND.                                                  13592000
135930******************************************************************13593000
135940* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *13594000
135950* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *13595000
135960* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *13596000
135970* FORMAT.                                                        *13597000
135980******************************************************************13598000
135990                                                                  13599000
136000     COPY DPPD004.                                                13600000
136010                                                                  13601000
136020     DISPLAY '************* CONTAINER ABEND *******************'  13602000
136030     DISPLAY 'CONTNR ID        '  TR023-CNTR-CONTNR-ID.           13603000
136040     DISPLAY 'SAIL DATE        '  TR023-CNTR-ACTL-DPRTR-DTE-MOM.  13604000
136050     DISPLAY 'SAIL TIME        '  TR023-CNTR-ACTL-DPRTR-TM-MOM.   13605000
136060     DISPLAY 'TRAN TYPE        '  TR023-CNTR-TRN-TYP.             13606000
136070     DISPLAY 'HOLD CONTNR ID   '  PV-HOLD-CONTNR-ID.              13607000
136080     DISPLAY 'HOLD SAIL DATE   '  PV-HOLD-ACTL-DPRTR-DTE-MOM.     13608000
136090     DISPLAY 'HOLD SAIL TIME   '  PV-HOLD-ACTL-DPRTR-TM-MOM.      13609000
136100     DISPLAY 'HOLD TRAN TYPE   '  PV-HOLD-TRN-TYP.                13610000
136110     MOVE +4013 TO ABEND-CODE.                                    13611000
136120     CALL 'ILBOABN0' USING ABEND-CODE.                            13612000
