/*  REXX    */                                                                  
CURRPGM = ' SEKRX004 - '                                                        
INP01_EOF = 'N'                                                                 
CALL READ_RACF_UNLOAD                                                           
DO WHILE (INP01_EOF = 'N')                                                      
    PARSE PULL RACF_RCD                                                         
    RECORD_TYPE = SUBSTR(RACF_RCD,1,4)                                          
    SELECT                                                                      
        WHEN (RECORD_TYPE = '0200') THEN CALL USER_DEFN                         
        OTHERWISE NOP                                                           
    END                                                                         
    CALL READ_RACF_UNLOAD                                                       
END                                                                             
"EXECIO 0 DISKR INP01 (FINIS"                                                   
"EXECIO 0 DISKR OUT01 (FINIS"                                                   
RETURN                                                                          
/*----------------------------------------------------------------*/            
USER_DEFN:                                                                      
    USER_ID = SUBSTR(RACF_RCD,6,8)                                              
    CREATED_DATE = SUBSTR(RACF_RCD,15,10)                                       
    REVOKED_IND = SUBSTR(RACF_RCD,50,3)                                         
    PROGRAMMER_NAME = SUBSTR(RACF_RCD,75,20)                                    
    LAST_USED_DATE = SUBSTR(RACF_RCD,114,10)                                    
    USER_INST_DATA = SUBSTR(RACF_RCD,125,255)                                   
    NAME_POSITION = POS('NAME(',USER_INST_DATA)                                 
    IF (NAME_POSITION > 0) THEN DO                                              
        NAME_POSITION = NAME_POSITION + 5                                       
        NAME_TEMP = SUBSTR(USER_INST_DATA,NAME_POSITION)                        
        END_POSITION = POS(')',NAME_TEMP)                                       
        IF (END_POSITION > 1) THEN DO                                           
            END_POSITION = END_POSITION - 1                                     
            USER_NAME = LEFT(SUBSTR(NAME_TEMP,1,END_POSITION),40)               
        END                                                                     
        ELSE                                                                    
            USER_NAME = LEFT('',40)                                             
    END                                                                         
    ELSE                                                                        
        USER_NAME = LEFT('',40)                                                 
    IF STRIP(USER_NAME) = '' THEN                                               
        USER_NAME = PROGRAMMER_NAME                                             
    CAT_POSITION = POS('CAT(',USER_INST_DATA)                                   
    IF (CAT_POSITION > 0) THEN DO                                               
        CAT_POSITION = CAT_POSITION + 4                                         
        CAT_TEMP = SUBSTR(USER_INST_DATA,CAT_POSITION)                          
        END_POSITION = POS(')',CAT_TEMP)                                        
        IF (END_POSITION > 1) THEN DO                                           
            END_POSITION = END_POSITION - 1                                     
            USER_CATEGORY = LEFT(SUBSTR(CAT_TEMP,1,END_POSITION),8)             
        END                                                                     
        ELSE                                                                    
            USER_CATEGORY = LEFT('',8)                                          
    END                                                                         
    ELSE                                                                        
        USER_CATEGORY = LEFT('',8)                                              
    EMPLID_POSITION = POS('EMPLID(',USER_INST_DATA)                             
    IF (EMPLID_POSITION > 0) THEN DO                                            
        EMPLID_POSITION = EMPLID_POSITION + 7                                   
        EMPLID_TEMP = SUBSTR(USER_INST_DATA,EMPLID_POSITION)                    
        END_POSITION = POS(')',EMPLID_TEMP)                                     
        IF (END_POSITION > 1) THEN DO                                           
            END_POSITION = END_POSITION - 1                                     
            USER_EMPLID = LEFT(SUBSTR(EMPLID_TEMP,1,END_POSITION),7)            
        END                                                                     
        ELSE                                                                    
            USER_EMPLID = LEFT('',7)                                            
    END                                                                         
    ELSE                                                                        
        USER_EMPLID = LEFT('',7)                                                
    USER_RCD = USER_ID || PROGRAMMER_NAME || USER_CATEGORY ||,                  
              REVOKED_IND || LAST_USED_DATE || CREATED_DATE                     
    IF ((USER_CATEGORY = 'KOHLSLRY') |,                                         
            (USER_CATEGORY = 'KOHLHRLY') |,                                     
            (USER_CATEGORY = 'AGENCY')) THEN                                    
    CALL WRITE_USER_FILE                                                        
RETURN                                                                          
/*----------------------------------------------------------------*/            
READ_RACF_UNLOAD:                                                               
    "EXECIO 1 DISKR INP01"              /* READ ONE RECORD        */            
    IF RC = 2 THEN                                                              
        INP01_EOF = 'Y'                                                         
    RETURN                                                                      
/*----------------------------------------------------------------*/            
WRITE_USER_FILE:                                                                
  OUT01_RECORD = LEFT(USER_RCD,59)                                              
  PUSH OUT01_RECORD                                                             
  "EXECIO 1 DISKW OUT01"                                                        
RETURN                                                                          
