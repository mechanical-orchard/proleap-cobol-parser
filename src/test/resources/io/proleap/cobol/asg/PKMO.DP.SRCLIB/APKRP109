000100 IDENTIFICATION DIVISION.                                         00010017
000200 PROGRAM-ID.     APKRP109.                                        00020017
000300 AUTHOR.         MARY KING.                                       00030017
000400 DATE-WRITTEN.   01/18/1996.                                      00040017
000500 DATE-COMPILED.                                                   00050017
000600*************************************************************     00060017
000700*    COBOL 2                                                *     00070017
000800*                                                           *     00080017
000900*    --- ADJUSTMENT JOURNAL INVENTORY CONTROL REPORT --     *     00090017
001000*                                                           *     00100017
001100*    THIS PROGRAM READS THE SORTED DAILY ONLINE ADJUSTMENT  *     00110017
001200*    JOURNAL FILE TO PRODUCE A DETAILED DAILY AJ REPORT     *     00120017
001300*    FOR USE IN PHYSICAL INVENTORY.                         *     00130017
001400*                                                           *     00140017
001500* INPUT:                                                    *     00150017
001600* 1.  SORTED ONLINE ADJUSTMENT JOURNAL  (COPYBOOK APRD040)  *     00160017
001700*                                                           *     00170017
001800* OUTPUT:                                                   *     00180017
001900* 1.  REPORT - ADJUSTMENT JOURNAL INVENTORY CONTROL REPORT  *     00190017
002000*                                                           *     00200017
002100*-----------------------------------------------------------*     00210017
002200*   CHANGE LOG:                                             *     00220017
002300*    12/07/99                                               *     00230017
002400*    CHANGED INPUT FILE FROM APTRAN FORMAT TO APRD040       *     00240017
002500*    FORMAT.  MODIFIED DETAIL LINES TO ACCEPT REPLACEMENT   *     00250017
002600*    FIELDS.                                                *     00260017
002700*    CHANGED BY: NANCY EILBES              WR#: 5998        *     00270017
002800*                                                           *     00280017
002900*    07/20/01                                               *     00290017
003000*    CHANGED THE INPUT FILE LRECL SIZE FROM 400 TO 500.     *     00300017
003100*    THE CHANGE WAS MADE BECAUSE COPYBOOK APRD040 HAS       *     00310017
003200*    EXPANDED TO 500.                                       *     00320017
003300*    CHANGED BY: ALEXIS KEIKER             WR#: 22467       *     00330017
003400*                                                           *     00340017
003500*    04/22/2004                                             *     00350018
003600*    INCREASED DL-STORE & ST-STORE LEN TO HOLD A 4 DIGIT    *     00360020
003700*    STORE NUMBER AS PART OF STORE CONSTRAINTS PROJECT.     *     00370018
003800*    CHANGED BY: MIKE BESKE                WR#: 25805       *     00380018
003900*                                                           *     00390018
003910*    09/26/2006                                             *     00391024
003920*    RECOMPILE FROM PRODUCTION TO PICK UP CHANGES TO THE    *     00392022
003930*    APRD040 COPYBOOK.                                      *     00393022
003940*    CHANGED BY: KRYSTEN LEARY             WR#: 31177       *     00394022
003950*                                                           *     00395021
003960*    03/22/2007                                             *     00396026
003970*    RECOMPILE FROM PRODUCTION TO PICK UP THE NEW FIELDS    *     00397025
003980*    AP040-WTHD-SETID, AP040-WTHD-SW, AND AP040-WTHD-CD     *     00398025
003981*    IN THE APRD040 COPYBOOK.                               *     00398125
003990*    CHANGED BY: KRYSTEN LEARY             WR#: 32060       *     00399025
003991*                                                           *     00399125
003992*    10/28/2014                                             *     00399227
003993*    CHANGE MADE: PO EXTENDED DIGIT CHANGES.                *     00399327
003994*    EXTENDED PO# FROM 7 TO 9                               *     00399427
003995*    CHANGED BY: COGNIZANT                 WR#: CHG0094517  *     00399627
003996*                                                           *     00399727
004000*************************************************************     00400017
004100   EJECT                                                          00410017
004200 ENVIRONMENT DIVISION.                                            00420017
004300 CONFIGURATION SECTION.                                           00430017
004400 SOURCE-COMPUTER.    IBM-3090.                                    00440017
004500 OBJECT-COMPUTER.    IBM-3090.                                    00450017
004600                                                                  00460017
004700 INPUT-OUTPUT SECTION.                                            00470017
004800 FILE-CONTROL.                                                    00480017
004900     SELECT ADJUSTMENT-FILE      ASSIGN TO UT-S-INP01.            00490017
005000     SELECT PRINT-FILE           ASSIGN TO UT-S-RPT01.            00500017
005100 EJECT                                                            00510017
005200 DATA DIVISION.                                                   00520017
005300 FILE SECTION.                                                    00530017
005400                                                                  00540017
005500 FD  ADJUSTMENT-FILE                                              00550017
005600     RECORDING MODE IS F                                          00560017
005700     LABEL RECORDS ARE STANDARD                                   00570017
005800     BLOCK CONTAINS 0 RECORDS                                     00580017
005900     DATA RECORD IS ADJUSTMENT-REC.                               00590017
006000 01  ADJUSTMENT-REC.                                              00600017
006100     05  FILLER                       PIC  X(500).                00610017
006200                                                                  00620017
006300 FD  PRINT-FILE                                                   00630017
006400     RECORDING MODE IS F                                          00640017
006500     LABEL RECORDS ARE STANDARD                                   00650017
006600     BLOCK CONTAINS 0 RECORDS                                     00660017
006700     DATA RECORD IS PRINT-REC.                                    00670017
006800 01  PRINT-REC                        PIC  X(132).                00680017
006900                                                                  00690017
007000 EJECT                                                            00700017
007100 WORKING-STORAGE SECTION.                                         00710017
007200                                                                  00720017
007300 01  PW-PROGRAM-WORKAREA.                                         00730017
007400     05  FILLER                  PIC  X(30)  VALUE                00740017
007500         '** BEGINING OF APKRP109 W/S **'.                        00750017
007600     05  PW-PROGRAM-NAME         PIC  X(08)  VALUE 'APKRP109'.    00760017
007700     05  PW-CURRENT-DATE.                                         00770017
007800         10  PW-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         00780017
007900         10  PW-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         00790017
008000         10  PW-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         00800017
008100     05  PW-CURRENT-TIME.                                         00810017
008200         10  PW-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         00820017
008300         10  PW-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         00830017
008400         10  FILLER              PIC  9(02)  VALUE ZEROS.         00840017
008500                                                                  00850017
008600                                                                  00860017
008700 01  PT-PROGRAM-TOTALS.                                           00870017
008800     05  PT-STORE-TOT-GROSS      PIC S9(10)V99 VALUE ZERO COMP-3. 00880017
008900     05  PT-STORE-TOT-NET        PIC S9(10)V99 VALUE ZERO COMP-3. 00890017
009000     05  PT-STORE-TOT-RETAIL     PIC S9(10)V99 VALUE ZERO COMP-3. 00900017
009100     05  PT-TRAN-TOT-GROSS       PIC S9(10)V99 VALUE ZERO COMP-3. 00910017
009200     05  PT-TRAN-TOT-NET         PIC S9(10)V99 VALUE ZERO COMP-3. 00920017
009300     05  PT-TRAN-TOT-RETAIL      PIC S9(10)V99 VALUE ZERO COMP-3. 00930017
009400     05  PT-GRAND-TOT-GROSS      PIC S9(10)V99 VALUE ZERO COMP-3. 00940017
009500     05  PT-GRAND-TOT-NET        PIC S9(10)V99 VALUE ZERO COMP-3. 00950017
009600     05  PT-GRAND-TOT-RETAIL     PIC S9(10)V99 VALUE ZERO COMP-3. 00960017
009700                                                                  00970017
009800                                                                  00980017
009900 01  SA-SAVED-AREA.                                               00990017
010000     05  SA-SAVED-TRANCDE        PIC  X(02)  VALUE SPACE.         01000017
010100     05  SA-SAVED-STORNO         PIC  9(05)  VALUE ZERO.          01010017
010200                                                                  01020017
010300 01  PC-PROGRAM-COUNTERS.                                         01030017
010400     05  PC-MAX-LINES            PIC S9(03)  VALUE +60            01040017
010500                                             COMP-3.              01050017
010600     05  PC-LINE-COUNT           PIC S9(03)  VALUE +99            01060017
010700                                             COMP-3.              01070017
010800     05  PC-PAGE-COUNT           PIC S9(05)  VALUE ZEROS          01080017
010900                                             COMP-3.              01090017
011000     05  PC-READ-COUNT           PIC S9(05)  VALUE ZERO           01100017
011100                                             COMP-3.              01110017
011200                                                                  01120017
011300 01  PS-PROGRAM-SWITCHES.                                         01130017
011400     05  PS-END-OF-AJ-SW         PIC  X(01)  VALUE 'N'.           01140017
011500         88  END-OF-AJ-TRANS                 VALUE 'Y'.           01150017
011600         88  MORE-AJ-TRANS                   VALUE 'N'.           01160017
011700 EJECT                                                            01170017
011800*----------------------------------------------------------------*01180017
011900*  ADJUSTMENT JOURNAL TRANSACTION RECORD LAYOUT                  *01190017
012000*----------------------------------------------------------------*01200017
012100     COPY APRD040.                                                01210017
012200 EJECT                                                            01220017
012300*----------------------------------------------------------------*01230017
012400*  STANDARD HEADER LAYOUT                                        *01240017
012500*----------------------------------------------------------------*01250017
012600     COPY DPWS132O.                                               01260017
012700                                                                  01270017
012800                                                                  01280017
012900 01  H2-HEADER-2.                                                 01290017
013000     05  FILLER                  PIC  X(42) VALUE SPACES.         01300017
013100     05  FILLER                  PIC  X(90) VALUE                 01310017
013200         'INVENTORY CONTROL REPORT OF DAILY AP ADJUSTMENTS'.      01320017
013300                                                                  01330017
013400                                                                  01340017
013500 01  DH-DETAIL-HEADER-1.                                          01350017
013600     05  FILLER          PIC X         VALUE ' '.                 01360017
013700     05  FILLER          PIC X(04)     VALUE 'TR  '.              01370017
013800     05  FILLER          PIC X(05)     VALUE 'STR  '.             01380017
013900     05  FILLER          PIC X(06)     VALUE 'DEPT'.              01390017
014000     05  FILLER          PIC X(10)     VALUE 'FIN LIAB'.          01400017
014100     05  FILLER          PIC X(10)     VALUE 'P.O.'.              01410028
014110     05  FILLER          PIC X(02)     VALUE SPACES.              01411030
014200     05  FILLER          PIC X(10)     VALUE 'VENDOR'.            01420017
014300     05  FILLER          PIC X(13)     VALUE 'DOCUMENT'.          01430017
014400     05  FILLER          PIC X(08)     VALUE 'ENTRY   '.          01440017
014500     05  FILLER          PIC X(08)     VALUE 'ENTRY   '.          01450017
014600     05  FILLER          PIC X(1)      VALUE SPACES.              01460029
014700     05  FILLER          PIC X(13)     VALUE 'TYPE'.              01470017
014800     05  FILLER          PIC X(19)     VALUE 'GROSS'.             01480017
014900     05  FILLER          PIC X(15)     VALUE 'NET'.               01490017
015000     05  FILLER          PIC X(16)     VALUE 'RETAIL'.            01500017
015100                                                                  01510017
015200 01  DH-DETAIL-HEADER-2.                                          01520017
015300     05  FILLER          PIC X         VALUE ' '.                 01530017
015400     05  FILLER          PIC X(04)     VALUE 'CD  '.              01540017
015500     05  FILLER          PIC X(05)     VALUE 'NBR  '.             01550017
015600     05  FILLER          PIC X(06)     VALUE 'NBR   '.            01560017
015700     05  FILLER          PIC X(10)     VALUE '  DATE    '.        01570017
015800     05  FILLER          PIC X(10)     VALUE 'NUMBER'.            01580028
015810     05  FILLER          PIC X(02)     VALUE SPACES.              01581030
015900     05  FILLER          PIC X(10)     VALUE 'NUMBER'.            01590017
016000     05  FILLER          PIC X(13)     VALUE ' NUMBER  '.         01600029
016100     05  FILLER          PIC X(08)     VALUE ' ID     '.          01610017
016200     05  FILLER          PIC X(08)     VALUE 'DATE    '.          01620017
016300     05  FILLER          PIC X(1)      VALUE SPACES.              01630029
016400     05  FILLER          PIC X(13)     VALUE 'CODE'.              01640017
016500     05  FILLER          PIC X(19)     VALUE 'COST'.              01650017
016600     05  FILLER          PIC X(15)     VALUE 'COST'.              01660017
016700     05  FILLER          PIC X(16)     VALUE 'AMOUNT'.            01670017
016800                                                                  01680017
016900                                                                  01690017
017000 01  DL-DETAIL-LINE.                                              01700017
017100     05  FILLER               PIC X        VALUE SPACES.          01710017
017200     05  DL-TRANCDE           PIC X(02)    VALUE SPACES.          01720017
017300     05  FILLER               PIC X(02)    VALUE SPACES.          01730017
017400     05  DL-STORE             PIC 9999     VALUE ZEROS.           01740017
017500     05  FILLER               PIC X(02)    VALUE SPACES.          01750017
017600     05  DL-DEPT              PIC 999      VALUE ZEROS.           01760017
017700     05  FILLER               PIC X(02)    VALUE SPACES.          01770017
017800     05  DL-FIN-LIAB-DATE.                                        01780017
017900         10  DL-FIN-LIAB-MO   PIC X(02)    VALUE SPACES.          01790017
018000         10  DL-DATE-SLASH1   PIC X(01)    VALUE '/'.             01800017
018100         10  DL-FIN-LIAB-DA   PIC X(02)    VALUE SPACES.          01810017
018200         10  DL-DATE-SLASH2   PIC X(01)    VALUE '/'.             01820017
018300         10  DL-FIN-LIAB-YR   PIC X(02)    VALUE SPACES.          01830017
018400     05  FILLER               PIC X(02)    VALUE SPACES.          01840017
018500     05  DL-PO-NBR            PIC ZZZZZZZZ9 VALUE ZEROS.          01850033
018600     05  FILLER               PIC X(02)    VALUE SPACES.          01860017
018700     05  DL-VND-NBR           PIC X(09)    VALUE SPACES.          01870017
018800     05  FILLER               PIC X(02)    VALUE SPACES.          01880017
018900     05  DL-DOC-NBR           PIC X(10)    VALUE SPACES.          01890017
019000     05  FILLER               PIC X(02)    VALUE SPACES.          01900017
019100     05  DL-ENTR-ID           PIC X(08)    VALUE SPACES.          01910017
019200     05  FILLER               PIC X(01)    VALUE SPACES.          01920017
019300     05  DL-DTENTRY           PIC X(06)    VALUE SPACES.          01930017
019400     05  FILLER               PIC X(04)    VALUE SPACES.          01940028
019500     05  DL-INVTYP            PIC X(02)    VALUE SPACES.          01950017
019600     05  FILLER               PIC X(02)    VALUE SPACES.          01960017
019700     05  DL-GROSS-COST        PIC ZZZ,ZZZ,ZZZ.ZZ-                 01970017
019800                                           VALUE ZEROS.           01980017
019900     05  FILLER               PIC X(02)    VALUE SPACES.          01990017
020000     05  DL-NET-COST          PIC ZZZ,ZZZ,ZZZ.ZZ-                 02000017
020100                                           VALUE ZEROS.           02010017
020200     05  FILLER               PIC X(02)    VALUE SPACES.          02020017
020300     05  DL-RETAIL-AMT        PIC ZZZ,ZZZ,ZZZ.ZZ-                 02030017
020400                                           VALUE ZEROS.           02040017
020500     05  FILLER               PIC X(05)    VALUE SPACES.          02050017
020600                                                                  02060017
020700                                                                  02070017
020800 01  ST-STORE-TOTAL-LINE.                                         02080017
020900     05  FILLER               PIC X(01)    VALUE SPACES.          02090017
021000     05  FILLER               PIC X(10)    VALUE SPACES.          02100017
021100     05  FILLER               PIC X(28)    VALUE                  02110017
021200     'TOTALS FOR STORE NUMBER     '.                              02120017
021300     05  ST-STORE             PIC 9(04)    VALUE ZERO.            02130018
021400     05  FILLER               PIC X(39)    VALUE SPACES.          02140018
021500     05  ST-GROSS-COST        PIC ZZZZ,ZZZ,ZZZ.99-                02150017
021600                                           VALUE ZEROS.           02160017
021700     05  FILLER               PIC X(01)    VALUE SPACES.          02170017
021800     05  ST-NET-COST          PIC ZZZZ,ZZZ,ZZZ.99-                02180017
021900                                           VALUE ZEROS.           02190017
022000     05  FILLER               PIC X(01)    VALUE SPACES.          02200017
022100     05  ST-RETAIL-AMT        PIC ZZZZ,ZZZ,ZZZ.99-                02210017
022200                                           VALUE ZEROS.           02220017
022300     05  FILLER               PIC X(09)    VALUE SPACES.          02230017
022400                                                                  02240017
022500                                                                  02250017
022600 01  TT-TRANCDE-TOTAL-LINE.                                       02260017
022700     05  FILLER               PIC X(01)    VALUE SPACES.          02270017
022800     05  FILLER               PIC X(10)    VALUE SPACES.          02280017
022900     05  FILLER               PIC X(28)    VALUE                  02290017
023000     'TOTALS FOR TRANSACTION CODE '.                              02300017
023100     05  TT-TRANCDE           PIC X(02)    VALUE SPACES.          02310017
023200     05  FILLER               PIC X(41)    VALUE SPACES.          02320017
023300     05  TT-GROSS-COST        PIC ZZZZ,ZZZ,ZZZ.99-                02330017
023400                                           VALUE ZEROS.           02340017
023500     05  FILLER               PIC X(01)    VALUE SPACES.          02350017
023600     05  TT-NET-COST          PIC ZZZZ,ZZZ,ZZZ.99-                02360017
023700                                           VALUE ZEROS.           02370017
023800     05  FILLER               PIC X(01)    VALUE SPACES.          02380017
023900     05  TT-RETAIL-AMT        PIC ZZZZ,ZZZ,ZZZ.99-                02390017
024000                                           VALUE ZEROS.           02400017
024100     05  FILLER               PIC X(09)    VALUE SPACES.          02410017
024200                                                                  02420017
024300                                                                  02430017
024400 01  GT-GRAND-TOTAL-LINE.                                         02440017
024500     05  FILLER               PIC X(01)    VALUE SPACES.          02450017
024600     05  FILLER               PIC X(10)    VALUE SPACES.          02460017
024700     05  FILLER               PIC X(71)    VALUE                  02470017
024800     'GRAND TOTALS'.                                              02480017
024900     05  GT-GROSS-COST        PIC ZZZZ,ZZZ,ZZZ.99-                02490017
025000                                           VALUE ZEROS.           02500017
025100     05  FILLER               PIC X(01)    VALUE SPACES.          02510017
025200     05  GT-NET-COST          PIC ZZZZ,ZZZ,ZZZ.99-                02520017
025300                                           VALUE ZEROS.           02530017
025400     05  FILLER               PIC X(01)    VALUE SPACES.          02540017
025500     05  GT-RETAIL-AMT        PIC ZZZZ,ZZZ,ZZZ.99-                02550017
025600                                           VALUE ZEROS.           02560017
025700     05  FILLER               PIC X(09)    VALUE SPACES.          02570017
025800 EJECT                                                            02580017
025900 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          02590017
026000                                             COMP SYNC.           02600017
026100     88  AC-BAD-DATA                         VALUE +4008.         02610017
026200     88  AC-DATE-ERROR                       VALUE +4019.         02620017
026300                                                                  02630017
026400                                                                  02640017
026500 01  ABEND-AREAS.                                                 02650017
026600     05  AA-ABEND-LIT            PIC  X(40)  VALUE                02660017
026700             '*****       ABEND'.                                 02670017
026800     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                02680017
026900             '*****   PROGRAM: APKRP109'.                         02690017
027000     05  AA-PARAGRAPH-LIT.                                        02700017
027100         10  FILLER              PIC  X(17)  VALUE                02710017
027200             '***** PARAGRAPH: '.                                 02720017
027300         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        02730017
027400     05  AA-MESSAGE-LINE.                                         02740017
027500         10  FILLER              PIC  X(06)  VALUE '*****'.       02750017
027600         10  AA-MESSAGE.                                          02760017
027700             15  AA-MSG-1        PIC  X(22)  VALUE SPACES.        02770017
027800             15  AA-MSG-2        PIC  X(03)  VALUE SPACES.        02780017
027900             15  AA-MSG-3        PIC  X(102) VALUE SPACES.        02790017
028000                                                                  02800017
028100                                                                  02810017
028200 01  FILLER                      PIC  X(25)  VALUE                02820017
028300     '** END OF APKRP109 W/S **'.                                 02830017
028400 EJECT                                                            02840017
028500 PROCEDURE DIVISION.                                              02850017
028600 A100-MAIN.                                                       02860017
028700                                                                  02870017
028800     PERFORM B100-INITIALIZE.                                     02880017
028900                                                                  02890017
029000     IF END-OF-AJ-TRANS                                           02900017
029100         PERFORM B400-EMPTY-FILE-END                              02910017
029200     ELSE                                                         02920017
029300         PERFORM B200-REPORT-ON-AJ-TRANS                          02930017
029400             UNTIL END-OF-AJ-TRANS                                02940017
029500         PERFORM B300-END-PROGRAM                                 02950017
029600     END-IF.                                                      02960017
029700                                                                  02970017
029800     GOBACK.                                                      02980017
029900 EJECT                                                            02990017
030000*----------------------------------------------------------------*03000017
030100*    OPENS FILES, GETS DATE AND TIME, READS FIRST RECORD         *03010017
030200*----------------------------------------------------------------*03020017
030300 B100-INITIALIZE.                                                 03030017
030400                                                                  03040017
030500     OPEN INPUT ADJUSTMENT-FILE                                   03050017
030600          OUTPUT PRINT-FILE.                                      03060017
030700                                                                  03070017
030800     ACCEPT PW-CURRENT-DATE FROM DATE.                            03080017
030900     MOVE PW-CURRENT-MONTH            TO DP132O-RUN-MONTH.        03090017
031000     MOVE PW-CURRENT-DAY              TO DP132O-RUN-DAY.          03100017
031100     MOVE PW-CURRENT-YEAR             TO DP132O-RUN-YEAR.         03110017
031200                                                                  03120017
031300     ACCEPT PW-CURRENT-TIME FROM TIME.                            03130017
031400     MOVE PW-CURRENT-HOUR             TO DP132O-RUN-HOUR.         03140017
031500     MOVE PW-CURRENT-MINUTE           TO DP132O-RUN-MINUTE.       03150017
031600     MOVE PW-PROGRAM-NAME             TO DP132O-PROGRAM-NAME.     03160017
031700                                                                  03170017
031800     INITIALIZE AP040-TRANSACTION-FILE.                           03180017
031900                                                                  03190017
032000     PERFORM R100-READ-ADJUSTMENT-FILE.                           03200017
032100                                                                  03210017
032200     IF MORE-AJ-TRANS                                             03220017
032300         MOVE AP040-AP-TRN-CDE TO SA-SAVED-TRANCDE                03230017
032400         MOVE AP040-STR-NBR    TO SA-SAVED-STORNO                 03240017
032500     END-IF.                                                      03250017
032600                                                                  03260017
032700 EJECT                                                            03270017
032800*----------------------------------------------------------------*03280017
032900*    CONTROLS REPORTING OF ADJUSTMENT JOURNAL FILE.              *03290017
033000*----------------------------------------------------------------*03300017
033100 B200-REPORT-ON-AJ-TRANS.                                         03310017
033200                                                                  03320017
033300     IF AP040-AP-TRN-CDE NOT = SA-SAVED-TRANCDE                   03330017
033400         PERFORM C200-TRANCDE-BREAK                               03340017
033500     ELSE                                                         03350017
033600     IF AP040-STR-NBR NOT = SA-SAVED-STORNO                       03360017
033700         PERFORM C300-STORNO-BREAK                                03370017
033800     END-IF.                                                      03380017
033900                                                                  03390017
034000     PERFORM C100-PREPARE-RPT.                                    03400017
034100                                                                  03410017
034200     PERFORM R100-READ-ADJUSTMENT-FILE.                           03420017
034300 EJECT                                                            03430017
034400*----------------------------------------------------------------*03440017
034500*   PRINTS LAST LINES OF REPORTS, CLOSES FILES, DISPLAYS COUNT   *03450017
034600*----------------------------------------------------------------*03460017
034700 B300-END-PROGRAM.                                                03470017
034800                                                                  03480017
034900     PERFORM C200-TRANCDE-BREAK.                                  03490017
035000                                                                  03500017
035100     MOVE PT-GRAND-TOT-GROSS  TO GT-GROSS-COST.                   03510017
035200     MOVE PT-GRAND-TOT-NET    TO GT-NET-COST.                     03520017
035300     MOVE PT-GRAND-TOT-RETAIL TO GT-RETAIL-AMT.                   03530017
035400                                                                  03540017
035500     PERFORM W400-PRINT-GRAND-TOTAL.                              03550017
035600                                                                  03560017
035700     DISPLAY 'RECORDS READ = ' PC-READ-COUNT.                     03570017
035800                                                                  03580017
035900     CLOSE ADJUSTMENT-FILE                                        03590017
036000           PRINT-FILE.                                            03600017
036100 EJECT                                                            03610017
036200*----------------------------------------------------------------*03620017
036300*    PRINTS END OF REPORT MESSAGES, CLOSES FILES                 *03630017
036400*----------------------------------------------------------------*03640017
036500 B400-EMPTY-FILE-END.                                             03650017
036600                                                                  03660017
036700     PERFORM W500-PRINT-HEADER.                                   03670017
036800     MOVE '         ** NO TRANSACTIONS ENTERED **' TO PRINT-REC.  03680017
036900     WRITE PRINT-REC AFTER 2.                                     03690017
037000                                                                  03700017
037100     CLOSE ADJUSTMENT-FILE                                        03710017
037200           PRINT-FILE.                                            03720017
037300 EJECT                                                            03730017
037400*----------------------------------------------------------------*03740017
037500*    POPULATES REPORT FIELDS USING DATA FROM INPUT FILE          *03750017
037600*----------------------------------------------------------------*03760017
037700 C100-PREPARE-RPT.                                                03770017
037800                                                                  03780017
037900     MOVE AP040-AP-TRN-CDE       TO DL-TRANCDE.                   03790017
038000     MOVE AP040-STR-NBR          TO DL-STORE.                     03800017
038100     MOVE AP040-DEPT-NBR         TO DL-DEPT.                      03810017
038200                                                                  03820017
038300     MOVE AP040-INV-CUTOFF-MM    TO DL-FIN-LIAB-MO.               03830017
038400     MOVE '/'                    TO DL-DATE-SLASH1.               03840017
038500     MOVE AP040-INV-CUTOFF-DD    TO DL-FIN-LIAB-DA.               03850017
038600     MOVE '/'                    TO DL-DATE-SLASH2.               03860017
038700     MOVE AP040-INV-CUTOFF-YY    TO DL-FIN-LIAB-YR.               03870017
038800                                                                  03880017
038900     MOVE AP040-PO-NBR           TO DL-PO-NBR.                    03890017
039000     MOVE AP040-VND-NBR          TO DL-VND-NBR.                   03900017
039100     MOVE AP040-DOC-NBR          TO DL-DOC-NBR.                   03910017
039200     MOVE AP040-ENTR-ID          TO DL-ENTR-ID.                   03920017
039300     MOVE AP040-ENTR-DTE (6:2)   TO DL-DTENTRY (1:2).             03930017
039400     MOVE AP040-ENTR-DTE (9:2)   TO DL-DTENTRY (3:2).             03940017
039500     MOVE AP040-ENTR-DTE (3:2)   TO DL-DTENTRY (5:2).             03950017
039600     MOVE AP040-PSTG-TYP-CDE     TO DL-INVTYP.                    03960017
039700                                                                  03970017
039800     MOVE AP040-GRO-COST-AMT     TO DL-GROSS-COST.                03980017
039900     MOVE AP040-RETL-AMT         TO DL-RETAIL-AMT.                03990017
040000     MOVE AP040-NET-COST-AMT     TO DL-NET-COST.                  04000017
040100                                                                  04010017
040200     PERFORM W100-PRINT-AJ-DETAIL.                                04020017
040300                                                                  04030017
040400     ADD AP040-GRO-COST-AMT      TO PT-STORE-TOT-GROSS.           04040017
040500     ADD AP040-NET-COST-AMT      TO PT-STORE-TOT-NET.             04050017
040600     ADD AP040-RETL-AMT          TO PT-STORE-TOT-RETAIL.          04060017
040700 EJECT                                                            04070017
040800*----------------------------------------------------------------*04080017
040900*    TRANCDE BREAK CAUSES A STORE CODE BREAK TO OCCUR, PRINTS    *04090017
041000*    TOTALS FOR THE TRAN CODE, AND ACCUMULATES GRAND TOTALS.     *04100017
041100*----------------------------------------------------------------*04110017
041200 C200-TRANCDE-BREAK.                                              04120017
041300                                                                  04130017
041400     PERFORM C300-STORNO-BREAK.                                   04140017
041500                                                                  04150017
041600     MOVE SA-SAVED-TRANCDE    TO TT-TRANCDE.                      04160017
041700     MOVE PT-TRAN-TOT-GROSS   TO TT-GROSS-COST.                   04170017
041800     MOVE PT-TRAN-TOT-NET     TO TT-NET-COST.                     04180017
041900     MOVE PT-TRAN-TOT-RETAIL  TO TT-RETAIL-AMT.                   04190017
042000                                                                  04200017
042100     PERFORM W300-PRINT-TRAN-TOTAL.                               04210017
042200                                                                  04220017
042300     MOVE +99                 TO PC-LINE-COUNT.                   04230017
042400                                                                  04240017
042500     ADD PT-TRAN-TOT-GROSS    TO PT-GRAND-TOT-GROSS.              04250017
042600     ADD PT-TRAN-TOT-NET      TO PT-GRAND-TOT-NET.                04260017
042700     ADD PT-TRAN-TOT-RETAIL   TO PT-GRAND-TOT-RETAIL.             04270017
042800                                                                  04280017
042900     MOVE ZEROS               TO PT-TRAN-TOT-GROSS                04290017
043000                                 PT-TRAN-TOT-NET                  04300017
043100                                 PT-TRAN-TOT-RETAIL.              04310017
043200                                                                  04320017
043300     IF MORE-AJ-TRANS                                             04330017
043400         MOVE AP040-AP-TRN-CDE TO SA-SAVED-TRANCDE                04340017
043500     END-IF.                                                      04350017
043600                                                                  04360017
043700                                                                  04370017
043800*----------------------------------------------------------------*04380017
043900*    STORE NBR BREAK PRINTS TOTALS FOR THE STORE AND ACCUMULATES *04390017
044000*    TRAN CODE TOTALS.                                           *04400017
044100*----------------------------------------------------------------*04410017
044200 C300-STORNO-BREAK.                                               04420017
044300                                                                  04430017
044400     MOVE SA-SAVED-STORNO     TO ST-STORE.                        04440017
044500     MOVE PT-STORE-TOT-GROSS  TO ST-GROSS-COST.                   04450017
044600     MOVE PT-STORE-TOT-NET    TO ST-NET-COST.                     04460017
044700     MOVE PT-STORE-TOT-RETAIL TO ST-RETAIL-AMT.                   04470017
044800                                                                  04480017
044900     PERFORM W200-PRINT-STORE-TOTAL.                              04490017
045000                                                                  04500017
045100     ADD PT-STORE-TOT-GROSS   TO PT-TRAN-TOT-GROSS.               04510017
045200     ADD PT-STORE-TOT-NET     TO PT-TRAN-TOT-NET.                 04520017
045300     ADD PT-STORE-TOT-RETAIL  TO PT-TRAN-TOT-RETAIL.              04530017
045400                                                                  04540017
045500     MOVE ZEROS               TO PT-STORE-TOT-GROSS               04550017
045600                                 PT-STORE-TOT-NET                 04560017
045700                                 PT-STORE-TOT-RETAIL.             04570017
045800     IF MORE-AJ-TRANS                                             04580017
045900         MOVE AP040-STR-NBR TO SA-SAVED-STORNO                    04590017
046000     END-IF.                                                      04600017
046100 EJECT                                                            04610017
046200*----------------------------------------------------------------*04620017
046300*    READS INPUT FILE.                                           *04630017
046400*----------------------------------------------------------------*04640017
046500 R100-READ-ADJUSTMENT-FILE.                                       04650017
046600                                                                  04660017
046700     READ ADJUSTMENT-FILE INTO AP040-TRANSACTION-FILE             04670017
046800        AT END SET END-OF-AJ-TRANS TO TRUE.                       04680017
046900                                                                  04690017
047000     IF MORE-AJ-TRANS                                             04700017
047100         ADD 1  TO PC-READ-COUNT                                  04710017
047200     END-IF.                                                      04720017
047300 EJECT                                                            04730017
047400*----------------------------------------------------------------*04740017
047500*    PRINTS THE ADJUSTMENT JOURNAL DETAIL                        *04750017
047600*----------------------------------------------------------------*04760017
047700 W100-PRINT-AJ-DETAIL.                                            04770017
047800                                                                  04780017
047900     IF PC-LINE-COUNT > PC-MAX-LINES                              04790017
048000         PERFORM W500-PRINT-HEADER                                04800017
048100     END-IF.                                                      04810017
048200                                                                  04820017
048300     WRITE PRINT-REC FROM DL-DETAIL-LINE AFTER 1.                 04830017
048400     ADD 1  TO PC-LINE-COUNT.                                     04840017
048500                                                                  04850017
048600     INITIALIZE DL-DETAIL-LINE.                                   04860017
048700                                                                  04870017
048800                                                                  04880017
048900*----------------------------------------------------------------*04890017
049000*    PRINTS THE ADJUSTMENT JOURNAL STORE TOTAL LINE              *04900017
049100*----------------------------------------------------------------*04910017
049200 W200-PRINT-STORE-TOTAL.                                          04920017
049300                                                                  04930017
049400     IF PC-LINE-COUNT > PC-MAX-LINES                              04940017
049500         PERFORM W500-PRINT-HEADER                                04950017
049600     END-IF.                                                      04960017
049700                                                                  04970017
049800     WRITE PRINT-REC FROM ST-STORE-TOTAL-LINE   AFTER 2.          04980017
049900     INITIALIZE ST-STORE-TOTAL-LINE                               04990017
050000                PRINT-REC.                                        05000017
050100     WRITE PRINT-REC.                                             05010017
050200                                                                  05020017
050300     ADD 3  TO PC-LINE-COUNT.                                     05030017
050400                                                                  05040017
050500                                                                  05050017
050600*----------------------------------------------------------------*05060017
050700*    PRINTS THE ADJUSTMENT JOURNAL TRAN CODE TOTAL LINE          *05070017
050800*----------------------------------------------------------------*05080017
050900 W300-PRINT-TRAN-TOTAL.                                           05090017
051000                                                                  05100017
051100     IF PC-LINE-COUNT > PC-MAX-LINES                              05110017
051200         PERFORM W500-PRINT-HEADER                                05120017
051300     END-IF.                                                      05130017
051400                                                                  05140017
051500     WRITE PRINT-REC FROM TT-TRANCDE-TOTAL-LINE AFTER 2.          05150017
051600     INITIALIZE TT-TRANCDE-TOTAL-LINE                             05160017
051700                PRINT-REC.                                        05170017
051800     WRITE PRINT-REC.                                             05180017
051900                                                                  05190017
052000     ADD 3  TO PC-LINE-COUNT.                                     05200017
052100                                                                  05210017
052200                                                                  05220017
052300                                                                  05230017
052400*----------------------------------------------------------------*05240017
052500*    PRINTS THE ADJUSTMENT JOURNAL GRAND TOTAL                   *05250017
052600*----------------------------------------------------------------*05260017
052700 W400-PRINT-GRAND-TOTAL.                                          05270017
052800                                                                  05280017
052900     IF PC-LINE-COUNT > PC-MAX-LINES                              05290017
053000         PERFORM W500-PRINT-HEADER                                05300017
053100     END-IF.                                                      05310017
053200                                                                  05320017
053300     WRITE PRINT-REC FROM GT-GRAND-TOTAL-LINE   AFTER 2.          05330017
053400                                                                  05340017
053500                                                                  05350017
053600*----------------------------------------------------------------*05360017
053700*    PRINTS HEADERS.                                             *05370017
053800*----------------------------------------------------------------*05380017
053900 W500-PRINT-HEADER.                                               05390017
054000                                                                  05400017
054100     ADD 1                            TO PC-PAGE-COUNT.           05410017
054200                                                                  05420017
054300     MOVE PC-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      05430017
054400     MOVE 1                           TO DP132O-REPORT-NUMBER.    05440017
054500                                                                  05450017
054600     WRITE PRINT-REC FROM DP132O-STANDRD-HEADER-132-COLS          05460017
054700                                             AFTER PAGE.          05470017
054800     WRITE PRINT-REC FROM H2-HEADER-2        AFTER 1.             05480017
054900     WRITE PRINT-REC FROM DH-DETAIL-HEADER-1 AFTER 2.             05490017
055000     WRITE PRINT-REC FROM DH-DETAIL-HEADER-2 AFTER 1.             05500017
055100                                                                  05510017
055200     INITIALIZE PRINT-REC.                                        05520017
055300     WRITE PRINT-REC                         AFTER 1.             05530017
055400                                                                  05540017
055500     MOVE 6                           TO PC-LINE-COUNT.           05550017
055600                                                                  05560017
055700 EJECT                                                            05570017
055800*----------------------------------------------------------------*05580017
055900*    ABEND ROUTINE                                               *05590017
056000*----------------------------------------------------------------*05600017
056100 Z999-ABEND.                                                      05610017
056200                                                                  05620017
056300     DISPLAY AA-ABEND-LIT.                                        05630017
056400     DISPLAY AA-PROGRAM-LIT.                                      05640017
056500     DISPLAY AA-PARAGRAPH-LIT.                                    05650017
056600     DISPLAY AA-MESSAGE-LINE.                                     05660017
056700     CALL 'ILBOABN0' USING ABEND-CODE.                            05670017
