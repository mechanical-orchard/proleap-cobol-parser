000100 TITLE 'CORPORATE SUMMARY QC SPOT CHECK STATISTICS REPORT'.       00010004
******* CHECKED OUT BY DAVID WELLER (TKMA602) ON 12/3/2013              00020004
000200 IDENTIFICATION DIVISION.                                         00030004
000300                                                                  00040004
000400 PROGRAM-ID.             SUKRP035.                                00050004
000500 AUTHOR.                 LARRY SCHLEICHER.                        00060004
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070004
000700 DATE-WRITTEN            APRIL, 2002.                             00080004
000800 DATE-COMPILED.                                                   00090004
000900*                                                                 00100004
001000 ENVIRONMENT DIVISION.                                            00110004
001100                                                                  00120004
001200 CONFIGURATION SECTION.                                           00130004
001300                                                                  00140004
001400 SOURCE-COMPUTER.        IBM-3090.                                00150004
001500 OBJECT-COMPUTER.        IBM-3090.                                00160004
001600                                                                  00170004
001700 INPUT-OUTPUT SECTION.                                            00180004
001800                                                                  00190004
001900 FILE-CONTROL.                                                    00200004
002000                                                                  00210004
002100     SELECT TOTAL-FILE                                            00220004
002200         ASSIGN TO INP01.                                         00230004
002300                                                                  00240004
002400     SELECT REPORT-FILE                                           00250004
002500         ASSIGN TO RPT01.                                         00260004
002600                                                                  00270004
002700 DATA DIVISION.                                                   00280004
002800                                                                  00290004
002900 FILE SECTION.                                                    00300004
003000*                                                                 00310004
003100 FD  TOTAL-FILE                                                   00320004
003200     RECORDING MODE IS F                                          00330004
003300     LABEL RECORDS ARE STANDARD                                   00340004
003400     BLOCK CONTAINS 0 RECORDS.                                    00350004
003500 01  TOTAL-RECORD                    PIC X(150).                  00360004
003600*                                                                 00370004
003700 FD  REPORT-FILE                                                  00380004
003800     RECORDING MODE IS F                                          00390004
003900     LABEL RECORDS ARE STANDARD                                   00400004
004000     BLOCK CONTAINS 0 RECORDS.                                    00410004
CH8347 01  REPORT-RECORD                   PIC X(150).                  00420011
004200                                                                  00430004
004300 WORKING-STORAGE SECTION.                                         00440004
004400 01  PROGRAM-SWITCHES.                                            00450004
004500                                                                  00460004
004600*    THESE SWITCHES SIGNAL WHEN END-OF-FILE IS REACHED            00470004
004700     05  PS-EOF-EXTRACT-SW            PIC X(01) VALUE 'N'.        00480004
004800         88  PS-EOF-EXTRACT                     VALUE 'Y'.        00490004
004900     05  PS-NO-DATA-SW                PIC X(01) VALUE 'Y'.        00500004
005000         88  PS-NO-DATA                         VALUE 'N'.        00510004
005100                                                                  00520004
005200*    CONTROLS PRINTING OF SUBHEADER RATHER THAN DETAIL LINE       00530004
005300     05  PS-SUBHEADER-SW              PIC X(01) VALUE 'N'.        00540004
005400         88  PS-PRINT-SUBHEADER                 VALUE 'Y'.        00550004
005500         88  PS-DONT-PRINT-SUBHEADER            VALUE 'N'.        00560004
005600*    CONTROLS PRINTING OF 'DC TOTAL:'                             00570004
005700     05  PS-SUBTOTAL-SW               PIC X(01) VALUE 'N'.        00580004
005800         88  PS-PRINT-CORP-TOTAL                VALUE 'Y'.        00590004
005900         88  PS-DONT-PRINT-CORP-TOTAL           VALUE 'N'.        00600004
006000                                                                  00610004
006100/                                                                 00620004
006200 01  PV-CURR-KEY.                                                 00630004
006300     05  PV-PKGNG-TYPE-CURR           PIC X(02) VALUE SPACES.     00640004
006400     05  PV-VENDOR-RANK-CURR          PIC X(06) VALUE SPACES.     00650004
006500 01  PV-PREV-KEY.                                                 00660004
006600     05  PV-PKGNG-TYPE-PREV           PIC X(02) VALUE SPACES.     00670004
006700     05  PV-VENDOR-RANK-PREV          PIC X(06) VALUE SPACES.     00680004
006800 01  PV-PREV-KEY-A.                                               00690004
006900     05  PV-PKGNG-TYPE-A              PIC X(02) VALUE SPACES.     00700004
007000     05  PV-VENDOR-RANK-A             PIC X(06) VALUE SPACES.     00710004
007100/                                                                 00720004
007200 01  PV-PROGRAM-VARIABLES.                                        00730004
007300     05  PV-PAGE-COUNT               PIC S9(04)   VALUE ZERO      00740004
007400                                                  COMP-3.         00750004
007500     05  PV-LINE-COUNT               PIC S9(03)   VALUE ZERO      00760004
007600                                                  COMP-3.         00770004
007700                                                                  00780004
007800     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00790004
007900     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00800004
008000     05  PV-ERROR-MESSAGE-1          PIC X(50) VALUE SPACE.       00810004
008100     05  PV-ERROR-MESSAGE-2          PIC X(50) VALUE SPACE.       00820004
008200                                                                  00830004
008300     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00840004
008400                                                   COMP SYNC.     00850004
008500     05  PV-ABEND-PARA-NAME          PIC X(30)     VALUE SPACES.  00860004
008600     05  PV-DB2-OPERATION-MSG-1      PIC X(40)     VALUE SPACES.  00870004
008700     05  PV-DB2-OPERATION-MSG-2      PIC X(40)     VALUE SPACES.  00880004
008800     05  PV-DB2-TABLE-NAME           PIC X(12)     VALUE SPACES.  00890004
008900     05  PV-PERCENT                   PIC S9(4)V9(3) COMP-3       00900004
009000                                                     VALUE ZERO.  00910004
009100     05  PV-AUD-CRTN-QTY-COMPLT       PIC S9(9) COMP VALUE ZERO.  00920004
009200     05  PV-AUD-UNIT-QTY-COMPLT       PIC S9(9) COMP VALUE ZERO.  00930004
009300     05  PV-UNITS-PER-HOUR            PIC S9(6)V99                00940004
009400                                                COMP VALUE ZERO.  00950004
009500     05  PV-SAVE-VENDOR-RANK          PIC X(6) VALUE SPACES.      00960004
009600     05  PV-SAVE-PKGNG-TYPE           PIC X(2) VALUE SPACES.      00970004
009700                                                                  00980004
009800     05  PV-TOTAL-COMPLT-AUDITS       PIC S9(06) VALUE ZEROES.    00990004
009900     05  PV-GRAND-TOT-COMPLT-AUDIT    PIC S9(9) COMP-3.           01000004
010000                                                                  01010004
010100     05  PV-DISP-OPER                 PIC  9(04) VALUE ZEROES.    01020004
010200     05  PV-DISP-COMPLETE             PIC  9(06) VALUE ZEROES.    01030004
010300     05  PV-DISP-NUMERIC-1            PIC  9(09) VALUE ZEROES.    01040004
010400     05  PV-DISP-NUMERIC-2            PIC  9(09) VALUE ZEROES.    01050004
010500     05  PV-DISP-NUMERIC-3            PIC  9(09) VALUE ZEROES.    01060004
010600                                                                  01070004
010700 01  PC-CONSTANTS.                                                01080004
010800     05  PC-MAX-RETRIES          PIC S9(4)     COMP SYNC VALUE +2.01090004
010900                                                                  01100004
011000     05  PC-END-OF-PAGE              PIC S9(3) COMP-3 VALUE +60.  01110004
011100     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     01120004
011200     05  PC-SPACE                    PIC  X(01)    VALUE ' '.     01130004
011300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01140004
011400         'SUKRP035'.                                              01150004
011500     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01160004
011600                                                                  01170004
011700                                                                  01180004
011800     05 ABEND-CODE                    PIC S9(04) VALUE ZERO       01190004
011900                                                 COMP SYNC.       01200004
012000     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     01210004
012100                                                                  01220004
012200                                                                  01230004
012300     05  PV-TODAYS-DATE.                                          01240004
012400         10  PV-TODAYS-DATE-CCYY     PIC  9(04)    VALUE ZEROS.   01250004
012500         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   01260004
012600         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   01270004
012700     05  PV-TODAYS-TIME.                                          01280004
012800         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   01290004
012900         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   01300004
013000         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   01310004
013100         10  FILLER                  PIC  9(02)    VALUE ZEROS.   01320004
013200     05  PV-FORMAT-DATE.                                          01330004
013300         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01340004
013400         10  FILLER                  PIC  X(01)    VALUE '/'.     01350004
013500         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01360004
013600         10  FILLER                  PIC  X(01)    VALUE '/'.     01370004
013700         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01380004
013800                                                                  01390004
013900*                                                                 01400004
014000*                                                                 01410004
014100 01  WS-BATCH-PROC-DATE.                                          01420004
014200     05  WS-BATCH-PROC-CC            PIC X(02)     VALUE SPACE.   01430004
014300     05  WS-BATCH-PROC-YY            PIC X(02)     VALUE SPACE.   01440004
014400     05  FILLER                      PIC X(01)     VALUE SPACE.   01450004
014500     05  WS-BATCH-PROC-MM            PIC X(02)     VALUE SPACE.   01460004
014600     05  FILLER                      PIC X(01)     VALUE SPACE.   01470004
014700     05  WS-BATCH-PROC-DD            PIC X(02)     VALUE SPACE.   01480004
014800                                                                  01490004
014900 01 WS-CALC-FIELDS.                                               01500004
015000    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         01510004
015100                                                   VALUE ZEROS.   01520004
015200    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         01530004
015300                                                   VALUE ZEROS.   01540004
015400 01  PV-ABEND-FIELDS.                                             01550004
015500     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'SUKRP035'.01560004
015600     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01570004
015700     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01580004
015800     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01590004
015900     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01600004
016000     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01610004
016100     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    01620004
016200     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01630004
016300     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01640004
016400     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01650004
016500     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01660004
016600                                                                  01670004
016700/                                                                 01680004
016800*    DATE CONTROL CARD                                            01690004
016900     COPY SURD032.                                                01700004
017000                                                                  01710004
017100*    OPER UNIT TOTALS INPUT FILE LAYOUT                           01720004
017200     COPY SURD035.                                                01730004
017300                                                                  01740004
017400/                                                                 01750004
017500*STANDARD REPORT HEADER FOR 132 COLUMN REPORT                     01760004
017600     COPY DPWS132.                                                01770004
017700                                                                  01780004
017800*MAIN HEADINGS                                                    01790004
017900 01  HEADING-LINE1.                                               01800004
018000     05  FILLER                  PIC  X(42)    VALUE SPACE.       01810004
018100     05  FILLER                  PIC  X(49)    VALUE              01820004
018200         'CORPORATE SUMMARY QC SPOT CHECK STATISTICS REPORT'.     01830004
018300     05  FILLER                  PIC  X(41)    VALUE SPACE.       01840004
018400                                                                  01850004
018500 01  HEADING-LINE2.                                               01860004
018600     05  FILLER                  PIC  X(54)    VALUE SPACE.       01870004
018700*        (SUCH AS 'WEEK', 'MONTH', 'YEAR')                        01880004
018800     05  HL2-PERIOD-TYPE         PIC  X(07)    VALUE              01890004
018900         '  WEEK '.                                               01900004
019000     05  FILLER                  PIC  X(07)    VALUE              01910004
019100         'ENDING '.                                               01920004
019200     05  HL2-WEEK-ENDING-DATE    PIC X(10)     VALUE SPACES.      01930004
019300     05  FILLER                  PIC  X(54)    VALUE SPACE.       01940004
019400                                                                  01950004
019500 01  HEADING-LINE3.                                               01960004
019600     05  FILLER                  PIC  X(17)    VALUE              01970004
019700         'CORPORATE SUMMARY'.                                     01980004
019800     05  FILLER                  PIC  X(115)   VALUE SPACE.       01990004
019900                                                                  02000004
020000 01  HEADING-LINE4.                                               02010004
CH8347     05  FILLER                  PIC  X(09)    VALUE SPACE.       02020011
CH8347     05  FILLER                  PIC  X(23)    VALUE ALL '-'.     02030011
020300     05  FILLER                  PIC  X(18)    VALUE              02040004
020400         ' NUMBER OF AUDITS '.                                    02050004
CH8347     05  FILLER                  PIC  X(25)    VALUE ALL '-'.     02060011
CH8347     05  FILLER                  PIC  X(15)    VALUE SPACES.      02070011
CH8347     05  FILLER                  PIC  X(23)    VALUE ALL '-'.     02080011
020800     05  FILLER                  PIC  X(15)    VALUE              02090004
020900         ' UNITS AUDITED '.                                       02100004
021000     05  FILLER                  PIC  X(18)    VALUE ALL '-'.     02110004
021100                                                                  02120004
021200 01  HEADING-LINE5.                                               02130004
CH8347     05  FILLER                  PIC  X(31)    VALUE              02140011
CH8347         '         TOTAL    TOTAL  PROMPT'.                       02150011
CH8347     05  FILLER                  PIC  X(35)    VALUE SPACES.      02160011
CH8347     05  FILLER                  PIC  X(39)    VALUE              02170011
CH8347         'AUDITS    -- CARTONS --- --- UNITS ----'.               02180011
CH8347     05  FILLER                  PIC  X(37)    VALUE SPACES.      02190011
CH8347     05  FILLER                  PIC  X(06)    VALUE              02200011
022000         'UNIT'.                                                  02210004
022100     05  FILLER                  PIC  X(02)    VALUE SPACES.      02220004
022200                                                                  02230004
022300 01  HEADING-LINE6.                                               02240004
CH8347     05  FILLER                  PIC  X(31)    VALUE              02250011
CH8347         '         PROMPT   COMPLT COMPLT'.                       02260011
CH8347     05  FILLER                  PIC  X(42)    VALUE              02270011
CH8347         '   -- PASSED ---    -- FAILED --   W/CRTN'.             02280011
CH8347     05  FILLER                  PIC  X(32)    VALUE              02290011
CH8347         '   -- AUDITED --- -- AUDITED ---'.                      02300011
CH8347     05  FILLER                  PIC  X(21)    VALUE SPACES.      02310011
CH8347     05  FILLER                  PIC  X(20)    VALUE              02320011
CH8347         'NOT      IN     PER'.                                   02330011
023300     05  FILLER                  PIC  X(02)    VALUE SPACES.      02340004
023400                                                                  02350004
023500 01  HEADING-LINE7.                                               02360004
CH8347     05  FILLER                  PIC  X(31)    VALUE              02370011
CH8347         '         COMPLT   AUDITS PERCNT'.                       02380011
CH8347     05  FILLER                  PIC  X(41)    VALUE              02390011
CH8347         '    QTY   PERCNT    QTY   PERCNT   REOPEN'.             02400011
CH8347     05  FILLER                  PIC  X(41)    VALUE              02410011
CH8347         '    QTY   PERCNT    QTY   PERCNT   PROMPT'.             02420011
CH8347     05  FILLER                  PIC  X(33)    VALUE              02430011
CH8347         '  COMPLETE  NEEDED  PROCESS  HOUR'.                     02440011
024400     05  FILLER                  PIC  X(02)    VALUE SPACES.      02450004
024500                                                                  02460004
024600 01  SUBHEADING-LINE1.                                            02470004
024700     05  SH1-PKGNG-TYPE          PIC  X(17)    VALUE SPACES.      02480004
024800         88  SH1-BULK-CASEPACK                 VALUE              02490004
024900             '** BULK/CASEPACK:'.                                 02500004
025000         88  SH1-PREPACK                       VALUE              02510004
025100             '** PREPACK:      '.                                 02520004
025200         88  SH1-PACK-BY-STORE                 VALUE              02530004
025300             '** PACK BY STORE:'.                                 02540004
      *DW 12/13/13 - BEGIN                                              02550004
025200         88  SH1-RFID                          VALUE              02560004
025300             '** RFID:'.                                          02570004
      *DW 12/13/13 - BEGIN                                              02580004
025400         88  SH1-CORP-TOTALS                   VALUE              02590004
025500             '** CORP TOTAL:   '.                                 02600004
025600     05  FILLER                  PIC  X(115)   VALUE SPACES.      02610004
025700                                                                  02620004
025800 01  DETAIL-LINES.                                                02630004
025900                                                                  02640004
026000*    THIS LINE RECAPS ALL THE VENDOR RANK TOTALS FOR THE DC       02650004
026100     05  DL-LINE2.                                                02660004
026200         10  DL1-VENDOR-RANKING       PIC X(06) VALUE SPACES.     02670004
026300         10  FILLER                   PIC X(01) VALUE SPACES.     02680004
CH8347         10  DL1-TOT-PROMPT-AUDITS    PIC Z(7)9.                  02690011
026500         10  FILLER                   PIC X(01) VALUE SPACES.     02700004
CH8347         10  DL1-TOT-COMPLT-AUDITS    PIC Z(7)9.                  02710011
026700         10  FILLER                   PIC X(01) VALUE SPACES.     02720004
026800         10  DL1-PRMPT-COMPLT-PCT     PIC ZZ9.99.                 02730004
026900         10  FILLER                   PIC X(01) VALUE SPACES.     02740004
CH8347         10  DL1-AUD-PASSED-QTY       PIC Z(7)9.                  02750011
027100         10  FILLER                   PIC X(01) VALUE SPACES.     02760004
027200         10  DL1-AUD-PASSED-PCT       PIC ZZ9.99.                 02770004
027300         10  FILLER                   PIC X(01) VALUE SPACES.     02780004
CH8347         10  DL1-AUD-FAILED-QTY       PIC Z(7)9.                  02790011
027500         10  FILLER                   PIC X(01) VALUE SPACES.     02800004
027600         10  DL1-AUD-FAILED-PCT       PIC ZZ9.99.                 02810004
027700         10  FILLER                   PIC X(01) VALUE SPACES.     02820004
CH8347         10  DL1-AUD-REOPEN-QTY       PIC Z(7)9.                  02830011
027900         10  FILLER                   PIC X(01) VALUE SPACES.     02840004
CH8347         10  DL1-CTNS-AUDITED-QTY     PIC Z(7)9.                  02850011
028100         10  FILLER                   PIC X(01) VALUE SPACES.     02860004
028200         10  DL1-CTNS-AUDITED-PCT     PIC ZZ9.99.                 02870004
028300         10  FILLER                   PIC X(01) VALUE SPACES.     02880004
CH8347         10  DL1-UNIT-AUDITED-QTY     PIC Z(7)9.                  02890011
028500         10  FILLER                   PIC X(01) VALUE SPACES.     02900004
028600         10  DL1-UNIT-AUDITED-PCT     PIC ZZ9.99.                 02910004
028700         10  FILLER                   PIC X(01) VALUE SPACES.     02920004
CH8347         10  DL1-UNIT-PROMPT-QTY      PIC Z(7)9.                  02930011
028900         10  FILLER                   PIC X(01) VALUE SPACES.     02940004
CH8347         10  DL1-UNIT-COMPLETE-QTY    PIC Z(7)9.                  02950011
029100         10  FILLER                   PIC X(01) VALUE SPACES.     02960004
CH8347         10  DL1-UNIT-NOT-NEEDED-QTY  PIC Z(7)9.                  02970011
029300         10  FILLER                   PIC X(01) VALUE SPACES.     02980004
CH8347         10  DL1-UNIT-IN-PROCESS-QTY  PIC Z(7)9.                  02990011
029500         10  FILLER                   PIC X(01) VALUE SPACES.     03000004
029600         10  DL1-UNIT-PER-HOUR        PIC ZZZZ9.                  03010004
029700                                                                  03020004
029800                                                                  03030004
029900 01  TOTAL-LINES.                                                 03040004
030000     05  TL-LINE1.                                                03050004
030100         10  FILLER                   PIC X(06) VALUE 'TOTAL '.   03060004
CH8347         10  FILLER                   PIC X(11) VALUE SPACES.     03070011
030300         10  TL1-TOT-COMPLT-AUDITS    PIC Z(6)9.                  03080004
CH8347         10  FILLER                   PIC X(09) VALUE SPACES.     03090011
030500         10  TL1-AUD-PASSED-QTY       PIC Z(6)9.                  03100004
CH8347         10  FILLER                   PIC X(09) VALUE SPACES.     03110011
030700         10  TL1-AUD-FAILED-QTY       PIC Z(6)9.                  03120004
CH8347         10  FILLER                   PIC X(09) VALUE SPACES.     03130011
030900         10  TL1-AUD-REOPEN-QTY       PIC Z(6)9.                  03140004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03150011
031100         10  TL1-CTNS-AUDITED-PCT     PIC ZZ9.99.                 03160004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03170011
031300         10  TL1-UNIT-AUDITED-PCT     PIC ZZ9.99.                 03180004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03190011
031500         10  TL1-UNIT-COMPLETE-QTY    PIC Z(7)9.                  03200004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03210011
031700         10  TL1-UNIT-IN-PROCESS-QTY  PIC Z(7)9.                  03220004
031800                                                                  03230004
031900     05  TL-LINE2.                                                03240004
CH8347         10  FILLER                   PIC X(07) VALUE SPACES.     03250011
032100         10  TL2-TOT-PROMPT-AUDITS    PIC Z(7)9.                  03260004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03270011
032300         10  TL2-PRMPT-COMPLT-PCT     PIC ZZ9.99.                 03280004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03290011
032500         10  TL2-AUD-PASSED-PCT       PIC ZZ9.99.                 03300004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03310011
032700         10  TL2-AUD-FAILED-PCT       PIC ZZ9.99.                 03320004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03330011
032900         10  TL2-CTNS-AUDITED-QTY     PIC Z(7)9.                  03340004
CH8347         10  FILLER                   PIC X(08) VALUE SPACES.     03350011
033100         10  TL2-UNIT-AUDITED-QTY     PIC Z(7)9.                  03360004
CH8347         10  FILLER                   PIC X(08) VALUE SPACES.     03370011
033300         10  TL2-UNIT-PROMPT-QTY      PIC Z(7)9.                  03380004
CH8347         10  FILLER                   PIC X(10) VALUE SPACES.     03390011
033500         10  TL2-UNIT-NOT-NEEDED-QTY  PIC Z(7)9.                  03400004
CH8347         10  FILLER                   PIC X(09) VALUE SPACES.     03410011
033700         10  TL2-UNIT-PER-HOUR        PIC Z(5)9.                  03420004
033800                                                                  03430004
033810     05  TL-LINE3.                                                03440004
CH8347         10  FILLER                   PIC X(73) VALUE SPACES.     03450011
033893         10  FILLER                   PIC X(15) VALUE             03460004
033894                                      'CRTN UNIT QTY  '.          03470004
033895         10  TL3-CRTN-UNIT-QTY        PIC Z(8)9.                  03480004
033896         10  FILLER                   PIC X(45) VALUE SPACES.     03490004
033901                                                                  03500004
033910 01  MISCELLANEOUS-LINES.                                         03510004
034000     05  END-OF-REPORT-LINE.                                      03520004
034100         10  FILLER                  PIC  X(44)    VALUE SPACES.  03530004
034200         10  FILLER                  PIC  X(45)    VALUE          03540004
034300             '*******   E N D   O F   R E P O R T   *******'.     03550004
034400         10  FILLER                  PIC  X(43)    VALUE SPACES.  03560004
034500     05  NO-DATA-TO-REPORT-LINE.                                  03570004
034600         10  FILLER                  PIC  X(40)    VALUE SPACES.  03580004
034700         10  FILLER                  PIC  X(52)    VALUE          03590004
034800         '*******  N O   D A T A   T O   R E P O R T   *******'.  03600004
034900         10  FILLER                  PIC  X(40)    VALUE SPACES.  03610004
035000     05  BL-BLANK-LINE               PIC X(132)    VALUE SPACE.   03620004
035100                                                                  03630004
035200                                                                  03640004
035300                                                                  03650004
035400*    OCCURRENCE 1 IS FOR EACH PACKAGING TYPE                      03660004
035500*    OCCURRENCE 2 IS FOR THE WHOLE DC                             03670004
035600*    OCCURRENCES 3 THRU 20 ARE TO SUMMARIZE THE                   03680004
035700*         INDIVIDUAL VENDOR RANKS AT THE PACKAGE LEVEL            03690004
035800*    OCCURRENCES 20 THRU 38 ARE TO SUMMARIZE THE                  03700004
035900*         INDIVIDUAL VENDOR RANKS AT THE CORPORATE LEVEL          03710004
036000 01  PT-TOTALS-TABLE.                                             03720004
036100     05  PT-TOTALS OCCURS 38 TIMES INDEXED BY PT-IDX,             03730004
036200                                              PT-SRCH-IDX,        03740004
036300                                              PT-TOT-IDX,         03750004
036400                                              PT-END-IDX,         03760004
036500                                              PT-FINAL-IDX.       03770004
036600*    PT-END-IDX MARKS THE LAST VALID OCCURRENCE IN THE TABLE      03780004
036700*       IN THE 3 THROUGH 20 RANGE                                 03790004
036800         10  PT-VENDOR-RANK           PIC X(6).                   03800004
036900         10  PT-PROMPT-AUDITS         PIC S9(9) COMP-3.           03810004
037000         10  PT-COMPLETE-AUDITS       PIC S9(9) COMP-3.           03820004
037100         10  PT-AUD-CNT-COMPLT        PIC S9(9) COMP-3.           03830004
037200         10  PT-AUD-CNT-PROMPT        PIC S9(9) COMP-3.           03840004
037300         10  PT-PASSED-QTY            PIC S9(9) COMP-3.           03850004
037400         10  PT-FAILED-QTY            PIC S9(9) COMP-3.           03860004
037500         10  PT-REOPEN-QTY            PIC S9(9) COMP-3.           03870004
037600         10  PT-CRTNS-AUDITED-QTY     PIC S9(9) COMP-3.           03880004
037700         10  PT-UNITS-AUDITED-QTY     PIC S9(9) COMP-3.           03890004
037800         10  PT-UNITS-PROMPT-QTY      PIC S9(9) COMP-3.           03900004
037900         10  PT-UNITS-COMPLETE-QTY    PIC S9(9) COMP-3.           03910004
038000         10  PT-UNITS-NOT-NEEDED-QTY  PIC S9(9) COMP-3.           03920004
038100         10  PT-UNITS-INPROCESS-QTY   PIC S9(9) COMP-3.           03930004
038200         10  PT-UNITS-PER-HOUR        PIC S9(9) COMP-3.           03940004
038300         10  PT-AUD-CRTN-QTY-COMPLT   PIC S9(9) COMP-3.           03950004
038400         10  PT-TOTAL-MINUTES         PIC S9(14) COMP-3.          03960004
038500         10  PT-CRTN-CRTN-QTY         PIC S9(9) COMP-3.           03970004
038600         10  PT-CRTN-UNIT-QTY         PIC S9(9) COMP-3.           03980004
038700                                                                  03990004
038800         10  PT-PROMPT-COMPLETE-PCT   PIC S9(3)V99 COMP-3.        04000004
038900         10  PT-PASSED-PCT            PIC S9(3)V99 COMP-3.        04010004
039000         10  PT-FAILED-PCT            PIC S9(3)V99 COMP-3.        04020004
039100         10  PT-CARTONS-AUDITED-PCT   PIC S9(3)V99 COMP-3.        04030004
039200         10  PT-UNITS-AUDITED-PCT     PIC S9(3)V99 COMP-3.        04040004
039300/                                                                 04050004
039400* STORE MASTER                                                    04060004
039500                                                                  04070004
039600     COPY DPWS004.                                                04080004
039700                                                                  04090004
039800/                                                                 04100004
039900 PROCEDURE DIVISION.                                              04110004
040000                                                                  04120004
040100 0000-MAINLINE.                                                   04130004
040200     PERFORM 1000-INITIALIZE.                                     04140004
040300                                                                  04150004
040400     PERFORM 2000-MAIN-PROCESS                                    04160004
040500         UNTIL PS-EOF-EXTRACT                                     04170004
040600                                                                  04180004
040700     PERFORM 9000-END-PROCESS.                                    04190004
040800                                                                  04200004
040900     GOBACK.                                                      04210004
041000*                                                                 04220004
041100*                                                                 04230004
041200 1000-INITIALIZE.                                                 04240004
041300     OPEN INPUT TOTAL-FILE                                        04250004
041400          OUTPUT REPORT-FILE.                                     04260004
041500                                                                  04270004
041600     ACCEPT PV-TODAYS-DATE FROM DATE YYYYMMDD.                    04280004
041700     ACCEPT PV-TODAYS-TIME FROM TIME.                             04290004
041800                                                                  04300004
041900     MOVE PV-TODAYS-DATE-MM        TO DP132-RUN-MONTH.            04310004
042000     MOVE PV-TODAYS-DATE-DD        TO DP132-RUN-DAY.              04320004
042100     MOVE PV-TODAYS-DATE-CCYY      TO DP132-RUN-YEAR.             04330004
042200     MOVE PV-TODAYS-TIME-HH        TO DP132-RUN-HOUR.             04340004
042300     MOVE PV-TODAYS-TIME-MM        TO DP132-RUN-MINUTE.           04350004
042400     MOVE PC-CURRENT-PROGRAM-NAME  TO DP132-PROGRAM-NAME.         04360004
042500                                                                  04370004
042600     ACCEPT SU032-DATE-CONTROL-REC FROM SYSIN.                    04380004
042700                                                                  04390004
042800     DISPLAY 'CONTROL CARD IS:'                                   04400004
042900     DISPLAY SU032-DATE-CONTROL-REC                               04410004
043000                                                                  04420004
043100     STRING SU032-TO-DATE (6:2) '/'                               04430004
043200            SU032-TO-DATE (9:2) '/'                               04440004
043300            SU032-TO-DATE (1:4)                                   04450004
043400             DELIMITED BY SIZE                                    04460004
043500         INTO HL2-WEEK-ENDING-DATE                                04470004
043600                                                                  04480004
043700     EVALUATE SU032-RPT-TYPE                                      04490004
043800     WHEN 'W'                                                     04500004
043900         MOVE '  WEEK '               TO HL2-PERIOD-TYPE          04510004
044000     WHEN 'M'                                                     04520004
044100         MOVE ' MONTH '               TO HL2-PERIOD-TYPE          04530004
044200     WHEN 'S'                                                     04540004
044300         MOVE 'SEASON '               TO HL2-PERIOD-TYPE          04550004
044400     WHEN 'C'                                                     04560004
044500     WHEN 'F'                                                     04570004
044600         MOVE '  YEAR '               TO HL2-PERIOD-TYPE          04580004
044610     WHEN 'T'                                                     04590004
044620         MOVE '   YTD '               TO HL2-PERIOD-TYPE          04600004
044630     WHEN OTHER                                                   04610004
044640         MOVE '1000-INITIALIZE'       TO PV-PARAGRAPH-NAME        04620004
044650         MOVE 'INVALID REPORT TYPE  ' TO PV-ERROR-MESSAGE-1       04630004
044660         PERFORM 9200-ABEND                                       04640004
044670     END-EVALUATE                                                 04650004
044680                                                                  04660004
044690     PERFORM 8000-READ-TOTAL-FILE.                                04670004
044700                                                                  04680004
044800     PERFORM 8100-PRINT-REPORT-HEADINGS                           04690004
044900                                                                  04700004
045000     IF PS-EOF-EXTRACT                                            04710004
045100         SET PS-NO-DATA               TO TRUE                     04720004
045200         WRITE REPORT-RECORD                                      04730004
045300           FROM NO-DATA-TO-REPORT-LINE                            04740004
045400         AFTER ADVANCING 3 LINE                                   04750004
045500     ELSE                                                         04760004
045600                                                                  04770004
045700         MOVE PV-CURR-KEY             TO PV-PREV-KEY              04780004
045800         MOVE SU035-VENDOR-RANKING    TO PV-SAVE-VENDOR-RANK      04790004
045900         MOVE SU035-PKGNG-TYPE        TO PV-SAVE-PKGNG-TYPE       04800004
046000                                                                  04810004
046100         SET PS-PRINT-SUBHEADER                                   04820004
046200         PS-DONT-PRINT-CORP-TOTAL     TO TRUE                     04830004
046300                                                                  04840004
046400         INITIALIZE PT-TOTALS-TABLE                               04850004
046500     END-IF.                                                      04860004
046600                                                                  04870004
046700/                                                                 04880004
046800 2000-MAIN-PROCESS.                                               04890004
046900                                                                  04900004
047000     EVALUATE TRUE                                                04910004
047100         WHEN PV-PKGNG-TYPE-CURR  =  PV-PKGNG-TYPE-PREV           04920004
047200             PERFORM 4000-DETAIL-BUCKETS                          04930004
047300         WHEN PV-PKGNG-TYPE-CURR  >  PV-PKGNG-TYPE-PREV           04940004
047400             PERFORM 3000-PKGNG-BREAK                             04950004
047500             PERFORM 4000-DETAIL-BUCKETS                          04960004
047600     END-EVALUATE.                                                04970004
047700                                                                  04980004
047800     IF PS-PRINT-SUBHEADER                                        04990004
047900         PERFORM 8300-SUBHEADER                                   05000004
048000     END-IF.                                                      05010004
048100                                                                  05020004
048200     PERFORM 8000-READ-TOTAL-FILE.                                05030004
048300                                                                  05040004
048400                                                                  05050004
048500 3000-PKGNG-BREAK.                                                05060004
048600                                                                  05070004
048700     PERFORM VARYING PT-IDX FROM 3 BY 1                           05080004
048800                   UNTIL PT-IDX > PT-END-IDX                      05090004
048900         PERFORM 4200-TOTALS                                      05100004
049000         INITIALIZE PT-TOTALS (PT-IDX)                            05110004
049100     END-PERFORM.                                                 05120004
049200                                                                  05130004
049300                                                                  05140004
049400     SET PT-IDX                       TO 1.                       05150004
049500     PERFORM 4100-TOTALS.                                         05160004
049600     INITIALIZE PT-TOTALS (1).                                    05170004
049700                                                                  05180004
049800                                                                  05190004
049900     MOVE SU035-VENDOR-RANKING        TO PV-SAVE-VENDOR-RANK.     05200004
050000                                                                  05210004
050100     SET PS-PRINT-SUBHEADER           TO TRUE.                    05220004
050200     MOVE PV-PKGNG-TYPE-CURR          TO PV-PKGNG-TYPE-PREV.      05230004
050300     MOVE PV-VENDOR-RANK-CURR         TO PV-VENDOR-RANK-PREV.     05240004
050400                                                                  05250004
050500     IF PS-EOF-EXTRACT                                            05260004
050600         CONTINUE                                                 05270004
050700     ELSE                                                         05280004
050800         MOVE PV-CURR-KEY             TO PV-PREV-KEY              05290004
050900         SET PS-PRINT-SUBHEADER       TO TRUE                     05300004
051000         PERFORM 8300-SUBHEADER                                   05310004
051100     END-IF.                                                      05320004
051200                                                                  05330004
051300 4000-DETAIL-BUCKETS.                                             05340004
051400                                                                  05350004
051500     SET PT-SRCH-IDX                  TO 3.                       05360004
051600                                                                  05370004
051700     SEARCH PT-TOTALS VARYING PT-SRCH-IDX                         05380004
051800     AT END                                                       05390004
051900         MOVE '2110-MOVE-AUDIT-FIELDS' TO PV-PARAGRAPH-NAME       05400004
052000         MOVE 'TABLE OVERFLOW       ' TO PV-ERROR-MESSAGE-1       05410004
052100         PERFORM 9200-ABEND                                       05420004
052200                                                                  05430004
052300     WHEN PT-VENDOR-RANK (PT-SRCH-IDX) = SPACES                   05440004
052400         MOVE SU035-VENDOR-RANKING    TO PT-VENDOR-RANK           05450004
052500                                         (PT-SRCH-IDX)            05460004
052600         SET PT-END-IDX               TO PT-SRCH-IDX              05470004
052700     WHEN PT-VENDOR-RANK (PT-SRCH-IDX) = SU035-VENDOR-RANKING     05480004
052800         CONTINUE                                                 05490004
052900     END-SEARCH.                                                  05500004
053000                                                                  05510004
053100     SET PT-TOT-IDX                   TO 21.                      05520004
053200                                                                  05530004
053300     SEARCH PT-TOTALS VARYING PT-TOT-IDX                          05540004
053400     AT END                                                       05550004
053500         MOVE '2110-MOVE-AUDIT-FIELDS' TO PV-PARAGRAPH-NAME       05560004
053600         MOVE 'TOTALS TABLE OVERFLOW' TO PV-ERROR-MESSAGE-1       05570004
053700         PERFORM 9200-ABEND                                       05580004
053800                                                                  05590004
053900     WHEN PT-VENDOR-RANK (PT-TOT-IDX) = SPACES                    05600004
054000         SET PT-FINAL-IDX             TO PT-TOT-IDX               05610004
054100         MOVE SU035-VENDOR-RANKING    TO PT-VENDOR-RANK           05620004
054200                                         (PT-TOT-IDX)             05630004
054300     WHEN PT-VENDOR-RANK (PT-TOT-IDX) = SU035-VENDOR-RANKING      05640004
054400         CONTINUE                                                 05650004
054500     END-SEARCH.                                                  05660004
054600                                                                  05670004
054700     ADD SU035-TOT-PROMPT-AUDITS TO PT-PROMPT-AUDITS (1)          05680004
054800                                    PT-PROMPT-AUDITS (2)          05690004
054900                                    PT-PROMPT-AUDITS              05700004
055000                                         (PT-SRCH-IDX)            05710004
055100                                    PT-PROMPT-AUDITS              05720004
055200                                         (PT-TOT-IDX).            05730004
055300                                                                  05740004
055400     ADD SU035-COMPLETE-AUDITS   TO PT-COMPLETE-AUDITS            05750004
055500                                         (PT-SRCH-IDX).           05760004
055600                                                                  05770004
055700     ADD SU035-TOT-COMPLT-AUDITS TO PT-AUD-CNT-COMPLT (1)         05780004
055800                                    PT-AUD-CNT-COMPLT (2)         05790004
055900                                    PT-AUD-CNT-COMPLT             05800004
056000                                         (PT-SRCH-IDX)            05810004
056100                                    PT-AUD-CNT-COMPLT             05820004
056200                                         (PT-TOT-IDX).            05830004
056300                                                                  05840004
056400                                                                  05850004
056500     ADD SU035-AUD-CNT-PROMPT    TO PT-AUD-CNT-PROMPT (1)         05860004
056600                                    PT-AUD-CNT-PROMPT (2)         05870004
056700                                    PT-AUD-CNT-PROMPT             05880004
056800                                         (PT-SRCH-IDX)            05890004
056900                                    PT-AUD-CNT-PROMPT             05900004
057000                                         (PT-TOT-IDX).            05910004
057100                                                                  05920004
057200     ADD SU035-AUD-PASSED-QTY    TO PT-PASSED-QTY (1)             05930004
057300                                    PT-PASSED-QTY (2)             05940004
057400                                    PT-PASSED-QTY                 05950004
057500                                         (PT-SRCH-IDX)            05960004
057600                                    PT-PASSED-QTY                 05970004
057700                                         (PT-TOT-IDX).            05980004
057800                                                                  05990004
057900     ADD SU035-AUD-FAILED-QTY    TO PT-FAILED-QTY (1)             06000004
058000                                    PT-FAILED-QTY (2)             06010004
058100                                    PT-FAILED-QTY                 06020004
058200                                         (PT-SRCH-IDX)            06030004
058300                                    PT-FAILED-QTY                 06040004
058400                                         (PT-TOT-IDX).            06050004
058500                                                                  06060004
058600     ADD SU035-AUD-REOPEN-QTY    TO PT-REOPEN-QTY (1)             06070004
058700                                    PT-REOPEN-QTY (2)             06080004
058800                                    PT-REOPEN-QTY                 06090004
058900                                         (PT-SRCH-IDX)            06100004
059000                                    PT-REOPEN-QTY                 06110004
059100                                         (PT-TOT-IDX).            06120004
059200                                                                  06130004
059300     ADD SU035-CTNS-AUDITED-QTY                                   06140004
059400                             TO PT-CRTNS-AUDITED-QTY (1)          06150004
059500                                PT-CRTNS-AUDITED-QTY (2)          06160004
059600                                PT-CRTNS-AUDITED-QTY              06170004
059700                                         (PT-SRCH-IDX)            06180004
059800                                PT-CRTNS-AUDITED-QTY              06190004
059900                                         (PT-TOT-IDX).            06200004
060000                                                                  06210004
060100     ADD SU035-UNIT-AUDITED-QTY                                   06220004
060200                             TO PT-UNITS-AUDITED-QTY (1)          06230004
060300                                PT-UNITS-AUDITED-QTY (2)          06240004
060400                                PT-UNITS-AUDITED-QTY              06250004
060500                                         (PT-SRCH-IDX)            06260004
060600                                PT-UNITS-AUDITED-QTY              06270004
060700                                         (PT-TOT-IDX).            06280004
060800                                                                  06290004
060900     ADD SU035-UNIT-PROMPT-QTY                                    06300004
061000                             TO PT-UNITS-PROMPT-QTY (1)           06310004
061100                                PT-UNITS-PROMPT-QTY (2)           06320004
061200                                PT-UNITS-PROMPT-QTY               06330004
061300                                         (PT-SRCH-IDX)            06340004
061400                                PT-UNITS-PROMPT-QTY               06350004
061500                                         (PT-TOT-IDX).            06360004
061600                                                                  06370004
061700     ADD SU035-UNIT-COMPLETE-QTY                                  06380004
061800                            TO PT-UNITS-COMPLETE-QTY (1)          06390004
061900                               PT-UNITS-COMPLETE-QTY (2)          06400004
062000                               PT-UNITS-COMPLETE-QTY              06410004
062100                                         (PT-SRCH-IDX)            06420004
062200                               PT-UNITS-COMPLETE-QTY              06430004
062300                                         (PT-TOT-IDX).            06440004
062400                                                                  06450004
062500     ADD SU035-UNIT-NOT-NEEDED-QTY                                06460004
062600                         TO PT-UNITS-NOT-NEEDED-QTY (1)           06470004
062700                            PT-UNITS-NOT-NEEDED-QTY (2)           06480004
062800                            PT-UNITS-NOT-NEEDED-QTY               06490004
062900                                         (PT-SRCH-IDX)            06500004
063000                            PT-UNITS-NOT-NEEDED-QTY               06510004
063100                                         (PT-TOT-IDX).            06520004
063200                                                                  06530004
063300     ADD SU035-UNIT-IN-PROCESS-QTY                                06540004
063400                         TO PT-UNITS-INPROCESS-QTY (1)            06550004
063500                            PT-UNITS-INPROCESS-QTY (2)            06560004
063600                            PT-UNITS-INPROCESS-QTY                06570004
063700                                         (PT-SRCH-IDX)            06580004
063800                            PT-UNITS-INPROCESS-QTY                06590004
063900                                         (PT-TOT-IDX).            06600004
064000                                                                  06610004
064100                                                                  06620004
064200     ADD SU035-AUD-CRTN-QTY-COMPLT                                06630004
064300                             TO PT-AUD-CRTN-QTY-COMPLT (1)        06640004
064400                                PT-AUD-CRTN-QTY-COMPLT (2)        06650004
064500                                PT-AUD-CRTN-QTY-COMPLT            06660004
064600                                         (PT-SRCH-IDX)            06670004
064700                                PT-AUD-CRTN-QTY-COMPLT            06680004
064800                                         (PT-TOT-IDX).            06690004
064900                                                                  06700004
065000     ADD SU035-TOTAL-MINUTES TO PT-TOTAL-MINUTES (1)              06710004
065100                                PT-TOTAL-MINUTES (2)              06720004
065200                                PT-TOTAL-MINUTES                  06730004
065300                                         (PT-SRCH-IDX)            06740004
065400                                PT-TOTAL-MINUTES                  06750004
065500                                         (PT-TOT-IDX).            06760004
065600     ADD SU035-CRTN-CRTN-QTY       TO PT-CRTN-CRTN-QTY (1)        06770004
065700                                      PT-CRTN-CRTN-QTY (2)        06780004
065800                                      PT-CRTN-CRTN-QTY            06790004
065900                                         (PT-SRCH-IDX)            06800004
066000                                      PT-CRTN-CRTN-QTY            06810004
066100                                         (PT-TOT-IDX).            06820004
066200     ADD SU035-CRTN-UNIT-QTY       TO PT-CRTN-UNIT-QTY (1)        06830004
066300                                      PT-CRTN-UNIT-QTY (2)        06840004
066400                                      PT-CRTN-UNIT-QTY            06850004
066500                                         (PT-SRCH-IDX)            06860004
066600                                      PT-CRTN-UNIT-QTY            06870004
066700                                         (PT-TOT-IDX).            06880004
066800                                                                  06890004
066900 4100-TOTALS.                                                     06900004
067000                                                                  06910004
067100     MOVE PT-PROMPT-AUDITS (PT-IDX)   TO TL2-TOT-PROMPT-AUDITS    06920004
067200     MOVE PT-AUD-CNT-COMPLT (PT-IDX)  TO TL1-TOT-COMPLT-AUDITS    06930004
067300                                                                  06940004
067400     MOVE PT-PASSED-QTY (PT-IDX)      TO TL1-AUD-PASSED-QTY       06950004
067500                                                                  06960004
067600     MOVE PT-FAILED-QTY (PT-IDX)      TO TL1-AUD-FAILED-QTY       06970004
067700                                                                  06980004
067800     MOVE PT-REOPEN-QTY (PT-IDX)      TO TL1-AUD-REOPEN-QTY       06990004
067900                                                                  07000004
068000     MOVE PT-CRTNS-AUDITED-QTY (PT-IDX) TO TL2-CTNS-AUDITED-QTY   07010004
068100                                                                  07020004
068200     MOVE PT-UNITS-AUDITED-QTY (PT-IDX) TO TL2-UNIT-AUDITED-QTY   07030004
068210     MOVE PT-CRTN-UNIT-QTY (PT-IDX)     TO TL3-CRTN-UNIT-QTY      07040004
068300                                                                  07050004
068400     MOVE PT-UNITS-PROMPT-QTY (PT-IDX) TO TL2-UNIT-PROMPT-QTY     07060004
068500                                                                  07070004
068600     MOVE PT-UNITS-COMPLETE-QTY(PT-IDX) TO TL1-UNIT-COMPLETE-QTY  07080004
068700                                                                  07090004
068800     MOVE PT-UNITS-NOT-NEEDED-QTY (PT-IDX)                        07100004
068900                                      TO TL2-UNIT-NOT-NEEDED-QTY  07110004
069000                                                                  07120004
069100     MOVE PT-UNITS-INPROCESS-QTY (PT-IDX)                         07130004
069200                                      TO TL1-UNIT-IN-PROCESS-QTY  07140004
069300                                                                  07150004
069400     PERFORM 4110-COMPUTE-PERCENTAGES.                            07160004
069500                                                                  07170004
069600 4110-COMPUTE-PERCENTAGES.                                        07180004
069700                                                                  07190004
069800     COMPUTE PV-PERCENT ROUNDED =                                 07200004
069900          ( PT-PROMPT-AUDITS (PT-IDX)                             07210004
070000           / PT-AUD-CNT-PROMPT (PT-IDX) ) * 100                   07220004
070100         ON SIZE ERROR                                            07230004
070200             MOVE ZERO                TO TL2-PRMPT-COMPLT-PCT     07240004
070300         NOT ON SIZE ERROR                                        07250004
070400             MOVE PV-PERCENT          TO TL2-PRMPT-COMPLT-PCT     07260004
070500     END-COMPUTE                                                  07270004
070600                                                                  07280004
070700                                                                  07290004
070800     COMPUTE PV-PERCENT ROUNDED =                                 07300004
070900          ( PT-PASSED-QTY (PT-IDX)                                07310004
071000           / PT-AUD-CNT-COMPLT (PT-IDX) )                         07320004
071100                          * 100                                   07330004
071200         ON SIZE ERROR                                            07340004
071300             MOVE ZERO                TO TL2-AUD-PASSED-PCT       07350004
071400         NOT ON SIZE ERROR                                        07360004
071500             MOVE PV-PERCENT          TO TL2-AUD-PASSED-PCT       07370004
071600     END-COMPUTE                                                  07380004
071700                                                                  07390004
071800                                                                  07400004
071900     COMPUTE PV-PERCENT ROUNDED =                                 07410004
072000          ( PT-FAILED-QTY (PT-IDX)                                07420004
072100           / PT-AUD-CNT-COMPLT (PT-IDX)  )                        07430004
072200                          * 100                                   07440004
072300         ON SIZE ERROR                                            07450004
072400             MOVE ZERO                TO TL2-AUD-FAILED-PCT       07460004
072500         NOT ON SIZE ERROR                                        07470004
072600             MOVE PV-PERCENT          TO TL2-AUD-FAILED-PCT       07480004
072700     END-COMPUTE                                                  07490004
072800                                                                  07500004
072900     COMPUTE PV-UNITS-PER-HOUR ROUNDED =                          07510004
073000        (PT-UNITS-AUDITED-QTY (PT-IDX)                            07520004
073100                   / PT-TOTAL-MINUTES (PT-IDX)) * 60              07530004
073200         ON SIZE ERROR                                            07540004
073300             MOVE ZERO                TO TL2-UNIT-PER-HOUR        07550004
073400         NOT ON SIZE ERROR                                        07560004
073500             MOVE PV-UNITS-PER-HOUR   TO TL2-UNIT-PER-HOUR        07570004
073600     END-COMPUTE.                                                 07580004
073700                                                                  07590004
073800*    MOVE  PT-UNITS-AUDITED-QTY (PT-IDX)  TO  PV-DISP-NUMERIC-1.  07600004
073900*    MOVE  PT-TOTAL-MINUTES (PT-IDX)      TO  PV-DISP-NUMERIC-2.  07610004
074000*    MOVE  PV-UNITS-PER-HOUR              TO  PV-DISP-NUMERIC-3.  07620004
074100*                                                                 07630004
074200*    DISPLAY '   UNITS - ' PV-DISP-NUMERIC-1                      07640004
074300*            '   MIN - '   PV-DISP-NUMERIC-2                      07650004
074400*            '   UPH - '   PV-DISP-NUMERIC-3.                     07660004
074500                                                                  07670004
074600     COMPUTE PV-PERCENT ROUNDED =                                 07680004
074700              ( PT-AUD-CRTN-QTY-COMPLT (PT-IDX)                   07690004
074800               / PT-CRTN-CRTN-QTY (PT-IDX) )                      07700004
074900                              * 100                               07710004
075000         ON SIZE ERROR                                            07720004
075100             MOVE ZERO                TO TL1-CTNS-AUDITED-PCT     07730004
075200         NOT ON SIZE ERROR                                        07740004
075300             MOVE PV-PERCENT          TO TL1-CTNS-AUDITED-PCT     07750004
075400     END-COMPUTE.                                                 07760004
075500                                                                  07770004
075600     COMPUTE PV-PERCENT ROUNDED =                                 07780004
075700              ( PT-UNITS-AUDITED-QTY (PT-IDX)                     07790004
075800               / PT-CRTN-UNIT-QTY (PT-IDX) )                      07800004
075900                          * 100                                   07810004
076000         ON SIZE ERROR                                            07820004
076100             MOVE ZERO                TO TL1-UNIT-AUDITED-PCT     07830004
076200         NOT ON SIZE ERROR                                        07840004
076300             MOVE PV-PERCENT          TO TL1-UNIT-AUDITED-PCT     07850004
076400     END-COMPUTE.                                                 07860004
076500                                                                  07870004
076600                                                                  07880004
076700     WRITE REPORT-RECORD FROM TL-LINE1 AFTER ADVANCING 2 LINES.   07890004
076800     WRITE REPORT-RECORD FROM TL-LINE2 AFTER ADVANCING 1 LINE.    07900004
076810     WRITE REPORT-RECORD FROM TL-LINE3 AFTER ADVANCING 1 LINE.    07910004
076900                                                                  07920004
077000*---------------------------------------------------------------  07930004
077100*   DC TOTALS                                                     07940004
077200*---------------------------------------------------------------  07950004
077300 4200-TOTALS.                                                     07960004
077400                                                                  07970004
077500     MOVE PT-VENDOR-RANK (PT-IDX)     TO DL1-VENDOR-RANKING.      07980004
077600     MOVE PT-PROMPT-AUDITS (PT-IDX)   TO DL1-TOT-PROMPT-AUDITS.   07990004
077700     MOVE PT-AUD-CNT-COMPLT(PT-IDX)   TO DL1-TOT-COMPLT-AUDITS.   08000004
077800                                                                  08010004
077900     MOVE PT-PASSED-QTY (PT-IDX)      TO DL1-AUD-PASSED-QTY.      08020004
078000                                                                  08030004
078100     MOVE PT-FAILED-QTY (PT-IDX)      TO DL1-AUD-FAILED-QTY.      08040004
078200                                                                  08050004
078300     MOVE PT-REOPEN-QTY (PT-IDX)      TO DL1-AUD-REOPEN-QTY.      08060004
078400                                                                  08070004
078500     MOVE PT-CRTNS-AUDITED-QTY (PT-IDX) TO DL1-CTNS-AUDITED-QTY.  08080004
078600                                                                  08090004
078700     MOVE PT-UNITS-AUDITED-QTY (PT-IDX) TO DL1-UNIT-AUDITED-QTY.  08100004
078800                                                                  08110004
078900     MOVE PT-UNITS-PROMPT-QTY (PT-IDX) TO DL1-UNIT-PROMPT-QTY.    08120004
079000                                                                  08130004
079100     MOVE PT-UNITS-COMPLETE-QTY(PT-IDX) TO DL1-UNIT-COMPLETE-QTY. 08140004
079200                                                                  08150004
079300     MOVE PT-UNITS-NOT-NEEDED-QTY (PT-IDX)                        08160004
079400                                      TO DL1-UNIT-NOT-NEEDED-QTY. 08170004
079500                                                                  08180004
079600     MOVE PT-UNITS-INPROCESS-QTY (PT-IDX)                         08190004
079700                                      TO DL1-UNIT-IN-PROCESS-QTY. 08200004
079800                                                                  08210004
079900     PERFORM 4210-COMPUTE-PERCENTAGES.                            08220004
080000                                                                  08230004
080100     WRITE REPORT-RECORD FROM DL-LINE2                            08240004
080200               AFTER ADVANCING 1 LINES.                           08250004
080300                                                                  08260004
080400 4210-COMPUTE-PERCENTAGES.                                        08270004
080500                                                                  08280004
080600     COMPUTE PV-PERCENT ROUNDED =                                 08290004
080700          ( PT-PROMPT-AUDITS (PT-IDX)                             08300004
080800           / PT-AUD-CNT-PROMPT (PT-IDX) ) * 100                   08310004
080900         ON SIZE ERROR                                            08320004
081000             MOVE ZERO                TO DL1-PRMPT-COMPLT-PCT     08330004
081100         NOT ON SIZE ERROR                                        08340004
081200             MOVE PV-PERCENT          TO DL1-PRMPT-COMPLT-PCT     08350004
081300     END-COMPUTE                                                  08360004
081400                                                                  08370004
081500                                                                  08380004
081600     COMPUTE PV-PERCENT ROUNDED =                                 08390004
081700          ( PT-PASSED-QTY (PT-IDX)                                08400004
081800           / PT-AUD-CNT-COMPLT (PT-IDX)  )                        08410004
081900                          * 100                                   08420004
082000         ON SIZE ERROR                                            08430004
082100             MOVE ZERO                TO DL1-AUD-PASSED-PCT       08440004
082200         NOT ON SIZE ERROR                                        08450004
082300             MOVE PV-PERCENT          TO DL1-AUD-PASSED-PCT       08460004
082400     END-COMPUTE                                                  08470004
082500                                                                  08480004
082600                                                                  08490004
082700     COMPUTE PV-PERCENT ROUNDED =                                 08500004
082800          ( PT-FAILED-QTY (PT-IDX)                                08510004
082900           / PT-AUD-CNT-COMPLT (PT-IDX)  )                        08520004
083000                          * 100                                   08530004
083100         ON SIZE ERROR                                            08540004
083200             MOVE ZERO                TO DL1-AUD-FAILED-PCT       08550004
083300         NOT ON SIZE ERROR                                        08560004
083400             MOVE PV-PERCENT          TO DL1-AUD-FAILED-PCT       08570004
083500     END-COMPUTE                                                  08580004
083600                                                                  08590004
083700     COMPUTE PV-PERCENT ROUNDED =                                 08600004
083800              ( PT-AUD-CRTN-QTY-COMPLT (PT-IDX)                   08610004
083900               / PT-CRTN-CRTN-QTY (PT-IDX) )                      08620004
084000                              * 100                               08630004
084100         ON SIZE ERROR                                            08640004
084200             MOVE ZERO                TO DL1-CTNS-AUDITED-PCT     08650004
084300         NOT ON SIZE ERROR                                        08660004
084400             MOVE PV-PERCENT          TO DL1-CTNS-AUDITED-PCT     08670004
084500     END-COMPUTE.                                                 08680004
084600                                                                  08690004
084700     COMPUTE PV-PERCENT ROUNDED =                                 08700004
084800              ( PT-UNITS-AUDITED-QTY (PT-IDX)                     08710004
084900               / PT-CRTN-UNIT-QTY (PT-IDX) )                      08720004
085000                          * 100                                   08730004
085100         ON SIZE ERROR                                            08740004
085200             MOVE ZERO                TO DL1-UNIT-AUDITED-PCT     08750004
085300         NOT ON SIZE ERROR                                        08760004
085400             MOVE PV-PERCENT          TO DL1-UNIT-AUDITED-PCT     08770004
085500     END-COMPUTE.                                                 08780004
085600                                                                  08790004
085700     COMPUTE PV-UNITS-PER-HOUR ROUNDED =                          08800004
085800        (PT-UNITS-AUDITED-QTY (PT-IDX)                            08810004
085900                   / PT-TOTAL-MINUTES (PT-IDX)) * 60              08820004
086000         ON SIZE ERROR                                            08830004
086100             MOVE ZERO                TO DL1-UNIT-PER-HOUR        08840004
086200         NOT ON SIZE ERROR                                        08850004
086300             MOVE PV-UNITS-PER-HOUR   TO DL1-UNIT-PER-HOUR        08860004
086400     END-COMPUTE.                                                 08870004
086500*    MOVE  PT-UNITS-AUDITED-QTY (PT-IDX)  TO  PV-DISP-NUMERIC-1.  08880004
086600*    MOVE  PT-TOTAL-MINUTES (PT-IDX)      TO  PV-DISP-NUMERIC-2.  08890004
086700*    MOVE  PV-UNITS-PER-HOUR              TO  PV-DISP-NUMERIC-3.  08900004
086800*                                                                 08910004
086900*    DISPLAY 'D  UNITS - ' PV-DISP-NUMERIC-1                      08920004
087000*            'D  MIN - '   PV-DISP-NUMERIC-2                      08930004
087100*            'D  UPH - '   PV-DISP-NUMERIC-3.                     08940004
087200                                                                  08950004
087300 8000-READ-TOTAL-FILE.                                            08960004
087400                                                                  08970004
087500     READ TOTAL-FILE INTO SU035-RECORD                            08980004
087600         AT END                                                   08990004
087700             SET PS-EOF-EXTRACT       TO TRUE                     09000004
087800         NOT AT END                                               09010004
087900             MOVE SU035-PKGNG-TYPE    TO PV-PKGNG-TYPE-CURR       09020004
088000             MOVE SU035-VENDOR-RANKING TO PV-VENDOR-RANK-CURR     09030004
088100     END-READ.                                                    09040004
088200                                                                  09050004
088300/                                                                 09060004
088400 8100-PRINT-REPORT-HEADINGS.                                      09070004
088500     ADD 1                        TO PV-PAGE-COUNT.               09080004
088600     MOVE PV-PAGE-COUNT           TO DP132-PAGE-NUMBER.           09090004
088700                                                                  09100004
088800     MOVE ZERO                    TO PV-LINE-COUNT.               09110004
088900     MOVE 1                       TO DP132-REPORT-NUMBER.         09120004
089000                                                                  09130004
089100     WRITE REPORT-RECORD                                          09140004
089200       FROM DP132-STANDRD-HEADER-132-COLS                         09150004
089300         AFTER ADVANCING PAGE.                                    09160004
089400                                                                  09170004
089500     WRITE REPORT-RECORD                                          09180004
089600       FROM HEADING-LINE1                                         09190004
089700         AFTER ADVANCING 2 LINES.                                 09200004
089800                                                                  09210004
089900     WRITE REPORT-RECORD                                          09220004
090000       FROM HEADING-LINE2                                         09230004
090100         AFTER ADVANCING 1 LINE.                                  09240004
090200                                                                  09250004
090300     WRITE REPORT-RECORD                                          09260004
090400       FROM HEADING-LINE3                                         09270004
090500         AFTER ADVANCING 2 LINE.                                  09280004
090600                                                                  09290004
090700     WRITE REPORT-RECORD                                          09300004
090800       FROM HEADING-LINE4                                         09310004
090900         AFTER ADVANCING 1 LINE.                                  09320004
091000                                                                  09330004
091100     WRITE REPORT-RECORD                                          09340004
091200       FROM HEADING-LINE5                                         09350004
091300         AFTER ADVANCING 1 LINE.                                  09360004
091400                                                                  09370004
091500     WRITE REPORT-RECORD                                          09380004
091600       FROM HEADING-LINE6                                         09390004
091700         AFTER ADVANCING 1 LINE.                                  09400004
091800                                                                  09410004
091900     WRITE REPORT-RECORD                                          09420004
092000       FROM HEADING-LINE7                                         09430004
092100         AFTER ADVANCING 1 LINE.                                  09440004
092200                                                                  09450004
092300                                                                  09460004
092400 8300-SUBHEADER.                                                  09470004
092500                                                                  09480004
092600     IF PS-PRINT-CORP-TOTAL                                       09490004
092700         SET SH1-CORP-TOTALS          TO TRUE                     09500004
092800     ELSE                                                         09510004
092900     EVALUATE SU035-PKGNG-TYPE                                    09520004
093000         WHEN 'BC'                                                09530004
093100             SET SH1-BULK-CASEPACK    TO TRUE                     09540004
093200         WHEN 'PP'                                                09550004
093300             SET SH1-PREPACK          TO TRUE                     09560004
093400         WHEN 'PS'                                                09570004
093500             SET SH1-PACK-BY-STORE    TO TRUE                     09580004
      * DW 12/13/13 - BEGIN                                             09590004
093400         WHEN 'RF'                                                09600004
093500             SET SH1-RFID             TO TRUE                     09610004
      * DW 12/13/13 - END                                               09620004
093600     END-EVALUATE                                                 09630004
093700         SET PS-DONT-PRINT-SUBHEADER  TO TRUE                     09640004
093800     END-IF.                                                      09650004
093900                                                                  09660004
094000     IF PS-PRINT-CORP-TOTAL                                       09670004
094100         SET PS-DONT-PRINT-CORP-TOTAL TO TRUE                     09680004
094200         WRITE REPORT-RECORD                                      09690004
094300             FROM SUBHEADING-LINE1                                09700004
094400                 AFTER ADVANCING 3 LINE                           09710004
094500     ELSE                                                         09720004
094600         WRITE REPORT-RECORD                                      09730004
094700             FROM SUBHEADING-LINE1                                09740004
094800                 AFTER ADVANCING 2 LINE                           09750004
094900     END-IF.                                                      09760004
095000                                                                  09770004
095100 9000-END-PROCESS.                                                09780004
095200                                                                  09790004
095300     IF PS-NO-DATA                                                09800004
095400         CONTINUE                                                 09810004
095500     ELSE                                                         09820004
095600         PERFORM 3000-PKGNG-BREAK                                 09830004
095700         SET PS-PRINT-CORP-TOTAL          TO TRUE                 09840004
095800         PERFORM 8300-SUBHEADER                                   09850004
095900                                                                  09860004
096000         PERFORM VARYING PT-IDX FROM 21 BY 1                      09870004
096100                       UNTIL PT-IDX > PT-FINAL-IDX                09880004
096200             PERFORM 4200-TOTALS                                  09890004
096300             INITIALIZE PT-TOTALS (PT-IDX)                        09900004
096400         END-PERFORM                                              09910004
096500                                                                  09920004
096600         SET PT-IDX                       TO 2                    09930004
096700         PERFORM 4100-TOTALS                                      09940004
096800         INITIALIZE PT-TOTALS (2)                                 09950004
096900                                                                  09960004
097000         WRITE REPORT-RECORD                                      09970004
097100             FROM END-OF-REPORT-LINE                              09980004
097200             AFTER ADVANCING 3 LINES                              09990004
097300     END-IF.                                                      10000004
097400                                                                  10010004
097500                                                                  10020004
097600     CLOSE TOTAL-FILE                                             10030004
097700           REPORT-FILE.                                           10040004
097800                                                                  10050004
097900 9200-ABEND.                                                      10060004
098000******************************************************************10070004
098100*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       10080004
098200******************************************************************10090004
098300     DISPLAY '***************************'.                       10100004
098400     DISPLAY '**       ABEND           **'.                       10110004
098500     DISPLAY '**  IN PROGRAM SUKRP035  **'.                       10120004
098600     DISPLAY '***************************'.                       10130004
098700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        10140004
098800     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       10150004
098900     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       10160004
099000                                                                  10170004
099100     MOVE +4014                  TO PV-ABEND-CODE.                10180004
099200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10190004
099300                                                                  10200004
