000100*-----------------------*                                         00010009
000200 IDENTIFICATION DIVISION.                                         00020009
000300*-----------------------*                                         00030009
000400 PROGRAM-ID.    CNKCS222.                                         00040009
000500 AUTHOR.        PATRICK BURKE.                                    00050009
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060009
000700 DATE-WRITTEN.  DECEMBER 2000.                                    00070009
000800 DATE-COMPILED.                                                   00080009
000900*----------------------------------------------------------------*00090009
001000*    THIS PROGRAM ALLOWS THE USER TO DEFINE A NEW OUTBOUND       *00100009
001100*    TRAILER.                                                    *00110009
001200*----------------------------------------------------------------*00120009
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00121041
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00122041
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00123041
263455*----------------------------------------------------------------*00124041
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00125042
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00126042
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00127042
CICS  *-----------------------------------------------------------------00128042
001300                                                                  00130009
001400 ENVIRONMENT DIVISION.                                            00140009
001500                                                                  00150009
001600 DATA DIVISION.                                                   00160009
001700                                                                  00170009
001800 WORKING-STORAGE SECTION.                                         00180009
001900                                                                  00190009
002000 01  DK-DB2-KEYS.                                                 00200009
002100     05  DK-CURR-OPER-UNT-ID       PIC S9(04) COMP VALUE +0.      00210009
002200     05  DK-CURR-FCLTY-ID          PIC S9(04) COMP VALUE +0.      00220009
002300     05  DK-SCAC-CDE               PIC  X(04)  VALUE SPACE.       00230009
002400     05  DK-TRLR-ID                PIC  X(12)  VALUE SPACE.       00240009
002500     05  DK-TRLR-SRL-NBR           PIC S9(09)  VALUE +0 COMP.     00250009
002600     05  DK-TRIP-ID                PIC S9(09)  VALUE +0 COMP.     00260009
002700     05  DK-TRIP-STATUS            PIC  X(02)  VALUE SPACES.      00270009
002800     05  DK-PO-NBR                 PIC S9(07)  VALUE +0 COMP.     00280009
002900     05  DK-REC-SEQ-NBR            PIC S9(09)  VALUE +0 COMP.     00290009
003000     05  DK-SERIAL-SHIP-CDE        PIC S9(18)V COMP-3.            00300009
003100     05  DK-OPER-UNT-ID-DISPLAY    PIC S9(04) COMP VALUE +0.      00310009
003200                                                                  00320009
003300 01  PV-PROGRAM-VARIABLES.                                        00330009
003400     05  PV-CURR-OPER-FCLTY-HOLD.                                 00340009
003500         10  PV-CURR-OPER-UNT-HOLD PIC  9(04)  VALUE ZEROES.      00350009
003600         10  FILLER                PIC  X(01)  VALUE '-'.         00360009
003700         10  PV-CURR-FCLTY-ID-HOLD PIC  9(04)  VALUE ZEROES.      00370009
003800     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE +0     00380009
003900                                                    COMP SYNC.    00390009
004000     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.00400009
004100                                                                  00410009
004200     05  PV-SCAC-CDE                     PIC  X(04) VALUE SPACE.  00420009
004300     05  PV-TRLR-ID                      PIC  X(12) VALUE SPACE.  00430009
004400     05  PV-TRAILER-SERIAL-NBR           PIC S9(09) VALUE +0      00440009
004500                                                    COMP.         00450009
004600     05  PV-TRLR-LENGTH                  PIC S9(04) COMP.         00460009
004700     05  PV-TRLR-LENGTH-CHAR.                                     00470009
004800         10  PV-TRLR-LENGTH-NUM              PIC 9(02).           00480009
004900*JPL                                                              00490009
005000     05  PV-SUB1                         PIC S9(4) COMP SYNC.     00500009
005100     05  PV-SUB2                         PIC S9(4) COMP SYNC.     00510009
005200                                                                  00520009
005300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.00530009
005400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00540009
005500                                                     COMP SYNC.   00550009
005600     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROES 00560009
005700                                                     COMP SYNC.   00570009
005800                                                                  00580009
005900     05  PV-INPUT-FIELD                  PIC X(18).               00590009
006000     05  FILLER REDEFINES PV-INPUT-FIELD.                         00600009
006100         10  PV-INPUT-BYTES OCCURS 18 TIMES.                      00610009
006200             15  PV-IN-BYTE              PIC X(01).               00620009
006300                                                                  00630009
006400     05  PV-OUTPUT-FIELD                 PIC X(18).               00640009
006500     05  FILLER REDEFINES PV-OUTPUT-FIELD.                        00650009
006600         10  PV-OUTPUT-BYTE OCCURS 18 TIMES.                      00660009
006700             15  PV-OUT-BYTE             PIC X(01).               00670009
006800                                                                  00680009
006900     05  PV-COMMIT-COUNTER               PIC S9(04) VALUE ZERO.   00690009
007000     05  PV-DC-5-CHAR-ABBR               PIC  X(05) VALUE SPACES. 00700009
007100     05  PV-DC-5-CHAR-ABBR-R REDEFINES   PV-DC-5-CHAR-ABBR.       00710009
007200         10 FILLER                       PIC X(03).               00720009
007300         10 PV-2-DIGIT-DC-ABBR           PIC X(02).               00730009
007400                                                                  00740009
007500                                                                  00750009
007600                                                                  00760009
007700 01  DN-DB2-NULL-INDICATORS.                                      00770009
007800     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROES. 00780009
007900*                                                                 00790009
008000                                                                  00800009
008100 01  PC-PROGRAM-CONSTANTS.                                        00810009
008200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'CN222A'.   00820009
008300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'CNKM222 '. 00830009
008400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'CNKCS222'. 00840009
008500     05  PC-RANDOM-PGM             PIC  X(08)  VALUE  'DPKUT902'. 00850009
008600     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00860009
008700     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'PCKCS126'.  00870009
008800     05  PC-01                     PIC  X(02)  VALUE '01'.        00880009
008900     05  PC-03                     PIC  X(02)  VALUE  '03'.       00890009
009000     05  PC-90                     PIC  X(02)  VALUE  '90'.       00900009
009100     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       00910009
009200     05  PC-UNLDG                  PIC  X(02)  VALUE  'UG'.       00920009
009300     05  PC-UNLDD                  PIC  X(02)  VALUE  'UN'.       00930009
009400     05  PC-ARRVD                  PIC  X(02)  VALUE  'AR'.       00940009
009500     05  PC-ENROUTE                PIC  X(02)  VALUE  'EN'.       00950009
009600     05  PC-DEPARTED               PIC  X(02)  VALUE  'DP'.       00960009
009700     05  PC-A                           PIC  X(01)  VALUE 'A'.    00970009
009800     05  PC-X                      PIC  X(01)  VALUE  'X'.        00980009
009900     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00990009
010000                                               COMP-3.            01000009
010100     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 01010009
010200                                                                  01020009
010300                                                                  01030009
010400*----------------------------------------------------------------*01040009
010500*  SYSTEM MESSAGES                                                01050009
010600*----------------------------------------------------------------*01060009
010700* 00005 - INVALID VALUE                                           01070009
010800* 00007 - REQUIRED FIELD                                          01080009
010900* 00008 - MUST BE NUMERIC                                         01090009
011000* 00098 - PRINT REQUEST HAS BEEN SUBMITTED                        01100009
011100* 00330 - ENTRY OF A FIELD REQUIRED FOR FUNCTION SELECTED         01110009
011200* 00342 - MUST BE NUMERIC AND > 0                                 01120009
011300* 00726 - PURCHASE ORDER NOT FOUND                                01130009
011400* 00743 - TRIP DOES NOT EXIST                                     01140009
011500* 00746 - INVALID PRINTER DESTINATION                             01150009
011600* 00955 - WRONG OPERATING UNIT/FACILITY FOR THIS RECEIVER         01160009
011700* 01245 - PO NUMBER AND RECEIVER REQUIRED                         01170009
011800* 01551 - SCAC/TRAILER OR TRIP ID ARE REQUIRED FOR USE OF THIS FUN01180009
011900* 01422 - THIS IS AN INVALID LABEL FOR THIS DEPARTMENT            01190009
012000* 02122 - LABEL REQUEST FAILED DUE TO COMMUNICATION ERROR -       01200009
012100*                                     CALL HELP DESK              01210009
012200* 02588 - INVALID SERIAL NUMBER FOR SCAC/TRAILER ID               01220009
012300* 02591 - ADD TRAILER SUCCESSFUL                                  01230009
012400* 02592 - ADD TRAILER SUCCESSFUL AND LABEL PRINT REQUESTED        01240009
012500* 02593 - ADD TRAILER ASSIGNED AND LABEL PRINT REQUESTED          01250009
012600* 02607 - UNABLE TO ADD, TRAILER ALREADY DEFINED                  01260009
012700* 02609 - INVALID SCAC CODE                                       01270009
012800* 02611 - TRAILER ADDED, LABEL PRINT FAILED, RETRY REPRINT        01280009
012900* 02613 - INVALID TRAILER SERIAL NUMBER                           01290009
013000* 02624 - MANUAL TRAILER SERIAL NBR MUST BE < 100,000,000         01300009
013100* 02753 - SERIAL NUMBER ASSIGNED TO ANOTHER SCAC/TRLR             01310009
013200* 03552 - INVALID TRAILER LENGTH MUST BE 01,28,48 OR 53           01320009
013210* 03758 - TRAILER ID CANNOT START WITH SPACE - PLEASE RETRY       01321032
013300*----------------------------------------------------------------*01330009
013400 01  PC-TSYMSG-NUMBERS.                                           01340009
013500     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          01350009
013600     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          01360009
013700     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          01370009
013800     05  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.          01380009
013900     05  PC-TSYMSG-00330       PIC  9(05)  VALUE  00330.          01390009
014000     05  PC-TSYMSG-00342       PIC  9(05)  VALUE  00342.          01400009
014100     05  PC-TSYMSG-00726       PIC  9(05)  VALUE  00726.          01410009
014200     05  PC-TSYMSG-00743       PIC  9(05)  VALUE  00743.          01420009
014300     05  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.          01430009
014400     05  PC-TSYMSG-00955       PIC  9(05)  VALUE  00955.          01440009
014500     05  PC-TSYMSG-01245       PIC  9(05)  VALUE  01245.          01450009
014600     05  PC-TSYMSG-01551       PIC  9(05)  VALUE  01551.          01460009
014700     05  PC-TSYMSG-01422       PIC  9(05)  VALUE  01422.          01470009
014800     05  PC-TSYMSG-02122       PIC  9(05)  VALUE  02122.          01480009
014900     05  PC-TSYMSG-02588       PIC  9(05)  VALUE  02588.          01490009
015000     05  PC-TSYMSG-02591       PIC  9(05)  VALUE  02591.          01500009
015100     05  PC-TSYMSG-02592       PIC  9(05)  VALUE  02592.          01510009
015200     05  PC-TSYMSG-02593       PIC  9(05)  VALUE  02593.          01520009
015300     05  PC-TSYMSG-02607       PIC  9(05)  VALUE  02607.          01530009
015400     05  PC-TSYMSG-02609       PIC  9(05)  VALUE  02609.          01540009
015500     05  PC-TSYMSG-02611       PIC  9(05)  VALUE  02611.          01550009
015600     05  PC-TSYMSG-02613       PIC  9(05)  VALUE  02613.          01560009
015700     05  PC-TSYMSG-02624       PIC  9(05)  VALUE  02624.          01570009
015800     05  PC-TSYMSG-02753       PIC  9(05)  VALUE  02753.          01580009
015900     05  PC-TSYMSG-03552       PIC  9(05)  VALUE  03552.          01590009
015910     05  PC-TSYMSG-03758       PIC  9(05)  VALUE  03758.          01591033
016000                                                                  01600009
016100                                                                  01610009
016200 01  PS-PROGRAM-SWITCHES.                                         01620009
016300     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01630009
016400         88  PS-ERROR                          VALUE  'Y'.        01640009
016500         88  PS-NO-ERROR                       VALUE  'N'.        01650009
016600     05  PS-TRAILER-EXISTS-SW      PIC  X(01)  VALUE  'N'.        01660009
016700         88  PS-TRAILER-EXISTS                 VALUE  'Y'.        01670009
016800         88  PS-TRAILER-DOESNT-EXIST           VALUE  'N'.        01680009
016900     05  PS-ADD-TRAILER-SW         PIC  X(01)  VALUE  'N'.        01690009
017000         88  PS-ADD-TRAILER                    VALUE  'Y'.        01700009
017100         88  PS-NO-ADD-TRAILER                 VALUE  'N'.        01710009
017200     05  PS-VALID-TRAILER-ID-SW    PIC  X(01)  VALUE  'N'.        01720009
017300         88  PS-VALID-TRAILER-ID               VALUE  'Y'.        01730009
017400         88  PS-NOT-VALID-TRAILER-ID           VALUE  'N'.        01740009
017500     05  PS-ADD-TCNTRID-SW         PIC  X(01)  VALUE  'N'.        01750009
017600         88  PS-SUCCESSFUL-ADD-TCNTRID         VALUE  'Y'.        01760009
017700         88  PS-UNSUCCESSFUL-ADD-TCNTRID       VALUE  'N'.        01770009
017800     05  PS-SCAC-EXISTS-SW         PIC  X(01)  VALUE  'N'.        01780009
017900         88  PS-SCAC-EXISTS                    VALUE  'Y'.        01790009
018000         88  PS-SCAC-DOESNT-EXIST              VALUE  'N'.        01800009
018100     05  PS-SCAC-TRAILERID-SW      PIC  X(01)  VALUE  'N'.        01810009
018200         88  PS-SCAC-TRAILERID                 VALUE  'Y'.        01820009
018300         88  PS-NO-SCAC-TRAILERID              VALUE  'N'.        01830009
018400     05  PS-TRLR-LGTH-SW           PIC  X(01)  VALUE  'N'.        01840009
018500         88  PS-VALID-TRLR-LGTH                VALUE  'Y'.        01850009
018600         88  PS-NOT-VALID-TRLR-LGTH            VALUE  'N'.        01860009
018700     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01870009
018800         88  PS-VALID-INPUT                          VALUE 'Y'.   01880009
018900         88  PS-INVALID-INPUT                        VALUE 'N'.   01890009
019000                                                                  01900033
019100 01  PM-PROGRAM-MESSAGES.                                         01910009
019200     05  PM-ABEND-INFO-A.                                         01920009
019300         10  FILLER                PIC X(15)   VALUE              01930009
019400                                   'DP020-SRC-AID: '.             01940009
019500         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01950009
019600         10  FILLER                PIC X(19)   VALUE              01960009
019700                                   '. DP020-FK-ACTION: '.         01970009
019800         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01980009
019900         10  FILLER                PIC X(22)   VALUE              01990009
020000                                   '. DP020-FK-DISPN-IND: '.      02000009
020100         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      02010009
020200         10  FILLER                PIC X(01)   VALUE '.'.         02020009
020300         10  FILLER                PIC X(19)   VALUE SPACE.       02030009
020400                                                                  02040009
020500                                                                  02050009
020600*----------------------------------------------------------------*02060009
020700*  RANDOM NUMBER AREA                                             02070009
020800*----------------------------------------------------------------*02080009
020900     COPY DPWS902.                                                02090009
021000                                                                  02100009
021100*----------------------------------------------------------------*02110009
021200*    MAP LAYOUT                                                  *02120009
021300*----------------------------------------------------------------*02130009
021400                                                                  02140009
021500     COPY CNKM222.                                                02150009
021600     EJECT                                                        02160009
021700*                                                                 02170009
021800*----------------------------------------------------------------*02180009
021900*  SENDING/RECEIVING AREA FOR THE PRINTER VALIDATION ROUTING      02190009
022000*  (DPKCS060)                                                     02200009
022100*----------------------------------------------------------------*02210009
022200     COPY DPWS072.                                                02220009
022300                                                                  02230009
022400*----------------------------------------------------------------*02240009
022500*    ATTRIBUTE SETTINGS COPYBOOK.                                *02250009
022600*----------------------------------------------------------------*02260009
022700                                                                  02270009
022800     COPY DPWS015.                                                02280009
022900                                                                  02290009
023000*----------------------------------------------------------------*02300009
023100*    COMMUNICATION AREA FOR PRINT MODULE.                        *02310009
023200*----------------------------------------------------------------*02320009
023300                                                                  02330009
023400     COPY PCWS140.                                                02340009
023500 EJECT                                                            02350009
023600*----------------------------------------------------------------*02360009
023700*    FUNCTION KEYS COPYBOOK                                      *02370009
023800*----------------------------------------------------------------*02380009
023900                                                                  02390009
024000     COPY DPWS016.                                                02400009
024100 EJECT                                                            02410009
024200******************************************************************02420009
024300** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02430009
024400** SUB-ROUTINE (DPKUT100).                                      **02440009
024500******************************************************************02450009
024600     COPY DPWS010I.                                               02460009
024700 EJECT                                                            02470009
024800******************************************************************02480009
024900** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **02490009
025000** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02500009
025100******************************************************************02510009
025200     COPY DPWS030.                                                02520009
CICS       COPY DPWS930.                                                02521042
025300 EJECT                                                            02530009
025400***************************************************************** 02540009
025500*    STANDARD COMMAREA.                                           02550009
025600***************************************************************** 02560009
025700                                                                  02570009
025800     COPY DPWS020.                                                02580009
025900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02590009
026000                                                                  02600009
026100***************************************************************** 02610009
026200*    INTER-APPLICATION COMMAREA.                                  02620009
026300***************************************************************** 02630009
026400                                                                  02640009
026500         10  INTER-APPL-COMM-AREA PIC X(200).                     02650009
026600     COPY CNWS008.                                                02660009
026700***************************************************************** 02670009
026800*    SPECIFIC COMMMAREA                                           02680009
026900***************************************************************** 02690009
027000         10  ASC-SPECIFIC-COMMAREA.                               02700009
027100             15  ASC-LIST-KEYS.                                   02710009
027200                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   02720009
027300                                                     COMP.        02730009
027400                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   02740009
027500                                                     COMP.        02750009
027600                 20  ASC-KEY-TRIP-ID                 PIC S9(09)   02760009
027700                                                     COMP-3.      02770009
027800             15  ASC-CURR-OPER-FCLTY-HOLD.                        02780009
027900                 20  ASC-CURR-OPER-UNT-ID        PIC  9(04).      02790009
028000                 20  ASC-CURR-OPER-UNT-ID-N REDEFINES             02800009
028100                           ASC-CURR-OPER-UNT-ID  PIC  Z(04).      02810009
028200                 20  FILLER                      PIC  X(01).      02820009
028300                 20  ASC-CURR-FCLTY-ID           PIC  X(04).      02830009
028400                 20  ASC-CURR-FCLTY-ID-N REDEFINES                02840009
028500                           ASC-CURR-FCLTY-ID     PIC  Z(04).      02850009
028600                                                                  02860009
028700             15  ASC-FCLTY-NME               PIC  X(25).          02870009
028800             15  ASC-SCAC-CDE                PIC  X(04).          02880009
028900             15  ASC-SCAC-NAME               PIC  X(30).          02890009
029000             15  ASC-TRAILER-ID              PIC  X(12).          02900009
029100             15  ASC-TRAILER-SERIAL-NBR      PIC  X(09).          02910009
029200                                                                  02920009
029300             15  ASC-TRAILER-SERIAL-NBR-N  REDEFINES              02930009
029400                 ASC-TRAILER-SERIAL-NBR      PIC  9(09).          02940009
029500             15  ASC-TRLR-LENGTH             PIC  X(04).          02950009
029600             15  ASC-TRLR-LENGTH-N  REDEFINES ASC-TRLR-LENGTH     02960009
029700                                             PIC  9(04).          02970009
029800             15  ASC-PRINTER-ID              PIC  X(08).          02980009
029900             15  ASC-PRTR-LOC-DESC           PIC  X(30).          02990009
030000             15  ASC-USER-ID                 PIC  X(08).          03000009
030100             15  ASC-XFER-MODE-ID            PIC  X(02).          03010009
030200             15  ASC-IP-ADDRESS              PIC  X(15).          03020009
030300             15  ASC-OS-RLSE-CDE             PIC  X(05).          03030009
030400             15  FILLER                      PIC  X(36).          03040009
030500     EJECT                                                        03050009
030600*----------------------------------------------------------------*03060009
030700*    ABEND PROCESSING COPYBOOK.                                  *03070009
030800*----------------------------------------------------------------*03080009
030900                                                                  03090009
031000     COPY DPWS013.                                                03100009
031100                                                                  03110009
031200*----------------------------------------------------------------*03120009
031300*    DB2 AREA FOR EXTERNAL ENTITY TABLE                          *03130009
031400*----------------------------------------------------------------*03140009
031500                                                                  03150009
031600     EXEC SQL                                                     03160009
031700          INCLUDE TEXTENT                                         03170009
031800     END-EXEC.                                                    03180009
031900                                                                  03190009
032000*----------------------------------------------------------------*03200009
032100*    DB2 AREA                                                    *03210009
032200*----------------------------------------------------------------*03220009
032300                                                                  03230009
032400     EXEC SQL                                                     03240009
032500          INCLUDE TENTNME                                         03250009
032600     END-EXEC.                                                    03260009
032700                                                                  03270009
032800*----------------------------------------------------------------*03280009
032900*    DB2 AREA                                                    *03290009
033000*----------------------------------------------------------------*03300009
033100                                                                  03310009
033200     EXEC SQL                                                     03320009
033300          INCLUDE TCNTRID                                         03330009
033400     END-EXEC.                                                    03340009
033500                                                                  03350009
033600*----------------------------------------------------------------*03360009
033700*    COMMAREA USED TO CALL XLKUT071                              *03370009
033800*----------------------------------------------------------------*03380009
033900                                                                  03390009
034000     COPY XLWS071.                                                03400009
034100                                                                  03410009
034200*----------------------------------------------------------------*03420009
034300*    DB2 AREA FOR TRIP TABLE                                     *03430009
034400*----------------------------------------------------------------*03440009
034500                                                                  03450009
034600     EXEC SQL                                                     03460009
034700          INCLUDE TVHTRIP                                         03470009
034800     END-EXEC.                                                    03480009
034900                                                                  03490009
035000*----------------------------------------------------------------*03500009
035100*    DB2 AREA FOR TRIP STATUS TABLE                              *03510009
035200*----------------------------------------------------------------*03520009
035300                                                                  03530009
035400     EXEC SQL                                                     03540009
035500          INCLUDE TTRIPST                                         03550009
035600     END-EXEC.                                                    03560009
035700                                                                  03570009
035800*----------------------------------------------------------------*03580009
035900*    DB2 AREA FOR SHIP UNIT TABLE                                *03590009
036000*----------------------------------------------------------------*03600009
036100                                                                  03610009
036200     EXEC SQL                                                     03620009
036300          INCLUDE TSHPUNT                                         03630009
036400     END-EXEC.                                                    03640009
036500                                                                  03650009
036600*----------------------------------------------------------------*03660009
036700*    DB2 AREA FOR VEHICLE TABLE                                  *03670009
036800*----------------------------------------------------------------*03680009
036900                                                                  03690009
037000     EXEC SQL                                                     03700009
037100          INCLUDE TVEHICL                                         03710009
037200     END-EXEC.                                                    03720009
037300*----------------------------------------------------------------*03730009
037400*    DB2 AREA FOR RECEIV   TABLE                                  03740009
037500*----------------------------------------------------------------*03750009
037600                                                                  03760009
037700     EXEC SQL                                                     03770009
037800          INCLUDE TRECEIV                                         03780009
037900     END-EXEC.                                                    03790009
038000                                                                  03800009
038100*----------------------------------------------------------------*03810009
038200*    DB2 AREA FOR TKRPRPM  TABLE                                  03820009
038300*----------------------------------------------------------------*03830009
038400                                                                  03840009
038500     EXEC SQL                                                     03850009
038600          INCLUDE TKRPRPM                                         03860009
038700     END-EXEC.                                                    03870009
038800                                                                  03880009
038900*----------------------------------------------------------------*03890009
039000                                                                  03900009
039100*  COMMUNICATION AREAS FOR DB2                                    03910009
039200*                                                                 03920009
039300     EXEC SQL                                                     03930009
039400         INCLUDE SQLCA                                            03940009
039500     END-EXEC.                                                    03950009
039600*----------------------------------------------------------------*03960009
039700                                                                  03970009
039800 EJECT                                                            03980009
039900 LINKAGE SECTION.                                                 03990009
040000                                                                  04000009
040100 01  DFHCOMMAREA.                                                 04010009
040200     05  FILLER                         OCCURS  1 TO 4072 TIMES   04020009
040300                                        DEPENDING ON EIBCALEN.    04030009
040400         10  FILLER                     PIC X.                    04040009
040500                                                                  04050009
040600                                                                  04060009
040700 PROCEDURE DIVISION.                                              04070009
040800***************************************************************** 04080009
040900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04090009
041000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04100009
041100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04110009
041200**                                                             ** 04120009
041300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 04130009
041400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 04140009
041500***************************************************************** 04150009
041600 0000-MAIN-MODULE.                                                04160009
041700     INITIALIZE DP030-CICS-API-FIELDS.                            04170009
041800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04180009
041900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04190009
042000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04200009
042100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04210009
042200     SET PS-NOT-VALID-TRLR-LGTH    TO TRUE.                       04220009
042300     MOVE LENGTH OF CN222AI        TO DP030-MAP-LENGTH (1).       04230009
042400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04240009
042500     PERFORM 0001-CALL-CICS-ARCH-API.                             04250009
042600*                                                                 04260009
042700     PERFORM 1000-CONTROL-PROCESSING                              04270009
042800*                                                                 04280009
042900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04290009
043000     PERFORM 0001-CALL-CICS-ARCH-API.                             04300009
043100                                                                  04310009
043200 0001-CALL-CICS-ARCH-API.                                         04320009
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04330042
043400                                    DFHCOMMAREA                   04340042
043500                                    DP030-CICS-API-FIELDS         04350042
043600                                    DP020-STANDARD-COMMAREA       04360042
043700                                    CN222AI.                      04370042
043800*                                                                 04380009
043900     IF  DP030-RC-CALL-SUCCESSFUL                                 04390009
044000         CONTINUE                                                 04400009
044100     ELSE                                                         04410009
044200         SET DP013-NO-ROLLBACK                                    04420009
044300             DP013-XCTL-DISPLAY-RESTART                           04430009
044400             DP013-CICS-ABEND      TO TRUE                        04440009
044500         MOVE 'BEFORE 0000-MAIN-MODULE'                           04450009
044600                                   TO DP013-PARAGRAPH             04460009
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04461042
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04462042
044900         MOVE DP030-RETURN-CODE                                   04490009
045000                                   TO DP013-MESSAGE-TEXT (3)      04500009
045100         PERFORM DP013-0000-PROCESS-ABEND                         04510009
045200     END-IF.                                                      04520009
045300 EJECT                                                            04530009
045400*----------------------------------------------------------------*04540009
045500*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04550009
045600*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04560009
045700*----------------------------------------------------------------*04570009
045800                                                                  04580009
045900 1000-CONTROL-PROCESSING.                                         04590009
046000                                                                  04600009
046100     EVALUATE TRUE                                                04610009
046200         WHEN DP020-NEXT-ACT-INITIAL                              04620009
046300         WHEN DP020-NEXT-ACT-RETURN                               04630009
046400             INITIALIZE ASC-SPECIFIC-COMMAREA                     04640009
046500             MOVE DP020-LOCATION-NBR TO                           04650009
046600                                    ASC-CURR-OPER-UNT-ID          04660009
046700                                    PV-CURR-OPER-UNT-HOLD         04670009
046800                                    ASC-KEY-OPER-UNT-ID           04680009
046900             MOVE 0001           TO ASC-CURR-FCLTY-ID             04690009
047000                                    ASC-KEY-FCLTY-ID              04700009
047100                                    PV-CURR-FCLTY-ID-HOLD         04710009
047200             PERFORM 4000-BUILD-INITIAL-PANEL                     04720009
047300                                                                  04730009
047400                                                                  04740009
047500         WHEN DP020-NEXT-ACT-READ-MAP                             04750009
047600             PERFORM 2000-FKEY-PROCESSING                         04760009
047700                                                                  04770009
047800         WHEN OTHER                                               04780009
047900             SET DP013-LOGIC-ABEND                                04790009
048000                 DP013-NO-ROLLBACK TO TRUE                        04800009
048100             MOVE '1000-CONTROL-PROCESSING'                       04810009
048200                                   TO  DP013-PARAGRAPH            04820009
048300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04830009
048400                                   TO  DP013-MESSAGE-TEXT(1)      04840009
048500             MOVE DP020-NEXT-APPL-ACTIVITY                        04850009
048600                                   TO DP013-MESSAGE-TEXT(2)       04860009
048700             PERFORM DP013-0000-PROCESS-ABEND                     04870009
048800     END-EVALUATE.                                                04880009
048900                                                                  04890009
049000*----------------------------------------------------------------*04900009
049100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04910009
049200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04920009
049300* EDITS.                                                         *04930009
049400*----------------------------------------------------------------*04940009
049500                                                                  04950009
049600 2000-FKEY-PROCESSING.                                            04960009
049700                                                                  04970009
049800     EVALUATE TRUE                                                04980009
049900                                                                  04990009
050000         WHEN DP020-SRC-AID = DP016-CLEAR                         05000009
050100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05010009
050200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05020009
050300                                                                  05030009
050400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05040009
050500             INITIALIZE ASC-SPECIFIC-COMMAREA                     05050009
050600             MOVE DP020-LOCATION-NBR TO                           05060009
050700                                    ASC-CURR-OPER-UNT-ID          05070009
050800                                    PV-CURR-OPER-UNT-HOLD         05080009
050900                                    ASC-KEY-OPER-UNT-ID           05090009
051000             MOVE  0001          TO ASC-CURR-FCLTY-ID-N           05100009
051100                                    ASC-KEY-FCLTY-ID              05110009
051200                                    PV-CURR-FCLTY-ID-HOLD         05120009
051300             PERFORM 4000-BUILD-INITIAL-PANEL                     05130009
051400             PERFORM 3200-RESET-ATTRIBUTES                        05140009
051500                                                                  05150009
051600         WHEN OTHER                                               05160009
051700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05170009
051800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05180009
051900             IF  PS-NO-ERROR                                      05190009
052000                 SET DP030-CONTINUE-GO TO TRUE                    05200009
052100                 PERFORM 2100-CHECK-FUNCTION-KEY                  05210009
052200             ELSE                                                 05220009
052300                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             05230009
052400                 SET DP030-OVERRIDE-GO TO TRUE                    05240009
052500             END-IF                                               05250009
052600     END-EVALUATE.                                                05260009
052700******************************************************************05270009
052800** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **05280009
052900** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **05290009
053000** FROM THE CICS ARCHITECTURE API.                              **05300009
053100******************************************************************05310009
053200 2100-CHECK-FUNCTION-KEY.                                         05320009
053300     EVALUATE TRUE                                                05330009
053400*************                                                     05340009
053500*F13 ADDTRLR                                                      05350009
053600*************                                                     05360009
053700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05370009
053800           PERFORM 3400-SELECT-TCNTRID                            05380009
053900            IF PS-ADD-TRAILER                                     05390009
054000              PERFORM 3150-VALIDATE-TRAILER-ID                    05400009
054100              IF PS-VALID-TRAILER-ID                              05410009
054200                PERFORM 3100-VALIDATE-SCAC-CDE                    05420009
054300                  IF PS-SCAC-EXISTS                               05430009
054400                    MOVE ASC-SCAC-NAME   TO CNSCDSO               05440009
054500                    MOVE ASC-TRAILER-SERIAL-NBR-N                 05450009
054600                                  TO PV-TRAILER-SERIAL-NBR        05460009
054700                 PERFORM 3300-INSERT-TCNTRID                      05470011
054800                    IF PS-SUCCESSFUL-ADD-TCNTRID                  05480009
054900                      MOVE PC-TSYMSG-02591    TO DP020-MSG-NUMBER 05490009
055000                      MOVE -1                 TO CNTRLRL          05500009
055100                      SET   DP020-MSG-INFORMATIONAL  TO TRUE      05510009
055200                      SET DP030-SET-CURSOR-APPL-1                 05520009
055300                                             TO TRUE              05530009
055400                      SET DP030-OVERRIDE-GO TO TRUE               05540009
055500                    ELSE                                          05550009
055600                    IF PS-UNSUCCESSFUL-ADD-TCNTRID                05560009
055700                      MOVE PC-TSYMSG-02753    TO DP020-MSG-NUMBER 05570009
055800                      MOVE -1                 TO CNTRLRL          05580009
055900                      MOVE DP015-RED          TO CNTRLRC          05590009
056000                      MOVE DP015-REVERSE      TO CNTRLRH          05600009
056100                      SET   DP020-MSG-INFORMATIONAL  TO TRUE      05610009
056200                      SET DP030-SET-CURSOR-APPL-1                 05620009
056300                                             TO TRUE              05630009
056400                      SET DP030-OVERRIDE-GO TO TRUE               05640009
056500                    ELSE                                          05650009
056600                      MOVE PC-TSYMSG-02613    TO DP020-MSG-NUMBER 05660009
056700                      MOVE -1                 TO CNTRLRL          05670009
056800                      SET   DP020-MSG-FATAL          TO TRUE      05680009
056900                      SET DP030-SET-CURSOR-APPL-1                 05690009
057000                                             TO TRUE              05700009
057100                      SET DP030-OVERRIDE-GO TO TRUE               05710009
057200                    END-IF                                        05720009
057300                    END-IF                                        05730033
057400                  ELSE                                            05740009
057500                    INITIALIZE CN008-INTER-APPL-COMMAREA          05750009
057600                        SET PS-ERROR                              05760009
057700                            DP020-MSG-FATAL  TO TRUE              05770009
057800                        MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER  05780009
057900                        MOVE DP015-UNP-ALP-BRT-OFF                05790009
058000                                             TO CNSCACA           05800009
058100                        MOVE DP015-RED       TO CNSCACC           05810009
058200                        MOVE DP015-REVERSE   TO CNSCACH           05820009
058300                        MOVE -1              TO CNSCACL           05830009
058400                        SET DP030-SET-CURSOR-APPL-1               05840009
058500                                             TO TRUE              05850009
058600                        SET DP030-OVERRIDE-GO TO TRUE             05860009
058700                  END-IF                                          05870009
058800               END-IF                                             05880009
058900            ELSE                                                  05890009
059000                    INITIALIZE CN008-INTER-APPL-COMMAREA          05900009
059100                        SET PS-ERROR                              05910009
059200                            DP020-MSG-FATAL  TO TRUE              05920009
059300                        MOVE PC-TSYMSG-02607 TO DP020-MSG-NUMBER  05930009
059400                        MOVE DP015-UNP-ALP-BRT-OFF                05940009
059500                                             TO CNVEIDA           05950009
059600                        MOVE DP015-RED       TO CNVEIDC           05960009
059700                        MOVE DP015-REVERSE   TO CNVEIDH           05970009
059800                        MOVE -1              TO CNVEIDL           05980009
059900                        SET DP030-SET-CURSOR-APPL-1               05990009
060000                                             TO TRUE              06000009
060100                        SET DP030-OVERRIDE-GO TO TRUE             06010009
060200            END-IF                                                06020009
060300                                                                  06030009
060400*************                                                     06040009
060500*F14 CURRSCAC                                                     06050009
060600*************                                                     06060009
060700         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              06070009
060800             CONTINUE                                             06080009
060900                                                                  06090009
060910*--------------------------------------------------------------   06091033
060920* F15 UPDATE                                                      06092033
060921* ADDED - DMH 7/6/2018                                            06092133
060922*--------------------------------------------------------------   06092233
060940         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              06094033
060950              PERFORM 2110-PREPARE-INTER-APPL-COMM                06095033
060960                                                                  06096033
061000*************                                                     06100009
061100*F17 TRLRLIST                                                     06110009
061200*************                                                     06120009
061300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06130009
061400                    PERFORM 2110-PREPARE-INTER-APPL-COMM          06140009
061500                                                                  06150009
061600*******************************                                   06160009
061700* F18 - PRINT LABELS (PCKCS707)                                   06170009
061800*******************************                                   06180009
061900                                                                  06190009
062000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06200009
062100             PERFORM 4700-FILL-PCWS140                            06210009
062200             PERFORM 4800-LINK-TO-PCKCS707                        06220009
062300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06230009
062400*                                                                 06240009
062500*************                                                     06250009
062600*F19 ASGN/PRT                                                     06260009
062700*************                                                     06270009
062800         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              06280009
062900            PERFORM 3400-SELECT-TCNTRID                           06290009
063000               IF PS-ADD-TRAILER                                  06300009
063100                  PERFORM 3250-AUTO-ASSIGN-TCNTRID                06310009
063200                      UNTIL PS-SUCCESSFUL-ADD-TCNTRID             06320009
063300                  PERFORM 4700-FILL-PCWS140                       06330009
063400                  PERFORM 4800-LINK-TO-PCKCS707                   06340009
063500                  IF PS-NO-ERROR                                  06350009
063600                      SET   DP020-MSG-INFORMATIONAL  TO TRUE      06360009
063700                      MOVE -1              TO CNSCACL             06370009
063800                      MOVE PC-TSYMSG-02593 TO DP020-MSG-NUMBER    06380009
063900                  END-IF                                          06390009
064000                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            06400009
064100               ELSE                                               06410009
064200                    INITIALIZE CN008-INTER-APPL-COMMAREA          06420009
064300                        SET PS-ERROR                              06430009
064400                            DP020-MSG-FATAL  TO TRUE              06440009
064500                        MOVE PC-TSYMSG-02607 TO DP020-MSG-NUMBER  06450009
064600                        MOVE -1              TO CNVEIDL           06460009
064700                        MOVE DP015-UNP-ALP-BRT-OFF                06470009
064800                                             TO CNVEIDA           06480009
064900                        MOVE DP015-RED       TO CNVEIDC           06490009
065000                        MOVE DP015-REVERSE   TO CNVEIDH           06500009
065100                        SET DP030-SET-CURSOR-APPL-1               06510009
065200                                             TO TRUE              06520009
065300                        SET DP030-OVERRIDE-GO TO TRUE             06530009
065400             END-IF                                               06540009
065500********                                                          06550009
065600* ENTER                                                           06560009
065700********                                                          06570009
065800         WHEN DP020-SRC-AID = DP016-ENTER                         06580009
065810              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  06581039
065900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06590039
066000              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 06600039
066100              MOVE -1                   TO CNSCACL                06610039
066200                                                                  06620033
066300         WHEN OTHER                                               06630033
066400             SET DP013-NO-ROLLBACK                                06640033
066500                 DP013-XCTL-DISPLAY-RESTART                       06650033
066600                 DP013-CICS-ABEND  TO TRUE                        06660033
066700             MOVE '2100-CHECK-FUNCTION-KEY'                       06670033
066800                                   TO DP013-PARAGRAPH             06680033
066900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06690033
067000                                   TO DP013-MESSAGE-TEXT (1)      06700033
067100             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 06710033
067200                                   TO DP013-MESSAGE-TEXT (2)      06720033
067300             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                06730033
067400             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 06740033
067500                                   TO PM-A-FK-ACTION              06750033
067600             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              06760033
067700                                   TO PM-A-FK-DISPN               06770033
067800             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      06780033
067900             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        06790033
068000                                   TO DP013-MESSAGE-TEXT (4)      06800033
068100             PERFORM DP013-0000-PROCESS-ABEND                     06810033
068200     END-EVALUATE.                                                06820033
068300                                                                  06830033
068400******************************************************************06840033
068500** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06850033
068600** INTER-APPLICATION COMMAREA.                                  **06860033
068700******************************************************************06870033
068800 2110-PREPARE-INTER-APPL-COMM.                                    06880033
068900     INITIALIZE CN008-INTER-APPL-COMMAREA.                        06890033
069000     MOVE ASC-KEY-OPER-UNT-ID          TO CN008-OPER-UNT-ID.      06900033
069100     MOVE ASC-KEY-FCLTY-ID             TO CN008-FCLTY-ID.         06910033
069200     MOVE ASC-FCLTY-NME                TO CN008-FCLTY-NME.        06920033
069300     MOVE ASC-SCAC-CDE                 TO CN008-SCAC.             06930033
069400     MOVE ASC-SCAC-NAME                TO CN008-SCAC-NAME.        06940033
069500     MOVE ASC-TRAILER-ID               TO CN008-TRLR-ID.          06950033
069600     MOVE ASC-TRAILER-SERIAL-NBR       TO CN008-TRLR-SRL-NBR.     06960033
069700     MOVE ASC-TRLR-LENGTH-N            TO CN008-TRLR-LENGTH.      06970033
069800     MOVE ASC-PRINTER-ID               TO CN008-PRINTER-ID.       06980033
069900/                                                                 06990033
070000*----------------------------------------------------------------*07000033
070100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*07010033
070200* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *07020033
070300* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *07030033
070400*----------------------------------------------------------------*07040033
070500                                                                  07050033
070600 2200-MOVE-SCREEN-TO-COMMAREA.                                    07060033
070700                                                                  07070033
070800     IF CNSCACL > ZERO                                            07080033
070900         MOVE CNSCACI              TO ASC-SCAC-CDE                07090033
071000     ELSE                                                         07100033
071100         IF CNSCACF = DP015-ERASE-EOF                             07110033
071200             MOVE SPACES           TO ASC-SCAC-CDE                07120033
071300         END-IF                                                   07130033
071400     END-IF.                                                      07140033
071500                                                                  07150033
071600     IF  CNVEIDL > ZERO                                           07160033
071700         MOVE CNVEIDI               TO ASC-TRAILER-ID             07170033
071800     ELSE                                                         07180033
071900         IF CNVEIDF = DP015-ERASE-EOF                             07190033
072000             MOVE SPACES           TO ASC-TRAILER-ID              07200033
072100         END-IF                                                   07210033
072200     END-IF.                                                      07220033
072300                                                                  07230033
072400     IF  CNTRLRL   > ZERO                                         07240033
072500         MOVE CNTRLRI                TO ASC-TRAILER-SERIAL-NBR    07250033
072600*        MOVE ASC-TRAILER-SERIAL-NBR TO ASC-TRAILER-SERIAL-NBR-N  07260033
072700                                                                  07270033
072800     ELSE                                                         07280033
072900         IF  CNTRLRF = DP015-ERASE-EOF                            07290033
073000             MOVE ZERO             TO ASC-TRAILER-SERIAL-NBR      07300033
073100         END-IF                                                   07310033
073200     END-IF.                                                      07320033
073300                                                                  07330033
073400     IF  CNLNGTHL  > ZERO                                         07340033
073500         MOVE CNLNGTHI             TO ASC-TRLR-LENGTH             07350033
073600     ELSE                                                         07360033
073700         IF  CNLNGTHF = DP015-ERASE-EOF                           07370033
073800             MOVE ZERO             TO ASC-TRLR-LENGTH             07380033
073900         END-IF                                                   07390033
074000     END-IF.                                                      07400033
074100                                                                  07410033
074200     IF  CNPRTIDL   > ZERO                                        07420033
074300         MOVE CNPRTIDI             TO ASC-PRINTER-ID              07430033
074400     ELSE                                                         07440033
074500         IF  CNPRTIDF = DP015-ERASE-EOF                           07450033
074600             MOVE SPACES           TO ASC-PRINTER-ID              07460033
074700         END-IF                                                   07470033
074800     END-IF.                                                      07480033
074900                                                                  07490033
075000                                                                  07500033
075100                                                                  07510033
075200****************************************************************  07520033
075300*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  07530033
075400*                                                              *  07540033
075500****************************************************************  07550033
075600                                                                  07560033
075700 2290-GET-DC-LOCATION.                                            07570033
075800                                                                  07580033
075900     INITIALIZE XL071-COMMAREA.                                   07590033
076000     MOVE  DP020-LOCATION-NBR TO XL071-LOCATION-NUMBER.           07600033
076100                                                                  07610033
076200     CALL XL071-LOCATION-MODULE USING                             07620033
076300                                DFHEIBLK                          07630033
076400                                XL071-COMMAREA                    07640033
076500                                XL071-COMMAREA-REC.               07650033
076600                                                                  07660033
076700     EVALUATE TRUE                                                07670033
076800         WHEN XL071-NO-ERRORS                                     07680033
076900              MOVE XL071-LOC-5-ABBR-NM TO PV-DC-5-CHAR-ABBR       07690033
077000              IF XL071-LOC-TYP-CDE = 'DC'                         07700033
077100                 MOVE PV-2-DIGIT-DC-ABBR  TO PC140-CRA-DC-ID      07710033
077200                 MOVE DK-CURR-OPER-UNT-ID TO                      07720033
077300                                       PC140-CRA-OPER-UNT-ID      07730033
077400              ELSE                                                07740033
077500                 MOVE  PC-90   TO  PC140-CRA-DC-ID                07750033
077600                                   PC140-CRA-OPER-UNT-ID          07760033
077700              END-IF                                              07770033
077800                                                                  07780033
077900         WHEN XL071-LOC-NOT-FOUND                                 07790033
078000         WHEN XL071-DC-ASGMT-NOT-FND                              07800033
078100              MOVE  PC-90   TO  PC140-CRA-DC-ID                   07810033
078200                                PC140-CRA-OPER-UNT-ID             07820033
078300                                                                  07830033
078400         WHEN OTHER                                               07840033
078500              MOVE '2290-GET-DC-LOCATION'                         07850033
078600                              TO DP013-PARAGRAPH                  07860033
078700              STRING 'SELECT STORE NUMBER - '                     07870033
078800                      XL071-LOCATION-NUMBER                       07880033
078900                     ' - BAD RETURN CODE FROM XLKUT071 - '        07890033
079000                      XL071-RETURN-CODE                           07900033
079100                      DELIMITED BY SIZE                           07910033
079200                      INTO DP013-MESSAGE-TEXT (1)                 07920033
079300              STRING 'SQLCODE - '                                 07930033
079400                      XL071-SQLCODE                               07940033
079500                     ' - '                                        07950033
079600                      XL071-DB2-TABLE                             07960033
079700                      DELIMITED BY SIZE                           07970033
079800                      INTO DP013-MESSAGE-TEXT (2)                 07980033
079900              MOVE XL071-SQLCA     TO DP013-SQLCA                 07990033
080000              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    08000033
080100              MOVE PC140-CRA-DC-ID                                08010033
080200                              TO DP013-MESSAGE-TEXT(3)            08020033
080300              MOVE XL071-SQLCODE TO SQLCODE                       08030033
080400              SET DP013-DB2-ABEND                                 08040033
080500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              08050033
080600              PERFORM DP013-0000-PROCESS-ABEND                    08060033
080700                                                                  08070033
080800     END-EVALUATE.                                                08080033
080900                                                                  08090033
081000                                                                  08100033
081100*----------------------------------------------------------------*08110033
081200* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *08120033
081300* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *08130033
081400* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*08140033
081500* IN THE DESTINATION PROGRAM, NOT HERE.                          *08150033
081600*----------------------------------------------------------------*08160033
081700 3000-EDIT-DATA-IN-COMMAREA.                                      08170033
081800*                                                                 08180033
081900     PERFORM 3200-RESET-ATTRIBUTES.                               08190033
082000*                                                                 08200033
082100*******************************                                   08210033
082200* SCAC CODE EDITS                                                 08220033
082300*******************************                                   08230033
082400*                                                                 08240033
082500        IF ASC-SCAC-CDE > SPACES                                  08250033
082600           MOVE ASC-SCAC-CDE          TO DK-SCAC-CDE              08260033
082700           PERFORM 3100-VALIDATE-SCAC-CDE                         08270033
082800             IF PS-SCAC-DOESNT-EXIST                              08280033
082900               SET  PS-ERROR                                      08290033
083000                 DP020-MSG-FATAL       TO TRUE                    08300033
083100                 MOVE PC-TSYMSG-02609  TO DP020-MSG-NUMBER        08310033
083200                 MOVE DP015-UNP-ALP-BRT-OFF                       08320033
083300                                       TO CNSCACA                 08330033
083400                 MOVE DP015-RED        TO CNSCACC                 08340033
083500                 MOVE DP015-REVERSE    TO CNSCACH                 08350033
083600                 MOVE -1               TO CNSCACL                 08360033
083700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08370033
083800             ELSE                                                 08380033
083900                 CONTINUE                                         08390033
084000        ELSE                                                      08400033
084100            IF DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)             08410033
084200               OR DP020-SRC-AID = DP016-ENTER                     08420033
084300               CONTINUE                                           08430033
084400            ELSE                                                  08440033
084500            SET  PS-ERROR                                         08450033
084600                 DP020-MSG-FATAL       TO TRUE                    08460033
084700                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        08470033
084800                 MOVE DP015-UNP-ALP-BRT-OFF                       08480033
084900                                       TO CNSCACA                 08490033
085000                 MOVE DP015-RED        TO CNSCACC                 08500033
085100                 MOVE DP015-REVERSE    TO CNSCACH                 08510033
085200                 MOVE -1               TO CNSCACL                 08520033
085300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08530033
085400            END-IF                                                08540033
085500        END-IF.                                                   08550033
085600*                                                                 08560033
085700*******************************                                   08570033
085800* TRAILER ID EDITS                                                08580033
085900*******************************                                   08590033
086000*                                                                 08600033
086100     EVALUATE TRUE                                                08610033
086200        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08620033
086300*       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)               08630033
086400        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               08640033
086500        WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)               08650033
086510        WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               08651033
086520        WHEN DP020-SRC-AID = DP016-ENTER                          08652038
086600                                                                  08660033
086700        IF ASC-TRAILER-ID  > SPACES                               08670033
086800            CONTINUE                                              08680033
086900        ELSE                                                      08690033
087000            SET  PS-ERROR                                         08700033
087100                 DP020-MSG-FATAL       TO TRUE                    08710033
087200                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        08720033
087300                 MOVE DP015-UNP-ALP-BRT-OFF                       08730033
087400                                       TO CNVEIDA                 08740033
087500                 MOVE DP015-RED        TO CNVEIDC                 08750033
087600                 MOVE DP015-REVERSE    TO CNVEIDH                 08760033
087700                 MOVE -1               TO CNVEIDL                 08770033
087800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08780033
087900        END-IF                                                    08790033
088000     END-EVALUATE.                                                08800033
088100*                                                                 08810033
088200*******************************                                   08820033
088300* TRAILER ID - LEADING SPACES                                     08830033
088400*******************************                                   08840033
088500*                                                                 08850033
088600     EVALUATE TRUE                                                08860033
088700        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08870033
088800        WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)               08880033
088810        WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               08881033
088900        WHEN DP020-SRC-AID      =  DP016-ENTER                    08890033
089000                                                                  08900033
089100            IF ASC-TRAILER-ID(1:1) = SPACES                       08910033
089200                SET  PS-ERROR                                     08920033
089210                     DP020-MSG-FATAL       TO TRUE                08921033
089220                MOVE PC-TSYMSG-03758   TO DP020-MSG-NUMBER        08922033
089230                MOVE DP015-UNP-ALP-BRT-OFF                        08923033
089240                                       TO CNVEIDA                 08924033
089250                MOVE DP015-RED         TO CNVEIDC                 08925033
089260                MOVE DP015-REVERSE     TO CNVEIDH                 08926033
089270                MOVE -1                TO CNVEIDL                 08927033
089280                SET DP030-SET-CURSOR-APPL-1                       08928033
089290                                       TO TRUE                    08929033
089291            ELSE                                                  08929133
089292                CONTINUE                                          08929233
089293            END-IF                                                08929333
089294                                                                  08929433
089295     END-EVALUATE.                                                08929533
089300*                                                                 08930009
089400*******************************                                   08940009
089500* TRAILER SERIAL NUMBER EDITS                                     08950009
089600*******************************                                   08960009
089700*                                                                 08970009
089800     EVALUATE TRUE                                                08980009
089900        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08990009
090000        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               09000009
090010        WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               09001033
090100        WHEN DP020-SRC-AID      =  DP016-ENTER                    09010009
090200                                                                  09020009
090300        IF ASC-TRAILER-SERIAL-NBR > SPACES                        09030009
090400           MOVE ASC-TRAILER-SERIAL-NBR-N  TO                      09040009
090500                                    DP010I-UNEDITED-FIELD         09050009
090600           MOVE LENGTH OF ASC-TRAILER-SERIAL-NBR                  09060009
090700                                     TO DP010I-MAXIMUM-DIGITS     09070009
090800*          MOVE ZERO                     TO DP010I-MAXIMUM-DECIMAL09080009
090900           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                09090009
263455           CALL DP010I-NUMERIC-EDIT-ROUTINE                       09101041
263455                USING DP010I-NUMERIC-EDIT-AREA                    09102041
091100           IF  DP010I-ERROR-DETECTED                              09110009
091200               SET PS-ERROR                                       09120009
091300                   DP020-MSG-FATAL       TO TRUE                  09130009
091400               MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER      09140009
091500               MOVE DP015-UNP-ALP-BRT-OFF                         09150009
091600                                         TO CNTRLRA               09160009
091700               MOVE DP015-RED            TO CNTRLRC               09170009
091800               MOVE DP015-REVERSE        TO CNTRLRH               09180009
091900               MOVE -1                   TO CNTRLRL               09190009
092000               SET DP030-SET-CURSOR-APPL-1 TO TRUE                09200009
092100           ELSE                                                   09210009
092200               MOVE DP010I-NUMERIC-FIELD                          09220009
092300                                     TO ASC-TRAILER-SERIAL-NBR-N  09230009
092400                                        PV-TRAILER-SERIAL-NBR     09240009
092500*              MOVE ASC-TRAILER-SERIAL-NBR-N  TO CNTRLRO          09250009
092600           END-IF                                                 09260009
092700        ELSE                                                      09270009
092800            IF DP020-SRC-AID      =  DP016-ENTER                  09280009
092900               CONTINUE                                           09290009
093000            ELSE                                                  09300009
093100            SET  PS-ERROR                                         09310009
093200                 DP020-MSG-FATAL       TO TRUE                    09320009
093300                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        09330009
093400                 MOVE DP015-UNP-ALP-BRT-OFF                       09340009
093500                                       TO CNTRLRA                 09350009
093600                 MOVE DP015-RED        TO CNTRLRC                 09360009
093700                 MOVE DP015-REVERSE    TO CNTRLRH                 09370009
093800                 MOVE -1               TO CNTRLRL                 09380009
093900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09390009
094000            END-IF                                                09400009
094100        END-IF                                                    09410009
094200     END-EVALUATE                                                 09420009
094300*                                                                 09430009
094400***************************************************************** 09440009
094500* IF ONLY TRAILER SERIAL NUMBER IS ENTERED POPULATE REST OF DATA  09450009
094600* FROM TCNTRID.                                                   09460009
094700***************************************************************** 09470009
094800*                                                                 09480009
094900     EVALUATE TRUE                                                09490009
095000        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               09500009
095010        WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               09501033
095020        WHEN DP020-SRC-AID = DP016-ENTER                          09502038
095200                                                                  09520009
095300      IF   PS-NO-ERROR                                            09530009
095400        IF ASC-TRAILER-SERIAL-NBR > SPACES  AND                   09540009
095500           ASC-SCAC-CDE           = SPACES  AND                   09550009
095600           ASC-TRAILER-ID         = SPACES                        09560009
095700           PERFORM 3500-SELECT-SCAC-AND-TRAILERID                 09570009
095800           IF PS-NO-SCAC-TRAILERID                                09580009
095900             SET PS-ERROR                                         09590009
096000                 DP020-MSG-FATAL       TO TRUE                    09600009
096100                 MOVE PC-TSYMSG-02613  TO DP020-MSG-NUMBER        09610009
096200                 MOVE DP015-UNP-ALP-BRT-OFF                       09620009
096300                                       TO CNTRLRA                 09630009
096400                 MOVE DP015-RED        TO CNTRLRC                 09640009
096500                 MOVE DP015-REVERSE    TO CNTRLRH                 09650009
096600                 MOVE -1               TO CNTRLRL                 09660009
096700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09670009
096800           ELSE                                                   09680009
096900                 MOVE PV-SCAC-CDE      TO ASC-SCAC-CDE            09690009
097000                 MOVE PV-TRLR-ID       TO ASC-TRAILER-ID          09700009
097010                 MOVE CNTRID-TRLR-SIZE-MU                         09701034
097020                                       TO ASC-TRLR-LENGTH-N       09702034
097100        END-IF                                                    09710009
097200       END-IF                                                     09720009
097300      END-IF                                                      09730009
097400     END-EVALUATE.                                                09740009
097500*                                                                 09750009
097600***************************************************************** 09760009
097700* IF ONLY SCAC AND TRAILER IS ENTERED POPULATE THE SERIAL NUMBER  09770009
097800* FROM TCNTRID.                                                   09780009
097900***************************************************************** 09790009
098000*                                                                 09800009
098100     EVALUATE TRUE                                                09810009
098200        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               09820009
098210        WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               09821033
098220        WHEN DP020-SRC-AID = DP016-ENTER                          09822038
098400                                                                  09840009
098500      IF   PS-NO-ERROR                                            09850009
098600        IF (ASC-TRAILER-SERIAL-NBR   = SPACES  OR                 09860040
098610            ASC-TRAILER-SERIAL-NBR-N = ZEROES)  AND               09861040
098700           ASC-SCAC-CDE           > SPACES  AND                   09870009
098800           ASC-TRAILER-ID         > SPACES                        09880009
098900           PERFORM 3510-SELECT-TRAILER-SERIAL-NBR                 09890009
099000       END-IF                                                     09900009
099100      END-IF                                                      09910009
099200     END-EVALUATE.                                                09920009
099300*                                                                 09930009
099400*******************************                                   09940009
099500* PRINTER ID EDITS                                                09950009
099600*******************************                                   09960009
099700*                                                                 09970009
099800     EVALUATE TRUE                                                09980009
099900        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               09990009
100000        WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)               10000009
100100        WHEN DP020-SRC-AID = DP016-ENTER                          10010009
100200                                                                  10020009
100300        IF ASC-PRINTER-ID  > SPACES                               10030009
100400            PERFORM 3080-VALIDATE-PRINTER                         10040009
100500        ELSE                                                      10050009
100600            IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR        10060009
100700                DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)            10070009
100800                SET  PS-ERROR                                     10080009
100900                     DP020-MSG-FATAL       TO TRUE                10090009
101000                     MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER    10100009
101100                     MOVE DP015-UNP-ALP-BRT-OFF TO CNPRTIDA       10110009
101200                     MOVE DP015-RED        TO CNPRTIDC            10120009
101300                     MOVE DP015-REVERSE    TO CNPRTIDH            10130009
101400                     MOVE -1               TO CNPRTIDL            10140009
101500                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          10150009
101600            END-IF                                                10160009
101700        END-IF                                                    10170009
101800     END-EVALUATE.                                                10180009
101900*                                                                 10190009
102000*******************************                                   10200009
102100* TRAILER LENGTH EDITS                                            10210009
102200*******************************                                   10220009
102300*                                                                 10230009
102400     EVALUATE TRUE                                                10240009
102500        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               10250009
102600        WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)               10260009
102610        WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               10261040
102700        WHEN DP020-SRC-AID      =  DP016-ENTER                    10270009
102800                                                                  10280009
102900        IF ASC-TRLR-LENGTH   >  SPACES                            10290009
103000           MOVE ASC-TRLR-LENGTH      TO DP010I-UNEDITED-FIELD     10300009
103100           MOVE LENGTH OF ASC-TRLR-LENGTH                         10310009
103200                                     TO DP010I-MAXIMUM-DIGITS     10320009
103300           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                10330009
263455           CALL DP010I-NUMERIC-EDIT-ROUTINE                       10341041
263455                USING DP010I-NUMERIC-EDIT-AREA                    10342041
103500           IF  DP010I-ERROR-DETECTED                              10350009
103600               SET PS-ERROR                                       10360009
103700                   DP020-MSG-FATAL       TO TRUE                  10370009
103800               MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER      10380009
103900               MOVE DP015-UNP-ALP-BRT-OFF                         10390009
104000                                         TO CNLNGTHA              10400009
104100               MOVE DP015-RED            TO CNLNGTHC              10410009
104200               MOVE DP015-REVERSE        TO CNLNGTHH              10420009
104300               MOVE -1                   TO CNLNGTHL              10430009
104400               SET DP030-SET-CURSOR-APPL-1 TO TRUE                10440009
104500           ELSE                                                   10450009
104600               MOVE DP010I-NUMERIC-FIELD                          10460009
104700                                     TO ASC-TRLR-LENGTH-N         10470009
104800                                        PV-TRLR-LENGTH            10480009
104900           END-IF                                                 10490009
105000        END-IF                                                    10500009
105100     END-EVALUATE.                                                10510009
105200*                                                                 10520009
105300     EVALUATE TRUE                                                10530009
105400        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               10540009
105500        WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)               10550009
105600                                                                  10560009
105700        IF ASC-TRLR-LENGTH > SPACES  AND                          10570009
105800           ASC-TRLR-LENGTH > ZEROES                               10580009
105900            PERFORM 3090-VALIDATE-TRLR-LGTH                       10590009
106000            IF PS-VALID-TRLR-LGTH                                 10600009
106100                CONTINUE                                          10610009
106200            ELSE                                                  10620009
106300               SET PS-ERROR                                       10630009
106400                   DP020-MSG-FATAL       TO TRUE                  10640009
106500                   MOVE PC-TSYMSG-03552  TO DP020-MSG-NUMBER      10650009
106600                   MOVE DP015-UNP-ALP-BRT-OFF                     10660009
106700                                         TO CNLNGTHA              10670009
106800                   MOVE DP015-RED        TO CNLNGTHC              10680009
106900                   MOVE DP015-REVERSE    TO CNLNGTHH              10690009
107000                   MOVE -1               TO CNLNGTHL              10700009
107100                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            10710009
107200            END-IF                                                10720009
107300        ELSE                                                      10730009
107400            SET  PS-ERROR                                         10740009
107500                 DP020-MSG-FATAL       TO TRUE                    10750009
107600                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        10760009
107700                 MOVE DP015-UNP-ALP-BRT-OFF                       10770009
107800                                       TO CNLNGTHA                10780009
107900                 MOVE DP015-RED        TO CNLNGTHC                10790009
108000                 MOVE DP015-REVERSE    TO CNLNGTHH                10800009
108100                 MOVE -1               TO CNLNGTHL                10810009
108200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10820009
108300        END-IF                                                    10830009
108400     END-EVALUATE.                                                10840009
108500*                                                                 10850009
108600*                                                                 10860009
108700*----------------------------------------------------------------*10870009
108800*   3080-VALIDATE-PRINTER                                         10880009
108900* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                       10890009
109000*----------------------------------------------------------------*10900009
109100 3080-VALIDATE-PRINTER.                                           10910009
109200     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     10920009
109300     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 10930009
109400     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        10940009
109500     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     10950009
109600                                        DP072-FCLTY-ID.           10960009
109700     MOVE ASC-PRINTER-ID             TO DP072-PRINTER-ID          10970009
109800     MOVE PC-REPORT-PGM-1            TO DP072-RPT-PGM-NME         10980009
109900     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     10990009
110000     SET DP072-VALIDATE              TO TRUE.                     11000009
110100                                                                  11010009
110200     EXEC CICS                                                    11020009
110300          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  11030009
110400               COMMAREA (DP072-COMM-AREA)                         11040009
110500               RESP     (PV-CICS-RESPONSE)                        11050009
110600     END-EXEC                                                     11060009
110700                                                                  11070009
110800     EVALUATE TRUE                                                11080009
110900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11090009
111000           MOVE DP072-OPER-UNT-ID      TO ASC-CURR-OPER-UNT-ID    11100009
111100                                          DK-CURR-OPER-UNT-ID     11110009
111200                                          DK-OPER-UNT-ID-DISPLAY  11120009
111300           MOVE DP072-PRTR-LOC-DESC    TO ASC-PRTR-LOC-DESC       11130009
111400           MOVE DP072-FCLTY-ID         TO ASC-CURR-FCLTY-ID       11140009
111500                                          DK-CURR-FCLTY-ID        11150009
111600           MOVE DP072-PRTR-IP-ADDRESS  TO ASC-IP-ADDRESS          11160009
111700           MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                    11170009
111800                                       TO ASC-OS-RLSE-CDE         11180009
111900           MOVE DP072-PRTR-DATA-XFER-MODE-ID                      11190009
112000                                       TO ASC-XFER-MODE-ID        11200009
112100           PERFORM 2290-GET-DC-LOCATION                           11210009
112200         WHEN OTHER                                               11220009
112300            IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR        11230009
112400                DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)            11240009
112500                    SET PS-ERROR                                  11250009
112600                        DP020-MSG-FATAL       TO TRUE             11260009
112700                    MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER 11270009
112800                    MOVE DP015-UNP-ALP-BRT-OFF                    11280009
112900                                              TO CNPRTIDA         11290009
113000                    MOVE DP015-RED            TO CNPRTIDC         11300009
113100                    MOVE DP015-REVERSE        TO CNPRTIDH         11310009
113200                    MOVE -1                   TO CNPRTIDL         11320009
113300                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           11330009
113400            END-IF                                                11340009
113500     END-EVALUATE.                                                11350009
113600                                                                  11360009
113700     IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR               11370009
113800         DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                   11380009
113900         IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX           11390009
114000             SET  PS-ERROR                                        11400009
114100                  DP020-MSG-FATAL         TO TRUE                 11410009
114200             MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER     11420009
114300             MOVE DP015-UNP-ALP-BRT-OFF   TO CNPRTIDA             11430009
114400             MOVE DP015-RED               TO CNPRTIDC             11440009
114500             MOVE DP015-REVERSE           TO CNPRTIDH             11450009
114600             MOVE -1                      TO CNPRTIDL             11460009
114700             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 11470009
114800         END-IF                                                   11480009
114900                                                                  11490009
115000         IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A              11500009
115100             CONTINUE                                             11510009
115200         ELSE                                                     11520009
115300             SET  PS-ERROR                                        11530009
115400                  DP020-MSG-FATAL         TO TRUE                 11540009
115500             MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER     11550009
115600             MOVE DP015-UNP-ALP-BRT-OFF   TO CNPRTIDA             11560009
115700             MOVE DP015-RED               TO CNPRTIDC             11570009
115800             MOVE DP015-REVERSE           TO CNPRTIDH             11580009
115900             MOVE -1                      TO CNPRTIDL             11590009
116000             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 11600009
116100         END-IF                                                   11610009
116200     END-IF.                                                      11620009
116300                                                                  11630009
116400*----------------------------------------------------------------*11640009
116500*  CHECK THE TKRPRPM TABLE TO VERIFY THE TRAILER LENGTH          *11650009
116600*  ENTERED IS VALID.                                             *11660009
116700*----------------------------------------------------------------*11670009
116800 3090-VALIDATE-TRLR-LGTH.                                         11680009
116900     SET PS-NOT-VALID-TRLR-LGTH TO TRUE.                          11690009
117000     MOVE ASC-TRLR-LENGTH             TO PV-TRLR-LENGTH-NUM       11700009
117100                                                                  11710009
117200                                                                  11720009
117300     EXEC SQL                                                     11730009
117400        SELECT  FUNC_TXT                                          11740009
117500          INTO  :KRPRPM-FUNC-TXT                                  11750009
117600          FROM  TKRPRPM                                           11760009
117700         WHERE  LOC_ID             = 90                           11770009
117800           AND  INTFC_SYS_CDE      = 'KHL'                        11780009
117900           AND  FUNC_PRC_STAT_CDE  = 'AC'                         11790009
118000           AND  SYS_PRC_FUNC_CDE   = 'CNTLNG'                     11800009
118100     END-EXEC.                                                    11810009
118200                                                                  11820009
118300     EVALUATE TRUE                                                11830009
118400         WHEN SQLCODE = +0                                        11840009
118500              IF PV-TRLR-LENGTH-CHAR = KRPRPM-FUNC-TXT (1:2)      11850009
118600                                OR KRPRPM-FUNC-TXT (4:2)          11860009
118700                                OR KRPRPM-FUNC-TXT (7:2)          11870009
118800                                OR KRPRPM-FUNC-TXT (10:2)         11880009
118900                                OR KRPRPM-FUNC-TXT (13:2)         11890009
119000                                OR KRPRPM-FUNC-TXT (16:2)         11900009
119100                                OR KRPRPM-FUNC-TXT (19:2)         11910009
119200                                OR KRPRPM-FUNC-TXT (22:2)         11920009
119300                 SET PS-VALID-TRLR-LGTH TO TRUE                   11930009
119400              END-IF                                              11940009
119500                                                                  11950009
119600         WHEN SQLCODE = +100                                      11960009
119700             SET PS-NOT-VALID-TRLR-LGTH TO TRUE                   11970009
119800                                                                  11980009
119900         WHEN SQLWARN0 NOT = SPACES                               11990009
120000         WHEN SQLCODE < +0                                        12000009
120100         WHEN SQLCODE > +0                                        12010009
120200             MOVE '3090-VALIDATE-TRLR-LGTH'                       12020009
120300                             TO DP013-PARAGRAPH                   12030009
120400             MOVE 'SELECT FUNC_TXT'                               12040009
120500                             TO DP013-MESSAGE-TEXT (1)            12050009
120600             MOVE DK-SCAC-CDE TO DP013-MESSAGE-TEXT (2)           12060009
120700             MOVE SQLCA      TO DP013-SQLCA                       12070009
120800             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          12080009
120900             SET DP013-DB2-ABEND                                  12090009
121000                             TO TRUE                              12100009
121100             SET DP013-XCTL-DISPLAY-RESTART                       12110009
121200                             TO TRUE                              12120009
121300                                                                  12130009
121400             SET  PS-ERROR                                        12140009
121500              DP020-MSG-FATAL         TO TRUE                     12150009
121600         MOVE PC-TSYMSG-00005         TO DP020-MSG-NUMBER         12160009
121700         MOVE DP015-UNP-ALP-BRT-OFF   TO CNSCACA                  12170009
121800         MOVE DP015-RED               TO CNSCACC                  12180009
121900         MOVE DP015-REVERSE           TO CNSCACH                  12190009
122000         MOVE -1                      TO CNSCACL                  12200009
122100         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     12210009
122200                                                                  12220009
122300         PERFORM DP013-0000-PROCESS-ABEND                         12230009
122400     END-EVALUATE.                                                12240009
122500                                                                  12250009
122600                                                                  12260009
122700*----------------------------------------------------------------*12270009
122800*  CHECK THE EXTERNAL ENTERPRISE TABLE TO VERIFY THE SCAC CODE   *12280009
122900*  ENTERED IS VALID.                                             *12290009
123000*----------------------------------------------------------------*12300009
123100 3100-VALIDATE-SCAC-CDE.                                          12310009
123200                                                                  12320009
123300     EXEC SQL                                                     12330009
123400        SELECT  A.SCAC_CDE                                        12340009
123500             ,  B.ENT_NAME_DESC                                   12350009
123600          INTO :EXTENT-SCAC-CDE                                   12360009
123700             , :ENTNME-ENT-NAME-DESC                              12370009
123800          FROM  TEXTENT A                                         12380009
123900              , TENTNME B                                         12390009
124000         WHERE  A.SCAC_CDE    = :DK-SCAC-CDE                      12400009
124100           AND  A.CARRIER_IND = 'Y'                               12410009
124200           AND  A.ENT_ID      = B.ENT_ID                          12420009
124300           AND  B.TYPE_CDE    = '01'                              12430009
124400         WITH UR                                                  12440009
124500     END-EXEC.                                                    12450009
124600                                                                  12460009
124700     EVALUATE TRUE                                                12470009
124800         WHEN SQLCODE = +0                                        12480009
124900         WHEN SQLCODE = -811                                      12490009
125000             SET PS-SCAC-EXISTS        TO TRUE                    12500009
125100             MOVE ENTNME-ENT-NAME-DESC TO ASC-SCAC-NAME           12510009
125200                                                                  12520009
125300                                                                  12530009
125400         WHEN SQLCODE = +100                                      12540009
125500             SET PS-SCAC-DOESNT-EXIST TO TRUE                     12550009
125600                                                                  12560009
125700         WHEN SQLWARN0 NOT = SPACES                               12570009
125800         WHEN SQLCODE < +0                                        12580009
125900         WHEN SQLCODE > +0                                        12590009
126000             MOVE '3100-VALIDATE-SCAC-CDE'                        12600009
126100                             TO DP013-PARAGRAPH                   12610009
126200             MOVE 'SELECT SCAC CODE'                              12620009
126300                             TO DP013-MESSAGE-TEXT (1)            12630009
126400             MOVE DK-SCAC-CDE TO DP013-MESSAGE-TEXT (2)           12640009
126500             MOVE SQLCA      TO DP013-SQLCA                       12650009
126600             MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)          12660009
126700             SET DP013-DB2-ABEND                                  12670009
126800                             TO TRUE                              12680009
126900             SET DP013-XCTL-DISPLAY-RESTART                       12690009
127000                             TO TRUE                              12700009
127100                                                                  12710009
127200             SET  PS-ERROR                                        12720009
127300              DP020-MSG-FATAL         TO TRUE                     12730009
127400         MOVE PC-TSYMSG-00005         TO DP020-MSG-NUMBER         12740009
127500         MOVE DP015-UNP-ALP-BRT-OFF   TO CNSCACA                  12750009
127600         MOVE DP015-RED               TO CNSCACC                  12760009
127700         MOVE DP015-REVERSE           TO CNSCACH                  12770009
127800         MOVE -1                      TO CNSCACL                  12780009
127900         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     12790009
128000                                                                  12800009
128100             PERFORM DP013-0000-PROCESS-ABEND                     12810009
128200     END-EVALUATE.                                                12820009
128300                                                                  12830009
128400*----------------------------------------------------------------*12840009
128500*  CHECK TRAILER ID ENTERED ON SCREEN TO VERIFY IT IS GREATER    *12850009
128600*  THAN 10000000.                                                *12860009
128700*----------------------------------------------------------------*12870009
128800 3150-VALIDATE-TRAILER-ID.                                        12880009
128900                                                                  12890009
129000     IF ASC-TRAILER-SERIAL-NBR-N  < 1                             12900009
129100        MOVE PC-TSYMSG-00342        TO DP020-MSG-NUMBER           12910009
129200        MOVE -1                     TO CNTRLRL                    12920009
129300        MOVE DP015-RED              TO CNTRLRC                    12930009
129400        MOVE DP015-REVERSE          TO CNTRLRH                    12940009
129500        SET   DP020-MSG-FATAL       TO TRUE                       12950009
129600        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       12960009
129700        SET DP030-OVERRIDE-GO       TO TRUE                       12970009
129800     ELSE                                                         12980009
129900     IF ASC-TRAILER-SERIAL-NBR-N  > 099999999  AND                12990009
130000        ASC-TRAILER-SERIAL-NBR-N  < 300000001                     13000009
130100        SET PS-VALID-TRAILER-ID TO TRUE                           13010009
130200     ELSE                                                         13020009
130300        MOVE PC-TSYMSG-02624        TO DP020-MSG-NUMBER           13030009
130400        MOVE -1                     TO CNTRLRL                    13040009
130500        MOVE DP015-RED              TO CNTRLRC                    13050009
130600        MOVE DP015-REVERSE          TO CNTRLRH                    13060009
130700        SET   DP020-MSG-FATAL       TO TRUE                       13070009
130800        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       13080009
130900        SET DP030-OVERRIDE-GO       TO TRUE                       13090009
131000     END-IF                                                       13100009
131100     END-IF.                                                      13110009
131200*                                                                 13120009
131300******************************************************************13130009
131400** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **13140009
131500** MAP.                                                         **13150009
131600******************************************************************13160009
131700 3200-RESET-ATTRIBUTES.                                           13170009
131800     MOVE DP015-UNP-ALP-NOR-OFF    TO CNSCACA                     13180009
131900                                      CNVEIDA                     13190009
132000                                      CNTRLRA                     13200009
132100                                      CNPRTIDA                    13210009
132200                                      CNLNGTHA.                   13220009
132300     MOVE DP015-GREEN              TO CNSCACC                     13230009
132400                                      CNVEIDC                     13240009
132500                                      CNTRLRC                     13250009
132600                                      CNPRTIDC                    13260009
132700                                      CNLNGTHC.                   13270009
132800     MOVE DP015-UNDERLINE          TO CNSCACH                     13280009
132900                                      CNVEIDH                     13290009
133000                                      CNTRLRH                     13300009
133100                                      CNPRTIDH                    13310009
133200                                      CNLNGTHH.                   13320009
133300     MOVE SPACES                   TO AMSGLNO.                    13330009
133400                                                                  13340009
133500*                                                                 13350009
133600******************************************************************13360009
133700** ADD AND AUTO ASSIGN A NUMBER FOR A TRAILER.                  **13370009
133800******************************************************************13380009
133900*                                                                 13390009
134000 3250-AUTO-ASSIGN-TCNTRID.                                        13400009
134100                                                                  13410009
134200     PERFORM 3370-CREATE-TRAILER-SERIAL-NBR.                      13420009
134300     MOVE ASC-TRAILER-SERIAL-NBR  TO PV-TRAILER-SERIAL-NBR.       13430013
134400                PERFORM 3300-INSERT-TCNTRID.                      13440020
134500*                                                                 13450009
134600******************************************************************13460009
134700*  3300-INSERT-TCNTRID.                                           13470009
134800******************************************************************13480009
134900 3300-INSERT-TCNTRID.                                             13490009
135000*                                                                 13500009
135100         EXEC SQL                                                 13510009
135200             INSERT INTO TCNTRID                                  13520009
135300                    ( SCAC_CDE,                                   13530009
135400                      TRLR_ID,                                    13540009
135500                      TRLR_SRL_NBR,                               13550009
135600                      TRLR_SIZE_MU)                               13560009
135700              VALUES                                              13570009
135800                    ( :ASC-SCAC-CDE,                              13580009
135900                      :ASC-TRAILER-ID,                            13590009
136000                      :PV-TRAILER-SERIAL-NBR,                     13600009
136100                      :PV-TRLR-LENGTH)                            13610009
136200         END-EXEC                                                 13620009
136300                                                                  13630009
136400         EVALUATE TRUE                                            13640009
136500             WHEN SQLCODE = ZERO                                  13650009
136600                 SET PS-SUCCESSFUL-ADD-TCNTRID  TO TRUE           13660009
136700                 MOVE PC-TSYMSG-02591    TO DP020-MSG-NUMBER      13670009
136800                 MOVE -1                 TO CNSCACL               13680009
136900             WHEN SQLCODE = -803                                  13690009
137000                 SET PS-UNSUCCESSFUL-ADD-TCNTRID  TO TRUE         13700009
137100             WHEN SQLWARN0 NOT = SPACES                           13710009
137200             WHEN SQLCODE < ZERO                                  13720009
137300             WHEN SQLCODE > ZERO                                  13730009
137400                 MOVE '3300-INSERT-TCNTRID'                       13740009
137500                                 TO DP013-PARAGRAPH               13750009
137600                 MOVE 'INCREASING TRAILER ID'                     13760009
137700                                 TO DP013-MESSAGE-TEXT (1)        13770009
137800                 MOVE SQLCA      TO DP013-SQLCA                   13780009
137900                 MOVE 'TCNTRID'  TO DP013-DB2-TABLE-NAME (1)      13790009
138000                 SET DP013-DB2-ABEND                              13800009
138100                                 TO TRUE                          13810009
138200                 SET DP013-XCTL-DISPLAY-RESTART                   13820009
138300                                 TO TRUE                          13830009
138400                 PERFORM 9990-WRITE-CICS                          13840009
138500         END-EVALUATE.                                            13850009
138600                                                                  13860009
138700*----------------------------------------------------------------*13870009
138800*  CREATE SOCKET TRANSACTION ID USING RANDOM NUMBER PROGRAM       13880009
138900*----------------------------------------------------------------*13890009
139000 3370-CREATE-TRAILER-SERIAL-NBR.                                  13900009
139100     CALL PC-RANDOM-PGM USING DFHEIBLK                            13910009
139200                              DFHCOMMAREA                         13920009
139300                              DP902-RANDNBR-ROUTINE-FIELDS.       13930009
139400                                                                  13940009
139500     IF DP902-SUCCESSFUL                                          13950009
139600         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          13960009
139700         MOVE PV-RANDOM-NUMBER       TO ASC-TRAILER-SERIAL-NBR    13970009
139800         IF ASC-TRAILER-SERIAL-NBR > 300000000                    13980009
139900            CONTINUE                                              13990009
140000         ELSE                                                     14000009
140100            ADD  300000000           TO  ASC-TRAILER-SERIAL-NBR-N 14010009
140200         END-IF                                                   14020009
140300                                                                  14030009
140400**THIS DISPLAY IS IN FOR TEST ONLY - BEGIN                        14040009
140500**       STRING ' PCKCS707 - '        DELIMITED BY SIZE           14050009
140600**              'RANDOM NUMBER - '    DELIMITED BY SIZE           14060009
140700**              PV-RANDOM-NUMBER      DELIMITED BY SIZE           14070009
140800**              ' LPMS-TRANS-ID - '   DELIMITED BY SIZE           14080009
140900**              PV-LPMS-TRANS-ID      DELIMITED BY SIZE           14090009
141000**                                    INTO PV-CICS-MSG-AREA       14100009
141100**       PERFORM 9990-WRITE-CICS                                  14110009
141200**THIS DISPLAY IS IN FOR TEST ONLY - END                          14120009
141300                                                                  14130009
141400     ELSE                                                         14140009
141500         SET  PS-INVALID-INPUT       TO TRUE                      14150009
141600         STRING  PC-RANDOM-PGM                                    14160009
141700                ' 4370-CREATE-TRANS-ID -'                         14170009
141800                ' ERROR GENERATING RANDOM'                        14180009
141900                ' NBR FOR LPMS TRANS ID'   DELIMITED BY SIZE      14190009
142000                                           INTO PV-CICS-MSG-AREA  14200009
142100         PERFORM 9990-WRITE-CICS                                  14210009
142200     END-IF.                                                      14220009
142300                                                                  14230009
142400*----------------------------------------------------------------*14240009
142500*  VALIDATE THAT THIS IS A NEW TRAILER BY PERFORMING A SELECT    *14250009
142600*  AGAINST TCNTRID FOR THE SCAC AND TRAILER ID ENTERED           *14260009
142700*----------------------------------------------------------------*14270009
142800 3400-SELECT-TCNTRID.                                             14280009
142900                                                                  14290009
143000     EXEC SQL                                                     14300009
143100          SELECT TRLR_ID                                          14310009
143110               , TRLR_SIZE_MU                                     14311034
143120               , TRLR_SRL_NBR                                     14312035
143200            INTO :CNTRID-TRLR-ID                                  14320009
143210               , :CNTRID-TRLR-SIZE-MU                             14321034
143220               , :CNTRID-TRLR-SRL-NBR                             14322035
143300          FROM   TCNTRID                                          14330009
143400          WHERE TRLR_ID       = :ASC-TRAILER-ID                   14340009
143500           AND  SCAC_CDE      = :ASC-SCAC-CDE                     14350009
143600     END-EXEC.                                                    14360009
143700                                                                  14370009
143800     EVALUATE TRUE                                                14380009
143900         WHEN SQLCODE = +0                                        14390009
144000         WHEN SQLCODE = -811                                      14400009
144100             SET PS-NO-ADD-TRAILER TO TRUE                        14410009
144110             MOVE CNTRID-TRLR-SRL-NBR  TO ASC-TRAILER-SERIAL-NBR  14411035
144120             MOVE CNTRID-TRLR-SIZE-MU  TO ASC-TRLR-LENGTH-N       14412035
144200                                                                  14420009
144300         WHEN SQLCODE = +100                                      14430009
144400             SET PS-ADD-TRAILER TO TRUE                           14440009
144500              CONTINUE                                            14450009
144600                                                                  14460009
144700         WHEN SQLWARN0 NOT = SPACES                               14470009
144800         WHEN SQLCODE < +0                                        14480009
144900         WHEN SQLCODE > +0                                        14490009
145000              MOVE '3050-VALIDATE-TRAILER'                        14500009
145100                              TO DP013-PARAGRAPH                  14510009
145200              MOVE 'UNSUCCESSFUL SELECT ON TCNTRID'               14520009
145300                              TO DP013-MESSAGE-TEXT (1)           14530009
145400              MOVE SQLCA      TO DP013-SQLCA                      14540009
145500              MOVE 'TCNTRID ' TO DP013-DB2-TABLE-NAME (1)         14550009
145600              SET DP013-DB2-ABEND                                 14560009
145700                  DP013-XCTL-DISPLAY-RESTART                      14570009
145800                              TO TRUE                             14580009
145900              PERFORM DP013-0000-PROCESS-ABEND                    14590009
146000     END-EVALUATE.                                                14600009
146100*                                                                 14610009
146200*----------------------------------------------------------------*14620009
146300*  SELECT SCAC AND TRAILER ID BASED ON TRAILER SERIAL NUMBER     *14630009
146400*  ENTERED                                                       *14640009
146500*----------------------------------------------------------------*14650009
146600 3500-SELECT-SCAC-AND-TRAILERID.                                  14660009
146700                                                                  14670009
146800     MOVE PV-TRAILER-SERIAL-NBR   TO DK-TRLR-SRL-NBR              14680009
146900                                                                  14690009
147000     EXEC SQL                                                     14700009
147100          SELECT SCAC_CDE                                         14710009
147200               , TRLR_ID                                          14720009
147210               , TRLR_SIZE_MU                                     14721034
147300            INTO :CNTRID-SCAC-CDE                                 14730009
147400               , :CNTRID-TRLR-ID                                  14740009
147410               , :CNTRID-TRLR-SIZE-MU                             14741034
147500          FROM   TCNTRID                                          14750009
147600          WHERE TRLR_SRL_NBR  = :DK-TRLR-SRL-NBR                  14760009
147700     END-EXEC.                                                    14770009
147800                                                                  14780009
147900     EVALUATE TRUE                                                14790009
148000         WHEN SQLCODE = +0                                        14800009
148100         WHEN SQLCODE = -811                                      14810009
148200              MOVE CNTRID-SCAC-CDE    TO PV-SCAC-CDE              14820009
148300                                         ASC-SCAC-CDE             14830009
148400                                         DK-SCAC-CDE              14840009
148500              MOVE CNTRID-TRLR-ID     TO PV-TRLR-ID               14850009
148600                                         ASC-TRAILER-ID           14860009
148610             MOVE CNTRID-TRLR-SIZE-MU  TO ASC-TRLR-LENGTH-N       14861037
148700              PERFORM 3100-VALIDATE-SCAC-CDE                      14870009
148800              SET PS-SCAC-TRAILERID TO TRUE                       14880009
148900                                                                  14890009
149000         WHEN SQLCODE = +100                                      14900009
149100             SET PS-NO-SCAC-TRAILERID TO TRUE                     14910009
149200                                                                  14920009
149300         WHEN SQLWARN0 NOT = SPACES                               14930009
149400         WHEN SQLCODE < +0                                        14940009
149500         WHEN SQLCODE > +0                                        14950009
149600              MOVE '3500-SELECT-SCAC-AND-TRAILERID'               14960009
149700                              TO DP013-PARAGRAPH                  14970009
149800              MOVE 'UNSUCCESSFUL SELECT ON TCNTRID'               14980009
149900                              TO DP013-MESSAGE-TEXT (1)           14990009
150000              MOVE SQLCA      TO DP013-SQLCA                      15000009
150100              MOVE 'TCNTRID ' TO DP013-DB2-TABLE-NAME (1)         15010009
150200              SET DP013-DB2-ABEND                                 15020009
150300                  DP013-XCTL-DISPLAY-RESTART                      15030009
150400                              TO TRUE                             15040009
150500              PERFORM DP013-0000-PROCESS-ABEND                    15050009
150600     END-EVALUATE.                                                15060009
150700*                                                                 15070009
150800*----------------------------------------------------------------*15080009
150900*  SELECT TRAILER SERIAL NBR BASED ON SCAC AND TRAILER ID        *15090009
151000*  ENTERED                                                       *15100009
151100*----------------------------------------------------------------*15110009
151200 3510-SELECT-TRAILER-SERIAL-NBR.                                  15120009
151300                                                                  15130009
151400     MOVE ASC-SCAC-CDE            TO DK-SCAC-CDE                  15140009
151500     MOVE ASC-TRAILER-ID          TO DK-TRLR-ID                   15150009
151600                                                                  15160009
151700     EXEC SQL                                                     15170009
151800          SELECT TRLR_SRL_NBR                                     15180009
151810               , TRLR_SIZE_MU                                     15181037
151900            INTO :CNTRID-TRLR-SRL-NBR                             15190009
151910               , :CNTRID-TRLR-SIZE-MU                             15191037
152000          FROM   TCNTRID                                          15200009
152100          WHERE SCAC_CDE      = :DK-SCAC-CDE                      15210009
152200            AND TRLR_ID       = :DK-TRLR-ID                       15220009
152300     END-EXEC.                                                    15230009
152400                                                                  15240009
152500     EVALUATE TRUE                                                15250009
152600         WHEN SQLCODE = +0                                        15260009
152700              MOVE CNTRID-TRLR-SRL-NBR  TO PV-TRAILER-SERIAL-NBR  15270009
152800                                           ASC-TRAILER-SERIAL-NBR 15280009
152810              MOVE CNTRID-TRLR-SIZE-MU  TO ASC-TRLR-LENGTH-N      15281037
152900                                                                  15290009
153000         WHEN SQLCODE = +100                                      15300009
153100             CONTINUE                                             15310009
153200                                                                  15320009
153300         WHEN SQLWARN0 NOT = SPACES                               15330009
153400         WHEN SQLCODE < +0                                        15340009
153500         WHEN SQLCODE > +0                                        15350009
153600              MOVE '3510-SELECT-TRAILER-SERIAL-NBR'               15360009
153700                              TO DP013-PARAGRAPH                  15370009
153800              MOVE 'UNSUCCESSFUL SELECT ON TCNTRID'               15380009
153900                              TO DP013-MESSAGE-TEXT (1)           15390009
154000              MOVE SQLCA      TO DP013-SQLCA                      15400009
154100              MOVE 'TCNTRID ' TO DP013-DB2-TABLE-NAME (1)         15410009
154200              SET DP013-DB2-ABEND                                 15420009
154300                  DP013-XCTL-DISPLAY-RESTART                      15430009
154400                              TO TRUE                             15440009
154500              PERFORM DP013-0000-PROCESS-ABEND                    15450009
154600     END-EVALUATE.                                                15460009
154700*                                                                 15470009
154800*----------------------------------------------------------------*15480009
154900*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *15490009
155000*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *15500009
155100*  IT HERE.                                                      *15510009
155200*----------------------------------------------------------------*15520009
155300 4000-BUILD-INITIAL-PANEL.                                        15530009
155400     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        15540009
155500     MOVE -1                       TO CNSCACL.                    15550009
155600                                                                  15560009
155700     MOVE SPACES                   TO CNTRLRO                     15570009
155800                                      CNSCACO                     15580009
155900                                      CNPRTIDO                    15590009
156000                                      CNVEIDO.                    15600009
156100     MOVE PV-CURR-OPER-FCLTY-HOLD  TO CNOPERO.                    15610009
156200     PERFORM 7000-GET-STORE-NAME                                  15620009
156300     MOVE ASC-FCLTY-NME             TO CNOPDSO.                   15630009
156400*                                                                 15640009
156500*----------------------------------------------------------------*15650009
156600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *15660009
156700*----------------------------------------------------------------*15670009
156800 4400-MOVE-COMMAREA-TO-SCREEN.                                    15680009
156900     MOVE ASC-CURR-OPER-UNT-ID      TO PV-CURR-OPER-UNT-HOLD.     15690009
157000     MOVE ASC-CURR-FCLTY-ID         TO PV-CURR-FCLTY-ID-HOLD.     15700009
157100     MOVE PV-CURR-OPER-FCLTY-HOLD   TO CNOPERO.                   15710009
157200     MOVE ASC-FCLTY-NME             TO CNOPDSO.                   15720009
157300     MOVE ASC-SCAC-CDE              TO CNSCACO.                   15730009
157400     MOVE ASC-SCAC-NAME             TO CNSCDSO.                   15740009
157500     MOVE ASC-PRINTER-ID            TO CNPRTIDO.                  15750009
157600     MOVE ASC-PRTR-LOC-DESC         TO CNPRTDSO.                  15760009
157700     MOVE ASC-TRAILER-ID            TO CNVEIDO.                   15770009
157800     MOVE ASC-TRAILER-SERIAL-NBR-N  TO CNTRLRO.                   15780009
157810     MOVE ASC-TRLR-LENGTH-N         TO CNLNGTHO.                  15781036
157900 EJECT                                                            15790009
158000*----------------------------------------------------------------*15800009
158100*----------------------------------------------------------------*15810009
158200* FILL IN THE NECESSARY FIELDS IN PCWS140.                        15820009
158300*----------------------------------------------------------------*15830009
158400 4700-FILL-PCWS140.                                               15840009
158500                                                                  15850009
158600     INITIALIZE PC140-TRLR-SERL-NBR-LBL.                          15860009
158700     SET PC140-TRAILER-SERIAL-LBL-NBR TO TRUE.                    15870009
158800     MOVE ASC-PRINTER-ID            TO PC140-TSN-PRTR-ID.         15880009
158900     MOVE DP020-USERID              TO PC140-TSN-USERID.          15890009
159000     MOVE ASC-CURR-OPER-UNT-ID      TO PC140-TSN-OPER-UNT-ID.     15900009
159100     MOVE ASC-SCAC-CDE              TO PC140-TSN-SCAC.            15910009
159200     MOVE ASC-TRAILER-ID            TO PC140-TSN-TRLR-ID.         15920009
159300     MOVE ASC-TRAILER-SERIAL-NBR-N  TO PC140-TSN-SERL-NBR.        15930009
159400     MOVE ASC-XFER-MODE-ID          TO PC140-TSN-XFER-MODE-ID.    15940009
159500     MOVE ASC-IP-ADDRESS            TO PC140-TSN-IP-ADDRESS.      15950009
159600     MOVE ASC-OS-RLSE-CDE           TO PC140-TSN-OS-RLSE-CDE.     15960009
159700                                                                  15970009
159800*----------------------------------------------------------------*15980009
159900* LINK TO THE LABEL PRINTING PROGRAM - PCKCS707                   15990009
160000*----------------------------------------------------------------*16000009
160100 4800-LINK-TO-PCKCS707.                                           16010009
160200                                                                  16020009
160300     MOVE 400  TO  PV-COMMAREA-LENGTH.                            16030009
160400                                                                  16040009
160500     EXEC CICS                                                    16050009
160600          LINK PROGRAM  ('PCKCS707')                              16060009
160700               COMMAREA (PC140-LABELMST)                          16070009
160800               LENGTH   (PV-COMMAREA-LENGTH)                      16080009
160900               RESP     (PV-CICS-RESPONSE)                        16090009
161000     END-EXEC.                                                    16100009
161100                                                                  16110009
161200     EVALUATE TRUE                                                16120009
161300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16130009
161400              CONTINUE                                            16140009
161500         WHEN OTHER                                               16150009
161600              SET PS-ERROR                TO TRUE                 16160009
161700              PERFORM DP013-0000-PROCESS-ABEND                    16170009
161800     END-EVALUATE.                                                16180009
161900     IF PC140-CRA-SOCKET-COMM-ERROR                               16190009
162000         SET PS-ERROR                TO TRUE                      16200009
162100         SET DP020-MSG-FATAL         TO TRUE                      16210009
162200         MOVE PC-TSYMSG-02611        TO DP020-MSG-NUMBER          16220009
162300         MOVE DP015-UNP-NUM-BRT-OFF  TO CNPRTIDA                  16230009
162400         MOVE -1                     TO CNPRTIDL                  16240009
162500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      16250009
162600     ELSE                                                         16260009
162700     IF PC140-CRA-INVALID-PRT-FMT                                 16270009
162800         SET PS-ERROR                TO TRUE                      16280009
162900         SET DP020-MSG-FATAL         TO TRUE                      16290009
163000         MOVE PC-TSYMSG-01422        TO DP020-MSG-NUMBER          16300009
163100         MOVE -1                     TO CNPRTIDL                  16310009
163200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      16320009
163300     ELSE                                                         16330009
163400         SET DP020-MSG-INFORMATIONAL TO TRUE                      16340009
163500         MOVE PC-TSYMSG-00098        TO DP020-MSG-NUMBER          16350009
163600         MOVE -1                     TO CNPRTIDL                  16360009
163700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      16370009
163800     END-IF.                                                      16380009
163900                                                                  16390009
164000                                                                  16400009
164100****************************************************************  16410009
164200*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  16420009
164300*                                                              *  16430009
164400****************************************************************  16440009
164500                                                                  16450009
164600 7000-GET-STORE-NAME.                                             16460009
164700                                                                  16470009
164800     INITIALIZE XL071-COMMAREA.                                   16480009
164900     MOVE ASC-KEY-OPER-UNT-ID TO XL071-LOCATION-NUMBER.           16490009
165000                                                                  16500009
165100     CALL XL071-LOCATION-MODULE USING                             16510009
165200                                DFHEIBLK                          16520009
165300                                XL071-COMMAREA                    16530009
165400                                XL071-COMMAREA-REC.               16540009
165500                                                                  16550009
165600     EVALUATE TRUE                                                16560009
165700         WHEN XL071-NO-ERRORS                                     16570009
165800         WHEN XL071-DC-ASGMT-NOT-FND                              16580009
165900              MOVE XL071-LOC-NM                                   16590009
166000                                TO ASC-FCLTY-NME                  16600009
166100                                                                  16610009
166200         WHEN XL071-LOC-NOT-FOUND                                 16620009
166300              MOVE SPACES     TO ASC-FCLTY-NME                    16630009
166400                                                                  16640009
166500         WHEN OTHER                                               16650009
166600              MOVE '7000-GET-STORE-NAME'                          16660009
166700                                  TO DP013-PARAGRAPH              16670009
166800              STRING 'SELECT STORE NUMBER - '                     16680009
166900                      XL071-LOCATION-NUMBER                       16690009
167000                     ' - BAD RETURN CODE FROM XLKUT071 - '        16700009
167100                      XL071-RETURN-CODE                           16710009
167200                      DELIMITED BY SIZE                           16720009
167300                      INTO DP013-MESSAGE-TEXT (1)                 16730009
167400              STRING 'SQLCODE - '                                 16740009
167500                      XL071-SQLCODE                               16750009
167600                     ' - '                                        16760009
167700                      XL071-DB2-TABLE                             16770009
167800                      DELIMITED BY SIZE                           16780009
167900                      INTO DP013-MESSAGE-TEXT (2)                 16790009
168000              MOVE XL071-SQLCA     TO DP013-SQLCA                 16800009
168100              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    16810009
168200              MOVE XL071-SQLCODE TO SQLCODE                       16820009
168300              SET DP013-DB2-ABEND                                 16830009
168400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              16840009
168500              PERFORM DP013-0000-PROCESS-ABEND                    16850009
168600                                                                  16860009
168700     END-EVALUATE.                                                16870009
168800                                                                  16880009
168900*----------------------------------------------------------------*16890009
169000 9990-WRITE-CICS.                                                 16900009
169100     MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     16910009
169200                                                                  16920009
169300     EXEC CICS WRITEQ TD                                          16930009
169400                      QUEUE('CSSL')                               16940009
169500                      FROM(PV-CICS-MSG-AREA)                      16950009
169600                      LENGTH(PV-COMMAREA-LENGTH)                  16960009
169700                      RESP (PV-CICS-RESPONSE)                     16970009
169800     END-EXEC.                                                    16980009
169900                                                                  16990009
170000     MOVE SPACES TO PV-CICS-MSG-AREA.                             17000009
170100*----------------------------------------------------------------*17010009
170200*    ABEND PROCESSOR MODULE                                      *17020009
170300*----------------------------------------------------------------*17030009
170400                                                                  17040009
170500     COPY DPPD013.                                                17050009
