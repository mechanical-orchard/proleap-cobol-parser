000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKRP120.                                         00020000
000300 AUTHOR.        NANCY EILBES.                                     00030000
000400 INSTALLATION.  KOHLS.                                            00040000
000500 DATE-WRITTEN   NOVEMBER 2003.                                    00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*  VENDOR BROADCAST/BRIDAL AGREEMENTS AND ACTIVITY REPORTS       *00080000
000810*                                                                *00081000
000820*  COBOL                                                         *00082000
000830*                                                                *00083000
000840*  THIS PROGRAM REPORTS PURCHASE AND ADJUSTMENT ACTIVITY ALONG   *00084000
000850*  WITH VENDOR BROADCAST/BRIDAL ALLOWANCE AGREEMENT INFO FOR     *00085000
000860*  A SPECIFIC TIME PERIOD.  THE DATA EXTRACT FOR THESE REPORTS   *00086000
000870*  IS DONE IN PROGRAM APKUT118.                                  *00087000
000880*----------------------------------------------------------------*00088000
000890* INPUT:                                                         *00089000
000900*  1. VENDOR ACTIVITY EXTRACT FILE            APRD081            *00090000
001000*  2. CONTROL CARD WITH EXTRACT DATES                            *00100000
001010*  3. CONTROL CARD WITH REPORT SUBHEADING                        *00101000
001020*                                                                *00102000
001030* OUTPUT:                                                        *00103000
001040*                                                                *00104000
001050*  1. BROADCAST AGREEMENTS ACTIVITY REPORT                       *00105000
001060*                                                                *00106000
001070*----------------------------------------------------------------*00107000
001080* CHANGE LOG:                                                    *00108000
001090*                                                                *00109000
001100* DATE  01/12/2004                                               *00110000
001200*   CHANGE MADE: INITIAL VERSION.                                *00120000
001300*   MADE BY: NANCY EILBES            WR/IR #: WR25421            *00130000
001400*                                                                *00140000
001410* DATE  04/29/2004                                               *00141000
001420*   CHANGE MADE: EXPANDED REPORT TO ADD ACCOUNTING ENTRY COLUMNS.*00142000
001430*   MODIFIED THE COLUMN ORDER PER USER REQUEST.                  *00143000
001440*   MADE BY: NANCY EILBES            WR/IR #: WR26677            *00144000
001450*                                                                *00145000
001460* DATE  05/13/2004                                               *00146000
001461*   CHANGE MADE: EXPANDED LINES PER PAGE TO 74 TO GO WITH THE    *00146100
001462*   NEW 200 WIDTH.  CHANGED LOGIC POPULATING THE VENDOR TOTAL TO *00146200
001463*   ONLY MOVE THE REVERSAL, OTP AND REPAY AMOUNTS IF THEY ARE    *00146300
001464*   NOT ZERO.  THIS CORRECTED A PROBLEM WHERE THE TOTALS WEREN'T *00146400
001465*   SHOWING WHEN THE LAST DEPARTMENT FOR A VENDOR HAD NO TOTALS. *00146500
001466*   MADE BY: NANCY EILBES            WR/IR #: WR26677            *00146600
001467*                                                                *00146700
001468* DATE  08/05/2004                                               *00146800
001469*     CHANGE MADE: EXPANDED 4 AMOUNT FIELDS ON DETAIL LINE TO    *00146900
001470*     PREVENT HIGH-ORDER TRUNCATION OF RECEIPTS, ETC.            *00147000
001471*     MADE BY: NANCY EILBES            WR/IR #: WR26677          *00147100
001472*                                                                *00147200
001473* DATE  10/21/2004                                               *00147300
001474*     CHANGE MADE: MODIFIED HANDLING OF ACT-EARNED AND VND-REPAY *00147400
001475*     COLUMNS FOR BROADCAST ('88').  THE INPUT WILL NOW HAVE     *00147500
001476*     DEPT DETAIL FOR THESE 2 FIELDS, SO THEY CAN BE PRINTED ON  *00147600
001477*     EACH DETAIL LINE AND NEED TO BE ADDED INTO VENDOR TOTALS.  *00147700
001478*     MADE BY: NANCY EILBES            WR/IR #: WR26677          *00147800
001479*                                                                *00147900
001480* DATE  01/12/2005                                               *00148002
001481*     CHANGE MADE: MODIFIED FORMAT OF VENDOR TOTAL LINE SO THAT  *00148102
001482*     VENDOR NAME ALIGNS UNDER SAME FIELD IN DETAIL LINE.  THIS  *00148202
001483*     CHANGE WILL MAKE THE TOTAL LINES MORE USABLE WHEN THESE    *00148302
001484*     REPORTS ARE IMPORTED INTO EXCEL.                           *00148402
001485*     MADE BY: NANCY EILBES            WR/IR #: WR26677          *00148502
001486*                                                                *00148602
001487* DATE  03/17/2006                                               *00148708
001488*     CHANGE MADE: HANDLE TRANCODE 5A IN SIMILAR FASHION AS 88   *00148803
001492*     MADE BY: GREG WISIALOWSKI        WR/IR #: WR29954          *00149203
001493*                                                                *00149303
001494******************************************************************00149403
001495 ENVIRONMENT DIVISION.                                            00149503
001496 CONFIGURATION SECTION.                                           00149603
001497 SOURCE-COMPUTER.        IBM-3090.                                00149703
001498 OBJECT-COMPUTER.        IBM-3090.                                00149803
001499                                                                  00149903
001500 INPUT-OUTPUT SECTION.                                            00150003
001501 FILE-CONTROL.                                                    00150103
001502                                                                  00150203
001503     SELECT ACTIVITY-EXTRACT-FILE        ASSIGN TO INP01.         00150303
001504     SELECT REPORT-FILE                  ASSIGN TO RPT01.         00150403
001510                                                                  00151003
001600 DATA DIVISION.                                                   00160000
001700 FILE SECTION.                                                    00170000
001800                                                                  00180000
001900 FD  ACTIVITY-EXTRACT-FILE                                        00190000
002000     RECORDING MODE IS F                                          00200000
002100     LABEL RECORDS ARE STANDARD                                   00210000
002200     BLOCK CONTAINS 0 RECORDS.                                    00220000
002300 01  ACTIVITY-EXTRACT-RECORD         PIC  X(250).                 00230000
002400                                                                  00240000
002500 FD  REPORT-FILE                                                  00250000
002600     RECORDING MODE IS F                                          00260000
002700     LABEL RECORDS ARE STANDARD                                   00270000
002800     BLOCK CONTAINS 0 RECORDS                                     00280000
002900     DATA RECORD IS REPORT-REC.                                   00290000
003000 01  REPORT-REC                  PIC  X(200).                     00300000
003100                                                                  00310000
003200 WORKING-STORAGE SECTION.                                         00320000
003300                                                                  00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-PROGRAM-NAME     PIC X(8)  VALUE 'APKRP120'.          00350000
003600                                                                  00360000
003700 01  PS-PROGRAM-SWITCHES.                                         00370000
003800     05  PS-END-OF-EXTRACT-SW        PIC X     VALUE 'N'.         00380000
003900         88  PS-END-OF-EXTRACT                 VALUE 'Y'.         00390000
004000                                                                  00400000
004100 01  CONTROL-CARD.                                                00410000
004200     05  CC-BEGIN-DTE            PIC X(10).                       00420000
004300     05  FILLER                  PIC X.                           00430000
004400     05  CC-END-DTE              PIC X(10).                       00440000
004500     05  FILLER                  PIC X(59).                       00450000
004600                                                                  00460000
004700 01  CONTROL-CARD-TWO.                                            00470000
004800     05  CC-SUBHEADING           PIC X(40).                       00480000
004900     05  FILLER                  PIC X.                           00490000
005000     05  CC-RPT-ALW-TYP          PIC X(9).                        00500000
005100     05  FILLER                  PIC X(30).                       00510000
005200                                                                  00520000
005300 01  PV-REPORT-CONTROLS.                                          00530000
005400     05  PV-LINE-COUNT           PIC S999       VALUE +0.         00540000
005500     05  PC-LINES-PER-PAGE-MAX   PIC S999       VALUE +78.        00550000
005510     05  PV-PAGE-COUNT           PIC S9(05)     VALUE +0.         00551000
005520                                                                  00552000
005530 01  PV-PROGRAM-VARIABLES.                                        00553000
005540     05  VN-GROSS-AMT                PIC S9(10)V99  VALUE ZERO.   00554000
005550     05  VN-GROSS-RTV-AMT            PIC S9(10)V99  VALUE ZERO.   00555000
005560     05  VN-GROSS-DSC-AMT            PIC S9(10)V99  VALUE ZERO.   00556000
005570     05  VN-GROSS-RTV-DSC-AMT        PIC S9(10)V99  VALUE ZERO.   00557000
005580     05  VN-EST-EARNED               PIC S9(08)V99  VALUE ZERO.   00558000
005590     05  VN-ACT-EARNED               PIC S9(08)V99  VALUE ZERO.   00559000
005600     05  VN-REVERSAL                 PIC S9(08)V99  VALUE ZERO.   00560000
005700     05  VN-VND-DED-AMT              PIC S9(08)V99  VALUE ZERO.   00570000
005800     05  VN-VND-REPAY-AMT            PIC S9(08)V99  VALUE ZERO.   00580000
005900     05  VN-DIFFERENCE               PIC S9(08)V99  VALUE ZERO.   00590000
006000     05  VN-DEPT-COUNT               PIC S9(4)      VALUE ZERO.   00600000
006100     05  TOT-GROSS-AMT               PIC S9(12)V99  VALUE ZERO.   00610000
006200     05  TOT-GROSS-RTV-AMT           PIC S9(12)V99  VALUE ZERO.   00620000
006300     05  TOT-GROSS-DSC-AMT           PIC S9(12)V99  VALUE ZERO.   00630000
006400     05  TOT-GROSS-RTV-DSC-AMT       PIC S9(12)V99  VALUE ZERO.   00640000
006500     05  TOT-EST-EARNED              PIC S9(10)V99  VALUE ZERO.   00650000
006600     05  TOT-ACT-EARNED              PIC S9(10)V99  VALUE ZERO.   00660000
006700     05  TOT-REVERSAL                PIC S9(10)V99  VALUE ZERO.   00670000
006800     05  TOT-VND-DEDUCT              PIC S9(10)V99  VALUE ZERO.   00680000
006900     05  TOT-VND-REPAY               PIC S9(10)V99  VALUE ZERO.   00690000
007000     05  TOT-DIFFERENCE              PIC S9(10)V99  VALUE ZERO.   00700000
007100     05  SAVE-DMA-NBR                PIC X(2)       VALUE SPACES. 00710000
007200     05  SAVE-VND-NBR                PIC X(9)       VALUE SPACES. 00720000
007300     05  SAVE-VENDOR-NAME            PIC X(30)      VALUE SPACES. 00730000
007400     05  SAVE-DEPT-NBR               PIC X(3)       VALUE SPACES. 00740000
007500     05  PV-DISCOUNT-PCT-EXPD        PIC 999V99     VALUE ZERO.   00750000
007600     05  PV-INPUT-EXTRACT-CNT        PIC 9(9)       VALUE ZERO.   00760000
007700                                                                  00770000
007800     05  PV-CURRENT-DATE.                                         00780000
007900         10  PV-CURRENT-CCYY.                                     00790000
008000             15  PV-CURRENT-CC     PIC  9(2)    VALUE ZEROES.     00800000
008100             15  PV-CURRENT-YEAR   PIC  9(2)    VALUE ZEROES.     00810000
008200         10  PV-CURRENT-MONTH      PIC  9(2)    VALUE ZEROES.     00820000
008300         10  PV-CURRENT-DAY        PIC  9(2)    VALUE ZEROES.     00830000
008400     05  PV-CURRENT-TIME.                                         00840000
008500         10  PV-CURRENT-HOUR       PIC  9(2)    VALUE ZEROES.     00850000
008600         10  PV-CURRENT-MINUTE     PIC  9(2)    VALUE ZEROES.     00860000
008700         10  FILLER                PIC  9(2)    VALUE ZEROES.     00870000
008800                                                                  00880000
008900*----------------------------------------------------------------*00890000
009000*    STANDARD HEADER LAYOUT                                       00900000
009100*----------------------------------------------------------------*00910000
009200     COPY DPWS200O.                                               00920000
009300                                                                  00930000
009400                                                                  00940000
009500*---------------------------------------------------------------* 00950000
009600*  RECORD LAYOUT FOR RECEIVER                                     00960000
009700*---------------------------------------------------------------* 00970000
009800     COPY APRD081.                                                00980000
009900                                                                  00990000
010000                                                                  01000000
010100*----------------------------------------------------------------*01010000
010200*    REPORT LAYOUT                                                01020000
010300*----------------------------------------------------------------*01030000
010400                                                                  01040000
010500 01  HEADING-LINE-1.                                              01050000
010600     05  FILLER                  PIC  X(76) VALUE SPACES.         01060000
010700     05  FILLER                  PIC  X(29) VALUE                 01070000
010800                                  'PURCHASE ACTIVITY AND VENDOR '.01080000
010900     05  H1-TITLE-ALW-TYP        PIC  X(9)  VALUE SPACES.         01090000
010910     05  FILLER                  PIC  X(11) VALUE                 01091000
010920                                                    ' AGREEMENTS'.01092000
010930     05  FILLER                  PIC  X(75) VALUE SPACES.         01093000
010940                                                                  01094000
010950 01  HEADING-LINE-2.                                              01095000
010960     05  FILLER                  PIC  X(84) VALUE SPACES.         01096000
010970     05  FILLER                  PIC  X(04) VALUE                 01097000
010980                                                  'FOR '.         01098000
010990     05  H2-BEGIN-DTE            PIC  X(10).                      01099000
011000     05  FILLER                  PIC  X(9)  VALUE ' THROUGH '.    01100000
011100     05  H2-END-DTE              PIC  X(10).                      01110000
011200     05  FILLER                  PIC  X(83) VALUE SPACES.         01120000
011300                                                                  01130000
011400 01  HEADING-LINE-3.                                              01140000
011500     05  FILLER                  PIC  X(80) VALUE SPACES.         01150000
011600     05  H3-SUBHEADING           PIC  X(40).                      01160000
011700     05  FILLER                  PIC  X(80) VALUE SPACES.         01170000
011800                                                                  01180000
011900 01  DETAIL-HEADING-LINE.                                         01190000
012000     05  FILLER                  PIC X(30) VALUE 'VENDOR NAME'.   01200000
012100     05  FILLER                  PIC X(2)  VALUE SPACES.          01210000
012110     05  FILLER                  PIC X(9)  VALUE 'VENDOR # '.     01211000
012120     05  FILLER                  PIC X(2)  VALUE SPACES.          01212000
012130     05  FILLER                  PIC X(3)  VALUE 'DIV'.           01213000
012140     05  FILLER                  PIC X(2)  VALUE SPACES.          01214000
012150     05  FILLER                  PIC X(3)  VALUE 'DPT'.           01215000
012160     05  FILLER                  PIC X(3)  VALUE SPACES.          01216000
012170     05  FILLER                  PIC X(4)  VALUE 'PCNT'.          01217000
012180     05  FILLER                  PIC X     VALUE SPACES.          01218000
012190     05  FILLER                  PIC X(3)  VALUE 'RTV'.           01219000
012200     05  FILLER                  PIC X     VALUE SPACES.          01220000
012300     05  FILLER                  PIC X(3)  VALUE 'DSC'.           01230000
012400     05  FILLER                  PIC X     VALUE SPACES.          01240000
012500     05  FILLER                  PIC X(3)  VALUE 'FRQ'.           01250000
012600     05  FILLER                  PIC X(5)  VALUE SPACES.          01260000
012700     05  FILLER                  PIC X(8)  VALUE 'RECEIPTS'.      01270000
012800     05  FILLER                  PIC X(7)  VALUE SPACES.          01280000
012810     05  FILLER                  PIC X(7)  VALUE 'NET RTV'.       01281000
012820     05  FILLER                  PIC X(6)  VALUE SPACES.          01282000
012830     05  FILLER                  PIC X(8)  VALUE 'NET DISC'.      01283000
012840     05  FILLER                  PIC X(6)  VALUE SPACES.          01284000
012850     05  FILLER                  PIC X(8)  VALUE 'NET BOTH'.      01285000
012860     05  FILLER                  PIC X(4)  VALUE SPACES.          01286000
012870     05  FILLER                  PIC X(8)  VALUE 'EST EARN'.      01287000
012880     05  FILLER                  PIC X(5)  VALUE SPACES.          01288000
012890     05  FILLER                  PIC X(8)  VALUE 'REVERSAL'.      01289000
012900     05  FILLER                  PIC X(5)  VALUE SPACES.          01290000
013000     05  FILLER                  PIC X(8)  VALUE 'ACT EARN'.      01300000
013100     05  FILLER                  PIC X(6)  VALUE SPACES.          01310000
013200     05  FILLER                  PIC X(7)  VALUE 'VND OTP'.       01320000
013300     05  FILLER                  PIC X(3)  VALUE SPACES.          01330000
013400     05  FILLER                  PIC X(9)  VALUE 'VND REPAY'.     01340000
013500     05  FILLER                  PIC X(5)  VALUE SPACES.          01350000
013600     05  FILLER                  PIC X(7)  VALUE 'EST/ACT'.       01360000
013700                                                                  01370000
013800 01  BLANK-LINE                  PIC X(200) VALUE SPACES.         01380000
013900                                                                  01390000
014000 01  DETAIL-LINE.                                                 01400000
014100     05  DL-VENDOR-NAME          PIC X(30) VALUE SPACES.          01410000
014200     05  FILLER                  PIC X(2)  VALUE SPACES.          01420000
014300     05  DL-VENDOR-NBR           PIC X(9)  VALUE SPACES.          01430000
014400     05  FILLER                  PIC X(3)  VALUE SPACES.          01440000
014500     05  DL-DMA-NBR              PIC X(2)  VALUE SPACES.          01450000
014600     05  FILLER                  PIC X(2)  VALUE SPACES.          01460000
014700     05  DL-DEPT-NBR             PIC X(3)  VALUE SPACES.          01470000
014800     05  FILLER                  PIC X     VALUE SPACES.          01480000
014900     05  DL-DISCOUNT-PCT         PIC ZZ9.99.                      01490000
015000     05  FILLER                  PIC X(2)  VALUE SPACES.          01500000
015100     05  DL-RTV-IND              PIC X.                           01510000
015200     05  FILLER                  PIC X(3)  VALUE SPACES.          01520000
015300     05  DL-DSC-IND              PIC X.                           01530000
015400     05  FILLER                  PIC X(2)  VALUE SPACES.          01540000
015500     05  DL-PSTG-FREQ            PIC X(2).                        01550000
015600     05  FILLER                  PIC X(1)  VALUE SPACES.          01560000
015700     05  DL-GROSS-AMT            PIC -(10).99.                    01570000
015800     05  FILLER                  PIC X(1)  VALUE SPACES.          01580000
015900     05  DL-GROSS-RTV-AMT        PIC -(10).99.                    01590000
016000     05  FILLER                  PIC X(1)  VALUE SPACES.          01600000
016010     05  DL-GROSS-DSC-AMT        PIC -(10).99.                    01601000
016020     05  FILLER                  PIC X(1)  VALUE SPACES.          01602000
016030     05  DL-GROSS-RTV-DSC-AMT    PIC -(10).99.                    01603000
016040     05  FILLER                  PIC X     VALUE SPACES.          01604000
016050     05  DL-EST-EARNED           PIC -(8).99.                     01605000
016060     05  FILLER                  PIC XX    VALUE SPACES.          01606000
016070     05  DL-REVERSAL             PIC -(8).--.                     01607000
016080     05  FILLER                  PIC XX    VALUE SPACES.          01608000
016090     05  DL-ACT-EARNED           PIC -(8).--.                     01609000
016100     05  FILLER                  PIC XX    VALUE SPACES.          01610000
016200     05  DL-VND-DEDUCT           PIC -(8).--.                     01620000
016300     05  FILLER                  PIC X     VALUE SPACES.          01630000
016400     05  DL-VND-REPAY            PIC -(8).--.                     01640000
016500     05  FILLER                  PIC X     VALUE SPACES.          01650000
016600     05  DL-DIFFERENCE           PIC -(8).--.                     01660000
016700                                                                  01670000
016800 01  DETAIL-LINE2.                                                01680000
016900     05  FILLER                  PIC X(139) VALUE SPACES.         01690000
017000     05  DL2-REVERSAL            PIC -(8).--.                     01700000
017100     05  FILLER                  PIC XX    VALUE SPACES.          01710000
017200     05  DL2-ACT-EARNED          PIC -(8).--.                     01720000
017300     05  FILLER                  PIC XX    VALUE SPACES.          01730000
017400     05  DL2-VND-DEDUCT          PIC -(8).--.                     01740000
017500     05  FILLER                  PIC X     VALUE SPACES.          01750000
017600     05  DL2-VND-REPAY           PIC -(8).--.                     01760000
017700     05  FILLER                  PIC X     VALUE SPACES.          01770000
017800     05  DL2-DIFFERENCE          PIC -(8).--.                     01780000
017900                                                                  01790000
018000 01  DASH-LINE.                                                   01800000
018100     05  FILLER                  PIC X(69) VALUE SPACES.          01810000
018200     05  FILLER                  PIC X(14) VALUE ALL '-'.         01820000
018210     05  FILLER                  PIC X     VALUE SPACES.          01821000
018220     05  FILLER                  PIC X(13) VALUE ALL '-'.         01822000
018230     05  FILLER                  PIC X     VALUE SPACES.          01823000
018240     05  FILLER                  PIC X(13) VALUE ALL '-'.         01824000
018250     05  FILLER                  PIC X     VALUE SPACES.          01825000
018260     05  FILLER                  PIC X(13) VALUE ALL '-'.         01826000
018270     05  FILLER                  PIC X     VALUE SPACES.          01827000
018280     05  FILLER                  PIC X(11) VALUE ALL '-'.         01828000
018290     05  FILLER                  PIC X(2)  VALUE SPACES.          01829000
018300     05  FILLER                  PIC X(11) VALUE ALL '-'.         01830000
018400     05  FILLER                  PIC X(2)  VALUE SPACES.          01840000
018500     05  FILLER                  PIC X(11) VALUE ALL '-'.         01850000
018600     05  FILLER                  PIC X(2)  VALUE SPACES.          01860000
018700     05  FILLER                  PIC X(11) VALUE ALL '-'.         01870000
018800     05  FILLER                  PIC X     VALUE SPACES.          01880000
018900     05  FILLER                  PIC X(11) VALUE ALL '-'.         01890000
019000     05  FILLER                  PIC X     VALUE SPACES.          01900000
019100     05  FILLER                  PIC X(11) VALUE ALL '-'.         01910000
019200                                                                  01920000
019300 01  VND-TOTAL-LINE.                                              01930000
019700     05  VTOT-VENDOR-NAME        PIC X(30).                       01970000
019710     05  FILLER                  PIC X(12) VALUE                  01971000
019720                                 'TOTALS:     '.                  01972000
019900     05  FILLER                  PIC X(19) VALUE SPACES.          01990000
019910     05  FILLER                  PIC X(8)  VALUE SPACES.          01991001
020000     05  VTOT-GROSS-AMT          PIC -(11).99.                    02000000
020100     05  FILLER                  PIC X     VALUE SPACES.          02010000
020200     05  VTOT-GROSS-RTV-AMT      PIC -(10).99.                    02020000
020300     05  FILLER                  PIC X     VALUE SPACES.          02030000
020400     05  VTOT-GROSS-DSC-AMT      PIC -(10).99.                    02040000
020500     05  FILLER                  PIC X     VALUE SPACES.          02050000
020600     05  VTOT-GROSS-RTV-DSC-AMT  PIC -(10).99.                    02060000
020700     05  FILLER                  PIC X     VALUE SPACES.          02070000
020800     05  VTOT-EST-EARNED         PIC -(8).99.                     02080000
020900     05  FILLER                  PIC XX    VALUE SPACES.          02090000
021000     05  VTOT-REVERSAL           PIC -(8).99.                     02100000
021100     05  FILLER                  PIC XX    VALUE SPACES.          02110000
021200     05  VTOT-ACT-EARNED         PIC -(8).99.                     02120000
021300     05  FILLER                  PIC XX    VALUE SPACES.          02130000
021400     05  VTOT-VND-DEDUCT         PIC -(8).99.                     02140000
021500     05  FILLER                  PIC X     VALUE SPACES.          02150000
021600     05  VTOT-VND-REPAY          PIC -(8).99.                     02160000
021700     05  FILLER                  PIC X     VALUE SPACES.          02170000
021800     05  VTOT-DIFFERENCE         PIC -(8).99.                     02180000
021900                                                                  02190000
022000 01  GRAND-TOTAL-LINE.                                            02200000
022100     05  FILLER                  PIC X(41) VALUE                  02210000
022110                                           '     GRAND TOTALS:'.  02211000
022120     05  FILLER                  PIC X(18) VALUE SPACES.          02212000
022130     05  TL-GROSS-AMT            PIC -(13).99.                    02213000
022140     05  FILLER                  PIC X     VALUE SPACES.          02214000
022150     05  TL-GROSS-RTV-AMT        PIC -(11).99.                    02215000
022160     05  FILLER                  PIC X     VALUE SPACES.          02216000
022170     05  TL-GROSS-DSC-AMT        PIC -(11).99.                    02217000
022180     05  FILLER                  PIC X     VALUE SPACES.          02218000
022190     05  TL-GROSS-RTV-DSC-AMT    PIC -(11).99.                    02219000
022200     05  FILLER                  PIC X     VALUE SPACES.          02220000
022300     05  TL-EST-EARNED           PIC -(11).99.                    02230000
022400     05  FILLER                  PIC X     VALUE SPACES.          02240000
022500     05  TL-REVERSAL             PIC -(9).99.                     02250000
022600     05  FILLER                  PIC X     VALUE SPACES.          02260000
022700     05  TL-ACT-EARNED           PIC -(9).99.                     02270000
022800     05  FILLER                  PIC X     VALUE SPACES.          02280000
022900     05  TL-VND-DEDUCT           PIC -(9).99.                     02290000
023000     05  FILLER                  PIC X     VALUE SPACES.          02300000
023100     05  TL-VND-REPAY            PIC -(9).99.                     02310000
023200     05  FILLER                  PIC X     VALUE SPACES.          02320000
023300     05  TL-DIFFERENCE           PIC -(9).99.                     02330000
023400                                                                  02340000
023500 01  END-OF-REPORT.                                               02350000
023600     05  FILLER                  PIC  X(59) VALUE SPACES.         02360000
023700     05  FILLER                  PIC  X(33) VALUE                 02370000
023800                              '***  E N D  O F  R E P O R T  ***'.02380000
023900     05  FILLER                  PIC  X(58) VALUE SPACES.         02390000
024000                                                                  02400000
024100 PROCEDURE DIVISION.                                              02410000
024200                                                                  02420000
024300 A100-PROGRAM-MAINLINE.                                           02430000
024400                                                                  02440000
024500     PERFORM B100-INITIALIZE.                                     02450000
024600                                                                  02460000
024700     PERFORM B200-CREATE-REPORT                                   02470000
024800         UNTIL PS-END-OF-EXTRACT.                                 02480000
024900                                                                  02490000
025000     PERFORM B300-EOJ-ROUTINE.                                    02500000
025100                                                                  02510000
025200     GOBACK.                                                      02520000
025300                                                                  02530000
025400                                                                  02540000
025500******************************************************************02550000
025600*  INITIALIZATIONS                                               *02560000
025700******************************************************************02570000
025800 B100-INITIALIZE.                                                 02580000
025900                                                                  02590000
026000     OPEN INPUT  ACTIVITY-EXTRACT-FILE                            02600000
026100          OUTPUT REPORT-FILE.                                     02610000
026200                                                                  02620000
026300*    FORMAT HEADING DATA                                          02630000
026400     MOVE FUNCTION CURRENT-DATE TO PV-CURRENT-DATE.               02640000
026500     MOVE PV-CURRENT-MONTH      TO DP200O-RUN-MONTH.              02650000
026600     MOVE PV-CURRENT-DAY        TO DP200O-RUN-DAY.                02660000
026700     MOVE PV-CURRENT-YEAR       TO DP200O-RUN-YEAR.               02670000
026800                                                                  02680000
026900     ACCEPT PV-CURRENT-TIME FROM TIME.                            02690000
027000     MOVE PV-CURRENT-HOUR       TO DP200O-RUN-HOUR.               02700000
027100     MOVE PV-CURRENT-MINUTE     TO DP200O-RUN-MINUTE.             02710000
027200     MOVE PC-PROGRAM-NAME       TO DP200O-PROGRAM-NAME.           02720000
027300     MOVE 1                     TO DP200O-REPORT-NUMBER.          02730000
027400                                                                  02740000
027500     ACCEPT CONTROL-CARD.                                         02750000
027600     MOVE CC-BEGIN-DTE          TO H2-BEGIN-DTE.                  02760000
027700     MOVE CC-END-DTE            TO H2-END-DTE.                    02770000
027800                                                                  02780000
027900     ACCEPT CONTROL-CARD-TWO.                                     02790000
028000     MOVE CC-RPT-ALW-TYP        TO H1-TITLE-ALW-TYP.              02800000
028100     MOVE CC-SUBHEADING         TO H3-SUBHEADING.                 02810000
028200                                                                  02820000
028300     PERFORM R100-READ-EXTRACT-FILE.                              02830000
028400     PERFORM W100-WRITE-HEADINGS.                                 02840000
028401                                                                  02840100
028402******************************************************************02840200
028403*  CREATE REPORT DETAIL LINES FROM INPUT FILE.  FILE CAN CONTAIN  02840300
028404*  2 RECORDS FOR THE SAME VENDOR/DEPT; ONE WITH THE AGREEMENT INFO02840400
028405*  AND THE SECOND WITHOUT.  IN THIS CASE, ONLY THE FIRST RECORD   02840500
028406*  IS PROCESSED.  IF A SECOND RECORD IS FOUND FOR A VENDOR/DEPT,  02840600
028407*  IT IS BYPASSED (ANOTHER READ IS DONE WITHOUT CREATING A LINE). 02840700
028408******************************************************************02840800
028409 B200-CREATE-REPORT.                                              02840900
028410                                                                  02841000
028420     IF  AP081-VENDOR-NBR = SAVE-VND-NBR                          02842000
028430        CONTINUE                                                  02843000
028440     ELSE                                                         02844000
028450        PERFORM D100-POPULATE-VND-TOTAL                           02845000
028460     END-IF.                                                      02846000
028470                                                                  02847000
028480     IF  AP081-VENDOR-NBR = SAVE-VND-NBR                          02848000
028490     AND AP081-DEPT-NBR = SAVE-DEPT-NBR                           02849000
028500         CONTINUE                                                 02850000
028600     ELSE                                                         02860000
028700         PERFORM C100-POPULATE-REPORT-RECORD                      02870000
028800         PERFORM W300-WRITE-REPORT-RECORD                         02880000
028900         MOVE AP081-VENDOR-NBR TO SAVE-VND-NBR                    02890000
029000         MOVE AP081-VENDOR-NAME TO SAVE-VENDOR-NAME               02900000
029100         MOVE AP081-DEPT-NBR TO SAVE-DEPT-NBR                     02910000
029200     END-IF.                                                      02920000
029300                                                                  02930000
029400     PERFORM R100-READ-EXTRACT-FILE.                              02940000
029500                                                                  02950000
029600                                                                  02960000
029700******************************************************************02970000
029800*  CLOSE CURSOR & OUTPUT FILE, DISPLAY END OF RUN MESSAGE.       *02980000
029900******************************************************************02990000
030000 B300-EOJ-ROUTINE.                                                03000000
030100                                                                  03010000
030200     PERFORM D100-POPULATE-VND-TOTAL.                             03020000
030300     PERFORM D200-POPULATE-TOTAL-LINE.                            03030000
030400     PERFORM W400-WRITE-EOR.                                      03040000
030500                                                                  03050000
030600     CLOSE ACTIVITY-EXTRACT-FILE                                  03060000
030700           REPORT-FILE.                                           03070000
030800                                                                  03080000
030900     DISPLAY 'RECORDS READ            = ' PV-INPUT-EXTRACT-CNT.   03090000
031000                                                                  03100000
031100******************************************************************03110000
031200*  FORMAT REPORT DETAIL                                           03120000
031300******************************************************************03130000
031400 C100-POPULATE-REPORT-RECORD.                                     03140000
031500                                                                  03150000
031600     MOVE AP081-DMA-NBR             TO DL-DMA-NBR.                03160000
031700     MOVE AP081-VENDOR-NAME         TO DL-VENDOR-NAME.            03170000
031800     MOVE AP081-VENDOR-NBR          TO DL-VENDOR-NBR.             03180000
031900     MOVE AP081-DEPT-NBR            TO DL-DEPT-NBR.               03190000
032000     MOVE AP081-AGR-RTV-IND         TO DL-RTV-IND.                03200000
032100     MOVE AP081-AGR-DSC-IND         TO DL-DSC-IND.                03210000
032200     MOVE AP081-AGR-PSTG-FRQ-CDE    TO DL-PSTG-FREQ.              03220000
032300                                                                  03230000
032400     COMPUTE PV-DISCOUNT-PCT-EXPD = AP081-AGR-DISC-PCT * 100.     03240000
032500     MOVE PV-DISCOUNT-PCT-EXPD      TO DL-DISCOUNT-PCT.           03250000
032600                                                                  03260000
032700     MOVE AP081-GROSS-PURCHS-AMT    TO DL-GROSS-AMT.              03270000
032800     MOVE AP081-PRCH-NET-RTV-AMT    TO DL-GROSS-RTV-AMT.          03280000
032900     MOVE AP081-PRCH-NET-DSC-AMT    TO DL-GROSS-DSC-AMT.          03290000
033000     MOVE AP081-PRCH-NET-ALL-AMT    TO DL-GROSS-RTV-DSC-AMT.      03300000
033100     MOVE AP081-EST-EARNED-AMT      TO DL-EST-EARNED.             03310000
033200                                                                  03320000
033300     IF  AP081-AGR-AP-TRN-CDE = '88' OR                           03330003
033310         AP081-AGR-AP-TRN-CDE = '5A'                              03331003
033400         MOVE AP081-VND-REPAY-AMT   TO DL-VND-REPAY               03332005
033500         MOVE AP081-DEPT-EXP-CR-AMT TO DL-ACT-EARNED              03333005
033600     END-IF.                                                      03360000
033700                                                                  03370000
033310     IF  AP081-AGR-AP-TRN-CDE = '5A'                              03372005
033400         MOVE AP081-VND-DED-AMT     TO DL-VND-DEDUCT              03375005
033600     END-IF.                                                      03376005
033700                                                                  03377005
033800     ADD AP081-GROSS-PURCHS-AMT    TO VN-GROSS-AMT.               03380000
033900     ADD AP081-PRCH-NET-RTV-AMT    TO VN-GROSS-RTV-AMT.           03390000
034000     ADD AP081-PRCH-NET-DSC-AMT    TO VN-GROSS-DSC-AMT.           03400000
034100     ADD AP081-PRCH-NET-ALL-AMT    TO VN-GROSS-RTV-DSC-AMT.       03410000
034200     ADD AP081-EST-EARNED-AMT      TO VN-EST-EARNED.              03420000
034300     ADD +1                        TO VN-DEPT-COUNT.              03430000
034400                                                                  03440000
034500     IF  AP081-RVRS-EARNED-AMT = 0                                03450000
034600         CONTINUE                                                 03460000
034700     ELSE                                                         03470000
034710         MOVE AP081-RVRS-EARNED-AMT TO VN-REVERSAL                03471000
034720     END-IF.                                                      03472000
034730                                                                  03473000
034740     IF  AP081-VND-DED-AMT = 0                                    03474000
034750         CONTINUE                                                 03475000
034760     ELSE                                                         03476000
               IF AP081-AGR-AP-TRN-CDE = '5A'                           03476105
                  ADD AP081-VND-DED-AMT   TO VN-VND-DED-AMT             03476205
               ELSE                                                     03476305
034770            MOVE AP081-VND-DED-AMT   TO VN-VND-DED-AMT            03477005
034780         END-IF                                                   03478005
034780     END-IF.                                                      03478105
034790                                                                  03479000
034800     IF  AP081-AGR-AP-TRN-CDE = '88'                              03480000
034900     OR  AP081-AGR-AP-TRN-CDE = '  '                              03490000
034910     OR  AP081-AGR-AP-TRN-CDE = '5A'                              03491003
035000         ADD AP081-DEPT-EXP-CR-AMT TO VN-ACT-EARNED               03500000
035100         ADD AP081-VND-REPAY-AMT   TO VN-VND-REPAY-AMT            03510000
035200     ELSE                                                         03520000
035300         MOVE AP081-DEPT-EXP-CR-AMT TO VN-ACT-EARNED              03530000
035400         MOVE AP081-VND-REPAY-AMT   TO VN-VND-REPAY-AMT           03540000
035410     END-IF.                                                      03541000
035420                                                                  03542000
035430******************************************************************03543000
035440*  FORMAT VENDOR TOTAL LINE.  IF THERE IS ONLY ONE DEPARTMENT     03544000
035450*  DETAIL LINE FOR A VENDOR, NO TOTAL LINE IS PRINTED.            03545000
035460*  VENDOR TOTALS ARE ADDED INTO THE GRAND TOTAL FIELDS AND THEN   03546000
035470*  CLEARED FOR THE NEXT VENDOR.                                   03547000
035480******************************************************************03548000
035490 D100-POPULATE-VND-TOTAL.                                         03549000
035500                                                                  03550000
035600     IF  VN-DEPT-COUNT > 1                                        03560000
035700         MOVE SAVE-VENDOR-NAME      TO VTOT-VENDOR-NAME           03570000
035800         MOVE VN-GROSS-AMT          TO VTOT-GROSS-AMT             03580000
035900         MOVE VN-GROSS-RTV-AMT      TO VTOT-GROSS-RTV-AMT         03590000
036000         MOVE VN-GROSS-DSC-AMT      TO VTOT-GROSS-DSC-AMT         03600000
036100         MOVE VN-GROSS-RTV-DSC-AMT  TO VTOT-GROSS-RTV-DSC-AMT     03610000
036200         MOVE VN-EST-EARNED         TO VTOT-EST-EARNED            03620000
036300         MOVE VN-ACT-EARNED         TO VTOT-ACT-EARNED            03630000
036400         MOVE VN-REVERSAL           TO VTOT-REVERSAL              03640000
036500         MOVE VN-VND-DED-AMT        TO VTOT-VND-DEDUCT            03650000
036600         MOVE VN-VND-REPAY-AMT      TO VTOT-VND-REPAY             03660000
036700         COMPUTE VN-DIFFERENCE = VN-EST-EARNED + VN-ACT-EARNED    03670000
036800         MOVE VN-DIFFERENCE         TO VTOT-DIFFERENCE            03680000
036900                                                                  03690000
037000         WRITE REPORT-REC FROM DASH-LINE                          03700000
037100           AFTER ADVANCING +1 LINES                               03710000
037200                                                                  03720000
037300         WRITE REPORT-REC FROM VND-TOTAL-LINE                     03730000
037400           AFTER ADVANCING +1 LINES                               03740000
037500                                                                  03750000
037600         ADD +2 TO PV-LINE-COUNT                                  03760000
037700     ELSE                                                         03770000
037800         MOVE SPACES TO DETAIL-LINE2                              03780000
037900         MOVE VN-ACT-EARNED         TO DL2-ACT-EARNED             03790000
038000         MOVE VN-REVERSAL           TO DL2-REVERSAL               03800000
038100         MOVE VN-VND-DED-AMT        TO DL2-VND-DEDUCT             03810000
038200         MOVE VN-VND-REPAY-AMT      TO DL2-VND-REPAY              03820000
038300         COMPUTE VN-DIFFERENCE = VN-EST-EARNED + VN-ACT-EARNED    03830000
038400         MOVE VN-DIFFERENCE         TO DL2-DIFFERENCE             03840000
038500                                                                  03850000
038600         WRITE REPORT-REC FROM DETAIL-LINE2                       03860000
038700           AFTER ADVANCING +0 LINES                               03870000
038800     END-IF.                                                      03880000
038900                                                                  03890000
039000     WRITE REPORT-REC FROM BLANK-LINE                             03900000
039100       AFTER ADVANCING +1 LINES.                                  03910000
039200                                                                  03920000
039300     ADD +1 TO PV-LINE-COUNT.                                     03930000
039400                                                                  03940000
039500     ADD VN-GROSS-AMT         TO TOT-GROSS-AMT.                   03950000
039600     ADD VN-GROSS-RTV-AMT     TO TOT-GROSS-RTV-AMT.               03960000
039700     ADD VN-GROSS-DSC-AMT     TO TOT-GROSS-DSC-AMT.               03970000
039800     ADD VN-GROSS-RTV-DSC-AMT TO TOT-GROSS-RTV-DSC-AMT.           03980000
039900     ADD VN-EST-EARNED        TO TOT-EST-EARNED.                  03990000
039910     ADD VN-ACT-EARNED        TO TOT-ACT-EARNED.                  03991000
039920     ADD VN-REVERSAL          TO TOT-REVERSAL .                   03992000
039921     ADD VN-VND-DED-AMT       TO TOT-VND-DEDUCT.                  03992100
039922     ADD VN-VND-REPAY-AMT     TO TOT-VND-REPAY.                   03992200
039923     ADD VN-DIFFERENCE        TO TOT-DIFFERENCE.                  03992300
039924                                                                  03992400
039925     MOVE ZEROES TO VN-GROSS-AMT                                  03992500
039926                    VN-GROSS-RTV-AMT                              03992600
039927                    VN-GROSS-DSC-AMT                              03992700
039928                    VN-GROSS-RTV-DSC-AMT                          03992800
039929                    VN-EST-EARNED                                 03992900
039930                    VN-REVERSAL                                   03993000
039931                    VN-ACT-EARNED                                 03993100
039932                    VN-VND-DED-AMT                                03993200
039933                    VN-VND-REPAY-AMT                              03993300
039934                    VN-DIFFERENCE                                 03993400
039935                    VN-DEPT-COUNT.                                03993500
039936                                                                  03993600
039937                                                                  03993700
039938******************************************************************03993800
039939*  FORMAT TOTAL DETAIL                                            03993900
039940******************************************************************03994000
039941 D200-POPULATE-TOTAL-LINE.                                        03994100
039942                                                                  03994200
039943     MOVE TOT-GROSS-AMT         TO TL-GROSS-AMT.                  03994300
039944     MOVE TOT-GROSS-RTV-AMT     TO TL-GROSS-RTV-AMT.              03994400
039945     MOVE TOT-GROSS-DSC-AMT     TO TL-GROSS-DSC-AMT.              03994500
039946     MOVE TOT-GROSS-RTV-DSC-AMT TO TL-GROSS-RTV-DSC-AMT.          03994600
039947     MOVE TOT-EST-EARNED        TO TL-EST-EARNED.                 03994700
039948     MOVE TOT-ACT-EARNED        TO TL-ACT-EARNED.                 03994800
039949     MOVE TOT-REVERSAL          TO TL-REVERSAL.                   03994900
039950     MOVE TOT-VND-DEDUCT        TO TL-VND-DEDUCT.                 03995000
039951     MOVE TOT-VND-REPAY         TO TL-VND-REPAY.                  03995100
039952     MOVE TOT-DIFFERENCE        TO TL-DIFFERENCE.                 03995200
039953                                                                  03995300
039954     WRITE REPORT-REC FROM GRAND-TOTAL-LINE                       03995400
039955       AFTER ADVANCING +2 LINES.                                  03995500
039956                                                                  03995600
039957     ADD +2 TO PV-LINE-COUNT.                                     03995700
039958                                                                  03995800
039959                                                                  03995900
039960******************************************************************03996000
039970*   READ  INPUT EXTRACT FILE                                     *03997000
039980******************************************************************03998000
039990 R100-READ-EXTRACT-FILE.                                          03999000
040000                                                                  04000000
040001     INITIALIZE AP081-VNDAGR-EXTRACT.                             04000100
040002                                                                  04000200
040003     READ ACTIVITY-EXTRACT-FILE INTO AP081-VNDAGR-EXTRACT         04000300
040004       AT END SET PS-END-OF-EXTRACT TO TRUE.                      04000400
040005                                                                  04000500
040006     IF PS-END-OF-EXTRACT                                         04000600
040007         CONTINUE                                                 04000700
040008     ELSE                                                         04000800
040009         ADD +1 TO PV-INPUT-EXTRACT-CNT                           04000900
040010     END-IF.                                                      04001000
040011                                                                  04001100
040012                                                                  04001200
040013*----------------------------------------------------------------*04001300
040014*    WRITE PAGE HEADING LINES                                    *04001400
040015*----------------------------------------------------------------*04001500
040016 W100-WRITE-HEADINGS.                                             04001600
040017                                                                  04001700
040018     ADD +1             TO PV-PAGE-COUNT.                         04001800
040019     MOVE PV-PAGE-COUNT TO DP200O-PAGE-NUMBER.                    04001900
040020                                                                  04002000
040021     WRITE REPORT-REC FROM DP200O-STANDRD-HEADER-200-COLS         04002100
040022       AFTER ADVANCING PAGE.                                      04002200
040023                                                                  04002300
040024     WRITE REPORT-REC FROM HEADING-LINE-1                         04002400
040025       AFTER ADVANCING +1 LINES.                                  04002500
040026                                                                  04002600
040027     WRITE REPORT-REC FROM HEADING-LINE-2                         04002700
040028       AFTER ADVANCING +1 LINES.                                  04002800
040029                                                                  04002900
040030     WRITE REPORT-REC FROM HEADING-LINE-3                         04003000
040040       AFTER ADVANCING +1 LINES.                                  04004000
040050                                                                  04005000
040060     WRITE REPORT-REC FROM DETAIL-HEADING-LINE                    04006000
040070       AFTER ADVANCING +2 LINES.                                  04007000
040080                                                                  04008000
040090     WRITE REPORT-REC FROM BLANK-LINE                             04009000
040100       AFTER ADVANCING +1 LINES.                                  04010000
040200                                                                  04020000
040300     MOVE +7 TO PV-LINE-COUNT.                                    04030000
040400                                                                  04040000
040500******************************************************************04050000
040600*  WRITE OUT REPORT DETAIL LINE                                  *04060000
040700******************************************************************04070000
040800 W300-WRITE-REPORT-RECORD.                                        04080000
040900                                                                  04090000
041000     IF (PV-LINE-COUNT + 3) > PC-LINES-PER-PAGE-MAX               04100000
041100         PERFORM W100-WRITE-HEADINGS                              04110000
041200     END-IF.                                                      04120000
041300                                                                  04130000
041400*    IF PV-LINE-COUNT > PC-LINES-PER-PAGE-MAX                     04140000
041500*        PERFORM W100-WRITE-HEADINGS                              04150000
041600*    END-IF.                                                      04160000
041700                                                                  04170000
041800     WRITE REPORT-REC FROM DETAIL-LINE                            04180000
041900       AFTER ADVANCING +1 LINES.                                  04190000
042000                                                                  04200000
042100     ADD +1 TO PV-LINE-COUNT.                                     04210000
042200                                                                  04220000
042300     INITIALIZE DETAIL-LINE.                                      04230000
042400                                                                  04240000
042500                                                                  04250000
042600*----------------------------------------------------------------*04260000
042700*    WRITE END OF REPORT LINE                                    *04270000
042800*----------------------------------------------------------------*04280000
042900 W400-WRITE-EOR.                                                  04290000
043000                                                                  04300000
043100     IF (PV-LINE-COUNT + 3) > PC-LINES-PER-PAGE-MAX               04310000
043200         PERFORM W100-WRITE-HEADINGS                              04320000
043300     END-IF.                                                      04330000
043400                                                                  04340000
043500     WRITE REPORT-REC FROM END-OF-REPORT                          04350000
043600       AFTER ADVANCING +3 LINES.                                  04360000
043700                                                                  04370000
