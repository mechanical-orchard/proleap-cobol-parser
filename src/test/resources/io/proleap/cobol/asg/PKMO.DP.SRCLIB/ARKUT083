000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             ARKUT083.                                00050001
000600 AUTHOR.                 KAREN GIVENS.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            02-15-2012.                              00080001
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001100* THE PURPOSE OF THIS PROGRAM IS TO READ THROUGH FIRST DATA       00120024
001100* CAP (CUSTOMER/ACCOUNT/PLASTICS) SOURCE FILE TO VERIFY THAT      00130024
001100* WE RECEIVED ALL THE RECORDS FROM FD AND TO PRODUCE              00140024
001100* OTHER OUTPUT DATASETS THAT CONTAIN RECORD COUNTS.               00150024
001100* THIS PROGRAM WILL WRITE OUT AN EXACT COPY OF THE CAP SOURCE     00160024
001100* FILE WITHOUT HEADER AND TRAILER RECORDS.                        00170024
001100* THIS PROGRAM WILL WRITE OUT 9 OUTPUT COUNT FILES.               00180024
001500******************************************************************00190000
001600                                                                  00200000
001700******************************************************************00210000
001800 ENVIRONMENT DIVISION.                                            00220000
001900******************************************************************00230000
002000                                                                  00240000
002100 CONFIGURATION SECTION.                                           00250000
002200                                                                  00260000
002300 SOURCE-COMPUTER.        IBM-3090.                                00270000
002400 OBJECT-COMPUTER.        IBM-3090.                                00280000
002500                                                                  00290000
002600 INPUT-OUTPUT SECTION.                                            00300000
002700                                                                  00310000
002800 FILE-CONTROL.                                                    00320000
002900                                                                  00330000
003000     SELECT CAP-MASTER-IN-FILE                                    00340005
003100         ASSIGN TO INP01.                                         00350000
003300     SELECT CAP-MASTER-OUT-FILE                                   00360005
003400         ASSIGN TO OUT01.                                         00370000
003401     SELECT TOTAL-NBR-CAP-CURL-FILE                               00380001
003402         ASSIGN TO OUT02.                                         00390000
003403     SELECT TOTAL-NBR-CAP-CUEX-FILE                               00400001
003404         ASSIGN TO OUT03.                                         00410000
003405     SELECT TOTAL-NBR-CAP-CUID-FILE                               00420001
003406         ASSIGN TO OUT04.                                         00430000
003407     SELECT TOTAL-NBR-CAP-PINS-FILE                               00440001
003408         ASSIGN TO OUT05.                                         00450000
003409     SELECT TOTAL-NBR-CAP-PRST-FILE                               00460001
003410         ASSIGN TO OUT06.                                         00470000
003411     SELECT TOTAL-NBR-CAP-PRPI-FILE                               00480001
003412         ASSIGN TO OUT07.                                         00490000
003413     SELECT TOTAL-NBR-CAP-ADEX-FILE                               00500001
003414         ASSIGN TO OUT08.                                         00510000
003415     SELECT TOTAL-NBR-CAP-PHON-FILE                               00520001
003416         ASSIGN TO OUT09.                                         00530000
003417     SELECT TOTAL-NBR-CAP-EMAL-FILE                               00540001
003418         ASSIGN TO OUT10.                                         00550000
003500                                                                  00560000
003600******************************************************************00570000
003700 DATA DIVISION.                                                   00580000
003800******************************************************************00590000
003900                                                                  00600000
004000 FILE SECTION.                                                    00610000
004100                                                                  00620000
004200 FD CAP-MASTER-IN-FILE                                            00630001
004300     RECORDING MODE V                                             00640000
004300     LABEL RECORDS ARE STANDARD                                   00650013
004300     BLOCK CONTAINS 0 RECORDS                                     00660013
004300     RECORD IS VARYING IN SIZE                                    00670013
004300               FROM 1 TO 573                                      00680023
004300                   DEPENDING ON IN-REC-LENGTH.                    00690013
004601 01  DBASE-DATA-GROUP-RECORD.                                     00700003
004602     05  CAP-GROUP-ID               PIC X(7).                     00710003
005000       88  IN-CAP-HEADER-REC        VALUE "HEADER ".              00720007
005000       88  IN-CAP-TRAILER-REC       VALUE "TRAILER".              00730007
005000       88  IN-CAP-CURL-REC          VALUE "CURL001".              00740007
005000       88  IN-CAP-CUEX-REC          VALUE "CUEX002".              00750007
005000       88  IN-CAP-CUID-REC          VALUE "CUID003".              00760007
005000       88  IN-CAP-PINS-REC          VALUE "PINS004".              00770007
005000       88  IN-CAP-PRST-REC          VALUE "PRST005".              00780007
005000       88  IN-CAP-PRPI-REC          VALUE "PRPI006".              00790007
005000       88  IN-CAP-ADEX-REC          VALUE "ADEX007".              00800007
005000       88  IN-CAP-PHON-REC          VALUE "PHON008".              00810007
005000       88  IN-CAP-EMAL-REC          VALUE "EMAL009".              00820007
005000       88  IN-CAP-CMCB-REC          VALUE "CMCB010".              00830020
005000       88  IN-CAP-ACCB-REC          VALUE "ACCB010".              00840020
005000       88  IN-CAP-ALTC-REC          VALUE "ALTC012".              00850020
005000       88  IN-CAP-CCBR-REC          VALUE "CCBR013".              00860020
005000     05  CAP-OUT-KEY-FULL-ACCOUNT   PIC X(28).                    00870003
005001     05  CAP-DATA                   PIC X(538).                   00880003
005015************************************************************      00890000
006200* FOR 01 LEVELS, ADD 10 BYTES TO ACCOUNT FOR REC IDENTIFIER.      00900000
006300************************************************************      00910000
006400 01 IN-TINY-REC                     PIC X.                        00920023
006400 01 IN-CURL-REC                     PIC X(127).                   00930023
006902 01 IN-CUEX-REC                     PIC X(216).                   00940014
006903 01 IN-CUID-REC                     PIC X(292).                   00950014
006904 01 IN-PINS-REC                     PIC X(275).                   00960014
006905 01 IN-PRST-REC                     PIC X(93).                    00970014
006906 01 IN-PRPI-REC                     PIC X(79).                    00980014
006906 01 IN-ADEX-REC                     PIC X(573).                   00990014
006906 01 IN-PHON-REC                     PIC X(87).                    01000014
006906 01 IN-EMAL-REC                     PIC X(117).                   01010014
006906 01 IN-CMCB-REC                     PIC X(183).                   01020020
006906 01 IN-ACCB-REC                     PIC X(41).                    01030020
006906 01 IN-ALTC-REC                     PIC X(90).                    01040020
006906 01 IN-CCBR-REC                     PIC X(45).                    01050020
006907                                                                  01060000
006908 FD CAP-MASTER-OUT-FILE                                           01070001
006909     RECORDING MODE IS V                                          01080000
006909     LABEL RECORDS ARE STANDARD                                   01090013
006909     BLOCK CONTAINS 0 RECORDS                                     01100013
006909     RECORD IS VARYING IN SIZE                                    01110013
006909               FROM 1 TO 573                                      01120023
006909                   DEPENDING ON OUT-REC-LENGTH.                   01130013
006913************************************************************      01140000
006914* FOR 01 LEVELS, ADD 10 BYTES TO ACCOUNT FOR REC IDENTIFIER.      01150000
006915************************************************************      01160000
006400 01 OUT-TINY-REC                     PIC X.                       01170023
006400 01 OUT-CURL-REC                     PIC X(127).                  01180023
006902 01 OUT-CUEX-REC                     PIC X(216).                  01190014
006903 01 OUT-CUID-REC                     PIC X(292).                  01200014
006904 01 OUT-PINS-REC                     PIC X(275).                  01210014
006905 01 OUT-PRST-REC                     PIC X(93).                   01220014
006906 01 OUT-PRPI-REC                     PIC X(79).                   01230014
006906 01 OUT-ADEX-REC                     PIC X(573).                  01240014
006906 01 OUT-PHON-REC                     PIC X(87).                   01250014
006906 01 OUT-EMAL-REC                     PIC X(117).                  01260014
006906 01 OUT-CMCB-REC                     PIC X(183).                  01270020
006906 01 OUT-ACCB-REC                     PIC X(41).                   01280020
006906 01 OUT-ALTC-REC                     PIC X(90).                   01290020
006906 01 OUT-CCBR-REC                     PIC X(45).                   01300020
006922                                                                  01310000
006923 FD TOTAL-NBR-CAP-CURL-FILE                                       01320001
006924     RECORDING MODE IS F                                          01330000
006925     BLOCK CONTAINS 0 RECORDS                                     01340020
006926     LABEL RECORDS ARE STANDARD.                                  01350000
006927 01  TOTAL-NBR-CAP-CURL-REC          PIC X(80).                   01360001
006928                                                                  01370000
006929 FD TOTAL-NBR-CAP-CUEX-FILE                                       01380001
006930     RECORDING MODE IS F                                          01390000
006931     BLOCK CONTAINS 0 RECORDS                                     01400000
006932     LABEL RECORDS ARE STANDARD.                                  01410000
006933 01  TOTAL-NBR-CAP-CUEX-REC          PIC X(80).                   01420001
006934                                                                  01430000
006935 FD TOTAL-NBR-CAP-CUID-FILE                                       01440001
006936     RECORDING MODE IS F                                          01450000
006937     BLOCK CONTAINS 0 RECORDS                                     01460000
006938     LABEL RECORDS ARE STANDARD.                                  01470000
006939 01  TOTAL-NBR-CAP-CUID-REC          PIC X(80).                   01480001
006940                                                                  01490000
006941 FD TOTAL-NBR-CAP-PINS-FILE                                       01500001
006942     RECORDING MODE IS F                                          01510000
006943     BLOCK CONTAINS 0 RECORDS                                     01520000
006944     LABEL RECORDS ARE STANDARD.                                  01530000
006945 01  TOTAL-NBR-CAP-PINS-REC          PIC X(80).                   01540001
006946                                                                  01550000
006947 FD TOTAL-NBR-CAP-PRST-FILE                                       01560001
006948     RECORDING MODE IS F                                          01570000
006949     BLOCK CONTAINS 0 RECORDS                                     01580000
006950     LABEL RECORDS ARE STANDARD.                                  01590000
006951 01  TOTAL-NBR-CAP-PRST-REC          PIC X(80).                   01600001
006952                                                                  01610000
006953 FD TOTAL-NBR-CAP-PRPI-FILE                                       01620001
006954     RECORDING MODE IS F                                          01630000
006955     BLOCK CONTAINS 0 RECORDS                                     01640000
006956     LABEL RECORDS ARE STANDARD.                                  01650000
006957 01  TOTAL-NBR-CAP-PRPI-REC          PIC X(80).                   01660001
006958                                                                  01670000
006959 FD TOTAL-NBR-CAP-ADEX-FILE                                       01680001
006960     RECORDING MODE IS F                                          01690000
006961     BLOCK CONTAINS 0 RECORDS                                     01700000
006962     LABEL RECORDS ARE STANDARD.                                  01710000
006963 01  TOTAL-NBR-CAP-ADEX-REC          PIC X(80).                   01720001
006970                                                                  01730000
006971 FD TOTAL-NBR-CAP-PHON-FILE                                       01740001
006972     RECORDING MODE IS F                                          01750000
006973     BLOCK CONTAINS 0 RECORDS                                     01760000
006974     LABEL RECORDS ARE STANDARD.                                  01770000
006975 01  TOTAL-NBR-CAP-PHON-REC          PIC X(80).                   01780001
006976                                                                  01790000
006977 FD TOTAL-NBR-CAP-EMAL-FILE                                       01800001
006978     RECORDING MODE IS F                                          01810000
006979     BLOCK CONTAINS 0 RECORDS                                     01820000
006980     LABEL RECORDS ARE STANDARD.                                  01830000
006981 01  TOTAL-NBR-CAP-EMAL-REC          PIC X(80).                   01840001
006982                                                                  01850000
006989 WORKING-STORAGE SECTION.                                         01860000
006990******************************************************************01870000
006991*                        ABEND CODES                              01880000
006992******************************************************************01890000
006993     COPY ARWS052.                                                01900000
006994                                                                  01910000
006995******************************************************************01920000
006996*                        SWITCHES                                 01930000
006997******************************************************************01940000
006998 01 PS-PROGRAM-SWITCHES.                                          01950000
006999    05 PS-PROCESSING-SW               PIC X      VALUE SPACES.    01960000
007000       88 PS-CONTINUE-PROCESSING                 VALUE 'Y'.       01970000
007001       88 PS-STOP-PROCESSING                     VALUE 'N'.       01980000
007002                                                                  01990000
007003******************************************************************02000000
007004*                        CONSTANTS                                02010000
007005******************************************************************02020000
007100 01 PC-PROGRAM-CONSTANTS.                                         02030000
007200    05 PC-PROGRAM-NAME                PIC X(8)   VALUE 'ARKUT083'.02040001
007300                                                                  02050000
007400******************************************************************02060000
007500*                        VARIABLES                                02070000
007600******************************************************************02080000
007700 01 PV-PROGRAM-VARIABLES.                                         02090000
008000    05 PV-READ-COUNT                  PIC S9(9)  VALUE ZEROES     02100000
008100                                                 COMP.            02110000
008101    05 PV-CRDMAST-COUNT               PIC S9(9)  VALUE ZEROES     02120000
008102                                                 COMP.            02130000
008103    05 PV-CURL-COUNT                  PIC S9(9)  VALUE ZEROES     02140001
008104                                                 COMP.            02150000
008105    05 PV-CUEX-COUNT                  PIC S9(9)  VALUE ZEROES     02160001
008106                                                 COMP.            02170000
008107    05 PV-CUID-COUNT                  PIC S9(9)  VALUE ZEROES     02180001
008108                                                 COMP.            02190000
008109    05 PV-PINS-COUNT                  PIC S9(9)  VALUE ZEROES     02200001
008110                                                 COMP.            02210000
008111    05 PV-PRST-COUNT                  PIC S9(9)  VALUE ZEROES     02220001
008112                                                 COMP.            02230000
008113    05 PV-PRPI-COUNT                  PIC S9(9)  VALUE ZEROES     02240001
008114                                                 COMP.            02250000
008115    05 PV-ADEX-COUNT                  PIC S9(9)  VALUE ZEROES     02260001
008116                                                 COMP.            02270000
008117    05 PV-PHON-COUNT                  PIC S9(9)  VALUE ZEROES     02280001
008118                                                 COMP.            02290000
008119    05 PV-EMAL-COUNT                  PIC S9(9)  VALUE ZEROES     02300001
008120                                                 COMP.            02310000
008200    05 PV-BTCH-DATE.                                              02320000
008300       10 PV-BTCH-DATE-YYYY           PIC 9(04)  VALUE ZEROS.     02330000
008400       10 PV-BTCH-DATE-MM             PIC 9(02)  VALUE ZEROS.     02340000
008500       10 PV-BTCH-DATE-DD             PIC 9(02)  VALUE ZEROS.     02350000
008600    05 PV-BTCH-NBR.                                               02360000
008700       10 PV-BTCH-SEQ-NBR             PIC 9(1)   VALUE ZERO.      02370000
008800       10 PV-BTCH-MM                  PIC 9(2)   VALUE ZEROS.     02380000
008900       10 PV-BTCH-DD                  PIC 9(2)   VALUE ZEROS.     02390000
009202    05 PV-TRAILER-REC-CNT             PIC 9(15)  VALUE ZEROES.    02400015
008920    77 IN-REC-LENGTH                  PIC 9(5)   VALUE ZEROS.     02410013
008920    77 OUT-REC-LENGTH                 PIC 9(5)   VALUE ZEROS.     02420013
009000******************************************************************02430000
009100*                        WORK AREA                                02440000
009200******************************************************************02450000
009201 01 IN-TRAILER-RECORD.                                            02460015
009203    05 FILLER                       PIC X(08)  VALUE SPACES.      02470015
009202    05 IN-TRAILER-REC-CNT           PIC 9(15)  VALUE ZEROES.      02480015
009203    05 FILLER                       PIC X(550) VALUE SPACES.      02490015
009204                                                                  02500000
009201 01 OUT-TOTAL-RECORD.                                             02510015
009202    05 OUT-TOTAL-RECORD-COUNT       PIC 9(10) VALUE ZEROES.       02520015
009203    05 FILLER                       PIC X(70) VALUE SPACES.       02530015
009204                                                                  02540015
009205******************************************************************02550000
009206*                        COPYBOOKS                                02560000
009207******************************************************************02570000
009300                                                                  02580000
009400******************************************************************02590000
009500* FD CAP CARDHOLDER MASTER LAYOUT - VARIABLE FORMAT (INPUT)       02600002
009600******************************************************************02610000
009700*    COPY ARRD080.                                                02620014
009800                                                                  02630000
009900******************************************************************02640000
010000 PROCEDURE DIVISION.                                              02650000
010100******************************************************************02660000
010200*--------------*                                                  02670000
010300 0000-MAINLINE.                                                   02680000
010400*--------------*                                                  02690000
010500                                                                  02700000
010600     PERFORM Z050-INITIALIZE.                                     02710000
010700                                                                  02720000
010800     PERFORM 1000-PROCESS-CARD-MASTER-FILE.                       02730000
010900                                                                  02740000
011000     PERFORM Z100-END-PROC.                                       02750000
011100                                                                  02760000
011200     STOP RUN.                                                    02770000
011300                                                                  02780000
011400*-------------------------------*                                 02790000
011500 1000-PROCESS-CARD-MASTER-FILE.                                   02800000
011600*-------------------------------*                                 02810000
011700     SET PS-CONTINUE-PROCESSING TO TRUE.                          02820000
011800                                                                  02830000
011900     PERFORM 4000-READ-CAP-MASTER.                                02840004
012000                                                                  02850000
012100     PERFORM 2000-PROCESS-CARD-MASTER                             02860000
012200       UNTIL PS-STOP-PROCESSING.                                  02870000
012201                                                                  02880000
012202     PERFORM 5000-WRITE-OUTPUT-FILES.                             02890000
012203                                                                  02900000
012400*-------------------------------*                                 02910000
012500 2000-PROCESS-CARD-MASTER.                                        02920000
012600*-------------------------------*                                 02930000
013900                                                                  02940000
013901     IF IN-CAP-HEADER-REC                                         02950007
013901        PERFORM 4000-READ-CAP-MASTER                              02960004
013901     ELSE                                                         02970004
013901        IF IN-CAP-TRAILER-REC                                     02980007
013902           MOVE DBASE-DATA-GROUP-RECORD TO IN-TRAILER-RECORD      02990015
013902           MOVE IN-TRAILER-REC-CNT      TO PV-TRAILER-REC-CNT     03000015
013901           PERFORM 4000-READ-CAP-MASTER                           03010004
013901        ELSE                                                      03020004
013903           PERFORM 2100-PROCESS-MASTER-COUNTS                     03030004
013904           PERFORM 5100-WRITE-MSTR-REC                            03040004
013905           PERFORM 4000-READ-CAP-MASTER                           03050004
014603        END-IF                                                    03060004
014604     END-IF.                                                      03070004
014605                                                                  03080004
014607*-------------------------------*                                 03090000
014608 2100-PROCESS-MASTER-COUNTS.                                      03100000
014609*-------------------------------*                                 03110000
014606                                                                  03120004
014614     IF IN-CAP-CURL-REC                                           03130006
014618        ADD +1                      TO PV-CURL-COUNT              03140001
014619     END-IF.                                                      03150000
014606                                                                  03160006
014614     IF IN-CAP-CUEX-REC                                           03170006
014618        ADD +1                      TO PV-CUEX-COUNT              03180006
014619     END-IF.                                                      03190006
014606                                                                  03200006
014614     IF IN-CAP-CUID-REC                                           03210006
014618        ADD +1                      TO PV-CUID-COUNT              03220006
014619     END-IF.                                                      03230006
014606                                                                  03240006
014614     IF IN-CAP-PINS-REC                                           03250006
014618        ADD +1                      TO PV-PINS-COUNT              03260006
014619     END-IF.                                                      03270006
014606                                                                  03280006
014614     IF IN-CAP-PRST-REC                                           03290006
014618        ADD +1                      TO PV-PRST-COUNT              03300006
014619     END-IF.                                                      03310006
014606                                                                  03320006
014614     IF IN-CAP-PRPI-REC                                           03330006
014618        ADD +1                      TO PV-PRPI-COUNT              03340006
014619     END-IF.                                                      03350006
014606                                                                  03360006
014614     IF IN-CAP-ADEX-REC                                           03370006
014618        ADD +1                      TO PV-ADEX-COUNT              03380006
014619     END-IF.                                                      03390006
014606                                                                  03400006
014614     IF IN-CAP-PHON-REC                                           03410006
014618        ADD +1                      TO PV-PHON-COUNT              03420006
014619     END-IF.                                                      03430006
014606                                                                  03440006
014614     IF IN-CAP-EMAL-REC                                           03450006
014618        ADD +1                      TO PV-EMAL-COUNT              03460006
014619     END-IF.                                                      03470006
014620                                                                  03480006
014683                                                                  03490000
029321*-------------------------------*                                 03500000
029322 4000-READ-CAP-MASTER.                                            03510001
029323*-------------------------------*                                 03520000
029324                                                                  03530000
029325     READ CAP-MASTER-IN-FILE                                      03540001
029327       AT END                                                     03550000
029328        SET PS-STOP-PROCESSING TO TRUE                            03560000
029329     END-READ.                                                    03570000
029330                                                                  03580000
029331     IF NOT PS-STOP-PROCESSING                                    03590000
029332        ADD 1 TO PV-READ-COUNT                                    03600000
029333     END-IF.                                                      03610000
029334                                                                  03620000
029335*-------------------------------*                                 03630000
029336 5000-WRITE-OUTPUT-FILES.                                         03640000
029337*-------------------------------*                                 03650000
029338     PERFORM 5200-WRITE-CURL-CNT-REC.                             03660001
029339     PERFORM 5300-WRITE-CUEX-CNT-REC.                             03670001
029340     PERFORM 5400-WRITE-CUID-CNT-REC.                             03680001
029341     PERFORM 5500-WRITE-PINS-CNT-REC.                             03690001
029342     PERFORM 5600-WRITE-PRST-CNT-REC.                             03700001
029343     PERFORM 5700-WRITE-PRPI-CNT-REC.                             03710001
029344     PERFORM 5800-WRITE-ADEX-CNT-REC.                             03720001
029345     PERFORM 5900-WRITE-PHON-CNT-REC.                             03730001
029346     PERFORM 6000-WRITE-EMAL-CNT-REC.                             03740001
029349                                                                  03750000
029350*-------------------------------*                                 03760000
029351 5100-WRITE-MSTR-REC.                                             03770000
029352*-------------------------------*                                 03780000
029337                                                                  03790013
029350     MOVE IN-REC-LENGTH TO OUT-REC-LENGTH.                        03800013
029351                                                                  03810013
029352     EVALUATE TRUE                                                03820013
029337         WHEN IN-CAP-CURL-REC                                     03830013
029350             MOVE IN-CURL-REC (1:IN-REC-LENGTH)                   03840013
029351               TO OUT-CURL-REC                                    03850013
029352             WRITE OUT-CURL-REC                                   03860013
029376             ADD +1 TO PV-CRDMAST-COUNT                           03870020
029337                                                                  03880013
029373         WHEN IN-CAP-CUEX-REC                                     03890013
029374             MOVE IN-CUEX-REC (1:IN-REC-LENGTH)                   03900013
029375               TO OUT-CUEX-REC                                    03910013
029375             WRITE OUT-CUEX-REC                                   03920013
029376             ADD +1 TO PV-CRDMAST-COUNT                           03930020
029337                                                                  03940013
029373         WHEN IN-CAP-CUID-REC                                     03950013
029374            MOVE IN-CUID-REC (1:IN-REC-LENGTH)                    03960013
029375              TO OUT-CUID-REC                                     03970013
029375            WRITE OUT-CUID-REC                                    03980013
029376             ADD +1 TO PV-CRDMAST-COUNT                           03990020
029337                                                                  04000013
029373         WHEN IN-CAP-PINS-REC                                     04010013
029374            MOVE IN-PINS-REC (1:IN-REC-LENGTH)                    04020013
029375              TO OUT-PINS-REC                                     04030013
029375            WRITE OUT-PINS-REC                                    04040013
029376             ADD +1 TO PV-CRDMAST-COUNT                           04050020
029337                                                                  04060013
029373         WHEN IN-CAP-PRST-REC                                     04070013
029374            MOVE IN-PRST-REC (1:IN-REC-LENGTH)                    04080013
029375              TO OUT-PRST-REC                                     04090013
029375            WRITE OUT-PRST-REC                                    04100013
029376             ADD +1 TO PV-CRDMAST-COUNT                           04110020
029337                                                                  04120013
029373         WHEN IN-CAP-PRPI-REC                                     04130013
029374            MOVE IN-PRPI-REC (1:IN-REC-LENGTH)                    04140013
029375              TO OUT-PRPI-REC                                     04150013
029375            WRITE OUT-PRPI-REC                                    04160013
029376             ADD +1 TO PV-CRDMAST-COUNT                           04170020
029337                                                                  04180013
029373         WHEN IN-CAP-ADEX-REC                                     04190013
029374            MOVE IN-ADEX-REC (1:IN-REC-LENGTH)                    04200013
029375              TO OUT-ADEX-REC                                     04210013
029375            WRITE OUT-ADEX-REC                                    04220013
029376             ADD +1 TO PV-CRDMAST-COUNT                           04230020
029337                                                                  04240013
029373         WHEN IN-CAP-PHON-REC                                     04250013
029374            MOVE IN-PHON-REC (1:IN-REC-LENGTH)                    04260013
029375              TO OUT-PHON-REC                                     04270013
029375            WRITE OUT-PHON-REC                                    04280013
029376             ADD +1 TO PV-CRDMAST-COUNT                           04290020
029337                                                                  04300013
029373         WHEN IN-CAP-EMAL-REC                                     04310013
029374            MOVE IN-EMAL-REC (1:IN-REC-LENGTH)                    04320013
029375              TO OUT-EMAL-REC                                     04330013
029375            WRITE OUT-EMAL-REC                                    04340013
029376             ADD +1 TO PV-CRDMAST-COUNT                           04350020
029337                                                                  04360020
029373         WHEN IN-CAP-ACCB-REC                                     04370020
029374            MOVE IN-ACCB-REC (1:IN-REC-LENGTH)                    04380020
029375              TO OUT-ACCB-REC                                     04390020
029375            WRITE OUT-ACCB-REC                                    04400020
029376             ADD +1 TO PV-CRDMAST-COUNT                           04410020
029378                                                                  04420013
029373         WHEN IN-CAP-CMCB-REC                                     04430020
029374            MOVE IN-CMCB-REC (1:IN-REC-LENGTH)                    04440020
029375              TO OUT-CMCB-REC                                     04450020
029375            WRITE OUT-CMCB-REC                                    04460020
029376             ADD +1 TO PV-CRDMAST-COUNT                           04470020
029378                                                                  04480020
029373         WHEN IN-CAP-ALTC-REC                                     04490020
029374            MOVE IN-ALTC-REC (1:IN-REC-LENGTH)                    04500020
029375              TO OUT-ALTC-REC                                     04510020
029375            WRITE OUT-ALTC-REC                                    04520020
029376             ADD +1 TO PV-CRDMAST-COUNT                           04530020
029378                                                                  04540020
029373         WHEN IN-CAP-CCBR-REC                                     04550020
029374            MOVE IN-CCBR-REC (1:IN-REC-LENGTH)                    04560020
029375              TO OUT-CCBR-REC                                     04570020
029375            WRITE OUT-CCBR-REC                                    04580020
029376             ADD +1 TO PV-CRDMAST-COUNT                           04590020
029378                                                                  04600020
029378     END-EVALUATE.                                                04610013
029378                                                                  04620013
029379*-------------------------------*                                 04630000
029380 5200-WRITE-CURL-CNT-REC.                                         04640001
029381*-------------------------------*                                 04650000
029382     MOVE PV-CURL-COUNT                                           04660001
029383       TO OUT-TOTAL-RECORD-COUNT                                  04670000
029384     WRITE TOTAL-NBR-CAP-CURL-REC                                 04680001
029385        FROM OUT-TOTAL-RECORD.                                    04690000
029386                                                                  04700000
029387*-------------------------------*                                 04710000
029388 5300-WRITE-CUEX-CNT-REC.                                         04720001
029389*-------------------------------*                                 04730000
029390     MOVE PV-CUEX-COUNT                                           04740001
029391       TO OUT-TOTAL-RECORD-COUNT                                  04750000
029392     WRITE TOTAL-NBR-CAP-CUEX-REC                                 04760001
029393        FROM OUT-TOTAL-RECORD.                                    04770000
029394                                                                  04780000
029395*-------------------------------*                                 04790000
029396 5400-WRITE-CUID-CNT-REC.                                         04800001
029397*-------------------------------*                                 04810000
029398     MOVE PV-CUID-COUNT                                           04820001
029399       TO OUT-TOTAL-RECORD-COUNT                                  04830000
029400     WRITE TOTAL-NBR-CAP-CUID-REC                                 04840001
029401        FROM OUT-TOTAL-RECORD.                                    04850001
029402                                                                  04860000
029403*-------------------------------*                                 04870000
029404 5500-WRITE-PINS-CNT-REC.                                         04880001
029405*-------------------------------*                                 04890000
029406     MOVE PV-PINS-COUNT                                           04900001
029407       TO OUT-TOTAL-RECORD-COUNT                                  04910000
029408     WRITE TOTAL-NBR-CAP-PINS-REC                                 04920001
029409        FROM OUT-TOTAL-RECORD.                                    04930000
029410                                                                  04940000
029411*-------------------------------*                                 04950000
029412 5600-WRITE-PRST-CNT-REC.                                         04960001
029413*-------------------------------*                                 04970000
029414     MOVE PV-PRST-COUNT                                           04980001
029415       TO OUT-TOTAL-RECORD-COUNT                                  04990000
029416     WRITE TOTAL-NBR-CAP-PRST-REC                                 05000001
029417        FROM OUT-TOTAL-RECORD.                                    05010000
029418                                                                  05020000
029419*-------------------------------*                                 05030000
029420 5700-WRITE-PRPI-CNT-REC.                                         05040001
029421*-------------------------------*                                 05050000
029422     MOVE PV-PRPI-COUNT                                           05060001
029423       TO OUT-TOTAL-RECORD-COUNT                                  05070000
029424     WRITE TOTAL-NBR-CAP-PRPI-REC                                 05080001
029425        FROM OUT-TOTAL-RECORD.                                    05090000
029426                                                                  05100000
029427*-------------------------------*                                 05110000
029428 5800-WRITE-ADEX-CNT-REC.                                         05120001
029429*-------------------------------*                                 05130000
029430     MOVE PV-ADEX-COUNT                                           05140001
029431       TO OUT-TOTAL-RECORD-COUNT                                  05150000
029432     WRITE TOTAL-NBR-CAP-ADEX-REC                                 05160001
029433        FROM OUT-TOTAL-RECORD.                                    05170000
029434                                                                  05180000
029435*-------------------------------*                                 05190000
029436 5900-WRITE-PHON-CNT-REC.                                         05200001
029437*-------------------------------*                                 05210000
029438     MOVE PV-PHON-COUNT                                           05220001
029439       TO OUT-TOTAL-RECORD-COUNT                                  05230000
029440     WRITE TOTAL-NBR-CAP-PHON-REC                                 05240001
029441        FROM OUT-TOTAL-RECORD.                                    05250000
029442                                                                  05260000
029443*-------------------------------*                                 05270000
029444 6000-WRITE-EMAL-CNT-REC.                                         05280001
029445*-------------------------------*                                 05290000
029446     MOVE PV-EMAL-COUNT                                           05300001
029447       TO OUT-TOTAL-RECORD-COUNT                                  05310000
029448     WRITE TOTAL-NBR-CAP-EMAL-REC                                 05320001
029449        FROM OUT-TOTAL-RECORD.                                    05330000
029450                                                                  05340000
029467******************************************************************05350000
029468* Z050 - INITIALIZE                                               05360000
029469******************************************************************05370000
029470 Z050-INITIALIZE.                                                 05380000
029471                                                                  05390000
029472     OPEN INPUT  CAP-MASTER-IN-FILE                               05400001
029473     OPEN OUTPUT CAP-MASTER-OUT-FILE                              05410001
029474                 TOTAL-NBR-CAP-CURL-FILE                          05420001
029475                 TOTAL-NBR-CAP-CUEX-FILE                          05430001
029476                 TOTAL-NBR-CAP-CUID-FILE                          05440001
029477                 TOTAL-NBR-CAP-PINS-FILE                          05450001
029478                 TOTAL-NBR-CAP-PRST-FILE                          05460001
029479                 TOTAL-NBR-CAP-PRPI-FILE                          05470001
029480                 TOTAL-NBR-CAP-ADEX-FILE                          05480001
029481                 TOTAL-NBR-CAP-PHON-FILE                          05490001
029482                 TOTAL-NBR-CAP-EMAL-FILE.                         05500001
029485                                                                  05510000
029486****************************************                          05520001
029487* Z100 - PREFORMS TASK TERMINATION PROCESSING                     05530000
029488******************************************************************05540000
029489 Z100-END-PROC.                                                   05550000
029490     DISPLAY ' '.                                                 05560000
029491     DISPLAY '**********************'.                            05570000
029492     DISPLAY '   ARKUT083 CONTROLS  '.                            05580011
029493     DISPLAY '**********************'.                            05590000
029494     DISPLAY ' '.                                                 05600000
029495     DISPLAY 'RECORDS READ   : '    PV-READ-COUNT.                05610006
029496     DISPLAY 'MSTR REC WRITES: '    PV-CRDMAST-COUNT.             05620006
029497     DISPLAY 'CURL REC WRITES: '    PV-CURL-COUNT.                05630006
029498     DISPLAY 'CUEX REC WRITES: '    PV-CUEX-COUNT.                05640006
029499     DISPLAY 'CUID REC WRITES: '    PV-CUID-COUNT.                05650006
029500     DISPLAY 'PINS REC WRITES: '    PV-PINS-COUNT.                05660006
029501     DISPLAY 'PRST REC WRITES: '    PV-PRST-COUNT.                05670006
029502     DISPLAY 'PRPI REC WRITES: '    PV-PRPI-COUNT.                05680006
029503     DISPLAY 'ADEX REC WRITES: '    PV-ADEX-COUNT.                05690006
029504     DISPLAY 'PHON REC WRITES: '    PV-PHON-COUNT.                05700006
029505     DISPLAY 'EMAL REC WRITES: '    PV-EMAL-COUNT.                05710006
029508                                                                  05720016
029508     IF PV-READ-COUNT = 0                                         05730016
029509        DISPLAY ' '                                               05740016
029510        DISPLAY '*** NO CARD MASTER RECORDS TO REFORMAT ***'      05750016
029511     END-IF.                                                      05760016
029508                                                                  05770016
029508     IF PV-TRAILER-REC-CNT NOT EQUAL PV-READ-COUNT                05780017
029509        DISPLAY ' '                                               05790016
029510        DISPLAY '*** WARNING WARNING WARNING WARNING ***'         05800016
029510        DISPLAY '***************************************'         05810016
029510        DISPLAY '******* CAP MASTER TRAILER COUNT ******'         05820018
029510        DISPLAY '****** DOES NOT MATCH PROGRAM  ********'         05830016
029510        DISPLAY '*********  RECORD READ COUNT  *********'         05840016
029510        DISPLAY '**** WE MAY NOT HAVE RECEIVED *********'         05850017
029510        DISPLAY '******* ALL RECS FROM FDR !!! *********'         05860016
029510        DISPLAY '***************************************'         05870016
029509        DISPLAY ' '                                               05880016
029509        DISPLAY 'FD TRAILER COUNT = ' PV-TRAILER-REC-CNT          05890019
029509        DISPLAY ' ARKUT083  COUNT = ' PV-READ-COUNT               05900019
029509        DISPLAY ' '                                               05910019
029509        MOVE 0004 TO RETURN-CODE                                  05920019
029511     END-IF.                                                      05930016
029512                                                                  05940016
029513     CLOSE CAP-MASTER-IN-FILE                                     05950001
029514           CAP-MASTER-OUT-FILE                                    05960001
029515           TOTAL-NBR-CAP-CURL-FILE                                05970001
029516           TOTAL-NBR-CAP-CUEX-FILE                                05980001
029517           TOTAL-NBR-CAP-CUID-FILE                                05990001
029518           TOTAL-NBR-CAP-PINS-FILE                                06000001
029519           TOTAL-NBR-CAP-PRST-FILE                                06010001
029520           TOTAL-NBR-CAP-PRPI-FILE                                06020001
029521           TOTAL-NBR-CAP-ADEX-FILE                                06030001
029522           TOTAL-NBR-CAP-PHON-FILE                                06040001
029523           TOTAL-NBR-CAP-EMAL-FILE.                               06050001
029526                                                                  06060000
029534******************************************************************06070000
