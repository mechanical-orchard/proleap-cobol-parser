000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKUT217.                                         00020000
000300 AUTHOR.        JILL JUEL.                                        00030000
000400 DATE-WRITTEN.  JULY 2000.                                        00040000
000500 DATE-COMPILED.                                                   00050000
000600***************************************************************** 00060000
000700*            FORMAT EDI REMITTANCE FILE                         * 00070000
000800***************************************************************** 00080000
000900*  PURPOSE:  THE PURPOSE OF THIS PROGRAM IS TO FORMAT THE AP    * 00090000
001000*            REMITTANCE EXTRACT INTO THE EDI REMITTANCE ADVICE  * 00100000
001100*            FILE FOR THOSE VENDORS THAT ARE SET UP TO RECEIVE  * 00110000
001200*            THE 820 DOCUMENT.                                  * 00120000
001300***************************************************************** 00130000
001400*                                                               * 00140000
001500*  DB2 TABLES:  TEXTENT                                         * 00150000
001600*               TTRDPRT                                         * 00160000
001700*               TTRDTRN                                         * 00170000
001800*                                                               * 00180000
001900*   INPUT: AP-REMITTANCE-FILE                        APRD002    * 00190000
002000*     SORTED BY: REMIT VENDOR, PAYMENT ID REF,                  * 00200000
002100*                PO NUMBER,  INVOICE ID, RECORD                 * 00210000
002200*                TYPE CODE, AND ORIGIN                          * 00220000
002300*  OUTPUT: EDI-REMITTANCE-FILE                       APRD001    * 00230000
002400*                                                               * 00240000
002500***************************************************************** 00250000
002600* MAINTENANCE LOG:                                              * 00260000
002700*                                                               * 00270000
002800* 09/25/2000                                                    * 00280000
002900*    ADDED CODE TO REMOVE CHARACTERS THAT THE EDI TRANSLATOR    * 00290000
003000*    CONDSIDERS A SPECIAL CHARACTER, CAUSING THE IT TO ABEND.   * 00300000
003100*    ALSO CHANGED THE ADJ-REASON-CDE FROM RX TO A8. RX WOULD BE * 00310000
003200*    THE BETTER REASON CODE BUT IT IS NOT AVAILABLE UNTIL EDI   * 00320000
003300*    TRANSLATOR VERSION 4020, WE ARE CURRENTLY ON VERSION 4010. * 00330000
003400*    ADDED A CHECK TO SEE IF VENDOR STYLE IS SPACES, IF IT IS   * 00340000
003500*    THEN SPACES WAS MOVED TO MEMO-PRODUCT-CDE ELSE THE VENDOR  * 00350000
003600*    STYLE WAS MOVED AND VA WAS MOVED TO MEMO-PRODUCT-CDE, PER  * 00360000
003700*    EDI TEAM.                                                  * 00370000
003800* MADE BY: JILL JUEL                           WR# 20593        * 00380000
003900* 01/02/2001                                                    * 00390000
004000*    CHANGED LOGIC TO CREATE ADJUSTMENT WHEN ORIGIN IS 'ONL'    * 00400000
004100*    AND GROSS AMOUNT IS NEGATIVE.                              * 00410000
004200* MADE BY: L SCHALLHORN                        WR# 20593        * 00420000
004300*                                                               * 00430000
004400* 01/10/2001                                                    * 00440000
004500*    CHANGED DEFAULT REASON CODE LOGIC FOR "OTHER" IN C200-     * 00450000
004600*    PARAGRAPH TO MOVE 74 INSTEAD OF SPACES.                    * 00460000
004700* MADE BY: MARK BURNSIDE                       WR# 20704        * 00470000
004800*                                                               * 00480000
004900* 05/07/2001                                                    * 00490000
005000*    ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS     * 00500000
005100*    WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI        * 00510000
005200*    TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND     * 00520000
005300*    C600 WERE AFFECTED.  ADDED MORE TX CODES TO THE EVALUATE   * 00530000
005400*    STATEMENT IN PARAGRAPH C200.                               * 00540000
005500* MADE BY: KEVIN CATLIN                        WR# 22181        * 00550000
005600*                                                               * 00560000
005700* 03/20/2002                                                    * 00570000
005800*    RECOMPILE DID NOT PICK UP NEW COPYBOOK BACK ON 2-11-02     * 00580000
005900*    (PITS: P000438306).  RESENDING SOURCE AND COPYBOOK TO      * 00590000
006000*    PICK UP NEW COPYBOOK.                                      * 00600000
006100* MADE BY: MIKE BESKE                        PITS# 457138       * 00610000
006200*                                                               * 00620000
006300* 05/16/2002                                                    * 00630000
006400*   CHANGE MADE:  NI-SKU CHANGES.  RECOMPILE FROM PRODUCTION    * 00640000
006500*   TO INCORPORATE CHANGES TO COPYBOOK APRD002.                 * 00650000
006600* MADE BY:  KEVIN CATLIN                   WR/IR #: 21278       * 00660000
006700*                                                               * 00670000
006800* 02/07/2003                                                    * 00680000
006900*    CHANGE MADE: ARKPO PHASE3 PROJECT.                         * 00690000
007000*    UPDATED PGM TITLE TO MATCH THE SPEC TITLE.                 * 00700000
007100*    UPDATED PGM COMMENT BLOCK WITH THE FILENAMES.              * 00710000
007200*    IN PARAGRAPHS C200 AND C500 THE MOVE STMTS STRINGING THE   * 00720000
007300*    PO NUMBER INTO THE RESULT FIELD WERE CHANGED TO ACCOUNT    * 00730000
007400*    FOR THE FACT THAT THE SOURCE FIELD IS NOW 9 BYTES BUT THE  * 00740000
007500*    RESULT FIELD IS STILL 10 IN LENGTH.                        * 00750000
007600* MADE BY:  MIKE BESKE                          WR#: 23500      * 00760000
007700*                                                               * 00770000
007800* 04/11/2003                                                    * 00780000
007900*    CHANGE MADE: MOVE SPACES TO UNPRINTABLE CHARACTERS.  THIS  * 00790000
008000*    IS PREVENT THE EDI SUPPORT TEAM FROM NOT BEING ABLE TO     * 00800000
008100*    TRANSMIT THE FILE.                                         * 00810000
008200* MADE BY:  L SCHALLHORN                        WR#: 23417      * 00820000
008300*                                                               * 00830000
008400* DATE  04/30/2003                                              * 00840000
008500*     CHANGE MADE: IN PARAGRAPH C200-, ADDED NEW AP TRAN CODE   * 00850000
008600*     OF '11' (FOR THE AUTOMATED VENDOR CHARGEBACK) IN THE      * 00860000
008700*     EVALUATE STATEMENT.  EDI ADJUSTMENT REASON CODE WILL BE   * 00870000
008800*     '49' FOR THIS SITUATION.                                  * 00880000
008900*     MADE BY: KEVIN CATLIN            WR/IR #: P000544189      * 00890000
009000*                                                               * 00900000
009100* DATE  10/10/2003                                              * 00910000
009200*     CHANGE MADE: ADDED LOGIC THROUGHOUT PROGRAM TO REPLACE    * 00920000
009300*     LOW-VALUES IN ANY COMMENTS OR DOC NUMBER FIELDS WITH      * 00930000
009400*     SPACES.                                                   * 00940000
009500*     MADE BY: NANCY EILBES            WR/IR #: P000596332      * 00950000
009600*                                                               * 00960000
009700* DATE  12/12/2003                                              * 00970000
009800*     CHANGE MADE: ADD NEW CHECK FOR HEX VALUE '05' IN          * 00980000
009900*     COMMENT FIELD.  THIS IS TO PREVENT THE EDI TEAM FROM NOT  * 00990000
010000*     BEING ABLE TO TRANSMIT THE 820.                           * 01000000
010100*     MADE BY: MARK BURNSIDE           WR/IR #: P000616008      * 01010000
010200*                                                               * 01020000
010300* DATE  12/13/2003                                              * 01030000
010400*     CHANGE MADE: CHANGED THE CODE IN PARA C400- TO PICK UP    * 01040000
010500*     THE NEW FIELD NAME MEMO-SKU-UPC-NBR IN PLACE OF THE OLD   * 01050000
010600*     FIELD NAME MEMO-SKU-NBR ON INPUT AND OUTPUT.              * 01060000
010700*     MADE BY: MIKE BESKE              WR/IR #: WR24077         * 01070000
010800*                                                               * 01080000
010900* DATE  09/08/2004                                              * 01090000
011000*     CHANGE MADE: IN PARAGRAPH C200-, ADDED NEW AP TRANCODES   * 01100000
011100*     OF '91', '57' & '56' (BROADCAST TRANCODES) TO THE         * 01110000
011200*     EVALUATE STATEMENT.  EDI ADJUSTMENT REASON CODE WILL BE   * 01120000
011300*     '71' (ADVERTISING ALLOWANCE).  ADDED NEW AP TRANCODES     * 01130000
011400*     OF '0B' & '0C' (NEW STORE DISCOUNTS) TO THE               * 01140000
011500*     EVALUATE STATEMENT.  EDI ADJUSTMENT REASON CODE WILL BE   * 01150000
011600*     'A3' (NEW STORE ALLOWANCE).                               * 01160000
011700*     MADE BY: MIKE BESKE              WR/IR #: P000690013      * 01170000
011800*                                                               * 01180000
011900* DATE  09/09/2004                                              * 01190000
012000*     CHANGED MADE: STORE CONSTRAINTS PROJECT                   * 01200000
012100*     RECOMPILED THIS PROGRAM TO PICK UP THE APRD001            * 01210000
012200*     COPYBOOK MODIFICATIONS.                                   * 01220000
012300*     MADE BY: MIKE BESKE              WR/IR #: WR25805         * 01230000
012400*                                                               * 01240000
012500* DATE  03/02/2005                                              * 01250000
012600*     CHANGE MADE: ADDED LOGIC TO THE PARAGRAPH C100- TO        * 01260000
012700*     REPLACE ALL ASTERISKS IN THE VENDOR NAME WITH SPACES.     * 01270000
012800*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28424         * 01280000
012900*                                                               * 01290000
013000* DATE  03/02/2005                                              * 01300000
013100*     CHANGE MADE: NEW STORE DISCOUNT AUTOMATION                * 01310000
013200*     ADDED LOGIC TO THE PARAGRAPH C400- TO PASS 'DV'           * 01320000
013300*     (LOCATION) TO THE MEMO PRODUCT CODE AND ONE TO THE MEMO   * 01330000
013400*     ITEM QUANTITY ON THE EDI FILE FOR THE NSD DETAILS.  ALSO  * 01340000
013500*     ADDED LOGIC TO BYPASS THE EDI FILE FOR NSD WHEN THE UNIT  * 01350000
013600*     COST EQUALS ZERO.                                         * 01360000
013700*     MADE BY: KRYSTEN LEARY           WR/IR #: WR26679         * 01370000
013800*                                                               * 01380000
013900* DATE  05/27/2005                                              * 01390000
014000*     CHANGE MADE: IN PARAGRAPH C200-, ADDED NEW AP TRANCODES   * 01400000
014100*     OF '6A' & '6B' (COMPLIANCE NETWORK) TO THE EVALUATE       * 01410000
014200*     STATEMENT.  THESE WILL GET THE SAME REASON CODES AS       * 01420000
014300*     TRANCODES '60' AND '61', WHICH THEY ARE REPLACING.        * 01430000
014400*     MADE BY: MIKE BESKE              WR/IR #: P000690013      * 01440000
014500*                                                               * 01450000
014600* DATE  10/11/2007                                              * 01460000
014700*     CHANGE MADE: ADD NEW CHECK FOR HEX VALUE OF '1E' IN COMMENT 01470000
014800*     FIELD.  THIS IS TO PREVENT THE EDI TEAM FROM NOT          * 01480000
014900*     BEING ABLE TO TRANSMIT THE 820.                           * 01490000
015000*     MADE BY: MIKE BESKE              WR/IR #: INC000000108294 * 01500000
015100*                                                               * 01510000
015200* DATE  06/03/2008                                              * 01520000
015300*     CHANGE MADE: IN PARAGRAPH C200-, ADDED AP TRANCODES  OF   * 01530000
015400*     '89','93','94','95','96','97' (BRIDAL REGISTRY) TO THE    * 01540000
015500*     EVALUATE STATEMENT TO HAVE 'MA' (MARKETING ALLOWANCE)     * 01550000
015600*     ASSIGNED AS THE ADJUSTMENT REASON CODE PER USER REQUEST.  * 01560000
015700*     MADE BY: MIKE BESKE              WR/IR #: WR34276         * 01570000
015800*                                                               * 01580000
015900* DATE  06/04/2008                                              * 01590000
016000*     CHANGE MADE: IN PARAGRAPH C200-, REMOVED AP TRANCODES OF  * 01600000
016100*     '89','93','94' (BRIDAL REGISTRY) FROM THE EVALUATE STMT.  * 01610000
016200*     MADE BY: MIKE BESKE              WR/IR #: WR34276         * 01620000
016300*                                                               * 01630000
016400* DATE  09/23/2008                                              * 01640000
016500*     CHANGE MADE: IN PARAGRAPH C100-, UPDATED LOGIC TO SET     * 01650000
016600*     PAYMENT METHOD AND COMPANY NAME BASED ON PAYMENT CYCLE    * 01660000
016700*     VALUE.  THIS IS USED FOR CREATING EDI 820'S FOR TRADED    * 01670000
016800*     VOUCHERS.                                                 * 01680000
016900*     MADE BY: SCOTT KRUSCHKA          WR/IR #: WR34510         * 01690000
017000*                                                               * 01700000
017100* DATE  05/01/2009                                              * 01710000
017200*     CHANGE MADE: IN PARAGRAPH B200-, MODIFIED LOGIC THAT      * 01720000
017300*     CHECKS WHEN TO CREATE A NEW HEADER RECORD TO CHECK IF     * 01730000
017400*     EITHER THE PAYMENT-ID-REF OR THE VENDOR ID HAS CHANGED.   * 01740000
017500*     FOR TRADED VOUCHERS, IF THE 2 VENDORS ARE RELATED AS ONE  * 01750000
017600*     BUYER NUMBER IN THE PRIME REVENUE SYSTEM, THEY WILL HAVE  * 01760000
017700*     THE SAME PAYMENT REFERENCE NUMBER, SO A NEW HEADER WOULD  * 01770000
017800*     NOT BE CREATED IF WE DON'T ALSO LOOK FOR A CHANGE IN      * 01780000
017900*     VENDOR ID.                                                * 01790000
018000*     MADE BY: NANCY EILBES            WR/IR #: INC000000791568 * 01800000
018100*                                                               * 01810000
018200* DATE  02/03/2012                                              * 01820000
018300*     CHANGE MADE:                                              * 01830000
018400*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 01840000
018500*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 01850000
018600*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 01860000
018700*     C600 WERE AFFECTED. NEW VALUE WAS X'32'.                  * 01870000
018800*     MADE BY: NANCY EILBES            WR/IR #: CRQ000000019732 * 01880000
018900*                                                               * 01890000
019000* DATE  05/25/2012                                              * 01900000
019100*     CHANGE MADE:                                              * 01910000
019200*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 01920000
019300*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 01930000
019400*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 01940000
019500*     C600 WERE AFFECTED. NEW VALUE WAS X'AB'.                  * 01950000
019600*     MADE BY: NANCY EILBES            WR/IR #: CRQ000000026040 * 01960000
019700*                                                               * 01970000
019800* DATE  08/24/2012                                              * 01980000
019900*     CHANGE MADE:                                              * 01990000
020000*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02000000
020100*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02010000
020200*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02020000
020300*     C600 WERE AFFECTED. NEW VALUE WAS X'9B'.                  * 02030000
020400*     MADE BY: NANCY EILBES            WR/IR #: CRQ000000031357 * 02040000
020500*                                                               * 02050000
020600* DATE  11/08/2013                                              * 02060000
020700*     CHANGE MADE:                                              * 02070000
020800*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02080000
020900*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02090000
021000*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02100000
021100*     C600 WERE AFFECTED. NEW VALUE WAS X'15'.                  * 02110000
021200*     MADE BY: COGNIZANT               WR/IR #: CHG0068108      * 02120000
021300*                                                               * 02130000
021400* DATE  05/30/2014                                              * 02140000
021500*     CHANGE MADE:                                              * 02150000
021600*     INSPECT LOGIC TO REPLACE SPECIAL CHARACTER X'15' WAS      * 02160000
021700*     CHECKING SAME DATA ITEM ACROSS ALL PARAGRAPHS.            * 02170000
021800*     MODIFIED LOGIC TO CHECK RELEVANT DATA ITEMS IN EACH OF THE* 02180000
021900*     PARAGRAPH.                                                * 02190000
022000*     MADE BY: COGNIZANT               WR/IR #: CHG0083014      * 02200000
022100*                                                               * 02210000
022110* DATE  06/06/2014                                              * 02211000
022120*     CHANGE MADE:                                              * 02212000
022130*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02213000
022140*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02214000
022150*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02215000
022160*     C600 WERE AFFECTED. NEW VALUE WAS X'41'.                  * 02216000
022170*     MADE BY: COGNIZANT               WR/IR #: CHG0083651      * 02217000
022171*                                                               * 02217100
022172* DATE  10/15/2015                                              * 02217200
022173*     CHANGE MADE:                                              * 02217300
022174*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02217400
022175*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02217500
022176*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02217600
022177*     C600 WERE AFFECTED. NEW VALUE WAS X'FD'.                  * 02217700
022178*     MADE BY: COGNIZANT               WR/IR #: CHG0125759      * 02217800
022179*                                                               * 02217900
022180* DATE  04/25/2017                                              * 02218000
022181*     CHANGE MADE:                                              * 02218100
022182*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02218200
022183*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02218300
022184*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02218400
022185*     C600 WERE AFFECTED. NEW VALUE WAS X'B3'.                  * 02218500
022186*     MADE BY: COGNIZANT               WR/IR #: CHG0167321      * 02218600
022187*                                                               * 02218703
022188* DATE  06/14/2017                                              * 02218803
022189*     CHANGE MADE:                                              * 02218903
022190*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02219003
022191*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02219103
022192*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02219203
022193*     C600 WERE AFFECTED. NEW VALUE WAS X'0D'.                  * 02219303
022194*     MADE BY: NANCY EILBES            WR/IR #: CHG0170754      * 02219403
022195*                                                               * 02219505
022196* DATE  08/16/2019                                              * 02219604
022197*     CHANGE MADE:                                              * 02219704
022198*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02219804
022199*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02219904
022200*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02220004
022201*     C600 WERE AFFECTED. NEW VALUE WAS X'0A'.                  * 02220104
022202*     FIND FOR THE CODING TAG '229571' TO SEE THE CHANGES       * 02220205
022203*     MADE BY: SARVESWARAN NATTAMAI    WR/IR #: CHG0229571      * 02220305
022204*                                                               * 02220407
022205* DATE  10/21/2020                                              * 02220507
022206*     CHANGE MADE:                                              * 02220607
022207*     ADDED MORE INSPECT LOGIC TO REPLACE SPECIAL CHARACTERS    * 02220707
022208*     WITH ACCEPTABLE CHARACTERS THAT WON'T CAUSE THE EDI       * 02220807
022209*     TRANSLATOR TO ABEND.  PARAGRAPHS C200, C300, C500, AND    * 02220907
022210*     C600 WERE AFFECTED. NEW VALUE WAS X'CA'.                  * 02221007
022212*     MADE BY: NANCY EILBES            WR/IR #: CHG0250367      * 02221207
022204*                                                               * 02221308
022205* DATE  05/11/2021                                              * 02221408
022206*     CHANGE MADE:                                              * 02221508
022207*     PROCESS P01 (SEPHORA PRE-PAID) THE SAME AS M01            * 02221608
022212*     MADE BY: JEAN KURK  S            WR/IR #: CHG0256545      * 02222008
022213***************************************************************** 02222107
022214 ENVIRONMENT DIVISION.                                            02222207
022215 CONFIGURATION SECTION.                                           02222307
022216 SOURCE-COMPUTER.        IBM-370.                                 02222407
022220 OBJECT-COMPUTER.        IBM-370.                                 02223007
022300                                                                  02230000
022400 INPUT-OUTPUT SECTION.                                            02240000
022500                                                                  02250000
022600 FILE-CONTROL.                                                    02260000
022700     SELECT AP-REMITTANCE-FILE   ASSIGN TO INP01.                 02270000
022800     SELECT EDI-REMITTANCE-FILE  ASSIGN TO OUT01.                 02280000
022900                                                                  02290000
023000 DATA DIVISION.                                                   02300000
023100 FILE SECTION.                                                    02310000
023200                                                                  02320000
023300 FD  AP-REMITTANCE-FILE                                           02330000
023400     RECORDING MODE IS F                                          02340000
023500     LABEL RECORDS ARE STANDARD                                   02350000
023600     BLOCK CONTAINS 0 RECORDS                                     02360000
023700     RECORD CONTAINS 385 CHARACTERS                               02370000
023800     DATA RECORD IS AP-REMITTANCE-RECORD.                         02380000
023900                                                                  02390000
024000 01  AP-REMITTANCE-RECORD           PIC X(385).                   02400000
024100                                                                  02410000
024200 FD  EDI-REMITTANCE-FILE                                          02420000
024300     RECORDING MODE IS F                                          02430000
024400     LABEL RECORDS ARE STANDARD                                   02440000
024500     BLOCK CONTAINS 0 RECORDS                                     02450000
024600     RECORD CONTAINS 345 CHARACTERS                               02460000
024700     DATA RECORD IS EDI-REMITTANCE-RECORD.                        02470000
024800                                                                  02480000
024900 01  EDI-REMITTANCE-RECORD          PIC X(345).                   02490000
025000                                                                  02500000
025100 EJECT                                                            02510000
025200                                                                  02520000
025300 WORKING-STORAGE SECTION.                                         02530000
025400                                                                  02540000
025500 01  PROGRAM-SWITCHES.                                            02550000
025600     05  PS-AP-REMITTANCE-EOF        PIC X(01)  VALUE 'N'.        02560000
025700         88  NOT-AP-REMITTANCE-EOF              VALUE 'N'.        02570000
025800         88  AP-REMITTANCE-EOF                  VALUE 'Y'.        02580000
025900     05  PS-VENDOR-EDI-ELIGIBLE      PIC X(01)  VALUE 'N'.        02590000
026000         88  VENDOR-NOT-EDI-ELIGIBLE            VALUE 'N'.        02600000
026100         88  VENDOR-EDI-ELIGIBLE                VALUE 'Y'.        02610000
026200     05  PS-LINE-INV-SW              PIC X(01)  VALUE 'N'.        02620000
026300         88  PS-LINE-NOT-INV                    VALUE 'N'.        02630000
026400         88  PS-LINE-INV                        VALUE 'Y'.        02640000
026500                                                                  02650000
026600 01  PROGRAM-CONSTANTS.                                           02660000
026700     05  PC-KOHLS-DEPT-STORES        PIC X(35)  VALUE             02670000
026800        'KOHLS DEPARTMENT STORES            '.                    02680000
026900     05  PC-KOHLS-DEPT-STORES-TRADED PIC X(35)  VALUE             02690000
027000        'KOHLS DEPT STORES TRADED SCF       '.                    02700000
027100     05  PC-KOHLS-VENDOR-ID          PIC X(10)  VALUE             02710000
027200        '787408996 '.                                             02720000
027300**   KOHL'S COMPANY ID IS '3' PLUS OUR VENDOR ID                  02730000
027400     05  PC-KOHLS-COMPANY-ID         PIC X(10)  VALUE             02740000
027500        '3787408996'.                                             02750000
027600                                                                  02760000
027700 01  PROGRAM-VARIABLES.                                           02770000
027800     05  VENDOR-BEING-PROCESSED      PIC X(10)  VALUE SPACES.     02780000
027900     05  HOLD-PAYMENT-ID-REF         PIC X(30)  VALUE SPACES.     02790000
028000     05  PV-PAY-CYCLE-SEQ-NBR        PIC X(08)  VALUE SPACES.     02800000
028100                                                                  02810000
028200 01  PROGRAM-COUNTERS.                                            02820000
028300     05  COUNT-AP-REMIT-TOTAL        PIC 9(09)  VALUE 0.          02830000
028400     05  COUNT-AP-REMIT-PROCESSED    PIC 9(09)  VALUE 0.          02840000
028500     05  COUNT-AP-REMIT-BYPASSED     PIC 9(09)  VALUE 0.          02850000
028600                                                                  02860000
028700     05  COUNT-EDI-TOTAL             PIC 9(09)  VALUE 0.          02870000
028800     05  COUNT-EDI-HEADER            PIC 9(09)  VALUE 0.          02880000
028900     05  COUNT-EDI-ADJ-REMIT         PIC 9(09)  VALUE 0.          02890000
029000     05  COUNT-EDI-ADJ-COMMENT       PIC 9(09)  VALUE 0.          02900000
029100     05  COUNT-EDI-ADJ-MEMO          PIC 9(09)  VALUE 0.          02910000
029200     05  COUNT-EDI-INV-REMIT         PIC 9(09)  VALUE 0.          02920000
029300     05  COUNT-EDI-INV-COMMENT       PIC 9(09)  VALUE 0.          02930000
029400     05  COUNT-EDI-DISC-ADJ          PIC 9(09)  VALUE 0.          02940000
029500     05  COUNT-EDI-DISC-COMMENT      PIC 9(09)  VALUE 0.          02950000
029600     05  BYPASS-EDI-ADJ-MEMO         PIC 9(09)  VALUE 0.          02960000
029700                                                                  02970000
029800 01  ABEND-CODE                      PIC S9(04) VALUE 0 COMP SYNC.02980000
029900     88  AC-BAD-WRITE                           VALUE  +4001.     02990000
030000     88  AC-CONTROL-CARD-ERROR                  VALUE  +4003.     03000000
030100     88  AC-OPEN-ERROR                          VALUE  +4005.     03010000
030200     88  AC-CLOSE-ERROR                         VALUE  +4006.     03020000
030300     88  AC-BAD-DATA                            VALUE  +4008.     03030000
030400     88  AC-DB2-ERROR                           VALUE  +4013.     03040000
030500     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     03050000
030600     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     03060000
030700     88  AC-DATE-ERROR                          VALUE  +4019.     03070000
030800                                                                  03080000
030900 01  ABEND-AREAS.                                                 03090000
031000     05  AA-ABEND-LIT                PIC X(40)  VALUE             03100000
031100             '*****       ABEND'.                                 03110000
031200     05  AA-PROGRAM-LIT              PIC X(40)  VALUE             03120000
031300             '*****   PROGRAM: APKUT217'.                         03130000
031400     05  AA-PARAGRAPH-LIT.                                        03140000
031500         10  FILLER                  PIC X(17)  VALUE             03150000
031600             '***** PARAGRAPH: '.                                 03160000
031700         10  AA-PARAGRAPH-NAME       PIC X(35)  VALUE SPACES.     03170000
031800     05  AA-MESSAGE-LINE.                                         03180000
031900         10  FILLER                  PIC X(06)  VALUE '*****'.    03190000
032000         10  AA-MESSAGE              PIC X(127) VALUE SPACES.     03200000
032100         10  FILLER REDEFINES AA-MESSAGE.                         03210000
032200             15 AA-MESSAGE-1         PIC X(45).                   03220000
032300             15 AA-MESSAGE-2         PIC X(45).                   03230000
032400             15 AA-MESSAGE-3         PIC X(37).                   03240000
032500     05  AA-DB2-ERROR-LIT            PIC X(40)  VALUE             03250000
032600             '*****    DB2 ERROR'.                                03260000
032700     05  AA-DB2-OPERATION-LIT.                                    03270000
032800         10  FILLER                  PIC X(17)  VALUE             03280000
032900             '***** OPERATION: '.                                 03290000
033000         10  AA-DB2-OPERATION.                                    03300000
033100             15  AA-DB2-OP-1         PIC X(25)  VALUE SPACES.     03310000
033200             15  AA-DB2-OP-2         PIC X(25)  VALUE SPACES.     03320000
033300     05  AA-DB2-TABLE-1              PIC X(18)  VALUE SPACES.     03330000
033400     05  AA-DB2-TABLE-2              PIC X(18)  VALUE SPACES.     03340000
033500     05  AA-DB2-TABLE-3              PIC X(18)  VALUE SPACES.     03350000
033600 EJECT                                                            03360000
033700                                                                  03370000
033800*--------------------------------------------------------------*  03380000
033900*   THIS IS THE RECORD LAYOUT FOR THE EDI REMITTANCE INFO      *  03390000
034000*   EXTRACT.                                                   *  03400000
034100*--------------------------------------------------------------*  03410000
034200     COPY APRD001.                                                03420000
034300 EJECT                                                            03430000
034400                                                                  03440000
034500*--------------------------------------------------------------*  03450000
034600*   THIS IS THE RECORD LAYOUT FOR THE AP REMITTANCE INFO       *  03460000
034700*   EXTRACT.                                                   *  03470000
034800*--------------------------------------------------------------*  03480000
034900     COPY APRD002.                                                03490000
035000 EJECT                                                            03500000
035100                                                                  03510000
035200*--------------------------------------------------------------*  03520000
035300*  DPWS004 CONTAINS THE FIELDS NECESSARY TO CALL THE SQLCA     *  03530000
035400*  MESSAGE MODULE 'DSNTIAR' AND DISPLAY THE FORMATTED RESULTS. *  03540000
035500*--------------------------------------------------------------*  03550000
035600     COPY DPWS004.                                                03560000
035700 EJECT                                                            03570000
035800                                                                  03580000
035900*-------------------------------------------------------------*   03590000
036000*  EXTERNAL ENTITY ID TABLE                                   *   03600000
036100*-------------------------------------------------------------*   03610000
036200     EXEC SQL                                                     03620000
036300          INCLUDE TEXTENT                                         03630000
036400     END-EXEC.                                                    03640000
036500 EJECT                                                            03650000
036600                                                                  03660000
036700*--------------------------------------------------------------*  03670000
036800*  TTRDPRT                                                     *  03680000
036900*--------------------------------------------------------------*  03690000
037000     EXEC SQL                                                     03700000
037100          INCLUDE TTRDPRT                                         03710000
037200     END-EXEC.                                                    03720000
037300 EJECT                                                            03730000
037400                                                                  03740000
037500*--------------------------------------------------------------*  03750000
037600*  TTRDTRN                                                     *  03760000
037700*--------------------------------------------------------------*  03770000
037800     EXEC SQL                                                     03780000
037900          INCLUDE TTRDTRN                                         03790000
038000     END-EXEC.                                                    03800000
038100 EJECT                                                            03810000
038200                                                                  03820000
038300*--------------------------------------------------------------*  03830000
038400*  COMMUNICATIONS AREA2 FOR DB2                                *  03840000
038500*--------------------------------------------------------------*  03850000
038600     COPY SQLCA2.                                                 03860000
038700*--------------------------------------------------------------*  03870000
038800*     SQL COMMUNICATIONS AREA DCLGEN                           *  03880000
038900*--------------------------------------------------------------*  03890000
039000     EXEC SQL                                                     03900000
039100         INCLUDE SQLCA                                            03910000
039200     END-EXEC.                                                    03920000
039300 EJECT                                                            03930000
039400                                                                  03940000
039500 LINKAGE SECTION.                                                 03950000
039600************************                                          03960000
039700 PROCEDURE DIVISION.                                              03970000
039800************************                                          03980000
039900 A100-MAINLINE-ROUTINE.                                           03990000
040000                                                                  04000000
040100     PERFORM B100-INITIALIZATION.                                 04010000
040200                                                                  04020000
040300     PERFORM B200-PROCESS-AP-REMITTANCE                           04030000
040400       UNTIL AP-REMITTANCE-EOF.                                   04040000
040500                                                                  04050000
040600     PERFORM B300-TERMINATION.                                    04060000
040700     GOBACK.                                                      04070000
040800                                                                  04080000
040900*--------------------------------------------------------------*  04090000
041000*  INITIALIZATION PROCESSING                                   *  04100000
041100*--------------------------------------------------------------*  04110000
041200 B100-INITIALIZATION.                                             04120000
041300                                                                  04130000
041400     DISPLAY ' '.                                                 04140000
041500     DISPLAY '**--------------- APKUT217 --------------------**'. 04150000
041600     DISPLAY 'DATE ' FUNCTION CURRENT-DATE(1:8)                   04160000
041700           '  TIME ' FUNCTION CURRENT-DATE(9:6)                   04170000
041800                                                                  04180000
041900     OPEN  INPUT AP-REMITTANCE-FILE                               04190000
042000          OUTPUT EDI-REMITTANCE-FILE.                             04200000
042100                                                                  04210000
042200     PERFORM R100-READ-AP-REMITTANCE.                             04220000
042300 EJECT.                                                           04230000
042400                                                                  04240000
042500*--------------------------------------------------------------*  04250000
042600* PROCESS THE AP REMITTANCE FILE                               *  04260000
042700*--------------------------------------------------------------*  04270000
042800 B200-PROCESS-AP-REMITTANCE.                                      04280000
042900                                                                  04290000
043000     IF AP002-REMIT-VENDOR NOT = VENDOR-BEING-PROCESSED           04300000
043100        PERFORM S100-SELECT-VENDOR-ELIGIBLITY                     04310000
043200     END-IF.                                                      04320000
043300                                                                  04330000
043400     IF VENDOR-EDI-ELIGIBLE                                       04340000
043500        ADD 1 TO COUNT-AP-REMIT-PROCESSED                         04350000
043600        IF AP002-PAYMENT-ID-REF NOT = HOLD-PAYMENT-ID-REF         04360000
043700        OR AP002-REMIT-VENDOR NOT = VENDOR-BEING-PROCESSED        04370000
043800           PERFORM C100-CREATE-EDI-HEADER                         04380000
043900        END-IF                                                    04390000
044000        IF REMIT-LINE-RECORD                                      04400000
044100           SET PS-LINE-NOT-INV TO TRUE                            04410000
044200*          IF (AP002-ORIGIN = 'M01' OR 'M02' OR 'I70' OR 'C80')   04420008
044200           IF (AP002-ORIGIN = 'M01' OR 'M02' OR 'I70'             04421009
044200                                             OR 'C80' OR 'P01')   04422009
044300               OR                                                 04430000
044400              (AP002-ORIGIN = 'ONL' AND AP002-GROSS-AMT >= 0)     04440000
044500              SET PS-LINE-INV TO TRUE                             04450000
044600              PERFORM C500-CREATE-EDI-INV-REMIT                   04460000
044700           ELSE                                                   04470000
044800              PERFORM C200-CREATE-EDI-ADJ-REMIT                   04480000
044900           END-IF                                                 04490000
045000        END-IF                                                    04500000
045100        IF REMIT-COMMENT-RECORD                                   04510000
045200*          IF (AP002-ORIGIN = 'M01' OR 'M02' OR 'I70' OR 'C80')   04520008
044200           IF (AP002-ORIGIN = 'M01' OR 'M02' OR 'I70'             04521009
044200                                             OR 'C80' OR 'P01')   04522009
045300               OR                                                 04530000
045400              (AP002-ORIGIN = 'ONL' AND PS-LINE-INV)              04540000
045500              PERFORM C600-CREATE-EDI-INV-COMMENT                 04550000
045600           ELSE                                                   04560000
045700              PERFORM C300-CREATE-EDI-ADJ-COMMENT                 04570000
045800           END-IF                                                 04580000
045900        END-IF                                                    04590000
046000        IF MEMO-LINE-RECORD                                       04600000
046100           PERFORM C400-CREATE-EDI-ADJ-MEMO                       04610000
046200        END-IF                                                    04620000
046300     ELSE                                                         04630000
046400        ADD  1 TO COUNT-AP-REMIT-BYPASSED                         04640000
046500     END-IF.                                                      04650000
046600                                                                  04660000
046700     MOVE AP002-REMIT-VENDOR   TO VENDOR-BEING-PROCESSED.         04670000
046800     MOVE AP002-PAYMENT-ID-REF TO HOLD-PAYMENT-ID-REF.            04680000
046900     PERFORM R100-READ-AP-REMITTANCE.                             04690000
047000                                                                  04700000
047100 EJECT.                                                           04710000
047200                                                                  04720000
047300*--------------------------------------------------------------*  04730000
047400*  END OF PROGRAM PROCESSING                                   *  04740000
047500*--------------------------------------------------------------*  04750000
047600 B300-TERMINATION.                                                04760000
047700     DISPLAY '**********************************************'.    04770000
047800     DISPLAY '**         APKUT217 RECORD COUNTS           **'.    04780000
047900     DISPLAY '**********************************************'.    04790000
048000     DISPLAY ' AP REMIT TOTAL      ' COUNT-AP-REMIT-TOTAL         04800000
048100     DISPLAY ' AP REMIT PROCESSED  ' COUNT-AP-REMIT-PROCESSED     04810000
048200     DISPLAY ' AP REMIT BYPASSED   ' COUNT-AP-REMIT-BYPASSED      04820000
048300     DISPLAY ' '                                                  04830000
048400     DISPLAY ' EDI TOTAL           ' COUNT-EDI-TOTAL              04840000
048500     DISPLAY ' EDI HEADER          ' COUNT-EDI-HEADER             04850000
048600     DISPLAY ' EDI ADJ REMIT       ' COUNT-EDI-ADJ-REMIT          04860000
048700     DISPLAY ' EDI ADJ COMMENT     ' COUNT-EDI-ADJ-COMMENT        04870000
048800     DISPLAY ' EDI ADJ MEMO        ' COUNT-EDI-ADJ-MEMO           04880000
048900     DISPLAY ' BYPASSED ADJ MEMO   ' BYPASS-EDI-ADJ-MEMO          04890000
049000     DISPLAY ' EDI INV REMIT       ' COUNT-EDI-INV-REMIT          04900000
049100     DISPLAY ' EDI INV COMMENT     ' COUNT-EDI-INV-COMMENT        04910000
049200     DISPLAY ' EDI DISC ADJ        ' COUNT-EDI-DISC-ADJ           04920000
049300     DISPLAY ' EDI DISC COMMENT    ' COUNT-EDI-DISC-COMMENT       04930000
049400     DISPLAY '**********************************************'.    04940000
049500                                                                  04950000
049600     CLOSE AP-REMITTANCE-FILE                                     04960000
049700           EDI-REMITTANCE-FILE.                                   04970000
049800 EJECT.                                                           04980000
049900                                                                  04990000
050000*--------------------------------------------------------------*  05000000
050100* CREATE EDI REMITTANCE HEADER RECORD                          *  05010000
050200*--------------------------------------------------------------*  05020000
050300 C100-CREATE-EDI-HEADER.                                          05030000
050400     INITIALIZE AP001-PAYMENT-REMIT-RECORD.                       05040000
050500     INITIALIZE AP001-REMIT-HEADER-RECD.                          05050000
050600     MOVE AP002-REMIT-VENDOR     TO AP001-VENDOR-ID.              05060000
050700     MOVE AP002-PAYMENT-ID-REF   TO AP001-CHECK-NBR.              05070000
050800     MOVE AP002-PYMT-DTE         TO AP001-PYMT-DTE.               05080000
050900     MOVE AP002-VCHR-VENDOR-ID   TO AP001-VCHR-VENDOR-ID.         05090000
051000     MOVE TRDTRN-PROD-TEST-IND   TO AP001-PROD-TEST-CDE.          05100000
051100     SET  REMIT-HEADER-RECORD TO TRUE.                            05110000
051200**   REQUEST PER EDI, ADD LEADING ZERO TO ENT-ID                  05120000
051300     MOVE ZERO                   TO AP001-HDR-ENT-ID(1:1).        05130000
051400     MOVE EXTENT-ENT-ID          TO AP001-HDR-ENT-ID(2:9).        05140000
051500     MOVE 'I'                    TO AP001-HDR-TRAN-CDE.           05150000
051600     MOVE AP002-PYMNT-AMT        TO AP001-HDR-CHECK-AMT.          05160000
051700     MOVE 'C'                    TO AP001-HDR-CR-DR-CDE.          05170000
051800                                                                  05180000
051900     IF AP002-PAY-CYCLE = 'TRADED'                                05190000
052000        SET PYMT-MTHD-ACH TO TRUE                                 05200000
052100        MOVE PC-KOHLS-DEPT-STORES-TRADED                          05210000
052200                                  TO AP001-HDR-ORIG-COMPANY-NME   05220000
052300     ELSE                                                         05230000
052400        SET PYMT-MTHD-CHECK TO TRUE                               05240000
052500        MOVE PC-KOHLS-DEPT-STORES TO AP001-HDR-ORIG-COMPANY-NME   05250000
052600     END-IF.                                                      05260000
052700                                                                  05270000
052800     IF EXTENT-VND-CLSN-CDE  = 'E'                                05280000
052900        MOVE 'E' TO AP001-HDR-PAYEE-TYP                           05290000
053000     ELSE                                                         05300000
053100        MOVE 'V' TO AP001-HDR-PAYEE-TYP                           05310000
053200     END-IF.                                                      05320000
053300                                                                  05330000
053400     MOVE SPACES                 TO AP001-HDR-ODFI-ROUTING-NBR.   05340000
053500     MOVE SPACES                 TO AP001-HDR-ODFI-ACCT-NBR.      05350000
053600     MOVE PC-KOHLS-COMPANY-ID    TO AP001-HDR-ORIG-COMPANY-ID.    05360000
053700     MOVE SPACES                 TO AP001-HDR-RDFI-ROUTING-NBR.   05370000
053800     MOVE SPACES                 TO AP001-HDR-RDFI-ACCT-NBR.      05380000
053900** SETTLEMENT DATE IS A REQUIRED FIELD, USE PAYMENT DATE PER EDI  05390000
054000     MOVE AP002-PYMT-CC          TO AP001-HDR-SETTLEMENT-CC.      05400000
054100     MOVE AP002-PYMT-YY          TO AP001-HDR-SETTLEMENT-YY.      05410000
054200     MOVE AP002-PYMT-MM          TO AP001-HDR-SETTLEMENT-MM.      05420000
054300     MOVE AP002-PYMT-DD          TO AP001-HDR-SETTLEMENT-DD.      05430000
054400     MOVE AP002-PAYMENT-ID-REF   TO AP001-HDR-CHECK-NBR.          05440000
054500                                                                  05450000
054600     MOVE AP002-PAY-CYCLE-SEQ-NBR TO PV-PAY-CYCLE-SEQ-NBR         05460000
054700     STRING AP002-PAY-CYCLE           DELIMITED BY SIZE           05470000
054800            '-'                       DELIMITED BY SIZE           05480000
054900            PV-PAY-CYCLE-SEQ-NBR(6:3) DELIMITED BY SIZE           05490000
055000       INTO AP001-HDR-PAY-CYCLE-SEQ-NBR                           05500000
055100     END-STRING.                                                  05510000
055200                                                                  05520000
055300     MOVE AP002-PYMT-CC          TO AP001-HDR-CHECK-CC.           05530000
055400     MOVE AP002-PYMT-YY          TO AP001-HDR-CHECK-YY.           05540000
055500     MOVE AP002-PYMT-MM          TO AP001-HDR-CHECK-MM.           05550000
055600     MOVE AP002-PYMT-DD          TO AP001-HDR-CHECK-DD.           05560000
055700     MOVE PC-KOHLS-VENDOR-ID     TO AP001-HDR-ORIG-CO-VENDOR-ID.  05570000
055800     MOVE AP002-VCHR-VENDOR-NME  TO AP001-HDR-VCHR-VENDOR-NME.    05580000
055900     INSPECT AP001-HDR-VCHR-VENDOR-NME                            05590000
056000             REPLACING ALL '*' BY ' '.                            05600000
056100     MOVE AP002-VCHR-VENDOR-ID   TO AP001-HDR-VCHR-VENDOR-ID.     05610000
056200                                                                  05620000
056300     ADD 1 TO COUNT-EDI-HEADER                                    05630000
056400     PERFORM W100-WRITE-EDI-REMITTANCE.                           05640000
056500 EJECT.                                                           05650000
056600                                                                  05660000
056700*--------------------------------------------------------------*  05670000
056800* CREATE EDI ADJUSTMENT REMITTANCE RECORD                      *  05680000
056900*--------------------------------------------------------------*  05690000
057000 C200-CREATE-EDI-ADJ-REMIT.                                       05700000
057100     INITIALIZE AP001-ADJUSTMENT-RECD.                            05710000
057200     SET ADJUSTMENT-REMIT-RECORD TO TRUE.                         05720000
057300     MOVE AP002-NET-AMT          TO AP001-ADJ-NET-AMT.            05730000
057400                                                                  05740000
057500     EVALUATE AP002-AP-TRN-CDE                                    05750000
057600         WHEN '0B'                                                05760000
057700              MOVE 'A3'          TO AP001-ADJ-REASON-CDE          05770000
057800         WHEN '0C'                                                05780000
057900              MOVE 'A3'          TO AP001-ADJ-REASON-CDE          05790000
058000         WHEN '03'                                                05800000
058100              MOVE '74'          TO AP001-ADJ-REASON-CDE          05810000
058200         WHEN '04'                                                05820000
058300              MOVE 'B6'          TO AP001-ADJ-REASON-CDE          05830000
058400         WHEN '05'                                                05840000
058500              MOVE 'D3'          TO AP001-ADJ-REASON-CDE          05850000
058600         WHEN '06'                                                05860000
058700              MOVE '74'          TO AP001-ADJ-REASON-CDE          05870000
058800         WHEN '07'                                                05880000
058900              MOVE '74'          TO AP001-ADJ-REASON-CDE          05890000
059000         WHEN '08'                                                05900000
059100              MOVE '74'          TO AP001-ADJ-REASON-CDE          05910000
059200         WHEN '10'                                                05920000
059300              MOVE '01'          TO AP001-ADJ-REASON-CDE          05930000
059400         WHEN '11'                                                05940000
059500              MOVE '49'          TO AP001-ADJ-REASON-CDE          05950000
059600         WHEN '12'                                                05960000
059700              MOVE '59'          TO AP001-ADJ-REASON-CDE          05970000
059800         WHEN '13'                                                05980000
059900              MOVE '46'          TO AP001-ADJ-REASON-CDE          05990000
060000         WHEN '15'                                                06000000
060100              MOVE '29'          TO AP001-ADJ-REASON-CDE          06010000
060200         WHEN '16'                                                06020000
060300              MOVE '01'          TO AP001-ADJ-REASON-CDE          06030000
060400         WHEN '18'                                                06040000
060500              MOVE '93'          TO AP001-ADJ-REASON-CDE          06050000
060600         WHEN '20'                                                06060000
060700              MOVE '15'          TO AP001-ADJ-REASON-CDE          06070000
060800         WHEN '21'                                                06080000
060900              MOVE '93'          TO AP001-ADJ-REASON-CDE          06090000
061000         WHEN '22'                                                06100000
061100              MOVE '11'          TO AP001-ADJ-REASON-CDE          06110000
061200         WHEN '23'                                                06120000
061300              MOVE '92'          TO AP001-ADJ-REASON-CDE          06130000
061400         WHEN '24'                                                06140000
061500              MOVE 'A8'          TO AP001-ADJ-REASON-CDE          06150000
061600         WHEN '25'                                                06160000
061700              MOVE 'A8'          TO AP001-ADJ-REASON-CDE          06170000
061800         WHEN '26'                                                06180000
061900              MOVE 'A8'          TO AP001-ADJ-REASON-CDE          06190000
062000         WHEN '27'                                                06200000
062100              MOVE 'BE'          TO AP001-ADJ-REASON-CDE          06210000
062200         WHEN '30'                                                06220000
062300              MOVE '49'          TO AP001-ADJ-REASON-CDE          06230000
062400         WHEN '31'                                                06240000
062500              MOVE '74'          TO AP001-ADJ-REASON-CDE          06250000
062600         WHEN '32'                                                06260000
062700              MOVE '74'          TO AP001-ADJ-REASON-CDE          06270000
062800         WHEN '38'                                                06280000
062900              MOVE '74'          TO AP001-ADJ-REASON-CDE          06290000
063000         WHEN '39'                                                06300000
063100              MOVE '74'          TO AP001-ADJ-REASON-CDE          06310000
063200         WHEN '41'                                                06320000
063300              MOVE '74'          TO AP001-ADJ-REASON-CDE          06330000
063400         WHEN '42'                                                06340000
063500              MOVE '74'          TO AP001-ADJ-REASON-CDE          06350000
063600         WHEN '47'                                                06360000
063700              MOVE 'A3'          TO AP001-ADJ-REASON-CDE          06370000
063800         WHEN '48'                                                06380000
063900              MOVE 'B6'          TO AP001-ADJ-REASON-CDE          06390000
064000         WHEN '56'                                                06400000
064100              MOVE '71'          TO AP001-ADJ-REASON-CDE          06410000
064200         WHEN '57'                                                06420000
064300              MOVE '71'          TO AP001-ADJ-REASON-CDE          06430000
064400         WHEN '6A'                                                06440000
064500              MOVE '49'          TO AP001-ADJ-REASON-CDE          06450000
064600         WHEN '6B'                                                06460000
064700              MOVE '74'          TO AP001-ADJ-REASON-CDE          06470000
064800         WHEN '60'                                                06480000
064900              MOVE '49'          TO AP001-ADJ-REASON-CDE          06490000
065000         WHEN '61'                                                06500000
065100              MOVE '74'          TO AP001-ADJ-REASON-CDE          06510000
065200         WHEN '62'                                                06520000
065300              MOVE '49'          TO AP001-ADJ-REASON-CDE          06530000
065400         WHEN '67'                                                06540000
065500              MOVE '74'          TO AP001-ADJ-REASON-CDE          06550000
065600         WHEN '68'                                                06560000
065700              MOVE '74'          TO AP001-ADJ-REASON-CDE          06570000
065800         WHEN '81'                                                06580000
065900              MOVE 'A3'          TO AP001-ADJ-REASON-CDE          06590000
066000         WHEN '91'                                                06600000
066100              MOVE '71'          TO AP001-ADJ-REASON-CDE          06610000
066200         WHEN '95'                                                06620000
066300         WHEN '96'                                                06630000
066400         WHEN '97'                                                06640000
066500              MOVE 'MA'          TO AP001-ADJ-REASON-CDE          06650000
066600         WHEN OTHER                                               06660000
066700              MOVE '74'          TO AP001-ADJ-REASON-CDE          06670000
066800     END-EVALUATE.                                                06680000
066900                                                                  06690000
067000     MOVE 'AM'                   TO AP001-ADJ-REF-ID-QUAL.        06700000
067100     IF AP002-INVOICE-ID = SPACES                                 06710000
067200        MOVE 'INVOICE NBR UNKNOWN'  TO AP001-ADJ-DOC-NBR          06720000
067300     ELSE                                                         06730000
067400        MOVE AP002-INVOICE-ID       TO AP001-ADJ-DOC-NBR          06740000
067500        INSPECT AP001-ADJ-DOC-NBR                                 06750000
067600                REPLACING ALL X'0D25' BY '  '                     06760000
067700        INSPECT AP001-ADJ-DOC-NBR                                 06770000
067800                REPLACING ALL '`' BY "'"                          06780000
067900        INSPECT AP001-ADJ-DOC-NBR                                 06790000
068000                REPLACING ALL '' BY '('                          06800000
068100        INSPECT AP001-ADJ-DOC-NBR                                 06810000
068200                REPLACING ALL '' BY ')'                          06820000
068300        INSPECT AP001-ADJ-DOC-NBR                                 06830000
068400                REPLACING ALL '' BY ' '                          06840000
068500        INSPECT AP001-ADJ-DOC-NBR                                 06850000
068600                REPLACING ALL X'B7' BY ' '                        06860000
068700        INSPECT AP001-ADJ-DOC-NBR                                 06870000
068800                REPLACING ALL X'B8' BY ' '                        06880000
068900        INSPECT AP001-ADJ-DOC-NBR                                 06890000
069000                REPLACING ALL '~' BY ' '                          06900000
069100        INSPECT AP001-ADJ-DOC-NBR                                 06910000
069200                REPLACING ALL '<' BY '('                          06920000
069300        INSPECT AP001-ADJ-DOC-NBR                                 06930000
069400                REPLACING ALL '>' BY ')'                          06940000
069500        INSPECT AP001-ADJ-DOC-NBR                                 06950000
069600                REPLACING ALL '|' BY ' '                          06960000
069700        INSPECT AP001-ADJ-DOC-NBR                                 06970000
069800                REPLACING ALL '!' BY ' '                          06980000
069900        INSPECT AP001-ADJ-DOC-NBR                                 06990000
070000                REPLACING ALL X'00' BY ' '                        07000000
070100        INSPECT AP001-ADJ-DOC-NBR                                 07010000
070200                REPLACING ALL X'05' BY ' '                        07020000
070300        INSPECT AP001-ADJ-DOC-NBR                                 07030000
070400                REPLACING ALL X'1E' BY ' '                        07040000
070500        INSPECT AP001-ADJ-DOC-NBR                                 07050000
070600                REPLACING ALL X'32' BY ' '                        07060000
070700        INSPECT AP001-ADJ-DOC-NBR                                 07070000
070800                REPLACING ALL X'AB' BY ' '                        07080000
070900        INSPECT AP001-ADJ-DOC-NBR                                 07090000
071000                REPLACING ALL X'9B' BY ' '                        07100000
071100        INSPECT AP001-ADJ-DOC-NBR                                 07110000
071200                REPLACING ALL X'15' BY ' '                        07120000
071300        INSPECT AP001-ADJ-DOC-NBR                                 07130000
071400                REPLACING ALL X'41' BY ' '                        07140000
071500        INSPECT AP001-ADJ-DOC-NBR                                 07150000
071600                REPLACING ALL X'FD' BY ' '                        07160000
071610        INSPECT AP001-ADJ-DOC-NBR                                 07161000
071620                REPLACING ALL X'B3' BY ' '                        07162000
071621        INSPECT AP001-ADJ-DOC-NBR                                 07162100
071622                REPLACING ALL X'0D' BY ' '                        07162201
071623        INSPECT AP001-ADJ-DOC-NBR                                 07162305
071624                REPLACING ALL X'0A' BY ' '                        07162405
071625        INSPECT AP001-ADJ-DOC-NBR                                 07162506
071626                REPLACING ALL X'CA' BY ' '                        07162606
071630     END-IF.                                                      07163000
071640     MOVE AP002-DEPT-NBR         TO AP001-ADJ-DEPT-NBR.           07164000
071650**   REQUEST PER EDI, ADD LEADING ZERO TO PO NBR                  07165000
071660     MOVE ZEROES                 TO AP001-ADJ-PO-NBR(1:1).        07166000
071670     MOVE AP002-PO-NBR           TO AP001-ADJ-PO-NBR(2:9).        07167000
071680     MOVE AP002-DOC-CC           TO AP001-ADJ-DOC-CC.             07168000
071690     MOVE AP002-DOC-YY           TO AP001-ADJ-DOC-YY.             07169000
071700     MOVE AP002-DOC-MM           TO AP001-ADJ-DOC-MM.             07170000
071800     MOVE AP002-DOC-DD           TO AP001-ADJ-DOC-DD.             07180000
071900     MOVE AP002-LOC-ID           TO AP001-ADJ-STR-NBR.            07190000
072000                                                                  07200000
072100     ADD 1 TO COUNT-EDI-ADJ-REMIT.                                07210000
072200     PERFORM W100-WRITE-EDI-REMITTANCE.                           07220000
072300 EJECT.                                                           07230000
072400                                                                  07240000
072500*--------------------------------------------------------------*  07250000
072600* CREATE EDI ADJUSTMENT COMMENT RECORD                         *  07260000
072700*--------------------------------------------------------------*  07270000
072800 C300-CREATE-EDI-ADJ-COMMENT.                                     07280000
072900     INITIALIZE AP001-ADJ-COMMENT-RECD.                           07290000
073000     SET ADJUSTMENT-COMMENT-RECORD TO TRUE.                       07300000
073100     MOVE AP002-COMMENT-LINE1 TO AP001-ADJ-COMMENT-DESC.          07310000
073200     INSPECT AP001-ADJ-COMMENT-DESC                               07320000
073300             REPLACING ALL X'0D25' BY '  '.                       07330000
073400     INSPECT AP001-ADJ-COMMENT-DESC                               07340000
073500             REPLACING ALL X'0D15' BY '  '.                       07350000
073600     INSPECT AP001-ADJ-COMMENT-DESC                               07360000
073700             REPLACING ALL '`' BY "'".                            07370000
073800     INSPECT AP001-ADJ-COMMENT-DESC                               07380000
073900             REPLACING ALL '' BY '('.                            07390000
074000     INSPECT AP001-ADJ-COMMENT-DESC                               07400000
074100             REPLACING ALL '' BY ')'.                            07410000
074200     INSPECT AP001-ADJ-COMMENT-DESC                               07420000
074300             REPLACING ALL '' BY ' '.                            07430000
074400     INSPECT AP001-ADJ-COMMENT-DESC                               07440000
074500             REPLACING ALL X'B7' BY ' '.                          07450000
074600     INSPECT AP001-ADJ-COMMENT-DESC                               07460000
074700             REPLACING ALL X'B8' BY ' '.                          07470000
074800     INSPECT AP001-ADJ-COMMENT-DESC                               07480000
074900             REPLACING ALL '~' BY ' '.                            07490000
075000     INSPECT AP001-ADJ-COMMENT-DESC                               07500000
075100             REPLACING ALL '<' BY '('.                            07510000
075200     INSPECT AP001-ADJ-COMMENT-DESC                               07520000
075300             REPLACING ALL '>' BY ')'.                            07530000
075400     INSPECT AP001-ADJ-COMMENT-DESC                               07540000
075500             REPLACING ALL '|' BY ' '.                            07550000
075600     INSPECT AP001-ADJ-COMMENT-DESC                               07560000
075700             REPLACING ALL '!' BY ' '.                            07570000
075800     INSPECT AP001-ADJ-COMMENT-DESC                               07580000
075900             REPLACING ALL X'00' BY ' '.                          07590000
076000     INSPECT AP001-ADJ-COMMENT-DESC                               07600000
076100             REPLACING ALL X'05' BY ' '.                          07610000
076200     INSPECT AP001-ADJ-COMMENT-DESC                               07620000
076300             REPLACING ALL X'1E' BY ' '.                          07630000
076400     INSPECT AP001-ADJ-COMMENT-DESC                               07640000
076500             REPLACING ALL X'32' BY ' '.                          07650000
076600     INSPECT AP001-ADJ-COMMENT-DESC                               07660000
076700             REPLACING ALL X'AB' BY ' '.                          07670000
076800     INSPECT AP001-ADJ-COMMENT-DESC                               07680000
076900             REPLACING ALL X'9B' BY ' '.                          07690000
077000     INSPECT AP001-ADJ-COMMENT-DESC                               07700000
077100             REPLACING ALL X'15' BY ' '.                          07710000
077200     INSPECT AP001-ADJ-COMMENT-DESC                               07720000
077300             REPLACING ALL X'41' BY ' '.                          07730000
077400     INSPECT AP001-ADJ-COMMENT-DESC                               07740000
077500             REPLACING ALL X'FD' BY ' '.                          07750000
077600     INSPECT AP001-ADJ-COMMENT-DESC                               07760000
077700             REPLACING ALL X'B3' BY ' '.                          07770000
077710     INSPECT AP001-ADJ-COMMENT-DESC                               07771000
077720             REPLACING ALL X'0D' BY ' '.                          07772001
077730     INSPECT AP001-ADJ-COMMENT-DESC                               07773005
077740             REPLACING ALL X'0A' BY ' '.                          07774005
077750     INSPECT AP001-ADJ-COMMENT-DESC                               07775006
077760             REPLACING ALL X'CA' BY ' '.                          07776006
077800     ADD 1 TO COUNT-EDI-ADJ-COMMENT.                              07780000
077900     PERFORM W100-WRITE-EDI-REMITTANCE.                           07790000
078000                                                                  07800000
078100     IF AP002-COMMENT-LINE2 NOT = ALL SPACES                      07810000
078200        INITIALIZE AP001-ADJ-COMMENT-RECD                         07820000
078300        SET ADJUSTMENT-COMMENT-RECORD TO TRUE                     07830000
078400        MOVE AP002-COMMENT-LINE2 TO AP001-ADJ-COMMENT-DESC        07840000
078500        INSPECT AP001-ADJ-COMMENT-DESC                            07850000
078600                REPLACING ALL X'0D25' BY '  '                     07860000
078700        INSPECT AP001-ADJ-COMMENT-DESC                            07870000
078800                REPLACING ALL X'0D15' BY '  '                     07880000
078900        INSPECT AP001-ADJ-COMMENT-DESC                            07890000
079000                REPLACING ALL '`' BY "'"                          07900000
079100        INSPECT AP001-ADJ-COMMENT-DESC                            07910000
079200                REPLACING ALL '' BY '('                          07920000
079300        INSPECT AP001-ADJ-COMMENT-DESC                            07930000
079400                REPLACING ALL '' BY ')'                          07940000
079500        INSPECT AP001-ADJ-COMMENT-DESC                            07950000
079600                REPLACING ALL '' BY ' '                          07960000
079700        INSPECT AP001-ADJ-COMMENT-DESC                            07970000
079800                REPLACING ALL X'B7' BY ' '                        07980000
079900        INSPECT AP001-ADJ-COMMENT-DESC                            07990000
080000                REPLACING ALL X'B8' BY ' '                        08000000
080100        INSPECT AP001-ADJ-COMMENT-DESC                            08010000
080200                REPLACING ALL '~' BY ' '                          08020000
080300        INSPECT AP001-ADJ-COMMENT-DESC                            08030000
080400                REPLACING ALL '<' BY '('                          08040000
080500        INSPECT AP001-ADJ-COMMENT-DESC                            08050000
080600                REPLACING ALL '>' BY ')'                          08060000
080700        INSPECT AP001-ADJ-COMMENT-DESC                            08070000
080800                REPLACING ALL '|' BY ' '                          08080000
080900        INSPECT AP001-ADJ-COMMENT-DESC                            08090000
081000                REPLACING ALL '!' BY ' '                          08100000
081100        INSPECT AP001-ADJ-COMMENT-DESC                            08110000
081200                REPLACING ALL X'00' BY ' '                        08120000
081300        INSPECT AP001-ADJ-COMMENT-DESC                            08130000
081400                REPLACING ALL X'05' BY ' '                        08140000
081500        INSPECT AP001-ADJ-COMMENT-DESC                            08150000
081600                REPLACING ALL X'1E' BY ' '                        08160000
081700        INSPECT AP001-ADJ-COMMENT-DESC                            08170000
081800                REPLACING ALL X'32' BY ' '                        08180000
081900        INSPECT AP001-ADJ-COMMENT-DESC                            08190000
082000                REPLACING ALL X'AB' BY ' '                        08200000
082100        INSPECT AP001-ADJ-COMMENT-DESC                            08210000
082200                REPLACING ALL X'9B' BY ' '                        08220000
082300        INSPECT AP001-ADJ-COMMENT-DESC                            08230000
082400                REPLACING ALL X'15' BY ' '                        08240000
082500        INSPECT AP001-ADJ-COMMENT-DESC                            08250000
082510                REPLACING ALL X'41' BY ' '                        08251000
082520        INSPECT AP001-ADJ-COMMENT-DESC                            08252000
082530                REPLACING ALL X'FD' BY ' '                        08253000
082540        INSPECT AP001-ADJ-COMMENT-DESC                            08254000
082550                REPLACING ALL X'B3' BY ' '                        08255000
082551        INSPECT AP001-ADJ-COMMENT-DESC                            08255100
082552                REPLACING ALL X'0D' BY ' '                        08255201
082553        INSPECT AP001-ADJ-COMMENT-DESC                            08255305
082554                REPLACING ALL X'0A' BY ' '                        08255405
082555        INSPECT AP001-ADJ-COMMENT-DESC                            08255506
082556                REPLACING ALL X'CA' BY ' '                        08255606
082557        IF AP001-ADJ-COMMENT-DESC NOT = ALL SPACES                08255706
082560           ADD 1 TO COUNT-EDI-ADJ-COMMENT                         08256002
082570           PERFORM W100-WRITE-EDI-REMITTANCE                      08257002
082571        END-IF                                                    08257102
082580     END-IF.                                                      08258000
082590                                                                  08259000
082600     IF AP002-COMMENT-LINE3 NOT = ALL SPACES                      08260000
082700        INITIALIZE AP001-ADJ-COMMENT-RECD                         08270000
082800        SET ADJUSTMENT-COMMENT-RECORD TO TRUE                     08280000
082900        MOVE AP002-COMMENT-LINE3 TO AP001-ADJ-COMMENT-DESC        08290000
083000        INSPECT AP001-ADJ-COMMENT-DESC                            08300000
083100                REPLACING ALL X'0D25' BY '  '                     08310000
083200        INSPECT AP001-ADJ-COMMENT-DESC                            08320000
083300                REPLACING ALL X'0D15' BY '  '                     08330000
083400        INSPECT AP001-ADJ-COMMENT-DESC                            08340000
083500                REPLACING ALL '`' BY "'"                          08350000
083600        INSPECT AP001-ADJ-COMMENT-DESC                            08360000
083700                REPLACING ALL '' BY '('                          08370000
083800        INSPECT AP001-ADJ-COMMENT-DESC                            08380000
083900                REPLACING ALL '' BY ')'                          08390000
084000        INSPECT AP001-ADJ-COMMENT-DESC                            08400000
084100                REPLACING ALL '' BY ' '                          08410000
084200        INSPECT AP001-ADJ-COMMENT-DESC                            08420000
084300                REPLACING ALL X'B7' BY ' '                        08430000
084400        INSPECT AP001-ADJ-COMMENT-DESC                            08440000
084500                REPLACING ALL X'B8' BY ' '                        08450000
084600        INSPECT AP001-ADJ-COMMENT-DESC                            08460000
084700                REPLACING ALL '~' BY ' '                          08470000
084800        INSPECT AP001-ADJ-COMMENT-DESC                            08480000
084900                REPLACING ALL '<' BY '('                          08490000
085000        INSPECT AP001-ADJ-COMMENT-DESC                            08500000
085100                REPLACING ALL '>' BY ')'                          08510000
085200        INSPECT AP001-ADJ-COMMENT-DESC                            08520000
085300                REPLACING ALL '|' BY ' '                          08530000
085400        INSPECT AP001-ADJ-COMMENT-DESC                            08540000
085500                REPLACING ALL '!' BY ' '                          08550000
085600        INSPECT AP001-ADJ-COMMENT-DESC                            08560000
085700                REPLACING ALL X'00' BY ' '                        08570000
085800        INSPECT AP001-ADJ-COMMENT-DESC                            08580000
085900                REPLACING ALL X'05' BY ' '                        08590000
086000        INSPECT AP001-ADJ-COMMENT-DESC                            08600000
086100                REPLACING ALL X'1E' BY ' '                        08610000
086200        INSPECT AP001-ADJ-COMMENT-DESC                            08620000
086300                REPLACING ALL X'32' BY ' '                        08630000
086400        INSPECT AP001-ADJ-COMMENT-DESC                            08640000
086500                REPLACING ALL X'AB' BY ' '                        08650000
086600        INSPECT AP001-ADJ-COMMENT-DESC                            08660000
086700                REPLACING ALL X'9B' BY ' '                        08670000
086800        INSPECT AP001-ADJ-COMMENT-DESC                            08680000
086900                REPLACING ALL X'15' BY ' '                        08690000
087000        INSPECT AP001-ADJ-COMMENT-DESC                            08700000
087100                REPLACING ALL X'41' BY ' '                        08710000
087200        INSPECT AP001-ADJ-COMMENT-DESC                            08720000
087300                REPLACING ALL X'FD' BY ' '                        08730000
087310        INSPECT AP001-ADJ-COMMENT-DESC                            08731000
087320                REPLACING ALL X'B3' BY ' '                        08732000
087321        INSPECT AP001-ADJ-COMMENT-DESC                            08732100
087322                REPLACING ALL X'0D' BY ' '                        08732201
087323        INSPECT AP001-ADJ-COMMENT-DESC                            08732305
087324                REPLACING ALL X'0A' BY ' '                        08732405
087325        INSPECT AP001-ADJ-COMMENT-DESC                            08732506
087326                REPLACING ALL X'CA' BY ' '                        08732606
087327        IF AP001-ADJ-COMMENT-DESC NOT = ALL SPACES                08732706
087328           ADD 1 TO COUNT-EDI-ADJ-COMMENT                         08732806
087329           PERFORM W100-WRITE-EDI-REMITTANCE                      08732906
087330        END-IF                                                    08733006
087350     END-IF.                                                      08735000
087360 EJECT.                                                           08736000
087370                                                                  08737000
087380                                                                  08738000
087390*--------------------------------------------------------------*  08739000
087400* CREATE EDI ADJUSTMENT MEMO RECORD                            *  08740000
087500*--------------------------------------------------------------*  08750000
087600 C400-CREATE-EDI-ADJ-MEMO.                                        08760000
087700     INITIALIZE AP001-ADJ-MEMO-RECD.                              08770000
087800     SET ADJUSTMENT-MEMO-RECORD TO TRUE.                          08780000
087900                                                                  08790000
088000     MOVE AP002-MEMO-SKU-UPC-NBR   TO AP001-MEMO-SKU-UPC-NBR.     08800000
088100     MOVE 'EA'                     TO AP001-MEMO-UOM.             08810000
088200     MOVE 'QT'                     TO AP001-MEMO-COST-CDE.        08820000
088300                                                                  08830000
088400     IF AP002-MEMO-VEND-STYL-NBR = SPACES                         08840000
088500        MOVE SPACES                TO AP001-MEMO-PRODUCT-CDE      08850000
088600        MOVE SPACES                TO AP001-MEMO-VEND-STYL-NBR    08860000
088700     ELSE                                                         08870000
088800        IF AP002-AP-TRN-CDE = '0B'                                08880000
088900           MOVE 'DV'               TO AP001-MEMO-PRODUCT-CDE      08890000
089000           MOVE AP002-MEMO-VEND-STYL-NBR                          08900000
089100                TO AP001-MEMO-VEND-STYL-NBR                       08910000
089200        ELSE                                                      08920000
089300           MOVE 'VA'               TO AP001-MEMO-PRODUCT-CDE      08930000
089400           MOVE AP002-MEMO-VEND-STYL-NBR                          08940000
089500                TO AP001-MEMO-VEND-STYL-NBR                       08950000
089600        END-IF                                                    08960000
089700     END-IF.                                                      08970000
089800                                                                  08980000
089900     COMPUTE AP001-MEMO-ITEM-QTY = AP002-MEMO-INV-QTY             08990000
090000                                 - AP002-MEMO-RCV-QTY.            09000000
090100                                                                  09010000
090200     COMPUTE AP001-MEMO-UNIT-COST = AP002-MEMO-INVC-COST-AMT      09020000
090300                                  - AP002-MEMO-ORD-COST-AMT.      09030000
090400                                                                  09040000
090500     IF AP002-AP-TRN-CDE = '0B'                                   09050000
090600        IF AP001-MEMO-UNIT-COST = 0                               09060000
090700           ADD 1      TO BYPASS-EDI-ADJ-MEMO                      09070000
090800        ELSE                                                      09080000
090900           MOVE 1     TO AP001-MEMO-ITEM-QTY                      09090000
091000           ADD 1      TO COUNT-EDI-ADJ-MEMO                       09100000
091100           PERFORM W100-WRITE-EDI-REMITTANCE                      09110000
091200        END-IF                                                    09120000
091300     ELSE                                                         09130000
091400        IF AP001-MEMO-ITEM-QTY = 0 OR                             09140000
091500           AP001-MEMO-UNIT-COST = 0                               09150000
091600           ADD 1      TO BYPASS-EDI-ADJ-MEMO                      09160000
091700        ELSE                                                      09170000
091800           ADD 1      TO COUNT-EDI-ADJ-MEMO                       09180000
091900           PERFORM W100-WRITE-EDI-REMITTANCE                      09190000
092000        END-IF                                                    09200000
092100     END-IF.                                                      09210000
092200 EJECT.                                                           09220000
092300                                                                  09230000
092400*--------------------------------------------------------------*  09240000
092500* CREATE EDI INVOICE REMITTANCE RECORD                         *  09250000
092600*--------------------------------------------------------------*  09260000
092700 C500-CREATE-EDI-INV-REMIT.                                       09270000
092800     INITIALIZE AP001-INVOICE-RECD.                               09280000
092900     SET INVOICE-REMIT-RECORD TO TRUE.                            09290000
093000     MOVE 'IV'                   TO AP001-INV-DOC-TYP.            09300000
093100     IF AP002-INVOICE-ID = SPACES                                 09310000
093200        MOVE 'INVOICE NBR UNKNOWN'  TO AP001-INV-DOC-NBR          09320000
093300     ELSE                                                         09330000
093400        MOVE AP002-INVOICE-ID       TO AP001-INV-DOC-NBR          09340000
093500        INSPECT AP001-INV-DOC-NBR                                 09350000
093600                REPLACING ALL X'0D25' BY '  '                     09360000
093700        INSPECT AP001-INV-DOC-NBR                                 09370000
093800                REPLACING ALL '`' BY "'"                          09380000
093900        INSPECT AP001-INV-DOC-NBR                                 09390000
094000                REPLACING ALL '' BY '('                          09400000
094100        INSPECT AP001-INV-DOC-NBR                                 09410000
094200                REPLACING ALL '' BY ')'                          09420000
094300        INSPECT AP001-INV-DOC-NBR                                 09430000
094400                REPLACING ALL '' BY ' '                          09440000
094500        INSPECT AP001-INV-DOC-NBR                                 09450000
094600                REPLACING ALL X'B7' BY ' '                        09460000
094700        INSPECT AP001-INV-DOC-NBR                                 09470000
094800                REPLACING ALL X'B8' BY ' '                        09480000
094900        INSPECT AP001-INV-DOC-NBR                                 09490000
095000                REPLACING ALL '~' BY ' '                          09500000
095100        INSPECT AP001-INV-DOC-NBR                                 09510000
095200                REPLACING ALL '<' BY '('                          09520000
095300        INSPECT AP001-INV-DOC-NBR                                 09530000
095400                REPLACING ALL '>' BY ')'                          09540000
095500        INSPECT AP001-INV-DOC-NBR                                 09550000
095600                REPLACING ALL '|' BY ' '                          09560000
095700        INSPECT AP001-INV-DOC-NBR                                 09570000
095800                REPLACING ALL '!' BY ' '                          09580000
095900        INSPECT AP001-INV-DOC-NBR                                 09590000
096000                REPLACING ALL X'00' BY ' '                        09600000
096100        INSPECT AP001-INV-DOC-NBR                                 09610000
096200                REPLACING ALL X'05' BY ' '                        09620000
096300        INSPECT AP001-INV-DOC-NBR                                 09630000
096400                REPLACING ALL X'1E' BY ' '                        09640000
096500        INSPECT AP001-INV-DOC-NBR                                 09650000
096600                REPLACING ALL X'32' BY ' '                        09660000
096700        INSPECT AP001-INV-DOC-NBR                                 09670000
096800                REPLACING ALL X'AB' BY ' '                        09680000
096900        INSPECT AP001-INV-DOC-NBR                                 09690000
097000                REPLACING ALL X'9B' BY ' '                        09700000
097100        INSPECT AP001-INV-DOC-NBR                                 09710000
097200                REPLACING ALL X'15' BY ' '                        09720000
097300        INSPECT AP001-INV-DOC-NBR                                 09730000
097400                REPLACING ALL X'41' BY ' '                        09740000
097500        INSPECT AP001-INV-DOC-NBR                                 09750000
097600                REPLACING ALL X'FD' BY ' '                        09760000
097700        INSPECT AP001-INV-DOC-NBR                                 09770000
097800                REPLACING ALL X'B3' BY ' '                        09780000
097810        INSPECT AP001-INV-DOC-NBR                                 09781000
097820                REPLACING ALL X'0D' BY ' '                        09782001
097830        INSPECT AP001-INV-DOC-NBR                                 09783005
097840                REPLACING ALL X'0A' BY ' '                        09784005
097850        INSPECT AP001-INV-DOC-NBR                                 09785006
097860                REPLACING ALL X'CA' BY ' '                        09786006
097900     END-IF.                                                      09790000
098000     MOVE AP002-NET-AMT          TO AP001-INV-NET-AMT.            09800000
098100     MOVE AP002-GROSS-AMT        TO AP001-INV-GROSS-AMT.          09810000
098200     MOVE AP002-DISCOUNT-AMT     TO AP001-INV-DISCOUNT-AMT.       09820000
098300     MOVE ZEROES                 TO AP001-INV-PO-NBR(1:1).        09830000
098400     MOVE AP002-PO-NBR           TO AP001-INV-PO-NBR(2:9).        09840000
098500     MOVE AP002-DEPT-NBR         TO AP001-INV-DEPT-NBR.           09850000
098600     MOVE AP002-DOC-CC           TO AP001-INV-DOC-CC.             09860000
098700     MOVE AP002-DOC-YY           TO AP001-INV-DOC-YY.             09870000
098800     MOVE AP002-DOC-MM           TO AP001-INV-DOC-MM.             09880000
098900     MOVE AP002-DOC-DD           TO AP001-INV-DOC-DD.             09890000
099000     MOVE AP002-LOC-ID           TO AP001-INV-STR-NBR.            09900000
099100                                                                  09910000
099200     ADD 1 TO COUNT-EDI-INV-REMIT.                                09920000
099300     PERFORM W100-WRITE-EDI-REMITTANCE.                           09930000
099400 EJECT.                                                           09940000
099500                                                                  09950000
099600*--------------------------------------------------------------*  09960000
099700* CREATE EDI INVOICE COMMENT RECORD                            *  09970000
099800*--------------------------------------------------------------*  09980000
099900 C600-CREATE-EDI-INV-COMMENT.                                     09990000
100000     INITIALIZE AP001-INV-COMMENT-RECD.                           10000000
100100     SET INVOICE-COMMENT-RECORD TO TRUE.                          10010000
100200     MOVE AP002-COMMENT-LINE1 TO AP001-INV-COMMENT-DESC.          10020000
100300     INSPECT AP001-INV-COMMENT-DESC                               10030000
100400             REPLACING ALL X'0D25' BY '  '.                       10040000
100500     INSPECT AP001-INV-COMMENT-DESC                               10050000
100600             REPLACING ALL X'0D15' BY '  '.                       10060000
100700     INSPECT AP001-INV-COMMENT-DESC                               10070000
100800             REPLACING ALL '`' BY "'".                            10080000
100900     INSPECT AP001-INV-COMMENT-DESC                               10090000
101000             REPLACING ALL '' BY '('.                            10100000
101100     INSPECT AP001-INV-COMMENT-DESC                               10110000
101200             REPLACING ALL '' BY ')'.                            10120000
101300     INSPECT AP001-INV-COMMENT-DESC                               10130000
101400             REPLACING ALL '' BY ' '.                            10140000
101500     INSPECT AP001-INV-COMMENT-DESC                               10150000
101600             REPLACING ALL X'B7' BY ' '.                          10160000
101700     INSPECT AP001-INV-COMMENT-DESC                               10170000
101800             REPLACING ALL X'B8' BY ' '.                          10180000
101900     INSPECT AP001-INV-COMMENT-DESC                               10190000
102000             REPLACING ALL '~' BY ' '.                            10200000
102100     INSPECT AP001-INV-COMMENT-DESC                               10210000
102200             REPLACING ALL '<' BY '('.                            10220000
102300     INSPECT AP001-INV-COMMENT-DESC                               10230000
102400             REPLACING ALL '>' BY ')'.                            10240000
102500     INSPECT AP001-INV-COMMENT-DESC                               10250000
102600             REPLACING ALL '|' BY ' '.                            10260000
102700     INSPECT AP001-INV-COMMENT-DESC                               10270000
102800             REPLACING ALL '!' BY ' '.                            10280000
102900     INSPECT AP001-INV-COMMENT-DESC                               10290000
103000             REPLACING ALL X'00' BY ' '.                          10300000
103100     INSPECT AP001-INV-COMMENT-DESC                               10310000
103200             REPLACING ALL X'05' BY ' '.                          10320000
103300     INSPECT AP001-INV-COMMENT-DESC                               10330000
103400             REPLACING ALL X'1E' BY ' '.                          10340000
103500     INSPECT AP001-INV-COMMENT-DESC                               10350000
103600             REPLACING ALL X'32' BY ' '.                          10360000
103700     INSPECT AP001-INV-COMMENT-DESC                               10370000
103800             REPLACING ALL X'AB' BY ' '.                          10380000
103900     INSPECT AP001-INV-COMMENT-DESC                               10390000
104000             REPLACING ALL X'9B' BY ' '.                          10400000
104100     INSPECT AP001-INV-COMMENT-DESC                               10410000
104200             REPLACING ALL X'15' BY ' '.                          10420000
104300     INSPECT AP001-INV-COMMENT-DESC                               10430000
104310             REPLACING ALL X'41' BY ' '.                          10431000
104320     INSPECT AP001-INV-COMMENT-DESC                               10432000
104330             REPLACING ALL X'FD' BY ' '.                          10433000
104340     INSPECT AP001-INV-COMMENT-DESC                               10434000
104350             REPLACING ALL X'B3' BY ' '.                          10435000
104351     INSPECT AP001-INV-COMMENT-DESC                               10435100
104352             REPLACING ALL X'0D' BY ' '.                          10435201
104353     INSPECT AP001-INV-COMMENT-DESC                               10435304
104354             REPLACING ALL X'0A' BY ' '.                          10435404
104355     INSPECT AP001-INV-COMMENT-DESC                               10435506
104356             REPLACING ALL X'CA' BY ' '.                          10435606
104360     ADD 1 TO COUNT-EDI-INV-COMMENT.                              10436000
104370     PERFORM W100-WRITE-EDI-REMITTANCE.                           10437000
104380                                                                  10438000
104390     IF AP002-COMMENT-LINE2 NOT = ALL SPACES                      10439000
104400        INITIALIZE AP001-INV-COMMENT-RECD                         10440000
104500        SET INVOICE-COMMENT-RECORD TO TRUE                        10450000
104600        MOVE AP002-COMMENT-LINE2 TO AP001-INV-COMMENT-DESC        10460000
104700        INSPECT AP001-INV-COMMENT-DESC                            10470000
104800                REPLACING ALL X'0D25' BY '  '                     10480000
104900        INSPECT AP001-INV-COMMENT-DESC                            10490000
105000                REPLACING ALL X'0D15' BY '  '                     10500000
105100        INSPECT AP001-INV-COMMENT-DESC                            10510000
105200                REPLACING ALL '`' BY "'"                          10520000
105300        INSPECT AP001-INV-COMMENT-DESC                            10530000
105400                REPLACING ALL '' BY '('                          10540000
105500        INSPECT AP001-INV-COMMENT-DESC                            10550000
105600                REPLACING ALL '' BY ')'                          10560000
105700        INSPECT AP001-INV-COMMENT-DESC                            10570000
105800                REPLACING ALL '' BY ' '                          10580000
105900        INSPECT AP001-INV-COMMENT-DESC                            10590000
106000                REPLACING ALL X'B7' BY ' '                        10600000
106100        INSPECT AP001-INV-COMMENT-DESC                            10610000
106200                REPLACING ALL X'B8' BY ' '                        10620000
106300        INSPECT AP001-INV-COMMENT-DESC                            10630000
106400                REPLACING ALL '~' BY ' '                          10640000
106500        INSPECT AP001-INV-COMMENT-DESC                            10650000
106600                REPLACING ALL '<' BY '('                          10660000
106700        INSPECT AP001-INV-COMMENT-DESC                            10670000
106800                REPLACING ALL '>' BY ')'                          10680000
106900        INSPECT AP001-INV-COMMENT-DESC                            10690000
107000                REPLACING ALL '|' BY ' '                          10700000
107100        INSPECT AP001-INV-COMMENT-DESC                            10710000
107200                REPLACING ALL '!' BY ' '                          10720000
107300        INSPECT AP001-INV-COMMENT-DESC                            10730000
107400                REPLACING ALL X'00' BY ' '                        10740000
107500        INSPECT AP001-INV-COMMENT-DESC                            10750000
107600                REPLACING ALL X'05' BY ' '                        10760000
107700        INSPECT AP001-INV-COMMENT-DESC                            10770000
107800                REPLACING ALL X'1E' BY ' '                        10780000
107900        INSPECT AP001-INV-COMMENT-DESC                            10790000
108000                REPLACING ALL X'32' BY ' '                        10800000
108100        INSPECT AP001-INV-COMMENT-DESC                            10810000
108200                REPLACING ALL X'AB' BY ' '                        10820000
108300        INSPECT AP001-INV-COMMENT-DESC                            10830000
108400                REPLACING ALL X'9B' BY ' '                        10840000
108500        INSPECT AP001-INV-COMMENT-DESC                            10850000
108600                REPLACING ALL X'15' BY ' '                        10860000
108700        INSPECT AP001-INV-COMMENT-DESC                            10870000
108800                REPLACING ALL X'41' BY ' '                        10880000
108900        INSPECT AP001-INV-COMMENT-DESC                            10890000
109000                REPLACING ALL X'FD' BY ' '                        10900000
109010        INSPECT AP001-INV-COMMENT-DESC                            10901000
109020                REPLACING ALL X'B3' BY ' '                        10902000
109021        INSPECT AP001-INV-COMMENT-DESC                            10902100
109022                REPLACING ALL X'0D' BY ' '                        10902201
109023        INSPECT AP001-INV-COMMENT-DESC                            10902305
109024                REPLACING ALL X'0A' BY ' '                        10902405
109025        INSPECT AP001-INV-COMMENT-DESC                            10902506
109026                REPLACING ALL X'CA' BY ' '                        10902606
109027        IF AP001-INV-COMMENT-DESC NOT = ALL SPACES                10902706
109030           ADD 1 TO COUNT-EDI-INV-COMMENT                         10903002
109040           PERFORM W100-WRITE-EDI-REMITTANCE                      10904002
109050        END-IF                                                    10905002
109051     END-IF.                                                      10905102
109060                                                                  10906000
109070     IF AP002-COMMENT-LINE3 NOT = ALL SPACES                      10907000
109080        INITIALIZE AP001-INV-COMMENT-RECD                         10908000
109090        SET INVOICE-COMMENT-RECORD TO TRUE                        10909000
109100        MOVE AP002-COMMENT-LINE3 TO AP001-INV-COMMENT-DESC        10910000
109200        INSPECT AP001-INV-COMMENT-DESC                            10920000
109300                REPLACING ALL X'0D25' BY '  '                     10930000
109400        INSPECT AP001-INV-COMMENT-DESC                            10940000
109500                REPLACING ALL X'0D15' BY '  '                     10950000
109600        INSPECT AP001-INV-COMMENT-DESC                            10960000
109700                REPLACING ALL '`' BY "'"                          10970000
109800        INSPECT AP001-INV-COMMENT-DESC                            10980000
109900                REPLACING ALL '' BY '('                          10990000
110000        INSPECT AP001-INV-COMMENT-DESC                            11000000
110100                REPLACING ALL '' BY ')'                          11010000
110200        INSPECT AP001-INV-COMMENT-DESC                            11020000
110300                REPLACING ALL '' BY ' '                          11030000
110400        INSPECT AP001-INV-COMMENT-DESC                            11040000
110500                REPLACING ALL X'B7' BY ' '                        11050000
110600        INSPECT AP001-INV-COMMENT-DESC                            11060000
110700                REPLACING ALL X'B8' BY ' '                        11070000
110800        INSPECT AP001-INV-COMMENT-DESC                            11080000
110900                REPLACING ALL '~' BY ' '                          11090000
111000        INSPECT AP001-INV-COMMENT-DESC                            11100000
111100                REPLACING ALL '<' BY '('                          11110000
111200        INSPECT AP001-INV-COMMENT-DESC                            11120000
111300                REPLACING ALL '>' BY ')'                          11130000
111400        INSPECT AP001-INV-COMMENT-DESC                            11140000
111500                REPLACING ALL '|' BY ' '                          11150000
111600        INSPECT AP001-INV-COMMENT-DESC                            11160000
111700                REPLACING ALL '!' BY ' '                          11170000
111800        INSPECT AP001-INV-COMMENT-DESC                            11180000
111900                REPLACING ALL X'00' BY ' '                        11190000
112000        INSPECT AP001-INV-COMMENT-DESC                            11200000
112100                REPLACING ALL X'05' BY ' '                        11210000
112200        INSPECT AP001-INV-COMMENT-DESC                            11220000
112300                REPLACING ALL X'1E' BY ' '                        11230000
112400        INSPECT AP001-INV-COMMENT-DESC                            11240000
112500                REPLACING ALL X'32' BY ' '                        11250000
112600        INSPECT AP001-INV-COMMENT-DESC                            11260000
112700                REPLACING ALL X'AB' BY ' '                        11270000
112800        INSPECT AP001-INV-COMMENT-DESC                            11280000
112900                REPLACING ALL X'9B' BY ' '                        11290000
113000        INSPECT AP001-INV-COMMENT-DESC                            11300000
113100                REPLACING ALL X'15' BY ' '                        11310000
113200        INSPECT AP001-INV-COMMENT-DESC                            11320000
113300                REPLACING ALL X'41' BY ' '                        11330000
113400        INSPECT AP001-INV-COMMENT-DESC                            11340000
113500                REPLACING ALL X'FD' BY ' '                        11350000
113600        INSPECT AP001-INV-COMMENT-DESC                            11360000
113700                REPLACING ALL X'B3' BY ' '                        11370000
113710        INSPECT AP001-INV-COMMENT-DESC                            11371000
113720                REPLACING ALL X'0D' BY ' '                        11372001
113721        INSPECT AP001-INV-COMMENT-DESC                            11372105
113722                REPLACING ALL X'0A' BY ' '                        11372205
113723        INSPECT AP001-INV-COMMENT-DESC                            11372306
113724                REPLACING ALL X'CA' BY ' '                        11372406
113730        IF AP001-INV-COMMENT-DESC NOT = ALL SPACES                11373002
113740           ADD 1 TO COUNT-EDI-INV-COMMENT                         11374002
113750           PERFORM W100-WRITE-EDI-REMITTANCE                      11375002
113760        END-IF                                                    11376002
114000     END-IF.                                                      11400000
114100 EJECT.                                                           11410000
114200                                                                  11420000
114300*--------------------------------------------------------------*  11430000
114400* READS THE AP REMITTANCE FILE                                 *  11440000
114500*--------------------------------------------------------------*  11450000
114600 R100-READ-AP-REMITTANCE.                                         11460000
114700     READ AP-REMITTANCE-FILE INTO AP002-REMIT-EXTRACT-RECORD      11470000
114800       AT END                                                     11480000
114900          SET AP-REMITTANCE-EOF TO TRUE                           11490000
115000       NOT AT END                                                 11500000
115100          ADD 1 TO COUNT-AP-REMIT-TOTAL                           11510000
115200     END-READ.                                                    11520000
115300                                                                  11530000
115400 EJECT.                                                           11540000
115500                                                                  11550000
115600*--------------------------------------------------------------*  11560000
115700*  THIS SQL CAN RETURN MORE THAN ONE ROW, BECAUSE THE SYSTEM   *  11570000
115800*  DOES NOT FORCE THE USER TO INACTIVATE THE 'TEST' ROW WHEN   *  11580000
115900*  THEY ARE ACTIVATING THE 'PROD' ROW, SO BOTH CAN BE ACTIVE   *  11590000
116000*  FOR A PERIOD OF TIME.  WHEN THIS HAPPENS, WE WANT TO        *  11600000
116100*  PROCESS THE VENDOR AS 'PROD'.  THAT MEANS, WHEN THE SQLCODE *  11610000
116200*  IS -811, WE SHOULD PROCESS THE VENDOR AS FOUND, BUT MOVE    *  11620000
116300*  'P' TO THE TRDTRN-PROD-TEST-IND.                            *  11630000
116400*--------------------------------------------------------------*  11640000
116500 S100-SELECT-VENDOR-ELIGIBLITY.                                   11650000
116600     EXEC SQL                                                     11660000
116700         SELECT A.ENT_ID                                          11670000
116800              , A.VND_CLSN_CDE                                    11680000
116900              , B.PROD_TEST_IND                                   11690000
117000           INTO :EXTENT-ENT-ID                                    11700000
117100              , :EXTENT-VND-CLSN-CDE                              11710000
117200              , :TRDTRN-PROD-TEST-IND                             11720000
117300           FROM TEXTENT A                                         11730000
117400              , TTRDTRN B                                         11740000
117500              , TTRDPRT C                                         11750000
117600          WHERE A.ENT_ID       = C.ENT_ID                         11760000
117700            AND A.DUN_NBR      = :AP002-REMIT-VENDOR              11770000
117800            AND B.TP_DKEY      = C.TP_DKEY                        11780000
117900            AND B.TRAN_SET_CDE = '820'                            11790000
118000            AND B.ACTV_DTE    <= CURRENT DATE                     11800000
118100            AND B.INACTV_DTE   = '9999-09-09'                     11810000
118200            AND C.ACTV_DTE    <= CURRENT DATE                     11820000
118300            AND C.INACTV_DTE   = '9999-09-09'                     11830000
118400     END-EXEC.                                                    11840000
118500                                                                  11850000
118600     EVALUATE TRUE                                                11860000
118700         WHEN SQLCODE = ZERO                                      11870000
118800             SET VENDOR-EDI-ELIGIBLE TO TRUE                      11880000
118900         WHEN SQLCODE = -811                                      11890000
119000             SET VENDOR-EDI-ELIGIBLE TO TRUE                      11900000
119100             MOVE 'P' TO TRDTRN-PROD-TEST-IND                     11910000
119200         WHEN SQLCODE = +100                                      11920000
119300             SET VENDOR-NOT-EDI-ELIGIBLE TO TRUE                  11930000
119400         WHEN OTHER                                               11940000
119500             DISPLAY 'AP002-REMIT-VENDOR ' AP002-REMIT-VENDOR     11950000
119600             SET AC-UNSUCCESSFUL-SELECT    TO TRUE                11960000
119700             MOVE 'S100-SELECT-VENDOR-ELIGIBLITY'                 11970000
119800                                           TO AA-PARAGRAPH-NAME   11980000
119900             MOVE 'UNSUCCESSFUL SELECT'    TO AA-DB2-OPERATION    11990000
120000             MOVE 'TEXTENT'                TO AA-DB2-TABLE-1      12000000
120100             MOVE 'TTRDTRN'                TO AA-DB2-TABLE-2      12010000
120200             MOVE 'TTRDPRT'                TO AA-DB2-TABLE-3      12020000
120300             PERFORM Z998-DB2-ABEND                               12030000
120400     END-EVALUATE.                                                12040000
120500 EJECT.                                                           12050000
120600                                                                  12060000
120700*--------------------------------------------------------------*  12070000
120800*  THIS ROUTINE WRITES THE EDI REMITTANCE FILE                 *  12080000
120900*--------------------------------------------------------------*  12090000
121000 W100-WRITE-EDI-REMITTANCE.                                       12100000
121100     WRITE EDI-REMITTANCE-RECORD FROM AP001-PAYMENT-REMIT-RECORD. 12110000
121200     ADD 1 TO COUNT-EDI-TOTAL.                                    12120000
121300 EJECT.                                                           12130000
121400                                                                  12140000
121500*--------------------------------------------------------------*  12150000
121600*  DB2 ABEND ROUTINE                                           *  12160000
121700*--------------------------------------------------------------*  12170000
121800 Z998-DB2-ABEND.                                                  12180000
121900                                                                  12190000
122000     DISPLAY '**********************************************'.    12200000
122100     DISPLAY '**        APKUT217 ABENDING !!!!!!!         **'.    12210000
122200     DISPLAY '**********************************************'.    12220000
122300                                                                  12230000
122400     DISPLAY AA-ABEND-LIT.                                        12240000
122500     DISPLAY AA-DB2-ERROR-LIT.                                    12250000
122600     DISPLAY AA-PROGRAM-LIT.                                      12260000
122700     DISPLAY AA-PARAGRAPH-LIT.                                    12270000
122800     DISPLAY AA-DB2-OPERATION-LIT.                                12280000
122900     DISPLAY AA-DB2-TABLE-1.                                      12290000
123000     DISPLAY AA-DB2-TABLE-2.                                      12300000
123100     DISPLAY AA-DB2-TABLE-3.                                      12310000
123200     SET AC-DB2-ERROR TO TRUE.                                    12320000
123300                                                                  12330000
123400     COPY DPPD004.                                                12340000
123500                                                                  12350000
123600     CALL 'ILBOABN0' USING ABEND-CODE.                            12360000
123700                                                                  12370000
