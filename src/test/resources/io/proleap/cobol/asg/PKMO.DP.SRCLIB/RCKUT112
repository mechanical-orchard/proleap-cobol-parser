000100***************************************************************** 00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300***************************************************************** 00030004
000400 PROGRAM-ID.    RCKUT112.                                         00040004
000500 AUTHOR.        PATRICK BURKE.                                    00050004
000600 INSTALLATION.  KOHLS.                                            00060004
000700 DATE-WRITTEN   JUNE 2001.                                        00070004
000800 DATE-COMPILED.                                                   00080004
000900***************************************************************** 00090004
001000* THIS PROGRAM CREATES AN EXTRACT FILE OF RECEIVING DATA TO     * 00100004
001100* FEED THE RCKRP035 REPORT TO LIST TOTAL UNITS VERIFIED FOR A   * 00110004
001200* SPECIFIC STORE TYPE (SUCH AS E-COMMERCE STORE).               * 00120004
001201***************************************************************** 00120112
001202*                    C H A N G E     L O G                      * 00120213
001203*================================================================ 00120313
001204* DATE: 09/20/12   CRQ32716/WR38972                               00120413
001205* WHO: STEVEN NOWAK (REFER TO '092012' FOR ALL CHANGES)           00120513
001206* WHY: SELECT AND WRITE TO NEW OUTPUT FILE (OUT02)'               00120613
001207*================================================================ 00120713
001208* DATE: 10/01/12   CRQ32716/INC2352859                            00120813
001209* WHO: STEVEN NOWAK (REFER TO '100112' FOR ALL CHANGES)           00120913
001210* WHY: UPDATE SQL IN PARA 3300                                    00121013
001211***************************************************************** 00121113
001212 ENVIRONMENT DIVISION.                                            00121213
001213***************************************************************** 00121313
001214 INPUT-OUTPUT SECTION.                                            00121413
001215*                                                                 00121513
001216 FILE-CONTROL.                                                    00121613
001217                                                                  00121713
001218     SELECT STORE-FILE     ASSIGN TO INP01.                       00121813
001219*                                                                 00121913
001220     SELECT EXTRACT-FILE   ASSIGN TO OUT01.                       00122013
001230*                                                                 00123013
001240* WR38972 NEXT 2 LINES ARE NEW - SJN                              00124013
001250     SELECT RDC-EXTR-FILE  ASSIGN TO OUT02.                       00125013
001260*                                                                 00126013
001270***************************************************************** 00127013
001280 DATA DIVISION.                                                   00128013
001290***************************************************************** 00129013
001291 FILE SECTION.                                                    00129113
001292*                                                                 00129213
001293 FD  STORE-FILE                                                   00129313
001294     RECORDING MODE IS F                                          00129413
001295     LABEL RECORDS ARE STANDARD                                   00129513
001296     BLOCK CONTAINS 0 RECORDS.                                    00129613
001297 01  STORE-RECORD                PIC X(300).                      00129713
001298*                                                                 00129813
001299 FD  EXTRACT-FILE                                                 00129913
001300     RECORDING MODE IS F                                          00130013
001400     LABEL RECORDS ARE STANDARD                                   00140013
001500     BLOCK CONTAINS 0 RECORDS.                                    00150013
001600 01  EXTRACT-RECORD              PIC X(300).                      00160013
001700*                                                                 00170013
001800* WR38972 NEXT 6 LINES ARE NEW - SJN                              00180013
001900 FD  RDC-EXTR-FILE                                                00190013
002000     RECORDING MODE IS F                                          00200013
002100     LABEL RECORDS ARE STANDARD                                   00210013
002200     BLOCK CONTAINS 0 RECORDS.                                    00220013
002300 01  RDC-EXTR-RECORD             PIC X(300).                      00230013
002400*                                                                 00240013
002500***************************************************************** 00250013
002600 WORKING-STORAGE SECTION.                                         00260013
002700***************************************************************** 00270013
002800                                                                  00280013
002900**************************************************************    00290013
003000* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00300013
003100**************************************************************    00310013
003200 01  CC-CONTROL-CARD.                                             00320013
003300     05  CC-RUN-TYPE                  PIC  X(01).                 00330013
003400          88  CC-RUN-DAILY                       VALUE 'D'.       00340013
003500          88  CC-RUN-WEEKLY                      VALUE 'W'.       00350013
003600     05  FILLER                       PIC  X(79) VALUE SPACES.    00360013
003700                                                                  00370013
003800                                                                  00380013
003900 01  PS-PROGRAM-SWITCHES.                                         00390013
004000     05  PS-STORE-FOUND-SW            PIC X(01)  VALUE 'N'.       00400013
004100         88  PS-STORE-FOUND                      VALUE 'Y'.       00410013
004200         88  PS-STORE-NOT-FOUND                  VALUE 'N'.       00420013
004300     05  PS-TABLE-SEARCH-SW           PIC X(01)  VALUE 'N'.       00430013
004400         88  PS-TABLE-SEARCH                     VALUE 'Y'.       00440013
004500         88  PS-END-TABLE-SEARCH                 VALUE 'N'.       00450013
004600     05  PS-EOF-EXTRACT-SW            PIC X(01)  VALUE 'N'.       00460013
004700         88  PS-EOF-EXTRACT-FILE                 VALUE 'Y'.       00470013
004800         88  PS-NOT-EOF-EXTRACT-FILE             VALUE 'N'.       00480013
004900     05  PS-EOF-STORE-SW              PIC X(01)  VALUE 'N'.       00490013
005000         88  PS-EOF-STORE-FILE                   VALUE 'Y'.       00500013
005100         88  PS-NOT-EOF-STORE-FILE               VALUE 'N'.       00510013
005200     05  PS-EOF-TKRPRPM-CSR-SW        PIC X(01)  VALUE 'N'.       00520013
005300         88  PS-EOF-TKRPRPM-CSR                  VALUE 'Y'.       00530013
005400         88  PS-NOT-EOF-TKRPRPM-CSR              VALUE 'N'.       00540013
005500*                                                                 00550013
005600* WR38972 NEXT 9 LINES ARE NEW - SJN                              00560013
005700     05  PS-RECV-LOC-UPDATE-SE-SW     PIC X(01)  VALUE 'N'.       00570013
005800         88  PS-RECV-LOC-UPDATE-SE               VALUE 'Y'.       00580013
005900         88  PS-DONT-RECV-LOC-UPDATE-SE          VALUE 'N'.       00590013
006000     05  PS-RDC-RECORD-SW             PIC X(01)  VALUE 'N'.       00600013
006100         88  PS-RDC-RECORD-YES                   VALUE 'Y'.       00610013
006200         88  PS-RDC-RECORD-NO                    VALUE 'N'.       00620013
006300     05  PS-CURR-LOC-DC-SW            PIC X(01)  VALUE 'N'.       00630013
006400         88  PS-CURR-LOC-DC                      VALUE 'Y'.       00640013
006500         88  PS-CURR-LOC-DC-NO                   VALUE 'N'.       00650013
006600*                                                                 00660013
006700 01  ST-STORE-TABLE.                                              00670013
006800     05  ST-STORE-ENTRIES OCCURS 100 TIMES.                       00680013
006900         10  ST-STORE-NUMBER          PIC X(04).                  00690013
007000                                                                  00700013
007010 01  PV-PROGRAM-VARIABLES.                                        00701013
007020     05 PV-ST-SUB                     PIC S9(04)    VALUE +0      00702013
007030                                                      COMP-3.     00703013
007040     05 PV-TOTAL-STORES               PIC S9(04)    VALUE +0      00704013
007050                                                      COMP-3.     00705013
007060     05 PV-SQL-SUB                    PIC S9(04)    VALUE +0      00706013
007070                                                      COMP-3.     00707013
007080                                                                  00708013
007090     05  PV-STORE                     PIC 9(04).                  00709013
007100     05  PV-PREV-STORE                PIC 9(04).                  00710013
007200     05  PV-VENDOR-NAME               PIC X(30).                  00720013
007300*                                                                 00730013
007400* WR38972 NEXT 3 LINES ARE NEW - SJN                              00740013
007500     05  PV-PREV-ORD-NBR              PIC S9(09) COMP   VALUE 0.  00750013
007600     05  PV-PREV-REC-SEQ-NBR          PIC S9(09) COMP   VALUE 0.  00760013
007700     05  PV-PREV-LOC-NBR              PIC S9(04) COMP   VALUE 0.  00770013
007800*                                                                 00780013
007900     05  PV-PRC-FUNC-CDE              PIC X(06).                  00790013
008000*                                                                 00800013
008100     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      00810013
008200*                                                                 00820013
008300     05  PV-FETCH-COUNTER             PIC S9(09) VALUE ZERO       00830013
008400                                                  COMP SYNC.      00840013
008500     05  PV-TKRPRPM-FETCHED           PIC S9(09) VALUE ZERO       00850013
008600                                                  COMP SYNC.      00860013
008700     05  PV-RECORDS-WRITE-QTY         PIC S9(09) VALUE ZERO       00870013
008710                                                  COMP SYNC.      00871013
008720* WR38972 NEXT 2 LINES ARE NEW - SJN                              00872013
008730     05  PV-RDC-REC-WRITE-QTY         PIC S9(09) VALUE ZERO       00873013
008740                                                  COMP SYNC.      00874013
008750     05  PV-RECORDS-READ-QTY          PIC S9(09) VALUE ZERO       00875013
008760                                                  COMP SYNC.      00876013
008770     05  PV-POS-SELECTED              PIC S9(09) VALUE ZERO       00877013
008780                                                  COMP SYNC.      00878013
008790     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00879013
008800                                                                  00880013
008900* WR38972 NEXT 4 LINES ARE NEW - SJN                              00890013
009000     05  PV-CURR-OPER-UNT-ID          PIC S9(04) COMP   VALUE 0.  00900013
009100     05  PV-DUMMY                     PIC S9(4)  COMP VALUE 0.    00910013
009200     05  PV-INPUT-BYPASSED            PIC S9(07) COMP-3 VALUE 0.  00920013
009300     05  PV-INPUT-BYPASSED-ZERO       PIC S9(07) COMP-3 VALUE 0.  00930013
009400                                                                  00940013
009500     05 PV-EXTRACT-DATE.                                          00950013
009600       10 PV-EXTRACT-MM               PIC 9(02) VALUE ZEROS.      00960013
009700       10 FILLER                      PIC X(01) VALUE '/'.        00970013
009800       10 PV-EXTRACT-DD               PIC 9(02) VALUE ZEROS.      00980013
009900       10 FILLER                      PIC X(01) VALUE '/'.        00990013
010000       10 PV-EXTRACT-CCYY             PIC 9(04) VALUE ZEROS.      01000013
010100                                                                  01010013
010200     05 PV-PROC-DATE                  PIC X(10) VALUE SPACE.      01020013
010300                                                                  01030013
010310     05 PV-PROCESS-DATE.                                          01031013
010320       10 PV-PROC-CCYY                PIC X(04) VALUE SPACE.      01032013
010330       10 FILLER                      PIC X(01) VALUE SPACE.      01033013
010340       10 PV-PROC-MM                  PIC X(02) VALUE SPACE.      01034013
010350       10 FILLER                      PIC X(01) VALUE SPACE.      01035013
010360       10 PV-PROC-DD                  PIC X(02) VALUE SPACE.      01036013
010370                                                                  01037013
010380* WR38972 NEXT 6 LINES ARE NEW - SJN                              01038013
010390 01 DK-DATABASE-KEYS.                                             01039013
010400     05  DK-ORD-NBR                   PIC S9(09) COMP   VALUE 0.  01040013
010500     05  DK-ORD-LNE-NBR               PIC S9(09) COMP   VALUE 0.  01050013
010600     05  DK-REC-SEQ-NBR               PIC S9(09) COMP   VALUE 0.  01060013
010700     05  DK-LOC-NBR                   PIC S9(04) COMP   VALUE 0.  01070013
010800     05  DK-LOC-NBR2                  PIC  S9(4) COMP   VALUE 0.  01080013
010900     05  DK-LOC-TYP-CDE               PIC   X(2)   VALUE SPACES.  01090013
011000                                                                  01100013
011100 01 PC-PROGRAM-CONSTANTS.                                         01110013
011200     05  PC-PROGRAM-NAME             PIC X(08)  VALUE 'RCKUT112'. 01120013
011300     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.01130013
011400* WR38972 NEXT LINE IS NEW - SJN                                  01140013
011500     05  PC-DC                       PIC X(02) VALUE 'DC'.        01150013
011911     05  PC-CS                       PIC X(02) VALUE 'CS'.        01191110
011920                                                                  01192004
011930 01  PV-ABEND-FIELDS.                                             01193004
011940     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01194004
011950                                                 COMP SYNC.       01195004
011960     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKUT112'.01196004
011970     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01197004
011980     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    01198004
011990******************************************************************01199004
012000*  USED FOR DB2 ERROR MESSAGE BUILDING                            01200004
012100******************************************************************01210004
012200     COPY DPWS004.                                                01220004
012300                                                                  01230004
012400******************************************************************01240004
012500*   DB2 SQL COMMUNICATION AREA                                    01250004
012600******************************************************************01260004
012700     EXEC SQL                                                     01270004
012800          INCLUDE SQLCA                                           01280004
012900     END-EXEC.                                                    01290004
013000                                                                  01300004
013100******************************************************************01310004
013200*   DB2 DCLGEN                                                    01320004
013300******************************************************************01330004
013400     EXEC SQL                                                     01340004
013500          INCLUDE TKRPRCD                                         01350004
013600     END-EXEC.                                                    01360004
013700                                                                  01370004
013800******************************************************************01380004
013900*   DB2 DCLGEN                                                    01390004
014000******************************************************************01400004
014100     EXEC SQL                                                     01410004
014200          INCLUDE TKRPRPM                                         01420004
014300     END-EXEC.                                                    01430004
014400                                                                  01440004
014500* WR38972 NEXT 6 LINES ARE NEW - SJN                              01450004
014600******************************************************************01460004
014700*    TRECEIV - RECEIVER TABLE.                                    01470004
014800******************************************************************01480004
014900     EXEC SQL                                                     01490004
015000          INCLUDE TRECEIV                                         01500004
015100     END-EXEC.                                                    01510004
015200                                                                  01520004
015300* WR38972 NEXT 6 LINES ARE NEW - SJN                              01530004
015400******************************************************************01540004
015500*    XLT_LOC - LOGISTICS DOMAIN LOCATION MASTER TABLE.            01550004
015600******************************************************************01560004
015601     EXEC SQL                                                     01560104
015602          INCLUDE XLT00010                                        01560204
015603     END-EXEC.                                                    01560304
015604                                                                  01560404
015605* WR38972 NEXT 6 LINES ARE NEW - SJN                              01560504
015606******************************************************************01560604
015607*    TSEASET - SEASONAL SET CODES                                 01560704
015608******************************************************************01560804
015609     EXEC SQL                                                     01560904
015610          INCLUDE TSEASET                                         01561004
015620     END-EXEC.                                                    01562004
015630                                                                  01563004
015640* WR38972 NEXT 6 LINES ARE NEW - SJN                              01564004
015650******************************************************************01565004
015660*    TPURCHS - PURCHASE ORDER TABLE                               01566004
015670******************************************************************01567004
015680     EXEC SQL                                                     01568004
015690          INCLUDE TPURCHS                                         01569004
015691     END-EXEC.                                                    01569104
015692                                                                  01569204
015693* WR38972 NEXT 6 LINES ARE NEW - SJN                              01569304
015694******************************************************************01569404
015695*    WST00008 - WST_INTGRTN_TYP                                   01569504
015696******************************************************************01569604
015697     EXEC SQL                                                     01569704
015698          INCLUDE WST00008                                        01569804
015699     END-EXEC.                                                    01569904
015700                                                                  01570004
015701* WR38972 NEXT 6 LINES ARE NEW - SJN                              01570104
015702******************************************************************01570204
015703*    WST00009 - WST_ATTR_DEFN                                     01570304
015704******************************************************************01570404
015705     EXEC SQL                                                     01570504
015706          INCLUDE WST00009                                        01570604
015707     END-EXEC.                                                    01570704
015708                                                                  01570804
015709* WR38972 NEXT 6 LINES ARE NEW - SJN                              01570904
015710******************************************************************01571004
015711*    WST00010 - WST_ATTR_ELEM                                     01571104
015712******************************************************************01571204
015713     EXEC SQL                                                     01571304
015714          INCLUDE WST00010                                        01571404
015715     END-EXEC.                                                    01571504
015716                                                                  01571604
015717******************************************************************01571704
015718* EXTRACT CURSOR                                                  01571804
015719******************************************************************01571904
015720     EXEC SQL                                                     01572004
015721          DECLARE STORE-CSR CURSOR FOR                            01572104
015722          SELECT A.LOC_ID                                         01572204
015723          FROM   TKRPRPM A                                        01572304
015724          WHERE  A.INTFC_SYS_CDE     = 'KHL'                      01572404
015725            AND  A.SYS_PRC_FUNC_CDE  =  :PV-PRC-FUNC-CDE          01572504
015726            AND  A.FUNC_PRC_STAT_CDE = 'AC'                       01572604
015727            AND  A.FUNC_TXT          = 'Y'                        01572704
015728                                                                  01572804
015729* WR38972 NEXT LINE IS NEW - SJN                                  01572904
015730          WITH UR                                                 01573004
015740     END-EXEC.                                                    01574004
015750                                                                  01575004
015760******************************************************************01576004
015770*  COPYBOOK USED IN CREATING EXTRACT FILE                         01577004
015780******************************************************************01578004
015790     COPY STOREEXT.                                               01579004
015800                                                                  01580004
015900                                                                  01590004
016000******************************************************************01600004
016100 PROCEDURE DIVISION.                                              01610004
016200******************************************************************01620004
016300                                                                  01630004
016400     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           01640004
016500     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   01650004
016600                                                                  01660004
016700     EVALUATE TRUE                                                01670004
016800                                                                  01680004
016900       WHEN CC-RUN-DAILY                                          01690004
017000          MOVE 'VRFRPD'      TO  PV-PRC-FUNC-CDE                  01700004
017100                                                                  01710004
017200       WHEN CC-RUN-WEEKLY                                         01720004
017300          MOVE 'VRFRPW'      TO  PV-PRC-FUNC-CDE                  01730004
017400                                                                  01740004
017500     END-EVALUATE.                                                01750004
017600                                                                  01760004
017700*                                                                 01770004
017800     PERFORM 1000-INITIALIZATION.                                 01780004
017900*                                                                 01790004
018000     SET PS-NOT-EOF-EXTRACT-FILE TO TRUE.                         01800004
018100*                                                                 01810004
018200     IF PV-ST-SUB = 1                                             01820004
018300        CONTINUE                                                  01830004
018400     ELSE                                                         01840004
018500        PERFORM 2000-PROCESS-EXTRACTS                             01850004
018600           UNTIL PS-EOF-STORE-FILE.                               01860004
018700*                                                                 01870004
018800     PERFORM 9000-EOJ-ROUTINE.                                    01880004
018900*                                                                 01890004
019000     GOBACK.                                                      01900004
019100*                                                                 01910004
019200******************************************************************01920004
019300*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    01930004
019400******************************************************************01940004
019500 1000-INITIALIZATION.                                             01950004
019600                                                                  01960004
019700     OPEN  INPUT STORE-FILE                                       01970004
019800          OUTPUT EXTRACT-FILE                                     01980004
019900* WR38972 NEXT LINE IS NEW - SJN                                  01990004
020000                 RDC-EXTR-FILE.                                   02000004
020100                                                                  02010004
020200     DISPLAY '**************************************'.            02020004
020300     DISPLAY '*        PROGRAM - RCKUT112          *'.            02030004
020400     DISPLAY '**************************************'.            02040004
020500     DISPLAY '                                      '.            02050004
020600                                                                  02060004
020700*LOAD STORE NUMBERS INTO WS TABLE.                                02070004
020800     INITIALIZE ST-STORE-TABLE.                                   02080004
020900*                                                                 02090004
021000     SET PS-NOT-EOF-TKRPRPM-CSR TO TRUE.                          02100004
021100     PERFORM 1500-OPEN-STORE-CURSOR.                              02110004
021200                                                                  02120004
021300     MOVE +1 TO PV-ST-SUB.                                        02130004
021400     PERFORM 1600-LOAD-STORE-TABLE                                02140004
021500         UNTIL PS-EOF-TKRPRPM-CSR.                                02150004
021600*                                                                 02160004
021700     PERFORM 1800-CLOSE-STORE-CURSOR.                             02170004
021800*                                                                 02180004
021900***************************************************************** 02190004
022000 1500-OPEN-STORE-CURSOR.                                          02200004
022100***************************************************************** 02210004
022200*                                                                 02220004
022300     EXEC SQL                                                     02230004
022400         OPEN STORE-CSR                                           02240004
022500     END-EXEC.                                                    02250004
022600*                                                                 02260004
022700     EVALUATE TRUE                                                02270004
022800         WHEN SQLCODE = +0                                        02280004
022900             CONTINUE                                             02290004
023000         WHEN SQLWARN0 NOT = SPACE                                02300004
023100         WHEN SQLCODE  NOT = +0                                   02310004
023200             MOVE '1500-OPEN-STORE-CURSOR'                        02320004
023300                                 TO PV-ABEND-PARAGRAPH            02330004
023400             PERFORM Z999-SQL-ABEND                               02340004
023500     END-EVALUATE.                                                02350004
023600*                                                                 02360004
023700***************************************************************** 02370004
023800 1600-LOAD-STORE-TABLE.                                           02380004
023900***************************************************************** 02390004
024000*                                                                 02400004
024100     PERFORM 1700-FETCH-STORE-CURSOR.                             02410004
024200*                                                                 02420004
024300     IF PS-NOT-EOF-TKRPRPM-CSR                                    02430004
024400         MOVE KRPRPM-LOC-ID     TO ST-STORE-NUMBER (PV-ST-SUB)    02440004
024500         DISPLAY '***STORE NBR = ' KRPRPM-LOC-ID                  02450004
024600         ADD +1                  TO PV-ST-SUB                     02460004
024700     END-IF.                                                      02470004
024800*                                                                 02480004
024900***************************************************************** 02490004
025000 1700-FETCH-STORE-CURSOR.                                         02500004
025100***************************************************************** 02510004
025200*                                                                 02520004
025300     EXEC SQL                                                     02530004
025400          FETCH STORE-CSR                                         02540004
025500           INTO  :KRPRPM-LOC-ID                                   02550004
025600     END-EXEC.                                                    02560004
025700*                                                                 02570004
025800         EVALUATE TRUE                                            02580004
025900             WHEN SQLCODE = ZERO                                  02590004
026000                 ADD 1   TO PV-FETCH-COUNTER                      02600004
026100                 SET PS-NOT-EOF-TKRPRPM-CSR    TO TRUE            02610004
026200             WHEN SQLCODE = -904                                  02620004
026300             WHEN SQLCODE = -913                                  02630004
026400                 CONTINUE                                         02640004
026500             WHEN SQLCODE = +100                                  02650004
026600                 SET PS-EOF-TKRPRPM-CSR    TO TRUE                02660004
026700             WHEN SQLWARN0 NOT = SPACES                           02670004
026800             WHEN SQLCODE  NOT = ZERO                             02680004
026900                  MOVE '1700-FETCH-STORE-CURSOR'                  02690004
027000                                TO PV-ABEND-PARAGRAPH             02700004
027100                  MOVE 'MAX RETRIES EXCEEDED'                     02710004
027200                                TO PV-ABEND-OPERATION             02720004
027300                  PERFORM Z999-SQL-ABEND                          02730004
027400*                                                                 02740004
027500         END-EVALUATE.                                            02750004
027600*                                                                 02760004
027700***************************************************************** 02770004
027800 1800-CLOSE-STORE-CURSOR.                                         02780004
027900***************************************************************** 02790004
028000*    DISPLAY '1800-CLOSE-STORE-CSR'.                              02800004
028100*                                                                 02810004
028200     EXEC SQL                                                     02820004
028300         CLOSE STORE-CSR                                          02830004
028400     END-EXEC                                                     02840004
028500*                                                                 02850004
028600     EVALUATE TRUE                                                02860004
028700         WHEN SQLCODE = ZERO                                      02870004
028800             CONTINUE                                             02880004
028900         WHEN OTHER                                               02890004
029000             PERFORM Z999-SQL-ABEND                               02900004
029100     END-EVALUATE.                                                02910004
029200*                                                                 02920004
029300***************************************************************** 02930004
029400 2000-PROCESS-EXTRACTS.                                           02940004
029500***************************************************************** 02950004
029600     MOVE '2000-PROCESS-EXTRACTS   ' TO PV-ABEND-PARAGRAPH.       02960004
029700*                                                                 02970004
029800     PERFORM 2100-READ-INPUT-FILE.                                02980004
029900                                                                  02990004
030000     SET PS-TABLE-SEARCH TO TRUE.                                 03000004
030100*                                                                 03010004
030200     IF PV-STORE = PV-PREV-STORE                                  03020004
030300        CONTINUE                                                  03030004
030400     ELSE                                                         03040004
030500         IF PS-NOT-EOF-STORE-FILE                                 03050004
030600            SET PS-STORE-NOT-FOUND TO TRUE                        03060004
030700            MOVE PV-STORE  TO  PV-PREV-STORE                      03070004
030800                                                                  03080004
030900            PERFORM 2260-SEARCH-STORE-TABLE                       03090004
031000               VARYING PV-ST-SUB FROM 1 BY 1                      03100004
031100                                                                  03110004
031200            UNTIL PS-STORE-FOUND                                  03120004
031300               OR PS-END-TABLE-SEARCH                             03130004
031400         END-IF                                                   03140004
031500     END-IF.                                                      03150004
031600                                                                  03160004
031700     IF PS-STORE-FOUND                                            03170004
031800         PERFORM 2200-WRITE-EXTRACT-RECORD                        03180004
031900                                                                  03190004
032000* WR38972 NEXT LINE IS NEW - SJN                                  03200004
032100         PERFORM 3000-PROCESS-RDC-EXTRACTS                        03210004
032200     END-IF.                                                      03220004
032300*                                                                 03230004
032400***************************************************************** 03240004
032500 2100-READ-INPUT-FILE.                                            03250004
032600***************************************************************** 03260004
032700*                                                                 03270004
032800     READ STORE-FILE INTO STORE-EXTRACT-LINE                      03280004
032900        AT END                                                    03290004
033000           SET PS-EOF-STORE-FILE     TO TRUE                      03300004
033100        NOT AT END                                                03310004
033200            MOVE SE-LOC-NBR            TO PV-STORE                03320004
033300            ADD  +1                    TO PV-RECORDS-READ-QTY     03330004
033400     END-READ.                                                    03340004
033500*                                                                 03350004
033600***************************************************************** 03360004
033700 2200-WRITE-EXTRACT-RECORD.                                       03370004
033800***************************************************************** 03380004
033900     MOVE '2200-WRITE-EXTRACT-RCD   ' TO PV-ABEND-PARAGRAPH.      03390004
034000*                                                                 03400004
034100     IF SE-RETAIL-UNITS-MARK = 0                                  03410004
034200       CONTINUE                                                   03420004
034300     ELSE                                                         03430004
034400       WRITE EXTRACT-RECORD                                       03440004
034500          FROM STORE-EXTRACT-LINE                                 03450004
034600                                                                  03460004
034700     ADD 1          TO PV-RECORDS-WRITE-QTY.                      03470004
034800*                                                                 03480004
034900************************************************************      03490004
035000 2260-SEARCH-STORE-TABLE.                                         03500004
035100************************************************************      03510004
035200*                                                                 03520004
035300     IF PV-ST-SUB > 100                                           03530004
035400         SET PS-STORE-NOT-FOUND TO TRUE                           03540004
035500         DISPLAY '***********************************'            03550004
035600         DISPLAY 'TABLE OVERFLOW ON   '                           03560004
035700         DISPLAY 'STORE TABLE - OVER 100 OCCURS  '                03570004
035800         DISPLAY 'RUN ABORTED'                                    03580004
035900         DISPLAY '***********************************'            03590004
036000         MOVE 4001  TO PV-ABEND-CODE                              03600004
036100         PERFORM 9999-ABORT                                       03610004
036200     END-IF.                                                      03620004
036300*                                                                 03630004
036400     IF ST-STORE-NUMBER (PV-ST-SUB) = SPACES                      03640004
036500         SET PS-END-TABLE-SEARCH      TO TRUE                     03650004
036600     END-IF.                                                      03660004
036700*                                                                 03670004
036800     IF ST-STORE-NUMBER (PV-ST-SUB) = PV-STORE                    03680004
036900         SET PS-STORE-FOUND TO TRUE                               03690004
037000     END-IF.                                                      03700004
037100*                                                                 03710004
037200* WR38972 PARAGRAPH IS NEW - SJN                                  03720004
037300***************************************************************** 03730004
037400 3000-PROCESS-RDC-EXTRACTS.                                       03740004
037500***************************************************************** 03750004
037600                                                                  03760004
037700     MOVE SE-PO            TO DK-ORD-NBR.                         03770004
037800     MOVE SE-REC-SEQ-NBR   TO DK-REC-SEQ-NBR.                     03780004
037900     MOVE SE-LOC-NBR       TO DK-LOC-NBR.                         03790004
038000                                                                  03800004
038100     IF  SE-RETAIL-UNITS-MARK = 0                                 03810004
038200         ADD +1 TO PV-INPUT-BYPASSED-ZERO                         03820004
038300                                                                  03830004
038400     ELSE                                                         03840004
038401         IF  DK-ORD-NBR          = PV-PREV-ORD-NBR                03840104
038402         AND DK-REC-SEQ-NBR      = PV-PREV-REC-SEQ-NBR            03840204
038403         AND DK-LOC-NBR          = PV-PREV-LOC-NBR                03840304
038404             IF  PS-RECV-LOC-UPDATE-SE                            03840404
038405                 IF  PS-RDC-RECORD-YES                            03840504
038406                     PERFORM 3300-GUARANTE-LOC-IS-DC              03840604
038408                     IF  PS-CURR-LOC-DC                           03840804
038409* BEGIN DRW 06/05/2014                                            03840909
038411                       IF SE-CS-CONVRSON                          03841111
038412                         PERFORM 3400-WRITE-RDC-EXTR-REC          03841209
038417* END DRW                                                         03841709
038419                       ELSE                                       03841909
038420                         ADD +1 TO PV-INPUT-BYPASSED              03842004
038421                       END-IF                                     03842109
038422                     ELSE                                         03842209
038423                       ADD +1 TO PV-INPUT-BYPASSED                03842309
038424                     END-IF                                       03842409
038426                 ELSE                                             03842609
038427                     ADD +1 TO PV-INPUT-BYPASSED                  03842709
038428                 END-IF                                           03842809
038429                                                                  03842909
038430             ELSE                                                 03843009
038431                 ADD +1 TO PV-INPUT-BYPASSED                      03843109
038432             END-IF                                               03843209
038433                                                                  03843309
038434         ELSE                                                     03843409
038435             MOVE DK-ORD-NBR      TO PV-PREV-ORD-NBR              03843509
038436             MOVE DK-REC-SEQ-NBR  TO PV-PREV-REC-SEQ-NBR          03843609
038437             MOVE DK-LOC-NBR      TO PV-PREV-LOC-NBR              03843709
038438                                                                  03843809
038439             SET PS-RECV-LOC-UPDATE-SE TO TRUE                    03843909
038440             SET PS-RDC-RECORD-NO      TO TRUE                    03844009
038441                                                                  03844109
038442             PERFORM 3100-CHECK-RECV-LOC-NBR                      03844209
038443                                                                  03844309
038444             IF  XLT00010-E-BUS-IND = 'Y'                         03844409
038445                 PERFORM 3200-CHECK-FOR-RDC                       03844509
038446             END-IF                                               03844609
038447                                                                  03844709
038448             IF  PS-RECV-LOC-UPDATE-SE                            03844809
038449                 IF  PS-RDC-RECORD-YES                            03844909
038450                     PERFORM 3300-GUARANTE-LOC-IS-DC              03845009
038451                                                                  03845109
038452                     IF  PS-CURR-LOC-DC                           03845209
038453* BEGIN DRW 06/05/2014                                            03845309
038455                       IF SE-CS-CONVRSON                          03845511
038456                         PERFORM 3400-WRITE-RDC-EXTR-REC          03845609
038458* END DRW                                                         03845809
038460                       ELSE                                       03846009
038461                         ADD +1 TO PV-INPUT-BYPASSED              03846109
038462                       END-IF                                     03846209
038463                     ELSE                                         03846309
038464                         ADD +1 TO PV-INPUT-BYPASSED              03846409
038465                     END-IF                                       03846509
038467                 ELSE                                             03846709
038468                     ADD +1 TO PV-INPUT-BYPASSED                  03846809
038469                 END-IF                                           03846909
038470                                                                  03847009
038471             ELSE                                                 03847109
038472                 ADD +1 TO PV-INPUT-BYPASSED                      03847209
038473                                                                  03847309
038474             END-IF                                               03847409
038475         END-IF                                                   03847509
038476     END-IF.                                                      03847609
038477                                                                  03847709
038478                                                                  03847809
038479* WR38972 PARAGRAPH IS NEW - SJN                                  03847909
038480***************************************************************** 03848009
038481* CHECK TO SEE IF THE DC ASSOCIATED TO THE RECEIVING STORE        03848109
038482* IS SET FOR UPDATE OF STORE EXPECTED.                            03848209
038483***************************************************************** 03848309
038484 3100-CHECK-RECV-LOC-NBR.                                         03848409
038485                                                                  03848509
038486     EXEC SQL                                                     03848609
038487         SELECT A.ORD_NBR                                         03848709
038488              , A.VERFYD_TMST                                     03848809
038489              , D.E_BUS_IND                                       03848909
038490              , A.CURR_OPER_UNT_ID                                03849009
038491                                                                  03849109
038492           INTO :RECEIV-ORD-NBR                                   03849209
038493              , :RECEIV-VERFYD-TMST                               03849309
038494              , :XLT00010-E-BUS-IND                               03849409
038495              , :RECEIV-CURR-OPER-UNT-ID                          03849509
038496                                                                  03849609
038497         FROM TRECEIV   A                                         03849709
038498            , XLT_DC_LOC_ASGMT   B                                03849809
038499            , TKRPRPM   C                                         03849909
038500            , XLT_LOC   D                                         03850009
038501                                                                  03850109
038502         WHERE A.ORD_NBR          = :DK-ORD-NBR                   03850209
038503           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               03850309
038504           AND NOT A.REC_TYP_CDE  = 'CD'                          03850413
038505           AND B.LOC_NBR          = :DK-LOC-NBR                   03850509
038506                                                                  03850609
038507           AND B.EFF_BEG_DTE      =                               03850709
038508                (SELECT MAX(EFF_BEG_DTE)                          03850809
038509                   FROM XLT_DC_LOC_ASGMT Z                        03850909
038510                  WHERE Z.LOC_NBR = B.LOC_NBR                     03851009
038511                    AND EFF_BEG_DTE <= CURRENT DATE)              03851109
038512                                                                  03851209
038513           AND C.LOC_ID           = B.DC_NBR                      03851309
038514           AND C.INTFC_SYS_CDE    = 'KHL'                         03851409
038515           AND C.SYS_PRC_FUNC_CDE = 'STREXP'                      03851509
038516           AND A.CRE_TMST         >= C.FUNC_BEG_TMST              03851609
038517           AND D.LOC_NBR           = B.LOC_NBR                    03851709
038518           AND D.LOC_TYP_CDE       = 'DS'                         03851809
038519         WITH UR                                                  03851909
038520       END-EXEC.                                                  03852009
038521                                                                  03852109
038522     EVALUATE TRUE                                                03852209
038523         WHEN SQLCODE = ZERO                                      03852309
038524         WHEN SQLCODE = -811                                      03852409
038525              CONTINUE                                            03852509
038526                                                                  03852609
038527         WHEN SQLCODE = +100                                      03852709
038528              SET PS-DONT-RECV-LOC-UPDATE-SE TO TRUE              03852809
038529                                                                  03852909
038530         WHEN SQLCODE = -904                                      03853009
038531         WHEN SQLCODE = -911                                      03853109
038532         WHEN SQLCODE = -913                                      03853209
038533              MOVE SQLCODE TO PV-SQLCODE                          03853309
038534              MOVE '3100-CHECK-RECV-LOC-NBR'                      03853409
038535                                TO PV-ABEND-PARAGRAPH             03853509
038536              MOVE 'CONTENTION PROBLEM'                           03853609
038537                            TO PV-ABEND-OPERATION                 03853709
038538              PERFORM Z999-SQL-ABEND                              03853809
038539                                                                  03853909
038540         WHEN SQLWARN0 NOT = SPACES                               03854009
038541         WHEN SQLCODE < +0                                        03854109
038542         WHEN SQLCODE > +0                                        03854209
038543              MOVE SQLCODE TO PV-SQLCODE                          03854309
038544              MOVE '3100-CHECK-RECV-LOC-NBR'                      03854409
038545                                TO PV-ABEND-PARAGRAPH             03854509
038546              MOVE 'SQL ERROR PROBLEM'                            03854609
038547                            TO PV-ABEND-OPERATION                 03854709
038548              PERFORM Z999-SQL-ABEND                              03854809
038549      END-EVALUATE.                                               03854909
038550                                                                  03855009
038551                                                                  03855109
038552* WR38972 PARAGRAPH IS NEW - SJN                                  03855209
038553***************************************************************** 03855309
038554* CHECK TO SEE IF THE PO IS ING STORE IS SET FOR A SPECIFIC RDC   03855409
038555* SEASONAL SET CODE AND THUS FEED OMS                             03855509
038556***************************************************************** 03855609
038557 3200-CHECK-FOR-RDC.                                              03855709
038558                                                                  03855809
038559     EXEC SQL                                                     03855909
038560         SELECT G.SEASET_SHRT_NM                                  03856009
038561                                                                  03856109
038562           INTO :SEASET-SEASET-SHRT-NM                            03856209
038563                                                                  03856309
038570           FROM  WST_INTGRTN_TYP  A                               03857004
038580                ,WST_ATTR_DEFN    B                               03858004
038590                ,WST_ATTR_ELEM    C                               03859004
038600                ,WST_ATTR_ELEM    D                               03860004
038601                ,WST_ATTR_ELEM    E                               03860104
038602                ,WST_ATTR_ELEM    F                               03860204
038603                ,TSEASET          G                               03860304
038604                ,TPURCHS          H                               03860404
038605                                                                  03860504
038606            WHERE A.INTGRTN_TYP_CDE   = 'EFCATRDC'                03860604
038607              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         03860704
038608                                                                  03860804
038609              AND B.ATTR_DEFN_SEQ_NBR = 1                         03860904
038610              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         03861004
038611              AND C.ATTR_DEFN_SEQ_NBR = 1                         03861104
038612              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         03861204
038613              AND D.ATTR_DEFN_SEQ_NBR = 2                         03861304
038614              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         03861404
038615              AND E.ATTR_DEFN_SEQ_NBR = 3                         03861504
038616              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         03861604
038617              AND F.ATTR_DEFN_SEQ_NBR = 4                         03861704
038618                                                                  03861804
038619              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       03861904
038620              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       03862004
038621              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       03862104
038622                                                                  03862204
038623              AND C.ATTR_ELEM_TXT     = G.SEASET_TYP_CDE          03862304
038624              AND D.ATTR_ELEM_TXT     = 'ACTIVE'                  03862404
038625                                                                  03862504
038626              AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP         03862604
038627              AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP         03862704
038628                                                                  03862804
038629              AND G.SEASET_SHRT_NM    = H.SEASET_SHRT_NM          03862904
038630              AND G.SEASET_YR         = H.SEASET_YR               03863004
038631              AND H.PO_NBR            = :DK-ORD-NBR               03863104
038632              AND H.VER_STATUS_CDE    = 'A'                       03863204
038633           WITH UR                                                03863304
038634       END-EXEC.                                                  03863404
038635                                                                  03863504
038636     EVALUATE TRUE                                                03863604
038637         WHEN SQLCODE = ZERO                                      03863704
038638         WHEN SQLCODE = -811                                      03863804
038639              SET PS-RDC-RECORD-YES TO TRUE                       03863904
038640                                                                  03864006
038642         WHEN SQLCODE = +100                                      03864204
038643              SET PS-RDC-RECORD-NO  TO TRUE                       03864304
038645                                                                  03864504
038646         WHEN SQLCODE = -904                                      03864604
038647         WHEN SQLCODE = -911                                      03864704
038648         WHEN SQLCODE = -913                                      03864804
038649              MOVE SQLCODE TO PV-SQLCODE                          03864904
038650              MOVE '3200-CHECK-FOR-RDC'                           03865004
038651                                TO PV-ABEND-PARAGRAPH             03865104
038652              MOVE 'CONTENTION PROBLEM'                           03865204
038653                            TO PV-ABEND-OPERATION                 03865304
038654              PERFORM Z999-SQL-ABEND                              03865404
038655                                                                  03865504
038656         WHEN SQLWARN0 NOT = SPACES                               03865604
038657         WHEN SQLCODE < +0                                        03865704
038658         WHEN SQLCODE > +0                                        03865804
038659              MOVE SQLCODE TO PV-SQLCODE                          03865904
038660              MOVE '3200-CHECK-FOR-RDC'                           03866004
038661                                TO PV-ABEND-PARAGRAPH             03866104
038662              MOVE 'SQL ERROR PROBLEM'                            03866204
038663                            TO PV-ABEND-OPERATION                 03866304
038664              PERFORM Z999-SQL-ABEND                              03866404
038665      END-EVALUATE.                                               03866504
038666                                                                  03866604
038741* WR38972 PARAGRAPH IS NEW - SJN                                  03874104
038742***************************************************************** 03874204
038743* CHECK THE OUTPUT CURR_OPER_UNT_ID TO SEE IF IT'S A DC THAT      03874304
038744* SUPPORTS THE STORES & HAS PARM OF 'REDDCS' ETC. ON TKRPRPM TBL. 03874404
038745* THIS IS DONE FOR THE RDC ECOMM ORDER TO BE FULFILLED IN A DC.   03874504
038746***************************************************************** 03874604
038747 3300-GUARANTE-LOC-IS-DC.                                         03874704
038748                                                                  03874804
038749     MOVE SE-CURR-OPER-UNT-ID TO DK-LOC-NBR2.                     03874904
038750     MOVE PC-DC               TO DK-LOC-TYP-CDE.                  03875004
038751                                                                  03875104
038752     EXEC SQL                                                     03875204
038753         SELECT 1                                                 03875304
038754           INTO   :PV-DUMMY                                       03875404
038755                                                                  03875504
038756         FROM XLT_LOC                                             03875604
038757                                                                  03875704
038758* INC2352859 NEXT 3 LINES HAVE BEEN CHANGED - SJN                 03875806
038759         WHERE LOC_TYP_CDE = :DK-LOC-TYP-CDE                      03875906
038760           AND E_BUS_IND   = 'N'                                  03876006
038761           AND LOC_NBR     = :DK-LOC-NBR2                         03876106
038762         WITH UR                                                  03876204
038763       END-EXEC.                                                  03876304
038764                                                                  03876404
038765     EVALUATE TRUE                                                03876504
038766         WHEN SQLCODE = ZERO                                      03876604
038767         WHEN SQLCODE = -811                                      03876704
038768              SET PS-CURR-LOC-DC    TO TRUE                       03876804
038769                                                                  03876905
038770         WHEN SQLCODE = +100                                      03877005
038771              SET PS-CURR-LOC-DC-NO TO TRUE                       03877105
038772                                                                  03877205
038773         WHEN SQLCODE = -904                                      03877305
038774         WHEN SQLCODE = -911                                      03877405
038775         WHEN SQLCODE = -913                                      03877505
038776              MOVE SQLCODE TO PV-SQLCODE                          03877605
038777              MOVE '3300-GUARANTE-LOC-IS-DC'                      03877705
038778                                TO PV-ABEND-PARAGRAPH             03877805
038779              MOVE 'CONTENTION PROBLEM'                           03877905
038780                            TO PV-ABEND-OPERATION                 03878005
038781              PERFORM Z999-SQL-ABEND                              03878105
038782                                                                  03878205
038783         WHEN SQLWARN0 NOT = SPACES                               03878305
038784         WHEN SQLCODE < +0                                        03878405
038785         WHEN SQLCODE > +0                                        03878505
038786              MOVE SQLCODE TO PV-SQLCODE                          03878605
038787              MOVE '3300-GUARANTE-LOC-IS-DC'                      03878705
038788                           TO PV-ABEND-PARAGRAPH                  03878805
038789              MOVE 'SQL ERROR PROBLEM'                            03878905
038790                            TO PV-ABEND-OPERATION                 03879005
038791              PERFORM Z999-SQL-ABEND                              03879105
038792      END-EVALUATE.                                               03879205
038793                                                                  03879305
038794                                                                  03879405
038795* WR38972 PARAGRAPH IS NEW - SJN                                  03879505
038869                                                                  03886910
038870***************************************************************** 03887005
038871 3400-WRITE-RDC-EXTR-REC.                                         03887105
038872***************************************************************** 03887205
038873                                                                  03887305
038874     MOVE '3400-WRITE-RDC-EXTR-REC  ' TO PV-ABEND-PARAGRAPH.      03887405
038875                                                                  03887505
038876     IF  SE-RETAIL-UNITS-MARK = 0                                 03887605
038877         CONTINUE                                                 03887705
038878     ELSE                                                         03887805
038879         WRITE RDC-EXTR-RECORD                                    03887905
038880               FROM STORE-EXTRACT-LINE                            03888005
038881     END-IF.                                                      03888105
038882                                                                  03888205
038883     ADD 1 TO PV-RDC-REC-WRITE-QTY.                               03888305
038884                                                                  03888405
038885                                                                  03888505
038886***************************************************************** 03888605
038887 9000-EOJ-ROUTINE.                                                03888705
038888***************************************************************** 03888805
038889*                                                                 03888905
038890     CLOSE  STORE-FILE                                            03889005
038891           EXTRACT-FILE                                           03889105
038892* WR38972 NEXT LINE IS NEW - SJN                                  03889205
038893           RDC-EXTR-FILE.                                         03889305
038894                                                                  03889405
038895* WR38972 NEXT 10 LINES ARE NEW - SJN                             03889505
038896     DISPLAY '                    '.                              03889605
038897     DISPLAY '********************'.                              03889705
038898     DISPLAY '  PROGRAM CONTROLS  '.                              03889805
038899     DISPLAY '********************'.                              03889905
038900     DISPLAY 'RECS READ     = ' PV-FETCH-COUNTER.                 03890005
038901     DISPLAY 'WRITTEN       = ' PV-RECORDS-WRITE-QTY.             03890105
038902     DISPLAY 'RDC WRITTEN   = ' PV-RDC-REC-WRITE-QTY.             03890205
038903     DISPLAY 'BYPASSED      = ' PV-INPUT-BYPASSED.                03890304
038904     DISPLAY 'BYPASSED ZERO = ' PV-INPUT-BYPASSED-ZERO.           03890404
038905     DISPLAY '                    '.                              03890504
038906                                                                  03890604
038910     DISPLAY '***END RCKUT112***'.                                03891004
039000                                                                  03900004
039100                                                                  03910004
039200***************************************************************** 03920004
039300 Z999-SQL-ABEND.                                                  03930004
039400***************************************************************** 03940004
039500                                                                  03950004
039600     MOVE SQLCODE TO PV-SQLCODE.                                  03960004
039700     DISPLAY '*** DB2 ERROR '.                                    03970004
039800     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       03980004
039900     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 03990004
040000     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               04000004
040100     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               04010004
040200                                                                  04020004
040300     COPY DPPD004.                                                04030004
040400                                                                  04040004
040500                                                                  04050004
040600     MOVE +4013                  TO PV-ABEND-CODE.                04060004
040700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         04070004
040800***************************************************************** 04080004
040900 9999-ABORT.                                                      04090004
041000***************************************************************** 04100004
041100                                                                  04110004
041200      DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                    04120004
041300      CALL 'ILBOABN0'   USING PV-ABEND-CODE.                      04130004
041400                                                                  04140004
