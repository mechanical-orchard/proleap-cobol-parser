000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - SML ALREADY ASSIGNED WARNING  / PRINT SML'. 00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRF858.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN.           JANUARY 2001.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000 ENVIRONMENT DIVISION.                                            00100000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400******************************************************************00140000
001500*                                                                 00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-FR-STR-NBR                PIC  S9(04) COMP            00170000
001800                                           VALUE ZERO.            00180000
001900     05  DK-XFER-SEQ-NBR              PIC  S9(08) COMP            00190000
002000                                           VALUE ZERO.            00200000
002100     05  DK-TRN-NBR                   PIC  S9(09) COMP            00210004
002200                                           VALUE ZERO.            00220000
002300                                                                  00230000
002400 01  PC-PROGRAM-CONSTANTS.                                        00240000
002500     05  PC-TRANID                       PIC  X(04)  VALUE 'E858'.00250000
002600                                                                  00260000
002700     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)  VALUE 'PCKRF858'. 00270000
002800     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00280000
002900     05  PC-PCKCS721               PIC  X(08)  VALUE 'PCKCS721'.  00290000
003000                                                                  00300000
003100* ERROR MESSAGES                                                 *00310000
003200     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19) VALUE               00320000
003300                                           'DB2 ACCESS ERROR   '. 00330000
003400     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00340000
003500                                           'UNRECOGNIZED PF KEY'. 00350000
003600     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00360000
003700                                           'ENTER THROUGH MENU '. 00370000
003800     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00380000
003900                                           'TRANS NOT AVAILABLE'. 00390000
004000     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               00400000
004100                                           'PLEASE ENTER FIELD '. 00410000
004200     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00420000
004300                                           'MUST BE NUMERIC    '. 00430000
004400     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               00440000
004500                                           'MUST BE > ZERO     '. 00450000
004600     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               00460000
004700                                           'FIRST DIGIT NOT 0  '. 00470000
004800     05  PC-TOO-MANY-DIGITS         PIC X(19) VALUE               00480000
004900                                           'TOO MANY DIGITS    '. 00490000
005000     05  PC-CICS-ERR-MSG            PIC X(19) VALUE               00500000
005100                                           'CICS ACCESS ERROR  '. 00510000
005200     05  PC-WRONG-FACILITY          PIC X(19) VALUE               00520000
005300                                           'WRG FCLTY - F2 CONF'. 00530000
005400     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               00540000
005500                                           'MORE DIGITS REQUIRD'. 00550000
005600     05  PC-IGNORE-UPDATE-MSG       PIC X(19) VALUE               00560000
005700                                           'UPDATE NOT DONE    '. 00570000
005800                                                                  00580000
005900 01  PS-PROGRAM-SWITCHES.                                         00590000
006000     05  PS-ERROR-SW                  PIC  X(01)  VALUE 'N'.      00600000
006100         88  PS-ERRORS-YES                        VALUE 'Y'.      00610000
006200         88  PS-ERRORS-NO                         VALUE 'N'.      00620000
006300     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'N'.      00630000
006400         88  PS-VALID-INPUT                       VALUE 'Y'.      00640000
006500         88  PS-INVALID-INPUT                     VALUE 'N'.      00650000
006600     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00660000
006700         88  PS-XCTL-E854                         VALUE 'E854'.   00670000
006800         88  PS-XCTL-E857                         VALUE 'E857'.   00680000
006900         88  PS-XCTL-E858                         VALUE 'E858'.   00690000
007000     05  PS-CSR-SW                    PIC X(01)   VALUE 'N'.      00700000
007100         88  PS-END-CSR-YES                       VALUE 'Y'.      00710000
007200                                                                  00720000
007300*----------------------------------------------------------------*00730000
007400*  PROGRAM VARIABLES                                             *00740000
007500*----------------------------------------------------------------*00750000
007600 01  PV-PROGRAM-VARIABLES.                                        00760000
007700     05  PV-CICS-RESP                 PIC S9(04) VALUE ZERO       00770000
007800                                                 COMP SYNC.       00780000
007900     05  PV-SAVE-PRTR-ID              PIC X(08) VALUE SPACES.     00790000
008000                                                                  00800000
008100     05  PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.     00810000
008200     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          00820000
008300         10 FILLER                    PIC  X(03).                 00830000
008400         10 PV-2-DIGIT-DC-ABBR        PIC  X(02).                 00840000
008500     05  PV-STORE-NUMBER.                                         00850000
008600         10  PV-STORE-NUMBER-N    PIC 9(04)   VALUE ZERO.         00860000
008700     05  PV-FAST-NBR.                                             00870000
008800         10  PV-FAST-STORE            PIC 9(05) VALUE ZERO.       00880004
008900         10  FILLER                   PIC X(01) VALUE '-'.        00890000
009000         10  PV-FAST-SEQ              PIC 9(06) VALUE ZERO.       00900000
009100         10  FILLER                   PIC X(01) VALUE '-'.        00910000
009200         10  PV-FAST-CHK-DIGIT        PIC 9(01) VALUE ZERO.       00920000
009300                                                                  00930000
009400                                                                  00940000
009500     05  PV-TMST                      PIC X(26).                  00950000
009600     05  PV-SUB                       PIC S9(4) COMP              00960009
009700                                                VALUE ZERO.       00970010
009800     05  PV-LABEL-COUNT               PIC S9(4) COMP              00980010
009900                                                VALUE ZERO.       00990010
010000     05  PV-FAST-COUNT                PIC S9(04) COMP             01000010
010100                                                VALUE ZERO.       01010010
010200                                                                  01020010
010300     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   01030010
010400                                                     COMP SYNC.   01040010
010500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01050010
010600                                                     COMP SYNC.   01060010
010700     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01070010
010800     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01080010
010900                                                     COMP SYNC.   01090010
011000     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01100010
011100                                                                  01110010
011200     05  PV-CARTON-N                  PIC S9(18) VALUE ZERO.      01120010
011300     05  PV-CARTON-SPLIT REDEFINES PV-CARTON-N.                   01130010
011400         10  FILLER                   PIC X(10).                  01140010
011500         10  PV-CARTON-MFST-NBR       PIC 9(08).                  01150010
011600 01  PV-LOG-MSG.                                                  01160010
011700     05  FILLER                       PIC X(12) VALUE             01170010
011800         ' E857 ERROR '.                                          01180010
011900     05  FILLER                       PIC X(09) VALUE             01190010
012000         'SQLCODE= '.                                             01200010
012100     05  PV-SQLCODE                   PIC -9(03).                 01210010
012200     05  FILLER                       PIC X(06) VALUE             01220010
012300         ' ERR= '.                                                01230010
012400     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01240010
012500     05  FILLER                       PIC X(07) VALUE             01250010
012600         ' FAST= '.                                               01260010
012700     05  PV-DISPLAY-FAST              PIC X(14) VALUE ZEROES.     01270010
012800     05  FILLER                       PIC X(05) VALUE             01280010
012900         ' PO= '.                                                 01290010
013000     05  PV-DISPLAY-PO                PIC 9(09) VALUE ZEROES.     01300010
013100     05  FILLER                       PIC X(07) VALUE             01310010
013200         ' RCVR= '.                                               01320010
013300     05  PV-DISPLAY-RCVR              PIC 9(04) VALUE ZEROES.     01330010
013400     05  FILLER                       PIC X(07) VALUE             01340010
013500         ' LINE= '.                                               01350010
013600     05  PV-DISPLAY-PO-LNE-NBR        PIC 9(04) VALUE ZEROES.     01360010
013700     05  FILLER                       PIC X(06) VALUE             01370010
013800         ' STR= '.                                                01380010
013900     05  PV-DISPLAY-STORE             PIC 9(04) VALUE ZEROES.     01390010
014000                                                                  01400010
014100 01  PV-EDITING-FIELDS.                                           01410010
014200                                                                  01420010
014300     05  PV-PROGRAM-DATA.                                         01430010
014400** AS PART OF THE PO EXPANSION PROJECT, COMMENTED OUT THE NEXT    01440010
014500** 7 LINES BECAUSE THEY ARE NEVER REFERENCED IN THE PROGRAM.      01450010
014600*        10  PV-PO                       PIC  X(07)  VALUE SPACE. 01460010
014700*        10  PV-PO-N REDEFINES PV-PO     PIC  ZZZZZZ9.            01470010
014800*                                                                 01480010
014900*        10  PV-PO-RCVR.                                          01490010
015000*            15 PV-PO-OUT                PIC  9(07).              01500010
015100*            15 FILLER                   PIC  X(01)  VALUE '-'.   01510010
015200*            15 PV-RCVR-OUT              PIC 9(03).               01520010
015300*                                                                 01530010
015400                                                                  01540010
015500         10  PV-PO-LINE-N                  PIC 9(09).             01550010
015600         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 01560010
015700             15 FILLER                     PIC X(05).             01570010
015800             15 PV-PO-LINE-OUT             PIC X(04).             01580010
015900                                                                  01590010
016000         10  PV-PO-LINE-LBL.                                      01600010
016100             15  PV-LINE-LBL-1           PIC 9(01).               01610010
016200             15  PV-LINE-LBL-3           PIC 9(03).               01620010
016300                                                                  01630010
016400 01  ERROR-MESSAGES.                                              01640010
016500     05  PM-PROGRAM-MESSAGE-1.                                    01650010
016600         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       01660010
016700         10  FILLER               PIC  X(01)  VALUE '-'.          01670010
016800         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       01680010
016900         10  FILLER               PIC  X(48)  VALUE SPACES.       01690010
017000                                                                  01700010
017100/                                                                 01710010
017200* COMMAREA FOR PCRF85X SCREENS                                    01720010
017300 01  CA-COMMAREA.                                                 01730010
017400     COPY PCWS033.                                                01740010
017500/                                                                 01750010
017600*  CHECK DIGIT WORK AREA                                          01760010
017700     COPY PCWS037.                                                01770010
017800/                                                                 01780010
017900*  MAP LAYOUT                                                     01790010
018000     COPY PCKM858.                                                01800010
018100/                                                                 01810010
018200* HELP SCREEN COMMAREA                                            01820010
018300     COPY PCWS192.                                                01830010
018400* HELP SCREEN WORK AREA                                           01840010
018500     COPY PCWS188.                                                01850010
018600/                                                                 01860010
018700* PRINTER VALIDATION AREA                                         01870010
018800     COPY DPWS072.                                                01880010
018900/                                                                 01890010
019000* MANIFEST NBR MODULE                                             01900010
019100     COPY PCWS187.                                                01910010
019200/                                                                 01920010
019300* CARTON LABELING SYSTEM COMMAREA                                 01930010
019400     COPY PCWS140.                                                01940010
019500/                                                                 01950010
019600*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01960010
019700     COPY DPWS015.                                                01970010
019800     COPY DPWS010I.                                               01980010
019900                                                                  01990010
020000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02000010
020100     COPY DFHAID.                                                 02010010
020200                                                                  02020010
020300*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02030010
020400     COPY DPWS013.                                                02040010
020500/                                                                 02050010
020600*                                                                 02060010
020700*  DCLGEN FOR THE LOGISTICS DOMAIN LOCATION MASTER TABLE          02070010
020800*                                                                 02080010
020900     EXEC SQL                                                     02090010
021000         INCLUDE XLT00010                                         02100010
021100     END-EXEC.                                                    02110010
021200                                                                  02120010
021300     EXEC SQL                                                     02130010
021400         INCLUDE TCOCNTL                                          02140010
021500     END-EXEC.                                                    02150010
021600                                                                  02160010
021700     EXEC SQL                                                     02170010
021800         INCLUDE SUT00024                                         02180010
021900     END-EXEC.                                                    02190010
022000                                                                  02200010
022100     EXEC SQL                                                     02210010
022200         INCLUDE SUT00028                                         02220010
022300     END-EXEC.                                                    02230010
022400                                                                  02240010
022500     EXEC SQL                                                     02250010
022600         DECLARE LABEL-CSR CURSOR WITH HOLD FOR                   02260010
022700         SELECT DISTINCT                                          02270010
022800             A.SHIPT_UNT_ID                                       02280010
022900           , B.ORGN_LOC_NBR                                       02290010
023000         FROM SUT_OTBND_UPC A                                     02300010
023100             ,SUT_OTBND_CART B                                    02310010
023200         WHERE TRN_NBR = :SUT00028-TRN-NBR                        02320010
023300           AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    02330010
023400         ORDER BY SHIPT_UNT_ID                                    02340010
023500     END-EXEC                                                     02350010
023600                                                                  02360010
023700     EXEC SQL                                                     02370010
023800         INCLUDE SQLCA                                            02380010
023900     END-EXEC.                                                    02390010
024000                                                                  02400010
024100 LINKAGE SECTION.                                                 02410010
024200 01  DFHCOMMAREA.                                                 02420010
024300     05  FILLER                         OCCURS  1 TO 4072 TIMES   02430010
024400                                      DEPENDING ON EIBCALEN.      02440010
024500         10  FILLER                   PIC X.                      02450010
024600/                                                                 02460010
024700 PROCEDURE DIVISION.                                              02470010
024800 0000-PROGRAM-MAINLINE.                                           02480010
024900                                                                  02490010
025000                                                                  02500010
025100     INITIALIZE CA-COMMAREA                                       02510010
025200     MOVE DFHCOMMAREA                 TO CA-COMMAREA.             02520010
025300                                                                  02530010
025400     EVALUATE TRUE                                                02540010
025500         WHEN EIBCALEN = ZERO                                     02550010
025600             MOVE PC-ENTER-THROUGH-MENU-MSG                       02560010
025700                                      TO PV-MESSAGE-AREA          02570010
025800             PERFORM 8110-RETURN                                  02580010
025900                                                                  02590010
026000         WHEN EIBTRNID = 'Z278'                                   02600010
026100             MOVE DFHCOMMAREA         TO PC192-COMMAREA           02610010
026200             MOVE PC192-HOST-SAVE-AREA                            02620010
026300                                      TO CA-COMMAREA              02630010
026400             SET PC033-PROCESS-SCREEN TO TRUE                     02640010
026500             MOVE PC192-HOST-SAVE-MAP TO PC858AO                  02650010
026600             PERFORM 8000-SEND-MAP                                02660010
026700             PERFORM 8100-RETURN-TRANID                           02670010
026800                                                                  02680010
026900         WHEN PC033-INITIALIZE-SCREEN                             02690010
027000         WHEN EIBAID = DFHCLEAR                                   02700010
027100             PERFORM 1000-INITIALIZE                              02710010
027200             PERFORM 8000-SEND-MAP                                02720010
027300             PERFORM 8100-RETURN-TRANID                           02730010
027400                                                                  02740010
027500                                                                  02750010
027600         WHEN EIBAID = DFHPF3                                     02760010
027700             MOVE 'PCKRF853'          TO PV-TRANSFER-PROGRAM      02770010
027800             PERFORM 8200-XCTL                                    02780010
027900                                                                  02790010
028000         WHEN EIBAID = DFHPF4                                     02800010
028100                                                                  02810010
028200*            DELETE FAST ITEMS FROM ALL CARTONS                   02820010
028300*            PCKRF854 WILL ADD THE FAST INTO A NEW CARTON         02830010
028400                                                                  02840010
028500             PERFORM 3000-DELETE-FAST-FROM-CARTONS                02850010
028600             IF PS-ERRORS-NO                                      02860010
028700                 SET PC033-MOVE-FAST-TO-NEW-LABEL                 02870010
028800                                      TO TRUE                     02880010
028900                 MOVE 'PCKRF854'      TO PV-TRANSFER-PROGRAM      02890010
029000                 PERFORM 8200-XCTL                                02900010
029100             END-IF                                               02910010
029200                                                                  02920010
029300         WHEN EIBAID = DFHENTER                                   02930010
029400             PERFORM 2000-PROCESS                                 02940010
029500             PERFORM 8010-SEND-DATA-ONLY                          02950010
029600             PERFORM 8100-RETURN-TRANID                           02960010
029700                                                                  02970010
029800                                                                  02980010
029900         WHEN EIBAID = DFHPF1                                     02990010
030000             PERFORM 8020-RECEIVE-MAP                             03000010
030100             MOVE PC858AO             TO PC192-HOST-SAVE-MAP      03010010
030200             PERFORM 1200-HELP-SCREEN                             03020010
030300                                                                  03030010
030400         WHEN OTHER                                               03040010
030500             PERFORM 8010-SEND-DATA-ONLY                          03050010
030600             PERFORM 8100-RETURN-TRANID                           03060010
030700     END-EVALUATE.                                                03070010
030800                                                                  03080010
030900     GOBACK.                                                      03090010
031000                                                                  03100010
031100 1000-INITIALIZE.                                                 03110010
031200                                                                  03120010
031300     EXEC SQL                                                     03130010
031400         SET :PV-TMST = CURRENT TIMESTAMP                         03140010
031500     END-EXEC.                                                    03150010
031600     MOVE PC-TRANID                   TO PC033-TRAN-ID            03160010
031700     SET PC033-PROCESS-SCREEN         TO TRUE                     03170010
031800     MOVE PC-CURRENT-PROGRAM-NAME                                 03180010
031900                                      TO PC033-LAST-PROGRAM       03190010
032000     MOVE PC033-SML-PRTR-ID           TO APRTRO.                  03200010
032100                                                                  03210010
032200 1200-HELP-SCREEN.                                                03220010
032300     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03230010
032400     MOVE 'PCKRF858'                  TO PC192-PROGRAM-NAME       03240010
032500     COPY PCPD188.                                                03250010
032600     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03260010
032700     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     03270010
032800     PERFORM 8220-XCTL-TO-HELP.                                   03280010
032900                                                                  03290010
033000/                                                                 03300010
033100 2000-PROCESS.                                                    03310010
033200                                                                  03320010
033300     PERFORM 8020-RECEIVE-MAP.                                    03330010
033400     IF APRTRL > ZERO                                             03340010
033500         MOVE APRTRI                  TO PC033-SML-PRTR-ID        03350010
033600     ELSE                                                         03360010
033700         IF APRTRA = DP015-ERASE-EOF                              03370010
033800             MOVE SPACES              TO PC033-SML-PRTR-ID        03380010
033900         END-IF                                                   03390010
034000     END-IF.                                                      03400010
034100                                                                  03410010
034200     IF PC033-SML-PRTR-ID = SPACES                                03420010
034300         MOVE 'PRTR NBR REQUIRED'     TO AMSGLNO                  03430010
034400         SET PS-ERRORS-YES            TO TRUE                     03440010
034500     ELSE                                                         03450010
034600     IF PC033-SML-PRTR-ID = PV-SAVE-PRTR-ID                       03460010
034700         CONTINUE                                                 03470010
034800     ELSE                                                         03480010
034900         PERFORM 2100-VALIDATE-PRINTER                            03490010
035000         IF PS-ERRORS-NO                                          03500010
035100             PERFORM 2150-VALIDATE-PRINTER-ID-SML                 03510010
035200             IF PS-ERRORS-NO                                      03520010
035300                 PERFORM 2160-CONVERT-FAST-TO-NUMERIC             03530010
035400                 PERFORM 7250-COUNT-FAST-NBRS                     03540010
035500                 PERFORM 7200-OPEN-LABEL-CSR                      03550010
035600                 PERFORM 7210-FETCH-LABEL-CSR                     03560010
035700                                                                  03570010
035800                 PERFORM UNTIL PS-END-CSR-YES OR PS-ERRORS-YES    03580010
035900                     PERFORM 2200-LOAD-PRTR-COMMAREA              03590010
036000                     PERFORM 7210-FETCH-LABEL-CSR                 03600010
036100                 END-PERFORM                                      03610010
036200                                                                  03620010
036300                 PERFORM 7220-CLOSE-LABEL-CSR                     03630010
036400                     IF PS-ERRORS-NO                              03640010
036500                         MOVE 'LABEL PRT COMPLETE'                03650010
036600                                      TO AMSGLNO                  03660010
036700                     ELSE                                         03670010
036800                         CONTINUE                                 03680010
036900                     END-IF                                       03690010
037000             END-IF                                               03700010
037100         END-IF                                                   03710010
037200     END-IF                                                       03720010
037300     END-IF.                                                      03730010
037400                                                                  03740010
037500 2100-VALIDATE-PRINTER.                                           03750010
037600                                                                  03760010
037700     MOVE '01'                        TO DP072-RPT-PGM-TYP-ID.    03770010
037800     MOVE PC033-OPER-UNT-ID           TO DP072-ORIGIN-OPER-UNT-ID 03780010
037900                                        DP072-OPER-UNT-ID.        03790010
038000     MOVE 1                           TO DP072-ORIGIN-FCLTY-ID    03800010
038100                                         DP072-FCLTY-ID.          03810010
038200     MOVE 'PCKCS126'                  TO DP072-RPT-PGM-NME        03820010
038300     MOVE PC033-SML-PRTR-ID           TO DP072-PRINTER-ID         03830010
038400     SET DP072-VALIDATE               TO TRUE                     03840010
038500                                                                  03850010
038600     EXEC CICS                                                    03860010
038700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  03870010
038800               COMMAREA (DP072-COMM-AREA)                         03880010
038900               RESP     (PV-CICS-RESP)                            03890010
039000     END-EXEC                                                     03900010
039100                                                                  03910010
039200     EVALUATE TRUE                                                03920010
039300         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     03930010
039400              CONTINUE                                            03940010
039500         WHEN OTHER                                               03950010
039600             SET PS-ERRORS-YES        TO TRUE                     03960010
039700             MOVE 'INVALID PRINTER ID'                            03970010
039800                                      TO AMSGLNO                  03980010
039900     END-EVALUATE.                                                03990010
040000                                                                  04000010
040100                                                                  04010010
040200*----------------------------------------------------------------*04020010
040300*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *04030010
040400*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *04040010
040500*  CAN BE PRINTED ON THIS PRINTER.                               *04050010
040600*----------------------------------------------------------------*04060010
040700 2150-VALIDATE-PRINTER-ID-SML.                                    04070010
040800                                                                  04080010
040900     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  = 'MGMX'                 04090010
041000             MOVE 'INVALID PRINTER ID'                            04100010
041100                                      TO AMSGLNO                  04110010
041200         SET PS-ERRORS-YES            TO TRUE                     04120010
041300     END-IF.                                                      04130010
041400                                                                  04140010
041500     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = 'A'                    04150010
041600         CONTINUE                                                 04160010
041700     ELSE                                                         04170010
041800         SET PS-ERRORS-YES            TO TRUE                     04180010
041900         MOVE 'INVALID PRINTER ID'                                04190010
042000                                      TO AMSGLNO                  04200010
042100     END-IF.                                                      04210010
042200/                                                                 04220010
042300 2160-CONVERT-FAST-TO-NUMERIC.                                    04230010
042400                                                                  04240010
042500     MOVE PC033-FAST-NBR              TO DP010I-UNEDITED-FIELD    04250010
042600     MOVE LENGTH OF PC033-FAST-NBR    TO DP010I-MAXIMUM-DIGITS    04260010
042700     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  04270010
042800     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     04280010
042910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             04291010
042920                         USING DP010I-NUMERIC-EDIT-AREA           04292010
043000     IF  DP010I-ERROR-DETECTED                                    04300010
043100         SET PS-ERRORS-YES            TO TRUE                     04310010
043200     ELSE                                                         04320010
043300         MOVE DP010I-NUMERIC-FIELD    TO                          04330010
043400                                   SUT00028-TRN-NBR               04340010
043500     END-IF.                                                      04350010
043600                                                                  04360010
043700 2200-LOAD-PRTR-COMMAREA.                                         04370010
043800                                                                  04380010
043900     SET PC140-COMMON-MFST-LBL-NBR    TO TRUE                     04390010
044000     MOVE DP072-PRTR-IP-ADDRESS       TO PC140-SML-IP-ADDRESS     04400010
044100     MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                          04410010
044200                                      TO PC140-SML-OS-RLSE-CDE    04420010
044300     MOVE DP072-PRTR-DATA-XFER-MODE-ID                            04430010
044400                                      TO PC140-SML-XFER-MODE-ID   04440010
044500     MOVE DP072-XMIT-INTFC-CDE                                    04450010
044600                                      TO PC140-XMIT-INTFC-CDE     04460010
044700     MOVE DP072-PRTR-TYP-CDE                                      04470010
044800                                      TO PC140-SML-PRTR-TYPE      04480010
044900                                                                  04490010
045000     MOVE DP072-PRTR-OPER-UNT-ID      TO XLT00010-LOC-NBR         04500010
045100                                         COCNTL-OPER-UNT-ID       04510010
045200     MOVE 'FT-'                       TO PC140-SML-TYPE           04520010
045300     PERFORM 7000-GET-DC-LOCATION.                                04530010
045400     PERFORM 7100-CHECK-IF-DC.                                    04540010
045500                                                                  04550010
045600     MOVE PC033-STR-NBR               TO PC187-STR-NBR            04560010
045700     MOVE 1                           TO                          04570010
045800                                  PC033-NBR-LABELS-REQUESTED      04580010
045900     MOVE PC033-NBR-LABELS-REQUESTED  TO PC187-NO-OF-LBLS         04590010
046000*    PERFORM 6000-LINK-PCKCS721                                   04600010
046100                                                                  04610010
046200     MOVE PC033-SML-PRTR-ID           TO PC140-SML-PRTR-ID        04620010
046300     PERFORM 7050-GET-STORE-NAME                                  04630010
046400                                                                  04640010
046500     MOVE XLT00010-LOC-10-ABBR-NM     TO PC140-SML-STR-NAME       04650010
046600                                                                  04660010
046700     MOVE SUT00028-SHIPT-UNT-ID       TO PC033-CARTON             04670010
046800     MOVE PC033-CARTON                TO PV-CARTON-N              04680010
046900     MOVE PV-CARTON-MFST-NBR          TO PC140-SML-STRT-MFST-NBR  04690010
047000*    MOVE PC187-START-MFST-NBR        TO PC140-SML-STRT-MFST-NBR  04700010
047100                                                                  04710010
047200     MOVE PC033-NBR-LABELS-REQUESTED                              04720010
047300                                      TO PC140-SML-TOT-CART       04730010
047400**** MOVE PC033-OPER-UNT-ID           TO PC140-SML-ORIGIN-DC      04740010
047500     MOVE SUT00024-ORGN-LOC-NBR       TO PC140-SML-ORIGIN-DC      04750010
047600     MOVE ZERO                        TO PC140-SML-DIVERT-PFX.    04760010
047700     MOVE COCNTL-SSCC-18-IND          TO PC140-CRA-DC-SSCC-18-IND 04770010
047800     MOVE PC033-STR-NBR               TO PC140-CRA-LOC-ID         04780010
047900                                                                  04790010
048000     INITIALIZE PC140-SML-ZNE-LINE-1                              04800010
048100                PC140-SML-ZNE-LINE-2                              04810010
048200                PC140-SML-ZNE-LINE-3.                             04820010
048300     MOVE '* FAST TRANSFER *'         TO PC140-SML-ZNE-LINE-1.    04830010
048400                                                                  04840010
048500                                                                  04850010
048600     MOVE PC033-STR-NBR               TO PV-STORE-NUMBER-N        04860010
048700     MOVE PV-STORE-NUMBER             TO PC140-SML-STR-NBR        04870010
048800                                                                  04880010
048900     MOVE PC033-FR-STR-NBR            TO PC037-XFER-FROM-STORE-NBR04890010
049000                                         PV-FAST-STORE            04900010
049100     MOVE PC033-XFER-SEQ-NBR          TO PC037-XFER-SEQ-NBR       04910010
049200                                         PV-FAST-SEQ              04920010
049300     PERFORM P0300-GET-CHK-DIGIT                                  04930010
049400     MOVE PC037-FAST-CHECK-DIGIT      TO PV-FAST-CHK-DIGIT        04940010
049500*    PERFORM 7250-COUNT-FAST-NBRS                                 04950010
049600     IF PV-LABEL-COUNT = 1                                        04960010
049700         MOVE PV-FAST-NBR             TO PC140-SML-ZNE-LINE-2     04970010
049800     ELSE                                                         04980010
049900         MOVE '    MULTIPLE    '      TO PC140-SML-ZNE-LINE-2     04990010
050000     END-IF.                                                      05000010
050100                                                                  05010010
050200     PERFORM 6100-LINK-SOCKET-PRINT-ROUTINE.                      05020010
050300     COPY PCPD037.                                                05030010
050400/                                                                 05040010
050500 3000-DELETE-FAST-FROM-CARTONS.                                   05050010
050600                                                                  05060010
050700     PERFORM 2160-CONVERT-FAST-TO-NUMERIC                         05070010
050800     PERFORM 7200-OPEN-LABEL-CSR                                  05080010
050900     PERFORM 7210-FETCH-LABEL-CSR                                 05090010
051000                                                                  05100010
051100     PERFORM UNTIL PS-END-CSR-YES OR PS-ERRORS-YES                05110010
051200         PERFORM 7350-CHECK-ONLY-FAST-IN-CARTON                   05120010
051300         IF PV-FAST-COUNT = ZERO                                  05130010
051400*            THERE ARE NO OTHER FAST TRANSFERS IN THIS CARTON     05140010
051500*            SO DELETE THE CARTON AND ALL ITEMS WITHIN IT         05150010
051600             PERFORM 7400-DELETE-OTBND-CART                       05160010
051700         ELSE                                                     05170010
051800*            THERE ARE OTHER FAST TRANSFERS IN THIS CARTON        05180010
051900*            SO DELETE ONLY THE SCANNED FAST ITEMS WITHIN IT      05190010
052000             PERFORM 7300-DELETE-CART-UPC                         05200010
052100         END-IF                                                   05210010
052200     PERFORM 7210-FETCH-LABEL-CSR                                 05220010
052300     END-PERFORM                                                  05230010
052400                                                                  05240010
052500     PERFORM 7220-CLOSE-LABEL-CSR.                                05250010
052600/                                                                 05260010
052700 6000-LINK-PCKCS721.                                              05270010
052800                                                                  05280010
052900     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   05290010
053000                                                                  05300010
053100     EXEC CICS                                                    05310010
053200         LINK PROGRAM  (PC-PCKCS721)                              05320010
053300              COMMAREA (PC187-COMMAREA-REC)                       05330010
053400              LENGTH   (PV-COMMAREA-LENGTH)                       05340010
053500              RESP     (PV-CICS-RESPONSE)                         05350010
053600     END-EXEC.                                                    05360010
053700                                                                  05370010
053800     EVALUATE TRUE                                                05380010
053900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05390010
054000              IF  PC187-CRA-SUCCESSFUL                            05400010
054100                  CONTINUE                                        05410010
054200              ELSE                                                05420010
054300                  SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE         05430010
054400*                 MOVE SQLCODE              TO PV-SQL-CODE        05440010
054500*                 STRING ' PCKCS707 - '        DELIMITED BY SIZE  05450010
054600*                        '6000-LINK-PCKCS721 ' DELIMITED BY SIZE  05460010
054700*                        ' RETURN MESSAGE - '  DELIMITED BY SIZE  05470010
054800*                        PC187-CRA-RET-MSG     DELIMITED BY SIZE  05480010
054900*                        '  PARA-'             DELIMITED BY SIZE  05490010
055000*                        PC187-CRA-REQ-ID      DELIMITED BY SIZE  05500010
055100*                                         INTO PV-CICS-MSG-AREA   05510010
055200*                 MOVE LENGTH OF PV-CICS-MSG-AREA                 05520010
055300*                                           TO PV-COMMAREA-LENGTH 05530010
055400*                 PERFORM 9990-WRITE-CICS                         05540010
055500              END-IF                                              05550010
055600         WHEN OTHER                                               05560010
055700              SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE             05570010
055800*             MOVE SQLCODE              TO PV-SQL-CODE            05580010
055900*             STRING ' PCKCS707 (OTHER) -' DELIMITED BY SIZE      05590010
056000*                    '6000-LINK-PCKCS721 ' DELIMITED BY SIZE      05600010
056100*                    ' RETURN MESSAGE - '  DELIMITED BY SIZE      05610010
056200*                    PC187-CRA-RET-MSG     DELIMITED BY SIZE      05620010
056300*                    '  PARA-'             DELIMITED BY SIZE      05630010
056400*                    PC187-CRA-REQ-ID      DELIMITED BY SIZE      05640010
056500*                                     INTO PV-CICS-MSG-AREA       05650010
056600*             MOVE LENGTH OF PV-CICS-MSG-AREA                     05660010
056700*                                       TO PV-COMMAREA-LENGTH     05670010
056800*             PERFORM 9990-WRITE-CICS                             05680010
056900     END-EVALUATE.                                                05690010
057000/                                                                 05700010
057100 6100-LINK-SOCKET-PRINT-ROUTINE.                                  05710010
057200                                                                  05720010
057300     MOVE PC033-USER-ID               TO PC140-CRA-USERID.        05730010
057400     MOVE LENGTH OF PC140-LABELMST    TO PV-COMMAREA-LENGTH.      05740010
057500                                                                  05750010
057600     EXEC CICS                                                    05760010
057700          LINK PROGRAM  ('PCKCS707')                              05770010
057800               COMMAREA (PC140-LABELMST)                          05780010
057900               LENGTH   (PV-COMMAREA-LENGTH)                      05790010
058000               RESP     (PV-CICS-RESPONSE)                        05800010
058100     END-EXEC.                                                    05810010
058200                                                                  05820010
058300     EVALUATE TRUE                                                05830010
058400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05840010
058500              CONTINUE                                            05850010
058600         WHEN OTHER                                               05860010
058700             PERFORM DP014-0000-PROCESS-ABEND                     05870010
058800     END-EVALUATE.                                                05880010
058900                                                                  05890010
059000     EVALUATE TRUE                                                05900010
059100     WHEN PC140-CRA-SOCKET-COMM-ERROR                             05910010
059200         SET PS-ERRORS-YES            TO TRUE                     05920010
059300         MOVE '*** COMM ERROR *** '   TO AMSGLNO                  05930010
059400*LABEL REQUEST FAILED DUE TO COMMUNICATION ERROR - CALL HELP DESK 05940010
059500     WHEN PC140-CRA-INVALID-PRT-FMT                               05950010
059600         MOVE PC140-CRA-RET-CDE       TO PM-RET-CDE               05960010
059700         MOVE PC140-CRA-RET-MSG       TO PM-RET-MSG               05970010
059800         MOVE 'INVALID PRT FORMAT'    TO AMSGLNO                  05980010
059900     WHEN OTHER                                                   05990010
060000*       PRINT REQUEST HAS BEEN SUBMITTED                          06000010
060100         CONTINUE                                                 06010010
060200     END-EVALUATE.                                                06020010
060300/                                                                 06030010
060400 7000-GET-DC-LOCATION.                                            06040010
060500     EXEC SQL                                                     06050010
060600          SELECT LOC_5_ABBR_NM                                    06060010
060700          INTO  :PV-DC-5-CHAR-ABBR                                06070010
060800          FROM   XLT_LOC                                          06080010
060900          WHERE  LOC_TYP_CDE = 'DC'                               06090010
061000          AND    LOC_NBR   = :XLT00010-LOC-NBR                    06100010
061100     END-EXEC.                                                    06110010
061200                                                                  06120010
061300     EVALUATE TRUE                                                06130010
061400         WHEN SQLCODE = ZERO                                      06140010
061500              MOVE  PV-2-DIGIT-DC-ABBR                            06150010
061600                                      TO PC140-CRA-DC-ID          06160010
061700              MOVE  XLT00010-LOC-NBR  TO PC140-CRA-OPER-UNT-ID    06170010
061800                                                                  06180010
061900         WHEN SQLCODE = +100                                      06190010
062000              MOVE  '90'              TO PC140-CRA-DC-ID          06200010
062100                                         PC140-CRA-OPER-UNT-ID    06210010
062200                                                                  06220010
062300         WHEN SQLWARN0 NOT = SPACES                               06230010
062400         WHEN SQLCODE NOT EQUAL ZERO                              06240010
062500             MOVE 1                   TO PV-ERROR-NBR             06250010
062600                                         PC033-ERROR-NBR          06260010
062700             PERFORM  9903-WRITE-CICS-LOG                         06270010
062800             MOVE '7000-GET-DC-LOCATION'                          06280010
062900                             TO PC033-PARAGRAPH                   06290010
063000             MOVE 'PCKRF858 - GET DC LOCATION CODE'               06300010
063100                             TO PC033-MESSAGE-TEXT(1)             06310010
063200             MOVE PC140-CRA-DC-ID                                 06320010
063300                             TO PC033-MESSAGE-TEXT(2)             06330010
063400             MOVE SQLCA      TO PC033-SQLCA                       06340010
063500             MOVE 'XLT_LOC'  TO PC033-DB2-TABLE-NAME(1)           06350010
063600             SET PC033-ABEND          TO TRUE                     06360010
063700             MOVE 99                  TO PC033-PGM-MSG-NBR        06370010
063800             PERFORM 8210-XCTL-ERROR-SCREEN                       06380010
063900     END-EVALUATE.                                                06390010
064000                                                                  06400010
064100 7050-GET-STORE-NAME.                                             06410010
064200     EXEC SQL                                                     06420010
064300             SELECT LOC_10_ABBR_NM                                06430010
064400             INTO  :XLT00010-LOC-10-ABBR-NM                       06440010
064500             FROM   XLT_LOC                                       06450010
064600             WHERE  LOC_NBR = :PC033-STR-NBR                      06460010
064700             AND    LOC_TYP_CDE IN ('DS', 'DC', 'CS', 'RV')       06470010
064800     END-EXEC                                                     06480010
064900                                                                  06490010
065000         EVALUATE TRUE                                            06500010
065100             WHEN SQLCODE = ZERO                                  06510010
065200             WHEN SQLCODE = +100                                  06520010
065300             WHEN SQLCODE = -904                                  06530010
065400             WHEN SQLCODE = -913                                  06540010
065500                 CONTINUE                                         06550010
065600             WHEN SQLWARN0 NOT = SPACES                           06560010
065700             WHEN SQLCODE < ZERO                                  06570010
065800             WHEN SQLCODE > ZERO                                  06580010
065900                 MOVE 2                 TO PV-ERROR-NBR           06590010
066000                                         PC033-ERROR-NBR          06600010
066100                 PERFORM  9903-WRITE-CICS-LOG                     06610010
066200                 MOVE '2240-GET-STORE-NAME'                       06620010
066300                                 TO PC033-PARAGRAPH               06630010
066400                 MOVE 'SELECT STORE NAME'                         06640010
066500                                 TO PC033-MESSAGE-TEXT (1)        06650010
066600                 MOVE SQLCA      TO PC033-SQLCA                   06660010
066700                 MOVE 'XLT_LOC'  TO PC033-DB2-TABLE-NAME (1)      06670010
066800                 SET PC033-ABEND      TO TRUE                     06680010
066900                 MOVE 99              TO PC033-PGM-MSG-NBR        06690010
067000                 PERFORM 8210-XCTL-ERROR-SCREEN                   06700010
067100     END-EVALUATE.                                                06710010
067200                                                                  06720010
067300 7100-CHECK-IF-DC.                                                06730010
067400                                                                  06740010
067500     EXEC SQL                                                     06750010
067600          SELECT  SSCC_18_IND                                     06760010
067700            INTO :COCNTL-SSCC-18-IND                              06770010
067800            FROM  TCOCNTL                                         06780010
067900           WHERE  OPER_UNT_ID = :COCNTL-OPER-UNT-ID               06790010
068000     END-EXEC.                                                    06800010
068100                                                                  06810010
068200     EVALUATE TRUE                                                06820010
068300         WHEN SQLCODE = ZERO                                      06830010
068400              CONTINUE                                            06840010
068500         WHEN SQLCODE = +100                                      06850010
068600              SET PS-ERRORS-YES       TO TRUE                     06860010
068700*INVALID DISTRIBUTION CENTER                                      06870010
068800         WHEN SQLWARN0 NOT = SPACES                               06880010
068900         WHEN SQLCODE < +0                                        06890010
069000         WHEN SQLCODE > +0                                        06900010
069100              MOVE 3                 TO PV-ERROR-NBR              06910010
069200                                         PC033-ERROR-NBR          06920010
069300              PERFORM  9903-WRITE-CICS-LOG                        06930010
069400              MOVE '7100-CHECK-IF-DC'                             06940010
069500                                      TO PC033-PARAGRAPH          06950010
069600              MOVE 'CHECK IF OPER UNIT IS FOR DC'                 06960010
069700                                      TO PC033-MESSAGE-TEXT (1)   06970010
069800              MOVE SQLCA              TO PC033-SQLCA              06980010
069900              MOVE 'TCOCNTL'          TO PC033-DB2-TABLE-NAME (1) 06990010
070000             SET PC033-ABEND          TO TRUE                     07000010
070100             MOVE 99                  TO PC033-PGM-MSG-NBR        07010010
070200             PERFORM 8210-XCTL-ERROR-SCREEN                       07020010
070300     END-EVALUATE.                                                07030010
070400/                                                                 07040010
070500 7200-OPEN-LABEL-CSR.                                             07050010
070600                                                                  07060010
070700     EXEC SQL                                                     07070010
070800         OPEN LABEL-CSR                                           07080010
070900     END-EXEC                                                     07090010
071000                                                                  07100010
071100     EVALUATE TRUE                                                07110010
071200         WHEN SQLCODE = ZERO                                      07120010
071300              CONTINUE                                            07130010
071400         WHEN SQLWARN0 NOT = SPACES                               07140010
071500         WHEN SQLCODE < +0                                        07150010
071600         WHEN SQLCODE > +0                                        07160010
071700              MOVE 4                 TO PV-ERROR-NBR              07170010
071800                                         PC033-ERROR-NBR          07180010
071900              PERFORM  9903-WRITE-CICS-LOG                        07190010
072000              MOVE '7200-OPEN-LABEL-CSR'                          07200010
072100                                      TO PC033-PARAGRAPH          07210010
072200              MOVE 'OPEN LABEL-CSR FOR REPRINTING'                07220010
072300                                      TO PC033-MESSAGE-TEXT (1)   07230010
072400              MOVE SQLCA              TO PC033-SQLCA              07240010
072500              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 07250010
072600             SET PC033-ABEND          TO TRUE                     07260010
072700             MOVE 99                  TO PC033-PGM-MSG-NBR        07270010
072800             PERFORM 8210-XCTL-ERROR-SCREEN                       07280010
072900     END-EVALUATE.                                                07290010
073000                                                                  07300010
073100 7210-FETCH-LABEL-CSR.                                            07310010
073200                                                                  07320010
073300     EXEC SQL                                                     07330010
073400         FETCH LABEL-CSR                                          07340010
073500         INTO :SUT00028-SHIPT-UNT-ID                              07350010
073600            , :SUT00024-ORGN-LOC-NBR                              07360010
073700     END-EXEC                                                     07370010
073800                                                                  07380010
073900     EVALUATE TRUE                                                07390010
074000         WHEN SQLCODE = ZERO                                      07400010
074100              CONTINUE                                            07410010
074200         WHEN SQLCODE = +100                                      07420010
074300             SET PS-END-CSR-YES       TO TRUE                     07430010
074400         WHEN SQLWARN0 NOT = SPACES                               07440010
074500         WHEN SQLCODE < +0                                        07450010
074600         WHEN SQLCODE > +0                                        07460010
074700              MOVE 5                 TO PV-ERROR-NBR              07470010
074800                                         PC033-ERROR-NBR          07480010
074900              PERFORM  9903-WRITE-CICS-LOG                        07490010
075000              MOVE '7210-FETCH-LABEL-CSR'                         07500010
075100                                      TO PC033-PARAGRAPH          07510010
075200              MOVE 'FETCH LABEL-CSR FOR REPRINTING'               07520010
075300                                      TO PC033-MESSAGE-TEXT (1)   07530010
075400              MOVE SQLCA              TO PC033-SQLCA              07540010
075500              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 07550010
075600             SET PC033-ABEND          TO TRUE                     07560010
075700             MOVE 99                  TO PC033-PGM-MSG-NBR        07570010
075800             PERFORM 8210-XCTL-ERROR-SCREEN                       07580010
075900     END-EVALUATE.                                                07590010
076000                                                                  07600010
076100 7220-CLOSE-LABEL-CSR.                                            07610010
076200                                                                  07620010
076300     EXEC SQL                                                     07630010
076400         CLOSE LABEL-CSR                                          07640010
076500     END-EXEC                                                     07650010
076600                                                                  07660010
076700     EVALUATE TRUE                                                07670010
076800         WHEN SQLCODE = ZERO                                      07680010
076900              CONTINUE                                            07690010
077000         WHEN SQLWARN0 NOT = SPACES                               07700010
077100         WHEN SQLCODE < +0                                        07710010
077200         WHEN SQLCODE > +0                                        07720010
077300              MOVE 6                 TO PV-ERROR-NBR              07730010
077400                                         PC033-ERROR-NBR          07740010
077500              PERFORM  9903-WRITE-CICS-LOG                        07750010
077600              MOVE '7220-CLOSE-LABEL-CSR'                         07760010
077700                                      TO PC033-PARAGRAPH          07770010
077800              MOVE 'CLOSE LABEL-CSR FOR REPRINTING'               07780010
077900                                      TO PC033-MESSAGE-TEXT (1)   07790010
078000              MOVE SQLCA              TO PC033-SQLCA              07800010
078100              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 07810010
078200             SET PC033-ABEND          TO TRUE                     07820010
078300             MOVE 99                  TO PC033-PGM-MSG-NBR        07830010
078400             PERFORM 8210-XCTL-ERROR-SCREEN                       07840010
078500     END-EVALUATE.                                                07850010
078600                                                                  07860010
078700 7250-COUNT-FAST-NBRS.                                            07870010
078800     EXEC SQL                                                     07880010
078900     SELECT COUNT(DISTINCT SHIPT_UNT_ID)                          07890010
079000         INTO :PV-LABEL-COUNT                                     07900010
079100         FROM SUT_OTBND_UPC A                                     07910010
079200         WHERE TRN_NBR = :SUT00028-TRN-NBR                        07920010
079300     END-EXEC                                                     07930010
079400                                                                  07940010
079500     EVALUATE TRUE                                                07950010
079600         WHEN SQLCODE = ZERO                                      07960010
079700              CONTINUE                                            07970010
079800         WHEN SQLWARN0 NOT = SPACES                               07980010
079900         WHEN SQLCODE < +0                                        07990010
080000         WHEN SQLCODE > +0                                        08000010
080100              MOVE '7250-COUNT-FAST-NBRS'                         08010010
080200                                      TO PC033-PARAGRAPH          08020010
080300              MOVE 'COUNT CARTONS FOR A FAST NBR'                 08030010
080400                                      TO PC033-MESSAGE-TEXT (1)   08040010
080500              MOVE SQLCA              TO PC033-SQLCA              08050010
080600              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 08060010
080700             SET PC033-ABEND          TO TRUE                     08070010
080800             MOVE 99                  TO PC033-PGM-MSG-NBR        08080010
080900             PERFORM 8210-XCTL-ERROR-SCREEN                       08090010
081000     END-EVALUATE.                                                08100010
081100/                                                                 08110010
081200 7300-DELETE-CART-UPC.                                            08120010
081300                                                                  08130010
081400* DELETE ALL THE ITEMS BELONGING TO THIS FAST THAT ARE CONTAINED  08140010
081500* WITHIN THIS CARTON                                              08150010
081600     EXEC SQL                                                     08160010
081700         DELETE                                                   08170010
081800         FROM SUT_OTBND_UPC A                                     08180010
081900         WHERE                                                    08190010
082000             SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID                08200010
082100             AND                                                  08210010
082200              TRN_NBR   = :SUT00028-TRN-NBR                       08220010
082300     END-EXEC.                                                    08230010
082400                                                                  08240010
082500     EVALUATE TRUE                                                08250010
082600         WHEN SQLCODE = ZERO                                      08260010
082700         WHEN SQLCODE = +100                                      08270010
082800              CONTINUE                                            08280010
082900         WHEN SQLWARN0 NOT = SPACES                               08290010
083000         WHEN SQLCODE < +0                                        08300010
083100         WHEN SQLCODE > +0                                        08310010
083200              MOVE '7300-DELETE-CART-UPC'                         08320010
083300                                      TO PC033-PARAGRAPH          08330010
083400              MOVE 'DELETE FAST ITEMS FROM A CARTON'              08340010
083500                                      TO PC033-MESSAGE-TEXT (1)   08350010
083600              MOVE SQLCA              TO PC033-SQLCA              08360010
083700              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 08370010
083800             SET PC033-ABEND          TO TRUE                     08380010
083900             MOVE 99                  TO PC033-PGM-MSG-NBR        08390010
084000             PERFORM 8210-XCTL-ERROR-SCREEN                       08400010
084100     END-EVALUATE.                                                08410010
084200                                                                  08420010
084300 7350-CHECK-ONLY-FAST-IN-CARTON.                                  08430010
084400*                                                                 08440010
084500* IS THIS THE ONLY FAST NUMBER IN THE CARTON?                     08450010
084600                                                                  08460010
084700     EXEC SQL                                                     08470010
084800         SELECT COUNT(*)                                          08480010
084900         INTO :PV-FAST-COUNT                                      08490010
085000         FROM SUT_OTBND_CART A                                    08500010
085100         WHERE                                                    08510010
085200         A.SHIPT_UNT_ID = :PC033-CARTON                           08520010
085300           AND                                                    08530010
085400              EXISTS                                              08540010
085500         (SELECT *                                                08550010
085600          FROM SUT_OTBND_UPC B                                    08560010
085700          WHERE A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                   08570010
085800          AND   B.TRN_NBR     <> :SUT00028-TRN-NBR)               08580010
085900     END-EXEC                                                     08590010
086000                                                                  08600010
086100     EVALUATE TRUE                                                08610010
086200         WHEN SQLCODE = ZERO                                      08620010
086300              CONTINUE                                            08630010
086400         WHEN SQLWARN0 NOT = SPACES                               08640010
086500         WHEN SQLCODE < +0                                        08650010
086600         WHEN SQLCODE > +0                                        08660010
086700             MOVE '7350-CHECK-ONLY-FAST-IN-CARTON'                08670010
086800                                      TO PC033-PARAGRAPH          08680010
086900             MOVE 'CHECK IF OTHER FAST NBRS IN A CARTON'          08690010
087000                                      TO PC033-MESSAGE-TEXT (1)   08700010
087100             MOVE SQLCA               TO PC033-SQLCA              08710010
087200             MOVE 'SUT00028'          TO PC033-DB2-TABLE-NAME (1) 08720010
087300             SET PC033-ABEND          TO TRUE                     08730010
087400             MOVE 99                  TO PC033-PGM-MSG-NBR        08740010
087500             PERFORM 8210-XCTL-ERROR-SCREEN                       08750010
087600     END-EVALUATE.                                                08760010
087700                                                                  08770010
087800 7400-DELETE-OTBND-CART.                                          08780010
087900                                                                  08790010
088000     EXEC SQL                                                     08800010
088100         DELETE                                                   08810010
088200         FROM SUT_OTBND_CART A                                    08820010
088300         WHERE                                                    08830010
088400             SHIPT_UNT_ID  = :SUT00028-SHIPT-UNT-ID               08840010
088500     END-EXEC.                                                    08850010
088600                                                                  08860010
088700     EVALUATE TRUE                                                08870010
088800         WHEN SQLCODE = ZERO                                      08880010
088900         WHEN SQLCODE = +100                                      08890010
089000              CONTINUE                                            08900010
089100         WHEN SQLWARN0 NOT = SPACES                               08910010
089200         WHEN SQLCODE < +0                                        08920010
089300         WHEN SQLCODE > +0                                        08930010
089400              MOVE '7400-DELETE-OTBND-CART'                       08940010
089500                                      TO PC033-PARAGRAPH          08950010
089600              MOVE 'DELETE AN EMPTY CARTON'                       08960010
089700                                      TO PC033-MESSAGE-TEXT (1)   08970010
089800              MOVE SQLCA              TO PC033-SQLCA              08980010
089900              MOVE 'SUT00024'         TO PC033-DB2-TABLE-NAME (1) 08990010
090000             SET PC033-ABEND          TO TRUE                     09000010
090100             MOVE 99                  TO PC033-PGM-MSG-NBR        09010010
090200             PERFORM 8210-XCTL-ERROR-SCREEN                       09020010
090300     END-EVALUATE.                                                09030010
090400                                                                  09040010
090500/                                                                 09050010
090600 8000-SEND-MAP.                                                   09060010
090700                                                                  09070010
090800     MOVE -1                          TO APRTRL                   09080010
090900     EXEC CICS                                                    09090010
091000         SEND MAP       ('PC858A')                                09100010
091100              MAPSET    ('PCKM858')                               09110010
091200              ERASE                                               09120010
091300              CURSOR                                              09130010
091400              RESP      (PV-CICS-RESPONSE)                        09140010
091500     END-EXEC.                                                    09150010
091600                                                                  09160010
091700     EVALUATE TRUE                                                09170010
091800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09180010
091900             CONTINUE                                             09190010
092000         WHEN OTHER                                               09200010
092100             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          09210010
092200             MOVE 'PCKRF858 - UNABLE TO SEND MAP'                 09220010
092300                                      TO DP013-MESSAGE-TEXT (1)   09230010
092400             SET DP013-CICS-ABEND                                 09240010
092500                 DP013-ROLLBACK       TO TRUE                     09250010
092600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09260010
092700     END-EVALUATE.                                                09270010
092800                                                                  09280010
092900 8010-SEND-DATA-ONLY.                                             09290010
093000                                                                  09300010
093100     MOVE -1                          TO AMSGLNL                  09310010
093200     EXEC CICS                                                    09320010
093300         SEND MAP       ('PC858A')                                09330010
093400              MAPSET    ('PCKM858')                               09340010
093500              CURSOR                                              09350010
093600              DATAONLY                                            09360010
093700              RESP      (PV-CICS-RESPONSE)                        09370010
093800     END-EXEC.                                                    09380010
093900                                                                  09390010
094000     EVALUATE TRUE                                                09400010
094100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09410010
094200             CONTINUE                                             09420010
094300         WHEN OTHER                                               09430010
094400             MOVE '8010-SEND-DATA-ONLY'                           09440010
094500                                      TO DP013-PARAGRAPH          09450010
094600             MOVE 'PCKRF858 - UNABLE TO SEND DATA'                09460010
094700                                      TO DP013-MESSAGE-TEXT (1)   09470010
094800             SET DP013-CICS-ABEND                                 09480010
094900                 DP013-ROLLBACK       TO TRUE                     09490010
095000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09500010
095100     END-EVALUATE.                                                09510010
095200                                                                  09520010
095300 8020-RECEIVE-MAP.                                                09530010
095400                                                                  09540010
095500     EXEC CICS                                                    09550010
095600         RECEIVE MAP    ('PC858A')                                09560010
095700                 MAPSET ('PCKM858')                               09570010
095800                 RESP   (PV-CICS-RESPONSE)                        09580010
095900     END-EXEC.                                                    09590010
096000                                                                  09600010
096100     EVALUATE TRUE                                                09610010
096200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09620010
096300             CONTINUE                                             09630010
096400         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                09640010
096500             CONTINUE                                             09650010
096600         WHEN OTHER                                               09660010
096700            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       09670010
096800            MOVE 'PCKRF858 - UNABLE TO RECEIVE MAP'               09680010
096900                                         TO DP013-MESSAGE-TEXT (1)09690010
097000            SET DP013-LOGIC-ABEND        TO TRUE                  09700010
097100            SET DP013-ROLLBACK           TO TRUE                  09710010
097200            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                09720010
097300     END-EVALUATE.                                                09730010
097400                                                                  09740010
097500 8100-RETURN-TRANID.                                              09750010
097600                                                                  09760010
097700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       09770010
097800     EXEC CICS                                                    09780010
097900         RETURN TRANSID  (PC-TRANID)                              09790010
098000                COMMAREA (CA-COMMAREA)                            09800010
098100                LENGTH   (PV-COMMAREA-LENGTH)                     09810010
098200                RESP     (PV-CICS-RESPONSE)                       09820010
098300     END-EXEC.                                                    09830010
098400                                                                  09840010
098500     EVALUATE TRUE                                                09850010
098600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09860010
098700             CONTINUE                                             09870010
098800         WHEN OTHER                                               09880010
098900             MOVE '8100-RETURN-TRANID'  TO DP013-PARAGRAPH        09890010
099000             MOVE 'PCKRF858 - UNABLE TO RETURN TO TRANID'         09900010
099100                 TO DP013-MESSAGE-TEXT (1)                        09910010
099200             SET DP013-CICS-ABEND       TO TRUE                   09920010
099300             SET DP013-ROLLBACK         TO TRUE                   09930010
099400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09940010
099500     END-EVALUATE.                                                09950010
099600                                                                  09960010
099700 8110-RETURN.                                                     09970010
099800                                                                  09980010
099900     EXEC CICS                                                    09990010
100000         SEND FROM (PV-MESSAGE-AREA)                              10000010
100100              LENGTH (19)                                         10010010
100200              ERASE                                               10020010
100300     END-EXEC.                                                    10030010
100400                                                                  10040010
100500     EXEC CICS                                                    10050010
100600         RETURN                                                   10060010
100700     END-EXEC.                                                    10070010
100800                                                                  10080010
100900 8200-XCTL.                                                       10090010
101000     SET PC033-INITIALIZE-SCREEN      TO TRUE.                    10100010
101100     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      10110010
101200     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       10120010
101300                                                                  10130010
101400     EXEC CICS                                                    10140010
101500         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    10150010
101600               COMMAREA  (CA-COMMAREA)                            10160010
101700               LENGTH    (PV-COMMAREA-LENGTH)                     10170010
101800               RESP      (PV-CICS-RESPONSE)                       10180010
101900     END-EXEC.                                                    10190010
102000                                                                  10200010
102100     EVALUATE TRUE                                                10210010
102200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10220010
102300             CONTINUE                                             10230010
102400         WHEN OTHER                                               10240010
102500             MOVE '8200-XCTL'                                     10250010
102600                                      TO DP013-PARAGRAPH          10260010
102700             MOVE 'PCKRF858 - UNABLE TO XCTL TO PROGRAM: '        10270010
102800                                      TO DP013-MESSAGE-TEXT (1)   10280010
102900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   10290010
103000             SET DP013-CICS-ABEND                                 10300010
103100                 DP013-ROLLBACK       TO TRUE                     10310010
103200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10320010
103300             SET PC033-PROCESS-SCREEN TO TRUE                     10330010
103400             PERFORM 8000-SEND-MAP                                10340010
103500             PERFORM 8100-RETURN-TRANID                           10350010
103600     END-EVALUATE.                                                10360010
103700                                                                  10370010
103800 8210-XCTL-ERROR-SCREEN.                                          10380010
103900     IF NOT PC033-ABEND                                           10390010
104000         SET PC033-INITIALIZE-SCREEN  TO TRUE                     10400010
104100     END-IF                                                       10410010
104200     MOVE DFHEIBLK                    TO PC033-DFHEIBLK.          10420010
104300     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      10430010
104400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       10440010
104500     MOVE 'PCKRF852'                  TO PV-TRANSFER-PROGRAM      10450010
104600     IF PC033-PGM-MSG-NBR = ZERO                                  10460010
104700         MOVE 3                       TO PC033-PGM-MSG-NBR        10470010
104800     END-IF                                                       10480010
104900                                                                  10490010
105000     EXEC CICS                                                    10500010
105100         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    10510010
105200               COMMAREA  (CA-COMMAREA)                            10520010
105300               LENGTH    (PV-COMMAREA-LENGTH)                     10530010
105400               RESP      (PV-CICS-RESPONSE)                       10540010
105500     END-EXEC.                                                    10550010
105600                                                                  10560010
105700     EVALUATE TRUE                                                10570010
105800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10580010
105900             CONTINUE                                             10590010
106000         WHEN OTHER                                               10600010
106100             MOVE '8200-XCTL'                                     10610010
106200                                      TO DP013-PARAGRAPH          10620010
106300             MOVE 'PCKRF858 - UNABLE TO XCTL TO PROGRAM: '        10630010
106400                                      TO DP013-MESSAGE-TEXT (1)   10640010
106500             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   10650010
106600             SET DP013-CICS-ABEND                                 10660010
106700                 DP013-ROLLBACK       TO TRUE                     10670010
106800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10680010
106900*            MOVE PC-TRANS-UNAVAILABLE-MSG                        10690010
107000*                                     TO AMSGLNO                  10700010
107100             SET PC033-PROCESS-SCREEN TO TRUE                     10710010
107200             PERFORM 8000-SEND-MAP                                10720010
107300             PERFORM 8100-RETURN-TRANID                           10730010
107400     END-EVALUATE.                                                10740010
107500                                                                  10750010
107600*                                                                 10760010
107700 8220-XCTL-TO-HELP.                                               10770010
107800                                                                  10780010
107900     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       10790010
108000                                                                  10800010
108100     EXEC CICS                                                    10810010
108200         XCTL                                                     10820010
108300             PROGRAM   (PV-TRANSFER-PROGRAM)                      10830010
108400             COMMAREA  (PC192-COMMAREA)                           10840010
108500             LENGTH    (PV-COMMAREA-LENGTH)                       10850010
108600             RESP      (PV-CICS-RESPONSE)                         10860010
108700     END-EXEC.                                                    10870010
108800                                                                  10880010
108900     EVALUATE TRUE                                                10890010
109000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10900010
109100              CONTINUE                                            10910010
109200         WHEN OTHER                                               10920010
109300             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          10930010
109400             MOVE 'PCKRF858 - UNABLE TO XCTL TO PROGRAM: '        10940010
109500                                      TO DP013-MESSAGE-TEXT (1)   10950010
109600             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   10960010
109700             SET DP013-CICS-ABEND                                 10970010
109800                 DP013-ROLLBACK       TO TRUE                     10980010
109900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10990010
110000*            MOVE PC-TRANS-UNAVAILABLE-MSG                        11000010
110100*                                     TO AMSGLNO                  11010010
110200             SET PC033-PROCESS-SCREEN TO TRUE                     11020010
110300             PERFORM 8000-SEND-MAP                                11030010
110400             PERFORM 8100-RETURN-TRANID                           11040010
110500     END-EVALUATE.                                                11050010
110600*                                                                 11060010
110700 8230-XCTL-TO-E854.                                               11070010
110800                                                                  11080010
110900     SET PC033-INITIALIZE-SCREEN      TO TRUE.                    11090010
111000     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      11100010
111100     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       11110010
111200     MOVE 'PCKRF858'                  TO PV-TRANSFER-PROGRAM      11120010
111300                                                                  11130010
111400     EXEC CICS                                                    11140010
111500         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    11150010
111600               COMMAREA  (CA-COMMAREA)                            11160010
111700               LENGTH    (PV-COMMAREA-LENGTH)                     11170010
111800               RESP      (PV-CICS-RESPONSE)                       11180010
111900     END-EXEC.                                                    11190010
112000                                                                  11200010
112100     EVALUATE TRUE                                                11210010
112200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11220010
112300             CONTINUE                                             11230010
112400         WHEN OTHER                                               11240010
112500             MOVE '8230-XCTL-TO-E854'                             11250010
112600                                      TO DP013-PARAGRAPH          11260010
112700             MOVE 'PCKRF858 - UNABLE TO XCTL TO PROGRAM: '        11270010
112800                                      TO DP013-MESSAGE-TEXT (1)   11280010
112900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   11290010
113000             SET DP013-CICS-ABEND                                 11300010
113100                 DP013-ROLLBACK       TO TRUE                     11310010
113200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               11320010
113300             SET PC033-PROCESS-SCREEN TO TRUE                     11330010
113400             PERFORM 8000-SEND-MAP                                11340010
113500             PERFORM 8100-RETURN-TRANID                           11350010
113600     END-EVALUATE.                                                11360010
113700/                                                                 11370010
113800 9000-SOFT-ABORT.                                                 11380010
113900                                                                  11390010
114000     EXEC CICS                                                    11400010
114100         SYNCPOINT ROLLBACK                                       11410010
114200     END-EXEC                                                     11420010
114300                                                                  11430010
114400     MOVE 4                           TO PC033-PGM-MSG-NBR        11440010
114500     MOVE SQLCODE                     TO PC033-SQLCODE            11450010
114600     PERFORM 8210-XCTL-ERROR-SCREEN.                              11460010
114700                                                                  11470010
114800 9903-WRITE-CICS-LOG.                                             11480010
114900                                                                  11490010
115000     MOVE SQLCODE                     TO PV-SQLCODE               11500010
115100     STRING PC033-FR-STR-NBR '-'                                  11510010
115200            PC033-XFER-SEQ-NBR '-'                                11520010
115300            PC037-FAST-CHECK-DIGIT DELIMITED BY SIZE              11530010
115400                                      INTO PV-DISPLAY-FAST        11540010
115500     MOVE PC033-PO-NBR                TO PV-DISPLAY-PO            11550010
115600     MOVE PC033-RCVR-SEQ-NBR          TO PV-DISPLAY-RCVR          11560010
115700     MOVE PC033-PO-LINE-NBR           TO PV-DISPLAY-PO-LNE-NBR    11570010
115800     MOVE PC033-STR-NBR               TO PV-DISPLAY-STORE         11580010
115900                                                                  11590010
116000     EXEC CICS                                                    11600010
116100         WRITEQ TD                                                11610010
116200             QUEUE  ('CSSL')                                      11620010
116300             FROM   (PV-LOG-MSG)                                  11630010
116400             RESP   (PV-CICS-RESPONSE)                            11640010
116500     END-EXEC.                                                    11650010
116600                                                                  11660010
116700 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  11670010
116800                                                                  11680010
116900     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           11690010
117000     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          11700010
117100     INITIALIZE DP013-SRC-TASK-NUMBER                             11710010
117200                DP013-STACK.                                      11720010
117300     SET DP013-LINK-RETURN            TO TRUE.                    11730010
117400                                                                  11740010
117500     EXEC CICS                                                    11750010
117600         LINK                                                     11760010
117700             PROGRAM   (DP013-NAME)                               11770010
117800             COMMAREA  (DP013-PARAMETERS)                         11780010
117900             LENGTH    (DP013-LENGTH)                             11790010
118000     END-EXEC.                                                    11800010
118100                                                                  11810010
118200*----------------------------------------------------------------*11820010
118300*    ABEND PROCESSOR MODULE                                      *11830010
118400*----------------------------------------------------------------*11840010
118500                                                                  11850010
118600     COPY DPPD014.                                                11860010
118700                                                                  11870010
