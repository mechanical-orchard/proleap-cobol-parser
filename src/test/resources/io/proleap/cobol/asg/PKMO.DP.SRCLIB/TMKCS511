000100 IDENTIFICATION DIVISION.                                         00010072
000200 PROGRAM-ID.    TMKCS511.                                         00020072
000300 AUTHOR.        VIRGENE LENNEMAN                                  00030072
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040072
000500 DATE-WRITTEN.  02-27-98.                                         00050072
000600 DATE-COMPILED.                                                   00060072
000700*----------------------------------------------------------------*00070072
000800*    E511 - TROUBLE MANAGEMENT CRITERIA SPECIFICATION            *00080072
000900*                   FOR THE BUYING OFFICE                        *00090072
001000*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00100072
001100*    SUBSEQUENT PROGRAMS TO CREATE A LIST OF TROUBLE RECORDS     *00110072
001200*    ASSOCIATED WITH A PO OR PO LINE.                            *00120072
001300*----------------------------------------------------------------*00130072
001301******************************************************************00130199
001310* CHANGE HISTORY:                                                *00131099
001311*    CHANGES                                                     *00131199
001320*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)               *00132099
001330*     DATE:    11/06/2014                                        *00133099
001340*                                                                *00134099
001350*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00135099
001360*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/11/2014     *00136099
001370******************************************************************00137099
263627* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00139099
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00139199
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00139299
001370******************************************************************00139399
CICS  * CHANGED 11/09/2022    BY JIM HUNTER      WR: CHG0278008         00139499
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00139599
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00139699
CICS  *-----------------------------------------------------------------00139799
001400                                                                  00140072
001500 ENVIRONMENT DIVISION.                                            00150072
001600 DATA DIVISION.                                                   00160072
001700 WORKING-STORAGE SECTION.                                         00170072
001800                                                                  00180072
001900 01  PC-PROGRAM-CONSTANTS.                                        00190072
002000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TM511A  '. 00200072
002100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TMKM511 '. 00210072
002200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TMKCS511'. 00220072
002300     05  PC-MAX-RETRIES            PIC S9(04)  VALUE +3.          00230072
002400     05  PC-KOHLS-OPER-CO          PIC  X(02)  VALUE   '03'.      00240099
002500     05  PC-ACTIVE-STATUS          PIC  X(01)  VALUE   'A'.       00250099
002600     05  PC-DPT                    PIC  X(03)  VALUE   'DPT'.     00260099
002700     05  PC-BYR                    PIC  X(03)  VALUE   'BYR'.     00270099
002800     05  PC-ABY                    PIC  X(03)  VALUE   'ABY'.     00280099
002900     05  PC-DMA                    PIC  X(03)  VALUE   'DMA'.     00290099
003000     05  PC-GMA                    PIC  X(03)  VALUE   'GMA'.     00300099
003100     05  PC-B                      PIC  X(01)  VALUE   'B'.       00310099
003200     05  PC-A                      PIC  X(01)  VALUE   'A'.       00320072
003300     05  PC-D                      PIC  X(01)  VALUE   'D'.       00330099
003400     05  PC-N                      PIC  X(01)  VALUE   'N'.       00340072
003500     05  PC-I                      PIC  X(01)  VALUE   'I'.       00350072
003600     05  PC-R                      PIC  X(01)  VALUE   'R'.       00360072
003700     05  PC-S                      PIC  X(01)  VALUE   'S'.       00370072
003800     05  PC-0000                   PIC S9(04)  VALUE  +0000.      00380072
003900     05  PC-9999                   PIC S9(04)  VALUE  +9999.      00390072
004000     05  PC-TSYMSG-NUMBERS.                                       00400072
004100*  REQUIRED ENTRY                                                 00410072
004200         10  PC-TSYMSG-00007       PIC  9(05)  VALUE 00007.       00420072
004300*  MUST BE NUMBERIC                                               00430072
004400         10  PC-TSYMSG-00008       PIC  9(05)  VALUE 00008.       00440072
004500*  INVALID DATE                                                   00450099
004600         10  PC-TSYMSG-00009       PIC  9(05)  VALUE 00009.       00460099
004700*  ENTER AN "S" TO SELECT                                         00470072
004800         10  PC-TSYMSG-00397       PIC  9(05)  VALUE 00397.       00480072
004900*  WAIT 15 SECONDS;RETRY FUNCTION AGAIN, IF UNSUCCESSFUL          00490072
005000*  CALL HELP DESK                                                 00500072
005100         10  PC-TSYMSG-00551       PIC  9(05)  VALUE 00551.       00510072
005200*  PURCHASE ORDER NOT FOUND                                       00520072
005300         10  PC-TSYMSG-00726       PIC  9(05)  VALUE 00726.       00530072
005400*  NOT AUTHORIZED TO VIEW THIS INFORMATION                        00540072
005500         10  PC-TSYMSG-00840       PIC  9(05)  VALUE 00840.       00550072
005600*  ONLY ONE MAY BE SELECTED                                       00560092
005700         10  PC-TSYMSG-00973       PIC  9(05)  VALUE 00973.       00570092
005800*  DEPARTMENT, BUYER OR PO NBR REQUIRED FOR LIST                  00580092
005900         10  PC-TSYMSG-01029       PIC  9(05)  VALUE 01029.       00590072
006000*  RECEIVER NOT FOUND                                             00600072
006100         10  PC-TSYMSG-01298       PIC  9(05)  VALUE 01298.       00610072
006200*  A SYSTEM ERROR HAS OCCURRED - CONTACT HELP DESK                00620072
006300         10  PC-TSYMSG-01570       PIC  9(05)  VALUE 01570.       00630072
006400*  ONLY ONE MAY BE ENTERED                                        00640072
006500         10  PC-TSYMSG-01693       PIC  9(05)  VALUE 01693.       00650072
006600*  ONE MUST BE SELECTED                                           00660077
006700         10  PC-TSYMSG-01698       PIC  9(05)  VALUE 01698.       00670077
006800*  ENTER PO OR PO/RECEIVER FOR SELECTED NOTIF STATUS              00680099
006900         10  PC-TSYMSG-01735       PIC  9(05)  VALUE 01735.       00690096
007000*  PO AND/OR RECEIVER NOT FOUND                                   00700099
007100         10  PC-TSYMSG-01772       PIC  9(05)  VALUE 01772.       00710099
007200*  ENTER EITHER Y OR N FOR PACK TRBL                              00720099
007300         10  PC-TSYMSG-02191       PIC  9(05)  VALUE 02191.       00730099
007400         10  PC-TSYMSG-00143       PIC  9(05)  VALUE 00143.       00740099
007500*                                                                 00750072
007600 01  PS-PROGRAM-SWITCHES.                                         00760072
007700     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00770072
007800         88  PS-ERROR                          VALUE  'Y'.        00780072
007900         88  PS-NO-ERROR                       VALUE  'N'.        00790072
008000     05  PS-SQL-ERROR-SW           PIC  X(01)  VALUE  'N'.        00800072
008100         88  PS-SQL-ERROR                      VALUE  'Y'.        00810072
008200         88  PS-NO-SQL-ERROR                   VALUE  'N'.        00820072
008300     05  PS-DEFAULT-BUYER-SW       PIC  X(01)  VALUE  'Y'.        00830072
008400         88  PS-DEFAULT-BUYER                  VALUE  'Y'.        00840072
008500         88  PS-NOT-DEFAULT-BUYER              VALUE  'N'.        00850072
008600     05  PS-ERROR-MSG-SW           PIC  X(01)  VALUE  ' '.        00860072
008700         88  PS-PO-RCVR-NOT-FOUND              VALUE  'P'.        00870072
008800         88  PS-RETRY-EXCEEDED                 VALUE  'X'.        00880072
008900         88  PS-SEVERE-ERROR                   VALUE  'S'.        00890072
009000     05  PS-NOTIF-STAT-SW          PIC  X(01)  VALUE  'N'.        00900099
009100         88  PS-NOTIF-STAT-ENTERED             VALUE  'Y'.        00910099
009200         88  PS-NOTIF-STAT-NOT-ENTERED         VALUE  'N'.        00920099
009300     05  PS-RCVR-SEQ-SW            PIC  X(01)  VALUE  'N'.        00930099
009400         88  PS-RCVR-SEQ-ENTERED               VALUE  'Y'.        00940099
009500         88  PS-RCVR-SEQ-NOT-ENTERED           VALUE  'N'.        00950099
009600     05  PS-PO-NBR-SW              PIC  X(01)  VALUE  'N'.        00960099
009700         88  PS-PO-NBR-ENTERED                 VALUE  'Y'.        00970099
009800         88  PS-PO-NBR-NOT-ENTERED             VALUE  'N'.        00980099
009900     05  PS-DEPT-NBR-SW            PIC  X(01)  VALUE  'N'.        00990099
010000         88  PS-DEPT-NBR-ENTERED               VALUE  'Y'.        01000099
010100         88  PS-DEPT-NBR-NOT-ENTERED           VALUE  'N'.        01010099
010200     05  PS-BUYR-NBR-SW            PIC  X(01)  VALUE  'N'.        01020099
010300         88  PS-BUYR-NBR-ENTERED               VALUE  'Y'.        01030099
010400         88  PS-BUYR-NBR-NOT-ENTERED           VALUE  'N'.        01040099
010500*                                                                 01050072
010600 01  PV-PROGRAM-VARIABLES.                                        01060072
010700     05  PV-SQL-SUB                PIC S9(04)  VALUE +0           01070072
010800                                               COMP SYNC.         01080072
010900     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE ZERO         01090072
011000                                               COMP SYNC.         01100072
011100     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0           01110072
011200                                               COMP SYNC.         01120072
011300     05  PV-DB2-COUNT              PIC S9(09)  VALUE +0           01130072
011400                                               COMP-3.            01140072
011800     05  PV-TIMESTAMP              PIC  X(26)  VALUE SPACES.      01180099
011900     05  PV-SAVE-BYR-NBR           PIC  X(03)  VALUE SPACES.      01190099
012000     05  PV-SAVE-BYR-NBR-N         REDEFINES                      01200072
012100         PV-SAVE-BYR-NBR           PIC  9(03).                    01210072
012200     05  PV-XFACT-DATE             PIC  X(10)  VALUE SPACES.      01220099
012210*** PRB0049237 START                                              01221099
012211     05  PV-USER-ID              PIC  X(08)   VALUE SPACES.       01221199
012212     05  PV-SYSTEM-ID.                                            01221299
012213         10  FILLER              PIC  X(04)  VALUE SPACE.         01221399
012214         10  PV-REGION-IND       PIC  X(01).                      01221499
012215             88  PV-TEST-CICS                VALUE 'T'.           01221599
012216             88  PV-QA-CICS                  VALUE 'Q'.           01221699
012217             88  PV-PROD-CICS                VALUE 'P'.           01221799
012218             88  PV-LEARN-CICS               VALUE 'L'.           01221899
012219         10  FILLER              PIC  X(03)  VALUE SPACES.        01221999
012220*** PRB0049237 END                                                01222099
012300*                                                                 01230072
012400 01  DK-DB2-KEYS.                                                 01240072
012500     05  DK-PO-NBR                 PIC S9(09)  COMP VALUE +0.     01250072
012600     05  DK-REC-SEQ-NBR            PIC S9(09)  COMP VALUE +0.     01260072
012700     05  DK-LOW-REC-SEQ-NBR        PIC S9(09)  COMP VALUE +0.     01270072
012800     05  DK-HI-REC-SEQ-NBR         PIC S9(09)  COMP VALUE +0.     01280072
012900     05  DK-DEPT-NBR               PIC  X(03)       VALUE SPACES. 01290072
013000     05  DK-DEPT-NBR-N             REDEFINES                      01300072
013100         DK-DEPT-NBR               PIC  9(03).                    01310072
013200     05  DK-BYR-NBR                PIC  X(03)       VALUE SPACES. 01320072
013300     05  DK-BYR-NBR-N              REDEFINES                      01330072
013400         DK-BYR-NBR                PIC  9(03).                    01340072
013500     05  DK-DMA-NBR                PIC  X(02)       VALUE SPACES. 01350072
013600     05  DK-DMA-NBR-N              REDEFINES                      01360072
013700         DK-DMA-NBR                PIC  9(02).                    01370072
013800     05  DK-GMA-NBR                PIC  X(02)       VALUE SPACES. 01380072
013900     05  DK-GMA-NBR-N              REDEFINES                      01390072
014000         DK-GMA-NBR                PIC  9(02).                    01400072
014100/                                                                 01410072
014200     COPY TMKM511.                                                01420072
014300/                                                                 01430072
014400*    ATTRIBUTE SETTINGS COPYBOOK.                                *01440072
014500                                                                  01450072
014600     COPY DPWS015.                                                01460099
014700                                                                  01470072
014800*    FUNCTION KEYS COPYBOOK                                      *01480072
014900                                                                  01490072
015000     COPY DPWS016.                                                01500099
015100/                                                                 01510072
015200** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01520072
015300** SUB-ROUTINE (DPKUT100).                                      **01530072
015400     COPY DPWS010I.                                               01540099
015500/                                                                 01550072
015600*  WORK AREA PASSED IN CALL TO DPKUT500                          *01560072
015700     COPY DPWS500.                                                01570099
015800/                                                                 01580072
055700*---------------------------------------------------------------* 01581099
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01582099
055900*---------------------------------------------------------------* 01583099
015900     COPY DPWS030.                                                01590099
CICS       COPY DPWS930.                                                01591099
016000/                                                                 01600072
016100*    STANDARD COMMAREA.                                           01610072
016200                                                                  01620072
016300     COPY DPWS020.                                                01630099
016400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01640072
016500         10  INTER-APPL-COMM-AREA PIC X(200).                     01650072
016600     COPY TMWS004.                                                01660099
016700     COPY POWS060.                                                01670099
016800***************************************************************** 01680072
016900*    SPECIFIC COMMMAREA FOR TMKCS511.                             01690072
017000***************************************************************** 01700072
017100         10  ASC-SPECIFIC-COMMAREA.                               01710072
017200             15  ASC-RESPONSIBILITY-AREA.                         01720072
017300                 20  ASC-RA-BUYER            PIC X(01).           01730072
017400                 20  ASC-RA-ANALYST          PIC X(01).           01740072
017500                 20  ASC-RA-BUYER-ANALYST    PIC X(01).           01750072
017600                 20  ASC-RA-BUYER-ANALYST-DC PIC X(01).           01760072
017700             15  ASC-BUYER-NBR               PIC X(03).           01770072
017800             15  ASC-BUYER-NBR-N             REDEFINES            01780072
017900                 ASC-BUYER-NBR               PIC 9(03).           01790072
018000             15  ASC-DEPT                    PIC X(03).           01800072
018100             15  ASC-DEPT-N                  REDEFINES            01810072
018200                 ASC-DEPT                    PIC 9(03).           01820072
018300*PS 10/11/2014 CHANGES STARTS                                     01830099
018310             15  ASC-PO-NBR                  PIC X(08).           01831099
018400             15  ASC-PO-NBR-N                REDEFINES            01840072
018500                 ASC-PO-NBR                  PIC 9(08).           01850099
018510*PS 10/11/2014 CHANGES ENDS                                       01851099
018600             15  ASC-RCVR-SEQ-NBR            PIC X(04).           01860072
018700             15  ASC-RCVR-SEQ-NBR-N          REDEFINES            01870072
018800                 ASC-RCVR-SEQ-NBR            PIC 9(04).           01880072
018900             15  ASC-NOTIF-STATUS            PIC X(01).           01890072
019000             15  ASC-RCVR-STATUS-ARRIVED     PIC X(01).           01900072
019100             15  ASC-RCVR-STATUS-ENROUTE     PIC X(01).           01910072
019200             15  ASC-PK-NOTIFY               PIC X(01).           01920099
019300             15  ASC-PK-FR-DATE              PIC X(08).           01930099
019400             15  ASC-PK-FR-DATE-CC           PIC X(08).           01940099
019500             15  ASC-PK-FR-DATE-ISO          PIC X(10).           01950099
019600             15  ASC-PK-TO-DATE              PIC X(08).           01960099
019700             15  ASC-PK-TO-DATE-CC           PIC X(08).           01970099
019800             15  ASC-PK-TO-DATE-ISO          PIC X(10).           01980099
019900/                                                                 01990072
020000*    ABEND PROCESSING COPYBOOK.                                  *02000072
020100                                                                  02010072
020200     COPY DPWS013.                                                02020099
020300/                                                                 02030072
020400*  SQL AND COBOL DECLARATIONS FOR THE MERCHANDISE AREA TABLE     *02040072
020500                                                                  02050072
020600     EXEC SQL                                                     02060072
020700         INCLUDE TMDSEAR                                          02070072
020800     END-EXEC.                                                    02080072
020900/                                                                 02090072
021000*  SQL AND COBOL DECLARATIONS FOR THE RESPONSIBILITY AREA TABLE  *02100072
021100                                                                  02110072
021200     EXEC SQL                                                     02120072
021300         INCLUDE TRSPBAR                                          02130072
021400     END-EXEC.                                                    02140072
021500/                                                                 02150072
021600*  SQL AND COBOL DECLARATIONS FOR THE WORKER TABLE                02160072
021700                                                                  02170072
021800     EXEC SQL                                                     02180072
021900         INCLUDE TWORKER                                          02190072
022000     END-EXEC.                                                    02200072
022100/                                                                 02210072
022200*  SQL AND COBOL DECLARATIONS FOR THE PURCHASE ORDER TABLE       *02220072
022300                                                                  02230072
022400     EXEC SQL                                                     02240072
022500         INCLUDE TPURCHS                                          02250072
022600     END-EXEC.                                                    02260072
022700/                                                                 02270072
022800*  SQL AND COBOL DECLARATIONS FOR THE RECEIVER TABLE             *02280072
022900                                                                  02290072
023000     EXEC SQL                                                     02300072
023100         INCLUDE TRECEIV                                          02310072
023200     END-EXEC.                                                    02320072
023300/                                                                 02330072
023400     EXEC SQL                                                     02340072
023500         INCLUDE SQLCA                                            02350072
023600     END-EXEC.                                                    02360072
023700/                                                                 02370072
023800****************************************************************' 02380072
023900* THIS CURSOR IS USED TO GET BUYER NBR AND RESPONSIBILITY AREA *' 02390072
024000****************************************************************' 02400072
024100     EXEC SQL                                                     02410072
024200         DECLARE RESP-AREA-BUY-CSR CURSOR                         02420072
024300         FOR SELECT A.BYR_NBR, B.WORKER_STRT_DTE                  02430072
024400           FROM TMDSEAR A                                         02440072
024500              , TRSPBAR B                                         02450072
024600          WHERE A.MDSEAR_DKEY      = B.MDSEAR_DKEY                02460072
024700            AND A.MDSELV_CDE       = :PC-DPT                      02470072
024800            AND B.RSPLVL_CDE      IN (:PC-BYR, :PC-ABY)           02480081
024900            AND A.OPERCO_NBR       = :PC-KOHLS-OPER-CO            02490072
025000            AND B.WORKER_STRT_DTE <= CURRENT_DATE                 02500072
025100            AND B.WORKER_END_DTE  >= CURRENT_DATE                 02510072
025200            AND B.WORKER_NBR       =                              02520072
025300                (SELECT C.WORKER_NBR                              02530072
025400                   FROM TWORKER C                                 02540072
025500                  WHERE C.OPERCO_NBR = :PC-KOHLS-OPER-CO          02550072
025600                    AND C.UID_NBR    = :DP020-USERID)             02560072
025700          ORDER BY B.WORKER_STRT_DTE DESC                         02570080
025800     END-EXEC.                                                    02580072
025900                                                                  02590072
026000 LINKAGE SECTION.                                                 02600072
026100                                                                  02610072
026200 01  DFHCOMMAREA.                                                 02620072
026300     05  FILLER                         OCCURS  1 TO 4072 TIMES   02630072
026400                                        DEPENDING ON EIBCALEN.    02640072
026500         10  FILLER                     PIC X.                    02650072
026600                                                                  02660072
026700                                                                  02670072
026800 PROCEDURE DIVISION.                                              02680072
026900                                                                  02690072
027000 0000-MAIN-MODULE.                                                02700072
027100     INITIALIZE DP030-CICS-API-FIELDS.                            02710072
027200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02720072
027300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02730072
027400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02740072
027500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02750072
027600     MOVE LENGTH OF TM511AI        TO DP030-MAP-LENGTH (1).       02760072
027700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02770072
027800     PERFORM 0001-CALL-CICS-ARCH-API.                             02780072
027900                                                                  02790072
028000     PERFORM 1000-CONTROL-PROCESSING                              02800072
028100                                                                  02810072
028200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02820072
028300     PERFORM 0001-CALL-CICS-ARCH-API.                             02830072
028400                                                                  02840072
028500 0001-CALL-CICS-ARCH-API.                                         02850072
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02860099
028700                                    DFHCOMMAREA                   02870099
028800                                    DP030-CICS-API-FIELDS         02880099
028900                                    DP020-STANDARD-COMMAREA       02890099
029000                                    TM511AI.                      02900099
029100                                                                  02910072
029200     IF  DP030-RC-CALL-SUCCESSFUL                                 02920072
029300         CONTINUE                                                 02930072
029400     ELSE                                                         02940072
029500         SET DP013-NO-ROLLBACK                                    02950072
029600             DP013-XCTL-DISPLAY-RESTART                           02960072
029700             DP013-CICS-ABEND      TO TRUE                        02970072
029800         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        02980072
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02981099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02982099
030100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03010072
030200         PERFORM DP013-0000-PROCESS-ABEND                         03020072
030300     END-IF.                                                      03030072
030400/                                                                 03040072
030500 1000-CONTROL-PROCESSING.                                         03050072
030600                                                                  03060072
030700     EVALUATE TRUE                                                03070072
030800         WHEN DP020-NEXT-ACT-INITIAL                              03080072
030900             INITIALIZE ASC-SPECIFIC-COMMAREA                     03090072
031000             PERFORM 4000-BUILD-INITIAL-PANEL                     03100072
031100                                                                  03110072
031200         WHEN DP020-NEXT-ACT-READ-MAP                             03120072
031300             PERFORM 2000-FKEY-PROCESSING                         03130072
031400                                                                  03140072
031500         WHEN DP020-NEXT-ACT-RETURN                               03150072
031600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03160072
031700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03170072
031800                                                                  03180072
031900         WHEN OTHER                                               03190072
032000             SET DP013-LOGIC-ABEND                                03200072
032100                 DP013-NO-ROLLBACK TO TRUE                        03210072
032200             MOVE '1000-CONTROL-PROCESSING' TO  DP013-PARAGRAPH   03220072
032300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03230072
032400                                   TO  DP013-MESSAGE-TEXT(1)      03240072
032500             MOVE DP020-NEXT-APPL-ACTIVITY                        03250072
032600                                   TO DP013-MESSAGE-TEXT(2)       03260072
032700             PERFORM DP013-0000-PROCESS-ABEND                     03270072
032800     END-EVALUATE.                                                03280072
032900/                                                                 03290072
033000 2000-FKEY-PROCESSING.                                            03300072
033100                                                                  03310072
033200     EVALUATE TRUE                                                03320072
033300                                                                  03330072
033400         WHEN DP020-SRC-AID = DP016-CLEAR                         03340072
033500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03350072
033600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03360072
033700                                                                  03370072
033800         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03380072
033900             INITIALIZE ASC-SPECIFIC-COMMAREA                     03390072
034000             PERFORM 4000-BUILD-INITIAL-PANEL                     03400072
034100             PERFORM 3200-RESET-ATTRIBUTES                        03410072
034200                                                                  03420072
034300         WHEN OTHER                                               03430072
034400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03440072
034500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03450072
034600             IF  PS-NO-ERROR                                      03460072
034700                 SET DP030-CONTINUE-GO TO TRUE                    03470072
034800                 PERFORM 2100-CHECK-FUNCTION-KEY                  03480072
034900             ELSE                                                 03490072
035000                 SET DP030-OVERRIDE-GO TO TRUE                    03500072
035100             END-IF                                               03510072
035200     END-EVALUATE.                                                03520072
035210*** PRB0049237 START                                              03521099
035211 2010-CHECK-CICS-NETWORK.                                         03521199
035212                                                                  03521299
035213      EXEC CICS                                                   03521399
035214          ASSIGN                                                  03521499
035215              APPLID(PV-SYSTEM-ID)                                03521599
035216              USERID (PV-USER-ID)                                 03521699
035217      END-EXEC.                                                   03521799
035218                                                                  03521899
035219      IF PV-PROD-CICS THEN                                        03521999
035220          NEXT SENTENCE                                           03522099
035221      ELSE                                                        03522199
035222          MOVE +1                      TO PV-DB2-COUNT            03522299
035223      END-IF.                                                     03522399
035224                                                                  03522499
035230*** PRB0049237 END                                                03523099
035300/                                                                 03530072
035400 2100-CHECK-FUNCTION-KEY.                                         03540072
035500     EVALUATE TRUE                                                03550072
035600         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               03560072
035700             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03570072
035800                                                                  03580072
035900         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               03590099
036000         WHEN DP020-SRC-AID = DP016-ENTER                         03600072
036100             CONTINUE                                             03610072
036200                                                                  03620072
036300         WHEN OTHER                                               03630072
036400             SET DP013-NO-ROLLBACK                                03640072
036500                 DP013-XCTL-DISPLAY-RESTART                       03650072
036600                 DP013-CICS-ABEND  TO TRUE                        03660072
036700             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    03670072
036800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03680072
036900                                   TO DP013-MESSAGE-TEXT (1)      03690072
037000             PERFORM DP013-0000-PROCESS-ABEND                     03700072
037100     END-EVALUATE.                                                03710072
037200/                                                                 03720072
037300 2110-PREPARE-INTER-APPL-COMM.                                    03730072
037400     INITIALIZE TM004-INTER-APPL-COMMAREA                         03740099
037500     IF ASC-RA-BUYER = PC-S                                       03750099
037600         SET TM004-RA-BUYER-SW TO TRUE                            03760099
037700         MOVE PC-B TO TM004-RA-BUYER                              03770099
037800     END-IF                                                       03780099
037900     IF ASC-RA-ANALYST = PC-S                                     03790099
038000         SET TM004-RA-ANALYST-SW TO TRUE                          03800099
038100         MOVE PC-A TO TM004-RA-ANALYST                            03810099
038200     END-IF                                                       03820099
038300     IF ASC-RA-BUYER-ANALYST = PC-S                               03830099
038400         SET TM004-RA-BUY-ANALYST-SW TO TRUE                      03840099
038500         MOVE PC-B TO TM004-RA-BUYER                              03850099
038600         MOVE PC-A TO TM004-RA-ANALYST                            03860099
038700     END-IF                                                       03870099
038800     IF ASC-RA-BUYER-ANALYST-DC = PC-S                            03880099
038900         SET TM004-RA-BUY-ANALYST-DC-SW TO TRUE                   03890099
039000         MOVE PC-B TO TM004-RA-BUYER                              03900099
039100         MOVE PC-A TO TM004-RA-ANALYST                            03910099
039200         MOVE PC-D TO TM004-RA-BUYER-ANALYST-DC                   03920099
039300     END-IF                                                       03930099
039400     MOVE ASC-BUYER-NBR            TO TM004-BUYER-NBR             03940099
039500     MOVE ASC-DEPT                 TO TM004-DEPT                  03950099
039610*PS 10/14/2014 CHANGE STARTS                                      03961099
039620     MOVE ASC-PO-NBR               TO TM004-PO-NBR-N              03962099
039630*PS 10/14/2014 CHANGE ENDS                                        03963099
039700     MOVE ASC-RCVR-SEQ-NBR TO TM004-RCVR-SEQ-NBR                  03970099
039800****    UNRESOLVED IS THE DEFAULT FOR NOTIF. STATUS               03980083
039900     SET TM004-UNRSLVD-STAT-ONLY TO TRUE                          03990099
040000     MOVE PC-N TO TM004-STAT-NEW                                  04000099
040100     MOVE PC-I TO TM004-STAT-IN-PRC                               04010099
040200     IF ASC-NOTIF-STATUS > SPACES                                 04020099
040300         SET TM004-ALL-NOTIF-STATS TO TRUE                        04030099
040400         MOVE PC-R TO TM004-STAT-RSLVD                            04040099
040500         MOVE PC-A TO TM004-STAT-ACKNW                            04050099
040600     END-IF                                                       04060099
040700****    ARRIVED AND ENROUTE IS THE DEFAULT FOR RECEIVER STATUS    04070083
040800     SET TM004-RCVR-STAT-ARR-ENR TO TRUE                          04080099
040900     IF ASC-RCVR-STATUS-ARRIVED = PC-S                            04090099
041000         SET TM004-RCVR-STAT-ARRIVED TO TRUE                      04100099
041100     END-IF                                                       04110099
041200     IF ASC-RCVR-STATUS-ENROUTE = PC-S                            04120099
041300         SET TM004-RCVR-STAT-ENROUTE TO TRUE                      04130099
041400     END-IF.                                                      04140099
041500*                                                                 04150099
041600     IF ASC-PK-NOTIFY > SPACES                                    04160099
041700         MOVE ASC-PK-NOTIFY TO TM004-PACK-TRBL-IND                04170099
041800     ELSE                                                         04180099
041900         MOVE 'N'           TO TM004-PACK-TRBL-IND                04190099
042000     END-IF.                                                      04200099
042100     IF ASC-PK-FR-DATE > SPACES                                   04210099
042200         MOVE ASC-PK-FR-DATE-ISO TO TM004-PACK-FR-DT              04220099
042300     END-IF.                                                      04230099
042400     IF ASC-PK-TO-DATE > SPACES                                   04240099
042500         MOVE ASC-PK-TO-DATE-ISO TO TM004-PACK-TO-DT              04250099
042600     END-IF.                                                      04260099
042700/                                                                 04270072
042800 2200-MOVE-SCREEN-TO-COMMAREA.                                    04280072
042900     IF  ABUYERL  > ZERO                                          04290072
043000         MOVE ABUYERI    TO ASC-RA-BUYER                          04300072
043100     ELSE                                                         04310072
043200         IF  ABUYERF = DP015-ERASE-EOF                            04320072
043300             MOVE SPACE  TO ASC-RA-BUYER                          04330072
043400         END-IF                                                   04340072
043500     END-IF.                                                      04350072
043600                                                                  04360072
043700     IF  AANLYTL  > ZERO                                          04370072
043800         MOVE AANLYTI    TO ASC-RA-ANALYST                        04380072
043900     ELSE                                                         04390072
044000         IF  AANLYTF = DP015-ERASE-EOF                            04400072
044100             MOVE SPACE  TO ASC-RA-ANALYST                        04410072
044200         END-IF                                                   04420072
044300     END-IF.                                                      04430072
044400                                                                  04440072
044500     IF  ABYANLL  > ZERO                                          04450072
044600         MOVE ABYANLI    TO ASC-RA-BUYER-ANALYST                  04460072
044700     ELSE                                                         04470072
044800         IF  ABYANLF = DP015-ERASE-EOF                            04480072
044900             MOVE SPACE  TO ASC-RA-BUYER-ANALYST                  04490072
045000         END-IF                                                   04500072
045100     END-IF.                                                      04510072
045200                                                                  04520072
045300     IF  ABANDCL  > ZERO                                          04530072
045400         MOVE ABANDCI    TO ASC-RA-BUYER-ANALYST-DC               04540072
045500     ELSE                                                         04550072
045600         IF  ABANDCF = DP015-ERASE-EOF                            04560072
045700             MOVE SPACE  TO ASC-RA-BUYER-ANALYST-DC               04570072
045800         END-IF                                                   04580072
045900     END-IF.                                                      04590072
046000                                                                  04600072
046100                                                                  04610072
046200     IF  ABYRNBRL > ZERO                                          04620072
046300         MOVE ABYRNBRI   TO ASC-BUYER-NBR                         04630072
046400     ELSE                                                         04640072
046500         IF  ABYRNBRF = DP015-ERASE-EOF                           04650072
046600             MOVE SPACE  TO ASC-BUYER-NBR                         04660072
046700         END-IF                                                   04670072
046800     END-IF.                                                      04680072
046900                                                                  04690072
047000     IF  ADPTNBRL > ZERO                                          04700072
047100         MOVE ADPTNBRI   TO ASC-DEPT                              04710072
047200     ELSE                                                         04720072
047300         IF  ADPTNBRF = DP015-ERASE-EOF                           04730072
047400             MOVE SPACE  TO ASC-DEPT                              04740072
047500         END-IF                                                   04750072
047600     END-IF.                                                      04760072
047700                                                                  04770072
047800     IF  APONBRL > ZERO                                           04780072
047900         MOVE APONBRI    TO ASC-PO-NBR                            04790072
048000     ELSE                                                         04800072
048100         IF  APONBRF = DP015-ERASE-EOF                            04810072
048200             MOVE SPACE  TO ASC-PO-NBR                            04820072
048300         END-IF                                                   04830072
048400     END-IF.                                                      04840072
048500                                                                  04850072
048600     IF  ARCVSEQL > ZERO                                          04860072
048700         MOVE ARCVSEQI   TO ASC-RCVR-SEQ-NBR                      04870072
048800     ELSE                                                         04880072
048900         IF  ARCVSEQF = DP015-ERASE-EOF                           04890072
049000             MOVE SPACE  TO ASC-RCVR-SEQ-NBR                      04900072
049100         END-IF                                                   04910072
049200     END-IF.                                                      04920072
049300                                                                  04930072
049400     IF  ANTFSTAL > ZERO                                          04940072
049500         MOVE ANTFSTAI   TO ASC-NOTIF-STATUS                      04950072
049600     ELSE                                                         04960072
049700         IF  ANTFSTAF = DP015-ERASE-EOF                           04970072
049800             MOVE SPACE  TO ASC-NOTIF-STATUS                      04980072
049900         END-IF                                                   04990072
050000     END-IF.                                                      05000072
050100                                                                  05010072
050200***** RCVR CAN EITHER BE ARRIVED OR ENROUTE, DEFAULT IS BOTH      05020072
050300     IF  ARCARIVL > ZERO                                          05030072
050400         MOVE ARCARIVI   TO ASC-RCVR-STATUS-ARRIVED               05040072
050500     ELSE                                                         05050072
050600         IF  ARCARIVF = DP015-ERASE-EOF                           05060072
050700             MOVE SPACE  TO ASC-RCVR-STATUS-ARRIVED               05070072
050800         END-IF                                                   05080072
050900     END-IF.                                                      05090072
051000                                                                  05100072
051100     IF  ARCENRTL > ZERO                                          05110072
051200         MOVE ARCENRTI   TO ASC-RCVR-STATUS-ENROUTE               05120072
051300     ELSE                                                         05130072
051400         IF  ARCENRTF = DP015-ERASE-EOF                           05140072
051500             MOVE SPACE  TO ASC-RCVR-STATUS-ENROUTE               05150072
051600         END-IF                                                   05160072
051700     END-IF.                                                      05170072
051800                                                                  05180072
051900     IF APKNTFYL > ZERO                                           05190099
052000         MOVE APKNTFYI   TO ASC-PK-NOTIFY                         05200099
052100     ELSE                                                         05210099
052200         IF APKNTFYF = DP015-ERASE-EOF                            05220099
052300             MOVE SPACES TO ASC-PK-NOTIFY                         05230099
052400         END-IF                                                   05240099
052500     END-IF.                                                      05250099
052600     IF AFRDATEL > ZERO                                           05260099
052700         MOVE AFRDATEI   TO ASC-PK-FR-DATE                        05270099
052800     ELSE                                                         05280099
052900         IF AFRDATEF = DP015-ERASE-EOF                            05290099
053000             MOVE SPACES TO ASC-PK-FR-DATE                        05300099
053100                            ASC-PK-FR-DATE-CC                     05310099
053200                            ASC-PK-FR-DATE-ISO                    05320099
053300         END-IF                                                   05330099
053400     END-IF.                                                      05340099
053500     IF ATODATEL > ZERO                                           05350099
053600         MOVE ATODATEI   TO ASC-PK-TO-DATE                        05360099
053700     ELSE                                                         05370099
053800         IF ATODATEF = DP015-ERASE-EOF                            05380099
053900             MOVE SPACES TO ASC-PK-TO-DATE                        05390099
054000                            ASC-PK-TO-DATE-CC                     05400099
054100                            ASC-PK-TO-DATE-ISO                    05410099
054200         END-IF                                                   05420099
054300     END-IF.                                                      05430099
054400                                                                  05440099
054500/                                                                 05450072
054600 3000-EDIT-DATA-IN-COMMAREA.                                      05460072
054700     PERFORM 3200-RESET-ATTRIBUTES.                               05470072
054800                                                                  05480072
054900     PERFORM 3100-INITIAL-EDITS                                   05490099
055000     IF PS-NO-ERROR                                               05500099
055100         PERFORM 3150-REMAINING-EDITS                             05510099
055200     END-IF.                                                      05520099
055300                                                                  05530099
055400     IF  PS-NO-ERROR                                              05540072
055500         MOVE -1                   TO ABYRNBRL                    05550079
055600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05560072
055700     END-IF.                                                      05570072
055800/                                                                 05580072
055900 3100-INITIAL-EDITS.                                              05590099
056000     PERFORM 3105-CHK-RCVR-STAT.                                  05600099
056100     PERFORM 3110-CHK-NOTIF-STAT.                                 05610099
056200     PERFORM 3115-CHK-RCVR-SEQ.                                   05620099
056300     PERFORM 3120-CHK-PO-NBR.                                     05630099
056400     PERFORM 3125-CHK-DEPT-NBR.                                   05640099
056500     PERFORM 3130-CHK-BUYER-NBR.                                  05650099
056600     PERFORM 3135-CHK-RESP-AREA.                                  05660099
056700     PERFORM 3140-CHK-PACK-NTFY.                                  05670099
056800     PERFORM 3141-CHK-PACK-FR-DT.                                 05680099
056900     PERFORM 3142-CHK-PACK-TO-DT.                                 05690099
057000                                                                  05700099
057100 3105-CHK-RCVR-STAT.                                              05710099
057200     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    05720099
057300         CONTINUE                                                 05730099
057400     ELSE                                                         05740099
057500         IF (ASC-RCVR-STATUS-ARRIVED > SPACE) AND                 05750099
057600            (ASC-RCVR-STATUS-ENROUTE > SPACE)                     05760099
057700             SET PS-ERROR                                         05770099
057800                 DP020-MSG-FATAL TO TRUE                          05780099
057900             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             05790099
058000             MOVE DP015-UNP-ALP-BRT-OFF TO ARCARIVA               05800099
058100                                           ARCENRTA               05810099
058200             MOVE DP015-RED         TO ARCARIVC                   05820099
058300                                           ARCENRTC               05830099
058400             MOVE DP015-REVERSE TO ARCARIVH                       05840099
058500                                           ARCENRTH               05850099
058600             MOVE -1                TO ARCARIVL                   05860099
058700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05870099
058800         ELSE                                                     05880099
058900             IF ASC-RCVR-STATUS-ARRIVED > SPACE                   05890099
059000                 IF ASC-RCVR-STATUS-ARRIVED NOT = 'S'             05900099
059100                     SET PS-ERROR                                 05910099
059200                         DP020-MSG-FATAL TO TRUE                  05920099
059300                     MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER     05930099
059400                     MOVE DP015-UNP-ALP-BRT-OFF TO ARCARIVA       05940099
059500                     MOVE DP015-RED TO ARCARIVC                   05950099
059600                     MOVE DP015-REVERSE TO ARCARIVH               05960099
059700                     MOVE -1          TO ARCARIVL                 05970099
059800                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          05980099
059900                 END-IF                                           05990099
060000             END-IF                                               06000099
060100             IF ASC-RCVR-STATUS-ENROUTE > SPACE                   06010099
060200                 IF ASC-RCVR-STATUS-ENROUTE NOT = 'S'             06020099
060300                     SET PS-ERROR                                 06030099
060400                         DP020-MSG-FATAL TO TRUE                  06040099
060500                     MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER     06050099
060600                     MOVE DP015-UNP-ALP-BRT-OFF TO ARCENRTA       06060099
060700                     MOVE DP015-RED TO ARCENRTC                   06070099
060800                     MOVE DP015-REVERSE TO ARCENRTH               06080099
060900                     MOVE -1          TO ARCENRTL                 06090099
061000                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          06100099
061100                 END-IF                                           06110099
061200             END-IF                                               06120099
061300         END-IF                                                   06130099
061400     END-IF.                                                      06140099
061500                                                                  06150099
061600 3110-CHK-NOTIF-STAT.                                             06160099
061700     IF  (ASC-NOTIF-STATUS > SPACE)                               06170099
061800         IF ASC-NOTIF-STATUS NOT = 'S'                            06180099
061900             SET PS-ERROR                                         06190099
062000                 DP020-MSG-FATAL TO TRUE                          06200099
062100             MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER             06210099
062200             MOVE DP015-UNP-ALP-BRT-OFF TO ANTFSTAA               06220099
062300             MOVE DP015-RED TO ANTFSTAC                           06230099
062400             MOVE DP015-REVERSE TO ANTFSTAH                       06240099
062500             MOVE -1               TO ANTFSTAL                    06250099
062600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06260099
062700         ELSE                                                     06270099
062800             SET PS-NOTIF-STAT-ENTERED   TO TRUE                  06280099
062900         END-IF                                                   06290099
063000     END-IF.                                                      06300099
063100                                                                  06310099
063200 3115-CHK-RCVR-SEQ.                                               06320099
063300     IF (ASC-RCVR-SEQ-NBR > SPACE)                                06330099
063400         MOVE ASC-RCVR-SEQ-NBR TO DP010I-UNEDITED-FIELD           06340099
063500         MOVE LENGTH OF ASC-RCVR-SEQ-NBR                          06350099
063600                              TO DP010I-MAXIMUM-DIGITS            06360099
063700         MOVE ZERO            TO DP010I-MAXIMUM-DECIMALS          06370099
063800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06380099
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06391099
263627              USING DP010I-NUMERIC-EDIT-AREA                      06392099
064000         IF DP010I-ERROR-DETECTED                                 06400099
064100             SET PS-ERROR                                         06410099
064200                 DP020-MSG-FATAL TO TRUE                          06420099
064300             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             06430099
064400             MOVE DP015-UNP-ALP-BRT-OFF TO ARCVSEQA               06440099
064500             MOVE DP015-RED TO ARCVSEQC                           06450099
064600             MOVE DP015-REVERSE TO ARCVSEQH                       06460099
064700             MOVE -1        TO ARCVSEQL                           06470099
064800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06480099
064900         ELSE                                                     06490099
065000             MOVE DP010I-NUMERIC-FIELD                            06500099
065100                                TO ASC-RCVR-SEQ-NBR-N             06510099
065200             MOVE ASC-RCVR-SEQ-NBR-N                              06520099
065300                                TO DK-LOW-REC-SEQ-NBR             06530099
065400             MOVE ASC-RCVR-SEQ-NBR-N                              06540099
065500                                TO DK-HI-REC-SEQ-NBR              06550099
065600             SET PS-RCVR-SEQ-ENTERED   TO TRUE                    06560099
065700         END-IF                                                   06570099
065800     END-IF.                                                      06580099
065900                                                                  06590099
066000 3120-CHK-PO-NBR.                                                 06600099
066100     IF (ASC-PO-NBR > SPACE)                                      06610099
066200         MOVE ASC-PO-NBR   TO DP010I-UNEDITED-FIELD               06620099
066300         MOVE LENGTH OF ASC-PO-NBR                                06630099
066400                           TO DP010I-MAXIMUM-DIGITS               06640099
066500         MOVE ZERO         TO DP010I-MAXIMUM-DECIMALS             06650099
066600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06660099
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06671099
263627              USING DP010I-NUMERIC-EDIT-AREA                      06672099
066800         IF DP010I-ERROR-DETECTED                                 06680099
066900             SET PS-ERROR                                         06690099
067000                 DP020-MSG-FATAL TO TRUE                          06700099
067100             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             06710099
067200             MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                06720099
067300             MOVE DP015-RED TO APONBRC                            06730099
067400             MOVE DP015-REVERSE TO APONBRH                        06740099
067500             MOVE -1        TO APONBRL                            06750099
067600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06760099
067700         ELSE                                                     06770099
067800             MOVE DP010I-NUMERIC-FIELD TO ASC-PO-NBR-N            06780099
067900             MOVE ASC-PO-NBR-N TO DK-PO-NBR                       06790099
068000             SET PS-PO-NBR-ENTERED   TO TRUE                      06800099
068100             IF ASC-RCVR-SEQ-NBR-N > 0                            06810099
068200                 CONTINUE                                         06820099
068300             ELSE                                                 06830099
068400                 MOVE PC-0000      TO DK-LOW-REC-SEQ-NBR          06840099
068500                 MOVE PC-9999      TO DK-HI-REC-SEQ-NBR           06850099
068600             END-IF                                               06860099
068700         END-IF                                                   06870099
068800     END-IF.                                                      06880099
068900                                                                  06890099
069000 3125-CHK-DEPT-NBR.                                               06900099
069100     IF (ASC-DEPT > SPACES)                                       06910099
069200         MOVE ASC-DEPT           TO DP010I-UNEDITED-FIELD         06920099
069300         MOVE LENGTH OF ASC-DEPT TO DP010I-MAXIMUM-DIGITS         06930099
069400         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       06940099
069500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06950099
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06961099
263627              USING DP010I-NUMERIC-EDIT-AREA                      06962099
069700         IF DP010I-ERROR-DETECTED                                 06970099
069800             SET PS-ERROR                                         06980099
069900                 DP020-MSG-FATAL TO TRUE                          06990099
070000             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             07000099
070100             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNBRA               07010099
070200             MOVE DP015-RED TO ADPTNBRC                           07020099
070300             MOVE DP015-REVERSE TO ADPTNBRH                       07030099
070400             MOVE -1            TO ADPTNBRL                       07040099
070500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07050099
070600         ELSE                                                     07060099
070700             MOVE DP010I-NUMERIC-FIELD TO ASC-DEPT-N              07070099
070800                                          DK-DEPT-NBR-N           07080099
070900             SET PS-DEPT-NBR-ENTERED   TO TRUE                    07090099
071000         END-IF                                                   07100099
071100     END-IF.                                                      07110099
071200                                                                  07120099
071300 3130-CHK-BUYER-NBR.                                              07130099
071400     IF (ASC-BUYER-NBR > SPACES)                                  07140099
071500         MOVE ASC-BUYER-NBR TO DP010I-UNEDITED-FIELD              07150099
071600         MOVE LENGTH OF ASC-BUYER-NBR                             07160099
071700                               TO DP010I-MAXIMUM-DIGITS           07170099
071800         MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS         07180099
071900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07190099
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07201099
263627              USING DP010I-NUMERIC-EDIT-AREA                      07202099
072100         IF DP010I-ERROR-DETECTED                                 07210099
072200             SET PS-ERROR                                         07220099
072300                 DP020-MSG-FATAL TO TRUE                          07230099
072400             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             07240099
072500             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNBRA               07250099
072600             MOVE DP015-RED TO ABYRNBRC                           07260099
072700             MOVE DP015-REVERSE TO ABYRNBRH                       07270099
072800             MOVE -1            TO ABYRNBRL                       07280099
072900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07290099
073000         ELSE                                                     07300099
073100             MOVE DP010I-NUMERIC-FIELD TO ASC-BUYER-NBR-N         07310099
073200                                          DK-BYR-NBR-N            07320099
073300             SET PS-BUYR-NBR-ENTERED   TO TRUE                    07330099
073400         END-IF                                                   07340099
073500     END-IF.                                                      07350099
073600                                                                  07360099
073700 3135-CHK-RESP-AREA.                                              07370099
073800****  CHECK RESPONSIBILITY AREA - ONE MUST BE ENTERED             07380099
073900****   UNLESS GOING TO DC SPLIT                                   07390099
074000     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    07400099
074100         CONTINUE                                                 07410099
074200     ELSE                                                         07420099
074300         IF (ASC-RA-BUYER = SPACES) AND                           07430099
074400            (ASC-RA-ANALYST = SPACES) AND                         07440099
074500            (ASC-RA-BUYER-ANALYST = SPACES) AND                   07450099
074600            (ASC-RA-BUYER-ANALYST-DC = SPACES)                    07460099
074700             SET PS-ERROR                                         07470099
074800                 DP020-MSG-FATAL TO TRUE                          07480099
074900             MOVE PC-TSYMSG-01698 TO DP020-MSG-NUMBER             07490099
075000             MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA                07500099
075100                                           AANLYTA                07510099
075200                                           ABYANLA                07520099
075300                                           ABANDCA                07530099
075400             MOVE DP015-RED TO ABUYERC                            07540099
075500                               AANLYTC                            07550099
075600                               ABYANLC                            07560099
075700                               ABANDCC                            07570099
075800             MOVE DP015-REVERSE TO ABUYERH                        07580099
075900                                   AANLYTH                        07590099
076000                                   ABYANLH                        07600099
076100                                   ABANDCH                        07610099
076200             MOVE -1    TO ABUYERL                                07620099
076300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07630099
076400         END-IF                                                   07640099
076500                                                                  07650099
076600****  CHECK RESPONSIBILITY AREA - ONLY ONE MAY BE ENTERED         07660099
076700         IF (ASC-RA-BUYER > SPACES) AND                           07670099
076800            (ASC-RA-ANALYST > SPACES) AND                         07680099
076900            (ASC-RA-BUYER-ANALYST > SPACES) AND                   07690099
077000            (ASC-RA-BUYER-ANALYST-DC > SPACES)                    07700099
077100             SET PS-ERROR                                         07710099
077200                 DP020-MSG-FATAL TO TRUE                          07720099
077300             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             07730099
077400             MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA                07740099
077500                                           AANLYTA                07750099
077600                                           ABYANLA                07760099
077700                                           ABANDCA                07770099
077800             MOVE DP015-RED TO ABUYERC                            07780099
077900                               AANLYTC                            07790099
078000                               ABYANLC                            07800099
078100                               ABANDCC                            07810099
078200             MOVE DP015-REVERSE TO ABUYERH                        07820099
078300                                   AANLYTH                        07830099
078400                                   ABYANLH                        07840099
078500                                   ABANDCH                        07850099
078600             MOVE -1    TO ABUYERL                                07860099
078700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07870099
078800         END-IF                                                   07880099
078900                                                                  07890099
079000         IF (ASC-RA-BUYER > SPACES)                               07900099
079100             IF ASC-RA-BUYER NOT = 'S'                            07910099
079200                 SET PS-ERROR                                     07920099
079300                     DP020-MSG-FATAL TO TRUE                      07930099
079400                 MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER         07940099
079500                 MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA            07950099
079600                 MOVE DP015-RED TO ABUYERC                        07960099
079700                 MOVE DP015-REVERSE TO ABUYERH                    07970099
079800                 MOVE -1        TO ABUYERL                        07980099
079900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07990099
080000             END-IF                                               08000099
080100         END-IF                                                   08010099
080200         IF (ASC-RA-ANALYST > SPACES)                             08020099
080300             IF ASC-RA-ANALYST NOT = 'S'                          08030099
080400             SET PS-ERROR                                         08040099
080500                 DP020-MSG-FATAL TO TRUE                          08050099
080600                 MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER         08060099
080700                 MOVE DP015-UNP-ALP-BRT-OFF TO AANLYTA            08070099
080800                 MOVE DP015-RED TO AANLYTC                        08080099
080900                 MOVE DP015-REVERSE TO AANLYTH                    08090099
081000                 MOVE -1        TO AANLYTL                        08100099
081100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08110099
081200             END-IF                                               08120099
081300         END-IF                                                   08130099
081400                                                                  08140099
081500         IF (ASC-RA-BUYER-ANALYST > SPACES)                       08150099
081600             IF ASC-RA-BUYER-ANALYST NOT = 'S'                    08160099
081700                 SET PS-ERROR                                     08170099
081800                     DP020-MSG-FATAL TO TRUE                      08180099
081900                 MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER         08190099
082000                 MOVE DP015-UNP-ALP-BRT-OFF TO ABYANLA            08200099
082100                 MOVE DP015-RED TO ABYANLC                        08210099
082200                 MOVE DP015-REVERSE TO ABYANLH                    08220099
082300                 MOVE -1        TO ABYANLL                        08230099
082400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08240099
082500             END-IF                                               08250099
082600         END-IF                                                   08260099
082700                                                                  08270099
082800         IF (ASC-RA-BUYER-ANALYST-DC > SPACES)                    08280099
082900             IF ASC-RA-BUYER-ANALYST-DC NOT = 'S'                 08290099
083000                 SET PS-ERROR                                     08300099
083100                     DP020-MSG-FATAL TO TRUE                      08310099
083200                 MOVE PC-TSYMSG-00397 TO DP020-MSG-NUMBER         08320099
083300                 MOVE DP015-UNP-ALP-BRT-OFF TO ABANDCA            08330099
083400                 MOVE DP015-RED         TO ABANDCC                08340099
083500                 MOVE DP015-REVERSE TO ABANDCH                    08350099
083600                 MOVE -1        TO ABANDCL                        08360099
083700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08370099
083800             END-IF                                               08380099
083900         END-IF                                                   08390099
084000     END-IF.                                                      08400099
084100                                                                  08410099
084200 3140-CHK-PACK-NTFY.                                              08420099
084300     IF ASC-PK-NOTIFY > SPACE                                     08430099
084400         IF ASC-PK-NOTIFY = 'Y'                                   08440099
084500             CONTINUE                                             08450099
084600         ELSE                                                     08460099
084700             SET PS-ERROR                                         08470099
084800                 DP020-MSG-FATAL TO TRUE                          08480099
084900             MOVE PC-TSYMSG-02191 TO DP020-MSG-NUMBER             08490099
085000             MOVE DP015-UNP-ALP-BRT-OFF TO APKNTFYA               08500099
085100             MOVE DP015-RED TO APKNTFYC                           08510099
085200             MOVE DP015-REVERSE TO APKNTFYH                       08520099
085300             MOVE -1            TO APKNTFYL                       08530099
085400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08540099
085500         END-IF                                                   08550099
085600     END-IF.                                                      08560099
085700                                                                  08570099
085800 3141-CHK-PACK-FR-DT.                                             08580099
085900     IF ASC-PK-FR-DATE > SPACES                                   08590099
086000         INITIALIZE DPG51                                         08600099
086100         SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                  08610099
086200         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  08620099
086300         MOVE ZERO TO TALLY                                       08630099
086400         INSPECT ASC-PK-FR-DATE                                   08640099
086500                 TALLYING TALLY FOR ALL '/'                       08650099
086600         IF TALLY > 1                                             08660099
086700*            ==> 'MM/DD/YY' <==                                   08670099
086800             SET DPG52-LK-DTE-GREG-CC-FMT TO TRUE                 08680099
086900             IF ASC-PK-FR-DATE (7:2) > 80                         08690099
087000                 MOVE '19' TO PV-XFACT-DATE(7:2)                  08700099
087100             ELSE                                                 08710099
087200                 MOVE '20' TO PV-XFACT-DATE(7:2)                  08720099
087300             END-IF                                               08730099
087400             MOVE ASC-PK-FR-DATE(1:6) TO PV-XFACT-DATE(1:6)       08740099
087500             MOVE ASC-PK-FR-DATE(7:2) TO PV-XFACT-DATE(9:2)       08750099
087600         ELSE                                                     08760099
087700*            ==> 'MMDDYY  ' <==                                   08770099
087800             SET DPG52-LK-DTE-GREG-CC TO TRUE                     08780099
087900             IF ASC-PK-FR-DATE (5:2) > 80                         08790099
088000                 MOVE '19' TO PV-XFACT-DATE(5:2)                  08800099
088100             ELSE                                                 08810099
088200                 MOVE '20' TO PV-XFACT-DATE(5:2)                  08820099
088300             END-IF                                               08830099
088400             MOVE ASC-PK-FR-DATE (1:2) TO PV-XFACT-DATE(1:2)      08840099
088500             MOVE ASC-PK-FR-DATE (3:2) TO PV-XFACT-DATE(3:2)      08850099
088600             MOVE ASC-PK-FR-DATE (5:2) TO PV-XFACT-DATE(7:2)      08860099
088700             MOVE SPACES TO PV-XFACT-DATE(9:2)                    08870099
088800         END-IF                                                   08880099
088900                                                                  08890099
089000         MOVE PV-XFACT-DATE TO DPG52-LK-DATE-INPUT                08900099
089100         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  08910099
089200                  DPG51 DPG52 DPG53 DPG54 DPG55 DPG56             08920099
089300         IF (DPG54-DATE-INVALID                                   08930099
089400           OR DPG54-SEVERE-ERROR)                                 08940099
089500             SET PS-ERROR                                         08950099
089600                 DP020-MSG-FATAL TO TRUE                          08960099
089700*            ---- INVALID DATE ----                               08970099
089800             MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER      08980099
089900             MOVE DP015-UNP-ALP-BRT-MDT  TO AFRDATEA              08990099
090000             MOVE DP015-RED              TO AFRDATEC              09000099
090100             MOVE DP015-REVERSE          TO AFRDATEH              09010099
090200             MOVE -1                     TO AFRDATEL              09020099
090300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09030099
090400         ELSE                                                     09040099
090500             MOVE DPG55-GREG-DATE-FMT    TO ASC-PK-FR-DATE        09050099
090600             MOVE DPG55-GREG-CC-DATE     TO ASC-PK-FR-DATE-CC     09060099
090700             MOVE DPG55-DB2-ISO-DATE-FMT TO ASC-PK-FR-DATE-ISO    09070099
090800         END-IF                                                   09080099
090900     END-IF.                                                      09090099
091000                                                                  09100099
091100 3142-CHK-PACK-TO-DT.                                             09110099
091200     IF ASC-PK-TO-DATE > SPACES                                   09120099
091300         INITIALIZE DPG51                                         09130099
091400         SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                  09140099
091500         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  09150099
091600         MOVE ZERO TO TALLY                                       09160099
091700         INSPECT ASC-PK-TO-DATE                                   09170099
091800                 TALLYING TALLY FOR ALL '/'                       09180099
091900         IF TALLY > 1                                             09190099
092000*            ==> 'MM/DD/YY' <==                                   09200099
092100             SET DPG52-LK-DTE-GREG-CC-FMT TO TRUE                 09210099
092200             IF ASC-PK-TO-DATE (7:2) > 80                         09220099
092300                 MOVE '19' TO PV-XFACT-DATE(7:2)                  09230099
092400             ELSE                                                 09240099
092500                 MOVE '20' TO PV-XFACT-DATE(7:2)                  09250099
092600             END-IF                                               09260099
092700             MOVE ASC-PK-TO-DATE(1:6) TO PV-XFACT-DATE(1:6)       09270099
092800             MOVE ASC-PK-TO-DATE(7:2) TO PV-XFACT-DATE(9:2)       09280099
092900         ELSE                                                     09290099
093000*            ==> 'MMDDYY  ' <==                                   09300099
093100             SET DPG52-LK-DTE-GREG-CC TO TRUE                     09310099
093200             IF ASC-PK-TO-DATE (5:2) > 80                         09320099
093300                 MOVE '19' TO PV-XFACT-DATE(5:2)                  09330099
093400             ELSE                                                 09340099
093500                 MOVE '20' TO PV-XFACT-DATE(5:2)                  09350099
093600             END-IF                                               09360099
093700             MOVE ASC-PK-TO-DATE (1:2) TO PV-XFACT-DATE(1:2)      09370099
093800             MOVE ASC-PK-TO-DATE (3:2) TO PV-XFACT-DATE(3:2)      09380099
093900             MOVE ASC-PK-TO-DATE (5:2) TO PV-XFACT-DATE(7:2)      09390099
094000             MOVE SPACES TO PV-XFACT-DATE(9:2)                    09400099
094100         END-IF                                                   09410099
094200                                                                  09420099
094300         MOVE PV-XFACT-DATE TO DPG52-LK-DATE-INPUT                09430099
094400         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  09440099
094500                  DPG51 DPG52 DPG53 DPG54 DPG55 DPG56             09450099
094600         IF (DPG54-DATE-INVALID                                   09460099
094700           OR DPG54-SEVERE-ERROR)                                 09470099
094800             SET PS-ERROR                                         09480099
094900                 DP020-MSG-FATAL TO TRUE                          09490099
095000*            ---- INVALID DATE ----                               09500099
095100             MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER      09510099
095200             MOVE DP015-UNP-ALP-BRT-MDT  TO ATODATEA              09520099
095300             MOVE DP015-RED              TO ATODATEC              09530099
095400             MOVE DP015-REVERSE          TO ATODATEH              09540099
095500             MOVE -1                     TO ATODATEL              09550099
095600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09560099
095700         ELSE                                                     09570099
095800             MOVE DPG55-GREG-DATE-FMT    TO ASC-PK-TO-DATE        09580099
095900             MOVE DPG55-GREG-CC-DATE     TO ASC-PK-TO-DATE-CC     09590099
096000             MOVE DPG55-DB2-ISO-DATE-FMT TO ASC-PK-TO-DATE-ISO    09600099
096100         END-IF                                                   09610099
096200     END-IF.                                                      09620099
096300                                                                  09630099
096400 3150-REMAINING-EDITS.                                            09640099
096500     IF PS-NOTIF-STAT-ENTERED                                     09650099
096600         PERFORM 3155-CHK2-NOTIF-STAT                             09660099
096700     END-IF.                                                      09670099
096800     PERFORM 3185-CHK2-BYR-DPT-PO-REL.                            09680099
096900     PERFORM 3190-CHK2-RESP-AREA-REL.                             09690099
097000         IF PS-RCVR-SEQ-ENTERED OR                                09700099
097100            PS-PO-NBR-ENTERED OR                                  09710099
097200            PS-DEPT-NBR-ENTERED OR                                09720099
097300            PS-BUYR-NBR-ENTERED                                   09730099
097400             IF PS-RCVR-SEQ-ENTERED OR                            09740099
097500                PS-PO-NBR-ENTERED                                 09750099
097600                 PERFORM 3160-CHK2-PO-RCVR-SEQ                    09760099
097700             END-IF                                               09770099
097800             IF PS-DEPT-NBR-ENTERED                               09780099
097900                 PERFORM 3170-CHK2-DEPT-NBR                       09790099
098000             END-IF                                               09800099
098100             IF PS-BUYR-NBR-ENTERED                               09810099
098200                 PERFORM 3175-CHK2-BUYER-NBR                      09820099
098300             END-IF                                               09830099
098400         END-IF.                                                  09840099
098500     PERFORM 3199-COMPARE-FR-TO-DATES.                            09850099
098600                                                                  09860099
098700 3155-CHK2-NOTIF-STAT.                                            09870099
098800     IF (ASC-PO-NBR = SPACE OR ZEROS) AND                         09880099
098900        ASC-DEPT > SPACE AND ASC-BUYER-NBR > SPACE                09890099
099000         SET PS-ERROR                                             09900099
099100             DP020-MSG-FATAL TO TRUE                              09910099
099200         MOVE PC-TSYMSG-01735 TO DP020-MSG-NUMBER                 09920099
099300         MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                    09930099
099400                                       ABYRNBRA                   09940099
099500                                       ADPTNBRA                   09950099
099600         MOVE DP015-RED TO APONBRC                                09960099
099700                           ABYRNBRC                               09970099
099800                           ADPTNBRC                               09980099
099900         MOVE DP015-REVERSE TO APONBRH                            09990099
100000                               ABYRNBRH                           10000099
100100                               ADPTNBRH                           10010099
100200         MOVE -1                           TO ABYRNBRL            10020099
100300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10030099
100400     END-IF.                                                      10040099
100500     IF ((ASC-PO-NBR = SPACE OR ZEROS) AND                        10050099
100600         ASC-DEPT = SPACE AND ASC-BUYER-NBR > SPACE)              10060099
100700         SET PS-ERROR                                             10070099
100800             DP020-MSG-FATAL TO TRUE                              10080099
100900         MOVE PC-TSYMSG-01735 TO DP020-MSG-NUMBER                 10090099
101000         MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                    10100099
101100                                       ABYRNBRA                   10110099
101200         MOVE DP015-RED TO APONBRC                                10120099
101300                           ABYRNBRC                               10130099
101400         MOVE DP015-REVERSE TO APONBRH                            10140099
101500                               ABYRNBRH                           10150099
101600         MOVE -1                           TO ABYRNBRL            10160099
101700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10170099
101800     END-IF.                                                      10180099
101900     IF ((ASC-PO-NBR = SPACE OR ZEROS) AND                        10190099
102000         ASC-DEPT > SPACE AND ASC-BUYER-NBR = SPACE)              10200099
102100         SET PS-ERROR                                             10210099
102200             DP020-MSG-FATAL TO TRUE                              10220099
102300         MOVE PC-TSYMSG-01735 TO DP020-MSG-NUMBER                 10230099
102400         MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                    10240099
102500                                       ADPTNBRA                   10250099
102600         MOVE DP015-RED TO APONBRC                                10260099
102700                           ADPTNBRC                               10270099
102800         MOVE DP015-REVERSE TO APONBRH                            10280099
102900                               ADPTNBRH                           10290099
103000         MOVE -1                           TO ADPTNBRL            10300099
103100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10310099
103200     END-IF.                                                      10320099
103300     IF ((ASC-PO-NBR = SPACE OR ZEROS) AND                        10330099
103400         ASC-DEPT = SPACE AND ASC-BUYER-NBR = SPACE)              10340099
103500         SET PS-ERROR                                             10350099
103600             DP020-MSG-FATAL TO TRUE                              10360099
103700         MOVE PC-TSYMSG-01735 TO DP020-MSG-NUMBER                 10370099
103800         MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                    10380099
103900         MOVE DP015-RED TO APONBRC                                10390099
104000         MOVE DP015-REVERSE TO APONBRH                            10400099
104100         MOVE -1                TO APONBRL                        10410099
104200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10420099
104300     END-IF.                                                      10430099
104400                                                                  10440099
104500 3160-CHK2-PO-RCVR-SEQ.                                           10450099
104600     PERFORM 3600-SELECT-PO                                       10460099
104700     IF PS-PO-RCVR-NOT-FOUND                                      10470099
104800         SET PS-ERROR                                             10480099
104900             DP020-MSG-FATAL TO TRUE                              10490099
105000         MOVE PC-TSYMSG-01772 TO DP020-MSG-NUMBER                 10500099
105100         IF PS-PO-NBR-ENTERED                                     10510099
105200             MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                10520099
105300             MOVE DP015-RED TO APONBRC                            10530099
105400             MOVE DP015-REVERSE TO APONBRH                        10540099
105500             MOVE -1            TO APONBRL                        10550099
105600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10560099
105700         END-IF                                                   10570099
105800         IF PS-RCVR-SEQ-ENTERED                                   10580099
105900             MOVE DP015-UNP-ALP-BRT-OFF TO ARCVSEQA               10590099
106000             MOVE DP015-RED TO ARCVSEQC                           10600099
106100             MOVE DP015-REVERSE TO ARCVSEQH                       10610099
106200             MOVE -1            TO ARCVSEQL                       10620099
106300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10630099
106400         END-IF                                                   10640099
106500     END-IF                                                       10650099
106600     IF PS-RETRY-EXCEEDED                                         10660099
106700         SET PS-ERROR                                             10670099
106800             DP020-MSG-FATAL TO TRUE                              10680099
106900         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 10690099
107000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10700099
107100     END-IF                                                       10710099
107200     IF PS-SEVERE-ERROR                                           10720099
107300         SET PS-ERROR                                             10730099
107400             DP020-MSG-FATAL TO TRUE                              10740099
107500         MOVE PC-TSYMSG-01570 TO DP020-MSG-NUMBER                 10750099
107600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10760099
107700     END-IF                                                       10770099
107800     IF ASC-PO-NBR = SPACES OR ZEROS                              10780099
107900         SET PS-ERROR                                             10790099
108000             DP020-MSG-FATAL TO TRUE                              10800099
108100         MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 10810099
108200         MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA                    10820099
108300         MOVE DP015-RED TO APONBRC                                10830099
108400         MOVE DP015-GREEN TO ARCVSEQC                             10840099
108500         MOVE DP015-REVERSE TO APONBRH                            10850099
108600         MOVE DP015-UNDERLINE TO ARCVSEQH                         10860099
108700         MOVE -1             TO APONBRL                           10870099
108800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10880099
108900     END-IF.                                                      10890099
109000                                                                  10900099
109100 3170-CHK2-DEPT-NBR.                                              10910099
109200     IF (ASC-DEPT > SPACES)                                       10920099
109300         INITIALIZE PV-DB2-COUNT                                  10930099
109400         PERFORM 3500-CHECK-AUTHORIZATION-DEPT                    10940099
109500         IF PV-DB2-COUNT = +0                                     10950099
109600             MOVE PC-TSYMSG-00840 TO DP020-MSG-NUMBER             10960099
109700             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNBRA               10970099
109800             MOVE DP015-RED TO ADPTNBRC                           10980099
109900             MOVE DP015-REVERSE TO ADPTNBRH                       10990099
110000             MOVE -1            TO ADPTNBRL                       11000099
110100             SET PS-ERROR                                         11010099
110200                 DP020-MSG-FATAL                                  11020099
110300                 DP030-SET-CURSOR-APPL-1 TO TRUE                  11030099
110400         END-IF                                                   11040099
110500     END-IF.                                                      11050099
110600                                                                  11060099
110700 3175-CHK2-BUYER-NBR.                                             11070099
110800     IF (ASC-BUYER-NBR > SPACES)                                  11080099
110900         IF ASC-BUYER-NBR-N = PV-SAVE-BYR-NBR                     11090099
111000             CONTINUE                                             11100099
111100         ELSE                                                     11110099
111200             SET PS-NOT-DEFAULT-BUYER TO TRUE                     11120099
111300         END-IF                                                   11130099
111400         IF PS-DEFAULT-BUYER                                      11140099
111500             CONTINUE                                             11150099
111600         ELSE                                                     11160099
111700             INITIALIZE PV-DB2-COUNT                              11170099
111800             PERFORM 3510-CHECK-AUTHORIZATION-BYR                 11180099
111801*** PRB0049237 START                                              11180199
111820*            MOVE +1 TO PV-DB2-COUNT                              11182099
111830             PERFORM 2010-CHECK-CICS-NETWORK                      11183099
111840*** PRB0049237 END                                                11184099
111900             IF PV-DB2-COUNT = +0                                 11190099
112000                  MOVE PC-TSYMSG-00840                            11200099
112100                                TO DP020-MSG-NUMBER               11210099
112200                  MOVE DP015-UNP-ALP-BRT-OFF                      11220099
112300                                TO ABYRNBRA                       11230099
112400                 MOVE DP015-RED TO ABYRNBRC                       11240099
112500                 MOVE DP015-REVERSE TO ABYRNBRH                   11250099
112600                 MOVE -1                TO ABYRNBRL               11260099
112700                 SET PS-ERROR                                     11270099
112800                     DP020-MSG-FATAL                              11280099
112900                     DP030-SET-CURSOR-APPL-1 TO TRUE              11290099
113000             END-IF                                               11300099
113100         END-IF                                                   11310099
113200     END-IF.                                                      11320099
113300                                                                  11330099
113400 3185-CHK2-BYR-DPT-PO-REL.                                        11340099
113500     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    11350099
113600         CONTINUE                                                 11360099
113700     ELSE                                                         11370099
113800** CHECK IF BUYER AND DEPT AND PO ARE BLANK                       11380099
113900         IF (ASC-BUYER-NBR = SPACES) AND                          11390099
114000            (ASC-DEPT = SPACES) AND                               11400099
114100            (ASC-PO-NBR = SPACES)                                 11410099
114200             SET PS-ERROR                                         11420099
114300                 DP020-MSG-FATAL TO TRUE                          11430099
114400             IF ASC-NOTIF-STATUS > SPACES                         11440099
114500                 MOVE PC-TSYMSG-01735 TO DP020-MSG-NUMBER         11450099
114600                 MOVE DP015-UNP-ALP-BRT-OFF TO APONBRA            11460099
114700                 MOVE DP015-RED TO APONBRC                        11470099
114800                 MOVE DP015-REVERSE TO APONBRH                    11480099
114900                 MOVE -1       TO APONBRL                         11490099
115000             ELSE                                                 11500099
115100                 MOVE PC-TSYMSG-01029 TO DP020-MSG-NUMBER         11510099
115200                 MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNBRA           11520099
115300                                               ADPTNBRA           11530099
115400                                               APONBRA            11540099
115500                 MOVE DP015-RED       TO  ABYRNBRC                11550099
115600                                          ADPTNBRC                11560099
115700                                          APONBRC                 11570099
115800                 MOVE DP015-REVERSE TO ABYRNBRH                   11580099
115900                                       ADPTNBRH                   11590099
116000                                       APONBRH                    11600099
116100                 MOVE -1       TO ABYRNBRL                        11610099
116200             END-IF                                               11620099
116300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11630099
116400         END-IF                                                   11640099
116500** CHECK IF BUYER AND DEPT AND PO ARE ALL ENTERED                 11650099
116600         IF ((ASC-BUYER-NBR > SPACES) AND                         11660099
116700            (ASC-DEPT > SPACES) AND                               11670099
116800            (ASC-PO-NBR > SPACES))                                11680099
116900             SET PS-ERROR                                         11690099
117000                 DP020-MSG-FATAL TO TRUE                          11700099
117100             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             11710099
117200             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNBRA               11720099
117300                                           ADPTNBRA               11730099
117400                                           APONBRA                11740099
117500             MOVE DP015-RED TO ABYRNBRC                           11750099
117600                               ADPTNBRC                           11760099
117700                               APONBRC                            11770099
117800             MOVE DP015-REVERSE TO ABYRNBRH                       11780099
117900                                   ADPTNBRH                       11790099
118000                                   APONBRH                        11800099
118100             MOVE -1           TO ABYRNBRL                        11810099
118200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11820099
118300         END-IF                                                   11830099
118400** CHECK IF BUYER, DEPT, PO AND RCVR. SEQ. ARE ALL ENTERED        11840099
118500         IF ((ASC-BUYER-NBR > SPACES) AND                         11850099
118600            (ASC-DEPT > SPACES) AND                               11860099
118700            (ASC-PO-NBR > SPACES) AND                             11870099
118800            (ASC-RCVR-SEQ-NBR > SPACES))                          11880099
118900             SET PS-ERROR                                         11890099
119000                 DP020-MSG-FATAL TO TRUE                          11900099
119100             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             11910099
119200             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNBRA               11920099
119300                                           ADPTNBRA               11930099
119400                                           APONBRA                11940099
119500                                           ARCVSEQA               11950099
119600             MOVE DP015-RED TO ABYRNBRC                           11960099
119700                               ADPTNBRC                           11970099
119800                               APONBRC                            11980099
119900                               ARCVSEQC                           11990099
120000             MOVE DP015-REVERSE TO ABYRNBRH                       12000099
120100                                   ADPTNBRH                       12010099
120200                                   APONBRH                        12020099
120300                                   ARCVSEQH                       12030099
120400             MOVE -1           TO ABYRNBRL                        12040099
120500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12050099
120600         END-IF                                                   12060099
120700** CHECK IF BUYER AND DEPT ARE ENTERED                            12070099
120800         IF (ASC-BUYER-NBR > SPACES) AND                          12080099
120900            (ASC-DEPT > SPACES) AND                               12090099
121000            (ASC-PO-NBR = SPACES)                                 12100099
121100             SET PS-ERROR                                         12110099
121200                 DP020-MSG-FATAL TO TRUE                          12120099
121300             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             12130099
121400             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNBRA               12140099
121500                                           ADPTNBRA               12150099
121600             MOVE DP015-RED TO ABYRNBRC                           12160099
121700                               ADPTNBRC                           12170099
121800             MOVE DP015-REVERSE TO ABYRNBRH                       12180099
121900                                   ADPTNBRH                       12190099
122000             MOVE -1           TO ABYRNBRL                        12200099
122100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12210099
122200         END-IF                                                   12220099
122300** CHECK IF BUYER AND PO ARE ENTERED                              12230099
122400         IF (ASC-BUYER-NBR > SPACES) AND                          12240099
122500            (ASC-DEPT = SPACES) AND                               12250099
122600            (ASC-PO-NBR > SPACES)                                 12260099
122700             SET PS-ERROR                                         12270099
122800                 DP020-MSG-FATAL TO TRUE                          12280099
122900             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             12290099
123000             MOVE DP015-UNP-ALP-BRT-OFF TO ABYRNBRA               12300099
123100                                           APONBRA                12310099
123200             MOVE DP015-RED TO ABYRNBRC                           12320099
123300                               APONBRC                            12330099
123400             MOVE DP015-REVERSE TO ABYRNBRH                       12340099
123500                                   APONBRH                        12350099
123600             MOVE -1           TO ABYRNBRL                        12360099
123700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12370099
123800         END-IF                                                   12380099
123900** CHECK IF DEPT AND PO ARE ENTERED                               12390099
124000         IF (ASC-BUYER-NBR = SPACES) AND                          12400099
124100            (ASC-DEPT > SPACES) AND                               12410099
124200            (ASC-PO-NBR > SPACES)                                 12420099
124300             SET PS-ERROR                                         12430099
124400                 DP020-MSG-FATAL TO TRUE                          12440099
124500             MOVE PC-TSYMSG-01693 TO DP020-MSG-NUMBER             12450099
124600             MOVE DP015-UNP-ALP-BRT-OFF TO ADPTNBRA               12460099
124700                                           APONBRA                12470099
124800             MOVE DP015-RED TO ADPTNBRC                           12480099
124900                               APONBRC                            12490099
125000             MOVE DP015-REVERSE TO ADPTNBRH                       12500099
125100                                   APONBRH                        12510099
125200             MOVE -1           TO ADPTNBRL                        12520099
125300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12530099
125400         END-IF                                                   12540099
125500     END-IF.                                                      12550099
125600                                                                  12560099
125700 3190-CHK2-RESP-AREA-REL.                                         12570099
125800     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    12580099
125900         CONTINUE                                                 12590099
126000     ELSE                                                         12600099
126100         IF ASC-RA-BUYER > SPACES                                 12610099
126200             IF ASC-RA-ANALYST > SPACES                           12620099
126300                 SET PS-ERROR                                     12630099
126400                     DP020-MSG-FATAL TO TRUE                      12640099
126500                 MOVE PC-TSYMSG-00973 TO DP020-MSG-NUMBER         12650099
126600                 MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA            12660099
126700                                               AANLYTA            12670099
126800                 MOVE DP015-RED TO ABUYERC                        12680099
126900                                    AANLYTC                       12690099
127000                 MOVE DP015-REVERSE TO ABUYERH                    12700099
127100                                       AANLYTH                    12710099
127200                 MOVE -1            TO ABUYERL                    12720099
127300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12730099
127400             END-IF                                               12740099
127500         END-IF                                                   12750099
127600         IF ASC-RA-BUYER > SPACES                                 12760099
127700             IF ASC-RA-BUYER-ANALYST > SPACES                     12770099
127800                 SET PS-ERROR                                     12780099
127900                     DP020-MSG-FATAL TO TRUE                      12790099
128000                 MOVE PC-TSYMSG-00973 TO DP020-MSG-NUMBER         12800099
128100                 MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA            12810099
128200                                               ABYANLA            12820099
128300                 MOVE DP015-RED  TO ABUYERC                       12830099
128400                                    ABYANLC                       12840099
128500                 MOVE DP015-REVERSE TO ABUYERH                    12850099
128600                                       ABYANLH                    12860099
128700                 MOVE -1            TO ABUYERL                    12870099
128800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12880099
128900             END-IF                                               12890099
129000         END-IF                                                   12900099
129100         IF ASC-RA-BUYER > SPACES                                 12910099
129200             IF ASC-RA-BUYER-ANALYST-DC > SPACES                  12920099
129300                 SET PS-ERROR                                     12930099
129400                     DP020-MSG-FATAL TO TRUE                      12940099
129500                 MOVE PC-TSYMSG-00973 TO DP020-MSG-NUMBER         12950099
129600                 MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA            12960099
129700                                               ABANDCA            12970099
129800                 MOVE DP015-RED TO ABUYERC                        12980099
129900                                   ABANDCC                        12990099
130000                 MOVE DP015-REVERSE TO ABUYERH                    13000099
130100                                       ABANDCH                    13010099
130200                 MOVE -1        TO ABUYERL                        13020099
130300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13030099
130400             END-IF                                               13040099
130500         END-IF                                                   13050099
130600                                                                  13060099
130700         IF (ASC-RA-ANALYST > SPACES)                             13070099
130800             IF ASC-RA-BUYER-ANALYST > SPACES                     13080099
130900                 SET PS-ERROR                                     13090099
131000                     DP020-MSG-FATAL TO TRUE                      13100099
131100                 MOVE PC-TSYMSG-00973 TO DP020-MSG-NUMBER         13110099
131200                 MOVE DP015-UNP-ALP-BRT-OFF TO AANLYTA            13120099
131300                                               ABYANLA            13130099
131400                 MOVE DP015-RED TO AANLYTC                        13140099
131500                                   ABYANLC                        13150099
131600                 MOVE DP015-REVERSE TO AANLYTH                    13160099
131700                                       ABYANLH                    13170099
131800                 MOVE -1        TO AANLYTL                        13180099
131900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13190099
132000             END-IF                                               13200099
132100         END-IF                                                   13210099
132200         IF (ASC-RA-ANALYST > SPACES)                             13220099
132300             IF ASC-RA-BUYER-ANALYST-DC > SPACES                  13230099
132400                 SET PS-ERROR                                     13240099
132500                     DP020-MSG-FATAL TO TRUE                      13250099
132600                 MOVE PC-TSYMSG-00973 TO DP020-MSG-NUMBER         13260099
132700                 MOVE DP015-UNP-ALP-BRT-OFF TO AANLYTA            13270099
132800                                               ABANDCA            13280099
132900                 MOVE DP015-RED TO AANLYTC                        13290099
133000                                    ABANDCC                       13300099
133100                 MOVE DP015-REVERSE TO AANLYTH                    13310099
133200                                       ABANDCH                    13320099
133300                 MOVE -1            TO AANLYTL                    13330099
133400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13340099
133500             END-IF                                               13350099
133600         END-IF                                                   13360099
133700                                                                  13370099
133800         IF (ASC-RA-BUYER-ANALYST > SPACES)                       13380099
133900             IF ASC-RA-BUYER-ANALYST-DC > SPACES                  13390099
134000                 SET PS-ERROR                                     13400099
134100                     DP020-MSG-FATAL TO TRUE                      13410099
134200                 MOVE PC-TSYMSG-00973 TO DP020-MSG-NUMBER         13420099
134300                 MOVE DP015-UNP-ALP-BRT-OFF TO ABYANLA            13430099
134400                                               ABANDCA            13440099
134500                 MOVE DP015-RED TO ABYANLC                        13450099
134600                                   ABANDCC                        13460099
134700                 MOVE DP015-REVERSE TO ABYANLH                    13470099
134800                                       ABANDCH                    13480099
134900                 MOVE -1            TO ABYANLL                    13490099
135000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13500099
135100             END-IF                                               13510099
135200         END-IF                                                   13520099
135300     END-IF.                                                      13530099
135400                                                                  13540099
135500 3199-COMPARE-FR-TO-DATES.                                        13550099
135600     IF ASC-PK-FR-DATE-ISO > SPACES                               13560099
135700       AND ASC-PK-TO-DATE-ISO > SPACES                            13570099
135900         IF ASC-PK-FR-DATE-ISO > ASC-PK-TO-DATE-ISO               13590099
136000             SET PS-ERROR                                         13600099
136100                 DP020-MSG-FATAL TO TRUE                          13610099
136200             MOVE PC-TSYMSG-00143        TO DP020-MSG-NUMBER      13620099
136300             MOVE DP015-UNP-ALP-BRT-MDT  TO ATODATEA              13630099
136400             MOVE DP015-RED              TO ATODATEC              13640099
136500             MOVE DP015-REVERSE          TO ATODATEH              13650099
136600             MOVE -1                     TO ATODATEL              13660099
136700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13670099
136800         ELSE                                                     13680099
136801             MOVE 'Y' TO ASC-PK-NOTIFY                            13680199
136810         END-IF                                                   13681099
136900     END-IF.                                                      13690099
137000                                                                  13700099
137100                                                                  13710099
137200 3200-RESET-ATTRIBUTES.                                           13720099
137300     MOVE DP015-UNP-ALP-NOR-OFF    TO ABUYERA                     13730099
137400                                      AANLYTA                     13740099
137500                                      ABYANLA                     13750099
137600                                      ABANDCA                     13760099
137700                                      ABYRNBRA                    13770072
137800                                      ADPTNBRA                    13780072
137900                                      APONBRA                     13790072
138000                                      ARCVSEQA                    13800072
138100                                      ANTFSTAA                    13810072
138200                                      ARCARIVA                    13820072
138300                                      ARCENRTA                    13830099
138400                                      APKNTFYA                    13840099
138500                                      AFRDATEA                    13850099
138600                                      ATODATEA.                   13860099
138700     MOVE DP015-GREEN              TO ABUYERC                     13870072
138800                                      AANLYTC                     13880072
138900                                      ABYANLC                     13890072
139000                                      ABANDCC                     13900072
139100                                      ABYRNBRC                    13910072
139200                                      ADPTNBRC                    13920072
139300                                      APONBRC                     13930072
139400                                      ARCVSEQC                    13940072
139500                                      ANTFSTAC                    13950072
139600                                      ARCARIVC                    13960072
139700                                      ARCENRTC                    13970099
139800                                      APKNTFYC                    13980099
139900                                      AFRDATEC                    13990099
140000                                      ATODATEC.                   14000099
140100     MOVE DP015-UNDERLINE          TO ABUYERH                     14010072
140200                                      AANLYTH                     14020072
140300                                      ABYANLH                     14030072
140400                                      ABANDCH                     14040072
140500                                      ADPTNBRH                    14050072
140600                                      ABYRNBRH                    14060072
140700                                      APONBRH                     14070072
140800                                      ARCVSEQH                    14080072
140900                                      ANTFSTAH                    14090072
141000                                      ARCARIVH                    14100072
141100                                      ARCENRTH                    14110099
141200                                      APKNTFYH                    14120099
141300                                      AFRDATEH                    14130099
141400                                      ATODATEH.                   14140099
141500/                                                                 14150072
141600 3500-CHECK-AUTHORIZATION-DEPT.                                   14160072
141700                                                                  14170072
141800     PERFORM                                                      14180072
141900         WITH TEST AFTER                                          14190072
142000         VARYING PV-RETRY-COUNTER                                 14200072
142100         FROM 1 BY 1                                              14210072
142200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14220072
142300             OR (SQLCODE = +0)                                    14230072
142400             OR (SQLCODE = +100))                                 14240072
142500                                                                  14250072
142600         EXEC SQL                                                 14260072
142700              SELECT COUNT(*)                                     14270072
142800                INTO :PV-DB2-COUNT                                14280072
142900                FROM TMDSEAR A                                    14290072
143000                    ,TRSPBAR B                                    14300072
143100               WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                14310072
143200                 AND A.DEPT_NBR    = :DK-DEPT-NBR                 14320072
143300                 AND A.MDSELV_CDE  = :PC-DPT                      14330072
143400                 AND A.OPERCO_NBR  = :PC-KOHLS-OPER-CO            14340072
143500                 AND B.WORKER_STRT_DTE <= CURRENT DATE            14350072
143600                 AND B.WORKER_END_DTE  >= CURRENT DATE            14360072
143700                 AND B.WORKER_NBR  =                              14370072
143800                    (SELECT WORKER_NBR                            14380072
143900                       FROM TWORKER                               14390072
144000                      WHERE OPERCO_NBR = :PC-KOHLS-OPER-CO        14400072
144100                        AND UID_NBR    = :DP020-USERID)           14410072
144200         END-EXEC                                                 14420072
144300                                                                  14430072
144400         EVALUATE TRUE                                            14440072
144500             WHEN SQLCODE = +0                                    14450072
144600             WHEN SQLCODE = +100                                  14460072
144700             WHEN SQLCODE = -904                                  14470072
144800             WHEN SQLCODE = -913                                  14480072
144900                  CONTINUE                                        14490072
145000                                                                  14500072
145100             WHEN SQLWARN0 NOT = SPACES                           14510072
145200             WHEN SQLCODE < +0                                    14520072
145300             WHEN SQLCODE > +0                                    14530072
145400                  MOVE '3500-CHECK-AUTHORIZATION-DEPT'            14540072
145500                                  TO DP013-PARAGRAPH              14550072
145600                  MOVE 'UNSUCCESSFUL COUNT ON WORKER'             14560072
145700                                  TO DP013-MESSAGE-TEXT (1)       14570072
145800                  MOVE SQLCA      TO DP013-SQLCA                  14580072
145900                  MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)     14590072
146000                  MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)     14600072
146100                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (3)     14610072
146200                  SET DP013-DB2-ABEND                             14620072
146300                      DP013-XCTL-DISPLAY-RESTART TO TRUE          14630072
146400                  PERFORM DP013-0000-PROCESS-ABEND                14640072
146500         END-EVALUATE                                             14650072
146600     END-PERFORM.                                                 14660072
146700                                                                  14670072
146800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14680072
146900         MOVE '3500-CHECK-AUTHORIZATION-DEPT' TO DP013-PARAGRAPH  14690072
147000         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TWORKER'          14700072
147100                                  TO DP013-MESSAGE-TEXT (1)       14710072
147200         MOVE SQLCA               TO DP013-SQLCA                  14720072
147300         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     14730072
147400         MOVE 'TRSPBAR '          TO DP013-DB2-TABLE-NAME (2)     14740072
147500         SET DP013-DB2-ABEND                                      14750072
147600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   14760072
147700         PERFORM DP013-0000-PROCESS-ABEND                         14770072
147800     END-IF.                                                      14780072
147900                                                                  14790072
148000     IF  PV-DB2-COUNT = +0                                        14800072
148100         PERFORM 3505-GET-DMA-GMA-FOR-DEPT                        14810072
148200         IF  SQLCODE = +100                                       14820072
148300             CONTINUE                                             14830072
148400         ELSE                                                     14840072
148500             PERFORM 3520-CHECK-DMA-AUTHORIZATION                 14850072
148600             IF  PV-DB2-COUNT = +0                                14860072
148700                 PERFORM 3530-CHECK-GMA-AUTHORIZATION             14870072
148800             END-IF                                               14880072
148900         END-IF                                                   14890072
149000     END-IF.                                                      14900072
149100                                                                  14910072
149200     IF  PV-DB2-COUNT = +0                                        14920072
149300         PERFORM 3535-CHECK-NO-AUTHORIZATION                      14930072
149400         IF  PV-DB2-COUNT = +0                                    14940072
149500             PERFORM 3540-CHECK-NO-DMA-AUTH                       14950072
149600             IF  PV-DB2-COUNT = +0                                14960072
149700                 PERFORM 3545-CHECK-NO-GMA-AUTH                   14970072
149800                 IF  PV-DB2-COUNT = +0                            14980072
149900                     MOVE +1  TO PV-DB2-COUNT                     14990072
150000                 ELSE                                             15000072
150100                     MOVE +0  TO PV-DB2-COUNT                     15010072
150200                 END-IF                                           15020072
150300             ELSE                                                 15030072
150400                 MOVE +0      TO PV-DB2-COUNT                     15040072
150500             END-IF                                               15050072
150600         ELSE                                                     15060072
150700             MOVE +0          TO PV-DB2-COUNT                     15070072
150800         END-IF                                                   15080072
150900     END-IF.                                                      15090072
151000                                                                  15100072
151100 3505-GET-DMA-GMA-FOR-DEPT.                                       15110072
151200                                                                  15120072
151300     PERFORM                                                      15130072
151400         WITH TEST AFTER                                          15140072
151500         VARYING PV-RETRY-COUNTER                                 15150072
151600         FROM 1 BY 1                                              15160072
151700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15170072
151800             OR (SQLCODE = +0)                                    15180072
151900             OR (SQLCODE = +100))                                 15190072
152000                                                                  15200072
152100         EXEC SQL                                                 15210072
152200              SELECT GMA_NBR,                                     15220072
152300                     DMA_NBR                                      15230072
152400                INTO :DK-GMA-NBR,                                 15240072
152500                     :DK-DMA-NBR                                  15250072
152600                FROM TMDSEAR                                      15260072
152700               WHERE DEPT_NBR    = :DK-DEPT-NBR                   15270072
152800                 AND MDSELV_CDE  = :PC-DPT                        15280072
152900                 AND OPERCO_NBR  = :PC-KOHLS-OPER-CO              15290072
153000                 AND STRT_DTE   <= CURRENT DATE                   15300072
153100                 AND END_DTE    >= CURRENT DATE                   15310072
153200         END-EXEC                                                 15320072
153300                                                                  15330072
153400         EVALUATE TRUE                                            15340072
153500             WHEN SQLCODE = +0                                    15350072
153600             WHEN SQLCODE = +100                                  15360072
153700             WHEN SQLCODE = -904                                  15370072
153800             WHEN SQLCODE = -913                                  15380072
153900                  CONTINUE                                        15390072
154000                                                                  15400072
154100             WHEN SQLWARN0 NOT = SPACES                           15410072
154200             WHEN SQLCODE < +0                                    15420072
154300             WHEN SQLCODE > +0                                    15430072
154400                  MOVE '3505-GET-DMA-GMA-FOR-DEPT'                15440072
154500                                  TO DP013-PARAGRAPH              15450072
154600                  MOVE 'UNSUCCESSFUL SELECT ON MDSEAR'            15460072
154700                                  TO DP013-MESSAGE-TEXT (1)       15470072
154800                  MOVE SQLCA      TO DP013-SQLCA                  15480072
154900                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     15490072
155000                  SET DP013-DB2-ABEND                             15500072
155100                      DP013-XCTL-DISPLAY-RESTART TO TRUE          15510072
155200                  PERFORM DP013-0000-PROCESS-ABEND                15520072
155300         END-EVALUATE                                             15530072
155400     END-PERFORM.                                                 15540072
155500                                                                  15550072
155600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15560072
155700         MOVE '3505-GET-DMA-GMA-FOR-DEPT' TO DP013-PARAGRAPH      15570072
155800         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON MDSEAR'          15580072
155900                                  TO DP013-MESSAGE-TEXT (1)       15590072
156000         MOVE SQLCA               TO DP013-SQLCA                  15600072
156100         MOVE 'TMDSEAR '          TO DP013-DB2-TABLE-NAME (1)     15610072
156200         SET DP013-DB2-ABEND                                      15620072
156300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   15630072
156400         PERFORM DP013-0000-PROCESS-ABEND                         15640072
156500     END-IF.                                                      15650072
156600                                                                  15660072
156700 3510-CHECK-AUTHORIZATION-BYR.                                    15670072
156800                                                                  15680072
156900     PERFORM                                                      15690072
157000         WITH TEST AFTER                                          15700072
157100         VARYING PV-RETRY-COUNTER                                 15710072
157200         FROM 1 BY 1                                              15720072
157300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15730072
157400             OR (SQLCODE = +0)                                    15740072
157500             OR (SQLCODE = +100))                                 15750072
157600                                                                  15760072
157700         EXEC SQL                                                 15770072
157800              SELECT COUNT(*)                                     15780072
157900                INTO :PV-DB2-COUNT                                15790072
158000                FROM TMDSEAR A                                    15800072
158100                    ,TRSPBAR B                                    15810072
158200               WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                15820072
158300                 AND A.BYR_NBR     = :DK-BYR-NBR                  15830072
158400                 AND A.MDSELV_CDE  = :PC-DPT                      15840072
158500                 AND A.OPERCO_NBR  = :PC-KOHLS-OPER-CO            15850072
158600                 AND B.WORKER_STRT_DTE <= CURRENT DATE            15860072
158700                 AND B.WORKER_END_DTE  >= CURRENT DATE            15870072
158800                 AND B.WORKER_NBR  =                              15880072
158900                    (SELECT WORKER_NBR                            15890072
159000                       FROM TWORKER                               15900072
159100                      WHERE OPERCO_NBR = :PC-KOHLS-OPER-CO        15910072
159200                        AND UID_NBR    = :DP020-USERID)           15920072
159300         END-EXEC                                                 15930072
159400                                                                  15940072
159500         EVALUATE TRUE                                            15950072
159600             WHEN SQLCODE = +0                                    15960072
159700             WHEN SQLCODE = +100                                  15970072
159800             WHEN SQLCODE = -904                                  15980072
159900             WHEN SQLCODE = -913                                  15990072
160000                  CONTINUE                                        16000072
160100                                                                  16010072
160200             WHEN SQLWARN0 NOT = SPACES                           16020072
160300             WHEN SQLCODE < +0                                    16030072
160400             WHEN SQLCODE > +0                                    16040072
160500                  MOVE '3510-CHECK-AUTHORIZATION-BYR'             16050072
160600                                  TO DP013-PARAGRAPH              16060072
160700                  MOVE 'UNSUCCESSFUL COUNT ON WORKER'             16070072
160800                                  TO DP013-MESSAGE-TEXT (1)       16080072
160900                  MOVE SQLCA      TO DP013-SQLCA                  16090072
161000                  MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)     16100072
161100                  MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)     16110072
161200                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (3)     16120072
161300                  SET DP013-DB2-ABEND                             16130072
161400                      DP013-XCTL-DISPLAY-RESTART TO TRUE          16140072
161500                  PERFORM DP013-0000-PROCESS-ABEND                16150072
161600         END-EVALUATE                                             16160072
161700     END-PERFORM.                                                 16170072
161800                                                                  16180072
161900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16190072
162000         MOVE '3510-CHECK-AUTHORIZATION-BYR' TO DP013-PARAGRAPH   16200072
162100         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TWORKER'          16210072
162200                                  TO DP013-MESSAGE-TEXT (1)       16220072
162300         MOVE SQLCA               TO DP013-SQLCA                  16230072
162400         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     16240072
162500         MOVE 'TRSPBAR '          TO DP013-DB2-TABLE-NAME (2)     16250072
162600         SET DP013-DB2-ABEND                                      16260072
162700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   16270072
162800         PERFORM DP013-0000-PROCESS-ABEND                         16280072
162900     END-IF.                                                      16290072
163000                                                                  16300072
163100     IF  PV-DB2-COUNT = +0                                        16310072
163200         PERFORM 3515-GET-DMA-GMA-FOR-BYR                         16320072
163300         IF  SQLCODE = +100                                       16330072
163400             CONTINUE                                             16340072
163500         ELSE                                                     16350072
163600             PERFORM 3520-CHECK-DMA-AUTHORIZATION                 16360072
163700             IF  PV-DB2-COUNT = +0                                16370072
163800                 PERFORM 3530-CHECK-GMA-AUTHORIZATION             16380072
163900             END-IF                                               16390072
164000         END-IF                                                   16400072
164100     END-IF.                                                      16410072
164200                                                                  16420072
164300     IF  PV-DB2-COUNT = +0                                        16430072
164400         PERFORM 3535-CHECK-NO-AUTHORIZATION                      16440072
164500         IF  PV-DB2-COUNT = +0                                    16450072
164600             PERFORM 3540-CHECK-NO-DMA-AUTH                       16460072
164700             IF  PV-DB2-COUNT = +0                                16470072
164800                 PERFORM 3545-CHECK-NO-GMA-AUTH                   16480072
164900                 IF  PV-DB2-COUNT = +0                            16490072
165000                     MOVE +1  TO PV-DB2-COUNT                     16500072
165100                 ELSE                                             16510072
165200                     MOVE +0  TO PV-DB2-COUNT                     16520072
165300                 END-IF                                           16530072
165400             ELSE                                                 16540072
165500                 MOVE +0      TO PV-DB2-COUNT                     16550072
165600             END-IF                                               16560072
165700         ELSE                                                     16570072
165800             MOVE +0          TO PV-DB2-COUNT                     16580072
165900         END-IF                                                   16590072
166000     END-IF.                                                      16600072
166100                                                                  16610072
166200 3515-GET-DMA-GMA-FOR-BYR.                                        16620072
166300                                                                  16630072
166400     PERFORM                                                      16640072
166500         WITH TEST AFTER                                          16650072
166600         VARYING PV-RETRY-COUNTER                                 16660072
166700         FROM 1 BY 1                                              16670072
166800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16680072
166900             OR (SQLCODE = +0)                                    16690072
167000             OR (SQLCODE = +100))                                 16700072
167100                                                                  16710072
167200         EXEC SQL                                                 16720072
167300              SELECT DISTINCT                                     16730072
167400                     GMA_NBR,                                     16740072
167500                     DMA_NBR                                      16750072
167600                INTO :DK-GMA-NBR,                                 16760072
167700                     :DK-DMA-NBR                                  16770072
167800                FROM TMDSEAR                                      16780072
167900               WHERE BYR_NBR     = :DK-BYR-NBR                    16790072
168000                 AND MDSELV_CDE  = :PC-DPT                        16800072
168100                 AND OPERCO_NBR  = :PC-KOHLS-OPER-CO              16810072
168200                 AND STRT_DTE   <= CURRENT DATE                   16820072
168300                 AND END_DTE    >= CURRENT DATE                   16830072
168400         END-EXEC                                                 16840072
168500                                                                  16850072
168600         EVALUATE TRUE                                            16860072
168700             WHEN SQLCODE = +0                                    16870072
168800             WHEN SQLCODE = +100                                  16880072
168900             WHEN SQLCODE = -904                                  16890072
169000             WHEN SQLCODE = -913                                  16900072
169100                  CONTINUE                                        16910072
169200                                                                  16920072
169300             WHEN SQLWARN0 NOT = SPACES                           16930072
169400             WHEN SQLCODE < +0                                    16940072
169500             WHEN SQLCODE > +0                                    16950072
169600                  MOVE '3515-GET-DMA-GMA-FOR-BYR'                 16960072
169700                                  TO DP013-PARAGRAPH              16970072
169800                  MOVE 'UNSUCCESSFUL SELECT ON MDSEAR'            16980072
169900                                  TO DP013-MESSAGE-TEXT (1)       16990072
170000                  MOVE SQLCA      TO DP013-SQLCA                  17000072
170100                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     17010072
170200                  SET DP013-DB2-ABEND                             17020072
170300                      DP013-XCTL-DISPLAY-RESTART TO TRUE          17030072
170400                  PERFORM DP013-0000-PROCESS-ABEND                17040072
170500         END-EVALUATE                                             17050072
170600     END-PERFORM.                                                 17060072
170700                                                                  17070072
170800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17080072
170900         MOVE '3515-GET-DMA-GMA-FOR-BYR' TO DP013-PARAGRAPH       17090072
171000         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON MDSEAR'          17100072
171100                                  TO DP013-MESSAGE-TEXT (1)       17110072
171200         MOVE SQLCA               TO DP013-SQLCA                  17120072
171300         MOVE 'TMDSEAR '          TO DP013-DB2-TABLE-NAME (1)     17130072
171400         SET DP013-DB2-ABEND                                      17140072
171500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   17150072
171600         PERFORM DP013-0000-PROCESS-ABEND                         17160072
171700     END-IF.                                                      17170072
171800                                                                  17180072
171900 3520-CHECK-DMA-AUTHORIZATION.                                    17190072
172000                                                                  17200072
172100     PERFORM                                                      17210072
172200         WITH TEST AFTER                                          17220072
172300         VARYING PV-RETRY-COUNTER                                 17230072
172400         FROM 1 BY 1                                              17240072
172500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17250072
172600             OR (SQLCODE = +0)                                    17260072
172700             OR (SQLCODE = +100))                                 17270072
172800                                                                  17280072
172900         EXEC SQL                                                 17290072
173000              SELECT COUNT(*)                                     17300072
173100                INTO :PV-DB2-COUNT                                17310072
173200                FROM TMDSEAR A                                    17320072
173300                    ,TRSPBAR B                                    17330072
173400               WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                17340072
173500                 AND A.DMA_NBR    = :DK-DMA-NBR                   17350072
173600                 AND A.MDSELV_CDE  = :PC-DMA                      17360072
173700                 AND A.OPERCO_NBR  = :PC-KOHLS-OPER-CO            17370072
173800                 AND B.WORKER_STRT_DTE <= CURRENT DATE            17380072
173900                 AND B.WORKER_END_DTE  >= CURRENT DATE            17390072
174000                 AND B.WORKER_NBR  =                              17400072
174100                    (SELECT WORKER_NBR                            17410072
174200                       FROM TWORKER                               17420072
174300                      WHERE OPERCO_NBR = :PC-KOHLS-OPER-CO        17430072
174400                        AND UID_NBR    = :DP020-USERID)           17440072
174500         END-EXEC                                                 17450072
174600                                                                  17460072
174700         EVALUATE TRUE                                            17470072
174800             WHEN SQLCODE = +0                                    17480072
174900             WHEN SQLCODE = +100                                  17490072
175000             WHEN SQLCODE = -904                                  17500072
175100             WHEN SQLCODE = -913                                  17510072
175200                  CONTINUE                                        17520072
175300                                                                  17530072
175400             WHEN SQLWARN0 NOT = SPACES                           17540072
175500             WHEN SQLCODE < +0                                    17550072
175600             WHEN SQLCODE > +0                                    17560072
175700                  MOVE '3520-CHECK-DMA-AUTHORIZATION'             17570072
175800                                  TO DP013-PARAGRAPH              17580072
175900                  MOVE 'UNSUCCESSFUL COUNT ON WORKER'             17590072
176000                                  TO DP013-MESSAGE-TEXT (1)       17600072
176100                  MOVE SQLCA      TO DP013-SQLCA                  17610072
176200                  MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)     17620072
176300                  MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)     17630072
176400                  SET DP013-DB2-ABEND                             17640072
176500                      DP013-XCTL-DISPLAY-RESTART TO TRUE          17650072
176600                  PERFORM DP013-0000-PROCESS-ABEND                17660072
176700         END-EVALUATE                                             17670072
176800     END-PERFORM.                                                 17680072
176900                                                                  17690072
177000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17700072
177100         MOVE '3520-CHECK-DMA-AUTHORIZATION' TO DP013-PARAGRAPH   17710072
177200         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TWORKER'          17720072
177300                                  TO DP013-MESSAGE-TEXT (1)       17730072
177400         MOVE SQLCA               TO DP013-SQLCA                  17740072
177500         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     17750072
177600         MOVE 'TRSPBAR '          TO DP013-DB2-TABLE-NAME (2)     17760072
177700         SET DP013-DB2-ABEND                                      17770072
177800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   17780072
177900         PERFORM DP013-0000-PROCESS-ABEND                         17790072
178000     END-IF.                                                      17800072
178100                                                                  17810072
178200 3525-GET-GMA-FOR-DMA.                                            17820072
178300                                                                  17830072
178400     PERFORM                                                      17840072
178500         WITH TEST AFTER                                          17850072
178600         VARYING PV-RETRY-COUNTER                                 17860072
178700         FROM 1 BY 1                                              17870072
178800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17880072
178900             OR (SQLCODE = +0)                                    17890072
179000             OR (SQLCODE = +100))                                 17900072
179100                                                                  17910072
179200         EXEC SQL                                                 17920072
179300              SELECT GMA_NBR                                      17930072
179400                INTO :DK-GMA-NBR                                  17940072
179500                FROM TMDSEAR                                      17950072
179600               WHERE DMA_NBR     = :DK-DMA-NBR                    17960072
179700                 AND MDSELV_CDE  = :PC-DMA                        17970072
179800                 AND OPERCO_NBR  = :PC-KOHLS-OPER-CO              17980072
179900                 AND STRT_DTE   <= CURRENT DATE                   17990072
180000                 AND END_DTE    >= CURRENT DATE                   18000072
180100         END-EXEC                                                 18010072
180200                                                                  18020072
180300         EVALUATE TRUE                                            18030072
180400             WHEN SQLCODE = +0                                    18040072
180500             WHEN SQLCODE = +100                                  18050072
180600             WHEN SQLCODE = -904                                  18060072
180700             WHEN SQLCODE = -913                                  18070072
180800                  CONTINUE                                        18080072
180900                                                                  18090072
181000             WHEN SQLWARN0 NOT = SPACES                           18100072
181100             WHEN SQLCODE < +0                                    18110072
181200             WHEN SQLCODE > +0                                    18120072
181300                  MOVE '3525-GET-GMA-FOR-DMA' TO DP013-PARAGRAPH  18130072
181400                  MOVE 'UNSUCCESSFUL SELECT ON MDSEAR'            18140072
181500                                  TO DP013-MESSAGE-TEXT (1)       18150072
181600                  MOVE SQLCA      TO DP013-SQLCA                  18160072
181700                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     18170072
181800                  SET DP013-DB2-ABEND                             18180072
181900                      DP013-XCTL-DISPLAY-RESTART TO TRUE          18190072
182000                  PERFORM DP013-0000-PROCESS-ABEND                18200072
182100         END-EVALUATE                                             18210072
182200     END-PERFORM.                                                 18220072
182300                                                                  18230072
182400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18240072
182500         MOVE '3525-GET-GMA-FOR-DMA' TO  DP013-PARAGRAPH          18250072
182600         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON MDSEAR'          18260072
182700                                  TO DP013-MESSAGE-TEXT (1)       18270072
182800         MOVE SQLCA               TO DP013-SQLCA                  18280072
182900         MOVE 'TMDSEAR '          TO DP013-DB2-TABLE-NAME (1)     18290072
183000         SET DP013-DB2-ABEND                                      18300072
183100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   18310072
183200         PERFORM DP013-0000-PROCESS-ABEND                         18320072
183300     END-IF.                                                      18330072
183400                                                                  18340072
183500 3530-CHECK-GMA-AUTHORIZATION.                                    18350072
183600                                                                  18360072
183700     PERFORM                                                      18370072
183800         WITH TEST AFTER                                          18380072
183900         VARYING PV-RETRY-COUNTER                                 18390072
184000         FROM 1 BY 1                                              18400072
184100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18410072
184200             OR (SQLCODE = +0)                                    18420072
184300             OR (SQLCODE = +100))                                 18430072
184400                                                                  18440072
184500         EXEC SQL                                                 18450072
184600              SELECT COUNT(*)                                     18460072
184700                INTO :PV-DB2-COUNT                                18470072
184800                FROM TMDSEAR A                                    18480072
184900                    ,TRSPBAR B                                    18490072
185000               WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                18500072
185100                 AND A.GMA_NBR    = :DK-GMA-NBR                   18510072
185200                 AND A.MDSELV_CDE  = :PC-GMA                      18520072
185300                 AND A.OPERCO_NBR  = :PC-KOHLS-OPER-CO            18530072
185400                 AND B.WORKER_STRT_DTE <= CURRENT DATE            18540072
185500                 AND B.WORKER_END_DTE  >= CURRENT DATE            18550072
185600                 AND B.WORKER_NBR  =                              18560072
185700                    (SELECT WORKER_NBR                            18570072
185800                       FROM TWORKER                               18580072
185900                      WHERE OPERCO_NBR = :PC-KOHLS-OPER-CO        18590072
186000                        AND UID_NBR    = :DP020-USERID)           18600072
186100         END-EXEC                                                 18610072
186200                                                                  18620072
186300         EVALUATE TRUE                                            18630072
186400             WHEN SQLCODE = +0                                    18640072
186500             WHEN SQLCODE = +100                                  18650072
186600             WHEN SQLCODE = -904                                  18660072
186700             WHEN SQLCODE = -913                                  18670072
186800                  CONTINUE                                        18680072
186900                                                                  18690072
187000             WHEN SQLWARN0 NOT = SPACES                           18700072
187100             WHEN SQLCODE < +0                                    18710072
187200             WHEN SQLCODE > +0                                    18720072
187300                  MOVE '3530-CHECK-GMA-AUTHORIZATION'             18730072
187400                                  TO DP013-PARAGRAPH              18740072
187500                  MOVE 'UNSUCCESSFUL COUNT ON WORKER'             18750072
187600                                  TO DP013-MESSAGE-TEXT (1)       18760072
187700                  MOVE SQLCA      TO DP013-SQLCA                  18770072
187800                  MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)     18780072
187900                  MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)     18790072
188000                  SET DP013-DB2-ABEND                             18800072
188100                      DP013-XCTL-DISPLAY-RESTART TO TRUE          18810072
188200                  PERFORM DP013-0000-PROCESS-ABEND                18820072
188300         END-EVALUATE                                             18830072
188400     END-PERFORM.                                                 18840072
188500                                                                  18850072
188600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18860072
188700         MOVE '3530-CHECK-GMA-AUTHORIZATION' TO DP013-PARAGRAPH   18870072
188800         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TWORKER'          18880072
188900                                  TO DP013-MESSAGE-TEXT (1)       18890072
189000         MOVE SQLCA               TO DP013-SQLCA                  18900072
189100         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     18910072
189200         MOVE 'TRSPBAR '          TO DP013-DB2-TABLE-NAME (2)     18920072
189300         SET DP013-DB2-ABEND                                      18930072
189400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   18940072
189500         PERFORM DP013-0000-PROCESS-ABEND                         18950072
189600     END-IF.                                                      18960072
189700                                                                  18970072
189800 3535-CHECK-NO-AUTHORIZATION.                                     18980072
189900                                                                  18990072
190000     PERFORM                                                      19000072
190100         WITH TEST AFTER                                          19010072
190200         VARYING PV-RETRY-COUNTER                                 19020072
190300         FROM 1 BY 1                                              19030072
190400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19040072
190500             OR (SQLCODE = +0)                                    19050072
190600             OR (SQLCODE = +100))                                 19060072
190700                                                                  19070072
190800         EXEC SQL                                                 19080072
190900              SELECT COUNT(*)                                     19090072
191000                INTO :PV-DB2-COUNT                                19100072
191100                FROM TMDSEAR A                                    19110072
191200                    ,TRSPBAR B                                    19120072
191300               WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                19130072
191400                 AND A.MDSELV_CDE  = :PC-DPT                      19140072
191500                 AND A.OPERCO_NBR  = :PC-KOHLS-OPER-CO            19150072
191600                 AND B.WORKER_STRT_DTE <= CURRENT DATE            19160072
191700                 AND B.WORKER_END_DTE  >= CURRENT DATE            19170072
191800                 AND B.WORKER_NBR  =                              19180072
191900                    (SELECT WORKER_NBR                            19190072
192000                       FROM TWORKER                               19200072
192100                      WHERE OPERCO_NBR = :PC-KOHLS-OPER-CO        19210072
192200                        AND UID_NBR    = :DP020-USERID)           19220072
192300         END-EXEC                                                 19230072
192400                                                                  19240072
192500         EVALUATE TRUE                                            19250072
192600             WHEN SQLCODE = +0                                    19260072
192700             WHEN SQLCODE = +100                                  19270072
192800             WHEN SQLCODE = -904                                  19280072
192900             WHEN SQLCODE = -913                                  19290072
193000                  CONTINUE                                        19300072
193100                                                                  19310072
193200             WHEN SQLWARN0 NOT = SPACES                           19320072
193300             WHEN SQLCODE < +0                                    19330072
193400             WHEN SQLCODE > +0                                    19340072
193500                  MOVE '3535-CHECK-NO-AUTHORIZATION'              19350072
193600                                  TO DP013-PARAGRAPH              19360072
193700                  MOVE 'UNSUCCESSFUL COUNT ON WORKER'             19370072
193800                                  TO DP013-MESSAGE-TEXT (1)       19380072
193900                  MOVE SQLCA      TO DP013-SQLCA                  19390072
194000                  MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)     19400072
194100                  MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)     19410072
194200                  SET DP013-DB2-ABEND                             19420072
194300                      DP013-XCTL-DISPLAY-RESTART TO TRUE          19430072
194400                  PERFORM DP013-0000-PROCESS-ABEND                19440072
194500         END-EVALUATE                                             19450072
194600     END-PERFORM.                                                 19460072
194700                                                                  19470072
194800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19480072
194900         MOVE '3535-CHECK-NO-AUTHORIZATION' TO DP013-PARAGRAPH    19490072
195000         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TWORKER'          19500072
195100                                  TO DP013-MESSAGE-TEXT (1)       19510072
195200         MOVE SQLCA               TO DP013-SQLCA                  19520072
195300         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     19530072
195400         MOVE 'TRSPBAR '          TO DP013-DB2-TABLE-NAME (2)     19540072
195500         SET DP013-DB2-ABEND                                      19550072
195600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   19560072
195700         PERFORM DP013-0000-PROCESS-ABEND                         19570072
195800     END-IF.                                                      19580072
195900                                                                  19590072
196000 3540-CHECK-NO-DMA-AUTH.                                          19600072
196100                                                                  19610072
196200     PERFORM                                                      19620072
196300         WITH TEST AFTER                                          19630072
196400         VARYING PV-RETRY-COUNTER                                 19640072
196500         FROM 1 BY 1                                              19650072
196600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19660072
196700             OR (SQLCODE = +0)                                    19670072
196800             OR (SQLCODE = +100))                                 19680072
196900                                                                  19690072
197000         EXEC SQL                                                 19700072
197100              SELECT COUNT(*)                                     19710072
197200                INTO :PV-DB2-COUNT                                19720072
197300                FROM TMDSEAR A                                    19730072
197400                    ,TRSPBAR B                                    19740072
197500               WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                19750072
197600                 AND A.MDSELV_CDE  = :PC-DMA                      19760072
197700                 AND A.OPERCO_NBR  = :PC-KOHLS-OPER-CO            19770072
197800                 AND B.WORKER_STRT_DTE <= CURRENT DATE            19780072
197900                 AND B.WORKER_END_DTE  >= CURRENT DATE            19790072
198000                 AND B.WORKER_NBR  =                              19800072
198100                    (SELECT WORKER_NBR                            19810072
198200                       FROM TWORKER                               19820072
198300                      WHERE OPERCO_NBR = :PC-KOHLS-OPER-CO        19830072
198400                        AND UID_NBR    = :DP020-USERID)           19840072
198500         END-EXEC                                                 19850072
198600                                                                  19860072
198700         EVALUATE TRUE                                            19870072
198800             WHEN SQLCODE = +0                                    19880072
198900             WHEN SQLCODE = +100                                  19890072
199000             WHEN SQLCODE = -904                                  19900072
199100             WHEN SQLCODE = -913                                  19910072
199200                  CONTINUE                                        19920072
199300                                                                  19930072
199400             WHEN SQLWARN0 NOT = SPACES                           19940072
199500             WHEN SQLCODE < +0                                    19950072
199600             WHEN SQLCODE > +0                                    19960072
199700                  MOVE '3540-CHECK-NO-DMA-AUTH'                   19970072
199800                                  TO DP013-PARAGRAPH              19980072
199900                  MOVE 'UNSUCCESSFUL COUNT ON WORKER'             19990072
200000                                  TO DP013-MESSAGE-TEXT (1)       20000072
200100                  MOVE SQLCA      TO DP013-SQLCA                  20010072
200200                  MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)     20020072
200300                  MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)     20030072
200400                  SET DP013-DB2-ABEND                             20040072
200500                      DP013-XCTL-DISPLAY-RESTART TO TRUE          20050072
200600                  PERFORM DP013-0000-PROCESS-ABEND                20060072
200700         END-EVALUATE                                             20070072
200800     END-PERFORM.                                                 20080072
200900                                                                  20090072
201000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20100072
201100         MOVE '3540-CHECK-NO-DMA-AUTH' TO DP013-PARAGRAPH         20110072
201200         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TWORKER'          20120072
201300                                  TO DP013-MESSAGE-TEXT (1)       20130072
201400         MOVE SQLCA               TO DP013-SQLCA                  20140072
201500         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     20150072
201600         MOVE 'TRSPBAR '          TO DP013-DB2-TABLE-NAME (2)     20160072
201700         SET DP013-DB2-ABEND                                      20170072
201800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   20180072
201900         PERFORM DP013-0000-PROCESS-ABEND                         20190072
202000     END-IF.                                                      20200072
202100                                                                  20210072
202200 3545-CHECK-NO-GMA-AUTH.                                          20220072
202300                                                                  20230072
202400     PERFORM                                                      20240072
202500         WITH TEST AFTER                                          20250072
202600         VARYING PV-RETRY-COUNTER                                 20260072
202700         FROM 1 BY 1                                              20270072
202800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20280072
202900             OR (SQLCODE = +0)                                    20290072
203000             OR (SQLCODE = +100))                                 20300072
203100                                                                  20310072
203200         EXEC SQL                                                 20320072
203300              SELECT COUNT(*)                                     20330072
203400                INTO :PV-DB2-COUNT                                20340072
203500                FROM TMDSEAR A                                    20350072
203600                    ,TRSPBAR B                                    20360072
203700               WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                20370072
203800                 AND A.MDSELV_CDE  = :PC-GMA                      20380072
203900                 AND A.OPERCO_NBR  = :PC-KOHLS-OPER-CO            20390072
204000                 AND B.WORKER_STRT_DTE <= CURRENT DATE            20400072
204100                 AND B.WORKER_END_DTE  >= CURRENT DATE            20410072
204200                 AND B.WORKER_NBR  =                              20420072
204300                    (SELECT WORKER_NBR                            20430072
204400                       FROM TWORKER                               20440072
204500                      WHERE OPERCO_NBR = :PC-KOHLS-OPER-CO        20450072
204600                        AND UID_NBR    = :DP020-USERID)           20460072
204700         END-EXEC                                                 20470072
204800                                                                  20480072
204900         EVALUATE TRUE                                            20490072
205000             WHEN SQLCODE = +0                                    20500072
205100             WHEN SQLCODE = +100                                  20510072
205200             WHEN SQLCODE = -904                                  20520072
205300             WHEN SQLCODE = -913                                  20530072
205400                  CONTINUE                                        20540072
205500                                                                  20550072
205600             WHEN SQLWARN0 NOT = SPACES                           20560072
205700             WHEN SQLCODE < +0                                    20570072
205800             WHEN SQLCODE > +0                                    20580072
205900                  MOVE '3545-CHECK-NO-GMA-AUTH'                   20590072
206000                                  TO DP013-PARAGRAPH              20600072
206100                  MOVE 'UNSUCCESSFUL COUNT ON WORKER'             20610072
206200                                  TO DP013-MESSAGE-TEXT (1)       20620072
206300                  MOVE SQLCA      TO DP013-SQLCA                  20630072
206400                  MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)     20640072
206500                  MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)     20650072
206600                  SET DP013-DB2-ABEND                             20660072
206700                      DP013-XCTL-DISPLAY-RESTART TO TRUE          20670072
206800                  PERFORM DP013-0000-PROCESS-ABEND                20680072
206900         END-EVALUATE                                             20690072
207000     END-PERFORM.                                                 20700072
207100                                                                  20710072
207200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20720072
207300         MOVE '3545-CHECK-NO-GMA-AUTH' TO DP013-PARAGRAPH         20730072
207400         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TWORKER'          20740072
207500                                  TO DP013-MESSAGE-TEXT (1)       20750072
207600         MOVE SQLCA               TO DP013-SQLCA                  20760072
207700         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     20770072
207800         MOVE 'TRSPBAR '          TO DP013-DB2-TABLE-NAME (2)     20780072
207900         SET DP013-DB2-ABEND                                      20790072
208000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   20800072
208100         PERFORM DP013-0000-PROCESS-ABEND                         20810072
208200     END-IF.                                                      20820072
208300/                                                                 20830072
208400*----------------------------------------------------------------*20840072
208500*    CHECK THAT THE PURCHASE ORDER AND/OR REC SEQ NBR EXISTS     *20850072
208600*----------------------------------------------------------------*20860072
208700                                                                  20870072
208800 3600-SELECT-PO.                                                  20880072
208900                                                                  20890072
209000     PERFORM                                                      20900072
209100         WITH TEST AFTER                                          20910072
209200         VARYING PV-RETRY-COUNTER                                 20920072
209300         FROM 1 BY 1                                              20930072
209400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20940072
209500                   OR (SQLCODE = ZERO OR +100 OR -811))           20950072
209600*                                                                 20960072
209700         EXEC SQL                                                 20970072
209800             SELECT ORD_NBR                                       20980072
209900                  , REC_SEQ_NBR                                   20990072
210000               INTO :RECEIV-ORD-NBR                               21000072
210100                  , :RECEIV-REC-SEQ-NBR                           21010072
210200               FROM TRECEIV                                       21020072
210300              WHERE ORD_NBR       = :DK-PO-NBR                    21030072
210400                AND REC_SEQ_NBR  BETWEEN :DK-LOW-REC-SEQ-NBR      21040072
210500                                     AND :DK-HI-REC-SEQ-NBR       21050072
210600                AND VER_STATUS_CDE = :PC-ACTIVE-STATUS            21060072
210700         END-EXEC                                                 21070072
210800                                                                  21080072
210900         EVALUATE TRUE                                            21090072
211000             WHEN SQLCODE = ZERO                                  21100072
211100             WHEN SQLCODE = -811                                  21110072
211200                 CONTINUE                                         21120072
211300             WHEN SQLCODE = +100                                  21130072
211400                 SET PS-PO-RCVR-NOT-FOUND TO TRUE                 21140072
211500             WHEN SQLCODE = -904                                  21150072
211600             WHEN SQLCODE = -913                                  21160072
211700                 CONTINUE                                         21170072
211800             WHEN SQLWARN0 NOT = SPACE                            21180072
211900             WHEN SQLCODE NOT = ZERO                              21190072
212000                 SET PS-SEVERE-ERROR TO TRUE                      21200072
212100                 MOVE '3600-SELECT-PO' TO DP013-PARAGRAPH         21210075
212200                 MOVE 'SELECT PO/REC SEQ NBR'                     21220075
212300                                      TO DP013-MESSAGE-TEXT (1)   21230075
212400                 MOVE SQLCA           TO DP013-SQLCA              21240075
212500                 MOVE 'TRECEIV '      TO DP013-DB2-TABLE-NAME (1) 21250075
212600                 SET DP013-DB2-ABEND                              21260075
212700                     DP013-NO-ROLLBACK                            21270075
212800                     DP013-LINK-RETURN TO TRUE                    21280075
212900                 PERFORM DP013-0000-PROCESS-ABEND                 21290075
213000         END-EVALUATE                                             21300072
213100     END-PERFORM.                                                 21310072
213200                                                                  21320072
213300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21330072
213400         SET PS-RETRY-EXCEEDED TO TRUE                            21340072
213500         MOVE '3600-SELECT-PO' TO DP013-PARAGRAPH                 21350075
213600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     21360075
213700                                   TO DP013-MESSAGE-TEXT (1)      21370075
213800         MOVE SQLCA                TO DP013-SQLCA                 21380075
213900         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    21390075
214000         SET DP013-DB2-ABEND                                      21400075
214100             DP013-NO-ROLLBACK                                    21410075
214200             DP013-LINK-RETURN TO TRUE                            21420075
214300         PERFORM DP013-0000-PROCESS-ABEND                         21430075
214400     END-IF.                                                      21440072
214500                                                                  21450072
214600/                                                                 21460072
214700 4000-BUILD-INITIAL-PANEL.                                        21470072
214800     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        21480072
214900     MOVE -1                       TO ABYRNBRL.                   21490078
215000                                                                  21500072
215100     SET PS-NO-SQL-ERROR                                          21510072
215200         PS-DEFAULT-BUYER          TO TRUE.                       21520072
215300     PERFORM 4100-OPEN-RAB-CSR.                                   21530072
215400     PERFORM 4200-FETCH-RAB-CSR.                                  21540072
215500     PERFORM 4300-CLOSE-RAB-CSR.                                  21550072
215600                                                                  21560072
215700     IF ASC-RA-BUYER > SPACE                                      21570072
215800         MOVE ASC-RA-BUYER  TO ABUYERO                            21580072
215900         MOVE ASC-BUYER-NBR TO ABYRNBRO                           21590082
216000     END-IF.                                                      21600072
216100                                                                  21610072
216200     IF ASC-RA-BUYER-ANALYST > SPACE                              21620072
216300         MOVE ASC-RA-BUYER-ANALYST  TO ABYANLO                    21630072
216400     END-IF.                                                      21640072
216500                                                                  21650072
216600                                                                  21660072
216700                                                                  21670072
216800 4100-OPEN-RAB-CSR.                                               21680072
216900     PERFORM                                                      21690072
217000         WITH TEST AFTER                                          21700072
217100         VARYING PV-RETRY-COUNTER                                 21710072
217200         FROM 1 BY 1                                              21720072
217300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21730072
217400            OR  (SQLCODE = +0))                                   21740072
217500                                                                  21750072
217600         EXEC SQL                                                 21760072
217700             OPEN RESP-AREA-BUY-CSR                               21770072
217800         END-EXEC                                                 21780072
217900                                                                  21790072
218000         EVALUATE TRUE                                            21800072
218100             WHEN SQLCODE = +0                                    21810072
218200             WHEN SQLCODE = -904                                  21820072
218300             WHEN SQLCODE = -913                                  21830072
218400                 CONTINUE                                         21840072
218500             WHEN SQLWARN0 NOT = SPACES                           21850072
218600             WHEN SQLCODE < +0                                    21860072
218700             WHEN SQLCODE > +0                                    21870072
218800                 SET PS-SQL-ERROR TO TRUE                         21880072
218900                 MOVE '4100-OPEN-RAD-CSR  ' TO DP013-PARAGRAPH    21890072
219000                 MOVE 'OPEN RESP-AREA-BUY CURSOR FAILED'          21900072
219100                                       TO DP013-MESSAGE-TEXT (1)  21910072
219200                 MOVE SQLCA    TO DP013-SQLCA                     21920072
219300                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME (1)       21930072
219400                 MOVE 'TRSPBAR' TO DP013-DB2-TABLE-NAME (2)       21940072
219500                 MOVE 'TWORKER' TO DP013-DB2-TABLE-NAME (3)       21950072
219600                 SET DP013-DB2-ABEND                              21960072
219700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           21970072
219800                 PERFORM DP013-0000-PROCESS-ABEND                 21980072
219900         END-EVALUATE                                             21990072
220000     END-PERFORM.                                                 22000072
220100                                                                  22010072
220200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22020072
220300         MOVE '4100-OPEN-RAD-CSR  ' TO DP013-PARAGRAPH            22030072
220400         MOVE 'MAX RETRIES EXCEEDED ON TMDSEAR, TRSPBAR, TWORKER' 22040072
220500                               TO DP013-MESSAGE-TEXT (1)          22050072
220600         MOVE SQLCA            TO DP013-SQLCA                     22060072
220700         MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)        22070072
220800         MOVE 'TRSPBAR'        TO DP013-DB2-TABLE-NAME (2)        22080072
220900         MOVE 'TWORKER'        TO DP013-DB2-TABLE-NAME (3)        22090072
221000         SET DP013-DB2-ABEND                                      22100072
221100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   22110072
221200         PERFORM DP013-0000-PROCESS-ABEND                         22120072
221300     END-IF.                                                      22130072
221400                                                                  22140072
221500                                                                  22150072
221600 4200-FETCH-RAB-CSR.                                              22160072
221700     EXEC SQL                                                     22170072
221800          FETCH RESP-AREA-BUY-CSR                                 22180072
221900           INTO :MDSEAR-BYR-NBR                                   22190072
222000              , :RSPBAR-WORKER-STRT-DTE                           22200072
222100     END-EXEC.                                                    22210072
222200                                                                  22220072
222300     EVALUATE TRUE                                                22230072
222400         WHEN SQLCODE = +0                                        22240072
222500         WHEN SQLCODE = -811                                      22250072
222600             MOVE PC-S TO ASC-RA-BUYER                            22260072
222700             MOVE MDSEAR-BYR-NBR TO ASC-BUYER-NBR                 22270072
222800                                    PV-SAVE-BYR-NBR               22280072
222900             SET PS-DEFAULT-BUYER TO TRUE                         22290072
223000         WHEN SQLCODE = +100                                      22300072
223100             MOVE PC-S TO ASC-RA-BUYER-ANALYST                    22310072
223200**** FOR ANY OTHER ERROR MOVE 'S' TO BUYER/ANALYST                22320072
223300         WHEN OTHER                                               22330072
223400             MOVE PC-S TO ASC-RA-BUYER-ANALYST                    22340072
223500     END-EVALUATE.                                                22350072
223600                                                                  22360072
223700                                                                  22370072
223800 4300-CLOSE-RAB-CSR.                                              22380072
223900     PERFORM                                                      22390072
224000         WITH TEST AFTER                                          22400072
224100         VARYING PV-RETRY-COUNTER                                 22410072
224200         FROM 1 BY 1                                              22420072
224300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22430072
224400            OR  (SQLCODE = +0))                                   22440072
224500                                                                  22450072
224600         EXEC SQL                                                 22460072
224700             CLOSE RESP-AREA-BUY-CSR                              22470072
224800         END-EXEC                                                 22480072
224900                                                                  22490072
225000         EVALUATE TRUE                                            22500072
225100             WHEN SQLCODE = +0                                    22510072
225200             WHEN SQLCODE = -904                                  22520072
225300             WHEN SQLCODE = -913                                  22530072
225400                 CONTINUE                                         22540072
225500             WHEN SQLWARN0 NOT = SPACES                           22550072
225600             WHEN SQLCODE < +0                                    22560072
225700             WHEN SQLCODE > +0                                    22570072
225800                 SET PS-SQL-ERROR TO TRUE                         22580072
225900                 MOVE '4100-CLOSE-RAB-CSR ' TO DP013-PARAGRAPH    22590072
226000                 MOVE 'CLOSE RESP-AREA-BUY CURSOR FAILED'         22600072
226100                                       TO DP013-MESSAGE-TEXT (1)  22610072
226200                 MOVE SQLCA    TO DP013-SQLCA                     22620072
226300                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME (1)       22630072
226400                 MOVE 'TRSPBAR' TO DP013-DB2-TABLE-NAME (2)       22640072
226500                 MOVE 'TWORKER' TO DP013-DB2-TABLE-NAME (3)       22650072
226600                 SET DP013-DB2-ABEND                              22660072
226700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           22670072
226800                 PERFORM DP013-0000-PROCESS-ABEND                 22680072
226900         END-EVALUATE                                             22690072
227000     END-PERFORM.                                                 22700072
227100                                                                  22710072
227200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22720072
227300         MOVE '4300-CLOSE-RAB-CSR ' TO DP013-PARAGRAPH            22730072
227400         MOVE 'MAX RETRIES EXCEEDED ON TMDSEAR, TRSPBAR, TWORKER' 22740072
227500                               TO DP013-MESSAGE-TEXT (1)          22750072
227600         MOVE 'TO CLOSE CURSOR'                                   22760072
227700                               TO DP013-MESSAGE-TEXT (1)          22770072
227800         MOVE SQLCA            TO DP013-SQLCA                     22780072
227900         MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)        22790072
228000         MOVE 'TRSPBAR'        TO DP013-DB2-TABLE-NAME (2)        22800072
228100         MOVE 'TWORKER'        TO DP013-DB2-TABLE-NAME (3)        22810072
228200         SET DP013-DB2-ABEND                                      22820072
228300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   22830072
228400         PERFORM DP013-0000-PROCESS-ABEND                         22840072
228500     END-IF.                                                      22850072
228600                                                                  22860072
228700                                                                  22870072
228800 4400-MOVE-COMMAREA-TO-SCREEN.                                    22880072
228900     MOVE ASC-RA-BUYER             TO ABUYERO.                    22890072
229000     MOVE ASC-RA-ANALYST           TO AANLYTO.                    22900072
229100     MOVE ASC-RA-BUYER-ANALYST     TO ABYANLO.                    22910072
229200     MOVE ASC-RA-BUYER-ANALYST-DC  TO ABANDCO.                    22920072
229300     MOVE ASC-BUYER-NBR-N          TO ABYRNBRO.                   22930072
229400     MOVE ASC-DEPT-N               TO ADPTNBRO.                   22940072
229500     MOVE ASC-PO-NBR-N             TO APONBRO.                    22950072
229600     MOVE ASC-RCVR-SEQ-NBR-N       TO ARCVSEQO.                   22960072
229700     MOVE ASC-NOTIF-STATUS         TO ANTFSTAO.                   22970072
229800     MOVE ASC-RCVR-STATUS-ARRIVED  TO ARCARIVO.                   22980072
229900     MOVE ASC-RCVR-STATUS-ENROUTE  TO ARCENRTO.                   22990072
230000     MOVE ASC-PK-NOTIFY            TO APKNTFYO.                   23000099
230100     MOVE ASC-PK-FR-DATE           TO AFRDATEO.                   23010099
230200     MOVE ASC-PK-TO-DATE           TO ATODATEO.                   23020099
230300/                                                                 23030072
230400**************************************************************    23040072
230500*     ABEND PROCESSING PARAGRAPH                             *    23050072
230600**************************************************************    23060072
230700     COPY DPPD013.                                                23070099
