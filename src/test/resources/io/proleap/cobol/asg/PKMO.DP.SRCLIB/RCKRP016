000100  IDENTIFICATION DIVISION.                                                
000200  TITLE 'PAPERWORK MANIFEST REPORTS'.                                     
000300  PROGRAM-ID.    RCKRP016.                                                
000400  AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                         
000500  DATE-WRITTEN.  MARCH 1997.                                              
000600  DATE-COMPILED.                                                          
000700                                                                          
000800  ENVIRONMENT DIVISION.                                                   
000900  CONFIGURATION SECTION.                                                  
001000  OBJECT-COMPUTER.        IBM-3090.                                       
001100  SOURCE-COMPUTER.        IBM-3090.                                       
001200  INPUT-OUTPUT SECTION.                                                   
001300  FILE-CONTROL.                                                           
001400     SELECT DS-EXTRACT-FILE ASSIGN TO INP01.                              
001500     SELECT DC-EXTRACT-FILE ASSIGN TO INP02.                              
001600     SELECT DS-REPORT-FILE  ASSIGN TO RPT01.                              
001700     SELECT DC-REPORT-FILE  ASSIGN TO RPT02.                              
001800                                                                          
001900  DATA DIVISION.                                                          
002000  FILE SECTION.                                                           
002100                                                                          
002200 FD  DS-EXTRACT-FILE                                                      
002300     RECORDING MODE IS F                                                  
002400     RECORD CONTAINS 300 CHARACTERS                                       
002500     BLOCK  CONTAINS 0 RECORDS                                            
002600     LABEL RECORDS ARE STANDARD.                                          
002700 01  DS-EXTRACT-REC                   PIC X(300).                         
002800                                                                          
002900 FD  DC-EXTRACT-FILE                                                      
003000     RECORDING MODE IS F                                                  
003100     RECORD CONTAINS 300 CHARACTERS                                       
003200     BLOCK  CONTAINS 0 RECORDS                                            
003300     LABEL RECORDS ARE STANDARD.                                          
003400 01  DS-EXTRACT-REC                   PIC X(300).                         
003500                                                                          
003600 FD  DS-REPORT-FILE                                                       
003700     RECORDING MODE IS F                                                  
003800     RECORD CONTAINS 132 CHARACTERS                                       
003900     BLOCK  CONTAINS 0 RECORDS                                            
004000     LABEL RECORDS ARE STANDARD.                                          
004100 01  DS-REPORT-REC.                                                       
004200     05  DS-REPORT-LINE               PIC X(132).                         
004300                                                                          
004400 FD  DC-REPORT-FILE                                                       
004500     RECORDING MODE IS F                                                  
004600     RECORD CONTAINS 132 CHARACTERS                                       
004700     BLOCK  CONTAINS 0 RECORDS                                            
004800     LABEL RECORDS ARE STANDARD.                                          
004900 01  DC-REPORT-REC.                                                       
005000     05  DC-REPORT-LINE               PIC X(132).                         
005100/                                                                         
005200 WORKING-STORAGE SECTION.                                                 
005300                                                                          
       01  TABLE-KEYS.                                                          
           05  DK-PO-NBR                    PIC S9(9) COMP.                     
           05  DK-REC-SEQ-NBR               PIC S9(9) COMP.                     
                                                                                
005400 01  PROGRAM-SWITCHES.                                                    
005500     05  PS-DC-EOF-SW                 PIC X(01) VALUE 'N'.                
005600         88  PS-DC-EOF                          VALUE 'Y'.                
005700     05  PS-DS-EOF-SW                 PIC X(01) VALUE 'N'.                
005800         88  PS-DS-EOF                          VALUE 'Y'.                
005700     05  PS-REPORT-SW                 PIC X(02) VALUE 'DS'.               
005800         88  PS-DS-REPORT                       VALUE 'DS'.               
005800         88  PS-DC-REPORT                       VALUE 'DC'.               
005900                                                                          
006000 01  PROGRAM-COUNTERS COMP-3.                                             
006100     05  PV-DC-EXTRACT-COUNT          PIC S9(07) VALUE ZERO.              
006200     05  PV-DS-EXTRACT-COUNT          PIC S9(07) VALUE ZERO.              
006300     05  PV-DC-ITEM-COUNT             PIC S9(07) VALUE ZERO.              
006400     05  PV-DS-ITEM-COUNT             PIC S9(07) VALUE ZERO.              
006500     05  PV-PAGE-CNTR                 PIC S9(05) VALUE ZERO.              
006600     05  PV-LINE-CNTR                 PIC S9(05) VALUE ZERO.              
006700                                                                          
006800 01  PROGRAM-WORK-AREAS.                                                  
006900     05  PV-TIMESTAMP                 PIC X(26).                          
007000     05  TIME-STRIPPER.                                                   
007100         10  PV-TIME-OUT.                                                 
007200             15  PV-TIME-HH           PIC 9(02) VALUE ZERO.               
007300             15  PV-TIME-MM           PIC 9(02) VALUE ZERO.               
007400             15  FILLER               PIC 9(02) VALUE ZERO.               
007500     05  PV-DATE-STRIPPER.                                                
007600         10  DATE-YY                  PIC 9(02) VALUE ZERO.               
007700         10  DATE-MM                  PIC 9(02) VALUE ZERO.               
007800         10  DATE-DD                  PIC 9(02) VALUE ZERO.               
007500     05  PV-STORE-NBR-DISP.                                               
007500         10  PV-STORE-NBR-N           PIC 9(04) VALUE ZERO.               
007900     05  ABEND-CODE                   PIC S9(04) COMP VALUE ZERO.         
008000     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.              
008100     05  PV-DB2-OPERATION-ATTEMPTED   PIC X(30) VALUE SPACE.              
008200 01  PV-HOLD-FIELDS.                                                      
008300     05  PV-HOLD-VENDOR-NAME          PIC X(25) VALUE SPACES.             
008500     05  PV-HOLD-SRC-CDE              PIC X(01) VALUE SPACES.             
008600     05  PV-HOLD-OPER-UNT-ID          PIC S9(4) COMP VALUE ZERO.          
008700     05  PV-HOLD-FCLTY-ID             PIC S9(4) COMP VALUE ZERO.          
008400     05  PV-HOLD-PO                   PIC S9(9) COMP VALUE ZERO.          
008400     05  PV-HOLD-REC-SEQ-NBR          PIC S9(9) COMP VALUE ZERO.          
008800     05  PV-HEAD-OPER-UNT-ID          PIC S9(4) COMP VALUE ZERO.          
008900     05  PV-HEAD-FCLTY-ID             PIC S9(4) COMP VALUE ZERO.          
009000 01  PV-HOLD-DC-REC                   PIC X(300).                         
009100 01  PV-HOLD-DS-REC                   PIC X(300).                         
009200                                                                          
009300******************************************************************        
009400*    R E P O R T   H E A D I N G   L I N E S                     *        
009500******************************************************************        
009600     COPY DPWS132O.                                                       
009700                                                                          
009800 01  REPORT-HDR2.                                                         
009900     05  FILLER                    PIC X(02)  VALUE SPACES.               
010000     05  FILLER                    PIC X(15)  VALUE                       
010100     '        REGION '.                                                   
010200     05  FILLER                    PIC X(03)  VALUE SPACES.               
010300     05  HDR2-DIVISION             PIC X(02).                             
010400     05  FILLER                    PIC X(14)  VALUE SPACES.               
010500     05  FILLER                    PIC X(25)  VALUE                       
010600     'M E R C H A N D I S I N G'.                                         
010700     05  FILLER                    PIC X(34)  VALUE                       
010800     '  P R O C E S S I N G  S Y S T E M'.                                
010900     05  FILLER                    PIC X(25)  VALUE SPACES.               
011000     05  FILLER                    PIC X(04)  VALUE SPACES.               
011100     05  FILLER                    PIC X      VALUE SPACES.               
011200     05  FILLER                    PIC X(07)  VALUE SPACES.               
011300                                                                          
011400 01  REPORT-HDR3.                                                         
011500     05  FILLER                    PIC X(48)  VALUE SPACES.               
011600     05  FILLER                    PIC X(21)  VALUE                       
011700        'RECEIVING LOCATION - '.                                          
011800     05  HDR3-REC-LOC              PIC X(25)  VALUE SPACES.               
011900     05  FILLER                    PIC X(38)  VALUE SPACES.               
012000                                                                          
012100 01  REPORT-HDR4.                                                         
012200     05  FILLER                    PIC X(18)  VALUE SPACES.               
012300     05  FILLER                    PIC X(27)  VALUE                       
012400     '   PAPERWORK MANIFEST  FOR '.                                       
012500     05  HDR4-MONTH                   PIC 99.                             
012600     05  FILLER                       PIC X      VALUE '/'.               
012700     05  HDR4-DAY                     PIC 99.                             
012800     05  FILLER                       PIC X      VALUE '/'.               
012900     05  HDR4-YEAR                    PIC 99.                             
013000     05  FILLER                       PIC X(79)  VALUE SPACES.            
013100                                                                          
013200 01  REPORT-HDR5.                                                         
013300     05  FILLER                    PIC X(60)  VALUE SPACES.               
013400     05  HDR5-STORE-TXT            PIC X(05)  VALUE 'STORE'.              
013500     05  FILLER                    PIC X(06)  VALUE SPACES.               
013600     05  FILLER                    PIC X(04)  VALUE 'SHIP'.               
013700     05  FILLER                    PIC X(06)  VALUE SPACES.               
013800     05  FILLER                    PIC X(04)  VALUE 'DATE'.               
013900     05  FILLER                    PIC X(08)  VALUE SPACES.               
014000     05  FILLER                    PIC X(04)  VALUE 'DATE'.               
           05  FILLER                    PIC X(14)  VALUE                       
                                                     '       CREATE '.          
014100     05  FILLER                    PIC X(04)  VALUE SPACES.               
014200     05  FILLER                    PIC X(09)  VALUE 'RECEIVED '.          
014300     05  FILLER                    PIC X(11)  VALUE SPACES.               
014400                                                                          
014500 01  REPORT-HDR6.                                                         
014600     05  FILLER                    PIC X(11)  VALUE SPACES.               
014700     05  FILLER                    PIC X(11)  VALUE 'VENDOR NAME'.        
014800     05  FILLER                    PIC X(22)  VALUE SPACES.               
014900     05  FILLER                    PIC X(04)  VALUE 'P.O.'.               
015000     05  FILLER                    PIC X(12)  VALUE SPACES.               
015100     05  HDR6-NUMBER-TXT           PIC X(06)  VALUE 'NUMBER'.             
015200     05  FILLER                    PIC X(05)  VALUE SPACES.               
015300     05  FILLER                    PIC X(04)  VALUE 'TYPE'.               
015400     05  FILLER                    PIC X(04)  VALUE SPACES.               
015500     05  FILLER                    PIC X(08)  VALUE 'RECEIVED'.           
015600     05  FILLER                    PIC X(06)  VALUE SPACES.               
015700     05  FILLER                    PIC X(04)  VALUE 'SENT'.               
           05  FILLER                    PIC X(14)  VALUE                       
                                                     '      USER ID '.          
015800     05  FILLER                    PIC X(04)  VALUE SPACES.               
015900     05  FILLER                    PIC X(09)  VALUE 'BY AP    '.          
016000     05  FILLER                    PIC X(11)  VALUE SPACES.               
016100                                                                          
016200 01  REPORT-UNDERLINE.                                                    
016300     05  FILLER                    PIC X(11)  VALUE SPACES.               
016400     05  FILLER                    PIC X(11)  VALUE '-----------'.        
016500     05  FILLER                    PIC X(13)  VALUE SPACES.               
016600     05  FILLER                    PIC X(05)  VALUE SPACES.               
016700     05  FILLER                    PIC X(13)  VALUE                       
016800                                              '-------------'.            
016900     05  FILLER                    PIC X(06)  VALUE SPACES.               
017000     05  RU-STORE-NBR-UNDERLINE    PIC X(08)  VALUE '--------'.           
017100     05  FILLER                    PIC X(04)  VALUE SPACES.               
017200     05  FILLER                    PIC X(04)  VALUE '----'.               
017300     05  FILLER                    PIC X(04)  VALUE SPACES.               
017400     05  FILLER                    PIC X(08)  VALUE '--------'.           
017500     05  FILLER                    PIC X(04)  VALUE SPACES.               
017600     05  FILLER                    PIC X(08)  VALUE '--------'.           
017700     05  FILLER                    PIC X(04)  VALUE SPACES.               
017800     05  FILLER                    PIC X(08)  VALUE '--------'.           
017700     05  FILLER                    PIC X(04)  VALUE SPACES.               
017800     05  FILLER                    PIC X(09)  VALUE '---------'.          
017900     05  FILLER                    PIC X(11)  VALUE SPACES.               
018000/                                                                         
018100 01  PV-DETAIL-LINE.                                                      
018200     05  FILLER                    PIC X(11)  VALUE SPACES.               
018300     05  D-VENDOR-NAME             PIC X(25)  VALUE SPACES.               
018400     05  FILLER                    PIC X(04)  VALUE SPACES.               
018500     05  D-PO-NBR                  PIC 9(08)  VALUE ZERO.                 
018600     05  D-RCVR-DASH               PIC X(01)  VALUE '-'.                  
018700     05  D-RCVR-SEQ-NBR            PIC 9(04)  VALUE ZERO.                 
018800     05  FILLER                    PIC X(02)  VALUE SPACES.               
018900     05  D-ADJ-LIT                 PIC X(03)  VALUE SPACE.                
019000     05  FILLER                    PIC X(03)  VALUE SPACES.               
019100     05  D-STORE-NBR               PIC X(04)  VALUE SPACES.               
019200     05  FILLER                    PIC X(06)  VALUE SPACES.               
019300     05  D-TYPE                    PIC X(06)  VALUE ZERO.                 
019400     05  FILLER                    PIC X(02)  VALUE SPACES.               
019500     05  D-RECD-DATE.                                                     
019600         10 D-RECD-MM              PIC 99     VALUE ZERO.                 
019700         10 D-SLASH-1              PIC X      VALUE '/'.                  
019800         10 D-RECD-DD              PIC 99     VALUE ZERO.                 
019900         10 D-SLASH-2              PIC X      VALUE '/'.                  
020000         10 D-RECD-YY              PIC 99     VALUE ZERO.                 
020100     05  FILLER                    PIC X(04)  VALUE SPACES.               
020200     05  D-SENT-DATE.                                                     
020300         10 D-SENT-MM              PIC 99     VALUE ZERO.                 
020400         10 D-SLASH-3              PIC X      VALUE '/'.                  
020500         10 D-SENT-DD              PIC 99     VALUE ZERO.                 
020600         10 D-SLASH-4              PIC X      VALUE '/'.                  
020700         10 D-SENT-YY              PIC 99     VALUE ZERO.                 
           05  FILLER                    PIC X(04)  VALUE SPACES.               
           05  D-CREATE-USERID           PIC X(08).                             
020800     05  FILLER                    PIC X(24)  VALUE SPACES.               
020900/                                                                         
021000 01  TOTAL-LINES.                                                         
021100     05 TOTAL-HDR.                                                        
021200         10 FILLER                    PIC X(27)  VALUE SPACES.            
021300         10 FILLER                    PIC X(21)  VALUE                    
021400         'TOTAL RECORDS READ = '.                                         
021500         10 G-TOT-RECORDS             PIC ZZZZZZ9.                        
021600         10 FILLER                    PIC X(77)  VALUE SPACES.            
021700     05 END-OF-REPORT.                                                    
021800         10 FILLER                    PIC X(49)  VALUE SPACES.            
021900         10 FILLER                    PIC X(21)  VALUE                    
022000         '*** END OF REPORT ***'.                                         
022100         10 FILLER                    PIC X(62)  VALUE SPACES.            
022200                                                                          
022300     05 HDR-SPACE                     PIC X(132) VALUE SPACES.            
022400                                                                          
022500 01  PR-PRINT-NO-DETAIL.                                                  
022600     05  FILLER                      PIC X(53)  VALUE SPACES.             
022700     05  FILLER                      PIC X(29)  VALUE                     
022800         '*** NO DETAILS TO REPORT ***'.                                  
022900                                                                          
023000 SKIP3                                                                    
023100 01  PT-LOCATIONS-TABLE.                                                  
023200     05  PT-LOCATIONS OCCURS 50 TIMES INDEXED BY LOC-IDX.                 
023300         10  PT-OPER-UNT-ID  PIC S9(4) COMP.                              
023400         10  PT-FCLTY-ID     PIC S9(4) COMP.                              
023500         10  PT-LOCATION     PIC X(25).                                   
023600/                                                                         
023700     COPY STOREEXT.                                                       
023800/                                                                         
023900*    LOCATION MODULE                                                      
024000     COPY XLWS071.                                                        
024100/                                                                         
024200     EXEC SQL                                                             
024300         INCLUDE SQLCA                                                    
024400     END-EXEC.                                                            
048700******************************************************************        
048800*  COBOL DELCARATION FOR THE RECEIPTS TABLE                               
048900******************************************************************        
049000     EXEC SQL                                                             
049100          INCLUDE TRECEIV                                                 
049200     END-EXEC.                                                            
024500                                                                          
024600     COPY SQLCA2.                                                         
024700                                                                          
024800     COPY DPWS004.                                                        
024900/                                                                         
025000 PROCEDURE DIVISION.                                                      
025100                                                                          
025200     PERFORM 1000-INITIALIZATION.                                         
025300                                                                          
025400     MOVE PV-HOLD-DS-REC              TO STORE-EXTRACT-LINE               
026600     SET  PS-DS-REPORT                TO TRUE.                            
025500     PERFORM 2000-DS-REPORT UNTIL PS-DS-EOF.                              
025600                                                                          
025700*    IF PV-DS-EXTRACT-COUNT > ZERO                                        
025800*        ADD +1                       TO PV-DS-ITEM-COUNT                 
025900*        PERFORM 5000-MOVE-TO-PRINTLINE                                   
026000*        WRITE DS-REPORT-REC FROM PV-DETAIL-LINE                          
026100*                          AFTER ADVANCING 1                              
026200*    END-IF.                                                              
026300                                                                          
026400     MOVE +1                          TO PV-PAGE-CNTR.                    
026500     MOVE ZERO                        TO PV-LINE-CNTR.                    
026600     MOVE PV-HOLD-DC-REC              TO STORE-EXTRACT-LINE.              
026600     SET  PS-DC-REPORT                TO TRUE.                            
026700                                                                          
026800     PERFORM 3000-DC-REPORT UNTIL PS-DC-EOF.                              
026900                                                                          
027000*    IF PV-DC-EXTRACT-COUNT > ZERO                                        
027100*        ADD +1                       TO PV-DC-ITEM-COUNT                 
027200*        PERFORM 5000-MOVE-TO-PRINTLINE                                   
027300*        WRITE DS-REPORT-REC FROM PV-DETAIL-LINE                          
027400*                          AFTER ADVANCING 1                              
027500*    END-IF.                                                              
027600                                                                          
027700     PERFORM 9000-EOJ.                                                    
027800                                                                          
027900     GOBACK.                                                              
028000/                                                                         
028100 1000-INITIALIZATION.                                                     
028200     EXEC SQL SET :PV-TIMESTAMP = CURRENT TIMESTAMP END-EXEC.             
028300     OPEN INPUT  DC-EXTRACT-FILE                                          
028400                 DS-EXTRACT-FILE                                          
028500     OPEN OUTPUT DC-REPORT-FILE                                           
028600                 DS-REPORT-FILE.                                          
028700     PERFORM 8000-READ-DS-EXTRACT.                                        
028800     MOVE STORE-EXTRACT-LINE          TO PV-HOLD-DS-REC                   
028900                                                                          
029000     PERFORM 8100-READ-DC-EXTRACT.                                        
029100     MOVE STORE-EXTRACT-LINE          TO PV-HOLD-DC-REC                   
029200                                                                          
029300     ACCEPT PV-DATE-STRIPPER FROM DATE.                                   
029400     ACCEPT PV-TIME-OUT FROM TIME.                                        
029500     MOVE DATE-DD                     TO DP132O-RUN-DAY                   
029600                                         HDR4-DAY.                        
029700     MOVE DATE-MM                     TO DP132O-RUN-MONTH                 
029800                                         HDR4-MONTH.                      
029900     MOVE DATE-YY                     TO DP132O-RUN-YEAR                  
030000                                         HDR4-YEAR.                       
030100     MOVE PV-TIME-HH                  TO DP132O-RUN-HOUR.                 
030200     MOVE PV-TIME-MM                  TO DP132O-RUN-MINUTE.               
030300     MOVE '03'                        TO HDR2-DIVISION.                   
030400     MOVE 'RCKRP016'                  TO DP132O-PROGRAM-NAME.             
030500                                                                          
030600     MOVE 1                           TO DP132O-REPORT-NUMBER.            
030700     PERFORM 2100-DS-HEADERS                                              
030800     IF PS-DS-EOF                                                         
030900         WRITE DS-REPORT-REC FROM PR-PRINT-NO-DETAIL                      
031000               AFTER ADVANCING 2                                          
031100     END-IF.                                                              
031200                                                                          
031300         MOVE SE-OPER-UNT-ID          TO PV-HOLD-OPER-UNT-ID              
031400         MOVE SE-FCLTY-ID             TO PV-HOLD-FCLTY-ID                 
031500     INITIALIZE PT-LOCATIONS-TABLE.                                       
031600     MOVE 2                           TO DP132O-REPORT-NUMBER.            
031700     MOVE SE-OPER-UNT-ID              TO PV-HEAD-OPER-UNT-ID.             
031800     MOVE SE-FCLTY-ID                 TO PV-HEAD-FCLTY-ID.                
031900     MOVE ZERO                        TO PV-PAGE-CNTR.                    
032000     PERFORM 3100-DC-HEADERS                                              
032100     IF PS-DC-EOF                                                         
032200         WRITE DS-REPORT-REC FROM PR-PRINT-NO-DETAIL                      
032300               AFTER ADVANCING 2                                          
032400     END-IF.                                                              
032500                                                                          
032600/                                                                         
032700 2000-DS-REPORT.                                                          
032800                                                                          
032900     IF  SE-PO          = PV-HOLD-PO                                      
032900     AND SE-REC-SEQ-NBR = PV-HOLD-REC-SEQ-NBR                             
033000         NEXT SENTENCE                                                    
033100*        IF SE-REC-SRC-CDE = 'A'                                          
033200*            MOVE 'ADJ'               TO D-ADJ-LIT                        
033300*            ADD +1                   TO PV-LINE-CNTR                     
033400*                                                                         
033500*            IF PV-LINE-CNTR > 50                                         
033600*                PERFORM 2100-DS-HEADERS                                  
033700*            END-IF                                                       
033800*                                                                         
033900*            ADD +1                   TO PV-DS-ITEM-COUNT                 
034000*            PERFORM 5000-MOVE-TO-PRINTLINE                               
034100*            WRITE DS-REPORT-REC FROM PV-DETAIL-LINE                      
034200*                      AFTER ADVANCING 1                                  
034300*        END-IF                                                           
034400     ELSE                                                                 
034500         MOVE SE-PO                   TO PV-HOLD-PO                       
034500         MOVE SE-REC-SEQ-NBR          TO PV-HOLD-REC-SEQ-NBR              
034600         IF SE-REC-SRC-CDE = 'A'                                          
034700             MOVE 'ADJ'               TO  D-ADJ-LIT                       
034800         ELSE                                                             
034900             MOVE '   '               TO  D-ADJ-LIT                       
035000         END-IF                                                           
035100         ADD +1                       TO PV-LINE-CNTR                     
035200         IF PV-LINE-CNTR > 50                                             
035300             PERFORM 2100-DS-HEADERS                                      
035400         END-IF                                                           
035500         ADD +1                       TO PV-DS-ITEM-COUNT                 
035500         PERFORM 5000-MOVE-TO-PRINTLINE                                   
035700         WRITE DS-REPORT-REC FROM PV-DETAIL-LINE                          
035800               AFTER ADVANCING 1                                          
035900     END-IF.                                                              
036000                                                                          
036100     PERFORM 8000-READ-DS-EXTRACT.                                        
036200                                                                          
036300                                                                          
036400 2100-DS-HEADERS.                                                         
036500                                                                          
036600     ADD 1                            TO PV-PAGE-CNTR.                    
036700     MOVE PV-PAGE-CNTR                TO DP132O-PAGE-NUMBER.              
036800     MOVE 1                           TO DP132O-REPORT-NUMBER.            
036900     WRITE DS-REPORT-REC                                                  
037000         FROM DP132O-STANDRD-HEADER-132-COLS                              
037100         AFTER ADVANCING PAGE.                                            
037200                                                                          
037300     WRITE DS-REPORT-REC FROM REPORT-HDR2 AFTER ADVANCING 2.              
037400                                                                          
037500     MOVE 'DIRECT SHIPMENT'           TO HDR3-REC-LOC                     
047400     MOVE 'STORE'                     TO HDR5-STORE-TXT.                  
047400     MOVE 'NUMBER'                    TO HDR6-NUMBER-TXT.                 
047400     MOVE '--------'                  TO RU-STORE-NBR-UNDERLINE.          
037600     WRITE DS-REPORT-REC FROM REPORT-HDR3 AFTER ADVANCING 1.              
037700     WRITE DS-REPORT-REC FROM REPORT-HDR4 AFTER ADVANCING 2.              
037800     WRITE DS-REPORT-REC FROM REPORT-HDR5 AFTER ADVANCING 2.              
037900     WRITE DS-REPORT-REC FROM REPORT-HDR6 AFTER ADVANCING 1.              
038000     WRITE DS-REPORT-REC FROM REPORT-UNDERLINE AFTER ADVANCING 1.         
038100     WRITE DS-REPORT-REC FROM HDR-SPACE AFTER ADVANCING 1.                
038200                                                                          
038300     MOVE ZERO                        TO PV-LINE-CNTR.                    
038400     MOVE SPACES                      TO PV-HOLD-VENDOR-NAME.             
038500/                                                                         
038600 3000-DC-REPORT.                                                          
038700     EVALUATE TRUE                                                        
038800     WHEN SE-REC-SRC-CDE = 'A'                                            
038900         CONTINUE                                                         
039000     WHEN SE-OPER-UNT-ID = PV-HOLD-OPER-UNT-ID                            
039100          AND SE-FCLTY-ID = PV-HOLD-FCLTY-ID                              
039200          AND SE-PO = PV-HOLD-PO                                          
039200          AND SE-REC-SEQ-NBR = PV-HOLD-REC-SEQ-NBR                        
039300         CONTINUE                                                         
039400     WHEN SE-OPER-UNT-ID NOT = PV-HOLD-OPER-UNT-ID                        
039500            OR SE-FCLTY-ID NOT = PV-HOLD-FCLTY-ID                         
039600         PERFORM 3200-DC-BREAK                                            
039700         MOVE SE-OPER-UNT-ID          TO PV-HEAD-OPER-UNT-ID              
039800         MOVE SE-FCLTY-ID             TO PV-HEAD-FCLTY-ID                 
039900         MOVE ZERO                    TO PV-PAGE-CNTR                     
040000         PERFORM 3100-DC-HEADERS                                          
040100         MOVE SE-OPER-UNT-ID          TO PV-HOLD-OPER-UNT-ID              
040200         MOVE SE-FCLTY-ID             TO PV-HOLD-FCLTY-ID                 
040300         MOVE SE-PO                   TO PV-HOLD-PO                       
040300         MOVE SE-REC-SEQ-NBR          TO PV-HOLD-REC-SEQ-NBR              
040400         ADD +1                       TO PV-LINE-CNTR                     
040500         ADD +1                       TO PV-DC-ITEM-COUNT                 
040600         PERFORM 5000-MOVE-TO-PRINTLINE                                   
040700         WRITE DC-REPORT-REC FROM PV-DETAIL-LINE                          
040800                       AFTER ADVANCING 1                                  
039200     WHEN SE-PO NOT = PV-HOLD-PO                                          
039200            OR SE-REC-SEQ-NBR NOT = PV-HOLD-REC-SEQ-NBR                   
040300         MOVE SE-PO                   TO PV-HOLD-PO                       
040300         MOVE SE-REC-SEQ-NBR          TO PV-HOLD-REC-SEQ-NBR              
041100         ADD +1                       TO PV-LINE-CNTR                     
041200                                                                          
041300         IF PV-LINE-CNTR > 50                                             
041400             MOVE SE-OPER-UNT-ID      TO PV-HEAD-OPER-UNT-ID              
041500             MOVE SE-FCLTY-ID         TO PV-HEAD-FCLTY-ID                 
041600             PERFORM 3100-DC-HEADERS                                      
041700         END-IF                                                           
041800                                                                          
041900         ADD +1                       TO PV-DC-ITEM-COUNT                 
042000         PERFORM 5000-MOVE-TO-PRINTLINE                                   
042100         WRITE DC-REPORT-REC FROM PV-DETAIL-LINE                          
042200                   AFTER ADVANCING 1                                      
042300     END-EVALUATE.                                                        
042400                                                                          
042500     PERFORM 8100-READ-DC-EXTRACT.                                        
042600                                                                          
042700 3100-DC-HEADERS.                                                         
042800                                                                          
042900     ADD 1                            TO PV-PAGE-CNTR.                    
043000     MOVE PV-PAGE-CNTR                TO DP132O-PAGE-NUMBER.              
043100     MOVE 2                           TO DP132O-REPORT-NUMBER.            
043200     WRITE DC-REPORT-REC                                                  
043300         FROM DP132O-STANDRD-HEADER-132-COLS                              
043400         AFTER ADVANCING PAGE.                                            
043500                                                                          
043600     WRITE DC-REPORT-REC FROM REPORT-HDR2 AFTER ADVANCING 2.              
043700                                                                          
043800     IF PV-DC-EXTRACT-COUNT = ZERO                                        
043900         MOVE SPACES                  TO HDR3-REC-LOC                     
044000     ELSE                                                                 
044100         SET LOC-IDX TO 1                                                 
044200         SEARCH PT-LOCATIONS                                              
044300         AT END                                                           
044400             DISPLAY SPACES                                               
044500             DISPLAY 'LOCATION TABLE OVERFLOW'                            
044600             DISPLAY 'PARAGRAPH 3100-DC-HEADERS'                          
044700             DISPLAY SPACES                                               
044800             CLOSE DC-EXTRACT-FILE                                        
044900                   DS-EXTRACT-FILE                                        
045000                   DC-REPORT-FILE                                         
045100                   DS-REPORT-FILE                                         
045200             MOVE +4004 TO ABEND-CODE                                     
045300             CALL 'ILBOABN0' USING ABEND-CODE                             
045400         WHEN PT-OPER-UNT-ID(LOC-IDX) = ZERO                              
045500             MOVE SE-OPER-UNT-ID      TO PT-OPER-UNT-ID(LOC-IDX)          
045600             MOVE SE-FCLTY-ID         TO PT-FCLTY-ID(LOC-IDX)             
045700             PERFORM 7000-GET-LOC-NAME                                    
045800             IF XL071-NO-ERRORS                                           
045900                 MOVE XL071-LOC-NM    TO PT-LOCATION(LOC-IDX)           07
046000                                          HDR3-REC-LOC                  07
046100             ELSE                                                       07
046200                 MOVE 'UNKNOWN'       TO PT-LOCATION(LOC-IDX)           07
046300                                         HDR3-REC-LOC                   07
046400             END-IF                                                     07
046500                                                                          
046600         WHEN PT-OPER-UNT-ID(LOC-IDX) = PV-HEAD-OPER-UNT-ID               
046700          AND PT-FCLTY-ID(LOC-IDX)    = PV-HEAD-FCLTY-ID                  
046800             MOVE PT-LOCATION(LOC-IDX)                                    
046900                                      TO HDR3-REC-LOC                     
047000         END-SEARCH                                                       
047100     END-IF.                                                              
047200                                                                          
047300     WRITE DC-REPORT-REC FROM REPORT-HDR3 AFTER ADVANCING 1.              
047400                                                                          
047400     MOVE SPACES                      TO HDR5-STORE-TXT                   
047400                                         HDR6-NUMBER-TXT                  
047400                                         RU-STORE-NBR-UNDERLINE.          
047400                                                                          
047400                                                                          
047500     WRITE DC-REPORT-REC FROM REPORT-HDR4 AFTER ADVANCING 2.              
047600     WRITE DC-REPORT-REC FROM REPORT-HDR5 AFTER ADVANCING 2.              
047700     WRITE DC-REPORT-REC FROM REPORT-HDR6 AFTER ADVANCING 1.              
047800     WRITE DC-REPORT-REC FROM REPORT-UNDERLINE AFTER ADVANCING 1.         
047900     WRITE DC-REPORT-REC FROM HDR-SPACE AFTER ADVANCING 1.                
048000                                                                          
048100     MOVE ZERO                        TO PV-LINE-CNTR.                    
048200     MOVE SPACES                      TO PV-HOLD-VENDOR-NAME.             
048300/                                                                         
048400                                                                          
048500 3200-DC-BREAK.                                                           
048600                                                                          
048700     IF PV-LINE-CNTR > 50                                                 
048800         MOVE PV-HOLD-OPER-UNT-ID     TO PV-HEAD-OPER-UNT-ID              
048900         MOVE PV-HOLD-FCLTY-ID        TO PV-HEAD-FCLTY-ID                 
049000         PERFORM 3100-DC-HEADERS                                          
049100     END-IF.                                                              
049200                                                                          
049300     MOVE PV-DC-ITEM-COUNT            TO G-TOT-RECORDS                    
049400     WRITE DC-REPORT-REC FROM TOTAL-HDR AFTER ADVANCING 3.                
049500     WRITE DC-REPORT-REC FROM END-OF-REPORT AFTER ADVANCING 2.            
049600                                                                          
049700     MOVE ZERO TO PV-DC-ITEM-COUNT.                                       
049800                                                                          
049900 5000-MOVE-TO-PRINTLINE.                                                  
050000                                                                          
050100     MOVE SE-DR-MM                    TO D-RECD-MM.                       
050200     MOVE '/'                         TO D-SLASH-1.                       
050300     MOVE SE-DR-DD                    TO D-RECD-DD.                       
050400     MOVE '/'                         TO D-SLASH-2.                       
050500     MOVE SE-DR-YY                    TO D-RECD-YY.                       
050600     MOVE SE-PROCESSING-AREA          TO D-TYPE.                          
050700     MOVE SE-DV-MM                    TO D-SENT-MM.                       
050800     MOVE '/'                         TO D-SLASH-3.                       
050900     MOVE SE-DV-DD                    TO D-SENT-DD.                       
051000     MOVE '/'                         TO D-SLASH-4.                       
051100     MOVE SE-DV-YY                    TO D-SENT-YY.                       
051200                                                                          
051300     MOVE SE-VENDOR-NAME-INHOUSE      TO D-VENDOR-NAME.                   
051400                                                                          
051500     IF D-VENDOR-NAME = PV-HOLD-VENDOR-NAME                               
051600         MOVE SPACES                  TO D-VENDOR-NAME                    
051700     ELSE                                                                 
051800         MOVE D-VENDOR-NAME TO PV-HOLD-VENDOR-NAME                        
051900     END-IF.                                                              
052000                                                                          
052200     MOVE SE-PO                       TO D-PO-NBR.                        
052300     MOVE '-'                         TO D-RCVR-DASH.                     
052400     MOVE SE-REC-SEQ-NBR              TO D-RCVR-SEQ-NBR.                  
           PERFORM 5010-CRE-UID.                                                
052000                                                                          
052000** WE ONLY WANT TO DISPLAY STORE NUMBER ON THE DIRECT SHIPMENT            
052000** COPY OF THE REPORT.  THE STORE NUMBER COLUMN SHOULD BE SPACES          
052000** ON THE DC SHIPMENT COPY OF THE REPORT.                                 
052400     IF  PS-DC-REPORT                                                     
052400         MOVE SPACES                  TO D-STORE-NBR                      
052400     ELSE                                                                 
052400         MOVE RECEIV-OPER-UNT-ID      TO PV-STORE-NBR-N                   
052400         MOVE PV-STORE-NBR-DISP       TO D-STORE-NBR                      
052400     END-IF.                                                              
052500/                                                                         
       5010-CRE-UID.                                                            
           MOVE SE-PO             TO DK-PO-NBR                                  
           MOVE SE-REC-SEQ-NBR    TO DK-REC-SEQ-NBR                             
           EXEC SQL                                                             
               SELECT  CRE_UID                                                  
                    ,  OPER_UNT_ID                                              
                 INTO :RECEIV-CRE-UID                                           
                    , :RECEIV-OPER-UNT-ID                                       
                 FROM  TRECEIV                                                  
                WHERE  ORD_NBR     = :DK-PO-NBR                                 
                  AND  REC_SEQ_NBR = :DK-REC-SEQ-NBR                            
           END-EXEC.                                                            
           IF SQLCODE = 0                                                       
               MOVE RECEIV-CRE-UID TO D-CREATE-USERID                           
           ELSE                                                                 
               MOVE SPACES         TO D-CREATE-USERID                           
           END-IF.                                                              
                                                                                
052600 7000-GET-LOC-NAME.                                                       
052700                                                                          
052800     INITIALIZE XL071-COMMAREA-REC.                                       
052900     MOVE SE-OPER-UNT-ID       TO XL071-LOCATION-NUMBER                   
053000                                                                          
053100     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.                 
053200                                                                          
053300     EVALUATE TRUE                                                        
053400     WHEN XL071-NO-ERRORS                                                 
053500     WHEN XL071-LOC-NOT-FOUND                                             
053600     WHEN XL071-DC-ASGMT-NOT-FND                                          
053700         CONTINUE                                                         
053800     WHEN XL071-BAD-DB2-RETURN                                            
053900         MOVE XL071-SQLCA             TO SQLCA                            
054000         MOVE '7000-GET-LOC-NAME'     TO PV-PARAGRAPH-NAME                
054100         MOVE 'CALL XLKUT071 LOCATION MODULE'                             
054200                                     TO PV-DB2-OPERATION-ATTEMPTED        
054300         PERFORM 9800-SQL-ABEND                                           
054400     END-EVALUATE.                                                        
054500/                                                                         
054600 8000-READ-DS-EXTRACT.                                                    
054700     READ DS-EXTRACT-FILE                                                 
054800         INTO STORE-EXTRACT-LINE                                          
054900     AT END                                                               
055000         SET PS-DS-EOF                TO TRUE                             
055100     NOT AT END                                                           
055200         ADD 1                        TO PV-DS-EXTRACT-COUNT              
055300     END-READ.                                                            
055400                                                                          
055500 8100-READ-DC-EXTRACT.                                                    
055600     READ DC-EXTRACT-FILE                                                 
055700         INTO STORE-EXTRACT-LINE                                          
055800     AT END                                                               
055900         SET PS-DC-EOF                TO TRUE                             
056000     NOT AT END                                                           
056100         ADD 1                        TO PV-DC-EXTRACT-COUNT              
056200     END-READ.                                                            
056300/                                                                         
056400 9000-EOJ.                                                                
056500                                                                          
056600*    ADD +1                           TO PV-DS-ITEM-COUNT                 
056700*    PERFORM 5000-MOVE-TO-PRINTLINE                                       
056800*    WRITE DC-REPORT-REC FROM PV-DETAIL-LINE                              
056900*                      AFTER ADVANCING 1                                  
057000                                                                          
057100     MOVE PV-DS-ITEM-COUNT            TO G-TOT-RECORDS                    
057200     WRITE DS-REPORT-REC FROM TOTAL-HDR AFTER ADVANCING 3.                
057300     WRITE DS-REPORT-REC FROM END-OF-REPORT AFTER ADVANCING 2.            
057400                                                                          
057500     MOVE PV-DC-ITEM-COUNT            TO G-TOT-RECORDS                    
057600     WRITE DC-REPORT-REC FROM TOTAL-HDR AFTER ADVANCING 3.                
057700     WRITE DC-REPORT-REC FROM END-OF-REPORT AFTER ADVANCING 2.            
057800                                                                          
057900     CLOSE       DC-EXTRACT-FILE                                          
058000                 DS-EXTRACT-FILE                                          
058100                 DC-REPORT-FILE                                           
058200                 DS-REPORT-FILE.                                          
058300 9800-SQL-ABEND.                                                          
058400     DISPLAY '** ABEND     **'.                                           
058500     DISPLAY '** PROGRAM   ** = RCKRP016'.                                
058600     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
058700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
058800                                                                          
058900******************************************************************        
059000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
059100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
059200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
059300* FORMAT.                                                                 
059400******************************************************************        
059500     COPY DPPD004.                                                        
059600                                                                          
059700     MOVE +4013                       TO ABEND-CODE.                      
059800     CALL 'ILBOABN0' USING ABEND-CODE.                                    
059900                                                                          
