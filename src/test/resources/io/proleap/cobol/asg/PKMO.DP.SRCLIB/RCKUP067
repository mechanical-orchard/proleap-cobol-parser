000505 IDENTIFICATION DIVISION.                                         00050501
000506 PROGRAM-ID.             RCKUP067.                                00050601
000507 AUTHOR.                 DENISE HAHN.                             00050720
000508 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050801
000509 DATE-WRITTEN.           SEPTEMBER 2018.                          00050901
000510 DATE-COMPILED.                                                   00051001
000520                                                                  00052001
000530*-----------------------------------------------------------------00053001
000540*                                                                 00054001
000541* THIS PROGRAM IS TO AUTOMATICALLY VERIFY EFC FREE ASTRAY RCVRS   00054101
000542* THAT ARE IN IP STATUS, AND THE TRAILER THEY ARE ATTACHED TO IS  00054201
000543* ALREADY AT (UN-UNLOADED, ET-END TRIP, DP-DEPARTED) STATUS       00054301
000544*                                                                 00054401
000545*-----------------------------------------------------------------00054501
000550                                                                  00055001
000560* GENERAL PROCESSING:                                             00056001
000570* -------------------                                             00057001
000600* 1) CURSOR TO SELECT ALL OF THE EFC FREE ASTRAY RECEIVER THAT ARE00060001
000700*    STILL IN IP STATUS AND THE TRAILER THEY ARE ATTACHED TO IS   00070001
000710*    IN (UN-UNLOADED, ET-END TRIP, DP-DEPARTED) STATUS            00071001
000800*                                                                 00080001
000900* 2) SET THE RECEIVER TO VERIFIED                                 00090001
001000*    - UPDATE TRECEIV                                             00100001
001001*    - UPDATE TRECITM                                             00100101
001010*    - UPDATE TRECDIS                                             00101001
001020*                                                                 00102001
001030* 3) WRITE ENTRY TO WFT_LOD_CNTL, WFT_LOD_XFER                    00103001
001200*                                                                 00120001
003900*                                                                 00390001
004000* 4) COMMIT AFTER EACH RECEIVER IS UPDATED                        00400001
004600*                                                                 00460001
004800*                                                              *  00480001
004900******************************************************************00490001
005000 ENVIRONMENT DIVISION.                                            00500001
005100******************************************************************00510001
005200 CONFIGURATION SECTION.                                           00520001
005300 SOURCE-COMPUTER.        IBM-3090.                                00530001
005400 OBJECT-COMPUTER.        IBM-3090.                                00540001
005500                                                                  00550001
005600 INPUT-OUTPUT SECTION.                                            00560001
005700 FILE-CONTROL.                                                    00570001
005800                                                                  00580001
005810     SELECT INPUT-FILE                                            00581015
005820            ASSIGN TO IN01.                                       00582015
005830                                                                  00583015
005900                                                                  00590015
006600     SELECT OUTPUT-FILE                                           00660001
006700            ASSIGN TO OUT01.                                      00670001
006800                                                                  00680001
006900******************************************************************00690001
007000 DATA DIVISION.                                                   00700001
007100******************************************************************00710001
007200 FILE SECTION.                                                    00720001
007300                                                                  00730001
007400 FD  INPUT-FILE                                                   00740001
007500     RECORDING MODE F                                             00750001
007600     BLOCK CONTAINS 0 RECORDS                                     00760001
007700     LABEL RECORDS ARE OMITTED.                                   00770001
007800 01  INPUT-RECORD                     PIC  X(200).                00780001
007900                                                                  00790001
009200 FD  OUTPUT-FILE                                                  00920001
009300     RECORDING MODE F                                             00930001
009400     BLOCK CONTAINS 0 RECORDS                                     00940001
009500     LABEL RECORDS ARE OMITTED.                                   00950001
009600 01  OUTPUT-RECORD                    PIC  X(200).                00960001
009610                                                                  00961001
009620******************************************************************00962001
009630 WORKING-STORAGE SECTION.                                         00963001
009640******************************************************************00964001
009800                                                                  00980001
018805                                                                  01880516
018806******************************************************************01880606
018807* INPUT LAYOUT                                                    01880716
018808******************************************************************01880806
018809     COPY RCRD100.                                                01880916
018811                                                                  01881116
018812******************************************************************01881216
018813* OUTPUT LAYOUT                                                   01881316
018814******************************************************************01881416
018815     COPY RCRD099.                                                01881516
018816                                                                  01881616
018817*----------------------------------------------------------------*01881713
018818*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     01881806
018819*----------------------------------------------------------------*01881913
018820     COPY DPWS004.                                                01882013
018900*                                                                 01890001
019000*                                                                 01900001
019100 01  PA-PROGRAM-ACCUMULATORS.                                     01910003
019110     05  PA-RCVR-COUNT                PIC  9(09) VALUE ZERO.      01911003
019120                                                                  01912003
021100*                                                                 02110001
022240 01  PS-PROGRAM-SWITCHES.                                         02224002
022250     05  PS-EOF-INPUT-SW             PIC X(01) VALUE 'N'.         02225015
022260         88  PS-EOF-INPUT                      VALUE 'Y'.         02226015
022270         88  PS-EOF-INPUT-NO                   VALUE 'N'.         02227015
022271     05  PS-END-OF-LINE-CSR-SW       PIC X(01) VALUE 'N'.         02227102
022272         88  PS-END-OF-LINE-CSR                VALUE 'Y'.         02227202
022273         88  PS-END-OF-LINE-CSR-NO             VALUE 'N'.         02227302
022274     05  PS-END-OF-STR-CSR-SW        PIC X(01) VALUE 'N'.         02227406
022275         88  PS-END-OF-STR-CSR                 VALUE 'Y'.         02227506
022276         88  PS-END-OF-STR-CSR-NO              VALUE 'N'.         02227606
022277     05  PS-STORE-INV-CYCLE-SW       PIC X(01) VALUE 'N'.         02227707
022278         88  PS-STORE-INV-CYCLE                VALUE 'Y'.         02227807
022279         88  PS-STORE-INV-CYCLE-NO             VALUE 'N'.         02227907
022280     05  PS-ERROR-SW                 PIC X(01) VALUE 'N'.         02228015
022281         88  PS-ERROR                          VALUE 'Y'.         02228115
022282         88  PS-ERROR-NO                       VALUE 'N'.         02228215
022283     05  PS-RCVR-VERIFIED-SW         PIC X(01) VALUE 'N'.         02228344
022284         88  PS-RCVR-VERIFIED                  VALUE 'Y'.         02228444
022285         88  PS-RCVR-VERIFIED-NO               VALUE 'N'.         02228544
022286                                                                  02228606
024550 01  PC-PROGRAM-CONSTANTS.                                        02455013
024560     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'RCKUP067'.  02456013
024580*                                                                 02458001
024590 01  DK-DB2-KEYS.                                                 02459005
024600     05  DK-OPER-UNIT-ID              PIC S9(04) COMP VALUE +0.   02460005
024610     05  DK-FCLTY-ID                  PIC S9(04) COMP VALUE +0.   02461013
024700     05  DK-ORD-NBR                   PIC S9(09) COMP VALUE +0.   02470013
024710     05  DK-RCVR-SEQ                  PIC S9(09) COMP VALUE +0.   02471005
024720     05  DK-LINE-NBR                  PIC S9(04) COMP VALUE +0.   02472013
024730     05  DK-STR-NBR                   PIC S9(04) COMP VALUE +0.   02473005
024731     05  DK-STR-FCLTY-ID              PIC S9(04) COMP VALUE +0.   02473113
024740                                                                  02474006
025300*                                                                 02530001
028000 01  PV-PROGRAM-VARIABLES.                                        02800005
028010     05  PV-CURRENT-TMST            PIC  X(26).                   02801057
028011     05  PV-DISP-PO                 PIC  9(09).                   02801157
028020     05  PV-DISP-REC-SEQ            PIC  9(04).                   02802015
028040     05  PV-DISP-LINE               PIC  9(04).                   02804018
028050     05  PV-DISP-STR                PIC  9(04).                   02805018
028060     05  PV-DISP-SQLCODE            PIC -9(09).                   02806005
028070     05  PV-PARAGRAPH               PIC  X(48) VALUE SPACES.      02807015
028071                                                                  02807115
028072     05  PV-DISP-OPER               PIC  9(04).                   02807227
028073     05  PV-DISP-FCLTY              PIC  9(04).                   02807327
028074     05  PV-DISP-ORD-NBR            PIC  9(09).                   02807427
028075     05  PV-DISP-RCVR               PIC  9(04).                   02807527
028078     05  PV-DISP-STR-FCLTY          PIC  9(04).                   02807827
028079     05  PV-DISP-EXPECTED           PIC -Z(09).                   02807927
028080     05  PV-DISP-VERIFY             PIC -Z(09).                   02808027
028081     05  PV-DISP-AP-VERIFY          PIC -Z(09).                   02808127
028087     05  PV-DISP-PKSL-QTY           PIC -Z(09).                   02808727
028088     05  PV-DISP-DTL-CK             PIC -Z(09).                   02808827
028089     05  PV-DISP-RCVR-EXPTD         PIC -Z(09).                   02808927
028090     05  PV-DISP-RCVR-ACTL          PIC -Z(09).                   02809027
028100     05  PV-DISP-LOD-XFER           PIC  X(125).                  02810030
028101                                                                  02810126
028102     05  PV-TOTAL-TRECEIV-UPDATES   PIC  9(09) VALUE ZEROES.      02810226
028103     05  PV-TOTAL-TRECITM-UPDATES   PIC  9(09) VALUE ZEROES.      02810326
028104     05  PV-TOTAL-TRECDIS-UPDATES   PIC  9(09) VALUE ZEROES.      02810426
028105     05  PV-TOTAL-WFT-CNTL-INSERTS  PIC  9(09) VALUE ZEROES.      02810526
028106     05  PV-TOTAL-WFT-XFER-INSERTS  PIC  9(09) VALUE ZEROES.      02810626
028107     05  PV-TOTAL-DB2-COMMITS       PIC  9(09) VALUE ZEROES.      02810726
028108     05  PV-INPUT-COUNT             PIC  9(09) VALUE ZEROES.      02810826
028110     05  PV-OUTPUT-COUNT            PIC  9(09) VALUE ZEROES.      02811026
028120     05  PV-TRECDIS-UPDATE-COUNT    PIC  9(09) VALUE ZEROES.      02812040
028130     05  PV-TRECITM-UPDATE-COUNT    PIC  9(09) VALUE ZEROES.      02813040
028140     05  PV-TRECEIV-UPDATE-COUNT    PIC  9(09) VALUE ZEROES.      02814040
028141     05  PV-RECEIV-UPD-REC-TMST     PIC  9(09) VALUE ZEROES.      02814158
028150     05  PV-WFT-CNTL-INSERTS        PIC  9(09) VALUE ZEROES.      02815040
028160     05  PV-WFT-XFER-INSERTS        PIC  9(09) VALUE ZEROES.      02816040
028170     05  PV-PREV-VE-COUNT           PIC  9(09) VALUE ZEROES.      02817045
028200                                                                  02820026
029300     05  PV-WORK-DATE-PLUS-7        PIC  X(10)  VALUE ZEROS.      02930013
030400*                                                                 03040001
030500     05  PV-EXPTED-ITM-QTY          PIC  S9(9) COMP.              03050014
030600     05  PV-VERIFY-ITM-QTY          PIC  S9(9) COMP.              03060014
030700     05  PV-AP-VERIFY-ITM-QTY       PIC  S9(9) COMP.              03070014
030710     05  PV-RCVR-CARTON-COUNT       PIC  S9(9) COMP.              03071051
030800*                                                                 03080001
032500*                                                                 03250001
032600     05  PV-RECEIPT-ADJUSTMENT-REC.                               03260022
032700         10  PV-HEADER-DATA.                                      03270022
032800             15  PV-ORDER-NUMBER               PIC 9(09).         03280022
032900             15  PV-RCVR-ID                    PIC 9(09).         03290022
033000             15  PV-DC                         PIC 9(04).         03300022
033100             15  PV-SKU                        PIC 9(08).         03310022
033200             15  PV-VRFY-DATE                  PIC X(14).         03320022
033300             15  PV-STORE-COUNT                PIC 9(04).         03330022
033400             15  FILLER                        PIC X(52).         03340022
033500         10  PV-STORE-DATA OCCURS 1 TO 100 TIMES                  03350022
033600                              DEPENDING ON PV-STORE-COUNT         03360022
033700                              INDEXED BY PV-IDX.                  03370022
033800             15  PV-STORE                      PIC 9(04).         03380022
033900             15  PV-STORE-QTY                  PIC 9(09).         03390022
034000             15  PV-STORE-QTY-SIGN             PIC X(01).         03400022
034100                                                                  03410022
034200 01  PV-DB2-TMST                      PIC X(26).                  03420014
034300 01  FILLER  REDEFINES  PV-DB2-TMST.                              03430014
034400         10  PV-DB2-TMST-CCYY         PIC X(04).                  03440014
034500         10  FILLER                   PIC X(01).                  03450014
034600         10  PV-DB2-TMST-MO           PIC X(02).                  03460014
034700         10  FILLER                   PIC X(01).                  03470014
034800         10  PV-DB2-TMST-DA           PIC X(02).                  03480014
034900         10  FILLER                   PIC X(01).                  03490014
035000         10  PV-DB2-TMST-HH           PIC X(02).                  03500014
035100         10  FILLER                   PIC X(01).                  03510014
035200         10  PV-DB2-TMST-MM           PIC X(02).                  03520014
035300         10  FILLER                   PIC X(01).                  03530014
035400         10  PV-DB2-TMST-SS           PIC X(02).                  03540014
035500             88  PV-DB2-TMST-SS-01               VALUE '01'.      03550014
035600         10  FILLER                   PIC X(01).                  03560014
035700         10  PV-DB2-TMST-MS           PIC X(06).                  03570014
035800             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  03580014
039200                                                                  03920013
039210*----------------------------------------------------------------*03921013
039220*    TRECEIV                                                      03922013
039230*----------------------------------------------------------------*03923013
039240     EXEC SQL                                                     03924013
039250          INCLUDE TRECEIV                                         03925013
039260     END-EXEC.                                                    03926013
039270                                                                  03927013
039280*----------------------------------------------------------------*03928013
039290*    TRECITM                                                      03929013
039291*----------------------------------------------------------------*03929113
039292     EXEC SQL                                                     03929213
039293          INCLUDE TRECITM                                         03929313
039294     END-EXEC.                                                    03929413
039295                                                                  03929513
039296*----------------------------------------------------------------*03929613
039297*    TRECDIS                                                      03929713
039298*----------------------------------------------------------------*03929813
039299     EXEC SQL                                                     03929913
039300          INCLUDE TRECDIS                                         03930013
039301     END-EXEC.                                                    03930113
039302                                                                  03930213
039352******************************************************************03935213
039353*    XLT_SKU                                                      03935323
039354******************************************************************03935413
039355     EXEC SQL                                                     03935513
039356          INCLUDE XLT00003                                        03935623
039357     END-EXEC.                                                    03935713
039358                                                                  03935813
039359******************************************************************03935923
039360*    XLT_MDSE_INV_PARM                                            03936023
039361******************************************************************03936123
039362     EXEC SQL                                                     03936223
039363          INCLUDE XLT00025                                        03936323
039364     END-EXEC.                                                    03936423
039365                                                                  03936523
039366******************************************************************03936613
039367*    SUT_OTBND_CART                                               03936714
039368******************************************************************03936813
039369     EXEC SQL                                                     03936913
039370          INCLUDE SUT00024                                        03937014
039371     END-EXEC.                                                    03937113
039372                                                                  03937213
039373******************************************************************03937314
039374*    SUT_OTBND_UPC                                                03937414
039375******************************************************************03937514
039376     EXEC SQL                                                     03937614
039377          INCLUDE SUT00028                                        03937714
039378     END-EXEC.                                                    03937814
039387******************************************************************03938713
039388*    DB2 DCLGEN WFT_LOD_CNTL                                      03938813
039389******************************************************************03938913
039390     EXEC SQL                                                     03939013
039391          INCLUDE WFT00001                                        03939113
039392     END-EXEC.                                                    03939213
039393                                                                  03939313
039394******************************************************************03939413
039395*    DB2 DCLGEN WFT_LOD_XFER                                      03939513
039396******************************************************************03939613
039397     EXEC SQL                                                     03939713
039398          INCLUDE WFT00002                                        03939813
039399     END-EXEC.                                                    03939913
039400                                                                  03940013
039401*-----------------------------------------------------------------03940113
039402*  COMMUNICATIONS AREA FOR DB2                                    03940213
039403*-----------------------------------------------------------------03940313
039404     EXEC SQL                                                     03940413
039405          INCLUDE SQLCA                                           03940513
039406     END-EXEC.                                                    03940613
039407                                                                  03940713
039469*-----------------------------------------------------------------03946913
039470*    RCVR-LINE-CSR                                                03947013
039471*-----------------------------------------------------------------03947113
039472     EXEC SQL                                                     03947213
039473          DECLARE RCVR-LINE-CSR CURSOR FOR                        03947313
039474          SELECT  A.ORD_LNE_NBR                                   03947423
039475                , A.STATUS_CDE                                    03947523
039476                , B.SKU_NBR                                       03947623
039477            FROM  TRECITM A                                       03947723
039478                , XLT_SKU B                                       03947824
039479           WHERE  A.ORD_NBR          = :DK-ORD-NBR                03947923
039480             AND  A.REC_SEQ_NBR      = :DK-RCVR-SEQ               03948023
039481             AND  A.VER_STATUS_CDE = 'A'                          03948123
039482             AND A.ITM_NBR         =  B.ITM_NBR                   03948223
039483         ORDER BY A.ORD_LNE_NBR                                   03948323
039484     END-EXEC.                                                    03948423
039485                                                                  03948523
039486*-----------------------------------------------------------------03948623
039487*    RCVR-LINE-STR-CSR                                            03948723
039488*-----------------------------------------------------------------03948823
039489     EXEC SQL                                                     03948923
039490          DECLARE RCVR-LINE-STR-CSR CURSOR FOR                    03949023
039491          SELECT  STR_NBR                                         03949123
039492            FROM  TRECDIS                                         03949223
039493           WHERE  ORD_NBR          = :DK-ORD-NBR                  03949323
039494             AND  REC_SEQ_NBR      = :DK-RCVR-SEQ                 03949423
039495             AND  ORD_LNE_NBR      = :DK-LINE-NBR                 03949523
039497         ORDER BY STR_NBR                                         03949723
039498     END-EXEC.                                                    03949823
039499                                                                  03949923
039500*                                                                 03950023
039501*                                                                 03950123
039510****************************************************************  03951023
039600 PROCEDURE DIVISION.                                              03960013
039700******************************************************************03970001
039800 0000-PROGRAM-MAINLINE.                                           03980013
039810                                                                  03981041
039900     DISPLAY '************ START OF RCKUP067 ***************'     03990002
039910     DISPLAY ' '.                                                 03991036
040000                                                                  04000013
040510     SET PS-END-OF-LINE-CSR-NO                                    04051015
040520         PS-END-OF-STR-CSR-NO  TO TRUE.                           04052015
040600                                                                  04060002
041000     OPEN INPUT  INPUT-FILE                                       04100015
041001          OUTPUT OUTPUT-FILE.                                     04100115
041010                                                                  04101002
041020     PERFORM 7000-READ-INPUT.                                     04102015
041050                                                                  04105002
041060     IF PS-EOF-INPUT                                              04106015
041070        DISPLAY '*                                            *'  04107002
041080        DISPLAY '* NO EFC IP FREE ASTRAY RECEIVERS TO VERIFY *'   04108002
041090        DISPLAY '*                                            *'  04109002
041091     ELSE                                                         04109102
042200         PERFORM 2000-PROCESS-INPUT                               04220015
042300             UNTIL PS-EOF-INPUT                                   04230015
042310                OR PS-ERROR                                       04231006
042370     END-IF.                                                      04237002
042380                                                                  04238002
042381     CLOSE OUTPUT-FILE.                                           04238141
042390                                                                  04239041
042400     DISPLAY ' '                                                  04240040
042401     DISPLAY 'DB2 COMMITS:     '  PV-TOTAL-DB2-COMMITS            04240140
042402     DISPLAY 'INPUT COUNT:     '  PV-INPUT-COUNT                  04240240
042403     DISPLAY 'PREV VE COUNT:   '  PV-PREV-VE-COUNT                04240345
042404     DISPLAY 'OUTPUT COUNT:    '  PV-OUTPUT-COUNT                 04240445
042405     DISPLAY ' '                                                  04240545
042406     DISPLAY 'TRECDIS UPDATES: '  PV-TRECDIS-UPDATE-COUNT         04240645
042407     DISPLAY 'WFT_CNTL UPDATES:'  PV-WFT-CNTL-INSERTS             04240745
042408     DISPLAY 'WFT_XFER UPDATES:'  PV-WFT-XFER-INSERTS             04240845
042409     DISPLAY ' '                                                  04240945
042410     DISPLAY 'TRECITM UPDATES: '  PV-TRECITM-UPDATE-COUNT         04241045
042411     DISPLAY 'TRECEIV UPDATES: '  PV-TRECEIV-UPDATE-COUNT         04241145
042412     DISPLAY 'REC-TMST UPDATE: '  PV-RECEIV-UPD-REC-TMST          04241258
042414     DISPLAY ' '.                                                 04241439
042415     DISPLAY '************* END OF RCKUP067 ****************'     04241539
042416     DISPLAY ' '.                                                 04241639
042417                                                                  04241739
042420     STOP RUN.                                                    04242039
042500                                                                  04250039
042600                                                                  04260039
045700*----------------------------------------------------------------*04570015
046000*                                                                 04600002
046100*----------------------------------------------------------------*04610015
046200 2000-PROCESS-INPUT.                                              04620003
046215                                                                  04621536
046356     MOVE RC100-CURR-OPER-UNIT   TO DK-OPER-UNIT-ID.              04635617
046357     MOVE RC100-ORD-NBR          TO DK-ORD-NBR.                   04635717
046358     MOVE RC100-REC-SEQ-NBR      TO DK-RCVR-SEQ                   04635817
046359                                                                  04635944
046360     SET  PS-RCVR-VERIFIED-NO    TO TRUE.                         04636044
046361                                                                  04636144
046362     PERFORM 5200-CHECK-IF-RCVR-VE.                               04636244
046363                                                                  04636344
046364     IF  PS-RCVR-VERIFIED                                         04636444
046365         MOVE DK-ORD-NBR         TO PV-DISP-PO                    04636544
046366         MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ               04636644
046367         DISPLAY ' RCVR BYPASSED: '                               04636744
046368                 PV-DISP-PO      '-'                              04636844
046369                 PV-DISP-RCVR    ' ALREADY VERIFIED'              04636944
046370     ELSE                                                         04637044
046371         PERFORM 2005-PROCESS-RCVR                                04637144
046372     END-IF.                                                      04637244
046380                                                                  04638044
047038     IF PS-ERROR-NO                                               04703842
047039         PERFORM 6000-DB2-COMMIT                                  04703942
047040         PERFORM 7000-READ-INPUT                                  04704042
047041     ELSE                                                         04704142
047042         PERFORM 6100-DB2-ROLLBACK                                04704242
047043     END-IF.                                                      04704342
047044                                                                  04704442
047045                                                                  04704542
047046*----------------------------------------------------------------*04704644
047047*                                                                 04704744
047048*----------------------------------------------------------------*04704844
047049 2005-PROCESS-RCVR.                                               04704944
047055                                                                  04705544
047056     ADD  1  TO  PA-RCVR-COUNT.                                   04705644
047057                                                                  04705744
047058     MOVE  ZEROES       TO PV-TOTAL-TRECEIV-UPDATES               04705844
047059                           PV-TOTAL-TRECITM-UPDATES               04705944
047060                           PV-TOTAL-TRECDIS-UPDATES.              04706044
047061                                                                  04706144
047062     SET PS-END-OF-LINE-CSR-NO                                    04706244
047063         PS-END-OF-STR-CSR-NO  TO TRUE.                           04706344
047064                                                                  04706444
047065     MOVE RC100-CURR-OPER-UNIT   TO DK-OPER-UNIT-ID.              04706544
047066     MOVE RC100-ORD-NBR          TO DK-ORD-NBR.                   04706644
047067     MOVE RC100-REC-SEQ-NBR      TO DK-RCVR-SEQ                   04706744
047068                                                                  04706844
047069     PERFORM 8050-OPEN-RCVR-LNE-CSR.                              04706944
047070     PERFORM 8060-FETCH-RCVR-LNE-CSR.                             04707044
047071                                                                  04707144
047072     PERFORM 2010-PROCESS-LINES                                   04707244
047073       UNTIL PS-END-OF-LINE-CSR                                   04707344
047074          OR PS-ERROR.                                            04707444
047075                                                                  04707544
047076     PERFORM 8070-CLOSE-RCVR-LNE-CSR                              04707644
047077                                                                  04707744
047078     IF  PS-ERROR-NO                                              04707856
047079         PERFORM 4000-CHECK-REC-TMST                              04707956
047080     END-IF.                                                      04708056
047081                                                                  04708156
047082     IF  PS-ERROR-NO                                              04708256
047083         PERFORM 5005-GET-CARTON-CNT                              04708356
047084         PERFORM 5030-UPDATE-TRECEIV                              04708456
047085         PERFORM 5100-FILL-OUTPUT-RECORD                          04708556
047086     END-IF.                                                      04708656
047090                                                                  04709056
047091                                                                  04709144
047092*----------------------------------------------------------------*04709242
047093*                                                                *04709342
047094*----------------------------------------------------------------*04709442
047095 2010-PROCESS-LINES.                                              04709542
047101                                                                  04710142
047102     SET  PS-END-OF-LINE-CSR-NO                                   04710242
047103          PS-END-OF-STR-CSR-NO                                    04710342
047104          PS-ERROR-NO            TO  TRUE.                        04710442
047105                                                                  04710542
047106     MOVE ZEROES                 TO  PV-TOTAL-TRECDIS-UPDATES.    04710642
047107                                                                  04710742
047108     PERFORM 8100-OPEN-LINE-STR-CSR.                              04710842
047109     PERFORM 8110-FETCH-LINE-STR-CSR.                             04710942
047110                                                                  04711042
047111     PERFORM 2020-PROCESS-LINE-STR                                04711142
047112       UNTIL PS-END-OF-STR-CSR                                    04711242
047113          OR PS-ERROR.                                            04711342
047114                                                                  04711442
047115     PERFORM 8120-CLOSE-LINE-STR-CSR.                             04711542
047116                                                                  04711642
047117     IF  PS-ERROR-NO                                              04711742
047118         PERFORM 5020-UPDATE-TRECITM                              04711842
047119     END-IF.                                                      04711942
047120                                                                  04712042
047121     MOVE  ZEROES  TO  RECITM-PKSL-ITM-QTY                        04712142
047122                       RECITM-DTL-CK-ITM-QTY.                     04712242
047123                                                                  04712342
047124     IF  PS-ERROR-NO                                              04712442
047125         PERFORM 8060-FETCH-RCVR-LNE-CSR                          04712542
047126     END-IF.                                                      04712642
047127                                                                  04712742
047128                                                                  04712807
047129*----------------------------------------------------------------*04712917
047130* PROCESS RECEIVER TO VERIFY EFC FREE ASTRAY RCVR                 04713003
047131*----------------------------------------------------------------*04713117
047132 2020-PROCESS-LINE-STR.                                           04713217
047180                                                                  04718008
047181     PERFORM 2030-PROCESS-EFC-LINE-STR.                           04718117
047182                                                                  04718217
047183     IF PS-ERROR-NO                                               04718317
047184         PERFORM 8110-FETCH-LINE-STR-CSR                          04718417
047185     END-IF.                                                      04718517
047186                                                                  04718617
047188                                                                  04718808
113401*---------------------------------------------------------------* 11340108
113402*                                                                 11340208
113403*---------------------------------------------------------------* 11340308
113410 2030-PROCESS-EFC-LINE-STR.                                       11341008
113416                                                                  11341608
113417     IF PS-ERROR-NO                                               11341731
113418         PERFORM 5000-GET-MFSTD-UNITS                             11341831
113419     END-IF.                                                      11341931
113420                                                                  11342008
113421     ADD  SUT00028-SHPD-UNT-QTY  TO RECEIV-EXPTED-ITM-QTY         11342108
113422                                    RECEIV-ACTL-ITM-QTY           11342208
113423                                    RECITM-PKSL-ITM-QTY           11342308
113424                                    RECITM-DTL-CK-ITM-QTY.        11342408
113425                                                                  11342508
113426     MOVE SUT00028-SHPD-UNT-QTY  TO RECDIS-EXPTED-ITM-QTY         11342608
113427                                    RECDIS-VERIFY-ITM-QTY         11342708
113428                                    RECDIS-AP-VERIFY-ITM-QTY      11342822
113429                                    PV-VERIFY-ITM-QTY.            11342922
113430                                                                  11343022
113431     IF PS-ERROR-NO                                               11343131
113432         PERFORM 5010-UPDATE-TRECDIS                              11343231
113433     END-IF.                                                      11343331
113434                                                                  11343422
113435     IF PS-ERROR-NO                                               11343522
113436         PERFORM 5040-INSERT-WFT-LOD-CNTL                         11343622
113437     END-IF.                                                      11343722
113438                                                                  11343822
113439     IF PS-ERROR-NO                                               11343922
113440         PERFORM 5050-INSERT-WFT-LOD-XFER                         11344022
113441     END-IF.                                                      11344122
113446                                                                  11344622
113447                                                                  11344756
113448*---------------------------------------------------------------* 11344856
113449* CHECK IF RECEIVER HAS THE REC_TMST SET (NOT 9'S)                11344956
113450* IF THE REC_TMST IS 9'S - NEED TO CHECK THE TRIP STATUS          11345056
113451*    IF THE TRIP STATUS IS 'DE' OR 'ET'                           11345156
113452*       THEN SET THE REC_TMST TO THE CURRENT TIMESTAMP            11345256
113453*    IF THE TRIP STATUS IS NOT 'DE' OR 'ET'                       11345356
113454*       THEN THE REC_TMST CAN REMAIN AS 9'S                       11345456
113455*---------------------------------------------------------------* 11345556
113456 4000-CHECK-REC-TMST.                                             11345656
113462                                                                  11346256
113463     PERFORM 4010-GET-REC-TMST.                                   11346356
113464                                                                  11346456
113465     IF  RECEIV-REC-TMST  = '9999-09-09-09.09.09.999999' AND      11346556
113466         (RC100-TRIP-STATUS NOT = 'EN')                           11346660
113470         MOVE PV-CURRENT-TMST  TO  RECEIV-REC-TMST                11347060
113471         PERFORM 4020-UPDATE-REC-TMST                             11347160
113472     END-IF.                                                      11347260
113473                                                                  11347360
113474                                                                  11347460
113475 4010-GET-REC-TMST.                                               11347560
113481                                                                  11348160
113482     EXEC SQL                                                     11348260
113483          SELECT REC_TMST                                         11348360
113484               , CURRENT TIMESTAMP                                11348460
113485            INTO :RECEIV-REC-TMST                                 11348560
113486               , :PV-CURRENT-TMST                                 11348660
113487            FROM TRECEIV                                          11348760
113488           WHERE ORD_NBR             = :DK-ORD-NBR                11348860
113489             AND REC_SEQ_NBR         = :DK-RCVR-SEQ               11348960
113490             AND VER_STATUS_CDE      = 'A'                        11349060
113491     END-EXEC.                                                    11349160
113492                                                                  11349260
113493     EVALUATE TRUE                                                11349360
113494         WHEN SQLCODE = ZERO                                      11349460
113495              CONTINUE                                            11349560
113496                                                                  11349660
113500         WHEN SQLWARN0 NOT = SPACES                               11350056
113510         WHEN SQLCODE  NOT = ZERO                                 11351056
113520             MOVE DK-ORD-NBR        TO PV-DISP-PO                 11352056
113521             MOVE DK-RCVR-SEQ       TO PV-DISP-REC-SEQ            11352156
113522             MOVE SQLCODE TO PV-DISP-SQLCODE                      11352256
113523             SET PS-ERROR        TO TRUE                          11352356
113524             DISPLAY '******************************************' 11352456
113525             DISPLAY '*ABEND                                   *' 11352556
113526             DISPLAY '*PROGRAM   = RCKUP067                    *' 11352656
113527             DISPLAY '*DB2 OPER  = SELECT TRECEIV              *' 11352756
113528             DISPLAY '*PARAGRAPH = 4010-GET-REC-TMST           *' 11352856
113529             DISPLAY '*SQLCODE =  ' PV-DISP-SQLCODE               11352956
113530             DISPLAY '*PO =       ' PV-DISP-PO                    11353056
113531             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               11353156
113533             DISPLAY '******************************************' 11353356
113534     END-EVALUATE.                                                11353456
113536                                                                  11353656
113537                                                                  11353756
113538 4020-UPDATE-REC-TMST.                                            11353856
113544                                                                  11354456
113545     MOVE DK-OPER-UNIT-ID       TO PV-DISP-OPER                   11354556
113546     MOVE DK-ORD-NBR            TO PV-DISP-ORD-NBR                11354656
113547     MOVE DK-RCVR-SEQ           TO PV-DISP-RCVR                   11354756
113548                                                                  11354856
113549     DISPLAY ' UPDATE TRECEIV - REC_TMST '                        11354956
113550             PV-DISP-OPER    '-'                                  11355056
113551             PV-DISP-ORD-NBR '-'                                  11355156
113552             PV-DISP-RCVR    ' '                                  11355256
113553             'TMST: ' RECEIV-REC-TMST.                            11355358
113554     DISPLAY ' '.                                                 11355456
113555                                                                  11355556
113556     EXEC SQL                                                     11355656
113557          UPDATE TRECEIV                                          11355756
113558             SET REC_TMST            = :RECEIV-REC-TMST           11355856
113559           WHERE ORD_NBR             = :DK-ORD-NBR                11355956
113560             AND REC_SEQ_NBR         = :DK-RCVR-SEQ               11356056
113561             AND VER_STATUS_CDE      = 'A'                        11356156
113562     END-EXEC.                                                    11356256
113570                                                                  11357056
113580     EVALUATE TRUE                                                11358056
113590         WHEN SQLCODE = ZERO                                      11359056
113591              ADD  1        TO PV-RECEIV-UPD-REC-TMST             11359156
113592                                                                  11359256
113593         WHEN SQLWARN0 NOT = SPACES                               11359356
113594         WHEN SQLCODE  NOT = ZERO                                 11359456
113595             MOVE DK-ORD-NBR        TO PV-DISP-PO                 11359556
113596             MOVE DK-RCVR-SEQ       TO PV-DISP-REC-SEQ            11359656
113597             MOVE SQLCODE TO PV-DISP-SQLCODE                      11359756
113598             SET PS-ERROR        TO TRUE                          11359856
113599             DISPLAY '******************************************' 11359956
113600             DISPLAY '*ABEND                                   *' 11360056
113610             DISPLAY '*PROGRAM   = RCKUP067                    *' 11361056
113620             DISPLAY '*DB2 OPER  = UPDATE TRECEIV              *' 11362056
113630             DISPLAY '*PARAGRAPH = 4020-UPDATE-REC-TMST        *' 11363056
113640             DISPLAY '*SQLCODE =  ' PV-DISP-SQLCODE               11364056
113650             DISPLAY '*PO =       ' PV-DISP-PO                    11365056
113660             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               11366056
113661             DISPLAY '*REC-TMST = ' RECEIV-REC-TMST               11366156
113670             DISPLAY '******************************************' 11367056
113680     END-EVALUATE.                                                11368056
113691                                                                  11369156
113700                                                                  11370056
204513*---------------------------------------------------------------* 20451309
204514*                                                                 20451409
204515*---------------------------------------------------------------* 20451509
204520 5000-GET-MFSTD-UNITS.                                            20452008
204530                                                                  20453008
204531     MOVE  RECDIS-STR-NBR  TO  DK-STR-NBR.                        20453128
204532                                                                  20453228
204533     EXEC SQL                                                     20453328
204534          SELECT SUM(B.SHPD_UNT_QTY)                              20453428
204535            INTO :SUT00028-SHPD-UNT-QTY                           20453528
204536            FROM SUT_OTBND_CART A                                 20453628
204537               , SUT_OTBND_UPC B                                  20453728
204538           WHERE A.ORGN_LOC_NBR      = :DK-OPER-UNIT-ID           20453828
204539             AND A.DEST_LOC_NBR      = :DK-STR-NBR                20453928
204540             AND A.ACTV_IND          = 'Y'                        20454028
204541             AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID             20454128
204542             AND B.TRN_NBR           = :DK-ORD-NBR                20454213
204543             AND B.RCVR_SEQ_NBR      = :DK-RCVR-SEQ               20454308
204544             AND B.TRN_LNE_NBR       = :DK-LINE-NBR               20454413
204545     END-EXEC.                                                    20454508
204546                                                                  20454608
204547     EVALUATE TRUE                                                20454708
204548         WHEN SQLCODE = +0                                        20454808
204549              CONTINUE                                            20454908
204550         WHEN SQLCODE = +100                                      20455008
204551         WHEN SQLCODE = -305                                      20455154
204552              MOVE ZEROES  TO  SUT00028-SHPD-UNT-QTY              20455254
204553         WHEN SQLWARN0 NOT = SPACE                                20455354
204554         WHEN SQLCODE  NOT = +0                                   20455454
204555             MOVE DK-OPER-UNIT-ID    TO PV-DISP-OPER              20455554
204556             MOVE DK-ORD-NBR         TO PV-DISP-PO                20455654
204557             MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ           20455754
204558             MOVE DK-LINE-NBR        TO PV-DISP-LINE              20455854
204559             MOVE DK-STR-NBR         TO PV-DISP-STR               20455954
204560             MOVE SQLCODE            TO PV-DISP-SQLCODE           20456054
204561             SET PS-ERROR        TO TRUE                          20456154
204562             DISPLAY '******************************************' 20456254
204563             DISPLAY '*ABEND                                   *' 20456354
204564             DISPLAY '*PROGRAM   = RCKUP067                    *' 20456454
204565             DISPLAY '*DB2 OPER  = GET MANIFESTED UNITS        *' 20456554
204566             DISPLAY '*PARAGRAPH = 5000-GET-MFSTD-UNITS        *' 20456654
204567             DISPLAY '*PO-RCVR   = ' PV-DISP-OPER                 20456754
204568                                 '-' PV-DISP-PO                   20456854
204569                                 '-' PV-DISP-REC-SEQ              20456954
204570                                 '-' PV-DISP-LINE                 20457054
204571                                 '-' PV-DISP-STR                  20457154
204572             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20457254
204573             DISPLAY '******************************************' 20457354
204574     END-EVALUATE.                                                20457454
204575                                                                  20457554
204576                                                                  20457654
204577*---------------------------------------------------------------* 20457754
204578*                                                                 20457854
204579*---------------------------------------------------------------* 20457954
204580 5005-GET-CARTON-CNT.                                             20458054
204586                                                                  20458654
204587     MOVE  ZEROES  TO  PV-RCVR-CARTON-COUNT.                      20458751
204588                                                                  20458851
204589     EXEC SQL                                                     20458951
204590          SELECT COUNT(DISTINCT A.SHIPT_UNT_ID)                   20459051
204591            INTO :PV-RCVR-CARTON-COUNT                            20459151
204592            FROM SUT_OTBND_CART A                                 20459251
204593               , SUT_OTBND_UPC B                                  20459351
204594           WHERE A.ORGN_LOC_NBR      = :DK-OPER-UNIT-ID           20459451
204595             AND A.ACTV_IND          = 'Y'                        20459551
204596             AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID             20459651
204597             AND B.TRN_NBR           = :DK-ORD-NBR                20459751
204598             AND B.RCVR_SEQ_NBR      = :DK-RCVR-SEQ               20459851
204599     END-EXEC.                                                    20459951
204600                                                                  20460051
204601     EVALUATE TRUE                                                20460151
204602         WHEN SQLCODE = +0                                        20460251
204603              CONTINUE                                            20460351
204604         WHEN SQLCODE = +100                                      20460451
204605         WHEN SQLCODE = -305                                      20460555
204606              MOVE ZEROES  TO  SUT00028-SHPD-UNT-QTY              20460655
204607         WHEN SQLWARN0 NOT = SPACE                                20460755
204608         WHEN SQLCODE  NOT = +0                                   20460855
204609             MOVE DK-OPER-UNIT-ID    TO PV-DISP-OPER              20460955
204610             MOVE DK-ORD-NBR         TO PV-DISP-PO                20461055
204611             MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ           20461155
204612             MOVE DK-LINE-NBR        TO PV-DISP-LINE              20461255
204613             MOVE DK-STR-NBR         TO PV-DISP-STR               20461355
204614             MOVE SQLCODE            TO PV-DISP-SQLCODE           20461455
204615             SET PS-ERROR        TO TRUE                          20461555
204616             DISPLAY '******************************************' 20461655
204617             DISPLAY '*ABEND                                   *' 20461755
204618             DISPLAY '*PROGRAM   = RCKUP067                    *' 20461855
204619             DISPLAY '*DB2 OPER  = GET MANIFESTED UNITS        *' 20461955
204620             DISPLAY '*PARAGRAPH = 5005-GET-CARTON-CNT         *' 20462055
204621             DISPLAY '*PO-RCVR   = ' PV-DISP-OPER                 20462155
204622                                 '-' PV-DISP-PO                   20462255
204623                                 '-' PV-DISP-REC-SEQ              20462355
204624                                 '-' PV-DISP-LINE                 20462455
204625                                 '-' PV-DISP-STR                  20462555
204626             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20462655
204627             DISPLAY '******************************************' 20462755
204628     END-EVALUATE.                                                20462855
204629                                                                  20462955
204630                                                                  20463055
204631*---------------------------------------------------------------* 20463155
204632*                                                               * 20463255
204633*---------------------------------------------------------------* 20463355
204634 5010-UPDATE-TRECDIS.                                             20463455
204640                                                                  20464055
204641     MOVE 1  TO  DK-FCLTY-ID                                      20464155
204642                 DK-STR-FCLTY-ID.                                 20464255
204650                                                                  20465055
204660     EXEC SQL                                                     20466055
204661          UPDATE TRECDIS                                          20466155
204662             SET  EXPTED_ITM_QTY    = :RECDIS-EXPTED-ITM-QTY      20466255
204663               ,  VERIFY_ITM_QTY    = :RECDIS-VERIFY-ITM-QTY      20466355
204664               ,  AP_VERIFY_ITM_QTY = :RECDIS-AP-VERIFY-ITM-QTY   20466455
204665           WHERE                                                  20466555
204666                  ORD_NBR       =   :DK-ORD-NBR                   20466655
204667             AND  ORD_LNE_NBR   =   :DK-LINE-NBR                  20466755
204668             AND  REC_SEQ_NBR   =   :DK-RCVR-SEQ                  20466855
204669             AND  OPER_UNT_ID   =   :DK-OPER-UNIT-ID              20466955
204670             AND  FCLTY_ID      =   :DK-FCLTY-ID                  20467055
204671             AND  STR_NBR       =   :DK-STR-NBR                   20467155
204672             AND  STR_FCLTY_ID  =   :DK-STR-FCLTY-ID              20467255
204673     END-EXEC.                                                    20467355
204674                                                                  20467455
204675     EVALUATE TRUE                                                20467555
204676         WHEN SQLCODE = +0                                        20467655
204677              ADD   1       TO PV-TRECDIS-UPDATE-COUNT            20467755
204678                                                                  20467855
204679         WHEN OTHER                                               20467955
204680             MOVE RECDIS-ORD-NBR     TO PV-DISP-PO                20468055
204681             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           20468155
204682             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE              20468255
204683             MOVE RECDIS-STR-NBR     TO PV-DISP-STR               20468355
204684             MOVE SQLCODE TO PV-DISP-SQLCODE                      20468455
204685             SET PS-ERROR        TO TRUE                          20468555
204686             DISPLAY '******************************************' 20468655
204687             DISPLAY '*ABEND                                   *' 20468755
204688             DISPLAY '*PROGRAM   = RCKUP067                    *' 20468855
204689             DISPLAY '*DB2 OPER  = UPDATE TRECDIS              *' 20468955
204690             DISPLAY '*PARAGRAPH = 5010-UPDATE-TRECDIS         *' 20469055
204691             DISPLAY '*SQLCODE =  ' PV-DISP-SQLCODE               20469155
204692             DISPLAY '*PO =       ' PV-DISP-PO                    20469255
204693             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               20469355
204694             DISPLAY '*LINE =     ' PV-DISP-LINE                  20469455
204695             DISPLAY '*STORE =    ' PV-DISP-STR                   20469555
204696             DISPLAY '******************************************' 20469655
204697     END-EVALUATE.                                                20469755
204698                                                                  20469855
204699                                                                  20469955
204700*---------------------------------------------------------------* 20470055
204701*                                                                 20470155
204702*---------------------------------------------------------------* 20470255
204703 5020-UPDATE-TRECITM.                                             20470355
204709                                                                  20470955
204720     EXEC SQL                                                     20472048
204800          UPDATE  TRECITM                                         20480047
205600             SET  PKSL_ITM_QTY   = :RECITM-PKSL-ITM-QTY           20560047
205700               ,  DTL_CK_ITM_QTY = :RECITM-DTL-CK-ITM-QTY         20570047
205800               ,  STATUS_CDE     = 'VE'                           20580047
206827               ,  VRFD_USR_ID    = 'EFCFAVE'                      20682750
206830               ,  VERFYD_TMST    = CURRENT TIMESTAMP              20683050
206831               ,  UPD_TMST       = CURRENT TIMESTAMP              20683150
206832               ,  UPD_UID        = 'RCKUP067'                     20683250
206833               ,  UPD_PGM_ID     = 'RCKUP067'                     20683350
206838           WHERE  ORD_NBR        = :DK-ORD-NBR                    20683847
206839             AND  ORD_LNE_NBR    = :DK-LINE-NBR                   20683947
206840             AND  REC_SEQ_NBR    = :DK-RCVR-SEQ                   20684047
206841             AND  OPER_UNT_ID    = :DK-OPER-UNIT-ID               20684147
206843             AND VER_STATUS_CDE  = 'A'                            20684350
206884     END-EXEC.                                                    20688447
206885                                                                  20688547
206886     EVALUATE TRUE                                                20688647
206887         WHEN SQLCODE = ZERO                                      20688747
206889              ADD  +1       TO PV-TRECITM-UPDATE-COUNT            20688947
206890                                                                  20689047
206891         WHEN SQLWARN0 NOT = SPACES                               20689147
206892         WHEN SQLCODE  NOT = ZERO                                 20689247
206893             MOVE DK-ORD-NBR        TO PV-DISP-PO                 20689347
206894             MOVE DK-RCVR-SEQ       TO PV-DISP-REC-SEQ            20689447
206895             MOVE DK-LINE-NBR       TO PV-DISP-LINE               20689547
206896             MOVE SQLCODE TO PV-DISP-SQLCODE                      20689647
206900             SET PS-ERROR        TO TRUE                          20690047
206901             DISPLAY '******************************************' 20690147
206902             DISPLAY '*ABEND                                   *' 20690247
206903             DISPLAY '*PROGRAM   = RCKUP067                    *' 20690347
206904             DISPLAY '*DB2 OPER  = UPDATE ON TRECITM           *' 20690447
206905             DISPLAY '*PARAGRAPH = 5020-UPDATE-TRECITM         *' 20690547
206906             DISPLAY '*SQLCODE =  ' PV-DISP-SQLCODE               20690647
206907             DISPLAY '*PO =       ' PV-DISP-PO                    20690747
206908             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               20690847
206909             DISPLAY '*LINE =     ' PV-DISP-LINE                  20690947
206910             DISPLAY '******************************************' 20691047
206911     END-EVALUATE.                                                20691147
206912                                                                  20691209
206913                                                                  20691309
206914*---------------------------------------------------------------* 20691409
206915*                                                                 20691509
206916*---------------------------------------------------------------* 20691609
206917 5030-UPDATE-TRECEIV.                                             20691718
206939                                                                  20693951
206940     MOVE PV-RCVR-CARTON-COUNT  TO RECEIV-EXPTED-CART-CNT         20694051
206941                                   RECEIV-ACTL-CART-CNT.          20694151
206942                                                                  20694247
206943     EXEC SQL                                                     20694347
206944          UPDATE TRECEIV                                          20694447
206945             SET  EXPTED_CART_CNT    = :RECEIV-EXPTED-CART-CNT    20694550
206946               ,  ACTL_CART_CNT      = :RECEIV-ACTL-CART-CNT      20694650
206947               ,  RCVG_CLERK_INIT_ID = 'FAV'                      20694750
206948               ,  STATUS_CDE         = 'VE'                       20694850
206949               ,  VRFD_USR_ID        = 'EFCFAVE'                  20694950
206950               ,  VERFYD_TMST        = CURRENT TIMESTAMP          20695050
206951               ,  UPD_TMST           = CURRENT TIMESTAMP          20695150
206952               ,  UPD_UID            = 'RCKUP067'                 20695250
206953               ,  UPD_PGM_ID         = 'RCKUP067'                 20695350
206954           WHERE ORD_NBR             = :DK-ORD-NBR                20695450
206955             AND REC_SEQ_NBR         = :DK-RCVR-SEQ               20695550
206956             AND VER_STATUS_CDE      = 'A'                        20695650
206957     END-EXEC.                                                    20695750
206958                                                                  20695850
206959     EVALUATE TRUE                                                20695950
206960         WHEN SQLCODE = ZERO                                      20696050
206961              ADD  1        TO PV-TRECEIV-UPDATE-COUNT            20696150
206962                                                                  20696250
206963         WHEN SQLWARN0 NOT = SPACES                               20696350
206964         WHEN SQLCODE  NOT = ZERO                                 20696450
206965             MOVE DK-ORD-NBR        TO PV-DISP-PO                 20696550
206966             MOVE DK-RCVR-SEQ       TO PV-DISP-REC-SEQ            20696650
206967             MOVE SQLCODE TO PV-DISP-SQLCODE                      20696750
206968             SET PS-ERROR        TO TRUE                          20696850
206969             DISPLAY '******************************************' 20696950
206970             DISPLAY '*ABEND                                   *' 20697050
206971             DISPLAY '*PROGRAM   = RCKUP067                    *' 20697150
206972             DISPLAY '*DB2 OPER  = UPDATE TRECEIV              *' 20697250
206973             DISPLAY '*PARAGRAPH = 5030-UPDATE-TRECEIV         *' 20697350
206974             DISPLAY '*SQLCODE =  ' PV-DISP-SQLCODE               20697450
206975             DISPLAY '*PO =       ' PV-DISP-PO                    20697550
206976             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               20697650
206977             DISPLAY '******************************************' 20697750
206978     END-EVALUATE.                                                20697850
206979                                                                  20697950
206980                                                                  20698010
206997*---------------------------------------------------------------* 20699710
206998*                                                                 20699810
206999*---------------------------------------------------------------* 20699910
207000 5040-INSERT-WFT-LOD-CNTL.                                        20700010
207006                                                                  20700610
207007     INITIALIZE DCLWFT00001.                                      20700710
207008     INITIALIZE DCLWFT00002.                                      20700810
207009                                                                  20700910
207010     EXEC SQL                                                     20701010
207011         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          20701110
207012     END-EXEC.                                                    20701210
207013                                                                  20701310
207014*    DISPLAY ' INSERT WFT-LOD-CNTL: '                             20701447
207015*            WFT00002-PRC-CNTL-TMST '-'                           20701547
207016*            'SKUVER'               '-'                           20701647
207017*            'READY'.                                             20701747
207018                                                                  20701847
207019     EXEC SQL                                                     20701947
207020         INSERT INTO WFT_LOD_CNTL                                 20702047
207021             ( PRC_CNTL_TMST                                      20702147
207022             , TRN_TYP_CDE                                        20702247
207023             , STAT_CDE                                           20702347
207024             , INIT_PRCG_BEG_TMST                                 20702447
207025             , END_TMST                                           20702547
207026             , ARCH_DAT_IND                                       20702647
207027             , DAT_LOD_VER_NBR                                    20702747
207028             , STR_NBR)                                           20702847
207029         VALUES                                                   20702947
207030             ( :WFT00002-PRC-CNTL-TMST                            20703047
207031             , 'SKUVER'                                           20703147
207032             , 'READY'                                            20703247
207033             , '0001-01-01-00.00.00.000000'                       20703347
207034             , '0001-01-01-00.00.00.000000'                       20703447
207035             , ' '                                                20703547
207036             , 0                                                  20703647
207037             , 0999                                               20703747
207038             )                                                    20703847
207039     END-EXEC.                                                    20703947
207040                                                                  20704047
207041     EVALUATE TRUE                                                20704147
207042        WHEN SQLCODE = +0                                         20704247
207043              MOVE +1       TO PV-WFT-CNTL-INSERTS                20704347
207044        WHEN SQLWARN0 NOT = SPACES                                20704447
207045        WHEN SQLCODE < +0                                         20704547
207046        WHEN SQLCODE > +0                                         20704647
207047             MOVE DK-ORD-NBR        TO PV-DISP-PO                 20704747
207048             MOVE DK-RCVR-SEQ       TO PV-DISP-REC-SEQ            20704847
207049             MOVE SQLCODE TO PV-DISP-SQLCODE                      20704947
207050             SET PS-ERROR        TO TRUE                          20705047
207051             DISPLAY '******************************************' 20705147
207052             DISPLAY '*ABEND                                   *' 20705247
207053             DISPLAY '*PROGRAM   = RCKUP009                    *' 20705347
207054             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_CNTL      *' 20705447
207055             DISPLAY '*PARAGRAPH = 5040-INSERT-WFT-LOD-CNTL    *' 20705547
207056             DISPLAY '*SQLCODE =   ' PV-DISP-SQLCODE              20705647
207057             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       20705747
207058             DISPLAY '******************************************' 20705847
207059     END-EVALUATE.                                                20705947
207060                                                                  20706010
207061                                                                  20706110
207062*---------------------------------------------------------------* 20706210
207063*                                                                 20706310
207064*---------------------------------------------------------------* 20706410
207065 5050-INSERT-WFT-LOD-XFER.                                        20706510
207071                                                                  20707110
207074     INITIALIZE WFT00002-LOD-DAT-TXT.                             20707410
207075                                                                  20707510
207076     MOVE DK-ORD-NBR        TO PV-ORDER-NUMBER.                   20707613
207077     MOVE XLT00003-SKU-NBR  TO PV-SKU.                            20707723
207078     MOVE DK-RCVR-SEQ       TO PV-RCVR-ID.                        20707813
207079     MOVE DK-OPER-UNIT-ID   TO PV-DC.                             20707922
207080                                                                  20708010
207087     EXEC SQL                                                     20708710
207088          SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP           20708810
207089     END-EXEC.                                                    20708910
207090                                                                  20709010
207091     MOVE PV-DB2-TMST-CCYY    TO PV-VRFY-DATE (1:4).              20709110
207092     MOVE PV-DB2-TMST-MO      TO PV-VRFY-DATE (5:2).              20709210
207093     MOVE PV-DB2-TMST-DA      TO PV-VRFY-DATE (7:2).              20709310
207094     MOVE PV-DB2-TMST-HH      TO PV-VRFY-DATE (9:2).              20709410
207095     MOVE PV-DB2-TMST-MM      TO PV-VRFY-DATE (11:2).             20709510
207096     MOVE PV-DB2-TMST-SS      TO PV-VRFY-DATE (13:2).             20709610
207097     MOVE 1                   TO PV-STORE-COUNT.                  20709710
207098     MOVE DK-STR-NBR          TO PV-STORE (1).                    20709810
207099     MOVE PV-VERIFY-ITM-QTY   TO PV-STORE-QTY (1).                20709910
207100     MOVE 'P'                 TO PV-STORE-QTY-SIGN (1).           20710010
207101     MOVE LENGTH OF PV-RECEIPT-ADJUSTMENT-REC TO                  20710110
207102        WFT00002-LOD-DAT-TXT-LEN.                                 20710210
207103                                                                  20710310
207104     MOVE PV-RECEIPT-ADJUSTMENT-REC TO                            20710410
207105        WFT00002-LOD-DAT-TXT-TEXT                                 20710530
207106         PV-DISP-LOD-XFER.                                        20710630
207107                                                                  20710726
207108*    DISPLAY ' INSERT WFT-LOD-XFER: '                             20710847
207109*            WFT00002-PRC-CNTL-TMST '-'                           20710947
207110*            'SKUVER'               '-'                           20711047
207111*            '1'                    '-'                           20711147
207112*            PV-DISP-LOD-XFER.                                    20711247
207113                                                                  20711347
207114     EXEC SQL                                                     20711447
207115         INSERT INTO WFT_LOD_XFER                                 20711547
207116             ( PRC_CNTL_TMST                                      20711647
207117             , TRN_TYP_CDE                                        20711747
207118             , BTCH_LOD_SEQ_ID                                    20711847
207119             , LOD_DAT_TXT                                        20711947
207120             )                                                    20712047
207121         VALUES                                                   20712147
207122             (:WFT00002-PRC-CNTL-TMST                             20712247
207123             , 'SKUVER'                                           20712347
207124             , 1                                                  20712447
207125             , :WFT00002-LOD-DAT-TXT                              20712547
207126             )                                                    20712647
207127     END-EXEC.                                                    20712747
207128                                                                  20712847
207129     EVALUATE TRUE                                                20712947
207130        WHEN SQLCODE = +0                                         20713047
207131              MOVE +1       TO PV-WFT-XFER-INSERTS                20713147
207132        WHEN SQLWARN0 NOT = SPACES                                20713247
207133        WHEN SQLCODE < +0                                         20713347
207134        WHEN SQLCODE > +0                                         20713447
207135             MOVE DK-ORD-NBR        TO PV-DISP-PO                 20713547
207136             MOVE DK-RCVR-SEQ       TO PV-DISP-REC-SEQ            20713647
207137             MOVE DK-LINE-NBR       TO PV-DISP-LINE               20713747
207138             MOVE DK-STR-NBR        TO PV-DISP-STR                20713847
207139             MOVE SQLCODE TO PV-DISP-SQLCODE                      20713947
207140             SET PS-ERROR        TO TRUE                          20714047
207141             DISPLAY '******************************************' 20714147
207142             DISPLAY '*ABEND                                   *' 20714247
207143             DISPLAY '*PROGRAM   = RCKUP009                    *' 20714347
207144             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_XFER      *' 20714447
207145             DISPLAY '*PARAGRAPH = 5050-INSERT-WFT-LOD-XFER    *' 20714547
207146             DISPLAY '*SQLCODE =   ' PV-DISP-SQLCODE              20714647
207147             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       20714747
207148             DISPLAY '*PO =        ' PV-DISP-PO                   20714847
207149             DISPLAY '*RECEIVER =  ' PV-DISP-REC-SEQ              20714947
207150             DISPLAY '*LINE =      ' PV-DISP-LINE                 20715047
207151             DISPLAY '*STORE =     ' PV-DISP-STR                  20715147
207152             DISPLAY '******************************************' 20715247
207153     END-EVALUATE.                                                20715347
207154                                                                  20715426
207155                                                                  20715526
207156*----------------------------------------------------------------*20715626
207157*                                                                *20715726
207158*----------------------------------------------------------------*20715826
207159 5100-FILL-OUTPUT-RECORD.                                         20715926
207165                                                                  20716526
207166     INITIALIZE RC099-EFC-RCVR-REC.                               20716653
207167                                                                  20716726
207168     MOVE RC100-CURR-OPER-UNIT   TO RC099-CURR-OPER-UNIT.         20716852
207169     MOVE RC100-ORD-NBR          TO RC099-ORD-NBR.                20716952
207170     MOVE RC100-REC-SEQ-NBR      TO RC099-REC-SEQ-NBR.            20717052
207171     MOVE RC100-RCVR-STATUS      TO RC099-RCVR-STATUS.            20717152
207172     MOVE RC100-CREATE-USERID    TO RC099-CREATE-USERID.          20717252
207173     MOVE RC100-UPDATE-USERID    TO RC099-UPDATE-USERID.          20717352
207174     MOVE RC100-UPDATE-PROGRAM   TO RC099-UPDATE-PROGRAM.         20717452
207175     MOVE RC100-CREATE-TMST      TO RC099-CREATE-TMST.            20717552
207176     MOVE RC100-SCAC             TO RC099-SCAC.                   20717652
207177     MOVE RC100-VEHICL           TO RC099-VEHICL.                 20717752
207178     MOVE RC100-TRIP             TO RC099-TRIP.                   20717852
207179     MOVE RC100-EFC-SHIPMT-NBR   TO RC099-EFC-SHIPMT-NBR.         20717952
207180     MOVE RC100-TRIP-STATUS      TO RC099-TRIP-STATUS.            20718052
207181     MOVE RC100-TRIP-STATUS-DATE TO RC099-TRIP-STATUS-DATE.       20718152
207182     MOVE RC100-TRIP-STATUS-TIME TO RC099-TRIP-STATUS-TIME.       20718252
207183     MOVE RC100-TRIP-STATUS-UID  TO RC099-TRIP-STATUS-UID.        20718352
207184     MOVE RC100-TRIP-STATUS-DESC TO RC099-TRIP-STATUS-DESC.       20718452
207185                                                                  20718526
207186     WRITE OUTPUT-RECORD                                          20718626
207187      FROM RC100-EFC-RCVR-REC.                                    20718726
207188                                                                  20718826
207189     ADD +1  TO PV-OUTPUT-COUNT.                                  20718926
207190                                                                  20719044
207191                                                                  20719144
207192*----------------------------------------------------------------*20719244
207193* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     20719344
207194*----------------------------------------------------------------*20719444
207195 5200-CHECK-IF-RCVR-VE.                                           20719544
207201                                                                  20720144
207202     EXEC SQL                                                     20720244
207203          SELECT STATUS_CDE                                       20720344
207204            INTO :RECEIV-STATUS-CDE                               20720444
207205            FROM TRECEIV                                          20720544
207207           WHERE ORD_NBR           = :DK-ORD-NBR                  20720746
207208             AND REC_SEQ_NBR       = :DK-RCVR-SEQ                 20720844
207209     END-EXEC.                                                    20720944
207210                                                                  20721044
207211     EVALUATE TRUE                                                20721144
207212         WHEN SQLCODE = +0                                        20721244
207213              IF  RECEIV-STATUS-CDE  = 'VE'                       20721344
207214                  SET  PS-RCVR-VERIFIED  TO  TRUE                 20721444
207215                  ADD  1  TO  PV-PREV-VE-COUNT                    20721545
207216              END-IF                                              20721644
207218         WHEN SQLWARN0 NOT = SPACE                                20721844
207219         WHEN SQLCODE  NOT = +0                                   20721944
207221             MOVE DK-ORD-NBR         TO PV-DISP-PO                20722144
207222             MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ           20722244
207225             MOVE SQLCODE            TO PV-DISP-SQLCODE           20722544
207226             SET PS-ERROR        TO TRUE                          20722644
207227             DISPLAY '******************************************' 20722744
207228             DISPLAY '*ABEND                                   *' 20722844
207229             DISPLAY '*PROGRAM   = RCKUP067                    *' 20722944
207230             DISPLAY '*DB2 OPER  = CHECK RCVR VERIFIED         *' 20723044
207231             DISPLAY '*PARAGRAPH = 5200-CHECK-IF-RCVR-VE       *' 20723144
207232             DISPLAY '*PO-RCVR   = ' PV-DISP-PO                   20723244
207234                                 '-' PV-DISP-REC-SEQ              20723444
207237             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20723744
207238             DISPLAY '******************************************' 20723844
207239     END-EVALUATE.                                                20723944
207240                                                                  20724044
207241                                                                  20724144
207242******************************************************************20724244
207243* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     20724344
207244******************************************************************20724444
207245 6000-DB2-COMMIT.                                                 20724544
207251                                                                  20725144
207252     EXEC SQL                                                     20725244
207253         COMMIT                                                   20725344
207254     END-EXEC.                                                    20725444
207255                                                                  20725544
207256     EVALUATE TRUE                                                20725644
207260         WHEN SQLCODE = +0                                        20726044
207300              ADD +1  TO PV-TOTAL-DB2-COMMITS                     20730017
210200     END-EVALUATE.                                                21020015
210300                                                                  21030015
210400 6100-DB2-ROLLBACK.                                               21040010
210410                                                                  21041036
210600     EXEC SQL                                                     21060010
210700         ROLLBACK                                                 21070010
210800     END-EXEC.                                                    21080010
210900                                                                  21090010
211000     EVALUATE TRUE                                                21100010
211100         WHEN SQLCODE = +0                                        21110010
211200              CONTINUE                                            21120010
211300         WHEN SQLWARN0 NOT = SPACES                               21130010
211400         WHEN SQLCODE  NOT = ZERO                                 21140010
211800         SET PS-ERROR        TO TRUE                              21180015
211900         DISPLAY '****************************'                   21190010
212000         DISPLAY '** ABEND                  **'                   21200010
212100         DISPLAY '** PROGRAM = RCKUP067     **'                   21210010
212200         DISPLAY '** PARAGRAPH = 6100-ROLLBACK'                   21220010
212300         DISPLAY '** UNSUCCESSFUL ROLLBACK  **'                   21230010
212400         DISPLAY '****************************'                   21240010
212500     END-EVALUATE.                                                21250010
212600                                                                  21260010
212610                                                                  21261003
212620                                                                  21262003
212621*----------------------------------------------------------------*21262115
212622*                                                                *21262203
212623*----------------------------------------------------------------*21262315
212630 7000-READ-INPUT.                                                 21263015
212636                                                                  21263636
212637     READ INPUT-FILE                                              21263715
212638         INTO RC100-EFC-RCVR-REC                                  21263815
212639     AT END                                                       21263934
212640         SET PS-EOF-INPUT             TO TRUE                     21264034
212641         DISPLAY ' '                                              21264138
212642         DISPLAY ' END OF INPUT FILE'                             21264238
212643     NOT AT END                                                   21264334
212644         ADD 1                        TO PV-INPUT-COUNT           21264434
212645         DISPLAY '--------------------------------------'         21264534
212646         DISPLAY ' '                                              21264634
212647         DISPLAY ' '                                              21264736
212648                  RC100-CURR-OPER-UNIT '-'                        21264836
212649                  RC100-ORD-NBR        '-'                        21264936
212650                  RC100-REC-SEQ-NBR                               21265036
212651         SET PS-END-OF-LINE-CSR-NO                                21265135
212652             PS-END-OF-STR-CSR-NO  TO  TRUE                       21265235
212653         MOVE  RC100-ORD-NBR      TO DK-ORD-NBR                   21265337
212654         MOVE  RC100-REC-SEQ-NBR  TO DK-RCVR-SEQ                  21265437
212655     END-READ.                                                    21265535
212656                                                                  21265635
212659                                                                  21265903
212660                                                                  21266003
212751******************************************************************21275105
212752*                                                                *21275205
212753******************************************************************21275305
212760 8050-OPEN-RCVR-LNE-CSR.                                          21276003
212766                                                                  21276636
212767     EXEC SQL                                                     21276703
212768          OPEN RCVR-LINE-CSR                                      21276803
212769     END-EXEC.                                                    21276903
212770                                                                  21277003
212771     EVALUATE TRUE                                                21277103
212772         WHEN SQLCODE = +0                                        21277203
212773              CONTINUE                                            21277303
212774         WHEN SQLWARN0 NOT = SPACE                                21277403
212775         WHEN SQLCODE  NOT = +0                                   21277503
212776             MOVE DK-ORD-NBR         TO PV-DISP-PO                21277605
212777             MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ           21277713
212778             MOVE SQLCODE            TO PV-DISP-SQLCODE           21277805
212779             SET PS-ERROR        TO TRUE                          21277915
212780             DISPLAY '******************************************' 21278003
212781             DISPLAY '*ABEND                                   *' 21278103
212782             DISPLAY '*PROGRAM   = RCKUP067                    *' 21278203
212783             DISPLAY '*DB2 OPER  = OPEN RCVR-LINE-CSR          *' 21278305
212784             DISPLAY '*PARAGRAPH = 8050-OPEN-RCVR-LNE-CSR      *' 21278405
212785             DISPLAY '*PO-RCVR   = ' PV-DISP-PO                   21278505
212786                                 '-' PV-DISP-REC-SEQ              21278605
212787             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                21278705
212788             DISPLAY '******************************************' 21278805
212789     END-EVALUATE.                                                21278905
212790                                                                  21279005
212791                                                                  21279105
212792******************************************************************21279205
212793*                                                                *21279305
212794******************************************************************21279405
212795 8060-FETCH-RCVR-LNE-CSR.                                         21279505
212801                                                                  21280136
212802     MOVE  ZEROES  TO  RECITM-PKSL-ITM-QTY                        21280222
212803                       RECITM-DTL-CK-ITM-QTY.                     21280322
212804                                                                  21280422
212805     EXEC SQL                                                     21280522
212806          FETCH RCVR-LINE-CSR                                     21280622
212807           INTO :RECITM-ORD-LNE-NBR                               21280722
212810              , :RECITM-STATUS-CDE                                21281022
212820              , :XLT00003-SKU-NBR                                 21282023
212897     END-EXEC.                                                    21289705
212898                                                                  21289805
212906     EVALUATE TRUE                                                21290637
212907         WHEN SQLCODE = +0                                        21290737
212908              MOVE RECITM-ORD-LNE-NBR  TO  DK-LINE-NBR            21290837
212920                                                                  21292005
212930         WHEN SQLCODE = +100                                      21293005
212940              SET PS-END-OF-LINE-CSR  TO  TRUE                    21294005
212950                                                                  21295005
212960         WHEN SQLWARN0 NOT = SPACE                                21296005
212970         WHEN SQLCODE < +0                                        21297005
212980         WHEN SQLCODE > +0                                        21298005
212990             MOVE SQLCODE TO PV-DISP-SQLCODE                      21299005
212993             SET PS-ERROR        TO TRUE                          21299315
212994             DISPLAY '******************************************' 21299405
212995             DISPLAY '*ABEND                                   *' 21299505
212996             DISPLAY '*PROGRAM   = RCKUP067                    *' 21299605
212997             DISPLAY '*DB2 OPER  = FETCH RCVR-LINE-CSR         *' 21299705
212998             DISPLAY '*PARAGRAPH = 8060-FETCH-RCVR-LNE-CSR     *' 21299805
212999             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                21299905
213000             DISPLAY '******************************************' 21300005
213001     END-EVALUATE.                                                21300105
213010                                                                  21301003
213100                                                                  21310003
213110******************************************************************21311005
213120*                                                                *21312005
213130******************************************************************21313005
213200 8070-CLOSE-RCVR-LNE-CSR.                                         21320003
213206                                                                  21320636
213220     EXEC SQL                                                     21322005
213230          CLOSE RCVR-LINE-CSR                                     21323005
213240     END-EXEC.                                                    21324005
213250                                                                  21325005
213260     EVALUATE TRUE                                                21326005
213270         WHEN SQLCODE = +0                                        21327005
213280              CONTINUE                                            21328005
213290         WHEN SQLWARN0 NOT = SPACE                                21329005
213291         WHEN SQLCODE  NOT = +0                                   21329105
213292             MOVE DK-ORD-NBR         TO PV-DISP-PO                21329205
213293             MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ           21329313
213294             MOVE SQLCODE TO PV-DISP-SQLCODE                      21329405
213295             SET PS-ERROR        TO TRUE                          21329515
213296             DISPLAY '******************************************' 21329605
213297             DISPLAY '*ABEND                                   *' 21329705
213298             DISPLAY '*PROGRAM   = RCKUP067                    *' 21329805
213299             DISPLAY '*DB2 OPER  = CLOSE RCVR-LINE-CSR         *' 21329905
213300             DISPLAY '*PARAGRAPH = 8070-CLOSE-RCVR-LNE-CSR     *' 21330005
213301             DISPLAY '*PO-RCVR   = ' PV-DISP-PO                   21330105
213302                                 '-' PV-DISP-REC-SEQ              21330205
213303             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                21330305
213304             DISPLAY '******************************************' 21330405
213305     END-EVALUATE.                                                21330505
213310                                                                  21331003
213400                                                                  21340003
213410*----------------------------------------------------------------*21341008
213420*                                                                *21342008
213430*----------------------------------------------------------------*21343008
213500 8100-OPEN-LINE-STR-CSR.                                          21350008
213510                                                                  21351036
213513     EXEC SQL                                                     21351308
213514          OPEN RCVR-LINE-STR-CSR                                  21351408
213515     END-EXEC.                                                    21351508
213516                                                                  21351608
213517     EVALUATE TRUE                                                21351708
213518         WHEN SQLCODE = +0                                        21351808
213519              CONTINUE                                            21351908
213520         WHEN SQLWARN0 NOT = SPACE                                21352008
213521         WHEN SQLCODE  NOT = +0                                   21352108
213522             MOVE DK-ORD-NBR         TO PV-DISP-PO                21352208
213523             MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ           21352313
213524             MOVE DK-LINE-NBR        TO PV-DISP-LINE              21352418
213525             MOVE SQLCODE            TO PV-DISP-SQLCODE           21352508
213526             SET PS-ERROR        TO TRUE                          21352615
213527             DISPLAY '******************************************' 21352708
213528             DISPLAY '*ABEND                                   *' 21352808
213529             DISPLAY '*PROGRAM   = RCKUP067                    *' 21352908
213530             DISPLAY '*DB2 OPER  = OPEN RCVR-LINE-STR-CSR      *' 21353008
213531             DISPLAY '*PARAGRAPH = 8100-OPEN-LINE-STR-CSR      *' 21353108
213532             DISPLAY '*PO-RCVR   = ' PV-DISP-PO                   21353208
213533                                 '-' PV-DISP-REC-SEQ              21353308
213534                                 '-' PV-DISP-LINE                 21353408
213535             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                21353508
213536             DISPLAY '******************************************' 21353608
213537     END-EVALUATE.                                                21353708
213538                                                                  21353808
213539                                                                  21353908
213540*----------------------------------------------------------------*21354008
213541*                                                                *21354108
213550*----------------------------------------------------------------*21355008
213600 8110-FETCH-LINE-STR-CSR.                                         21360008
213610                                                                  21361036
213630     EXEC SQL                                                     21363008
213640          FETCH RCVR-LINE-STR-CSR                                 21364008
213650           INTO :RECDIS-STR-NBR                                   21365013
213670     END-EXEC.                                                    21367008
213680                                                                  21368008
213690     EVALUATE TRUE                                                21369008
213691         WHEN SQLCODE = +0                                        21369108
213692              CONTINUE                                            21369208
213693                                                                  21369308
213694         WHEN SQLCODE = +100                                      21369408
213695              SET PS-END-OF-STR-CSR  TO  TRUE                     21369508
213696                                                                  21369608
213697         WHEN SQLWARN0 NOT = SPACE                                21369708
213698         WHEN SQLCODE < +0                                        21369808
213699         WHEN SQLCODE > +0                                        21369908
213700             MOVE SQLCODE TO PV-DISP-SQLCODE                      21370008
213710             SET PS-ERROR        TO TRUE                          21371015
213720             DISPLAY '******************************************' 21372008
213730             DISPLAY '*ABEND                                   *' 21373008
213740             DISPLAY '*PROGRAM   = RCKUP067                    *' 21374008
213750             DISPLAY '*DB2 OPER  = FETCH RCVR-LINE-STR-CSR     *' 21375008
213760             DISPLAY '*PARAGRAPH = 8110-FETCH-LINE-STR-CSR     *' 21376008
213770             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                21377008
213780             DISPLAY '******************************************' 21378008
213790     END-EVALUATE.                                                21379008
213800                                                                  21380008
214200                                                                  21420008
214210*----------------------------------------------------------------*21421008
214220*                                                                *21422008
214230*----------------------------------------------------------------*21423008
214300 8120-CLOSE-LINE-STR-CSR.                                         21430008
214310                                                                  21431036
214330     EXEC SQL                                                     21433008
214340          CLOSE RCVR-LINE-STR-CSR                                 21434008
214350     END-EXEC.                                                    21435008
214360                                                                  21436008
214370     EVALUATE TRUE                                                21437008
214380         WHEN SQLCODE = +0                                        21438008
214390              CONTINUE                                            21439008
214391         WHEN SQLWARN0 NOT = SPACE                                21439108
214392         WHEN SQLCODE  NOT = +0                                   21439208
214393             MOVE DK-ORD-NBR         TO PV-DISP-PO                21439308
214394             MOVE DK-RCVR-SEQ        TO PV-DISP-REC-SEQ           21439413
214395             MOVE DK-LINE-NBR        TO PV-DISP-LINE              21439518
214396             MOVE SQLCODE            TO PV-DISP-SQLCODE           21439608
214397             SET PS-ERROR        TO TRUE                          21439715
214398             DISPLAY '******************************************' 21439808
214399             DISPLAY '*ABEND                                   *' 21439908
214400             DISPLAY '*PROGRAM   = RCKUP067                    *' 21440008
214401             DISPLAY '*DB2 OPER  = CLOSE RCVR-LINE-STR-CSR     *' 21440108
214402             DISPLAY '*PARAGRAPH = 8120-CLOSE-LINE-STR-CSR     *' 21440208
214403             DISPLAY '*PO-RCVR   = ' PV-DISP-PO                   21440308
214404                                 '-' PV-DISP-REC-SEQ              21440408
214405                                 '-' PV-DISP-LINE                 21440508
214406             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                21440608
214407             DISPLAY '******************************************' 21440708
214408     END-EVALUATE.                                                21440808
214410                                                                  21441008
215010                                                                  21501036
217600******************************************************************21760001
217700**                      END OF PROGRAM                            21770001
217800*                                                                 21780001
217900******************************************************************21790001
