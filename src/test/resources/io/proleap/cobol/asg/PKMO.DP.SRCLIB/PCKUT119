000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             PCKUT119.                                00050000
000600 AUTHOR.                 GERMAN BANDA                             00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JUNE, 2022.                              00080000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM WILL TAKE IN A PO DETAIL FILE FROM ENROUTE AND    *00120000
001300* ARRIVED TRAILERS. THE FILE WILL BE SORTED IN TRIP/PO/RCVR/LINE *00130000
001400* ORDER.  THE PROGRAM WILL THEN CREATE A COMMA DELIMITED FILE    *00140099
001500* THAT WILL BE PICKED UP BY AN RPA PROCESS TO DOWNLOAD CASEPACK  *00150000
001600* SPLIT                                                          *00160000
001700* THE PROGRAM WILL CHECK 3 PARAMATERS                            *00170026
001800* 'CSRPA' - IS THE RDC TURNED ON FOR RPA PROCESSING              *00180030
001810* 'PCSCAC'- RDC TURNED OFF, CHECK IF SPECIFIC SCACS TURNED ON    *00181030
001820*           IN ORDER TO PROCESS BY SCAC                           00182099
001900* 'RPAZONE'- IS P2L ZONE IN RDC TURNED OFF FOR RPA PROCESSING    *00190099
002100*----------------------------------------------------------------*00210009
002110* INITIAL CHECKS TO PROCESS                                       00211099
002120*   - TRAILERS THAT ARE ARRIVED                                   00212099
002130*   - NON PACK BY STORE ORDERS                                    00213099
002140*   - PO/RECEIVERS THAT HAVE NOT BEEN DOWNLOADED TO CSPCK ALREADY 00214099
002200***************************************************************** 00220000
002300                                                                  00230000
002400***************************************************************** 00240000
002500 ENVIRONMENT DIVISION.                                            00250000
002600***************************************************************** 00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800                                                                  00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003100     SELECT INPUT-FILE ASSIGN TO INP01.                           00310000
003200                                                                  00320000
003300     SELECT OUTPUT-FILE ASSIGN TO OUT01.                          00330000
003400                                                                  00340000
003500                                                                  00350000
003600***************************************************************** 00360000
003700 DATA DIVISION.                                                   00370000
003800***************************************************************** 00380000
003900 FILE SECTION.                                                    00390000
004000*                                                                 00400000
004100*                                                                 00410000
004200 FD  INPUT-FILE                                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     BLOCK CONTAINS 0 RECORDS.                                    00450000
004600 01  INPUT-RECORD                PIC X(400).                      00460000
004700                                                                  00470000
004800 FD  OUTPUT-FILE                                                  00480000
004900     RECORDING MODE IS F                                          00490000
005000     LABEL RECORDS ARE STANDARD                                   00500000
005100     BLOCK CONTAINS 0 RECORDS.                                    00510000
005200 01  OUTPUT-RECORD               PIC X(215).                      00520099
005300                                                                  00530000
005500*                                                                 00550000
005600***************************************************************** 00560000
005700 WORKING-STORAGE SECTION.                                         00570000
005800                                                                  00580000
005900 01  PS-PROGRAM-SWITCHES.                                         00590000
006000     05  PS-END-OF-INPUT-FILE-SW      PIC X(01)  VALUE 'N'.       00600000
006100         88  PS-END-OF-INPUT-FILE                VALUE 'Y'.       00610000
006200         88  PS-NOT-END-OF-INPUT-FILE            VALUE 'N'.       00620000
006210     05  PS-FIRST-REC-SW              PIC X(01)  VALUE 'N'.       00621066
006220         88  PS-FIRST-RECORD-YES                 VALUE 'Y'.       00622066
006230         88  PS-FIRST-RECORD-NO                  VALUE 'N'.       00623066
006240     05  PS-CNTL-FLOW-SW              PIC X(01)  VALUE 'N'.       00624000
006250         88  PS-CNTL-FLOW-YES                    VALUE 'Y'.       00625000
006260         88  PS-CNTL-FLOW-NO                     VALUE 'N'.       00626000
006261     05  PS-UCC128-FOUND-SW           PIC X(01)  VALUE 'Y'.       00626101
006262         88  PS-UCC128-YES                       VALUE 'Y'.       00626201
006263         88  PS-UCC128-NO                        VALUE 'N'.       00626301
006264     05  PS-WRITE-RECORD-SW           PIC X(01)  VALUE 'Y'.       00626402
006265         88  PS-WRITE-RECORD-YES                 VALUE 'Y'.       00626502
006266         88  PS-WRITE-RECORD-NO                  VALUE 'N'.       00626602
006267     05  PS-DC-PROCESSING-SW          PIC X(01)  VALUE 'N'.       00626729
006268         88  PS-DC-PROCESSING-YES                VALUE 'Y'.       00626829
006269         88  PS-DC-PROCESSING-NO                 VALUE 'N'.       00626929
006270     05  PS-SCAC-LEVEL-SW             PIC X(01)  VALUE 'N'.       00627029
006271         88  PS-SCAC-LEVEL-YES                   VALUE 'Y'.       00627129
006272         88  PS-SCAC-LEVEL-NO                    VALUE 'N'.       00627229
006273     05  PS-SCAC-FOUND-SW             PIC X(01)  VALUE 'N'.       00627329
006274         88  PS-SCAC-FOUND-YES                   VALUE 'Y'.       00627429
006275         88  PS-SCAC-FOUND-NO                    VALUE 'N'.       00627529
006276     05  PS-ZONE-LEVEL-SW             PIC X(01)  VALUE 'N'.       00627629
006277         88  PS-ZONE-LEVEL-YES                   VALUE 'Y'.       00627730
006278         88  PS-ZONE-LEVEL-NO                    VALUE 'N'.       00627830
006280     05  PS-ZONE-FOUND-SW             PIC X(01)  VALUE 'N'.       00628030
006281         88  PS-ZONE-FOUND-YES                   VALUE 'Y'.       00628130
006282         88  PS-ZONE-FOUND-NO                    VALUE 'N'.       00628230
006286                                                                  00628689
006287                                                                  00628789
006290*                                                                 00629000
006300 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00630000
006400                                                 COMP SYNC.       00640000
006500     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     00650000
006600                                                                  00660000
006700 01  PV-PROGRAM-VARIABLES.                                        00670000
006703     05  PV-SKU-NUMBER                PIC 9(08).                  00670399
006704     05  PV-HNG-FLD-DESC              PIC X(04).                  00670499
006710     05  PV-PCNT-FIELD                PIC 9V99 VALUE 0.           00671037
006720     05  PV-PCNT-FIELD-9              PIC 9(6).                   00672048
006900                                                                  00690000
007000     05  PV-READ-COUNT                PIC S9(09) VALUE ZERO       00700000
007100                                                  COMP SYNC.      00710000
007200     05  PV-HAZ-COUNT                 PIC S9(09) VALUE ZERO       00720000
007300                                                  COMP SYNC.      00730000
007310     05  PV-REC-BYPASSED-COUNT        PIC S9(09) VALUE ZERO       00731099
007320                                                  COMP SYNC.      00732000
007330     05  PV-WRITE-OUTPUT-COUNT        PIC S9(09) VALUE ZERO       00733000
007340                                                  COMP SYNC.      00734000
007350     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00735000
007360                                                                  00736000
007370     05  PV-DISPLAY-TRIP-ID           PIC Z(8)9.                  00737000
007380     05  PV-DISPLAY-PO-NBR            PIC Z(8)9.                  00738000
007390     05  PV-DISPLAY-PO-LNE-NBR        PIC Z(8)9.                  00739000
007400     05  PV-DISPLAY-RCVR-SEQ-NBR      PIC 9999.                   00740000
007500     05  PV-DISPLAY-PACK-ID           PIC Z(8)9.                  00750000
007600     05  PV-DISPLAY-OPER-UNT-ID       PIC 9999.                   00760000
007610     05  PV-DISPLAY-ENT-ID            PIC 9999.                   00761001
007620     05  PV-DISPLAY-SKU               PIC 9(8).                   00762099
007700                                                                  00770000
007800     05  PV-PREV-PO-NBR              PIC S9(09)    VALUE ZERO.    00780000
007900     05  PV-PREV-REC-SEQ-NBR         PIC S9(04)    VALUE ZERO.    00790000
008000                                                                  00800000
008100     05  PV-DB2-CURRENT-TIMESTAMP     PIC X(26)  VALUE SPACES.    00810000
008200     05  PV-DB2-FUNCTION              PIC X(30)  VALUE SPACES.    00820000
008300     05  PV-DB2-TABLE-NAME1           PIC X(15)  VALUE SPACES.    00830000
008400     05  PV-DB2-TABLE-NAME2           PIC X(15)  VALUE SPACES.    00840000
008500     05  PV-DB2-TABLE-NAME3           PIC X(15)  VALUE SPACES.    00850000
008600                                                                  00860000
008610     05  PV-SCAC-LIST-TXT            PIC X(25)   VALUE SPACE.     00861029
008611     05  PV-SCAC-LIST.                                            00861131
008620         10  PV-SCAC-01              PIC  X(04)  VALUE SPACE.     00862029
008630         10  FILLER                  PIC  X.                      00863029
008640         10  PV-SCAC-02              PIC  X(04)  VALUE SPACE.     00864029
008650         10  FILLER                  PIC  X.                      00865029
008660         10  PV-SCAC-03              PIC  X(04)  VALUE SPACE.     00866029
008670         10  FILLER                  PIC  X.                      00867029
008680         10  PV-SCAC-04              PIC  X(04)  VALUE SPACE.     00868029
008690         10  FILLER                  PIC  X.                      00869029
008691         10  PV-SCAC-05              PIC  X(04)  VALUE SPACE.     00869129
008692         10  FILLER                  PIC  X.                      00869229
008693                                                                  00869330
008694     05  PV-ZONE-SEND-IND             PIC X(01)  VALUE SPACES.    00869430
008700                                                                  00870000
008800 01  PV-SAVE-FIELDS.                                              00880000
008900     05  PV-SAVE-TRIP-ID             PIC  S9(9) COMP.             00890000
009000     05  PV-SAVE-PO-NBR              PIC  S9(9) COMP.             00900000
009100     05  PV-SAVE-REC-SEQ-NBR         PIC  S9(9) COMP.             00910000
009200                                                                  00920000
009300                                                                  00930000
009400 01 PC-PROGRAM-CONSTANTS.                                         00940000
009500     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'PCKUT119'. 00950000
009510     05 PC-HANG-ZONE                 PIC X(04)  VALUE 'HANG'.     00951089
009520     05 PC-FOLD-ZONE                 PIC X(04)  VALUE 'FOLD'.     00952089
009600                                                                  00960000
009700 01  PV-ABEND-FIELDS.                                             00970000
009800     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         00980000
009900                                                 COMP SYNC.       00990000
010000     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'PCKUT100'.01000000
010100     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01010000
010200     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    01020000
010300     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACES.    01030000
010400     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30) VALUE SPACES.    01040000
010500     05  PV-DISPLAY-SQLCODE           PIC  999-  VALUE ZEROES.    01050000
010600     05  PV-SQL-RETURN-CD             PIC  999-.                  01060000
010700     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01070000
010800     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01080000
010900     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01090000
011000     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01100000
011100                                                                  01110000
011200                                                                  01120000
011300******************************************************************01130000
011400*  USED FOR DB2 ERROR MESSAGE BUILDING                            01140000
011500******************************************************************01150000
011600     COPY DPWS004.                                                01160000
011700                                                                  01170000
011800*----------------------------------------------------------------*01180000
011900*    ABEND PROCESSING COPYBOOK.                                  *01190000
012000*----------------------------------------------------------------*01200000
012100                                                                  01210000
012200     COPY DPWS013.                                                01220000
012300                                                                  01230000
012400******************************************************************01240000
012500*  WST_INTGRTN_TYP                                                01250000
012600******************************************************************01260000
012700     EXEC SQL                                                     01270000
012800          INCLUDE WST00008                                        01280000
012900     END-EXEC.                                                    01290000
013000                                                                  01300000
013100******************************************************************01310000
013200*  WST_ATTR_DEFN                                                  01320000
013300******************************************************************01330000
013400     EXEC SQL                                                     01340000
013500          INCLUDE WST00009                                        01350000
013600     END-EXEC.                                                    01360000
013700                                                                  01370000
013800******************************************************************01380000
013900*  WST_ATTR_ELEM                                                  01390000
014000******************************************************************01400000
014100     EXEC SQL                                                     01410000
014200          INCLUDE WST00010                                        01420000
014300     END-EXEC.                                                    01430000
014400                                                                  01440000
014410******************************************************************01441032
014420*  TKRPRPM - PARAMATER TABLE                                      01442032
014430******************************************************************01443032
014440     EXEC SQL                                                     01444032
014450          INCLUDE TKRPRPM                                         01445032
014460     END-EXEC.                                                    01446032
014470                                                                  01447032
014500******************************************************************01450000
014600*  TPURCHS PO TABLE                                               01460008
014700******************************************************************01470000
014800     EXEC SQL                                                     01480000
014900          INCLUDE TPURCHS                                         01490008
015000     END-EXEC.                                                    01500000
015100                                                                  01510000
015200******************************************************************01520000
015300*  TENTNME - ENTITY NAME TABLE                                    01530008
015400******************************************************************01540000
015500     EXEC SQL                                                     01550000
015600          INCLUDE TENTNME                                         01560008
015700     END-EXEC.                                                    01570000
015800                                                                  01580000
015900******************************************************************01590000
016000*  TRECEIV - RECEIVER HEADER TABLE                                01600008
016100******************************************************************01610000
016200     EXEC SQL                                                     01620000
016300          INCLUDE TRECEIV                                         01630008
016400     END-EXEC.                                                    01640000
016500                                                                  01650000
016600******************************************************************01660052
016700*  TMDSEAR -                                                      01670052
016800******************************************************************01680052
016810     EXEC SQL                                                     01681052
016820          INCLUDE TMDSEAR                                         01682052
016830     END-EXEC.                                                    01683052
016840                                                                  01684052
016841******************************************************************01684152
016842*  TMDSEDP -                                                      01684252
016843******************************************************************01684352
016844     EXEC SQL                                                     01684452
016845          INCLUDE TMDSEDP                                         01684552
016846     END-EXEC.                                                    01684652
016847                                                                  01684752
016848******************************************************************01684857
016849*  TDISTHD -                                                      01684957
016850******************************************************************01685057
016851     EXEC SQL                                                     01685157
016852          INCLUDE TDISTHD                                         01685257
016853     END-EXEC.                                                    01685357
016854                                                                  01685457
016855******************************************************************01685576
016856*  XLT_SKU                                                        01685676
016857******************************************************************01685776
016858     EXEC SQL                                                     01685876
016859          INCLUDE XLT00003                                        01685977
016860     END-EXEC.                                                    01686076
016861                                                                  01686176
016862******************************************************************01686276
016863*  XLT_VND_STYL                                                   01686376
016864******************************************************************01686476
016865     EXEC SQL                                                     01686576
016866          INCLUDE XLT00004                                        01686677
016867     END-EXEC.                                                    01686776
016868                                                                  01686876
016869******************************************************************01686985
016870*  TRECITM                                                        01687085
016871******************************************************************01687185
016872     EXEC SQL                                                     01687285
016873          INCLUDE TRECITM                                         01687385
016874     END-EXEC.                                                    01687485
016875                                                                  01687585
016876******************************************************************01687685
016877*   DB2 SQL COMMUNICATION AREA                                    01687785
016878******************************************************************01687885
016880     EXEC SQL                                                     01688000
016890          INCLUDE SQLCA                                           01689000
016900     END-EXEC.                                                    01690000
017000*                                                                 01700000
017100*DB2 AREA FOR COMMUNICATIONS AREA2                                01710000
017200     COPY SQLCA2.                                                 01720000
017300                                                                  01730000
017400***********************************************************       01740000
017500*  RECORD LAYOUT FOR AN EXTRACT FILE CONTAINING THE               01750000
017600*  PO/RCVR/LINE INFORMATION FOR A TRAILER                         01760000
017700***********************************************************       01770000
017800*INPUT FILE LAYOUT                                                01780000
017900     COPY PCRD068.                                                01790000
018000                                                                  01800000
018100 EJECT                                                            01810000
018200                                                                  01820000
018210***********************************************************       01821000
018220*  RECORD LAYOUT FOR AN EXTRACT FILE CONTAINING THE               01822000
018230*  PO/RCVR/LINE COMMA DELIMITED FILE                              01823000
018240***********************************************************       01824000
018250*OUTPUT FILE LAYOUT                                               01825000
018260     COPY PCRD084.                                                01826000
018270                                                                  01827000
018280 EJECT                                                            01828000
018290                                                                  01829000
018291***********************************************************       01829162
018292*  OUTPUT FILE HEADINGS FILE                                      01829262
018294***********************************************************       01829462
018295*OUTPUT FILE LAYOUT                                               01829562
018296     COPY PCRD085.                                                01829662
018297                                                                  01829762
018298 EJECT                                                            01829862
018299                                                                  01829962
018300***********************************************************       01830000
018400 PROCEDURE DIVISION.                                              01840000
018500***********************************************************       01850000
018600     DISPLAY '***BEGINNING PCKUT119***'.                          01860000
018700                                                                  01870000
018800     PERFORM 1000-INITIALIZE.                                     01880000
018900     IF PS-DC-PROCESSING-YES OR PS-SCAC-LEVEL-YES                 01890030
019000        PERFORM 2000-PROCESS-RECORDS                              01900029
019100            UNTIL PS-END-OF-INPUT-FILE                            01910029
019300     END-IF                                                       01930029
019301                                                                  01930129
019400                                                                  01940000
019500     PERFORM 9000-CLOSE-FILES.                                    01950000
019600                                                                  01960000
019700     GOBACK.                                                      01970000
019800                                                                  01980000
019900                                                                  01990000
020000******************************************************************02000000
020100*                                                                *02010000
020200******************************************************************02020000
020300 1000-INITIALIZE.                                                 02030000
020400                                                                  02040000
020500     OPEN INPUT  INPUT-FILE                                       02050000
020600          OUTPUT OUTPUT-FILE.                                     02060000
020700                                                                  02070000
020800     INITIALIZE PC068-RECORD-LAYOUT.                              02080000
020900                                                                  02090000
021000     PERFORM 7000-READ-INPUT-FILE.                                02100000
021100                                                                  02110000
021200     IF PS-END-OF-INPUT-FILE                                      02120000
021300         DISPLAY '** FILE IS EMPTY **'                            02130000
021310     ELSE                                                         02131002
021321         SET PS-FIRST-RECORD-YES TO TRUE                          02132166
021330         PERFORM 1200-CHECK-DC-RPA-PROCESSING                     02133028
021340                                                                  02134066
021400     END-IF.                                                      02140000
021500                                                                  02150000
021600                                                                  02160000
021610***************************************************************** 02161028
021620* CHECK IF RDC IS TURNED ON FOR RPA PROCESSING                  * 02162099
021630***************************************************************** 02163028
021640 1200-CHECK-DC-RPA-PROCESSING.                                    02164028
021650                                                                  02165028
021680                                                                  02168028
021690      EXEC SQL                                                    02169028
021691         SELECT FUNC_TXT                                          02169128
021692         INTO :KRPRPM-FUNC-TXT                                    02169228
021693         FROM TKRPRPM                                             02169328
021694         WHERE LOC_ID = :PC068-OPER-UNT-ID                        02169432
021695           AND INTFC_SYS_CDE = 'KHL'                              02169528
021696           AND SYS_PRC_FUNC_CDE = 'CSRPA'                         02169628
021697           AND FUNC_PRC_STAT_CDE = 'AC'                           02169728
021699           AND (CURRENT DATE                                      02169928
021700                BETWEEN DATE(FUNC_BEG_TMST) AND                   02170034
021701                   DATE(FUNC_END_TMST) )                          02170134
021702      END-EXEC.                                                   02170228
021703                                                                  02170328
021704      EVALUATE TRUE                                               02170428
021705          WHEN SQLCODE = +0                                       02170528
021706            MOVE KRPRPM-FUNC-TXT  TO PS-DC-PROCESSING-SW          02170670
021707            IF PS-DC-PROCESSING-NO                                02170770
021708               PERFORM 1500-CHECK-SCAC-LEVEL                      02170870
021709            END-IF                                                02170970
021710       WHEN SQLCODE = +100                                        02171028
021711            PERFORM 1500-CHECK-SCAC-LEVEL                         02171129
021712       WHEN SQLWARN0 NOT = SPACES                                 02171228
021713       WHEN SQLCODE NOT = ZERO                                    02171328
021714                                                                  02171428
021715            MOVE 'CHECK DC TURNED ON FOR RPA     '                02171528
021716                                  TO PV-DB2-OPERATION-MESSAGE-1   02171628
021717            MOVE 'TKRPRPM '       TO PV-DB2-TABLE-NAME1           02171728
021718            MOVE '1200-CHECK-DC-RPA-PROCESSING'                   02171828
021719                                        TO PV-PARAGRAPH-NAME      02171928
021720            PERFORM Z999A-SQL-ABEND                               02172028
021721     END-EVALUATE.                                                02172128
021722                                                                  02172228
021723                                                                  02172328
021724***************************************************************** 02172428
021725* CHECK IF SCAC IS PRESENT FOR RPA SCAC LEVEL PROCESSING        * 02172599
021726***************************************************************** 02172628
021727 1500-CHECK-SCAC-LEVEL.                                           02172729
021728                                                                  02172828
021731      SET PS-SCAC-LEVEL-NO TO TRUE                                02173129
021732                                                                  02173229
021733      EXEC SQL                                                    02173328
021734         SELECT FUNC_TXT                                          02173428
021735         INTO :PV-SCAC-LIST-TXT                                   02173529
021736         FROM TKRPRPM                                             02173628
021737         WHERE LOC_ID = :PC068-OPER-UNT-ID                        02173732
021738           AND INTFC_SYS_CDE = 'KHL'                              02173828
021739           AND SYS_PRC_FUNC_CDE = 'PCSCAC'                        02173929
021740           AND FUNC_PRC_STAT_CDE = 'AC'                           02174028
021741           AND (CURRENT DATE                                      02174128
021742                BETWEEN DATE(FUNC_BEG_TMST) AND                   02174234
021743                   DATE(FUNC_END_TMST) )                          02174334
021744      END-EXEC.                                                   02174428
021745                                                                  02174528
021746      EVALUATE TRUE                                               02174628
021747          WHEN SQLCODE = +0                                       02174728
021748            SET PS-SCAC-LEVEL-YES TO TRUE                         02174829
021749            MOVE PV-SCAC-LIST-TXT  TO PV-SCAC-LIST                02174929
021750       WHEN SQLCODE = +100                                        02175028
021751            SET PS-DC-PROCESSING-NO TO TRUE                       02175129
021752            SET PS-SCAC-LEVEL-NO TO TRUE                          02175229
021753            MOVE SPACE TO PV-SCAC-LIST                            02175329
021754       WHEN SQLWARN0 NOT = SPACES                                 02175428
021755       WHEN SQLCODE NOT = ZERO                                    02175528
021756                                                                  02175628
021757            MOVE 'CHECK DC TURNED ON FOR SCAC LVL'                02175729
021758                                  TO PV-DB2-OPERATION-MESSAGE-1   02175828
021759            MOVE 'TKRPRPM '       TO PV-DB2-TABLE-NAME1           02175928
021760            MOVE '1500-CHECK-SCAC-LEVEL       '                   02176029
021761                                        TO PV-PARAGRAPH-NAME      02176128
021762            PERFORM Z999A-SQL-ABEND                               02176228
021763     END-EVALUATE.                                                02176328
021764                                                                  02176428
021822***************************************************************** 02182228
021830*                                                                 02183000
021900***************************************************************** 02190000
022000 2000-PROCESS-RECORDS.                                            02200000
022100                                                                  02210029
022200     SET PS-WRITE-RECORD-NO TO TRUE                               02220069
022302                                                                  02230229
022310     IF  (PC068-PBS-IND = 'Y')     OR                             02231099
022320         (PC068-CASEPK-IND = 'Y')  OR                             02232049
022321         (PC068-UNP-ENRT )         OR                             02232150
022350         (PC068-UCC128-IND  = 'T') OR                             02235074
022360         (PC068-UCC128-IND  = ' ')                                02236065
022600             CONTINUE                                             02260099
022700     ELSE                                                         02270000
022800        SET PS-WRITE-RECORD-YES TO TRUE                           02280019
022810        IF PS-SCAC-LEVEL-YES                                      02281030
022820           PERFORM 2900-CHECK-SCAC-RECORD                         02282030
022830        END-IF                                                    02283030
022840*                                                                 02284030
022900        PERFORM 3000-GET-VND-SET-DATA                             02290001
022901        PERFORM 3200-SELECT-RECEIV-OPER                           02290121
022902        IF PC068-STORE-ZONE  = SPACE                              02290252
022903           PERFORM 3250-SELECT-MISSING-ZONE                       02290352
022904        ELSE                                                      02290452
022905           MOVE PC068-STORE-ZONE TO MDSEDP-STR-ZN-ID              02290552
022906        END-IF                                                    02290652
022907                                                                  02290799
022908        IF PS-WRITE-RECORD-YES                                    02290899
022909           PERFORM 3300-CHECK-ZONE-LEVEL                          02290999
022910        END-IF                                                    02291099
022911                                                                  02291199
022912        IF PS-WRITE-RECORD-YES                                    02291299
022913           PERFORM 3400-CHECK-TRLR-INPROCESS                      02291399
022914        END-IF                                                    02291499
022915                                                                  02291599
022916        IF PS-WRITE-RECORD-YES                                    02291699
022917           PERFORM 3500-CHECK-CSPK-DWNLD                          02291799
022918        END-IF                                                    02291899
022919                                                                  02291989
022920        IF (PC068-STORE-ZONE = PC-HANG-ZONE) OR                   02292089
022921           (PC068-STORE-ZONE = PC-FOLD-ZONE)                      02292189
022922            PERFORM 3600-SELECT-STYL-HNGFLD                       02292289
022923            IF (PC068-PO-NBR      = PV-PREV-PO-NBR) AND           02292399
022924               (PC068-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR)          02292499
022925                 CONTINUE                                         02292599
022926            ELSE                                                  02292699
022927               PERFORM 3700-SELECT-STYL-RCVR                      02292799
022928               MOVE PC068-PO-NBR       TO PV-PREV-PO-NBR          02292899
022929               MOVE PC068-REC-SEQ-NBR  TO PV-PREV-REC-SEQ-NBR     02292999
022930            END-IF                                                02293099
022931        ELSE                                                      02293199
022932            MOVE SPACES       TO PC084-HNG-FOLD-DESC              02293299
022933            MOVE 'N'          TO PC084-MIXED-IND                  02293399
022934        END-IF                                                    02293499
022940*                                                                 02294057
023200      END-IF.                                                     02320001
023300*                                                                 02330007
024500     IF PS-WRITE-RECORD-YES                                       02450002
024501        IF PS-FIRST-RECORD-YES                                    02450166
024502           PERFORM 8100-WRITE-TO-HEADING-REC                      02450266
024503           SET PS-FIRST-RECORD-NO TO TRUE                         02450366
024504        END-IF                                                    02450466
024505                                                                  02450566
024510        PERFORM 7900-LOAD-DELIMITED-FILE                          02451018
024600        PERFORM 8000-WRITE-TO-DTL-FILE                            02460002
024700     END-IF                                                       02470002
024710                                                                  02471002
024800     PERFORM 7000-READ-INPUT-FILE.                                02480000
024810***************************************************************** 02481099
024811* IF SCAC LEVEL PROCESSING EXTRACT THE INDIVIDUAL SCAC(S)         02481199
024812* ENTERED IN KRPRPM-FUNC-TXT                                      02481299
024813* SCAC SHOULD BE SEPERATED BY A SPACE  XXXX XXXX XXXX XXXX XXXX   02481399
024820***************************************************************** 02482099
024900                                                                  02490000
024922 2900-CHECK-SCAC-RECORD.                                          02492230
024923                                                                  02492329
024924     IF (PC068-SCAC      = PV-SCAC-01      AND                    02492431
024930         PV-SCAC-01          > SPACE)            OR               02493029
024940        (PC068-SCAC      = PV-SCAC-02      AND                    02494029
024950         PV-SCAC-02          > SPACE)            OR               02495029
024960        (PC068-SCAC      = PV-SCAC-03      AND                    02496033
024970         PV-SCAC-03          > SPACE)            OR               02497029
024980        (PC068-SCAC      = PV-SCAC-04      AND                    02498029
024990         PV-SCAC-04          > SPACE)            OR               02499029
024991        (PC068-SCAC      = PV-SCAC-05      AND                    02499129
024992         PV-SCAC-05          > SPACE)                             02499229
025001           CONTINUE                                               02500130
025002      ELSE                                                        02500230
025003           SET  PS-WRITE-RECORD-NO TO  TRUE                       02500330
025020      END-IF.                                                     02502029
025100***************************************************************** 02510000
050135***************************************************************** 05013500
050136* SELECT VENDOR NAME AND SEASONAL SET INFORMATION               * 05013601
050137***************************************************************** 05013700
050138 3000-GET-VND-SET-DATA.                                           05013801
050139                                                                  05013900
050160                                                                  05016000
050161     EXEC SQL                                                     05016101
050162         SELECT B.ENT_NAME_DESC                                   05016216
050163              , A.SEASET_YR                                       05016316
050164              , A.SEASET_SHRT_NM                                  05016416
050165              , A.PO_TYP_CDE                                      05016517
050166           INTO :ENTNME-ENT-NAME-DESC                             05016606
050167               ,:PURCHS-SEASET-YR                                 05016706
050168               ,:PURCHS-SEASET-SHRT-NM                            05016806
050169               ,:PURCHS-PO-TYP-CDE                                05016906
050170           FROM TPURCHS A                                         05017006
050171               ,TENTNME B                                         05017106
050172          WHERE  A.PO_NBR          = :PC068-PO-NBR                05017206
050173            AND  A.ENT_ID          =  B.ENT_ID                    05017306
050174            AND  A.VER_STATUS_CDE  = 'A'                          05017406
050175            AND  B.TYPE_CDE        = '01'                         05017506
050181     END-EXEC.                                                    05018101
050182                                                                  05018201
050183     EVALUATE TRUE                                                05018301
050184       WHEN SQLCODE = +0                                          05018401
050185           MOVE ENTNME-ENT-NAME-DESC  TO PC084-VEND-NME           05018501
050186           MOVE PURCHS-SEASET-YR      TO PC084-SEASET-YR          05018601
050187           MOVE PURCHS-SEASET-SHRT-NM TO PC084-SEASET-SHRT-NM     05018701
050188           MOVE PURCHS-PO-TYP-CDE     TO PC084-PO-TYP-CDE         05018839
050189       WHEN SQLCODE = +100                                        05018939
050190           MOVE SPACES               TO PC084-VEND-NME            05019039
050191                                        PC084-SEASET-YR           05019139
050192                                        PC084-SEASET-SHRT-NM      05019239
053100         WHEN SQLWARN0 NOT = SPACES                               05310000
053200         WHEN SQLCODE NOT = ZERO                                  05320000
053900              MOVE PC068-PO-NBR        TO PV-DISPLAY-PO-NBR       05390001
053910              MOVE PC068-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR   05391001
054000              MOVE PC068-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR 05400007
054100              MOVE PC068-PACK-ID       TO PV-DISPLAY-PACK-ID      05410000
054200                                                                  05420000
054300              MOVE 'SELECT VENDOR NAME AND SEASET  '              05430001
054400                                    TO PV-DB2-OPERATION-MESSAGE-1 05440000
054500              MOVE 'TPURCHS '       TO PV-DB2-TABLE-NAME1         05450001
054600              MOVE '3000-GET-VND-SET-DATA       '                 05460001
054700                                          TO PV-PARAGRAPH-NAME    05470000
054800              PERFORM Z999A-SQL-ABEND                             05480000
054900     END-EVALUATE.                                                05490000
055000                                                                  05500000
055100                                                                  05510000
055101***************************************************************** 05510101
055102* SELECT CURRENT AND CREATED FOR OPER UNT AND GOH-IND           * 05510299
055103***************************************************************** 05510301
055104 3200-SELECT-RECEIV-OPER.                                         05510407
055106                                                                  05510601
055107     EXEC SQL                                                     05510701
055109          SELECT CURR_OPER_UNT_ID                                 05510907
055110               , CRE_OPER_UNT_ID                                  05511007
055111               , GOH_IND                                          05511188
055112           INTO  :RECEIV-CURR-OPER-UNT-ID                         05511207
055113                ,:RECEIV-CRE-OPER-UNT-ID                          05511307
055114                ,:RECEIV-GOH-IND                                  05511488
055115           FROM TRECEIV                                           05511507
055116          WHERE ORD_NBR        = :PC068-PO-NBR                    05511607
055117            AND REC_SEQ_NBR    = :PC068-REC-SEQ-NBR               05511707
055118            AND VER_STATUS_CDE = 'A'                              05511807
055119           WITH UR                                                05511907
055130     END-EXEC.                                                    05513007
055131                                                                  05513107
055132     EVALUATE TRUE                                                05513207
055133       WHEN SQLCODE = +0                                          05513307
055134           MOVE RECEIV-CURR-OPER-UNT-ID TO PC084-CURR-OPER-UNT-ID 05513407
055135           MOVE RECEIV-CRE-OPER-UNT-ID  TO PC084-CRE-OPER-UNT-ID  05513507
055136       WHEN SQLCODE = +100                                        05513607
055137           SET PS-WRITE-RECORD-NO  TO TRUE                        05513707
055141       WHEN SQLWARN0 NOT = SPACES                                 05514107
055142       WHEN SQLCODE NOT = ZERO                                    05514207
055144            MOVE PC068-PO-NBR        TO PV-DISPLAY-PO-NBR         05514407
055145            MOVE PC068-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   05514507
055147                                                                  05514707
055148            MOVE 'SELECT OPER FROM RECEIVER      '                05514807
055149                                  TO PV-DB2-OPERATION-MESSAGE-1   05514907
055150            MOVE 'TRECEIV '       TO PV-DB2-TABLE-NAME1           05515007
055151            MOVE '3200-SELECT-RECEIV-OPER     '                   05515107
055152                                        TO PV-PARAGRAPH-NAME      05515207
055154            PERFORM Z999A-SQL-ABEND                               05515407
055155     END-EVALUATE.                                                05515507
055156                                                                  05515607
055157***************************************************************** 05515752
055158* ZONE IS NEEDED FOR ZONE LEVEL PROCESSING CHECK. SELECT ZONE   * 05515899
055159* WHEN NOT PRESENT ON FILE                                      * 05515999
055160***************************************************************** 05516099
055161 3250-SELECT-MISSING-ZONE.                                        05516199
055162                                                                  05516299
055163     EXEC SQL                                                     05516399
055164         SELECT C.STR_ZN_ID                                       05516499
055165           INTO :MDSEDP-STR-ZN-ID                                 05516599
055166           FROM TPURCHS A,                                        05516699
055167                TMDSEAR B,                                        05516799
055168                TMDSEDP C                                         05516899
055169          WHERE A.PO_NBR         = :PC068-PO-NBR                  05516999
055170            AND A.VER_STATUS_CDE = 'A'                            05517099
055171            AND A.DEPT_NBR       = B.DEPT_NBR                     05517199
055172            AND B.MDSELV_CDE     = 'DPT'                          05517299
055173            AND B.OPERCO_NBR     = '03'                           05517399
055174            AND (B.STRT_DTE     <= CURRENT DATE  AND              05517499
055175                 B.END_DTE      >  CURRENT DATE)                  05517599
055176            AND B.MDSEAR_DKEY    = C.MDSEAR_DKEY                  05517699
055177           WITH UR                                                05517799
055178     END-EXEC                                                     05517899
055179                                                                  05517999
055189     EVALUATE TRUE                                                05518952
055190       WHEN SQLCODE = +0                                          05519052
055191           CONTINUE                                               05519152
055194       WHEN SQLCODE = +100                                        05519452
055195           MOVE SPACE TO MDSEDP-STR-ZN-ID                         05519552
055196       WHEN SQLWARN0 NOT = SPACES                                 05519652
055197       WHEN SQLCODE NOT = ZERO                                    05519752
055198            MOVE PC068-PO-NBR        TO PV-DISPLAY-PO-NBR         05519852
055199            MOVE PC068-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   05519952
055200                                                                  05520052
055201            MOVE 'SELECT STORE ZONE          '                    05520199
055202                                  TO PV-DB2-OPERATION-MESSAGE-1   05520252
055203            MOVE 'TPURCHS '       TO PV-DB2-TABLE-NAME1           05520399
055204            MOVE '3200-SELECT-RECEIV-OPER     '                   05520452
055205                                        TO PV-PARAGRAPH-NAME      05520552
055206            PERFORM Z999A-SQL-ABEND                               05520652
055207     END-EVALUATE.                                                05520752
055213                                                                  05521352
055214***************************************************************** 05521499
055215* CHECK INTEGRATION TABLES TO DETERMINE IF A ZONE IS CONFIGURED * 05521599
055216* TO BE EXCLUDED FROM RPA PROCESSING                            * 05521699
055217***************************************************************** 05521799
055218 3300-CHECK-ZONE-LEVEL.                                           05521899
055219                                                                  05521999
055220     EXEC SQL                                                     05522099
055221        SELECT  G.ATTR_ELEM_TXT                                   05522199
055222          INTO :PV-ZONE-SEND-IND                                  05522299
055223          FROM                                                    05522399
055224                WST_INTGRTN_TYP    A                              05522499
055225             ,  WST_ATTR_DEFN      B                              05522599
055226             ,  WST_ATTR_ELEM      C                              05522699
055227             ,  WST_ATTR_ELEM      D                              05522799
055228             ,  WST_ATTR_ELEM      E                              05522899
055229             ,  WST_ATTR_ELEM      F                              05522999
055230             ,  WST_ATTR_ELEM      G                              05523099
055231        WHERE                                                     05523199
055232            A.INTGRTN_TYP_CDE   = 'RPAZONE'                       05523299
055233          AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE             05523399
055234          AND B.ATTR_DEFN_SEQ_NBR = 1                             05523499
055235          AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE             05523599
055236          AND C.ATTR_DEFN_SEQ_NBR = 1                             05523699
055237          AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE             05523799
055238          AND D.ATTR_DEFN_SEQ_NBR = 2                             05523899
055239          AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE             05523999
055240          AND E.ATTR_DEFN_SEQ_NBR = 3                             05524099
055241          AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE             05524199
055242          AND F.ATTR_DEFN_SEQ_NBR = 4                             05524299
055243          AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE             05524399
055244          AND G.ATTR_DEFN_SEQ_NBR = 5                             05524499
055245          AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR           05524599
055246          AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR           05524699
055247          AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR           05524799
055248          AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR           05524899
055249          AND C.ATTR_ELEM_NBR     = :PC068-OPER-UNT-ID            05524999
055250          AND D.ATTR_ELEM_TXT     = :MDSEDP-STR-ZN-ID             05525099
055251          AND E.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP            05525199
055252          AND F.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP            05525299
055253     END-EXEC.                                                    05525399
055254                                                                  05525499
055255     EVALUATE TRUE                                                05525599
055256         WHEN SQLCODE = +0                                        05525699
055257              IF PV-ZONE-SEND-IND  = 'N'                          05525799
055258                SET  PS-WRITE-RECORD-NO TO  TRUE                  05525899
055259              END-IF                                              05525999
055260         WHEN SQLCODE = +100                                      05526099
055261              CONTINUE                                            05526199
055262         WHEN SQLWARN0 NOT = SPACES                               05526299
055263         WHEN SQLCODE NOT = ZERO                                  05526399
055264              MOVE PC068-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID    05526499
055265              MOVE 'CHECK IF P2L ZONE PROCESSING   '              05526599
055266                                    TO PV-DB2-OPERATION-MESSAGE-1 05526699
055267              MOVE 'WST_ATTR_ELEM'  TO PV-DB2-TABLE-NAME1         05526799
055268              MOVE '3300-CHECK-ZONE-LEVEL       '                 05526899
055269                                          TO PV-PARAGRAPH-NAME    05526999
055270              PERFORM Z999A-SQL-ABEND                             05527099
055271     END-EVALUATE.                                                05527199
055272                                                                  05527299
055273***************************************************************** 05527399
055274* CALCULATE PERCENT SCANNING COMPLETED                          * 05527499
055275***************************************************************** 05527599
055276                                                                  05527699
055277 3400-CHECK-TRLR-INPROCESS.                                       05527799
055278      IF PC068-CRTNS-TO-SCAN > ZERO                               05527899
055279                  AND PC068-TOT-CTN-CNT > ZERO                    05527999
055280         COMPUTE PV-PCNT-FIELD =                                  05528099
055281                 ((PC068-TOT-CTN-CNT - PC068-CRTNS-TO-SCAN) /     05528199
055282                  PC068-TOT-CTN-CNT)                              05528299
055284          MOVE PV-PCNT-FIELD   TO PC084-PERCENT-COMPLETE          05528452
055285      ELSE                                                        05528552
055286        IF PC068-TOT-CTN-CNT = ZERO                               05528652
055287          MOVE ZERO          TO PC084-PERCENT-COMPLETE            05528752
055288       ELSE                                                       05528852
055289**NO LINE LEVEL UCC128 DATA                                       05528952
055290          SET PS-WRITE-RECORD-NO TO TRUE                          05529052
055291       END-IF.                                                    05529152
055292***************************************************************** 05529255
055293* CHECK IF CASEPACK PREVIOUSLY DOWNLOADED                      *  05529399
055294***************************************************************** 05529455
055295 3500-CHECK-CSPK-DWNLD.                                           05529555
055296                                                                  05529655
055297                                                                  05529755
055298     EXEC SQL                                                     05529855
055299        SELECT                                                    05529955
055303                CART_DWNLD_USR_ID                                 05530358
055306         INTO                                                     05530655
055310               :DISTHD-CART-DWNLD-USR-ID                          05531058
055313         FROM  TDISTHD                                            05531355
055314                                                                  05531455
055315         WHERE ORD_NBR        = :PC068-PO-NBR                     05531555
055316          AND  RCVR_SEQ_NBR   = :PC068-REC-SEQ-NBR                05531655
055317          AND  ORD_LNE_NBR    = :PC068-PO-LNE-NBR                 05531756
055318          AND  TOT_CART_CNT   > 0                                 05531855
055320         WITH UR                                                  05532055
055321     END-EXEC                                                     05532155
055338                                                                  05533855
055339     EVALUATE TRUE                                                05533955
055340       WHEN SQLCODE = +0                                          05534055
055342          SET PS-WRITE-RECORD-NO TO TRUE                          05534257
055345       WHEN SQLCODE = +100                                        05534555
055346            CONTINUE                                              05534657
055349         WHEN SQLWARN0 NOT = SPACES                               05534955
055350         WHEN SQLCODE NOT = ZERO                                  05535055
055352              MOVE PC068-PO-NBR        TO PV-DISPLAY-PO-NBR       05535255
055353              MOVE PC068-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR   05535355
055354              MOVE PC068-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR 05535455
055356                                                                  05535655
055357              MOVE 'SELECT CASEPACK DOWNLOAD       '              05535757
055358                                    TO PV-DB2-OPERATION-MESSAGE-1 05535855
055359              MOVE 'TDISTHD '       TO PV-DB2-TABLE-NAME1         05535957
055360              MOVE '3500-CHECK-CSPK-DWNLD       '                 05536057
055361                                          TO PV-PARAGRAPH-NAME    05536155
055363              PERFORM Z999A-SQL-ABEND                             05536355
055364     END-EVALUATE.                                                05536455
055365                                                                  05536555
055366***************************************************************** 05536675
055367* SELECT HANG FOLD FROM VEND STYL                               * 05536792
055368***************************************************************** 05536875
055369 3600-SELECT-STYL-HNGFLD.                                         05536975
055370                                                                  05537075
055371     MOVE PC068-SKU-NUMBER   TO PV-SKU-NUMBER.                    05537181
055372     MOVE PV-SKU-NUMBER      TO XLT00003-SKU-NBR.                 05537281
055373                                                                  05537378
055374     EXEC SQL                                                     05537478
055375        SELECT                                                    05537578
055376                HNG_FOLD_DESC                                     05537678
055377         INTO                                                     05537778
055378               :XLT00004-HNG-FOLD-DESC                            05537878
055379         FROM  XLT_SKU A                                          05537978
055380            ,  XLT_VND_STYL B                                     05538078
055381         WHERE A.STYL_ID  = B.STYL_ID                             05538178
055382          AND  A.SKU_NBR   = :XLT00003-SKU-NBR                    05538291
055383          AND  B.HNG_FOLD_DESC IN ('HANG','FOLD')                 05538391
055384         WITH UR                                                  05538475
055385     END-EXEC                                                     05538575
055386                                                                  05538675
055387     EVALUATE TRUE                                                05538775
055388       WHEN SQLCODE = +0                                          05538875
055394          MOVE XLT00004-HNG-FOLD-DESC(1:4) TO PC084-HNG-FOLD-DESC 05539499
055395       WHEN SQLCODE = +100                                        05539575
055397           IF RECEIV-GOH-IND = 'Y'                                05539789
055398              MOVE PC-HANG-ZONE TO PC084-HNG-FOLD-DESC            05539889
055399           ELSE                                                   05539989
055400              MOVE PC-FOLD-ZONE TO PC084-HNG-FOLD-DESC            05540089
055401           END-IF                                                 05540189
055402       WHEN SQLWARN0 NOT = SPACES                                 05540289
055403       WHEN SQLCODE NOT = ZERO                                    05540389
055405            MOVE PC068-PO-NBR        TO PV-DISPLAY-PO-NBR         05540589
055406            MOVE PC068-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR     05540689
055407            MOVE PC068-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   05540789
055409                                                                  05540989
055410            MOVE 'SELECT HANG FOLD FROM VEND STYL'                05541099
055411                                  TO PV-DB2-OPERATION-MESSAGE-1   05541189
055412            MOVE 'XLT_VND_STYL'   TO PV-DB2-TABLE-NAME1           05541299
055413            MOVE '3600-SELECT-STYL-HNGFLD     '                   05541399
055414                                        TO PV-PARAGRAPH-NAME      05541489
055415            PERFORM Z999A-SQL-ABEND                               05541589
055416     END-EVALUATE.                                                05541675
055420                                                                  05542075
055430***************************************************************** 05543092
055440* SELECT HANG FOLD COMBINATIONS AT RECEIVER LEVEL                *05544099
055450***************************************************************** 05545092
055451 3700-SELECT-STYL-RCVR.                                           05545192
055452                                                                  05545292
055453     MOVE SPACES           TO PV-HNG-FLD-DESC.                    05545399
055455                                                                  05545592
055456     EXEC SQL                                                     05545692
055457         SELECT DISTINCT(SUBSTR(HNG_FOLD_DESC,1,4))               05545798
055458          INTO :PV-HNG-FLD-DESC                                   05545898
055459          FROM   TRECITM A                                        05545998
055460              ,  XLT_SKU B                                        05546098
055461              ,  XLT_VND_STYL C                                   05546198
055470          WHERE A.ORD_NBR        = :PC068-PO-NBR                  05547098
055471            AND A.REC_SEQ_NBR    = :PC068-REC-SEQ-NBR             05547198
055472            AND A.VER_STATUS_CDE = 'A'                            05547298
055473            AND A.ITM_NBR = B.ITM_NBR                             05547398
055474            AND B.STYL_ID = C.STYL_ID                             05547498
055475            AND C.HNG_FOLD_DESC NOT IN (' ', 'MIXED','N/A')       05547598
055476         UNION                                                    05547698
055477            SELECT 'HANG'                                         05547798
055478            FROM TRECITM A                                        05547898
055479              ,  XLT_SKU B                                        05547998
055480              ,  XLT_VND_STYL C                                   05548098
055481              ,  TRECEIV D                                        05548198
055482         WHERE A.ORD_NBR         = :PC068-PO-NBR                  05548298
055483            AND A.REC_SEQ_NBR    = :PC068-REC-SEQ-NBR             05548398
055484            AND A.VER_STATUS_CDE = 'A'                            05548498
055485            AND A.ITM_NBR        = B.ITM_NBR                      05548598
055486            AND B.STYL_ID        = C.STYL_ID                      05548698
055487            AND NOT C.HNG_FOLD_DESC IN ('HANG','FOLD')            05548798
055488            AND D.ORD_NBR        = A.ORD_NBR                      05548898
055489            AND D.REC_SEQ_NBR    = A.REC_SEQ_NBR                  05548998
055490            AND D.GOH_IND = 'Y'                                   05549098
055491         UNION                                                    05549198
055492          SELECT 'FOLD'                                           05549298
055493          FROM  TRECITM A                                         05549398
055494             ,  XLT_SKU B                                         05549498
055495             ,  XLT_VND_STYL C                                    05549598
055496             ,  TRECEIV D                                         05549698
055497          WHERE A.ORD_NBR        = :PC068-PO-NBR                  05549798
055498            AND A.REC_SEQ_NBR    = :PC068-REC-SEQ-NBR             05549898
055499            AND A.VER_STATUS_CDE = 'A'                            05549998
055500            AND A.ITM_NBR        = B.ITM_NBR                      05550098
055501            AND B.STYL_ID        = C.STYL_ID                      05550198
055502            AND NOT C.HNG_FOLD_DESC IN ('HANG','FOLD')            05550298
055503            AND D.ORD_NBR        = A.ORD_NBR                      05550398
055504            AND D.REC_SEQ_NBR    = A.REC_SEQ_NBR                  05550498
055505            AND D.GOH_IND        = 'N'                            05550598
055506         WITH UR                                                  05550698
055507     END-EXEC                                                     05550792
055508                                                                  05550892
055509     EVALUATE TRUE                                                05550992
055510       WHEN SQLCODE = +0                                          05551092
055511       WHEN SQLCODE = +100                                        05551199
055512          MOVE 'N'  TO  PC084-MIXED-IND                           05551299
055517       WHEN SQLCODE = -811                                        05551798
055518          MOVE 'Y'  TO  PC084-MIXED-IND                           05551899
055523       WHEN SQLWARN0 NOT = SPACES                                 05552398
055524       WHEN SQLCODE NOT = ZERO                                    05552498
055525            MOVE PC068-ENT-ID        TO PV-DISPLAY-ENT-ID         05552598
055526            MOVE PC068-PO-NBR        TO PV-DISPLAY-PO-NBR         05552698
055527            MOVE PC068-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR     05552798
055528            MOVE PC068-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   05552898
055529            MOVE PC068-PACK-ID       TO PV-DISPLAY-PACK-ID        05552998
055530                                                                  05553098
055531            MOVE 'SELECT HANG FOLD COMBINATIONS  '                05553199
055532                                  TO PV-DB2-OPERATION-MESSAGE-1   05553298
055533            MOVE 'TRECITM '       TO PV-DB2-TABLE-NAME1           05553399
055534            MOVE '3700-SELECT-STYL-RCVR       '                   05553499
055535                                        TO PV-PARAGRAPH-NAME      05553598
055536            PERFORM Z999A-SQL-ABEND                               05553698
055537     END-EVALUATE.                                                05553798
055538                                                                  05553898
055539***************************************************************** 05553998
055540*                                                               * 05554098
055541***************************************************************** 05554198
055550 7000-READ-INPUT-FILE.                                            05555098
055600                                                                  05560000
055700      READ INPUT-FILE INTO PC068-RECORD-LAYOUT                    05570000
055800        AT END                                                    05580000
055900           SET PS-END-OF-INPUT-FILE TO TRUE                       05590000
056000        NOT AT END                                                05600000
056100           ADD +1 TO PV-READ-COUNT                                05610000
056200           MOVE ZEROES TO PC068-CNTL-FLOW-CTN-CNT                 05620000
056300                          PC068-CNTL-FLOW-UNT-CNT                 05630000
056400                          PC068-HAZ-CTN-CNT                       05640000
056500                          PC068-HAZ-UNT-CNT                       05650000
056600           SET  PC068-CNTL-FLOW-NO                                05660000
056700                PC068-HAZDS-NO       TO  TRUE                     05670000
056800      END-READ.                                                   05680000
056900                                                                  05690000
057000                                                                  05700000
057010 7900-LOAD-DELIMITED-FILE.                                        05701003
057020      INITIALIZE         PC084-TRBLE-CTN-LINE .                   05702043
057040      MOVE PC068-TRLR-LOC           TO PC084-TRLR-LOC             05704009
057060      MOVE PC068-ARRIVAL-DATE       TO PC084-ARRIVAL-DATE         05706009
057080      MOVE PC068-SCAC               TO PC084-SCAC                 05708009
057090      MOVE PC068-TRLR-NBR           TO PC084-TRLR-NBR             05709009
057098      MOVE PC068-PO-NBR             TO PC084-PO-NBR.              05709809
057099      MOVE PC068-REC-SEQ-NBR        TO PC084-REC-SEQ-NBR          05709909
057100      MOVE PC068-PO-LNE-NBR         TO PC084-PO-LNE-NBR           05710009
057101      MOVE PC068-PACK-ID            TO PC084-PACK-ID              05710109
057102      MOVE PC068-SKU-NUMBER         TO PC084-SKU-NUMBER           05710209
057103      MOVE PC068-OTPK-QTY           TO PC084-OTPK-QTY             05710342
057104      MOVE PC068-P2L-CTN-CNT        TO PC084-P2L-CTN-CNT          05710409
057105      MOVE PC068-XDCK-CTN-CNT       TO PC084-XDCK-CTN-CNT         05710509
057106      MOVE PC068-CASEPK-IND         TO PC084-CASEPK-IND           05710609
057107      MOVE PC068-UCC128-IND         TO PC084-UCC128-IND           05710709
057108      MOVE PC068-PKG-TYPE           TO PC084-PKG-TYPE             05710809
057109      MOVE PC068-STORE-ZONE         TO PC084-STORE-ZONE           05710909
057110      MOVE PC068-TRBLE-CTN-LINE     TO PC084-TRBLE-CTN-LINE       05711009
057111      MOVE PC068-CRTNS-TO-SCAN      TO PC084-CRTNS-TO-SCAN        05711109
057112      MOVE PC068-CNTL-FLOW-CTN-CNT  TO PC084-CNTL-FLOW-CTN-CNT    05711209
057113      MOVE PC068-CNTL-FLOW-UNT-CNT  TO PC084-CNTL-FLOW-UNT-CNT.   05711309
057114      MOVE SPACE                    TO PC084-FILLER.              05711482
057120***************************************************************** 05712009
057200*                                                               * 05720003
057300***************************************************************** 05730003
057400 8000-WRITE-TO-DTL-FILE.                                          05740000
057500                                                                  05750000
057600     WRITE OUTPUT-RECORD                                          05760000
057700       FROM PC084-RECORD-LAYOUT.                                  05770018
057800                                                                  05780000
057900     ADD +1 TO PV-WRITE-OUTPUT-COUNT.                             05790000
058000                                                                  05800000
058010***************************************************************** 05801062
058020*                                                               * 05802062
058030***************************************************************** 05803062
058040 8100-WRITE-TO-HEADING-REC.                                       05804062
058050                                                                  05805062
058060     WRITE OUTPUT-RECORD                                          05806062
058070       FROM PC085-HEADINGS-LAYOUT.                                05807062
058080                                                                  05808062
058091                                                                  05809162
058100***************************************************************** 05810000
058200*                                                               * 05820000
058300***************************************************************** 05830000
058400 9000-CLOSE-FILES.                                                05840000
058500                                                                  05850000
058600     DISPLAY ' '.                                                 05860000
058700     DISPLAY '**************************************************'.05870000
058800     DISPLAY 'PROGRAM.................'   PC-PROGRAM-NAME.        05880000
058900     DISPLAY ' '.                                                 05890000
059000     MOVE PV-READ-COUNT              TO PV-DISPLAY-COUNT.         05900000
059100     DISPLAY 'TOT RECS READ       : '   PV-DISPLAY-COUNT.         05910000
059200     DISPLAY ' '.                                                 05920000
059500     MOVE PV-WRITE-OUTPUT-COUNT       TO PV-DISPLAY-COUNT.        05950000
059600     DISPLAY 'TOT RECS WRITTEN    :  '   PV-DISPLAY-COUNT.        05960099
059700     DISPLAY ' '.                                                 05970000
060300                                                                  06030000
060400                                                                  06040000
060500     CLOSE INPUT-FILE                                             06050000
060600           OUTPUT-FILE.                                           06060000
060700                                                                  06070000
060800***************************************************************** 06080000
060900 Z999A-SQL-ABEND.                                                 06090000
061000***************************************************************** 06100000
061100     MOVE SQLCODE             TO PV-DISPLAY-SQLCODE.              06110000
061200                                                                  06120000
061300     DISPLAY '** ABEND **:       SQLERROR'.                       06130000
061400     DISPLAY '** PROGRAM:      ' PC-PROGRAM-NAME.                 06140000
061500     DISPLAY '** '                                                06150000
061700     DISPLAY '** OPER UNT ID:  ' PV-DISPLAY-OPER-UNT-ID.          06170000
061800     DISPLAY '** PO NBR:       ' PV-DISPLAY-PO-NBR.               06180000
061900     DISPLAY '** RCVR SEQ NBR: ' PV-DISPLAY-PO-LNE-NBR.           06190000
062000     DISPLAY '** LINE NUMBER:  ' PV-DISPLAY-RCVR-SEQ-NBR.         06200000
062100     DISPLAY '** PACK ID:      ' PV-DISPLAY-PACK-ID.              06210000
062200     DISPLAY '** SKU:          ' PC068-SKU-NUMBER.                06220000
062300     DISPLAY '** '                                                06230000
062400     DISPLAY '** PARAGRAPH:    ' PV-PARAGRAPH-NAME.               06240000
062500     DISPLAY '** DB2 TABLE:    ' PV-DB2-TABLE-NAME1.              06250000
062600     DISPLAY '** SQLCODE:      ' PV-DISPLAY-SQLCODE.              06260000
062700                                                                  06270000
062800     MOVE +4013                  TO PV-ABEND-CODE.                06280000
062900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06290072
