000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP108.                                        00020000
000300 AUTHOR.         PAUL KEBER - STRATAGEM                           00030000
000400 DATE-WRITTEN.   11/14/1995.                                      00040000
000500                                                                  00050008
000600****************************************************************  00060008
000700*    COBOL 2 / DB2                                             *  00070011
000800*--------------------------------------------------------------*  00080018
000900*    UNJOURNALIZED RECEIPT ANALYSIS REPORT                     *  00090011
001000*--------------------------------------------------------------*  00100018
001100*     THIS PROGRAM CREATES THE UNJOURNALIZED RECEIPT           *  00110011
001200*   ANALYSIS REPORT FROM A REPORT FILE PRODUCED IN APKUT107    *  00120011
001300*   AND A DATE FILE PRODUCED IN APKUT106.                      *  00130011
001400*     THE REPORT WILL BE IN DESCENDING VERIFICATION            *  00140011
001500*   EXCEPTION AMOUNT SEQUENCE.  A REPORT LINE WILL BE          *  00150011
001600*   CREATED FOR EACH PO WHICH HAS UNJOURNALIZED RECEIPTS       *  00160011
001700*   WITHIN A START AND END DATE RANGE AND WHICH HAVE BEEN      *  00170011
001800*   VERIFIED.                                                  *  00180011
001900*--------------------------------------------------------------*  00190018
002000* INPUT:                                                       *  00200011
002100*  1) UNJRNLZD-RECEIPT-DATA-FILE             (APRD107)         *  00210011
002200*  2) UNJRNLZD-RECEIPT-DATE-FILE             (APRD108)         *  00220011
002300*  3) PURCHASE ORDER TABLE                   (TPURCHS)         *  00230068
002400*  4) PURCHASE ORDER LINE ITEM TABLE         (TPURITM)         *  00240099
002500*  5) RECEIVING DISTRIBUTION TABLE           (TRECDIS)         *  00250099
002600*  6) PLAN ALLOCATIONS TABLE                 (TALLPLN)         *  00260099
002700*  7) INVOICE TABLE                          (TINVOIC)         *  00270099
002800*  8) MERCHANDISE INVOICE TABLE              (TMDINVC)         *  00280099
002900*                                                              *  00290011
003000* OUTPUT:                                                      *  00300011
003100*  1) RPT01-FILE                             (DPWS150O)        *  00310099
003200*--------------------------------------------------------------*  00320099
003300* CHANGE LOG:                                                     00330099
003400*                                                                 00340099
003500* 11/15/2002                                                      00350099
003600*    CHANGE MADE: INCREASED THE SIZE OF THE REPORT FROM 132 TO    00360099
003700*    150 CHARCTERS WIDE.  THIS WILL ALLOW THE ADDITION OF THE     00370099
003800*    OPEN TO BUY PERIOD ON THE REPORT.                            00380099
003900* MADE BY:  MIKE BESKE                          WR#: 24091        00390099
004000*                                                                 00400099
004100* 02/04/2003                                                      00410099
004200*    CHANGE MADE: ARKPO PHASE3 PROJECT.                           00420099
004300*    UPDATED THE FILES IN THE PROG COMMENT BLOCK.  INCREASED      00430099
004400*    THE PO PRINT FIELD TO Z(9) AND ADJUSTED THE PRINT HEADERS    00440099
004500*    TO MATCH ACCORDINGLY.                                        00450099
004600* MADE BY:  MIKE BESKE                          WR#: 23500        00460099
004700*                                                                 00470099
004800* 02/17/2005                                                      00480099
004900*    CHANGE MADE: ADDED 'NEW STR' AS THE LAST COLUMN ON THE       00490099
005000*    REPORT AND CREATED PRINT HEADERS TO MATCH ACCORDINGLY.       00500099
005100* MADE BY: KRYSTEN LEARY                        WR#: 27573        00510099
005200*                                                                 00520099
005300* 10/28/2005                                                      00530099
005400*    CHANGE MADE:                                                 00540099
005500*    INCREASED SIZE OF UNJRNLZD-RECEIPT-DATA-FILE TO 95           00550099
005600*    CHARACTERS TO ALLOW FOR THE NEW TOTAL GROSS COST             00560099
005700*    FIELD. THIS INPUT FILE IS DEFINED BY APRD107.                00570099
005800* MADE BY: MICHELE RINDFLEISCH                  WR#: 28546        00580099
005900*                                                                 00590099
006000* 05/17/2006                                                      00600099
006100*    CHANGE MADE: ADDED THE COLUMNS PO TYPE, PACK TYPE, # DC      00610099
006200*    VERIFIED, # OF INVOICES, RMS TOTAL QTY, RMS TOTAL COST,      00620099
006300*    UNITS VERIFIED, UNITS INVOICED, UNIT VARIANCE AND            00630099
006400*    UNJOURNALIZED TOTAL TO THE REPORT.  NUMEROUS SQL SELECT      00640099
006500*    STATEMENTS WERE ADDED TO THE PROGRAM TO OBTAIN THIS NEW      00650099
006600*    REPORT INFORMATION.  THE COLUMN VERIFIED EXCEPTION AMOUNT    00660099
006700*    WAS REMOVED FROM THE REPORT.                                 00670099
006800* MADE BY: KRYSTEN LEARY                        WR#: 30417        00680099
006900*                                                                 00690099
007000* DATE  04/23/2008                                                00700099
007100*     CHANGE MADE: REPLACED THE USE OF TPREQIT WITH TMDINVC IN THE00710099
007200*     SQL STATEMENT FOUND IN PARAGRAPH S300-SELECT-INVOICE-INFO.  00720099
007300*     THE USE OF TMDINVC ALLOWS THE PROGRAM TO COMPLETE IN ABOUT 400730099
007400*     MINUTES COMPARED TO 4 HOURS WHEN IT USED TPREQIT.  ALSO ADDE00740099
007500*     PERFORM OF A COMMIT AFTER EACH SUCCESSFUL EXECUTION OF THE  00750099
007600*     SQL IN S300-SELECT-INVOICE-INFO.  THIS WAS DONE AT THE      00760099
007700*     SUGGESTION OF BRAD DORN SO THAT THIS PROGRAM WOULD FREE UP  00770099
007800*     ANY LOCKS IT HAS ON DATA FOUND IN TINVOIC WHILE IT IS ACTIVE00780099
007900*     THIS STOPS THE REORG JOB DBK221 FROM ABENDING DUE TO THESE  00790099
008000*     LOCKS WHILE THIS PROGRAM AND THE JOB RUN AT THE SAME TIME.  00800099
008100*     MADE BY: MIKE BESKE              WR/IR #: WR34276           00810099
008110*                                                                 00811099
008120* DATE  10/31/2010                                                00812099
008130*     CHANGE MADE: INCREASED SIZE OF PV-RMS-TOTAL-COST TO         00813099
008200*     PIC S9(9)V9(2) COMP-3.                                      00820099
008210*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: INC000001459093   00821099
??FIX0*                                                                 00821199
??FIX0* DATE  11/24/2020                                                00822099
??FIX0*     CHANGE MADE: INCREASED SIZE OF PV-RMS-TOTAL-COST TO         00823099
??FIX0*     PIC S9(11)V9(2) COMP-3.                                     00824099
??FIX0*     MADE BY: COGNIZANT               WR/IR #: CHG0251411        00825099
008300****************************************************************  00830099
008400                                                                  00840008
008500 ENVIRONMENT DIVISION.                                            00850000
008600 INPUT-OUTPUT SECTION.                                            00860000
008700                                                                  00870018
008800 FILE-CONTROL.                                                    00880000
008900                                                                  00890000
009000     SELECT UNJRNLZD-RECEIPT-DATA-FILE       ASSIGN TO INP01.     00900014
009100     SELECT UNJRNLZD-RECEIPT-DATE-FILE       ASSIGN TO INP02.     00910014
009200     SELECT RPT01-FILE                       ASSIGN TO RPT01.     00920014
009300                                                                  00930000
009400 DATA DIVISION.                                                   00940000
009500 FILE SECTION.                                                    00950000
009600                                                                  00960018
009700 FD  UNJRNLZD-RECEIPT-DATA-FILE                                   00970000
009800     RECORDING MODE IS F                                          00980000
009900     LABEL RECORDS ARE STANDARD                                   00990000
010000     BLOCK CONTAINS 0 RECORDS                                     01000000
010100     DATA RECORD IS UNJRNLZD-RECEIPT-DATA-RECORD.                 01010000
010200 01  UNJRNLZD-RECEIPT-DATA-RECORD PIC X(95).                      01020001
010300                                                                  01030000
010400 FD  UNJRNLZD-RECEIPT-DATE-FILE                                   01040000
010500     RECORDING MODE IS F                                          01050000
010600     LABEL RECORDS ARE STANDARD                                   01060000
010700     BLOCK CONTAINS 0 RECORDS                                     01070000
010800     DATA RECORD IS UNJRNLZD-RECEIPT-DATE-RECORD.                 01080000
010900 01  UNJRNLZD-RECEIPT-DATE-RECORD PIC X(41).                      01090000
011000                                                                  01100000
011100 FD  RPT01-FILE                                                   01110000
011200     RECORDING MODE IS F                                          01120000
011300     LABEL RECORDS ARE STANDARD                                   01130000
011400     BLOCK CONTAINS 0 RECORDS                                     01140000
011500     DATA RECORD IS RPT01-RECORD.                                 01150000
011600 01  RPT01-RECORD                PIC  X(250).                     01160013
011700                                                                  01170000
011800 WORKING-STORAGE SECTION.                                         01180000
011900*----------------------------------------------------------------*01190009
012000* SQLCA FORMATTED MESSAGE AREA                                   *01200009
012100*----------------------------------------------------------------*01210009
012200     COPY DPWS004.                                                01220009
012300                                                                  01230009
012400*----------------------------------------------------------------*01240009
012500*  COMMUNICATIONS AREA2 FOR DB2                                  *01250009
012600*----------------------------------------------------------------*01260009
012700     COPY SQLCA2.                                                 01270009
012800                                                                  01280000
012900*----------------------------------------------------------------*01290009
013000*  INPUT RECORD AREA                                             *01300009
013100*----------------------------------------------------------------*01310009
013200     COPY APRD107.                                                01320009
013300                                                                  01330009
013400*----------------------------------------------------------------*01340009
013500*  UNJOURNALIZED RECEIPT DATE FILE                               *01350009
013600*----------------------------------------------------------------*01360009
013700     COPY APRD108.                                                01370009
013800                                                                  01380009
013900*----------------------------------------------------------------*01390009
014000*  PRINT AREA                                                    *01400009
014100*----------------------------------------------------------------*01410009
014200     COPY DPWS250O.                                               01420009
014300                                                                  01430009
014400 01  PROGRAM-CONSTANTS.                                           01440009
014500     05  PC-MAX-RETRIES           PIC 9(02)     VALUE 3.          01450009
014600     05  PC-PROGRAM-NAME          PIC X(08)     VALUE 'APKRP108'. 01460009
014700     05  PC-MAX-LINES             PIC S9(03)    VALUE +60.        01470026
014800     05  PC-PBS                   PIC X(03)     VALUE 'PBS'.      01480043
014900                                                                  01490000
015000 01  PROGRAM-VARIABLES.                                           01500009
015100     05  PV-RETRY-COUNTER           PIC S9(04)  VALUE ZERO.       01510026
015200     05  PV-PO-BEING-PROCESSED      PIC S9(09)  VALUE ZERO COMP.  01520021
015300     05  PV-DC-ORDRD-CNT            PIC S9(03)  VALUE ZERO COMP.  01530035
015400     05  PV-DC-RCVD-CNT             PIC S9(03)  VALUE ZERO COMP.  01540035
015500     05  PV-NBR-INVOICES            PIC S9(06)  VALUE ZERO COMP.  01550032
015600     05  PV-UNTS-INVOICED           PIC S9(09)  VALUE ZERO COMP.  01560032
015700     05  PV-UNTS-INVOICED-NULL      PIC S9(04)  VALUE ZERO COMP.  01570048
015800     05  PV-UNTS-VERIFIED           PIC S9(09)  VALUE ZERO COMP.  01580032
015900     05  PV-UNT-VARIANCE            PIC S9(09)  VALUE ZERO COMP.  01590032
016000     05  PV-RMS-TOTAL-QTY           PIC S9(09)  VALUE ZERO COMP.  01600032
??FIX0     05  PV-RMS-TOTAL-COST          PIC S9(11)V9(2) COMP-3.       01610099
016200     05  PV-UNJRNLZD-TOTAL          PIC S9(8)V9(2) COMP-3.        01620068
016300                                                                  01630012
016400 01  PROGRAM-SWITCHES.                                            01640012
016500     05  WS-END-OF-RECEIPT-RECS-SW  PIC X(01)   VALUE 'N'.        01650017
016600         88  END-OF-RECEIPT-RECS                VALUE 'Y'.        01660012
016700         88  NOT-END-OF-RECEIPT-RECS            VALUE 'N'.        01670017
016800                                                                  01680009
016900 01  DATE-WORK-AREA.                                              01690009
017000     05  SYSTEM-DATE              PIC 9(06)     VALUE ZERO.       01700009
017100     05  FILLER REDEFINES SYSTEM-DATE.                            01710009
017200         10  SYSTEM-YEAR          PIC 9(02).                      01720009
017300         10  SYSTEM-MONTH         PIC 9(02).                      01730009
017400         10  SYSTEM-DAY           PIC 9(02).                      01740009
017500     05  SYSTEM-TIME              PIC 9(08)     VALUE ZERO.       01750009
017600     05  FILLER REDEFINES SYSTEM-TIME.                            01760009
017700         10  SYSTEM-HOUR          PIC 9(02).                      01770009
017800         10  SYSTEM-MINUTE        PIC 9(02).                      01780009
017900         10  SYSTEM-SECOND        PIC 9(02).                      01790009
018000         10  FILLER               PIC 9(02).                      01800009
018100                                                                  01810009
018200 01  PR-END-DATE.                                                 01820009
018300     05  PR-END-MONTH            PIC  9(02)   VALUE ZERO.         01830009
018400     05  FILLER                  PIC  X(01)   VALUE '/'.          01840009
018500     05  PR-END-DAY              PIC  9(02)   VALUE ZERO.         01850009
018600     05  FILLER                  PIC  X(01)   VALUE '/'.          01860009
018700     05  PR-END-YEAR             PIC  9(04)   VALUE ZERO.         01870009
018800                                                                  01880009
018900 01  PR-START-DATE.                                               01890009
019000     05  PR-START-MONTH          PIC  9(02)   VALUE ZERO.         01900009
019100     05  FILLER                  PIC  X(01)   VALUE '/'.          01910009
019200     05  PR-START-DAY            PIC  9(02)   VALUE ZERO.         01920009
019300     05  FILLER                  PIC  X(01)   VALUE '/'.          01930009
019400     05  PR-START-YEAR           PIC  9(04)   VALUE ZERO.         01940009
019500                                                                  01950009
019600 01  PW-END-DATE.                                                 01960009
019700     05  PW-END-YEAR             PIC  9(04)   VALUE ZERO.         01970009
019800     05  FILLER                  PIC  X(01)   VALUE '-'.          01980009
019900     05  PW-END-MONTH            PIC  9(02)   VALUE ZERO.         01990009
020000     05  FILLER                  PIC  X(01)   VALUE '-'.          02000009
020100     05  PW-END-DAY              PIC  9(02)   VALUE ZERO.         02010009
020200                                                                  02020009
020300 01  PW-START-DATE.                                               02030009
020400     05  PW-START-YEAR           PIC  9(04)   VALUE ZERO.         02040009
020500     05  FILLER                  PIC  X(01)   VALUE '-'.          02050009
020600     05  PW-START-MONTH          PIC  9(02)   VALUE ZERO.         02060009
020700     05  FILLER                  PIC  X(01)   VALUE '-'.          02070009
020800     05  PW-START-DAY            PIC  9(02)   VALUE ZERO.         02080009
020900                                                                  02090009
021000 01  CONTROL-CARD-RECORD.                                         02100000
021100     05  CC-REPORT-TYPE          PIC  X(01).                      02110000
021200     05  CC-REPORT-TITLE         PIC  X(44).                      02120000
021300     05  FILLER                  PIC  X(35).                      02130000
021400                                                                  02140009
021500*--------------------------------------------------------------*  02150009
021600* REPORT HEADING LINES, DETAIL LINES, CONTROLS, ETC.           *  02160009
021700*--------------------------------------------------------------*  02170009
021800 01  REPORT-CONTROLS.                                             02180009
021900     05  PAGE-COUNT            PIC S9(04)   COMP-3 VALUE ZERO.    02190011
022000     05  LINE-COUNT            PIC S9(04)   COMP-3 VALUE ZERO.    02200011
022100 01  BLANK-LINE                PIC X(250)   VALUE SPACES.         02210011
022200                                                                  02220000
022300 01  HDR-LINE2.                                                   02230011
022400     05  FILLER                PIC X(103)   VALUE SPACES.         02240011
022500     05  HL2-TITLE             PIC X(44)    VALUE SPACES.         02250009
022600     05  FILLER                PIC X(103)   VALUE SPACES.         02260011
022700                                                                  02270000
022800 01  HDR-LINE3.                                                   02280000
022900     05  FILLER                PIC X(108)   VALUE SPACES.         02290014
023000     05  FILLER                PIC X(07)    VALUE 'DATES: '.      02300009
023100     05  HL3-START-DATE        PIC X(10)    VALUE SPACES.         02310009
023200     05  FILLER                PIC X(06)    VALUE ' THRU '.       02320009
023300     05  HL3-END-DATE          PIC X(10)    VALUE SPACES.         02330009
023400     05  FILLER                PIC X(107)   VALUE SPACES.         02340014
023500                                                                  02350000
023600 01  HDR-LINE4.                                                   02360000
023700     05  FILLER                PIC X(33)    VALUE SPACES.         02370009
023800     05  FILLER                PIC X(06)    VALUE 'VENDOR'.       02380009
023900     05  FILLER                PIC X(14)    VALUE SPACES.         02390037
024000     05  FILLER                PIC X(02)    VALUE 'PO'.           02400009
024100     05  FILLER                PIC X(06)    VALUE SPACES.         02410037
024200     05  FILLER                PIC X(02)    VALUE 'PO'.           02420009
024300     05  FILLER                PIC X(03)    VALUE SPACES.         02430037
024400     05  FILLER                PIC X(04)    VALUE 'PACK'.         02440009
024500     05  FILLER                PIC X(03)    VALUE SPACES.         02450037
024600     05  FILLER                PIC X(04)    VALUE '# DC'.         02460009
024700     05  FILLER                PIC X(06)    VALUE SPACES.         02470037
024800     05  FILLER                PIC X(04)    VALUE '# OF'.         02480009
024900     05  FILLER                PIC X(06)    VALUE SPACES.         02490099
025000     05  FILLER                PIC X(09)    VALUE 'RMS TOTAL'.    02500009
025100     05  FILLER                PIC X(04)    VALUE SPACES.         02510099
025200     05  FILLER                PIC X(05)    VALUE 'UNITS'.        02520009
025300     05  FILLER                PIC X(06)    VALUE SPACES.         02530099
025400     05  FILLER                PIC X(05)    VALUE 'UNITS'.        02540009
025500     05  FILLER                PIC X(07)    VALUE SPACES.         02550099
025600     05  FILLER                PIC X(04)    VALUE 'UNIT'.         02560009
025700     05  FILLER                PIC X(08)    VALUE SPACES.         02570099
025800     05  FILLER                PIC X(09)    VALUE 'RMS TOTAL'.    02580037
025900     05  FILLER                PIC X(37)    VALUE SPACES.         02590099
026000     05  FILLER                PIC X(13)    VALUE 'UNJOURNALIZED'.02600009
026100     05  FILLER                PIC X(03)    VALUE SPACES.         02610099
026200     05  FILLER                PIC X(13)    VALUE 'UNJOURNALIZED'.02620009
026300     05  FILLER                PIC X(03)    VALUE SPACES.         02630099
026400     05  FILLER                PIC X(13)    VALUE 'UNJOURNALIZED'.02640010
026500     05  FILLER                PIC X(03)    VALUE SPACES.         02650099
026600     05  FILLER                PIC X(07)    VALUE 'OPEN TO'.      02660009
026700     05  FILLER                PIC X(02)    VALUE SPACES.         02670038
026800     05  FILLER                PIC X(03)    VALUE 'NEW'.          02680009
026900     05  FILLER                PIC X(03)    VALUE SPACES.         02690099
027000                                                                  02700009
027100 01  HDR-LINE5.                                                   02710000
027200     05  FILLER                PIC X(11)    VALUE 'VENDOR NAME'.  02720010
027300     05  FILLER                PIC X(22)    VALUE SPACES.         02730010
027400     05  FILLER                PIC X(06)    VALUE 'NUMBER'.       02740010
027500     05  FILLER                PIC X(04)    VALUE SPACES.         02750037
027600     05  FILLER                PIC X(04)    VALUE 'DEPT'.         02760010
027700     05  FILLER                PIC X(04)    VALUE SPACES.         02770037
027800     05  FILLER                PIC X(06)    VALUE 'NUMBER'.       02780010
027900     05  FILLER                PIC X(03)    VALUE SPACES.         02790037
028000     05  FILLER                PIC X(04)    VALUE 'TYPE'.         02800010
028100     05  FILLER                PIC X(02)    VALUE SPACES.         02810037
028200     05  FILLER                PIC X(04)    VALUE 'TYPE'.         02820010
028300     05  FILLER                PIC X(02)    VALUE SPACES.         02830037
028400     05  FILLER                PIC X(08)    VALUE 'VERIFIED'.     02840010
028500     05  FILLER                PIC X(02)    VALUE SPACES.         02850037
028600     05  FILLER                PIC X(08)    VALUE 'INVOICES'.     02860010
028700     05  FILLER                PIC X(06)    VALUE SPACES.         02870099
028800     05  FILLER                PIC X(03)    VALUE 'QTY'.          02880010
028900     05  FILLER                PIC X(06)    VALUE SPACES.         02890099
029000     05  FILLER                PIC X(08)    VALUE 'VERIFIED'.     02900010
029100     05  FILLER                PIC X(03)    VALUE SPACES.         02910099
029200     05  FILLER                PIC X(08)    VALUE 'INVOICED'.     02920010
029300     05  FILLER                PIC X(03)    VALUE SPACES.         02930099
029400     05  FILLER                PIC X(08)    VALUE 'VARIANCE'.     02940010
029500     05  FILLER                PIC X(08)    VALUE SPACES.         02950099
029600     05  FILLER                PIC X(04)    VALUE 'COST'.         02960037
029700     05  FILLER                PIC X(12)    VALUE SPACES.         02970099
029800     05  FILLER                PIC X(07)    VALUE 'PO COST'.      02980037
029900     05  FILLER                PIC X(05)    VALUE SPACES.         02990099
030000     05  FILLER                PIC X(13)    VALUE 'VERIFIED COST'.03000037
030100     05  FILLER                PIC X(08)    VALUE SPACES.         03010099
030200     05  FILLER                PIC X(03)    VALUE 'NIR'.          03020037
030300     05  FILLER                PIC X(10)    VALUE SPACES.         03030099
030400     05  FILLER                PIC X(09)    VALUE 'RECEIVERS'.    03040038
030500     05  FILLER                PIC X(09)    VALUE SPACES.         03050099
030600     05  FILLER                PIC X(05)    VALUE 'TOTAL'.        03060038
030700     05  FILLER                PIC X(07)    VALUE SPACES.         03070099
030800     05  FILLER                PIC X(06)    VALUE 'BUY DT'.       03080038
030900     05  FILLER                PIC X(03)    VALUE SPACES.         03090038
031000     05  FILLER                PIC X(03)    VALUE 'STR'.          03100038
031100     05  FILLER                PIC X(03)    VALUE SPACES.         03110099
031200                                                                  03120038
031300 01  HDR-LINE6.                                                   03130000
031400     05  FILLER                PIC X(30)    VALUE                 03140011
031500         '------------------------------'.                        03150011
031600     05  FILLER                PIC X(02)    VALUE SPACES.         03160011
031700     05  FILLER                PIC X(09)    VALUE '---------'.    03170011
031800     05  FILLER                PIC X(02)    VALUE SPACES.         03180038
031900     05  FILLER                PIC X(04)    VALUE '----'.         03190011
032000     05  FILLER                PIC X(02)    VALUE SPACES.         03200038
032100     05  FILLER                PIC X(09)    VALUE '---------'.    03210011
032200     05  FILLER                PIC X(02)    VALUE SPACES.         03220038
032300     05  FILLER                PIC X(04)    VALUE '----'.         03230011
032400     05  FILLER                PIC X(02)    VALUE SPACES.         03240038
032500     05  FILLER                PIC X(04)    VALUE '----'.         03250011
032600     05  FILLER                PIC X(02)    VALUE SPACES.         03260038
032700     05  FILLER                PIC X(08)    VALUE '--------'.     03270011
032800     05  FILLER                PIC X(02)    VALUE SPACES.         03280038
032900     05  FILLER                PIC X(08)    VALUE '--------'.     03290011
033000     05  FILLER                PIC X(03)    VALUE SPACES.         03300099
033100     05  FILLER                PIC X(09)    VALUE '---------'.    03310011
033200     05  FILLER                PIC X(03)    VALUE SPACES.         03320099
033300     05  FILLER                PIC X(08)    VALUE '--------'.     03330011
033400     05  FILLER                PIC X(03)    VALUE SPACES.         03340099
033500     05  FILLER                PIC X(08)    VALUE '--------'.     03350011
033600     05  FILLER                PIC X(03)    VALUE SPACES.         03360099
033700     05  FILLER                PIC X(08)    VALUE '--------'.     03370011
033800     05  FILLER                PIC X(03)    VALUE SPACES.         03380099
033900     05  FILLER                PIC X(14)    VALUE                 03390039
034000         '--------------'.                                        03400038
034100     05  FILLER                PIC X(02)    VALUE SPACES.         03410038
034200     05  FILLER                PIC X(14)    VALUE                 03420011
034300         '--------------'.                                        03430011
034400     05  FILLER                PIC X(02)    VALUE SPACES.         03440011
034500     05  FILLER                PIC X(14)    VALUE                 03450011
034600         '--------------'.                                        03460011
034700     05  FILLER                PIC X(03)    VALUE SPACES.         03470099
034800     05  FILLER                PIC X(13)    VALUE                 03480011
034900         '-------------'.                                         03490011
035000     05  FILLER                PIC X(03)    VALUE SPACES.         03500099
035100     05  FILLER                PIC X(13)    VALUE                 03510011
035200         '-------------'.                                         03520011
035300     05  FILLER                PIC X(03)    VALUE SPACES.         03530099
035400     05  FILLER                PIC X(13)    VALUE                 03540011
035500         '-------------'.                                         03550011
035600     05  FILLER                PIC X(03)    VALUE SPACES.         03560099
035700     05  FILLER                PIC X(07)    VALUE '-------'.      03570011
035800     05  FILLER                PIC X(02)    VALUE SPACES.         03580038
035900     05  FILLER                PIC X(03)    VALUE '---'.          03590011
036000     05  FILLER                PIC X(03)    VALUE SPACES.         03600099
036100                                                                  03610011
036200 01  DETAIL-LINE               PIC X(250)   VALUE SPACES.         03620025
036300                                                                  03630000
036400 01  PO-DETAIL-LINE            REDEFINES  DETAIL-LINE.            03640025
036500     05  PDL-VENDOR-NAME         PIC X(30).                       03650025
036600     05  FILLER                  PIC X(02).                       03660026
036700     05  PDL-VENDOR-NUMBER       PIC X(09).                       03670025
036800     05  FILLER                  PIC X(03).                       03680037
036900     05  PDL-DEPARTMENT          PIC X(03).                       03690025
037000     05  FILLER                  PIC X(02).                       03700037
037100     05  PDL-PO-NBR              PIC Z(09).                       03710025
037200     05  FILLER                  PIC X(03).                       03720037
037300     05  PDL-PO-TYPE             PIC X(02).                       03730025
037400     05  FILLER                  PIC X(04).                       03740037
037500     05  PDL-PACK-TYPE           PIC X(03).                       03750025
037600     05  FILLER                  PIC X(04).                       03760099
037700     05  PDL-NBR-DC              PIC ZZ9.                         03770025
037800     05  FILLER                  PIC X(05).                       03780037
037900     05  PDL-NBR-INVOICES        PIC ZZZ,ZZ9.                     03790037
038000     05  FILLER                  PIC X(06).                       03800099
038100     05  PDL-RMS-TOT-QTY         PIC ZZZ,ZZ9.                     03810025
038200     05  FILLER                  PIC X(04).                       03820099
038300     05  PDL-UNTS-VERIFIED       PIC ZZZ,ZZ9.                     03830025
038400     05  FILLER                  PIC X(04).                       03840099
038500     05  PDL-UNTS-INVOICED       PIC ZZZ,ZZ9.                     03850025
038600     05  FILLER                  PIC X(03).                       03860099
038700     05  PDL-UNT-VARIANCE        PIC ZZZ,ZZ9-.                    03870046
??FIX0     05  FILLER                  PIC X(01).                       03880099
??FIX0     05  PDL-RMS-TOT-COST        PIC ZZ,ZZZ,ZZZ,ZZ9.99.           03890099
039000     05  FILLER                  PIC X(02).                       03900099
039100     05  PDL-PO-COST             PIC ZZZ,ZZZ,ZZ9.99.              03910025
039200     05  FILLER                  PIC X(02).                       03920026
039300     05  PDL-VERIFIED-COST       PIC ZZZ,ZZZ,ZZ9.99.              03930025
039400     05  FILLER                  PIC X(03).                       03940099
039500     05  PDL-UNJRNLZD-NIR        PIC ZZ,ZZZ,ZZ9.99.               03950011
039600     05  FILLER                  PIC X(03).                       03960099
039700     05  PDL-UNJRNLZD-RECEIVERS  PIC ZZ,ZZZ,ZZ9.99.               03970011
039800     05  FILLER                  PIC X(03).                       03980099
039900     05  PDL-UNJRNLZD-TOTAL      PIC ZZ,ZZZ,ZZ9.99.               03990011
040000     05  FILLER                  PIC X(03).                       04000099
040100     05  PDL-OTB-PER-NBR         PIC X(06).                       04010011
040200     05  FILLER                  PIC X(04).                       04020026
040300     05  PDL-NEW-STR-PO-IND      PIC X(01).                       04030011
040400     05  FILLER                  PIC X(04).                       04040099
040500                                                                  04050000
040600 01  EOR-END-OF-REPORT.                                           04060000
040700     05  FILLER                  PIC X(112)  VALUE SPACES.        04070011
040800     05  FILLER                  PIC X(26)   VALUE                04080011
040900         '*****  END OF REPORT *****'.                            04090000
041000     05  FILLER                  PIC X(112)  VALUE SPACES.        04100011
041100                                                                  04110000
041200*----------------------------------------------------------------*04120009
041300*  ABEND AREA                                                    *04130009
041400*----------------------------------------------------------------*04140009
041500 01  ABEND-CODE                PIC S9(04)  COMP SYNC VALUE ZERO.  04150009
041600     88  AC-MISSING-DATE-REC                         VALUE +4001. 04160009
041700     88  AC-DB2-ERROR                                VALUE +4013. 04170009
041800                                                                  04180000
041900 01  ABEND-AREAS.                                                 04190000
042000     05  AA-ABEND-LIT                    PIC X(17)  VALUE         04200009
042100             '***** ABEND *****'.                                 04210009
042200     05  AA-PROGRAM-LIT                  PIC X(15)  VALUE         04220009
042300             '***** PROGRAM: '.                                   04230009
042400     05  AA-PARAGRAPH-LIT                PIC X(19)  VALUE         04240009
042500             '***** PARAGRAPH: '.                                 04250000
042600     05  AA-PARAGRAPH-NAME               PIC X(35)  VALUE SPACES. 04260026
042700     05  AA-MESSAGE-LINE.                                         04270000
042800         10  FILLER                      PIC X(06)  VALUE '*****'.04280009
042900         10  AA-MESSAGE                  PIC X(127) VALUE SPACES. 04290009
043000     05  AA-DB2-ERROR-LIT                PIC X(21)  VALUE         04300009
043100         '***** DB2 ERROR *****'.                                 04310009
043200     05  AA-DB2-OPERATION-LIT.                                    04320009
043300         10  FILLER                      PIC X(17)  VALUE         04330009
043400             '***** OPERATION: '.                                 04340009
043500         10  AA-DB2-OPERATION.                                    04350009
043600             15  AA-DB2-OP-1             PIC X(25)  VALUE SPACES. 04360009
043700             15  AA-DB2-OP-2             PIC X(25)  VALUE SPACES. 04370009
043800     05  AA-DB2-TABLE1                   PIC X(08)  VALUE SPACES. 04380009
043900     05  AA-DB2-TABLE2                   PIC X(08)  VALUE SPACES. 04390009
044000     05  AA-DB2-TABLE3                   PIC X(08)  VALUE SPACES. 04400016
044100     05  AA-DB2-TABLE4                   PIC X(08)  VALUE SPACES. 04410016
044200                                                                  04420011
044300*--------------------------------------------------------------*  04430011
044400* DB2 AREA FOR COMMUNICATIONS                                  *  04440011
044500*--------------------------------------------------------------*  04450011
044600     EXEC SQL                                                     04460019
044700          INCLUDE SQLCA                                           04470019
044800     END-EXEC.                                                    04480019
044900                                                                  04490011
045000*--------------------------------------------------------------*  04500011
045100* PURCHASE ORDER TABLE                                         *  04510011
045200*--------------------------------------------------------------*  04520011
045300     EXEC SQL                                                     04530019
045400          INCLUDE TPURCHS                                         04540019
045500     END-EXEC.                                                    04550019
045600                                                                  04560011
045700*--------------------------------------------------------------*  04570011
045800* PURCHASE ORDER LINE ITEM TABLE                               *  04580011
045900*--------------------------------------------------------------*  04590011
046000     EXEC SQL                                                     04600019
046100          INCLUDE TPURITM                                         04610019
046200     END-EXEC.                                                    04620019
046300                                                                  04630011
046400*--------------------------------------------------------------*  04640011
046500* RECEIVING DISTRIBUTION TABLE                                 *  04650011
046600*--------------------------------------------------------------*  04660011
046700     EXEC SQL                                                     04670019
046800          INCLUDE TRECDIS                                         04680019
046900     END-EXEC.                                                    04690019
047000                                                                  04700011
047100*--------------------------------------------------------------*  04710011
047200* PLAN ALLOCATIONS TABLE                                       *  04720032
047300*--------------------------------------------------------------*  04730011
047400     EXEC SQL                                                     04740019
047500          INCLUDE TALLPLN                                         04750032
047600     END-EXEC.                                                    04760019
047700                                                                  04770011
047800*--------------------------------------------------------------*  04780011
047900* INVOICE TABLE                                                *  04790011
048000*--------------------------------------------------------------*  04800011
048100     EXEC SQL                                                     04810019
048200          INCLUDE TINVOIC                                         04820019
048300     END-EXEC.                                                    04830019
048400                                                                  04840011
048500*--------------------------------------------------------------*  04850032
048600* INVOICE ITEM TABLE                                           *  04860032
048700*--------------------------------------------------------------*  04870032
048800     EXEC SQL                                                     04880032
048900          INCLUDE TMDINVC                                         04890099
049000     END-EXEC.                                                    04900032
049100                                                                  04910032
049200*------------------------*                                        04920011
049300 PROCEDURE DIVISION.                                              04930000
049400*------------------------*                                        04940011
049500                                                                  04950000
049600     PERFORM B100-INITIALIZATION.                                 04960012
049700     PERFORM B200-PROCESS-INPUT                                   04970012
049800         UNTIL END-OF-RECEIPT-RECS.                               04980000
049900     PERFORM B300-END-OF-PROGRAM.                                 04990012
050000     GOBACK.                                                      05000000
050100                                                                  05010011
050200*---------------------------------------------------------------* 05020012
050300*  BEGIN PROGRAM STUFF                                          * 05030012
050400*---------------------------------------------------------------* 05040012
050500 B100-INITIALIZATION.                                             05050012
050600                                                                  05060000
050700     ACCEPT CONTROL-CARD-RECORD.                                  05070000
050800     IF CC-REPORT-TYPE = 'P' OR 'W'                               05080000
050900        MOVE CC-REPORT-TITLE              TO HL2-TITLE            05090012
051000     ELSE                                                         05100000
051100        MOVE 'CONTROL REPORT TYPE MUST BE -P- OR -W-'             05110000
051200          TO AA-MESSAGE-LINE                                      05120012
051300        PERFORM Z998-ABEND                                        05130012
051400     END-IF.                                                      05140000
051500                                                                  05150000
051600     ACCEPT SYSTEM-DATE FROM DATE.                                05160012
051700     MOVE SYSTEM-YEAR                 TO DP250O-RUN-YEAR.         05170012
051800     MOVE SYSTEM-MONTH                TO DP250O-RUN-MONTH.        05180012
051900     MOVE SYSTEM-DAY                  TO DP250O-RUN-DAY.          05190012
052000     ACCEPT SYSTEM-TIME FROM TIME.                                05200026
052100     MOVE SYSTEM-HOUR                 TO DP250O-RUN-HOUR.         05210012
052200     MOVE SYSTEM-MINUTE               TO DP250O-RUN-MINUTE.       05220012
052300     MOVE PC-PROGRAM-NAME             TO DP250O-PROGRAM-NAME.     05230012
052400     IF CC-REPORT-TYPE = 'W'                                      05240012
052500        MOVE 1                        TO   DP250O-REPORT-NUMBER   05250012
052600     ELSE                                                         05260012
052700        MOVE 2                        TO   DP250O-REPORT-NUMBER   05270012
052800     END-IF.                                                      05280012
052900     DISPLAY 'RUN DATE = ' SYSTEM-DATE.                           05290012
053000     DISPLAY 'RUN TIME = ' SYSTEM-TIME.                           05300012
053100                                                                  05310012
053200     OPEN INPUT  UNJRNLZD-RECEIPT-DATA-FILE                       05320000
053300          INPUT  UNJRNLZD-RECEIPT-DATE-FILE                       05330000
053400          OUTPUT RPT01-FILE.                                      05340000
053500                                                                  05350000
053600     INITIALIZE DCLTPURCHS                                        05360012
053700                DCLTPURITM                                        05370012
053800                DCLTRECDIS                                        05380012
053900                DCLTINVOIC                                        05390012
054000                DCLTALLPLN                                        05400032
054100                DCLTMDINVC.                                       05410099
054200     INITIALIZE DETAIL-LINE.                                      05420012
054300                                                                  05430012
054400     PERFORM R100-READ-RECEIPT-DATE-FILE.                         05440012
054500                                                                  05450000
054600     MOVE AP108-START-DATE       TO   PW-START-DATE.              05460000
054700     MOVE PW-START-YEAR          TO   PR-START-YEAR.              05470000
054800     MOVE PW-START-MONTH         TO   PR-START-MONTH.             05480000
054900     MOVE PW-START-DAY           TO   PR-START-DAY.               05490000
055000     MOVE PR-START-DATE          TO   HL3-START-DATE.             05500000
055100                                                                  05510000
055200     MOVE AP108-END-DATE         TO   PW-END-DATE.                05520000
055300     MOVE PW-END-YEAR            TO   PR-END-YEAR.                05530000
055400     MOVE PW-END-MONTH           TO   PR-END-MONTH.               05540000
055500     MOVE PW-END-DAY             TO   PR-END-DAY.                 05550000
055600     MOVE PR-END-DATE            TO   HL3-END-DATE.               05560000
055700                                                                  05570000
055800     PERFORM R200-READ-RECEIPT-DATA-FILE.                         05580012
055900     MOVE AP107-PO-NBR           TO PV-PO-BEING-PROCESSED.        05590021
056000     PERFORM W100-WRITE-REPORT-HEADINGS.                          05600042
056100                                                                  05610000
056200*---------------------------------------------------------------* 05620012
056300* PROCESS INPUT DATA                                            * 05630012
056400*---------------------------------------------------------------* 05640012
056500 B200-PROCESS-INPUT.                                              05650012
056600                                                                  05660000
056700     MOVE AP107-VENDOR-NAME          TO PDL-VENDOR-NAME.          05670012
056800     MOVE AP107-VENDOR-NUMBER        TO PDL-VENDOR-NUMBER.        05680012
056900     MOVE AP107-DEPT                 TO PDL-DEPARTMENT.           05690012
057000     MOVE AP107-PO-NBR               TO PDL-PO-NBR.               05700014
057100     PERFORM S050-SELECT-TPURCHS-INFO.                            05710052
057200     MOVE PURCHS-PO-TYP-CDE          TO PDL-PO-TYPE.              05720012
057300     MOVE PURCHS-PKGNG-CDE           TO PDL-PACK-TYPE.            05730012
057400     IF PURCHS-PKGNG-CDE = SPACES                                 05740099
057500        MOVE PC-PBS                  TO PDL-PACK-TYPE             05750099
057600     END-IF.                                                      05760099
057700                                                                  05770070
057800     PERFORM S200-SELECT-DC-ORDERED.                              05780096
057900     PERFORM S250-SELECT-DC-RECEIVED.                             05790096
058000     IF PV-DC-ORDRD-CNT > PV-DC-RCVD-CNT                          05800031
058100        MOVE PV-DC-ORDRD-CNT         TO PDL-NBR-DC                05810031
058200     ELSE                                                         05820031
058300        MOVE PV-DC-RCVD-CNT          TO PDL-NBR-DC                05830031
058400     END-IF.                                                      05840031
058500                                                                  05850073
058600     PERFORM S300-SELECT-INVOICE-INFO.                            05860096
058700     IF PV-NBR-INVOICES EQUAL ZERO                                05870032
058800        MOVE PV-NBR-INVOICES         TO PDL-NBR-INVOICES          05880032
058900        MOVE PV-UNTS-INVOICED-NULL   TO PDL-UNTS-INVOICED         05890072
059000     ELSE                                                         05900014
059100        MOVE PV-NBR-INVOICES         TO PDL-NBR-INVOICES          05910032
059200        MOVE PV-UNTS-INVOICED        TO PDL-UNTS-INVOICED         05920043
059300     END-IF.                                                      05930014
059400                                                                  05940073
059500     IF PURCHS-PKGNG-CDE = 'I' OR 'M'                             05950052
059600        PERFORM S350-SELECT-RMS-QTY                               05960096
059700        MOVE PV-RMS-TOTAL-QTY        TO PDL-RMS-TOT-QTY           05970078
059800     ELSE                                                         05980052
059900        PERFORM S400-SELECT-RMS-QTY                               05990096
060000        MOVE PV-RMS-TOTAL-QTY        TO PDL-RMS-TOT-QTY           06000078
060100     END-IF.                                                      06010052
060200                                                                  06020073
060300     PERFORM S450-SELECT-RMS-COST.                                06030096
060400     MOVE PV-RMS-TOTAL-COST          TO PDL-RMS-TOT-COST.         06040079
060500                                                                  06050073
060600     PERFORM S500-SELECT-UNTS-VERIFIED.                           06060096
060700     MOVE PV-UNTS-VERIFIED           TO PDL-UNTS-VERIFIED.        06070079
060800                                                                  06080073
060900     SUBTRACT PV-UNTS-INVOICED FROM PV-UNTS-VERIFIED              06090032
061000       GIVING PV-UNT-VARIANCE.                                    06100014
061100     MOVE PV-UNT-VARIANCE            TO PDL-UNT-VARIANCE.         06110014
061200     MOVE AP107-PO-COST              TO PDL-PO-COST.              06120032
061300     MOVE AP107-VERIFIED-COST        TO PDL-VERIFIED-COST.        06130014
061400     MOVE AP107-UNJRNLZD-NIR         TO PDL-UNJRNLZD-NIR.         06140012
061500     MOVE AP107-UNJRNLZD-RECEIVER    TO PDL-UNJRNLZD-RECEIVERS.   06150012
061600     ADD AP107-UNJRNLZD-NIR          TO AP107-UNJRNLZD-RECEIVER   06160012
061700         GIVING PV-UNJRNLZD-TOTAL.                                06170012
061800     MOVE PV-UNJRNLZD-TOTAL          TO PDL-UNJRNLZD-TOTAL.       06180012
061900     MOVE AP107-OTB-PER-NBR          TO PDL-OTB-PER-NBR.          06190012
062000     MOVE AP107-NEW-STR-PO-IND       TO PDL-NEW-STR-PO-IND.       06200012
062100                                                                  06210000
062200     PERFORM W200-WRITE-REPORT-DETAIL.                            06220012
062300     INITIALIZE PROGRAM-VARIABLES.                                06230036
062400                                                                  06240022
062500     PERFORM R200-READ-RECEIPT-DATA-FILE.                         06250012
062600     MOVE AP107-PO-NBR               TO PV-PO-BEING-PROCESSED.    06260022
062700                                                                  06270022
062800*---------------------------------------------------------------* 06280012
062900* END OF PROGRAM PROCESSING                                     * 06290012
063000*---------------------------------------------------------------* 06300012
063100 B300-END-OF-PROGRAM.                                             06310012
063200                                                                  06320000
063300     PERFORM W300-WRITE-END-OF-REPORT.                            06330012
063400                                                                  06340000
063500     CLOSE UNJRNLZD-RECEIPT-DATA-FILE                             06350012
063600           UNJRNLZD-RECEIPT-DATE-FILE                             06360012
063700           RPT01-FILE.                                            06370012
063800                                                                  06380000
063900*---------------------------------------------------------------* 06390012
064000* THIS ROUTINE READS THE REPORT DATA FILE FROM APKUT107         * 06400012
064100*---------------------------------------------------------------* 06410012
064200 R200-READ-RECEIPT-DATA-FILE.                                     06420012
064300                                                                  06430000
064400     READ UNJRNLZD-RECEIPT-DATA-FILE INTO AP107-RECORD            06440000
064500       AT END                                                     06450012
064600          SET END-OF-RECEIPT-RECS TO TRUE                         06460012
064700     END-READ.                                                    06470012
064800                                                                  06480000
064900*---------------------------------------------------------------* 06490012
065000* READ INPUT DATE FILE                                          * 06500012
065100*---------------------------------------------------------------* 06510012
065200 R100-READ-RECEIPT-DATE-FILE.                                     06520012
065300                                                                  06530000
065400     READ UNJRNLZD-RECEIPT-DATE-FILE INTO AP108-RECORD            06540000
065500       AT END                                                     06550012
065600          MOVE 'EMPTY UNJOURNALIZED RECEIPT DATES FILE'           06560012
065700            TO AA-MESSAGE                                         06570012
065800          SET AC-MISSING-DATE-REC     TO TRUE                     06580012
065900          PERFORM Z998-ABEND                                      06590012
066000     END-READ.                                                    06600012
066100                                                                  06610000
066200*---------------------------------------------------------------* 06620012
066300* GET THE PO TYPE AND PACK TYPE FROM THE PURCHASE ORDER TABLE   * 06630012
066400*---------------------------------------------------------------* 06640012
066500 S050-SELECT-TPURCHS-INFO.                                        06650052
066600                                                                  06660012
066700     PERFORM WITH TEST AFTER                                      06670012
066800       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       06680012
066900         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  06690012
067000            OR SQLCODE = ZERO                                     06700012
067100                                                                  06710012
067200       EXEC SQL                                                   06720012
067300         SELECT PO_TYP_CDE                                        06730012
067400              , PKGNG_CDE                                         06740012
067500           INTO :PURCHS-PO-TYP-CDE                                06750012
067600              , :PURCHS-PKGNG-CDE                                 06760012
067700           FROM TPURCHS                                           06770012
067800          WHERE PO_NBR = :PV-PO-BEING-PROCESSED                   06780021
067900            AND VER_STATUS_CDE = 'A'                              06790012
068000            AND PO_CATEG_CDE = 'MR'                               06800012
068100       END-EXEC                                                   06810012
068200                                                                  06820012
068300       EVALUATE TRUE                                              06830012
068400         WHEN SQLCODE = ZERO                                      06840012
068500         WHEN SQLCODE = -904                                      06850012
068600         WHEN SQLCODE = -913                                      06860012
068700           CONTINUE                                               06870012
068800         WHEN SQLWARN0 NOT = SPACES                               06880012
068900         WHEN SQLCODE NOT = ZERO                                  06890012
069000           MOVE 'S050-SELECT-TPURCHS-INFO'  TO AA-PARAGRAPH-NAME  06900054
069100           MOVE 'UNSUCCESSFUL SELECT TPURCHS'                     06910016
069200             TO AA-DB2-OPERATION                                  06920016
069300           MOVE 'TPURCHS'                   TO AA-DB2-TABLE1      06930016
069400           MOVE SPACES                      TO AA-DB2-TABLE2      06940016
069500                                               AA-DB2-TABLE3      06950016
069600                                               AA-DB2-TABLE4      06960016
069700           PERFORM Z999-DB2-ABEND                                 06970012
069800       END-EVALUATE                                               06980012
069900     END-PERFORM.                                                 06990012
070000                                                                  07000012
070100     IF PV-RETRY-COUNTER > 3                                      07010012
070200        MOVE 'S050-SELECT-TPURCHS-INFO'     TO AA-PARAGRAPH-NAME  07020054
070300        MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURCHS'             07030012
070400                                            TO AA-DB2-OPERATION   07040016
070500        MOVE 'TPURCHS'                      TO AA-DB2-TABLE1      07050016
070600        MOVE SPACES                         TO AA-DB2-TABLE2      07060016
070700                                               AA-DB2-TABLE3      07070016
070800                                               AA-DB2-TABLE4      07080016
070900        PERFORM Z999-DB2-ABEND                                    07090012
071000     END-IF.                                                      07100012
071100                                                                  07110012
071200*---------------------------------------------------------------* 07120031
071300* GET THE NUMBER OF DCS THAT HAVE ORDERING DATA.                * 07130031
071400*---------------------------------------------------------------* 07140031
071500 S200-SELECT-DC-ORDERED.                                          07150096
071600                                                                  07160031
071700     PERFORM WITH TEST AFTER                                      07170031
071800       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       07180031
071900         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  07190031
072000            OR SQLCODE = ZERO                                     07200031
072100                                                                  07210031
072200       EXEC SQL                                                   07220099
072300          SELECT COUNT(DISTINCT DEST_NBR)                         07230099
072400            INTO :PV-DC-ORDRD-CNT                                 07240099
072500            FROM TALLPLN                                          07250099
072600           WHERE PO_NBR = :PV-PO-BEING-PROCESSED                  07260099
072700             AND CURR_SPLIT_QTY <> 0                              07270099
072800       END-EXEC                                                   07280099
072900                                                                  07290099
073000       EVALUATE TRUE                                              07300031
073100         WHEN SQLCODE = ZERO                                      07310031
073200         WHEN SQLCODE = -904                                      07320031
073300         WHEN SQLCODE = -913                                      07330031
073400           CONTINUE                                               07340031
073500         WHEN SQLWARN0 NOT = SPACES                               07350031
073600         WHEN SQLCODE NOT = ZERO                                  07360031
073700           MOVE 'S200-SELECT-DC-ORDERED'   TO AA-PARAGRAPH-NAME   07370096
073800           MOVE 'UNSUCCESSFUL SELECT TALLPLN'                     07380099
073900             TO AA-DB2-OPERATION                                  07390031
074000           MOVE 'TALLPLN'                  TO AA-DB2-TABLE1       07400099
074100           MOVE SPACES                     TO AA-DB2-TABLE2       07410099
074200                                              AA-DB2-TABLE3       07420099
074300                                              AA-DB2-TABLE4       07430099
074400           PERFORM Z999-DB2-ABEND                                 07440099
074500       END-EVALUATE                                               07450099
074600     END-PERFORM.                                                 07460099
074700                                                                  07470099
074800     IF PV-RETRY-COUNTER > 3                                      07480099
074900        MOVE 'S200-SELECT-DC-ORDERED'      TO AA-PARAGRAPH-NAME   07490099
075000        MOVE 'MAX RETRIES EXCEEDED ON SELECT TALLPLN'             07500099
075100                                           TO AA-DB2-OPERATION    07510099
075200        MOVE 'TALLPLN'                     TO AA-DB2-TABLE1       07520099
075300        MOVE SPACES                        TO AA-DB2-TABLE2       07530099
075400                                              AA-DB2-TABLE3       07540099
075500                                              AA-DB2-TABLE4       07550099
075600        PERFORM Z999-DB2-ABEND                                    07560099
075700     END-IF.                                                      07570099
075800                                                                  07580099
075900*---------------------------------------------------------------* 07590099
076000* GET THE NUMBER OF DCS THAT HAVE RECEIVING DATA.               * 07600099
076100*---------------------------------------------------------------* 07610099
076200 S250-SELECT-DC-RECEIVED.                                         07620099
076300                                                                  07630099
076400     PERFORM WITH TEST AFTER                                      07640099
076500       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       07650099
076600         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  07660099
076700            OR SQLCODE = ZERO                                     07670099
076800                                                                  07680099
076900       EXEC SQL                                                   07690099
077000          SELECT COUNT(DISTINCT OPER_UNT_ID)                      07700099
077100            INTO :PV-DC-RCVD-CNT                                  07710099
077200            FROM TRECDIS                                          07720099
077300           WHERE ORD_NBR = :PV-PO-BEING-PROCESSED                 07730099
077400             AND VER_STATUS_CDE = 'A'                             07740099
077500             AND AP_VERIFY_ITM_QTY <> 0                           07750099
077600       END-EXEC                                                   07760099
077700                                                                  07770099
077800       EVALUATE TRUE                                              07780031
077900         WHEN SQLCODE = ZERO                                      07790031
078000         WHEN SQLCODE = -904                                      07800031
078100         WHEN SQLCODE = -913                                      07810031
078200           CONTINUE                                               07820031
078300         WHEN SQLWARN0 NOT = SPACES                               07830031
078400         WHEN SQLCODE NOT = ZERO                                  07840031
078500           MOVE 'S250-SELECT-DC-RECEIVED'  TO AA-PARAGRAPH-NAME   07850096
078600           MOVE 'UNSUCCESSFUL SELECT TRECDIS'                     07860099
078700             TO AA-DB2-OPERATION                                  07870031
078800           MOVE 'TRECDIS'                  TO AA-DB2-TABLE1       07880099
078900           MOVE SPACES                     TO AA-DB2-TABLE2       07890099
079000                                              AA-DB2-TABLE3       07900099
079100                                              AA-DB2-TABLE4       07910099
079200           PERFORM Z999-DB2-ABEND                                 07920099
079300       END-EVALUATE                                               07930099
079400     END-PERFORM.                                                 07940099
079500                                                                  07950099
079600     IF PV-RETRY-COUNTER > 3                                      07960099
079700        MOVE 'S250-SELECT-DC-RECEIVED'     TO AA-PARAGRAPH-NAME   07970099
079800        MOVE 'MAX RETRIES EXCEEDED ON SELECT TRECDIS'             07980099
079900                                           TO AA-DB2-OPERATION    07990099
080000        MOVE 'TRECDIS'                     TO AA-DB2-TABLE1       08000099
080100        MOVE SPACES                        TO AA-DB2-TABLE2       08010099
080200                                              AA-DB2-TABLE3       08020099
080300                                              AA-DB2-TABLE4       08030031
080400        PERFORM Z999-DB2-ABEND                                    08040031
080500     END-IF.                                                      08050031
080600                                                                  08060031
080700*---------------------------------------------------------------* 08070032
080800* GET THE NUMBER OF INVOICES AND THE UNITS INVOICED             * 08080032
080900*---------------------------------------------------------------* 08090032
081000 S300-SELECT-INVOICE-INFO.                                        08100096
081100                                                                  08110032
081200     PERFORM WITH TEST AFTER                                      08120032
081300       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       08130032
081400         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  08140032
081500            OR SQLCODE = ZERO                                     08150032
081600                                                                  08160032
081700       EXEC SQL                                                   08170032
081800          SELECT SUM(B.TOT_INVC_PC_QTY)                           08180099
081900               , COUNT(DISTINCT A.INVC_ID)                        08190099
082000           INTO :PV-UNTS-INVOICED:PV-UNTS-INVOICED-NULL           08200040
082100              , :PV-NBR-INVOICES                                  08210032
082200           FROM TINVOIC A                                         08220099
082300              , TMDINVC B                                         08230099
082400          WHERE A.PO_NBR  = B.PO_NBR                              08240099
082500            AND A.INVC_ID = B.INVC_ID                             08250099
082600            AND A.ENTR_MTHD_CDE = 'ED'                            08260099
082700            AND A.STATUS_CDE <> 'DE'                              08270099
082800            AND A.PO_NBR = :PV-PO-BEING-PROCESSED                 08280099
082900       END-EXEC                                                   08290032
083000                                                                  08300032
083100       EVALUATE TRUE                                              08310032
083200         WHEN SQLCODE = ZERO                                      08320032
083300           IF PV-UNTS-INVOICED-NULL < 0 THEN                      08330081
083400              MOVE ZERO                TO PV-UNTS-INVOICED-NULL   08340081
083500           END-IF                                                 08350077
083600           PERFORM U300-COMMIT                                    08360099
083700         WHEN SQLCODE = -904                                      08370032
083800         WHEN SQLCODE = -913                                      08380032
083900           CONTINUE                                               08390032
084000         WHEN SQLWARN0 NOT = SPACES                               08400032
084100         WHEN SQLCODE NOT = ZERO                                  08410032
084200           MOVE 'S300-SELECT-INVOICE-INFO' TO AA-PARAGRAPH-NAME   08420096
084300           MOVE 'UNSUCCESSFUL SELECT TINVOIC'                     08430099
084400             TO AA-DB2-OPERATION                                  08440032
084500           MOVE 'TINVOIC'                  TO AA-DB2-TABLE1       08450099
084600           MOVE 'TMDINVC'                  TO AA-DB2-TABLE2       08460099
084700           MOVE SPACES                     TO AA-DB2-TABLE3       08470099
084800                                              AA-DB2-TABLE4       08480099
084900           PERFORM Z999-DB2-ABEND                                 08490032
085000       END-EVALUATE                                               08500032
085100     END-PERFORM.                                                 08510032
085200                                                                  08520032
085300     IF PV-RETRY-COUNTER > 3                                      08530032
085400        MOVE 'S300-SELECT-INVOICE-INFO'    TO AA-PARAGRAPH-NAME   08540096
085500        MOVE 'MAX RETRIES EXCEEDED ON SELECT TINVOIC'             08550099
085600                                           TO AA-DB2-OPERATION    08560032
085700        MOVE 'TINVOIC'                     TO AA-DB2-TABLE1       08570099
085800        MOVE 'TMDINVC'                     TO AA-DB2-TABLE2       08580099
085900        MOVE SPACES                        TO AA-DB2-TABLE3       08590099
086000                                              AA-DB2-TABLE4       08600099
086100        PERFORM Z999-DB2-ABEND                                    08610032
086200     END-IF.                                                      08620032
086300                                                                  08630032
086400*---------------------------------------------------------------* 08640052
086500* GET THE RMS TOTAL QUANTITY WHEN THE PKGNG_CDE IS 'I' OR 'M'   * 08650052
086600*---------------------------------------------------------------* 08660052
086700 S350-SELECT-RMS-QTY.                                             08670096
086800                                                                  08680052
086900     PERFORM WITH TEST AFTER                                      08690052
087000       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       08700052
087100         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  08710052
087200            OR SQLCODE = ZERO                                     08720052
087300                                                                  08730052
087400       EXEC SQL                                                   08740052
087500          SELECT SUM(UNT_QTY + CNCLD_UNT_QTY)                     08750052
087600           INTO :PV-RMS-TOTAL-QTY                                 08760078
087700           FROM TPURITM                                           08770052
087800          WHERE PO_NBR = :PV-PO-BEING-PROCESSED                   08780052
087900            AND VER_STATUS_CDE = 'A'                              08790052
088000            AND PO_PREPK_ID > 0                                   08800052
088100       END-EXEC                                                   08810052
088200                                                                  08820052
088300       EVALUATE TRUE                                              08830052
088400         WHEN SQLCODE = ZERO                                      08840052
088500         WHEN SQLCODE = -904                                      08850052
088600         WHEN SQLCODE = -913                                      08860052
088700           CONTINUE                                               08870052
088800         WHEN SQLWARN0 NOT = SPACES                               08880052
088900         WHEN SQLCODE NOT = ZERO                                  08890052
089000           MOVE 'S350-SELECT-RMS-QTY'      TO AA-PARAGRAPH-NAME   08900096
089100           MOVE 'UNSUCCESSFUL SELECT TPURITM'                     08910052
089200             TO AA-DB2-OPERATION                                  08920052
089300           MOVE 'TPURITM'                  TO AA-DB2-TABLE1       08930052
089400           MOVE SPACES                     TO AA-DB2-TABLE2       08940052
089500                                              AA-DB2-TABLE3       08950052
089600                                              AA-DB2-TABLE4       08960052
089700           PERFORM Z999-DB2-ABEND                                 08970052
089800       END-EVALUATE                                               08980052
089900     END-PERFORM.                                                 08990052
090000                                                                  09000052
090100     IF PV-RETRY-COUNTER > 3                                      09010052
090200        MOVE 'S350-SELECT-RMS-QTY'         TO AA-PARAGRAPH-NAME   09020096
090300        MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'             09030052
090400                                           TO AA-DB2-OPERATION    09040052
090500        MOVE 'TPURITM'                     TO AA-DB2-TABLE1       09050052
090600        MOVE SPACES                        TO AA-DB2-TABLE2       09060052
090700                                              AA-DB2-TABLE3       09070052
090800                                              AA-DB2-TABLE4       09080052
090900        PERFORM Z999-DB2-ABEND                                    09090052
091000     END-IF.                                                      09100052
091100                                                                  09110052
091200*---------------------------------------------------------------* 09120052
091300* GET THE RMS TOTAL QUANTITY WHEN THE PKGNG_CDE IS NOT 'I' OR   * 09130052
091400* 'M'                                                           * 09140052
091500*---------------------------------------------------------------* 09150052
091600 S400-SELECT-RMS-QTY.                                             09160096
091700                                                                  09170052
091800     PERFORM WITH TEST AFTER                                      09180052
091900       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       09190052
092000         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  09200052
092100            OR SQLCODE = ZERO                                     09210052
092200                                                                  09220052
092300       EXEC SQL                                                   09230052
092400          SELECT SUM(UNT_QTY + CNCLD_UNT_QTY)                     09240052
092500           INTO :PV-RMS-TOTAL-QTY                                 09250078
092600           FROM TPURITM                                           09260052
092700          WHERE PO_NBR = :PV-PO-BEING-PROCESSED                   09270052
092800            AND VER_STATUS_CDE = 'A'                              09280052
092900            AND PO_PREPK_ID = 0                                   09290052
093000       END-EXEC                                                   09300052
093100                                                                  09310052
093200       EVALUATE TRUE                                              09320052
093300         WHEN SQLCODE = ZERO                                      09330052
093400         WHEN SQLCODE = -904                                      09340052
093500         WHEN SQLCODE = -913                                      09350052
093600           CONTINUE                                               09360052
093700         WHEN SQLWARN0 NOT = SPACES                               09370052
093800         WHEN SQLCODE NOT = ZERO                                  09380052
093900           MOVE 'S400-SELECT-RMS-QTY'      TO AA-PARAGRAPH-NAME   09390096
094000           MOVE 'UNSUCCESSFUL SELECT TPURITM'                     09400052
094100             TO AA-DB2-OPERATION                                  09410052
094200           MOVE 'TPURITM'                  TO AA-DB2-TABLE1       09420052
094300           MOVE SPACES                     TO AA-DB2-TABLE2       09430052
094400                                              AA-DB2-TABLE3       09440052
094500                                              AA-DB2-TABLE4       09450052
094600           PERFORM Z999-DB2-ABEND                                 09460052
094700       END-EVALUATE                                               09470052
094800     END-PERFORM.                                                 09480052
094900                                                                  09490052
095000     IF PV-RETRY-COUNTER > 3                                      09500052
095100        MOVE 'S400-SELECT-RMS-QTY'         TO AA-PARAGRAPH-NAME   09510096
095200        MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'             09520052
095300                                           TO AA-DB2-OPERATION    09530052
095400        MOVE 'TPURITM'                     TO AA-DB2-TABLE1       09540052
095500        MOVE SPACES                        TO AA-DB2-TABLE2       09550052
095600                                              AA-DB2-TABLE3       09560052
095700                                              AA-DB2-TABLE4       09570052
095800        PERFORM Z999-DB2-ABEND                                    09580052
095900     END-IF.                                                      09590052
096000                                                                  09600052
096100*---------------------------------------------------------------* 09610012
096200* GET THE RMS TOTAL COST                                        * 09620052
096300*---------------------------------------------------------------* 09630012
096400 S450-SELECT-RMS-COST.                                            09640096
096500                                                                  09650012
096600     PERFORM WITH TEST AFTER                                      09660012
096700       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       09670012
096800         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  09680012
096900            OR SQLCODE = ZERO                                     09690012
097000                                                                  09700012
097100       EXEC SQL                                                   09710012
097200         SELECT SUM((TOT_VAL_COST_AMT) +                          09720052
097300                    (CNCLD_UNT_QTY * UNT_COST_AMT))               09730032
097400           INTO :PV-RMS-TOTAL-COST                                09740079
097500           FROM TPURITM                                           09750012
097600          WHERE PO_NBR = :PV-PO-BEING-PROCESSED                   09760021
097700            AND VER_STATUS_CDE = 'A'                              09770012
097800       END-EXEC                                                   09780012
097900                                                                  09790012
098000       EVALUATE TRUE                                              09800012
098100         WHEN SQLCODE = ZERO                                      09810012
098200         WHEN SQLCODE = -904                                      09820012
098300         WHEN SQLCODE = -913                                      09830012
098400           CONTINUE                                               09840012
098500         WHEN SQLWARN0 NOT = SPACES                               09850012
098600         WHEN SQLCODE NOT = ZERO                                  09860012
098700           MOVE 'S450-SELECT-RMS-COST'      TO AA-PARAGRAPH-NAME  09870096
098800           MOVE 'UNSUCCESSFUL SELECT TPURITM'                     09880016
098900             TO AA-DB2-OPERATION                                  09890016
099000           MOVE 'TPURITM'                   TO AA-DB2-TABLE1      09900016
099100           MOVE SPACES                      TO AA-DB2-TABLE2      09910016
099200                                               AA-DB2-TABLE3      09920016
099300                                               AA-DB2-TABLE4      09930016
099400           PERFORM Z999-DB2-ABEND                                 09940012
099500       END-EVALUATE                                               09950012
099600     END-PERFORM.                                                 09960012
099700                                                                  09970012
099800     IF PV-RETRY-COUNTER > 3                                      09980012
099900        MOVE 'S450-SELECT-RMS-COST'         TO AA-PARAGRAPH-NAME  09990096
100000        MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'             10000012
100100                                            TO AA-DB2-OPERATION   10010016
100200        MOVE 'TPURITM'                      TO AA-DB2-TABLE1      10020016
100300        MOVE SPACES                         TO AA-DB2-TABLE2      10030016
100400                                               AA-DB2-TABLE3      10040016
100500                                               AA-DB2-TABLE4      10050016
100600        PERFORM Z999-DB2-ABEND                                    10060012
100700     END-IF.                                                      10070012
100800                                                                  10080012
100900*---------------------------------------------------------------* 10090032
101000* GET THE UNITS VERIFIED                                        * 10100032
101100*---------------------------------------------------------------* 10110032
101200 S500-SELECT-UNTS-VERIFIED.                                       10120096
101300                                                                  10130032
101400     PERFORM WITH TEST AFTER                                      10140032
101500       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       10150032
101600         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  10160032
101700            OR SQLCODE = ZERO                                     10170032
101800                                                                  10180032
101900       EXEC SQL                                                   10190032
102000         SELECT SUM(AP_VERIFY_ITM_QTY)                            10200032
102100           INTO :PV-UNTS-VERIFIED                                 10210079
102200           FROM TRECDIS                                           10220032
102300          WHERE ORD_NBR = :PV-PO-BEING-PROCESSED                  10230032
102400            AND VER_STATUS_CDE = 'A'                              10240032
102500       END-EXEC                                                   10250032
102600                                                                  10260032
102700       EVALUATE TRUE                                              10270032
102800         WHEN SQLCODE = ZERO                                      10280032
102900         WHEN SQLCODE = -904                                      10290032
103000         WHEN SQLCODE = -913                                      10300032
103100           CONTINUE                                               10310032
103200         WHEN SQLWARN0 NOT = SPACES                               10320032
103300         WHEN SQLCODE NOT = ZERO                                  10330032
103400           MOVE 'S500-SELECT-UNTS-VERIFIED' TO AA-PARAGRAPH-NAME  10340096
103500           MOVE 'UNSUCCESSFUL SELECT TRECDIS'                     10350032
103600             TO AA-DB2-OPERATION                                  10360032
103700           MOVE 'TRECDIS'                   TO AA-DB2-TABLE1      10370032
103800           MOVE SPACES                      TO AA-DB2-TABLE2      10380032
103900                                               AA-DB2-TABLE3      10390032
104000                                               AA-DB2-TABLE4      10400032
104100           PERFORM Z999-DB2-ABEND                                 10410032
104200       END-EVALUATE                                               10420032
104300     END-PERFORM.                                                 10430032
104400                                                                  10440032
104500     IF PV-RETRY-COUNTER > 3                                      10450032
104600        MOVE 'S500-SELECT-UNTS-VERIFIED'    TO AA-PARAGRAPH-NAME  10460096
104700        MOVE 'MAX RETRIES EXCEEDED ON SELECT TRECDIS'             10470032
104800                                            TO AA-DB2-OPERATION   10480032
104900        MOVE 'TRECDIS'                      TO AA-DB2-TABLE1      10490032
105000        MOVE SPACES                         TO AA-DB2-TABLE2      10500032
105100                                               AA-DB2-TABLE3      10510032
105200                                               AA-DB2-TABLE4      10520032
105300        PERFORM Z999-DB2-ABEND                                    10530032
105400     END-IF.                                                      10540032
105500                                                                  10550032
105600*--------------------------------------------------------------*  10560099
105700* PERFORM COMMIT TO RELEASE CLAIMS ON TINVOIC AND TMDINVC      *  10570099
105800* TABLES TO AVOID CONTENTION WITH DB2 REORG JOBS.              *  10580099
105900*--------------------------------------------------------------*  10590099
106000 U300-COMMIT.                                                     10600099
106100                                                                  10610099
106200     EXEC SQL                                                     10620099
106300         COMMIT                                                   10630099
106400     END-EXEC.                                                    10640099
106500                                                                  10650099
106600     EVALUATE TRUE                                                10660099
106700         WHEN SQLCODE = ZEROS                                     10670099
106800              CONTINUE                                            10680099
106900         WHEN OTHER                                               10690099
107000             MOVE 'U300-COMMIT'  TO AA-PARAGRAPH-NAME             10700099
107100             MOVE 'UNSUCCESSFUL COMMIT'                           10710099
107200                                 TO AA-DB2-OPERATION              10720099
107300             MOVE SPACES         TO AA-DB2-TABLE1                 10730099
107400                                    AA-DB2-TABLE2                 10740099
107500                                    AA-DB2-TABLE3                 10750099
107600                                    AA-DB2-TABLE4                 10760099
107700             PERFORM Z999-DB2-ABEND                               10770099
107800     END-EVALUATE.                                                10780099
107900                                                                  10790099
108000*---------------------------------------------------------------* 10800012
108100* WRITE REPORT HEADINGS                                         * 10810012
108200*---------------------------------------------------------------* 10820012
108300 W100-WRITE-REPORT-HEADINGS.                                      10830012
108400                                                                  10840012
108500     INITIALIZE LINE-COUNT.                                       10850012
108600     ADD 1                             TO PAGE-COUNT.             10860012
108700     MOVE PAGE-COUNT                   TO DP250O-PAGE-NUMBER.     10870012
108800     WRITE RPT01-RECORD                                           10880012
108900           FROM DP250O-STANDRD-HEADER-250-COLS AFTER PAGE.        10890026
109000                                                                  10900012
109100     WRITE RPT01-RECORD                FROM HDR-LINE2 AFTER 1.    10910012
109200     WRITE RPT01-RECORD                FROM HDR-LINE3 AFTER 1.    10920012
109300     WRITE RPT01-RECORD                FROM BLANK-LINE AFTER 1.   10930012
109400     WRITE RPT01-RECORD                FROM HDR-LINE4 AFTER 1.    10940012
109500     WRITE RPT01-RECORD                FROM HDR-LINE5 AFTER 1.    10950012
109600     WRITE RPT01-RECORD                FROM HDR-LINE6 AFTER 1.    10960012
109700     ADD 7                             TO LINE-COUNT.             10970012
109800                                                                  10980012
109900*---------------------------------------------------------------* 10990012
110000* WRITE REPORT DETAIL                                           * 11000012
110100*---------------------------------------------------------------* 11010012
110200 W200-WRITE-REPORT-DETAIL.                                        11020012
110300                                                                  11030028
110400     IF LINE-COUNT > PC-MAX-LINES                                 11040026
110500        PERFORM W100-WRITE-REPORT-HEADINGS                        11050012
110600     END-IF.                                                      11060012
110700                                                                  11070012
110800     WRITE RPT01-RECORD                FROM DETAIL-LINE AFTER 1.  11080012
110900     ADD 1                             TO LINE-COUNT.             11090012
111000     INITIALIZE DETAIL-LINE.                                      11100026
111100                                                                  11110012
111200*---------------------------------------------------------------* 11120012
111300* WRITE END OF REPORT LINE                                      * 11130012
111400*---------------------------------------------------------------* 11140012
111500 W300-WRITE-END-OF-REPORT.                                        11150012
111600                                                                  11160012
111700     WRITE RPT01-RECORD FROM EOR-END-OF-REPORT AFTER 1.           11170012
111800                                                                  11180012
111900*---------------------------------------------------------------* 11190012
112000* ABEND ROUTINE                                                 * 11200012
112100*---------------------------------------------------------------* 11210012
112200 Z998-ABEND.                                                      11220012
112300                                                                  11230000
112400     DISPLAY '*** PROGRAM   = ' PC-PROGRAM-NAME.                  11240009
112500     DISPLAY '*** MESSAGE   = ' AA-MESSAGE-LINE.                  11250000
112600                                                                  11260000
112700     CALL 'ILBOABN0'            USING ABEND-CODE.                 11270000
112800                                                                  11280000
112900*---------------------------------------------------------------* 11290012
113000* DB2 ABEND ROUTINE                                             * 11300012
113100*---------------------------------------------------------------* 11310012
113200 Z999-DB2-ABEND.                                                  11320012
113300                                                                  11330012
113400     DISPLAY AA-ABEND-LIT.                                        11340012
113500     DISPLAY AA-DB2-ERROR-LIT.                                    11350012
113600     DISPLAY AA-PROGRAM-LIT.                                      11360012
113700     DISPLAY AA-PARAGRAPH-LIT.                                    11370012
113800     DISPLAY AA-DB2-OPERATION-LIT.                                11380012
113900     DISPLAY AA-DB2-TABLE1.                                       11390012
114000     DISPLAY AA-DB2-TABLE2.                                       11400012
114100     SET AC-DB2-ERROR TO TRUE.                                    11410012
114200                                                                  11420012
114300     COPY DPPD004.                                                11430012
114400     CALL 'ILBOABN0' USING ABEND-CODE.                            11440012
