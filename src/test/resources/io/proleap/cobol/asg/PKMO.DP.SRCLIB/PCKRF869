000100 IDENTIFICATION DIVISION.                                         00010001
000200 TITLE 'MANIFESTING - MANAGE TRAILER MENU'.                       00020001
000300 PROGRAM-ID.             PCKRF869.                                00030001
000400 AUTHOR.                 DENNIS STEFFEN.                          00040001
000500 INSTALLATION.           KOHLS.                                   00050001
000600 DATE-WRITTEN            APRIL, 2001.                             00060001
000700 DATE-COMPILED.                                                   00070001
000800                                                                  00080001
000900******************************************************************00090001
001000* THIS PROGRAM IS DISPLAYED BY SELECTING OPTION 2,                00100001
001100* MANAGE TRAILER, ON THE SHIPPING MENU (PCKRF868) SCREEN.         00110001
001200******************************************************************00120001
001300                                                                  00130001
001400 ENVIRONMENT DIVISION.                                            00140001
001500 DATA DIVISION.                                                   00150001
001600                                                                  00160001
001700 WORKING-STORAGE SECTION.                                         00170001
001800 01  CA-COMMAREA.                                                 00180001
001900     COPY PCWS233.                                                00190001
002000     05  CA-PROGRAM-DATA.                                         00200001
002100         10  CA-SELECTION-X              PIC  X(01)  VALUE SPACE. 00210001
002200             88  CA-VALID-SELECTION                  VALUE        00220001
002300                 '1', '2', '3', '4', '5', 'T'.                    00230001
002400             88  CA-SELECTION-TEST                   VALUE 'T'.   00240001
002500         10  CA-SELECTION  REDEFINES  CA-SELECTION-X              00250001
002600                                         PIC  9(01).              00260001
002700             88  CA-OPEN-TRAILER-SELECTION           VALUE 1.     00270001
002800             88  CA-CLOSE-TRAILER-SELECTION          VALUE 2.     00280001
002900             88  CA-CONVEYOR-CUTOFF-SELECTION        VALUE 3.     00290001
003000             88  CA-LOAD-UNLOAD-TRAILER              VALUE 4.     00300001
003100             88  CA-TRAILER-STATUS                   VALUE 5.     00310001
003200                                                                  00320001
003300* HELP SCREEN COMMAREA                                            00330001
003400     COPY PCWS192.                                                00340001
003500* HELP SCREEN WORK AREA                                           00350001
003600     COPY PCWS188.                                                00360001
003700/                                                                 00370001
003800 01  PC-PROGRAM-CONSTANTS.                                        00380001
003900     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00390001
004000         'PCKRF869'.                                              00400001
004100     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        00410001
004200         'END OF SESSION     '.                                   00420001
004300     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        00430001
004400         'INVALID SELECTION  '.                                   00440001
004500     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        00450001
004600         'UNRECOGNIZED PF KEY'.                                   00460001
004700     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        00470001
004800         'USER NOT AUTHORIZED'.                                   00480001
004900     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        00490001
005000         'NUMERIC VALUE REQ. '.                                   00500001
005100     05  PC-PROGRAM-FUNCTION-KEYS        PIC  X(19)  VALUE        00510001
005200         'F3 =END            '.                                   00520001
005300     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        00530001
005400         'TRANS NOT AVAILABLE'.                                   00540001
005500     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        00550001
005600         'CICS ABEND -CALL DP'.                                   00560001
005700     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        00570001
005800         'CICSAUTH BAD RETURN'.                                   00580001
005900     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        00590001
006000         'SELECTION NOT AVAIL'.                                   00600001
006400                                                                  00640001
006500 01  PN-PGM-NAME-DATA.                                            00650001
006600     05  PN-SELECTION-01-PROGRAM         PIC  X(08)  VALUE        00660001
006700         'PCKRF870'.                                              00670001
006800     05  PN-SELECTION-02-PROGRAM         PIC  X(08)  VALUE        00680001
006900         'PCKRF876'.                                              00690001
007000     05  PN-SELECTION-03-PROGRAM         PIC  X(08)  VALUE        00700001
007100         'PCKRF872'.                                              00710001
007200     05  PN-SELECTION-04-PROGRAM         PIC  X(08)  VALUE        00720001
007300         'PCKRF878'.                                              00730001
007400     05  PN-SELECTION-05-PROGRAM         PIC  X(08)  VALUE        00740001
007500         'PCKRF898'.                                              00750001
007600                                                                  00760001
007700 01  PN-PGM-NAME-TABLE  REDEFINES  PN-PGM-NAME-DATA.              00770001
007800     05  PN-PGM-NAME  OCCURS 5 TIMES                              00780001
007900                      INDEXED BY PN-INDX                          00790001
008000                                         PIC  X(08).              00800001
008100                                                                  00810001
008200 01  PS-PROGRAM-SWITCHES.                                         00820001
008300     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   00830001
008400         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   00840001
008500         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   00850001
008600                                                                  00860001
008700 01  PV-PROGRAM-VARIABLES.                                        00870001
008800     05  PV-TIMESTAMP                 PIC X(26) VALUE SPACES.     00880001
008900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00890001
009000                                                     COMP SYNC.   00900001
009100     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00910001
009200     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  00920001
009300                                                     COMP SYNC.   00930001
009400     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 00940001
009500                                                                  00950001
009600     COPY DPWS026.                                                00960001
009700                                                                  00970001
009800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00980001
009900     COPY DPWS013.                                                00990001
010000                                                                  01000001
010100*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        01010001
010200     COPY DPWS008.                                                01020001
010300                                                                  01030001
010400*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01040001
010500     COPY DPWS010I.                                               01050001
010600                                                                  01060001
010700*  MAPSET                                                         01070001
010800     COPY PCKM869.                                                01080001
010900                                                                  01090001
011000*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01100001
011100     COPY DPWS015.                                                01110001
011200                                                                  01120001
011300     COPY DFHAID.                                                 01130001
011400                                                                  01140001
011500     EXEC SQL                                                     01150001
011600         INCLUDE SQLCA                                            01160001
011700     END-EXEC.                                                    01170001
011800                                                                  01180001
011900 LINKAGE SECTION.                                                 01190001
012000 01  DFHCOMMAREA.                                                 01200001
012100     05  FILLER                       OCCURS 1 TO 4072 TIMES      01210001
012200                                      DEPENDING ON EIBCALEN.      01220001
012300         10  FILLER                   PIC X.                      01230001
012400/                                                                 01240001
012500 PROCEDURE DIVISION.                                              01250001
012600 0000-PROGRAM-MAINLINE.                                           01260001
012700     INITIALIZE CA-COMMAREA.                                      01270001
012800     MOVE DFHCOMMAREA                 TO CA-COMMAREA.             01280001
012900     MOVE LOW-VALUES                  TO PC869AI.                 01290001
013000                                                                  01300001
013100     EVALUATE TRUE                                                01310001
013200         WHEN EIBCALEN = ZERO                                     01320001
013300         WHEN EIBTRNID = 'Z278'                                   01330001
013400         WHEN EIBAID = DFHCLEAR                                   01340001
013500         WHEN PC233-INITIALIZE-SCREEN                             01350001
013600             PERFORM 1000-INITIALIZE                              01360001
013700             PERFORM 8000-SEND-MAP                                01370001
013800             PERFORM 8200-RETURN-TRANID                           01380001
013900         WHEN EIBAID = DFHENTER                                   01390001
014000             PERFORM 8300-RECEIVE-MAP                             01400001
014100             PERFORM 2000-PROCESS-SELECTION                       01410001
014200         WHEN EIBAID = DFHPF3                                     01420001
014300              MOVE 'PCKRF868'         TO PV-TRANSFER-PROGRAM      01430001
014400              PERFORM 2100-XCTL-TO-SELECTED-PROGRAM               01440001
014500         WHEN EIBAID = DFHPF1                                     01450001
014600              PERFORM 1200-HELP-SCREEN                            01460001
014700         WHEN OTHER                                               01470001
014800             PERFORM 8300-RECEIVE-MAP                             01480001
014900              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     01490001
015000                                     TO AMSGLNO                   01500001
015100              PERFORM 8100-SEND-DATA-ONLY                         01510001
015200              PERFORM 8200-RETURN-TRANID                          01520001
015300     END-EVALUATE.                                                01530001
015400                                                                  01540001
015500     GOBACK.                                                      01550001
015600                                                                  01560001
015700 1000-INITIALIZE.                                                 01570001
015800     EXEC SQL                                                     01580001
015900         SET :PV-TIMESTAMP = CURRENT TIMESTAMP                    01590001
016000     END-EXEC                                                     01600001
016100                                                                  01610001
016200     INITIALIZE CA-COMMAREA                                       01620001
016300     PERFORM 1010-RECEIVE-SCREEN-FIELDS.                          01630001
016400                                                                  01640001
016500 1010-RECEIVE-SCREEN-FIELDS.                                      01650001
016600     IF  ASELECTL > ZERO                                          01660001
016700         MOVE ASELECTI                TO CA-SELECTION-X           01670001
016800     END-IF.                                                      01680001
016900                                                                  01690001
017000*                                                                 01700001
017100 1200-HELP-SCREEN.                                                01710001
017200     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      01720001
017300     MOVE 'PCKRF869'                  TO PC192-PROGRAM-NAME       01730001
017400     COPY PCPD188.                                                01740001
017500     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      01750001
017600     PERFORM 2200-XCTL-TO-HELP.                                   01760001
017700*                                                                 01770001
017800*                                                                 01780001
017900 2000-PROCESS-SELECTION.                                          01790001
018000                                                                  01800001
018100     PERFORM 2100-EDIT-SELECTION.                                 01810001
018200     SET PN-INDX                     TO CA-SELECTION.             01820001
018300     IF CA-SELECTION < 5                                          01830001
018400         PERFORM 9000-CHECK-RACF                                  01840001
018500     ELSE                                                         01850001
019000         MOVE PN-PGM-NAME (PN-INDX)  TO PV-TRANSFER-PROGRAM       01900001
019100         PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                    01910001
019300     END-IF.                                                      01930001
019400                                                                  01940001
019500     IF  PS-ACCESS-ALLOWED                                        01950001
019600         MOVE PN-PGM-NAME (PN-INDX)  TO PV-TRANSFER-PROGRAM       01960001
019700         PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                    01970001
019800     ELSE                                                         01980001
019900         MOVE DP015-UNP-ALP-BRT-MDT  TO ASELECTA                  01990001
020000         PERFORM 8100-SEND-DATA-ONLY                              02000001
020100         PERFORM 8200-RETURN-TRANID                               02010001
020200     END-IF.                                                      02020001
020300*                                                                 02030001
020400 2100-EDIT-SELECTION.                                             02040001
020500                                                                  02050001
020600     IF  CA-SELECTION-TEST                                        02060001
020700         CONTINUE                                                 02070001
020800     ELSE                                                         02080001
020900         MOVE CA-SELECTION-X         TO DP010I-UNEDITED-FIELD     02090001
021000         MOVE 1                      TO DP010I-MAXIMUM-DIGITS     02100001
021100         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   02110001
021200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  02120001
021300                                                                  02130001
021410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         02141004
021420                         USING DP010I-NUMERIC-EDIT-AREA           02142004
021500                                                                  02150001
021600         IF  DP010I-ERROR-DETECTED                                02160001
021700             MOVE PC-NON-NUMERIC-SELECTION-MSG TO AMSGLNO         02170001
021800             PERFORM 8100-SEND-DATA-ONLY                          02180001
021900             PERFORM 8200-RETURN-TRANID                           02190001
022000         ELSE                                                     02200001
022100             MOVE DP010I-NUMERIC-FIELD   TO CA-SELECTION          02210001
022200         END-IF                                                   02220001
022300     END-IF.                                                      02230001
022400                                                                  02240001
022500     EVALUATE CA-SELECTION                                        02250001
022600     WHEN 1                                                       02260001
022700     WHEN 2                                                       02270001
022800     WHEN 3                                                       02280001
022900     WHEN 4                                                       02290001
023000     WHEN 5                                                       02300001
023100         CONTINUE                                                 02310001
023200     WHEN OTHER                                                   02320001
023300         MOVE DP015-UNP-ALP-BRT-MDT  TO ASELECTA                  02330001
023400         MOVE PC-INVALID-SELECTION-MSG                            02340001
023500                                     TO AMSGLNO                   02350001
023600         PERFORM 8100-SEND-DATA-ONLY                              02360001
023700         PERFORM 8200-RETURN-TRANID                               02370001
023800     END-EVALUATE.                                                02380001
023900*                                                                 02390001
024000*                                                                 02400001
024100 2100-XCTL-TO-SELECTED-PROGRAM.                                   02410001
024200                                                                  02420001
024300     INITIALIZE PC233-COMMON-DATA.                                02430001
024400     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    02440001
024500     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      02450001
024600                                                                  02460001
024700     EVALUATE TRUE                                                02470001
024800         WHEN CA-SELECTION = 1                                    02480001
024900             MOVE 'PCKRF870'          TO PC233-ROOT-PROGRAM       02490001
025000             MOVE 'PCKRF869'          TO PC233-MENU-PROGRAM       02500001
025100         WHEN CA-SELECTION = 2                                    02510001
025200             MOVE 'PCKRF876'          TO PC233-ROOT-PROGRAM       02520001
025300             MOVE 'PCKRF869'          TO PC233-MENU-PROGRAM       02530001
025400         WHEN CA-SELECTION = 3                                    02540001
025500             MOVE 'PCKRF872'          TO PC233-ROOT-PROGRAM       02550001
025600             MOVE 'PCKRF869'          TO PC233-MENU-PROGRAM       02560001
025700         WHEN CA-SELECTION = 4                                    02570001
025800             MOVE 'PCKRF879'          TO PC233-ROOT-PROGRAM       02580001
025900             MOVE 'PCKRF869'          TO PC233-MENU-PROGRAM       02590001
026000         WHEN CA-SELECTION = 5                                    02600001
026100             MOVE 'PCKRF898'          TO PC233-ROOT-PROGRAM       02610001
026200             MOVE 'PCKRF869'          TO PC233-MENU-PROGRAM       02620001
026300     END-EVALUATE                                                 02630001
026400                                                                  02640001
026500     PERFORM DP026-0000-GET-LOGON-INFO.                           02650001
026600     MOVE DP026-USERID                TO PC233-USER-ID.           02660001
026700     MOVE DP026-LOCATION-NBR          TO PC233-OPER-UNT-ID        02670002
026800     MOVE DP026-FCLTY-ID              TO PC233-FCLTY-ID           02680001
026900     MOVE DP026-QUEUE-TERM            TO PC233-TERM-ID            02690001
027000                                                                  02700001
027100     PERFORM 8400-XCTL.                                           02710001
027200                                                                  02720001
027300     COPY DPPD026.                                                02730001
027400/                                                                 02740001
027500 2200-XCTL-TO-HELP.                                               02750001
027600                                                                  02760001
027700     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       02770001
027800                                                                  02780001
027900     EXEC CICS                                                    02790001
028000         XCTL                                                     02800001
028100             PROGRAM   (PV-TRANSFER-PROGRAM)                      02810001
028200             COMMAREA  (PC192-COMMAREA)                           02820001
028300             LENGTH    (PV-COMMAREA-LENGTH)                       02830001
028400             RESP      (PV-CICS-RESPONSE)                         02840001
028500     END-EXEC.                                                    02850001
028600                                                                  02860001
028700     EVALUATE TRUE                                                02870001
028800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02880001
028900              CONTINUE                                            02890001
029000         WHEN OTHER                                               02900001
029100              MOVE '2200-XCTL-TO-HELP'                            02910001
029200                                     TO DP013-PARAGRAPH           02920001
029300              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       02930001
029400                                     TO DP013-MESSAGE-TEXT (1)    02940001
029500              MOVE PV-TRANSFER-PROGRAM                            02950001
029600                                     TO DP013-MESSAGE-TEXT (2)    02960001
029700              SET DP013-CICS-ABEND   TO TRUE                      02970001
029800              SET DP013-NO-ROLLBACK  TO TRUE                      02980001
029900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              02990001
030000              MOVE PC-TRANS-UNAVAILABLE-MSG                       03000001
030100                                     TO AMSGLNO                   03010001
030200              PERFORM 8100-SEND-DATA-ONLY                         03020001
030300              PERFORM 8200-RETURN-TRANID                          03030001
030400     END-EVALUATE.                                                03040001
030500*                                                                 03050001
030600*                                                                 03060001
030700 8000-SEND-MAP.                                                   03070001
030800     EXEC CICS                                                    03080001
030900         SEND MAP       ('PC869A')                                03090001
031000              MAPSET    ('PCKM869')                               03100001
031100              ERASE                                               03110001
031200              RESP      (PV-CICS-RESPONSE)                        03120001
031300     END-EXEC.                                                    03130001
031400                                                                  03140001
031500     EVALUATE TRUE                                                03150001
031600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03160001
031700              CONTINUE                                            03170001
031800         WHEN OTHER                                               03180001
031900              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           03190001
032000              MOVE 'UNABLE TO SEND MAP'                           03200001
032100                                     TO DP013-MESSAGE-TEXT (1)    03210001
032200              SET DP013-CICS-ABEND   TO TRUE                      03220001
032300              SET DP013-NO-ROLLBACK  TO TRUE                      03230001
032400              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03240001
032500     END-EVALUATE.                                                03250001
032600*                                                                 03260001
032700*                                                                 03270001
032800 8100-SEND-DATA-ONLY.                                             03280001
032900     MOVE -1 TO ASELECTL.                                         03290001
033000                                                                  03300001
033100     EXEC CICS                                                    03310001
033200         SEND MAP       ('PC869A')                                03320001
033300              MAPSET    ('PCKM869')                               03330001
033400              CURSOR                                              03340001
033500              DATAONLY                                            03350001
033600              RESP      (PV-CICS-RESPONSE)                        03360001
033700     END-EXEC.                                                    03370001
033800                                                                  03380001
033900     EVALUATE TRUE                                                03390001
034000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03400001
034100              CONTINUE                                            03410001
034200         WHEN OTHER                                               03420001
034300              MOVE '8100-SEND-DATA-ONLY'                          03430001
034400                                     TO DP013-PARAGRAPH           03440001
034500              MOVE 'UNABLE TO SEND DATA'                          03450001
034600                                     TO DP013-MESSAGE-TEXT (1)    03460001
034700              SET DP013-CICS-ABEND   TO TRUE                      03470001
034800              SET DP013-NO-ROLLBACK  TO TRUE                      03480001
034900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03490001
035000     END-EVALUATE.                                                03500001
035100*                                                                 03510001
035200*                                                                 03520001
035300 8200-RETURN-TRANID.                                              03530001
035400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       03540001
035500     EXEC CICS                                                    03550001
035600         RETURN TRANSID   ('E869')                                03560001
035700                COMMAREA  (CA-COMMAREA)                           03570001
035800                LENGTH    (PV-COMMAREA-LENGTH)                    03580001
035900                RESP      (PV-CICS-RESPONSE)                      03590001
036000     END-EXEC.                                                    03600001
036100                                                                  03610001
036200     EVALUATE TRUE                                                03620001
036300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03630001
036400              CONTINUE                                            03640001
036500         WHEN OTHER                                               03650001
036600              MOVE '8200-RETURN-TRANID'                           03660001
036700                                     TO DP013-PARAGRAPH           03670001
036800              MOVE 'UNABLE TO RETURN TO TRANID'                   03680001
036900                                     TO DP013-MESSAGE-TEXT (1)    03690001
037000              SET DP013-CICS-ABEND   TO TRUE                      03700001
037100              SET DP013-NO-ROLLBACK  TO TRUE                      03710001
037200              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03720001
037300     END-EVALUATE.                                                03730001
037400*                                                                 03740001
037500 8300-RECEIVE-MAP.                                                03750001
037600     EXEC CICS                                                    03760001
037700         RECEIVE MAP    ('PC869A')                                03770001
037800                 MAPSET ('PCKM869')                               03780001
037900                 RESP   (PV-CICS-RESPONSE)                        03790001
038000     END-EXEC.                                                    03800001
038100                                                                  03810001
038200     EVALUATE TRUE                                                03820001
038300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03830001
038400              PERFORM 1010-RECEIVE-SCREEN-FIELDS                  03840001
038500         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                03850001
038600              CONTINUE                                            03860001
038700         WHEN OTHER                                               03870001
038800             MOVE '8300-RECEIVE-MAP'  TO DP013-PARAGRAPH          03880001
038900              MOVE 'UNABLE TO RECEIVE MAP'                        03890001
039000                                      TO DP013-MESSAGE-TEXT (1)   03900001
039100              SET DP013-LOGIC-ABEND   TO TRUE                     03910001
039200              SET DP013-NO-ROLLBACK   TO TRUE                     03920001
039300              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03930001
039400     END-EVALUATE.                                                03940001
039500/                                                                 03950001
039600 8400-XCTL.                                                       03960001
039700     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           03970001
039800                                                                  03980001
039900     EXEC CICS                                                    03990001
040000         XCTL                                                     04000001
040100             PROGRAM   (PV-TRANSFER-PROGRAM)                      04010001
040200             COMMAREA  (CA-COMMAREA)                              04020001
040300             LENGTH    (PV-COMMAREA-LENGTH)                       04030001
040400             RESP      (PV-CICS-RESPONSE)                         04040001
040500     END-EXEC.                                                    04050001
040600                                                                  04060001
040700     EVALUATE TRUE                                                04070001
040800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04080001
040900              CONTINUE                                            04090001
041000         WHEN OTHER                                               04100001
041100              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                04110001
041200                                     TO DP013-PARAGRAPH           04120001
041300              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       04130001
041400                                     TO DP013-MESSAGE-TEXT (1)    04140001
041500              MOVE PV-TRANSFER-PROGRAM                            04150001
041600                                     TO DP013-MESSAGE-TEXT (2)    04160001
041700              SET DP013-CICS-ABEND   TO TRUE                      04170001
041800              SET DP013-NO-ROLLBACK  TO TRUE                      04180001
041900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              04190001
042000              MOVE PC-TRANS-UNAVAILABLE-MSG                       04200001
042100                                     TO AMSGLNO                   04210001
042200              PERFORM 8100-SEND-DATA-ONLY                         04220001
042300              PERFORM 8200-RETURN-TRANID                          04230001
042400     END-EVALUATE.                                                04240001
042500                                                                  04250001
042600 9000-CHECK-RACF.                                                 04260001
042700******************************************************************04270001
042800*  CHECK ACCESSS AUTHORITY OF USER                                04280001
042900******************************************************************04290001
043000     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     04300001
043100     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     04310001
043200                                                                  04320001
043300     EVALUATE TRUE                                                04330001
043400         WHEN CA-OPEN-TRAILER-SELECTION                           04340001
043500              MOVE 'E870'             TO DP008-RESOURCE-NAME      04350001
043600         WHEN CA-CLOSE-TRAILER-SELECTION                          04360001
043700              MOVE 'E876'             TO DP008-RESOURCE-NAME      04370001
043800         WHEN CA-CONVEYOR-CUTOFF-SELECTION                        04380001
043900              MOVE 'E872'             TO DP008-RESOURCE-NAME      04390001
044000         WHEN CA-LOAD-UNLOAD-TRAILER                              04400001
044100              MOVE 'E878'             TO DP008-RESOURCE-NAME      04410001
044200         WHEN CA-TRAILER-STATUS                                   04420001
044300              MOVE 'E898'             TO DP008-RESOURCE-NAME      04430001
044400     END-EVALUATE.                                                04440001
044500                                                                  04450001
044600     EXEC CICS                                                    04460001
044700          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               04470001
044800               COMMAREA (DP008-SECURITY-COMMAREA)                 04480001
044900               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          04490001
045000               RESP     (PV-CICS-RESPONSE)                        04500001
045100     END-EXEC.                                                    04510001
045200                                                                  04520001
045300     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       04530001
045400         IF  DP008-CALL-SUCCESSFUL                                04540001
045500             IF  DP008-ACCESS-ALLOWED                             04550001
045600                 SET PS-ACCESS-ALLOWED                            04560001
045700                                     TO TRUE                      04570001
045800             ELSE                                                 04580001
045900                 MOVE PC-ACCESS-NOT-ALLOWED-MSG                   04590001
046000                                     TO AMSGLNO                   04600001
046100             END-IF                                               04610001
046200         ELSE                                                     04620001
046300             MOVE PC-CICSAUTH-MSG    TO AMSGLNO                   04630001
046400         END-IF                                                   04640001
046500     ELSE                                                         04650001
046600         MOVE '9000-CHECK-RACF'      TO DP013-PARAGRAPH           04660001
046700         MOVE 'BAD LINK TO RACF PROGRAM'                          04670001
046800                                     TO DP013-MESSAGE-TEXT (1)    04680001
046900         SET DP013-CICS-ABEND        TO TRUE                      04690001
047000         SET DP013-NO-ROLLBACK       TO TRUE                      04700001
047100         PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                   04710001
047200     END-IF.                                                      04720001
047300*                                                                 04730001
047400*                                                                 04740001
047500 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  04750001
047600     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            04760001
047700     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           04770001
047800     INITIALIZE DP013-SRC-TASK-NUMBER                             04780001
047900                DP013-STACK.                                      04790001
048000     SET DP013-LINK-RETURN           TO TRUE.                     04800001
048100                                                                  04810001
048200     EXEC CICS                                                    04820001
048300         LINK                                                     04830001
048400             PROGRAM   (DP013-NAME)                               04840001
048500             COMMAREA  (DP013-PARAMETERS)                         04850001
048600             LENGTH    (DP013-LENGTH)                             04860001
048700     END-EXEC.                                                    04870001
