000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.                MPKCS014.                             00040000
000500 AUTHOR.                    JEFF SNYDER.                          00050000
000600 INSTALLATION.              KOHLS DEPARTMENT STORES.              00060000
000700 DATE-WRITTEN.              12/06/89.                             00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*  CICS PROGRAM - MPKCS014 - TRANID = M014                       *00100000
001100*                                                                *00110000
001200*                                                                *00120000
001300******************************************************************00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500******************************************************************00150000
001600 DATA DIVISION.                                                   00160000
001700******************************************************************00170000
001800     EJECT                                                        00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000 01  FILLER                          PIC X(27) VALUE              00200000
002100     'WORKING STORAGE STARTS HERE'.                               00210000
002200                                                                  00220000
002300*                                                                 00230000
002400*  STANDARD ATTENTION IDENTIFIER LIST                             00240000
002500*                                                                 00250000
002600     COPY DFHAID.                                                 00260000
002700     EJECT                                                        00270000
002800                                                                  00280000
002900* COPIES FOR THE PROGRAM DRS1INTC WORK FIELDS.                    00290000
003000*    COPY DRRD001O.                                               00300000
003100     COPY DRRD002O.                                               00310000
003200                                                                  00320000
003300                                                                  00330000
003400*  COPY BOOK CONTAINING THE WORKING STORAGE VALUES REQUIRED FOR   00340000
003500*  CALLING THE PRINTER VALIDATION ROUTINE DPKCS060                00350000
003600*                                                                 00360000
003700     COPY DPWS072.                                                00370000
003800                                                                  00380000
003900*  COPY BOOK CONTAINING COMMON PRINTER LINE COMMANDS              00390000
004000*                                                                 00400000
004100     COPY DSWS004.                                                00410000
004200                                                                  00420000
004300*  LOGISTICS DOMAIN ITEM ACCESS MODULE COPYBOOK                   00430000
004400*                                                                 00440000
004500     COPY XLWS001.                                                00450000
004600                                                                  00460000
004700*  RECORD LAYOUT FOR THE REPORT HEADER                            00470000
004800*                                                                 00480000
004900     COPY DPWS133O.                                               00490000
005000*                                                                 00500000
005100 01  DRS01-COMMAREA.                                              00510000
005200      05  DRS01-COMM-DRRB.                                        00520000
005300          10  DRS01-DRRB-ID         PIC X(4)      VALUE 'DRRB'.   00530000
005400          10  DRS01-DRRB-FUNC       PIC X(4)      VALUE SPACES.   00540000
005500          10  DRS01-DRRB-RID        PIC X(8)      VALUE SPACES.   00550000
005600          10  DRS01-DRRD-OPTIONS    PIC X(4)      VALUE SPACES.   00560000
005700          10  FILLER                PIC X(8)      VALUE SPACES.   00570000
005800          10  DRS01-DRRB-RC         PIC S9(8)     VALUE +000 COMP.00580000
005900          10  DRS01-DRRB-RCS.                                     00590000
006000              15  DRS01-DRRB-RCS1   PIC S9(4)     VALUE +000 COMP.00600000
006100              15  DRS01-DRRB-RCS2   PIC S9(4)     VALUE +000 COMP.00610000
006200          10  DRS01-DRRB-ATTR-ERROR PIC S9(4)     VALUE +000 COMP.00620000
006300          10  FILLER                PIC X(2)      VALUE SPACES.   00630000
006400          10  DRS01-DRRB-DRDC       PIC S9(8)     VALUE +000 COMP.00640000
006500          10  DRS01-DRRB01-LINES    PIC S9(8)     VALUE +000 COMP.00650000
006600      05  DRS01-COMM-DRIB.                                        00660000
006700          10  DRS01-COMM-DRIB-HDR   PIC X(24)     VALUE ZERO.     00670000
006800          10  DRS01-COMM-DRIB-AT1   PIC X(192)    VALUE ZERO.     00680000
006900      05  DRS01-COMM-PRT-LINE REDEFINES DRS01-COMM-DRIB.          00690000
007000          10  DRS01-COMM-CTL        PIC X(1).                     00700000
007100          10  DRS01-COMM-DATA       PIC X(200).                   00710000
007200          10  FILLER                PIC X(15).                    00720000
007201*                                                                 00730000
007202 01  DK-DB2-KEYS.                                                 00740000
007203     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  00750000
007204                                                     COMP.        00760000
007205     05  DK-REC-SEQ-NBR                  PIC S9(09)  VALUE ZEROS  00770000
007206                                                     COMP.        00780000
007207     05  DK-ORD-LNE-NBR                  PIC S9(09)  VALUE ZEROS  00790000
007208                                                     COMP.        00800000
007209     05  DK-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  00810000
007210                                                     COMP.        00820000
007211     05  DK-FCLTY-ID                     PIC S9(04)  VALUE ZEROS  00830000
007212                                                     COMP.        00840000
007213     05  DK-PREPK-ID                     PIC S9(04)  VALUE ZEROS  00850000
007214                                                     COMP.        00860000
007215     05  DN-VEH-NBR                      PIC S9(04) VALUE ZEROS   00870000
007216                                                     COMP.        00880000
007217*DMH 05  DK-DIST-TABLE OCCURS 15 TIMES INDEXED BY DIST-IDX.       00890000
007218     05  DK-DIST-TABLE OCCURS 24 TIMES INDEXED BY DIST-IDX.       00890000
007219         10  DK-DIST                     PIC S9(04)  VALUE ZEROS  00900000
007220                                                     COMP.        00910000
007221                                                                  00920000
007222 01  IE-DRS-ERROR-MSG.                                            00930000
007223     05  FILLER                       PIC X(41)  VALUE            00940000
007224     'A DRS ERROR HAS OCCURRED  - CONTACT DP - '.                 00950000
007300     05  FILLER                       PIC X(44)  VALUE            00960000
007400     'PROGRAM MPKCS014'.                                          00970000
007500     05  FILLER                       PIC X(11)  VALUE            00980000
007600     'FUNCTION = '.                                               00990000
007700     05  IE-DRS-FUNC                  PIC X(4)   VALUE SPACE.     01000000
007800     05  FILLER                       PIC X(14)  VALUE            01010000
007900     'RETURN CODE = '.                                            01020000
008000     05  IE-DRS-RC                    PIC X(4)   VALUE SPACES.    01030000
008100                                                                  01040000
008200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01050000
008300*                                                                 01060000
008400     COPY DPWS013.                                                01070000
008500     COPY DPWS020.                                                01080000
008600                                                                  01090000
008700 01  R1H-REPORT-HEADING1.                                         01100000
008800     05  FILLER                      PIC X(46)  VALUE SPACES.     01110000
008900     05  FILLER                      PIC X(29)  VALUE             01120000
009000     'M A S T E R   P U R C H A S E'.                             01130000
009100     05  FILLER                      PIC X(12)  VALUE             01140000
009200     '   O R D E R'.                                              01150000
009300     05  FILLER                      PIC X(46)  VALUE SPACES.     01160000
009400                                                                  01170000
009500 01  R1H-REPORT-HEADING2.                                         01180000
009600     05  FILLER                      PIC X(01)  VALUE SPACES.     01190000
009700     05  FILLER                      PIC X(08)  VALUE 'RECEIVER'. 01200000
009800     05  FILLER                      PIC X(12)  VALUE SPACES.     01210000
009900     05  FILLER                      PIC X(07)  VALUE 'CARTONS'.  01220000
010000     05  FILLER                      PIC X(02)  VALUE SPACES.     01230000
010100     05  FILLER                      PIC X(07)  VALUE 'TRAILER'.  01240000
010200     05  FILLER                      PIC X(29)  VALUE SPACES.     01250000
010300     05  FILLER                      PIC X(08)  VALUE 'DELIVERY'. 01260000
010400     05  FILLER                      PIC X(04)  VALUE SPACES.     01270000
010500     05  FILLER                      PIC X(07)  VALUE 'TRAILER'.  01280000
010600     05  FILLER                      PIC X(08)  VALUE SPACES.     01290000
010700     05  FILLER                      PIC X(04)  VALUE 'TRIP'.     01300000
010800     05  FILLER                      PIC X(07)  VALUE SPACES.     01310000
010900     05  FILLER                      PIC X(04)  VALUE 'PROC'.     01320000
011000     05  FILLER                      PIC X(24)  VALUE SPACES.     01330000
011100                                                                  01340000
011200 01  R1H-REPORT-HEADING3.                                         01350000
011300     05  FILLER                      PIC X(01)  VALUE SPACES.     01360000
011400     05  FILLER                      PIC X(06)  VALUE 'NUMBER'.   01370000
011500     05  FILLER                      PIC X(14)  VALUE SPACES.     01380000
011600     05  FILLER                      PIC X(08)  VALUE 'RECEIVED'. 01390000
011700     05  FILLER                      PIC X(05)  VALUE ' DATE'.    01400000
011800     05  FILLER                      PIC X(06)  VALUE SPACES.     01410000
011900     05  FILLER                      PIC X(06)  VALUE 'VENDOR'.   01420000
012000     05  FILLER                      PIC X(05)  VALUE ' NAME'.    01430000
012100     05  FILLER                      PIC X(17)  VALUE SPACES.     01440000
012200     05  FILLER                      PIC X(04)  VALUE 'SCAC'.     01450000
012300     05  FILLER                      PIC X(06)  VALUE SPACES.     01460000
012400     05  FILLER                      PIC X(06)  VALUE 'NUMBER'.   01470000
012500     05  FILLER                      PIC X(10)  VALUE SPACES.     01480000
012600     05  FILLER                      PIC X(02)  VALUE 'ID'.       01490000
012700     05  FILLER                      PIC X(08)  VALUE SPACES.     01500000
012800     05  FILLER                      PIC X(04)  VALUE 'AREA'.     01510000
012900     05  FILLER                      PIC X(06)  VALUE SPACES.     01520000
013000     05  FILLER                      PIC X(13)  VALUE             01530000
013100                                               'MDSE LOCATION'.   01540000
013200     05  FILLER                      PIC X(05)  VALUE SPACES.     01550000
013300                                                                  01560000
013400 01  R1H-DESC-SUB-HEADING-1.                                      01570000
013500     05  FILLER                       PIC X(56)  VALUE SPACES.    01580000
016600*DMH 05  FILLER                       OCCURS  0 TO 15             01590000
016601*DMH                                  DEPENDING ON WS-DC-COUNT.   01600000
016602     05  FILLER                       OCCURS  12 TIMES.           01590000
016700         10  RH1-SUB-DIST-DESC        PIC X(05).                  01610000
016800         10  FILLER                   PIC X(02).                  01620000
016801                                                                  01630000
016802*                                                                         
016803*** DMH 4-1-11 - BEGIN                                                    
016804*                                                                         
016805 01  R1H-DESC-SUB-HEADING-1A.                                     01570000
016806     05  FILLER                       PIC X(56)  VALUE SPACES.    01580000
016810     05  RH1-SUB-DIST-DESC13          PIC X(05).                  01610000
016811     05  FILLER                       PIC X(02).                  01620000
016812     05  RH1-SUB-DIST-DESC14          PIC X(05).                  01610000
016813     05  FILLER                       PIC X(02).                  01620000
016814     05  RH1-SUB-DIST-DESC15          PIC X(05).                  01610000
016815     05  FILLER                       PIC X(02).                  01620000
016816     05  RH1-SUB-DIST-DESC16          PIC X(05).                  01610000
016817     05  FILLER                       PIC X(02).                  01620000
016818     05  RH1-SUB-DIST-DESC17          PIC X(05).                  01610000
016819     05  FILLER                       PIC X(02).                  01620000
016820     05  RH1-SUB-DIST-DESC18          PIC X(05).                  01610000
016821     05  FILLER                       PIC X(02).                  01620000
016822     05  RH1-SUB-DIST-DESC19          PIC X(05).                  01610000
016823     05  FILLER                       PIC X(02).                  01620000
016824     05  RH1-SUB-DIST-DESC20          PIC X(05).                  01610000
016825     05  FILLER                       PIC X(02).                  01620000
016826     05  RH1-SUB-DIST-DESC21          PIC X(05).                  01610000
016827     05  FILLER                       PIC X(02).                  01620000
016828     05  RH1-SUB-DIST-DESC22          PIC X(05).                  01610000
016829     05  FILLER                       PIC X(02).                  01620000
016830     05  RH1-SUB-DIST-DESC23          PIC X(05).                  01610000
016831     05  FILLER                       PIC X(02).                  01620000
016832     05  RH1-SUB-DIST-DESC24          PIC X(05).                  01610000
016833     05  FILLER                       PIC X(02).                  01620000
016836*                                                                         
016837*** DMH 4-1-11 - END                                                      
016838*                                                                         
016839                                                                  01630000
016840 01  R1H-SUB-HEADING1.                                            01640000
016841     05  FILLER                       PIC X(01)  VALUE SPACES.    01650000
016842     05  FILLER                       PIC X(04)  VALUE 'LINE'.    01660000
016843     05  FILLER                       PIC X(13)  VALUE SPACES.    01670000
016844     05  FILLER                       PIC X(06)  VALUE 'VENDOR'.  01680000
016845     05  FILLER                       PIC X(07)  VALUE SPACES.    01690000
016846     05  FILLER                       PIC X(04)  VALUE 'SIZE'.    01700000
016847     05  FILLER                       PIC X(02)  VALUE SPACES.    01710000
016848     05  FILLER                       PIC X(03)  VALUE 'CLR'.     01720000
016849     05  FILLER                       PIC X(02)  VALUE SPACES.    01730000
016850     05  FILLER                       PIC X(07)  VALUE 'PO ITEM'. 01740000
016851     05  FILLER                       PIC X(07)  VALUE SPACES.    01750000
016852*DMH 05  FILLER                       OCCURS  0 TO 15             01760000
016853*DMH                                  DEPENDING ON WS-DC-COUNT.   01770000
016854     05  FILLER                       OCCURS  12 TIMES.           01760000
016856         10  RH1-SUB-DIST             PIC Z(04).                  01780000
016860         10  FILLER                   PIC X(03).                  01790000
018500     05  RH1-TOTAL                    PIC X(03).                  01800000
018900                                                                  01810000
019000 01  R1H-SUB-HEADING1A.                                           01820000
019100     05  FILLER                       PIC X(56)  VALUE SPACES.    01830000
019200     05  RH1-SUB-DIST-13              PIC Z(04)  VALUE ZEROES.    01840000
019300     05  FILLER                       PIC X(03)  VALUE SPACES.    01850000
019400     05  RH1-SUB-DIST-14              PIC Z(04)  VALUE ZEROES.    01860000
019500     05  FILLER                       PIC X(03)  VALUE SPACES.    01870000
019600     05  RH1-SUB-DIST-15              PIC Z(04)  VALUE ZEROES.    01880000
019700     05  FILLER                       PIC X(03)  VALUE SPACES.    01890000
019800     05  RH1-SUB-DIST-16              PIC Z(04)  VALUE ZEROES.    01900000
019900     05  FILLER                       PIC X(03)  VALUE SPACES.    01910000
020000     05  RH1-SUB-DIST-17              PIC Z(04)  VALUE ZEROES.    01920000
020100     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020110     05  RH1-SUB-DIST-18              PIC Z(04)  VALUE ZEROES.    01920000
020120     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020130     05  RH1-SUB-DIST-19              PIC Z(04)  VALUE ZEROES.    01920000
020140     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020150     05  RH1-SUB-DIST-20              PIC Z(04)  VALUE ZEROES.    01920000
020160     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020170     05  RH1-SUB-DIST-21              PIC Z(04)  VALUE ZEROES.    01920000
020180     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020190     05  RH1-SUB-DIST-22              PIC Z(04)  VALUE ZEROES.    01920000
020191     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020192     05  RH1-SUB-DIST-23              PIC Z(04)  VALUE ZEROES.    01920000
020193     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020194     05  RH1-SUB-DIST-24              PIC Z(04)  VALUE ZEROES.    01920000
020195     05  FILLER                       PIC X(03)  VALUE SPACES.    01930000
020300                                                                  01950000
020400 01  R1H-SUB-HEADING2.                                            01960000
020500     05  FILLER                       PIC X(01)  VALUE SPACES.    01970000
020600     05  FILLER                       PIC X(04)  VALUE 'NBR '.    01980000
020700     05  FILLER                       PIC X(01)  VALUE SPACES.    01990000
020800     05  FILLER                       PIC X(03)  VALUE 'SKU'.     02000000
020900     05  FILLER                       PIC X(06)  VALUE SPACES.    02010000
021000     05  FILLER                       PIC X(02)  VALUE 'ST'.      02020000
021100     05  FILLER                       PIC X(01)  VALUE SPACES.    02030000
021200     05  FILLER                       PIC X(05)  VALUE 'STYLE'.   02040000
021300     05  FILLER                       PIC X(08)  VALUE SPACES.    02050000
021400     05  FILLER                       PIC X(04)  VALUE 'DESC'.    02060000
021500     05  FILLER                       PIC X(02)  VALUE SPACES.    02070000
021600     05  FILLER                       PIC X(04)  VALUE 'DESC'.    02080000
021700     05  FILLER                       PIC X(01)  VALUE SPACES.    02090000
021800     05  FILLER                       PIC X(11)  VALUE            02100000
021900                                                 'DESCRIPTION'.   02110000
022000     05  FILLER                       PIC X(01)  VALUE SPACES.    02120000
022100*DMH 05  WS-OTR-TABLE                 OCCURS  0 TO 15             02130000
022101*DMH                                  DEPENDING ON WS-DC-COUNT.   02140000
022110     05  WS-OTR-TABLE                 OCCURS  12 TIMES.           02130000
022300        10 FILLER                     PIC X(03)  VALUE SPACES.    02150000
022400        10 FILLER                     PIC X(03)  VALUE 'OTR'.     02160000
022500        10 FILLER                     PIC X(01)  VALUE SPACES.    02150000
024500                                                                  02170000
024600 01  R1D-DETAIL1.                                                 02180000
024700     05  FILLER                       PIC X      VALUE SPACE.     02190000
024800     05  R1D-PO-NBR                   PIC 9(08)  VALUE ZEROS.     02200000
024900     05  FILLER                       PIC X(01)  VALUE '-'.       02210000
025000     05  R1D-REC-SEQ-NBR              PIC 9(03)  VALUE ZEROS.     02220000
025100     05  FILLER                       PIC X(08)  VALUE SPACE.     02230000
025200     05  R1D-CARTONS                  PIC Z(6)9  VALUE SPACES.    02240000
025300     05  FILLER                       PIC X(02)  VALUE SPACES.    02250000
025400     05  R1D-DATE                     PIC X(08)  VALUE SPACES.    02260000
025500     05  FILLER                       PIC X(02)  VALUE SPACE.     02270000
025600     05  R1D-VENDOR                   PIC X(25)  VALUE SPACES.    02280000
025700     05  FILLER                       PIC X(03)  VALUE SPACE.     02290000
025800     05  R1D-SCAC                     PIC X(04)  VALUE SPACES.    02300000
025900     05  FILLER                       PIC X(05)  VALUE SPACE.     02310000
026000     05  R1D-TRAILER                  PIC X(10)  VALUE SPACES.    02320000
026100     05  FILLER                       PIC X(04)  VALUE SPACE.     02330000
026200     05  R1D-TRIP                     PIC 9(09)  BLANK ZEROES.    02340000
026300     05  FILLER                       PIC X(04)  VALUE SPACE.     02350000
026400     05  R1D-AREA                     PIC X(06)  VALUE SPACE.     02360000
026500     05  FILLER                       PIC X(04)  VALUE SPACE.     02370000
026600     05  R1D-MDSE-LOC                 PIC X(15)  VALUE SPACE.     02380000
026700     05  FILLER                       PIC X(04)  VALUE SPACE.     02390000
026800                                                                  02400000
026900                                                                  02410000
027000 01  R1D-DETAIL2.                                                 02420000
027100     05  FILLER                       PIC X(18)  VALUE            02430000
027200                                          ' RECEIVING CLERK: '.   02440000
027300     05  R1D-CLERK                    PIC X(20)  VALUE SPACES.    02450000
027400     05  FILLER                       PIC X(02)  VALUE SPACES.    02460000
027500     05  FILLER                       PIC X(09)  VALUE            02470000
027600                                                 'AD DATE: '.     02480000
027700     05  RID-AD-DATE                  PIC X(08)  VALUE SPACES.    02490000
027800     05  FILLER                       PIC X(02)  VALUE SPACES.    02500000
027900     05  FILLER                       PIC X(11)  VALUE            02510000
028000                                                 'PO STATUS: '.   02520000
028100     05  R1D-PO-STATUS                PIC X(02)  VALUE SPACES.    02530000
028200     05  FILLER                       PIC X(05)  VALUE SPACES.    02540000
028300     05  FILLER                       PIC X(09)  VALUE            02550000
028400                                                 'PRE-TCK: '.     02560000
028500     05  R1D-PRE-TICKET               PIC X(01)  VALUE SPACES.    02570000
028600     05  FILLER                       PIC X(04)  VALUE SPACES.    02580000
028700     05  FILLER                       PIC X(06)  VALUE            02590000
028800                                                 'HANG: '.        02600000
028900     05  R1D-HANG-IND                 PIC X(01)  VALUE SPACES.    02610000
029000     05  FILLER                       PIC X(06)  VALUE SPACES.    02620000
029100     05  FILLER                       PIC X(09)  VALUE            02630000
029200                                                 'PKG CDE: '.     02640000
029300     05  R1D-PKG-CODE                 PIC X(01)  VALUE SPACES.    02650000
029400     05  FILLER                       PIC X(17)  VALUE SPACES.    02660000
029500                                                                  02670000
029600 01  R1D-DETAIL2A.                                                02680000
029700     05  FILLER                       PIC X(01)  VALUE SPACES.    02690000
029800     05  FILLER                       PIC X(11)  VALUE            02700000
029900                                                 'SPEC INST: '.   02710000
030000     05  R1D-SPECIAL-INST             PIC X(120) VALUE SPACES.    02720000
030100                                                                  02730000
030200 01  R1D-DETAIL3.                                                 02740000
030300     05  FILLER                       PIC X(01)  VALUE SPACE.     02750000
030400     05  R1D-CONTROL-LINE             PIC 9(04)  VALUE ZEROES.    02760000
030500     05  FILLER                       PIC X(01)  VALUE SPACE.     02770000
030600     05  R1D-SKU                      PIC X(08)  VALUE SPACES.    02780000
030700     05  FILLER                       PIC X(01)  VALUE SPACES.    02790000
030800     05  R1D-STATUS                   PIC X(02)  VALUE SPACES.    02800000
030900     05  FILLER                       PIC X(01)  VALUE SPACES.    02810000
031000     05  R1D-VENDOR-STYLE             PIC X(12)  VALUE SPACES.    02820000
031100     05  FILLER                       PIC X(01)  VALUE SPACES.    02830000
031200     05  R1D-SIZE                     PIC X(05)  VALUE SPACES.    02840000
031300     05  FILLER                       PIC X(01)  VALUE SPACES.    02850000
031400     05  R1D-COLOR                    PIC X(04)  VALUE SPACES.    02860000
031500     05  FILLER                       PIC X(01)  VALUE SPACES.    02870000
031600     05  R1D-DESCRIPTION              PIC X(11)  VALUE SPACES.    02880000
031610     05  FILLER                       PIC X(02).                  02910000
031700*DMH 05  R1D-OTR                      OCCURS  0 TO 15             02890000
031701*DMH                                  DEPENDING ON WS-DC-COUNT.   02900000
031702     05  R1D-OTR                      OCCURS  12 TIMES.           02890000
031900         10  R1D-OPEN-TO-RECEIVE      PIC X(05).                  02920000
031910         10  FILLER                   PIC X(02).                  02910000
032000     05  FILLER                       PIC X(01).                  02930000
032100     05  R1D-OPEN-TO-RECEIVE-TOT      PIC Z(05).                  02940000
032400*                                                                 02950000
032500 01  R1D-DETAIL3B.                                                02960000
032600     05  FILLER                       PIC X(53)  VALUE SPACE.     02970000
032700*DMH 05  R1D-OTR OCCURS 15 TIMES.                                 02980000
032710     05  R1D-OTR OCCURS 12 TIMES.                                 02980000
032720         10  FILLER                   PIC X(02)  VALUE SPACES.    02990000
032900         10  R1D-OPEN-TO-RECEIVE-B    PIC X(05)  VALUE SPACES.    03000000
033000     05  FILLER                       PIC X(01)  VALUE SPACES.    03010000
033100     05  R1D-OPEN-TO-RECEIVE-TOT-B    PIC Z(05)9 VALUE ZEROES.    03020000
033200     05  FILLER                       PIC X(10)  VALUE SPACES.    03030000
033201*                                                                 03040000
033202 01  R1D-DETAIL3C.                                                03050000
033203     05  FILLER                       PIC X(42)  VALUE SPACE.     03060000
033204     05  FILLER                       PIC X(05)  VALUE 'TRBL:'.   03070000
033300     05  R1D-TROUBLE-C                PIC X(10)  VALUE SPACES.    03080000
033400     05  FILLER                       PIC X(75)  VALUE SPACES.    03090000
033500                                                                  03100000
033600 01  DL-DASH-LINE                     PIC X(108) VALUE ALL '_'.   03110000
033700                                                                  03120000
033800 01  DL-BARCODE-LINE.                                             03130000
033900     05  FILLER                       PIC X(19)  VALUE            03140000
034000         '^M0505000^T0010^BNZ'.                                   03150000
034100     05  DL-BARCODE-KEYREC            PIC X(8)   VALUE SPACES.    03160000
034200     05  DL-BARCODE-LINE-NMBR-X       PIC X(3)   VALUE SPACES.    03170000
034300     05  DL-BARCODE-LINE-NMBR  REDEFINES  DL-BARCODE-LINE-NMBR-X  03180000
034400                                      PIC 9(03).                  03190000
034500     05  DL-BARCODE-SEQ               PIC X(2)   VALUE SPACES.    03200000
034600     05  DL-BARCODE-CHK-DIGIT         PIC X(1)   VALUE SPACES.    03210000
034700     05  FILLER                       PIC X(4)   VALUE '^G^-'.    03220000
034800                                                                  03230000
034900 01  DL-BARCODE-READABLE.                                         03240000
035000     05  FILLER                       PIC X(2)   VALUE SPACES.    03250000
035100     05  DLB-READABLE-KEYREC          PIC X(8)   VALUE SPACES.    03260000
035200     05  FILLER                       PIC X(1)   VALUE SPACES.    03270000
035300     05  DLB-READABLE-LINE-NMBR-X     PIC X(3)   VALUE SPACES.    03280000
035400     05  DLB-READABLE-LINE-NMBR  REDEFINES                        03290000
035500             DLB-READABLE-LINE-NMBR-X PIC 9(3).                   03300000
035600     05  FILLER                       PIC X(1)   VALUE SPACES.    03310000
035700     05  DLB-READABLE-SEQ             PIC X(2)   VALUE SPACES.    03320000
035800     05  FILLER                       PIC X(1)   VALUE SPACES.    03330000
035900     05  DLB-READABLE-CHK-DIGIT       PIC X(1)   VALUE SPACES.    03340000
036000                                                                  03350000
036100 01  DL-BARCODE-KEYREC-LINE.                                      03360000
036200     05  FILLER                       PIC X(19)  VALUE            03370000
036300         '^M0303000^T0010^BNZ'.                                   03380000
036400     05  DLB-BARCODE-KEYREC           PIC X(8)   VALUE SPACES.    03390000
036500     05  FILLER                       PIC X(15)  VALUE            03400000
036600         '^T0200^M0201000'.                                       03410000
036700     05  DLB-DATE-RECEIVED            PIC X(8).                   03420000
036800     05  FILLER                       PIC X(15)  VALUE            03430000
036900         '^T0600^M0201000'.                                       03440000
037000     05  DLB-UPC-CERT-LINE            PIC X(46).                  03450000
037100     05  FILLER                       PIC X(4)   VALUE '^G^-'.    03460000
037200                                                                  03470000
037300 01  DL-BARCODE-LINE-NMBR-LINE.                                   03480000
037400     05  FILLER                       PIC X(19)  VALUE            03490000
037500         '^M0303000^T0020^BNZ'.                                   03500000
037600     05  DLB-BARCODE-LINE-NMBR-X      PIC X(3)   VALUE SPACES.    03510000
037700     05  DLB-BARCODE-LINE-NMBR  REDEFINES  DLB-BARCODE-LINE-NMBR-X03520000
037800                                      PIC 9(3).                   03530000
037900     05  FILLER                       PIC X(4)   VALUE '^G^-'.    03540000
038000                                                                  03550000
038100 01  BL-BORDER-LINE.                                              03560000
038200     05  FILLER                       PIC X(3)   VALUE '| |'.     03570000
038300     05  FILLER                       PIC X(8)   VALUE SPACES.    03580000
038400     05  FILLER                       PIC X(3)   VALUE '| |'.     03590000
038500     05  FILLER                       PIC X(15)  VALUE SPACES.    03600000
038600     05  FILLER                       PIC X      VALUE '|'.       03610000
038700     05  FILLER                       PIC X(9)   VALUE SPACES.    03620000
038800     05  FILLER                       PIC X      VALUE '|'.       03630000
038900     05  FILLER                       PIC X(9)   VALUE SPACES.    03640000
039000     05  FILLER                       PIC X      VALUE '|'.       03650000
039100     05  FILLER                       PIC X(9)   VALUE SPACES.    03660000
039200     05  FILLER                       PIC X      VALUE '|'.       03670000
039300     05  FILLER                       PIC X(7)   VALUE SPACES.    03680000
039400     05  FILLER                       PIC X(3)   VALUE '| |'.     03690000
039500     05  FILLER                       PIC X(17)  VALUE SPACES.    03700000
039600     05  FILLER                       PIC X(3)   VALUE '| |'.     03710000
039700     05  FILLER                       PIC X(17)  VALUE SPACES.    03720000
039800     05  FILLER                       PIC X      VALUE '|'.       03730000
039900                                                                  03740000
040000 01  WS-UPC-CERT-LINE.                                            03750000
040100     05  FILLER                  PIC X(10)   VALUE '** ** **'.    03760000
040200     05  WS-CERT-LINE            PIC X(26).                       03770000
040300     05  FILLER                  PIC X(10)   VALUE '  ** ** **'.  03780000
040400                                                                  03790000
040500 01  TL1-DETCHECK-LINE-1.                                         03800000
040600     05  FILLER                          PIC X(26)   VALUE        03810000
040700         'D E T A I L  C H E C K ** '.                            03820000
040800     05  FILLER                          PIC X(26)   VALUE        03830000
040900         'D E T A I L  C H E C K ** '.                            03840000
041000     05  FILLER                          PIC X(26)   VALUE        03850000
041100         'D E T A I L  C H E C K ** '.                            03860000
041200     05  FILLER                          PIC X(26)   VALUE        03870000
041300         'D E T A I L  C H E C K ** '.                            03880000
041400     05  FILLER                          PIC X(26)   VALUE        03890000
041500         'D E T A I L  C H E C K ** '.                            03900000
041600                                                                  03910000
041700 01  TL1-TROUBLE-LINE-1.                                          03920000
041800     05  FILLER                          PIC X(19)   VALUE        03930000
041900         'T R O U B L E  **  '.                                   03940000
042000     05  FILLER                          PIC X(19)   VALUE        03950000
042100         'T R O U B L E  **  '.                                   03960000
042200     05  FILLER                          PIC X(19)   VALUE        03970000
042300         'T R O U B L E  **  '.                                   03980000
042400     05  FILLER                          PIC X(19)   VALUE        03990000
042500         'T R O U B L E  **  '.                                   04000000
042600     05  FILLER                          PIC X(19)   VALUE        04010000
042700         'T R O U B L E  **  '.                                   04020000
042800     05  FILLER                          PIC X(19)   VALUE        04030000
042900         'T R O U B L E  **  '.                                   04040000
043000     05  FILLER                          PIC X(18)   VALUE        04050000
043100         'T R O U B L E  ** '.                                    04060000
043200                                                                  04070000
043300 01  TL2-TROUBLE-LINE-2.                                          04080000
043400     05  TL2-R-TRBL-TABLE OCCURS 5 TIMES INDEXED BY               04090000
043500                                            TRBL-IDX1.            04100000
043600         10  FILLER                      PIC X(06)   VALUE SPACES.04110000
043700         10  TL2-R-TRBL-DESC             PIC X(20).               04120000
043800     05  FILLER                          PIC X(02)   VALUE SPACES.04130000
043900                                                                  04140000
044000                                                                  04150000
044100 01  TL2-TROUBLE.                                                 04160000
044200     05  TL2-TRBL-DESC-TABLE OCCURS 2 TIMES INDEXED BY            04170000
044300                                            TRBL-IDX.             04180000
044400         10  TL2-TRBL-DESC               PIC X(10).               04190000
044500                                                                  04200000
044600 01  PS-PROGRAM-SWITCHES.                                         04210000
044700     05  PS-VENDOR-REQ-CERT-IND       PIC X(1)   VALUE 'N'.       04220000
044800         88  PS-VENDOR-REQ-CERT                  VALUE 'Y'.       04230000
044900     05  PS-PLAN-FOUND-IND            PIC X(1)   VALUE 'N'.       04240000
045000         88  PS-PLAN-NOT-FOUND                   VALUE 'N'.       04250000
045100         88  PS-PLAN-FOUND                       VALUE 'Y'.       04260000
045200     05  PS-SPECIAL-INSTRS-IND        PIC X(1)   VALUE 'N'.       04270000
045300         88  PS-NO-SPECIAL-INSTRS-FOUND          VALUE 'N'.       04280000
045400         88  PS-SPECIAL-INSTRS-FOUND             VALUE 'Y'.       04290000
045500     05  PS-DONE-WITH-RPTS-IND        PIC X(1)   VALUE 'N'.       04300000
045600         88  PS-DONE-WITH-RPTS                   VALUE 'Y'.       04310000
045700     05  PS-TWKORIN-CURSOR-SW         PIC X(01)  VALUE 'N'.       04320000
045800         88  PS-EOF-TWKORIN-CSR                  VALUE 'Y'.       04330000
045900     05  PS-TWKORIN-ZERO-SW           PIC X(01)  VALUE 'N'.       04340000
046000         88  PS-EOF-TWKORIN-ZERO                 VALUE 'Y'.       04350000
046100     05  PS-END-OF-ITM-QTY-CSR-IND    PIC X(01)  VALUE 'N'.       04360000
046200         88  PS-END-OF-ITM-QTY-CSR               VALUE 'Y'.       04370000
046300     05  PS-TOP-OF-PAGE-SET-SW        PIC X(01)  VALUE 'N'.       04380000
046400         88  PS-TOP-OF-PAGE-SET                  VALUE 'Y'.       04390000
046500         88  PS-TOP-OF-PAGE-NOT-SET              VALUE 'N'.       04400000
046600     05  PRINT-DETAIL-CHECK-SW        PIC X(01)  VALUE 'N'.       04410000
046700         88  PRINT-DETAIL-CHECK                  VALUE 'Y'.       04420000
046800         88  NO-PRINT-DETAIL-CHECK               VALUE 'N'.       04430000
046900     05  PRINT-DOUBLE-HEADING-SW      PIC X(01)  VALUE 'N'.       04440000
047000         88  PRINT-DOUBLE-HEADING                VALUE 'Y'.       04450000
047100         88  PRINT-SINGLE-HEADING                VALUE 'N'.       04460000
047200                                                                  04470000
047300 01  PS-PROGRAM-SUBSCRIPTS.                                       04480000
047400     05  PS-DIST-SUB                     PIC S9(04)  VALUE +0     04490000
047500                                                     COMP SYNC.   04500000
047600     05  INST-SUB                        PIC S9(04)  VALUE +0     04510000
047700                                                     COMP SYNC.   04520000
047800     05  STR-SUB                         PIC S9(04)  VALUE +0     04530000
047900                                                     COMP SYNC.   04540000
048000                                                                  04550000
048100 01  MSG-MESSAGES.                                                04560000
048200     05  MSG-NO-KEYREC                PIC X(25)  VALUE            04570000
048300         '  KEYREC NOT FOUND       '.                             04580000
048400     05  MSG-NO-PO                    PIC X(25)  VALUE            04590000
048500         'ORDER NUMBER NOT FOUND   '.                             04600000
048600     05  MSG-NO-LINE-NUMBER           PIC X(48)  VALUE            04610000
048700         '  ****    INVALID LINE NUMBER REQUESTED     ****'.      04620000
048800                                                                  04630000
048900 01  SW-SWITCHES.                                                 04640000
049000     05  SW-END-OF-LINE               PIC X      VALUE 'N'.       04650000
049100         88  SW-THATS-ALL-FOLKS                  VALUE 'Y'.       04660000
049200         88  SW-THERES-MORE                      VALUE 'N'.       04670000
049300                                                                  04680000
049400 01  CD-CHECK-DIGIT-FIELDS.                                       04690000
049500     05  CD-CONTROL-NO.                                           04700000
049600         10  CD-FIRST4                PIC 9(4).                   04710000
049700         10  CD-LAST3                 PIC 9(3).                   04720000
049800         10  FILLER                   PIC X.                      04730000
049900     05  CD-CONTROL-DIGIT REDEFINES CD-CONTROL-NO                 04740000
050000                                      PIC 9    OCCURS 8 TIMES.    04750000
050100     05  CD-ODD-DIGITS                PIC 9(4).                   04760000
050200     05  CD-ODD-BYTE REDEFINES CD-ODD-DIGITS                      04770000
050300                                      PIC 9    OCCURS 4.          04780000
050400     05  CD-ODD-RESULT                PIC 9(5).                   04790000
050500     05  CD-ODD-RESULT-BYTE REDEFINES CD-ODD-RESULT               04800000
050600                                      PIC 9    OCCURS 5.          04810000
050700     05  CD-ODD-EVEN-RESULT           PIC 99.                     04820000
050800     05  CD-ODD-EVEN-BYTE REDEFINES CD-ODD-EVEN-RESULT            04830000
050900                                      PIC 9    OCCURS 2.          04840000
051000     05  CD-CHECK-DIGIT               PIC 9          VALUE ZERO.  04850000
051100                                                                  04860000
051200 01  MOD10-WORKAREA.                                              04870000
051300     05  MOD10-CHECK-DIGITS.                                      04880000
051400         10  MOD10-KEYREC             PIC X(08)      VALUE SPACE. 04890000
051500         10  MOD10-LINE-NMBR-X        PIC X(03)      VALUE SPACE. 04900000
051600         10  MOD10-LINE-NMBR  REDEFINES  MOD10-LINE-NMBR-X        04910000
051700                                      PIC 9(03).                  04920000
051800         10  MOD10-SEQ                PIC X(02)      VALUE SPACE. 04930000
051900     05  MOD10-CHECK-DIGIT-R   REDEFINES   MOD10-CHECK-DIGITS     04940000
052000                               OCCURS   13  TIMES                 04950000
052100                               INDEXED  BY  MOD10-DIGIT-INDEX     04960000
052200                                      PIC 9(01).                  04970000
052300     05  MOD10-MULT-ACCUM             PIC 9(02).                  04980000
052400     05  MOD10-MULT-DIGITS   REDEFINES   MOD10-MULT-ACCUM.        04990000
052500         10  MOD10-MULT-DIGIT1        PIC 9(01).                  05000000
052600         10  MOD10-MULT-DIGIT2        PIC 9(01).                  05010000
052700     05  MOD10-CHECK-DIGIT-SUM        PIC 9(02).                  05020000
052800     05  MOD10-CHECK-DIGIT-SUM-R   REDEFINES                      05030000
052900                             MOD10-CHECK-DIGIT-SUM.               05040000
053000         10  MOD10-CHECK-DIGIT1       PIC 9(01).                  05050000
053100         10  MOD10-CHECK-DIGIT2       PIC 9(01).                  05060000
053200     05  MOD10-CHECK-DIGIT            PIC 9(01).                  05070000
053300                                                                  05080000
053400 01  PA-PROGRAM-ACCUMS.                                           05090000
053500     05  PA-RPT1-PAGE-NO              PIC S9(5)      VALUE ZERO.  05100000
053600     05  PA-RPT2-PAGE-NO              PIC S9(5)      VALUE ZERO.  05110000
053700     05  PA-AMOUNT-RECEIVED           PIC S9(7)      COMP-3       05120000
053800                                                     VALUE ZERO.  05130000
053900     05  PA-LINE-COUNT                PIC S9(2)      VALUE ZERO.  05140000
054000     05  PA-SELECT-COUNTER            PIC S9(08)     VALUE +0     05150000
054100                                                     COMP SYNC.   05160000
054200     05  PA-VENDOR-REQ-CERT           PIC S9(08)     VALUE +0     05170000
054300                                                     COMP SYNC.   05180000
054400     05  PA-VENDOR-UPC                PIC S9(08)     VALUE +0     05190000
054500                                                     COMP SYNC.   05200000
054600                                                                  05210000
054700 01  SA-SAVE-AREAS.                                               05220000
054800     05  SA-REPORT-ID                 PIC X(8).                   05230000
054900     05  SA-PO-NBR                    PIC X(8).                   05240000
055000     05  SA-KEY-REC-NUM               PIC 9(8)       VALUE ZEROS. 05250000
055100     05  SA-KEY-REC  REDEFINES  SA-KEY-REC-NUM.                   05260000
055200         10  SA-KEY1                  PIC X(7).                   05270000
055300         10  SA-KEY-SUB REDEFINES SA-KEY1.                        05280000
055400             15  FILLER               PIC X(3).                   05290000
055500             15  SA-KEY-LAST4         PIC X(4).                   05300000
055600         10  SA-KEY2                  PIC X.                      05310000
055700     05  SA-TOTAL-QUANTITY            PIC S9(9)  VALUE ZERO.      05320000
055800     05  SA-KEY-FEED-BACK             PIC X(10)  VALUE SPACES.    05330000
055900     05  SA-RQTY                      PIC S9(6)  VALUE ZERO.      05340000
056000*    05  SA-LINE                      PIC X(03)  VALUE SPACES.    05350000
056100*    05  SA-STORE-NUM                 PIC X(03)  VALUE SPACES.    05360000
056200     05  SA-INSTRUCTIONS OCCURS 9 TIMES                           05370000
056300                                      PIC X(25)  VALUE SPACES.    05380000
056400     05  SA-FREIGHT-INSTR             PIC X(25)  VALUE SPACES.    05390000
056500     05  SA-DATE-RECEIVED             PIC X(08)  VALUE SPACES.    05400000
056600     05  SA-STYLE.                                                05410000
056700         10  SA-VENDOR-STYLE          PIC X(15).                  05420000
056800         10  FILLER                   PIC X(10).                  05430000
056900     05  SA-CLASS.                                                05440000
057000         10  SA-CLASS2                PIC X(2).                   05450000
057100         10  FILLER                   PIC X.                      05460000
057200     05  SA-DATE-N                    PIC 9(6).                   05470000
057300     05  SA-DATE REDEFINES SA-DATE-N.                             05480000
057400         10  SA-MONTH                 PIC X(2).                   05490000
057500         10  SA-DAY                   PIC X(2).                   05500000
057600         10  SA-YEAR.                                             05510000
057700             15  SA-FIRST-DIGIT-OF-YEAR                           05520000
057800                                      PIC X.                      05530000
057900             15  SA-SECOND-DIGIT-OF-YEAR                          05540000
058000                                      PIC X.                      05550000
058100     05  SA-SEASON.                                               05560000
058200         10  SA-SEASON-CODE           PIC X.                      05570000
058300         10  SA-SEASON-YR.                                        05580000
058400             15  SA-SEASON-SECOND-DIGIT-OF-YEAR                   05590000
058500                                      PIC X.                      05600000
058600         10  SA-SEASON-MONTH.                                     05610000
058700             15  SA-SEASON-SECOND-DIGIT-OF-MNTH                   05620000
058800                                      PIC X.                      05630000
058900                                                                  05640000
059000 01  IW-INTERMEDIATE-WORK-AREAS.                                  05650000
059100     05  IW-KEY-REC.                                              05660000
059200         10  IW-KEY1                  PIC X(7).                   05670000
059300         10  IW-HOLD                  PIC X.                      05680000
059400         10  IW-KEY2                  PIC X.                      05690000
059500     05  IW-DATE.                                                 05700000
059600         10  IW-MONTH                 PIC 9(2)   VALUE ZERO.      05710000
059700         10  FILLER REDEFINES IW-MONTH.                           05720000
059800             15  IW-FIRST-DIGIT-OF-MONTH                          05730000
059900                                      PIC X.                      05740000
060000             15  IW-SECOND-DIGIT-OF-MONTH                         05750000
060100                                      PIC X.                      05760000
060200         10  FILLER                   PIC X      VALUE '/'.       05770000
060300         10  IW-DAY                   PIC X(2).                   05780000
060400         10  FILLER                   PIC X      VALUE '/'.       05790000
060500         10  IW-YEAR                  PIC X(2).                   05800000
060600     05  IW-TIME.                                                 05810000
060700         10  IW-ABSTIME               PIC S9(18) COMP SYNC.       05820000
060800         10  IW-TIME-EDIT.                                        05830000
060900             15  IW-TIME-HHMM         PIC X(5).                   05840000
061000             15  FILLER               PIC X(3).                   05850000
061100     05  IW-AMOUNT                    PIC ZZZZZZ9.                05860000
061200                                                                  05870000
061300 01  PC-PROGRAM-CONSTANTS.                                        05880000
061400     05  PC-M                         PIC X(01) VALUE 'M'.        05890000
061500     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'MPKCS014'. 05900000
061600     05  PC-DPKCS060                  PIC X(8)  VALUE 'DPKCS060'. 05910000
061700     05  PC-MULT-SPECIAL-INSTRS-MSG   PIC X(25)  VALUE            05920000
061800         'MULT SPECIAL INSTRS EXIST'.                             05930000
061900     05  PC-MULTIPLE-RESULT-SET-ROWS  PIC S9(04) VALUE -811       05940000
062000                                                 COMP SYNC.       05950000
062100     05  PC-ROW-NOT-FOUND             PIC S9(04) VALUE +100       05960000
062200                                                 COMP SYNC.       05970000
062300     05  PC-MAX-DIST-CENTERS          PIC S9(04) VALUE +24        05980000
062400                                                 COMP SYNC.       05990000
062500     05  PC-DIST-OTR-DISPLAYED        PIC S9(04) VALUE +24        06000000
062600                                                 COMP SYNC.       06010000
062700     05  PC-VERIFIED-STATUS           PIC X(02)  VALUE 'VE'.      06020000
062800     05  PC-SPRING                    PIC X      VALUE 'S'.       06030000
062900     05  PC-FALL                      PIC X      VALUE 'F'.       06040000
063000     05  PC-INIT                      PIC X(04)  VALUE 'INIT'.    06050000
063100     05  PC-TERM                      PIC X(04)  VALUE 'TERM'.    06060000
063200     05  PC-ACTIVE-STATUS             PIC X(02)  VALUE 'AC'.      06070000
063300     05  PC-DASH                      PIC X      VALUE '-'.       06080000
063400     05  PC-PUT                       PIC X(03)  VALUE 'PUT'.     06090000
063500     05  PC-KOHLS-OPERATING-COMPANY   PIC X(02)  VALUE '03'.      06100000
063600*    05  PC-LINE-MAX                  PIC S9(2)  VALUE +22.       06110000
063610*DMH 05  PC-LINE-MAX                  PIC S9(2)  VALUE +44.       06120000
063620     05  PC-LINE-MAX                  PIC S9(2)  VALUE +32.       06120000
063700     05  PC-PAGE                      PIC X      VALUE '1'.       06130000
063800     05  PC-SPACE1                    PIC X      VALUE ' '.       06140000
063900     05  PC-SPACE2                    PIC X      VALUE '0'.       06150000
064000     05  PC-SPACE3                    PIC X      VALUE '-'.       06160000
064100     05  PC-SIX                       PIC 9      VALUE 6.         06170000
064200     05  PC-SEVEN                     PIC 9      VALUE 7.         06180000
064300     05  PC-ONE                       PIC 9      VALUE 1.         06190000
064400     05  PC-01                        PIC XX     VALUE '01'.      06200000
064500     05  PC-EXTERNAL-UPC-LOW          PIC S9(15)V                 06210000
064600                                      VALUE 000000000000000       06220000
064700                                      COMP-3.                     06230000
064800     05  PC-INTERNAL-UPC-LOW          PIC S9(15)V                 06240000
064900                                      VALUE 000399999999999       06250000
065000                                      COMP-3.                     06260000
065100     05  PC-INTERNAL-UPC-HIGH         PIC S9(15)V                 06270000
065200                                      VALUE 000500000000000       0628000T
065300                                      COMP-3.                     06290000
065400     05  PC-EXTERNAL-UPC-HIGH         PIC S9(15)V                 06300000
065500                                      VALUE 999999999999999       06310000
065600                                      COMP-3.                     06320000
065700     05  PC-MAX-RETRIES               PIC S9(04) VALUE +2         06330000
065800                                      COMP SYNC.                  06340000
065900     05  PC-DEFAULT-DATE              PIC X(26) VALUE             06350000
066000         '9999-09-09-09.09.09.999999'.                            06360000
066100*    05  PC-MULTI-TROUBLE             PIC X(08) VALUE 'MLT TRBL'. 06370000
066200     05  PC-MULTI-TROUBLE             PIC X(10) VALUE             06380000
066201                                                    'MULT TRBL '. 06390000
066202     05  PC-CERT-YES                  PIC X(03) VALUE 'YES'.      06400000
066300     05  PC-CERT-NO                   PIC X(03) VALUE 'NO '.      06410000
066400                                                                  06420000
066500 01  PV-PROGRAM-VARIABLES.                                        06430000
066600     05  PV-CICS-MSG-AREA             PIC  X(80)  VALUE SPACE.    06440000
066700     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    06450000
066800     05  PV-CICS-MSG-HOLD.                                        06460000
066900         10  FILLER                   PIC  X(01)  VALUE SPACE.    06470000
067000         10  PV-CICS-MSG-DATA         PIC  X(79)  VALUE SPACE.    06480000
067100     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        06490000
067200                                                  COMP SYNC.      06500000
067300     05  PV-2ND-DETAIL-COUNT          PIC S9(08)  VALUE ZEROES    06510000
067400                                                  COMP.           06520000
067500*DMH 05  PC-DC-PER-LINE               PIC  9(04)  VALUE 15.       06530000
067510     05  PC-DC-PER-LINE               PIC  9(04)  VALUE 12.       06530000
067600     05  PV-2ND-DETAIL-SUB            PIC  9(04)  VALUE ZEROES.   06540000
067700                                                                  06550000
067800     05  PV-PRC-FCLTY-AREA-ID         PIC X(06) VALUE SPACES.     06560000
067900     05  PV-DIST-COUNT                PIC S9(03) COMP-3 VALUE 0.  06570000
068000     05  PV-DB2-COUNT                 PIC S9(9) VALUE +0          06580000
068100                                                COMP-3.           06590000
068200     05  PV-OPEN-DC-COUNT             PIC S9(9) VALUE +0          06600000
068300                                                COMP-3.           06610000
068400     05  PV-PO-LNE-NBR                PIC S9(9) VALUE ZEROS       06620000
068500                                                COMP.             06630000
068600     05  PV-APP-PO-LNE-NBR            PIC S9(9) VALUE ZEROS       06640000
068700                                                COMP.             06650000
068800     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        06660000
068900                                                COMP SYNC.        06670000
069000     05  PV-OTR  OCCURS 4 TIMES       PIC S9(09) VALUE ZEROS      06680000
069100                                                COMP SYNC.        06690000
069200     05  PV-COMMON-LENGTH             PIC S9(04) VALUE +0         06700000
069300                                                 COMP.            06710000
069400     05  PV-REC-SEQ-NBR               PIC 9(09) VALUE ZEROS.      06720000
069500     05  PV-TMST                      PIC X(26) VALUE SPACE.      06730000
069600     05  FILLER  REDEFINES  PV-TMST.                              06740000
069700         10  PV-TMST-DATE.                                        06750000
069800             15  PV-TMST-DATE-CC      PIC X(02).                  06760000
069900             15  PV-TMST-DATE-YY      PIC X(02).                  06770000
070000         10  FILLER                   PIC X(01).                  06780000
070100         10  PV-TMST-DATE-MM          PIC X(02).                  06790000
070200         10  FILLER                   PIC X(01).                  06800000
070300         10  PV-TMST-DATE-DD          PIC X(02).                  06810000
070400         10  FILLER                   PIC X(16).                  06820000
070500     05  PV-VERIFIED-IND              PIC S9(4) VALUE ZERO        06830000
070600                                                COMP SYNC.        06840000
070700     05  PV-EXPTED-IND                PIC S9(4) VALUE ZERO        06850000
070800                                                COMP SYNC.        06860000
070900     05  PV-AD-EVNT-DTE               PIC S9(4) VALUE ZERO        06870000
071000                                                COMP SYNC.        06880000
071100     05  PV-OPEN-TO-REC               PIC S9(6) VALUE ZERO.       06890000
071200     05  PV-SUM-ITM-QTY               PIC S9(9) VALUE ZERO        06900000
071300                                                COMP SYNC.        06910000
071400     05  PV-SUM-VERIFIED-QTY          PIC S9(9) VALUE ZERO        06920000
071500                                                COMP SYNC.        06930000
071600     05  PV-RCVR-SEQ-NBR              PIC S9(9) VALUE ZEROS       06940000
071700                                                COMP.             06950000
071800     05  PV-DISPLAY-KEYS.                                         06960000
071900         10  PV-DISPLAY-ORD-NBR       PIC  9(09) VALUE ZEROS      06970000
072000                                                 BLANK WHEN ZEROS.06980000
072100         10  FILLER                   PIC  X(02) VALUE SPACE.     06990000
072200         10  PV-DISPLAY-RCVR-SEQ-NBR  PIC  9(09) VALUE ZEROS      07000000
072300                                                 BLANK WHEN ZEROS.07010000
072400         10  FILLER                   PIC  X(02) VALUE SPACE.     07020000
072500         10  PV-DISPLAY-ORD-LNE-NBR   PIC  9(04) VALUE ZEROS      07030000
072600                                                 BLANK WHEN ZEROS.07040000
072700         10  FILLER                   PIC  X(02) VALUE SPACE.     07050000
072800         10  PV-DISPLAY-WORK-ORD-SEQ-NBR                          07060000
072900                                      PIC  9(04) VALUE ZEROS      07070000
073000                                                 BLANK WHEN ZEROS.07080000
073100         10  FILLER                   PIC  X(02) VALUE SPACE.     07090000
073200         10  PV-DISPLAY-OPER-UNT-ID   PIC  9(04) VALUE ZEROS      07100000
073300                                                 BLANK WHEN ZEROS.07110000
073400         10  FILLER                   PIC  X(02) VALUE SPACE.     07120000
073500         10  PV-DISPLAY-FCLTY-ID      PIC  9(04) VALUE ZEROS      07130000
073600                                                 BLANK WHEN ZEROS.07140000
073700     05  PV-DISPLAY-ENT-ID            PIC  9(09) VALUE ZEROS.     07150000
073800     05  PV-DISPLAY-DEPT-NBR          PIC  9(03) VALUE ZEROS.     07160000
073900     05  PV-DEPT                      PIC  X(03).                 07170000
074000     05  PV-CLASS                     PIC  X(02).                 07180000
074100     05  PV-DISPLAY-SKU-NBR           PIC  X(08).                 07190000
074110     05  WS-DC-COUNT                  PIC S9(04) COMP VALUE +0.   07200000
074200*                                                                 07210000
074300*                                                                 07220000
074400 01  CA-COMMON-AREA.                                              07230000
074500         10  CA-PO-NBR                PIC 9(08).                  07240000
074600         10  CA-REC-SEQ-NBR           PIC 9(03).                  07250000
074700         10  CA-OPER-UNT-ID           PIC 9(04).                  07260000
074800         10  CA-FCLTY-ID              PIC 9(03).                  07270000
074900         10  CA-CLERK                 PIC X(20).                  07280000
075000         10  CA-PRINTER               PIC X(8).                   07290000
075100         10  CA-MASTER-PO             PIC X(1).                   07300000
075200         10  CA-CHECKIN-DOC           PIC X(1).                   07310000
075300         10  CA-CHECKIN-DOC-LINE      PIC 9(3).                   07320000
075400         10  CA-PRTR-AUTO-CUTTER-IND  PIC X(01)  VALUE SPACE.     07330000
075500         10  CA-PRTR-PRTR-BRCDE-IND   PIC X(01)  VALUE SPACE.     07340000
075600         10  CA-PRTR-PRTR-CNTL-IND    PIC X(01)  VALUE SPACE.     07350000
075700         10  CA-PRINT-PACKAGE-IND     PIC  X(01) VALUE SPACE.     07360000
075800             88 CA-NOT-FROM-PRINT-PACKAGE        VALUE 'N'.       07370000
075900             88 CA-FROM-PRINT-PACKAGE            VALUE 'Y'.       07380000
076000*GB 10/31/01                                                      07390000
076100         10  CA-MERCH-LOC             PIC X(15).                  07400000
076200*                                                                 07410000
076300         10  CA-DRIB-AREA             PIC X(264).                 07420000
076400                                                                  07430000
076500                                                                  07440000
076600*                                                                 07450000
076700*  DCLGEN FOR THE DB2 VENDOR/DEPARTMENT TABLE                     07460000
076800*                                                                 07470000
076900     EXEC SQL                                                     07480000
077000          INCLUDE TVNDDPT                                         07490000
077100     END-EXEC.                                                    07500000
077200                                                                  07510000
077300*                                                                 07520000
077400*  DCLGEN FOR THE DB2 WORK ORDER INSTRUCTION TABLE                07530000
077500*                                                                 07540000
077600     EXEC SQL                                                     07550000
077700          INCLUDE TWKORIN                                         07560000
077800     END-EXEC.                                                    07570000
077900                                                                  07580000
078000*                                                                 07590000
078100*  DCLGEN FOR THE DB2 VENDOR AGREEMENT TABLE                      07600000
078200*                                                                 07610000
078300     EXEC SQL                                                     07620000
078400         INCLUDE TVNDAGR                                          07630000
078500     END-EXEC.                                                    07640000
078600                                                                  07650000
078700                                                                  07660000
078800*                                                                 07670000
078900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STATUS CODE TABLE  07680000
079000*                                                                 07690000
079100     EXEC SQL                                                     07700000
079200          INCLUDE TSTATCD                                         07710000
079300     END-EXEC.                                                    07720000
079400                                                                  07730000
079500*                                                                 07740000
079600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     07750000
079700*  HEADER TABLE                                                   07760000
079800*                                                                 07770000
079900     EXEC SQL                                                     07780000
080000          INCLUDE TPURCHS                                         07790000
080100     END-EXEC.                                                    07800000
080200                                                                  07810000
080300*                                                                 07820000
080400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     07830000
080500*  ITEM TABLE                                                     07840000
080600*                                                                 07850000
080700     EXEC SQL                                                     07860000
080800          INCLUDE TPURITM                                         07870000
080900     END-EXEC.                                                    07880000
081000                                                                  07890000
081100*                                                                 07900000
081200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRIZE NAME    07910000
081300*  TABLE.                                                         07920000
081400*                                                                 07930000
081500     EXEC SQL                                                     07940000
081600          INCLUDE TENTNME                                         07950000
081700     END-EXEC.                                                    07960000
081800                                                                  07970000
081900*                                                                 07980000
082000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     07990000
082100*  INSTRUCTIONS TABLE                                             08000000
082200*                                                                 08010000
082300     EXEC SQL                                                     08020000
082400          INCLUDE TPOINST                                         08030000
082500     END-EXEC.                                                    08040000
082600                                                                  08050000
082700*                                                                 08060000
082800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     08070000
082900*  INSTRUCTIONS CODE TABLE                                        08080000
083000*                                                                 08090000
083100     EXEC SQL                                                     08100000
083200          INCLUDE TINSTCD                                         08110000
083300     END-EXEC.                                                    08120000
083400                                                                  08130000
083500*                                                                 08140000
083600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     08150000
083700*                                                                 08160000
083800     EXEC SQL                                                     08170000
083900          INCLUDE TRECEIV                                         08180000
084000     END-EXEC.                                                    08190000
084100                                                                  08200000
084900     EXEC SQL                                                     08210000
085000         INCLUDE XLT00010                                         08220000
085100     END-EXEC.                                                    08230000
085200                                                                  08240000
085300*                                                                 08250000
085400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            08260000
085500*  NOTIFICATION TABLE                                             08270000
085600*                                                                 08280000
085700     EXEC SQL                                                     08290000
085800          INCLUDE TTRBNTF                                         08300000
085900     END-EXEC.                                                    08310000
086000                                                                  08320000
086100*                                                                 08330000
086200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            08340000
086300*  REASON CODE TABLE                                              08350000
086400*                                                                 08360000
086500     EXEC SQL                                                     08370000
086600          INCLUDE TTRBRSN                                         08380000
086700     END-EXEC.                                                    08390000
086800                                                                  08400000
086900*                                                                 08410000
087000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PO ASSOCIATION TABL08420000
087100*                                                                 08430000
087200     EXEC SQL                                                     08440000
087300          INCLUDE TSHPTPO                                         08450000
087400     END-EXEC.                                                    08460000
087500                                                                  08470000
087600     EXEC SQL                                                     08480000
087700          INCLUDE TSHIPMT                                         08490000
087800     END-EXEC.                                                    08500000
087900                                                                  08510000
088000     EXEC SQL                                                     08520000
088100          INCLUDE TVHTRIP                                         08530000
088200     END-EXEC.                                                    08540000
088300                                                                  08550000
088400*                                                                 08560000
088500*  COMMUNICATION AREAS FOR DB2                                    08570000
088600*                                                                 08580000
088700     EXEC SQL                                                     08590000
088800         INCLUDE SQLCA                                            08600000
088900     END-EXEC.                                                    08610000
089000                                                                  08620000
089100*                                                                 08630000
089200*  CURSOR DECLARATION FOR PROCESSING ALL LINES FOR A SPECIFIED PO 08640000
089300*                                                                 08650000
089400                                                                  08660000
089500     EXEC SQL                                                     08670000
089600         DECLARE PO_CSR  CURSOR FOR                               08680000
089700             SELECT  A.ACTL_CART_CNT,                             08690000
089800                     A.RCVR_NBR,                                  08700000
089900                     A.REC_TMST,                                  08710000
090000                     A.PRE_TKT_IND,                               08720000
090100                     A.GOH_IND,                                   08730000
090200                     B.ENT_ID,                                    08740000
090300                     B.DEPT_NBR,                                  08750000
090400                     B.STATUS_CDE,                                08760000
090500                     B.PKGNG_CDE,                                 08770000
090600                     C.PO_LNE_NBR,                                08780000
090700                     C.APP_PO_LNE_NBR,                            08790000
090800                     D.INHOUSE_NBR                                08800000
090900               FROM  TRECEIV  A,                                  08810000
091000                     TPURCHS  B,                                  08820000
091100                     TPURITM  C,                                  08830000
091200                     TVNDDPT  D,                                  08840000
091300                     TSTATCD  E                                   08850000
091400              WHERE  (A.ORD_NBR         =  :DK-ORD-NBR            08860000
091500                AND   A.ORD_NBR         =  B.PO_NBR               08870000
091600                AND   B.PO_NBR          =  C.PO_NBR               08880000
091700                AND   A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR        08890000
091800                AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID        08900000
091900                AND   A.FCLTY_ID        =  :DK-FCLTY-ID           08910000
092000                AND   A.VER_STATUS_CDE  =  'A'                    08920000
092100                AND   B.VER_STATUS_CDE  =  'A'                    08930000
092200                AND   C.VER_STATUS_CDE  =  'A'                    08940000
092300                AND   B.ENT_ID          =  D.ENT_ID               08950000
092400                AND   B.DEPT_NBR        =  D.DEPT_NBR             08960000
092500                AND   E.STATUS_TYP_CDE  =  'P'                    08970000
092600                AND   E.STATUS_CLS      IN ('ACT','CMP')          08980000
092700                AND   E.STATUS_CDE      =  B.STATUS_CDE)          08990000
092800           ORDER BY  C.PO_LNE_NBR                                 09000000
092900     END-EXEC.                                                    09010000
093000                                                                  09020000
093100*                                                                 09030000
093200*  CURSOR DECLARATION FOR RETRIEVING ALL RECEIVERS OTHER THAN     09040000
093300*  THE ONE BEING PROCESSED FOR THE LINE BEING PROCESSED.          09050000
093400*                                                                 09060000
093500******************************************************************09070000
093600*  TWKORIN CURSOR                                                *09080000
093700******************************************************************09090000
093800     EXEC SQL                                                     09100000
093900          DECLARE TWKORIN-CSR CURSOR FOR                          09110000
094000             SELECT  STRT_TMST,                                   09120000
094100                     STOP_TMST,                                   09130000
094200                     PRC_FCLTY_AREA_ID,                           09140000
094300                     SCREEN_SEQ_NBR                               09150000
094400               FROM  TWKORIN                                      09160000
094500              WHERE  (ORD_NBR            =  :DK-ORD-NBR           09170000
094600                AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR       09180000
094700                AND   ORD_LNE_NBR        =  :DK-ORD-LNE-NBR       09190000
094800                AND   WORK_ORD_SEQ_NBR   =  1                     09200000
094900                AND   OPER_UNT_ID        =  :DK-OPER-UNT-ID       09210000
095000                AND   FCLTY_ID           =  :DK-FCLTY-ID          09220000
095100                AND   VER_STATUS_CDE     =  'A')                  09230000
095200           ORDER BY  SCREEN_SEQ_NBR                               09240000
095300     END-EXEC.                                                    09250000
095400                                                                  09260000
095500******************************************************************09270000
095600*  TWKORIN CURSOR - FOR LINE NUMBER = ZERO                       *09280000
095700******************************************************************09290000
095800     EXEC SQL                                                     09300000
095900          DECLARE WKORIN0-CSR CURSOR FOR                          09310000
096000             SELECT  STRT_TMST,                                   09320000
096100                     STOP_TMST,                                   09330000
096200                     PRC_FCLTY_AREA_ID,                           09340000
096300                     SCREEN_SEQ_NBR                               09350000
096400               FROM  TWKORIN                                      09360000
096500              WHERE  (ORD_NBR            =  :DK-ORD-NBR           09370000
096600                AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR       09380000
096700                AND   ORD_LNE_NBR        =  0                     09390000
096800                AND   WORK_ORD_SEQ_NBR   =  1                     09400000
096900                AND   OPER_UNT_ID        =  :DK-OPER-UNT-ID       09410000
097000                AND   FCLTY_ID           =  :DK-FCLTY-ID          09420000
097100                AND   VER_STATUS_CDE     = 'A')                   09430000
097200           ORDER BY  SCREEN_SEQ_NBR                               09440000
097300     END-EXEC.                                                    09450000
097400                                                                  09460000
097500     EJECT                                                        09470000
097600                                                                  09480000
097700                                                                  09490000
097800     EXEC SQL                                                     09500000
097900         DECLARE DC-STR-CSR  CURSOR FOR                           09510000
098000             SELECT LOC_NBR                                       09520000
098100                  , LOC_5_ABBR_NM                                 09530000
098200               FROM XLT_LOC                                       09540000
098300              WHERE                                               09550000
098400                     LOC_TYP_CDE = 'DC'                           09560000
098500                AND  (CURRENT DATE                                09570000
098600                      BETWEEN                                     09580000
098700                       OPN_DTE AND CLO_DTE)                       09590000
098800           ORDER BY LOC_NBR                                       09600000
098900     END-EXEC.                                                    09610000
099000                                                                  09620000
099100                                                                  09630000
099200     EXEC SQL                                                     09640000
099300         DECLARE SP_INST_CSR  CURSOR FOR                          09650000
099400         SELECT  B.INSTR_DESC                                     09660000
099500           FROM  TPOINST A,                                       09670000
099600                 TINSTCD B                                        09680000
099700          WHERE  (A.PO_NBR     =  :DK-ORD-NBR                     09690000
099800            AND   A.RECIP_CDE  =  'DC'                            09700000
099900            AND   A.INSTR_NBR  =  B.INSTR_NBR)                    09710000
100000     END-EXEC.                                                    09720000
100100                                                                  09730000
100200*                                                                 09740000
100300*  SQL DB2 TROUBLE RECORD RECIEVER CURSOR DECLARATION             09750000
100400*                                                                 09760000
100500     EXEC SQL                                                     09770000
100600          DECLARE TRBL_R_CSR CURSOR FOR                           09780000
100700              SELECT  B.TRBL_LONG_DESC                            09790000
100800                FROM  TTRBNTF A                                   09800000
100900                    , TTRBRSN B                                   09810000
101000               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           09820000
101100                 AND   A.PO_LNE_NBR      =  0000                  09830000
101200                 AND   A.PREPK_ID        =  0000                  09840000
101300                 AND   A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR       09850000
101400                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       09860000
101500                 AND   A.RESOLVED_IND    IN ('N', 'I')            09870000
101600                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE)       09880000
101700     END-EXEC.                                                    09890000
101800                                                                  09900000
101900*                                                                 09910000
102000*  SQL DB2 TROUBLE RECORD CURSOR DECLARATION                      09920000
102100*                                                                 09930000
102200     EXEC SQL                                                     09940000
102300          DECLARE TRBL_CSR CURSOR FOR                             09950000
102400              SELECT  B.TRBL_SHT_DESC                             09960000
102500                FROM  TTRBNTF A                                   09970000
102600                    , TTRBRSN B                                   09980000
102700               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           09990000
102800                 AND ((A.PO_LNE_NBR      =  :DK-ORD-LNE-NBR       10000000
102900                 AND   B.TRBL_LVL_IND    <> :PC-M)                10010000
103000                  OR  (A.PREPK_ID        =  :DK-PREPK-ID          10020000
103100                 AND   B.TRBL_LVL_IND    =  :PC-M))               10030000
103200                 AND   A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR       10040000
103300                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       10050000
103400                 AND   A.RESOLVED_IND    IN ('N', 'I')            10060000
103500                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE)       10070000
103600     END-EXEC.                                                    10080000
103700                                                                  10090000
103800     EJECT                                                        10100000
103900*                                                                 10110000
104000*  TSHPTPO CURSOR DECLARATION TO FIND IF ANY OF THE LINES FOR     10120000
104100*  THE GIVEN PO HAS ROWS WHERE THE PACK SLIP INDICATIOR IS SET TO 10130000
104200*  'N'.                                                           10140000
104300*                                                                 10150000
104400     EXEC SQL                                                     10160000
104500        DECLARE TSHPTPO_CSR CURSOR FOR                            10170000
104600        SELECT  A.PKSL_IND                                        10180000
104700        FROM    TSHPTPO A                                         10190000
104800        WHERE   A.PO_NBR        = :DK-ORD-NBR                     10200000
104900        AND     A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                 10210000
105000        AND     A.PKSL_IND      = 'N'                             10220000
105100     END-EXEC.                                                    10230000
105200                                                                  10240000
105300     COPY DPWS276.                                                10250000
105400 01  PV-SAVE-OTR-AREA.                                            10260000
105500*DMH 05  PV-SAVE-OTR-TABLE      OCCURS 15 TIMES PIC X(23000).     10270000
105510     05  PV-SAVE-OTR-TABLE      OCCURS 24 TIMES PIC X(23000).     10270000
105600   EJECT                                                          10280000
105700******************************************************************10290000
105800 LINKAGE SECTION.                                                 10300000
105900******************************************************************10310000
106000                                                                  10320000
106100 01  DFHCOMMAREA                      PIC X(400).                 10330000
106200     EJECT                                                        10340000
106300******************************************************************10350000
106400 PROCEDURE DIVISION.                                              10360000
106500******************************************************************10370000
106600                                                                  10380000
106700 0000-MAINLINE.                                                   10390000
106800     MOVE LENGTH OF CA-COMMON-AREA TO PV-COMMON-LENGTH            10400000
106900     MOVE +200                     TO DRS02-DRIB-LRECL-1          10410000
106901                                      DRS02-DRIB-BLKSIZE-1.       10420000
106902                                                                  10430000
107000     EXEC CICS                                                    10440000
107100          RETRIEVE INTO(CA-COMMON-AREA)                           10450000
107200                   LENGTH(PV-COMMON-LENGTH)                       10460000
107300                   RESP   (PV-CICS-RESP)                          10470000
107400     END-EXEC.                                                    10480000
107500                                                                  10490000
107600     EVALUATE TRUE                                                10500000
107700         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     10510000
107800             CONTINUE                                             10520000
107900         WHEN PV-CICS-RESP = DFHRESP (ENDDATA)                    10530000
108000             PERFORM 1100-MOVE-COMMAREA                           10540000
108100         WHEN OTHER                                               10550000
108200             PERFORM Z950-DRS-ERROR-SUICIDE                       10560000
108300     END-EVALUATE.                                                10570000
108400*    IF THIS PROGRAM WAS CALLED FROM THE PRINT PACKAGE, ALL       10580000
108500*    DRS INIT/TERM AND PRINTER CONTROL WILL BE FROM THERE         10590000
108600     IF CA-NOT-FROM-PRINT-PACKAGE                                 10600000
108700         MOVE PC-INIT TO DRS01-DRRB-FUNC                          10610000
108800                                                                  10620000
108900         IF CA-PRINTER = 'XXXXXXXX'                               10630000
109000             MOVE 'R'            TO DRS02-DRIB-CLASS              10640000
109100             MOVE 'N'            TO DRS02-DRIB-HOLD               10650000
109200             MOVE 'LOCAL' TO DRS02-DRIB-DEST                      10660000
109300             MOVE DRS02-DRIB-HEADER TO DRS01-COMM-DRIB-HDR        10670000
109400             MOVE DRS02-DRIB-ATTRIB TO DRS01-COMM-DRIB-AT1        10680000
109500         ELSE                                                     10690000
109600             MOVE 'A'            TO DRS02-DRIB-CLASS              10700000
109700             MOVE 'N'            TO DRS02-DRIB-HOLD               10710000
109800             MOVE CA-PRINTER TO DRS02-DRIB-DEST                   10720000
109900             MOVE DRS02-DRIB-HEADER TO DRS01-COMM-DRIB-HDR        10730000
110000             MOVE DRS02-DRIB-ATTRIB TO DRS01-COMM-DRIB-AT1        10740000
110100         END-IF                                                   10750000
110200                                                                  10760000
110300         EXEC CICS LINK                                           10770000
110400             PROGRAM ('DRS1INTC')                                 10780000
110500             COMMAREA(DRS01-COMMAREA)                             10790000
110600             LENGTH(200)                                          10800000
110700         END-EXEC                                                 10810000
110800                                                                  10820000
110900         IF DRS01-DRRB-RC IS EQUAL TO ZERO                        10830000
111000             CONTINUE                                             10840000
111100         ELSE                                                     10850000
111200             PERFORM Z950-DRS-ERROR-SUICIDE                       10860000
111300         END-IF                                                   10870000
111400                                                                  10880000
111500         MOVE DRS01-DRRB-RID TO SA-REPORT-ID                      10890000
111600                                                                  10900000
111700         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           10910000
111800             PERFORM A010-LOAD-FORM-TO-DRS                        10920000
111900         END-IF                                                   10930000
112000     END-IF.                                                      10940000
112100     MOVE PC-PUT             TO  DRS01-DRRB-FUNC.                 10950000
112200                                                                  10960000
112300     INITIALIZE PV-SAVE-OTR-AREA.                                 10970000
112400                                                                  10980000
112500     SET  PRINT-SINGLE-HEADING  TO  TRUE                          10990000
112600     PERFORM 7065-COUNT-DC.                                       11000000
112700     PERFORM 7070-OPEN-DC-STR-CSR.                                11010000
112800     PERFORM 7080-FETCH-DC-STR-CSR.                               11020000
114100     MOVE  ZEROES  TO  RH1-SUB-DIST-13                            11040000
114200                       RH1-SUB-DIST-14                            11050000
114201                       RH1-SUB-DIST-15                            11060000
114202                       RH1-SUB-DIST-16                            11070000
114203                       RH1-SUB-DIST-17                            11070000
114204                       RH1-SUB-DIST-18                            11070000
114205                       RH1-SUB-DIST-19                            11070000
114206                       RH1-SUB-DIST-20                            11070000
114207                       RH1-SUB-DIST-21                            11070000
114208                       RH1-SUB-DIST-22                            11070000
114209                       RH1-SUB-DIST-23                            11070000
114210                       RH1-SUB-DIST-24.                           11070000
114300     PERFORM A060-LOAD-DC-ITEMS                                   11080000
114400             VARYING STR-SUB FROM 1 BY 1                          11090000
114500             UNTIL SQLCODE = PC-ROW-NOT-FOUND                     11100000
114600             OR STR-SUB > PC-MAX-DIST-CENTERS.                    11110000
114700     IF PV-DIST-COUNT > PC-MAX-DIST-CENTERS                       11120000
114800         MOVE PC-MAX-DIST-CENTERS TO PV-DIST-COUNT                11130000
114900     END-IF                                                       11140000
115000     PERFORM 7090-CLOSE-STR-NBR-CSR.                              11150000
115100                                                                  11160000
115200     PERFORM A100-CREATE-KEY-REPORTS                              11170000
115300         UNTIL  PS-DONE-WITH-RPTS.                                11180000
115400                                                                  11190000
115500*    IF THIS PROGRAM WAS CALLED FROM THE PRINT PACKAGE, ALL       11200000
115600*    DRS INIT/TERM AND PRINTER CONTROL WILL TAKE PLACE THERE      11210000
115700     IF  CA-NOT-FROM-PRINT-PACKAGE                                11220000
115800*        IF THE PRINTER HAS AN AUTO CUTTER, SENT CUT COMMAND      11230000
115900         IF CA-PRTR-AUTO-CUTTER-IND = 'Y'                         11240000
116000             MOVE PC-PUT                     TO DRS01-DRRB-FUNC   11250000
116100             MOVE DS004-PLC-CUT-FORM         TO DRS01-COMM-DATA   11260000
116200             MOVE SPACE                      TO DRS01-COMM-CTL    11270000
116300             PERFORM Z900-PUT-LINE-TO-DRS                         11280000
116400         END-IF                                                   11290000
116500                                                                  11300000
116600         MOVE PC-TERM TO DRS01-DRRB-FUNC                          11310000
116700         EXEC CICS LINK                                           11320000
116800             PROGRAM ('DRS1INTC')                                 11330000
116900             COMMAREA(DRS01-COMMAREA)                             11340000
117000             LENGTH(200)                                          11350000
117100         END-EXEC                                                 11360000
117200     END-IF.                                                      11370000
117300                                                                  11380000
117400     GOBACK.                                                      11390000
117500                                                                  11400000
117600                                                                  11410000
117700 1100-MOVE-COMMAREA.                                              11420000
117800     INITIALIZE CA-COMMON-AREA.                                   11430000
117900     MOVE DFHCOMMAREA           TO CA-COMMON-AREA.                11440000
118000*  THIS RESTORES THE DRIB WORK AREAS THAT WERE INITIALIZED        11450000
118100*  IN DSKCS606                                                    11460000
118200     MOVE CA-DRIB-AREA          TO DRS01-COMMAREA.                11470000
118300     MOVE DRS01-COMM-DRIB-HDR   TO DRS02-DRIB-HEADER.             11480000
118400     MOVE DRS01-COMM-DRIB-AT1   TO DRS02-DRIB-ATTRIB.             11490000
118500     MOVE DRS01-DRRB-RID        TO SA-REPORT-ID.                  11500000
118600                                                                  11510000
118700                                                                  11520000
118800                                                                  11530000
118900***************************************************************   11540000
119000**  A010-LOAD-FORM-TO-DRS. -- CALL THE PRINT-PACKAGE PRINTER **   11550000
119100**  CONTROL MODULE TO GET THE FORM FOR SEND TO THE PRINTER.  **   11560000
119200**  THIS PARAGRAPH IS EXECUTED ONLY IF THE PRINTER ACCEPTS   **   11570000
119300**  PRINTER CONTROL COMMANDS                                 **   11580000
119400***************************************************************   11590000
119500 A010-LOAD-FORM-TO-DRS.                                           11600000
119600     INITIALIZE DP072-COMM-AREA.                                  11610000
119700     MOVE CA-PRINTER                 TO DP072-PRINTER-ID.         11620000
119800     MOVE PC-CURRENT-PROGRAM-NAME    TO DP072-RPT-PGM-NME.        11630000
119900     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     11640000
120000     SET DP072-SELECT TO TRUE.                                    11650000
120100                                                                  11660000
120200     PERFORM A011-LINK-DPKCS060.                                  11670000
120300                                                                  11680000
120400     MOVE DP072-PRTR-TRACK-NBR       TO DS004-PLC-LF-FORM-NBR.    11690000
120500     MOVE DS004-PES-8LPI             TO DS004-PLC-LF-LPI          11700000
120600                                        DS004-PLC-DI-LPI.         11710000
120700                                                                  11720000
120800     IF  CA-NOT-FROM-PRINT-PACKAGE                                11730000
120900         MOVE PC-PUT                     TO DRS01-DRRB-FUNC       11740000
121000         MOVE DS004-PLC-LOAD-FORM        TO DRS01-COMM-DATA       11750000
121100         PERFORM Z900-PUT-LINE-TO-DRS                             11760000
121200     END-IF.                                                      11770000
121300                                                                  11780000
121400 A011-LINK-DPKCS060.                                              11790000
121500***************************************************************   11800000
121600**  1101-LINK-DPKCS060 -- LINK TO THE PRINT-PACKACGE PRINTER **   11810000
121700**  CONTROL MODULE (DPKCS060)                                **   11820000
121800***************************************************************   11830000
121900     EXEC CICS                                                    11840000
122000         LINK PROGRAM  (PC-DPKCS060)                              11850000
122100              COMMAREA (DP072-COMM-AREA)                          11860000
122200              RESP     (PV-CICS-RESP)                             11870000
122300     END-EXEC.                                                    11880000
122400                                                                  11890000
122500     EVALUATE TRUE                                                11900000
122600         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     11910000
122700             CONTINUE                                             11920000
122800         WHEN OTHER                                               11930000
122900               MOVE '1101-LINK-DPKCS060'                          11940000
123000                                    TO DP013-PARAGRAPH            11950000
123100               MOVE PV-CICS-RESP    TO DP013-MESSAGE-TEXT (1)     11960000
123200               MOVE SQLCA           TO DP013-SQLCA                11970000
123300               SET DP013-LINK-RETURN                              11980000
123400                   DP013-CICS-ABEND                               11990000
123500                   DP013-NO-ROLLBACK TO TRUE                      12000000
123600               PERFORM 9999-ABEND                                 12010000
123700     END-EVALUATE.                                                12020000
123800                                                                  12030000
123900                                                                  12040000
124000******************************************************************12050000
124100*  A060-LOAD-DC-ITEMS - THIS PARAGRAPH LOADS THE DISTRIBUTION CENT12060000
124200*                       STORE NUMBERS INTO A WORKING STORAGE TABLE12070000
124300******************************************************************12080000
124400 A060-LOAD-DC-ITEMS.                                              12090000
124500                                                                  12100000
124600     EVALUATE STR-SUB                                             12110000
124700     WHEN 1                                                       12120000
124800         IF DK-DIST (STR-SUB) = ZERO                              12130000
124900             IF  PRINT-SINGLE-HEADING                             12140000
125000                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12150000
125100                                          RH1-SUB-DIST(STR-SUB)   12160000
125200                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
125300                                      RH1-SUB-DIST-DESC(STR-SUB)  12180000
125400             ELSE                                                 12190000
125500                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12200000
125600                                          RH1-SUB-DIST-13         12210000
125610                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
125620                                          RH1-SUB-DIST-DESC13     12180000
125700             END-IF                                               12220000
125800         END-IF                                                   12230000
125900     WHEN 2                                                       12240000
126000         IF DK-DIST (STR-SUB) = ZERO                              12250000
126100             IF  PRINT-SINGLE-HEADING                             12260000
126200                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12270000
126300                                           RH1-SUB-DIST(STR-SUB)  12280000
126400                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12290000
126500                                      RH1-SUB-DIST-DESC(STR-SUB)  12300000
126600             ELSE                                                 12310000
126700                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12320000
126800                                             RH1-SUB-DIST-14      12330000
126810                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
126820                                          RH1-SUB-DIST-DESC14     12180000
126900             END-IF                                               12340000
127000         END-IF                                                   12350000
127100     WHEN 3                                                       12360000
127200         IF DK-DIST (STR-SUB) = ZERO                              12370000
127300             IF  PRINT-SINGLE-HEADING                             12380000
127400                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12390000
127500                                           RH1-SUB-DIST(STR-SUB)  12400000
127600                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12410000
127700                                      RH1-SUB-DIST-DESC(STR-SUB)  12420000
127800             ELSE                                                 12430000
127900                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12440000
128000                                             RH1-SUB-DIST-15      12450000
128010                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
128020                                          RH1-SUB-DIST-DESC15     12180000
128100             END-IF                                               12460000
128200         END-IF                                                   12470000
128300     WHEN 4                                                       12480000
128400         IF DK-DIST (STR-SUB) = ZERO                              12490000
128500             IF  PRINT-SINGLE-HEADING                             12500000
128600                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12510000
128700                                          RH1-SUB-DIST(STR-SUB)   12520000
128800                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12530000
128900                                      RH1-SUB-DIST-DESC(STR-SUB)  12540000
129000             ELSE                                                 12550000
129100                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12560000
129200                                             RH1-SUB-DIST-16      12570000
129210                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
129220                                          RH1-SUB-DIST-DESC16     12180000
129300             END-IF                                               12580000
129400         END-IF                                                   12590000
129500     WHEN 5                                                       12600000
129600         IF DK-DIST (STR-SUB) = ZERO                              12610000
129700             IF  PRINT-SINGLE-HEADING                             12620000
129800                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12630000
129900                                          RH1-SUB-DIST(STR-SUB)   12640000
130000                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12650000
130100                                      RH1-SUB-DIST-DESC(STR-SUB)  12660000
130200             ELSE                                                 12670000
130300                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
130400                                             RH1-SUB-DIST-17      12690000
130410                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
130420                                          RH1-SUB-DIST-DESC17     12180000
130500             END-IF                                               12700000
130600         END-IF                                                   12710000
130700     WHEN 6                                                       12720000
130800         IF DK-DIST (STR-SUB) = ZERO                              12730000
130810             IF  PRINT-SINGLE-HEADING                             12620000
130900                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)            
131000                                          RH1-SUB-DIST(STR-SUB)           
131100                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12760000
131200                                      RH1-SUB-DIST-DESC(STR-SUB)  12770000
131210             ELSE                                                 12670000
131220                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
131230                                             RH1-SUB-DIST-18      12690000
131231                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
131232                                          RH1-SUB-DIST-DESC18     12180000
131240             END-IF                                               12700000
131300         END-IF                                                   12780000
131400     WHEN 7                                                       12790000
131500         IF DK-DIST (STR-SUB) = ZERO                              12800000
131510             IF  PRINT-SINGLE-HEADING                             12620000
131600                 MOVE XLT00010-LOC-NBR   TO DK-DIST (STR-SUB)             
131700                                         RH1-SUB-DIST(STR-SUB)    12820000
131800                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12830000
131900                                      RH1-SUB-DIST-DESC(STR-SUB)  12840000
131910             ELSE                                                 12670000
131920                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
131930                                             RH1-SUB-DIST-19      12690000
131931                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
131932                                          RH1-SUB-DIST-DESC19     12180000
131940             END-IF                                               12700000
132000         END-IF                                                   12850000
132100     WHEN 8                                                       12860000
132200         IF DK-DIST (STR-SUB) = ZERO                              12870000
132210             IF  PRINT-SINGLE-HEADING                             12620000
132300                 MOVE XLT00010-LOC-NBR   TO DK-DIST (STR-SUB)             
132400                                         RH1-SUB-DIST(STR-SUB)    12890000
132500                 MOVE XLT00010-LOC-5-ABBR-NM  TO                          
132600                                      RH1-SUB-DIST-DESC(STR-SUB)  12910000
132610             ELSE                                                 12670000
132620                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
132630                                             RH1-SUB-DIST-20      12690000
132631                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
132632                                          RH1-SUB-DIST-DESC20     12180000
132640             END-IF                                               12700000
132700         END-IF                                                   12920000
132800     WHEN 9                                                       12930000
132900         IF DK-DIST (STR-SUB) = ZERO                              12940000
132910             IF  PRINT-SINGLE-HEADING                             12620000
133000                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)            
133100                                          RH1-SUB-DIST(STR-SUB)           
133200                 MOVE XLT00010-LOC-5-ABBR-NM  TO                          
133300                                      RH1-SUB-DIST-DESC(STR-SUB)  12980000
133310             ELSE                                                 12670000
133320                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
133330                                             RH1-SUB-DIST-21      12690000
133331                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
133332                                          RH1-SUB-DIST-DESC21     12180000
133340             END-IF                                               12700000
133400         END-IF                                                   12990000
133401     WHEN 10                                                      13000000
133402         IF DK-DIST (STR-SUB) = ZERO                              13010000
133403             IF  PRINT-SINGLE-HEADING                             12620000
133404                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)            
133405                                          RH1-SUB-DIST(STR-SUB)           
133406                 MOVE XLT00010-LOC-5-ABBR-NM  TO                          
133407                                      RH1-SUB-DIST-DESC(STR-SUB)  13050000
133408             ELSE                                                 12670000
133409                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
133410                                             RH1-SUB-DIST-22      12690000
133411                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
133412                                          RH1-SUB-DIST-DESC22     12180000
133413             END-IF                                               12700000
133414         END-IF                                                   13060000
133415     WHEN 11                                                      13070000
133416         IF DK-DIST (STR-SUB) = ZERO                              13080000
133417             IF  PRINT-SINGLE-HEADING                             12620000
133418                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)            
133419                                          RH1-SUB-DIST(STR-SUB)           
133420                 MOVE XLT00010-LOC-5-ABBR-NM  TO                          
133421                                      RH1-SUB-DIST-DESC(STR-SUB)  13120000
133422             ELSE                                                 12670000
133423                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
133424                                             RH1-SUB-DIST-23      12690000
133425                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
133426                                          RH1-SUB-DIST-DESC23     12180000
133427             END-IF                                               12700000
133428         END-IF                                                   13130000
133429     WHEN 12                                                              
133430         IF DK-DIST (STR-SUB) = ZERO                                      
133431             IF  PRINT-SINGLE-HEADING                             12620000
133432                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)            
133433                                          RH1-SUB-DIST(STR-SUB)           
133434                 MOVE XLT00010-LOC-5-ABBR-NM  TO                          
133435                                      RH1-SUB-DIST-DESC(STR-SUB)  13190000
133436             ELSE                                                 12670000
133437                 MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)    12680000
133438                                             RH1-SUB-DIST-24      12690000
133439                 MOVE XLT00010-LOC-5-ABBR-NM  TO                  12170000
133440                                          RH1-SUB-DIST-DESC24     12180000
133441             END-IF                                               12700000
133442         END-IF                                                   13200000
133443                                                                          
133444     WHEN 13                                                      13210000
133445         IF DK-DIST (STR-SUB) = ZERO                              13220000
133446             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13230000
133447                                         RH1-SUB-DIST(1)          13240000
133448                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13250000
133449                                      RH1-SUB-DIST-DESC(1)        13260000
133450         END-IF                                                   13270000
133451     WHEN 14                                                      13280000
133452         IF DK-DIST (STR-SUB) = ZERO                              13290000
133453             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13300000
133454                                         RH1-SUB-DIST(2)          13310000
133455                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13320000
133456                                      RH1-SUB-DIST-DESC(2)        13330000
133457         END-IF                                                   13340000
133458     WHEN 15                                                      13350000
133459         IF DK-DIST (STR-SUB) = ZERO                              13360000
133460             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133461                                         RH1-SUB-DIST(3)          13380000
133462                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133463                                      RH1-SUB-DIST-DESC(3)        13400000
133470         END-IF                                                   13410000
133480     WHEN 16                                                      13350000
133490         IF DK-DIST (STR-SUB) = ZERO                              13360000
133491             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133492                                         RH1-SUB-DIST(4)          13380000
133493                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133494                                      RH1-SUB-DIST-DESC(4)        13400000
133495         END-IF                                                   13410000
133496     WHEN 17                                                      13350000
133497         IF DK-DIST (STR-SUB) = ZERO                              13360000
133498             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133499                                         RH1-SUB-DIST(5)          13380000
133500                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133501                                      RH1-SUB-DIST-DESC(5)        13400000
133502         END-IF                                                   13410000
133503     WHEN 18                                                      13350000
133504         IF DK-DIST (STR-SUB) = ZERO                              13360000
133505             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133506                                         RH1-SUB-DIST(6)          13380000
133507                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133508                                      RH1-SUB-DIST-DESC(6)        13400000
133509         END-IF                                                   13410000
133510     WHEN 19                                                      13350000
133511         IF DK-DIST (STR-SUB) = ZERO                              13360000
133512             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133513                                         RH1-SUB-DIST(7)          13380000
133514                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133515                                      RH1-SUB-DIST-DESC(7)        13400000
133516         END-IF                                                   13410000
133517     WHEN 20                                                      13350000
133518         IF DK-DIST (STR-SUB) = ZERO                              13360000
133519             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133520                                         RH1-SUB-DIST(8)          13380000
133521                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133522                                      RH1-SUB-DIST-DESC(8)        13400000
133523         END-IF                                                   13410000
133524     WHEN 21                                                      13350000
133525         IF DK-DIST (STR-SUB) = ZERO                              13360000
133526             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133527                                         RH1-SUB-DIST(9)          13380000
133528                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133529                                      RH1-SUB-DIST-DESC(9)        13400000
133530         END-IF                                                   13410000
133531     WHEN 22                                                      13350000
133532         IF DK-DIST (STR-SUB) = ZERO                              13360000
133533             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133534                                         RH1-SUB-DIST(10)         13380000
133535                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133536                                      RH1-SUB-DIST-DESC(10)               
133537         END-IF                                                   13410000
133538     WHEN 23                                                      13350000
133539         IF DK-DIST (STR-SUB) = ZERO                              13360000
133540             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133541                                         RH1-SUB-DIST(11)                 
133542                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133543                                      RH1-SUB-DIST-DESC(11)               
133544         END-IF                                                   13410000
133545     WHEN 24                                                      13350000
133546         IF DK-DIST (STR-SUB) = ZERO                              13360000
133547             MOVE XLT00010-LOC-NBR    TO DK-DIST (STR-SUB)        13370000
133548                                         RH1-SUB-DIST(12)                 
133549                MOVE XLT00010-LOC-5-ABBR-NM  TO                   13390000
133550                                      RH1-SUB-DIST-DESC(12)               
133551         END-IF                                                   13410000
133560     WHEN OTHER                                                           
133600         MOVE 'A060-LOAD-DC-ITEMS'                                13430000
133700                 TO DP013-PARAGRAPH                               13440000
133800         MOVE 'DC STR OVERFLOW.  MAX DC # HAS BEEN EXCEEED '      13450000
133900             TO DP013-MESSAGE-TEXT (1)                            13460000
134000         SET DP013-DB2-ABEND   TO TRUE                            13470000
134100         SET DP013-NO-ROLLBACK TO TRUE                            13480000
134200         PERFORM 9999-ABEND                                       13490000
134300     END-EVALUATE.                                                13500000
134400                                                                  13510000
134500     PERFORM 4200-CALC-OPEN-TO-REC.                               13520000
134600                                                                  13530000
134700     MOVE DP276-OTR-TABLE      TO PV-SAVE-OTR-TABLE(STR-SUB).     13540000
134800                                                                  13550000
134900     PERFORM 7080-FETCH-DC-STR-CSR.                               13560000
135000                                                                  13570000
135100                                                                  13580000
135200 4200-CALC-OPEN-TO-REC.                                           13590000
135300                                                                  13600000
135400     SET DP276-LINE-LEVEL-OTR                                     13610000
135500         DP276-RECEIVER-OTR      TO TRUE                          13620000
135600                                                                  13630000
135700     INITIALIZE DP276-KEYS                                        13640000
135800     MOVE CA-PO-NBR              TO DP276-PO-NBR                  13650000
135900     MOVE ZERO                   TO DP276-PO-LNE-NBR              13660000
136000     MOVE CA-REC-SEQ-NBR         TO DP276-REC-SEQ-NBR             13670000
136100     MOVE XLT00010-LOC-NBR       TO DP276-OPER-UNT-ID             13680000
136200     MOVE CA-FCLTY-ID            TO DP276-FCLTY-ID.               13690000
136300     MOVE ZERO                   TO DP276-STR-NBR.                13700000
136400                                                                  13710000
136500                                                                  13720000
136600     COPY DPPD276.                                                13730000
136700 EJECT                                                            13740000
136800******************************************************************13750000
136900* A100-CREATE-KEY-REPORTS - THIS PARAGRAPH WILL GO INTO THE LOGIC 13760000
137000*      WHICH PRINTS THE REPORTS BASED ON WHICH CODE IS SET        13770000
137100******************************************************************13780000
137200 A100-CREATE-KEY-REPORTS.                                         13790000
137300     MOVE CA-PO-NBR       TO  DK-ORD-NBR.                         13800000
137400     MOVE CA-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                     13810000
137500     MOVE CA-OPER-UNT-ID  TO  DK-OPER-UNT-ID.                     13820000
137600     MOVE CA-FCLTY-ID     TO  DK-FCLTY-ID.                        13830000
137700                                                                  13840000
137800         MOVE 'A100-CREATE-KEY'  TO DP013-MESSAGE-TEXT (2)        13850000
137900         PERFORM X100-OPEN-PO-CSR                                 13860000
138000         PERFORM Y000-FETCH-PO-CSR                                13870000
138100         IF SQLCODE = ZEROS                                       13880000
138200             MOVE SA-REPORT-ID TO DRS01-DRRB-RID                  13890000
138300             PERFORM B200-PROCESS-PO-FIELDS                       13900000
138400             SET PS-DONE-WITH-RPTS  TO  TRUE                      13910000
138500         ELSE                                                     13920000
138600             PERFORM X200-CLOSE-PO-CSR                            13930000
138700             PERFORM B100-NO-PO-FOUND                             13940000
138800             SET PS-DONE-WITH-RPTS  TO  TRUE                      13950000
138900         END-IF.                                                  13960000
139000*    END-IF.                                                      13970000
139100                                                                  13980000
139200******************************************************************13990000
139300*  B100-NO-PO-FOUND - THIS PARAGRAPH WILL PRINT AND EMPTY REPORT  14000000
139400******************************************************************14010000
139500 B100-NO-PO-FOUND.                                                14020000
139600     PERFORM C100-FORMAT-HEADER1-LINES.                           14030000
139700     MOVE CA-PO-NBR       TO  R1D-PO-NBR.                         14040000
139800     MOVE CA-REC-SEQ-NBR  TO  R1D-REC-SEQ-NBR.                    14050000
139900     MOVE MSG-NO-PO     TO R1D-VENDOR.                            14060000
140000     MOVE R1D-DETAIL1 TO DRS01-COMM-DATA.                         14070000
140100     MOVE PC-SPACE2 TO DRS01-COMM-CTL.                            14080000
140200     MOVE SA-REPORT-ID TO DRS01-DRRB-RID                          14090000
140300     PERFORM Z900-PUT-LINE-TO-DRS.                                14100000
140400                                                                  14110000
140500******************************************************************14120000
140600*  B200-PROCESS-PO-FIELDS - THIS IS THE MAIN PARAGRAPH FOR PRINTIN14130000
140700*       THE MASTER PURCHASE ORDER (MOP) REPORT.                   14140000
140800******************************************************************14150000
140900 B200-PROCESS-PO-FIELDS.                                          14160000
141000                                                                  14170000
141100*                                                                 14180000
141200*  THIS LOGIC OPENS A CURSOR TO SEE IF PO LEVEL TROUBLE WAS FOUND 14190000
141300*  FOR THE PO BEING PROCESSED.  WHEN TROUBLE IS FOUND THE TROUBLE 14200000
141400*  MESSAGE LINE IS PRINTED AT THE TOP OF THE PAGE                 14210000
141500*                                                                 14220000
141600     PERFORM B330-OPEN-R-TRBL-CSR.                                14230000
141700     PERFORM B340-FETCH-R-TRBL-CSR.                               14240000
141800     INITIALIZE TL2-TROUBLE-LINE-2.                               14250000
141900     SET TRBL-IDX  TO 1.                                          14260000
142000     PERFORM B360-LOAD-R-TRBL-TBL                                 14270000
142100         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         14280000
142200         OR TRBL-IDX > 2.                                         14290000
142300     PERFORM B350-CLOSE-R-TRBL-CSR.                               14300000
142400                                                                  14310000
142500     IF TL2-R-TRBL-DESC (1) NOT = SPACES                          14320000
142600         MOVE TL1-TROUBLE-LINE-1     TO  DRS01-COMM-DATA          14330000
142700         SET PS-TOP-OF-PAGE-SET TO TRUE                           14340000
142800         MOVE PC-PAGE                TO  DRS01-COMM-CTL           14350000
142900         MOVE SA-REPORT-ID           TO  DRS01-DRRB-RID           14360000
143000         PERFORM Z900-PUT-LINE-TO-DRS                             14370000
143100         MOVE TL2-TROUBLE-LINE-2     TO  DRS01-COMM-DATA          14380000
143200         MOVE PC-SPACE2              TO  DRS01-COMM-CTL           14390000
143300         MOVE SA-REPORT-ID           TO  DRS01-DRRB-RID           14400000
143400         PERFORM Z900-PUT-LINE-TO-DRS                             14410000
143500     END-IF.                                                      14420000
143600                                                                  14430000
143700*                                                                 14440000
143800*  THE FOLLOWIG LOGIC WILL DETERMINE IF THERE IS ONE OR MORE      14450000
143900*  SHIPMENTS FOR THE RECEIVER WHERE THE PACK SLIP INDICATOR IS SET14460000
144000*  TO 'N', IF THERE IS THE DETAIL CHECK LINE IS PRINTED AT THE    14470000
144100*  TOP OF THE PAGE.                                               14480000
144200*                                                                 14490000
144300     PERFORM B370-OPEN-TSHPTPO-CSR.                               14500000
144400     PERFORM B380-FETCH-TSHPTPO-CSR.                              14510000
144500     PERFORM B390-CLOSE-TSHPTPO-CSR.                              14520000
144600                                                                  14530000
144700     IF PRINT-DETAIL-CHECK                                        14540000
144800        SET NO-PRINT-DETAIL-CHECK TO TRUE                         14550000
144900        MOVE TL1-DETCHECK-LINE-1 TO DRS01-COMM-DATA               14560000
145000        MOVE PC-SPACE1           TO DRS01-COMM-CTL                14570000
145100        MOVE SA-REPORT-ID        TO DRS01-DRRB-RID                14580000
145200              SET PS-TOP-OF-PAGE-SET TO TRUE                      14590000
145300              PERFORM Z900-PUT-LINE-TO-DRS                        14600000
145400     END-IF.                                                      14610000
145500                                                                  14620000
145600*                                                                 14630000
145700*  PRINT THE HEADER INFORMATION                                   14640000
145800*                                                                 14650000
145900     PERFORM C100-FORMAT-HEADER1-LINES.                           14660000
146000     MOVE PURITM-APP-PO-LNE-NBR TO PV-APP-PO-LNE-NBR.             14670000
146100     MOVE PURITM-PO-LNE-NBR     TO PV-PO-LNE-NBR.                 14680000
146200     PERFORM 7010-GET-PRIMARY-VNDR-NME.                           14690000
146300     MOVE CA-PO-NBR             TO SA-PO-NBR.                     14700000
146400     MOVE SA-PO-NBR             TO R1D-PO-NBR.                    14710000
146500     MOVE CA-REC-SEQ-NBR        TO R1D-REC-SEQ-NBR.               14720000
146600     MOVE ENTNME-ENT-NAME-DESC  TO  R1D-VENDOR.                   14730000
146700     MOVE PURCHS-STATUS-CDE     TO  R1D-PO-STATUS.                14740000
146800     MOVE RECEIV-ACTL-CART-CNT  TO  SA-RQTY.                      14750000
146900     MOVE SA-RQTY               TO  R1D-CARTONS.                  14760000
147000     MOVE RECEIV-REC-TMST       TO  PV-TMST.                      14770000
147100     MOVE PV-TMST-DATE-YY       TO  SA-YEAR.                      14780000
147200     MOVE PV-TMST-DATE-MM       TO  SA-MONTH.                     14790000
147300     MOVE PV-TMST-DATE-DD       TO  SA-DAY.                       14800000
147400     MOVE SA-MONTH              TO  IW-MONTH.                     14810000
147500     MOVE SA-DAY                TO  IW-DAY.                       14820000
147600     MOVE SA-YEAR               TO  IW-YEAR.                      14830000
147700     MOVE PURCHS-PKGNG-CDE      TO  R1D-PKG-CODE.                 14840000
147800     MOVE RECEIV-PRE-TKT-IND    TO  R1D-PRE-TICKET.               14850000
147900     MOVE RECEIV-GOH-IND        TO  R1D-HANG-IND.                 14860000
148000                                                                  14870000
148100     IF PV-TMST = PC-DEFAULT-DATE                                 14880000
148200         MOVE 'ENROUTE'         TO R1D-DATE                       14890000
148300                                   SA-DATE-RECEIVED               14900000
148400     ELSE                                                         14910000
148500         MOVE IW-DATE           TO R1D-DATE                       14920000
148600                                   SA-DATE-RECEIVED               14930000
148700         MOVE SA-SECOND-DIGIT-OF-YEAR                             14940000
148800                                TO SA-SEASON-SECOND-DIGIT-OF-YEAR 14950000
148900     END-IF.                                                      14960000
149000                                                                  14970000
149100     IF SA-DATE-RECEIVED = 'ENROUTE'                              14980000
149200         MOVE SPACES TO SA-SEASON                                 14990000
149300     ELSE                                                         15000000
149400         IF IW-MONTH < PC-SEVEN                                   15010000
149500             MOVE PC-SPRING TO SA-SEASON-CODE                     15020000
149600             MOVE IW-SECOND-DIGIT-OF-MONTH                        15030000
149700                            TO SA-SEASON-SECOND-DIGIT-OF-MNTH     15040000
149800         ELSE                                                     15050000
149900             SUBTRACT PC-SIX FROM IW-MONTH                        15060000
150000             MOVE PC-FALL TO SA-SEASON-CODE                       15070000
150100             MOVE IW-SECOND-DIGIT-OF-MONTH                        15080000
150200                            TO SA-SEASON-SECOND-DIGIT-OF-MNTH     15090000
150300         END-IF                                                   15100000
150400     END-IF.                                                      15110000
150500                                                                  15120000
150600     PERFORM 4500-GET-PROCESSING-AREA.                            15130000
150700     MOVE PV-PRC-FCLTY-AREA-ID TO R1D-AREA.                       15140000
150800                                                                  15150000
150900     PERFORM 7100-GET-SHIPMENT-INFO.                              15160000
151000     MOVE SPACES      TO R1D-MDSE-LOC.                            15170000
151100     IF CA-MERCH-LOC > SPACES                                     15180000
151200        MOVE CA-MERCH-LOC TO R1D-MDSE-LOC                         15190000
151300     END-IF.                                                      15200000
151400     MOVE R1D-DETAIL1          TO DRS01-COMM-DATA.                15210000
151500     MOVE PC-SPACE2            TO DRS01-COMM-CTL.                 15220000
151600     MOVE SA-REPORT-ID         TO DRS01-DRRB-RID.                 15230000
151700                                                                  15240000
151800     PERFORM Z900-PUT-LINE-TO-DRS.                                15250000
151900                                                                  15260000
152000     PERFORM 7040-GET-AD-DATE.                                    15270000
152100     MOVE SPACES              TO SA-FREIGHT-INSTR.                15280000
152200     MOVE PURITM-AD-EVNT-DTE  TO  SA-DATE-N.                      15290000
152300     MOVE SA-MONTH            TO IW-MONTH.                        15300000
152400     MOVE SA-DAY              TO IW-DAY.                          15310000
152500     MOVE SA-YEAR             TO IW-YEAR.                         15320000
152600                                                                  15330000
152700     IF SA-DATE IS NUMERIC                                        15340000
152800         IF SA-DATE IS EQUAL TO ZERO OR                           15350000
152900                                SPACES                            15360000
153000             MOVE SPACES TO RID-AD-DATE                           15370000
153100         ELSE                                                     15380000
153200             MOVE IW-DATE      TO RID-AD-DATE                     15390000
153300         END-IF                                                   15400000
153400     ELSE                                                         15410000
153500         MOVE SPACES TO RID-AD-DATE                               15420000
153600     END-IF.                                                      15430000
153700                                                                  15440000
153800     MOVE SPACES       TO SA-FREIGHT-INSTR.                       15450000
153900     MOVE CA-CLERK     TO R1D-CLERK.                              15460000
154000     MOVE R1D-DETAIL2  TO DRS01-COMM-DATA.                        15470000
154100     MOVE PC-SPACE2    TO DRS01-COMM-CTL.                         15480000
154200     MOVE SA-REPORT-ID TO DRS01-DRRB-RID.                         15490000
154300                                                                  15500000
154400     PERFORM Z900-PUT-LINE-TO-DRS.                                15510000
154500                                                                  15520000
154600     SET PS-SPECIAL-INSTRS-FOUND TO TRUE.                         15530000
154700     PERFORM 7020-OPEN-SP-INST-CSR.                               15540000
154800     PERFORM B210-PRINT-SPEC-INST                                 15550000
154900        VARYING INST-SUB FROM 1 BY 1 UNTIL                        15560000
155000           PS-NO-SPECIAL-INSTRS-FOUND OR                          15570000
155100           INST-SUB > 7                                           15580000
155200     PERFORM 7035-CLOSE-SP-INST-CSR.                              15590000
155300                                                                  15600000
155310     MOVE 'TOT'                 TO RH1-TOTAL                      15610000
155400     IF  PRINT-DOUBLE-HEADING                                     15620000
155500         MOVE R1H-DESC-SUB-HEADING-1A                                     
155510                                TO DRS01-COMM-DATA                15630000
155600         MOVE PC-SPACE2         TO DRS01-COMM-CTL                 15640000
155700         MOVE SA-REPORT-ID      TO DRS01-DRRB-RID                 15650000
155800                                                                  15660000
155900         PERFORM Z900-PUT-LINE-TO-DRS                             15670000
156000                                                                  15680000
156010         MOVE R1H-SUB-HEADING1A TO DRS01-COMM-DATA                15630000
156020         MOVE PC-SPACE1         TO DRS01-COMM-CTL                 15640000
156030         MOVE SA-REPORT-ID      TO DRS01-DRRB-RID                 15650000
156040                                                                  15660000
156050         PERFORM Z900-PUT-LINE-TO-DRS                             15670000
156060                                                                  15680000
156070         MOVE R1H-DESC-SUB-HEADING-1                                      
156080                                TO DRS01-COMM-DATA                15630000
156090         MOVE PC-SPACE1         TO DRS01-COMM-CTL                 15640000
156091         MOVE SA-REPORT-ID      TO DRS01-DRRB-RID                 15650000
156092                                                                  15660000
156093         PERFORM Z900-PUT-LINE-TO-DRS                             15670000
156094                                                                  15680000
156100         MOVE R1H-SUB-HEADING1 TO DRS01-COMM-DATA                 15690000
156200         MOVE PC-SPACE1        TO DRS01-COMM-CTL                  15700000
156300         MOVE SA-REPORT-ID     TO DRS01-DRRB-RID                  15710000
156400                                                                  15720000
156500         PERFORM Z900-PUT-LINE-TO-DRS                             15730000
156600     ELSE                                                         15740000
156700**GB 10/31/01 BEG **********************************************  15750000
156800         MOVE R1H-DESC-SUB-HEADING-1 TO DRS01-COMM-DATA           15760000
156900         MOVE PC-SPACE3        TO DRS01-COMM-CTL                  15770000
157000         MOVE SA-REPORT-ID     TO DRS01-DRRB-RID                  15780000
157100                                                                  15790000
157200         PERFORM Z900-PUT-LINE-TO-DRS                             15800000
157300**GB 10/31/01 END **********************************************  15810000
157400                                                                  15820000
157500         MOVE R1H-SUB-HEADING1 TO DRS01-COMM-DATA                 15830000
157600         MOVE PC-SPACE1        TO DRS01-COMM-CTL                  15840000
157700         MOVE SA-REPORT-ID     TO DRS01-DRRB-RID                  15850000
157800                                                                  15860000
157900         PERFORM Z900-PUT-LINE-TO-DRS                             15870000
158000     END-IF.                                                      15880000
158100     MOVE R1H-SUB-HEADING2 TO DRS01-COMM-DATA.                    15890000
158200     MOVE PC-SPACE1    TO DRS01-COMM-CTL.                         15900000
158300     MOVE SA-REPORT-ID TO DRS01-DRRB-RID.                         15910000
158400                                                                  15920000
158500     PERFORM Z900-PUT-LINE-TO-DRS.                                15930000
158600                                                                  15940000
158700*                                                                 15950000
158800*  PRINT THE DETAIL LINES FOR THE PO                              15960000
158900*                                                                 15970000
159000     PERFORM C200-PROCESS-LINE-ITEMS                              15980000
159100         UNTIL  SW-THATS-ALL-FOLKS                                15990000
159200                                                                  16000000
159300     PERFORM X200-CLOSE-PO-CSR.                                   16010000
159400     MOVE 'N'  TO  SW-END-OF-LINE.                                16020000
159500                                                                  16030000
159600 B210-PRINT-SPEC-INST.                                            16040000
159700     PERFORM 7030-GET-SPECIAL-INSTRS.                             16050000
159800     IF PS-SPECIAL-INSTRS-FOUND                                   16060000
159900         MOVE INSTCD-INSTR-DESC  TO  SA-INSTRUCTIONS (INST-SUB)   16070000
160000                                     R1D-SPECIAL-INST             16080000
160100         MOVE R1D-DETAIL2A TO DRS01-COMM-DATA                     16090000
160200         MOVE PC-SPACE1    TO DRS01-COMM-CTL                      16100000
160300         MOVE SA-REPORT-ID TO DRS01-DRRB-RID                      16110000
160400         PERFORM Z900-PUT-LINE-TO-DRS                             16120000
160410         ADD 1 TO PA-LINE-COUNT                                   19190000
160500     END-IF.                                                      16130000
160600                                                                  16140000
160700 B330-OPEN-R-TRBL-CSR.                                            16150000
160800     EXEC SQL                                                     16160000
160900         OPEN TRBL_R_CSR                                          16170000
161000     END-EXEC.                                                    16180000
161100                                                                  16190000
161200     EVALUATE TRUE                                                16200000
161300         WHEN SQLCODE = ZERO                                      16210000
161400             CONTINUE                                             16220000
161500         WHEN SQLWARN0 NOT = SPACE                                16230000
161600         WHEN SQLCODE < ZERO                                      16240000
161700         WHEN SQLCODE > ZERO                                      16250000
161800             MOVE 'B330-OPEN-R-TRBL-CSR'                          16260000
161900                 TO DP013-PARAGRAPH                               16270000
162000             MOVE 'OPEN THE TRBL_R_CSR'                           16280000
162100                 TO DP013-MESSAGE-TEXT (1)                        16290000
162200             MOVE SQLCA            TO DP013-SQLCA                 16300000
162300             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    16310000
162400             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    16320000
162500             SET DP013-DB2-ABEND   TO TRUE                        16330000
162600             SET DP013-NO-ROLLBACK TO TRUE                        16340000
162700             PERFORM 9999-ABEND                                   16350000
162800     END-EVALUATE.                                                16360000
162900                                                                  16370000
163000 B340-FETCH-R-TRBL-CSR.                                           16380000
163100     INITIALIZE DCLTWKORIN.                                       16390000
163200                                                                  16400000
163300     EXEC SQL                                                     16410000
163400         FETCH  TRBL_R_CSR                                        16420000
163500          INTO  :TRBRSN-TRBL-LONG-DESC                            16430000
163600     END-EXEC.                                                    16440000
163700                                                                  16450000
163800     EVALUATE TRUE                                                16460000
163900         WHEN SQLCODE = ZERO                                      16470000
164000             CONTINUE                                             16480000
164100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          16490000
164200             CONTINUE                                             16500000
164300         WHEN SQLWARN0 NOT = SPACE                                16510000
164400         WHEN SQLCODE < ZERO                                      16520000
164500         WHEN SQLCODE > ZERO                                      16530000
164600             MOVE 'B340-FETCH-R-TRBL-CSR'                         16540000
164700                 TO DP013-PARAGRAPH                               16550000
164800             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 16560000
164900-                 'FROM THE TRBL_R_CSR'                           16570000
165000               TO DP013-MESSAGE-TEXT (1)                          16580000
165100             MOVE SQLCA            TO DP013-SQLCA                 16590000
165200             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    16600000
165300             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    16610000
165400             SET DP013-DB2-ABEND   TO TRUE                        16620000
165500             SET DP013-NO-ROLLBACK TO TRUE                        16630000
165600             PERFORM 9999-ABEND                                   16640000
165700     END-EVALUATE.                                                16650000
165800                                                                  16660000
165900 B350-CLOSE-R-TRBL-CSR.                                           16670000
166000     EXEC SQL                                                     16680000
166100         CLOSE TRBL_R_CSR                                         16690000
166200     END-EXEC.                                                    16700000
166300                                                                  16710000
166400     EVALUATE TRUE                                                16720000
166500         WHEN SQLCODE = ZERO                                      16730000
166600             CONTINUE                                             16740000
166700         WHEN SQLWARN0 NOT = SPACE                                16750000
166800         WHEN SQLCODE < ZERO                                      16760000
166900         WHEN SQLCODE > ZERO                                      16770000
167000             MOVE 'B350-CLOSE-R-TRBL-CSR'                         16780000
167100                 TO DP013-PARAGRAPH                               16790000
167200             MOVE 'CLOSE THE TRBL_R_CSR'                          16800000
167300                 TO DP013-MESSAGE-TEXT (1)                        16810000
167400             MOVE SQLCA            TO DP013-SQLCA                 16820000
167500             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    16830000
167600             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    16840000
167700             SET DP013-DB2-ABEND   TO TRUE                        16850000
167800             SET DP013-NO-ROLLBACK TO TRUE                        16860000
167900             PERFORM 9999-ABEND                                   16870000
168000     END-EVALUATE.                                                16880000
168100                                                                  16890000
168200******************************************************************16900000
168300*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            16910000
168400******************************************************************16920000
168500 B360-LOAD-R-TRBL-TBL.                                            16930000
168600     MOVE TRBRSN-TRBL-LONG-DESC TO TL2-R-TRBL-DESC (TRBL-IDX1).   16940000
168700     SET TRBL-IDX1  UP BY 1.                                      16950000
168800     PERFORM B340-FETCH-R-TRBL-CSR.                               16960000
168900                                                                  16970000
169000 B370-OPEN-TSHPTPO-CSR.                                           16980000
169100     EXEC SQL                                                     16990000
169200         OPEN TSHPTPO_CSR                                         17000000
169300     END-EXEC.                                                    17010000
169400                                                                  17020000
169500     EVALUATE TRUE                                                17030000
169600         WHEN SQLCODE = ZERO                                      17040000
169700             CONTINUE                                             17050000
169800         WHEN SQLWARN0 NOT = SPACE                                17060000
169900         WHEN SQLCODE < ZERO                                      17070000
170000         WHEN SQLCODE > ZERO                                      17080000
170100             MOVE 'B370-OPEN-TSHPTPO-CSR'                         17090000
170200                 TO DP013-PARAGRAPH                               17100000
170300             MOVE 'OPEN THE TSHPTPO_CSR'                          17110000
170400                 TO DP013-MESSAGE-TEXT (1)                        17120000
170500             MOVE SQLCA            TO DP013-SQLCA                 17130000
170600             MOVE 'TSHPTPO'        TO DP013-DB2-TABLE-NAME (1)    17140000
170700             SET DP013-DB2-ABEND   TO TRUE                        17150000
170800             SET DP013-NO-ROLLBACK TO TRUE                        17160000
170900             PERFORM 9999-ABEND                                   17170000
171000     END-EVALUATE.                                                17180000
171100                                                                  17190000
171200 B380-FETCH-TSHPTPO-CSR.                                          17200000
171300     INITIALIZE DCLTSHPTPO.                                       17210000
171400                                                                  17220000
171500     EXEC SQL                                                     17230000
171600         FETCH  TSHPTPO_CSR                                       17240000
171700          INTO  :SHPTPO-PKSL-IND                                  17250000
171800     END-EXEC.                                                    17260000
171900                                                                  17270000
172000     EVALUATE TRUE                                                17280000
172100         WHEN SQLCODE = ZERO                                      17290000
172200             SET PRINT-DETAIL-CHECK TO TRUE                       17300000
172300         WHEN SQLCODE = PC-ROW-NOT-FOUND                          17310000
172400             CONTINUE                                             17320000
172500         WHEN SQLWARN0 NOT = SPACE                                17330000
172600         WHEN SQLCODE < ZERO                                      17340000
172700         WHEN SQLCODE > ZERO                                      17350000
172800             MOVE 'B380-FETCH-TSHPTPO-CSR'                        17360000
172900                 TO DP013-PARAGRAPH                               17370000
173000             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 17380000
173100-                 'FROM THE TSHPTPO CSR'                          17390000
173200               TO DP013-MESSAGE-TEXT (1)                          17400000
173300             MOVE SQLCA            TO DP013-SQLCA                 17410000
173400             MOVE 'TSHPTPO'        TO DP013-DB2-TABLE-NAME (1)    17420000
173500             SET DP013-DB2-ABEND   TO TRUE                        17430000
173600             SET DP013-NO-ROLLBACK TO TRUE                        17440000
173700             PERFORM 9999-ABEND                                   17450000
173800     END-EVALUATE.                                                17460000
173900                                                                  17470000
174000 B390-CLOSE-TSHPTPO-CSR.                                          17480000
174100     EXEC SQL                                                     17490000
174200         CLOSE TSHPTPO_CSR                                        17500000
174300     END-EXEC.                                                    17510000
174400                                                                  17520000
174500     EVALUATE TRUE                                                17530000
174600         WHEN SQLCODE = ZERO                                      17540000
174700             CONTINUE                                             17550000
174800         WHEN SQLWARN0 NOT = SPACE                                17560000
174900         WHEN SQLCODE < ZERO                                      17570000
175000         WHEN SQLCODE > ZERO                                      17580000
175100             MOVE 'B390-CLOSE-TSHPTPO-CSR'                        17590000
175200                 TO DP013-PARAGRAPH                               17600000
175300             MOVE 'CLOSE THE TSHPTPO-CSR'                         17610000
175400                 TO DP013-MESSAGE-TEXT (1)                        17620000
175500             MOVE SQLCA            TO DP013-SQLCA                 17630000
175600             MOVE 'TSHPTPO'        TO DP013-DB2-TABLE-NAME (1)    17640000
175700             SET DP013-DB2-ABEND   TO TRUE                        17650000
175800             SET DP013-NO-ROLLBACK TO TRUE                        17660000
175900             PERFORM 9999-ABEND                                   17670000
176000     END-EVALUATE.                                                17680000
176100                                                                  17690000
176200 C100-FORMAT-HEADER1-LINES.                                       17700000
176300     EXEC CICS                                                    17710000
176400         ASKTIME                                                  17720000
176500         ABSTIME(IW-ABSTIME)                                      17730000
176600     END-EXEC.                                                    17740000
176700     EXEC CICS                                                    17750000
176800         FORMATTIME                                               17760000
176900         ABSTIME(IW-ABSTIME)                                      17770000
177000         MMDDYY(DP133O-RUN-DATE)                                  17780000
177100         DATESEP                                                  17790000
177200         TIME(IW-TIME-EDIT)                                       17800000
177300         TIMESEP                                                  17810000
177400     END-EXEC.                                                    17820000
177500     MOVE IW-TIME-HHMM TO DP133O-RUN-TIME.                        17830000
177510     MOVE ZEROES          TO DP133O-PAGE-NUMBER.                  17850000
177600     ADD 1 TO PA-RPT1-PAGE-NO.                                    17840000
177700     MOVE PA-RPT1-PAGE-NO TO DP133O-PAGE-NUMBER.                  17850000
177800     MOVE 'MPKCS014' TO DP133O-PROGRAM-NAME.                      17860000
177900     MOVE  1  TO DP133O-REPORT-NUMBER.                            17870000
178000     MOVE DP133O-STANDRD-HEADER-133-COLS TO DRS01-COMM-DATA.      17880000
178100     IF PS-TOP-OF-PAGE-SET                                        17890000
178200         MOVE PC-SPACE2 TO DRS01-COMM-CTL                         17900000
178300     ELSE                                                         17910000
178400         MOVE PC-PAGE   TO DRS01-COMM-CTL                         17920000
178500     END-IF.                                                      17930000
178600     MOVE SA-REPORT-ID TO DRS01-DRRB-RID.                         17940000
178700     PERFORM Z900-PUT-LINE-TO-DRS.                                17950000
178800     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          17960000
178900     MOVE R1H-REPORT-HEADING1 TO DRS01-COMM-DATA.                 17970000
179000     MOVE PC-SPACE1 TO DRS01-COMM-CTL.                            17980000
179100     MOVE SA-REPORT-ID TO DRS01-DRRB-RID.                         17990000
179200     PERFORM Z900-PUT-LINE-TO-DRS.                                18000000
179300     MOVE R1H-REPORT-HEADING2 TO DRS01-COMM-DATA.                 18010000
179400     MOVE PC-SPACE2 TO DRS01-COMM-CTL.                            18020000
179500     MOVE SA-REPORT-ID TO DRS01-DRRB-RID.                         18030000
179600     PERFORM Z900-PUT-LINE-TO-DRS.                                18040000
179700     MOVE R1H-REPORT-HEADING3 TO DRS01-COMM-DATA.                 18050000
179800     MOVE PC-SPACE1 TO DRS01-COMM-CTL.                            18060000
179900     MOVE SA-REPORT-ID TO DRS01-DRRB-RID.                         18070000
180000     PERFORM Z900-PUT-LINE-TO-DRS.                                18080000
180100                                                                  18090000
180200                                                                  18100000
180300 C200-PROCESS-LINE-ITEMS.                                         18110000
180400     MOVE RECEIV-RCVR-NBR    TO SA-KEY-REC-NUM.                   18120000
180500     MOVE PV-APP-PO-LNE-NBR  TO R1D-CONTROL-LINE                  18130000
180600                                CD-LAST3                          18140000
180700                                DK-ORD-LNE-NBR.                   18150000
180800     MOVE SA-KEY-LAST4       TO CD-FIRST4.                        18160000
180900     PERFORM E200-CALC-CHECK-DIGIT.                               18170000
181000                                                                  18180000
181100     PERFORM 7050-SELECT-PO-LNE-ITM-DATA.                         18190000
181200     PERFORM 7055-CALL-CICS-API-ARCH.                             18200000
181300                                                                  18210000
181400     MOVE PURITM-SKU-DESC       TO R1D-DESCRIPTION.               18220000
181500     MOVE PURITM-SIZE-DESC      TO R1D-SIZE.                      18230000
181600     MOVE PURITM-VEND-STYL-NAME TO SA-STYLE.                      18240000
181700     MOVE SA-VENDOR-STYLE       TO R1D-VENDOR-STYLE.              18250000
181800     MOVE PURITM-COLOR-DESC     TO R1D-COLOR.                     18260000
181900     MOVE PURITM-STATUS-CDE     TO R1D-STATUS.                    18270000
182000     MOVE PURITM-PO-PREPK-ID    TO DK-PREPK-ID.                   18280000
182100                                                                  18290000
182200     MOVE PURITM-CL-NBR         TO SA-CLASS.                      18300000
182300     MOVE SA-CLASS2             TO PV-CLASS.                      18310000
182400                                                                  18320000
182500     MOVE PURCHS-DEPT-NBR       TO PV-DEPT.                       18330000
182600                                                                  18340000
182700     PERFORM C210-CALC-OPEN-TO-REC                                18350000
182800            VARYING PS-DIST-SUB FROM 1 BY 1                       18360000
182900            UNTIL PS-DIST-SUB > PV-DIST-COUNT                     18370000
183000                                                                  18380000
183100                                                                  18390000
183200     PERFORM C230-OPEN-TRBL-CSR.                                  18400000
183300     PERFORM C240-FETCH-TRBL-CSR.                                 18410000
183400     INITIALIZE TL2-TROUBLE.                                      18420000
183500     SET TRBL-IDX  TO 1.                                          18430000
183600     PERFORM C260-LOAD-TRBL-TBL                                   18440000
183700         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         18450000
183800         OR TRBL-IDX > 2.                                         18460000
183900     PERFORM C250-CLOSE-TRBL-CSR.                                 18470000
184000                                                                  18480000
184100     IF TL2-TRBL-DESC(1) NOT = SPACES                             18490000
184200         IF TL2-TRBL-DESC(2) NOT = SPACES                         18500000
184300*            IF  PRINT-SINGLE-HEADING                             18510000
184400*                MOVE PC-MULTI-TROUBLE TO R1D-TROUBLE             18520000
184500*            ELSE                                                 18530000
184600*                MOVE PC-MULTI-TROUBLE TO R1D-TROUBLE-B           18540000
184610                 MOVE PC-MULTI-TROUBLE TO R1D-TROUBLE-C           18550000
184700*            END-IF                                               18560000
184800         ELSE                                                     18570000
184900*            IF  PRINT-SINGLE-HEADING                             18580000
185000*                MOVE TL2-TRBL-DESC(1) TO R1D-TROUBLE             18590000
185100*            ELSE                                                 18600000
185200*                MOVE TL2-TRBL-DESC(1) TO R1D-TROUBLE-B           18610000
185210                 MOVE TL2-TRBL-DESC(1) TO R1D-TROUBLE-C           18620000
185300*            END-IF                                               18630000
185400         END-IF                                                   18640000
185500     ELSE                                                         18650000
185600*        MOVE SPACES TO R1D-TROUBLE                               18660000
185700*                       R1D-TROUBLE-B                             18670000
185710         MOVE SPACES TO R1D-TROUBLE-C                             18680000
185800     END-IF.                                                      18690000
185900     IF PA-LINE-COUNT IS GREATER THAN PC-LINE-MAX                 18700000
186000         PERFORM C100-FORMAT-HEADER1-LINES                        18710000
186100         MOVE R1D-DETAIL1  TO DRS01-COMM-DATA                     18720000
186200         MOVE PC-SPACE2    TO DRS01-COMM-CTL                      18730000
186300         MOVE SA-REPORT-ID TO DRS01-DRRB-RID                      18740000
186400         PERFORM Z900-PUT-LINE-TO-DRS                             18750000
186500         MOVE R1D-DETAIL2  TO DRS01-COMM-DATA                     18760000
186600         MOVE PC-SPACE1    TO DRS01-COMM-CTL                      18770000
186700         MOVE SA-REPORT-ID TO DRS01-DRRB-RID                      18780000
186800         PERFORM Z900-PUT-LINE-TO-DRS                             18790000
186810         MOVE 'TOT'                 TO RH1-TOTAL                  18800000
186900         IF  PRINT-DOUBLE-HEADING                                 18810000
187000             MOVE R1H-DESC-SUB-HEADING-1A                                 
187010                                    TO DRS01-COMM-DATA            18820000
187100             MOVE PC-SPACE2         TO DRS01-COMM-CTL             18830000
187200             MOVE SA-REPORT-ID      TO DRS01-DRRB-RID             18840000
187300                                                                  18850000
187400             PERFORM Z900-PUT-LINE-TO-DRS                         18860000
187500                                                                  18870000
187510             MOVE R1H-SUB-HEADING1A TO DRS01-COMM-DATA            18820000
187520             MOVE PC-SPACE1         TO DRS01-COMM-CTL             18830000
187530             MOVE SA-REPORT-ID      TO DRS01-DRRB-RID             18840000
187540                                                                  18850000
187550             PERFORM Z900-PUT-LINE-TO-DRS                         18860000
187560                                                                  18870000
187570             MOVE R1H-DESC-SUB-HEADING-1                                  
187580                                    TO DRS01-COMM-DATA                    
187590             MOVE PC-SPACE1         TO DRS01-COMM-CTL                     
187591             MOVE SA-REPORT-ID      TO DRS01-DRRB-RID                     
187592                                                                          
187593             PERFORM Z900-PUT-LINE-TO-DRS                                 
187594                                                                  15680000
187600             MOVE R1H-SUB-HEADING1 TO DRS01-COMM-DATA             18880000
187700             MOVE PC-SPACE1        TO DRS01-COMM-CTL              18890000
187800             MOVE SA-REPORT-ID     TO DRS01-DRRB-RID              18900000
187900                                                                  18910000
188000             PERFORM Z900-PUT-LINE-TO-DRS                         18920000
188100         ELSE                                                     18930000
188200*GB***************************************************************18940000
188300             MOVE R1H-DESC-SUB-HEADING-1 TO DRS01-COMM-DATA       18950000
188400             MOVE PC-SPACE3        TO DRS01-COMM-CTL              18960000
188500             MOVE SA-REPORT-ID     TO DRS01-DRRB-RID              18970000
188600                                                                  18980000
188700             PERFORM Z900-PUT-LINE-TO-DRS                         18990000
188800***GB*************************************************************19000000
188900                                                                  19010000
189000             MOVE R1H-SUB-HEADING1 TO DRS01-COMM-DATA             19020000
189100             MOVE PC-SPACE1        TO DRS01-COMM-CTL              19030000
189200             MOVE SA-REPORT-ID     TO DRS01-DRRB-RID              19040000
189300             PERFORM Z900-PUT-LINE-TO-DRS                         19050000
189400         END-IF                                                   19060000
189500         MOVE R1H-SUB-HEADING2 TO DRS01-COMM-DATA                 19070000
189600         MOVE PC-SPACE1    TO DRS01-COMM-CTL                      19080000
189700         MOVE SA-REPORT-ID TO DRS01-DRRB-RID                      19090000
189800         PERFORM Z900-PUT-LINE-TO-DRS                             19100000
189900         MOVE ZERO TO PA-LINE-COUNT                               19110000
190000     END-IF.                                                      19120000
190100                                                                  19130000
190200     IF  PV-2ND-DETAIL-COUNT  >  PC-DC-PER-LINE                   19140000
190300         MOVE R1D-DETAIL3   TO DRS01-COMM-DATA                    19150000
190400         MOVE PC-SPACE2     TO DRS01-COMM-CTL                     19160000
190500         MOVE SA-REPORT-ID  TO DRS01-DRRB-RID                     19170000
190600         PERFORM Z900-PUT-LINE-TO-DRS                             19180000
190700         ADD 1 TO PA-LINE-COUNT                                   19190000
190800                                                                  19200000
190900         MOVE R1D-DETAIL3B  TO DRS01-COMM-DATA                    19210000
191000         MOVE PC-SPACE1     TO DRS01-COMM-CTL                     19220000
191100         MOVE SA-REPORT-ID  TO DRS01-DRRB-RID                     19230000
191200         PERFORM Z900-PUT-LINE-TO-DRS                             19240000
191300         ADD 1 TO PA-LINE-COUNT                                   19250000
191400                                                                  19260000
191500     ELSE                                                         19270000
191600         MOVE R1D-DETAIL3 TO DRS01-COMM-DATA                      19280000
191700         MOVE PC-SPACE2 TO DRS01-COMM-CTL                         19290000
191800         MOVE SA-REPORT-ID TO DRS01-DRRB-RID                      19300000
191810/        DISPLAY 'R1D-DETAIL3' DRS01-COMM-DATA                    19310000
191900         PERFORM Z900-PUT-LINE-TO-DRS                             19320000
192000*        ADD 1 TO PA-LINE-COUNT                                   19330000
192010         ADD 2 TO PA-LINE-COUNT                                   19340000
192100     END-IF.                                                      19350000
192200     IF  R1D-TROUBLE-C = SPACES                                   19360000
192300         CONTINUE                                                 19370000
192301     ELSE                                                         19380000
192302         MOVE R1D-DETAIL3C  TO DRS01-COMM-DATA                    19390000
192303         MOVE PC-SPACE1     TO DRS01-COMM-CTL                     19400000
192304         MOVE SA-REPORT-ID  TO DRS01-DRRB-RID                     19410000
192305         PERFORM Z900-PUT-LINE-TO-DRS                             19420000
192306         ADD 1 TO PA-LINE-COUNT                                   19430000
192307     END-IF                                                       19440000
192308                                                                  19450000
192309     MOVE ZERO TO PA-AMOUNT-RECEIVED.                             19460000
192400     PERFORM Y000-FETCH-PO-CSR.                                   19470000
192500     IF NOT SW-THATS-ALL-FOLKS                                    19480000
192600         MOVE PURITM-APP-PO-LNE-NBR  TO  PV-APP-PO-LNE-NBR        19490000
192700         MOVE PURITM-PO-LNE-NBR      TO  PV-PO-LNE-NBR            19500000
192800     END-IF.                                                      19510000
192900                                                                  19520000
193000 C210-CALC-OPEN-TO-REC.                                           19530000
193100     MOVE PV-SAVE-OTR-TABLE(PS-DIST-SUB) TO DP276-OTR-TABLE.      19540000
193200                                                                  19550000
193300     MOVE PV-APP-PO-LNE-NBR          TO DP276-SEARCH-NBR          19560000
193400     PERFORM 4210-SEARCH-OTR                                      19570000
193500     MOVE DP276-OTR-OUT         TO PV-OTR (PS-DIST-SUB)           19580000
193600                                                                  19590000
193700     MOVE  PS-DIST-SUB  TO  PV-2ND-DETAIL-COUNT.                  19600000
193800     IF  PV-2ND-DETAIL-COUNT  >   PC-DC-PER-LINE                  19610000
193900         SUBTRACT  PC-DC-PER-LINE                                 19620000
194000             FROM  PV-2ND-DETAIL-COUNT                            19630000
194100           GIVING  PV-2ND-DETAIL-SUB.                             19640000
194200                                                                  19650000
194300     IF  PV-2ND-DETAIL-COUNT  >  PC-DC-PER-LINE                   19660000
194400         MOVE DP276-OTR-OUT-X       TO R1D-OPEN-TO-RECEIVE-B      19670000
194500                                      (PV-2ND-DETAIL-SUB)         19680000
194600     ELSE                                                         19690000
194700         MOVE DP276-OTR-OUT-X       TO R1D-OPEN-TO-RECEIVE        19700000
194800                                      (PS-DIST-SUB)               19710000
194900     END-IF                                                       19720000
195000                                                                  19730000
195100     IF PS-DIST-SUB = PV-DIST-COUNT                               19740000
195200         IF  PRINT-SINGLE-HEADING                                 19750000
195300             MOVE DP276-TOTAL-OTR   TO  R1D-OPEN-TO-RECEIVE-TOT   19760000
195400         ELSE                                                     19770000
195500             MOVE ZEROES            TO  R1D-OPEN-TO-RECEIVE-TOT   19780000
195600             MOVE DP276-TOTAL-OTR   TO  R1D-OPEN-TO-RECEIVE-TOT-B 19790000
195700         END-IF                                                   19800000
195800         MOVE ZERO              TO  DP276-TOTAL-OTR               19810000
195900     END-IF.                                                      19820000
196000                                                                  19830000
196100                                                                  19840000
196200 C230-OPEN-TRBL-CSR.                                              19850000
196300     EXEC SQL                                                     19860000
196400         OPEN TRBL_CSR                                            19870000
196500     END-EXEC.                                                    19880000
196600                                                                  19890000
196700     EVALUATE TRUE                                                19900000
196800         WHEN SQLCODE = ZERO                                      19910000
196900             CONTINUE                                             19920000
197000         WHEN SQLWARN0 NOT = SPACE                                19930000
197100         WHEN SQLCODE < ZERO                                      19940000
197200         WHEN SQLCODE > ZERO                                      19950000
197300             MOVE 'C230-OPEN-TRBL-CSR'                            19960000
197400                 TO DP013-PARAGRAPH                               19970000
197500             MOVE 'OPEN THE TRBL_CSR'                             19980000
197600                 TO DP013-MESSAGE-TEXT (1)                        19990000
197700             MOVE SQLCA            TO DP013-SQLCA                 20000000
197800             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    20010000
197900             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    20020000
198000             SET DP013-DB2-ABEND   TO TRUE                        20030000
198100             SET DP013-NO-ROLLBACK TO TRUE                        20040000
198200             PERFORM 9999-ABEND                                   20050000
198300     END-EVALUATE.                                                20060000
198400                                                                  20070000
198500 C240-FETCH-TRBL-CSR.                                             20080000
198600     INITIALIZE DCLTWKORIN.                                       20090000
198700                                                                  20100000
198800     EXEC SQL                                                     20110000
198900         FETCH  TRBL_CSR                                          20120000
199000          INTO  :TRBRSN-TRBL-SHT-DESC                             20130000
199100     END-EXEC.                                                    20140000
199200                                                                  20150000
199300     EVALUATE TRUE                                                20160000
199400         WHEN SQLCODE = ZERO                                      20170000
199500             CONTINUE                                             20180000
199600         WHEN SQLCODE = PC-ROW-NOT-FOUND                          20190000
199700*            CONTINUE                                             20200000
199710             MOVE SPACES TO TRBRSN-TRBL-SHT-DESC                  20210000
199800         WHEN SQLWARN0 NOT = SPACE                                20220000
199900         WHEN SQLCODE < ZERO                                      20230000
200000         WHEN SQLCODE > ZERO                                      20240000
200100             MOVE 'C240-FETCH-TRBL-CSR'                           20250000
200200                 TO DP013-PARAGRAPH                               20260000
200300             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 20270000
200400-                 'FROM THE TRBL_CSR'                             20280000
200500               TO DP013-MESSAGE-TEXT (1)                          20290000
200600             MOVE SQLCA            TO DP013-SQLCA                 20300000
200700             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    20310000
200800             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    20320000
200900             SET DP013-DB2-ABEND   TO TRUE                        20330000
201000             SET DP013-NO-ROLLBACK TO TRUE                        20340000
201100             PERFORM 9999-ABEND                                   20350000
201200     END-EVALUATE.                                                20360000
201300                                                                  20370000
201400 C250-CLOSE-TRBL-CSR.                                             20380000
201500     EXEC SQL                                                     20390000
201600         CLOSE TRBL_CSR                                           20400000
201700     END-EXEC.                                                    20410000
201800                                                                  20420000
201900     EVALUATE TRUE                                                20430000
202000         WHEN SQLCODE = ZERO                                      20440000
202100             CONTINUE                                             20450000
202200         WHEN SQLWARN0 NOT = SPACE                                20460000
202300         WHEN SQLCODE < ZERO                                      20470000
202400         WHEN SQLCODE > ZERO                                      20480000
202500             MOVE 'C250-CLOSE-TRBL-CSR'                           20490000
202600                 TO DP013-PARAGRAPH                               20500000
202700             MOVE 'CLOSE THE TRBL_CSR'                            20510000
202800                 TO DP013-MESSAGE-TEXT (1)                        20520000
202900             MOVE SQLCA            TO DP013-SQLCA                 20530000
203000             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    20540000
203100             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    20550000
203200             SET DP013-DB2-ABEND   TO TRUE                        20560000
203300             SET DP013-NO-ROLLBACK TO TRUE                        20570000
203400             PERFORM 9999-ABEND                                   20580000
203500     END-EVALUATE.                                                20590000
203600                                                                  20600000
203700******************************************************************20610000
203800*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            20620000
203900******************************************************************20630000
204000 C260-LOAD-TRBL-TBL.                                              20640000
204100     MOVE TRBRSN-TRBL-SHT-DESC TO TL2-TRBL-DESC(TRBL-IDX).        20650000
204200     SET TRBL-IDX  UP BY 1.                                       20660000
204300     PERFORM C240-FETCH-TRBL-CSR.                                 20670000
204400                                                                  20680000
204500 E200-CALC-CHECK-DIGIT.                                           20690000
204600     MOVE ZERO TO CD-CONTROL-DIGIT (8).                           20700000
204700     MOVE CD-CONTROL-DIGIT (7) TO CD-ODD-BYTE (4).                20710000
204800     MOVE CD-CONTROL-DIGIT (5) TO CD-ODD-BYTE (3).                20720000
204900     MOVE CD-CONTROL-DIGIT (3) TO CD-ODD-BYTE (2).                20730000
205000     MOVE CD-CONTROL-DIGIT (1) TO CD-ODD-BYTE (1).                20740000
205100     COMPUTE CD-ODD-RESULT = CD-ODD-DIGITS * 2.                   20750000
205200     COMPUTE CD-ODD-EVEN-RESULT = CD-ODD-RESULT-BYTE (1) +        20760000
205300                                  CD-ODD-RESULT-BYTE (2) +        20770000
205400                                  CD-ODD-RESULT-BYTE (3) +        20780000
205500                                  CD-ODD-RESULT-BYTE (4) +        20790000
205600                                  CD-ODD-RESULT-BYTE (5) +        20800000
205700                                  CD-CONTROL-DIGIT (6)   +        20810000
205800                                  CD-CONTROL-DIGIT (4)   +        20820000
205900                                  CD-CONTROL-DIGIT (2).           20830000
206000     COMPUTE CD-CHECK-DIGIT = 10 - CD-ODD-EVEN-BYTE (2).          20840000
206100                                                                  20850000
206200 G100-SETUP-BARCODE.                                              20860000
206300     INITIALIZE MOD10-WORKAREA.                                   20870000
206400     MOVE SA-KEY-REC TO DL-BARCODE-KEYREC                         20880000
206500                        DLB-READABLE-KEYREC                       20890000
206600                        MOD10-KEYREC.                             20900000
206700     MOVE PV-APP-PO-LNE-NBR TO DL-BARCODE-LINE-NMBR               20910000
206800                     DLB-READABLE-LINE-NMBR                       20920000
206900                     MOD10-LINE-NMBR.                             20930000
207000     MOVE '00' TO DL-BARCODE-SEQ                                  20940000
207100                  DLB-READABLE-SEQ                                20950000
207200                  MOD10-SEQ.                                      20960000
207300     SET MOD10-DIGIT-INDEX TO 13.                                 20970000
207400     PERFORM                                                      20980000
207500                 UNTIL MOD10-DIGIT-INDEX = 0                      20990000
207600         COMPUTE MOD10-MULT-ACCUM =                               21000000
207700                     MOD10-CHECK-DIGIT-R (MOD10-DIGIT-INDEX) * 2  21010000
207800         COMPUTE MOD10-CHECK-DIGIT-SUM =                          21020000
207900                     MOD10-CHECK-DIGIT-SUM +                      21030000
208000                         MOD10-MULT-DIGIT1 +                      21040000
208100                         MOD10-MULT-DIGIT2                        21050000
208200         SET MOD10-DIGIT-INDEX DOWN BY 1                          21060000
208300         IF MOD10-DIGIT-INDEX = 0                                 21070000
208400             CONTINUE                                             21080000
208500         ELSE                                                     21090000
208600             COMPUTE MOD10-CHECK-DIGIT-SUM =                      21100000
208700                     MOD10-CHECK-DIGIT-SUM +                      21110000
208800                         MOD10-CHECK-DIGIT-R (MOD10-DIGIT-INDEX)  21120000
208900             SET MOD10-DIGIT-INDEX DOWN BY 1                      21130000
209000         END-IF                                                   21140000
209100     END-PERFORM.                                                 21150000
209200                                                                  21160000
209300     COMPUTE MOD10-CHECK-DIGIT = 10 - MOD10-CHECK-DIGIT2.         21170000
209400     MOVE MOD10-CHECK-DIGIT TO DL-BARCODE-CHK-DIGIT               21180000
209500                               DLB-READABLE-CHK-DIGIT.            21190000
209600                                                                  21200000
209700 4500-GET-PROCESSING-AREA.                                        21210000
209800     PERFORM 4550-OPEN-TWKORIN.                                   21220000
209900     PERFORM 4600-FETCH-TWKORIN-LOOP.                             21230000
210000                                                                  21240000
210100 4550-OPEN-TWKORIN.                                               21250000
210200     EXEC SQL                                                     21260000
210300         OPEN TWKORIN-CSR                                         21270000
210400     END-EXEC.                                                    21280000
210500                                                                  21290000
210600     EVALUATE TRUE                                                21300000
210700         WHEN SQLCODE = ZEROS                                     21310000
210800              CONTINUE                                            21320000
210900         WHEN SQLWARN0 NOT = SPACES                               21330000
211000         WHEN SQLCODE < ZERO                                      21340000
211100         WHEN SQLCODE > ZERO                                      21350000
211200              MOVE '4550-OPEN-TWKORIN'                            21360000
211300                                     TO  DP013-PARAGRAPH          21370000
211400              MOVE 'OPEN TWKORIN CURSOR'                          21380000
211500                                     TO  DP013-MESSAGE-TEXT (1)   21390000
211600              MOVE SQLCA             TO  DP013-SQLCA              21400000
211700              MOVE 'TWKORIN'         TO  DP013-DB2-TABLE-NAME (1) 21410000
211800              SET DP013-DB2-ABEND    TO  TRUE                     21420000
211900              SET DP013-NO-ROLLBACK  TO  TRUE                     21430000
212000              PERFORM 9999-ABEND                                  21440000
212100     END-EVALUATE.                                                21450000
212200                                                                  21460000
212300 4575-CLOSE-TWKORIN.                                              21470000
212400     EXEC SQL                                                     21480000
212500         CLOSE TWKORIN-CSR                                        21490000
212600     END-EXEC.                                                    21500000
212700                                                                  21510000
212800     EVALUATE TRUE                                                21520000
212900         WHEN SQLCODE = ZEROS                                     21530000
213000             CONTINUE                                             21540000
213100         WHEN SQLWARN0 NOT = SPACES                               21550000
213200         WHEN SQLCODE < ZERO                                      21560000
213300         WHEN SQLCODE > ZERO                                      21570000
213400              MOVE '4575-CLOSE-TWKORIN'                           21580000
213500                                    TO DP013-PARAGRAPH            21590000
213600              MOVE 'CLOSE TWKORIN CURSOR'                         21600000
213700                                     TO  DP013-MESSAGE-TEXT (1)   21610000
213800              MOVE SQLCA             TO  DP013-SQLCA              21620000
213900              MOVE 'TWKORIN'         TO  DP013-DB2-TABLE-NAME (1) 21630000
214000              SET DP013-DB2-ABEND    TO  TRUE                     21640000
214100              SET DP013-NO-ROLLBACK  TO  TRUE                     21650000
214200              PERFORM 9999-ABEND                                  21660000
214300     END-EVALUATE.                                                21670000
214400                                                                  21680000
214500 4600-FETCH-TWKORIN-LOOP.                                         21690000
214600     MOVE 'N' TO PS-TWKORIN-CURSOR-SW.                            21700000
214700     MOVE 'N' TO PS-TWKORIN-ZERO-SW.                              21710000
214800     PERFORM 4650-FETCH-TWKORIN.                                  21720000
214900     IF  PS-EOF-TWKORIN-CSR                                       21730000
215000       OR WKORIN-STRT-TMST = PC-DEFAULT-DATE                      21740000
215100         PERFORM 4575-CLOSE-TWKORIN                               21750000
215200         PERFORM 4800-OPEN-WKORIN0-CURSOR                         21760000
215300         PERFORM 4850-FETCH-TWKORIN-ZERO                          21770000
215400         IF  WKORIN-STRT-TMST = PC-DEFAULT-DATE                   21780000
215500             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     21790000
215600                      PV-PRC-FCLTY-AREA-ID                        21800000
215700             MOVE 'N' TO PS-TWKORIN-ZERO-SW                       21810000
215800             PERFORM 4805-CLOSE-WKORIN0                           21820000
215900         ELSE                                                     21830000
216000             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     21840000
216100                      PV-PRC-FCLTY-AREA-ID                        21850000
216200             PERFORM 4850-FETCH-TWKORIN-ZERO                      21860000
216300                 UNTIL PS-EOF-TWKORIN-ZERO                        21870000
216400             PERFORM 4805-CLOSE-WKORIN0                           21880000
216500         END-IF                                                   21890000
216600     ELSE                                                         21900000
216700         MOVE WKORIN-PRC-FCLTY-AREA-ID TO PV-PRC-FCLTY-AREA-ID    21910000
216800         PERFORM 4650-FETCH-TWKORIN                               21920000
216900             UNTIL PS-EOF-TWKORIN-CSR                             21930000
217000         PERFORM 4575-CLOSE-TWKORIN                               21940000
217100     END-IF.                                                      21950000
217200                                                                  21960000
217300 4650-FETCH-TWKORIN.                                              21970000
217400                                                                  21980000
217500     EXEC SQL                                                     21990000
217600          FETCH TWKORIN-CSR                                       22000000
217700             INTO  :WKORIN-STRT-TMST,                             22010000
217800                   :WKORIN-STOP-TMST,                             22020000
217900                   :WKORIN-PRC-FCLTY-AREA-ID,                     22030000
218000                   :WKORIN-SCREEN-SEQ-NBR                         22040000
218100     END-EXEC.                                                    22050000
218200                                                                  22060000
218300     EVALUATE TRUE                                                22070000
218400         WHEN SQLCODE = +0                                        22080000
218500              PERFORM 4675-CHECK-DATES                            22090000
218600         WHEN SQLCODE = +100                                      22100000
218700              SET PS-EOF-TWKORIN-CSR TO TRUE                      22110000
218800         WHEN SQLWARN0 NOT = SPACES                               22120000
218900         WHEN SQLCODE < ZERO                                      22130000
219000         WHEN SQLCODE > ZERO                                      22140000
219100              MOVE '4600-FETCH-TWKORIN'                           22150000
219200                                     TO DP013-PARAGRAPH           22160000
219300              MOVE 'FETCH TWKORIN CURSOR'                         22170000
219400                                     TO  DP013-MESSAGE-TEXT (1)   22180000
219500              MOVE SQLCA             TO  DP013-SQLCA              22190000
219600              MOVE 'TWKORIN'         TO  DP013-DB2-TABLE-NAME (1) 22200000
219700              SET DP013-DB2-ABEND    TO  TRUE                     22210000
219800              SET DP013-NO-ROLLBACK  TO  TRUE                     22220000
219900              PERFORM 9999-ABEND                                  22230000
220000     END-EVALUATE.                                                22240000
220100                                                                  22250000
220200 4675-CHECK-DATES.                                                22260000
220300     IF  WKORIN-STRT-TMST NOT EQUAL PC-DEFAULT-DATE               22270000
220400         IF  WKORIN-STOP-TMST NOT EQUAL PC-DEFAULT-DATE           22280000
220500             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     22290000
220600                        PV-PRC-FCLTY-AREA-ID                      22300000
220700         ELSE                                                     22310000
220800             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     22320000
220900                        PV-PRC-FCLTY-AREA-ID                      22330000
221000             SET PS-EOF-TWKORIN-CSR TO TRUE                       22340000
221100         END-IF                                                   22350000
221200     ELSE                                                         22360000
221300         SET PS-EOF-TWKORIN-CSR TO TRUE                           22370000
221400     END-IF.                                                      22380000
221500/                                                                 22390000
221600 4800-OPEN-WKORIN0-CURSOR.                                        22400000
221700     EXEC SQL                                                     22410000
221800         OPEN WKORIN0-CSR                                         22420000
221900     END-EXEC.                                                    22430000
222000                                                                  22440000
222100     EVALUATE TRUE                                                22450000
222200         WHEN SQLCODE = ZERO                                      22460000
222300             CONTINUE                                             22470000
222400         WHEN SQLWARN0 NOT = SPACES                               22480000
222500         WHEN SQLCODE < ZERO                                      22490000
222600         WHEN SQLCODE > ZERO                                      22500000
222700              MOVE '4800-OPEN-WKORIN0'                            22510000
222800                                     TO  DP013-PARAGRAPH          22520000
222900              MOVE 'OPEN WKORIN0 CURSOR'                          22530000
223000                                     TO  DP013-MESSAGE-TEXT (1)   22540000
223100              MOVE SQLCA             TO  DP013-SQLCA              22550000
223200              MOVE 'TWKORIN'         TO  DP013-DB2-TABLE-NAME (1) 22560000
223300              SET DP013-DB2-ABEND    TO  TRUE                     22570000
223400              SET DP013-NO-ROLLBACK  TO  TRUE                     22580000
223500              PERFORM 9999-ABEND                                  22590000
223600     END-EVALUATE.                                                22600000
223700                                                                  22610000
223800 4805-CLOSE-WKORIN0.                                              22620000
223900     EXEC SQL                                                     22630000
224000         CLOSE WKORIN0-CSR                                        22640000
224100     END-EXEC.                                                    22650000
224200                                                                  22660000
224300      EVALUATE TRUE                                               22670000
224400          WHEN SQLCODE = 0                                        22680000
224500              CONTINUE                                            22690000
224600          WHEN SQLWARN0 NOT = SPACES                              22700000
224700          WHEN SQLCODE < ZERO                                     22710000
224800          WHEN SQLCODE > ZERO                                     22720000
224900               MOVE '4805-CLOSE-WKORIN0'                          22730000
225000                            TO DP013-PARAGRAPH                    22740000
225100               MOVE 'CLOSE WKORIN0 CURSOR'                        22750000
225200                                     TO  DP013-MESSAGE-TEXT (1)   22760000
225300              MOVE SQLCA             TO  DP013-SQLCA              22770000
225400              MOVE 'TWKORIN'         TO  DP013-DB2-TABLE-NAME (1) 22780000
225500              SET DP013-DB2-ABEND    TO  TRUE                     22790000
225600              SET DP013-NO-ROLLBACK  TO  TRUE                     22800000
225700              PERFORM 9999-ABEND                                  22810000
225800      END-EVALUATE.                                               22820000
225900                                                                  22830000
226000 4850-FETCH-TWKORIN-ZERO.                                         22840000
226100     EXEC SQL                                                     22850000
226200          FETCH WKORIN0-CSR                                       22860000
226300             INTO  :WKORIN-STRT-TMST,                             22870000
226400                   :WKORIN-STOP-TMST,                             22880000
226500                   :WKORIN-PRC-FCLTY-AREA-ID,                     22890000
226600                   :WKORIN-SCREEN-SEQ-NBR                         22900000
226700     END-EXEC.                                                    22910000
226800                                                                  22920000
226900     EVALUATE TRUE                                                22930000
227000         WHEN SQLCODE = +0                                        22940000
227100              PERFORM 4860-CHECK-DATES                            22950000
227200         WHEN SQLCODE = +100                                      22960000
227300              SET PS-EOF-TWKORIN-ZERO TO TRUE                     22970000
227400         WHEN SQLWARN0 NOT = SPACES                               22980000
227500         WHEN SQLCODE < ZERO                                      22990000
227600         WHEN SQLCODE > ZERO                                      23000000
227700              MOVE '4850-FETCH-TWKORIN-ZERO'                      23010000
227800                                   TO DP013-PARAGRAPH             23020000
227900              MOVE 'FETCH TWKORIN CURSOR'                         23030000
228000                                     TO  DP013-MESSAGE-TEXT (1)   23040000
228100              MOVE SQLCA             TO  DP013-SQLCA              23050000
228200              MOVE 'TWKORIN'         TO  DP013-DB2-TABLE-NAME (1) 23060000
228300              SET DP013-DB2-ABEND    TO  TRUE                     23070000
228400              SET DP013-NO-ROLLBACK  TO  TRUE                     23080000
228500              PERFORM 9999-ABEND                                  23090000
228600     END-EVALUATE.                                                23100000
228700                                                                  23110000
228800 4860-CHECK-DATES.                                                23120000
228900     IF  WKORIN-STRT-TMST NOT EQUAL PC-DEFAULT-DATE               23130000
229000         IF  WKORIN-STOP-TMST NOT EQUAL PC-DEFAULT-DATE           23140000
229100             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     23150000
229200                        PV-PRC-FCLTY-AREA-ID                      23160000
229300         ELSE                                                     23170000
229400             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     23180000
229500                        PV-PRC-FCLTY-AREA-ID                      23190000
229600             SET PS-EOF-TWKORIN-CSR TO TRUE                       23200000
229700         END-IF                                                   23210000
229800     ELSE                                                         23220000
229900         MOVE WKORIN-PRC-FCLTY-AREA-ID TO                         23230000
230000                    PV-PRC-FCLTY-AREA-ID                          23240000
230100         SET PS-EOF-TWKORIN-CSR TO TRUE                           23250000
230200     END-IF.                                                      23260000
230300                                                                  23270000
230400 X100-OPEN-PO-CSR.                                                23280000
230500     EXEC SQL                                                     23290000
230600         OPEN PO_CSR                                              23300000
230700     END-EXEC.                                                    23310000
230800                                                                  23320000
230900     EVALUATE TRUE                                                23330000
231000         WHEN SQLCODE = ZERO                                      23340000
231100             CONTINUE                                             23350000
231200         WHEN SQLWARN0 NOT = SPACE                                23360000
231300         WHEN SQLCODE < ZERO                                      23370000
231400         WHEN SQLCODE > ZERO                                      23380000
231500             MOVE 'X100-OPEN-PO-CSR'                              23390000
231600                 TO DP013-PARAGRAPH                               23400000
231700             MOVE 'OPEN THE PO_CSR'                               23410000
231800                 TO DP013-MESSAGE-TEXT (1)                        23420000
231900             MOVE SQLCA            TO DP013-SQLCA                 23430000
232000             MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME (1)    23440000
232100             SET DP013-DB2-ABEND   TO TRUE                        23450000
232200             SET DP013-NO-ROLLBACK TO TRUE                        23460000
232300             PERFORM 9999-ABEND                                   23470000
232400     END-EVALUATE.                                                23480000
232500                                                                  23490000
232600 X200-CLOSE-PO-CSR.                                               23500000
232700     EXEC SQL                                                     23510000
232800         CLOSE PO_CSR                                             23520000
232900     END-EXEC.                                                    23530000
233000                                                                  23540000
233100     EVALUATE TRUE                                                23550000
233200         WHEN SQLCODE = ZERO                                      23560000
233300             CONTINUE                                             23570000
233400         WHEN SQLWARN0 NOT = SPACE                                23580000
233500         WHEN SQLCODE < ZERO                                      23590000
233600         WHEN SQLCODE > ZERO                                      23600000
233700             MOVE 'X200-CLOSE-PO-CSR'                             23610000
233800                 TO DP013-PARAGRAPH                               23620000
233900             MOVE 'CLOSE THE PO_CSR'                              23630000
234000                 TO DP013-MESSAGE-TEXT (1)                        23640000
234100             MOVE SQLCA            TO DP013-SQLCA                 23650000
234200             MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME (1)    23660000
234300             SET DP013-DB2-ABEND   TO TRUE                        23670000
234400             SET DP013-NO-ROLLBACK TO TRUE                        23680000
234500             PERFORM 9999-ABEND                                   23690000
234600     END-EVALUATE.                                                23700000
234700                                                                  23710000
234800 Y000-FETCH-PO-CSR.                                               23720000
234900     INITIALIZE DCLTRECEIV                                        23730000
235000                DCLTPURCHS                                        23740000
235100                DCLTPURITM.                                       23750000
235200                                                                  23760000
235300     EXEC SQL                                                     23770000
235400         FETCH  PO_CSR                                            23780000
235500          INTO  :RECEIV-ACTL-CART-CNT,                            23790000
235600                :RECEIV-RCVR-NBR,                                 23800000
235700                :RECEIV-REC-TMST,                                 23810000
235800                :RECEIV-PRE-TKT-IND,                              23820000
235900                :RECEIV-GOH-IND,                                  23830000
236000                :PURCHS-ENT-ID,                                   23840000
236100                :PURCHS-DEPT-NBR,                                 23850000
236200                :PURCHS-STATUS-CDE,                               23860000
236300                :PURCHS-PKGNG-CDE,                                23870000
236400                :PURITM-PO-LNE-NBR,                               23880000
236500                :PURITM-APP-PO-LNE-NBR,                           23890000
236600                :VNDDPT-INHOUSE-NBR                               23900000
236700     END-EXEC.                                                    23910000
236800                                                                  23920000
236900     EVALUATE TRUE                                                23930000
237000         WHEN SQLCODE = ZERO                                      23940000
237100             CONTINUE                                             23950000
237200         WHEN SQLCODE = +100                                      23960000
237300             SET SW-THATS-ALL-FOLKS  TO  TRUE                     23970000
237400         WHEN SQLWARN0 NOT = SPACE                                23980000
237500         WHEN SQLCODE < ZERO                                      23990000
237600         WHEN SQLCODE > ZERO                                      24000000
237700             MOVE 'Y000-FETCH-PO-CSR'                             24010000
237800                 TO DP013-PARAGRAPH                               24020000
237900             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 24030000
238000-                 'FROM THE PO_CSR'                               24040000
238100                 TO DP013-MESSAGE-TEXT (1)                        24050000
238200             MOVE SQLCA            TO DP013-SQLCA                 24060000
238300             MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME (1)    24070000
238400             MOVE 'TPURCHS'        TO DP013-DB2-TABLE-NAME (2)    24080000
238500             MOVE 'TPURITM'        TO DP013-DB2-TABLE-NAME (3)    24090000
238600             MOVE 'TSTATCD'        TO DP013-DB2-TABLE-NAME (4)    24100000
238700             SET DP013-DB2-ABEND   TO TRUE                        24110000
238800             SET DP013-NO-ROLLBACK TO TRUE                        24120000
238900             PERFORM 9999-ABEND                                   24130000
239000     END-EVALUATE.                                                24140000
239100                                                                  24150000
239200 7010-GET-PRIMARY-VNDR-NME.                                       24160000
239300     INITIALIZE DCLTENTNME.                                       24170000
239400                                                                  24180000
239500     EXEC SQL                                                     24190000
239600         SELECT  ENT_NAME_DESC                                    24200000
239700           INTO  :ENTNME-ENT-NAME-DESC                            24210000
239800           FROM  TENTNME                                          24220000
239900          WHERE  (ENT_ID    =  :PURCHS-ENT-ID                     24230000
240000            AND   TYPE_CDE  =  '01')                              24240000
240100     END-EXEC.                                                    24250000
240200                                                                  24260000
240300     EVALUATE TRUE                                                24270000
240400         WHEN SQLCODE = ZERO                                      24280000
240500              CONTINUE                                            24290000
240600         WHEN SQLWARN0 NOT = SPACES                               24300000
240700         WHEN SQLCODE < ZERO                                      24310000
240800         WHEN SQLCODE > ZERO                                      24320000
240900              MOVE '7010-GET-PRIMARY-VNDR-NME'                    24330000
241000                                 TO DP013-PARAGRAPH               24340000
241100              MOVE 'SELECT PRIMARY VENDOR NAME ENT ID = '         24350000
241200                                 TO DP013-MESSAGE-TEXT (1)        24360000
241300              MOVE PURCHS-ENT-ID TO PV-DISPLAY-ENT-ID             24370000
241400              MOVE PV-DISPLAY-ENT-ID                              24380000
241500                                 TO DP013-MESSAGE-TEXT (2)        24390000
241600              MOVE SQLCA         TO DP013-SQLCA                   24400000
241700              MOVE 'TENTNME'     TO DP013-DB2-TABLE-NAME (1)      24410000
241800              SET DP013-DB2-ABEND                                 24420000
241900                                 TO TRUE                          24430000
242000              SET DP013-NO-ROLLBACK                               24440000
242100                                 TO TRUE                          24450000
242200              PERFORM 9999-ABEND                                  24460000
242300     END-EVALUATE.                                                24470000
242400 7020-OPEN-SP-INST-CSR.                                           24480000
242500     EXEC SQL                                                     24490000
242600         OPEN SP_INST_CSR                                         24500000
242700     END-EXEC.                                                    24510000
242800                                                                  24520000
242900     EVALUATE TRUE                                                24530000
243000         WHEN SQLCODE = ZERO                                      24540000
243100             CONTINUE                                             24550000
243200         WHEN SQLWARN0 NOT = SPACE                                24560000
243300         WHEN SQLCODE < ZERO                                      24570000
243400         WHEN SQLCODE > ZERO                                      24580000
243500             MOVE '7020-OPEN-SP-INST-CSR'                         24590000
243600                 TO DP013-PARAGRAPH                               24600000
243700             MOVE 'OPEN THE SP_INST_CSR'                          24610000
243800                 TO DP013-MESSAGE-TEXT (1)                        24620000
243900             MOVE SQLCA            TO DP013-SQLCA                 24630000
244000             MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)    24640000
244100             MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (1)    24650000
244200             SET DP013-DB2-ABEND   TO TRUE                        24660000
244300             SET DP013-NO-ROLLBACK TO TRUE                        24670000
244400             PERFORM 9999-ABEND                                   24680000
244500     END-EVALUATE.                                                24690000
244600                                                                  24700000
244700 7030-GET-SPECIAL-INSTRS.                                         24710000
244800     INITIALIZE DCLTINSTCD.                                       24720000
244900                                                                  24730000
245000     EXEC SQL                                                     24740000
245100         FETCH  SP_INST_CSR                                       24750000
245200           INTO  :INSTCD-INSTR-DESC                               24760000
245300     END-EXEC.                                                    24770000
245400                                                                  24780000
245500     EVALUATE TRUE                                                24790000
245600         WHEN SQLCODE = ZERO                                      24800000
245700             CONTINUE                                             24810000
245800         WHEN SQLCODE = +100                                      24820000
245900             SET PS-NO-SPECIAL-INSTRS-FOUND    TO  TRUE           24830000
246000         WHEN SQLWARN0 NOT = SPACES                               24840000
246100         WHEN SQLCODE < ZERO                                      24850000
246200         WHEN SQLCODE > ZERO                                      24860000
246300              MOVE '7030-GET-SPECIAL-INSTRS'                      24870000
246400                                 TO DP013-PARAGRAPH               24880000
246500              MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '         24890000
246600                                 TO DP013-MESSAGE-TEXT (1)        24900000
246700              MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR            24910000
246800              MOVE PV-DISPLAY-KEYS                                24920000
246900                                 TO DP013-MESSAGE-TEXT (2)        24930000
247000              MOVE SQLCA         TO DP013-SQLCA                   24940000
247100              MOVE 'TPOINST'     TO DP013-DB2-TABLE-NAME (1)      24950000
247200              MOVE 'TINSTCD'     TO DP013-DB2-TABLE-NAME (2)      24960000
247300              SET DP013-DB2-ABEND                                 24970000
247400                                 TO TRUE                          24980000
247500              SET DP013-NO-ROLLBACK                               24990000
247600                                 TO TRUE                          25000000
247700              PERFORM 9999-ABEND                                  25010000
247800     END-EVALUATE.                                                25020000
247900                                                                  25030000
248000 7035-CLOSE-SP-INST-CSR.                                          25040000
248100     EXEC SQL                                                     25050000
248200         CLOSE SP_INST_CSR                                        25060000
248300     END-EXEC.                                                    25070000
248400                                                                  25080000
248500     EVALUATE TRUE                                                25090000
248600         WHEN SQLCODE = ZERO                                      25100000
248700             CONTINUE                                             25110000
248800         WHEN SQLWARN0 NOT = SPACE                                25120000
248900         WHEN SQLCODE < ZERO                                      25130000
249000         WHEN SQLCODE > ZERO                                      25140000
249100             MOVE '7035-CLOSE-SP-INST-CSR'                        25150000
249200                 TO DP013-PARAGRAPH                               25160000
249300             MOVE 'CLOSE THE SP_INST_CSR'                         25170000
249400                 TO DP013-MESSAGE-TEXT (1)                        25180000
249500             MOVE SQLCA            TO DP013-SQLCA                 25190000
249600             MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)    25200000
249700             MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (1)    25210000
249800             SET DP013-DB2-ABEND   TO TRUE                        25220000
249900             SET DP013-NO-ROLLBACK TO TRUE                        25230000
250000             PERFORM 9999-ABEND                                   25240000
250100     END-EVALUATE.                                                25250000
250200                                                                  25260000
250300                                                                  25270000
250400/                                                                 25280000
250500*----------------------------------------------------------------*25290000
250600*    GET THE EARLIEST AD DATE                                    *25300000
250700*----------------------------------------------------------------*25310000
250800 7040-GET-AD-DATE.                                                25320000
250900     INITIALIZE DCLTPURITM.                                       25330000
251000                                                                  25340000
251100     EXEC SQL                                                     25350000
251200          SELECT  MIN(AD_EVNT_DTE)                                25360000
251300            INTO  :PURITM-AD-EVNT-DTE                             25370000
251400                      :PV-AD-EVNT-DTE                             25380000
251500            FROM  TPURITM                                         25390000
251600           WHERE  (PO_NBR         = :DK-ORD-NBR                   25400000
251700             AND   VER_STATUS_CDE = 'A'                           25410000
251800             AND   AD_EVNT_DTE > '0001-01-01')                    25420000
251900     END-EXEC.                                                    25430000
252000                                                                  25440000
252100     EVALUATE TRUE                                                25450000
252200         WHEN SQLCODE = +0                                        25460000
252300             CONTINUE                                             25470000
252400         WHEN SQLCODE = -305                                      25480000
252500             CONTINUE                                             25490000
252600         WHEN SQLWARN0 NOT = SPACES                               25500000
252700         WHEN SQLCODE < +0                                        25510000
252800         WHEN SQLCODE > +0                                        25520000
252900             MOVE '7040-GET-AD-DATE'                              25530000
253000                             TO DP013-PARAGRAPH                   25540000
253100             MOVE 'UNSUCCESSFUL SELECT ON TPURITM'                25550000
253200                             TO DP013-MESSAGE-TEXT (1)            25560000
253300             MOVE SQLCA      TO DP013-SQLCA                       25570000
253400             MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)          25580000
253500             SET DP013-DB2-ABEND                                  25590000
253600                 DP013-XCTL-DISPLAY-RESTART                       25600000
253700                             TO TRUE                              25610000
253800             PERFORM 9999-ABEND                                   25620000
253900     END-EVALUATE.                                                25630000
254000                                                                  25640000
254100 7050-SELECT-PO-LNE-ITM-DATA.                                     25650000
254200     INITIALIZE DCLTPURITM.                                       25660000
254300                                                                  25670000
254400     EXEC SQL                                                     25680000
254500         SELECT  A.ITM_NBR,                                       25690000
254600                 A.CL_NBR,                                        25700000
254700                 A.SKU_DESC,                                      25710000
254800                 A.SIZE_DESC,                                     25720000
254900                 A.COLOR_DESC,                                    25730000
255000                 A.UNT_QTY,                                       25740000
255100                 A.UNT_RTL_PR_AMT,                                25750000
255200                 A.VEND_STYL_NAME,                                25760000
255300                 A.STATUS_CDE,                                    25770000
255400                 A.GP_RTL_AMT,                                    25780000
255500                 A.GP_QTY,                                        25790000
255600                 A.PO_PREPK_ID                                    25800000
255700           INTO  :PURITM-ITM-NBR,                                 25810000
255800                 :PURITM-CL-NBR,                                  25820000
255900                 :PURITM-SKU-DESC,                                25830000
256000                 :PURITM-SIZE-DESC,                               25840000
256100                 :PURITM-COLOR-DESC,                              25850000
256200                 :PURITM-UNT-QTY,                                 25860000
256300                 :PURITM-UNT-RTL-PR-AMT,                          25870000
256400                 :PURITM-VEND-STYL-NAME,                          25880000
256500                 :PURITM-STATUS-CDE,                              25890000
256600                 :PURITM-GP-RTL-AMT,                              25900000
256700                 :PURITM-GP-QTY,                                  25910000
256800                 :PURITM-PO-PREPK-ID                              25920000
256900           FROM  TPURITM A                                        25930000
257000          WHERE  (A.PO_NBR          =  :DK-ORD-NBR                25940000
257100            AND   A.APP_PO_LNE_NBR  =  :PV-APP-PO-LNE-NBR         25950000
257200            AND   A.VER_STATUS_CDE  =  'A')                       25960000
257300     END-EXEC.                                                    25970000
257400                                                                  25980000
257500     EVALUATE TRUE                                                25990000
257600         WHEN SQLCODE = ZERO                                      26000000
257700              CONTINUE                                            26010000
257800         WHEN SQLWARN0 NOT = SPACES                               26020000
257900         WHEN SQLCODE < ZERO                                      26030000
258000         WHEN SQLCODE > ZERO                                      26040000
258100              MOVE '7050-SELECT-PO-HDR-DATA'                      26050000
258200                                     TO  DP013-PARAGRAPH          26060000
258300              MOVE 'SELECT INFO FOR THE FOLLOWING RECEIVER: '     26070000
258400                                     TO  DP013-MESSAGE-TEXT (1)   26080000
258500              MOVE DK-ORD-NBR        TO  PV-DISPLAY-ORD-NBR       26090000
258600              MOVE DK-ORD-LNE-NBR    TO  PV-DISPLAY-ORD-LNE-NBR   26100000
258700              MOVE PV-DISPLAY-KEYS   TO  DP013-MESSAGE-TEXT (2)   26110000
258800              MOVE SQLCA             TO  DP013-SQLCA              26120000
258900              MOVE 'TPURITM'         TO  DP013-DB2-TABLE-NAME (1) 26130000
259000              MOVE 'TSTATCD'         TO  DP013-DB2-TABLE-NAME (2) 26140000
259100              SET DP013-DB2-ABEND    TO  TRUE                     26150000
259200              SET DP013-NO-ROLLBACK  TO  TRUE                     26160000
259300              PERFORM 9999-ABEND                                  26170000
259400     END-EVALUATE.                                                26180000
259500******************************************************************26190000
259600*   LOGISTICS DOMAIN ITEM ACCESS MODULE                           26200000
259700******************************************************************26210000
259800                                                                  26220000
259900 7055-CALL-CICS-API-ARCH.                                         26230000
260000                                                                  26240000
260100      INITIALIZE XL001-ITEM-COMMAREA                              26250000
260200                                                                  26260000
260300      MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.                 26270000
260400                                                                  26280000
260500      SET  XL001-BY-ITEM                                          26290000
260600           XL001-SELECT-SKU TO TRUE.                              26300000
260700                                                                  26310000
260800      CALL XL001-VSM-PGM USING  DFHEIBLK                          26320000
260900                                XL001-COMMAREA                    26330000
261000                                XL001-ITEM-COMMAREA.              26340000
261100                                                                  26350000
261200      EVALUATE TRUE                                               26360000
261300                                                                  26370000
261400          WHEN XL001-SUCCESSFUL                                   26380000
261500               MOVE XL001-SKU-NBR     TO R1D-SKU                  26390000
261600                                                                  26400000
261700          WHEN XL001-SQL-ERROR                                    26410000
261800               IF XL001-SKU-SQLCODE = +100                        26420000
261900                  MOVE SPACES          TO R1D-SKU                 26430000
262000               ELSE                                               26440000
262100                  MOVE XL001-SKU-NBR   TO PV-DISPLAY-SKU-NBR      26450000
262200                  MOVE '7055-CALL-CICS-API-ARCH'                  26460000
262300                                       TO DP013-PARAGRAPH         26470000
262400                  MOVE 'UNSUCCESSFUL SELECT ON XLV SKU'           26480000
262500                                       TO DP013-MESSAGE-TEXT (1)  26490000
262600                  STRING 'XL VIEW ERROR PARA- '                   26500000
262700                                       DELIMITED BY SIZE          26510000
262800                  XL001-ERROR-PARAGRAPH-NBR DELIMITED BY SIZE     26520000
262900                                       INTO DP013-MESSAGE-TEXT (2)26530000
263000                  STRING 'SKU NUMBER : ' DELIMITED BY SIZE        26540000
263100                      PV-DISPLAY-SKU-NBR DELIMITED BY SIZE        26550000
263200                                  INTO DP013-MESSAGE-TEXT (3)     26560000
263300                  MOVE XL001-SKU-SQLCODE TO DP013-SQLCA           26570000
263400                  MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)26580000
263500                  SET DP013-DB2-ABEND                             26590000
263600                      DP013-XCTL-DISPLAY-RESTART                  26600000
263700                                         TO TRUE                  26610000
263800                  PERFORM DP013-0000-PROCESS-ABEND                26620000
263900               END-IF                                             26630000
264000                                                                  26640000
264100               WHEN XL001-INVALID-ACCESS                          26650000
264200                  MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'       26660000
264300                                     TO DP013-PARAGRAPH           26670000
264400                  MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'           26680000
264500                                     TO DP013-MESSAGE-TEXT (1)    26690000
264600                  MOVE SQLCA         TO DP013-SQLCA               26700000
264700                  MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)  26710000
264800                  SET DP013-DB2-ABEND                             26720000
264900                      DP013-XCTL-DISPLAY-RESTART                  26730000
265000                                     TO TRUE                      26740000
265100                                                                  26750000
265200                  PERFORM DP013-0000-PROCESS-ABEND                26760000
265300             WHEN OTHER                                           26770000
265400                  MOVE '7055-CALL-CICS-API-ARCH'                  26780000
265500                                     TO DP013-PARAGRAPH           26790000
265600                  MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'           26800000
265700                                     TO DP013-MESSAGE-TEXT (1)    26810000
265800                  MOVE SQLCA         TO DP013-SQLCA               26820000
265900                  MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)  26830000
266000                  SET DP013-DB2-ABEND                             26840000
266100                      DP013-XCTL-DISPLAY-RESTART                  26850000
266200                                     TO TRUE                      26860000
266300                                                                  26870000
266400                  PERFORM DP013-0000-PROCESS-ABEND                26880000
266500             END-EVALUATE.                                        26890000
266600/                                                                 26900000
266700 7060-CHECK-VNDR-AGRMT.                                           26910000
266800     INITIALIZE PV-DB2-COUNT.                                     26920000
266900                                                                  26930000
267000     EXEC SQL                                                     26940000
267100         SELECT  COUNT(*)                                         26950000
267200           INTO  :PV-DB2-COUNT                                    26960000
267300           FROM  TVNDAGR                                          26970000
267400          WHERE  (ENT_ID        =  :PURCHS-ENT-ID                 26980000
267500            AND   DEPT_NBR      =  :PURCHS-DEPT-NBR               26990000
267600            AND   AGRMT_TYP_ID  =  '4'                            27000000
267700            AND   TYP_CDE       =  3                              27010000
267800            AND  (CHAR(CURRENT DATE, ISO)                         27020000
267900                  BETWEEN                                         27030000
268000                  CHAR(EFFECTIVE_DATE,ISO)                        27040000
268100                      AND                                         27050000
268200                  CHAR(EXPIRATION_DATE,ISO)))                     27060000
268300     END-EXEC.                                                    27070000
268400                                                                  27080000
268500     EVALUATE TRUE                                                27090000
268600         WHEN SQLCODE = ZERO                                      27100000
268700              CONTINUE                                            27110000
268800         WHEN SQLCODE = +100                                      27120000
268900              CONTINUE                                            27130000
269000         WHEN SQLWARN0 NOT = SPACES                               27140000
269100         WHEN SQLCODE < ZERO                                      27150000
269200         WHEN SQLCODE > ZERO                                      27160000
269300              MOVE '7060-CHECK-VNDR-AGRMT'                        27170000
269400                                     TO  DP013-PARAGRAPH          27180000
269500              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  27190000
269600                                     TO  DP013-MESSAGE-TEXT (1)   27200000
269700              MOVE PURCHS-ENT-ID     TO  PV-DISPLAY-ENT-ID        27210000
269800              MOVE PURCHS-DEPT-NBR   TO  PV-DISPLAY-DEPT-NBR      27220000
269900              MOVE PV-DISPLAY-KEYS   TO  DP013-MESSAGE-TEXT (2)   27230000
270000              MOVE SQLCA             TO  DP013-SQLCA              27240000
270100              MOVE 'TVNDAGR'         TO  DP013-DB2-TABLE-NAME (1) 27250000
270200              SET DP013-DB2-ABEND    TO  TRUE                     27260000
270300              SET DP013-NO-ROLLBACK  TO  TRUE                     27270000
270400              PERFORM 9999-ABEND                                  27280000
270500     END-EVALUATE.                                                27290000
270600                                                                  27300000
270700                                                                  27310000
270800*----------------------------------------------------------------*27320000
270900* COUNT THE NUMBER OF OPEN DC'S                                  *27330000
271000*----------------------------------------------------------------*27340000
271100 7065-COUNT-DC.                                                   27350000
271200                                                                  27360000
271300     EXEC SQL                                                     27370000
271400          SELECT  COUNT(*)                                        27380000
271500            INTO  :PV-OPEN-DC-COUNT                               27390000
271600            FROM  XLT_LOC                                         27400000
271700           WHERE                                                  27410000
271800             LOC_TYP_CDE = 'DC'                                   27420000
271900               AND CURRENT DATE  BETWEEN  OPN_DTE AND CLO_DTE     27430000
272000     END-EXEC.                                                    27440000
272100                                                                  27450000
272200     EVALUATE TRUE                                                27460000
272300         WHEN SQLCODE = ZERO                                      27470000
272310              MOVE PV-OPEN-DC-COUNT  TO WS-DC-COUNT               27480000
272400*DMH         IF  PV-OPEN-DC-COUNT  >  15                          27490000
272410             IF  PV-OPEN-DC-COUNT  >  12                          27490000
272500                 SET  PRINT-DOUBLE-HEADING  TO  TRUE              27500000
272600             ELSE                                                 27510000
272700                 SET  PRINT-SINGLE-HEADING  TO  TRUE              27520000
272800             END-IF                                               27530000
272900                                                                  27540000
273000         WHEN SQLWARN0 NOT = SPACE                                27550000
273100         WHEN SQLCODE < ZERO                                      27560000
273200         WHEN SQLCODE > ZERO                                      27570000
273300             MOVE '7065-COUNT-DC'                                 27580000
273400                                    TO  DP013-PARAGRAPH           27590000
273500             MOVE 'COUNT NUMBER OF OPEN DC'                       27600000
273600                                    TO  DP013-MESSAGE-TEXT (1)    27610000
273700             MOVE SQLCA             TO  DP013-SQLCA               27620000
273800             MOVE 'XLT_LOC'         TO  DP013-DB2-TABLE-NAME (1)  27630000
273900             SET DP013-DB2-ABEND    TO  TRUE                      27640000
274000             SET DP013-NO-ROLLBACK  TO  TRUE                      27650000
274100             PERFORM 9999-ABEND                                   27660000
274200                                                                  27670000
274300     END-EVALUATE.                                                27680000
274400                                                                  27690000
274500                                                                  27700000
274600*----------------------------------------------------------------*27710000
274700*                                                                *27720000
274800*----------------------------------------------------------------*27730000
274900 7070-OPEN-DC-STR-CSR.                                            27740000
275000                                                                  27750000
275100     EXEC SQL                                                     27760000
275200         OPEN DC-STR-CSR                                          27770000
275300     END-EXEC.                                                    27780000
275400                                                                  27790000
275500     EVALUATE TRUE                                                27800000
275600         WHEN SQLCODE = ZERO                                      27810000
275700             CONTINUE                                             27820000
275800                                                                  27830000
275900         WHEN SQLWARN0 NOT = SPACE                                27840000
276000         WHEN SQLCODE < ZERO                                      27850000
276100         WHEN SQLCODE > ZERO                                      27860000
276200             MOVE '7070-OPEN-DC-STR-CSR'                          27870000
276300                                    TO  DP013-PARAGRAPH           27880000
276400             MOVE 'OPEN THE DC-STR-CSR'                           27890000
276500                                    TO  DP013-MESSAGE-TEXT (1)    27900000
276600             MOVE SQLCA             TO  DP013-SQLCA               27910000
276700             MOVE 'XLT_LOC'         TO  DP013-DB2-TABLE-NAME (1)  27920000
276800             SET DP013-DB2-ABEND    TO  TRUE                      27930000
276900             SET DP013-NO-ROLLBACK  TO  TRUE                      27940000
277000             PERFORM 9999-ABEND                                   27950000
277100                                                                  27960000
277200     END-EVALUATE.                                                27970000
277300                                                                  27980000
277400 7080-FETCH-DC-STR-CSR.                                           27990000
277500     INITIALIZE DCLXLT00010.                                      28000000
277600                                                                  28010000
277700     EXEC SQL                                                     28020000
277800         FETCH  DC-STR-CSR                                        28030000
277900          INTO  :XLT00010-LOC-NBR                                 28040000
278000              , :XLT00010-LOC-5-ABBR-NM                           28050000
278100     END-EXEC.                                                    28060000
278200                                                                  28070000
278300     EVALUATE TRUE                                                28080000
278400         WHEN SQLCODE = ZERO                                      28090000
278500             ADD 1 TO PV-DIST-COUNT                               28100000
278600                                                                  28110000
278700         WHEN SQLCODE = PC-ROW-NOT-FOUND                          28120000
278800             CONTINUE                                             28130000
278900                                                                  28140000
279000         WHEN SQLWARN0 NOT = SPACE                                28150000
279100         WHEN SQLCODE < ZERO                                      28160000
279200         WHEN SQLCODE > ZERO                                      28170000
279300             MOVE '7080-FETCH-DC-STR-CSR'                         28180000
279400                                    TO  DP013-PARAGRAPH           28190000
279500             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 28200000
279600-                 'FROM THE DC-STR-CSR'                           28210000
279700                                    TO  DP013-MESSAGE-TEXT (1)    28220000
279800             MOVE SQLCA             TO  DP013-SQLCA               28230000
279900             MOVE 'XLT_LOC'         TO  DP013-DB2-TABLE-NAME (1)  28240000
280000             SET DP013-DB2-ABEND    TO  TRUE                      28250000
280100             SET DP013-NO-ROLLBACK  TO  TRUE                      28260000
280200             PERFORM 9999-ABEND                                   28270000
280300     END-EVALUATE.                                                28280000
280400                                                                  28290000
280500 7090-CLOSE-STR-NBR-CSR.                                          28300000
280600                                                                  28310000
280700     EXEC SQL                                                     28320000
280800         CLOSE DC-STR-CSR                                         28330000
280900     END-EXEC.                                                    28340000
281000                                                                  28350000
281100     EVALUATE TRUE                                                28360000
281200         WHEN SQLCODE = ZERO                                      28370000
281300             CONTINUE                                             28380000
281400                                                                  28390000
281500         WHEN SQLWARN0 NOT = SPACE                                28400000
281600         WHEN SQLCODE < ZERO                                      28410000
281700         WHEN SQLCODE > ZERO                                      28420000
281800             MOVE '7090-CLOSE-DC-STR-CSR'                         28430000
281900                                    TO  DP013-PARAGRAPH           28440000
282000             MOVE 'CLOSE THE DC-STR-CSR'                          28450000
282100                                    TO  DP013-MESSAGE-TEXT (1)    28460000
282200             MOVE SQLCA             TO  DP013-SQLCA               28470000
282300             MOVE 'XLT_LOC'         TO  DP013-DB2-TABLE-NAME (1)  28480000
282400             SET DP013-DB2-ABEND    TO  TRUE                      28490000
282500             SET DP013-NO-ROLLBACK  TO  TRUE                      28500000
282600             PERFORM 9999-ABEND                                   28510000
282700     END-EVALUATE.                                                28520000
282800                                                                  28530000
282900 7100-GET-SHIPMENT-INFO.                                          28540000
283000                                                                  28550000
283100     EXEC SQL                                                     28560000
283200         SELECT  DISTINCT                                         28570000
283300                C.OWNER_SCAC_ID                                   28580000
283400               ,C.VEH_NBR                                         28590000
283500               ,C.TRIP_ID                                         28600000
283600         INTO                                                     28610000
283700               :VHTRIP-OWNER-SCAC-ID                              28620000
283800              ,:VHTRIP-VEH-NBR :DN-VEH-NBR                        28630000
283900              ,:VHTRIP-TRIP-ID                                    28640000
284000         FROM  TSHPTPO A                                          28650000
284100              ,TSHIPMT B                                          28660000
284200              ,TVHTRIP C                                          28670000
284300         WHERE A.PO_NBR          = :DK-ORD-NBR                    28680000
284400           AND A.REC_SEQ_NBR     = :DK-REC-SEQ-NBR                28690000
284500           AND A.SHIPT_ID        =  B.SHIPT_ID                    28700000
284600           AND B.TRIP_ID         =  C.TRIP_ID                     28710000
284700           AND A.PRIM_SHIPT_IND  = 'Y'                            28720000
284800     END-EXEC                                                     28730000
284900                                                                  28740000
285000     EVALUATE TRUE                                                28750000
285100         WHEN SQLCODE = ZERO                                      28760000
285200         WHEN SQLCODE = -811                                      28770000
285300             IF DN-VEH-NBR = -1                                   28780000
285400                 MOVE SPACES         TO R1D-TRAILER               28790000
285500             ELSE                                                 28800000
285600                 MOVE VHTRIP-VEH-NBR TO R1D-TRAILER               28810000
285700             END-IF                                               28820000
285800             MOVE VHTRIP-OWNER-SCAC-ID TO R1D-SCAC                28830000
285900             MOVE VHTRIP-TRIP-ID       TO R1D-TRIP                28840000
286000                                                                  28850000
286100         WHEN SQLCODE = +100                                      28860000
286200             MOVE SPACES         TO R1D-TRAILER                   28870000
286300                                    R1D-SCAC                      28880000
286400             MOVE ZERO           TO R1D-TRIP                      28890000
286500                                                                  28900000
286600         WHEN SQLCODE = -904                                      28910000
286700         WHEN SQLCODE = -913                                      28920000
286800             CONTINUE                                             28930000
286900                                                                  28940000
287000         WHEN SQLWARN0 NOT = SPACE                                28950000
287100         WHEN SQLCODE < +0                                        28960000
287200         WHEN SQLCODE > +0                                        28970000
287300             MOVE '7100-GET-SHIPMENT-INFO'                        28980000
287400                             TO DP013-PARAGRAPH                   28990000
287500             MOVE 'SELECT SHIPMENT INFO'                          29000000
287600                             TO DP013-MESSAGE-TEXT (1)            29010000
287700             MOVE DK-ORD-NBR  TO DP013-MESSAGE-TEXT (2)           29020000
287800             MOVE DK-REC-SEQ-NBR                                  29030000
287900                             TO DP013-MESSAGE-TEXT (3)            29040000
288000             MOVE SQLCA      TO DP013-SQLCA                       29050000
288100             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)          29060000
288200             MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)          29070000
288300             MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (3)          29080000
288400             SET DP013-DB2-ABEND                                  29090000
288500                             TO TRUE                              29100000
288600             SET DP013-XCTL-DISPLAY-RESTART                       29110000
288700                             TO TRUE                              29120000
288800             PERFORM DP013-0000-PROCESS-ABEND                     29130000
288900     END-EVALUATE.                                                29140000
289000                                                                  29150000
289100/                                                                 29160000
289200 Z900-PUT-LINE-TO-DRS.                                            29170000
289300     MOVE PC-PUT  TO DRS01-DRRB-FUNC.                             29180000
289400     EXEC CICS LINK                                               29190000
289500         PROGRAM ('DRS1INTC')                                     29200000
289600         COMMAREA(DRS01-COMMAREA)                                 29210000
289700         LENGTH(200)                                              29220000
289800     END-EXEC.                                                    29230000
289900     IF DRS01-DRRB-RC IS EQUAL TO ZERO                            29240000
290000         CONTINUE                                                 29250000
290100     ELSE                                                         29260000
290200         PERFORM Z950-DRS-ERROR-SUICIDE                           29270000
290300     END-IF.                                                      29280000
290400*                                                                 29290000
290500 Z950-DRS-ERROR-SUICIDE.                                          29300000
290600     MOVE DRS01-DRRB-FUNC TO IE-DRS-FUNC.                         29310000
290700     MOVE DRS01-DRRB-RC TO IE-DRS-RC.                             29320000
290800*                                                                 29330000
290900     MOVE PC-TERM TO DRS01-DRRB-FUNC.                             29340000
291000     EXEC CICS LINK                                               29350000
291100         PROGRAM ('DRS1INTC')                                     29360000
291200         COMMAREA(DRS01-COMMAREA)                                 29370000
291300         LENGTH(200)                                              29380000
291400     END-EXEC.                                                    29390000
291500     EXEC CICS                                                    29400000
291600         SYNCPOINT                                                29410000
291700     END-EXEC.                                                    29420000
291800                                                                  29430000
291900     EXEC CICS WRITEQ TD QUEUE ('CSML')                           29440000
292000         FROM (IE-DRS-ERROR-MSG)                                  29450000
292100         LENGTH(118)                                              29460000
292200     END-EXEC.                                                    29470000
292300                                                                  29480000
292400 9999-ABEND.                                                      29490000
292500     MOVE 'MPKCS014'               TO DP013-PROGRAM.              29500000
292600     SET DP013-LINK-RETURN         TO TRUE.                       29510000
292700     SET DP013-NO-ROLLBACK         TO TRUE.                       29520000
292800     INITIALIZE                       DP013-SRC-TASK-NUMBER       29530000
292900                                      DP013-STACK.                29540000
293000     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             29550000
293100                                                                  29560000
293200     EXEC CICS                                                    29570000
293300         LINK                                                     29580000
293400             PROGRAM  (DP013-NAME)                                29590000
293500             COMMAREA (DP013-PARAMETERS)                          29600000
293600             LENGTH   (DP013-LENGTH)                              29610000
293700     END-EXEC.                                                    29620000
293800                                                                  29630000
293900     EXEC CICS                                                    29640000
294000          RETURN                                                  29650000
294100     END-EXEC.                                                    29660000
294200/                                                                 29670000
294300******************************************************************29680000
294400*    ABEND PROCESSING                                             29690000
294500******************************************************************29700000
294600     COPY DPPD013.                                                29710000
