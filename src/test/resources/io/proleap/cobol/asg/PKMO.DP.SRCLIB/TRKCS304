000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    TRKCS304.                                         00040029
000500 AUTHOR.        THERESE RAMSEYER.                                 00050029
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  MARCH 1999.                                       00070029
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    Y304 - IMPORTS RECEIVING PO HISTORY                        * 00110029
001200*                                                               * 00120000
001300*  THIS PROGRAM DISPLAYS THE RECEIVING PO HISTORY OF A SELECTED * 00130029
001400*  PURCHASE ORDER, RECEIVED DELY DATE, AND ORIGIN SHIPPED FROM  * 00140031
001500*  TYPE.   THE COLUMN THAT WAS CHANGED, DATE & TIME OF CHANGE,  * 00150029
001600*  AND THE BEFORE AND AFTER VALUES OF THE COLUMN ARE            * 00160029
001700*  DISPLAYED.                                                   * 00170029
001800*                                                               * 00180000
001900*---------------------------------------------------------------* 00190000
001300* CHANGE HISTORY                                                *         
001300*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              *         
001300*     DATE:    10/31/2014                                       *         
001300*                                                               *         
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# *         
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/31/2014    *         
003250*---------------------------------------------------------------*         
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697                 
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263697* MAKING THE CALL DYNAMIC VS STATIC.                                      
263697*---------------------------------------------------------------*         
CICS  * CHANGED  1/16/2023    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
002000                                                                  00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200                                                                  00220000
002300 DATA DIVISION.                                                   00230000
002400                                                                  00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600                                                                  00260000
002700 01  DK-DB2-KEYS.                                                 00270000
002800     15  DK-PO-NBR                      PIC  S9(09) COMP          00280000
002900                                             VALUE ZERO.          00290000
003000     15  DK-PO-SEQ-NBR                  PIC  S9(04) COMP          00300034
003100                                             VALUE ZERO.          00310000
003200     15  DK-DELY-DTE                    PIC  X(10)  VALUE SPACES. 00320034
003300     15  DK-ORGN-SHPD-FROM-TYP          PIC  X(03)  VALUE SPACES. 00330000
003400                                                                  00340000
003500 01  PC-PROGRAM-CONSTANTS.                                        00350000
003600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00360000
003700                                                    'TR304A  '.   00370031
003800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00380000
003900                                                    'TRKM304 '.   00390031
004000     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00400000
004100                                                    'TRKCS304'.   00410031
004200     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00420000
004300     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00430000
004400     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00440000
004500     05  PC-RECEIVING-PO-FORMAT         PIC  X(01)  VALUE '1'.    00450031
004600     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00460000
004700     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     00470000
004800                                                    COMP SYNC.    00480000
004900     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00490000
005000                                                    COMP SYNC.    00500000
005100     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00510000
005200                                                    +1000000      00520000
005300                                                    COMP-3.       00530000
005400     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00540000
005500                                                    COMP SYNC.    00550000
005600     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00560000
005700                                                     COMP-3.      00570000
005800     05  PC-INIT-DATE                   PIC X(10)    VALUE        00580000
005900                                                   '0001-01-01'.  00590000
006000     05  PC-INIT-TIME                   PIC X(05)    VALUE        00600000
006100                                                   '00.00'.       00610000
006200     05  PC-SLASH                       PIC X(01)    VALUE '/'.   00620000
006300     05  PC-COLON                       PIC X(01)    VALUE ':'.   00630000
006400                                                                  00640000
006500 01  PC-TSYMSG-NUMBERS.                                           00650000
006600     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00660000
006700     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00670000
006800     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00680000
006900     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00690000
007000     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00700000
007100     05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  00710000
007200     05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  00720000
007300     05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  00730000
007400                                                                  00740000
007500 01  PS-PROGRAM-SUBSCRIPTS.                                       00750000
007600     05  PS-SUB                         PIC S9(04)   VALUE +0     00760000
007700                                                     COMP SYNC.   00770000
007800                                                                  00780000
007900 01  PS-PROGRAM-SWITCHES.                                         00790000
008000     05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   00800000
008100         88  PS-NO-ERROR                             VALUE 'Y'.   00810000
008200         88  PS-ERROR                                VALUE 'N'.   00820000
008300     05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   00830000
008400         88  PS-COMMAREA-VALID                       VALUE 'Y'.   00840000
008500         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00850000
008600                                                                  00860000
008700 01  PV-PROGRAM-VARIABLES.                                        00870000
008800     05  PV-RETRY-COUNTER               PIC S9(04)   VALUE +0     00880000
008900                                                     COMP SYNC.   00890000
009000     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     00900000
009100                                                     COMP SYNC.   00910000
009200     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     00920000
009300                                                     COMP-3.      00930000
009400     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     00940000
009500                                                     COMP-3.      00950000
009600     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     00960000
009700                                                     COMP-3.      00970000
009800     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     00980000
009900                                                     COMP SYNC.   00990000
010000     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     01000000
010100                                                     COMP SYNC.   01010000
010200     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     01020000
010300                                                     COMP SYNC.   01030000
010400     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     01040000
010500                                                     COMP SYNC.   01050000
010600     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01060000
010700                                                                  01070000
010800     05  PV-FORMAT-DATE.                                          01080000
010900         10  PV-FORMAT-MM               PIC XX.                   01090000
011000         10  PV-FORMAT-SLASH1           PIC X        VALUE '/'.   01100000
011100         10  PV-FORMAT-DD               PIC XX.                   01110000
011200         10  PV-FORMAT-SLASH2           PIC X        VALUE '/'.   01120000
011300         10  PV-FORMAT-YY               PIC XX.                   01130000
011400                                                                  01140000
011500     05  PV-FORMAT-TIME.                                          01150000
011600         10  PV-FORMAT-HOUR             PIC XX.                   01160000
011700         10  PV-FORMAT-COLON            PIC X        VALUE ':'.   01170000
011800         10  PV-FORMAT-MIN              PIC XX.                   01180000
011900                                                                  01190000
012000     05  PV-TMST.                                                 01200000
012100         10  PV-TMST-DATE.                                        01210000
012200             15  PV-TMST-MM            PIC XX.                    01220000
012300             15  PV-TMST-SLASH1        PIC X        VALUE '/'.    01230000
012400             15  PV-TMST-DD            PIC XX.                    01240000
012500             15  PV-TMST-SLASH2        PIC X        VALUE '/'.    01250000
012600             15  PV-TMST-CCYY          PIC X(04).                 01260000
012700             15  FILLER                PIC X(03).                 01270000
012800         10  PV-TMST-TIME.                                        01280000
012900             15  PV-TMST-HOUR          PIC XX.                    01290000
013000             15  PV-TMST-COLON         PIC X        VALUE ':'.    01300000
013100             15  PV-TMST-MIN           PIC XX.                    01310000
013200             15  FILLER                PIC X(12)    VALUE SPACES. 01320000
013300                                                                  01330000
013400     05  PV-HOLD-TMST-UNFORMAT          PIC X(26)    VALUE SPACES.01340000
013500                                                                  01350000
013600     05  PV-HOLD-BEFORE-VALUE           PIC X(30)    VALUE SPACES.01360000
013700     05  PV-HOLD-BEFORE-VALUE-V         PIC Z(08)9.99 VALUE ZERO. 01370000
013800     05  PV-HOLD-BEFORE-VALUE-N         PIC Z(08)9    VALUE ZERO. 01380000
013900     05  PV-HOLD-AFTER-VALUE            PIC X(30)    VALUE SPACES.01390000
014000     05  PV-HOLD-AFTER-VALUE-V          PIC Z(08)9.99 VALUE ZERO. 01400000
014100     05  PV-HOLD-AFTER-VALUE-N          PIC Z(08)9    VALUE ZERO. 01410000
014200     05  PV-HOLD-FIELD-NAME             PIC X(20)    VALUE SPACES.01420000
014210     05  PV-EXTL-REF-NBR                PIC X(15)    VALUE SPACES.        
014300                                                                  01430000
014400     05  PV-PREVIOUS-VALUES.                                      01440000
014500         10  PV-PREV-CONSLR-SCAC-ID     PIC X(04)    VALUE SPACES.01450000
014600         10  PV-PREV-IMPRT-TRIP-ID      PIC X(10)    VALUE SPACES.01460000
014700         10  PV-PREV-DPRTR-TMST         PIC X(26)    VALUE SPACES.01470000
014800         10  PV-PREV-POE-DELY-TMST      PIC X(26)    VALUE SPACES.01480000
014900         10  PV-PREV-CARR-SCAC-ID       PIC X(04)    VALUE SPACES.01490000
015000         10  PV-PREV-FOB-CDE            PIC X(05)    VALUE SPACES.01500000
015100         10  PV-PREV-IMPRT-VEH-NM       PIC X(25)    VALUE SPACES.01510000
015200         10  PV-PREV-TRIP-TYP-CDE       PIC X(01)    VALUE SPACES.01520000
015300         10  PV-PREV-DEST-POE-CDE       PIC X(04)    VALUE SPACES.01530000
015400         10  PV-PREV-C-O-PROD-CDE       PIC X(03)    VALUE SPACES.01540000
015500         10  PV-PREV-PROD-FCTRY-NM      PIC X(35)    VALUE SPACES.01550000
015600         10  PV-PREV-PO-CART-CNT        PIC S9(09)   VALUE +0     01560000
015700                                                     COMP.        01570000
015800         10  PV-PREV-PO-CBMT-QTY        PIC S9(07)V9(2) VALUE +0  01580000
015900                                                        COMP-3.   01590000
016000         10  PV-PREV-PO-WT-KGRM-QTY     PIC S9(09)   VALUE +0     01600000
016100                                                     COMP.        01610000
016200         10  PV-PREV-PO-UNT-QTY         PIC S9(09)   VALUE +0     01620000
016300                                                     COMP.        01630000
016400         10  PV-PREV-PO-EXC-APVL-CDE    PIC X(02)    VALUE SPACES.01640000
016500         10  PV-PREV-PO-EXC-APVL-USR-ID PIC X(08)    VALUE SPACES.01650000
016600         10  PV-PREV-PO-EXC-APVL-TMST   PIC X(26)    VALUE SPACES.01660000
016700         10  PV-PREV-PO-EXC-RSN-DESC    PIC X(30)    VALUE SPACES.01670000
016800         10  PV-PREV-EST-LBD-NM         PIC X(30)    VALUE SPACES.01680000
016900         10  PV-PREV-EST-LBD-TMST       PIC X(26)    VALUE SPACES.01690000
017100         10  PV-PREV-VOY-CHG-RSN-DESC   PIC X(30)    VALUE SPACES.01710000
017200         10  PV-PREV-DAT-SRC-ENT-ID     PIC S9(09)   VALUE +0     01720000
017300                                                     COMP.        01730000
017400         10  PV-PREV-LAST-UPD-BY-USR-ID PIC X(08)    VALUE SPACES.01740000
017500         10  PV-PREV-LAST-UPD-TMST      PIC X(26)    VALUE SPACES.01750000
017600                                                                  01760000
017700*---------------------------------------------------------------* 01770000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01780000
017900*---------------------------------------------------------------* 01790000
018000                                                                  01800000
018100     COPY DPWS030.                                                01810000
CICS       COPY DPWS930.                                                01810000
018200 EJECT                                                            01820000
018300*---------------------------------------------------------------* 01830000
018400*    NUMERIC EDIT LAYOUT.                                       * 01840000
018500*---------------------------------------------------------------* 01850000
018600                                                                  01860000
018700     COPY DPWS010I.                                               01870000
018800                                                                  01880000
018900 EJECT                                                            01890000
019000*---------------------------------------------------------------* 01900000
019100*    STANDARD COMMAREA.                                         * 01910000
019200*---------------------------------------------------------------* 01920000
019300                                                                  01930000
019400     COPY DPWS020.                                                01940000
019500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01950000
019600                                                                  01960000
030000*---------------------------------------------------------------* 03000000
030100* INTER-APPLICATION COMMAREA.                                   * 03010000
030200*   TRWS117 - IS THE INPUT LAYOUT WHEN COMING FROM THE RECEIVING* 03020032
030300*             ESTIMATES SCREEN.                                 * 03030032
030600*---------------------------------------------------------------* 03060000
030700                                                                  03070000
030800         10  INTER-APPL-COMM-AREA       PIC X(200).               03080000
030900     COPY TRWS117.                                                03090000
031100                                                                  03110000
031200*---------------------------------------------------------------* 03120000
031300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03130000
031400*---------------------------------------------------------------* 03140000
031500         10  ASC-SPECIFIC-COMMAREA.                               03150000
031600             15  ASC-LIST-KEYS.                                   03160000
031700                 20  ASC-KEY-PO-NBR                  PIC S9(09)   03170000
031800                                                         COMP.    03180000
031900                 20  ASC-KEY-PO-SEQ-NBR              PIC S9(04)   03190036
032000                                                         COMP.    03200000
032100                 20  ASC-KEY-DELY-DTE                PIC X(10).   03210032
032200                 20  ASC-KEY-ORGN-SHPD-FROM-TYP      PIC X(03).   03220000
032300                                                                  03230000
032400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03240000
032500                 20  ASC-ITEM-ARRAY.                              03250000
032600                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        03260000
032700                         30  ASC-LIST-ITEM-NUMBER                 03270000
032800                                                     PIC S9(09)   03280000
032900                                                     COMP-3.      03290000
033000                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03300000
033100                             88  ASC-VALID-SELECT    VALUE ' '    03310000
033200                                                           'S'    03320000
033300                                                           'B'    03330000
033400                                                           'E'.   03340000
033500                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03350000
033600                             88  ASC-TEMP-SELECT     VALUE 'S'.   03360000
033700                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03370000
033800                             88  ASC-TEMP-END        VALUE 'E'.   03380000
033900                         30  ASC-SELECTED-SW         PIC  X(01).  03390000
034000                             88  ASC-NO-SELECT       VALUE ' '.   03400000
034100                             88  ASC-SELECT          VALUE 'S'.   03410000
034200                             88  ASC-BEGIN           VALUE 'B'.   03420000
034300                             88  ASC-END             VALUE 'E'.   03430000
034400                         30  ASC-DATA                PIC  X(20).  03440000
034500                         30  ASC-USERID              PIC  X(08).  03450000
034600                         30  ASC-DATE                PIC  X(08).  03460000
034700                         30  ASC-TIME                PIC  X(05).  03470000
034800                         30  ASC-VALUE               PIC  X(30).  03480000
034900                                                                  03490000
035000             15  ASC-BLK-SUB                         PIC S9(04)   03500000
035100                                                         COMP     03510000
035200                                                         SYNC.    03520000
035300             15  ASC-ITEM-SUB                        PIC S9(04)   03530000
035400                                                         COMP     03540000
035500                                                         SYNC.    03550000
035600             15  ASC-SEL-SUB                         PIC S9(04)   03560000
035700                                                         COMP.    03570000
035800             15  ASC-SEL-ITEM                        PIC S9(04)   03580000
035900                                                         COMP.    03590000
036000             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   03600000
036100                                                         COMP-3.  03610000
036200             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03620000
036300                                                         COMP-3.  03630000
036400             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   03640000
036500                                                         COMP-3.  03650000
036600             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   03660000
036700                                                         COMP-3.  03670000
036800             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03680000
036900                                                         COMP-3.  03690000
037000             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03700000
037100                                                         COMP-3.  03710000
037200             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   03720000
037300                                                         COMP     03730000
037400                                                         SYNC.    03740000
037500             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03750000
037600                                                         COMP-3.  03760000
037700             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03770000
037800                                                         COMP-3.  03780000
037900             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03790000
038000                 88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 03800000
038100                 88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 03810000
038200             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  03820000
038300                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03830000
038400             15  ASC-DTL-QUEUE-NAME.                              03840000
038500                 20  ASC-DTL-TERM-ID                 PIC  X(04).  03850000
038600                 20  ASC-DTL-TASK-NUMBER             PIC S9(05)   03860000
038700                                                         COMP-3.  03870000
038800                 20  ASC-DTL-SEQ                     PIC  9(01).  03880000
038900                                                                  03890000
039000             15  ASC-START-ITEM-REQUEST.                          03900000
039100                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  03910000
039200                                                                  03920000
039300     EJECT                                                        03930000
039400*---------------------------------------------------------------* 03940000
039500*    ABEND PROCESSING COPYBOOK.                                 * 03950000
039600*---------------------------------------------------------------* 03960000
039700                                                                  03970000
039800     COPY DPWS013.                                                03980000
039900                                                                  03990000
040000     EJECT                                                        04000000
040100*---------------------------------------------------------------* 04010000
040200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04020000
040300*---------------------------------------------------------------* 04030000
040400                                                                  04040000
040500     COPY DPWS015.                                                04050000
040600                                                                  04060000
040700*---------------------------------------------------------------* 04070000
040800*    FUNCTION KEYS COPYBOOK.                                    * 04080000
040900*---------------------------------------------------------------* 04090000
041000                                                                  04100000
041100     COPY DPWS016.                                                04110000
041200                                                                  04120000
041300*---------------------------------------------------------------* 04130000
041400*    MAP LAYOUT                                                 * 04140000
041500*---------------------------------------------------------------* 04150000
041600                                                                  04160000
041700     COPY TRKM304.                                                04170031
041800                                                                  04180000
041900 01  MR-OCCURS-LAYOUT          REDEFINES  TR304AO.                04190031
042000*PS 10/31/2014 CHANGES STARTS                                     04200000
042000     05  FILLER                PIC X(96).                         04200000
042000*PS 10/31/2014 CHANGES ENDS                                       04200000
042100     05  MR-SCROLL-AREA OCCURS 12 TIMES.                          04210000
042200         10  MR-DATAL          PIC S9(04) COMP.                   04220000
042300         10  MR-DATAA          PIC  X(01).                        04230000
042400         10  MR-DATAC          PIC  X(01).                        04240000
042500         10  MR-DATAH          PIC  X(01).                        04250000
042600         10  MR-DATA           PIC  X(20).                        04260000
042700                                                                  04270000
042800         10  MR-USERIDL        PIC S9(04) COMP.                   04280000
042900         10  MR-USERIDA        PIC  X(01).                        04290000
043000         10  MR-USERIDC        PIC  X(01).                        04300000
043100         10  MR-USERIDH        PIC  X(01).                        04310000
043200         10  MR-USERID         PIC  X(08).                        04320000
043300                                                                  04330000
043400         10  MR-DATEL          PIC S9(04) COMP.                   04340000
043500         10  MR-DATEA          PIC  X(01).                        04350000
043600         10  MR-DATEC          PIC  X(01).                        04360000
043700         10  MR-DATEH          PIC  X(01).                        04370000
043800         10  MR-DATE           PIC  X(08).                        04380000
043900                                                                  04390000
044000         10  MR-TIMEL          PIC S9(04) COMP.                   04400000
044100         10  MR-TIMEA          PIC  X(01).                        04410000
044200         10  MR-TIMEC          PIC  X(01).                        04420000
044300         10  MR-TIMEH          PIC  X(01).                        04430000
044400         10  MR-TIME           PIC  X(05).                        04440000
044500                                                                  04450000
044600         10  MR-VALUEL         PIC S9(04) COMP.                   04460000
044700         10  MR-VALUEA         PIC  X(01).                        04470000
044800         10  MR-VALUEC         PIC  X(01).                        04480000
044900         10  MR-VALUEH         PIC  X(01).                        04490000
045000         10  MR-VALUE          PIC  X(30).                        04500000
045100                                                                  04510000
045200 EJECT                                                            04520000
045300*---------------------------------------------------------------* 04530000
045400*    DB2 AREA FOR RECEIVING PURCHASE ORDER TABLE                * 04540031
045500*---------------------------------------------------------------* 04550000
045600     EXEC SQL                                                     04560000
045700          INCLUDE TIMRCPO                                         04570031
045800     END-EXEC.                                                    04580000
045900*---------------------------------------------------------------* 04590000
046000*    DB2 AREA FOR RECEIVING PURCHASE ORDER AUDIT TABLE          * 04600031
046100*---------------------------------------------------------------* 04610000
046200     EXEC SQL                                                     04620000
046300          INCLUDE TAURCPO                                         04630031
046400     END-EXEC.                                                    04640000
046500*---------------------------------------------------------------* 04650000
046600*    DB2 AREA FOR COMMUNICATIONS                                * 04660000
046700*---------------------------------------------------------------* 04670000
046800     EXEC SQL                                                     04680000
046900          INCLUDE SQLCA                                           04690000
047000     END-EXEC.                                                    04700000
047100                                                                  04710000
047200*---------------------------------------------------------------* 04720000
047300*    CURSOR TO OBTAIN RECEIVING PO HISTORY INFORMATION          * 04730031
047400*---------------------------------------------------------------* 04740000
047500                                                                  04750000
047600     EXEC SQL                                                     04760000
047700          DECLARE PO-CSR CURSOR                                   04770000
047800          FOR SELECT                                              04780000
047900                A.CONSLR_SCAC_ID                                  04790000
048000              , A.IMPRT_TRIP_ID                                   04800000
048100              , A.DPRTR_TMST                                      04810000
048200              , A.POE_DELY_TMST                                   04820000
048300              , A.CARR_SCAC_ID                                    04830000
048400              , A.FOB_CDE                                         04840000
048500              , A.IMPRT_VEH_NM                                    04850000
048600              , A.TRIP_TYP_CDE                                    04860000
048700              , A.DEST_POE_CDE                                    04870000
048800              , A.C_O_PROD_CDE                                    04880000
048900              , A.PROD_FCTRY_NM                                   04890000
049000              , A.PO_CART_CNT                                     04900000
049100              , A.PO_CBMT_QTY                                     04910000
049200              , A.PO_WT_KGRM_QTY                                  04920000
049300              , A.PO_UNT_QTY                                      04930000
049400              , A.PO_EXC_APVL_CDE                                 04940000
049500              , A.PO_EXC_APVL_USR_ID                              04950000
049600              , A.PO_EXC_APVL_TMST                                04960000
049700              , A.PO_EXC_RSN_DESC                                 04970000
049800              , A.EST_LBD_NM                                      04980000
049900              , A.EST_LBD_TMST                                    04990000
050100              , A.VOY_CHG_RSN_DESC                                05010000
050200              , A.DAT_SRC_ENT_ID                                  05020000
050300              , A.LAST_UPD_BY_USR_ID                              05030000
050400              , A.LAST_UPD_TMST                                   05040000
050500          FROM                                                    05050000
050600                TAURCPO  A                                        05060031
050700          WHERE                                                   05070000
050800                A.PO_NBR           = :DK-PO-NBR                   05080000
050900            AND A.PO_RCVD_SEQ_NBR  = :DK-PO-SEQ-NBR               05090035
051000            AND A.ORGN_SHPD_FR_CDE = :DK-ORGN-SHPD-FROM-TYP       05100000
051100            AND DATE(A.PO_RCVD_DELY_TMST) = :DK-DELY-DTE          05110035
051200          ORDER BY                                                05120000
051300                A.LAST_UPD_TMST DESC                              05130000
051400     END-EXEC.                                                    05140000
051500                                                                  05150000
051600 EJECT                                                            05160000
051700 LINKAGE SECTION.                                                 05170000
051800                                                                  05180000
051900 01  DFHCOMMAREA.                                                 05190000
052000     05  FILLER                         OCCURS  1 TO 4072 TIMES   05200000
052100                                        DEPENDING ON EIBCALEN.    05210000
052200         10  FILLER                     PIC X.                    05220000
052300                                                                  05230000
052400 EJECT                                                            05240000
052500 PROCEDURE DIVISION.                                              05250000
052600                                                                  05260000
052700 0000-MAIN-MODULE.                                                05270000
052800                                                                  05280000
052900     INITIALIZE DP030-CICS-API-FIELDS.                            05290000
053000     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        05300000
053100     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           05310000
053200     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          05320000
053300     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        05330000
053400     MOVE LENGTH OF TR304AI       TO DP030-MAP-LENGTH (1).        05340031
053500     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      05350000
053600     PERFORM 0001-CALL-CICS-ARCH-API.                             05360000
053700                                                                  05370000
053800     PERFORM 1000-CONTROL-PROCESSING.                             05380000
053900                                                                  05390000
054000     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      05400000
054100     PERFORM 0001-CALL-CICS-ARCH-API.                             05410000
054200                                                                  05420000
054300*----------------------------------------------------------------*05430000
054400*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *05440000
054500*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *05450000
054600*----------------------------------------------------------------*05460000
054700                                                                  05470000
054800 0001-CALL-CICS-ARCH-API.                                         05480000
054900                                                                  05490000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05500000
055100                                    DFHCOMMAREA                           
055200                                    DP030-CICS-API-FIELDS                 
055300                                    DP020-STANDARD-COMMAREA               
055400                                    TR304AI.                              
055500                                                                  05550000
055600     IF  DP030-RC-CALL-SUCCESSFUL                                 05560000
055700         CONTINUE                                                 05570000
055800     ELSE                                                         05580000
055900         SET DP013-NO-ROLLBACK TO TRUE                            05590000
056000         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   05600000
056100         SET DP013-CICS-ABEND TO TRUE                             05610000
056200         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        05620000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05630000
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05640000
056500         MOVE DP030-RETURN-CODE                                   05650000
056600                               TO DP013-MESSAGE-TEXT (3)          05660000
056700         PERFORM DP013-0000-PROCESS-ABEND                         05670000
056800     END-IF.                                                      05680000
056900                                                                  05690000
057000*----------------------------------------------------------------*05700000
057100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05710000
057200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05720000
057300*                                                                *05730000
057400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05740000
057500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05750000
057600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05760000
057700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05770000
057800*----------------------------------------------------------------*05780000
057900                                                                  05790000
058000 1000-CONTROL-PROCESSING.                                         05800000
058100                                                                  05810000
058200     EVALUATE TRUE                                                05820000
058300         WHEN DP020-NEXT-ACT-INITIAL                              05830000
058400             MOVE EIBTRMID          TO ASC-DTL-TERM-ID            05840000
058500             MOVE DP020-SRC-TASK-NUMBER                           05850000
058600                                    TO ASC-DTL-TASK-NUMBER        05860000
058700             MOVE PC-DTL-QUEUE-SEQ  TO ASC-DTL-SEQ                05870000
058800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05880000
058900***-----$TEMPLATE NOTE$-------------------------------------------05890000
059000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05900000
059100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05910000
059200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05920000
059300***---------------------------------------------------------------05930000
059400             IF  PS-COMMAREA-NOT-VALID                            05940000
059500***              MOVE PC-TSYMSG-99901                             05950000
059600***                            TO  DP020-MSG-NUMBER               05960000
059700***              SET DP020-MSG-FATAL                              05970000
059800***                            TO  TRUE                           05980000
059900                 SET DP020-NEXT-ACT-APPL-ERROR                    05990000
060000                               TO  TRUE                           06000000
060100             ELSE                                                 06010000
060200                 PERFORM 2050-DELETE-DETAIL-QUEUE                 06020000
060300                 PERFORM 4000-BUILD-INITIAL-PANEL                 06030000
060400             END-IF                                               06040000
060500                                                                  06050000
060600         WHEN DP020-NEXT-ACT-READ-MAP                             06060000
060700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06070000
060800                               TO PV-TOP-ITEM                     06080000
060900             PERFORM 2000-PROCESS-PANEL                           06090000
061000                                                                  06100000
061100         WHEN DP020-NEXT-ACT-RETURN                               06110000
061200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06120000
061300                               TO PV-TOP-ITEM                     06130000
061400             MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        06140000
061500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06150000
061600                                                                  06160000
061700         WHEN OTHER                                               06170000
061800             SET DP013-LOGIC-ABEND TO TRUE                        06180000
061900             SET DP013-NO-ROLLBACK TO TRUE                        06190000
062000             MOVE '1000-CONTROL-PROCESSING'                       06200000
062100                               TO  DP013-PARAGRAPH                06210000
062200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06220000
062300                               TO  DP013-MESSAGE-TEXT(1)          06230000
062400             PERFORM DP013-0000-PROCESS-ABEND                     06240000
062500     END-EVALUATE.                                                06250000
062600                                                                  06260000
062700 EJECT                                                            06270000
062800*----------------------------------------------------------------*06280000
062900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06290000
063000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06300000
063100*----------------------------------------------------------------*06310000
063200                                                                  06320000
063300 1100-PROCESS-INTER-APPL-COMM.                                    06330000
063400                                                                  06340000
063500     SET PS-COMMAREA-VALID     TO TRUE.                           06350000
063600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            06360000
063700     MOVE SPACE                TO ASC-START-ITEM-REQUEST.         06370000
063800                                                                  06380000
063900     EVALUATE DP020-INT-APPL-FORMAT-IND                           06390000
064000         WHEN PC-RECEIVING-PO-FORMAT                              06400031
064100             MOVE TR117-PO-NBR         TO ASC-KEY-PO-NBR          06410032
064200                                          DK-PO-NBR               06420000
064300             MOVE TR117-PO-SEQ-NBR     TO ASC-KEY-PO-SEQ-NBR      06430034
064400                                          DK-PO-SEQ-NBR           06440033
064500             MOVE TR117-DELY-DTE       TO ASC-KEY-DELY-DTE        06450032
064600                                          DK-DELY-DTE             06460033
064700             MOVE TR117-ORGN-SHPD-FR-TYP TO                       06470000
064800                                      ASC-KEY-ORGN-SHPD-FROM-TYP  06480000
064900                                      DK-ORGN-SHPD-FROM-TYP       06490000
065000         WHEN OTHER                                               06500000
065100             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            06510000
065200             SET DP020-MSG-FATAL   TO TRUE                        06520000
065300             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                06530000
065400     END-EVALUATE.                                                06540000
065500                                                                  06550000
065600*----------------------------------------------------------------*06560000
065700*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *06570000
065800*    ON WHAT FUNCTION KEY WAS SELECTED.                          *06580000
065900*----------------------------------------------------------------*06590000
066000                                                                  06600000
066100 2000-PROCESS-PANEL.                                              06610000
066200                                                                  06620000
066300     EVALUATE TRUE                                                06630000
066400         WHEN DP020-SRC-AID = DP016-CLEAR                         06640000
066500             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                06650000
066600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06660000
066700             PERFORM 3200-RESET-ATTRIBUTES                        06670000
066800                                                                  06680000
066900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06690000
067000             MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR             06700000
067100             MOVE ASC-KEY-PO-SEQ-NBR     TO DK-PO-SEQ-NBR         06710037
067200             MOVE ASC-KEY-DELY-DTE       TO DK-DELY-DTE           06720037
067300             MOVE ASC-KEY-ORGN-SHPD-FROM-TYP TO                   06730000
067400                                         DK-ORGN-SHPD-FROM-TYP    06740000
067500             PERFORM 2050-DELETE-DETAIL-QUEUE                     06750000
067600             PERFORM 4000-BUILD-INITIAL-PANEL                     06760000
067700             PERFORM 3200-RESET-ATTRIBUTES                        06770000
067800                                                                  06780000
067900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06790000
068000             MOVE +1 TO PV-TOP-ITEM                               06800000
068100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06810000
068200             PERFORM 3200-RESET-ATTRIBUTES                        06820000
068300                                                                  06830000
068400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06840000
068500             PERFORM 2110-BROWSE-BACKWARD                         06850000
068600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06860000
068700             PERFORM 3200-RESET-ATTRIBUTES                        06870000
068800                                                                  06880000
068900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06890000
069000             PERFORM 2120-BROWSE-FORWARD                          06900000
069100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06910000
069200             PERFORM 3200-RESET-ATTRIBUTES                        06920000
069300                                                                  06930000
069400         WHEN DP020-SRC-AID = DP016-ENTER                         06940000
069500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06950000
069600             IF  PS-ERROR                                         06960000
069700                 CONTINUE                                         06970000
069800             ELSE                                                 06980000
069900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06990000
070000                 PERFORM 3200-RESET-ATTRIBUTES                    07000000
070100             END-IF                                               07010000
070200                                                                  07020000
070300         WHEN OTHER                                               07030000
070400             SET DP013-NO-ROLLBACK TO TRUE                        07040000
070500             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               07050000
070600             SET DP013-CICS-ABEND TO TRUE                         07060000
070700             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         07070000
070800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07080000
070900                                   TO DP013-MESSAGE-TEXT (1)      07090000
071000             PERFORM DP013-0000-PROCESS-ABEND                     07100000
071100                                                                  07110000
071200     END-EVALUATE.                                                07120000
071300 EJECT                                                            07130000
071400*----------------------------------------------------------------*07140000
071500*    DELETE THE TEMPORARY STORAGE QUEUE.                         *07150000
071600*----------------------------------------------------------------*07160000
071700                                                                  07170000
071800 2050-DELETE-DETAIL-QUEUE.                                        07180000
071900                                                                  07190000
072000     EXEC CICS                                                    07200000
072100         DELETEQ TS                                               07210000
072200             QUEUE (ASC-DTL-QUEUE-NAME)                           07220000
072300             RESP  (PV-CICS-RESP)                                 07230000
072400     END-EXEC.                                                    07240000
072500                                                                  07250000
072600     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       07260000
072700        (PV-CICS-RESP = DFHRESP(QIDERR))                          07270000
072800         CONTINUE                                                 07280000
072900     ELSE                                                         07290000
073000         SET DP013-CICS-ABEND TO TRUE                             07300000
073100         SET DP013-NO-ROLLBACK TO TRUE                            07310000
073200                                                                  07320000
073300         MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       07330000
073400         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  07340000
073500                        TO DP013-MESSAGE-TEXT (1)                 07350000
073600         PERFORM DP013-0000-PROCESS-ABEND                         07360000
073700     END-IF.                                                      07370000
073800                                                                  07380000
073900     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        07390000
074000 EJECT                                                            07400000
074100*----------------------------------------------------------------*07410000
074200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *07420000
074300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *07430000
074400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *07440000
074500*    MESSAGE.                                                    *07450000
074600*----------------------------------------------------------------*07460000
074700                                                                  07470000
074800 2110-BROWSE-BACKWARD.                                            07480000
074900                                                                  07490000
075000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07500000
075100         GIVING PV-TOP-ITEM.                                      07510000
075200                                                                  07520000
075300     IF  PV-TOP-ITEM < +1                                         07530000
075400         MOVE +1              TO PV-TOP-ITEM                      07540000
075500*        -- TOP OF LIST --                                        07550000
075600         MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 07560000
075700         SET DP020-MSG-INFORMATIONAL TO TRUE                      07570000
075800     END-IF.                                                      07580000
075900                                                                  07590000
076000 EJECT                                                            07600000
076100                                                                  07610000
076200*----------------------------------------------------------------*07620000
076300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07630000
076400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07640000
076500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07650000
076600*----------------------------------------------------------------*07660000
076700                                                                  07670000
076800 2120-BROWSE-FORWARD.                                             07680000
076900                                                                  07690000
077000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07700000
077100         GIVING PV-TOP-ITEM.                                      07710000
077200     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07720000
077300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07730000
077400                                   TO PV-TOP-ITEM                 07740000
077500*        -- BOTTOM OF LIST --                                     07750000
077600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07760000
077700         SET DP020-MSG-INFORMATIONAL                              07770000
077800                                   TO TRUE                        07780000
077900     ELSE                                                         07790000
078000         COMPUTE PV-BOTTOM-ITEM =                                 07800000
078100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07810000
078200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07820000
078300*            -- BOTTOM OF LIST --                                 07830000
078400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07840000
078500             SET DP020-MSG-INFORMATIONAL                          07850000
078600                                   TO TRUE                        07860000
078700         END-IF                                                   07870000
078800     END-IF.                                                      07880000
078900 EJECT                                                            07890000
079000*----------------------------------------------------------------*07900000
079100*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07910000
079200*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07920000
079300*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07930000
079400*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *07940000
079500*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07950000
079600*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07960000
079700*----------------------------------------------------------------*07970000
079800                                                                  07980000
079900 2130-CHECK-FOR-JUMP-BROWSE.                                      07990000
080000                                                                  08000000
080100     IF ASTRTITL > ZERO                                           08010000
080200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      08020000
080300     ELSE                                                         08030000
080400         IF ASTRTITF = DP015-ERASE-EOF                            08040000
080500             INITIALIZE ASC-START-ITEM-REQUEST                    08050000
080600         END-IF                                                   08060000
080700     END-IF.                                                      08070000
080800                                                                  08080000
080900     SET PS-NO-ERROR               TO TRUE.                       08090000
081000     IF (ASC-START-ITEM-REQUEST = SPACE)                          08100000
081100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08110000
081200                                   TO PV-TOP-ITEM                 08120000
081300     ELSE                                                         08130000
081400         MOVE ASC-START-ITEM-REQUEST                              08140000
081500                                   TO DP010I-UNEDITED-FIELD       08150000
081600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       08160000
081700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     08170000
081800         SET DP010I-NEGATIVE-NOT-ALLOWED                          08180000
081900                                   TO TRUE                        08190000
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
082100                                                                  08210000
082200         IF  NOT DP010I-ERROR-DETECTED                            08220000
082300             MOVE DP010I-NUMERIC-FIELD                            08230000
082400                                   TO  ASC-START-ITEM-REQUEST-N   08240000
082500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  08250000
082600                 IF  ASC-START-ITEM-REQUEST-N >                   08260000
082700                                          ASC-NUMBER-OF-ITEMS-READ08270000
082800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         08280000
082900                     COMPUTE PV-TOP-ITEM =                        08290000
083000                             ASC-NUMBER-OF-ITEMS-READ             08300000
083100                             - PC-ITEMS-PER-PANEL + 1             08310000
083200                     IF  PV-TOP-ITEM < +1                         08320000
083300                         MOVE +1   TO PV-TOP-ITEM                 08330000
083400                         MOVE PC-TSYMSG-00070                     08340000
083500                                   TO DP020-MSG-NUMBER            08350000
083600                         SET DP020-MSG-INFORMATIONAL              08360000
083700                                   TO TRUE                        08370000
083800                     END-IF                                       08380000
083900                 ELSE                                             08390000
084000                     MOVE ASC-START-ITEM-REQUEST-N                08400000
084100                                   TO PV-TOP-ITEM                 08410000
084200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      08420000
084300                     COMPUTE PV-BOTTOM-ITEM =                     08430000
084400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     08440000
084500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ08450000
084600*                        -- BOTTOM OF LIST --                     08460000
084700                         MOVE PC-TSYMSG-00070                     08470000
084800                                   TO DP020-MSG-NUMBER            08480000
084900                         SET DP020-MSG-INFORMATIONAL              08490000
085000                                   TO TRUE                        08500000
085100                     END-IF                                       08510000
085200                 END-IF                                           08520000
085300             ELSE                                                 08530000
085400*                --- VALUE OUT OF RANGE ----                      08540000
085500                 MOVE PC-TSYMSG-00101                             08550000
085600                                   TO DP020-MSG-NUMBER            08560000
085700                 MOVE -1           TO ASTRTITL                    08570000
085800                 SET DP030-SET-CURSOR-APPL-1                      08580000
085900                                   TO TRUE                        08590000
086000                 MOVE DP015-REVERSE                               08600000
086100                                   TO ASTRTITH                    08610000
086200                 MOVE DP015-RED    TO ASTRTITC                    08620000
086300                 MOVE DP015-UNP-NUM-BRT-MDT                       08630000
086400                                   TO ASTRTITA                    08640000
086500                 SET DP020-MSG-FATAL                              08650000
086600                                   TO TRUE                        08660000
086700                 SET PS-ERROR      TO TRUE                        08670000
086800             END-IF                                               08680000
086900                                                                  08690000
087000         ELSE                                                     08700000
087100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08710000
087200             MOVE -1               TO ASTRTITL                    08720000
087300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08730000
087400             MOVE DP015-REVERSE    TO ASTRTITH                    08740000
087500             MOVE DP015-RED        TO ASTRTITC                    08750000
087600             MOVE DP015-UNP-NUM-BRT-MDT                           08760000
087700                                   TO ASTRTITA                    08770000
087800             SET DP020-MSG-FATAL   TO TRUE                        08780000
087900             SET PS-ERROR          TO TRUE                        08790000
088000         END-IF                                                   08800000
088100     END-IF.                                                      08810000
088200                                                                  08820000
088300*----------------------------------------------------------------*08830000
088400*    RESET THE MAP FIELD ATTRIBUTES.                             *08840000
088500*----------------------------------------------------------------*08850000
088600 3200-RESET-ATTRIBUTES.                                           08860000
088700                                                                  08870000
088800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   08880000
088900     MOVE DP015-GREEN              TO ASTRTITC.                   08890000
089000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   08900000
089100     MOVE -1                       TO ASTRTITL.                   08910000
089200     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       08920000
089300                                                                  08930000
089400*----------------------------------------------------------------*08940000
089500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *08950000
089600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *08960000
089700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *08970000
089800*    DISPLAY THE PANEL TO USER.                                  *08980000
089900*----------------------------------------------------------------*08990000
090000                                                                  09000000
090100 4000-BUILD-INITIAL-PANEL.                                        09010000
090200                                                                  09020000
090300     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            09030000
090400                                 ASC-BLOCK-ENTRIES (2).           09040000
090500     MOVE +1                 TO  ASC-BLK-SUB.                     09050000
090600     SET ASC-ITEMS-LEFT-ON-DB                                     09060000
090700                             TO  TRUE.                            09070000
090800                                                                  09080000
090900     MOVE +0                 TO  ASC-ITEM-SUB                     09090000
091000                                 ASC-NUMBER-OF-ITEMS-READ         09100000
091100                                 ASC-NUMBER-OF-SELECTED-ITEMS     09110000
091200                                 ASC-HIGHEST-BLOCK-WRITTEN        09120000
091300                                 ASC-START-OF-SELECTED-RANGE      09130000
091400                                 ASC-END-OF-SELECTED-RANGE        09140000
091500                                 ASC-ITEM-AT-TOP-OF-PANEL.        09150000
091600                                                                  09160000
091700     PERFORM 4030-SELECT-TIMRCPO.                                 09170032
091800                                                                  09180000
091900     PERFORM 4040-MOVE-TIMRCPO-TO-HOLD.                           09190032
092000                                                                  09200000
092100     PERFORM 4010-OPEN-CURSOR.                                    09210000
092200                                                                  09220000
092300     PERFORM 4300-READ-ITEMS-FROM-DB.                             09230000
092400                                                                  09240000
092500     PERFORM 4020-CLOSE-CURSOR.                                   09250000
092600                                                                  09260000
092700     MOVE +1                 TO  PV-TOP-ITEM.                     09270000
092800     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          09280000
092900         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    09290000
093000         SET DP020-MSG-FATAL   TO  TRUE                           09300000
093100*--------NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED---   09310000
093200         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               09320000
093300     ELSE                                                         09330000
093400         MOVE -1             TO ASTRTITL                          09340000
093500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      09350000
093600         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     09360000
093700     END-IF.                                                      09370000
093800 EJECT                                                            09380000
093900*----------------------------------------------------------------*09390000
094000* OPEN THE PO CURSOR.                                            *09400000
094100*----------------------------------------------------------------*09410000
094200                                                                  09420000
094300 4010-OPEN-CURSOR.                                                09430000
094400                                                                  09440000
094500     EXEC SQL                                                     09450000
094600          OPEN PO-CSR                                             09460000
094700     END-EXEC.                                                    09470000
094800                                                                  09480000
094900     EVALUATE TRUE                                                09490000
095000         WHEN SQLCODE = ZERO                                      09500000
095100              CONTINUE                                            09510000
095200         WHEN SQLWARN0 NOT EQUAL SPACE                            09520000
095300         WHEN SQLCODE NOT EQUAL ZERO                              09530000
095400              MOVE '4010-OPEN-CURSOR'                             09540000
095500                           TO  DP013-PARAGRAPH                    09550000
095600              MOVE 'OPEN PO CURSOR'                               09560000
095700                           TO  DP013-MESSAGE-TEXT (1)             09570000
095800              MOVE SQLCA   TO  DP013-SQLCA                        09580000
095900              SET DP013-DB2-ABEND                                 09590000
096000                           TO  TRUE                               09600000
096100              PERFORM DP013-0000-PROCESS-ABEND                    09610000
096200     END-EVALUATE.                                                09620000
096300                                                                  09630000
096400 EJECT                                                            09640000
096500*----------------------------------------------------------------*09650000
096600* CLOSE THE PO CURSOR.                                           *09660000
096700*----------------------------------------------------------------*09670000
096800                                                                  09680000
096900 4020-CLOSE-CURSOR.                                               09690000
097000                                                                  09700000
097100     EXEC SQL                                                     09710000
097200         CLOSE PO-CSR                                             09720000
097300     END-EXEC.                                                    09730000
097400                                                                  09740000
097500     EVALUATE TRUE                                                09750000
097600         WHEN SQLCODE = ZERO                                      09760000
097700              CONTINUE                                            09770000
097800         WHEN SQLWARN0 NOT EQUAL SPACE                            09780000
097900         WHEN SQLCODE NOT EQUAL ZERO                              09790000
098000              MOVE '4020-CLOSE-CURSOR'                            09800000
098100                           TO  DP013-PARAGRAPH                    09810000
098200              MOVE 'CLOSE PO CURSOR'                              09820000
098300                           TO  DP013-MESSAGE-TEXT (1)             09830000
098400              MOVE SQLCA   TO  DP013-SQLCA                        09840000
098500              SET DP013-DB2-ABEND                                 09850000
098600                           TO  TRUE                               09860000
098700              PERFORM DP013-0000-PROCESS-ABEND                    09870000
098800     END-EVALUATE.                                                09880000
098900                                                                  09890000
099000 EJECT                                                            09900000
099100*----------------------------------------------------------------*09910000
099200* SELECT A ROW FROM THE RECEIVING PURCHASE ORDER TABLE (TIMRCPO).*09920032
099300*----------------------------------------------------------------*09930000
099400 4030-SELECT-TIMRCPO.                                             09940032
099500                                                                  09950000
099510     MOVE SPACES TO PV-EXTL-REF-NBR.                                      
099520                                                                          
099600     PERFORM                                                      09960000
099700         WITH TEST AFTER                                          09970000
099800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09980000
099900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09990000
100000                 SQLCODE = ZERO                     OR            10000000
100100                 SQLCODE = +100                                   10010000
100200                                                                  10020000
100300         EXEC SQL                                                 10030000
100400             SELECT CONSLR_SCAC_ID                                10040000
100500                   ,IMPRT_TRIP_ID                                 10050000
100600                   ,DPRTR_TMST                                    10060000
100700                   ,POE_DELY_TMST                                 10070000
100800                   ,CARR_SCAC_ID                                  10080000
100900                   ,FOB_CDE                                       10090000
101000                   ,IMPRT_VEH_NM                                  10100000
101100                   ,TRIP_TYP_CDE                                  10110000
101200                   ,DEST_POE_CDE                                  10120000
101300                   ,C_O_PROD_CDE                                  10130000
101400                   ,PROD_FCTRY_NM                                 10140000
101500                   ,PO_CART_CNT                                   10150000
101600                   ,PO_CBMT_QTY                                   10160000
101700                   ,PO_WT_KGRM_QTY                                10170000
101800                   ,PO_UNT_QTY                                    10180000
101900                   ,PO_EXC_APVL_CDE                               10190000
102000                   ,PO_EXC_APVL_USR_ID                            10200000
102100                   ,PO_EXC_APVL_TMST                              10210000
102200                   ,PO_EXC_RSN_DESC                               10220000
102300                   ,EST_LBD_NM                                    10230000
102400                   ,EST_LBD_TMST                                  10240000
102600                   ,VOY_CHG_RSN_DESC                              10260000
102700                   ,DAT_SRC_ENT_ID                                10270000
102800                   ,LAST_UPD_BY_USR_ID                            10280000
102900                   ,LAST_UPD_TMST                                 10290000
102910                   ,EXTL_REF_NBR                                          
103000              INTO :IMRCPO-CONSLR-SCAC-ID,                        10300032
103100                   :IMRCPO-IMPRT-TRIP-ID,                         10310032
103200                   :IMRCPO-DPRTR-TMST,                            10320032
103300                   :IMRCPO-POE-DELY-TMST,                         10330032
103400                   :IMRCPO-CARR-SCAC-ID,                          10340032
103500                   :IMRCPO-FOB-CDE,                               10350032
103600                   :IMRCPO-IMPRT-VEH-NM,                          10360032
103700                   :IMRCPO-TRIP-TYP-CDE,                          10370032
103800                   :IMRCPO-DEST-POE-CDE,                          10380032
103900                   :IMRCPO-C-O-PROD-CDE,                          10390032
104000                   :IMRCPO-PROD-FCTRY-NM,                         10400032
104100                   :IMRCPO-PO-CART-CNT,                           10410032
104200                   :IMRCPO-PO-CBMT-QTY,                           10420032
104300                   :IMRCPO-PO-WT-KGRM-QTY,                        10430032
104400                   :IMRCPO-PO-UNT-QTY,                            10440032
104500                   :IMRCPO-PO-EXC-APVL-CDE,                       10450032
104600                   :IMRCPO-PO-EXC-APVL-USR-ID,                    10460032
104700                   :IMRCPO-PO-EXC-APVL-TMST,                      10470032
104800                   :IMRCPO-PO-EXC-RSN-DESC,                       10480032
104900                   :IMRCPO-EST-LBD-NM,                            10490032
105000                   :IMRCPO-EST-LBD-TMST,                          10500032
105200                   :IMRCPO-VOY-CHG-RSN-DESC,                      10520032
105300                   :IMRCPO-DAT-SRC-ENT-ID,                        10530032
105400                   :IMRCPO-LAST-UPD-BY-USR-ID,                    10540032
105500                   :IMRCPO-LAST-UPD-TMST,                         10550032
105510                   :PV-EXTL-REF-NBR                                       
105600                                                                  10560000
105700               FROM TIMRCPO                                       10570032
105800              WHERE PO_NBR           = :DK-PO-NBR                 10580000
105900                AND PO_RCVD_SEQ_NBR  = :DK-PO-SEQ-NBR             10590035
106000                AND ORGN_SHPD_FR_CDE = :DK-ORGN-SHPD-FROM-TYP     10600000
106100                AND DATE(PO_RCVD_DELY_TMST) = :DK-DELY-DTE        10610035
106200         END-EXEC                                                 10620000
106201                                                                  10620100
106202         EVALUATE TRUE                                            10620200
106203             WHEN SQLCODE = -904                                  10620300
106204             WHEN SQLCODE = -913                                  10620400
106205                 CONTINUE                                         10620500
106206             WHEN SQLCODE = ZERO                                  10620600
106207             WHEN SQLCODE = +100                                  10620700
106208                  CONTINUE                                        10620800
106209             WHEN SQLWARN0 NOT = SPACES                           10620900
106210             WHEN SQLCODE < ZERO                                  10621000
106211             WHEN SQLCODE > ZERO                                  10621100
106212                 MOVE '4030-SELECT-TIMRCPO'                       10621232
106213                                   TO DP013-PARAGRAPH             10621300
106214                 MOVE 'SQL ERROR SELECTING RECEIVING PO'          10621432
106215                                   TO DP013-MESSAGE-TEXT (1)      10621500
106216                 MOVE SQLCA        TO DP013-SQLCA                 10621600
106217                 MOVE 'TIMRCPO '   TO DP013-DB2-TABLE-NAME (1)    10621732
106218                 SET DP013-DB2-ABEND                              10621800
106219                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10621900
106220                 PERFORM DP013-0000-PROCESS-ABEND                 10622000
106221         END-EVALUATE                                             10622100
106222     END-PERFORM.                                                 10622200
106223*                                                                 10622300
106224     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10622400
106225         MOVE '4030-SELECT-TIMRCPO'                               10622532
106226                                   TO DP013-PARAGRAPH             10622600
106227         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT PO'  10622700
106228                                   TO DP013-MESSAGE-TEXT (1)      10622800
106229         MOVE SQLCA                TO DP013-SQLCA                 10622900
106230         MOVE 'TIMRCPO '           TO DP013-DB2-TABLE-NAME (1)    10623032
106231         SET DP013-DB2-ABEND                                      10623100
106232             DP013-XCTL-DISPLAY-RESTART                           10623200
106233                                   TO TRUE                        10623300
106234         PERFORM DP013-0000-PROCESS-ABEND                         10623400
106235     END-IF.                                                      10623500
106236                                                                  10623600
106237 EJECT                                                            10623700
106238*----------------------------------------------------------------*10623800
106239* MOVE SELECTED TIMRCPO VALUES TO HOLD FIELDS FOR COMPARISON.    *10623932
106240*----------------------------------------------------------------*10624000
106250 4040-MOVE-TIMRCPO-TO-HOLD.                                       10625032
106260                                                                  10626000
106270     MOVE IMRCPO-CONSLR-SCAC-ID     TO PV-PREV-CONSLR-SCAC-ID.    10627032
106280     MOVE IMRCPO-IMPRT-TRIP-ID      TO PV-PREV-IMPRT-TRIP-ID.     10628032
106290     MOVE IMRCPO-DPRTR-TMST         TO PV-PREV-DPRTR-TMST.        10629032
106300     MOVE IMRCPO-POE-DELY-TMST      TO PV-PREV-POE-DELY-TMST.     10630032
106400     MOVE IMRCPO-CARR-SCAC-ID       TO PV-PREV-CARR-SCAC-ID.      10640032
106500     MOVE IMRCPO-FOB-CDE            TO PV-PREV-FOB-CDE.           10650032
106600     MOVE IMRCPO-IMPRT-VEH-NM       TO PV-PREV-IMPRT-VEH-NM.      10660032
106700     MOVE IMRCPO-TRIP-TYP-CDE       TO PV-PREV-TRIP-TYP-CDE.      10670032
106800     MOVE IMRCPO-DEST-POE-CDE       TO PV-PREV-DEST-POE-CDE.      10680032
106900     MOVE IMRCPO-C-O-PROD-CDE       TO PV-PREV-C-O-PROD-CDE.      10690032
107000     MOVE IMRCPO-PROD-FCTRY-NM      TO PV-PREV-PROD-FCTRY-NM.     10700032
107100     MOVE IMRCPO-PO-CART-CNT        TO PV-PREV-PO-CART-CNT.       10710032
107200     MOVE IMRCPO-PO-CBMT-QTY        TO PV-PREV-PO-CBMT-QTY.       10720032
107300     MOVE IMRCPO-PO-WT-KGRM-QTY     TO PV-PREV-PO-WT-KGRM-QTY.    10730032
107400     MOVE IMRCPO-PO-UNT-QTY         TO PV-PREV-PO-UNT-QTY.        10740032
107500     MOVE IMRCPO-PO-EXC-APVL-CDE    TO PV-PREV-PO-EXC-APVL-CDE.   10750032
107600     MOVE IMRCPO-PO-EXC-APVL-USR-ID TO PV-PREV-PO-EXC-APVL-USR-ID.10760032
107700     MOVE IMRCPO-PO-EXC-APVL-TMST   TO PV-PREV-PO-EXC-APVL-TMST.  10770032
107800     MOVE IMRCPO-PO-EXC-RSN-DESC    TO PV-PREV-PO-EXC-RSN-DESC.   10780032
107900     MOVE IMRCPO-EST-LBD-NM         TO PV-PREV-EST-LBD-NM.        10790032
108000     MOVE IMRCPO-EST-LBD-TMST       TO PV-PREV-EST-LBD-TMST.      10800032
108200     MOVE IMRCPO-VOY-CHG-RSN-DESC   TO PV-PREV-VOY-CHG-RSN-DESC.  10820032
108300     MOVE IMRCPO-DAT-SRC-ENT-ID     TO PV-PREV-DAT-SRC-ENT-ID.    10830032
108400     MOVE IMRCPO-LAST-UPD-BY-USR-ID TO                            10840032
108500                                    PV-PREV-LAST-UPD-BY-USR-ID.   10850000
108600     MOVE IMRCPO-LAST-UPD-TMST      TO PV-PREV-LAST-UPD-TMST.     10860032
108700                                                                  10870000
108800*----------------------------------------------------------------*10880000
108900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *10890000
109000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *10900000
109100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *10910000
109200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *10920000
109300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *10930000
109400*                                                                *10940000
109500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *10950000
109600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *10960000
109700*    UPON INITIALIZATION.                                        *10970000
109800*----------------------------------------------------------------*10980000
109900                                                                  10990000
110000 4300-READ-ITEMS-FROM-DB.                                         11000000
110100                                                                  11010000
110200     PERFORM                                                      11020000
110300         VARYING PV-READ-COUNT                                    11030000
110400         FROM 1 BY 1                                              11040000
110500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    11050000
110600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         11060000
110700                                                                  11070000
110800         PERFORM 4310-FETCH                                       11080000
110900                                                                  11090000
111000         IF  ASC-ITEMS-LEFT-ON-DB                                 11100000
111100             PERFORM 4330-CHECK-FOR-CHANGES                       11110000
111200         END-IF                                                   11120000
111300     END-PERFORM.                                                 11130000
111400                                                                  11140000
111500     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           11150000
111600         MOVE +1                       TO  ASC-BLK-SUB            11160000
111700         PERFORM 5100-WRITE-TEMP-STORAGE                          11170000
111800         ADD +1                        TO  ASC-BLK-SUB            11180000
111900         PERFORM 5100-WRITE-TEMP-STORAGE                          11190000
112000                                                                  11200000
112100         MOVE 1                        TO  ASC-BLK-SUB            11210000
112200                                           PV-BLOCK-NUMBER        11220000
112300         PERFORM 4410-READ-TEMP-STORAGE                           11230000
112400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             11240000
112500              MOVE 2                    TO  ASC-BLK-SUB           11250000
112600                                            PV-BLOCK-NUMBER       11260000
112700              PERFORM 4410-READ-TEMP-STORAGE                      11270000
112800         END-IF                                                   11280000
112900     END-IF.                                                      11290000
113000 EJECT                                                            11300000
113100*----------------------------------------------------------------*11310000
113200*    FETCH THE PO CURSOR.                                        *11320000
113300*----------------------------------------------------------------*11330000
113400                                                                  11340000
113500 4310-FETCH.                                                      11350000
113600                                                                  11360000
113700     PERFORM                                                      11370000
113800         WITH TEST AFTER                                          11380000
113900         VARYING PV-SQL-SUB                                       11390000
114000         FROM 1 BY 1                                              11400000
114100         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             11410000
114200            OR SQLCODE = 0                                        11420000
114300            OR SQLCODE = +100                                     11430000
114400                                                                  11440000
114500         EXEC SQL                                                 11450000
114600              FETCH PO-CSR                                        11460000
114700              INTO                                                11470000
114800                   :AURCPO-CONSLR-SCAC-ID,                        11480032
114900                   :AURCPO-IMPRT-TRIP-ID,                         11490032
115000                   :AURCPO-DPRTR-TMST,                            11500032
115100                   :AURCPO-POE-DELY-TMST,                         11510032
115200                   :AURCPO-CARR-SCAC-ID,                          11520032
115300                   :AURCPO-FOB-CDE,                               11530032
115400                   :AURCPO-IMPRT-VEH-NM,                          11540032
115500                   :AURCPO-TRIP-TYP-CDE,                          11550032
115600                   :AURCPO-DEST-POE-CDE,                          11560032
115700                   :AURCPO-C-O-PROD-CDE,                          11570032
115800                   :AURCPO-PROD-FCTRY-NM,                         11580032
115900                   :AURCPO-PO-CART-CNT,                           11590032
116000                   :AURCPO-PO-CBMT-QTY,                           11600032
116100                   :AURCPO-PO-WT-KGRM-QTY,                        11610032
116200                   :AURCPO-PO-UNT-QTY,                            11620032
116300                   :AURCPO-PO-EXC-APVL-CDE,                       11630032
116400                   :AURCPO-PO-EXC-APVL-USR-ID,                    11640032
116500                   :AURCPO-PO-EXC-APVL-TMST,                      11650032
116600                   :AURCPO-PO-EXC-RSN-DESC,                       11660032
116700                   :AURCPO-EST-LBD-NM,                            11670032
116800                   :AURCPO-EST-LBD-TMST,                          11680032
117000                   :AURCPO-VOY-CHG-RSN-DESC,                      11700032
117100                   :AURCPO-DAT-SRC-ENT-ID,                        11710032
117200                   :AURCPO-LAST-UPD-BY-USR-ID,                    11720032
117300                   :AURCPO-LAST-UPD-TMST                          11730032
117400         END-EXEC                                                 11740000
117500                                                                  11750000
117600         EVALUATE TRUE                                            11760000
117700             WHEN SQLCODE = ZERO                                  11770000
117800             WHEN SQLCODE = +100                                  11780000
117900             WHEN SQLCODE = -904                                  11790000
118000             WHEN SQLCODE = -913                                  11800000
118100                  CONTINUE                                        11810000
118200             WHEN SQLWARN0 NOT EQUAL SPACE                        11820000
118300             WHEN SQLCODE NOT EQUAL ZERO                          11830000
118400                  MOVE '4310-FETCH-CURSOR'                        11840000
118500                               TO  DP013-PARAGRAPH                11850000
118600                  MOVE 'FETCH PO CURSOR'                          11860000
118700                               TO  DP013-MESSAGE-TEXT (1)         11870000
118800                  MOVE SQLCA   TO  DP013-SQLCA                    11880000
118900                  SET DP013-DB2-ABEND                             11890000
119000                               TO  TRUE                           11900000
119100                  PERFORM DP013-0000-PROCESS-ABEND                11910000
119200         END-EVALUATE                                             11920000
119300     END-PERFORM.                                                 11930000
119400                                                                  11940000
119500     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   11950000
119600         MOVE '4310-FETCH-CURSOR'                                 11960000
119700                               TO  DP013-PARAGRAPH                11970000
119800         MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             11980000
119900                               TO  DP013-MESSAGE-TEXT (1)         11990000
120000         MOVE SQLCA            TO  DP013-SQLCA                    12000000
120100         SET DP013-DB2-ABEND   TO  TRUE                           12010000
120200         PERFORM DP013-0000-PROCESS-ABEND                         12020000
120300     END-IF.                                                      12030000
120400                                                                  12040000
120500     IF  SQLCODE EQUAL +100                                       12050000
120600         SET ASC-NO-ITEMS-LEFT-ON-DB                              12060000
120700                               TO  TRUE                           12070000
120800     END-IF.                                                      12080000
120900                                                                  12090000
121000 EJECT                                                            12100000
121100*----------------------------------------------------------------*12110000
121200*    GET THE CORRECT SUBSCRIPTS FOR PLACING THE TEXT LINE.       *12120000
121300*----------------------------------------------------------------*12130000
121400                                                                  12140000
121500 4320-GET-SUB.                                                    12150000
121600                                                                  12160000
121700     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        12170000
121800         ADD +1            TO  ASC-ITEM-SUB                       12180000
121900     ELSE                                                         12190000
122000         ADD +1            TO  ASC-BLK-SUB                        12200000
122100         MOVE +1           TO  ASC-ITEM-SUB                       12210000
122200                                                                  12220000
122300         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 12230000
122400             MOVE +1       TO  ASC-BLK-SUB                        12240000
122500             PERFORM 5100-WRITE-TEMP-STORAGE                      12250000
122600             MOVE ASC-BLOCK-ENTRIES                               12260000
122700                       (PC-MAX-BLOCKS-IN-ARRAY)                   12270000
122800             TO   ASC-BLOCK-ENTRIES(ASC-BLK-SUB)                  12280000
122900             ADD +1        TO  ASC-BLK-SUB                        12290000
123000             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           12300000
123100         END-IF                                                   12310000
123200     END-IF.                                                      12320000
123300                                                                  12330000
123400     ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               12340000
123500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        12350000
123600                                      (ASC-BLK-SUB                12360000
123700                                       ASC-ITEM-SUB).             12370000
123800                                                                  12380000
123900*----------------------------------------------------------------*12390000
124000*    COMPARE THE PREVIOUS VALUES TO THE CURRENT TAURCPO VALUES   *12400032
124100*    TO SEE WHAT CHANGES OCCURRED.                               *12410000
124200*----------------------------------------------------------------*12420000
124300 4330-CHECK-FOR-CHANGES.                                          12430000
124400                                                                  12440000
124500     IF AURCPO-CONSLR-SCAC-ID  NOT EQUAL PV-PREV-CONSLR-SCAC-ID   12450032
124600         MOVE PV-PREV-CONSLR-SCAC-ID    TO PV-HOLD-AFTER-VALUE    12460000
124700         MOVE AURCPO-CONSLR-SCAC-ID     TO PV-HOLD-BEFORE-VALUE   12470032
124800         MOVE 'CONSOLIDATOR SCAC   '    TO PV-HOLD-FIELD-NAME     12480000
124900         PERFORM 4340-PROCESS-CHANGES                             12490000
125000     END-IF.                                                      12500000
125100                                                                  12510000
125200     IF AURCPO-IMPRT-TRIP-ID NOT EQUAL PV-PREV-IMPRT-TRIP-ID      12520032
125300         MOVE PV-PREV-IMPRT-TRIP-ID     TO PV-HOLD-AFTER-VALUE    12530000
125400         MOVE AURCPO-IMPRT-TRIP-ID      TO PV-HOLD-BEFORE-VALUE   12540032
125500         MOVE 'VOYAGE NUMBER       '    TO PV-HOLD-FIELD-NAME     12550000
125600         PERFORM 4340-PROCESS-CHANGES                             12560000
125700     END-IF.                                                      12570000
125800                                                                  12580000
125900     IF AURCPO-DPRTR-TMST NOT EQUAL PV-PREV-DPRTR-TMST            12590032
126000         MOVE PV-PREV-DPRTR-TMST        TO PV-HOLD-TMST-UNFORMAT  12600000
126100         PERFORM 4350-FORMAT-TMST                                 12610000
126200         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    12620000
126300         MOVE AURCPO-DPRTR-TMST         TO PV-HOLD-TMST-UNFORMAT  12630032
126400         PERFORM 4350-FORMAT-TMST                                 12640000
126500         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   12650000
126600         MOVE 'ETD                 '    TO PV-HOLD-FIELD-NAME     12660000
126700         PERFORM 4340-PROCESS-CHANGES                             12670000
126800     END-IF.                                                      12680000
126900                                                                  12690000
127000     IF AURCPO-POE-DELY-TMST NOT EQUAL PV-PREV-POE-DELY-TMST      12700032
127100         MOVE PV-PREV-POE-DELY-TMST     TO PV-HOLD-TMST-UNFORMAT  12710000
127200         PERFORM 4350-FORMAT-TMST                                 12720000
127300         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    12730000
127400         MOVE AURCPO-POE-DELY-TMST      TO PV-HOLD-TMST-UNFORMAT  12740032
127500         PERFORM 4350-FORMAT-TMST                                 12750000
127600         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   12760000
127700         MOVE 'ETA                 '    TO PV-HOLD-FIELD-NAME     12770000
127800         PERFORM 4340-PROCESS-CHANGES                             12780000
127900     END-IF.                                                      12790000
128000                                                                  12800000
128100     IF AURCPO-CARR-SCAC-ID NOT EQUAL PV-PREV-CARR-SCAC-ID        12810032
128200         MOVE PV-PREV-CARR-SCAC-ID      TO PV-HOLD-AFTER-VALUE    12820000
128300         MOVE AURCPO-CARR-SCAC-ID       TO PV-HOLD-BEFORE-VALUE   12830032
128400         MOVE 'CARRIER SCAC        '    TO PV-HOLD-FIELD-NAME     12840000
128500         PERFORM 4340-PROCESS-CHANGES                             12850000
128600     END-IF.                                                      12860000
128700                                                                  12870000
128800     IF AURCPO-FOB-CDE NOT EQUAL PV-PREV-FOB-CDE                  12880032
128900         MOVE PV-PREV-FOB-CDE           TO PV-HOLD-AFTER-VALUE    12890000
129000         MOVE AURCPO-FOB-CDE            TO PV-HOLD-BEFORE-VALUE   12900032
129100         MOVE 'FOB                 '    TO PV-HOLD-FIELD-NAME     12910000
129200         PERFORM 4340-PROCESS-CHANGES                             12920000
129300     END-IF.                                                      12930000
129400                                                                  12940000
129500     IF AURCPO-IMPRT-VEH-NM NOT EQUAL PV-PREV-IMPRT-VEH-NM        12950032
129600         MOVE PV-PREV-IMPRT-VEH-NM      TO PV-HOLD-AFTER-VALUE    12960000
129700         MOVE AURCPO-IMPRT-VEH-NM       TO PV-HOLD-BEFORE-VALUE   12970032
129800         MOVE 'VESSEL NAME         '    TO PV-HOLD-FIELD-NAME     12980000
129900         PERFORM 4340-PROCESS-CHANGES                             12990000
130000     END-IF.                                                      13000000
130100                                                                  13010000
130200     IF AURCPO-TRIP-TYP-CDE NOT EQUAL PV-PREV-TRIP-TYP-CDE        13020032
130300         MOVE PV-PREV-TRIP-TYP-CDE      TO PV-HOLD-AFTER-VALUE    13030000
130400         MOVE AURCPO-TRIP-TYP-CDE       TO PV-HOLD-BEFORE-VALUE   13040032
130500         MOVE 'TRIP TYPE           '    TO PV-HOLD-FIELD-NAME     13050000
130600         PERFORM 4340-PROCESS-CHANGES                             13060000
130700     END-IF.                                                      13070000
130800                                                                  13080000
130900     IF AURCPO-DEST-POE-CDE NOT EQUAL PV-PREV-DEST-POE-CDE        13090032
131000         MOVE PV-PREV-DEST-POE-CDE      TO PV-HOLD-AFTER-VALUE    13100000
131100         MOVE AURCPO-DEST-POE-CDE       TO PV-HOLD-BEFORE-VALUE   13110032
131200         MOVE 'POE CDE             '    TO PV-HOLD-FIELD-NAME     13120000
131300         PERFORM 4340-PROCESS-CHANGES                             13130000
131400     END-IF.                                                      13140000
131500                                                                  13150000
131600     IF AURCPO-C-O-PROD-CDE NOT EQUAL PV-PREV-C-O-PROD-CDE        13160032
131700         MOVE PV-PREV-C-O-PROD-CDE      TO PV-HOLD-AFTER-VALUE    13170000
131800         MOVE AURCPO-C-O-PROD-CDE       TO PV-HOLD-BEFORE-VALUE   13180032
131900         MOVE 'COUNTRY OF PROD CDE '    TO PV-HOLD-FIELD-NAME     13190000
132000         PERFORM 4340-PROCESS-CHANGES                             13200000
132100     END-IF.                                                      13210000
132200                                                                  13220000
132300     IF AURCPO-PROD-FCTRY-NM NOT EQUAL PV-PREV-PROD-FCTRY-NM      13230032
132400         MOVE PV-PREV-PROD-FCTRY-NM     TO PV-HOLD-AFTER-VALUE    13240000
132500         MOVE AURCPO-PROD-FCTRY-NM      TO PV-HOLD-BEFORE-VALUE   13250032
132600         MOVE 'FACTORY NM          '    TO PV-HOLD-FIELD-NAME     13260000
132700         PERFORM 4340-PROCESS-CHANGES                             13270000
132800     END-IF.                                                      13280000
132900                                                                  13290000
133000     IF AURCPO-PO-CART-CNT NOT EQUAL PV-PREV-PO-CART-CNT          13300032
133100         MOVE PV-PREV-PO-CART-CNT       TO PV-HOLD-AFTER-VALUE-N  13310000
133200         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    13320000
133300         MOVE AURCPO-PO-CART-CNT        TO PV-HOLD-BEFORE-VALUE-N 13330032
133400         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   13340000
133500         MOVE 'CTN                 '    TO PV-HOLD-FIELD-NAME     13350000
133600         PERFORM 4340-PROCESS-CHANGES                             13360000
133700     END-IF.                                                      13370000
133800                                                                  13380000
133900     IF AURCPO-PO-CBMT-QTY NOT EQUAL PV-PREV-PO-CBMT-QTY          13390032
134000         MOVE PV-PREV-PO-CBMT-QTY       TO PV-HOLD-AFTER-VALUE-V  13400000
134100         MOVE PV-HOLD-AFTER-VALUE-V     TO PV-HOLD-AFTER-VALUE    13410000
134200         MOVE AURCPO-PO-CBMT-QTY        TO PV-HOLD-BEFORE-VALUE-V 13420032
134300         MOVE PV-HOLD-BEFORE-VALUE-V    TO PV-HOLD-BEFORE-VALUE   13430000
134400         MOVE 'CBM                 '    TO PV-HOLD-FIELD-NAME     13440000
134500         PERFORM 4340-PROCESS-CHANGES                             13450000
134600     END-IF.                                                      13460000
134700                                                                  13470000
134800     IF AURCPO-PO-WT-KGRM-QTY NOT EQUAL PV-PREV-PO-WT-KGRM-QTY    13480032
134900         MOVE PV-PREV-PO-WT-KGRM-QTY    TO PV-HOLD-AFTER-VALUE-N  13490000
135000         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    13500000
135100         MOVE AURCPO-PO-WT-KGRM-QTY     TO PV-HOLD-BEFORE-VALUE-N 13510032
135200         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   13520000
135300         MOVE 'KGS                 '    TO PV-HOLD-FIELD-NAME     13530000
135400         PERFORM 4340-PROCESS-CHANGES                             13540000
135500     END-IF.                                                      13550000
135600                                                                  13560000
135700     IF AURCPO-PO-UNT-QTY     NOT EQUAL PV-PREV-PO-UNT-QTY        13570032
135800         MOVE PV-PREV-PO-UNT-QTY        TO PV-HOLD-AFTER-VALUE-N  13580000
135900         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    13590000
136000         MOVE AURCPO-PO-UNT-QTY         TO PV-HOLD-BEFORE-VALUE-N 13600032
136100         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   13610000
136200         MOVE 'UNITS               '    TO PV-HOLD-FIELD-NAME     13620000
136300         PERFORM 4340-PROCESS-CHANGES                             13630000
136400     END-IF.                                                      13640000
136500                                                                  13650000
136600     IF AURCPO-PO-EXC-APVL-CDE NOT EQUAL PV-PREV-PO-EXC-APVL-CDE  13660032
136700         MOVE PV-PREV-PO-EXC-APVL-CDE   TO PV-HOLD-AFTER-VALUE    13670000
136800         MOVE AURCPO-PO-EXC-APVL-CDE    TO PV-HOLD-BEFORE-VALUE   13680032
136900         MOVE 'APPROVAL CDE        '    TO PV-HOLD-FIELD-NAME     13690000
137000         PERFORM 4340-PROCESS-CHANGES                             13700000
137100     END-IF.                                                      13710000
137200                                                                  13720000
137300     IF AURCPO-PO-EXC-APVL-USR-ID NOT EQUAL                       13730032
137400                                      PV-PREV-PO-EXC-APVL-USR-ID  13740000
137500         MOVE PV-PREV-PO-EXC-APVL-USR-ID TO PV-HOLD-AFTER-VALUE   13750000
137600         MOVE AURCPO-PO-EXC-APVL-USR-ID  TO PV-HOLD-BEFORE-VALUE  13760032
137700         MOVE 'APPROVAL USERID     '     TO PV-HOLD-FIELD-NAME    13770000
137800         PERFORM 4340-PROCESS-CHANGES                             13780000
137900     END-IF.                                                      13790000
138000                                                                  13800000
138100     IF AURCPO-PO-EXC-APVL-TMST NOT EQUAL PV-PREV-PO-EXC-APVL-TMST13810032
138200         MOVE PV-PREV-PO-EXC-APVL-TMST  TO PV-HOLD-TMST-UNFORMAT  13820000
138300         PERFORM 4350-FORMAT-TMST                                 13830000
138400         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    13840000
138500         MOVE AURCPO-PO-EXC-APVL-TMST   TO PV-HOLD-TMST-UNFORMAT  13850032
138600         PERFORM 4350-FORMAT-TMST                                 13860000
138700         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   13870000
138800         MOVE 'APPROVAL DT         '    TO PV-HOLD-FIELD-NAME     13880000
138900         PERFORM 4340-PROCESS-CHANGES                             13890000
139000     END-IF.                                                      13900000
139100                                                                  13910000
139200     IF AURCPO-PO-EXC-RSN-DESC NOT EQUAL PV-PREV-PO-EXC-RSN-DESC  13920032
139300         MOVE PV-PREV-PO-EXC-RSN-DESC   TO PV-HOLD-AFTER-VALUE    13930000
139400         MOVE AURCPO-PO-EXC-RSN-DESC    TO PV-HOLD-BEFORE-VALUE   13940032
139500         MOVE 'APPROVAL REASON     '    TO PV-HOLD-FIELD-NAME     13950000
139600         PERFORM 4340-PROCESS-CHANGES                             13960000
139700     END-IF.                                                      13970000
139800                                                                  13980000
139900     IF AURCPO-EST-LBD-NM NOT EQUAL PV-PREV-EST-LBD-NM            13990032
140000         MOVE PV-PREV-EST-LBD-NM        TO PV-HOLD-AFTER-VALUE    14000000
140100         MOVE AURCPO-EST-LBD-NM         TO PV-HOLD-BEFORE-VALUE   14010032
140200         MOVE 'EST LBD NM          '    TO PV-HOLD-FIELD-NAME     14020000
140300         PERFORM 4340-PROCESS-CHANGES                             14030000
140400     END-IF.                                                      14040000
140500                                                                  14050000
140600     IF AURCPO-EST-LBD-TMST NOT EQUAL PV-PREV-EST-LBD-TMST        14060032
140700         MOVE PV-PREV-EST-LBD-TMST      TO PV-HOLD-TMST-UNFORMAT  14070000
140800         PERFORM 4350-FORMAT-TMST                                 14080000
140900         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    14090000
141000         MOVE AURCPO-EST-LBD-TMST       TO PV-HOLD-TMST-UNFORMAT  14100032
141100         PERFORM 4350-FORMAT-TMST                                 14110000
141200         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   14120000
141300         MOVE 'EST LBD DT          '    TO PV-HOLD-FIELD-NAME     14130000
141400         PERFORM 4340-PROCESS-CHANGES                             14140000
141500     END-IF.                                                      14150000
141600                                                                  14160000
142800     IF AURCPO-VOY-CHG-RSN-DESC NOT EQUAL PV-PREV-VOY-CHG-RSN-DESC14280032
142900         MOVE PV-PREV-VOY-CHG-RSN-DESC  TO PV-HOLD-AFTER-VALUE    14290000
143000         MOVE AURCPO-VOY-CHG-RSN-DESC   TO PV-HOLD-BEFORE-VALUE   14300032
143100         MOVE 'REASON NEW VOYAGE   '    TO PV-HOLD-FIELD-NAME     14310000
143200         PERFORM 4340-PROCESS-CHANGES                             14320000
143300     END-IF.                                                      14330000
143400                                                                  14340000
143500     IF AURCPO-DAT-SRC-ENT-ID NOT EQUAL PV-PREV-DAT-SRC-ENT-ID    14350032
143600         MOVE PV-PREV-DAT-SRC-ENT-ID    TO PV-HOLD-AFTER-VALUE-N  14360000
143700         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    14370000
143800         MOVE AURCPO-DAT-SRC-ENT-ID     TO PV-HOLD-BEFORE-VALUE-N 14380032
143900         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   14390000
144000         MOVE 'DATA SOURCE         '    TO PV-HOLD-FIELD-NAME     14400000
144100         PERFORM 4340-PROCESS-CHANGES                             14410000
144200     END-IF.                                                      14420000
144300                                                                  14430000
144400     PERFORM 4345-MOVE-TAURCPO-TO-HOLD.                           14440032
144500                                                                  14450000
144600*----------------------------------------------------------------*14460000
144700*    FORMAT DATE AND TIME FROM LAST UPDATED TIMESTAMP.           *14470000
144800*----------------------------------------------------------------*14480000
144900 4335-FORMAT-LAST-UPD-TMST.                                       14490000
145000                                                                  14500000
145100     IF PV-PREV-LAST-UPD-TMST(1:10) EQUAL PC-INIT-DATE            14510000
145200         MOVE SPACES                      TO PV-FORMAT-DATE       14520000
145300     ELSE                                                         14530000
145400         MOVE PV-PREV-LAST-UPD-TMST(9:2)  TO PV-FORMAT-DD         14540000
145500         MOVE PV-PREV-LAST-UPD-TMST(6:2)  TO PV-FORMAT-MM         14550000
145600         MOVE PV-PREV-LAST-UPD-TMST(3:2)  TO PV-FORMAT-YY         14560000
145700         MOVE PC-SLASH                    TO PV-FORMAT-SLASH1     14570000
145800                                             PV-FORMAT-SLASH2     14580000
145900     END-IF.                                                      14590000
146000                                                                  14600000
146100     IF PV-PREV-LAST-UPD-TMST(12:5) EQUAL PC-INIT-TIME            14610000
146200         MOVE SPACES                      TO PV-FORMAT-TIME       14620000
146300     ELSE                                                         14630000
146400         MOVE PV-PREV-LAST-UPD-TMST(12:2) TO PV-FORMAT-HOUR       14640000
146500         MOVE PV-PREV-LAST-UPD-TMST(15:2) TO PV-FORMAT-MIN        14650000
146600         MOVE PC-COLON                    TO PV-FORMAT-COLON      14660000
146700     END-IF.                                                      14670000
146800                                                                  14680000
146900*----------------------------------------------------------------*14690000
147000*    PROCESS THE CHANGES THAT WERE FOUND FOR THE AUDIT ROW.      *14700000
147100*----------------------------------------------------------------*14710000
147200 4340-PROCESS-CHANGES.                                            14720000
147300                                                                  14730000
147400     PERFORM 4320-GET-SUB.                                        14740000
147500                                                                  14750000
147600     MOVE PV-HOLD-FIELD-NAME   TO ASC-DATA                        14760000
147700                                 (ASC-BLK-SUB ASC-ITEM-SUB).      14770000
147800     MOVE PV-PREV-LAST-UPD-BY-USR-ID TO                           14780000
147900                                  ASC-USERID                      14790000
148000                                 (ASC-BLK-SUB ASC-ITEM-SUB).      14800000
148100     PERFORM 4335-FORMAT-LAST-UPD-TMST.                           14810000
148200     MOVE PV-FORMAT-DATE       TO ASC-DATE                        14820000
148300                                 (ASC-BLK-SUB ASC-ITEM-SUB).      14830000
148400     MOVE PV-FORMAT-TIME       TO ASC-TIME                        14840000
148500                                 (ASC-BLK-SUB ASC-ITEM-SUB).      14850000
148600                                                                  14860000
148700     IF PV-HOLD-AFTER-VALUE = SPACES                              14870000
148800         MOVE 'NO DATA'            TO ASC-VALUE                   14880000
148900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   14890000
149000     ELSE                                                         14900000
149100         MOVE PV-HOLD-AFTER-VALUE TO ASC-VALUE                    14910000
149200                                    (ASC-BLK-SUB ASC-ITEM-SUB)    14920000
149300     END-IF.                                                      14930000
149400                                                                  14940000
149500     PERFORM 4320-GET-SUB.                                        14950000
149600                                                                  14960000
149700     MOVE SPACES               TO ASC-DATA                        14970000
149800                                 (ASC-BLK-SUB ASC-ITEM-SUB)       14980000
149900                                  ASC-USERID                      14990000
150000                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15000000
150100                                  ASC-DATE                        15010000
150200                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15020000
150300                                  ASC-TIME                        15030000
150400                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15040000
150500                                                                  15050000
150600     IF PV-HOLD-BEFORE-VALUE = SPACES                             15060000
150700         MOVE 'NO DATA'            TO ASC-VALUE                   15070000
150800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15080000
150900     ELSE                                                         15090000
151000         MOVE PV-HOLD-BEFORE-VALUE  TO ASC-VALUE                  15100000
151100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15110000
151200     END-IF.                                                      15120000
151300                                                                  15130000
151400*----------------------------------------------------------------*15140000
151500* MOVE TAURCPO VALUES TO HOLD FIELDS FOR COMPARISON.             *15150032
151600*----------------------------------------------------------------*15160000
151700 4345-MOVE-TAURCPO-TO-HOLD.                                       15170032
151800                                                                  15180000
151900     MOVE AURCPO-CONSLR-SCAC-ID     TO PV-PREV-CONSLR-SCAC-ID.    15190032
152000     MOVE AURCPO-IMPRT-TRIP-ID      TO PV-PREV-IMPRT-TRIP-ID.     15200032
152100     MOVE AURCPO-DPRTR-TMST         TO PV-PREV-DPRTR-TMST.        15210032
152200     MOVE AURCPO-POE-DELY-TMST      TO PV-PREV-POE-DELY-TMST.     15220032
152300     MOVE AURCPO-CARR-SCAC-ID       TO PV-PREV-CARR-SCAC-ID.      15230032
152400     MOVE AURCPO-FOB-CDE            TO PV-PREV-FOB-CDE.           15240032
152500     MOVE AURCPO-IMPRT-VEH-NM       TO PV-PREV-IMPRT-VEH-NM.      15250032
152600     MOVE AURCPO-TRIP-TYP-CDE       TO PV-PREV-TRIP-TYP-CDE.      15260032
152700     MOVE AURCPO-DEST-POE-CDE       TO PV-PREV-DEST-POE-CDE.      15270032
152800     MOVE AURCPO-C-O-PROD-CDE       TO PV-PREV-C-O-PROD-CDE.      15280032
152900     MOVE AURCPO-PROD-FCTRY-NM      TO PV-PREV-PROD-FCTRY-NM.     15290032
153000     MOVE AURCPO-PO-CART-CNT        TO PV-PREV-PO-CART-CNT.       15300032
153100     MOVE AURCPO-PO-CBMT-QTY        TO PV-PREV-PO-CBMT-QTY.       15310032
153200     MOVE AURCPO-PO-WT-KGRM-QTY     TO PV-PREV-PO-WT-KGRM-QTY.    15320032
153300     MOVE AURCPO-PO-UNT-QTY         TO PV-PREV-PO-UNT-QTY.        15330032
153400     MOVE AURCPO-PO-EXC-APVL-CDE    TO PV-PREV-PO-EXC-APVL-CDE.   15340032
153500     MOVE AURCPO-PO-EXC-APVL-USR-ID TO PV-PREV-PO-EXC-APVL-USR-ID.15350032
153600     MOVE AURCPO-PO-EXC-APVL-TMST   TO PV-PREV-PO-EXC-APVL-TMST.  15360032
153700     MOVE AURCPO-PO-EXC-RSN-DESC    TO PV-PREV-PO-EXC-RSN-DESC.   15370032
153800     MOVE AURCPO-EST-LBD-NM         TO PV-PREV-EST-LBD-NM.        15380032
153900     MOVE AURCPO-EST-LBD-TMST       TO PV-PREV-EST-LBD-TMST.      15390032
154100     MOVE AURCPO-VOY-CHG-RSN-DESC   TO PV-PREV-VOY-CHG-RSN-DESC.  15410032
154200     MOVE AURCPO-DAT-SRC-ENT-ID     TO PV-PREV-DAT-SRC-ENT-ID.    15420032
154300     MOVE AURCPO-LAST-UPD-BY-USR-ID TO                            15430032
154400                                    PV-PREV-LAST-UPD-BY-USR-ID.   15440000
154500     MOVE AURCPO-LAST-UPD-TMST      TO PV-PREV-LAST-UPD-TMST.     15450032
154600                                                                  15460000
154700*----------------------------------------------------------------*15470000
154800*    FORMAT TIMESTAMPS                                           *15480000
154900*----------------------------------------------------------------*15490000
155000 4350-FORMAT-TMST.                                                15500000
155100                                                                  15510000
155200     IF PV-HOLD-TMST-UNFORMAT(1:10) EQUAL PC-INIT-DATE            15520000
155300         MOVE SPACES                      TO PV-TMST-DATE         15530000
155400     ELSE                                                         15540000
155500         MOVE PV-HOLD-TMST-UNFORMAT(9:2)  TO PV-TMST-DD           15550000
155600         MOVE PV-HOLD-TMST-UNFORMAT(6:2)  TO PV-TMST-MM           15560000
155700         MOVE PV-HOLD-TMST-UNFORMAT(1:4)  TO PV-TMST-CCYY         15570000
155800         MOVE PC-SLASH                    TO PV-TMST-SLASH1       15580000
155900                                             PV-TMST-SLASH2       15590000
156000     END-IF.                                                      15600000
156100                                                                  15610000
156200     IF PV-HOLD-TMST-UNFORMAT(12:5) EQUAL PC-INIT-TIME            15620000
156300         MOVE SPACES                      TO PV-TMST-TIME         15630000
156400     ELSE                                                         15640000
156500         MOVE PV-HOLD-TMST-UNFORMAT(12:2) TO PV-TMST-HOUR         15650000
156600         MOVE PV-HOLD-TMST-UNFORMAT(15:2) TO PV-TMST-MIN          15660000
156700         MOVE PC-COLON                    TO PV-TMST-COLON        15670000
156800     END-IF.                                                      15680000
156900                                                                  15690000
157000*----------------------------------------------------------------*15700000
157100*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *15710000
157200*----------------------------------------------------------------*15720000
157300 4400-MOVE-COMMAREA-TO-SCREEN.                                    15730000
157400                                                                  15740000
157500     MOVE ASC-KEY-PO-NBR             TO APONBRO.                  15750000
157600     MOVE ASC-KEY-ORGN-SHPD-FROM-TYP TO AORGNSHO.                 15760000
157610     MOVE PV-EXTL-REF-NBR            TO AREFNBRO.                         
157700                                                                  15770000
157800     STRING  ASC-KEY-DELY-DTE (6:2) '/'                           15780000
157900             ASC-KEY-DELY-DTE (9:2) '/'                           15790000
158000             ASC-KEY-DELY-DTE (3:2)                               15800032
158100               DELIMITED BY SIZE                                  15810000
158200                  INTO ARCVGDTO                                   15820032
158300                                                                  15830000
158400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             15840000
158500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          15850000
158600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          15860000
158700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             15870000
158800                 GIVING PV-BLOCK-NUMBER                           15880000
158900                 REMAINDER PV-REMAINDER                           15890000
159000             IF  PV-REMAINDER > ZERO                              15900000
159100                 ADD +1 TO PV-BLOCK-NUMBER                        15910000
159200             END-IF                                               15920000
159300             MOVE +1    TO ASC-BLK-SUB                            15930000
159400             PERFORM 4410-READ-TEMP-STORAGE                       15940000
159500             ADD +1     TO ASC-BLK-SUB                            15950000
159600                           PV-BLOCK-NUMBER                        15960000
159700             PERFORM 4410-READ-TEMP-STORAGE                       15970000
159800     END-IF.                                                      15980000
159900     MOVE +1                       TO ASC-BLK-SUB.                15990000
160000     COMPUTE ASC-ITEM-SUB =                                       16000000
160100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              16010000
160200         + PC-ITEMS-PER-PANEL).                                   16020000
160300                                                                  16030000
160400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16040000
160500         ADD +1   TO ASC-BLK-SUB                                  16050000
160600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16060000
160700     END-IF.                                                      16070000
160800                                                                  16080000
160900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           16090000
161000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                16100000
161100     PERFORM 4420-FORMAT-LIST-LINES                               16110000
161200         VARYING PS-SUB                                           16120000
161300         FROM PC-ITEMS-PER-PANEL BY -1                            16130000
161400         UNTIL PS-SUB < +1.                                       16140000
161500                                                                  16150000
161600     COMPUTE ASC-ITEMS-DISPLAYED =                                16160000
161700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          16170000
161800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    16180000
161900                                      ASTRTITO.                   16190000
162000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    16200000
162100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    16210000
162200                                                                  16220000
162300     IF  DP020-MSG-NUMBER-X = SPACE                               16230000
162400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  16240000
162500*            --- MORE ITEMS TO DISPLAY ----                       16250000
162600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            16260000
162700             SET DP020-MSG-INFORMATIONAL TO TRUE                  16270000
162800         END-IF                                                   16280000
162900     END-IF.                                                      16290000
163000                                                                  16300000
163100*----------------------------------------------------------------*16310000
163200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *16320000
163300*----------------------------------------------------------------*16330000
163400                                                                  16340000
163500 4410-READ-TEMP-STORAGE.                                          16350000
163600                                                                  16360000
163700     EXEC CICS                                                    16370000
163800         READQ TS                                                 16380000
163900             QUEUE (ASC-DTL-QUEUE-NAME)                           16390000
164000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               16400000
164100             ITEM  (PV-BLOCK-NUMBER)                              16410000
164200             RESP  (PV-CICS-RESP)                                 16420000
164300     END-EXEC.                                                    16430000
164400                                                                  16440000
164500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       16450000
164600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     16460000
164700         CONTINUE                                                 16470000
164800     ELSE                                                         16480000
164900         SET DP013-CICS-ABEND TO  TRUE                            16490000
165000         SET DP013-NO-ROLLBACK TO  TRUE                           16500000
165100         MOVE '4410-READ-TEMP-STORAGE'                            16510000
165200                               TO  DP013-PARAGRAPH                16520000
165300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      16530000
165400                               TO  DP013-MESSAGE-TEXT(1)          16540000
165500         PERFORM DP013-0000-PROCESS-ABEND                         16550000
165600     END-IF.                                                      16560000
165700                                                                  16570000
165800*    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             16580000
165900                                                                  16590000
166000     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         16600000
166100         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               16610000
166200     END-IF.                                                      16620000
166300 EJECT                                                            16630000
166400*----------------------------------------------------------------*16640000
166500*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *16650000
166600*----------------------------------------------------------------*16660000
166700                                                                  16670000
166800 4420-FORMAT-LIST-LINES.                                          16680000
166900                                                                  16690000
167000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      16700000
167100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                16710000
167200         MOVE SPACES            TO MR-DATA   (PS-SUB)             16720000
167300                                   MR-USERID (PS-SUB)             16730000
167400                                   MR-DATE   (PS-SUB)             16740000
167500                                   MR-TIME   (PS-SUB)             16750000
167600                                   MR-VALUE  (PS-SUB)             16760000
167700     ELSE                                                         16770000
167800         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           16780000
167900             MOVE ASC-DATA      (ASC-BLK-SUB ASC-ITEM-SUB)        16790000
168000                                TO MR-DATA (PS-SUB)               16800000
168100             MOVE ASC-USERID    (ASC-BLK-SUB ASC-ITEM-SUB)        16810000
168200                                TO MR-USERID (PS-SUB)             16820000
168300             MOVE ASC-DATE      (ASC-BLK-SUB ASC-ITEM-SUB)        16830000
168400                                TO MR-DATE (PS-SUB)               16840000
168500             MOVE ASC-TIME      (ASC-BLK-SUB ASC-ITEM-SUB)        16850000
168600                                TO MR-TIME (PS-SUB)               16860000
168700             MOVE ASC-VALUE     (ASC-BLK-SUB ASC-ITEM-SUB)        16870000
168800                                TO MR-VALUE (PS-SUB)              16880000
168900         END-IF                                                   16890000
169000     END-IF.                                                      16900000
169100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               16910000
169200     IF  ASC-ITEM-SUB < + 1                                       16920000
169300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  16930000
169400         MOVE +1                 TO ASC-BLK-SUB                   16940000
169500     END-IF.                                                      16950000
169600                                                                  16960000
169700*----------------------------------------------------------------*16970000
169800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *16980000
169900*----------------------------------------------------------------*16990000
170000                                                                  17000000
170100 5100-WRITE-TEMP-STORAGE.                                         17010000
170200                                                                  17020000
170300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     17030000
170400                               TO  PV-LIST-ITEM-NUMBER.           17040000
170500     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           17050000
170600         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           17060000
170700                                                                  17070000
170800     EXEC CICS                                                    17080000
170900         WRITEQ TS                                                17090000
171000             QUEUE (ASC-DTL-QUEUE-NAME)                           17100000
171100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               17110000
171200             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     17120000
171300             RESP  (PV-CICS-RESP)                                 17130000
171400     END-EXEC.                                                    17140000
171500                                                                  17150000
171600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      17160000
171700         SET DP013-CICS-ABEND                                     17170000
171800                       TO  TRUE                                   17180000
171900         SET DP013-NO-ROLLBACK                                    17190000
172000                       TO  TRUE                                   17200000
172100         MOVE '5100-WRITE-TEMP-STORAGE'                           17210000
172200                       TO  DP013-PARAGRAPH                        17220000
172300         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       17230000
172400                       TO  DP013-MESSAGE-TEXT(1)                  17240000
172500         PERFORM DP013-0000-PROCESS-ABEND                         17250000
172600     END-IF.                                                      17260000
172700     ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             17270000
172800                                                                  17280000
172900 EJECT                                                            17290000
173000*----------------------------------------------------------------*17300000
173100*    ABEND PROCESSOR MODULE                                      *17310000
173200*----------------------------------------------------------------*17320000
173300                                                                  17330000
173400     COPY DPPD013.                                                17340000
