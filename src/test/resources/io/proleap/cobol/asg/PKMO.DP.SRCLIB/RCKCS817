000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS817.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  04-11-2003.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E817 - VERIFY RECEIVER BY PACK                             * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF ALL THE PACKS THAT ARE    * 00130000
001400*    ASSOCIATED TO A RECEIVER.  BY SELECTING ANY OF THESE       * 00140000
001500*    PACKS, THEY CAN BE 'VERIFIED' OR 'UNVERIFIED'              * 00150000
001600*                                                               * 00160000
001610*---------------------------------------------------------------* 00161002
001620* CHANGE HISTORY                                                * 00162003
001630*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              * 00163002
001640*     DATE:    11/14/2014                                       * 00164002
001650*      RECOMPILE THE PROGRAM AS THE PO NUMBER FIELD IN THE      * 00165002
001660*      COPYBOOK TMWS001 IS INCREASED TO 9 FROM 7.               * 00166002
001700*---------------------------------------------------------------* 00170000
001710* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00171004
001720* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00172005
001730* MAKING THE CALL DYNAMIC VS STATIC.                              00173005
001740*---------------------------------------------------------------* 00174005
001800 EJECT                                                            00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000                                                                  00200000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500 01  DK-DB2-KEYS.                                                 00250000
002600     05  DK-OPER-UNT-ID                  PIC S9(04)  COMP SYNC.   00260000
002700     05  DK-FCLTY-ID                     PIC S9(04)  COMP SYNC.   00270000
002800     05  DK-PO-NBR                       PIC S9(09)  COMP SYNC.   00280000
002900     05  DK-REC-SEQ-NBR                  PIC S9(09)  COMP SYNC.   00290000
003000     05  DK-PO-DRIVER-LNE                PIC S9(09)  COMP SYNC.   00300000
003100     05  DK-HOLD-LNE-NBR                 PIC S9(09)  COMP SYNC.   00310000
003200     05  DK-PREPK-ID                     PIC S9(04)  COMP SYNC.   00320000
003300                                                                  00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-FKEY-MODULE               PIC X(08) VALUE 'RCKUT126'. 00350000
003600     05  PC-FKEY-MODULE-LENGTH        PIC S9(04) VALUE  +400      00360000
003700                                                    COMP SYNC.    00370000
003800     05  PC-TMKCS520                  PIC X(08) VALUE 'TMKCS520'. 00380000
003900     05  PC-FA-HANDLER-PGM              PIC  X(08)  VALUE         00390000
004000                                                    'SUKUT705'.   00400000
004100     05  PC-RCKUT124                    PIC  X(08)  VALUE         00410000
004200                                                    'RCKUT124'.   00420000
004300     05  PC-AUDIT-RTN                   PIC  X(08)  VALUE         00430000
004400                                                    'RCKCS290'.   00440000
004500     05  PC-AUDIT-RTN-LENGTH            PIC S9(04)  VALUE  +300   00450000
004600                                                    COMP SYNC.    00460000
004700     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00470000
004800                                                    'RC817A  '.   00480000
004900     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00490000
005000                                                    'RCKM817 '.   00500000
005100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00510000
005200                                                    'RCKCS817'.   00520000
005300     05  PC-VRFY-AT-0-PROG-NAME         PIC  X(08)  VALUE         00530000
005400                                                    'RCK220V0'.   00540000
005500     05  PC-UNTS-WRKD-PGRM-NAME       PIC  X(08) VALUE 'PCKCS756'.00550000
005600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00560000
005700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00570000
005800     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00580000
005900     05  PC-INTER-APPL-LIST             PIC  X(01)  VALUE '2'.    00590000
006000     05  PC-POST-VERFY-CRIT-SPEC-FMT    PIC  X(01)  VALUE '3'.    00600000
006100     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +8      00610000
006200                                                    COMP SYNC.    00620000
006300     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00630000
006400                                                    COMP SYNC.    00640000
006500     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00650000
006600                                                    +1000000      00660000
006700                                                    COMP-3.       00670000
006800     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00680000
006900                                                    COMP SYNC.    00690000
007000     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00700000
007100                                                    COMP-3.       00710000
007200     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00720000
007300     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00730000
007400     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00740000
007500     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00750000
007600     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00760000
007700     05  PC-DB2-NINES-DATE              PIC X(26)   VALUE         00770000
007800         '9999-09-09-09.09.09.999999'.                            00780000
007900     05  PC-FS-TIMESTAMP                PIC  X(26)  VALUE         00790000
008000         '9999-09-09-09.09.09.999999'.                            00800000
008100*    05  PC-VERIFIED-MESSAGE    PIC  X(55)  VALUE                 00810000
008200*        'NNNNN-E-SOME OR ALL SELECTED LINES PREVIOUSLY VERIFIED'.00820000
008300*                                                                 00830000
008400     05  PC-TSYMSG-NUMBERS.                                       00840000
008500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00850000
008600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00860000
008700         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  00870000
008800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00880000
008900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00890000
009000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00900000
009100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00910000
009200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00920000
009300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00930000
009400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00940000
009500         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  00950000
009600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00960000
009700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00970000
009800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00980000
009900         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00990000
010000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01000000
010100         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01010000
010200         10  PC-TSYMSG-01061            PIC  9(05)  VALUE 01061.  01020000
010300         10  PC-TSYMSG-01127            PIC  9(05)  VALUE 01127.  01030000
010400         10  PC-TSYMSG-01128            PIC  9(05)  VALUE 01128.  01040000
010500         10  PC-TSYMSG-01129            PIC  9(05)  VALUE 01129.  01050000
010600         10  PC-TSYMSG-01818            PIC  9(05)  VALUE 01818.  01060000
010700         10  PC-TSYMSG-01876            PIC  9(05)  VALUE 01876.  01070000
010800         10  PC-TSYMSG-02875            PIC  9(05)  VALUE 02875.  01080000
010900         10  PC-TSYMSG-03082            PIC  9(05)  VALUE 03082.  01090000
011000         10  PC-TSYMSG-03135            PIC  9(05)  VALUE 03135.  01100000
011100         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01110000
011200         10  PC-TSYMSG-03231            PIC  9(05)  VALUE 03231.  01120000
011300                                                                  01130000
011400*        VEM MODULE ERROR MESSAGES                                01140000
011500         10  PC-TSYMSG-03290            PIC  9(05)  VALUE 03290.  01150000
011600         10  PC-TSYMSG-03291            PIC  9(05)  VALUE 03291.  01160000
011700         10  PC-TSYMSG-03292            PIC  9(05)  VALUE 03292.  01170000
011800         10  PC-TSYMSG-03293            PIC  9(05)  VALUE 03293.  01180000
011900         10  PC-TSYMSG-03294            PIC  9(05)  VALUE 03294.  01190000
012000         10  PC-TSYMSG-03295            PIC  9(05)  VALUE 03295.  01200000
012100         10  PC-TSYMSG-03296            PIC  9(05)  VALUE 03296.  01210000
012200                                                                  01220000
012300         10  PC-TSYMSG-03303            PIC  9(05)  VALUE 03303.  01230000
012400         10  PC-TSYMSG-03406            PIC  9(05)  VALUE 03406.  01240000
012500         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01250000
012600*                                                                 01260000
012700 01  PS-PROGRAM-SWITCHES.                                         01270000
012800     05  PS-EOC-LINE-CURSOR-SW          PIC  X(01)  VALUE 'N'.    01280000
012900         88  PS-EOC-LINE-CURSOR                     VALUE 'Y'.    01290000
013000         88  PS-NOT-EOC-LINE-CURSOR                 VALUE 'N'.    01300000
013100     05  PS-VERIFY-SW                   PIC  X(01)  VALUE 'N'.    01310000
013200         88  PS-CAN-VERIFY                          VALUE 'Y'.    01320000
013300         88  PS-CANT-VERIFY                         VALUE 'N'.    01330000
013400     05  PS-NO-DRIVER-INFO-SW           PIC  X(01)  VALUE 'Y'.    01340000
013500         88  PS-NO-DRIVER-INFO                      VALUE 'N'.    01350000
013600         88  PS-DRIVER-INFO                         VALUE 'Y'.    01360000
013700     05  PS-UNVERIFY-SW                 PIC  X(01)  VALUE 'N'.    01370000
013800         88  PS-CAN-UNVERIFY                        VALUE 'Y'.    01380000
013900         88  PS-CANT-UNVERIFY                       VALUE 'N'.    01390000
014000     05  PS-CONTINUE-FUNC-03-SW         PIC  X(01)  VALUE 'N'.    01400000
014100         88  PS-CONTINUE-FUNC-03                    VALUE 'Y'.    01410000
014200         88  PS-END-FUNC-03                         VALUE 'N'.    01420000
014300     05  PS-HIDDEN-TROUBLE-SW           PIC  X(01)  VALUE 'N'.    01430000
014400         88  PS-HIDDEN-LINE-ERRORS                  VALUE 'Y'.    01440000
014500         88  PS-NO-HIDDEN-LINE-ERRORS               VALUE 'N'.    01450000
014600     05  PS-DATA-OK-SW                  PIC  X(01)  VALUE 'N'.    01460000
014700         88  PS-DATA-OK                             VALUE 'Y'.    01470000
014800         88  PS-DATA-NOT-OK                         VALUE 'N'.    01480000
014900     05  PS-TROUBLE-SW                  PIC  X(01)  VALUE 'N'.    01490000
015000         88  PS-IN-TROUBLE                          VALUE 'Y'.    01500000
015100         88  PS-NOT-IN-TROUBLE                      VALUE 'N'.    01510000
015200     05  PS-PO-SW                       PIC  X(01)  VALUE 'N'.    01520000
015300         88  PS-PO-VERIFY                           VALUE 'Y'.    01530000
015400         88  PS-PO-UNVERIFY                         VALUE 'N'.    01540000
015500     05  PS-OPER-UNT-TYPE-SW            PIC  X(01)  VALUE ' '.    01550000
015600         88  PS-OPER-UNT-IS-DC                      VALUE 'Y'.    01560000
015700         88  PS-OPER-UNT-NOT-DC                     VALUE 'N'.    01570000
015800     05  PS-INVENTORY-CYCLE-SW        PIC  X    VALUE 'N'.        01580000
015900         88  PS-NO-INVENTORY-CYCLE              VALUE 'N'.        01590000
016000         88  PS-INVENTORY-CYCLE                 VALUE 'Y'.        01600000
016100     05  PS-CHECK-FOR-INV-CYCLE-SW    PIC  X    VALUE 'N'.        01610000
016200         88  PS-CHECKED-FOR-INV-CYCLE           VALUE 'Y'.        01620000
016300     05  PS-STR-INV-CYCLE-SW          PIC  X    VALUE 'N'.        01630000
016400         88  PS-FOUND-STR-INV-CYCLE             VALUE 'Y'.        01640000
016500         88  PS-NO-STR-INV-CYCLE                VALUE 'N'.        01650000
016600     05  PS-RECDIS-STR-FOUND-SW       PIC  X    VALUE 'N'.        01660000
016700         88  PS-RECDIS-STR-FOUND                VALUE 'Y'.        01670000
016800         88  PS-RECDIS-STR-NOT-FOUND            VALUE 'N'.        01680000
016900     05  PS-EOF-INV-CURSOR-SW         PIC  X    VALUE 'N'.        01690000
017000         88  PS-EOF-INV-CURSOR                  VALUE 'Y'.        01700000
017100         88  PS-NOT-EOF-INV-CURSOR              VALUE 'N'.        01710000
017200     05  PS-UPDATE-SW                   PIC  X(01)  VALUE 'N'.    01720000
017300         88  PS-NO-UPDATES-DONE                     VALUE 'N'.    01730000
017400         88  PS-UPDATES-DONE                        VALUE 'Y'.    01740000
017500     05  PS-NO-TDISTHD-FOUND-SW         PIC  X(01)  VALUE 'Y'.    01750000
017600         88  PS-TDISTHD-FOUND                       VALUE 'Y'.    01760000
017700         88  PS-NO-TDISTHD-FOUND                    VALUE 'N'.    01770000
017800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01780000
017900         88  PS-NO-ERROR                            VALUE 'Y'.    01790000
018000         88  PS-ERROR                               VALUE 'N'.    01800000
018100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01810000
018200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01820000
018300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01830000
018400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01840000
018500         88  PS-DONE                                VALUE 'Y'.    01850000
018600         88  PS-NOT-DONE                            VALUE 'N'.    01860000
018700     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01)  VALUE 'N'.       01870000
018800         88  PS-UNITS-WORKED-ERROR               VALUE 'Y'.       01880000
018900         88  PS-NO-UNITS-WORKED-ERROR            VALUE 'N'.       01890000
019000     05  PS-POT00006-SW                 PIC  X(01)  VALUE 'Y'.    01900000
019100         88  PS-POT00006-FOUND                      VALUE 'Y'.    01910000
019200         88  PS-POT00006-NOT-FOUND                  VALUE 'N'.    01920000
019300*                                                                 01930000
019400 01  PV-PROGRAM-VARIABLES.                                        01940000
019500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01950000
019600                                                     COMP SYNC.   01960000
019700     05  PV-ORD-LNE-NBR                  PIC S9(09)  COMP SYNC.   01970000
019800     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01980000
019900     05  PV-STATUS-CDE                  PIC  X(02).               01990000
020000     05  PV-RCPT-DISTR-UPD-CDE          PIC  X(01).               02000000
020100     05  PV-RECITM-STATUS-CDE           PIC  X(02).               02010000
020200     05  PV-VERIFY-USER                 PIC  X(08).               02020000
020300     05  PV-COUNT-STATUS-CDE            PIC  X(02).               02030000
020400     05  PV-INV-CUTOFF-DATE             PIC  X(10)  VALUE SPACES. 02040000
020500     05  PV-CURRENT-TIMESTAMP           PIC X(26)   VALUE         02050000
020600                                                       SPACES.    02060000
020700     05  PV-VERIFY-TIMESTAMP            PIC X(26)   VALUE         02070000
020800                                                       SPACES.    02080000
020900     05  PV-RECEIV-CURRENT-TIMESTAMP    PIC X(26)   VALUE         02090000
021000                                                       SPACES.    02100000
021100     05  PV-DB2-COUNT                   PIC S9(9)   VALUE +0      02110000
021200                                                    COMP-3.       02120000
021300     05  PV-DB2-TROUBLE-COUNT           PIC S9(9)   VALUE ZERO    02130000
021400                                                    COMP-3.       02140000
021500     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      02150000
021600                                                    COMP SYNC.    02160000
021700     05  PV-LNE-AP-VERIFY-ITM-QTY       PIC S9(09)  VALUE +0      02170000
021800                                                    COMP SYNC.    02180000
021900     05  PV-LNE-VERIFY-ITM-QTY          PIC S9(09)  VALUE +0      02190000
022000                                                    COMP SYNC.    02200000
022100     05  PV-LNE-EXPTED-ITM-QTY          PIC S9(09)  VALUE +0      02210000
022200                                                    COMP SYNC.    02220000
022300     05  PV-ODD-DC-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02230000
022400                                                    COMP SYNC.    02240000
022500     05  PV-ODD-AP-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02250000
022600                                                    COMP SYNC.    02260000
022700     05  PV-ODD-DC-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      02270000
022800                                                    COMP SYNC.    02280000
022900     05  PV-ODD-AP-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      02290000
023000                                                    COMP SYNC.    02300000
023100     05  PV-TOT-DC-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02310000
023200                                                    COMP SYNC.    02320000
023300     05  PV-TOT-AP-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02330000
023400                                                    COMP SYNC.    02340000
023500                                                                  02350000
023600     05  PV-DEPT-NBR-PIC9              PIC  9(03)  VALUE ZEROES.  02360000
023700     05  PV-DEPT-NBR-COMP-3            PIC S9(03) VALUE 0 COMP-3. 02370000
023800                                                                  02380000
023900     05  PV-PKSLIP-PACKS                PIC  9(06).               02390000
024000     05  PV-ACTUAL-PACKS                PIC  9(06).               02400000
024100     05  PV-VERFYD-PACKS                PIC  9(06).               02410000
024200     05  PV-ODD-UNITS                   PIC  9(06).               02420000
024300     05  PV-DRIVER-RATIO                PIC  9(06).               02430000
024400     05  PV-DISP-PO-NBR                 PIC  9(09).               02440000
024500     05  PV-DISP-OPER-UNT-ID            PIC  9(04).               02450000
024600     05  PV-DISP-FCLTY-ID               PIC  9(04).               02460000
024700     05  PV-DISP-REC-SEQ-NBR            PIC  9(04).               02470000
024800     05  PV-DISP-PREPK-ID               PIC  9(04).               02480000
024900     05  PV-DISP-LNE-NBR                PIC  9(04).               02490000
025000     05  PV-DISPLAY-SQL-CODE            PIC  9999- VALUE ZEROS.   02500000
025100     05  PV-DISPLAY-CICS-RESP           PIC  999999999-.          02510000
025200     05  PV-SUB                         PIC S9(04)  VALUE +0      02520000
025300                                                    COMP SYNC.    02530000
025400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02540000
025500                                                    COMP SYNC.    02550000
025600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02560000
025700                                                    COMP-3.       02570000
025800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02580000
025900                                                    COMP-3.       02590000
026000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02600000
026100                                                    COMP-3.       02610000
026200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02620000
026300                                                    COMP-3.       02630000
026400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02640000
026500                                                    COMP-3.       02650000
026600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02660000
026700                                                    COMP-3.       02670000
026800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02680000
026900                                                    COMP-3.       02690000
027000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02700000
027100                                                    COMP SYNC.    02710000
027200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02720000
027300                                                    COMP SYNC.    02730000
027400     05  PV-ITEM                        PIC S9(04)  VALUE +0      02740000
027500                                                    COMP SYNC.    02750000
027600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02760000
027700                                                    COMP SYNC.    02770000
027800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02780000
027900                                                    COMP SYNC.    02790000
028000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02800000
028100                                                    COMP SYNC.    02810000
028200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02820000
028300                                                    COMP SYNC.    02830000
028400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02840000
028500                                                    COMP SYNC.    02850000
028600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02860000
028700                                                    COMP SYNC.    02870000
028800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02880000
028900                                                    COMP SYNC.    02890000
029000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02900000
029100                                                    COMP SYNC.    02910000
029200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02920000
029300                                                    COMP SYNC.    02930000
029400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02940000
029500                                                    COMP SYNC.    02950000
029600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02960000
029700                                                    COMP SYNC.    02970000
029800     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02980000
029900                                                    COMP SYNC.    02990000
030000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03000000
030100                                                    COMP SYNC.    03010000
030200     05  PV-WORK-TIMESTAMP.                                       03020000
030300         10  PV-WORK-YEAR               PIC X(04).                03030000
030400         10  FILLER                     PIC X(01).                03040000
030500         10  PV-WORK-MONTH              PIC X(02).                03050000
030600         10  FILLER                     PIC X(01).                03060000
030700         10  PV-WORK-DAY                PIC X(02).                03070000
030800         10  FILLER                     PIC X(01).                03080000
030900         10  PV-WORK-HH                 PIC X(02).                03090000
031000         10  FILLER                     PIC X(01).                03100000
031100         10  PV-WORK-MIN                PIC X(02).                03110000
031200         10  FILLER                     PIC X(10).                03120000
031300     05  PV-DISPLAY-DATE.                                         03130000
031400         10  PV-DISPLAY-MONTH           PIC X(02).                03140000
031500         10  PV-SLASH-1                 PIC X(01).                03150000
031600         10  PV-DISPLAY-DAY             PIC X(02).                03160000
031700         10  PV-SLASH-2                 PIC X(01).                03170000
031800         10  PV-DISPLAY-YEAR            PIC X(04).                03180000
031900     05  PV-DISPLAY-TIME.                                         03190000
032000         10  PV-DISPLAY-HH              PIC X(02).                03200000
032100         10  PV-COLON-1                 PIC X(01).                03210000
032200         10  PV-DISPLAY-MM              PIC X(02).                03220000
032300     05  PV-RECEIV-VRFY-INFO.                                     03230000
032400         10  PV-LEFT-PAREN              PIC X(01).                03240000
032500         10  PV-VRFY-DATE               PIC X(10).                03250000
032600         10  FILLER                     PIC X(01).                03260000
032700         10  PV-VRFY-TIME               PIC X(05).                03270000
032800         10  PV-SEPARATOR               PIC X(03).                03280000
032900         10  PV-VRFY-USERID             PIC X(07).                03290000
033000         10  PV-RIGHT-PAREN             PIC X(01).                03300000
033100     05  PV-WORK-DATE                    PIC  X(10)  VALUE ZEROS. 03310000
033200     05  FILLER    REDEFINES PV-WORK-DATE.                        03320000
033300         10  PV-WORK-CC                  PIC  X(02).              03330000
033400         10  PV-WORK-YY                  PIC  X(02).              03340000
033500         10  FILLER                      PIC  X(01).              03350000
033600         10  PV-WORK-MM                  PIC  X(02).              03360000
033700         10  FILLER                      PIC  X(01).              03370000
033800         10  PV-WORK-DD                  PIC  X(02).              03380000
033900     05  PV-HOLD-WORK-DATE.                                       03390000
034000         10  PV-HOLD-WORK-CC             PIC  9(02).              03400000
034100         10  PV-HOLD-WORK-YY             PIC  9(02).              03410000
034200         10  PV-HOLD-WORK-MM             PIC  9(02).              03420000
034300         10  PV-HOLD-WORK-DD             PIC  9(02).              03430000
034400     05  PV-CURR-DATE                    PIC  X(10)  VALUE ZEROS. 03440000
034500     05  PV-CURRENT-DATE                 PIC  X(10)  VALUE ZEROS. 03450000
034600     05  FILLER   REDEFINES PV-CURRENT-DATE.                      03460000
034700         10  PV-CURRENT-CC               PIC  X(02).              03470000
034800         10  PV-CURRENT-YY               PIC  X(02).              03480000
034900         10  FILLER                      PIC  X(01).              03490000
035000         10  PV-CURRENT-MM               PIC  X(02).              03500000
035100         10  FILLER                      PIC  X(01).              03510000
035200         10  PV-CURRENT-DD               PIC  X(02).              03520000
035300     05  PV-HOLD-CURR-DATE.                                       03530000
035400         10  PV-HOLD-CURR-CC             PIC  9(02).              03540000
035500         10  PV-HOLD-CURR-YY             PIC  9(02).              03550000
035600         10  PV-HOLD-CURR-MM             PIC  9(02).              03560000
035700         10  PV-HOLD-CURR-DD             PIC  9(02).              03570000
035800     05  PV-HOLD-CUTOFF-DATE.                                     03580000
035900         10  PV-HOLD-CUTOFF-CC           PIC  9(02).              03590000
036000         10  PV-HOLD-CUTOFF-YY           PIC  9(02).              03600000
036100         10  PV-HOLD-CUTOFF-MM           PIC  9(02).              03610000
036200         10  PV-HOLD-CUTOFF-DD           PIC  9(02).              03620000
036300     05  PV-CURRENT-TIME                 PIC X(08)  VALUE SPACES. 03630000
036301*3/19/13                                                          03630101
036310     05  PV-PO-TTRBNTF                   PIC  S9(9) COMP          03631001
036320                                                    VALUE ZEROES. 03632001
036400                                                                  03640000
036500 01  LINE-NBR-TBL.                                                03650000
036600     05  TBL-LNE-ENTRIES          OCCURS 100 TIMES                03660000
036700                                  INDEXED BY LINE-IDX.            03670000
036800         10  TBL-LNE-NBR          PIC S9(09)  COMP.               03680000
036900         10  TBL-ITM-QTY          PIC S9(09)  COMP.               03690000
037000                                                                  03700000
037100******************************************************************03710000
037200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03720000
037300**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03730000
037400**  APPLICATION-SPECIFIC COMMAREA.                              **03740000
037500******************************************************************03750000
037600 01  LQW-LIST-QUEUE-WORK-AREA.                                    03760000
037700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03770000
037800     05  LQW-ITEM-ENTRIES               OCCURS 8 TIMES            03780000
037900                                        INDEXED BY LQW-IDX.       03790000
038000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03800000
038100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03810000
038200         10  LQW-SELECTED-SW            PIC  X(01).               03820000
038300             88  LQW-SELECT                         VALUE 'S'.    03830000
038400             88  LQW-DESELECT                       VALUE ' '.    03840000
038500         10  LQW-ACTION                 PIC  X(03).               03850000
038600             88  LQW-UPDATE                         VALUE 'UPD'.  03860000
038700             88  LQW-ERROR                          VALUE 'ERR'.  03870000
038800             88  LQW-INVENTORY                      VALUE 'INV'.  03880000
038900         10  LQW-CL                     PIC  X(02).               03890000
039000         10  LQW-PACK-ID                PIC  9(04).               03900000
039100         10  LQW-PACK-SKU               PIC  9(08).               03910000
039200         10  LQW-STAT-CDE               PIC  X(02).               03920000
039300         10  LQW-PKSLIP-PACKS           PIC  9(06).               03930000
039400         10  LQW-ACTUAL-PACKS           PIC  9(06).               03940000
039500         10  LQW-VERFYD-PACKS           PIC  9(06).               03950000
039600         10  LQW-ODD-UNITS              PIC  9(06).               03960000
039700         10  LQW-TOT-ACT-UNTS           PIC  9(06).               03970000
039800         10  LQW-TOT-VERFYD-UNTS        PIC  9(06).               03980000
039900         10  LQW-VERFYD-SOURCE          PIC  X(08).               03990000
040000         10  LQW-CANNOT-VERIFY-SW       PIC  X(01).               04000000
040100                                                                  04010000
040200     EJECT                                                        04020000
040300                                                                  04030000
040400     EJECT                                                        04040000
040500*---------------------------------------------------------------* 04050000
040600*    MAP LAYOUT                                                 * 04060000
040700*---------------------------------------------------------------* 04070000
040800                                                                  04080000
040900     COPY RCKM817.                                                04090000
041000*                                                                 04100000
041100 01  MR-OCCURS-LAYOUT                   REDEFINES  RC817AO.       04110000
041200     05  FILLER                         PIC X(237).               04120000
041300     05  MR-SCROLL-AREA                 OCCURS  8 TIMES.          04130000
041400         10  MR-SELECTL                 PIC S9(04) COMP.          04140000
041500         10  MR-SELECTA                 PIC  X(01).               04150000
041600         10  MR-SELECTC                 PIC  X(01).               04160000
041700         10  MR-SELECTH                 PIC  X(01).               04170000
041800         10  MR-SELECTI                 PIC  X(01).               04180000
041900                                                                  04190000
042000         10  MR-ACTIONL                 PIC S9(04) COMP.          04200000
042100         10  MR-ACTIONA                 PIC  X(01).               04210000
042200         10  MR-ACTIONC                 PIC  X(01).               04220000
042300         10  MR-ACTIONH                 PIC  X(01).               04230000
042400         10  MR-ACTION                  PIC  X(03).               04240000
042500                                                                  04250000
042600         10  MR-CLL                     PIC S9(04) COMP.          04260000
042700         10  MR-CLA                     PIC  X(01).               04270000
042800         10  MR-CLC                     PIC  X(01).               04280000
042900         10  MR-CLH                     PIC  X(01).               04290000
043000         10  MR-CL                      PIC  X(02).               04300000
043100                                                                  04310000
043200         10  MR-PACK-IDL                PIC S9(04) COMP.          04320000
043300         10  MR-PACK-IDA                PIC  X(01).               04330000
043400         10  MR-PACK-IDC                PIC  X(01).               04340000
043500         10  MR-PACK-IDH                PIC  X(01).               04350000
043600         10  MR-PACK-ID                 PIC  X(04).               04360000
043700                                                                  04370000
043800         10  MR-PACK-SKUL               PIC S9(04) COMP.          04380000
043900         10  MR-PACK-SKUA               PIC  X(01).               04390000
044000         10  MR-PACK-SKUC               PIC  X(01).               04400000
044100         10  MR-PACK-SKUH               PIC  X(01).               04410000
044200         10  MR-PACK-SKU-X.                                       04420000
044300             15  MR-PACK-SKU            PIC  9(08).               04430000
044400                                                                  04440000
044500         10  MR-STAT-CDEL               PIC S9(04) COMP.          04450000
044600         10  MR-STAT-CDEA               PIC  X(01).               04460000
044700         10  MR-STAT-CDEC               PIC  X(01).               04470000
044800         10  MR-STAT-CDEH               PIC  X(01).               04480000
044900         10  MR-STAT-CDE                PIC  X(02).               04490000
045000                                                                  04500000
045100         10  MR-PKSLIP-PACKSL           PIC S9(04) COMP.          04510000
045200         10  MR-PKSLIP-PACKSA           PIC  X(01).               04520000
045300         10  MR-PKSLIP-PACKSC           PIC  X(01).               04530000
045400         10  MR-PKSLIP-PACKSH           PIC  X(01).               04540000
045500         10  MR-PKSLIP-PACKS-X.                                   04550000
045600             15  MR-PKSLIP-PACKS        PIC  ZZZZZ9.              04560000
045700                                                                  04570000
045800         10  MR-ACTUAL-PACKSL           PIC S9(04) COMP.          04580000
045900         10  MR-ACTUAL-PACKSA           PIC  X(01).               04590000
046000         10  MR-ACTUAL-PACKSC           PIC  X(01).               04600000
046100         10  MR-ACTUAL-PACKSH           PIC  X(01).               04610000
046200         10  MR-ACTUAL-PACKS-X.                                   04620000
046300             15  MR-ACTUAL-PACKS        PIC  ZZZZZ9.              04630000
046400                                                                  04640000
046500         10  MR-VERFYD-PACKSL           PIC S9(04) COMP.          04650000
046600         10  MR-VERFYD-PACKSA           PIC  X(01).               04660000
046700         10  MR-VERFYD-PACKSC           PIC  X(01).               04670000
046800         10  MR-VERFYD-PACKSH           PIC  X(01).               04680000
046900         10  MR-VERFYD-PACKS-X.                                   04690000
047000             15  MR-VERFYD-PACKS        PIC  ZZZZZ9.              04700000
047100                                                                  04710000
047200         10  MR-ODD-UNITSL              PIC S9(04) COMP.          04720000
047300         10  MR-ODD-UNITSA              PIC  X(01).               04730000
047400         10  MR-ODD-UNITSC              PIC  X(01).               04740000
047500         10  MR-ODD-UNITSH              PIC  X(01).               04750000
047600         10  MR-ODD-UNITS-X.                                      04760000
047700             15  MR-ODD-UNITS           PIC  ZZZZZ9.              04770000
047800                                                                  04780000
047900         10  MR-TOT-ACT-UNTSL           PIC S9(04) COMP.          04790000
048000         10  MR-TOT-ACT-UNTSA           PIC  X(01).               04800000
048100         10  MR-TOT-ACT-UNTSC           PIC  X(01).               04810000
048200         10  MR-TOT-ACT-UNTSH           PIC  X(01).               04820000
048300         10  MR-TOT-ACT-UNTS-X.                                   04830000
048400             15  MR-TOT-ACT-UNTS        PIC  ZZZZZ9.              04840000
048500                                                                  04850000
048600         10  MR-TOT-VERFYD-UNTSL        PIC S9(04) COMP.          04860000
048700         10  MR-TOT-VERFYD-UNTSA        PIC  X(01).               04870000
048800         10  MR-TOT-VERFYD-UNTSC        PIC  X(01).               04880000
048900         10  MR-TOT-VERFYD-UNTSH        PIC  X(01).               04890000
049000         10  MR-TOT-VERFYD-UNTS-X.                                04900000
049100             15  MR-TOT-VERFYD-UNTS     PIC  ZZZZZ9.              04910000
049200                                                                  04920000
049300         10  MR-VERFYD-SOURCEL          PIC S9(04) COMP.          04930000
049400         10  MR-VERFYD-SOURCEA          PIC  X(01).               04940000
049500         10  MR-VERFYD-SOURCEC          PIC  X(01).               04950000
049600         10  MR-VERFYD-SOURCEH          PIC  X(01).               04960000
049700         10  MR-VERFYD-SOURCE           PIC  X(08).               04970000
049800     EJECT                                                        04980000
049900***************************************************************** 04990000
050000*   RCWS039 - IS THE LAYOUT THAT IS USED TO PASS INFO TO        * 05000000
050100*             THE F-KEY ELIGIBILITY MODULE (RCKUT126).          * 05010000
050200***************************************************************** 05020000
050300     COPY RCWS039.                                                05030000
050400                                                                  05040000
050500***************************************************************** 05050000
050600*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 05060000
050700*             FUNCTIONS                                        .* 05070000
050800***************************************************************** 05080000
050900     COPY RCWS071.                                                05090000
051000                                                                  05100000
051100*---------------------------------------------------------------* 05110000
051200*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 05120000
051300*---------------------------------------------------------------* 05130000
051400     COPY RCWS074.                                                05140000
051500                                                                  05150000
051600*----------------------------------------------------------------*05160000
051700**  SECURITY SUBROUTINE PARAMETERS                                05170000
051800*----------------------------------------------------------------*05180000
051900                                                                  05190000
052000     COPY DPWS008.                                                05200000
052100                                                                  05210000
052200*---------------------------------------------------------------* 05220000
052300*  RECORD LAYOUTS FOR THE FREE ASTRAY HANDLER MODULE              05230000
052400*---------------------------------------------------------------* 05240000
052500     COPY SUWS044.                                                05250000
052600                                                                  05260000
052700*---------------------------------------------------------------* 05270000
052800* COPY BOOK FOR CALLED MODULE PCKCS756                            05280000
052900*---------------------------------------------------------------* 05290000
053000     COPY PCWS238.                                                05300000
053100                                                                  05310000
053200*---------------------------------------------------------------* 05320000
053300*  RECORD LAYOUTS FOR THE VEM MODULE                              05330000
053400*---------------------------------------------------------------* 05340000
053500     COPY RCWS038.                                                05350000
053600                                                                  05360000
053700***************************************************************** 05370000
053800*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 05380000
053900*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 05390000
054000***************************************************************** 05400000
054100     COPY RCWS040.                                                05410000
054200                                                                  05420000
054300     COPY TMWS500.                                                05430000
054400                                                                  05440000
054500*---------------------------------------------------------------* 05450000
054600*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 05460000
054700*---------------------------------------------------------------* 05470000
054800     COPY RCWS031.                                                05480000
054900                                                                  05490000
055000                                                                  05500000
055100*---------------------------------------------------------------* 05510000
055200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05520000
055300*---------------------------------------------------------------* 05530000
055400                                                                  05540000
055500     COPY DPWS015.                                                05550000
055600                                                                  05560000
055700*---------------------------------------------------------------* 05570000
055800*    FUNCTION KEYS COPYBOOK.                                    * 05580000
055900*---------------------------------------------------------------* 05590000
056000                                                                  05600000
056100     COPY DPWS016.                                                05610000
056200                                                                  05620000
056300*---------------------------------------------------------------* 05630000
056400*    NUMERIC EDIT LAYOUT.                                       * 05640000
056500*---------------------------------------------------------------* 05650000
056600                                                                  05660000
056700     COPY DPWS010I.                                               05670000
056800 EJECT                                                            05680000
056900******************************************************************05690005
057000** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **05700005
057010** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **05701005
057100******************************************************************05710005
057200                                                                  05720000
057300     COPY DPWS030.                                                05730000
057310     COPY DPWS930.                                                05731005
057400*---------------------------------------------------------------* 05740000
057500*    RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE.        * 05750000
057600*---------------------------------------------------------------* 05760000
057700     COPY RCWS037.                                                05770000
057800                                                                  05780000
057900*---------------------------------------------------------------* 05790000
058000*  RECORD LAYOUT FOR THE PACKSLIP SELECTION TEMP STORAGE QUEUE. * 05800000
058100*---------------------------------------------------------------* 05810000
058200                                                                  05820000
058300     COPY RCWS801.                                                05830000
058400*---------------------------------------------------------------* 05840000
058500*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 05850000
058600*---------------------------------------------------------------* 05860000
058700                                                                  05870000
058800     COPY TMWS002.                                                05880000
058900                                                                  05890000
059000 EJECT                                                            05900000
059100*---------------------------------------------------------------* 05910000
059200*    STANDARD COMMAREA.                                         * 05920000
059300*---------------------------------------------------------------* 05930000
059400                                                                  05940000
059500     COPY DPWS020.                                                05950000
059600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05960000
059700                                                                  05970000
059800*---------------------------------------------------------------* 05980000
059900* INTER-APPLICATION COMMAREA.                                   * 05990000
060000*   RCWS017 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 06000000
060100*             SPEC SCREEN.                                      * 06010000
060200*    ****RCWS012 IS USED IN THE RCKCS219 PROGRAM, BUT RCWS017   * 06020000
060300*        IS PASSED FROM THE RCKCS277 PROGRAM, WHICH INCLUDES    * 06030000
060400*        A TROUBLE QUEUE NAME                                     06040000
060500*   RCWS036 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 06050000
060600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 06060000
060700*---------------------------------------------------------------* 06070000
060800                                                                  06080000
060900         10  INTER-APPL-COMM-AREA       PIC X(200).               06090000
061000     COPY RCWS017.                                                06100000
061100     COPY RCWS800.                                                06110000
061200     COPY RCWS036.                                                06120000
061300     COPY TMWS001.                                                06130000
061400                                                                  06140000
061500*---------------------------------------------------------------* 06150000
061600*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06160000
061700*---------------------------------------------------------------* 06170000
061800         10  ASC-SPECIFIC-COMMAREA.                               06180000
061900             15  ASC-LOCAL-GO-DESTINATION            PIC X(01).   06190000
062000                 88  ASC-RETURNING-FROM-RCVG         VALUE '1'.   06200000
062100                 88  ASC-RETURNING-FROM-TRBL         VALUE '2'.   06210000
062200                 88  ASC-RETURNING-FROM-STR-PACK     VALUE '3'.   06220000
062300             15  ASC-LIST-KEYS.                                   06230000
062400                 20  ASC-OPER-UNT-ID                 PIC S9(04)   06240000
062500                                                     COMP.        06250000
062600                 20  ASC-FCLTY-ID                    PIC S9(04)   06260000
062700                                                     COMP.        06270000
062800                 20  ASC-FCLTY-NME                   PIC  X(25).  06280000
062900                 20  ASC-RECEIV-VRFY-INFO            PIC  X(28).  06290000
063000                 20  ASC-PO-NBR                      PIC S9(09)   06300000
063100                                                     COMP.        06310000
063200                 20  ASC-PO-LNE-NBR                  PIC S9(09)   06320000
063300                                                     COMP.        06330000
063400                 20  ASC-REC-SEQ-NBR                 PIC S9(09)   06340000
063500                                                     COMP.        06350000
063600                 20  ASC-PO-DRIVER-LNE               PIC S9(09)   06360000
063700                                                     COMP.        06370000
063800                 20  ASC-DRIVER-RATIO                PIC  9(06).  06380000
063900                 20  ASC-TOT-PKSLIP-PACKS            PIC S9(07)   06390000
064000                                                     COMP.        06400000
064100                 20  ASC-TOT-ACTUAL-PACKS            PIC S9(07)   06410000
064200                                                     COMP.        06420000
064300                 20  ASC-TOT-VERFYD-PACKS            PIC S9(07)   06430000
064400                                                     COMP.        06440000
064500                 20  ASC-TOT-ODD-UNITS               PIC S9(07)   06450000
064600                                                     COMP.        06460000
064700                 20  ASC-HDR-TOT-ACT-UNTS            PIC S9(07)   06470000
064800                                                     COMP.        06480000
064900                 20  ASC-HDR-TOT-VERFYD-UNTS         PIC S9(07)   06490000
065000                                                     COMP.        06500000
065100                                                                  06510000
065200                 20  ASC-DEPT-NBR                    PIC  9(04).  06520000
065300             15  ASC-RECEIV-STATUS-CDE               PIC  X(02).  06530000
065400                 88 ASC-RECEIV-STATUS-VERIFY         VALUE 'VE'.  06540000
065500             15  ASC-RECEIV-PKGNG-CDE                PIC X(01).   06550000
065600             15  ASC-RECEIV-PACK-BY-ST-IND           PIC X(01).   06560000
065700                 88  ASC-PACK-BY-STORE        VALUE 'Y'.          06570000
065800                 88  ASC-NOT-PACK-BY-STORE    VALUE 'N'.          06580000
065900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06590000
066000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06600000
066100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06610000
066200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06620000
066300                                                                  06630000
066400                 20  ASC-ITEM-ARRAY.                              06640000
066500                     25  ASC-ITEM-ENTRIES OCCURS  8 TIMES.        06650000
066600                         30  ASC-LIST-ITEM-NUMBER                 06660000
066700                                                     PIC S9(09)   06670000
066800                                                     COMP-3.      06680000
066900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06690000
067000                             88  ASC-VALID-SELECT    VALUE ' '    06700000
067100                                                           'S'    06710000
067200                                                           'B'    06720000
067300                                                           'E'.   06730000
067400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06740000
067500                             88  ASC-TEMP-SELECT     VALUE 'S'.   06750000
067600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06760000
067700                             88  ASC-TEMP-END        VALUE 'E'.   06770000
067800                         30  ASC-SELECTED-SW         PIC  X(01).  06780000
067900                             88  ASC-NO-SELECT       VALUE ' '.   06790000
068000                             88  ASC-SELECT          VALUE 'S'.   06800000
068100                             88  ASC-BEGIN           VALUE 'B'.   06810000
068200                             88  ASC-END             VALUE 'E'.   06820000
068300                         30  ASC-ACTION              PIC  X(03).  06830000
068400                         30  ASC-CL                  PIC  X(02).  06840000
068500                         30  ASC-PACK-ID             PIC  9(04).  06850000
068600                         30  ASC-PACK-SKU            PIC  9(08).  06860000
068700                         30  ASC-STAT-CDE            PIC  X(02).  06870000
068800                         30  ASC-PKSLIP-PACKS        PIC  9(06).  06880000
068900                         30  ASC-ACTUAL-PACKS        PIC  9(06).  06890000
069000                         30  ASC-VERFYD-PACKS        PIC  9(06).  06900000
069100                         30  ASC-ODD-UNITS           PIC  9(06).  06910000
069200                         30  ASC-TOT-ACT-UNTS        PIC  9(06).  06920000
069300                         30  ASC-TOT-VERFYD-UNTS     PIC  9(06).  06930000
069400                         30  ASC-VERFYD-SOURCE       PIC  X(08).  06940000
069500                         30  ASC-CANNOT-VERIFY-SW    PIC  X(01).  06950000
069600                                                                  06960000
069700             15  ASC-BLK-SUB                         PIC S9(04)   06970000
069800                                                          COMP    06980000
069900                                                          SYNC.   06990000
070000             15  ASC-ITEM-SUB                        PIC S9(04)   07000000
070100                                                          COMP    07010000
070200                                                          SYNC.   07020000
070300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   07030000
070400                                                          COMP-3. 07040000
070500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   07050000
070600                                                          COMP-3. 07060000
070700             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   07070000
070800                                                          COMP-3. 07080000
070900             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   07090000
071000                                                          COMP-3. 07100000
071100             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   07110000
071200                                                          COMP-3. 07120000
071300             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   07130000
071400                                                          COMP    07140000
071500                                                          SYNC.   07150000
071600             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   07160000
071700                                                          COMP-3. 07170000
071800             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   07180000
071900                                                          COMP-3. 07190000
072000             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07200000
072100                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07210000
072200                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07220000
072300             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  07230000
072400                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07240000
072500                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07250000
072600             15  ASC-LIST-QUEUE-NAME.                             07260000
072700                 20  ASC-LIST-TERM-ID                PIC  X(04).  07270000
072800                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07280000
072900                                                          COMP-3. 07290000
073000                 20  ASC-LIST-SEQ                    PIC  9(01).  07300000
073100             15  ASC-SEL-QUEUE-NAME-IN               PIC X(08).   07310000
073200             15  ASC-SEL-QUEUE-NAME-OUT.                          07320000
073300                 20  ASC-SEL-TERM-ID-OUT             PIC  X(04).  07330000
073400                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(05)   07340000
073500                                                          COMP-3. 07350000
073600                 20  ASC-SEL-SEQ-OUT                 PIC  9(01).  07360000
073700                                                                  07370000
073800             15  ASC-TRB-QUEUE-NAME                  PIC X(08).   07380000
073900             15  ASC-START-ITEM-REQUEST.                          07390000
074000                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  07400000
074100                                                                  07410000
074200             15  ASC-VERIFY-SW                       PIC  X(01).  07420000
074300                 88  ASC-CAN-VERIFY                  VALUE 'Y'.   07430000
074400                 88  ASC-CANT-VERIFY                 VALUE 'N'.   07440000
074500             15  ASC-UNVERIFY-SW                     PIC  X(01).  07450000
074600                 88  ASC-CAN-UNVERIFY                VALUE 'Y'.   07460000
074700                 88  ASC-CANT-UNVERIFY-FS            VALUE 'F'.   07470000
074800                 88  ASC-CANT-UNVERIFY-ST            VALUE 'S'.   07480000
074900                 88  ASC-CANT-UNVERIFY               VALUE 'N'.   07490000
075000                                                                  07500000
075100             15  ASC-CONFIRM-SWITCH                  PIC X.       07510000
075200                 88  ASC-CONFIRM                     VALUE 'Y'.   07520000
075300                 88  ASC-NOT-CONFIRM                 VALUE 'N'.   07530000
075400                                                                  07540000
075500             15  ASC-CONFIRM-ZERO-SW                 PIC X.       07550000
075600                 88  ASC-CONFIRM-ZERO                VALUE 'Y'.   07560000
075700                 88  ASC-NOT-CONFIRM-ZERO            VALUE 'N'.   07570000
075800                                                                  07580000
075900             15  ASC-CONFIRM-VERIFY-SW               PIC X.       07590000
076000                 88  ASC-CONFIRM-VERIFY              VALUE 'V'.   07600000
076100                 88  ASC-CONFIRM-UNVERIFY            VALUE 'U'.   07610000
076200                 88  ASC-STOP-VERIFY                 VALUE 'S'.   07620000
076300                                                                  07630000
076400             15  ASC-TROUBLE-SW                      PIC  X(01).  07640000
076500                 88  ASC-IN-TROUBLE                  VALUE 'Y'.   07650000
076600                 88  ASC-NOT-IN-TROUBLE              VALUE 'N'.   07660000
076700                                                                  07670000
076800             15  ASC-POST-VERIFIED-RECEIPT-SW        PIC  X(01).  07680000
076900                 88  ASC-POST-VERIFIED-RECEIPT       VALUE 'Y'.   07690000
077000                 88  ASC-NOT-POST-VERIFIED-RECEIPT   VALUE 'N'.   07700000
077100                                                                  07710000
077200             15  ASC-TOT-VFY-QTY                     PIC S9(09)   07720000
077300                                                          COMP-3. 07730000
077400             15  ASC-TOT-ACT-QTY                     PIC S9(09)   07740000
077500                                                          COMP-3. 07750000
077600             15  ASC-AUTO-VE-SW           PIC X.                  07760000
077700                 88  ASC-AUTO-VE-YES      VALUE 'Y'.              07770000
077800                 88  ASC-AUTO-VE-NO       VALUE 'N'.              07780000
077900             15  ASC-REC-TYP-CDE                     PIC  X(02).  07790000
078000             15  ASC-FILLER                          PIC X(1517). 07800000
078100                                                                  07810000
078200     EJECT                                                        07820000
078300*---------------------------------------------------------------* 07830000
078400*    ABEND PROCESSING COPYBOOK.                                 * 07840000
078500*---------------------------------------------------------------* 07850000
078600                                                                  07860000
078700     COPY DPWS013.                                                07870000
078800                                                                  07880000
078900 EJECT                                                            07890000
079000*---------------------------------------------------------------* 07900000
079100*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 07910000
079200*---------------------------------------------------------------* 07920000
079300     EXEC SQL                                                     07930000
079400          INCLUDE TPURCHS                                         07940000
079500     END-EXEC.                                                    07950000
079600*---------------------------------------------------------------* 07960000
079700*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 07970000
079800*---------------------------------------------------------------* 07980000
079900     EXEC SQL                                                     07990000
080000          INCLUDE TPURITM                                         08000000
080100     END-EXEC.                                                    08010000
080200*---------------------------------------------------------------* 08020000
080300*    DB2 AREA FOR PURCHASE ORDER PRE PACK TABLE                 * 08030000
080400*---------------------------------------------------------------* 08040000
080500     EXEC SQL                                                     08050000
080600          INCLUDE TPOPRPK                                         08060000
080700     END-EXEC.                                                    08070000
080800/                                                                 08080000
080900*---------------------------------------------------------------* 08090000
081000*    DB2 AREA FOR RECEIPT HEADER TABLE                          * 08100000
081100*---------------------------------------------------------------* 08110000
081200     EXEC SQL                                                     08120000
081300          INCLUDE TRECEIV                                         08130000
081400     END-EXEC.                                                    08140000
081500*---------------------------------------------------------------* 08150000
081600*    DB2 AREA FOR RECEIPT ITEM TABLE                            * 08160000
081700*---------------------------------------------------------------* 08170000
081800     EXEC SQL                                                     08180000
081900          INCLUDE TRECITM                                         08190000
082000     END-EXEC.                                                    08200000
082100*---------------------------------------------------------------* 08210000
082200*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 08220000
082300*---------------------------------------------------------------* 08230000
082400     EXEC SQL                                                     08240000
082500          INCLUDE TRECDIS                                         08250000
082600     END-EXEC.                                                    08260000
082700*---------------------------------------------------------------* 08270000
082800*    DB2 AREA FOR TROUBLE NOTIFICATION TABLE                    * 08280000
082900*---------------------------------------------------------------* 08290000
083000     EXEC SQL                                                     08300000
083100          INCLUDE TTRBNTF                                         08310000
083200     END-EXEC.                                                    08320000
083300*---------------------------------------------------------------* 08330000
083400*    DB2 AREA FOR TROUBLE REASON TABLE                          * 08340000
083500*---------------------------------------------------------------* 08350000
083600     EXEC SQL                                                     08360000
083700          INCLUDE TTRBRSN                                         08370000
083800     END-EXEC.                                                    08380000
083900*---------------------------------------------------------------* 08390000
084000*    XLT_LOC TABLE                                              * 08400000
084100*---------------------------------------------------------------* 08410000
084200     EXEC SQL                                                     08420000
084300          INCLUDE XLT00010                                        08430000
084400     END-EXEC.                                                    08440000
084500*---------------------------------------------------------------* 08450000
084600*    DB2 AREA FOR RECEIPT VERIFIED ODD UNITS TABLE              * 08460000
084700*    (RCT_VRFD_ODD_UNT)                                         * 08470000
084800*---------------------------------------------------------------* 08480000
084900     EXEC SQL                                                     08490000
085000          INCLUDE RCT00009                                        08500000
085100     END-EXEC.                                                    08510000
085200*---------------------------------------------------------------* 08520000
085300*    DB2 AREA FOR DIST HEADER                                   * 08530000
085400*---------------------------------------------------------------* 08540000
085500     EXEC SQL                                                     08550000
085600          INCLUDE TDISTHD                                         08560000
085700     END-EXEC.                                                    08570000
085800*---------------------------------------------------------------* 08580000
085900*    DB2 AREA FOR DIST DETAIL                                   * 08590000
086000*---------------------------------------------------------------* 08600000
086100     EXEC SQL                                                     08610000
086200          INCLUDE TDISTDT                                         08620000
086300     END-EXEC.                                                    08630000
086400*---------------------------------------------------------------* 08640000
086500*    DB2 AREA FOR THE POT_RMS_RLOUT_CTL                         * 08650000
086600*---------------------------------------------------------------* 08660000
086700     EXEC SQL                                                     08670000
086800          INCLUDE POT00006                                        08680000
086900     END-EXEC.                                                    08690000
087000                                                                  08700000
087100*    EXEC SQL                                                     08710000
087200*         INCLUDE TCOCNTL                                         08720000
087300*    END-EXEC.                                                    08730000
087400*                                                                 08740000
087500*---------------------------------------------------------------* 08750000
087600*    DB2 AREA FOR COMMUNICATIONS                                * 08760000
087700*---------------------------------------------------------------* 08770000
087800     EXEC SQL                                                     08780000
087900          INCLUDE SQLCA                                           08790000
088000     END-EXEC.                                                    08800000
088100                                                                  08810000
088200*---------------------------------------------------------------* 08820000
088300                                                                  08830000
088400     EXEC SQL                                                     08840000
088500          DECLARE PACK-SLIP-CSR CURSOR                            08850000
088600          FOR SELECT DISTINCT                                     08860000
088700                B.PREPK_ID                                        08870000
088800              , B.STATUS_CDE                                      08880000
088900              , B.VRFD_USR_ID                                     08890000
089000              , D.DEPT_NBR                                        08900000
089100          FROM    TRECEIV  A                                      08910000
089200              ,   TRECITM  B                                      08920000
089300              ,   TPURCHS  D                                      08930000
089400          WHERE A.ORD_NBR          =  :DK-PO-NBR                  08940000
089500           AND  A.ORD_NBR          =  B.ORD_NBR                   08950000
089600           AND  A.ORD_NBR          =  D.PO_NBR                    08960000
089700           AND  A.VER_STATUS_CDE   =  'A'                         08970000
089800           AND  B.VER_STATUS_CDE   =  'A'                         08980000
089900           AND  D.VER_STATUS_CDE   =  'A'                         08990000
090000           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             09000000
090100           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               09010000
090200           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                09020000
090300           AND  A.FCLTY_ID         =  B.FCLTY_ID                  09030000
090400           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             09040000
090500           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               09050000
090600          ORDER BY                                                09060000
090700                B.PREPK_ID                                        09070000
090800     END-EXEC.                                                    09080000
090900                                                                  09090000
091000                                                                  09100000
091100                                                                  09110000
091200     EXEC SQL                                                     09120000
091300          DECLARE LINE-CSR CURSOR                                 09130000
091400          FOR SELECT                                              09140000
091500                ORD_LNE_NBR                                       09150000
091600             ,  CASE PREPK_DRV_LNE_CDE                            09160000
091700                     WHEN 'A'  THEN 'A'                           09170000
091800                     ELSE  ' '                                    09180000
091900                END                                               09190000
092000          FROM                                                    09200000
092100                TRECITM                                           09210000
092200          WHERE                                                   09220000
092300                ORD_NBR          =  :DK-PO-NBR                    09230000
092400           AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR               09240000
092500           AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID               09250000
092600           AND  FCLTY_ID         =  :DK-FCLTY-ID                  09260000
092700           AND  VER_STATUS_CDE   =  'A'                           09270000
092800           AND  PREPK_ID         = :DK-PREPK-ID                   09280000
092900          ORDER BY 2                                              09290000
093000                                                                  09300000
093100                                                                  09310000
093200     END-EXEC.                                                    09320000
093300                                                                  09330000
093400                                                                  09340000
093500 EJECT                                                            09350000
093600 LINKAGE SECTION.                                                 09360000
093700                                                                  09370000
093800 01  DFHCOMMAREA.                                                 09380000
093900     05  FILLER                         OCCURS  1 TO 4072 TIMES   09390000
094000                                        DEPENDING ON EIBCALEN.    09400000
094100         10  FILLER                     PIC X.                    09410000
094200                                                                  09420000
094300 EJECT                                                            09430000
094400 PROCEDURE DIVISION.                                              09440000
094500******************************************************************09450000
094600**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09460000
094700**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09470000
094800**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09480000
094900******************************************************************09490000
095000 0000-MAIN-MODULE.                                                09500000
095100     INITIALIZE DP030-CICS-API-FIELDS.                            09510000
095200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09520000
095300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09530000
095400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09540000
095500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09550000
095600     MOVE LENGTH OF RC817AI        TO DP030-MAP-LENGTH (1).       09560000
095700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09570000
095800     PERFORM 0001-CALL-CICS-ARCH-API.                             09580000
095900*                                                                 09590000
096000     PERFORM 1000-CONTROL-PROCESSING                              09600000
096100*                                                                 09610000
096200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09620000
096300     PERFORM 0001-CALL-CICS-ARCH-API.                             09630000
096400                                                                  09640000
096500******************************************************************09650000
096600**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09660000
096700**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **09670000
096800******************************************************************09680000
096900 0001-CALL-CICS-ARCH-API.                                         09690000
097010     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09701005
097100                                    DFHCOMMAREA                   09710005
097200                                    DP030-CICS-API-FIELDS         09720005
097300                                    DP020-STANDARD-COMMAREA       09730005
097400                                    RC817AI.                      09740005
097500*                                                                 09750000
097600     IF  DP030-RC-CALL-SUCCESSFUL                                 09760000
097700         CONTINUE                                                 09770000
097800     ELSE                                                         09780000
097900         SET DP013-NO-ROLLBACK                                    09790000
098000             DP013-XCTL-DISPLAY-RESTART                           09800000
098100             DP013-CICS-ABEND      TO TRUE                        09810000
098200         MOVE '0001-CALL-CICS-ARCH-API'                           09820000
098300                                   TO DP013-PARAGRAPH             09830000
098320         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O09832005
098330-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09833005
098600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09860000
098700         PERFORM DP013-0000-PROCESS-ABEND                         09870000
098800     END-IF.                                                      09880000
098900*----------------------------------------------------------------*09890000
099000* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09900000
099100* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09910000
099200*                                                                *09920000
099300* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09930000
099400*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09940000
099500*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09950000
099600*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09960000
099700*----------------------------------------------------------------*09970000
099800                                                                  09980000
099900 1000-CONTROL-PROCESSING.                                         09990000
100000                                                                  10000000
100100     EVALUATE TRUE                                                10010000
100200         WHEN DP020-NEXT-ACT-INITIAL                              10020000
100300             INITIALIZE ASC-SPECIFIC-COMMAREA                     10030000
100400             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10040000
100500                                      ASC-SEL-TERM-ID-OUT         10050000
100600             MOVE DP020-SRC-TASK-NUMBER                           10060000
100700                                   TO ASC-LIST-TASK-NUMBER        10070000
100800                                      ASC-SEL-TASK-NUMBER-OUT     10080000
100900             MOVE PC-LIST-QUEUE-SEQ                               10090000
101000                                   TO ASC-LIST-SEQ                10100000
101100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             10110000
101200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10120000
101300***-----$TEMPLATE NOTE$-------------------------------------------10130000
101400*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,10140000
101500*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  10150000
101600*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.10160000
101700***---------------------------------------------------------------10170000
101800             IF  PS-COMMAREA-NOT-VALID                            10180000
101900***              MOVE PC-TSYMSG-99901                             10190000
102000***                                TO DP020-MSG-NUMBER            10200000
102100***              SET DP020-MSG-FATAL                              10210000
102200***                                TO TRUE                        10220000
102300                 SET DP020-NEXT-ACT-APPL-ERROR                    10230000
102400                                   TO TRUE                        10240000
102500             ELSE                                                 10250000
102600                 PERFORM 4000-BUILD-INITIAL-PANEL                 10260000
102700             END-IF                                               10270000
102800                                                                  10280000
102900         WHEN DP020-NEXT-ACT-READ-MAP                             10290000
103000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10300000
103100                                   TO PV-TOP-ITEM                 10310000
103200             PERFORM 2000-PROCESS-PANEL                           10320000
103300                                                                  10330000
103400         WHEN DP020-NEXT-ACT-RETURN                               10340000
103500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10350000
103600                                   TO PV-TOP-ITEM                 10360000
103700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10370000
103800             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 10380000
103900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10390000
104000*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10400000
104100                                                                  10410000
104200         WHEN OTHER                                               10420000
104300             SET DP013-LOGIC-ABEND TO TRUE                        10430000
104400             SET DP013-NO-ROLLBACK TO TRUE                        10440000
104500             MOVE '1000-CONTROL-PROCESSING'                       10450000
104600                                   TO DP013-PARAGRAPH             10460000
104700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10470000
104800                                   TO DP013-MESSAGE-TEXT(1)       10480000
104900             PERFORM DP013-0000-PROCESS-ABEND                     10490000
105000     END-EVALUATE.                                                10500000
105100                                                                  10510000
105200 EJECT                                                            10520000
105300*----------------------------------------------------------------*10530000
105400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10540000
105500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10550000
105600*----------------------------------------------------------------*10560000
105700                                                                  10570000
105800 1100-PROCESS-INTER-APPL-COMM.                                    10580000
105900                                                                  10590000
106000     SET PS-COMMAREA-VALID         TO TRUE.                       10600000
106100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10610000
106200     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT OR       10620000
106300         DP020-INT-APPL-FORMAT-IND = PC-POST-VERFY-CRIT-SPEC-FMT  10630000
106400         IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT      10640000
106500             SET ASC-NOT-POST-VERIFIED-RECEIPT  TO TRUE           10650000
106600         ELSE                                                     10660000
106700             SET ASC-POST-VERIFIED-RECEIPT      TO TRUE           10670000
106800         END-IF                                                   10680000
106900         MOVE RC017-OPER-UNT-ID    TO  ASC-OPER-UNT-ID            10690000
107000         MOVE RC017-FCLTY-ID       TO  ASC-FCLTY-ID               10700000
107100         MOVE RC017-PO-NBR         TO  ASC-PO-NBR                 10710000
107200         MOVE RC017-REC-SEQ-NBR    TO  ASC-REC-SEQ-NBR            10720000
107300         MOVE RC017-FCLTY-NME      TO  ASC-FCLTY-NME              10730000
107400         MOVE RC017-TRB-QUEUE-NAME TO  ASC-TRB-QUEUE-NAME         10740000
107500         MOVE ASC-TRB-QUEUE-NAME   TO  RC036-TRB-QUEUE-NAME       10750000
107600                                                                  10760000
107700         IF  RC017-PO-LNE-NBR GREATER THAN ZERO                   10770000
107800             MOVE RC017-PO-LNE-NBR     TO  ASC-PO-LNE-NBR         10780000
107900         ELSE                                                     10790000
108000             MOVE ZERO                 TO  ASC-PO-LNE-NBR         10800000
108100         END-IF                                                   10810000
108200     END-IF.                                                      10820000
108300                                                                  10830000
108400 EJECT                                                            10840000
108500*----------------------------------------------------------------*10850000
108600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10860000
108700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10870000
108800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10880000
108900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10890000
109000* FUNCTION KEYS CAN GET THIS FAR.                                *10900000
109100*----------------------------------------------------------------*10910000
109200                                                                  10920000
109300 2000-PROCESS-PANEL.                                              10930000
109400     EVALUATE TRUE                                                10940000
109500         WHEN DP020-SRC-AID = DP016-CLEAR                         10950000
109600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10960000
109700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10970000
109800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10980000
109900                                                                  10990000
110000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11000000
110100             MOVE 0          TO ASC-TOT-PKSLIP-PACKS              11010000
110200                                ASC-TOT-ACTUAL-PACKS              11020000
110300                                ASC-TOT-VERFYD-PACKS              11030000
110400                                ASC-TOT-ODD-UNITS                 11040000
110500                                ASC-HDR-TOT-ACT-UNTS              11050000
110600                                ASC-HDR-TOT-VERFYD-UNTS           11060000
110700             PERFORM 2050-DELETE-LIST-QUEUE                       11070000
110800             PERFORM 4000-BUILD-INITIAL-PANEL                     11080000
110900                                                                  11090000
111000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11100000
111100             PERFORM 2140-DESELECT-ALL-ITEMS                      11110000
111200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11120000
111300                                                                  11130000
111400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11140000
111500             PERFORM 2150-SELECT-ALL-ITEMS                        11150000
111600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11160000
111700                                                                  11170000
111800         WHEN OTHER                                               11180000
111900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11190000
112000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11200000
112100             IF  PS-NO-ERROR                                      11210000
112200                 SET DP030-CONTINUE-GO                            11220000
112300                                 TO TRUE                          11230000
112400                 PERFORM 2100-CHECK-FUNCTION-KEY                  11240000
112500             ELSE                                                 11250000
112600                 SET DP030-OVERRIDE-GO                            11260000
112700                                 TO TRUE                          11270000
112800             END-IF                                               11280000
112900     END-EVALUATE.                                                11290000
113000 EJECT                                                            11300000
113100*----------------------------------------------------------------*11310000
113200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11320000
113300*----------------------------------------------------------------*11330000
113400 2050-DELETE-LIST-QUEUE.                                          11340000
113500                                                                  11350000
113600     EXEC CICS                                                    11360000
113700         DELETEQ TS                                               11370000
113800             QUEUE (ASC-LIST-QUEUE-NAME)                          11380000
113900             RESP  (PV-CICS-RESP)                                 11390000
114000     END-EXEC.                                                    11400000
114100                                                                  11410000
114200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11420000
114300        (PV-CICS-RESP = DFHRESP(QIDERR))                          11430000
114400         CONTINUE                                                 11440000
114500     ELSE                                                         11450000
114600         SET DP013-CICS-ABEND      TO TRUE                        11460000
114700         SET DP013-NO-ROLLBACK     TO TRUE                        11470000
114800                                                                  11480000
114900         MOVE '2050-DELETE-LIST-QUEUE'                            11490000
115000                                   TO DP013-PARAGRAPH             11500000
115100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11510000
115200                                   TO DP013-MESSAGE-TEXT (1)      11520000
115300         PERFORM DP013-0000-PROCESS-ABEND                         11530000
115400     END-IF.                                                      11540000
115500                                                                  11550000
115600     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11560000
115700 EJECT                                                            11570000
115800*----------------------------------------------------------------*11580000
115900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11590000
116000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11600000
116100* CICS ARCHITECTURE API.                                         *11610000
116200*----------------------------------------------------------------*11620000
116300 2100-CHECK-FUNCTION-KEY.                                         11630000
116400     EVALUATE TRUE                                                11640000
116500****    PF14  GO TO RECEIVER PACK LIST                            11650000
116600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11660000
116700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11670000
116800                 INITIALIZE RC800-INTER-APPL-COMMAREA             11680000
116900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11690000
117000                                TO RC036-NUMBER-OF-SELECTED-ITEMS 11700000
117100                 SET ASC-RETURNING-FROM-RCVG TO TRUE              11710000
117200                 PERFORM 5000-PREPARE-SEL-QUEUE                   11720000
117300             ELSE                                                 11730000
117400                 SET DP030-OVERRIDE-GO                            11740000
117500                                   TO TRUE                        11750000
117600                 MOVE PC-TSYMSG-00057                             11760000
117700                                   TO DP020-MSG-NUMBER            11770000
117800                 SET DP020-MSG-WARNING                            11780000
117900                                   TO TRUE                        11790000
118000             END-IF                                               11800000
118100                                                                  11810000
118200****    PF15  VERIFY                                              11820000
118300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11830000
118400         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               11840000
118500             SET RC039-FUNC-VRFY           TO TRUE                11850000
118600             PERFORM 2108-LINK-FKEY-MODULE                        11860000
118700             IF RC039-FUNCTION-NO                                 11870000
118800                 MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER     11880000
118900                 SET DP020-MSG-WARNING TO TRUE                    11890000
119000             ELSE                                                 11900000
119100                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          11910000
119200                   IF ASC-STOP-VERIFY                             11920000
119300                     MOVE PC-TSYMSG-03231  TO                     11930000
119400                                     DP020-MSG-NUMBER             11940000
119500                     SET DP020-MSG-FATAL                          11950000
119600                         PS-ERROR      TO  TRUE                   11960000
119700                     SET PS-CANT-VERIFY                           11970000
119800                                       TO  TRUE                   11980000
119900                   ELSE                                           11990000
120000                    IF ASC-CONFIRM-VERIFY                         12000000
120100                        SET  ASC-CONFIRM-ZERO TO  TRUE            12010000
120200                        MOVE PC-TSYMSG-01876  TO                  12020000
120300                                       DP020-MSG-NUMBER           12030000
120400                        SET DP020-MSG-WARNING TO TRUE             12040000
120500                    ELSE                                          12050000
120600                     PERFORM 5050-PREPARE-TO-VERIFY               12060000
120700                     IF  NOT PS-ERROR                             12070000
120800                         MOVE PC-TSYMSG-00059                     12080000
120900                                       TO  DP020-MSG-NUMBER       12090000
121000                         SET DP020-MSG-INFORMATIONAL              12100000
121100                                       TO  TRUE                   12110000
121200                     END-IF                                       12120000
121300                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                12130000
121400                                       TO  PV-TOP-ITEM            12140000
121500                     MOVE ZERO       TO  ASC-ITEM-AT-TOP-OF-PANEL 12150000
121600                                                                  12160000
121700                     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL     12170000
121800                         GIVING PV-BLOCK-NUMBER                   12180000
121900                         REMAINDER PV-REMAINDER                   12190000
122000                     IF  PV-REMAINDER > ZERO                      12200000
122100                         ADD +1 TO PV-BLOCK-NUMBER                12210000
122200                     END-IF                                       12220000
122300                                                                  12230000
122400                     MOVE +1        TO ASC-BLK-SUB                12240000
122500                     PERFORM 4410-READ-TEMP-STORAGE               12250000
122600                     ADD +1         TO ASC-BLK-SUB                12260000
122700                                       PV-BLOCK-NUMBER            12270000
122800                     PERFORM 4410-READ-TEMP-STORAGE               12280000
122900                     PERFORM 4330-SUM-TRECDIS-ALL                 12290000
123000                             MOVE RECDIS-VERIFY-ITM-QTY           12300000
123100                               TO  ASC-TOT-ACT-QTY                12310000
123200                             MOVE RECDIS-AP-VERIFY-ITM-QTY        12320000
123300                               TO  ASC-TOT-VFY-QTY                12330000
123400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12340000
123500                    END-IF                                        12350000
123600                   END-IF                                         12360000
123700                 ELSE                                             12370000
123800                     SET DP030-OVERRIDE-GO                        12380000
123900                                       TO TRUE                    12390000
124000                     MOVE PC-TSYMSG-00057                         12400000
124100                                       TO DP020-MSG-NUMBER        12410000
124200                     SET DP020-MSG-WARNING                        12420000
124300                                       TO TRUE                    12430000
124400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12440000
124500                 END-IF                                           12450000
124600             END-IF                                               12460000
124700                                                                  12470000
124800****    PF17  UNVERIFY                                            12480000
124900* UNVERIFY                                                        12490000
125000         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               12500000
125100             SET RC039-FUNC-UNVRFY         TO TRUE                12510000
125200             IF ASC-REC-TYP-CDE = 'CD'                            12520000
125300                 MOVE PC-TSYMSG-03406     TO DP020-MSG-NUMBER     12530000
125400                 SET DP020-MSG-WARNING TO TRUE                    12540000
125500             ELSE                                                 12550000
125600               PERFORM 2108-LINK-FKEY-MODULE                      12560000
125700               IF RC039-FUNCTION-NO                               12570000
125800                   MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER   12580000
125900                   SET DP020-MSG-WARNING TO TRUE                  12590000
126000               ELSE                                               12600000
126100                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          12610000
126200                    PERFORM 2170-CHECK-RACF-ACCESS                12620000
126300                       SET PS-CONTINUE-FUNC-03 TO TRUE            12630000
126400                       IF DP008-ACCESS-DENIED                     12640000
126500*                        -- NO SECURITY CLEARANCE FOR FUNCTION -- 12650000
126600                          SET DP030-OVERRIDE-GO                   12660000
126700                                           TO TRUE                12670000
126800                          MOVE PC-TSYMSG-01061                    12680000
126900                                           TO DP020-MSG-NUMBER    12690000
127000                          SET DP020-MSG-WARNING                   12700000
127100                                 PS-END-FUNC-03 TO TRUE           12710000
127200                          SET DP020-MSG-FATAL                     12720000
127300                                  PS-ERROR  TO  TRUE              12730000
127400                       END-IF                                     12740000
127500                       IF PS-END-FUNC-03                          12750000
127600                           CONTINUE                               12760000
127700                       ELSE                                       12770000
127800                          IF ASC-CANT-UNVERIFY-FS                 12780000
127900                             MOVE PC-TSYMSG-01128 TO              12790000
128000                                                 DP020-MSG-NUMBER 12800000
128100                             SET DP020-MSG-FATAL                  12810000
128200                                 ASC-NOT-CONFIRM                  12820000
128300                                 ASC-NOT-CONFIRM-ZERO             12830000
128400                                 PS-ERROR    TO  TRUE             12840000
128500                          END-IF                                  12850000
128600                       END-IF                                     12860000
128700**               --- PRESS F2 TO CONFIRM ---                      12870000
128800                     IF NOT PS-ERROR                              12880000
128900                         SET ASC-CONFIRM TO TRUE                  12890000
129000                         SET ASC-CONFIRM-UNVERIFY TO TRUE         12900000
129100                                                                  12910000
129200                         MOVE PC-TSYMSG-01129 TO                  12920000
129300                                             DP020-MSG-NUMBER     12930000
129400                         SET DP020-MSG-WARNING TO TRUE            12940000
129500                     END-IF                                       12950000
129600                 ELSE                                             12960000
129700                     SET DP030-OVERRIDE-GO                        12970000
129800                                       TO TRUE                    12980000
129900                     MOVE PC-TSYMSG-00057                         12990000
130000                                       TO DP020-MSG-NUMBER        13000000
130100                     SET DP020-MSG-WARNING                        13010000
130200                                       TO TRUE                    13020000
130300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13030000
130400                 END-IF                                           13040000
130500               END-IF                                             13050000
130600             END-IF                                               13060000
130700********   RESET SWITCHES AFTER UPDATE IS SUCCESSFUL (UNVERIFY)   13070000
130800********         IF  NOT PS-ERROR                                 13080000
130900********             MOVE PC-TSYMSG-00059                         13090000
131000********                           TO  DP020-MSG-NUMBER           13100000
131100********             SET DP020-MSG-INFORMATIONAL                  13110000
131200********                           TO  TRUE                       13120000
131300********             SET ASC-CANT-UNVERIFY                        13130000
131400********                 ASC-NOT-CONFIRM                          13140000
131500********                 ASC-NOT-CONFIRM-ZERO TO TRUE             13150000
131600********         END-IF                                           13160000
131700                                                                  13170000
131800                                                                  13180000
131900****    PF18  GO TO NOTIFY/TRBL DC LIST                           13190000
132000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              13200000
132100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13210000
132200                 INITIALIZE TM001-INTER-APPL-COMMAREA             13220000
132300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13230000
132400                                TO RC036-NUMBER-OF-SELECTED-ITEMS 13240000
132500                 SET ASC-RETURNING-FROM-TRBL TO TRUE              13250000
132600                 PERFORM 5000-PREPARE-SEL-QUEUE                   13260000
132700             ELSE                                                 13270000
132800                 SET DP030-OVERRIDE-GO                            13280000
132900                                   TO TRUE                        13290000
133000                 MOVE PC-TSYMSG-00057                             13300000
133100                                   TO DP020-MSG-NUMBER            13310000
133200                 SET DP020-MSG-WARNING                            13320000
133300                                   TO TRUE                        13330000
133400             END-IF                                               13340000
133500                                                                  13350000
133600****    PF23  GO TO STORE PACK VERIFICATION ADJUSTMENT            13360000
133700         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              13370000
133800             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13380000
133900                 INITIALIZE RC036-INTER-APPL-COMMAREA             13390000
134000                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13400000
134100                                TO RC036-NUMBER-OF-SELECTED-ITEMS 13410000
134200                 SET ASC-RETURNING-FROM-STR-PACK TO TRUE          13420000
134300                 PERFORM 5000-PREPARE-SEL-QUEUE                   13430000
134400             ELSE                                                 13440000
134500                 SET DP030-OVERRIDE-GO                            13450000
134600                                   TO TRUE                        13460000
134700                 MOVE PC-TSYMSG-00057                             13470000
134800                                   TO DP020-MSG-NUMBER            13480000
134900                 SET DP020-MSG-WARNING                            13490000
135000                                   TO TRUE                        13500000
135100             END-IF                                               13510000
135200                                                                  13520000
135300****    PF24  VERIFY ATO                                          13530000
135400         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              13540000
135500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13550000
135600               IF  ASC-AUTO-VE-YES                                13560000
135700                   SET DP030-OVERRIDE-GO TO TRUE                  13570000
135800                   MOVE PC-TSYMSG-03303  TO DP020-MSG-NUMBER      13580000
135900                   SET DP020-MSG-WARNING TO TRUE                  13590000
136000               ELSE                                               13600000
136100                   SET ASC-CONFIRM  TO TRUE                       13610000
136200                   IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)      13620000
136300                       MOVE PC-TSYMSG-01818  TO                   13630000
136400                                     DP020-MSG-NUMBER             13640000
136500                   ELSE                                           13650000
136600                       SET  ASC-CONFIRM-ZERO TO  TRUE             13660000
136700                       MOVE PC-TSYMSG-01876  TO                   13670000
136800                                     DP020-MSG-NUMBER             13680000
136900                   END-IF                                         13690000
137000                   SET DP020-MSG-WARNING TO TRUE                  13700000
137100               END-IF                                             13710000
137200                                                                  13720000
137300             ELSE                                                 13730000
137400                   SET DP030-OVERRIDE-GO TO  TRUE                 13740000
137500                   MOVE PC-TSYMSG-00057                           13750000
137600                                   TO DP020-MSG-NUMBER            13760000
137700                   SET DP020-MSG-WARNING TO TRUE                  13770000
137800             END-IF                                               13780000
137900                                                                  13790000
138000* CONFIRM                                                         13800000
138100         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    13810000
138200             IF ASC-NOT-CONFIRM AND                               13820000
138300                ASC-NOT-CONFIRM-ZERO                              13830000
138400                 MOVE PC-TSYMSG-00045   TO  DP020-MSG-NUMBER      13840000
138500                 SET DP020-MSG-FATAL                              13850000
138600                             PS-ERROR        TO  TRUE             13860000
138700             ELSE                                                 13870000
138800               IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO            13880000
138900                 IF ASC-CONFIRM-UNVERIFY                          13890000
139000                   PERFORM 5060-PREPARE-TO-UNVERIFY               13900000
139100                   MOVE SPACE TO ASC-CONFIRM-VERIFY-SW            13910000
139200                   IF  NOT PS-ERROR                               13920000
139300                       MOVE PC-TSYMSG-00059                       13930000
139400                                     TO  DP020-MSG-NUMBER         13940000
139500                       SET DP020-MSG-INFORMATIONAL                13950000
139600                                     TO  TRUE                     13960000
139700                       SET ASC-CANT-UNVERIFY                      13970000
139800                           ASC-NOT-CONFIRM                        13980000
139900                           ASC-NOT-CONFIRM-ZERO TO TRUE           13990000
140000                   END-IF                                         14000000
140100                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                  14010000
140200                                     TO  PV-TOP-ITEM              14020000
140300                   MOVE ZERO         TO  ASC-ITEM-AT-TOP-OF-PANEL 14030000
140400                                                                  14040000
140500                   DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL       14050000
140600                       GIVING PV-BLOCK-NUMBER                     14060000
140700                       REMAINDER PV-REMAINDER                     14070000
140800                   IF  PV-REMAINDER > ZERO                        14080000
140900                       ADD +1 TO PV-BLOCK-NUMBER                  14090000
141000                   END-IF                                         14100000
141100                                                                  14110000
141200                   MOVE +1        TO ASC-BLK-SUB                  14120000
141300                   PERFORM 4410-READ-TEMP-STORAGE                 14130000
141400                   ADD +1         TO ASC-BLK-SUB                  14140000
141500                                     PV-BLOCK-NUMBER              14150000
141600                   PERFORM 4410-READ-TEMP-STORAGE                 14160000
141700                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           14170000
141800                 ELSE                                             14180000
141900                   IF ASC-CONFIRM-ZERO OR                         14190000
142000                      ASC-CONFIRM-VERIFY                          14200000
142100                      MOVE SPACE TO ASC-CONFIRM-VERIFY-SW         14210000
142200                      PERFORM 5050-PREPARE-TO-VERIFY              14220000
142300                      IF  NOT PS-ERROR                            14230000
142400                          MOVE PC-TSYMSG-00059                    14240000
142500                                        TO  DP020-MSG-NUMBER      14250000
142600                          SET DP020-MSG-INFORMATIONAL             14260000
142700                                        TO  TRUE                  14270000
142800                      SET  ASC-NOT-CONFIRM                        14280000
142900                           ASC-NOT-CONFIRM-ZERO TO TRUE           14290000
143000                      END-IF                                      14300000
143100                      MOVE ASC-ITEM-AT-TOP-OF-PANEL               14310000
143200                                      TO  PV-TOP-ITEM             14320000
143300                      MOVE ZERO       TO  ASC-ITEM-AT-TOP-OF-PANEL14330000
143400                                                                  14340000
143500                      DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL    14350000
143600                          GIVING PV-BLOCK-NUMBER                  14360000
143700                          REMAINDER PV-REMAINDER                  14370000
143800                      IF  PV-REMAINDER > ZERO                     14380000
143900                          ADD +1 TO PV-BLOCK-NUMBER               14390000
144000                      END-IF                                      14400000
144100                                                                  14410000
144200                      MOVE +1        TO ASC-BLK-SUB               14420000
144300                      PERFORM 4410-READ-TEMP-STORAGE              14430000
144400                      ADD +1         TO ASC-BLK-SUB               14440000
144500                                        PV-BLOCK-NUMBER           14450000
144600                      PERFORM 4410-READ-TEMP-STORAGE              14460000
144700                      PERFORM 4330-SUM-TRECDIS-ALL                14470000
144800                              MOVE RECDIS-VERIFY-ITM-QTY          14480000
144900                                TO  ASC-TOT-ACT-QTY               14490000
145000                              MOVE RECDIS-AP-VERIFY-ITM-QTY       14500000
145100                                TO  ASC-TOT-VFY-QTY               14510000
145200                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        14520000
145300                      MOVE SPACE TO ASC-CONFIRM-ZERO-SW           14530000
145400                   END-IF                                         14540000
145500                   END-IF                                         14550000
145600               ELSE                                               14560000
145700                   SET DP030-OVERRIDE-GO                          14570000
145800                                     TO TRUE                      14580000
145900                   MOVE PC-TSYMSG-00057                           14590000
146000                                     TO DP020-MSG-NUMBER          14600000
146100                   SET DP020-MSG-WARNING                          14610000
146200                                     TO TRUE                      14620000
146300                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           14630000
146400               END-IF                                             14640000
146500             END-IF                                               14650000
146600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14660000
146700             MOVE +1               TO PV-TOP-ITEM                 14670000
146800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14680000
146900                                                                  14690000
147000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14700000
147100             PERFORM 3200-RESET-ATTRIBUTES                        14710000
147200             PERFORM 2110-BROWSE-BACKWARD                         14720000
147300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14730000
147400                                                                  14740000
147500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14750000
147600             PERFORM 2120-BROWSE-FORWARD                          14760000
147700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14770000
147800                                                                  14780000
147900         WHEN DP020-SRC-AID = DP016-ENTER                         14790000
148000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   14800000
148100             IF  PS-ERROR                                         14810000
148200                 CONTINUE                                         14820000
148300             ELSE                                                 14830000
148400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14840000
148500             END-IF                                               14850000
148600             MOVE SPACE TO ASC-CONFIRM-VERIFY-SW                  14860000
148700                                                                  14870000
148800********                                                          14880000
148900         WHEN OTHER                                               14890000
149000             SET DP013-NO-ROLLBACK                                14900000
149100                 DP013-XCTL-DISPLAY-RESTART                       14910000
149200                 DP013-CICS-ABEND  TO TRUE                        14920000
149300             MOVE '2100-CHECK-FUNCTION-KEY'                       14930000
149400                                   TO DP013-PARAGRAPH             14940000
149500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14950000
149600                                   TO DP013-MESSAGE-TEXT (1)      14960000
149700             PERFORM DP013-0000-PROCESS-ABEND                     14970000
149800     END-EVALUATE.                                                14980000
149900                                                                  14990000
150000*----------------------------------------------------------------*15000000
150100*    LINK TO F-KEY ELIGIBILITY MODULE (RCKUT126)                 *15010000
150200*----------------------------------------------------------------*15020000
150300 2108-LINK-FKEY-MODULE.                                           15030000
150400                                                                  15040000
150500     MOVE DP020-LOCATION-NBR TO RC039-SIGNON-LOCATION.            15050000
150600     MOVE ASC-OPER-UNT-ID   TO RC039-OPER-UNT-ID.                 15060000
150700     MOVE ASC-FCLTY-ID      TO RC039-FCLTY-ID.                    15070000
150800     MOVE ASC-PO-NBR        TO RC039-PO-NBR.                      15080000
150900     MOVE ASC-REC-SEQ-NBR   TO RC039-REC-SEQ-NBR.                 15090000
151000     MOVE 0                 TO RC039-PO-LNE-NBR.                  15100000
151100     MOVE 0                 TO RC039-PREPACK-ID.                  15110000
151200     MOVE DP020-USERID      TO RC039-USER-ID.                     15120000
151300     MOVE 'RCKCS817'        TO RC039-PROGRAM-NAME.                15130000
151400                                                                  15140000
151500     EXEC CICS                                                    15150000
151600          LINK PROGRAM (PC-FKEY-MODULE)                           15160000
151700          COMMAREA (RC039-FIELDS)                                 15170000
151800          LENGTH (PC-FKEY-MODULE-LENGTH)                          15180000
151900          RESP (PV-CICS-RESP)                                     15190000
152000     END-EXEC.                                                    15200000
152100                                                                  15210000
152200     EVALUATE TRUE                                                15220000
152300         WHEN RC039-SUCCESSFUL                                    15230000
152400            CONTINUE                                              15240000
152500                                                                  15250000
152600         WHEN RC039-DATABASE-BUSY                                 15260000
152700             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         15270000
152800             SET DP020-MSG-WARNING    TO TRUE                     15280000
152900                                                                  15290000
153000         WHEN RC039-INVALID-SQL                                   15300000
153100             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         15310000
153200             SET DP020-MSG-WARNING    TO TRUE                     15320000
153300                                                                  15330000
153400         WHEN OTHER                                               15340000
153500             MOVE '2108-LINK-FKEY-MODULE' TO DP013-PARAGRAPH      15350000
153600             MOVE 'UNSUCCESSFUL CALL TO FKEY ELIGIBILITY MODULE'  15360000
153700                                 TO DP013-MESSAGE-TEXT (1)        15370000
153800             MOVE RC039-SUCCESS-IND TO DP013-MESSAGE-TEXT (2)     15380000
153900             MOVE RC039-CRA-RET-MSG TO DP013-MESSAGE-TEXT (3)     15390000
154000             MOVE ASC-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        15400000
154100             MOVE ASC-FCLTY-ID      TO PV-DISP-FCLTY-ID           15410000
154200             MOVE ASC-PO-NBR        TO PV-DISP-PO-NBR             15420000
154300             MOVE ASC-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        15430000
154400                 STRING ' PO = '                                  15440000
154500                        PV-DISP-PO-NBR                            15450000
154600                        ' RECV ='                                 15460000
154700                        PV-DISP-REC-SEQ-NBR                       15470000
154800                        ' OPER = '                                15480000
154900                       PV-DISP-OPER-UNT-ID                        15490000
155000                        ' FCLTY = '                               15500000
155100                        PV-DISP-FCLTY-ID                          15510000
155200                                          DELIMITED BY SIZE       15520000
155300                                 INTO DP013-MESSAGE-TEXT (4)      15530000
155400             MOVE RC039-SQLCA    TO DP013-SQLCA                   15540000
155500             SET DP013-DB2-ABEND                                  15550000
155600                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              15560000
155700             PERFORM DP013-0000-PROCESS-ABEND                     15570000
155800     END-EVALUATE.                                                15580000
155900                                                                  15590000
156000*                                                                 15600000
156100*----------------------------------------------------------------*15610000
156200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *15620000
156300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *15630000
156400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *15640000
156500*    MESSAGE.                                                    *15650000
156600*----------------------------------------------------------------*15660000
156700                                                                  15670000
156800 2110-BROWSE-BACKWARD.                                            15680000
156900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15690000
157000         GIVING PV-TOP-ITEM.                                      15700000
157100*                                                                 15710000
157200     IF  ((PV-TOP-ITEM < +1)                                      15720000
157300       OR (PV-TOP-ITEM = +1))                                     15730000
157400         MOVE +1                   TO PV-TOP-ITEM                 15740000
157500*        -- TOP OF LIST --                                        15750000
157600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15760000
157700         SET DP020-MSG-INFORMATIONAL TO TRUE                      15770000
157800     END-IF.                                                      15780000
157900                                                                  15790000
158000 EJECT                                                            15800000
158100*----------------------------------------------------------------*15810000
158200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *15820000
158300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *15830000
158400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *15840000
158500*----------------------------------------------------------------*15850000
158600                                                                  15860000
158700 2120-BROWSE-FORWARD.                                             15870000
158800                                                                  15880000
158900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15890000
159000         GIVING PV-TOP-ITEM.                                      15900000
159100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15910000
159200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15920000
159300                                   TO PV-TOP-ITEM                 15930000
159400*        -- BOTTOM OF LIST --                                     15940000
159500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15950000
159600         SET DP020-MSG-INFORMATIONAL                              15960000
159700                                   TO TRUE                        15970000
159800     ELSE                                                         15980000
159900         COMPUTE PV-BOTTOM-ITEM =                                 15990000
160000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16000000
160100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16010000
160200*            -- BOTTOM OF LIST --                                 16020000
160300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16030000
160400             SET DP020-MSG-INFORMATIONAL                          16040000
160500                                   TO TRUE                        16050000
160600         END-IF                                                   16060000
160700     END-IF.                                                      16070000
160800 EJECT                                                            16080000
160900*----------------------------------------------------------------*16090000
161000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16100000
161100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16110000
161200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *16120000
161300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *16130000
161400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *16140000
161500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *16150000
161600*----------------------------------------------------------------*16160000
161700                                                                  16170000
161800 2130-CHECK-FOR-JUMP-BROWSE.                                      16180000
161900     SET PS-NO-ERROR               TO TRUE.                       16190000
162000     IF (ASC-START-ITEM-REQUEST = SPACE)                          16200000
162100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16210000
162200                                   TO PV-TOP-ITEM                 16220000
162300     ELSE                                                         16230000
162400         MOVE ASC-START-ITEM-REQUEST                              16240000
162500                                   TO DP010I-UNEDITED-FIELD       16250000
162600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       16260000
162700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     16270000
162800         SET DP010I-NEGATIVE-NOT-ALLOWED                          16280000
162900                                   TO TRUE                        16290000
163000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16300005
163010              USING DP010I-NUMERIC-EDIT-AREA                      16301005
163100                                                                  16310000
163200         IF  NOT DP010I-ERROR-DETECTED                            16320000
163300             MOVE DP010I-NUMERIC-FIELD                            16330000
163400                                   TO  ASC-START-ITEM-REQUEST-N   16340000
163500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  16350000
163600                 IF  ASC-START-ITEM-REQUEST-N >                   16360000
163700                                          ASC-NUMBER-OF-ITEMS-READ16370000
163800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         16380000
163900                     COMPUTE PV-TOP-ITEM =                        16390000
164000                             ASC-NUMBER-OF-ITEMS-READ             16400000
164100                             - PC-ITEMS-PER-PANEL + 1             16410000
164200                     IF  PV-TOP-ITEM < +1                         16420000
164300                         MOVE +1   TO PV-TOP-ITEM                 16430000
164400                         MOVE PC-TSYMSG-00070                     16440000
164500                                   TO DP020-MSG-NUMBER            16450000
164600                         SET DP020-MSG-INFORMATIONAL              16460000
164700                                   TO TRUE                        16470000
164800                     END-IF                                       16480000
164900                 ELSE                                             16490000
165000                     MOVE ASC-START-ITEM-REQUEST-N                16500000
165100                                   TO PV-TOP-ITEM                 16510000
165200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      16520000
165300                     COMPUTE PV-BOTTOM-ITEM =                     16530000
165400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16540000
165500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16550000
165600*                        -- BOTTOM OF LIST --                     16560000
165700                         MOVE PC-TSYMSG-00070                     16570000
165800                                   TO DP020-MSG-NUMBER            16580000
165900                         SET DP020-MSG-INFORMATIONAL              16590000
166000                                   TO TRUE                        16600000
166100                     END-IF                                       16610000
166200                 END-IF                                           16620000
166300             ELSE                                                 16630000
166400*                --- VALUE OUT OF RANGE ----                      16640000
166500                 MOVE PC-TSYMSG-00101                             16650000
166600                                   TO DP020-MSG-NUMBER            16660000
166700                 MOVE -1           TO ASTRTITL                    16670000
166800                 SET DP030-SET-CURSOR-APPL-1                      16680000
166900                                   TO TRUE                        16690000
167000                 MOVE DP015-REVERSE                               16700000
167100                                   TO ASTRTITH                    16710000
167200                 MOVE DP015-RED    TO ASTRTITC                    16720000
167300                 MOVE DP015-UNP-NUM-BRT-MDT                       16730000
167400                                   TO ASTRTITA                    16740000
167500                 SET DP020-MSG-FATAL                              16750000
167600                                   TO TRUE                        16760000
167700                 SET PS-ERROR      TO TRUE                        16770000
167800             END-IF                                               16780000
167900                                                                  16790000
168000         ELSE                                                     16800000
168100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16810000
168200             MOVE -1               TO ASTRTITL                    16820000
168300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16830000
168400             MOVE DP015-REVERSE    TO ASTRTITH                    16840000
168500             MOVE DP015-RED        TO ASTRTITC                    16850000
168600             MOVE DP015-UNP-NUM-BRT-MDT                           16860000
168700                                   TO ASTRTITA                    16870000
168800             SET DP020-MSG-FATAL   TO TRUE                        16880000
168900             SET PS-ERROR          TO TRUE                        16890000
169000         END-IF                                                   16900000
169100     END-IF.                                                      16910000
169200 EJECT                                                            16920000
169300*----------------------------------------------------------------*16930000
169400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *16940000
169500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *16950000
169600*----------------------------------------------------------------*16960000
169700 2140-DESELECT-ALL-ITEMS.                                         16970000
169800     MOVE +1                       TO ASC-BLK-SUB.                16980000
169900                                                                  16990000
170000     PERFORM 2141-CLEAR-SELECTED-INDS                             17000000
170100         VARYING ASC-ITEM-SUB                                     17010000
170200         FROM 1 BY 1                                              17020000
170300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17030000
170400                                                                  17040000
170500     ADD +1                        TO ASC-BLK-SUB.                17050000
170600                                                                  17060000
170700     PERFORM 2141-CLEAR-SELECTED-INDS                             17070000
170800         VARYING ASC-ITEM-SUB                                     17080000
170900         FROM 1 BY 1                                              17090000
171000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17100000
171100                                                                  17110000
171200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17120000
171300                                   TO PV-LIST-ITEM-NUMBER.        17130000
171400                                                                  17140000
171500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17150000
171600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17160000
171700                                                                  17170000
171800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17180000
171900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      17190000
172000         MOVE +1                   TO ASC-BLK-SUB                 17200000
172100                                                                  17210000
172200         PERFORM 5100-WRITE-TEMP-STORAGE                          17220000
172300                                                                  17230000
172400         MOVE +1                   TO PV-BLOCK-NUMBER             17240000
172500                                                                  17250000
172600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17260000
172700             PV-FIRST-BLOCK-IN-ARRAY - 1                          17270000
172800                                                                  17280000
172900         PERFORM                                                  17290000
173000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17300000
173100                                                                  17310000
173200             PERFORM 4410-READ-TEMP-STORAGE                       17320000
173300                                                                  17330000
173400             PERFORM 2141-CLEAR-SELECTED-INDS                     17340000
173500                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 17350000
173600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17360000
173700                                                                  17370000
173800             PERFORM 5100-WRITE-TEMP-STORAGE                      17380000
173900                                                                  17390000
174000             ADD +1                TO PV-BLOCK-NUMBER             17400000
174100                                                                  17410000
174200         END-PERFORM                                              17420000
174300                                                                  17430000
174400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17440000
174500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17450000
174600                                                                  17460000
174700         PERFORM                                                  17470000
174800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17480000
174900                   ASC-HIGHEST-BLOCK-WRITTEN                      17490000
175000                                                                  17500000
175100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17510000
175200                                   TO PV-BLOCK-NUMBER             17520000
175300                                                                  17530000
175400             PERFORM 4410-READ-TEMP-STORAGE                       17540000
175500                                                                  17550000
175600             PERFORM 2141-CLEAR-SELECTED-INDS                     17560000
175700                 VARYING ASC-ITEM-SUB                             17570000
175800                 FROM 1 BY 1                                      17580000
175900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17590000
176000                                                                  17600000
176100             PERFORM 5100-WRITE-TEMP-STORAGE                      17610000
176200                                                                  17620000
176300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17630000
176400                                                                  17640000
176500         END-PERFORM                                              17650000
176600                                                                  17660000
176700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17670000
176800                                   TO PV-BLOCK-NUMBER             17680000
176900                                                                  17690000
177000         PERFORM 4410-READ-TEMP-STORAGE                           17700000
177100     END-IF.                                                      17710000
177200                                                                  17720000
177300                                                                  17730000
177400     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 17740000
177500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.17750000
177600     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  17760000
177700                                                                  17770000
177800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17780000
177900                                                                  17790000
178000 EJECT                                                            17800000
178100*----------------------------------------------------------------*17810000
178200*    MARK EACH ITEM AS BEING NOT SELECTED.                       *17820000
178300*----------------------------------------------------------------*17830000
178400                                                                  17840000
178500 2141-CLEAR-SELECTED-INDS.                                        17850000
178600                                                                  17860000
178700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17870000
178800             NOT EQUAL ZERO                                       17880000
178900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17890000
179000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17900000
179100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17910000
179200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17920000
179300                                   TO TRUE                        17930000
179400         END-IF                                                   17940000
179500     END-IF.                                                      17950000
179600                                                                  17960000
179700 EJECT                                                            17970000
179800*----------------------------------------------------------------*17980000
179900*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *17990000
180000*  FOR ALL ITEMS.                                                *18000000
180100*----------------------------------------------------------------*18010000
180200                                                                  18020000
180300 2150-SELECT-ALL-ITEMS.                                           18030000
180400                                                                  18040000
180500     MOVE +1                       TO ASC-BLK-SUB.                18050000
180600                                                                  18060000
180700     PERFORM 2151-SET-SELECTED-INDS                               18070000
180800         VARYING ASC-ITEM-SUB                                     18080000
180900         FROM 1 BY 1                                              18090000
181000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18100000
181100                                                                  18110000
181200     ADD +1                        TO ASC-BLK-SUB.                18120000
181300                                                                  18130000
181400     PERFORM 2151-SET-SELECTED-INDS                               18140000
181500         VARYING ASC-ITEM-SUB                                     18150000
181600         FROM 1 BY 1                                              18160000
181700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18170000
181800                                                                  18180000
181900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18190000
182000                                   TO PV-LIST-ITEM-NUMBER.        18200000
182100                                                                  18210000
182200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18220000
182300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18230000
182400                                                                  18240000
182500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18250000
182600        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18260000
182700         MOVE +1                   TO ASC-BLK-SUB                 18270000
182800                                                                  18280000
182900         PERFORM 5100-WRITE-TEMP-STORAGE                          18290000
183000                                                                  18300000
183100         MOVE +1                   TO PV-BLOCK-NUMBER             18310000
183200                                                                  18320000
183300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18330000
183400             PV-FIRST-BLOCK-IN-ARRAY - 1                          18340000
183500                                                                  18350000
183600         PERFORM                                                  18360000
183700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18370000
183800                                                                  18380000
183900             PERFORM 4410-READ-TEMP-STORAGE                       18390000
184000                                                                  18400000
184100             PERFORM 2151-SET-SELECTED-INDS                       18410000
184200                 VARYING ASC-ITEM-SUB                             18420000
184300                 FROM 1 BY 1                                      18430000
184400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18440000
184500                                                                  18450000
184600             PERFORM 5100-WRITE-TEMP-STORAGE                      18460000
184700                                                                  18470000
184800             ADD +1                TO PV-BLOCK-NUMBER             18480000
184900                                                                  18490000
185000         END-PERFORM                                              18500000
185100                                                                  18510000
185200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18520000
185300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18530000
185400                                                                  18540000
185500         PERFORM                                                  18550000
185600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18560000
185700                   ASC-HIGHEST-BLOCK-WRITTEN                      18570000
185800                                                                  18580000
185900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18590000
186000                                   TO PV-BLOCK-NUMBER             18600000
186100                                                                  18610000
186200             PERFORM 4410-READ-TEMP-STORAGE                       18620000
186300                                                                  18630000
186400             PERFORM 2151-SET-SELECTED-INDS                       18640000
186500                 VARYING ASC-ITEM-SUB                             18650000
186600                 FROM 1 BY 1                                      18660000
186700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18670000
186800                                                                  18680000
186900             PERFORM 5100-WRITE-TEMP-STORAGE                      18690000
187000                                                                  18700000
187100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18710000
187200                                                                  18720000
187300         END-PERFORM                                              18730000
187400                                                                  18740000
187500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18750000
187600                                   TO PV-BLOCK-NUMBER             18760000
187700                                                                  18770000
187800         PERFORM 4410-READ-TEMP-STORAGE                           18780000
187900     END-IF.                                                      18790000
188000                                                                  18800000
188100                                                                  18810000
188200     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18820000
188300                       ASC-NUMBER-OF-SELECTED-ITEMS.              18830000
188400                                                                  18840000
188500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18850000
188600                                                                  18860000
188700 EJECT                                                            18870000
188800*----------------------------------------------------------------*18880000
188900*    MARK EACH ITEM AS BEING SELECTED.                           *18890000
189000*----------------------------------------------------------------*18900000
189100                                                                  18910000
189200 2151-SET-SELECTED-INDS.                                          18920000
189300                                                                  18930000
189400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18940000
189500             NOT EQUAL ZERO                                       18950000
189600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18960000
189700             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18970000
189800                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18980000
189900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18990000
190000                               TO  TRUE                           19000000
190100         END-IF                                                   19010000
190200     END-IF.                                                      19020000
190300/                                                                 19030000
190400*----------------------------------------------------------------*19040000
190500*    MARK EACH ITEM AS BEING SELECTED.                           *19050000
190600*----------------------------------------------------------------*19060000
190700                                                                  19070000
190800 2170-CHECK-RACF-ACCESS.                                          19080000
190900     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         19090000
191000     MOVE 'RCUNVER '              TO DP008-FUNCTION-NAME          19100000
191100     SET DP008-ACCESS-TYPE-USE    TO TRUE                         19110000
191200                                                                  19120000
191300     EXEC CICS                                                    19130000
191400        LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                  19140000
191500             COMMAREA (DP008-SECURITY-COMMAREA)                   19150000
191600             LENGTH (DP008-SECURITY-COMMAREA-LENGTH)              19160000
191700     END-EXEC                                                     19170000
191800                                                                  19180000
191900     IF DP008-CALL-SUCCESSFUL                                     19190000
192000         CONTINUE                                                 19200000
192100     ELSE                                                         19210000
192200        MOVE '2170-CHECK-RACF-ACCESS'                             19220000
192300                              TO DP013-PARAGRAPH                  19230000
192400         MOVE 'UNABLE TO ACCESS CICS'                             19240000
192500                              TO DP013-MESSAGE-TEXT (1)           19250000
192600         MOVE SQLCA           TO DP013-SQLCA                      19260000
192700         SET DP013-DB2-ABEND                                      19270000
192800             DP013-XCTL-DISPLAY-RESTART                           19280000
192900                              TO TRUE                             19290000
193000         PERFORM DP013-0000-PROCESS-ABEND                         19300000
193100     END-IF.                                                      19310000
193110                                                                  19311003
193111****************************************************************  19311103
193112* CHECK TO SEE IF ALLOW EFC POST VE ADJUSTMENTS EVEN IF THE       19311203
193113* PREPACK RATIO = 0                                               19311303
193114* DMH ADDED - 10/27/17                                            19311403
193115****************************************************************  19311503
193120 2175-CHECK-RACF-ACCESS-EFC.                                      19312003
193130     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         19313003
193140     MOVE 'EFCVEADJ'              TO DP008-FUNCTION-NAME          19314003
193150     SET DP008-ACCESS-TYPE-USE    TO TRUE                         19315003
193160                                                                  19316003
193170     EXEC CICS                                                    19317003
193180        LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                  19318003
193190             COMMAREA (DP008-SECURITY-COMMAREA)                   19319003
193191             LENGTH (DP008-SECURITY-COMMAREA-LENGTH)              19319103
193192     END-EXEC                                                     19319203
193193                                                                  19319303
193194     IF DP008-CALL-SUCCESSFUL                                     19319403
193195         CONTINUE                                                 19319503
193196     ELSE                                                         19319603
193197        MOVE '2175-CHECK-RACF-ACCESS-EFC'                         19319703
193198                              TO DP013-PARAGRAPH                  19319803
193199         MOVE 'UNABLE TO ACCESS CICS'                             19319903
193200                              TO DP013-MESSAGE-TEXT (1)           19320003
193201         MOVE SQLCA           TO DP013-SQLCA                      19320103
193202         SET DP013-DB2-ABEND                                      19320203
193203             DP013-XCTL-DISPLAY-RESTART                           19320303
193204                              TO TRUE                             19320403
193205         PERFORM DP013-0000-PROCESS-ABEND                         19320503
193206     END-IF.                                                      19320603
193207                                                                  19320703
193208                                                                  19320803
193210******************************************************************19321000
193300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **19330000
193400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **19340000
193500******************************************************************19350000
193600 2200-MOVE-SCREEN-TO-COMMAREA.                                    19360000
193700                                                                  19370000
193800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             19380000
193900     MOVE +1                       TO PV-SUB.                     19390000
194000*                                                                 19400000
194100     PERFORM 3100-SET-SUBSCRIPTS.                                 19410000
194200     IF  ASTRTITL > ZERO                                          19420000
194300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          19430000
194400     ELSE                                                         19440000
194500         IF  ASTRTITF = DP015-ERASE-EOF                           19450000
194600             INITIALIZE ASC-START-ITEM-REQUEST                    19460000
194700         END-IF                                                   19470000
194800     END-IF.                                                      19480000
194900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          19490000
195000         VARYING PV-SUB                                           19500000
195100         FROM 1 BY 1                                              19510000
195200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      19520000
195300******************************************************************19530000
195400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**19540000
195500******************************************************************19550000
195600 2210-MOVE-LINES-TO-COMMAREA.                                     19560000
195700     IF  MR-SELECTL (PV-SUB) > ZERO                               19570000
195800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19580000
195900         MOVE MR-SELECTI (PV-SUB)                                 19590000
196000                                   TO ASC-TEMP-SELECTED-SW        19600000
196100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19610000
196200     ELSE                                                         19620000
196300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19630000
196400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19640000
196500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        19650000
196600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19660000
196700         END-IF                                                   19670000
196800     END-IF.                                                      19680000
196900     ADD +1                        TO ASC-ITEM-SUB.               19690000
197000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19700000
197100         ADD +1                    TO ASC-BLK-SUB                 19710000
197200         MOVE +1                   TO ASC-ITEM-SUB                19720000
197300     END-IF.                                                      19730000
197400******************************************************************19740000
197500** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **19750000
197600** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **19760000
197700******************************************************************19770000
197800 3000-EDIT-DATA-IN-COMMAREA.                                      19780000
197900     SET PS-NO-ERROR               TO TRUE.                       19790000
198000*    PERFORM 3200-RESET-ATTRIBUTES.                               19800000
198100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     19810000
198200**                                                                19820000
198300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              19830000
198400* EDITTING IS DONE FROM THE BOTTOM UP.                            19840000
198500**                                                                19850000
198600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19860000
198700         ASC-ITEMS-DISPLAYED - 1.                                 19870000
198800     PERFORM 3100-SET-SUBSCRIPTS.                                 19880000
198900     PERFORM 3300-EDIT-SELECTIONS                                 19890000
199000         VARYING PV-SUB                                           19900000
199100         FROM PV-SUB BY -1                                        19910000
199200         UNTIL PV-SUB < +1                                        19920000
199300*                                                                 19930000
199400     IF  PS-NO-ERROR                                              19940000
199500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19950000
199600     END-IF.                                                      19960000
199700*                                                                 19970000
199800     IF  ((PS-NO-ERROR)                                           19980000
199900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   19990000
200000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    20000000
200100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  20010000
200200     END-IF.                                                      20020000
200300 EJECT                                                            20030000
200400*----------------------------------------------------------------*20040000
200500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *20050000
200600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*20060000
200700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *20070000
200800*                                                                *20080000
200900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *20090000
201000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *20100000
201100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *20110000
201200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *20120000
201300*----------------------------------------------------------------*20130000
201400                                                                  20140000
201500 3100-SET-SUBSCRIPTS.                                             20150000
201600                                                                  20160000
201700     COMPUTE ASC-ITEM-SUB =                                       20170000
201800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        20180000
201900                                                                  20190000
202000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         20200000
202100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20210000
202200                                                                  20220000
202300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               20230000
202400     ELSE                                                         20240000
202500         MOVE +1                     TO ASC-BLK-SUB               20250000
202600     END-IF.                                                      20260000
202700******************************************************************20270000
202800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **20280000
202900******************************************************************20290000
203000                                                                  20300000
203100 3200-RESET-ATTRIBUTES.                                           20310000
203200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   20320000
203300     MOVE DP015-GREEN              TO ASTRTITC.                   20330000
203400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   20340000
203500*                                                                 20350000
203600     PERFORM                                                      20360000
203700         VARYING PV-SUB                                           20370000
203800         FROM 1 BY 1                                              20380000
203900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        20390000
204000         MOVE DP015-UNP-ALP-NOR-OFF                               20400000
204100                                   TO MR-SELECTA (PV-SUB)         20410000
204200         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         20420000
204300         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         20430000
204400     END-PERFORM.                                                 20440000
204500******************************************************************20450000
204600** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **20460000
204700** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **20470000
204800** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **20480000
204900** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **20490000
205000******************************************************************20500000
205100 3300-EDIT-SELECTIONS.                                            20510000
205200     EVALUATE TRUE                                                20520000
205300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20530000
205400             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         20540000
205500             IF ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)        20550000
205600                 NOT = SPACES                                     20560000
205700                 IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)        20570000
205800                    IF ASC-CANNOT-VERIFY-SW                       20580000
205900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20590000
206000                         = 'Y'                                    20600000
206100                        SET ASC-STOP-VERIFY    TO TRUE            20610000
206200                    END-IF                                        20620000
206300                 END-IF                                           20630000
206400                 IF  DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)        20640000
206500                    IF ASC-CANNOT-VERIFY-SW                       20650000
206600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20660000
206700                         = 'Y'                                    20670000
206800                        SET ASC-STOP-VERIFY    TO TRUE            20680000
206900                    ELSE                                          20690000
207000                        SET ASC-CONFIRM-VERIFY TO TRUE            20700000
207100                    END-IF                                        20710000
207200                 END-IF                                           20720000
207300             END-IF                                               20730000
207400         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         20740000
207500             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        20750000
207600                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   20760000
207700                 MOVE ASC-TEMP-SELECTED-SW                        20770000
207800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20780000
207900                                TO ASC-SELECTED-SW                20790000
208000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20800000
208100                 IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)        20810000
208200                    IF ASC-CANNOT-VERIFY-SW                       20820000
208300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20830000
208400                         = 'Y'                                    20840000
208500                        SET ASC-STOP-VERIFY    TO TRUE            20850000
208600                    END-IF                                        20860000
208700                 END-IF                                           20870000
208800                 IF  DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)        20880000
208900                    IF ASC-CANNOT-VERIFY-SW                       20890000
209000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20900000
209100                         = 'Y'                                    20910000
209200                        SET ASC-STOP-VERIFY    TO TRUE            20920000
209300                    ELSE                                          20930000
209400                        SET ASC-CONFIRM-VERIFY TO TRUE            20940000
209500                    END-IF                                        20950000
209600                 END-IF                                           20960000
209700             END-IF                                               20970000
209800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20980000
209900                 = SPACE                                          20990000
210000             EVALUATE TRUE                                        21000000
210100                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       21010000
210200                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS21020000
210300                     MOVE SPACE TO ASC-SELECTED-SW                21030000
210400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21040000
210500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        21050000
210600                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    21060000
210700                     MOVE SPACE TO ASC-SELECTED-SW                21070000
210800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21080000
210900                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          21090000
211000                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      21100000
211100                     MOVE SPACE TO ASC-SELECTED-SW                21110000
211200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21120000
211300             END-EVALUATE                                         21130000
211400         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           21140000
211500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21150000
211600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    21160000
211700             END-IF                                               21170000
211800             PERFORM 3310-EDIT-RANGE                              21180000
211900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             21190000
212000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21200000
212100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    21210000
212200             END-IF                                               21220000
212300             PERFORM 3310-EDIT-RANGE                              21230000
212400         WHEN OTHER                                               21240000
212500             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           21250000
212600             SET DP020-MSG-FATAL    TO TRUE                       21260000
212700             MOVE -1                TO MR-SELECTL (PV-SUB)        21270000
212800             SET DP030-SET-CURSOR-APPL-1                          21280000
212900                                    TO TRUE                       21290000
213000             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        21300000
213100             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        21310000
213200             SET PS-ERROR TO TRUE                                 21320000
213300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21330000
213400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     21340000
213500                 MOVE SPACE         TO ASC-SELECTED-SW            21350000
213600                                        (ASC-BLK-SUB ASC-ITEM-SUB)21360000
213700             END-IF                                               21370000
213800     END-EVALUATE.                                                21380000
213900                                                                  21390000
214000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 21400000
214100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               21410000
214200     IF  ASC-ITEM-SUB < 1                                         21420000
214300         SUBTRACT +1 FROM ASC-BLK-SUB                             21430000
214400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                21440000
214500     END-IF.                                                      21450000
214600******************************************************************21460000
214700** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **21470000
214800** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **21480000
214900** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**21490000
215000** THE ENDING.                                                  **21500000
215100******************************************************************21510000
215200 3310-EDIT-RANGE.                                                 21520000
215300     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                21530000
215400         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   21540000
215500             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)21550000
215600                                   TO ASC-SELECTED-SW             21560000
215700                                        (ASC-BLK-SUB ASC-ITEM-SUB)21570000
215800             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 21580000
215900         ELSE                                                     21590000
216000             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     21600000
216100                 CONTINUE                                         21610000
216200             ELSE                                                 21620000
216300*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        21630000
216400                 MOVE PC-TSYMSG-00054                             21640000
216500                                   TO DP020-MSG-NUMBER            21650000
216600                 SET DP020-MSG-FATAL                              21660000
216700                                   TO TRUE                        21670000
216800                 MOVE -1           TO MR-SELECTL (PV-SUB)         21680000
216900                 SET DP030-SET-CURSOR-APPL-1                      21690000
217000                                   TO TRUE                        21700000
217100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         21710000
217200                 MOVE DP015-UNDERLINE                             21720000
217300                                   TO MR-SELECTH (PV-SUB)         21730000
217400                 SET PS-ERROR      TO TRUE                        21740000
217500             END-IF                                               21750000
217600         END-IF                                                   21760000
217700     ELSE                                                         21770000
217800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     21780000
217900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 21790000
218000                                   TO ASC-SELECTED-SW             21800000
218100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21810000
218200             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   21820000
218300         ELSE                                                     21830000
218400             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       21840000
218500                 CONTINUE                                         21850000
218600             ELSE                                                 21860000
218700*                -- ONLY ONE END-OF-RANGE ALLOWED --              21870000
218800                 MOVE PC-TSYMSG-00055                             21880000
218900                                   TO DP020-MSG-NUMBER            21890000
219000                 SET DP020-MSG-FATAL                              21900000
219100                                   TO TRUE                        21910000
219200                 MOVE -1           TO MR-SELECTL (PV-SUB)         21920000
219300                 SET DP030-SET-CURSOR-APPL-1                      21930000
219400                                   TO TRUE                        21940000
219500                 SET PS-ERROR      TO TRUE                        21950000
219600             END-IF                                               21960000
219700         END-IF                                                   21970000
219800     END-IF.                                                      21980000
219900*                                                                 21990000
220000******************************************************************22000000
220100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **22010000
220200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **22020000
220300******************************************************************22030000
220400 3400-CHECK-RANGE-SEQUENCE.                                       22040000
220500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       22050000
220600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      22060000
220700       AND  ASC-START-OF-SELECTED-RANGE >                         22070000
220800                                         ASC-END-OF-SELECTED-RANGE22080000
220900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                22090000
221000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 22100000
221100         SET DP020-MSG-FATAL TO TRUE                              22110000
221200         SET PS-ERROR TO TRUE                                     22120000
221300         PERFORM 3410-POSITION-AT-ERROR                           22130000
221400     END-IF.                                                      22140000
221500******************************************************************22150000
221600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **22160000
221700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **22170000
221800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **22180000
221900******************************************************************22190000
222000 3410-POSITION-AT-ERROR.                                          22200000
222100     SET DP030-SET-CURSOR-APPL-1                                  22210000
222200                                   TO TRUE.                       22220000
222300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22230000
222400                    - PV-TOP-ITEM + 1.                            22240000
222500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22250000
222600         CONTINUE                                                 22260000
222700     ELSE                                                         22270000
222800         MOVE -1                   TO MR-SELECTL (PV-SUB)         22280000
222900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22290000
223000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22300000
223100     END-IF.                                                      22310000
223200*                                                                 22320000
223300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22330000
223400                    - PV-TOP-ITEM + 1.                            22340000
223500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22350000
223600         CONTINUE                                                 22360000
223700     ELSE                                                         22370000
223800         MOVE -1                   TO MR-SELECTL (PV-SUB)         22380000
223900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22390000
224000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22400000
224100     END-IF.                                                      22410000
224200 EJECT                                                            22420000
224300*----------------------------------------------------------------*22430000
224400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *22440000
224500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *22450000
224600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *22460000
224700*----------------------------------------------------------------*22470000
224800                                                                  22480000
224900 3500-MARK-RANGE-AS-SELECTED.                                     22490000
225000     MOVE +1                       TO  ASC-BLK-SUB.               22500000
225100     PERFORM 3510-MARK-SELECTED-INDS                              22510000
225200         VARYING ASC-ITEM-SUB                                     22520000
225300         FROM 1 BY 1                                              22530000
225400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22540000
225500                                                                  22550000
225600     ADD +1                        TO ASC-BLK-SUB.                22560000
225700     PERFORM 3510-MARK-SELECTED-INDS                              22570000
225800         VARYING ASC-ITEM-SUB                                     22580000
225900         FROM 1 BY 1                                              22590000
226000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22600000
226100                                                                  22610000
226200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               22620000
226300                                   TO  PV-LIST-ITEM-NUMBER.       22630000
226400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            22640000
226500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         22650000
226600               PC-ITEMS-PER-PANEL).                               22660000
226700                                                                  22670000
226800     MOVE ASC-START-OF-SELECTED-RANGE                             22680000
226900                                   TO PV-START-OF-SELECTED-RANGE. 22690000
227000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            22700000
227100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  22710000
227200               PC-ITEMS-PER-PANEL).                               22720000
227300                                                                  22730000
227400     MOVE ASC-END-OF-SELECTED-RANGE                               22740000
227500                                   TO  PV-END-OF-SELECTED-RANGE.  22750000
227600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             22760000
227700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    22770000
227800               PC-ITEMS-PER-PANEL).                               22780000
227900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             22790000
228000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             22800000
228100                                                                  22810000
228200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    22820000
228300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        22830000
228400         MOVE +1                   TO ASC-BLK-SUB                 22840000
228500         PERFORM 5100-WRITE-TEMP-STORAGE                          22850000
228600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22860000
228700             PV-FIRST-BLOCK-IN-ARRAY - 1                          22870000
228800                                                                  22880000
228900         PERFORM                                                  22890000
229000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      22900000
229100                   PV-PREV-BLOCK-IN-ARRAY                         22910000
229200             MOVE PV-FIRST-BLOCK-IN-RANGE                         22920000
229300                                   TO PV-BLOCK-NUMBER             22930000
229400             PERFORM 4410-READ-TEMP-STORAGE                       22940000
229500             PERFORM 3510-MARK-SELECTED-INDS                      22950000
229600                 VARYING ASC-ITEM-SUB                             22960000
229700                 FROM 1 BY 1                                      22970000
229800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22980000
229900             PERFORM 5100-WRITE-TEMP-STORAGE                      22990000
230000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     23000000
230100         END-PERFORM                                              23010000
230200                                                                  23020000
230300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23030000
230400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23040000
230500         PERFORM                                                  23050000
230600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23060000
230700                   PV-LAST-BLOCK-IN-RANGE                         23070000
230800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23080000
230900                                   TO PV-BLOCK-NUMBER             23090000
231000             PERFORM 4410-READ-TEMP-STORAGE                       23100000
231100             PERFORM 3510-MARK-SELECTED-INDS                      23110000
231200                 VARYING ASC-ITEM-SUB                             23120000
231300                 FROM 1 BY 1                                      23130000
231400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23140000
231500             PERFORM 5100-WRITE-TEMP-STORAGE                      23150000
231600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23160000
231700         END-PERFORM                                              23170000
231800                                                                  23180000
231900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23190000
232000                                   TO PV-BLOCK-NUMBER             23200000
232100         PERFORM 4410-READ-TEMP-STORAGE                           23210000
232200     END-IF.                                                      23220000
232300                                                                  23230000
232400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 23240000
232500                                      ASC-END-OF-SELECTED-RANGE.  23250000
232600                                                                  23260000
232700 EJECT                                                            23270000
232800*----------------------------------------------------------------*23280000
232900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *23290000
233000*----------------------------------------------------------------*23300000
233100                                                                  23310000
233200 3510-MARK-SELECTED-INDS.                                         23320000
233300                                                                  23330000
233400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23340000
233500                                ASC-ITEM-SUB) >                   23350000
233600         ASC-START-OF-SELECTED-RANGE)                             23360000
233700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23370000
233800                                ASC-ITEM-SUB) =                   23380000
233900         ASC-START-OF-SELECTED-RANGE)                             23390000
234000                                                                  23400000
234100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23410000
234200                                    ASC-ITEM-SUB) <               23420000
234300             ASC-END-OF-SELECTED-RANGE)                           23430000
234400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23440000
234500                                    ASC-ITEM-SUB) =               23450000
234600             ASC-END-OF-SELECTED-RANGE)                           23460000
234700                                                                  23470000
234800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23480000
234900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   23490000
235000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   23500000
235100                               TO TRUE                            23510000
235200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              23520000
235300                               TO TRUE                            23530000
235400                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    23540000
235500             END-IF                                               23550000
235600         END-IF                                                   23560000
235700     END-IF.                                                      23570000
235800                                                                  23580000
235900 EJECT                                                            23590000
236000*----------------------------------------------------------------*23600000
236100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *23610000
236200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *23620000
236300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *23630000
236400*    DISPLAY THE PANEL TO USER.                                  *23640000
236500*----------------------------------------------------------------*23650000
236600                                                                  23660000
236700 4000-BUILD-INITIAL-PANEL.                                        23670000
236800                                                                  23680000
236900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            23690000
237000                                 ASC-BLOCK-ENTRIES (2).           23700000
237100     MOVE +1                 TO ASC-BLK-SUB.                      23710000
237200     SET ASC-ITEMS-LEFT-ON-DB                                     23720000
237300         ASC-CAN-VERIFY                                           23730000
237400         ASC-CAN-UNVERIFY    TO TRUE.                             23740000
237500                                                                  23750000
237600     MOVE +0                 TO ASC-ITEM-SUB                      23760000
237700                                ASC-NUMBER-OF-ITEMS-READ          23770000
237800                                ASC-NUMBER-OF-SELECTED-ITEMS      23780000
237900                                ASC-HIGHEST-BLOCK-WRITTEN         23790000
238000                                ASC-START-OF-SELECTED-RANGE       23800000
238100                                ASC-END-OF-SELECTED-RANGE         23810000
238200                                ASC-ITEM-AT-TOP-OF-PANEL          23820000
238300                                ASC-TOT-PKSLIP-PACKS              23830000
238400                                ASC-TOT-ACTUAL-PACKS              23840000
238500                                ASC-TOT-VERFYD-PACKS              23850000
238600                                ASC-TOT-ODD-UNITS                 23860000
238700                                ASC-HDR-TOT-ACT-UNTS              23870000
238800                                ASC-HDR-TOT-VERFYD-UNTS.          23880000
238900                                                                  23890000
239000     MOVE SPACE              TO ASC-CONFIRM-VERIFY-SW.            23900000
239100                                                                  23910000
239200     PERFORM 4100-PREPARE-CURSOR.                                 23920000
239300                                                                  23930000
239400     PERFORM 5300-GET-TRECEIV-STATUS.                             23940000
239500                                                                  23950000
239600     PERFORM 4050-CHECK-AUTOVRFD.                                 23960000
239700                                                                  23970000
239800     PERFORM 4010-OPEN-CURSOR.                                    23980000
239900                                                                  23990000
240000     PERFORM 4300-READ-ITEMS-FROM-DB.                             24000000
240100                                                                  24010000
240200     PERFORM 4020-CLOSE-CURSOR.                                   24020000
240300                                                                  24030000
240400     MOVE +1                   TO  PV-TOP-ITEM.                   24040000
240500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          24050000
240600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    24060000
240700         SET DP020-MSG-FATAL   TO  TRUE                           24070000
240800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24080000
240900     ELSE                                                         24090000
241000         IF  PS-NO-DRIVER-INFO                                    24100003
241010*                                                                 24101003
241020* DMH 10/27/17 BEGIN                                              24102003
241030             PERFORM 2175-CHECK-RACF-ACCESS-EFC                   24103003
241040             IF  DP008-ACCESS-DENIED                              24104003
241060* DMH 10/27/17 END                                                24106003
241070*                                                                 24107003
241100                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            24110003
241200                 SET DP020-MSG-FATAL   TO  TRUE                   24120003
241300                 MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID        24130003
241400                 STRING 'PACK ID '                                24140003
241500                        PV-DISP-PREPK-ID                          24150003
241600                        ' - RATIO SET TO ZERO - CONTACT COC'      24160003
241700                                      DELIMITED BY SIZE           24170003
241800                                 INTO  DP020-MSG-MESSAGE          24180003
241900                 SET DP020-MSG-FATAL                              24190003
242000                     PS-ERROR      TO  TRUE                       24200003
242001*                                                                 24200103
242002* DMH 10/27/17 BEGIN                                              24200203
242010            ELSE                                                  24201003
242020                 MOVE -1               TO MR-SELECTL (1)          24202003
242021                 SET DP030-SET-CURSOR-APPL-1                      24202103
242022                                       TO TRUE                    24202203
242023                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24202303
242024             END-IF                                               24202403
242030* DMH 10/27/17 END                                                24203003
242040*                                                                 24204003
242100         ELSE                                                     24210000
242200             MOVE -1               TO MR-SELECTL (1)              24220000
242300             SET DP030-SET-CURSOR-APPL-1                          24230000
242400                                   TO TRUE                        24240000
242500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24250000
242600         END-IF                                                   24260000
242700     END-IF.                                                      24270000
242800 EJECT                                                            24280000
242900                                                                  24290000
243000 4010-OPEN-CURSOR.                                                24300000
243100     PERFORM                                                      24310000
243200         WITH TEST AFTER                                          24320000
243300         VARYING PV-RETRY-COUNTER                                 24330000
243400         FROM 1 BY 1                                              24340000
243500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24350000
243600                   OR (SQLCODE = ZERO))                           24360000
243700                                                                  24370000
243800             EXEC SQL                                             24380000
243900                  OPEN PACK-SLIP-CSR                              24390000
244000             END-EXEC                                             24400000
244100                                                                  24410000
244200         EVALUATE TRUE                                            24420000
244300             WHEN SQLCODE = ZERO                                  24430000
244400             WHEN SQLCODE = -904                                  24440000
244500             WHEN SQLCODE = -913                                  24450000
244600                 CONTINUE                                         24460000
244700             WHEN SQLWARN0 NOT = SPACES                           24470000
244800             WHEN SQLCODE < ZERO                                  24480000
244900             WHEN SQLCODE > ZERO                                  24490000
245000                 MOVE '4010-OPEN-CURSOR'                          24500000
245100                                   TO DP013-PARAGRAPH             24510000
245200                 MOVE 'OPEN PACK SLIP CURSOR - '                  24520000
245300                                   TO DP013-MESSAGE-TEXT (1)      24530000
245400                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          24540000
245500                 MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID     24550000
245600                 MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID        24560000
245700                 MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR     24570000
245800                 STRING ' PO = '                                  24580000
245900                        PV-DISP-PO-NBR                            24590000
246000                        ' OPER = '                                24600000
246100                        PV-DISP-OPER-UNT-ID                       24610000
246200                        ' FCLTY = '                               24620000
246300                        PV-DISP-FCLTY-ID                          24630000
246400                        ' RECV ='                                 24640000
246500                        PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE     24650000
246600                                 INTO DP013-MESSAGE-TEXT (2)      24660000
246700                 MOVE SQLCA        TO DP013-SQLCA                 24670000
246800                 MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)    24680000
246900                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)    24690000
247000                 MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)    24700000
247100                 SET DP013-DB2-ABEND                              24710000
247200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           24720000
247300                 PERFORM DP013-0000-PROCESS-ABEND                 24730000
247400         END-EVALUATE                                             24740000
247500     END-PERFORM.                                                 24750000
247600*                                                                 24760000
247700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24770000
247800         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             24780000
247900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   24790000
248000                                   TO DP013-MESSAGE-TEXT (1)      24800000
248100         MOVE DK-PO-NBR            TO PV-DISP-PO-NBR              24810000
248200         MOVE DK-OPER-UNT-ID       TO PV-DISP-OPER-UNT-ID         24820000
248300         MOVE DK-FCLTY-ID          TO PV-DISP-FCLTY-ID            24830000
248400         MOVE DK-REC-SEQ-NBR       TO PV-DISP-REC-SEQ-NBR         24840000
248500         STRING ' PO = '                                          24850000
248600                PV-DISP-PO-NBR                                    24860000
248700                ' OPER = '                                        24870000
248800                PV-DISP-OPER-UNT-ID                               24880000
248900                ' FCLTY = '                                       24890000
249000                PV-DISP-FCLTY-ID                                  24900000
249100                ' RECV ='                                         24910000
249200                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             24920000
249300                         INTO DP013-MESSAGE-TEXT (2)              24930000
249400         MOVE SQLCA                TO DP013-SQLCA                 24940000
249500         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    24950000
249600         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (2)    24960000
249700         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (3)    24970000
249800         SET DP013-DB2-ABEND                                      24980000
249900             DP013-XCTL-DISPLAY-RESTART                           24990000
250000                                   TO TRUE                        25000000
250100         PERFORM DP013-0000-PROCESS-ABEND                         25010000
250200     END-IF.                                                      25020000
250300                                                                  25030000
250400 EJECT                                                            25040000
250500                                                                  25050000
250600 4020-CLOSE-CURSOR.                                               25060000
250700     EXEC SQL                                                     25070000
250800         CLOSE PACK-SLIP-CSR                                      25080000
250900     END-EXEC.                                                    25090000
251000*                                                                 25100000
251100     EVALUATE TRUE                                                25110000
251200         WHEN SQLCODE = ZERO                                      25120000
251300             CONTINUE                                             25130000
251400         WHEN SQLWARN0 NOT = SPACES                               25140000
251500         WHEN SQLCODE < ZERO                                      25150000
251600         WHEN SQLCODE > ZERO                                      25160000
251700             MOVE '4020-CLOSE-CURSOR'                             25170000
251800                               TO DP013-PARAGRAPH                 25180000
251900             MOVE 'CLOSE PACK SLIP CURSOR '                       25190000
252000                               TO DP013-MESSAGE-TEXT (1)          25200000
252100             MOVE SQLCA        TO DP013-SQLCA                     25210000
252200             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        25220000
252300             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        25230000
252400             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)        25240000
252500             SET DP013-DB2-ABEND                                  25250000
252600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25260000
252700             PERFORM DP013-0000-PROCESS-ABEND                     25270000
252800     END-EVALUATE.                                                25280000
252900                                                                  25290000
253000*----------------------------------------------------------------*25300000
253100*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          25310000
253200*----------------------------------------------------------------*25320000
253300 4050-CHECK-AUTOVRFD.                                             25330000
253400                                                                  25340000
253500     INITIALIZE RC040-FIELDS.                                     25350000
253600     MOVE DP020-LOCATION-NBR  TO RC040-SIGNON-LOCATION.           25360000
253700     MOVE ASC-PO-NBR          TO RC040-PO-NBR.                    25370000
253800     MOVE ASC-REC-SEQ-NBR     TO RC040-PO-RCVR.                   25380000
253900     MOVE DP020-USERID        TO RC040-USER-ID.                   25390000
254000     MOVE 'RCKCS817'          TO RC040-CALLING-PROGRAM.           25400000
254100                                                                  25410000
254200     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  25420000
254300                                        RC040-COMMAREA            25430000
254400                                        RC040-FIELDS.             25440000
254500                                                                  25450000
254600     EVALUATE TRUE                                                25460000
254700         WHEN RC040-SUCCESSFUL                                    25470000
254800                 MOVE RC040-AUTO-VE-SW TO ASC-AUTO-VE-SW          25480000
254900         WHEN RC040-DATABASE-BUSY OR                              25490000
255000              RC040-INVALID-SQL                                   25500000
255100                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       25510000
255200                  SET DP020-MSG-WARNING TO TRUE                   25520000
255300                  SET DP030-OVERRIDE-GO TO TRUE                   25530000
255400         WHEN RC040-NOT-SUCCESSFUL                                25540000
255500                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       25550000
255600                  SET DP020-MSG-WARNING TO TRUE                   25560000
255700                  SET DP030-OVERRIDE-GO TO TRUE                   25570000
255800         WHEN OTHER                                               25580000
255900             MOVE '4050-CHECK-AUTOVRFD ' TO DP013-PARAGRAPH       25590000
256000             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              25600000
256100                                         TO DP013-MESSAGE-TEXT (1)25610000
256200             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)25620000
256300             MOVE RC040-SQLCA            TO DP013-SQLCA           25630000
256400             SET DP013-DB2-ABEND                                  25640000
256500                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              25650000
256600             PERFORM DP013-0000-PROCESS-ABEND                     25660000
256700     END-EVALUATE.                                                25670000
256800                                                                  25680000
256900 EJECT                                                            25690000
257000*----------------------------------------------------------------*25700000
257100*    SET UP THE HOST VARIABLES.                                  *25710000
257200*----------------------------------------------------------------*25720000
257300                                                                  25730000
257400 4100-PREPARE-CURSOR.                                             25740000
257500                                                                  25750000
257600     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 25760000
257700     MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID.                    25770000
257800     MOVE ASC-PO-NBR           TO DK-PO-NBR.                      25780000
257900     MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.                 25790000
258000                                                                  25800000
258100                                                                  25810000
258200 EJECT                                                            25820000
258300*----------------------------------------------------------------*25830000
258400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *25840000
258500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *25850000
258600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *25860000
258700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *25870000
258800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *25880000
258900*                                                                *25890000
259000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *25900000
259100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *25910000
259200*    UPON INITIALIZATION.                                        *25920000
259300*----------------------------------------------------------------*25930000
259400                                                                  25940000
259500 4300-READ-ITEMS-FROM-DB.                                         25950000
259600                                                                  25960000
259700     PERFORM                                                      25970000
259800         VARYING PV-READ-COUNT                                    25980000
259900         FROM 1 BY 1                                              25990000
260000         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26000000
260100            OR (ASC-NO-ITEMS-LEFT-ON-DB)                          26010000
260200            OR PS-NO-DRIVER-INFO)                                 26020000
260300                                                                  26030000
260400         PERFORM 4310-FETCH                                       26040000
260500                                                                  26050000
260600         IF  ASC-ITEMS-LEFT-ON-DB                                 26060000
260700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26070000
260800                 ADD +1            TO ASC-ITEM-SUB                26080000
260900             ELSE                                                 26090000
261000                 ADD +1            TO ASC-BLK-SUB                 26100000
261100                 MOVE +1           TO ASC-ITEM-SUB                26110000
261200                                                                  26120000
261300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26130000
261400                     MOVE +1       TO ASC-BLK-SUB                 26140000
261500                     SET ASC-BLOCK-MODIFIED (1)                   26150000
261600                                   TO TRUE                        26160000
261700                     PERFORM 5100-WRITE-TEMP-STORAGE              26170000
261800                     MOVE ASC-BLOCK-ENTRIES                       26180000
261900                               (PC-MAX-BLOCKS-IN-ARRAY)           26190000
262000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26200000
262100                     ADD +1        TO ASC-BLK-SUB                 26210000
262200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26220000
262300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26230000
262400                                   TO TRUE                        26240000
262500                 END-IF                                           26250000
262600             END-IF                                               26260000
262700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26270000
262800             MOVE ASC-NUMBER-OF-ITEMS-READ                        26280000
262900                                   TO ASC-LIST-ITEM-NUMBER        26290000
263000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26300000
263100             MOVE RECEIV-PKGNG-CDE  TO ASC-RECEIV-PKGNG-CDE       26310000
263200             MOVE RECEIV-PACK-BY-ST-IND                           26320000
263300                                    TO ASC-RECEIV-PACK-BY-ST-IND  26330000
263400             MOVE RECEIV-STATUS-CDE TO ASC-RECEIV-STATUS-CDE      26340000
263500             MOVE RECITM-PREPK-ID  TO ASC-PACK-ID                 26350000
263600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26360000
263700             MOVE RECITM-STATUS-CDE                               26370000
263800                                   TO ASC-STAT-CDE                26380000
263900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26390000
264000             IF  RECITM-STATUS-CDE NOT EQUAL 'CM'                 26400000
264100                 SET ASC-CANT-VERIFY                              26410000
264200                               TO  TRUE                           26420000
264300             END-IF                                               26430000
264400             IF  RECITM-STATUS-CDE NOT EQUAL 'VE'                 26440000
264500                 SET ASC-CANT-UNVERIFY-ST                         26450000
264600                               TO  TRUE                           26460000
264700             END-IF                                               26470000
264800             MOVE RECITM-PREPK-ID   TO DK-PREPK-ID                26480000
264900             PERFORM 4340-SELECT-DRIVER-RATIO                     26490000
265000             MOVE PURITM-CL-NBR    TO ASC-CL                      26500000
265100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26510000
265200             MOVE RECITM-PREPK-RATO-QTY TO PV-DRIVER-RATIO        26520000
265300                                           ASC-DRIVER-RATIO       26530000
265400             MOVE 'N'          TO ASC-CANNOT-VERIFY-SW            26540000
265500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26550000
265600             IF RECITM-STATUS-CDE = 'VE'                          26560000
265700                 IF RECITM-VRFD-USR-ID (1:2) = 'TK'               26570000
265710                 OR RECITM-VRFD-USR-ID (1:2) = 'TC'               26571000
265720                 OR RECITM-VRFD-USR-ID (1:2) = 'TV'               26572000
265800                  OR SPACES                                       26580000
265900                     MOVE 'MANUAL' TO ASC-VERFYD-SOURCE           26590000
266000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26600000
266100                 ELSE                                             26610000
266200                     MOVE RECITM-VRFD-USR-ID TO ASC-VERFYD-SOURCE 26620000
266300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26630000
266400                  END-IF                                          26640000
266500             ELSE                                                 26650000
266600                 MOVE RECITM-ORD-LNE-NBR TO DK-HOLD-LNE-NBR       26660000
266700                 PERFORM 5460-SELECT-TDISTHD                      26670000
266800                 IF PS-NO-TDISTHD-FOUND                           26680000
266900                     MOVE 'MANUAL' TO ASC-VERFYD-SOURCE           26690000
267000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26700000
267100                 ELSE                                             26710000
267200                     IF DISTHD-VRFD-TMST = PC-FS-TIMESTAMP AND    26720000
267300                        DISTHD-TOT-CART-CNT > 0                   26730000
267400                         MOVE 'Y'     TO ASC-CANNOT-VERIFY-SW     26740000
267500                                  (ASC-BLK-SUB ASC-ITEM-SUB)      26750000
267600                     END-IF                                       26760000
267700                     IF DISTHD-TOT-CART-CNT = 0                   26770000
267800                         MOVE 'MANUAL' TO ASC-VERFYD-SOURCE       26780000
267900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26790000
268000                     ELSE                                         26800000
268100                         IF (DISTHD-P2L-CART-CNT = 0              26810000
268200                            AND (DISTHD-FCSE-CART-CNT > 0         26820000
268300                            OR DISTHD-INPK-CART-CNT > 0))         26830000
268400                              MOVE 'CASE' TO ASC-VERFYD-SOURCE    26840000
268500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     26850000
268600                         ELSE                                     26860000
268700                           IF (DISTHD-P2L-CART-CNT > 0            26870000
268800                             AND (DISTHD-FCSE-CART-CNT > 0        26880000
268900                               OR DISTHD-INPK-CART-CNT > 0))      26890000
269000                               MOVE 'P2L/CASE'                    26900000
269100                                             TO ASC-VERFYD-SOURCE 26910000
269200                                    (ASC-BLK-SUB ASC-ITEM-SUB)    26920000
269300                           ELSE                                   26930000
269400                           IF (DISTHD-P2L-CART-CNT > 0            26940000
269500                              AND (DISTHD-FCSE-CART-CNT = 0       26950000
269600                              AND DISTHD-INPK-CART-CNT = 0))      26960000
269700                              MOVE 'P2L'  TO ASC-VERFYD-SOURCE    26970000
269800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26980000
269900                           ELSE                                   26990000
270000                               MOVE 'MANUAL' TO  ASC-VERFYD-SOURCE27000000
270100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27010000
270200                           END-IF                                 27020000
270300                           END-IF                                 27030000
270400                         END-IF                                   27040000
270500                     END-IF                                       27050000
270600                 END-IF                                           27060000
270700             END-IF                                               27070000
270800             IF  RECEIV-FS-POST-TMST NOT EQUAL TO                 27080000
270900                 PC-FS-TIMESTAMP                                  27090000
271000                    SET ASC-CANT-UNVERIFY-FS                      27100000
271100                               TO  TRUE                           27110000
271200             END-IF                                               27120000
271300             IF  RECITM-STATUS-CDE NOT EQUAL 'VE'                 27130000
271400                 SET ASC-CANT-UNVERIFY-ST                         27140000
271500                               TO  TRUE                           27150000
271600             END-IF                                               27160000
271700*            IF ASC-AUTO-VE-YES                                   27170000
271800                 PERFORM 4350-CALL-RCKUT128                       27180000
271900                 MOVE RC074-TOTAL-INVC-PACK-QTY                   27190000
272000                                       TO  ASC-PKSLIP-PACKS       27200000
272100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27210000
272200                 ADD RC074-TOTAL-INVC-PACK-QTY                    27220000
272300                                       TO  ASC-TOT-PKSLIP-PACKS   27230000
272400                 MOVE RC074-TOTAL-ACTL-PACK-QTY                   27240000
272500                                       TO  ASC-ACTUAL-PACKS       27250000
272600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27260000
272700                 ADD RC074-TOTAL-ACTL-PACK-QTY                    27270000
272800                                       TO  ASC-TOT-ACTUAL-PACKS   27280000
272900                 MOVE RC074-VERIFY-PACK-QTY                       27290000
273000                                       TO  ASC-VERFYD-PACKS       27300000
273100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27310000
273200                 ADD RC074-VERIFY-PACK-QTY                        27320000
273300                                       TO  ASC-TOT-VERFYD-PACKS   27330000
273400                 IF  RECITM-STATUS-CDE EQUAL 'VE'                 27340000
273500                     MOVE RC074-VERIFY-ODD-QTY     TO PV-ODD-UNITS27350000
273600                 ELSE                                             27360000
273700                     MOVE RC074-ACTUAL-ODD-QTY TO PV-ODD-UNITS    27370000
273800                 END-IF                                           27380000
273900                 MOVE PV-ODD-UNITS     TO  ASC-ODD-UNITS          27390000
274000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27400000
274100                 ADD PV-ODD-UNITS      TO  ASC-TOT-ODD-UNITS      27410000
274200                                                                  27420000
274300                                                                  27430000
274400                 MOVE RC074-TOTAL-ACTL-ITM-QTY                    27440000
274500                               TO  ASC-TOT-ACT-UNTS               27450000
274600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27460000
274700                 ADD RC074-TOTAL-ACTL-ITM-QTY                     27470000
274800                               TO  ASC-HDR-TOT-ACT-UNTS           27480000
274900                                   ASC-TOT-ACT-QTY                27490000
275000                 MOVE RC074-VERIFY-ITM-QTY                        27500000
275100                               TO  ASC-TOT-VERFYD-UNTS            27510000
275200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27520000
275300                 ADD RC074-VERIFY-ITM-QTY                         27530000
275400                               TO  ASC-HDR-TOT-VERFYD-UNTS        27540000
275500                                   ASC-TOT-VFY-QTY                27550000
275600*                                                                 27560000
275700*            ELSE                                                 27570000
275800*                PERFORM 4320-SUM-TRECDIS                         27580000
275900*                MOVE RECITM-ORD-LNE-NBR    TO DK-PO-DRIVER-LNE   27590000
276000*                PERFORM 4325-SUM-TRECDIS-DRIVER                  27600000
276100*                PERFORM 4380-SELECT-ODD-UNITS                    27610000
276200*                PERFORM 4390-SELECT-ODD-UNITS-DRIVER             27620000
276300*                IF PV-DRIVER-RATIO > 0                           27630000
276400*                    COMPUTE PV-PKSLIP-PACKS =                    27640000
276500*                        PV-LNE-EXPTED-ITM-QTY   / PV-DRIVER-RATIO27650000
276600*                    COMPUTE PV-ACTUAL-PACKS =                    27660000
276700*                       (PV-LNE-VERIFY-ITM-QTY                    27670000
276800*                                  - PV-ODD-DC-VERIFY-ODU-PK-QTY) 27680000
276900*                                                / PV-DRIVER-RATIO27690000
277000*                    COMPUTE PV-VERFYD-PACKS =                    27700000
277100*                       (PV-LNE-AP-VERIFY-ITM-QTY                 27710000
277200*                                  - PV-ODD-AP-VERIFY-ODU-PK-QTY) 27720000
277300*                                                / PV-DRIVER-RATIO27730000
277400*                ELSE                                             27740000
277500*                    MOVE 0            TO PV-PKSLIP-PACKS         27750000
277600*                    MOVE 0            TO PV-ACTUAL-PACKS         27760000
277700*                    MOVE 0            TO PV-VERFYD-PACKS         27770000
277800*                END-IF                                           27780000
277900*                MOVE PV-PKSLIP-PACKS  TO  ASC-PKSLIP-PACKS       27790000
278000*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 27800000
278100*                ADD PV-PKSLIP-PACKS   TO  ASC-TOT-PKSLIP-PACKS   27810000
278200*                MOVE PV-ACTUAL-PACKS  TO  ASC-ACTUAL-PACKS       27820000
278300*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 27830000
278400*                ADD PV-ACTUAL-PACKS   TO  ASC-TOT-ACTUAL-PACKS   27840000
278500*                MOVE PV-VERFYD-PACKS  TO  ASC-VERFYD-PACKS       27850000
278600*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 27860000
278700*                ADD PV-VERFYD-PACKS   TO  ASC-TOT-VERFYD-PACKS   27870000
278800*                IF  RECITM-STATUS-CDE EQUAL 'VE'                 27880000
278900*                    MOVE PV-ODD-AP-VERIFY-ODU-QTY TO PV-ODD-UNITS27890000
279000*                ELSE                                             27900000
279100*                    MOVE PV-ODD-DC-VERIFY-ODU-QTY TO PV-ODD-UNITS27910000
279200*                END-IF                                           27920000
279300*                MOVE PV-ODD-UNITS     TO  ASC-ODD-UNITS          27930000
279400*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 27940000
279500*                ADD PV-ODD-UNITS      TO  ASC-TOT-ODD-UNITS      27950000
279600*                                                                 27960000
279700*                                                                 27970000
279800*                MOVE RECDIS-VERIFY-ITM-QTY                       27980000
279900*                              TO  ASC-TOT-ACT-UNTS               27990000
280000*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 28000000
280100*                ADD RECDIS-VERIFY-ITM-QTY                        28010000
280200*                              TO  ASC-HDR-TOT-ACT-UNTS           28020000
280300*                MOVE RECDIS-AP-VERIFY-ITM-QTY                    28030000
280400*                              TO  ASC-TOT-VERFYD-UNTS            28040000
280500*                                      (ASC-BLK-SUB ASC-ITEM-SUB) 28050000
280600*                ADD RECDIS-AP-VERIFY-ITM-QTY                     28060000
280700*                              TO  ASC-HDR-TOT-VERFYD-UNTS        28070000
280800*            END-IF                                               28080000
280900             MOVE POPRPK-PK-SKU-NBR                               28090000
281000                               TO  ASC-PACK-SKU                   28100000
281100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28110000
281200             MOVE PURCHS-DEPT-NBR                                 28120000
281300                               TO ASC-DEPT-NBR                    28130000
281400                                                                  28140000
281500         END-IF                                                   28150000
281600     END-PERFORM.                                                 28160000
281700     IF ASC-AUTO-VE-NO                                            28170000
281800         PERFORM 4330-SUM-TRECDIS-ALL                             28180000
281900         MOVE RECDIS-VERIFY-ITM-QTY                               28190000
282000            TO  ASC-TOT-ACT-QTY                                   28200000
282100         MOVE RECDIS-AP-VERIFY-ITM-QTY                            28210000
282200            TO  ASC-TOT-VFY-QTY                                   28220000
282300     END-IF.                                                      28230000
282400                                                                  28240000
282500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          28250000
282600         MOVE +1               TO ASC-BLK-SUB                     28260000
282700         PERFORM 5100-WRITE-TEMP-STORAGE                          28270000
282800         ADD +1                TO ASC-BLK-SUB                     28280000
282900         PERFORM 5100-WRITE-TEMP-STORAGE                          28290000
283000                                                                  28300000
283100         MOVE 1                TO ASC-BLK-SUB                     28310000
283200                                  PV-BLOCK-NUMBER                 28320000
283300         PERFORM 4410-READ-TEMP-STORAGE                           28330000
283400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             28340000
283500             MOVE 2            TO ASC-BLK-SUB                     28350000
283600                                  PV-BLOCK-NUMBER                 28360000
283700             PERFORM 4410-READ-TEMP-STORAGE                       28370000
283800         END-IF                                                   28380000
283900     END-IF.                                                      28390000
284000 EJECT                                                            28400000
284100                                                                  28410000
284200 4310-FETCH.                                                      28420000
284300                                                                  28430000
284400     EXEC SQL                                                     28440000
284500          FETCH PACK-SLIP-CSR                                     28450000
284600          INTO  :RECITM-PREPK-ID                                  28460000
284700              , :RECITM-STATUS-CDE                                28470000
284800              , :RECITM-VRFD-USR-ID                               28480000
284900              , :PURCHS-DEPT-NBR                                  28490000
285000                                                                  28500000
285100     END-EXEC.                                                    28510000
285200                                                                  28520000
285300     EVALUATE TRUE                                                28530000
285400         WHEN SQLCODE = ZERO                                      28540000
285500         WHEN SQLCODE = +100                                      28550000
285600              CONTINUE                                            28560000
285700         WHEN SQLWARN0 NOT = SPACE                                28570000
285800         WHEN SQLCODE NOT = ZERO                                  28580000
285900              MOVE '4310-FETCH-CURSOR'                            28590000
286000                               TO DP013-PARAGRAPH                 28600000
286100              MOVE 'FETCH PACK SLIP CURSOR'                       28610000
286200                               TO DP013-MESSAGE-TEXT (1)          28620000
286300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             28630000
286400              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        28640000
286500              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           28650000
286600              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        28660000
286700              STRING ' PO = '                                     28670000
286800                     PV-DISP-PO-NBR                               28680000
286900                     ' OPER = '                                   28690000
287000                     PV-DISP-OPER-UNT-ID                          28700000
287100                     ' FCLTY = '                                  28710000
287200                     PV-DISP-FCLTY-ID                             28720000
287300                     ' RECV ='                                    28730000
287400                     PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE        28740000
287500                              INTO DP013-MESSAGE-TEXT (2)         28750000
287600              MOVE SQLCA       TO DP013-SQLCA                     28760000
287700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        28770000
287800              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (2)        28780000
287900              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (3)        28790000
288000              SET DP013-DB2-ABEND                                 28800000
288100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              28810000
288200              PERFORM DP013-0000-PROCESS-ABEND                    28820000
288300     END-EVALUATE.                                                28830000
288400                                                                  28840000
288500     IF  SQLCODE EQUAL +100                                       28850000
288600         SET ASC-NO-ITEMS-LEFT-ON-DB                              28860000
288700                                   TO TRUE                        28870000
288800     END-IF.                                                      28880000
288900                                                                  28890000
289000 4320-SUM-TRECDIS.                                                28900000
289100                                                                  28910000
289200     MOVE ZERO                 TO RECDIS-VERIFY-ITM-QTY.          28920000
289300     MOVE ZERO                 TO RECDIS-AP-VERIFY-ITM-QTY.       28930000
289400                                                                  28940000
289500     EXEC SQL                                                     28950000
289600          SELECT                                                  28960000
289700                 SUM(A.VERIFY_ITM_QTY)                            28970000
289800              ,  SUM(A.AP_VERIFY_ITM_QTY)                         28980000
289900          INTO                                                    28990000
290000                :RECDIS-VERIFY-ITM-QTY :PV-NULL-IND               29000000
290100              , :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND            29010000
290200          FROM                                                    29020000
290300                 TRECDIS A                                        29030000
290400              ,  TRECITM  B                                       29040000
290500          WHERE                                                   29050000
290600                A.ORD_NBR          =  :DK-PO-NBR                  29060000
290700           AND  A.ORD_NBR          =  B.ORD_NBR                   29070000
290800           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             29080000
290900           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               29090000
291000           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                29100000
291100           AND  A.FCLTY_ID         =  B.FCLTY_ID                  29110000
291200           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             29120000
291300           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               29130000
291400           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               29140000
291600           AND  B.VER_STATUS_CDE   =  'A'                         29160000
291700           AND  B.PREPK_ID         = :DK-PREPK-ID                 29170000
291800                                                                  29180000
292400     END-EXEC.                                                    29240000
292500                                                                  29250000
292600     EVALUATE TRUE                                                29260000
292700         WHEN SQLCODE = ZERO                                      29270000
292800         WHEN SQLCODE = +100                                      29280000
292900              CONTINUE                                            29290000
293010         WHEN SQLCODE = -904                                      29301000
293100         WHEN SQLCODE = -911                                      29310000
293200         WHEN SQLCODE = -913                                      29320000
293300             PERFORM 9900-SOFT-ABORT                              29330000
293400         WHEN SQLCODE = -305                                      29340000
293500              CONTINUE                                            29350000
293600         WHEN SQLWARN0 NOT = SPACE                                29360000
293700         WHEN SQLCODE NOT = ZERO                                  29370000
293800              MOVE '4320-SUM-TRECDIS'                             29380000
293900                               TO DP013-PARAGRAPH                 29390000
294000              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  29400000
294100                               TO DP013-MESSAGE-TEXT (1)          29410000
294200              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             29420000
294300              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        29430000
294400              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           29440000
294500              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        29450000
294600              MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID           29460000
294700              STRING ' PO = '                                     29470000
294800                     PV-DISP-PO-NBR                               29480000
294900                     ' OPER = '                                   29490000
295000                     PV-DISP-OPER-UNT-ID                          29500000
295100                     ' FCLTY = '                                  29510000
295200                     PV-DISP-FCLTY-ID                             29520000
295300                     ' RECV ='                                    29530000
295400                     PV-DISP-REC-SEQ-NBR                          29540000
295500                     ' PACK ='                                    29550000
295600                     PV-DISP-PREPK-ID    DELIMITED BY SIZE        29560000
295700                              INTO DP013-MESSAGE-TEXT (2)         29570000
295800              MOVE SQLCA       TO DP013-SQLCA                     29580000
295900              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        29590000
296000              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (2)        29600000
296100              MOVE SQLCA       TO DP013-SQLCA                     29610000
296200              SET DP013-DB2-ABEND                                 29620000
296300                               TO TRUE                            29630000
296400              PERFORM DP013-0000-PROCESS-ABEND                    29640000
296500     END-EVALUATE.                                                29650000
296600/                                                                 29660000
296700 4325-SUM-TRECDIS-DRIVER.                                         29670000
296800                                                                  29680000
296900     MOVE ZERO                 TO  PV-LNE-AP-VERIFY-ITM-QTY.      29690000
297000     MOVE ZERO                 TO  PV-LNE-VERIFY-ITM-QTY.         29700000
297100     MOVE ZERO                 TO  PV-LNE-EXPTED-ITM-QTY.         29710000
297200                                                                  29720000
297300     EXEC SQL                                                     29730000
297400          SELECT                                                  29740000
297500                 SUM(AP_VERIFY_ITM_QTY)                           29750000
297600                ,SUM(VERIFY_ITM_QTY)                              29760000
297700                ,SUM(EXPTED_ITM_QTY)                              29770000
297800          INTO                                                    29780000
297900                :PV-LNE-AP-VERIFY-ITM-QTY :PV-NULL-IND            29790000
298000               ,:PV-LNE-VERIFY-ITM-QTY :PV-NULL-IND               29800000
298100               ,:PV-LNE-EXPTED-ITM-QTY :PV-NULL-IND               29810000
298200          FROM                                                    29820000
298300                 TRECDIS                                          29830000
298400          WHERE                                                   29840000
298500                ORD_NBR          =  :DK-PO-NBR                    29850000
298600           AND  ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             29860000
298700           AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR               29870000
298800           AND  FCLTY_ID         =  :DK-FCLTY-ID                  29880000
298900           AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID               29890000
299100     END-EXEC.                                                    29910000
299200                                                                  29920000
299300     EVALUATE TRUE                                                29930000
299400         WHEN SQLCODE = ZERO                                      29940000
299500         WHEN SQLCODE = +100                                      29950000
299600              CONTINUE                                            29960000
299710         WHEN SQLCODE = -904                                      29971000
299800         WHEN SQLCODE = -911                                      29980000
299900         WHEN SQLCODE = -913                                      29990000
300000             PERFORM 9900-SOFT-ABORT                              30000000
300100         WHEN SQLCODE = -305                                      30010000
300200              CONTINUE                                            30020000
300300         WHEN SQLWARN0 NOT = SPACE                                30030000
300400         WHEN SQLCODE NOT = ZERO                                  30040000
300500              MOVE '4325-SUM-TRECDIS-DRIVER'                      30050000
300600                               TO DP013-PARAGRAPH                 30060000
300700              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  30070000
300800                               TO DP013-MESSAGE-TEXT (1)          30080000
300900              MOVE SQLCA       TO DP013-SQLCA                     30090000
301000                                                                  30100000
301100              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             30110000
301200              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        30120000
301300              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           30130000
301400              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        30140000
301500              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            30150000
301600              STRING ' PO = '                                     30160000
301700                     PV-DISP-PO-NBR                               30170000
301800                     ' OPER = '                                   30180000
301900                     PV-DISP-OPER-UNT-ID                          30190000
302000                     ' FCLTY = '                                  30200000
302100                     PV-DISP-FCLTY-ID                             30210000
302200                     ' RECV ='                                    30220000
302300                     PV-DISP-REC-SEQ-NBR                          30230000
302400                     ' PACK ='                                    30240000
302500                     PV-DISP-PREPK-ID    DELIMITED BY SIZE        30250000
302600                              INTO DP013-MESSAGE-TEXT (2)         30260000
302700              MOVE SQLCA        TO DP013-SQLCA                    30270000
302800              MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)       30280000
302900              SET DP013-DB2-ABEND                                 30290000
303000                               TO TRUE                            30300000
303100              PERFORM DP013-0000-PROCESS-ABEND                    30310000
303200     END-EVALUATE.                                                30320000
303300/                                                                 30330000
303400 4330-SUM-TRECDIS-ALL.                                            30340000
303500                                                                  30350000
303600     MOVE ZERO                 TO  RECDIS-AP-VERIFY-ITM-QTY.      30360000
303700     MOVE ZERO                 TO  RECDIS-VERIFY-ITM-QTY.         30370000
303800     MOVE ZERO                 TO  RECDIS-EXPTED-ITM-QTY.         30380000
303900                                                                  30390000
304000     EXEC SQL                                                     30400000
304100          SELECT                                                  30410000
304200                 SUM(AP_VERIFY_ITM_QTY)                           30420000
304300                ,SUM(VERIFY_ITM_QTY)                              30430000
304400                ,SUM(EXPTED_ITM_QTY)                              30440000
304500          INTO                                                    30450000
304600                :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND            30460000
304700               ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND               30470000
304800               ,:RECDIS-EXPTED-ITM-QTY :PV-NULL-IND               30480000
304900          FROM                                                    30490000
305000                 TRECDIS                                          30500000
305100          WHERE                                                   30510000
305200                ORD_NBR          =  :DK-PO-NBR                    30520000
305300           AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR               30530000
305400           AND  FCLTY_ID         =  :DK-FCLTY-ID                  30540000
305500           AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID               30550000
305700     END-EXEC.                                                    30570000
305800                                                                  30580000
305900     EVALUATE TRUE                                                30590000
306000         WHEN SQLCODE = ZERO                                      30600000
306100         WHEN SQLCODE = +100                                      30610000
306200              CONTINUE                                            30620000
306310         WHEN SQLCODE = -904                                      30631000
306400         WHEN SQLCODE = -911                                      30640000
306500         WHEN SQLCODE = -913                                      30650000
306600             PERFORM 9900-SOFT-ABORT                              30660000
306700         WHEN SQLCODE = -305                                      30670000
306800              CONTINUE                                            30680000
306900         WHEN SQLWARN0 NOT = SPACE                                30690000
307000         WHEN SQLCODE NOT = ZERO                                  30700000
307100              MOVE '4330-SUM-TRECDIS-ALL'                         30710000
307200                               TO DP013-PARAGRAPH                 30720000
307300              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  30730000
307400                               TO DP013-MESSAGE-TEXT (1)          30740000
307500              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             30750000
307600              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        30760000
307700              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           30770000
307800              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        30780000
307900              STRING ' PO = '                                     30790000
308000                     PV-DISP-PO-NBR                               30800000
308100                     ' OPER = '                                   30810000
308200                     PV-DISP-OPER-UNT-ID                          30820000
308300                     ' FCLTY = '                                  30830000
308400                     PV-DISP-FCLTY-ID                             30840000
308500                     ' RECV ='                                    30850000
308600                     PV-DISP-REC-SEQ-NBR                          30860000
308700                                         DELIMITED BY SIZE        30870000
308800                              INTO DP013-MESSAGE-TEXT (2)         30880000
308900              MOVE SQLCA       TO DP013-SQLCA                     30890000
309000              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        30900000
309100              SET DP013-DB2-ABEND                                 30910000
309200                               TO TRUE                            30920000
309300              PERFORM DP013-0000-PROCESS-ABEND                    30930000
309400     END-EVALUATE.                                                30940000
309500/                                                                 30950000
309600 4340-SELECT-DRIVER-RATIO.                                        30960000
309700                                                                  30970000
309800     EXEC SQL                                                     30980000
309900          SELECT                                                  30990000
310000                B.ORD_LNE_NBR                                     31000000
310100             ,  B.PREPK_RATO_QTY                                  31010000
310200             ,  D.PK_SKU_NBR                                      31020000
310300             ,  C.CL_NBR                                          31030000
310400          INTO                                                    31040000
310500                :RECITM-ORD-LNE-NBR                               31050000
310600             ,  :RECITM-PREPK-RATO-QTY                            31060000
310700             ,  :POPRPK-PK-SKU-NBR                                31070000
310800             ,  :PURITM-CL-NBR                                    31080000
310900          FROM    TRECEIV  A                                      31090000
311000              ,   TRECITM  B                                      31100000
311100              ,   TPURITM  C                                      31110000
311200              ,   TPOPRPK  D                                      31120000
311300          WHERE A.ORD_NBR          =  :DK-PO-NBR                  31130000
311400           AND  A.ORD_NBR          =  B.ORD_NBR                   31140000
311500           AND  A.ORD_NBR          =  C.PO_NBR                    31150000
311600           AND  A.ORD_NBR          =  D.PO_NBR                    31160000
311700           AND  A.VER_STATUS_CDE   =  'A'                         31170000
311800           AND  B.VER_STATUS_CDE   =  'A'                         31180000
311900           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             31190000
312000           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               31200000
312100           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                31210000
312200           AND  A.FCLTY_ID         =  B.FCLTY_ID                  31220000
312300           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             31230000
312400           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               31240000
312500           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            31250000
312600           AND  B.PO_VER_NBR       =  C.VER_NBR                   31260000
312700           AND  B.PREPK_DRV_LNE_CDE = 'A'                         31270000
312800           AND  B.PREPK_ID         = :DK-PREPK-ID                 31280000
312900           AND  B.PREPK_ID         =  D.PO_PREPK_ID               31290000
313000     END-EXEC.                                                    31300000
313100                                                                  31310000
313200     EVALUATE TRUE                                                31320000
313300         WHEN SQLCODE = ZERO                                      31330000
313400             CONTINUE                                             31340000
313500         WHEN SQLCODE = +100                                      31350000
313600             SET PS-NO-DRIVER-INFO TO TRUE                        31360000
313700         WHEN SQLWARN0 NOT = SPACES                               31370000
313800         WHEN SQLCODE < ZERO                                      31380000
313900         WHEN SQLCODE > ZERO                                      31390000
314000             MOVE '4340-SELECT-DRIVER-RATIO'                      31400000
314100                               TO DP013-PARAGRAPH                 31410000
314200             MOVE 'SELECT DRIVER RATIO '                          31420000
314300                               TO DP013-MESSAGE-TEXT (1)          31430000
314400             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              31440000
314500             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         31450000
314600             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            31460000
314700             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         31470000
314800             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            31480000
314900             STRING ' PO = '                                      31490000
315000                    PV-DISP-PO-NBR                                31500000
315100                    ' OPER = '                                    31510000
315200                    PV-DISP-OPER-UNT-ID                           31520000
315300                    ' FCLTY = '                                   31530000
315400                    PV-DISP-FCLTY-ID                              31540000
315500                    ' RECV ='                                     31550000
315600                    PV-DISP-REC-SEQ-NBR                           31560000
315700                    ' PACK ='                                     31570000
315800                    PV-DISP-PREPK-ID    DELIMITED BY SIZE         31580000
315900                             INTO DP013-MESSAGE-TEXT (2)          31590000
316000             MOVE SQLCA        TO DP013-SQLCA                     31600000
316100             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        31610000
316200             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        31620000
316300             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)        31630000
316400             SET DP013-DB2-ABEND                                  31640000
316500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31650000
316600             PERFORM DP013-0000-PROCESS-ABEND                     31660000
316700     END-EVALUATE.                                                31670000
316800*                                                                 31680000
316900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31690000
317000         MOVE '4340-SELECT-DRIVER-RATIO' TO DP013-PARAGRAPH       31700000
317100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING ON SELECT'     31710000
317200                                   TO DP013-MESSAGE-TEXT (1)      31720000
317300         MOVE DK-PO-NBR            TO PV-DISP-PO-NBR              31730000
317400         MOVE DK-OPER-UNT-ID       TO PV-DISP-OPER-UNT-ID         31740000
317500         MOVE DK-FCLTY-ID          TO PV-DISP-FCLTY-ID            31750000
317600         MOVE DK-REC-SEQ-NBR       TO PV-DISP-REC-SEQ-NBR         31760000
317700         MOVE DK-PREPK-ID          TO PV-DISP-PREPK-ID            31770000
317800         STRING ' PO = '                                          31780000
317900                PV-DISP-PO-NBR                                    31790000
318000                ' OPER = '                                        31800000
318100                PV-DISP-OPER-UNT-ID                               31810000
318200                ' FCLTY = '                                       31820000
318300                PV-DISP-FCLTY-ID                                  31830000
318400                ' RECV ='                                         31840000
318500                PV-DISP-REC-SEQ-NBR                               31850000
318600                ' PACK ='                                         31860000
318700                PV-DISP-PREPK-ID    DELIMITED BY SIZE             31870000
318800                         INTO DP013-MESSAGE-TEXT (2)              31880000
318900         MOVE SQLCA                TO DP013-SQLCA                 31890000
319000         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    31900000
319100         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (2)    31910000
319200         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (3)    31920000
319300         SET DP013-DB2-ABEND                                      31930000
319400             DP013-XCTL-DISPLAY-RESTART                           31940000
319500                                   TO TRUE                        31950000
319600         PERFORM DP013-0000-PROCESS-ABEND                         31960000
319700     END-IF.                                                      31970000
319800                                                                  31980000
319900 4350-CALL-RCKUT128.                                              31990000
320000     INITIALIZE RC074-FIELDS.                                     32000000
320100     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               32010000
320200     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  32020000
320300     MOVE ASC-PO-NBR          TO RC074-PO-NBR.                    32030000
320400     MOVE ASC-REC-SEQ-NBR     TO RC074-RCVR-SEQ-NBR.              32040000
320500     MOVE RECITM-PREPK-ID     TO RC074-PACK-ID.                   32050000
320600     MOVE ASC-AUTO-VE-SW      TO RC074-AUTO-VE-SW.                32060000
320700     SET RC074-PACK-QTY-YES   TO TRUE.                            32070000
320800                                                                  32080000
320900     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 32090000
321000                                         RC074-COMMAREA           32100000
321100                                         RC074-FIELDS.            32110000
321200                                                                  32120000
321300     EVALUATE TRUE                                                32130000
321400         WHEN RC074-SUCCESSFUL                                    32140000
321500             CONTINUE                                             32150000
321600         WHEN OTHER                                               32160000
321700             MOVE '4350-CALL-RCKUT128'                            32170000
321800                                 TO DP013-PARAGRAPH               32180000
321900             STRING                                               32190000
322000                  'UNSUCCESSFUL CALL TO RCKUT128 '                32200000
322100                  'SUCCESS-IND = '                                32210000
322200                  RC074-SUCCESS-IND                               32220000
322300                               DELIMITED BY SIZE                  32230000
322400                               INTO DP013-MESSAGE-TEXT (1)        32240000
322500             MOVE RC074-CRA-RET-MSG                               32250000
322600                                 TO DP013-MESSAGE-TEXT (2)        32260000
322700             MOVE RC074-SQLCA    TO DP013-SQLCA                   32270000
322800             SET DP013-DB2-ABEND                                  32280000
322900                 DP013-XCTL-DISPLAY-RESTART                       32290000
323000                                 TO TRUE                          32300000
323100             PERFORM DP013-0000-PROCESS-ABEND                     32310000
323200     END-EVALUATE.                                                32320000
323300                                                                  32330000
323400 4380-SELECT-ODD-UNITS.                                           32340000
323500                                                                  32350000
323600     MOVE 0               TO PV-ODD-DC-VERIFY-ODU-QTY             32360000
323700                             PV-ODD-AP-VERIFY-ODU-QTY.            32370000
323800     EXEC SQL                                                     32380000
323900          SELECT                                                  32390000
324000                 SUM(A.DC_VRFY_ODU_QTY)                           32400000
324100             ,   SUM(A.AP_VRFY_ODU_QTY)                           32410000
324200          INTO                                                    32420000
324300                :PV-ODD-DC-VERIFY-ODU-QTY :PV-NULL-IND            32430000
324400             ,  :PV-ODD-AP-VERIFY-ODU-QTY :PV-NULL-IND            32440000
324500          FROM                                                    32450000
324600                 RCT_VRFD_ODD_UNT A                               32460000
324700              ,  TRECITM  B                                       32470000
324800          WHERE                                                   32480000
324900                A.PO_NBR           =  :DK-PO-NBR                  32490000
325000           AND  A.PO_LNE_NBR       =  B.ORD_LNE_NBR               32500000
325100           AND  A.RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR             32510000
325200           AND  A.PO_NBR           =  B.ORD_NBR                   32520000
325300           AND  B.VER_STATUS_CDE   =  'A'                         32530000
325400           AND  A.RCVR_SEQ_NBR     =  B.REC_SEQ_NBR               32540000
325500           AND  B.PREPK_ID         = :DK-PREPK-ID                 32550000
325600     END-EXEC.                                                    32560000
325700                                                                  32570000
325800     EVALUATE TRUE                                                32580000
325900         WHEN SQLCODE = ZERO                                      32590000
326000         WHEN SQLCODE = +100                                      32600000
326100              CONTINUE                                            32610000
326200         WHEN SQLCODE = -904                                      32620000
326300         WHEN SQLCODE = -911                                      32630000
326400         WHEN SQLCODE = -913                                      32640000
326500             PERFORM 9900-SOFT-ABORT                              32650000
326600         WHEN SQLCODE = -305                                      32660000
326700              CONTINUE                                            32670000
326800         WHEN SQLWARN0 NOT = SPACE                                32680000
326900         WHEN SQLCODE NOT = ZERO                                  32690000
327000              MOVE '4380-SELECT-ODD-UNITS'                        32700000
327100                               TO DP013-PARAGRAPH                 32710000
327200              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  32720000
327300                               TO DP013-MESSAGE-TEXT (1)          32730000
327400              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             32740000
327500              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        32750000
327600              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            32760000
327700              STRING ' PO = '                                     32770000
327800                     PV-DISP-PO-NBR                               32780000
327900                     ' RECV ='                                    32790000
328000                     PV-DISP-REC-SEQ-NBR                          32800000
328100                     ' LINE ='                                    32810000
328200                     PV-DISP-LNE-NBR                              32820000
328300                                         DELIMITED BY SIZE        32830000
328400                              INTO DP013-MESSAGE-TEXT (2)         32840000
328500              MOVE SQLCA       TO DP013-SQLCA                     32850000
328600              MOVE 'RCT00009'  TO DP013-DB2-TABLE-NAME (1)        32860000
328700              MOVE SQLCA       TO DP013-SQLCA                     32870000
328800              SET DP013-DB2-ABEND                                 32880000
328900                               TO TRUE                            32890000
329000              PERFORM DP013-0000-PROCESS-ABEND                    32900000
329100     END-EVALUATE.                                                32910000
329200                                                                  32920000
329300 4390-SELECT-ODD-UNITS-DRIVER.                                    32930000
329400                                                                  32940000
329500     MOVE 0               TO PV-ODD-DC-VERIFY-ODU-PK-QTY          32950000
329600                             PV-ODD-AP-VERIFY-ODU-PK-QTY.         32960000
329700     EXEC SQL                                                     32970000
329800          SELECT                                                  32980000
329900                 SUM(A.DC_VRFY_ODU_QTY)                           32990000
330000             ,   SUM(A.AP_VRFY_ODU_QTY)                           33000000
330100          INTO                                                    33010000
330200                :PV-ODD-DC-VERIFY-ODU-PK-QTY :PV-NULL-IND         33020000
330300             ,  :PV-ODD-AP-VERIFY-ODU-PK-QTY :PV-NULL-IND         33030000
330400          FROM                                                    33040000
330500                 RCT_VRFD_ODD_UNT A                               33050000
330600              ,  TRECITM  B                                       33060000
330700          WHERE                                                   33070000
330800                A.PO_NBR           =  :DK-PO-NBR                  33080000
330900           AND  A.PO_LNE_NBR       =  :DK-PO-DRIVER-LNE           33090000
331000           AND  A.PO_LNE_NBR       =  B.ORD_LNE_NBR               33100000
331100           AND  A.RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR             33110000
331200           AND  A.PO_NBR           =  B.ORD_NBR                   33120000
331300           AND  B.VER_STATUS_CDE   =  'A'                         33130000
331400           AND  A.RCVR_SEQ_NBR     =  B.REC_SEQ_NBR               33140000
331500           AND  B.PREPK_ID         = :DK-PREPK-ID                 33150000
331600     END-EXEC.                                                    33160000
331700                                                                  33170000
331800     EVALUATE TRUE                                                33180000
331900         WHEN SQLCODE = ZERO                                      33190000
332000         WHEN SQLCODE = +100                                      33200000
332100              CONTINUE                                            33210000
332200         WHEN SQLCODE = -904                                      33220000
332300         WHEN SQLCODE = -911                                      33230000
332400         WHEN SQLCODE = -913                                      33240000
332500             PERFORM 9900-SOFT-ABORT                              33250000
332600         WHEN SQLCODE = -305                                      33260000
332700              CONTINUE                                            33270000
332800         WHEN SQLWARN0 NOT = SPACE                                33280000
332900         WHEN SQLCODE NOT = ZERO                                  33290000
333000              MOVE '4390-SELECT-ODD-UNITS-DRIVER'                 33300000
333100                               TO DP013-PARAGRAPH                 33310000
333200              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  33320000
333300                               TO DP013-MESSAGE-TEXT (1)          33330000
333400              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             33340000
333500              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        33350000
333600              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            33360000
333700              STRING ' PO = '                                     33370000
333800                     PV-DISP-PO-NBR                               33380000
333900                     ' RECV ='                                    33390000
334000                     PV-DISP-REC-SEQ-NBR                          33400000
334100                     ' LINE ='                                    33410000
334200                     PV-DISP-LNE-NBR                              33420000
334300                                         DELIMITED BY SIZE        33430000
334400                              INTO DP013-MESSAGE-TEXT (2)         33440000
334500              MOVE SQLCA       TO DP013-SQLCA                     33450000
334600              MOVE 'RCT00009'  TO DP013-DB2-TABLE-NAME (1)        33460000
334700              MOVE SQLCA       TO DP013-SQLCA                     33470000
334800              SET DP013-DB2-ABEND                                 33480000
334900                               TO TRUE                            33490000
335000              PERFORM DP013-0000-PROCESS-ABEND                    33500000
335100     END-EVALUATE.                                                33510000
335200 EJECT                                                            33520000
335300*----------------------------------------------------------------*33530000
335400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *33540000
335500*----------------------------------------------------------------*33550000
335600                                                                  33560000
335700 4400-MOVE-COMMAREA-TO-SCREEN.                                    33570000
335800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             33580000
335900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          33590000
336000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          33600000
336100             MOVE +1    TO ASC-BLK-SUB                            33610000
336200             PERFORM 5100-WRITE-TEMP-STORAGE                      33620000
336300             ADD +1     TO ASC-BLK-SUB                            33630000
336400             PERFORM 5100-WRITE-TEMP-STORAGE                      33640000
336500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             33650000
336600                 GIVING PV-BLOCK-NUMBER                           33660000
336700                 REMAINDER PV-REMAINDER                           33670000
336800             IF  PV-REMAINDER > ZERO                              33680000
336900                 ADD +1 TO PV-BLOCK-NUMBER                        33690000
337000             END-IF                                               33700000
337100             MOVE +1    TO ASC-BLK-SUB                            33710000
337200             PERFORM 4410-READ-TEMP-STORAGE                       33720000
337300             ADD +1     TO ASC-BLK-SUB                            33730000
337400                           PV-BLOCK-NUMBER                        33740000
337500             PERFORM 4410-READ-TEMP-STORAGE                       33750000
337600     END-IF.                                                      33760000
337700     MOVE +1            TO ASC-BLK-SUB.                           33770000
337800     COMPUTE ASC-ITEM-SUB =                                       33780000
337900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              33790000
338000         + PC-ITEMS-PER-PANEL).                                   33800000
338100*                                                                 33810000
338200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        33820000
338300         ADD +1         TO ASC-BLK-SUB                            33830000
338400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            33840000
338500     END-IF.                                                      33850000
338600*                                                                 33860000
338700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           33870000
338800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                33880000
338900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        33890000
339000     PERFORM 4420-FORMAT-LIST-LINES                               33900000
339100         VARYING PV-SUB                                           33910000
339200         FROM PC-ITEMS-PER-PANEL BY -1                            33920000
339300         UNTIL PV-SUB < +1.                                       33930000
339400*                                                                 33940000
339500     COMPUTE ASC-ITEMS-DISPLAYED =                                33950000
339600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          33960000
339700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    33970000
339800                                      ASTRTITO.                   33980000
339900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    33990000
340000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    34000000
340100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34010000
340200                                   TO ASELITO.                    34020000
340300*                                                                 34030000
340400     IF  DP020-MSG-NUMBER-X = SPACE                               34040000
340500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  34050000
340600*            --- MORE ITEMS TO DISPLAY ----                       34060000
340700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            34070000
340800             SET DP020-MSG-INFORMATIONAL TO TRUE                  34080000
340900         END-IF                                                   34090000
341000     END-IF.                                                      34100000
341100                                                                  34110000
341200     MOVE ASC-PO-NBR               TO APOO.                       34120000
341300     MOVE ASC-REC-SEQ-NBR          TO ARCVRO.                     34130000
341400     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     34140000
341500     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    34150000
341600     MOVE ASC-FCLTY-NME            TO ANAMEO.                     34160000
341700     MOVE ASC-DEPT-NBR             TO ADEPTO.                     34170000
341800     MOVE ASC-RECEIV-STATUS-CDE    TO ASTATO.                     34180000
341900     MOVE ASC-RECEIV-VRFY-INFO     TO ADTETKO.                    34190000
342000     MOVE ASC-TOT-PKSLIP-PACKS     TO APCKSLPO.                   34200000
342100     MOVE ASC-TOT-ODD-UNITS        TO AODDO.                      34210000
342200     MOVE ASC-TOT-ACTUAL-PACKS     TO AACTUALO.                   34220000
342300     MOVE ASC-HDR-TOT-ACT-UNTS     TO ATACTUALO.                  34230000
342400     MOVE ASC-TOT-VERFYD-PACKS     TO AVERFYDO.                   34240000
342500     MOVE ASC-HDR-TOT-VERFYD-UNTS  TO ATVERFYDO.                  34250000
342600     IF ASC-RECEIV-STATUS-CDE = 'VE'                              34260000
342700         MOVE 'ACTUAL'             TO AACTEXPO                    34270000
342800     ELSE                                                         34280000
342900         MOVE 'EXPTED'             TO AACTEXPO                    34290000
343000     END-IF.                                                      34300000
343100*----------------------------------------------------------------*34310000
343200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *34320000
343300*----------------------------------------------------------------*34330000
343400                                                                  34340000
343500 4410-READ-TEMP-STORAGE.                                          34350000
343600                                                                  34360000
343700     EXEC CICS                                                    34370000
343800         READQ TS                                                 34380000
343900             QUEUE (ASC-LIST-QUEUE-NAME)                          34390000
344000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34400000
344100             ITEM  (PV-BLOCK-NUMBER)                              34410000
344200             RESP  (PV-CICS-RESP)                                 34420000
344300     END-EXEC.                                                    34430000
344400                                                                  34440000
344500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       34450000
344600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     34460000
344700         CONTINUE                                                 34470000
344800     ELSE                                                         34480000
344900         SET DP013-CICS-ABEND     TO TRUE                         34490000
345000         SET DP013-NO-ROLLBACK    TO TRUE                         34500000
345100         MOVE '4410-READ-TEMP-STORAGE'                            34510000
345200                                  TO DP013-PARAGRAPH              34520000
345300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      34530000
345400                                  TO DP013-MESSAGE-TEXT(1)        34540000
345500         PERFORM DP013-0000-PROCESS-ABEND                         34550000
345600     END-IF.                                                      34560000
345700                                                                  34570000
345800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             34580000
345900*                                                                 34590000
346000     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         34600000
346100         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               34610000
346200     END-IF.                                                      34620000
346300 EJECT                                                            34630000
346400*----------------------------------------------------------------*34640000
346500*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *34650000
346600*----------------------------------------------------------------*34660000
346700                                                                  34670000
346800 4420-FORMAT-LIST-LINES.                                          34680000
346900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      34690000
347000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                34700000
347100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           34710000
347200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           34720000
347300         MOVE SPACE              TO MR-SELECTI (PV-SUB)           34730000
347400                                    MR-ACTION (PV-SUB)            34740000
347500                                    MR-CL (PV-SUB)                34750000
347600                                    MR-PACK-ID (PV-SUB)           34760000
347700                                    MR-PACK-SKU-X (PV-SUB)        34770000
347800                                    MR-STAT-CDE (PV-SUB)          34780000
347900                                    MR-PKSLIP-PACKS-X (PV-SUB)    34790000
348000                                    MR-ACTUAL-PACKS-X (PV-SUB)    34800000
348100                                    MR-VERFYD-PACKS-X (PV-SUB)    34810000
348200                                    MR-ODD-UNITS-X (PV-SUB)       34820000
348300                                    MR-TOT-ACT-UNTS-X (PV-SUB)    34830000
348400                                    MR-TOT-VERFYD-UNTS-X (PV-SUB) 34840000
348500                                    MR-VERFYD-SOURCE (PV-SUB)     34850000
348600     ELSE                                                         34860000
348700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      34870000
348800                                                   > SPACE        34880000
348900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 34890000
349000                                 TO MR-SELECTI (PV-SUB)           34900000
349100         ELSE                                                     34910000
349200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      34920000
349300                                 TO MR-SELECTI (PV-SUB)           34930000
349400         END-IF                                                   34940000
349500*                                                                 34950000
349600         IF  DP030-SET-CURSOR-TRAILER                             34960000
349700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)34970000
349800                 > SPACE)                                         34980000
349900               OR (PV-SUB = 1))                                   34990000
350000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               35000000
350100                MOVE -1          TO MR-SELECTL (PV-SUB)           35010000
350200             END-IF                                               35020000
350300         END-IF                                                   35030000
350400*                                                                 35040000
350500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           35050000
350600             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           35060000
350700                                 TO MR-ACTION (PV-SUB)            35070000
350800             MOVE ASC-CL (ASC-BLK-SUB ASC-ITEM-SUB)               35080000
350900                                 TO MR-CL (PV-SUB)                35090000
351000             MOVE ASC-PACK-ID (ASC-BLK-SUB ASC-ITEM-SUB)          35100000
351100                                 TO MR-PACK-ID (PV-SUB)           35110000
351200             MOVE ASC-PACK-SKU (ASC-BLK-SUB ASC-ITEM-SUB)         35120000
351300                                 TO MR-PACK-SKU (PV-SUB)          35130000
351400             MOVE ASC-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB)         35140000
351500                                 TO MR-STAT-CDE (PV-SUB)          35150000
351600             MOVE ASC-PKSLIP-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)     35160000
351700                                 TO MR-PKSLIP-PACKS (PV-SUB)      35170000
351800             MOVE ASC-ACTUAL-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)     35180000
351900                                 TO MR-ACTUAL-PACKS (PV-SUB)      35190000
352000             IF ASC-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'VE'    35200000
352100                 MOVE ASC-VERFYD-PACKS (ASC-BLK-SUB ASC-ITEM-SUB) 35210000
352200                                     TO MR-VERFYD-PACKS (PV-SUB)  35220000
352300             ELSE                                                 35230000
352400                 MOVE SPACES         TO MR-VERFYD-PACKS-X (PV-SUB)35240000
352500             END-IF                                               35250000
352600             MOVE ASC-ODD-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)        35260000
352700                                 TO MR-ODD-UNITS (PV-SUB)         35270000
352800             MOVE ASC-TOT-ACT-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)     35280000
352900                                 TO MR-TOT-ACT-UNTS (PV-SUB)      35290000
353000             IF ASC-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'VE'    35300000
353100               MOVE ASC-TOT-VERFYD-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)35310000
353200                                 TO MR-TOT-VERFYD-UNTS (PV-SUB)   35320000
353300             ELSE                                                 35330000
353400                 MOVE SPACES     TO MR-TOT-VERFYD-UNTS-X (PV-SUB) 35340000
353500             END-IF                                               35350000
353600             MOVE ASC-VERFYD-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)    35360000
353700                                 TO MR-VERFYD-SOURCE (PV-SUB)     35370000
353800             IF ASC-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) NOT = 'VE'35380000
353900                 MOVE DP015-YELLOW   TO MR-VERFYD-SOURCEC (PV-SUB)35390000
354000             ELSE                                                 35400000
354100                 MOVE DP015-BLUE     TO MR-VERFYD-SOURCEC (PV-SUB)35410000
354200             END-IF                                               35420000
354300         END-IF                                                   35430000
354400     END-IF.                                                      35440000
354500     SUBTRACT +1 FROM ASC-ITEM-SUB                                35450000
354600     IF  ASC-ITEM-SUB < + 1                                       35460000
354700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  35470000
354800         MOVE +1                 TO ASC-BLK-SUB                   35480000
354900     END-IF.                                                      35490000
355000******************************************************************35500000
355100** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **35510000
355200** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **35520000
355300** ISSUE A WARNING.                                             **35530000
355400******************************************************************35540000
355500 4430-CHECK-FOR-BEGIN-AND-END.                                    35550000
355600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       35560000
355700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     35570000
355800*            -- NO END-OF-RANGE SPECFIED ---                      35580000
355900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            35590000
356000             SET DP020-MSG-WARNING TO TRUE                        35600000
356100             PERFORM 4431-POSITION-AT-WARNING                     35610000
356200         END-IF                                                   35620000
356300     ELSE                                                         35630000
356400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     35640000
356500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                35650000
356600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            35660000
356700             SET DP020-MSG-WARNING TO TRUE                        35670000
356800             PERFORM 4431-POSITION-AT-WARNING                     35680000
356900         END-IF                                                   35690000
357000     END-IF.                                                      35700000
357100******************************************************************35710000
357200** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **35720000
357300** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **35730000
357400** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **35740000
357500** POSITION THE CURSOR THERE.                                   **35750000
357600******************************************************************35760000
357700 4431-POSITION-AT-WARNING.                                        35770000
357800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 35780000
357900                    - PV-TOP-ITEM + 1.                            35790000
358000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      35800000
358100         CONTINUE                                                 35810000
358200     ELSE                                                         35820000
358300         SET DP030-SET-CURSOR-APPL-1                              35830000
358400                                   TO TRUE                        35840000
358500         MOVE -1                   TO MR-SELECTL (PV-SUB)         35850000
358600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         35860000
358700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         35870000
358800     END-IF.                                                      35880000
358900*                                                                 35890000
359000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   35900000
359100                    - PV-TOP-ITEM + 1.                            35910000
359200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      35920000
359300         CONTINUE                                                 35930000
359400     ELSE                                                         35940000
359500         SET DP030-SET-CURSOR-APPL-1                              35950000
359600                                   TO TRUE                        35960000
359700         MOVE -1                   TO MR-SELECTL (PV-SUB)         35970000
359800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         35980000
359900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         35990000
360000     END-IF.                                                      36000000
360100                                                                  36010000
360200 EJECT                                                            36020000
360300*----------------------------------------------------------------*36030000
360400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *36040000
360500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *36050000
360600* FOR THE SELECTED ITEMS QUEUE.                                  *36060000
360700*                                                                *36070000
360800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *36080000
360900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *36090000
361000* THE ARRAY IS FULL.                                             *36100000
361100*----------------------------------------------------------------*36110000
361200                                                                  36120000
361300 5000-PREPARE-SEL-QUEUE.                                          36130000
361400                                                                  36140000
361500     MOVE +1                   TO  ASC-BLK-SUB.                   36150000
361600     PERFORM 5100-WRITE-TEMP-STORAGE.                             36160000
361700     ADD +1                    TO  ASC-BLK-SUB.                   36170000
361800     PERFORM 5100-WRITE-TEMP-STORAGE.                             36180000
361900                                                                  36190000
362000     PERFORM 6010-DELETE-SEL-QUEUE.                               36200000
362100                                                                  36210000
362200     EVALUATE TRUE                                                36220000
362300****    F14 - TO RECEIVER PACK LIST                               36230000
362400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              36240000
362500             INITIALIZE RC800-INTER-APPL-COMMAREA                 36250000
362600             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    36260000
362700                                 TO RC800-NUMBER-OF-SELECTED-ITEMS36270000
362800             MOVE ASC-PO-NBR     TO RC800-REC-NBR-N               36280000
362900             MOVE ASC-REC-SEQ-NBR                                 36290000
363000                                 TO RC800-REC-SEQ-NBR-N           36300000
363100             MOVE ASC-OPER-UNT-ID                                 36310000
363200                                 TO RC800-OPER-UNIT-ID            36320000
363300             MOVE ASC-FCLTY-ID   TO RC800-FACILITY-ID             36330000
363400             MOVE ASC-SEL-QUEUE-NAME-OUT TO RC800-SEL-QUEUE-NAME  36340000
363500             SET ASC-UPDATE-TSQ        TO  TRUE                   36350000
363600                                                                  36360000
363700             SET RC801-IDX             TO  1                      36370000
363800             MOVE ZERO                 TO RC800-NUMBER-OF-TS-ITEMS36380000
363900             INITIALIZE RC801-SELECTED-ITEM-ARRAY                 36390000
364000                                                                  36400000
364100             PERFORM 5210-FILL-SEL-QUEUE-RECORD2                  36410000
364200                     VARYING PV-ITEM                              36420000
364300                     FROM 1 BY 1                                  36430000
364400                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 36440000
364500                                                                  36450000
364600             IF  RC801-IDX > 1                                    36460000
364700                 PERFORM 5215-WRITE-SEL-QUEUE2                    36470000
364800                 ADD +1                TO RC800-NUMBER-OF-TS-ITEMS36480000
364900             END-IF                                               36490000
365000****    F18 - TO NOTIF/TRBL DC LIST                               36500000
365100         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              36510000
365200             INITIALIZE TM001-INTER-APPL-COMMAREA                 36520000
365300             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    36530000
365400                                 TO TM001-NUMBER-OF-SELECTED-ITEMS36540000
365500             SET ASC-UPDATE-TSQ        TO  TRUE                   36550000
365600             SET TM002-IDX             TO  1                      36560000
365700             MOVE ZERO                 TO TM001-NUMBER-OF-TS-ITEMS36570000
365800             INITIALIZE TM002-SELECTED-ITEM-ARRAY                 36580000
365900             MOVE ASC-SEL-QUEUE-NAME-OUT TO TM001-SEL-QUEUE-NAME  36590000
366000             PERFORM 5220-FILL-SEL-QUEUE-RECORD3                  36600000
366100                     VARYING PV-ITEM                              36610000
366200                     FROM 1 BY 1                                  36620000
366300                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 36630000
366400                                                                  36640000
366500             IF  TM002-IDX > 1                                    36650000
366600                 PERFORM 5225-WRITE-SEL-QUEUE3                    36660000
366700                 ADD +1                TO TM001-NUMBER-OF-TS-ITEMS36670000
366800             END-IF                                               36680000
366900****    F23 - TO STORE VERIFY ADJUST BY PACK                      36690000
367000         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              36700000
367100             MOVE ASC-SEL-QUEUE-NAME-OUT TO RC036-SEL-QUEUE-NAME  36710000
367200             MOVE ASC-TRB-QUEUE-NAME   TO RC036-TRB-QUEUE-NAME    36720000
367300             MOVE ASC-OPER-UNT-ID      TO RC036-OPER-UNT-ID       36730000
367400             MOVE ASC-FCLTY-ID         TO RC036-FCLTY-ID          36740000
367500             MOVE ASC-FCLTY-NME        TO RC036-FCLTY-NME         36750000
367600             MOVE ASC-PO-NBR           TO RC036-PO-NBR            36760000
367700             MOVE ASC-REC-SEQ-NBR      TO RC036-REC-SEQ-NBR       36770000
367800             SET ASC-UPDATE-TSQ        TO  TRUE                   36780000
367900                                                                  36790000
368000             SET RC037-IDX             TO  1                      36800000
368100             MOVE ZERO                 TO RC036-NUMBER-OF-TS-ITEMS36810000
368200             INITIALIZE RC037-SELECTED-ITEM-ARRAY                 36820000
368300                                                                  36830000
368400             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   36840000
368500                     VARYING PV-ITEM                              36850000
368600                     FROM 1 BY 1                                  36860000
368700                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 36870000
368800                                                                  36880000
368900             IF  RC037-IDX > 1                                    36890000
369000                 PERFORM 5205-WRITE-SEL-QUEUE                     36900000
369100                 ADD +1                TO RC036-NUMBER-OF-TS-ITEMS36910000
369200             END-IF                                               36920000
369300                                                                  36930000
369400     END-EVALUATE.                                                36940000
369500 EJECT                                                            36950000
369600                                                                  36960000
369700 5050-PREPARE-TO-VERIFY.                                          36970000
369800                                                                  36980000
369900     MOVE +1                   TO  ASC-BLK-SUB.                   36990000
370000     PERFORM 5100-WRITE-TEMP-STORAGE.                             37000000
370100     ADD +1                    TO  ASC-BLK-SUB.                   37010000
370200     PERFORM 5100-WRITE-TEMP-STORAGE.                             37020000
370300*                                                                 37030000
370400*    IF ALL ITEMS IN LIST HAVE A 'CM' STATUS, SKIP 5400 AND       37040000
370500*    PROCESS 5450 DIRECTLY.                                       37050000
370600*                                                                 37060000
370700     IF  ASC-CAN-VERIFY                                           37070000
370800         PERFORM 5450-PROCESS-TRECDIS                             37080000
370900                 VARYING PV-ITEM                                  37090000
371000                 FROM 1 BY 1                                      37100000
371100                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  37110000
371200         SET ASC-CANT-VERIFY   TO  TRUE                           37120000
371300         PERFORM 5700-COUNT-TRECITM                               37130000
371400     ELSE                                                         37140000
371500         SET PS-CAN-VERIFY     TO  TRUE                           37150000
371600         PERFORM 5400-FIRST-PASS-TRECDIS                          37160000
371700                 VARYING PV-ITEM                                  37170000
371800                 FROM 1 BY 1                                      37180000
371900                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  37190000
372000                   OR  PS-CANT-VERIFY                             37200000
372100         IF  PS-CAN-VERIFY                                        37210000
372200             PERFORM 5450-PROCESS-TRECDIS                         37220000
372300                     VARYING PV-ITEM                              37230000
372400                     FROM 1 BY 1                                  37240000
372500                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    37250000
372600             PERFORM 5700-COUNT-TRECITM                           37260000
372700         ELSE                                                     37270000
372800             MOVE PC-TSYMSG-03296 TO DP020-MSG-NUMBER             37280000
372900             SET DP020-MSG-FATAL                                  37290000
373000                 PS-ERROR      TO  TRUE                           37300000
373100         END-IF                                                   37310000
373200     END-IF.                                                      37320000
373300                                                                  37330000
373400 5060-PREPARE-TO-UNVERIFY.                                        37340000
373500                                                                  37350000
373600     MOVE +1                   TO  ASC-BLK-SUB.                   37360000
373700     PERFORM 5100-WRITE-TEMP-STORAGE.                             37370000
373800     ADD +1                    TO  ASC-BLK-SUB.                   37380000
373900     PERFORM 5100-WRITE-TEMP-STORAGE.                             37390000
374000*                                                                 37400000
374100     IF  ASC-CAN-UNVERIFY                                         37410000
374200         PERFORM 5410-PROCESS-TRECDIS-UNVERIFY                    37420000
374300                 VARYING PV-ITEM                                  37430000
374400                 FROM 1 BY 1                                      37440000
374500                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  37450000
374600         SET ASC-CANT-UNVERIFY TO  TRUE                           37460000
374700         PERFORM 5705-COUNT-TRECITM-UNVERIFY                      37470000
374800     ELSE                                                         37480000
374900         SET PS-CAN-UNVERIFY     TO  TRUE                         37490000
375000         PERFORM 5310-FIRST-PASS-TRECDIS-UNVRF                    37500000
375100                 VARYING PV-ITEM                                  37510000
375200                 FROM 1 BY 1                                      37520000
375300                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  37530000
375400                   OR  PS-CANT-UNVERIFY                           37540000
375500         IF  PS-CAN-UNVERIFY                                      37550000
375600             PERFORM 5410-PROCESS-TRECDIS-UNVERIFY                37560000
375700                     VARYING PV-ITEM                              37570000
375800                     FROM 1 BY 1                                  37580000
375900                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    37590000
376000             PERFORM 5705-COUNT-TRECITM-UNVERIFY                  37600000
376100         ELSE                                                     37610000
376200             IF ASC-CANT-UNVERIFY-FS                              37620000
376300                  MOVE PC-TSYMSG-01128     TO  DP020-MSG-NUMBER   37630000
376400                  SET DP020-MSG-FATAL                             37640000
376500                      PS-ERROR      TO  TRUE                      37650000
376600             ELSE                                                 37660000
376700                  MOVE PC-TSYMSG-01127     TO  DP020-MSG-NUMBER   37670000
376800                  SET DP020-MSG-FATAL                             37680000
376900                  PS-ERROR      TO  TRUE                          37690000
377000             END-IF                                               37700000
377100         END-IF                                                   37710000
377200     END-IF.                                                      37720000
377300/                                                                 37730000
377400*----------------------------------------------------------------*37740000
377500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *37750000
377600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *37760000
377700*----------------------------------------------------------------*37770000
377800                                                                  37780000
377900 5100-WRITE-TEMP-STORAGE.                                         37790000
378000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     37800000
378100                                   TO PV-LIST-ITEM-NUMBER.        37810000
378200     COMPUTE PV-BLOCK-NUMBER =                                    37820000
378300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37830000
378400                                                                  37840000
378500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             37850000
378600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             37860000
378700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      37870000
378800             PERFORM 5105-REWRITE-ASC-LISTQ                       37880000
378900         END-IF                                                   37890000
379000     ELSE                                                         37900000
379100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       37910000
379200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            37920000
379300         PERFORM 5110-WRITE-ASC-LISTQ                             37930000
379400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   37940000
379500     END-IF.                                                      37950000
379600                                                                  37960000
379700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             37970000
379800******************************************************************37980000
379900** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **37990000
380000** SPECIFIC COMMAREA.                                           **38000000
380100******************************************************************38010000
380200 5105-REWRITE-ASC-LISTQ.                                          38020000
380300     EXEC CICS                                                    38030000
380400         WRITEQ TS                                                38040000
380500             QUEUE (ASC-LIST-QUEUE-NAME)                          38050000
380600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               38060000
380700             ITEM  (PV-BLOCK-NUMBER)                              38070000
380800             REWRITE                                              38080000
380900             RESP  (PV-CICS-RESP)                                 38090000
381000     END-EXEC.                                                    38100000
381100                                                                  38110000
381200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           38120000
381300         CONTINUE                                                 38130000
381400     ELSE                                                         38140000
381500         SET DP013-CICS-ABEND            TO TRUE                  38150000
381600         SET DP013-NO-ROLLBACK           TO TRUE                  38160000
381700         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       38170000
381800         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     38180000
381900                                         TO DP013-MESSAGE-TEXT(1) 38190000
382000         PERFORM DP013-0000-PROCESS-ABEND                         38200000
382100     END-IF.                                                      38210000
382200                                                                  38220000
382300******************************************************************38230000
382400** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **38240000
382500** SPECIFIC COMMAREA.                                           **38250000
382600******************************************************************38260000
382700 5110-WRITE-ASC-LISTQ.                                            38270000
382800     EXEC CICS                                                    38280000
382900         WRITEQ TS                                                38290000
383000             QUEUE (ASC-LIST-QUEUE-NAME)                          38300000
383100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               38310000
383200             ITEM  (PV-BLOCK-NUMBER)                              38320000
383300             RESP  (PV-CICS-RESP)                                 38330000
383400     END-EXEC.                                                    38340000
383500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      38350000
383600         SET DP013-CICS-ABEND      TO TRUE                        38360000
383700         SET DP013-NO-ROLLBACK     TO TRUE                        38370000
383800         MOVE '5110-WRITE-ASC-LISTQ'                              38380000
383900                                   TO DP013-PARAGRAPH             38390000
384000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           38400000
384100                                   TO DP013-MESSAGE-TEXT(1)       38410000
384200         PERFORM DP013-0000-PROCESS-ABEND                         38420000
384300     END-IF.                                                      38430000
384400 EJECT                                                            38440000
384500*----------------------------------------------------------------*38450000
384600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *38460000
384700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *38470000
384800*----------------------------------------------------------------*38480000
384900                                                                  38490000
385000 5200-FILL-SEL-QUEUE-RECORD.                                      38500000
385100                                                                  38510000
385200     PERFORM 6112-READ-LIST-QUEUE.                                38520000
385300                                                                  38530000
385400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38540000
385500         PERFORM                                                  38550000
385600         VARYING LQW-IDX                                          38560000
385700         FROM 1 BY 1                                              38570000
385800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38580000
385900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          38590000
386000                                                                  38600000
386100             IF  LQW-SELECT (LQW-IDX)                             38610000
386200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              38620000
386300                                   TO RC037-ITEM (RC037-IDX)      38630000
386400                 MOVE ASC-OPER-UNT-ID                             38640000
386500                                 TO RC037-OPER-UNT-ID (RC037-IDX) 38650000
386600                 MOVE ASC-FCLTY-ID                                38660000
386700                                 TO RC037-FCLTY-ID (RC037-IDX)    38670000
386800                 MOVE ASC-PO-NBR                                  38680000
386900                                 TO RC037-PO-NBR (RC037-IDX)      38690000
387000                 MOVE ASC-REC-SEQ-NBR                             38700000
387100                                 TO RC037-REC-SEQ-NBR (RC037-IDX) 38710000
387200                 MOVE LQW-PACK-ID  (LQW-IDX)                      38720000
387300                                   TO RC037-PACK-ID (RC037-IDX)   38730000
387400                 MOVE LQW-PACK-SKU (LQW-IDX)                      38740000
387500                                   TO RC037-PACK-SKU (RC037-IDX)  38750000
387600                 MOVE LQW-STAT-CDE (LQW-IDX)                      38760000
387700                                   TO RC037-STAT-CDE (RC037-IDX)  38770000
387800                 MOVE SPACE        TO RC037-ACTION-SW (RC037-IDX) 38780000
387900                 SET RC037-IDX UP BY 1                            38790000
388000                 IF  RC037-IDX > RC037-MAX-ITEMS                  38800000
388100                     PERFORM 5205-WRITE-SEL-QUEUE                 38810000
388200                     ADD +1        TO RC036-NUMBER-OF-TS-ITEMS    38820000
388300                     INITIALIZE RC037-SELECTED-ITEM-ARRAY         38830000
388400                     SET RC037-IDX TO  1                          38840000
388500                 END-IF                                           38850000
388600             END-IF                                               38860000
388700         END-PERFORM                                              38870000
388800     END-IF.                                                      38880000
388900                                                                  38890000
389000*----------------------------------------------------------------*38900000
389100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *38910000
389200*----------------------------------------------------------------*38920000
389300                                                                  38930000
389400 5205-WRITE-SEL-QUEUE.                                            38940000
389500                                                                  38950000
389600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38960000
389700                                   TO RC037-SELECTED-ITEMS.       38970000
389800                                                                  38980000
389900     EXEC CICS                                                    38990000
390000          WRITEQ TS                                               39000000
390100              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      39010000
390200              FROM  (RC037-DC-SELECT-RECORD)                      39020000
390300              ITEM  (PV-SEL-QUEUE-ITEM)                           39030000
390400              RESP  (PV-CICS-RESP)                                39040000
390500     END-EXEC.                                                    39050000
390600                                                                  39060000
390700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39070000
390800         CONTINUE                                                 39080000
390900     ELSE                                                         39090000
391000         SET DP013-CICS-ABEND      TO TRUE                        39100000
391100         SET DP013-NO-ROLLBACK     TO TRUE                        39110000
391200         MOVE '5205-WRITE-SEL-QUEUE'                              39120000
391300                                   TO DP013-PARAGRAPH             39130000
391400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          39140000
391500                                   TO DP013-MESSAGE-TEXT(1)       39150000
391600         PERFORM DP013-0000-PROCESS-ABEND                         39160000
391700     END-IF.                                                      39170000
391800                                                                  39180000
391900 5210-FILL-SEL-QUEUE-RECORD2.                                     39190000
392000                                                                  39200000
392100     PERFORM 6112-READ-LIST-QUEUE.                                39210000
392200                                                                  39220000
392300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       39230000
392400         PERFORM                                                  39240000
392500         VARYING LQW-IDX                                          39250000
392600         FROM 1 BY 1                                              39260000
392700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            39270000
392800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          39280000
392900                                                                  39290000
393000             IF  LQW-SELECT (LQW-IDX)                             39300000
393100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              39310000
393200                                   TO RC801-ITEM (RC801-IDX)      39320000
393300                 MOVE LQW-PACK-ID (LQW-IDX)                       39330000
393400                                   TO RC801-PACK-ID  (RC801-IDX)  39340000
393500                 MOVE SPACE        TO RC801-ACTION-SW (RC801-IDX) 39350000
393600                 SET RC801-IDX UP BY 1                            39360000
393700                 IF  RC801-IDX > RC801-MAX-ITEMS                  39370000
393800                     PERFORM 5215-WRITE-SEL-QUEUE2                39380000
393900                     ADD +1        TO RC800-NUMBER-OF-TS-ITEMS    39390000
394000                     INITIALIZE RC801-SELECTED-ITEM-ARRAY         39400000
394100                     SET RC801-IDX TO  1                          39410000
394200                 END-IF                                           39420000
394300             END-IF                                               39430000
394400         END-PERFORM                                              39440000
394500     END-IF.                                                      39450000
394600                                                                  39460000
394700*----------------------------------------------------------------*39470000
394800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *39480000
394900*----------------------------------------------------------------*39490000
395000                                                                  39500000
395100 5215-WRITE-SEL-QUEUE2.                                           39510000
395200                                                                  39520000
395300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            39530000
395400                                   TO RC801-SELECTED-ITEMS.       39540000
395500                                                                  39550000
395600     EXEC CICS                                                    39560000
395700          WRITEQ TS                                               39570000
395800              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      39580000
395900              FROM  (RC801-PREPACK-SELECT-RECORD)                 39590000
396000              ITEM  (PV-SEL-QUEUE-ITEM)                           39600000
396100              RESP  (PV-CICS-RESP)                                39610000
396200     END-EXEC.                                                    39620000
396300                                                                  39630000
396400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39640000
396500         CONTINUE                                                 39650000
396600     ELSE                                                         39660000
396700         SET DP013-CICS-ABEND      TO TRUE                        39670000
396800         SET DP013-NO-ROLLBACK     TO TRUE                        39680000
396900         MOVE '5215-WRITE-SEL-QUEUE2'                             39690000
397000                                   TO DP013-PARAGRAPH             39700000
397100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          39710000
397200                                   TO DP013-MESSAGE-TEXT(1)       39720000
397300         PERFORM DP013-0000-PROCESS-ABEND                         39730000
397400     END-IF.                                                      39740000
397500                                                                  39750000
397600                                                                  39760000
397700 5220-FILL-SEL-QUEUE-RECORD3.                                     39770000
397800                                                                  39780000
397900     PERFORM 6112-READ-LIST-QUEUE.                                39790000
398000                                                                  39800000
398100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       39810000
398200         PERFORM                                                  39820000
398300         VARYING LQW-IDX                                          39830000
398400         FROM 1 BY 1                                              39840000
398500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            39850000
398600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          39860000
398700                                                                  39870000
398800             IF  LQW-SELECT (LQW-IDX)                             39880000
398900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              39890000
399000                                   TO TM002-ITEM (TM002-IDX)      39900000
399100                 MOVE ASC-OPER-UNT-ID                             39910000
399200                                 TO TM002-OPER-UNT-ID (TM002-IDX) 39920000
399300                 MOVE ASC-FCLTY-ID                                39930000
399400                                 TO TM002-FCLTY-ID (TM002-IDX)    39940000
399500                 MOVE ASC-PO-NBR                                  39950000
399600                                 TO TM002-PO-NBR (TM002-IDX)      39960000
399700                 MOVE ASC-REC-SEQ-NBR                             39970000
399800                                 TO TM002-RCVR-SEQ (TM002-IDX)    39980000
399900                 MOVE LQW-PACK-ID (LQW-IDX)                       39990000
400000                                 TO TM002-PREPK-ID (TM002-IDX)    40000000
400100                 MOVE SPACE        TO TM002-ACTION-SW (TM002-IDX) 40010000
400200                 SET TM002-IDX UP BY 1                            40020000
400300                 IF  TM002-IDX > TM002-MAX-ITEMS                  40030000
400400                     PERFORM 5225-WRITE-SEL-QUEUE3                40040000
400500                     ADD +1        TO TM001-NUMBER-OF-TS-ITEMS    40050000
400600                     INITIALIZE TM002-SELECTED-ITEM-ARRAY         40060000
400700                     SET TM002-IDX TO  1                          40070000
400800                 END-IF                                           40080000
400900             END-IF                                               40090000
401000         END-PERFORM                                              40100000
401100     END-IF.                                                      40110000
401200                                                                  40120000
401300*----------------------------------------------------------------*40130000
401400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *40140000
401500*----------------------------------------------------------------*40150000
401600                                                                  40160000
401700 5225-WRITE-SEL-QUEUE3.                                           40170000
401800                                                                  40180000
401900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            40190000
402000                                   TO TM002-SELECTED-ITEMS.       40200000
402100                                                                  40210000
402200     EXEC CICS                                                    40220000
402300          WRITEQ TS                                               40230000
402400              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      40240000
402500              FROM  (TM002-MESSAGE-SEL-REC)                       40250000
402600              ITEM  (PV-SEL-QUEUE-ITEM)                           40260000
402700              RESP  (PV-CICS-RESP)                                40270000
402800     END-EXEC.                                                    40280000
402900                                                                  40290000
403000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40300000
403100         CONTINUE                                                 40310000
403200     ELSE                                                         40320000
403300         SET DP013-CICS-ABEND      TO TRUE                        40330000
403400         SET DP013-NO-ROLLBACK     TO TRUE                        40340000
403500         MOVE '5215-WRITE-SEL-QUEUE2'                             40350000
403600                                   TO DP013-PARAGRAPH             40360000
403700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          40370000
403800                                   TO DP013-MESSAGE-TEXT(1)       40380000
403900         PERFORM DP013-0000-PROCESS-ABEND                         40390000
404000     END-IF.                                                      40400000
404100                                                                  40410000
404200 5300-GET-TRECEIV-STATUS.                                         40420000
404300                                                                  40430000
404400     EXEC SQL                                                     40440000
404500          SELECT                                                  40450000
404600             FS_POST_TMST                                         40460000
404700           , STATUS_CDE                                           40470000
404800           , VERFYD_TMST                                          40480000
404900           , VRFD_USR_ID                                          40490000
405000           , PKGNG_CDE                                            40500000
405100           , PACK_BY_ST_IND                                       40510000
405200           , REC_TYP_CDE                                          40520000
405300        INTO                                                      40530000
405400             :RECEIV-FS-POST-TMST                                 40540000
405500           , :RECEIV-STATUS-CDE                                   40550000
405600           , :RECEIV-VERFYD-TMST                                  40560000
405700           , :RECEIV-VRFD-USR-ID                                  40570000
405800           , :RECEIV-PKGNG-CDE                                    40580000
405900           , :RECEIV-PACK-BY-ST-IND                               40590000
406000           , :RECEIV-REC-TYP-CDE                                  40600000
406100          FROM  TRECEIV                                           40610000
406200          WHERE                                                   40620000
406300                 ORD_NBR          =  :DK-PO-NBR                   40630000
406400          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              40640000
406500          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              40650000
406600          AND    FCLTY_ID         =  :DK-FCLTY-ID                 40660000
406700          AND    VER_STATUS_CDE   =  'A'                          40670000
406800     END-EXEC.                                                    40680000
406900                                                                  40690000
407000     EVALUATE TRUE                                                40700000
407100         WHEN SQLCODE = ZERO                                      40710000
407200           IF RECEIV-STATUS-CDE = 'VE'                            40720000
407300              MOVE  RECEIV-VERFYD-TMST TO PV-WORK-TIMESTAMP       40730000
407400              MOVE  PV-WORK-YEAR       TO PV-DISPLAY-YEAR         40740000
407500              MOVE  PV-WORK-MONTH      TO PV-DISPLAY-MONTH        40750000
407600              MOVE  PV-WORK-DAY        TO PV-DISPLAY-DAY          40760000
407700              MOVE  '/'                TO PV-SLASH-1              40770000
407800              MOVE  '/'                TO PV-SLASH-2              40780000
407900              MOVE  PV-WORK-HH         TO PV-DISPLAY-HH           40790000
408000              MOVE  PV-WORK-MIN        TO PV-DISPLAY-MM           40800000
408100              MOVE  ':'                TO PV-COLON-1              40810000
408200              MOVE  '('                TO PV-LEFT-PAREN           40820000
408300              MOVE  PV-DISPLAY-DATE    TO PV-VRFY-DATE            40830000
408400              MOVE  PV-DISPLAY-TIME    TO PV-VRFY-TIME            40840000
408500              MOVE  ' - '              TO PV-SEPARATOR            40850000
408600              MOVE  RECEIV-VRFD-USR-ID TO PV-VRFY-USERID          40860000
408700              MOVE  ')'                TO PV-RIGHT-PAREN          40870000
408800              MOVE  PV-RECEIV-VRFY-INFO                           40880000
408900                                       TO ASC-RECEIV-VRFY-INFO    40890000
409000           ELSE                                                   40900000
409100                 MOVE SPACES       TO ASC-RECEIV-VRFY-INFO        40910000
409200           END-IF                                                 40920000
409300           MOVE RECEIV-REC-TYP-CDE   TO ASC-REC-TYP-CDE           40930000
409400         WHEN SQLCODE = -904                                      40940000
409500         WHEN SQLCODE = -911                                      40950000
409600         WHEN SQLCODE = -913                                      40960000
409700              PERFORM 9900-SOFT-ABORT                             40970000
409800         WHEN SQLWARN0 NOT = SPACE                                40980000
409900         WHEN SQLCODE NOT = ZERO                                  40990000
410000              MOVE '5300-GET-TRECEIV-STATUS'                      41000000
410100                               TO DP013-PARAGRAPH                 41010000
410200              MOVE 'SELECT TRECEIV'                               41020000
410300                               TO DP013-MESSAGE-TEXT (1)          41030000
410400              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             41040000
410500              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        41050000
410600              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           41060000
410700              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        41070000
410800              STRING ' PO = '                                     41080000
410900                     PV-DISP-PO-NBR                               41090000
411000                     ' OPER = '                                   41100000
411100                     PV-DISP-OPER-UNT-ID                          41110000
411200                     ' FCLTY = '                                  41120000
411300                     PV-DISP-FCLTY-ID                             41130000
411400                     ' RECV ='                                    41140000
411500                     PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE        41150000
411600                              INTO DP013-MESSAGE-TEXT (2)         41160000
411700              MOVE SQLCA        TO DP013-SQLCA                    41170000
411800              MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)       41180000
411900              MOVE SQLCA       TO DP013-SQLCA                     41190000
412000              SET DP013-DB2-ABEND                                 41200000
412100                               TO TRUE                            41210000
412200              PERFORM DP013-0000-PROCESS-ABEND                    41220000
412300     END-EVALUATE.                                                41230000
412400                                                                  41240000
412500                                                                  41250000
412600 5310-FIRST-PASS-TRECDIS-UNVRF.                                   41260000
412700                                                                  41270000
412800     PERFORM 6112-READ-LIST-QUEUE.                                41280000
412900                                                                  41290000
413000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       41300000
413100         PERFORM                                                  41310000
413200         VARYING LQW-IDX                                          41320000
413300         FROM 1 BY 1                                              41330000
413400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            41340000
413500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          41350000
413600           OR  PS-CANT-UNVERIFY                                   41360000
413700                                                                  41370000
413800             IF  LQW-SELECT (LQW-IDX)                             41380000
413900                 IF  LQW-STAT-CDE (LQW-IDX) EQUAL 'VE'            41390000
414000                     CONTINUE                                     41400000
414100                 ELSE                                             41410000
414200                     SET PS-CANT-UNVERIFY                         41420000
414300                                   TO  TRUE                       41430000
414400                 END-IF                                           41440000
414500             END-IF                                               41450000
414600         END-PERFORM                                              41460000
414700     END-IF.                                                      41470000
414800/                                                                 41480000
414900*----------------------------------------------------------------*41490000
415000*    CHECK IF ALL SELECTED ITEMS HAVE A 'CM' STATUS CODE         *41500000
415100*----------------------------------------------------------------*41510000
415200                                                                  41520000
415300 5400-FIRST-PASS-TRECDIS.                                         41530000
415400                                                                  41540000
415500     PERFORM 6112-READ-LIST-QUEUE.                                41550000
415600                                                                  41560000
415700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       41570000
415800         PERFORM                                                  41580000
415900         VARYING LQW-IDX                                          41590000
416000         FROM 1 BY 1                                              41600000
416100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            41610000
416200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          41620000
416300           OR  PS-CANT-VERIFY                                     41630000
416400                                                                  41640000
416500             IF  LQW-SELECT (LQW-IDX)                             41650000
416600                 IF  LQW-STAT-CDE (LQW-IDX) EQUAL 'CM'            41660000
416700                 OR  LQW-STAT-CDE (LQW-IDX) EQUAL 'IP'            41670000
416800                     CONTINUE                                     41680000
416900                 ELSE                                             41690000
417000                     SET PS-CANT-VERIFY                           41700000
417100                                   TO  TRUE                       41710000
417200                 END-IF                                           41720000
417300             END-IF                                               41730000
417400         END-PERFORM                                              41740000
417500     END-IF.                                                      41750000
417600                                                                  41760000
417700 5410-PROCESS-TRECDIS-UNVERIFY.                                   41770000
417800                                                                  41780000
417900     PERFORM 6112-READ-LIST-QUEUE.                                41790000
418000                                                                  41800000
418100                                                                  41810000
418200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       41820000
418300         PERFORM                                                  41830000
418400         VARYING LQW-IDX                                          41840000
418500         FROM 1 BY 1                                              41850000
418600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            41860000
418700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          41870000
418800                                                                  41880000
418900             IF  LQW-SELECT (LQW-IDX)                             41890000
419000***              MOVE LQW-PO-LNE-NBR(LQW-IDX)                     41900000
419100***                              TO  RECDIS-ORD-LNE-NBR           41910000
419200                 MOVE LQW-PACK-ID (LQW-IDX)                       41920000
419300                                 TO  TRBNTF-PREPK-ID              41930000
419400                                     DK-PREPK-ID                  41940000
419500                 MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID      41950000
419600                 MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID         41960000
419700                 MOVE ASC-PO-NBR           TO DK-PO-NBR           41970000
419800                 MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR      41980000
419900                 PERFORM 5470-COUNT-TRECDIS-ROWS                  41990000
420000                 PERFORM 5550-PROCESS-LINE-CSR                    42000000
420100                 INITIALIZE RC038-FIELDS                          42010000
420200                 SET RC038-UNVERIFY TO TRUE                       42020000
420300                 PERFORM 5475-CALL-VEM-MODULE                     42030000
420400                                                                  42040000
420500*                ALLOW THE UNVERIFY TO PROCEED IF THE ONLY TROUBLE42050000
420600*                WAS CAUSED BY A PRIOR UNVERIFY ON THE RECEIVER   42060000
420700                 IF  RC038-RECV-TROUBLE                           42070000
420800                     PERFORM 5410A-TRBL-EXCEPTIONS                42080000
420900                     IF PV-DB2-TROUBLE-COUNT > ZERO               42090000
421000                         MOVE SPACE TO RC038-NO-VERIFY-REASON     42100000
421100                     END-IF                                       42110000
421200                 END-IF                                           42120000
421300                                                                  42130000
421400                 IF (PV-DB2-COUNT EQUAL ZERO                      42140000
421500                 OR  RC038-LINE-TROUBLE                           42150000
421600                 OR  RC038-RECV-TROUBLE)                          42160000
421700                     SET LQW-ERROR (LQW-IDX)                      42170000
421800                         PS-ERROR                                 42180000
421900                                 TO  TRUE                         42190000
422000*                    MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" I42200000
422100*                         'NDICATES NO RECDIS OR IN TROUBLE'      42210000
422200*                                TO  DP020-MSG-MESSAGE            42220000
422300                     MOVE PC-TSYMSG-03290 TO DP020-MSG-NUMBER     42230000
422400                     SET DP020-MSG-WARNING TO TRUE                42240000
422500                 ELSE                                             42250000
422600                     PERFORM VARYING LINE-IDX FROM 1 BY 1         42260000
422700                           UNTIL TBL-LNE-NBR (LINE-IDX) = 0       42270000
422800                       MOVE TBL-LNE-NBR (LINE-IDX)                42280000
422900                                             TO RECDIS-ORD-LNE-NBR42290000
423000                       MOVE 'CM'   TO  PV-STATUS-CDE              42300000
423100                       PERFORM 5411-CHECK-SOURCE                  42310000
423200                       PERFORM 5510-UPDATE-TRECDIS-UNVERIFY       42320000
423300                       SET PS-PO-UNVERIFY TO TRUE                 42330000
423400                       PERFORM 5600-UPDATE-TRECITM                42340000
423500                     END-PERFORM                                  42350000
423600                     PERFORM 9000-CALL-PO-RCVR-TRKING-MOD         42360000
423700                     IF PS-NO-ERROR                               42370000
423800                         PERFORM 5805-CHECK-POLINE-FOR-UPDATE     42380000
423900                         MOVE 'IP'   TO  LQW-STAT-CDE (LQW-IDX)   42390000
424000                         PERFORM 4320-SUM-TRECDIS                 42400000
424100                         MOVE RECDIS-VERIFY-ITM-QTY               42410000
424200                                     TO LQW-TOT-ACT-UNTS (LQW-IDX)42420000
424300                         SUBTRACT  LQW-TOT-VERFYD-UNTS (LQW-IDX)  42430000
424400                                             FROM ASC-TOT-VFY-QTY 42440000
424500                         SUBTRACT  LQW-TOT-VERFYD-UNTS (LQW-IDX)  42450000
424600                                    FROM ASC-HDR-TOT-VERFYD-UNTS  42460000
424700**                       ADD RECDIS-AP-VERIFY-ITM-QTY             42470000
424800**                                            TO  ASC-TOT-VFY-QTY 42480000
424900**                       ADD RECDIS-AP-VERIFY-ITM-QTY             42490000
425000**                                    TO ASC-HDR-TOT-VERFYD-UNTS  42500000
425100**                       MOVE RECDIS-AP-VERIFY-ITM-QTY            42510000
425200                         MOVE ZERO                                42520000
425300                                  TO LQW-TOT-VERFYD-UNTS (LQW-IDX)42530000
425400                         SUBTRACT LQW-VERFYD-PACKS (LQW-IDX)      42540000
425500                                         FROM ASC-TOT-VERFYD-PACKS42550000
425600**                       COMPUTE PV-VERFYD-PACKS =                42560000
425700**                          (RECDIS-AP-VERIFY-ITM-QTY             42570000
425800**                              -  LQW-ODD-UNITS (LQW-IDX))       42580000
425900**                                              / ASC-DRIVER-RATIO42590000
426000**                       ADD PV-VERFYD-PACKS                      42600000
426100**                                         TO ASC-TOT-VERFYD-PACKS42610000
426200**                       MOVE PV-VERFYD-PACKS  TO                 42620000
426300                         MOVE ZERO TO                             42630000
426400                                  LQW-VERFYD-PACKS (LQW-IDX)      42640000
426500                         SET LQW-UPDATE (LQW-IDX)   TO  TRUE      42650000
426600                         SET LQW-DESELECT (LQW-IDX) TO  TRUE      42660000
426700                         MOVE SPACE  TO                           42670000
426800                                    LQW-TEMP-SELECTED-SW (LQW-IDX)42680000
426900                         SUBTRACT 1 FROM                          42690000
427000                                     ASC-NUMBER-OF-SELECTED-ITEMS 42700000
427100                     END-IF                                       42710000
427200                 END-IF                                           42720000
427300             END-IF                                               42730000
427400         END-PERFORM                                              42740000
427500     END-IF.                                                      42750000
427600                                                                  42760000
427700     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                42770000
427800     PERFORM 6111-WRITE-LIST-QUEUE.                               42780000
427900                                                                  42790000
428000                                                                  42800000
428100 5410A-TRBL-EXCEPTIONS.                                           42810000
428200     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        42820000
428300     PERFORM 5475A-CHECK-FOR-375-TROUBLE.                         42830000
428400                                                                  42840000
428500 5411-CHECK-SOURCE.                                               42850000
428600     MOVE TBL-LNE-NBR (LINE-IDX)   TO DK-HOLD-LNE-NBR.            42860000
428700     PERFORM 5460-SELECT-TDISTHD.                                 42870000
428800     IF PS-NO-TDISTHD-FOUND                                       42880000
428900        MOVE 'MANUAL'  TO LQW-VERFYD-SOURCE (LQW-IDX)             42890000
429000     ELSE                                                         42900000
429100        IF DISTHD-TOT-CART-CNT = 0                                42910000
429200          MOVE 'MANUAL'  TO LQW-VERFYD-SOURCE (LQW-IDX)           42920000
429300        ELSE                                                      42930000
429400          IF (DISTHD-P2L-CART-CNT = 0                             42940000
429500             AND (DISTHD-FCSE-CART-CNT > 0                        42950000
429600             OR DISTHD-INPK-CART-CNT > 0))                        42960000
429700             MOVE 'CASE'  TO LQW-VERFYD-SOURCE (LQW-IDX)          42970000
429800          ELSE                                                    42980000
429900             IF (DISTHD-P2L-CART-CNT > 0                          42990000
430000               AND (DISTHD-FCSE-CART-CNT > 0                      43000000
430100                 OR DISTHD-INPK-CART-CNT > 0))                    43010000
430200                 MOVE 'P2L/CASE'  TO LQW-VERFYD-SOURCE (LQW-IDX)  43020000
430300             ELSE                                                 43030000
430400             IF (DISTHD-P2L-CART-CNT > 0                          43040000
430500                AND (DISTHD-FCSE-CART-CNT = 0                     43050000
430600                AND DISTHD-INPK-CART-CNT = 0))                    43060000
430700                MOVE 'P2L'  TO LQW-VERFYD-SOURCE (LQW-IDX)        43070000
430800             ELSE                                                 43080000
430900                   MOVE 'MANUAL'  TO LQW-VERFYD-SOURCE (LQW-IDX)  43090000
431000             END-IF                                               43100000
431100          END-IF                                                  43110000
431200        END-IF                                                    43120000
431300       END-IF                                                     43130000
431400     END-IF.                                                      43140000
431500 5415-CHECK-ERRORS.                                               43150000
431600                                                                  43160000
431700     IF PV-DB2-COUNT EQUAL ZERO                                   43170000
431800         SET LQW-ERROR (LQW-IDX)                                  43180000
431900             PS-ERROR  TO TRUE                                    43190000
432000*            MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" INDICATES43200000
432100*                 ' NO RECDIS '                                   43210000
432200*                                TO  DP020-MSG-MESSAGE            43220000
432300             MOVE PC-TSYMSG-03291 TO DP020-MSG-NUMBER             43230000
432400             SET DP020-MSG-WARNING TO TRUE                        43240000
432500     ELSE                                                         43250000
432600        IF RC038-LINE-TROUBLE                                     43260000
432700            SET LQW-ERROR (LQW-IDX)                               43270000
432800                PS-ERROR  TO TRUE                                 43280000
432900*           MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" INDICATES 43290000
433000*                'LINE IN TROUBLE     '                           43300000
433100*                          TO  DP020-MSG-MESSAGE                  43310000
433200                     MOVE PC-TSYMSG-03292 TO DP020-MSG-NUMBER     43320000
433300                     SET DP020-MSG-WARNING TO TRUE                43330000
433400        ELSE                                                      43340000
433500           IF RC038-RECV-TROUBLE                                  43350000
433600               SET LQW-ERROR (LQW-IDX)                            43360000
433700                   PS-ERROR  TO TRUE                              43370000
433800*              MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" INDICAT43380000
433900*                   'ES RECEIVER IN TROUBLE '                     43390000
434000*                          TO  DP020-MSG-MESSAGE                  43400000
434100                 MOVE PC-TSYMSG-03293 TO DP020-MSG-NUMBER         43410000
434200                     SET DP020-MSG-WARNING TO TRUE                43420000
434300           ELSE                                                   43430000
434400              IF RC038-STORE-INVENTORY                            43440000
434500                  SET LQW-INVENTORY (LQW-IDX)                     43450000
434600                      PS-ERROR   TO TRUE                          43460000
434700*                 MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "INV" INDI43470000
434800*                      'CATES STORES IN INV FLUSH PROCESS '       43480000
434900*                            TO  DP020-MSG-MESSAGE                43490000
435000                 MOVE PC-TSYMSG-03294 TO DP020-MSG-NUMBER         43500000
435100                     SET DP020-MSG-WARNING TO TRUE                43510000
435200              ELSE                                                43520000
435300                 IF RC038-VERIFY-NO                               43530000
435400                     SET LQW-ERROR (LQW-IDX)                      43540000
435500                         PS-ERROR   TO TRUE                       43550000
435600*                     MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" 43560000
435700*                      'INDICATES LINE WHERE PROBLEM EXISTS '     43570000
435800*                            TO  DP020-MSG-MESSAGE                43580000
435900                     MOVE PC-TSYMSG-03295 TO DP020-MSG-NUMBER     43590000
436000                     SET DP020-MSG-WARNING TO TRUE                43600000
436100*                                                                 43610000
436200* DMH 07/08/04 BEGIN                                              43620000
436300                  MOVE RC038-OPER-UNT-ID TO PV-DISP-OPER-UNT-ID   43630000
436400                  MOVE RC038-PO-NBR      TO PV-DISP-PO-NBR        43640000
436500                  MOVE RC038-REC-SEQ-NBR TO PV-DISP-REC-SEQ-NBR   43650000
436600                  MOVE RC038-PO-LNE-NBR  TO PV-DISP-LNE-NBR       43660000
436700                  MOVE RC038-PREPACK-ID  TO PV-DISP-PREPK-ID      43670000
436800                     STRING ' RCKCS817 - '                        43680000
436900                             PV-DISP-OPER-UNT-ID '-'              43690000
437000                             PV-DISP-PO-NBR      '-'              43700000
437100                             PV-DISP-REC-SEQ-NBR '-'              43710000
437200                             PV-DISP-LNE-NBR     '-'              43720000
437300                             PV-DISP-PREPK-ID '   -   '           43730000
437400                            'NO VERIFY REASON - '                 43740000
437500                             RC038-NO-VERIFY-REASON               43750000
437600                                  DELIMITED BY SIZE               43760000
437700                             INTO PV-CICS-MSG-AREA                43770000
437800                     MOVE LENGTH OF PV-CICS-MSG-AREA              43780000
437900                               TO PV-COMMAREA-LENGTH              43790000
438000                     PERFORM 9200-WRITE-TO-CICS-LOG               43800000
438100* DMH 07/08/04 END                                                43810000
438200                                                                  43820000
438300                 END-IF                                           43830000
438400              END-IF                                              43840000
438500           END-IF                                                 43850000
438600        END-IF                                                    43860000
438700     END-IF.                                                      43870000
438800/                                                                 43880000
438900*----------------------------------------------------------------*43890000
439000*    UPDATE TRECDIS FOR EACH SELECTED ITEM.                      *43900000
439100*----------------------------------------------------------------*43910000
439200                                                                  43920000
439300 5450-PROCESS-TRECDIS.                                            43930000
439400                                                                  43940000
439500     PERFORM 6112-READ-LIST-QUEUE.                                43950000
439600                                                                  43960000
439700                                                                  43970000
439800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       43980000
439900         PERFORM                                                  43990000
440000         VARYING LQW-IDX                                          44000000
440100         FROM 1 BY 1                                              44010000
440200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            44020000
440300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          44030000
440400                                                                  44040000
440500             IF  LQW-SELECT (LQW-IDX)                             44050000
440600*                MOVE LQW-PO-LNE-NBR (LQW-IDX)                    44060000
440700*                                TO  RECDIS-ORD-LNE-NBR           44070000
440800                 MOVE LQW-PACK-ID (LQW-IDX)                       44080000
440900                                 TO  TRBNTF-PREPK-ID              44090000
441000                                     DK-PREPK-ID                  44100000
441100                 MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID      44110000
441200                 MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID         44120000
441300                 MOVE ASC-PO-NBR           TO DK-PO-NBR           44130000
441400                 MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR      44140000
441500                 PERFORM 5470-COUNT-TRECDIS-ROWS                  44150000
441600                 PERFORM 5550-PROCESS-LINE-CSR                    44160000
441700                 INITIALIZE RC038-FIELDS                          44170000
441800                 SET RC038-VERIFY TO TRUE                         44180000
441900                 PERFORM 5475-CALL-VEM-MODULE                     44190000
442000                 PERFORM 5415-CHECK-ERRORS                        44200000
442100                 IF PS-ERROR                                      44210000
442200                     CONTINUE                                     44220000
442300                 ELSE                                             44230000
442400                     PERFORM VARYING LINE-IDX FROM 1 BY 1         44240000
442500                           UNTIL TBL-LNE-NBR (LINE-IDX) = 0       44250000
442600                       MOVE TBL-LNE-NBR (LINE-IDX)                44260000
442700                                             TO RECDIS-ORD-LNE-NBR44270000
442800                       MOVE 'VE'   TO  PV-STATUS-CDE              44280000
442900                       PERFORM 5500-UPDATE-TRECDIS-VERIFY         44290000
443000                       SET PS-PO-VERIFY TO TRUE                   44300000
443100                       PERFORM 5600-UPDATE-TRECITM                44310000
443200                     END-PERFORM                                  44320000
443300                     PERFORM 9000-CALL-PO-RCVR-TRKING-MOD         44330000
443400                     IF PS-NO-ERROR                               44340000
443500                         PERFORM 5800-CHECK-POLINE-FOR-UPDATE     44350000
443600                         MOVE 'VE'   TO  LQW-STAT-CDE (LQW-IDX)   44360000
443700                         MOVE 'MANUAL'                            44370000
443800                                  TO LQW-VERFYD-SOURCE (LQW-IDX)  44380000
443900                         PERFORM 4340-SELECT-DRIVER-RATIO         44390000
444000                         MOVE RECITM-ORD-LNE-NBR                  44400000
444100                                        TO DK-PO-DRIVER-LNE       44410000
444200                         MOVE RECITM-PREPK-RATO-QTY               44420000
444300                                        TO PV-DRIVER-RATIO        44430000
444400                         PERFORM 4390-SELECT-ODD-UNITS-DRIVER     44440000
444500                         PERFORM 4320-SUM-TRECDIS                 44450000
444600                         PERFORM 4325-SUM-TRECDIS-DRIVER          44460000
444700                         MOVE RECDIS-VERIFY-ITM-QTY               44470000
444800                                     TO LQW-TOT-ACT-UNTS (LQW-IDX)44480000
444900                         SUBTRACT  LQW-TOT-VERFYD-UNTS (LQW-IDX)  44490000
445000                                             FROM ASC-TOT-VFY-QTY 44500000
445100                         SUBTRACT  LQW-TOT-VERFYD-UNTS (LQW-IDX)  44510000
445200                                    FROM ASC-HDR-TOT-VERFYD-UNTS  44520000
445300                         ADD RECDIS-AP-VERIFY-ITM-QTY             44530000
445400                                               TO ASC-TOT-VFY-QTY 44540000
445500                         ADD RECDIS-AP-VERIFY-ITM-QTY             44550000
445600                                      TO ASC-HDR-TOT-VERFYD-UNTS  44560000
445700                         MOVE RECDIS-AP-VERIFY-ITM-QTY            44570000
445800                                 TO LQW-TOT-VERFYD-UNTS (LQW-IDX) 44580000
445900                                                                  44590000
446000                         SUBTRACT LQW-VERFYD-PACKS (LQW-IDX)      44600000
446100                                         FROM ASC-TOT-VERFYD-PACKS44610000
446200                                                                  44620000
446300                         IF PV-DRIVER-RATIO > 0                   44630000
446400                             COMPUTE PV-VERFYD-PACKS =            44640000
446500                                (PV-LNE-AP-VERIFY-ITM-QTY         44650000
446600                                   - PV-ODD-AP-VERIFY-ODU-PK-QTY) 44660000
446700                                                / PV-DRIVER-RATIO 44670000
446800                         ELSE                                     44680000
446900                             MOVE 0        TO PV-VERFYD-PACKS     44690000
447000                         END-IF                                   44700000
447100                         ADD PV-VERFYD-PACKS                      44710000
447200                                           TO ASC-TOT-VERFYD-PACKS44720000
447300                         MOVE PV-VERFYD-PACKS  TO                 44730000
447400                                  LQW-VERFYD-PACKS (LQW-IDX)      44740000
447500                         IF ASC-CONFIRM-ZERO                      44750000
447600                             MOVE 0  TO LQW-ACTUAL-PACKS (LQW-IDX)44760000
447700                                        LQW-ODD-UNITS    (LQW-IDX)44770000
447800                         END-IF                                   44780000
447900                         SET LQW-UPDATE (LQW-IDX)   TO  TRUE      44790000
448000                         SET LQW-DESELECT (LQW-IDX) TO  TRUE      44800000
448100                         MOVE SPACE  TO                           44810000
448200                                    LQW-TEMP-SELECTED-SW (LQW-IDX)44820000
448300                         SUBTRACT 1 FROM                          44830000
448400                                     ASC-NUMBER-OF-SELECTED-ITEMS 44840000
448500                     END-IF                                       44850000
448600                 END-IF                                           44860000
448700             END-IF                                               44870000
448800         END-PERFORM                                              44880000
448900     END-IF.                                                      44890000
449000                                                                  44900000
449100     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                44910000
449200     PERFORM 6111-WRITE-LIST-QUEUE.                               44920000
449300                                                                  44930000
449400 5460-SELECT-TDISTHD.                                             44940000
449500                                                                  44950000
449600                                                                  44960000
449700     EXEC SQL                                                     44970000
449800          SELECT                                                  44980000
449900                TOT_CART_CNT,                                     44990000
450000                FCSE_CART_CNT,                                    45000000
450100                P2L_CART_CNT,                                     45010000
450200                INPK_CART_CNT,                                    45020000
450300                VRFD_TMST                                         45030000
450400          INTO                                                    45040000
450500                :DISTHD-TOT-CART-CNT,                             45050000
450600                :DISTHD-FCSE-CART-CNT,                            45060000
450700                :DISTHD-P2L-CART-CNT,                             45070000
450800                :DISTHD-INPK-CART-CNT,                            45080000
450900                :DISTHD-VRFD-TMST                                 45090000
451000          FROM                                                    45100000
451100                TDISTHD                                           45110000
451200          WHERE                                                   45120000
451300                ORD_NBR          =  :DK-PO-NBR                    45130000
451400          AND   ORD_LNE_NBR      =  :DK-HOLD-LNE-NBR              45140000
451500          AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               45150000
451600     END-EXEC.                                                    45160000
451700                                                                  45170000
451800     EVALUATE TRUE                                                45180000
451900         WHEN SQLCODE = ZERO                                      45190000
452000              SET PS-TDISTHD-FOUND TO TRUE                        45200000
452100         WHEN SQLCODE = +100                                      45210000
452200              SET PS-NO-TDISTHD-FOUND TO TRUE                     45220000
452300         WHEN SQLCODE = -904                                      45230000
452400         WHEN SQLCODE = -911                                      45240000
452500         WHEN SQLCODE = -913                                      45250000
452600             PERFORM 9900-SOFT-ABORT                              45260000
452700         WHEN SQLWARN0 NOT = SPACE                                45270000
452800         WHEN SQLCODE NOT = ZERO                                  45280000
452900              MOVE '5460-SELECT-TDISTHD'                          45290000
453000                               TO DP013-PARAGRAPH                 45300000
453100              MOVE 'GET TDISTHD ROW'                              45310000
453200                               TO DP013-MESSAGE-TEXT (1)          45320000
453300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             45330000
453400              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        45340000
453500              MOVE DK-HOLD-LNE-NBR  TO PV-DISP-LNE-NBR            45350000
453600              STRING ' PO = '                                     45360000
453700                     PV-DISP-PO-NBR                               45370000
453800                     ' RECV ='                                    45380000
453900                     PV-DISP-REC-SEQ-NBR                          45390000
454000                     ' LINE ='                                    45400000
454100                     PV-DISP-LNE-NBR     DELIMITED BY SIZE        45410000
454200                              INTO DP013-MESSAGE-TEXT (2)         45420000
454300              MOVE SQLCA        TO DP013-SQLCA                    45430000
454400              MOVE 'TDISTHD '   TO DP013-DB2-TABLE-NAME (1)       45440000
454500              SET DP013-DB2-ABEND                                 45450000
454600                               TO TRUE                            45460000
454700              PERFORM DP013-0000-PROCESS-ABEND                    45470000
454800     END-EVALUATE.                                                45480000
454900 EJECT                                                            45490000
455000/                                                                 45500000
455100 5470-COUNT-TRECDIS-ROWS.                                         45510000
455200                                                                  45520000
455300     MOVE ZERO            TO  PV-DB2-COUNT.                       45530000
455400     EXEC SQL                                                     45540000
455500          SELECT                                                  45550000
455600                COUNT(*)                                          45560000
455700          INTO                                                    45570000
455800                :PV-DB2-COUNT :PV-NULL-IND                        45580000
455900          FROM                                                    45590000
456000                TRECDIS  A                                        45600000
456100              , TRECITM  B                                        45610000
456200          WHERE                                                   45620000
456300                A.ORD_NBR          =  :DK-PO-NBR                  45630000
456400*         AND   A.ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR         45640000
456500          AND   A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             45650000
456600          AND   A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             45660000
456700          AND   A.FCLTY_ID         =  :DK-FCLTY-ID                45670000
456900          AND   A.ORD_NBR          =  B.ORD_NBR                   45690000
457000          AND   A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               45700000
457100          AND   A.FCLTY_ID         =  B.FCLTY_ID                  45710000
457200          AND   A.OPER_UNT_ID      =  B.OPER_UNT_ID               45720000
457300          AND   A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               45730000
457400          AND   B.VER_STATUS_CDE   =  'A'                         45740000
457500          AND   B.PREPK_ID         = :DK-PREPK-ID                 45750000
457600     END-EXEC.                                                    45760000
457700                                                                  45770000
457800     EVALUATE TRUE                                                45780000
457900         WHEN SQLCODE = ZERO                                      45790000
458000         WHEN SQLCODE = +100                                      45800000
458100              CONTINUE                                            45810000
458210         WHEN SQLCODE = -904                                      45821000
458300         WHEN SQLCODE = -911                                      45830000
458400         WHEN SQLCODE = -913                                      45840000
458500             PERFORM 9900-SOFT-ABORT                              45850000
458600         WHEN SQLWARN0 NOT = SPACE                                45860000
458700         WHEN SQLCODE NOT = ZERO                                  45870000
458800              MOVE '5470-COUNT-TRECDIS-ROWS'                      45880000
458900                               TO DP013-PARAGRAPH                 45890000
459000              MOVE 'CHECK IF ANY RECDIS ROWS EXIST'               45900000
459100                               TO DP013-MESSAGE-TEXT (1)          45910000
459200              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             45920000
459300              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        45930000
459400              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        45940000
459500              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           45950000
459600              MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID           45960000
459700              STRING ' PO = '                                     45970000
459800                     PV-DISP-PO-NBR                               45980000
459900                     ' RECV ='                                    45990000
460000                     PV-DISP-REC-SEQ-NBR                          46000000
460100                     ' OPER ='                                    46010000
460200                     PV-DISP-OPER-UNT-ID                          46020000
460300                     ' FCLTY ='                                   46030000
460400                     PV-DISP-FCLTY-ID                             46040000
460500                     ' PACK ='                                    46050000
460600                     PV-DISP-PREPK-ID    DELIMITED BY SIZE        46060000
460700                              INTO DP013-MESSAGE-TEXT (2)         46070000
460800              MOVE SQLCA        TO DP013-SQLCA                    46080000
460900              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        46090000
461000              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (2)        46100000
461100              MOVE SQLCA       TO DP013-SQLCA                     46110000
461200              SET DP013-DB2-ABEND                                 46120000
461300                               TO TRUE                            46130000
461400              PERFORM DP013-0000-PROCESS-ABEND                    46140000
461500     END-EVALUATE.                                                46150000
461600/                                                                 46160000
461700 5475-CALL-VEM-MODULE.                                            46170000
461800                                                                  46180000
461900     MOVE ASC-AUTO-VE-SW           TO RC038-AUTOVE-PO-SW          46190000
462000     MOVE ASC-PO-NBR               TO RC038-PO-NBR.               46200000
462100     MOVE ASC-REC-SEQ-NBR          TO RC038-REC-SEQ-NBR.          46210000
462200     MOVE 0                        TO RC038-PO-LNE-NBR.           46220000
462300     MOVE LQW-PACK-ID (LQW-IDX)    TO RC038-PREPACK-ID.           46230000
462400     MOVE ASC-OPER-UNT-ID          TO RC038-OPER-UNT-ID.          46240000
462500     MOVE ASC-FCLTY-ID             TO RC038-FCLTY-ID.             46250000
462600     MOVE DP020-USERID             TO RC038-USER-ID.              46260000
462700     MOVE SPACES TO PS-OPER-UNT-TYPE-SW.                          46270000
462800     PERFORM 8000-SELECT-TRECEIV                                  46280000
462900     IF PS-OPER-UNT-NOT-DC                                        46290000
463000         SET RC038-DIRECT-STR      TO TRUE                        46300000
463100     END-IF.                                                      46310000
463200     SET RC038-PROCESS-NO-UPDATE   TO TRUE.                       46320000
463300                                                                  46330000
463400     IF ASC-PACK-BY-STORE                                         46340000
463500        SET RC038-PBS              TO TRUE                        46350000
463600     ELSE                                                         46360000
463700         IF ASC-RECEIV-PKGNG-CDE = 'M' OR 'I'                     46370000
463800            MOVE ASC-RECEIV-PKGNG-CDE                             46380000
463900                                   TO RC038-PKGNG-CDE             46390000
464000         ELSE                                                     46400000
464100            MOVE 'B'               TO RC038-PKGNG-CDE             46410000
464200         END-IF                                                   46420000
464300     END-IF.                                                      46430000
464400                                                                  46440000
464500     MOVE LENGTH OF RC038-FIELDS         TO PV-COMMAREA-LENGTH.   46450000
464600                                                                  46460000
464700     EXEC CICS                                                    46470000
464800         LINK PROGRAM  (PC-RCKUT124)                              46480000
464900              COMMAREA (RC038-FIELDS)                             46490000
465000              LENGTH   (PV-COMMAREA-LENGTH)                       46500000
465100              RESP     (PV-CICS-RESP)                             46510000
465200     END-EXEC.                                                    46520000
465300                                                                  46530000
465400     EVALUATE TRUE                                                46540000
465500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     46550000
465600             IF  RC038-INVALID-SQL     OR                         46560000
465700                 RC038-DATABASE-BUSY                              46570000
465800                 STRING ' RCKCS817 - '        DELIMITED BY SIZE   46580000
465900                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   46590000
466000                        RC038-SUCCESS-IND     DELIMITED BY SIZE   46600000
466100                                   INTO DP013-MESSAGE-TEXT(1)     46610000
466200                 SET DP013-CICS-ABEND        TO TRUE              46620000
466300                 SET DP013-NO-ROLLBACK       TO TRUE              46630000
466400                 MOVE '5475-CALL-VEM-MODULE' TO DP013-PARAGRAPH   46640000
466500                 PERFORM DP013-0000-PROCESS-ABEND                 46650000
466600             END-IF                                               46660000
466700         WHEN OTHER                                               46670000
466800             MOVE PV-CICS-RESP          TO PV-DISPLAY-CICS-RESP   46680000
466900             STRING ' RCKCS817 (OTHER) -' DELIMITED BY SIZE       46690000
467000                    ' CICS RESP = '       DELIMITED BY SIZE       46700000
467100                    PV-DISPLAY-CICS-RESP  DELIMITED BY SIZE       46710000
467200                               INTO DP013-MESSAGE-TEXT(1)         46720000
467300             SET DP013-CICS-ABEND        TO TRUE                  46730000
467400             SET DP013-NO-ROLLBACK       TO TRUE                  46740000
467500             MOVE '5475-CALL-VEM-MODULE' TO DP013-PARAGRAPH       46750000
467600             PERFORM DP013-0000-PROCESS-ABEND                     46760000
467700                                                                  46770000
467800     END-EVALUATE.                                                46780000
467900                                                                  46790000
468000/                                                                 46800000
468100 5475A-CHECK-FOR-375-TROUBLE.                                     46810000
468200                                                                  46820000
468300     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        46830000
468310     MOVE ZERO                   TO  PV-PO-TTRBNTF                46831001
468400     EXEC SQL                                                     46840000
468500          SELECT A.PO_NBR                                         46850001
468600          INTO  :PV-PO-TTRBNTF                                    46860001
468700          FROM   TTRBNTF A                                        46870000
468800                ,TTRBRSN B                                        46880000
468900         WHERE   A.PO_NBR           =  :ASC-PO-NBR                46890001
469000          AND    A.REC_SEQ_NBR      = :ASC-REC-SEQ-NBR            46900000
469100          AND    A.PO_LNE_NBR       =  0                          46910000
469200          AND    A.PREPK_ID         =  0                          46920000
469300          AND    A.RESOLVED_IND    IN  ('N', 'I', 'R')            46930000
469400          AND    A.TRBL_RSN_CDE     =  375                        46940000
469500          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             46950000
469600          AND    B.NOTIF_IND        =  'T'                        46960000
469700         FETCH FIRST 1 ROWS ONLY                                  46970000
469800     END-EXEC.                                                    46980000
469900                                                                  46990000
470000     EVALUATE TRUE                                                47000000
470100         WHEN SQLCODE = ZERO                                      47010000
470110         WHEN SQLCODE = -811                                      47011001
470120              MOVE  1  TO  PV-DB2-TROUBLE-COUNT                   47012001
470200         WHEN SQLCODE = +100                                      47020000
470210              MOVE  0  TO  PV-DB2-TROUBLE-COUNT                   47021001
470300              CONTINUE                                            47030000
470400         WHEN SQLCODE = -904                                      47040000
470500         WHEN SQLCODE = -911                                      47050000
470600         WHEN SQLCODE = -913                                      47060000
470700              PERFORM 9900-SOFT-ABORT                             47070000
470800         WHEN SQLWARN0 NOT = SPACE                                47080000
470900         WHEN SQLCODE NOT = ZERO                                  47090000
471000              MOVE '5475A-CHECK-FOR-375-TROUBLE'                  47100000
471100                                    TO DP013-PARAGRAPH            47110000
471200              MOVE 'COUNT MANUALLY UNVERIFIED TROUBLES'           47120000
471300                                    TO DP013-MESSAGE-TEXT (1)     47130000
471400              MOVE SQLCA       TO DP013-SQLCA                     47140000
471500              SET DP013-DB2-ABEND                                 47150000
471600                               TO TRUE                            47160000
471700              PERFORM DP013-0000-PROCESS-ABEND                    47170000
471800     END-EVALUATE.                                                47180000
471900/                                                                 47190000
472000 5500-UPDATE-TRECDIS-VERIFY.                                      47200000
472100                                                                  47210000
472200*** WHY ARE THEY READING THIS HERE????                            47220000
472300                                                                  47230000
472400     PERFORM 5610-SELECT-TRECITM.                                 47240000
472500                                                                  47250000
472600     IF (DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)  OR                47260000
472700         ASC-CONFIRM-ZERO)                                        47270000
472800         PERFORM 5535-UPDATE-TRECDIS-ZERO                         47280000
472900         PERFORM 5537-UPDATE-ODD-UNIT-ZERO                        47290000
473000         IF ASC-AUTO-VE-YES                                       47300000
473100             PERFORM 5593-CREATE-376-TROUBLE                      47310000
473200         END-IF                                                   47320000
473300     ELSE                                                         47330000
473400         IF ASC-AUTO-VE-YES                                       47340000
473500             PERFORM 4350-CALL-RCKUT128                           47350000
473600             PERFORM 5590-UPDATE-RECDIS-OTBND                     47360000
473700*****    UPDATE FOR ODD UNITS FOR OUTBOUND????                    47370000
473800             PERFORM 5593-CREATE-376-TROUBLE                      47380000
473900         ELSE                                                     47390000
474000             PERFORM 5530-UPDATE-TRECDIS                          47400000
474100             PERFORM 5532-UPDATE-ODD-UNIT                         47410000
474200         END-IF                                                   47420000
474300     END-IF.                                                      47430000
474400                                                                  47440000
474500/                                                                 47450000
474600 5510-UPDATE-TRECDIS-UNVERIFY.                                    47460000
474700                                                                  47470000
474800     PERFORM 5610-SELECT-TRECITM.                                 47480000
474900                                                                  47490000
475000     PERFORM 5540-UPDATE-TRECDIS-UNVERIFY.                        47500000
475100     PERFORM 5545-UPDATE-ODD-UNT-UNVERIFY.                        47510000
475200     IF ASC-AUTO-VE-YES                                           47520000
475300         PERFORM 5591-UPDATE-DISTHD                               47530000
475400         PERFORM 5592-CREATE-375-TROUBLE                          47540000
475500     END-IF.                                                      47550000
475600                                                                  47560000
475700 5530-UPDATE-TRECDIS.                                             47570000
475800     EXEC SQL                                                     47580000
475900          UPDATE TRECDIS                                          47590000
476000          SET    AP_VERIFY_ITM_QTY   =  VERIFY_ITM_QTY            47600000
476100          WHERE                                                   47610000
476200                 ORD_NBR          =  :DK-PO-NBR                   47620000
476300          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          47630000
476400          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              47640000
476500          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              47650000
476600          AND    FCLTY_ID         =  :DK-FCLTY-ID                 47660000
476800     END-EXEC.                                                    47680000
476900                                                                  47690000
477000     EVALUATE TRUE                                                47700000
477100         WHEN SQLCODE = ZERO                                      47710000
477200              CONTINUE                                            47720000
477300         WHEN SQLCODE = +100                                      47730000
477400              CONTINUE                                            47740000
477500         WHEN SQLCODE = -904                                      47750000
477600         WHEN SQLCODE = -911                                      47760000
477700         WHEN SQLCODE = -913                                      47770000
477800              SET PS-UPDATES-DONE TO TRUE                         47780000
477900              PERFORM 9900-SOFT-ABORT                             47790000
478000         WHEN SQLWARN0 NOT = SPACE                                47800000
478100         WHEN SQLCODE NOT = ZERO                                  47810000
478200              MOVE '5500-UPDATE-TRECDIS'                          47820000
478300                               TO DP013-PARAGRAPH                 47830000
478400              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            47840000
478500                               TO DP013-MESSAGE-TEXT (1)          47850000
478600              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             47860000
478700              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        47870000
478800              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        47880000
478900              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           47890000
479000              MOVE RECDIS-ORD-LNE-NBR                             47900000
479100                                    TO PV-DISP-LNE-NBR            47910000
479200              STRING ' PO = '                                     47920000
479300                     PV-DISP-PO-NBR                               47930000
479400                     ' RECV ='                                    47940000
479500                     PV-DISP-REC-SEQ-NBR                          47950000
479600                     ' OPER ='                                    47960000
479700                     PV-DISP-OPER-UNT-ID                          47970000
479800                     ' FCLTY ='                                   47980000
479900                     PV-DISP-FCLTY-ID                             47990000
480000                     ' LINE ='                                    48000000
480100                     PV-DISP-LNE-NBR                              48010000
480200                                         DELIMITED BY SIZE        48020000
480300                              INTO DP013-MESSAGE-TEXT (2)         48030000
480400              MOVE SQLCA        TO DP013-SQLCA                    48040000
480500              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        48050000
480600              MOVE SQLCA       TO DP013-SQLCA                     48060000
480700              SET DP013-DB2-ABEND                                 48070000
480800                               TO TRUE                            48080000
480900              PERFORM DP013-0000-PROCESS-ABEND                    48090000
481000     END-EVALUATE.                                                48100000
481100                                                                  48110000
481200                                                                  48120000
481300 5532-UPDATE-ODD-UNIT.                                            48130000
481400     EXEC SQL                                                     48140000
481500          UPDATE RCT_VRFD_ODD_UNT                                 48150000
481600          SET    AP_VRFY_ODU_QTY  =  DC_VRFY_ODU_QTY              48160000
481700          WHERE                                                   48170000
481800                 PO_NBR           =  :DK-PO-NBR                   48180000
481900          AND    PO_LNE_NBR       =  :RECDIS-ORD-LNE-NBR          48190000
482000          AND    RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR              48200000
482100     END-EXEC.                                                    48210000
482200                                                                  48220000
482300     EVALUATE TRUE                                                48230000
482400         WHEN SQLCODE = ZERO                                      48240000
482500              CONTINUE                                            48250000
482600         WHEN SQLCODE = +100                                      48260000
482700              CONTINUE                                            48270000
482800         WHEN SQLCODE = -904                                      48280000
482900         WHEN SQLCODE = -911                                      48290000
483000         WHEN SQLCODE = -913                                      48300000
483100              SET PS-UPDATES-DONE TO TRUE                         48310000
483200              PERFORM 9900-SOFT-ABORT                             48320000
483300         WHEN SQLWARN0 NOT = SPACE                                48330000
483400         WHEN SQLCODE NOT = ZERO                                  48340000
483500              MOVE '5520-UPDATE-ODD-UNIT'                         48350000
483600                               TO DP013-PARAGRAPH                 48360000
483700              MOVE 'UPDATE VERIFIED ODD UNITS TABLE'              48370000
483800                               TO DP013-MESSAGE-TEXT (1)          48380000
483900              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             48390000
484000              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        48400000
484100              MOVE RECDIS-ORD-LNE-NBR                             48410000
484200                                    TO PV-DISP-LNE-NBR            48420000
484300              STRING ' PO = '                                     48430000
484400                     PV-DISP-PO-NBR                               48440000
484500                     ' RECV ='                                    48450000
484600                     PV-DISP-REC-SEQ-NBR                          48460000
484700                     ' LINE ='                                    48470000
484800                     PV-DISP-LNE-NBR                              48480000
484900                                         DELIMITED BY SIZE        48490000
485000                              INTO DP013-MESSAGE-TEXT (2)         48500000
485100              MOVE SQLCA        TO DP013-SQLCA                    48510000
485200              MOVE 'RCT_VRFD_ODD_UNT'                             48520000
485300                               TO DP013-DB2-TABLE-NAME (1)        48530000
485400              MOVE SQLCA       TO DP013-SQLCA                     48540000
485500              SET DP013-DB2-ABEND                                 48550000
485600                               TO TRUE                            48560000
485700              PERFORM DP013-0000-PROCESS-ABEND                    48570000
485800     END-EVALUATE.                                                48580000
485900                                                                  48590000
486000                                                                  48600000
486100 5535-UPDATE-TRECDIS-ZERO.                                        48610000
486200     MOVE  ZEROES  TO  RECDIS-VERIFY-ITM-QTY.                     48620000
486300     MOVE  ZEROES  TO  RECDIS-AP-VERIFY-ITM-QTY.                  48630000
486400     EXEC SQL                                                     48640000
486500          UPDATE TRECDIS                                          48650000
486600          SET    AP_VERIFY_ITM_QTY = :RECDIS-AP-VERIFY-ITM-QTY    48660000
486700                ,VERIFY_ITM_QTY    = :RECDIS-VERIFY-ITM-QTY       48670000
486800          WHERE                                                   48680000
486900                 ORD_NBR          =  :DK-PO-NBR                   48690000
487000          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          48700000
487100          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              48710000
487200          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              48720000
487300          AND    FCLTY_ID         =  :DK-FCLTY-ID                 48730000
487500     END-EXEC.                                                    48750000
487600                                                                  48760000
487700     EVALUATE TRUE                                                48770000
487800         WHEN SQLCODE = ZERO                                      48780000
487900              CONTINUE                                            48790000
488000         WHEN SQLCODE = +100                                      48800000
488100              CONTINUE                                            48810000
488200         WHEN SQLCODE = -904                                      48820000
488300         WHEN SQLCODE = -911                                      48830000
488400         WHEN SQLCODE = -913                                      48840000
488500              SET PS-UPDATES-DONE TO TRUE                         48850000
488600              PERFORM 9900-SOFT-ABORT                             48860000
488700         WHEN SQLWARN0 NOT = SPACE                                48870000
488800         WHEN SQLCODE NOT = ZERO                                  48880000
488900              MOVE '5535-UPDATE-TRECDIS-ZERO'                     48890000
489000                               TO DP013-PARAGRAPH                 48900000
489100              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            48910000
489200                               TO DP013-MESSAGE-TEXT (1)          48920000
489300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             48930000
489400              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        48940000
489500              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        48950000
489600              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           48960000
489700              MOVE RECDIS-ORD-LNE-NBR                             48970000
489800                                    TO PV-DISP-LNE-NBR            48980000
489900              STRING ' PO = '                                     48990000
490000                     PV-DISP-PO-NBR                               49000000
490100                     ' RECV ='                                    49010000
490200                     PV-DISP-REC-SEQ-NBR                          49020000
490300                     ' OPER ='                                    49030000
490400                     PV-DISP-OPER-UNT-ID                          49040000
490500                     ' FCLTY ='                                   49050000
490600                     PV-DISP-FCLTY-ID                             49060000
490700                     ' LINE ='                                    49070000
490800                     PV-DISP-LNE-NBR                              49080000
490900                                         DELIMITED BY SIZE        49090000
491000                              INTO DP013-MESSAGE-TEXT (2)         49100000
491100              MOVE SQLCA        TO DP013-SQLCA                    49110000
491200              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        49120000
491300              MOVE SQLCA       TO DP013-SQLCA                     49130000
491400              SET DP013-DB2-ABEND                                 49140000
491500                               TO TRUE                            49150000
491600              PERFORM DP013-0000-PROCESS-ABEND                    49160000
491700     END-EVALUATE.                                                49170000
491800                                                                  49180000
491900                                                                  49190000
492000 5537-UPDATE-ODD-UNIT-ZERO.                                       49200000
492100     MOVE  ZEROES  TO  RCT00009-DC-VRFY-ODU-QTY.                  49210000
492200     MOVE  ZEROES  TO  RCT00009-AP-VRFY-ODU-QTY.                  49220000
492300     EXEC SQL                                                     49230000
492400          UPDATE RCT_VRFD_ODD_UNT                                 49240000
492500          SET    DC_VRFY_ODU_QTY   = :RCT00009-DC-VRFY-ODU-QTY    49250000
492600                ,AP_VRFY_ODU_QTY   = :RCT00009-AP-VRFY-ODU-QTY    49260000
492700          WHERE                                                   49270000
492800                 PO_NBR           =  :DK-PO-NBR                   49280000
492900          AND    PO_LNE_NBR       =  :RECDIS-ORD-LNE-NBR          49290000
493000          AND    RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR              49300000
493100     END-EXEC.                                                    49310000
493200                                                                  49320000
493300     EVALUATE TRUE                                                49330000
493400         WHEN SQLCODE = ZERO                                      49340000
493500              CONTINUE                                            49350000
493600         WHEN SQLCODE = +100                                      49360000
493700              CONTINUE                                            49370000
493800         WHEN SQLCODE = -904                                      49380000
493900         WHEN SQLCODE = -911                                      49390000
494000         WHEN SQLCODE = -913                                      49400000
494100              SET PS-UPDATES-DONE TO TRUE                         49410000
494200              PERFORM 9900-SOFT-ABORT                             49420000
494300         WHEN SQLWARN0 NOT = SPACE                                49430000
494400         WHEN SQLCODE NOT = ZERO                                  49440000
494500              MOVE '5537-UPDATE-ODD-UNIT-ZERO'                    49450000
494600                               TO DP013-PARAGRAPH                 49460000
494700              MOVE 'UPDATE VERIFIED ODD UNIT TABLE'               49470000
494800                               TO DP013-MESSAGE-TEXT (1)          49480000
494900              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             49490000
495000              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        49500000
495100              MOVE RECDIS-ORD-LNE-NBR                             49510000
495200                                    TO PV-DISP-LNE-NBR            49520000
495300              STRING ' PO = '                                     49530000
495400                     PV-DISP-PO-NBR                               49540000
495500                     ' RECV ='                                    49550000
495600                     PV-DISP-REC-SEQ-NBR                          49560000
495700                     ' LINE ='                                    49570000
495800                     PV-DISP-LNE-NBR                              49580000
495900                                         DELIMITED BY SIZE        49590000
496000                              INTO DP013-MESSAGE-TEXT (2)         49600000
496100              MOVE SQLCA        TO DP013-SQLCA                    49610000
496200              MOVE 'RCT_VRFD_ODD_UNT '                            49620000
496300                               TO DP013-DB2-TABLE-NAME (1)        49630000
496400              MOVE SQLCA       TO DP013-SQLCA                     49640000
496500              SET DP013-DB2-ABEND                                 49650000
496600                               TO TRUE                            49660000
496700              PERFORM DP013-0000-PROCESS-ABEND                    49670000
496800     END-EVALUATE.                                                49680000
496900                                                                  49690000
497000                                                                  49700000
497100 5540-UPDATE-TRECDIS-UNVERIFY.                                    49710007
497200     EXEC SQL                                                     49720000
497300          UPDATE TRECDIS                                          49730000
497400          SET    AP_VERIFY_ITM_QTY   =  0                         49740000
497500          WHERE                                                   49750000
497600                 ORD_NBR          =  :DK-PO-NBR                   49760000
497700          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          49770000
497800          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              49780000
497900          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              49790000
498000          AND    FCLTY_ID         =  :DK-FCLTY-ID                 49800000
498200     END-EXEC.                                                    49820000
498300                                                                  49830000
498400     EVALUATE TRUE                                                49840000
498500         WHEN SQLCODE = ZERO                                      49850000
498600              CONTINUE                                            49860000
498700         WHEN SQLCODE = +100                                      49870000
498800              CONTINUE                                            49880000
498900         WHEN SQLCODE = -904                                      49890000
499000         WHEN SQLCODE = -911                                      49900000
499100         WHEN SQLCODE = -913                                      49910000
499200              SET PS-UPDATES-DONE TO TRUE                         49920000
499300              PERFORM 9900-SOFT-ABORT                             49930000
499400         WHEN SQLWARN0 NOT = SPACE                                49940000
499500         WHEN SQLCODE NOT = ZERO                                  49950000
499600              MOVE '5540-UPDATE-TRECDIS-UNVERIFY'                 49960000
499700                               TO DP013-PARAGRAPH                 49970000
499800              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            49980000
499900                               TO DP013-MESSAGE-TEXT (1)          49990000
500000              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             50000000
500100              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        50010000
500200              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        50020000
500300              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           50030000
500400              MOVE RECDIS-ORD-LNE-NBR                             50040000
500500                                    TO PV-DISP-LNE-NBR            50050000
500600              STRING ' PO = '                                     50060000
500700                     PV-DISP-PO-NBR                               50070000
500800                     ' RECV ='                                    50080000
500900                     PV-DISP-REC-SEQ-NBR                          50090000
501000                     ' OPER ='                                    50100000
501100                     PV-DISP-OPER-UNT-ID                          50110000
501200                     ' FCLTY ='                                   50120000
501300                     PV-DISP-FCLTY-ID                             50130000
501400                     ' LINE ='                                    50140000
501500                     PV-DISP-LNE-NBR                              50150000
501600                                         DELIMITED BY SIZE        50160000
501700                              INTO DP013-MESSAGE-TEXT (2)         50170000
501800              MOVE SQLCA        TO DP013-SQLCA                    50180000
501900              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        50190000
502000              MOVE SQLCA       TO DP013-SQLCA                     50200000
502100              SET DP013-DB2-ABEND                                 50210000
502200                               TO TRUE                            50220000
502300              PERFORM DP013-0000-PROCESS-ABEND                    50230000
502400     END-EVALUATE.                                                50240000
502500                                                                  50250000
502600 5545-UPDATE-ODD-UNT-UNVERIFY.                                    50260000
502700     EXEC SQL                                                     50270000
502800          UPDATE RCT_VRFD_ODD_UNT                                 50280000
502900          SET    AP_VRFY_ODU_QTY   = 0                            50290000
503000          WHERE                                                   50300000
503100                 PO_NBR           =  :DK-PO-NBR                   50310000
503200          AND    PO_LNE_NBR       =  :RECDIS-ORD-LNE-NBR          50320000
503300          AND    RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR              50330000
503400     END-EXEC.                                                    50340000
503500                                                                  50350000
503600     EVALUATE TRUE                                                50360000
503700         WHEN SQLCODE = ZERO                                      50370000
503800              CONTINUE                                            50380000
503900         WHEN SQLCODE = +100                                      50390000
504000              CONTINUE                                            50400000
504100         WHEN SQLCODE = -904                                      50410000
504200         WHEN SQLCODE = -911                                      50420000
504300         WHEN SQLCODE = -913                                      50430000
504400              SET PS-UPDATES-DONE TO TRUE                         50440000
504500              PERFORM 9900-SOFT-ABORT                             50450000
504600         WHEN SQLWARN0 NOT = SPACE                                50460000
504700         WHEN SQLCODE NOT = ZERO                                  50470000
504800              MOVE '5545-UPDATE-ODD-UNT-UNVERIFY'                 50480000
504900                               TO DP013-PARAGRAPH                 50490000
505000              MOVE 'UPDATE VERIFIED ODD UNIT TABLE'               50500000
505100                               TO DP013-MESSAGE-TEXT (1)          50510000
505200              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             50520000
505300              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        50530000
505400              MOVE RECDIS-ORD-LNE-NBR                             50540000
505500                                    TO PV-DISP-LNE-NBR            50550000
505600              STRING ' PO = '                                     50560000
505700                     PV-DISP-PO-NBR                               50570000
505800                     ' RECV ='                                    50580000
505900                     PV-DISP-REC-SEQ-NBR                          50590000
506000                     ' LINE ='                                    50600000
506100                     PV-DISP-LNE-NBR                              50610000
506200                                         DELIMITED BY SIZE        50620000
506300                              INTO DP013-MESSAGE-TEXT (2)         50630000
506400              MOVE SQLCA        TO DP013-SQLCA                    50640000
506500              MOVE 'RCT_VRFD_ODD_UNT '                            50650000
506600                               TO DP013-DB2-TABLE-NAME (1)        50660000
506700              MOVE SQLCA       TO DP013-SQLCA                     50670000
506800              SET DP013-DB2-ABEND                                 50680000
506900                               TO TRUE                            50690000
507000              PERFORM DP013-0000-PROCESS-ABEND                    50700000
507100     END-EVALUATE.                                                50710000
507200                                                                  50720000
507300 5550-PROCESS-LINE-CSR.                                           50730000
507400     INITIALIZE LINE-NBR-TBL.                                     50740000
507500     SET PS-NOT-EOC-LINE-CURSOR TO TRUE.                          50750000
507600     PERFORM 5560-OPEN-LINE-CURSOR.                               50760000
507700     PERFORM 5570-FETCH-LINE-CURSOR                               50770000
507800         VARYING LINE-IDX FROM 1 BY 1                             50780000
507900         UNTIL PS-EOC-LINE-CURSOR.                                50790000
508000     PERFORM 5580-CLOSE-LINE-CURSOR.                              50800000
508100                                                                  50810000
508200 5560-OPEN-LINE-CURSOR.                                           50820000
508300                                                                  50830000
508400     EXEC SQL                                                     50840000
508500          OPEN LINE-CSR                                           50850000
508600     END-EXEC.                                                    50860000
508700                                                                  50870000
508800     EVALUATE TRUE                                                50880000
508900         WHEN SQLCODE = ZERO                                      50890000
509000             CONTINUE                                             50900000
509100         WHEN SQLWARN0 NOT = SPACES                               50910000
509200         WHEN SQLCODE < ZERO                                      50920000
509300         WHEN SQLCODE > ZERO                                      50930000
509400             MOVE '5560-OPEN-LINE-CURSOR'                         50940000
509500                               TO DP013-PARAGRAPH                 50950000
509600             MOVE 'OPEN LINE CURSOR - '                           50960000
509700                               TO DP013-MESSAGE-TEXT (1)          50970000
509800             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              50980000
509900             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         50990000
510000             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            51000000
510100             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         51010000
510200             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            51020000
510300             STRING ' PO = '                                      51030000
510400                    PV-DISP-PO-NBR                                51040000
510500                    ' RECV ='                                     51050000
510600                    PV-DISP-REC-SEQ-NBR                           51060000
510700                    ' OPER = '                                    51070000
510800                    PV-DISP-OPER-UNT-ID                           51080000
510900                    ' FCLTY = '                                   51090000
511000                    PV-DISP-FCLTY-ID                              51100000
511100                    ' PACK ='                                     51110000
511200                    PV-DISP-PREPK-ID    DELIMITED BY SIZE         51120000
511300                             INTO DP013-MESSAGE-TEXT (2)          51130000
511400             MOVE SQLCA        TO DP013-SQLCA                     51140000
511500             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        51150000
511600             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        51160000
511700             SET DP013-DB2-ABEND                                  51170000
511800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               51180000
511900             PERFORM DP013-0000-PROCESS-ABEND                     51190000
512000     END-EVALUATE.                                                51200000
512100                                                                  51210000
512200 5570-FETCH-LINE-CURSOR.                                          51220000
512300                                                                  51230000
512400     EXEC SQL                                                     51240000
512500          FETCH LINE-CSR                                          51250000
512600          INTO  :RECITM-ORD-LNE-NBR                               51260000
512700             ,  :RECITM-PREPK-DRV-LNE-CDE                         51270000
512800     END-EXEC.                                                    51280000
512900                                                                  51290000
513000     EVALUATE TRUE                                                51300000
513100         WHEN SQLCODE = ZERO                                      51310000
513200             MOVE RECITM-ORD-LNE-NBR   TO TBL-LNE-NBR(LINE-IDX)   51320000
513300                                          DK-PO-DRIVER-LNE        51330000
513400             PERFORM 4325-SUM-TRECDIS-DRIVER                      51340000
513500             MOVE PV-LNE-VERIFY-ITM-QTY                           51350000
513600                                       TO TBL-ITM-QTY(LINE-IDX)   51360000
513700         WHEN SQLCODE = +100                                      51370000
513800             SET PS-EOC-LINE-CURSOR TO TRUE                       51380000
513900         WHEN SQLWARN0 NOT = SPACES                               51390000
514000         WHEN SQLCODE < ZERO                                      51400000
514100         WHEN SQLCODE > ZERO                                      51410000
514200             MOVE '5570-FETCH-LINE-CURSOR'                        51420000
514300                               TO DP013-PARAGRAPH                 51430000
514400             MOVE 'FETCH LINE CURSOR - '                          51440000
514500                               TO DP013-MESSAGE-TEXT (1)          51450000
514600             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              51460000
514700             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         51470000
514800             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            51480000
514900             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         51490000
515000             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            51500000
515100             STRING ' PO = '                                      51510000
515200                    PV-DISP-PO-NBR                                51520000
515300                    ' RECV ='                                     51530000
515400                    PV-DISP-REC-SEQ-NBR                           51540000
515500                    ' OPER = '                                    51550000
515600                    PV-DISP-OPER-UNT-ID                           51560000
515700                    ' FCLTY = '                                   51570000
515800                    PV-DISP-FCLTY-ID                              51580000
515900                    ' PACK ='                                     51590000
516000                    PV-DISP-PREPK-ID    DELIMITED BY SIZE         51600000
516100                             INTO DP013-MESSAGE-TEXT (2)          51610000
516200             MOVE SQLCA        TO DP013-SQLCA                     51620000
516300             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        51630000
516400             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        51640000
516500             SET DP013-DB2-ABEND                                  51650000
516600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               51660000
516700             PERFORM DP013-0000-PROCESS-ABEND                     51670000
516800     END-EVALUATE.                                                51680000
516900                                                                  51690000
517000 5580-CLOSE-LINE-CURSOR.                                          51700000
517100                                                                  51710000
517200     EXEC SQL                                                     51720000
517300          CLOSE LINE-CSR                                          51730000
517400     END-EXEC.                                                    51740000
517500                                                                  51750000
517600     EVALUATE TRUE                                                51760000
517700         WHEN SQLCODE = ZERO                                      51770000
517800             CONTINUE                                             51780000
517900         WHEN SQLWARN0 NOT = SPACES                               51790000
518000         WHEN SQLCODE < ZERO                                      51800000
518100         WHEN SQLCODE > ZERO                                      51810000
518200             MOVE '5580-CLOSE-LINE-CURSOR'                        51820000
518300                               TO DP013-PARAGRAPH                 51830000
518400             MOVE 'CLOSE LINE CURSOR - '                          51840000
518500                               TO DP013-MESSAGE-TEXT (1)          51850000
518600             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              51860000
518700             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         51870000
518800             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            51880000
518900             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         51890000
519000             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            51900000
519100             STRING ' PO = '                                      51910000
519200                    PV-DISP-PO-NBR                                51920000
519300                    ' RECV ='                                     51930000
519400                    PV-DISP-REC-SEQ-NBR                           51940000
519500                    ' OPER = '                                    51950000
519600                    PV-DISP-OPER-UNT-ID                           51960000
519700                    ' FCLTY = '                                   51970000
519800                    PV-DISP-FCLTY-ID                              51980000
519900                    ' PACK ='                                     51990000
520000                    PV-DISP-PREPK-ID    DELIMITED BY SIZE         52000000
520100                             INTO DP013-MESSAGE-TEXT (2)          52010000
520200             MOVE SQLCA        TO DP013-SQLCA                     52020000
520300             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        52030000
520400             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        52040000
520500             SET DP013-DB2-ABEND                                  52050000
520600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               52060000
520700             PERFORM DP013-0000-PROCESS-ABEND                     52070000
520800     END-EVALUATE.                                                52080000
520900                                                                  52090000
521000                                                                  52100000
521100 5590-UPDATE-RECDIS-OTBND.                                        52110000
521200                                                                  52120000
521300     EXEC SQL                                                     52130000
521400          UPDATE TRECDIS                                          52140000
521500          SET    AP_VERIFY_ITM_QTY   =  :RC074-TOTAL-ACTL-ITM-QTY 52150000
521600          WHERE                                                   52160000
521700                 ORD_NBR          =  :RC074-PO-NBR                52170000
521800          AND    ORD_LNE_NBR      =  :RC074-LINE-NBR              52180000
521900          AND    REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR          52190000
522000          AND    OPER_UNT_ID      =  :RC074-OPER-UNT-ID           52200000
522100          AND    FCLTY_ID         =  :RC074-FCLTY-ID              52210000
522300     END-EXEC.                                                    52230000
522400                                                                  52240000
522500     EVALUATE TRUE                                                52250000
522600         WHEN SQLCODE = ZERO                                      52260000
522700              CONTINUE                                            52270000
522800         WHEN SQLCODE = +100                                      52280000
522900              CONTINUE                                            52290000
523000         WHEN SQLCODE = -904                                      52300000
523100         WHEN SQLCODE = -911                                      52310000
523200         WHEN SQLCODE = -913                                      52320000
523300              SET PS-UPDATES-DONE TO TRUE                         52330000
523400              PERFORM 9900-SOFT-ABORT                             52340000
523500         WHEN SQLWARN0 NOT = SPACE                                52350000
523600         WHEN SQLCODE NOT = ZERO                                  52360000
523700              MOVE '5590-UPDATE-RECDIS-OTBND'                     52370000
523800                               TO DP013-PARAGRAPH                 52380000
523900              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            52390000
524000                               TO DP013-MESSAGE-TEXT (1)          52400000
524100              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        52410000
524200              MOVE SQLCA       TO DP013-SQLCA                     52420000
524300              SET DP013-DB2-ABEND                                 52430000
524400                               TO TRUE                            52440000
524500              PERFORM DP013-0000-PROCESS-ABEND                    52450000
524600     END-EVALUATE.                                                52460000
524700                                                                  52470000
524800                                                                  52480000
524900 5591-UPDATE-DISTHD.                                              52490000
525000                                                                  52500000
525100     EXEC SQL                                                     52510000
525200         UPDATE  TDISTHD                                          52520000
525300           SET PRCG_STAT_CDE      = 'R'                           52530000
525400           ,   VRFD_TMST          = :PC-DB2-NINES-DATE            52540000
525500      WHERE ORD_NBR           = :ASC-PO-NBR                       52550000
525600        AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR                  52560000
525700        AND ORD_LNE_NBR       = :RECDIS-ORD-LNE-NBR               52570000
525800     END-EXEC.                                                    52580000
525900                                                                  52590000
526000                                                                  52600000
526100     EVALUATE TRUE                                                52610000
526200         WHEN SQLCODE = ZERO                                      52620000
526300              PERFORM 5597-UPDATE-DISTDT                          52630000
526400         WHEN SQLCODE = +100                                      52640000
526500              CONTINUE                                            52650000
526600         WHEN SQLCODE = -904                                      52660000
526700         WHEN SQLCODE = -911                                      52670000
526800         WHEN SQLCODE = -913                                      52680000
526900              SET PS-UPDATES-DONE TO TRUE                         52690000
527000              PERFORM 9900-SOFT-ABORT                             52700000
527100         WHEN SQLWARN0 NOT = SPACE                                52710000
527200         WHEN SQLCODE NOT = ZERO                                  52720000
527300              MOVE '5591-UPDATE-DISTHD'                           52730000
527400                               TO DP013-PARAGRAPH                 52740000
527500              MOVE 'UPDATE DISTRIBUTION HEADER TABLE'             52750000
527600                               TO DP013-MESSAGE-TEXT (1)          52760000
527700              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        52770000
527800              MOVE SQLCA       TO DP013-SQLCA                     52780000
527900              SET DP013-DB2-ABEND                                 52790000
528000                               TO TRUE                            52800000
528100              PERFORM DP013-0000-PROCESS-ABEND                    52810000
528200     END-EVALUATE.                                                52820000
528300                                                                  52830000
528400 5592-CREATE-375-TROUBLE.                                         52840000
528500                                                                  52850000
528600     INITIALIZE TM500-FIELDS.                                     52860000
528700     MOVE 375                      TO  TM500-TRBL-RSN-CDE.        52870000
528800     PERFORM 5595-GET-DATE-TIME.                                  52880000
528900     STRING 'MANUALLY UNVERIFIED - '                              52890000
529000            DP020-USERID                                          52900000
529100            ' ON '                                                52910000
529200            PV-CURRENT-DATE                                       52920000
529300            ' '                                                   52930000
529400            PV-CURRENT-TIME       DELIMITED BY SIZE               52940000
529500            INTO TM500-FREEFORM-TEXT.                             52950000
529600     PERFORM 5594-CREATE-TROUBLE.                                 52960000
529700                                                                  52970000
529800 5593-CREATE-376-TROUBLE.                                         52980000
529900                                                                  52990000
530000     INITIALIZE TM500-FIELDS.                                     53000000
530100     MOVE 376                      TO  TM500-TRBL-RSN-CDE.        53010000
530200     PERFORM 5595-GET-DATE-TIME.                                  53020000
530300     STRING 'MANUALLY VERIFIED - '                                53030000
530400            DP020-USERID                                          53040000
530500            ' ON '                                                53050000
530600            PV-CURRENT-DATE                                       53060000
530700            ' '                                                   53070000
530800            PV-CURRENT-TIME       DELIMITED BY SIZE               53080000
530900            INTO TM500-FREEFORM-TEXT.                             53090000
531000     PERFORM 5594-CREATE-TROUBLE.                                 53100000
531100                                                                  53110000
531200 5594-CREATE-TROUBLE.                                             53120000
531300     SET TM500-ADD-DETAILS                                        53130000
531400         TM500-CREATE-MANUAL       TO  TRUE.                      53140000
531500                                                                  53150000
531600     MOVE 0                        TO  TM500-NOTIF-NBR.           53160000
531700     MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         53170000
531800     MOVE 1                        TO  TM500-FCLTY-ID.            53180000
531900                                                                  53190000
532000     MOVE ASC-PO-NBR               TO  TM500-PO-NBR.              53200000
532100                                                                  53210000
532200     IF ASC-PACK-BY-STORE                                         53220000
532300         SET TM500-PO-LEVEL            TO  TRUE                   53230000
532400     ELSE                                                         53240000
532500         IF ASC-RECEIV-PKGNG-CDE = 'M' OR 'I'                     53250000
532600             SET TM500-PACK-LEVEL      TO  TRUE                   53260000
532700         ELSE                                                     53270000
532800             SET TM500-LINE-LEVEL      TO  TRUE                   53280000
532900         END-IF                                                   53290000
533000     END-IF.                                                      53300000
533100     MOVE RC074-LINE-NBR           TO  TM500-PO-LNE-NBR.          53310000
533200                                                                  53320000
533300     MOVE ASC-REC-SEQ-NBR          TO  TM500-REC-SEQ-NBR.         53330000
533400                                                                  53340000
533500     MOVE DP020-USERID             TO  TM500-CRE-UID              53350000
533600                                       TM500-NOTIF-UID.           53360000
533700                                                                  53370000
533800     PERFORM 5596-LINK-TO-UPDATE.                                 53380000
533900     IF TM500-CALL-SUCCESSFUL                                     53390000
534000      OR TM500-DUPLICATE-TROUBLE                                  53400000
534100             CONTINUE                                             53410000
534200     ELSE                                                         53420000
534300         MOVE '5594-CREATE-TROUBLE'                               53430000
534400                          TO DP013-PARAGRAPH                      53440000
534500         MOVE ASC-PO-NBR          TO PV-DISP-PO-NBR               53450000
534600         MOVE ASC-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR          53460000
534700         MOVE RC074-LINE-NBR      TO PV-DISP-LNE-NBR              53470000
534800         STRING   ' RET CODE='                                    53480000
534900                  TM500-RETURN-CODE                               53490000
535000                  ' PO='                                          53500000
535100                  PV-DISP-PO-NBR                                  53510000
535200                  ' RCV='                                         53520000
535300                  PV-DISP-REC-SEQ-NBR                             53530000
535400                  ' LNE='                                         53540000
535500                  PV-DISP-LNE-NBR                                 53550000
535600                  DELIMITED BY SIZE                               53560000
535700                        INTO DP013-MESSAGE-TEXT (1)               53570000
535800         PERFORM DP013-0000-PROCESS-ABEND                         53580000
535900     END-IF.                                                      53590000
536000                                                                  53600000
536100 5595-GET-DATE-TIME.                                              53610000
536200                                                                  53620000
536300     EXEC SQL                                                     53630000
536400         SELECT  CURRENT DATE                                     53640000
536500                ,CURRENT TIME                                     53650000
536600           INTO  :PV-CURRENT-DATE                                 53660000
536700                ,:PV-CURRENT-TIME                                 53670000
536800           FROM  SYSIBM.SYSDUMMY1                                 53680000
536900     END-EXEC.                                                    53690000
537000                                                                  53700000
537100                                                                  53710000
537200     EVALUATE TRUE                                                53720000
537300         WHEN SQLCODE = ZERO                                      53730000
537400              CONTINUE                                            53740000
537500         WHEN SQLWARN0 NOT = SPACE                                53750000
537600         WHEN SQLCODE NOT = ZERO                                  53760000
537700              MOVE '5595-GET-DATE-TIME'                           53770000
537800                               TO DP013-PARAGRAPH                 53780000
537900              MOVE 'SELECT DATE AND TIME'                         53790000
538000                               TO DP013-MESSAGE-TEXT (1)          53800000
538100              MOVE 'SYSDUMMY1' TO DP013-DB2-TABLE-NAME (1)        53810000
538200              MOVE SQLCA       TO DP013-SQLCA                     53820000
538300              SET DP013-DB2-ABEND                                 53830000
538400                               TO TRUE                            53840000
538500              PERFORM DP013-0000-PROCESS-ABEND                    53850000
538600     END-EVALUATE.                                                53860000
538700                                                                  53870000
538800                                                                  53880000
538900 5596-LINK-TO-UPDATE.                                             53890000
539000                                                                  53900000
539100     EXEC CICS LINK                                               53910000
539200          PROGRAM (PC-TMKCS520)                                   53920000
539300          COMMAREA(TM500-FIELDS)                                  53930000
539400          RESP    (PV-CICS-RESP)                                  53940000
539500     END-EXEC.                                                    53950000
539600                                                                  53960000
539700     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   53970000
539800         MOVE PV-CICS-RESP         TO PV-DISPLAY-CICS-RESP        53980000
539900         MOVE '5596-LINK-TO-UPDATE'                               53990000
540000                          TO DP013-PARAGRAPH                      54000000
540100         STRING   ' CICS RESP='                                   54010000
540200                  PV-DISPLAY-CICS-RESP                            54020000
540300                  DELIMITED BY SIZE                               54030000
540400                        INTO DP013-MESSAGE-TEXT (1)               54040000
540500         SET DP013-DB2-ABEND                                      54050000
540600                          TO TRUE                                 54060000
540700         PERFORM DP013-0000-PROCESS-ABEND                         54070000
540800     END-IF.                                                      54080000
540900                                                                  54090000
541000/                                                                 54100000
541100 5597-UPDATE-DISTDT.                                              54110000
541200                                                                  54120000
541300     EXEC SQL                                                     54130000
541400         UPDATE  TDISTDT                                          54140000
541500           SET RCVG_PSTD_STAT_CDE = 'N'                           54150000
541600      WHERE ORD_NBR           = :ASC-PO-NBR                       54160000
541700        AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR                  54170000
541800        AND ORD_LNE_NBR       = :RECDIS-ORD-LNE-NBR               54180000
541900     END-EXEC.                                                    54190000
542000                                                                  54200000
542100                                                                  54210000
542200     EVALUATE TRUE                                                54220000
542300         WHEN SQLCODE = ZERO                                      54230000
542400              CONTINUE                                            54240000
542500         WHEN SQLCODE = +100                                      54250000
542600              CONTINUE                                            54260000
542700         WHEN SQLCODE = -904                                      54270000
542800         WHEN SQLCODE = -911                                      54280000
542900         WHEN SQLCODE = -913                                      54290000
543000              SET PS-UPDATES-DONE TO TRUE                         54300000
543100              PERFORM 9900-SOFT-ABORT                             54310000
543200         WHEN SQLWARN0 NOT = SPACE                                54320000
543300         WHEN SQLCODE NOT = ZERO                                  54330000
543400              MOVE '5597-UPDATE-DISTDT'                           54340000
543500                               TO DP013-PARAGRAPH                 54350000
543600              MOVE 'UPDATE DISTRIBUTION DETAIL TABLE'             54360000
543700                               TO DP013-MESSAGE-TEXT (1)          54370000
543800              MOVE 'TDISTDT '  TO DP013-DB2-TABLE-NAME (1)        54380000
543900              MOVE SQLCA       TO DP013-SQLCA                     54390000
544000              SET DP013-DB2-ABEND                                 54400000
544100                               TO TRUE                            54410000
544200              PERFORM DP013-0000-PROCESS-ABEND                    54420000
544300     END-EVALUATE.                                                54430000
544400                                                                  54440000
544500                                                                  54450000
544600*----------------------------------------------------------------*54460000
544700*    TO UPDATE A ROW, THE CURRENT ROW MUST BE CHANGED TO         *54470000
544800*    INACTIVE STATUS.  NEXT, A NEW ROW, WITH THE UPDATED         *54480000
544900*    COLUMNS, IS INSERTED WITH AN ACTIVE STATUS.                 *54490000
545000*----------------------------------------------------------------*54500000
545100 5600-UPDATE-TRECITM.                                             54510000
545200                                                                  54520000
545300     SET PS-DATA-OK          TO  TRUE                             54530000
545400                                                                  54540000
545500     IF  PS-DATA-OK                                               54550000
545600         MOVE 'I'                TO RC031-TABLE-TO-AUDIT          54560000
545700         MOVE 'B'                TO RC031-AUD-TYP-CDE             54570000
545800         MOVE 'U'                TO RC031-AUD-FUNC-CDE            54580000
545900         MOVE ASC-OPER-UNT-ID    TO RC031-OPER-UNT-ID             54590000
546000         MOVE ASC-FCLTY-ID       TO RC031-FCLTY-ID                54600000
546100         MOVE ASC-PO-NBR         TO RC031-PO-NBR                  54610000
546200         MOVE ASC-REC-SEQ-NBR    TO RC031-REC-SEQ-NBR             54620000
546300         MOVE RECDIS-ORD-LNE-NBR TO RC031-PO-LNE-NBR              54630000
546400                                                                  54640000
546500     IF (DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)  OR                54650000
546600         ASC-CONFIRM-ZERO)                                        54660000
546700             MOVE PC-VRFY-AT-0-PROG-NAME                          54670000
546800                                 TO RC031-UPD-PGM-ID              54680000
546900         ELSE                                                     54690000
547000             MOVE PC-CURRENT-PROGRAM-NAME                         54700000
547100                                 TO RC031-UPD-PGM-ID              54710000
547200         END-IF                                                   54720000
547300                                                                  54730000
547400         EXEC CICS                                                54740000
547500              LINK PROGRAM  (PC-AUDIT-RTN)                        54750000
547600              COMMAREA (RC031-FIELDS)                             54760000
547700              LENGTH   (PC-AUDIT-RTN-LENGTH)                      54770000
547800         END-EXEC                                                 54780000
547900                                                                  54790000
548000         EVALUATE TRUE                                            54800000
548100             WHEN RC031-CALL-SUCCESSFUL                           54810000
548200                 CONTINUE                                         54820000
548300             WHEN OTHER                                           54830000
548400                 MOVE '5600-UDDATE-TRECITM'                       54840000
548500                                     TO DP013-PARAGRAPH           54850000
548600                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            54860000
548700                                     TO DP013-MESSAGE-TEXT (1)    54870000
548800                 MOVE RC031-RETURN-DESC                           54880000
548900                                     TO DP013-MESSAGE-TEXT (2)    54890000
549000                 MOVE RC031-SQLCA    TO DP013-SQLCA               54900000
549100                 SET DP013-DB2-ABEND                              54910000
549200                     DP013-XCTL-DISPLAY-RESTART                   54920000
549300                                     TO TRUE                      54930000
549400                 PERFORM DP013-0000-PROCESS-ABEND                 54940000
549500         END-EVALUATE                                             54950000
549600     END-IF.                                                      54960000
549700                                                                  54970000
549800     IF  PS-DATA-OK                                               54980000
549900         IF PS-PO-UNVERIFY                                        54990000
550000             MOVE PC-FS-TIMESTAMP TO                              55000000
550100                                       PV-VERIFY-TIMESTAMP        55010000
550200             MOVE 'U'                TO                           55020000
550300                                       PV-RCPT-DISTR-UPD-CDE      55030000
550400             MOVE 'IP'               TO PV-RECITM-STATUS-CDE      55040000
550500             MOVE SPACES             TO PV-VERIFY-USER            55050000
550600             PERFORM 5620-UPDATE-TRECITM                          55060000
550700             MOVE 'X'                TO PC238-TRANS-TYPE-CDE      55070000
550800         ELSE                                                     55080000
550900             MOVE PV-CURRENT-TIMESTAMP TO                         55090000
551000                                       PV-VERIFY-TIMESTAMP        55100000
551100             MOVE RECITM-RCPT-DISTR-UPD-CDE TO                    55110000
551200                                       PV-RCPT-DISTR-UPD-CDE      55120000
551300             MOVE PV-STATUS-CDE      TO PV-RECITM-STATUS-CDE      55130000
551400             MOVE DP020-USERID       TO PV-VERIFY-USER            55140000
551500             PERFORM 5620-UPDATE-TRECITM                          55150000
551600             IF ASC-AUTO-VE-YES                                   55160000
551700                 IF ASC-RECEIV-PACK-BY-ST-IND = 'Y'               55170000
551800                     PERFORM 5662-VERIFY-DISTHD-LINE              55180000
551900                 END-IF                                           55190000
552000             END-IF                                               55200000
552100             MOVE 'V'                TO PC238-TRANS-TYPE-CDE      55210000
552200         END-IF                                                   55220000
552300     END-IF.                                                      55230000
552400                                                                  55240000
552500     IF  PS-OPER-UNT-TYPE-SW = SPACES                             55250000
552600         PERFORM 8000-SELECT-TRECEIV                              55260000
552700     END-IF.                                                      55270000
552800     IF  PS-OPER-UNT-IS-DC                                        55280000
552900         IF  ASC-CONFIRM-ZERO                                     55290000
553000             MOVE ZEROES                TO PC238-WRKD-UNT-QTY     55300000
553100         ELSE                                                     55310000
553200             MOVE TBL-ITM-QTY  (LINE-IDX)    TO PC238-WRKD-UNT-QTY55320000
553300         END-IF                                                   55330000
553400         PERFORM 8500-UPDATE-UNITS-WRKD                           55340000
553500     END-IF.                                                      55350000
553600     IF  PS-OPER-UNT-NOT-DC                                       55360000
553700         MOVE TBL-ITM-QTY  (LINE-IDX)    TO PC238-WRKD-UNT-QTY    55370000
553800         MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      55380000
553900         PERFORM 8500-UPDATE-UNITS-WRKD                           55390000
554000     END-IF.                                                      55400000
554100/                                                                 55410000
554200*----------------------------------------------------------------*55420000
554300*    GET THE CURRENT ROW FOR PROCESSING.                         *55430000
554400*----------------------------------------------------------------*55440000
554500 5610-SELECT-TRECITM.                                             55450000
554600                                                                  55460000
554700     EXEC SQL                                                     55470000
554800          SELECT                                                  55480000
554900                ORD_NBR                                           55490000
555000              , ORD_LNE_NBR                                       55500000
555100              , REC_SEQ_NBR                                       55510000
555200              , OPER_UNT_ID                                       55520000
555300              , FCLTY_ID                                          55530000
555400              , CRE_TMST                                          55540000
555500              , CRE_UID                                           55550000
555600              , PO_VER_NBR                                        55560000
555700              , ITM_NBR                                           55570000
555800              , PRE_TKT_IND                                       55580000
555900              , TKT_FMT_ID                                        55590000
556000              , RTV_IND                                           55600000
556100              , STATUS_CDE                                        55610000
556200              , VER_STATUS_CDE                                    55620000
556300              , PKSL_ITM_QTY                                      55630000
556400              , DTL_CK_ITM_QTY                                    55640000
556500              , INNR_PACK_QTY                                     55650000
556600              , CASE_PACK_QTY                                     55660000
556700              , RTV_QTY                                           55670000
556800              , EXPTED_CART_CNT                                   55680000
556900              , ACTL_CART_CNT                                     55690000
557000              , MKING_APRON_TMST                                  55700000
557100              , UNT_COST_AMT                                      55710000
557200              , COLOR_DESC                                        55720000
557300              , SIZE_DESC                                         55730000
557400              , VEND_STYL_NAME                                    55740000
557500              , VEND_DESC                                         55750000
557600              , VERFYD_TMST                                       55760000
557700              , PKSL_NBR                                          55770000
557800              , REC_INV_LNE_NBR                                   55780000
557900              , DMG_ITM_QTY                                       55790000
558000              , UPD_TMST                                          55800000
558100              , UPD_UID                                           55810000
558200              , UPD_PGM_ID                                        55820000
558300              , RCPT_DISTR_UPD_CDE                                55830000
558400              , VRFD_USR_ID                                       55840000
558500              , CURRENT TIMESTAMP                                 55850000
558600          INTO                                                    55860000
558700                :RECITM-ORD-NBR                                   55870000
558800              , :RECITM-ORD-LNE-NBR                               55880000
558900              , :RECITM-REC-SEQ-NBR                               55890000
559000              , :RECITM-OPER-UNT-ID                               55900000
559100              , :RECITM-FCLTY-ID                                  55910000
559200              , :RECITM-CRE-TMST                                  55920000
559300              , :RECITM-CRE-UID                                   55930000
559400              , :RECITM-PO-VER-NBR                                55940000
559500              , :RECITM-ITM-NBR                                   55950000
559600              , :RECITM-PRE-TKT-IND                               55960000
559700              , :RECITM-TKT-FMT-ID                                55970000
559800              , :RECITM-RTV-IND                                   55980000
559900              , :RECITM-STATUS-CDE                                55990000
560000              , :RECITM-VER-STATUS-CDE                            56000000
560100              , :RECITM-PKSL-ITM-QTY                              56010000
560200              , :RECITM-DTL-CK-ITM-QTY                            56020000
560300              , :RECITM-INNR-PACK-QTY                             56030000
560400              , :RECITM-CASE-PACK-QTY                             56040000
560500              , :RECITM-RTV-QTY                                   56050000
560600              , :RECITM-EXPTED-CART-CNT                           56060000
560700              , :RECITM-ACTL-CART-CNT                             56070000
560800              , :RECITM-MKING-APRON-TMST                          56080000
560900              , :RECITM-UNT-COST-AMT                              56090000
561000              , :RECITM-COLOR-DESC                                56100000
561100              , :RECITM-SIZE-DESC                                 56110000
561200              , :RECITM-VEND-STYL-NAME                            56120000
561300              , :RECITM-VEND-DESC                                 56130000
561400              , :RECITM-VERFYD-TMST                               56140000
561500              , :RECITM-PKSL-NBR                                  56150000
561600              , :RECITM-REC-INV-LNE-NBR                           56160000
561700              , :RECITM-DMG-ITM-QTY                               56170000
561800              , :RECITM-UPD-TMST                                  56180000
561900              , :RECITM-UPD-UID                                   56190000
562000              , :RECITM-UPD-PGM-ID                                56200000
562100              , :RECITM-RCPT-DISTR-UPD-CDE                        56210000
562200              , :RECITM-VRFD-USR-ID                               56220000
562300              , :PV-CURRENT-TIMESTAMP                             56230000
562400          FROM                                                    56240000
562500                TRECITM                                           56250000
562600          WHERE                                                   56260000
562700                 ORD_NBR          =  :DK-PO-NBR                   56270000
562800          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          56280000
562900          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              56290000
563000          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              56300000
563100          AND    FCLTY_ID         =  :DK-FCLTY-ID                 56310000
563200          AND    VER_STATUS_CDE   =  'A'                          56320000
563300     END-EXEC.                                                    56330000
563400                                                                  56340000
563500     EVALUATE TRUE                                                56350000
563600         WHEN SQLCODE = ZERO                                      56360000
563700              CONTINUE                                            56370000
563800         WHEN SQLCODE = +100                                      56380000
563900              SET PS-DATA-NOT-OK    TO  TRUE                      56390000
564000         WHEN SQLCODE = -904                                      56400000
564100         WHEN SQLCODE = -911                                      56410000
564200         WHEN SQLCODE = -913                                      56420000
564300              PERFORM 9900-SOFT-ABORT                             56430000
564400         WHEN SQLWARN0 NOT = SPACE                                56440000
564500         WHEN SQLCODE NOT = ZERO                                  56450000
564600              MOVE '5610-SELECT-TRECITM'                          56460000
564700                               TO DP013-PARAGRAPH                 56470000
564800              MOVE 'SELECT TRECITM'                               56480000
564900                               TO DP013-MESSAGE-TEXT (1)          56490000
565000              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             56500000
565100              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        56510000
565200              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        56520000
565300              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           56530000
565400              MOVE RECDIS-ORD-LNE-NBR                             56540000
565500                                    TO PV-DISP-LNE-NBR            56550000
565600              STRING ' PO = '                                     56560000
565700                     PV-DISP-PO-NBR                               56570000
565800                     ' RECV ='                                    56580000
565900                     PV-DISP-REC-SEQ-NBR                          56590000
566000                     ' OPER ='                                    56600000
566100                     PV-DISP-OPER-UNT-ID                          56610000
566200                     ' FCLTY ='                                   56620000
566300                     PV-DISP-FCLTY-ID                             56630000
566400                     ' LINE ='                                    56640000
566500                     PV-DISP-LNE-NBR                              56650000
566600                                         DELIMITED BY SIZE        56660000
566700                              INTO DP013-MESSAGE-TEXT (2)         56670000
566800              MOVE SQLCA        TO DP013-SQLCA                    56680000
566900              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        56690000
567000              MOVE SQLCA       TO DP013-SQLCA                     56700000
567100              SET DP013-DB2-ABEND                                 56710000
567200                               TO TRUE                            56720000
567300              PERFORM DP013-0000-PROCESS-ABEND                    56730000
567400     END-EVALUATE.                                                56740000
567500/                                                                 56750000
567600*----------------------------------------------------------------*56760000
567700*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *56770000
567800*----------------------------------------------------------------*56780000
567900                                                                  56790000
568000 5620-UPDATE-TRECITM.                                             56800000
568100                                                                  56810000
568200     EXEC SQL                                                     56820000
568300          UPDATE                                                  56830000
568400                TRECITM                                           56840000
568500          SET   STATUS_CDE        =  :PV-RECITM-STATUS-CDE        56850000
568600               ,VERFYD_TMST       =  :PV-VERIFY-TIMESTAMP         56860000
568700               ,RCPT_DISTR_UPD_CDE =  :PV-RCPT-DISTR-UPD-CDE      56870000
568800               ,VRFD_USR_ID        = :PV-VERIFY-USER              56880000
568900          WHERE                                                   56890000
569000                 ORD_NBR          =  :DK-PO-NBR                   56900000
569100          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          56910000
569200          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              56920000
569300          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              56930000
569400          AND    FCLTY_ID         =  :DK-FCLTY-ID                 56940000
569500          AND    VER_STATUS_CDE   =  'A'                          56950000
569600     END-EXEC.                                                    56960000
569700                                                                  56970000
569800     EVALUATE TRUE                                                56980000
569900         WHEN SQLCODE = ZERO                                      56990000
570000              CONTINUE                                            57000000
570100         WHEN SQLCODE = -904                                      57010000
570200         WHEN SQLCODE = -911                                      57020000
570300         WHEN SQLCODE = -913                                      57030000
570400              SET PS-UPDATES-DONE TO TRUE                         57040000
570500              PERFORM 9900-SOFT-ABORT                             57050000
570600         WHEN SQLWARN0 NOT = SPACE                                57060000
570700         WHEN SQLCODE NOT = ZERO                                  57070000
570800              MOVE '5620-UPDATE-TRECITM'                          57080000
570900                               TO DP013-PARAGRAPH                 57090000
571000              MOVE 'UPDATE TRECITM STATUS CODE'                   57100000
571100                               TO DP013-MESSAGE-TEXT (1)          57110000
571200              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             57120000
571300              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        57130000
571400              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        57140000
571500              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           57150000
571600              MOVE RECDIS-ORD-LNE-NBR                             57160000
571700                                    TO PV-DISP-LNE-NBR            57170000
571800              STRING ' PO = '                                     57180000
571900                     PV-DISP-PO-NBR                               57190000
572000                     ' RECV ='                                    57200000
572100                     PV-DISP-REC-SEQ-NBR                          57210000
572200                     ' OPER ='                                    57220000
572300                     PV-DISP-OPER-UNT-ID                          57230000
572400                     ' FCLTY ='                                   57240000
572500                     PV-DISP-FCLTY-ID                             57250000
572600                     ' LINE ='                                    57260000
572700                     PV-DISP-LNE-NBR                              57270000
572800                                         DELIMITED BY SIZE        57280000
572900                              INTO DP013-MESSAGE-TEXT (2)         57290000
573000              MOVE SQLCA        TO DP013-SQLCA                    57300000
573100              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        57310000
573200              MOVE SQLCA       TO DP013-SQLCA                     57320000
573300              SET DP013-DB2-ABEND                                 57330000
573400                               TO TRUE                            57340000
573500              PERFORM DP013-0000-PROCESS-ABEND                    57350000
573600     END-EVALUATE.                                                57360000
573700/                                                                 57370000
573800 5661-VERIFY-DISTHD-RCVR.                                         57380000
573900                                                                  57390000
574000     EXEC SQL                                                     57400000
574100         UPDATE  TDISTHD                                          57410000
574200           SET PRCG_STAT_CDE      = 'V'                           57420000
574300           ,   VRFD_TMST          = :PV-RECEIV-CURRENT-TIMESTAMP  57430000
574400      WHERE ORD_NBR           = :DK-PO-NBR                        57440000
574500        AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR                   57450000
574600        AND VRFD_TMST         = :PC-DB2-NINES-DATE                57460000
574700     END-EXEC.                                                    57470000
574800                                                                  57480000
574900     EVALUATE TRUE                                                57490000
575000         WHEN SQLCODE = ZERO                                      57500000
575100              CONTINUE                                            57510000
575200         WHEN SQLCODE = +100                                      57520000
575300              CONTINUE                                            57530000
575400         WHEN SQLCODE = -904                                      57540000
575500         WHEN SQLCODE = -911                                      57550000
575600         WHEN SQLCODE = -913                                      57560000
575700              SET PS-UPDATES-DONE TO TRUE                         57570000
575800              PERFORM 9900-SOFT-ABORT                             57580000
575900         WHEN SQLWARN0 NOT = SPACE                                57590000
576000         WHEN SQLCODE NOT = ZERO                                  57600000
576100              MOVE '5661-VERIFY-DISTHD-RCVR'                      57610000
576200                               TO DP013-PARAGRAPH                 57620000
576300              MOVE 'UPDATE DISTRIBUTION HEADER TABLE'             57630000
576400                               TO DP013-MESSAGE-TEXT (1)          57640000
576500              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             57650000
576600              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        57660000
576700              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        57670000
576800              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           57680000
576900              MOVE RECDIS-ORD-LNE-NBR                             57690000
577000                                    TO PV-DISP-LNE-NBR            57700000
577100              STRING ' PO = '                                     57710000
577200                     PV-DISP-PO-NBR                               57720000
577300                     ' RECV ='                                    57730000
577400                     PV-DISP-REC-SEQ-NBR                          57740000
577500                     ' OPER ='                                    57750000
577600                     PV-DISP-OPER-UNT-ID                          57760000
577700                     ' FCLTY ='                                   57770000
577800                     PV-DISP-FCLTY-ID                             57780000
577900                     ' LINE ='                                    57790000
578000                     PV-DISP-LNE-NBR                              57800000
578100                                         DELIMITED BY SIZE        57810000
578200                              INTO DP013-MESSAGE-TEXT (2)         57820000
578300              MOVE SQLCA        TO DP013-SQLCA                    57830000
578400              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        57840000
578500              MOVE SQLCA       TO DP013-SQLCA                     57850000
578600              SET DP013-DB2-ABEND                                 57860000
578700                               TO TRUE                            57870000
578800              PERFORM DP013-0000-PROCESS-ABEND                    57880000
578900     END-EVALUATE.                                                57890000
579000                                                                  57900000
579100 5662-VERIFY-DISTHD-LINE.                                         57910000
579200                                                                  57920000
579300     EXEC SQL                                                     57930000
579400         UPDATE  TDISTHD                                          57940000
579500           SET PRCG_STAT_CDE      = 'V'                           57950000
579600           ,   VRFD_TMST          = :PV-VERIFY-TIMESTAMP          57960000
579700      WHERE ORD_NBR           = :DK-PO-NBR                        57970000
579800        AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR                   57980000
579900        AND ORD_LNE_NBR       = :RECDIS-ORD-LNE-NBR               57990000
580000     END-EXEC.                                                    58000000
580100                                                                  58010000
580200     EVALUATE TRUE                                                58020000
580300         WHEN SQLCODE = ZERO                                      58030000
580400              CONTINUE                                            58040000
580500         WHEN SQLCODE = +100                                      58050000
580600              CONTINUE                                            58060000
580700         WHEN SQLCODE = -904                                      58070000
580800         WHEN SQLCODE = -911                                      58080000
580900         WHEN SQLCODE = -913                                      58090000
581000              SET PS-UPDATES-DONE TO TRUE                         58100000
581100              PERFORM 9900-SOFT-ABORT                             58110000
581200         WHEN SQLWARN0 NOT = SPACE                                58120000
581300         WHEN SQLCODE NOT = ZERO                                  58130000
581400              MOVE '5662-VERIFY-DISTHD-LINE'                      58140000
581500                               TO DP013-PARAGRAPH                 58150000
581600              MOVE 'UPDATE DISTRIBUTION HEADER TABLE'             58160000
581700                               TO DP013-MESSAGE-TEXT (1)          58170000
581800              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             58180000
581900              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        58190000
582000              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        58200000
582100              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           58210000
582200              MOVE RECDIS-ORD-LNE-NBR                             58220000
582300                                    TO PV-DISP-LNE-NBR            58230000
582400              STRING ' PO = '                                     58240000
582500                     PV-DISP-PO-NBR                               58250000
582600                     ' RECV ='                                    58260000
582700                     PV-DISP-REC-SEQ-NBR                          58270000
582800                     ' OPER ='                                    58280000
582900                     PV-DISP-OPER-UNT-ID                          58290000
583000                     ' FCLTY ='                                   58300000
583100                     PV-DISP-FCLTY-ID                             58310000
583200                     ' LINE ='                                    58320000
583300                     PV-DISP-LNE-NBR                              58330000
583400                                         DELIMITED BY SIZE        58340000
583500                              INTO DP013-MESSAGE-TEXT (2)         58350000
583600              MOVE SQLCA        TO DP013-SQLCA                    58360000
583700              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        58370000
583800              MOVE SQLCA       TO DP013-SQLCA                     58380000
583900              SET DP013-DB2-ABEND                                 58390000
584000                               TO TRUE                            58400000
584100              PERFORM DP013-0000-PROCESS-ABEND                    58410000
584200     END-EVALUATE.                                                58420000
584300/                                                                 58430000
584400 5700-COUNT-TRECITM.                                              58440000
584500                                                                  58450000
584600     MOVE 'VE'  TO PV-COUNT-STATUS-CDE.                           58460000
584700     PERFORM 5710-COUNT-TRECITM-ROWS.                             58470000
584800     IF  PV-DB2-COUNT EQUAL ZERO                                  58480000
584900***      MOVE 'ACTUAL' TO AVERITO                                 58490000
585000         PERFORM 5720-GET-TRECEIV-STATUS                          58500000
585100             IF  RECEIV-STATUS-CDE EQUAL 'CM'                     58510000
585200             OR  RECEIV-STATUS-CDE EQUAL 'IP'                     58520000
585300                 PERFORM 5730-UPDATE-TRECEIV-STATUS               58530000
585400                 IF ASC-AUTO-VE-YES                               58540000
585500                     IF ASC-RECEIV-PACK-BY-ST-IND = 'Y'           58550000
585600                         PERFORM 5661-VERIFY-DISTHD-RCVR          58560000
585700                     END-IF                                       58570000
585800                 END-IF                                           58580000
585900             END-IF                                               58590000
586000     END-IF.                                                      58600000
586100                                                                  58610000
586200 5705-COUNT-TRECITM-UNVERIFY.                                     58620000
586300     PERFORM 5720-GET-TRECEIV-STATUS                              58630000
586400     IF RECEIV-STATUS-CDE EQUAL 'VE'                              58640000
586500***      MOVE 'EXPECTED'  TO AVERITO                              58650000
586600         PERFORM 5735-UPDATE-RECEIV-STATUS-UNV                    58660000
586700     END-IF.                                                      58670000
586800                                                                  58680000
586900                                                                  58690000
587000 5710-COUNT-TRECITM-ROWS.                                         58700000
587100                                                                  58710000
587200     MOVE ZERO            TO  PV-DB2-COUNT.                       58720000
587300     EXEC SQL                                                     58730000
587400          SELECT                                                  58740000
587500                COUNT(*)                                          58750000
587600          INTO                                                    58760000
587700                :PV-DB2-COUNT :PV-NULL-IND                        58770000
587800          FROM                                                    58780000
587900                TRECITM                                           58790000
588000          WHERE                                                   58800000
588100                ORD_NBR            =  :DK-PO-NBR                  58810000
588200          AND   STATUS_CDE        ^=  :PV-COUNT-STATUS-CDE        58820000
588300          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             58830000
588400          AND   OPER_UNT_ID        =  :DK-OPER-UNT-ID             58840000
588500          AND   FCLTY_ID           =  :DK-FCLTY-ID                58850000
588600          AND   VER_STATUS_CDE     =  'A'                         58860000
588700     END-EXEC.                                                    58870000
588800                                                                  58880000
588900     EVALUATE TRUE                                                58890000
589000         WHEN SQLCODE = ZERO                                      58900000
589100         WHEN SQLCODE = +100                                      58910000
589200              CONTINUE                                            58920000
589300         WHEN SQLCODE = -904                                      58930000
589400         WHEN SQLCODE = -911                                      58940000
589500         WHEN SQLCODE = -913                                      58950000
589600              PERFORM 9900-SOFT-ABORT                             58960000
589700         WHEN SQLWARN0 NOT = SPACE                                58970000
589800         WHEN SQLCODE NOT = ZERO                                  58980000
589900              MOVE '5700-COUNT-TRECITM'                           58990000
590000                               TO DP013-PARAGRAPH                 59000000
590100              MOVE 'COUNT NUMBER OF "VE" STATUS RECITM ROWS'      59010000
590200                               TO DP013-MESSAGE-TEXT (1)          59020000
590300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             59030000
590400              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        59040000
590500              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        59050000
590600              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           59060000
590700              STRING ' PO = '                                     59070000
590800                     PV-DISP-PO-NBR                               59080000
590900                     ' RECV ='                                    59090000
591000                     PV-DISP-REC-SEQ-NBR                          59100000
591100                     ' OPER ='                                    59110000
591200                     PV-DISP-OPER-UNT-ID                          59120000
591300                     ' FCLTY ='                                   59130000
591400                     PV-DISP-FCLTY-ID                             59140000
591500                     ' STAT ='                                    59150000
591600                     PV-COUNT-STATUS-CDE                          59160000
591700                                         DELIMITED BY SIZE        59170000
591800                              INTO DP013-MESSAGE-TEXT (2)         59180000
591900              MOVE SQLCA        TO DP013-SQLCA                    59190000
592000              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        59200000
592100              MOVE SQLCA       TO DP013-SQLCA                     59210000
592200              SET DP013-DB2-ABEND                                 59220000
592300                               TO TRUE                            59230000
592400              PERFORM DP013-0000-PROCESS-ABEND                    59240000
592500     END-EVALUATE.                                                59250000
592600/                                                                 59260000
592700 5720-GET-TRECEIV-STATUS.                                         59270000
592800                                                                  59280000
592900     EXEC SQL                                                     59290000
593000          SELECT                                                  59300000
593100             ORD_NBR                                              59310000
593200            ,REC_SEQ_NBR                                          59320000
593300            ,CRE_TMST                                             59330000
593400            ,CRE_UID                                              59340000
593500            ,PO_VER_NBR                                           59350000
593600            ,OPER_UNT_ID                                          59360000
593700            ,FCLTY_ID                                             59370000
593800            ,STATUS_CDE                                           59380000
593900            ,SYST_CRE_CDE                                         59390000
594000            ,REC_TYP_CDE                                          59400000
594100            ,VER_STATUS_CDE                                       59410000
594200            ,PACK_BY_ST_IND                                       59420000
594300            ,REC_TMST                                             59430000
594400            ,EXPTED_CART_CNT                                      59440000
594500            ,ACTL_CART_CNT                                        59450000
594600            ,EXPTED_ITM_QTY                                       59460000
594700            ,ACTL_ITM_QTY                                         59470000
594800            ,RCVR_NBR                                             59480000
594900            ,ML_POST_TMST                                         59490000
595000            ,FS_POST_TMST                                         59500000
595100            ,PRE_TKT_IND                                          59510000
595200            ,AD_INFO_DESC                                         59520000
595300            ,IN_TRBL_TMST                                         59530000
595400            ,IN_TRBL_MIN_CNT                                      59540000
595500            ,IN_TRBL_HOUR_CNT                                     59550000
595600            ,VERFYD_TMST                                          59560000
595700            ,RCVG_CLERK_INIT_ID                                   59570000
595800            ,REFER_BACK_SEQ_NBR                                   59580000
595900            ,AP_PRC_CDE                                           59590000
596000            ,AP_PRC_DTE                                           59600000
596100            ,MIS_DIRECT_IND                                       59610000
596200            ,IMPRT_IND                                            59620000
596300            ,CRE_OPER_UNT_ID                                      59630000
596400            ,CRE_FCLTY_ID                                         59640000
596500            ,CURR_OPER_UNT_ID                                     59650000
596600            ,CURR_FCLTY_ID                                        59660000
596700            ,UPD_TMST                                             59670000
596800            ,UPD_UID                                              59680000
596900            ,UPD_PGM_ID                                           59690000
597000            ,APRON_LOC_DESC                                       59700000
597100            ,MKNG_APRN_PRT_TMST                                   59710000
597200            ,GOH_IND                                              59720000
597300            ,CURRENT TIMESTAMP                                    59730000
597400            ,VRFD_USR_ID                                          59740000
597500        INTO                                                      59750000
597600             :RECEIV-ORD-NBR                                      59760000
597700           , :RECEIV-REC-SEQ-NBR                                  59770000
597800           , :RECEIV-CRE-TMST                                     59780000
597900           , :RECEIV-CRE-UID                                      59790000
598000           , :RECEIV-PO-VER-NBR                                   59800000
598100           , :RECEIV-OPER-UNT-ID                                  59810000
598200           , :RECEIV-FCLTY-ID                                     59820000
598300           , :RECEIV-STATUS-CDE                                   59830000
598400           , :RECEIV-SYST-CRE-CDE                                 59840000
598500           , :RECEIV-REC-TYP-CDE                                  59850000
598600           , :RECEIV-VER-STATUS-CDE                               59860000
598700           , :RECEIV-PACK-BY-ST-IND                               59870000
598800           , :RECEIV-REC-TMST                                     59880000
598900           , :RECEIV-EXPTED-CART-CNT                              59890000
599000           , :RECEIV-ACTL-CART-CNT                                59900000
599100           , :RECEIV-EXPTED-ITM-QTY                               59910000
599200           , :RECEIV-ACTL-ITM-QTY                                 59920000
599300           , :RECEIV-RCVR-NBR                                     59930000
599400           , :RECEIV-ML-POST-TMST                                 59940000
599500           , :RECEIV-FS-POST-TMST                                 59950000
599600           , :RECEIV-PRE-TKT-IND                                  59960000
599700           , :RECEIV-AD-INFO-DESC                                 59970000
599800           , :RECEIV-IN-TRBL-TMST                                 59980000
599900           , :RECEIV-IN-TRBL-MIN-CNT                              59990000
600000           , :RECEIV-IN-TRBL-HOUR-CNT                             60000000
600100           , :RECEIV-VERFYD-TMST                                  60010000
600200           , :RECEIV-RCVG-CLERK-INIT-ID                           60020000
600300           , :RECEIV-REFER-BACK-SEQ-NBR                           60030000
600400           , :RECEIV-AP-PRC-CDE                                   60040000
600500           , :RECEIV-AP-PRC-DTE                                   60050000
600600           , :RECEIV-MIS-DIRECT-IND                               60060000
600700           , :RECEIV-IMPRT-IND                                    60070000
600800           , :RECEIV-CRE-OPER-UNT-ID                              60080000
600900           , :RECEIV-CRE-FCLTY-ID                                 60090000
601000           , :RECEIV-CURR-OPER-UNT-ID                             60100000
601100           , :RECEIV-CURR-FCLTY-ID                                60110000
601200           , :RECEIV-UPD-TMST                                     60120000
601300           , :RECEIV-UPD-UID                                      60130000
601400           , :RECEIV-UPD-PGM-ID                                   60140000
601500           , :RECEIV-APRON-LOC-DESC                               60150000
601600           , :RECEIV-MKNG-APRN-PRT-TMST                           60160000
601700           , :RECEIV-GOH-IND                                      60170000
601800           , :PV-RECEIV-CURRENT-TIMESTAMP                         60180000
601900           , :RECEIV-VRFD-USR-ID                                  60190000
602000          FROM  TRECEIV                                           60200000
602100          WHERE                                                   60210000
602200                 ORD_NBR          =  :DK-PO-NBR                   60220000
602300          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              60230000
602400          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              60240000
602500          AND    FCLTY_ID         =  :DK-FCLTY-ID                 60250000
602600          AND    VER_STATUS_CDE   =  'A'                          60260000
602700     END-EXEC.                                                    60270000
602800                                                                  60280000
602900     EVALUATE TRUE                                                60290000
603000         WHEN SQLCODE = ZERO                                      60300000
603100              MOVE RECEIV-STATUS-CDE TO ASC-RECEIV-STATUS-CDE     60310000
603200              IF  ASC-RECEIV-STATUS-VERIFY                        60320000
603300                  MOVE  RECEIV-VERFYD-TMST TO PV-WORK-TIMESTAMP   60330000
603400                  MOVE  PV-WORK-YEAR       TO PV-DISPLAY-YEAR     60340000
603500                  MOVE  PV-WORK-MONTH      TO PV-DISPLAY-MONTH    60350000
603600                  MOVE  PV-WORK-DAY        TO PV-DISPLAY-DAY      60360000
603700                  MOVE  '/'                TO PV-SLASH-1          60370000
603800                  MOVE  '/'                TO PV-SLASH-2          60380000
603900                  MOVE  PV-WORK-HH         TO PV-DISPLAY-HH       60390000
604000                  MOVE  PV-WORK-MIN        TO PV-DISPLAY-MM       60400000
604100                  MOVE  ':'                TO PV-COLON-1          60410000
604200                  MOVE  '('                TO PV-LEFT-PAREN       60420000
604300                  MOVE  PV-DISPLAY-DATE    TO PV-VRFY-DATE        60430000
604400                  MOVE  PV-DISPLAY-TIME    TO PV-VRFY-TIME        60440000
604500                  MOVE  ' - '              TO PV-SEPARATOR        60450000
604600                  MOVE  RECEIV-VRFD-USR-ID TO PV-VRFY-USERID      60460000
604700                  MOVE  ')'                TO PV-RIGHT-PAREN      60470000
604800                  MOVE  PV-RECEIV-VRFY-INFO                       60480000
604900                                           TO ASC-RECEIV-VRFY-INFO60490000
605000              ELSE                                                60500000
605100                  MOVE  SPACES             TO ASC-RECEIV-VRFY-INFO60510000
605200              END-IF                                              60520000
605300         WHEN SQLCODE = +100                                      60530000
605400              SET PS-DATA-NOT-OK    TO  TRUE                      60540000
605500         WHEN SQLCODE = -904                                      60550000
605600         WHEN SQLCODE = -911                                      60560000
605700         WHEN SQLCODE = -913                                      60570000
605800              PERFORM 9900-SOFT-ABORT                             60580000
605900         WHEN SQLWARN0 NOT = SPACE                                60590000
606000         WHEN SQLCODE NOT = ZERO                                  60600000
606100              MOVE '5720-GET-TRECEIV-STATUS'                      60610000
606200                               TO DP013-PARAGRAPH                 60620000
606300              MOVE 'SELECT TRECEIV'                               60630000
606400                               TO DP013-MESSAGE-TEXT (1)          60640000
606500              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             60650000
606600              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        60660000
606700              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        60670000
606800              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           60680000
606900              STRING ' PO = '                                     60690000
607000                     PV-DISP-PO-NBR                               60700000
607100                     ' RECV ='                                    60710000
607200                     PV-DISP-REC-SEQ-NBR                          60720000
607300                     ' OPER ='                                    60730000
607400                     PV-DISP-OPER-UNT-ID                          60740000
607500                     ' FCLTY ='                                   60750000
607600                     PV-DISP-FCLTY-ID                             60760000
607700                                         DELIMITED BY SIZE        60770000
607800                              INTO DP013-MESSAGE-TEXT (2)         60780000
607900              MOVE SQLCA        TO DP013-SQLCA                    60790000
608000              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        60800000
608100              MOVE SQLCA       TO DP013-SQLCA                     60810000
608200              SET DP013-DB2-ABEND                                 60820000
608300                               TO TRUE                            60830000
608400              PERFORM DP013-0000-PROCESS-ABEND                    60840000
608500     END-EVALUATE.                                                60850000
608600/                                                                 60860000
608700*----------------------------------------------------------------*60870000
608800*    FIRST WE MUST GET THE DATA.                                 *60880000
608900*    NEXT, UPDATE THE CURRENT ROW; MAKE IT INACTIVE.             *60890000
609000*    NOW, INSERT A NEW ROW WITH THE APPROPRIATE CHANGES.         *60900000
609100*----------------------------------------------------------------*60910000
609200                                                                  60920000
609300 5730-UPDATE-TRECEIV-STATUS.                                      60930000
609400                                                                  60940000
609500     IF  PS-DATA-OK                                               60950000
609600         MOVE 'V'                TO RC031-TABLE-TO-AUDIT          60960000
609700         MOVE 'B'                TO RC031-AUD-TYP-CDE             60970000
609800         MOVE 'U'                TO RC031-AUD-FUNC-CDE            60980000
609900         MOVE ASC-OPER-UNT-ID    TO RC031-OPER-UNT-ID             60990000
610000         MOVE ASC-FCLTY-ID       TO RC031-FCLTY-ID                61000000
610100         MOVE ASC-PO-NBR         TO RC031-PO-NBR                  61010000
610200         MOVE ASC-REC-SEQ-NBR    TO RC031-REC-SEQ-NBR             61020000
610300                                                                  61030000
610400         EXEC CICS                                                61040000
610500              LINK PROGRAM  (PC-AUDIT-RTN)                        61050000
610600              COMMAREA (RC031-FIELDS)                             61060000
610700              LENGTH   (PC-AUDIT-RTN-LENGTH)                      61070000
610800         END-EXEC                                                 61080000
610900                                                                  61090000
611000         EVALUATE TRUE                                            61100000
611100             WHEN RC031-CALL-SUCCESSFUL                           61110000
611200                 CONTINUE                                         61120000
611300             WHEN OTHER                                           61130000
611400                 MOVE '5730-UDDATE-TRECEIV-STATUS'                61140000
611500                                     TO DP013-PARAGRAPH           61150000
611600                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            61160000
611700                                     TO DP013-MESSAGE-TEXT (1)    61170000
611800                 MOVE RC031-RETURN-DESC                           61180000
611900                                     TO DP013-MESSAGE-TEXT (2)    61190000
612000                 MOVE RC031-SQLCA    TO DP013-SQLCA               61200000
612100                 SET DP013-DB2-ABEND                              61210000
612200                     DP013-XCTL-DISPLAY-RESTART                   61220000
612300                                     TO TRUE                      61230000
612400                 PERFORM DP013-0000-PROCESS-ABEND                 61240000
612500         END-EVALUATE                                             61250000
612600     END-IF.                                                      61260000
612700                                                                  61270000
612800     IF PS-DATA-OK                                                61280000
612900                                                                  61290000
613000     MOVE 'VE'                TO  ASC-RECEIV-STATUS-CDE           61300000
613100                                  PV-STATUS-CDE                   61310000
613200     MOVE  PV-RECEIV-CURRENT-TIMESTAMP                            61320000
613300                              TO PV-WORK-TIMESTAMP                61330000
613400     MOVE  PV-WORK-YEAR       TO PV-DISPLAY-YEAR                  61340000
613500     MOVE  PV-WORK-MONTH      TO PV-DISPLAY-MONTH                 61350000
613600     MOVE  PV-WORK-DAY        TO PV-DISPLAY-DAY                   61360000
613700     MOVE  '/'                TO PV-SLASH-1                       61370000
613800     MOVE  '/'                TO PV-SLASH-2                       61380000
613900     MOVE  PV-WORK-HH         TO PV-DISPLAY-HH                    61390000
614000     MOVE  PV-WORK-MIN        TO PV-DISPLAY-MM                    61400000
614100     MOVE  ':'                TO PV-COLON-1                       61410000
614200     MOVE  '('                TO PV-LEFT-PAREN                    61420000
614300     MOVE  PV-DISPLAY-DATE    TO PV-VRFY-DATE                     61430000
614400     MOVE  PV-DISPLAY-TIME    TO PV-VRFY-TIME                     61440000
614500     MOVE  ' - '              TO PV-SEPARATOR                     61450000
614600     MOVE  DP020-USERID       TO PV-VRFY-USERID                   61460000
614700     MOVE  ')'                TO PV-RIGHT-PAREN                   61470000
614800     MOVE  PV-RECEIV-VRFY-INFO                                    61480000
614900                              TO ASC-RECEIV-VRFY-INFO.            61490000
615000     IF PS-DATA-OK                                                61500000
615100         PERFORM 5732-UPDATE-TRECEIV                              61510000
615200         IF ASC-AUTO-VE-YES                                       61520000
615300             PERFORM 5760-LINK-TO-FRASTY-HANDLER                  61530000
615400         END-IF                                                   61540000
615500     END-IF.                                                      61550000
615600                                                                  61560000
615700     MOVE SPACES TO PS-OPER-UNT-TYPE-SW.                          61570000
615800     PERFORM 8000-SELECT-TRECEIV                                  61580000
615900     IF  PS-OPER-UNT-IS-DC                                        61590000
616000         MOVE 'W'             TO PC238-TRANS-TYPE-CDE             61600000
616100         MOVE ASC-TOT-ACT-QTY TO PC238-WRKD-UNT-QTY               61610000
616200         PERFORM 8500-UPDATE-UNITS-WRKD                           61620000
616300     END-IF.                                                      61630000
616400                                                                  61640000
616500                                                                  61650000
616600 5732-UPDATE-TRECEIV.                                             61660000
616700                                                                  61670000
616800     EXEC SQL                                                     61680000
616900          UPDATE                                                  61690000
617000                TRECEIV                                           61700000
617100          SET   STATUS_CDE         =  :PV-STATUS-CDE              61710000
617200               ,VERFYD_TMST        =  :PV-RECEIV-CURRENT-TIMESTAMP61720000
617300               ,VRFD_USR_ID        =  :DP020-USERID               61730000
617400               ,UPD_TMST           =  :PV-RECEIV-CURRENT-TIMESTAMP61740000
617500               ,UPD_UID            =  :DP020-USERID               61750000
617600               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    61760000
617700          WHERE                                                   61770000
617800                 ORD_NBR          =  :DK-PO-NBR                   61780000
617900          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              61790000
618000          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              61800000
618100          AND    FCLTY_ID         =  :DK-FCLTY-ID                 61810000
618200          AND    VER_STATUS_CDE   =  'A'                          61820000
618300     END-EXEC.                                                    61830000
618400                                                                  61840000
618500     EVALUATE TRUE                                                61850000
618600         WHEN SQLCODE = ZERO                                      61860000
618700              CONTINUE                                            61870000
618800         WHEN SQLCODE = -904                                      61880000
618900         WHEN SQLCODE = -911                                      61890000
619000         WHEN SQLCODE = -913                                      61900000
619100              SET PS-UPDATES-DONE TO TRUE                         61910000
619200              PERFORM 9900-SOFT-ABORT                             61920000
619300         WHEN SQLWARN0 NOT = SPACE                                61930000
619400         WHEN SQLCODE NOT = ZERO                                  61940000
619500              MOVE '5732-UPDATE-TRECEIV'                          61950000
619600                               TO DP013-PARAGRAPH                 61960000
619700              MOVE 'UPDATE TRECEIV STATUS CODE'                   61970000
619800                               TO DP013-MESSAGE-TEXT (1)          61980000
619900              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             61990000
620000              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        62000000
620100              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        62010000
620200              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           62020000
620300              STRING ' PO = '                                     62030000
620400                     PV-DISP-PO-NBR                               62040000
620500                     ' RECV ='                                    62050000
620600                     PV-DISP-REC-SEQ-NBR                          62060000
620700                     ' OPER ='                                    62070000
620800                     PV-DISP-OPER-UNT-ID                          62080000
620900                     ' FCLTY ='                                   62090000
621000                     PV-DISP-FCLTY-ID                             62100000
621100                                         DELIMITED BY SIZE        62110000
621200                              INTO DP013-MESSAGE-TEXT (2)         62120000
621300              MOVE SQLCA        TO DP013-SQLCA                    62130000
621400              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        62140000
621500              MOVE SQLCA       TO DP013-SQLCA                     62150000
621600              SET DP013-DB2-ABEND                                 62160000
621700                               TO TRUE                            62170000
621800              PERFORM DP013-0000-PROCESS-ABEND                    62180000
621900     END-EVALUATE.                                                62190000
622000                                                                  62200000
622100/                                                                 62210000
622200*----------------------------------------------------------------*62220000
622300*    FIRST WE MUST GET THE DATA.                                 *62230000
622400*    NEXT, UPDATE THE CURRENT ROW; MAKE IT INACTIVE.             *62240000
622500*    NOW, INSERT A NEW ROW WITH THE APPROPRIATE CHANGES.         *62250000
622600*----------------------------------------------------------------*62260000
622700 5735-UPDATE-RECEIV-STATUS-UNV.                                   62270000
622800                                                                  62280000
622900     IF  PS-DATA-OK                                               62290000
623000         MOVE 'V'                TO RC031-TABLE-TO-AUDIT          62300000
623100         MOVE 'B'                TO RC031-AUD-TYP-CDE             62310000
623200         MOVE 'U'                TO RC031-AUD-FUNC-CDE            62320000
623300         MOVE ASC-OPER-UNT-ID    TO RC031-OPER-UNT-ID             62330000
623400         MOVE ASC-FCLTY-ID       TO RC031-FCLTY-ID                62340000
623500         MOVE ASC-PO-NBR         TO RC031-PO-NBR                  62350000
623600         MOVE ASC-REC-SEQ-NBR    TO RC031-REC-SEQ-NBR             62360000
623700                                                                  62370000
623800         EXEC CICS                                                62380000
623900              LINK PROGRAM  (PC-AUDIT-RTN)                        62390000
624000              COMMAREA (RC031-FIELDS)                             62400000
624100              LENGTH   (PC-AUDIT-RTN-LENGTH)                      62410000
624200         END-EXEC                                                 62420000
624300                                                                  62430000
624400         EVALUATE TRUE                                            62440000
624500             WHEN RC031-CALL-SUCCESSFUL                           62450000
624600                 CONTINUE                                         62460000
624700             WHEN OTHER                                           62470000
624800                 MOVE '5735-UDDATE-TRECEIV-STATUS-UNV'            62480000
624900                                     TO DP013-PARAGRAPH           62490000
625000                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            62500000
625100                                     TO DP013-MESSAGE-TEXT (1)    62510000
625200                 MOVE RC031-RETURN-DESC                           62520000
625300                                     TO DP013-MESSAGE-TEXT (2)    62530000
625400                 MOVE RC031-SQLCA    TO DP013-SQLCA               62540000
625500                 SET DP013-DB2-ABEND                              62550000
625600                     DP013-XCTL-DISPLAY-RESTART                   62560000
625700                                     TO TRUE                      62570000
625800                 PERFORM DP013-0000-PROCESS-ABEND                 62580000
625900         END-EVALUATE                                             62590000
626000     END-IF.                                                      62600000
626100     IF PS-DATA-OK                                                62610000
626200                                                                  62620000
626300         MOVE 'CM'                TO  ASC-RECEIV-STATUS-CDE       62630000
626400                                      PV-STATUS-CDE               62640000
626500         MOVE SPACES              TO  ASC-RECEIV-VRFY-INFO        62650000
626600     END-IF.                                                      62660000
626700     IF PS-DATA-OK                                                62670000
626800         PERFORM 5740-UPDATE-TRECEIV                              62680000
626900     END-IF.                                                      62690000
627000                                                                  62700000
627100     MOVE SPACES TO PS-OPER-UNT-TYPE-SW.                          62710000
627200     PERFORM 8000-SELECT-TRECEIV.                                 62720000
627300     IF  PS-OPER-UNT-IS-DC                                        62730000
627400         MOVE 'Y'       TO PC238-TRANS-TYPE-CDE                   62740000
627500         MOVE ZEROES    TO PC238-WRKD-UNT-QTY                     62750000
627600         PERFORM 8500-UPDATE-UNITS-WRKD                           62760000
627700     END-IF.                                                      62770000
627800                                                                  62780000
627900                                                                  62790000
628000 5740-UPDATE-TRECEIV.                                             62800000
628100                                                                  62810000
628200     EXEC SQL                                                     62820000
628300          UPDATE                                                  62830000
628400                TRECEIV                                           62840000
628500          SET   STATUS_CDE         =  :PV-STATUS-CDE              62850000
628600               ,VERFYD_TMST        =  :PC-FS-TIMESTAMP            62860000
628700               ,UPD_TMST           =  :PV-RECEIV-CURRENT-TIMESTAMP62870000
628800               ,UPD_UID            =  :DP020-USERID               62880000
628900               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    62890000
629000               ,VRFD_USR_ID        =  ' '                         62900000
629100          WHERE                                                   62910000
629200                 ORD_NBR          =  :DK-PO-NBR                   62920000
629300          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              62930000
629400          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              62940000
629500          AND    FCLTY_ID         =  :DK-FCLTY-ID                 62950000
629600          AND    VER_STATUS_CDE   =  'A'                          62960000
629700     END-EXEC.                                                    62970000
629800                                                                  62980000
629900     EVALUATE TRUE                                                62990000
630000         WHEN SQLCODE = ZERO                                      63000000
630100              CONTINUE                                            63010000
630200         WHEN SQLCODE = -904                                      63020000
630300         WHEN SQLCODE = -911                                      63030000
630400         WHEN SQLCODE = -913                                      63040000
630500              SET PS-UPDATES-DONE TO TRUE                         63050000
630600              PERFORM 9900-SOFT-ABORT                             63060000
630700         WHEN SQLWARN0 NOT = SPACE                                63070000
630800         WHEN SQLCODE NOT = ZERO                                  63080000
630900              MOVE '5740-UPDATE-TRECEIV'                          63090000
631000                               TO DP013-PARAGRAPH                 63100000
631100              MOVE 'UPDATE TRECEIV STATUS CODE'                   63110000
631200                               TO DP013-MESSAGE-TEXT (1)          63120000
631300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             63130000
631400              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        63140000
631500              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        63150000
631600              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           63160000
631700              STRING ' PO = '                                     63170000
631800                     PV-DISP-PO-NBR                               63180000
631900                     ' RECV ='                                    63190000
632000                     PV-DISP-REC-SEQ-NBR                          63200000
632100                     ' OPER ='                                    63210000
632200                     PV-DISP-OPER-UNT-ID                          63220000
632300                     ' FCLTY ='                                   63230000
632400                     PV-DISP-FCLTY-ID                             63240000
632500                                         DELIMITED BY SIZE        63250000
632600                              INTO DP013-MESSAGE-TEXT (2)         63260000
632700              MOVE SQLCA        TO DP013-SQLCA                    63270000
632800              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        63280000
632900              MOVE SQLCA       TO DP013-SQLCA                     63290000
633000              SET DP013-DB2-ABEND                                 63300000
633100                               TO TRUE                            63310000
633200              PERFORM DP013-0000-PROCESS-ABEND                    63320000
633300     END-EVALUATE.                                                63330000
633400                                                                  63340000
633500                                                                  63350000
633600 5760-LINK-TO-FRASTY-HANDLER.                                     63360000
633700                                                                  63370000
633800     INITIALIZE SU044-COMM-AREA.                                  63380000
633900     MOVE ASC-PO-NBR               TO SU044-PO.                   63390000
634000     MOVE ASC-REC-SEQ-NBR          TO SU044-ORIG-REC-SEQ-NBR.     63400000
634100     MOVE ASC-OPER-UNT-ID          TO SU044-OPER-UNT-ID.          63410000
634200     MOVE ASC-FCLTY-ID             TO SU044-FCLTY-ID.             63420000
634300     MOVE PC-CURRENT-PROGRAM-NAME  TO SU044-PROGRAM-NAME.         63430000
634400     SET  SU044-SRC-VERIFICATION   TO TRUE.                       63440000
634500     IF ASC-RECEIV-PACK-BY-ST-IND = 'Y'                           63450000
634600        SET SU044-RCVR-PBS         TO TRUE                        63460000
634700     ELSE                                                         63470000
634800        MOVE ZEROES                TO SU044-DEST-STR-NBR          63480000
634900        IF ASC-RECEIV-PKGNG-CDE = 'M' OR 'I'                      63490000
635000           SET SU044-RCVR-PREPK    TO TRUE                        63500000
635100        ELSE                                                      63510000
635200           SET SU044-RCVR-BULK     TO TRUE                        63520000
635300        END-IF                                                    63530000
635400     END-IF                                                       63540000
635500                                                                  63550000
635600     MOVE LENGTH OF SU044-COMM-AREA TO  PV-COMMAREA-LENGTH.       63560000
635700                                                                  63570000
635800     EXEC CICS                                                    63580000
635900         LINK PROGRAM  (PC-FA-HANDLER-PGM)                        63590000
636000              COMMAREA (SU044-COMM-AREA)                          63600000
636100              LENGTH   (PV-COMMAREA-LENGTH)                       63610000
636200     END-EXEC.                                                    63620000
636300                                                                  63630000
636400                                                                  63640000
636500     EVALUATE TRUE                                                63650000
636600         WHEN SU044-SUCCESSFUL                                    63660000
636700              CONTINUE                                            63670000
636800                                                                  63680000
636900         WHEN OTHER                                               63690000
637000             MOVE '5760-LINK-TO-FRASTY-HANDLER'                   63700000
637100                                  TO DP013-PARAGRAPH              63710000
637200             STRING ' SUCCESS IND = '                             63720000
637300                    SU044-SUCCESS-IND                             63730000
637400                         DELIMITED BY SIZE                        63740000
637500                                INTO DP013-MESSAGE-TEXT (1)       63750000
637600             MOVE SQLCA           TO DP013-SQLCA                  63760000
637700             SET DP013-DB2-ABEND                                  63770000
637800                 DP013-XCTL-DISPLAY-RESTART                       63780000
637900                                  TO TRUE                         63790000
638000             PERFORM DP013-0000-PROCESS-ABEND                     63800000
638100     END-EVALUATE.                                                63810000
638200                                                                  63820000
638300                                                                  63830000
638400*----------------------------------------------------------------*63840000
638500*    SEE IF ALL RECEIVERS FOR THIS PO LINE HAS BEEN VERFIIED.    *63850000
638600*    IF SO, SET THE PURCHASE ITEM ROW TO STATUS 'CM'.            *63860000
638700*    FIRST, GET THE PURCHASE ITEM ROW.                           *63870000
638800*    NEXT, GET ALL RECEIPTS.                                     *63880000
638900*----------------------------------------------------------------*63890000
639000                                                                  63900000
639100 5800-CHECK-POLINE-FOR-UPDATE.                                    63910000
639200                                                                  63920000
639300     MOVE ZERO                  TO  PURITM-UNT-QTY.               63930000
639400     PERFORM 5810-GET-PO-UNT-QTY.                                 63940000
639500     IF  PURITM-UNT-QTY GREATER THAN ZERO                         63950000
639600         MOVE ZERO              TO  RECDIS-AP-VERIFY-ITM-QTY      63960000
639700         PERFORM 5820-GET-RECDIS-QTY                              63970000
639800         IF  PURITM-UNT-QTY NOT GREATER RECDIS-AP-VERIFY-ITM-QTY  63980000
639900             PERFORM 5830-UPDATE-PURITM-PROCESS                   63990000
640000***          PERFORM 5851-CHECK-PURCHS-FOR-UPDATE                 64000000
640100     END-IF.                                                      64010000
640200/                                                                 64020000
640300                                                                  64030000
640400*----------------------------------------------------------------*64040000
640500*    SEE IF ALL RECEIVING FOR THIS PO LINE HAS BEEN VERIFIED.    *64050000
640600*    IF THE PURCHASE ITEM ROW IS EQUAL TO 'CM' SET IT TO 'AC'    *64060000
640700*    FOR THE UNVERIFY.                                           *64070000
640800*----------------------------------------------------------------*64080000
640900                                                                  64090000
641000 5805-CHECK-POLINE-FOR-UPDATE.                                    64100000
641100                                                                  64110000
641200     PERFORM 5830-UPDATE-PURITM-PROCESS.                          64120000
641300***  PERFORM 5850-CHECK-PURCHS-FOR-UPDATE.                        64130000
641400/                                                                 64140000
641500 5810-GET-PO-UNT-QTY.                                             64150000
641600                                                                  64160000
641700     EXEC SQL                                                     64170000
641800          SELECT                                                  64180000
641900                 B.UNT_QTY                                        64190000
642000           INTO                                                   64200000
642100                 :PURITM-UNT-QTY                                  64210000
642200           FROM                                                   64220000
642300                 TPURCHS A                                        64230000
642400               , TPURITM B                                        64240000
642500          WHERE                                                   64250000
642600                 A.PO_NBR            =  :DK-PO-NBR                64260000
642700           AND   A.PO_NBR            =  B.PO_NBR                  64270000
642800           AND   B.APP_PO_LNE_NBR    =  :RECDIS-ORD-LNE-NBR       64280000
642900           AND   A.VER_STATUS_CDE    =  'A'                       64290000
643000           AND   B.VER_STATUS_CDE    =  'A'                       64300000
643100     END-EXEC.                                                    64310000
643200                                                                  64320000
643300     EVALUATE TRUE                                                64330000
643400         WHEN SQLCODE = ZERO                                      64340000
643500         WHEN SQLCODE = +100                                      64350000
643600              CONTINUE                                            64360000
643700         WHEN SQLCODE = -904                                      64370000
643800         WHEN SQLCODE = -911                                      64380000
643900         WHEN SQLCODE = -913                                      64390000
644000              PERFORM 9900-SOFT-ABORT                             64400000
644100         WHEN SQLWARN0 NOT = SPACE                                64410000
644200         WHEN SQLCODE NOT = ZERO                                  64420000
644300              MOVE '5810-GET-PO-UNT-QTY'                          64430000
644400                               TO DP013-PARAGRAPH                 64440000
644500              MOVE 'GET PO LINE UNIT QUANTITY'                    64450000
644600                               TO DP013-MESSAGE-TEXT (1)          64460000
644700              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             64470000
644800              MOVE RECDIS-ORD-LNE-NBR                             64480000
644900                                    TO PV-DISP-LNE-NBR            64490000
645000              STRING ' PO = '                                     64500000
645100                     PV-DISP-PO-NBR                               64510000
645200                     ' LINE ='                                    64520000
645300                     PV-DISP-LNE-NBR                              64530000
645400                                         DELIMITED BY SIZE        64540000
645500                              INTO DP013-MESSAGE-TEXT (2)         64550000
645600              MOVE SQLCA        TO DP013-SQLCA                    64560000
645700              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        64570000
645800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (2)        64580000
645900              MOVE SQLCA       TO DP013-SQLCA                     64590000
646000              SET DP013-DB2-ABEND                                 64600000
646100                               TO TRUE                            64610000
646200              PERFORM DP013-0000-PROCESS-ABEND                    64620000
646300     END-EVALUATE.                                                64630000
646400/                                                                 64640000
646500 5820-GET-RECDIS-QTY.                                             64650000
646600                                                                  64660000
646700     EXEC SQL                                                     64670000
646800          SELECT                                                  64680000
646900                 SUM(C.AP_VERIFY_ITM_QTY)                         64690000
647000           INTO                                                   64700000
647100                 :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND           64710000
647200           FROM                                                   64720000
647300                 TRECEIV A                                        64730000
647400               , TRECITM B                                        64740000
647500               , TRECDIS C                                        64750000
647600           WHERE                                                  64760000
647700                 A.ORD_NBR         =  :DK-PO-NBR                  64770000
647800            AND  A.ORD_NBR         =  B.ORD_NBR                   64780000
647900            AND  A.ORD_NBR         =  C.ORD_NBR                   64790000
648000            AND  B.ORD_LNE_NBR     =  :RECDIS-ORD-LNE-NBR         64800000
648100            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               64810000
648200            AND  A.VER_STATUS_CDE  =  'A'                         64820000
648300            AND  B.VER_STATUS_CDE  =  'A'                         64830000
648500            AND  B.STATUS_CDE      =  'VE'                        64850000
648600            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               64860000
648700            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               64870000
648800     END-EXEC.                                                    64880000
648900                                                                  64890000
649000     EVALUATE TRUE                                                64900000
649100         WHEN SQLCODE = ZERO                                      64910000
649200         WHEN SQLCODE = +100                                      64920000
649300              CONTINUE                                            64930000
649410         WHEN SQLCODE = -904                                      64941000
649500         WHEN SQLCODE = -911                                      64950000
649600         WHEN SQLCODE = -913                                      64960000
649700              PERFORM 9900-SOFT-ABORT                             64970000
649800         WHEN SQLWARN0 NOT = SPACE                                64980000
649900         WHEN SQLCODE NOT = ZERO                                  64990000
650000              MOVE '5820-GET-RECDIS-QTY'                          65000000
650100                               TO DP013-PARAGRAPH                 65010000
650200              MOVE 'SUM RECDIS VERIFY QUANTITY'                   65020000
650300                               TO DP013-MESSAGE-TEXT (1)          65030000
650400              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             65040000
650500              MOVE RECDIS-ORD-LNE-NBR                             65050000
650600                                    TO PV-DISP-LNE-NBR            65060000
650700              STRING ' PO = '                                     65070000
650800                     PV-DISP-PO-NBR                               65080000
650900                     ' LINE = '                                   65090000
651000                     PV-DISP-LNE-NBR                              65100000
651100                                         DELIMITED BY SIZE        65110000
651200                              INTO DP013-MESSAGE-TEXT (2)         65120000
651300              MOVE SQLCA       TO DP013-SQLCA                     65130000
651400              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        65140000
651500              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (2)        65150000
651600              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (3)        65160000
651700              MOVE SQLCA       TO DP013-SQLCA                     65170000
651800              SET DP013-DB2-ABEND                                 65180000
651900                               TO TRUE                            65190000
652000              PERFORM DP013-0000-PROCESS-ABEND                    65200000
652100     END-EVALUATE.                                                65210000
652200/                                                                 65220000
652300*----------------------------------------------------------------*65230000
652400*    TO UPDATE THE PURCHASE ITEM ROW, WE REALLY MAKE THE CURRENT *65240000
652500*    ROW INACTIVE AND INSERT A NEW ROW WITH AN ACTIVE STATUS.    *65250000
652600*----------------------------------------------------------------*65260000
652700                                                                  65270000
652800 5830-UPDATE-PURITM-PROCESS.                                      65280000
652900                                                                  65290000
653000     PERFORM 5831-GET-PURITM.                                     65300000
653100     IF  SQLCODE EQUAL ZERO                                       65310000
653200     AND PURITM-STATUS-CDE NOT = 'RV'                             65320000
653300         IF PS-PO-UNVERIFY                                        65330000
653400             IF PURITM-STATUS-CDE = 'CM'                          65340000
653500                 PERFORM 5832-UPDATE-PURITM                       65350000
653600                 ADD 1               TO  PURITM-VER-NBR           65360000
653700                 PERFORM 5833-INSERT-PURITM                       65370000
653800              ELSE                                                65380000
653900                 CONTINUE                                         65390000
654000              END-IF                                              65400000
654100         ELSE                                                     65410000
654200             PERFORM 5834-UPDATE-PURITM-VERIFY                    65420000
654300         END-IF                                                   65430000
654400     END-IF.                                                      65440000
654500                                                                  65450000
654600                                                                  65460000
654700 5831-GET-PURITM.                                                 65470000
654800                                                                  65480000
654900     EXEC SQL                                                     65490000
655000          SELECT                                                  65500000
655100                  PO_NBR                                          65510000
655200                , VER_NBR                                         65520000
655300                , PO_LNE_NBR                                      65530000
655400                , VER_STATUS_CDE                                  65540000
655500                , SKU_SEQ_NBR                                     65550000
655600                , CL_NBR                                          65560000
655700                , VEND_STYL_NAME                                  65570000
655800                , COLOR_DESC                                      65580000
655900                , SIZE_DESC                                       65590000
656000                , UM_IND                                          65600000
656100                , UNT_QTY                                         65610000
656200                , UNT_RTL_PR_AMT                                  65620000
656300                , UNT_COST_AMT                                    65630000
656400                , TOT_VAL_COST_AMT                                65640000
656500                , TOT_VAL_RTL_AMT                                 65650000
656600                , MU_PCT                                          65660000
656700                , CRE_TMST                                        65670000
656800                , LAST_UPD_TMST                                   65680000
656900                , ITM_NBR                                         65690000
657000                , SKU_DESC                                        65700000
657100                , COLOR_CDE                                       65710000
657200                , SIZE_CDE                                        65720000
657300                , AD_EVNT_DTE                                     65730000
657400                , STATUS_CDE                                      65740000
657500                , CRE_BY_UID                                      65750000
657600                , LAST_UPD_BY_UID                                 65760000
657700                , GP_RTL_AMT                                      65770000
657800                , GP_QTY                                          65780000
657900                , APP_PO_LNE_NBR                                  65790000
658000                , PIC_ITM_IND                                     65800000
658100                , PIC_PG_NBR                                      65810000
658200                , PRD_1ST_COST_AMT                                65820000
658300                , PO_PREPK_ID                                     65830000
658400                , PREPK_RATO_QTY                                  65840000
658500                , SHIP_TO_TMP_DC_IND                              65850000
658600                , RMS_PO_SKU_NBR                                  65860000
658700                , CNCLD_UNT_QTY                                   65870000
658800           INTO                                                   65880000
658900                  :PURITM-PO-NBR                                  65890000
659000                , :PURITM-VER-NBR                                 65900000
659100                , :PURITM-PO-LNE-NBR                              65910000
659200                , :PURITM-VER-STATUS-CDE                          65920000
659300                , :PURITM-SKU-SEQ-NBR                             65930000
659400                , :PURITM-CL-NBR                                  65940000
659500                , :PURITM-VEND-STYL-NAME                          65950000
659600                , :PURITM-COLOR-DESC                              65960000
659700                , :PURITM-SIZE-DESC                               65970000
659800                , :PURITM-UM-IND                                  65980000
659900                , :PURITM-UNT-QTY                                 65990000
660000                , :PURITM-UNT-RTL-PR-AMT                          66000000
660100                , :PURITM-UNT-COST-AMT                            66010000
660200                , :PURITM-TOT-VAL-COST-AMT                        66020000
660300                , :PURITM-TOT-VAL-RTL-AMT                         66030000
660400                , :PURITM-MU-PCT                                  66040000
660500                , :PURITM-CRE-TMST                                66050000
660600                , :PURITM-LAST-UPD-TMST                           66060000
660700                , :PURITM-ITM-NBR                                 66070000
660800                , :PURITM-SKU-DESC                                66080000
660900                , :PURITM-COLOR-CDE                               66090000
661000                , :PURITM-SIZE-CDE                                66100000
661100                , :PURITM-AD-EVNT-DTE                             66110000
661200                , :PURITM-STATUS-CDE                              66120000
661300                , :PURITM-CRE-BY-UID                              66130000
661400                , :PURITM-LAST-UPD-BY-UID                         66140000
661500                , :PURITM-GP-RTL-AMT                              66150000
661600                , :PURITM-GP-QTY                                  66160000
661700                , :PURITM-APP-PO-LNE-NBR                          66170000
661800                , :PURITM-PIC-ITM-IND                             66180000
661900                , :PURITM-PIC-PG-NBR                              66190000
662000                , :PURITM-PRD-1ST-COST-AMT                        66200000
662100                , :PURITM-PO-PREPK-ID                             66210000
662200                , :PURITM-PREPK-RATO-QTY                          66220000
662300                , :PURITM-SHIP-TO-TMP-DC-IND                      66230000
662400                , :PURITM-RMS-PO-SKU-NBR                          66240000
662500                , :PURITM-CNCLD-UNT-QTY                           66250000
662600           FROM                                                   66260000
662700                  TPURITM                                         66270000
662800          WHERE                                                   66280000
662900                  PO_NBR             =  :DK-PO-NBR                66290000
663000           AND    APP_PO_LNE_NBR     =  :RECDIS-ORD-LNE-NBR       66300000
663100           AND    VER_STATUS_CDE     =  'A'                       66310000
663200     END-EXEC.                                                    66320000
663300                                                                  66330000
663400     EVALUATE TRUE                                                66340000
663500         WHEN SQLCODE = ZERO                                      66350000
663600         WHEN SQLCODE = +100                                      66360000
663700              CONTINUE                                            66370000
663800         WHEN SQLWARN0 NOT = SPACE                                66380000
663900         WHEN SQLCODE = -904                                      66390000
664000         WHEN SQLCODE = -911                                      66400000
664100         WHEN SQLCODE = -913                                      66410000
664200              PERFORM 9900-SOFT-ABORT                             66420000
664300         WHEN SQLCODE NOT = ZERO                                  66430000
664400              MOVE '5831-GET-PURITM'                              66440000
664500                               TO DP013-PARAGRAPH                 66450000
664600              MOVE 'SUM RECDIS VERIFY QUANTITY'                   66460000
664700                               TO DP013-MESSAGE-TEXT (1)          66470000
664800              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             66480000
664900              MOVE RECDIS-ORD-LNE-NBR                             66490000
665000                                    TO PV-DISP-LNE-NBR            66500000
665100              STRING ' PO = '                                     66510000
665200                     PV-DISP-PO-NBR                               66520000
665300                     ' LINE = '                                   66530000
665400                     PV-DISP-LNE-NBR                              66540000
665500                                         DELIMITED BY SIZE        66550000
665600                              INTO DP013-MESSAGE-TEXT (2)         66560000
665700              MOVE SQLCA       TO DP013-SQLCA                     66570000
665800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        66580000
665900              MOVE SQLCA       TO DP013-SQLCA                     66590000
666000              SET DP013-DB2-ABEND                                 66600000
666100                               TO TRUE                            66610000
666200              PERFORM DP013-0000-PROCESS-ABEND                    66620000
666300     END-EVALUATE.                                                66630000
666400/                                                                 66640000
666500 5832-UPDATE-PURITM.                                              66650000
666600                                                                  66660000
666700     EXEC SQL                                                     66670000
666800          UPDATE                                                  66680000
666900                 TPURITM                                          66690000
667000          SET    VER_STATUS_CDE   =  'I'                          66700000
667100          WHERE                                                   66710000
667200                 PO_NBR           =  :DK-PO-NBR                   66720000
667300          AND    APP_PO_LNE_NBR   =  :RECDIS-ORD-LNE-NBR          66730000
667400          AND    VER_STATUS_CDE   =  'A'                          66740000
667500     END-EXEC.                                                    66750000
667600                                                                  66760000
667700     EVALUATE TRUE                                                66770000
667800         WHEN SQLCODE = ZERO                                      66780000
667900              CONTINUE                                            66790000
668000         WHEN SQLCODE = -904                                      66800000
668100         WHEN SQLCODE = -911                                      66810000
668200         WHEN SQLCODE = -913                                      66820000
668300              SET PS-UPDATES-DONE TO TRUE                         66830000
668400              PERFORM 9900-SOFT-ABORT                             66840000
668500         WHEN SQLWARN0 NOT = SPACE                                66850000
668600         WHEN SQLCODE NOT = ZERO                                  66860000
668700              MOVE '5832-UPDATE-PURITM'                           66870000
668800                               TO DP013-PARAGRAPH                 66880000
668900              MOVE 'SET CURRENT ROW TO INACTIVE'                  66890000
669000                               TO DP013-MESSAGE-TEXT (1)          66900000
669100              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             66910000
669200              MOVE RECDIS-ORD-LNE-NBR                             66920000
669300                                    TO PV-DISP-LNE-NBR            66930000
669400              STRING ' PO = '                                     66940000
669500                     PV-DISP-PO-NBR                               66950000
669600                     ' LINE = '                                   66960000
669700                     PV-DISP-LNE-NBR                              66970000
669800                                         DELIMITED BY SIZE        66980000
669900                              INTO DP013-MESSAGE-TEXT (2)         66990000
670000              MOVE SQLCA       TO DP013-SQLCA                     67000000
670100              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        67010000
670200              MOVE SQLCA       TO DP013-SQLCA                     67020000
670300              SET DP013-DB2-ABEND                                 67030000
670400                               TO TRUE                            67040000
670500              PERFORM DP013-0000-PROCESS-ABEND                    67050000
670600     END-EVALUATE.                                                67060000
670700/                                                                 67070000
670800 5834-UPDATE-PURITM-VERIFY.                                       67080000
670900                                                                  67090000
671000     EXEC SQL                                                     67100000
671100          UPDATE                                                  67110000
671200                 TPURITM                                          67120000
671300          SET    STATUS_CDE   =  'CM'                             67130000
671400                ,STAT_TMST    =  CURRENT TIMESTAMP                67140000
671500          WHERE                                                   67150000
671600                 PO_NBR           =  :DK-PO-NBR                   67160000
671700          AND    APP_PO_LNE_NBR   =  :RECDIS-ORD-LNE-NBR          67170000
671800          AND    VER_STATUS_CDE   =  'A'                          67180000
671900     END-EXEC.                                                    67190000
672000                                                                  67200000
672100     EVALUATE TRUE                                                67210000
672200         WHEN SQLCODE = ZERO                                      67220000
672300              CONTINUE                                            67230000
672400         WHEN SQLCODE = -904                                      67240000
672500         WHEN SQLCODE = -911                                      67250000
672600         WHEN SQLCODE = -913                                      67260000
672700              SET PS-UPDATES-DONE TO TRUE                         67270000
672800              PERFORM 9900-SOFT-ABORT                             67280000
672900         WHEN SQLWARN0 NOT = SPACE                                67290000
673000         WHEN SQLCODE NOT = ZERO                                  67300000
673100              MOVE '5834-UPDATE-PURITM-VERIFY'                    67310000
673200                               TO DP013-PARAGRAPH                 67320000
673300              MOVE 'SET STATUS TO "CM" COMPLETE'                  67330000
673400                               TO DP013-MESSAGE-TEXT (1)          67340000
673500              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             67350000
673600              MOVE RECDIS-ORD-LNE-NBR                             67360000
673700                                    TO PV-DISP-LNE-NBR            67370000
673800              STRING ' PO = '                                     67380000
673900                     PV-DISP-PO-NBR                               67390000
674000                     ' LINE = '                                   67400000
674100                     PV-DISP-LNE-NBR                              67410000
674200                                         DELIMITED BY SIZE        67420000
674300                              INTO DP013-MESSAGE-TEXT (2)         67430000
674400              MOVE SQLCA       TO DP013-SQLCA                     67440000
674500              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        67450000
674600              MOVE SQLCA       TO DP013-SQLCA                     67460000
674700              SET DP013-DB2-ABEND                                 67470000
674800                               TO TRUE                            67480000
674900              PERFORM DP013-0000-PROCESS-ABEND                    67490000
675000     END-EVALUATE.                                                67500000
675100/                                                                 67510000
675200 5833-INSERT-PURITM.                                              67520000
675300                                                                  67530000
675400     EXEC SQL                                                     67540000
675500          INSERT                                                  67550000
675600           INTO   TPURITM                                         67560000
675700                 (PO_NBR                                          67570000
675800                , VER_NBR                                         67580000
675900                , PO_LNE_NBR                                      67590000
676000                , VER_STATUS_CDE                                  67600000
676100                , SKU_SEQ_NBR                                     67610000
676200                , CL_NBR                                          67620000
676300                , VEND_STYL_NAME                                  67630000
676400                , COLOR_DESC                                      67640000
676500                , SIZE_DESC                                       67650000
676600                , UM_IND                                          67660000
676700                , UNT_QTY                                         67670000
676800                , UNT_RTL_PR_AMT                                  67680000
676900                , UNT_COST_AMT                                    67690000
677000                , TOT_VAL_COST_AMT                                67700000
677100                , TOT_VAL_RTL_AMT                                 67710000
677200                , MU_PCT                                          67720000
677300                , CRE_TMST                                        67730000
677400                , LAST_UPD_TMST                                   67740000
677500                , ITM_NBR                                         67750000
677600                , SKU_DESC                                        67760000
677700                , COLOR_CDE                                       67770000
677800                , SIZE_CDE                                        67780000
677900                , AD_EVNT_DTE                                     67790000
678000                , STATUS_CDE                                      67800000
678100                , CRE_BY_UID                                      67810000
678200                , LAST_UPD_BY_UID                                 67820000
678300                , GP_RTL_AMT                                      67830000
678400                , GP_QTY                                          67840000
678500                , APP_PO_LNE_NBR                                  67850000
678600                , PIC_ITM_IND                                     67860000
678700                , PIC_PG_NBR                                      67870000
678800                , PRD_1ST_COST_AMT                                67880000
678900                , STAT_TMST                                       67890000
679000                , PO_PREPK_ID                                     67900000
679100                , PREPK_RATO_QTY                                  67910000
679200                , SHIP_TO_TMP_DC_IND                              67920000
679300                , RMS_PO_SKU_NBR                                  67930000
679400                , CNCLD_UNT_QTY                                   67940000
679500                )                                                 67950000
679600          VALUES                                                  67960000
679700                 (:PURITM-PO-NBR                                  67970000
679800                , :PURITM-VER-NBR                                 67980000
679900                , :PURITM-PO-LNE-NBR                              67990000
680000                , 'A'                                             68000000
680100                , :PURITM-SKU-SEQ-NBR                             68010000
680200                , :PURITM-CL-NBR                                  68020000
680300                , :PURITM-VEND-STYL-NAME                          68030000
680400                , :PURITM-COLOR-DESC                              68040000
680500                , :PURITM-SIZE-DESC                               68050000
680600                , :PURITM-UM-IND                                  68060000
680700                , :PURITM-UNT-QTY                                 68070000
680800                , :PURITM-UNT-RTL-PR-AMT                          68080000
680900                , :PURITM-UNT-COST-AMT                            68090000
681000                , :PURITM-TOT-VAL-COST-AMT                        68100000
681100                , :PURITM-TOT-VAL-RTL-AMT                         68110000
681200                , :PURITM-MU-PCT                                  68120000
681300                , :PURITM-CRE-TMST                                68130000
681400                ,  CURRENT TIMESTAMP                              68140000
681500                , :PURITM-ITM-NBR                                 68150000
681600                , :PURITM-SKU-DESC                                68160000
681700                , :PURITM-COLOR-CDE                               68170000
681800                , :PURITM-SIZE-CDE                                68180000
681900                , :PURITM-AD-EVNT-DTE                             68190000
682000                , 'AC'                                            68200000
682100                , :PURITM-CRE-BY-UID                              68210000
682200                , :DP020-USERID                                   68220000
682300                , :PURITM-GP-RTL-AMT                              68230000
682400                , :PURITM-GP-QTY                                  68240000
682500                , :PURITM-APP-PO-LNE-NBR                          68250000
682600                , :PURITM-PIC-ITM-IND                             68260000
682700                , :PURITM-PIC-PG-NBR                              68270000
682800                , :PURITM-PRD-1ST-COST-AMT                        68280000
682900                ,  CURRENT TIMESTAMP                              68290000
683000                , :PURITM-PO-PREPK-ID                             68300000
683100                , :PURITM-PREPK-RATO-QTY                          68310000
683200                , :PURITM-SHIP-TO-TMP-DC-IND                      68320000
683300                , :PURITM-RMS-PO-SKU-NBR                          68330000
683400                , :PURITM-CNCLD-UNT-QTY                           68340000
683500                  )                                               68350000
683600     END-EXEC.                                                    68360000
683700                                                                  68370000
683800     EVALUATE TRUE                                                68380000
683900         WHEN SQLCODE = ZERO                                      68390000
684000              CONTINUE                                            68400000
684100         WHEN SQLCODE = -904                                      68410000
684200         WHEN SQLCODE = -911                                      68420000
684300         WHEN SQLCODE = -913                                      68430000
684400              SET PS-UPDATES-DONE TO TRUE                         68440000
684500              PERFORM 9900-SOFT-ABORT                             68450000
684600         WHEN SQLWARN0 NOT = SPACE                                68460000
684700         WHEN SQLCODE NOT = ZERO                                  68470000
684800              MOVE '5833-INSERT-PURITM'                           68480000
684900                               TO DP013-PARAGRAPH                 68490000
685000              MOVE 'INSERT NEW ROW IN TPURITM TABLE'              68500000
685100                               TO DP013-MESSAGE-TEXT (1)          68510000
685200              MOVE PURITM-PO-NBR    TO PV-DISP-PO-NBR             68520000
685300              MOVE PURITM-PO-LNE-NBR                              68530000
685400                                    TO PV-DISP-LNE-NBR            68540000
685500              STRING ' PO = '                                     68550000
685600                     PV-DISP-PO-NBR                               68560000
685700                     ' LINE = '                                   68570000
685800                     PV-DISP-LNE-NBR                              68580000
685900                                         DELIMITED BY SIZE        68590000
686000                              INTO DP013-MESSAGE-TEXT (2)         68600000
686100              MOVE SQLCA       TO DP013-SQLCA                     68610000
686200              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        68620000
686300              MOVE SQLCA       TO DP013-SQLCA                     68630000
686400              SET DP013-DB2-ABEND                                 68640000
686500                               TO TRUE                            68650000
686600              PERFORM DP013-0000-PROCESS-ABEND                    68660000
686700     END-EVALUATE.                                                68670000
686800/                                                                 68680000
686900*----------------------------------------------------------------*68690000
687000*    HERE, WE CHECK IF ALL PURCHASE ITEM LINES ARE EQUAL TO      *68700000
687100*    'CM' 'CB' OR 'CA' AND THE PURCHASE ORDER HEADER IS EQUAL    *68710000
687200*    TO 'AP' OR 'AC'.  IF SO, UPDATE THE PURCHASE ORDER HEADER   *68720000
687300*    TO A STATUS OF 'CM'.                                        *68730000
687400*    AN UPDATE ENTAILS THE CHANGING OF THE CURRENT ROW TO AN     *68740000
687500*    INACTIVE STATUS AND INSERTING A NEW "ACTIVE" ROW.           *68750000
687600*----------------------------------------------------------------*68760000
687700                                                                  68770000
687800 5850-CHECK-PURCHS-FOR-UPDATE.                                    68780000
687900                                                                  68790000
688000     PERFORM 5852-GET-TPURCHS-STATUS.                             68800000
688100     MOVE PV-DEPT-NBR-PIC9 TO PV-DEPT-NBR-COMP-3                  68810000
688200     PERFORM 7010-GET-CURRENT-DATE                                68820000
688300     PERFORM F450-GET-POT00006-DEPT                               68830000
688400     IF PURCHS-STATUS-CDE EQUAL 'CM' AND                          68840000
688500        PS-POT00006-NOT-FOUND                                     68850000
688600         PERFORM 5853-UPDATE-PURCHS-STATUS                        68860000
688700         ADD 1        TO  PURCHS-VER-NBR                          68870000
688800         PERFORM 5854-INSERT-PURCHS                               68880000
688900     ELSE                                                         68890000
689000         CONTINUE                                                 68900000
689100     END-IF.                                                      68910000
689200                                                                  68920000
689300 5851-CHECK-PURCHS-FOR-UPDATE.                                    68930000
689400                                                                  68940000
689500     PERFORM 5851-COUNT-PO-LINE-ROWS.                             68950000
689600     IF  PV-DB2-COUNT EQUAL ZERO                                  68960000
689700         PERFORM 5852-GET-TPURCHS-STATUS                          68970000
689800         MOVE PV-DEPT-NBR-PIC9 TO PV-DEPT-NBR-COMP-3              68980000
689900         PERFORM 7010-GET-CURRENT-DATE                            68990000
690000         PERFORM F450-GET-POT00006-DEPT                           69000000
690100*        IF  PURCHS-STATUS-CDE EQUAL 'AP' OR 'AC'                 69010000
690200         IF (PURCHS-STATUS-CDE = 'AP' OR                          69020000
690300             PURCHS-STATUS-CDE = 'AC') AND                        69030000
690400             PS-POT00006-NOT-FOUND                                69040000
690500             PERFORM 5853-UPDATE-PURCHS-STATUS-VER                69050000
690600         END-IF                                                   69060000
690700     END-IF.                                                      69070000
690800                                                                  69080000
690900*----------------------------------------------------------------*69090000
691000*    VALIDATE THE DEPARTMENT NUMBER AGAINST POT_RMS_RLOUT_CTL    *69100000
691100*----------------------------------------------------------------*69110000
691200 F450-GET-POT00006-DEPT.                                          69120000
691300     INITIALIZE DCLPOT00006.                                      69130000
691400                                                                  69140000
691500     PERFORM WITH TEST AFTER                                      69150000
691600         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    69160000
691700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69170000
691800              OR (SQLCODE = +0)                                   69180000
691900              OR (SQLCODE = +100))                                69190000
692000         EXEC SQL                                                 69200000
692100              SELECT                                              69210000
692200                      DEPT_NBR                                    69220000
692300                     ,PO_ENTR_IN_RMS_DTE                          69230000
692400               INTO                                               69240000
692500                     :POT00006-DEPT-NBR                           69250000
692600                    ,:POT00006-PO-ENTR-IN-RMS-DTE                 69260000
692700              FROM                                                69270000
692800                     POT_RMS_RLOUT_CTL                            69280000
692900              WHERE                                               69290000
693000                    DEPT_NBR            = :PV-DEPT-NBR-COMP-3     69300000
693100              AND   PO_ENTR_IN_RMS_DTE  <= :PV-CURRENT-DATE       69310000
693200         END-EXEC                                                 69320000
693300                                                                  69330000
693400         EVALUATE TRUE                                            69340000
693500             WHEN SQLCODE = ZERO                                  69350000
693600                  SET PS-POT00006-FOUND TO TRUE                   69360000
693700             WHEN SQLCODE = +100                                  69370000
693800                  SET PS-POT00006-NOT-FOUND TO TRUE               69380000
693900             WHEN SQLCODE = -904                                  69390000
694000             WHEN SQLCODE = -911                                  69400000
694100             WHEN SQLCODE = -913                                  69410000
694200                  CONTINUE                                        69420000
694300             WHEN SQLWARN0 NOT = SPACE                            69430000
694400             WHEN SQLCODE NOT = ZERO                              69440000
694500                  MOVE 'F450-GET-POT00006-DEPT'                   69450000
694600                                   TO DP013-PARAGRAPH             69460000
694700                  MOVE 'GET THE POT_RMS_RLOUT_CTL'                69470000
694800                                   TO DP013-MESSAGE-TEXT (1)      69480000
694900*                 MOVE DK-ORD-NBR TO PV-ERROR-ORD-NBR             69490000
695000                  STRING ' PO = '                                 69500000
695100                         PV-DISP-PO-NBR                           69510000
695200                         ' LINE = '                               69520000
695300                         PV-DISP-LNE-NBR                          69530000
695400                                             DELIMITED BY SIZE    69540000
695500                                 INTO DP013-MESSAGE-TEXT (2)      69550000
695600                  MOVE 'POT00006'  TO DP013-DB2-TABLE-NAME (1)    69560000
695700                  MOVE SQLCA       TO DP013-SQLCA                 69570000
695800                  SET DP013-DB2-ABEND                             69580000
695900                                   TO TRUE                        69590000
696000                  PERFORM DP013-0000-PROCESS-ABEND                69600000
696100         END-EVALUATE                                             69610000
696200     END-PERFORM.                                                 69620000
696300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO  69630000
696400         MOVE 'F450-GET-POT00006-DEPT'                            69640000
696500                                 TO DP013-PARAGRAPH               69650000
696600         MOVE 'MAX RETRIES EXCEEDED ON SELECT OF POT00006'        69660000
696700                                 TO DP013-MESSAGE-TEXT (1)        69670000
696800         STRING ' PO = '                                          69680000
696900                  PV-DISP-PO-NBR                                  69690000
697000                ' LINE = '                                        69700000
697100                  PV-DISP-LNE-NBR                                 69710000
697200                                      DELIMITED BY SIZE           69720000
697300                               INTO DP013-MESSAGE-TEXT (2)        69730000
697400         MOVE SQLCA              TO DP013-SQLCA                   69740000
697500         MOVE 'POT00006'         TO DP013-DB2-TABLE-NAME (1)      69750000
697600         SET DP013-XCTL-DISPLAY-RESTART                           69760000
697700             DP013-DB2-ABEND     TO TRUE                          69770000
697800         PERFORM DP013-0000-PROCESS-ABEND                         69780000
697900     END-IF.                                                      69790000
698000/                                                                 69800000
698100 5851-COUNT-PO-LINE-ROWS.                                         69810000
698200                                                                  69820000
698300     MOVE ZERO            TO  PV-DB2-COUNT.                       69830000
698400     EXEC SQL                                                     69840000
698500          SELECT                                                  69850000
698600                COUNT(*)                                          69860000
698700          INTO                                                    69870000
698800                :PV-DB2-COUNT :PV-NULL-IND                        69880000
698900          FROM                                                    69890000
699000                TPURITM                                           69900000
699100          WHERE                                                   69910000
699200                PO_NBR             =  :DK-PO-NBR                  69920000
699300          AND   VER_STATUS_CDE     =  'A'                         69930000
699400          AND  (STATUS_CDE        ^=  'CM'                        69940000
699500           AND  STATUS_CDE        ^=  'CB'                        69950000
699600           AND  STATUS_CDE        ^=  'CA')                       69960000
699700     END-EXEC.                                                    69970000
699800                                                                  69980000
699900     EVALUATE TRUE                                                69990000
700000         WHEN SQLCODE = ZERO                                      70000000
700100         WHEN SQLCODE = +100                                      70010000
700200              CONTINUE                                            70020000
700300         WHEN SQLCODE = -904                                      70030000
700400         WHEN SQLCODE = -911                                      70040000
700500         WHEN SQLCODE = -913                                      70050000
700600              PERFORM 9900-SOFT-ABORT                             70060000
700700         WHEN SQLWARN0 NOT = SPACE                                70070000
700800         WHEN SQLCODE NOT = ZERO                                  70080000
700900              MOVE '5851-COUNT-PO-LINE-ROWS'                      70090000
701000                               TO DP013-PARAGRAPH                 70100000
701100              MOVE 'COUNT NUMBER OF "CM", "CB", "CA" STATUS ROWS' 70110000
701200                               TO DP013-MESSAGE-TEXT (1)          70120000
701300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             70130000
701400              STRING ' PO = '                                     70140000
701500                     PV-DISP-PO-NBR                               70150000
701600                                         DELIMITED BY SIZE        70160000
701700                              INTO DP013-MESSAGE-TEXT (2)         70170000
701800              MOVE SQLCA       TO DP013-SQLCA                     70180000
701900              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        70190000
702000              MOVE SQLCA       TO DP013-SQLCA                     70200000
702100              SET DP013-DB2-ABEND                                 70210000
702200                               TO TRUE                            70220000
702300              PERFORM DP013-0000-PROCESS-ABEND                    70230000
702400     END-EVALUATE.                                                70240000
702500/                                                                 70250000
702600*----------------------------------------------------------------*70260000
702700*    GET THE STATUS CODE OF THE CURRENT P.O.                     *70270000
702800*----------------------------------------------------------------*70280000
702900 5852-GET-TPURCHS-STATUS.                                         70290000
703000                                                                  70300000
703100     EXEC SQL                                                     70310000
703200          SELECT                                                  70320000
703300                  PO_NBR                                          70330000
703400                , VER_NBR                                         70340000
703500                , VER_STATUS_CDE                                  70350000
703600                , PO_TYP_CDE                                      70360000
703700                , PO_CATEG_CDE                                    70370000
703800                , EDI_IND                                         70380000
703900                , TOT_UNT_QTY                                     70390000
704000                , TOT_VAL_COST_AMT                                70400000
704100                , TOT_VAL_RTL_AMT                                 70410000
704200                , TOT_MU_PCT                                      70420000
704300                , TOT_SKUS_QTY                                    70430000
704400                , IMPRT_AGNT_PO_NBR                               70440000
704500                , IMPRT_ORD_OFF_NAME                              70450000
704600                , IMPRT_VEND_NAME                                 70460000
704700                , IMPRT_FCTRY_NAME                                70470000
704800                , IMPRT_CNTRY_NAME                                70480000
704900                , VEND_CNTRY_NAME                                 70490000
705000                , NEW_STR_PO_IND                                  70500000
705100                , IMPRT_PO_IND                                    70510000
705200                , IMPRT_AGNT_PO_IND                               70520000
705300                , STATUS_TMST                                     70530000
705400                , LAST_UPD_TMST                                   70540000
705500                , EDI_REXMIT_IND                                  70550000
705600                , EDI_REXMIT_TMST                                 70560000
705700                , DIR_STR_IND                                     70570000
705800                , LAST_UPD_BY_UID                                 70580000
705900                , APP_BY_UID                                      70590000
706000                , OTB_PER_NBR                                     70600000
706100                , DEPT_NBR                                        70610000
706200                , ENT_ID                                          70620000
706300                , STATUS_CDE                                      70630000
706400                , CRE_BY_UID                                      70640000
706500                , REJ_CT                                          70650000
706600                , REJ_UID                                         70660000
706700                , ORD_DTE                                         70670000
706800                , REVISION_CT                                     70680000
706900                , ADR_SEQ_NBR                                     70690000
707000                , DEST_KNOWN_IND                                  70700000
707100                , RLSE_IND                                        70710000
707200                , RLSE_DTE                                        70720000
707300                , PLCMNT_CNTRY_CDE                                70730000
707400                , PROD_CNTRY_CDE                                  70740000
707500                , UNT_PER_CBMT_QTY                                70750000
707600                , CRE_TMST                                        70760000
707700                , PRG_LAST_ACTVY_DTE                              70770000
707800                , PKGNG_CDE                                       70780000
707900                , SEASET_YR                                       70790000
708000                , SEASET_SHRT_NM                                  70800000
708100                , QTA_CTG_CDE                                     70810000
708200                , PO_IN_RMS_IND                                   70820000
708300           INTO                                                   70830000
708400                 :PURCHS-PO-NBR                                   70840000
708500                ,:PURCHS-VER-NBR                                  70850000
708600                ,:PURCHS-VER-STATUS-CDE                           70860000
708700                ,:PURCHS-PO-TYP-CDE                               70870000
708800                ,:PURCHS-PO-CATEG-CDE                             70880000
708900                ,:PURCHS-EDI-IND                                  70890000
709000                ,:PURCHS-TOT-UNT-QTY                              70900000
709100                ,:PURCHS-TOT-VAL-COST-AMT                         70910000
709200                ,:PURCHS-TOT-VAL-RTL-AMT                          70920000
709300                ,:PURCHS-TOT-MU-PCT                               70930000
709400                ,:PURCHS-TOT-SKUS-QTY                             70940000
709500                ,:PURCHS-IMPRT-AGNT-PO-NBR                        70950000
709600                ,:PURCHS-IMPRT-ORD-OFF-NAME                       70960000
709700                ,:PURCHS-IMPRT-VEND-NAME                          70970000
709800                ,:PURCHS-IMPRT-FCTRY-NAME                         70980000
709900                ,:PURCHS-IMPRT-CNTRY-NAME                         70990000
710000                ,:PURCHS-VEND-CNTRY-NAME                          71000000
710100                ,:PURCHS-NEW-STR-PO-IND                           71010000
710200                ,:PURCHS-IMPRT-PO-IND                             71020000
710300                ,:PURCHS-IMPRT-AGNT-PO-IND                        71030000
710400                ,:PURCHS-STATUS-TMST                              71040000
710500                ,:PURCHS-LAST-UPD-TMST                            71050000
710600                ,:PURCHS-EDI-REXMIT-IND                           71060000
710700                ,:PURCHS-EDI-REXMIT-TMST                          71070000
710800                ,:PURCHS-DIR-STR-IND                              71080000
710900                ,:PURCHS-LAST-UPD-BY-UID                          71090000
711000                ,:PURCHS-APP-BY-UID                               71100000
711100                ,:PURCHS-OTB-PER-NBR                              71110000
711200                ,:PURCHS-DEPT-NBR                                 71120000
711300                ,:PURCHS-ENT-ID                                   71130000
711400                ,:PURCHS-STATUS-CDE                               71140000
711500                ,:PURCHS-CRE-BY-UID                               71150000
711600                ,:PURCHS-REJ-CT                                   71160000
711700                ,:PURCHS-REJ-UID                                  71170000
711800                ,:PURCHS-ORD-DTE                                  71180000
711900                ,:PURCHS-REVISION-CT                              71190000
712000                ,:PURCHS-ADR-SEQ-NBR                              71200000
712100                ,:PURCHS-DEST-KNOWN-IND                           71210000
712200                ,:PURCHS-RLSE-IND                                 71220000
712300                ,:PURCHS-RLSE-DTE                                 71230000
712400                ,:PURCHS-PLCMNT-CNTRY-CDE                         71240000
712500                ,:PURCHS-PROD-CNTRY-CDE                           71250000
712600                ,:PURCHS-UNT-PER-CBMT-QTY                         71260000
712700                ,:PURCHS-CRE-TMST                                 71270000
712800                ,:PURCHS-PRG-LAST-ACTVY-DTE                       71280000
712900                ,:PURCHS-PKGNG-CDE                                71290000
713000                ,:PURCHS-SEASET-YR                                71300000
713100                ,:PURCHS-SEASET-SHRT-NM                           71310000
713200                ,:PURCHS-QTA-CTG-CDE                              71320000
713300                ,:PURCHS-PO-IN-RMS-IND                            71330000
713400          FROM                                                    71340000
713500                 TPURCHS                                          71350000
713600          WHERE                                                   71360000
713700                PO_NBR             =  :DK-PO-NBR                  71370000
713800          AND   VER_STATUS_CDE     =  'A'                         71380000
713900     END-EXEC.                                                    71390000
714000                                                                  71400000
714100     EVALUATE TRUE                                                71410000
714200         WHEN SQLCODE = ZERO                                      71420000
714300              MOVE PURCHS-DEPT-NBR TO PV-DEPT-NBR-PIC9            71430000
714400         WHEN SQLCODE = +100                                      71440000
714500              MOVE 0 TO PV-DEPT-NBR-PIC9                          71450000
714600*             CONTINUE                                            71460000
714700         WHEN SQLCODE = -904                                      71470000
714800         WHEN SQLCODE = -911                                      71480000
714900         WHEN SQLCODE = -913                                      71490000
715000              PERFORM 9900-SOFT-ABORT                             71500000
715100         WHEN SQLWARN0 NOT = SPACE                                71510000
715200         WHEN SQLCODE NOT = ZERO                                  71520000
715300              MOVE '5852-GET-TPURCHS-STATUS'                      71530000
715400                               TO DP013-PARAGRAPH                 71540000
715500              MOVE 'GET THE PURCHASE HEADER'                      71550000
715600                               TO DP013-MESSAGE-TEXT (1)          71560000
715700              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             71570000
715800              STRING ' PO = '                                     71580000
715900                     PV-DISP-PO-NBR                               71590000
716000                                         DELIMITED BY SIZE        71600000
716100                              INTO DP013-MESSAGE-TEXT (2)         71610000
716200              MOVE SQLCA       TO DP013-SQLCA                     71620000
716300              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        71630000
716400              MOVE SQLCA       TO DP013-SQLCA                     71640000
716500              SET DP013-DB2-ABEND                                 71650000
716600                               TO TRUE                            71660000
716700              PERFORM DP013-0000-PROCESS-ABEND                    71670000
716800     END-EVALUATE.                                                71680000
716900/                                                                 71690000
717000 5853-UPDATE-PURCHS-STATUS.                                       71700000
717100                                                                  71710000
717200     EXEC SQL                                                     71720000
717300          UPDATE                                                  71730000
717400                TPURCHS                                           71740000
717500           SET                                                    71750000
717600                VER_STATUS_CDE     =  'I'                         71760000
717700          WHERE                                                   71770000
717800                PO_NBR             =  :DK-PO-NBR                  71780000
717900          AND   VER_STATUS_CDE     =  'A'                         71790000
718000     END-EXEC.                                                    71800000
718100                                                                  71810000
718200     EVALUATE TRUE                                                71820000
718300         WHEN SQLCODE = ZERO                                      71830000
718400         WHEN SQLCODE = +100                                      71840000
718500              CONTINUE                                            71850000
718600         WHEN SQLCODE = -904                                      71860000
718700         WHEN SQLCODE = -911                                      71870000
718800         WHEN SQLCODE = -913                                      71880000
718900              SET PS-UPDATES-DONE TO TRUE                         71890000
719000              PERFORM 9900-SOFT-ABORT                             71900000
719100         WHEN SQLWARN0 NOT = SPACE                                71910000
719200         WHEN SQLCODE NOT = ZERO                                  71920000
719300              MOVE '5853-UPDATE-PURCHS-STATUS'                    71930000
719400                               TO DP013-PARAGRAPH                 71940000
719500              MOVE 'GET THE PURCHASE HEADER'                      71950000
719600                               TO DP013-MESSAGE-TEXT (1)          71960000
719700              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             71970000
719800              STRING ' PO = '                                     71980000
719900                     PV-DISP-PO-NBR                               71990000
720000                                         DELIMITED BY SIZE        72000000
720100                              INTO DP013-MESSAGE-TEXT (2)         72010000
720200              MOVE SQLCA       TO DP013-SQLCA                     72020000
720300              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        72030000
720400              MOVE SQLCA       TO DP013-SQLCA                     72040000
720500              SET DP013-DB2-ABEND                                 72050000
720600                               TO TRUE                            72060000
720700              PERFORM DP013-0000-PROCESS-ABEND                    72070000
720800     END-EVALUATE.                                                72080000
720900/                                                                 72090000
721000 5853-UPDATE-PURCHS-STATUS-VER.                                   72100000
721100                                                                  72110000
721200     EXEC SQL                                                     72120000
721300          UPDATE                                                  72130000
721400                TPURCHS                                           72140000
721500           SET                                                    72150000
721600                STATUS_CDE         =  'CM'                        72160000
721700              , STATUS_TMST        =  (CURRENT TIMESTAMP)         72170000
721800          WHERE                                                   72180000
721900                PO_NBR             =  :DK-PO-NBR                  72190000
722000          AND   VER_STATUS_CDE     =  'A'                         72200000
722100     END-EXEC.                                                    72210000
722200                                                                  72220000
722300     EVALUATE TRUE                                                72230000
722400         WHEN SQLCODE = ZERO                                      72240000
722500         WHEN SQLCODE = +100                                      72250000
722600              CONTINUE                                            72260000
722700         WHEN SQLCODE = -904                                      72270000
722800         WHEN SQLCODE = -911                                      72280000
722900         WHEN SQLCODE = -913                                      72290000
723000              SET PS-UPDATES-DONE TO TRUE                         72300000
723100              PERFORM 9900-SOFT-ABORT                             72310000
723200         WHEN SQLWARN0 NOT = SPACE                                72320000
723300         WHEN SQLCODE NOT = ZERO                                  72330000
723400              MOVE '5853-UPDATE-PURCHS-STATUS'                    72340000
723500                               TO DP013-PARAGRAPH                 72350000
723600              MOVE 'GET THE PURCHASE HEADER'                      72360000
723700                               TO DP013-MESSAGE-TEXT (1)          72370000
723800              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             72380000
723900              STRING ' PO = '                                     72390000
724000                     PV-DISP-PO-NBR                               72400000
724100                                         DELIMITED BY SIZE        72410000
724200                              INTO DP013-MESSAGE-TEXT (2)         72420000
724300              MOVE SQLCA       TO DP013-SQLCA                     72430000
724400              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        72440000
724500              MOVE SQLCA       TO DP013-SQLCA                     72450000
724600              SET DP013-DB2-ABEND                                 72460000
724700                               TO TRUE                            72470000
724800              PERFORM DP013-0000-PROCESS-ABEND                    72480000
724900     END-EVALUATE.                                                72490000
725000/                                                                 72500000
725100 5854-INSERT-PURCHS.                                              72510000
725200                                                                  72520000
725300     EXEC SQL                                                     72530000
725400          INSERT                                                  72540000
725500           INTO   TPURCHS                                         72550000
725600                 (PO_NBR                                          72560000
725700                , VER_NBR                                         72570000
725800                , VER_STATUS_CDE                                  72580000
725900                , PO_TYP_CDE                                      72590000
726000                , PO_CATEG_CDE                                    72600000
726100                , EDI_IND                                         72610000
726200                , TOT_UNT_QTY                                     72620000
726300                , TOT_VAL_COST_AMT                                72630000
726400                , TOT_VAL_RTL_AMT                                 72640000
726500                , TOT_MU_PCT                                      72650000
726600                , TOT_SKUS_QTY                                    72660000
726700                , IMPRT_AGNT_PO_NBR                               72670000
726800                , IMPRT_ORD_OFF_NAME                              72680000
726900                , IMPRT_VEND_NAME                                 72690000
727000                , IMPRT_FCTRY_NAME                                72700000
727100                , IMPRT_CNTRY_NAME                                72710000
727200                , VEND_CNTRY_NAME                                 72720000
727300                , NEW_STR_PO_IND                                  72730000
727400                , IMPRT_PO_IND                                    72740000
727500                , IMPRT_AGNT_PO_IND                               72750000
727600                , STATUS_TMST                                     72760000
727700                , LAST_UPD_TMST                                   72770000
727800                , EDI_REXMIT_IND                                  72780000
727900                , EDI_REXMIT_TMST                                 72790000
728000                , DIR_STR_IND                                     72800000
728100                , LAST_UPD_BY_UID                                 72810000
728200                , APP_BY_UID                                      72820000
728300                , OTB_PER_NBR                                     72830000
728400                , DEPT_NBR                                        72840000
728500                , ENT_ID                                          72850000
728600                , STATUS_CDE                                      72860000
728700                , CRE_BY_UID                                      72870000
728800                , REJ_CT                                          72880000
728900                , REJ_UID                                         72890000
729000                , ORD_DTE                                         72900000
729100                , REVISION_CT                                     72910000
729200                , ADR_SEQ_NBR                                     72920000
729300                , DEST_KNOWN_IND                                  72930000
729400                , RLSE_IND                                        72940000
729500                , RLSE_DTE                                        72950000
729600                , PLCMNT_CNTRY_CDE                                72960000
729700                , PROD_CNTRY_CDE                                  72970000
729800                , UNT_PER_CBMT_QTY                                72980000
729900                , CRE_TMST                                        72990000
730000                , PRG_LAST_ACTVY_DTE                              73000000
730100                , PKGNG_CDE                                       73010000
730200                , SEASET_YR                                       73020000
730300                , SEASET_SHRT_NM                                  73030000
730400                , QTA_CTG_CDE                                     73040000
730500                , PO_IN_RMS_IND                                   73050000
730600                )                                                 73060000
730700         VALUES                                                   73070000
730800                (:PURCHS-PO-NBR                                   73080000
730900                ,:PURCHS-VER-NBR                                  73090000
731000                ,'A'                                              73100000
731100                ,:PURCHS-PO-TYP-CDE                               73110000
731200                ,:PURCHS-PO-CATEG-CDE                             73120000
731300                ,:PURCHS-EDI-IND                                  73130000
731400                ,:PURCHS-TOT-UNT-QTY                              73140000
731500                ,:PURCHS-TOT-VAL-COST-AMT                         73150000
731600                ,:PURCHS-TOT-VAL-RTL-AMT                          73160000
731700                ,:PURCHS-TOT-MU-PCT                               73170000
731800                ,:PURCHS-TOT-SKUS-QTY                             73180000
731900                ,:PURCHS-IMPRT-AGNT-PO-NBR                        73190000
732000                ,:PURCHS-IMPRT-ORD-OFF-NAME                       73200000
732100                ,:PURCHS-IMPRT-VEND-NAME                          73210000
732200                ,:PURCHS-IMPRT-FCTRY-NAME                         73220000
732300                ,:PURCHS-IMPRT-CNTRY-NAME                         73230000
732400                ,:PURCHS-VEND-CNTRY-NAME                          73240000
732500                ,:PURCHS-NEW-STR-PO-IND                           73250000
732600                ,:PURCHS-IMPRT-PO-IND                             73260000
732700                ,:PURCHS-IMPRT-AGNT-PO-IND                        73270000
732800                , CURRENT TIMESTAMP                               73280000
732900                , CURRENT TIMESTAMP                               73290000
733000                ,:PURCHS-EDI-REXMIT-IND                           73300000
733100                ,:PURCHS-EDI-REXMIT-TMST                          73310000
733200                ,:PURCHS-DIR-STR-IND                              73320000
733300                ,:DP020-USERID                                    73330000
733400                ,:PURCHS-APP-BY-UID                               73340000
733500                ,:PURCHS-OTB-PER-NBR                              73350000
733600                ,:PURCHS-DEPT-NBR                                 73360000
733700                ,:PURCHS-ENT-ID                                   73370000
733800                ,'AC'                                             73380000
733900                ,:PURCHS-CRE-BY-UID                               73390000
734000                ,:PURCHS-REJ-CT                                   73400000
734100                ,:PURCHS-REJ-UID                                  73410000
734200                ,:PURCHS-ORD-DTE                                  73420000
734300                ,:PURCHS-REVISION-CT                              73430000
734400                ,:PURCHS-ADR-SEQ-NBR                              73440000
734500                ,:PURCHS-DEST-KNOWN-IND                           73450000
734600                ,:PURCHS-RLSE-IND                                 73460000
734700                ,:PURCHS-RLSE-DTE                                 73470000
734800                ,:PURCHS-PLCMNT-CNTRY-CDE                         73480000
734900                ,:PURCHS-PROD-CNTRY-CDE                           73490000
735000                ,:PURCHS-UNT-PER-CBMT-QTY                         73500000
735100                ,:PURCHS-CRE-TMST                                 73510000
735200                ,:PURCHS-PRG-LAST-ACTVY-DTE                       73520000
735300                ,:PURCHS-PKGNG-CDE                                73530000
735400                ,:PURCHS-SEASET-YR                                73540000
735500                ,:PURCHS-SEASET-SHRT-NM                           73550000
735600                ,:PURCHS-QTA-CTG-CDE                              73560000
735700                ,:PURCHS-PO-IN-RMS-IND                            73570000
735800                )                                                 73580000
735900     END-EXEC.                                                    73590000
736000                                                                  73600000
736100     EVALUATE TRUE                                                73610000
736200         WHEN SQLCODE = ZERO                                      73620000
736300              CONTINUE                                            73630000
736400         WHEN SQLCODE = -904                                      73640000
736500         WHEN SQLCODE = -911                                      73650000
736600         WHEN SQLCODE = -913                                      73660000
736700              SET PS-UPDATES-DONE TO TRUE                         73670000
736800              PERFORM 9900-SOFT-ABORT                             73680000
736900         WHEN SQLWARN0 NOT = SPACE                                73690000
737000         WHEN SQLCODE NOT = ZERO                                  73700000
737100              MOVE '5854-INSERT-PURCHS'                           73710000
737200                               TO DP013-PARAGRAPH                 73720000
737300              MOVE 'INSERT PURCHASE HEADER'                       73730000
737400                               TO DP013-MESSAGE-TEXT (1)          73740000
737500              MOVE PURCHS-PO-NBR    TO PV-DISP-PO-NBR             73750000
737600              STRING ' PO = '                                     73760000
737700                     PV-DISP-PO-NBR                               73770000
737800                                         DELIMITED BY SIZE        73780000
737900                              INTO DP013-MESSAGE-TEXT (2)         73790000
738000              MOVE SQLCA       TO DP013-SQLCA                     73800000
738100              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        73810000
738200              MOVE SQLCA       TO DP013-SQLCA                     73820000
738300              SET DP013-DB2-ABEND                                 73830000
738400                               TO TRUE                            73840000
738500              PERFORM DP013-0000-PROCESS-ABEND                    73850000
738600     END-EVALUATE.                                                73860000
738700/                                                                 73870000
738800                                                                  73880000
738900******************************************************************73890000
739000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **73900000
739100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **73910000
739200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **73920000
739300** THE USER.                                                    **73930000
739400******************************************************************73940000
739500 6000-REFRESH-PANEL-FROM-TEMP.                                    73950000
739600     IF  ASC-UPDATE-TSQ                                           73960000
739700         SET ASC-NO-TSQ-UPDATE TO TRUE                            73970000
739800         MOVE ZERO                 TO PV-SAVE-ITEM                73980000
739900                                      PV-SEL-QUEUE-ITEM           73990000
740000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        74000000
740100                                   TO PV-HOLD-SELECTED-ITEMS      74010000
740200         MOVE +1                   TO PV-ITEMS-PROCESSED          74020000
740300         PERFORM 6100-UPDATE-TSQ                                  74030000
740400             UNTIL PV-ITEMS-PROCESSED >                           74040000
740500                                     PV-HOLD-SELECTED-ITEMS       74050000
740600         PERFORM 6010-DELETE-SEL-QUEUE                            74060000
740700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         74070000
740800                    ASC-BLOCK-ENTRIES (2)                         74080000
740900     END-IF.                                                      74090000
741000                                                                  74100000
741100*----------------------------------------------------------------*74110000
741200*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *74120000
741300*----------------------------------------------------------------*74130000
741400 6010-DELETE-SEL-QUEUE.                                           74140000
741500                                                                  74150000
741600     EXEC CICS                                                    74160000
741700         DELETEQ TS                                               74170000
741800             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       74180000
741900             RESP  (PV-CICS-RESP)                                 74190000
742000     END-EXEC.                                                    74200000
742100*                                                                 74210000
742200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      74220000
742300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         74230000
742400         CONTINUE                                                 74240000
742500     ELSE                                                         74250000
742600         SET DP013-CICS-ABEND TO TRUE                             74260000
742700         SET DP013-NO-ROLLBACK TO TRUE                            74270000
742800         MOVE '6010-DELETE-SEL-QUEUE'                             74280000
742900                        TO DP013-PARAGRAPH                        74290000
743000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         74300000
743100                        TO DP013-MESSAGE-TEXT (1)                 74310000
743200         PERFORM DP013-0000-PROCESS-ABEND                         74320000
743300     END-IF.                                                      74330000
743400                                                                  74340000
743500*----------------------------------------------------------------*74350000
743600*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *74360000
743700*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *74370000
743800*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *74380000
743900*    THE TEMP QUEUE.                                             *74390000
744000*----------------------------------------------------------------*74400000
744100                                                                  74410000
744200 6100-UPDATE-TSQ.                                                 74420000
744300                                                                  74430000
744400     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             74440000
744500     PERFORM 6105-READ-SEL-QUEUE.                                 74450000
744600                                                                  74460000
744700     EVALUATE TRUE                                                74470000
744800         WHEN ASC-RETURNING-FROM-RCVG                             74480000
744900             PERFORM                                              74490000
745000                 VARYING RC801-IDX                                74500000
745100                 FROM 1 BY 1                                      74510000
745200                 UNTIL ((PV-ITEMS-PROCESSED >                     74520000
745300                                      PV-HOLD-SELECTED-ITEMS)     74530000
745400                 OR (RC801-IDX GREATER THAN RC801-MAX-ITEMS))     74540000
745500                 IF  RC801-ACTION-SW (RC801-IDX) > SPACE          74550000
745600                     PERFORM 6110-PROCESS-ITEMS                   74560000
745700                 END-IF                                           74570000
745800                 ADD +1                TO PV-ITEMS-PROCESSED      74580000
745900             END-PERFORM                                          74590000
746000         WHEN ASC-RETURNING-FROM-TRBL                             74600000
746100             PERFORM                                              74610000
746200                 VARYING TM002-IDX                                74620000
746300                 FROM 1 BY 1                                      74630000
746400                 UNTIL ((PV-ITEMS-PROCESSED >                     74640000
746500                                      PV-HOLD-SELECTED-ITEMS)     74650000
746600                 OR (TM002-IDX GREATER THAN TM002-MAX-ITEMS))     74660000
746700                 IF  TM002-ACTION-SW (TM002-IDX) > SPACE          74670000
746800                     PERFORM 6110-PROCESS-ITEMS                   74680000
746900                 END-IF                                           74690000
747000                 ADD +1                TO PV-ITEMS-PROCESSED      74700000
747100             END-PERFORM                                          74710000
747200         WHEN ASC-RETURNING-FROM-STR-PACK                         74720000
747300             PERFORM                                              74730000
747400                 VARYING RC037-IDX                                74740000
747500                 FROM 1 BY 1                                      74750000
747600                 UNTIL ((PV-ITEMS-PROCESSED >                     74760000
747700                                      PV-HOLD-SELECTED-ITEMS)     74770000
747800                 OR (RC037-IDX GREATER THAN RC037-MAX-ITEMS))     74780000
747900                 IF  RC037-ACTION-SW (RC037-IDX) > SPACE          74790000
748000                     PERFORM 6110-PROCESS-ITEMS                   74800000
748100                 END-IF                                           74810000
748200                 ADD +1                TO PV-ITEMS-PROCESSED      74820000
748300             END-PERFORM                                          74830000
748400     END-EVALUATE.                                                74840000
748500                                                                  74850000
748600     PERFORM 6111-WRITE-LIST-QUEUE.                               74860000
748700*----------------------------------------------------------------*74870000
748800*    READ THE LIST QUEUE RECORD.                                 *74880000
748900*----------------------------------------------------------------*74890000
749000                                                                  74900000
749100 6105-READ-SEL-QUEUE.                                             74910000
749200                                                                  74920000
749300     EVALUATE TRUE                                                74930000
749400         WHEN ASC-RETURNING-FROM-RCVG                             74940000
749500             EXEC CICS                                            74950000
749600                  READQ TS                                        74960000
749700                      QUEUE (ASC-SEL-QUEUE-NAME-OUT)              74970000
749800                      INTO  (RC801-PREPACK-SELECT-RECORD)         74980000
749900                      ITEM  (PV-SEL-QUEUE-ITEM)                   74990000
750000                      RESP  (PV-CICS-RESP)                        75000000
750100             END-EXEC                                             75010000
750200         WHEN ASC-RETURNING-FROM-TRBL                             75020000
750300             EXEC CICS                                            75030000
750400                  READQ TS                                        75040000
750500                      QUEUE (ASC-SEL-QUEUE-NAME-OUT)              75050000
750600                      INTO  (TM002-MESSAGE-SEL-REC)               75060000
750700                      ITEM  (PV-SEL-QUEUE-ITEM)                   75070000
750800                      RESP  (PV-CICS-RESP)                        75080000
750900             END-EXEC                                             75090000
751000         WHEN ASC-RETURNING-FROM-STR-PACK                         75100000
751100             EXEC CICS                                            75110000
751200                  READQ TS                                        75120000
751300                      QUEUE (ASC-SEL-QUEUE-NAME-OUT)              75130000
751400                      INTO  (RC037-DC-SELECT-RECORD)              75140000
751500                      ITEM  (PV-SEL-QUEUE-ITEM)                   75150000
751600                      RESP  (PV-CICS-RESP)                        75160000
751700             END-EXEC                                             75170000
751800     END-EVALUATE.                                                75180000
751900                                                                  75190000
752000*                                                                 75200000
752100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          75210000
752200         CONTINUE                                                 75220000
752300     ELSE                                                         75230000
752400         SET DP013-CICS-ABEND      TO  TRUE                       75240000
752500         SET DP013-NO-ROLLBACK     TO  TRUE                       75250000
752600         MOVE '6105-READ-SEL-QUEUE'                               75260000
752700                                   TO  DP013-PARAGRAPH            75270000
752800         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           75280000
752900                                   TO  DP013-MESSAGE-TEXT(1)      75290000
753000         PERFORM DP013-0000-PROCESS-ABEND                         75300000
753100     END-IF.                                                      75310000
753200 EJECT                                                            75320000
753300*----------------------------------------------------------------*75330000
753400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*75340000
753500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*75350000
753600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *75360000
753700*----------------------------------------------------------------*75370000
753800                                                                  75380000
753900 6110-PROCESS-ITEMS.                                              75390000
754000                                                                  75400000
754100     EVALUATE TRUE                                                75410000
754200         WHEN ASC-RETURNING-FROM-RCVG                             75420000
754300             COMPUTE PV-ITEM = 1 + ((RC801-ITEM (RC801-IDX) - 1)  75430000
754400                             / PC-ITEMS-PER-PANEL)                75440000
754500         WHEN ASC-RETURNING-FROM-TRBL                             75450000
754600             COMPUTE PV-ITEM = 1 + ((TM002-ITEM (TM002-IDX) - 1)  75460000
754700                             / PC-ITEMS-PER-PANEL)                75470000
754800         WHEN ASC-RETURNING-FROM-STR-PACK                         75480000
754900             COMPUTE PV-ITEM = 1 + ((RC037-ITEM (RC037-IDX) - 1)  75490000
755000                             / PC-ITEMS-PER-PANEL)                75500000
755100     END-EVALUATE.                                                75510000
755200                                                                  75520000
755300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           75530000
755400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          75540000
755500             PERFORM 6111-WRITE-LIST-QUEUE                        75550000
755600         END-IF                                                   75560000
755700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    75570000
755800                                                                  75580000
755900         PERFORM 6112-READ-LIST-QUEUE                             75590000
756000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               75600000
756100             CONTINUE                                             75610000
756200         END-IF                                                   75620000
756300     END-IF.                                                      75630000
756400                                                                  75640000
756500     EVALUATE TRUE                                                75650000
756600         WHEN ASC-RETURNING-FROM-RCVG                             75660000
756700             COMPUTE PV-SUB = (RC801-ITEM (RC801-IDX)             75670000
756800                            - LQW-LIST-ITEM-NUMBER (1)) + 1       75680000
756900         WHEN ASC-RETURNING-FROM-TRBL                             75690000
757000             COMPUTE PV-SUB = (TM002-ITEM (TM002-IDX)             75700000
757100                            - LQW-LIST-ITEM-NUMBER (1)) + 1       75710000
757200         WHEN ASC-RETURNING-FROM-STR-PACK                         75720000
757300             COMPUTE PV-SUB = (RC037-ITEM (RC037-IDX)             75730000
757400                            - LQW-LIST-ITEM-NUMBER (1)) + 1       75740000
757500     END-EVALUATE.                                                75750000
757600                                                                  75760000
757700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         75770000
757800     MOVE LQW-SELECTED-SW (PV-SUB)                                75780000
757900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  75790000
758000     EVALUATE TRUE                                                75800000
758100         WHEN ASC-RETURNING-FROM-RCVG                             75810000
758200             EVALUATE TRUE                                        75820000
758300                 WHEN RC801-INQ (RC801-IDX)                       75830000
758400                      MOVE PC-INQ      TO LQW-ACTION (PV-SUB)     75840000
758500                                                                  75850000
758600                 WHEN RC801-UPD (RC801-IDX)                       75860000
758700                      MOVE PC-UPD      TO LQW-ACTION (PV-SUB)     75870000
758800                                                                  75880000
758900                 WHEN RC801-DEL (RC801-IDX)                       75890000
759000                      MOVE PC-DEL      TO LQW-ACTION (PV-SUB)     75900000
759100                                                                  75910000
759200                 WHEN RC801-ERR (RC801-IDX)                       75920000
759300                      MOVE PC-ERR      TO LQW-ACTION (PV-SUB)     75930000
759400             END-EVALUATE                                         75940000
759500         WHEN ASC-RETURNING-FROM-TRBL                             75950000
759600             EVALUATE TRUE                                        75960000
759700                 WHEN TM002-INQ (TM002-IDX)                       75970000
759800                      MOVE PC-INQ      TO LQW-ACTION (PV-SUB)     75980000
759900                                                                  75990000
760000                 WHEN TM002-UPD (TM002-IDX)                       76000000
760100                      MOVE PC-UPD      TO LQW-ACTION (PV-SUB)     76010000
760200                                                                  76020000
760300                 WHEN TM002-DEL (TM002-IDX)                       76030000
760400                      MOVE PC-DEL      TO LQW-ACTION (PV-SUB)     76040000
760500                                                                  76050000
760600                 WHEN TM002-ERR (TM002-IDX)                       76060000
760700                      MOVE PC-ERR      TO LQW-ACTION (PV-SUB)     76070000
760800             END-EVALUATE                                         76080000
760900         WHEN ASC-RETURNING-FROM-STR-PACK                         76090000
761000             EVALUATE TRUE                                        76100000
761100                 WHEN RC037-INQ (RC037-IDX)                       76110000
761200                      MOVE PC-INQ      TO LQW-ACTION (PV-SUB)     76120000
761300                                                                  76130000
761400                 WHEN RC037-UPD (RC037-IDX)                       76140000
761500                      MOVE PC-UPD      TO LQW-ACTION (PV-SUB)     76150000
761600                                                                  76160000
761700                 WHEN RC037-DEL (RC037-IDX)                       76170000
761800                      MOVE PC-DEL      TO LQW-ACTION (PV-SUB)     76180000
761900                                                                  76190000
762000                 WHEN RC037-ERR (RC037-IDX)                       76200000
762100                      MOVE PC-ERR      TO LQW-ACTION (PV-SUB)     76210000
762200             END-EVALUATE                                         76220000
762300             IF LQW-ACTION (PV-SUB) = PC-UPD OR                   76230000
762400                LQW-ACTION (PV-SUB) = PC-INQ                      76240000
762500                 MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID      76250000
762600                 MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID         76260000
762700                 MOVE ASC-PO-NBR           TO DK-PO-NBR           76270000
762800                 MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR      76280000
762900                 MOVE LQW-PACK-ID (PV-SUB) TO DK-PREPK-ID         76290000
763000                 PERFORM 5300-GET-TRECEIV-STATUS                  76300000
763100                 PERFORM 6200-SELECT-PACK-DATA                    76310000
763200                 PERFORM 6300-PROCESS-LINES                       76320000
763300             END-IF                                               76330000
763400     END-EVALUATE.                                                76340000
763500                                                                  76350000
763600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                76360000
763700                                                                  76370000
763800*----------------------------------------------------------------*76380000
763900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *76390000
764000*----------------------------------------------------------------*76400000
764100                                                                  76410000
764200 6111-WRITE-LIST-QUEUE.                                           76420000
764300                                                                  76430000
764400     EXEC CICS                                                    76440000
764500         WRITEQ TS                                                76450000
764600             QUEUE (ASC-LIST-QUEUE-NAME)                          76460000
764700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     76470000
764800             ITEM  (PV-SAVE-ITEM)                                 76480000
764900             REWRITE                                              76490000
765000             RESP  (PV-CICS-RESP)                                 76500000
765100     END-EXEC.                                                    76510000
765200*                                                                 76520000
765300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          76530000
765400         CONTINUE                                                 76540000
765500     ELSE                                                         76550000
765600         SET DP013-CICS-ABEND  TO  TRUE                           76560000
765700         SET DP013-NO-ROLLBACK TO  TRUE                           76570000
765800         MOVE '6111-WRITE-LIST-QUEUE'                             76580000
765900                               TO  DP013-PARAGRAPH                76590000
766000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  76600000
766100                               TO  DP013-MESSAGE-TEXT(1)          76610000
766200         PERFORM DP013-0000-PROCESS-ABEND                         76620000
766300     END-IF.                                                      76630000
766400                                                                  76640000
766500 EJECT                                                            76650000
766600*----------------------------------------------------------------*76660000
766700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*76670000
766800*----------------------------------------------------------------*76680000
766900                                                                  76690000
767000 6112-READ-LIST-QUEUE.                                            76700000
767100                                                                  76710000
767200     EXEC CICS                                                    76720000
767300         READQ TS                                                 76730000
767400             QUEUE (ASC-LIST-QUEUE-NAME)                          76740000
767500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     76750000
767600             ITEM  (PV-ITEM)                                      76760000
767700             RESP  (PV-CICS-RESP)                                 76770000
767800     END-EXEC.                                                    76780000
767900*                                                                 76790000
768000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          76800000
768100         CONTINUE                                                 76810000
768200     ELSE                                                         76820000
768300         SET DP013-CICS-ABEND        TO TRUE                      76830000
768400         SET DP013-NO-ROLLBACK       TO TRUE                      76840000
768500         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           76850000
768600         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    76860000
768700                                     TO DP013-MESSAGE-TEXT(1)     76870000
768800         PERFORM DP013-0000-PROCESS-ABEND                         76880000
768900     END-IF.                                                      76890000
769000                                                                  76900000
769100 6200-SELECT-PACK-DATA.                                           76910000
769200     EXEC SQL                                                     76920000
769300          SELECT DISTINCT                                         76930000
769400                B.PREPK_ID                                        76940000
769500              , B.STATUS_CDE                                      76950000
769600              , B.VRFD_USR_ID                                     76960000
769700              , C.CL_NBR                                          76970000
769800              , D.DEPT_NBR                                        76980000
769900          INTO  :RECITM-PREPK-ID                                  76990000
770000              , :RECITM-STATUS-CDE                                77000000
770100              , :RECITM-VRFD-USR-ID                               77010000
770200              , :PURITM-CL-NBR                                    77020000
770300              , :PURCHS-DEPT-NBR                                  77030000
770400          FROM    TRECEIV  A                                      77040000
770500              ,   TRECITM  B                                      77050000
770600              ,   TPURITM  C                                      77060000
770700              ,   TPURCHS  D                                      77070000
770800          WHERE A.ORD_NBR          =  :DK-PO-NBR                  77080000
770900           AND  A.ORD_NBR          =  B.ORD_NBR                   77090000
771000           AND  A.ORD_NBR          =  C.PO_NBR                    77100000
771100           AND  A.ORD_NBR          =  D.PO_NBR                    77110000
771200           AND  A.VER_STATUS_CDE   =  'A'                         77120000
771300           AND  B.VER_STATUS_CDE   =  'A'                         77130000
771400           AND  D.VER_STATUS_CDE   =  'A'                         77140000
771500           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             77150000
771600           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               77160000
771700           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                77170000
771800           AND  A.FCLTY_ID         =  B.FCLTY_ID                  77180000
771900           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             77190000
772000           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               77200000
772100           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            77210000
772200           AND  B.PO_VER_NBR       =  C.VER_NBR                   77220000
772300           AND  B.PREPK_ID         = :DK-PREPK-ID                 77230000
772400     END-EXEC.                                                    77240000
772500                                                                  77250000
772600     EVALUATE TRUE                                                77260000
772700         WHEN SQLCODE = ZERO                                      77270000
772800              CONTINUE                                            77280000
772900         WHEN SQLWARN0 NOT = SPACE                                77290000
773000         WHEN SQLCODE NOT = ZERO                                  77300000
773100              MOVE '6200-SELECT-PACK-DATA'                        77310000
773200                               TO DP013-PARAGRAPH                 77320000
773300              MOVE 'SELECT PACK DATA'                             77330000
773400                               TO DP013-MESSAGE-TEXT (1)          77340000
773500              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             77350000
773600              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        77360000
773700              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           77370000
773800              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        77380000
773900              MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID           77390000
774000              STRING ' PO = '                                     77400000
774100                     PV-DISP-PO-NBR                               77410000
774200                     ' RECV ='                                    77420000
774300                     PV-DISP-REC-SEQ-NBR                          77430000
774400                     ' OPER = '                                   77440000
774500                     PV-DISP-OPER-UNT-ID                          77450000
774600                     ' FCLTY = '                                  77460000
774700                     PV-DISP-FCLTY-ID                             77470000
774800                     ' PACK  = '                                  77480000
774900                     PV-DISP-PREPK-ID                             77490000
775000                                         DELIMITED BY SIZE        77500000
775100                              INTO DP013-MESSAGE-TEXT (2)         77510000
775200              MOVE SQLCA       TO DP013-SQLCA                     77520000
775300              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        77530000
775400              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (2)        77540000
775500              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (3)        77550000
775600              SET DP013-DB2-ABEND                                 77560000
775700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              77570000
775800              PERFORM DP013-0000-PROCESS-ABEND                    77580000
775900     END-EVALUATE.                                                77590000
776000                                                                  77600000
776100                                                                  77610000
776200 6300-PROCESS-LINES.                                              77620000
776300     MOVE PC-UPD           TO LQW-ACTION (PV-SUB).                77630000
776400     MOVE RECEIV-STATUS-CDE TO ASC-RECEIV-STATUS-CDE.             77640000
776500     MOVE PURITM-CL-NBR    TO LQW-CL (PV-SUB).                    77650000
776600     MOVE RECITM-PREPK-ID  TO LQW-PACK-ID (PV-SUB).               77660000
776700     MOVE RECITM-STATUS-CDE                                       77670000
776800                           TO LQW-STAT-CDE (PV-SUB).              77680000
776900     IF  RECITM-STATUS-CDE NOT EQUAL 'CM'                         77690000
777000         SET ASC-CANT-VERIFY                                      77700000
777100                       TO  TRUE                                   77710000
777200     END-IF.                                                      77720000
777300     IF  RECITM-STATUS-CDE NOT EQUAL 'VE'                         77730000
777400         SET ASC-CANT-UNVERIFY-ST                                 77740000
777500                       TO  TRUE                                   77750000
777600     END-IF.                                                      77760000
777700     IF  RECEIV-FS-POST-TMST NOT EQUAL TO                         77770000
777800         PC-FS-TIMESTAMP                                          77780000
777900            SET ASC-CANT-UNVERIFY-FS                              77790000
778000                       TO  TRUE                                   77800000
778100     END-IF.                                                      77810000
778200     IF  RECITM-STATUS-CDE NOT EQUAL 'VE'                         77820000
778300         SET ASC-CANT-UNVERIFY-ST                                 77830000
778400                       TO  TRUE                                   77840000
778500     END-IF.                                                      77850000
778600     MOVE RECITM-PREPK-ID   TO DK-PREPK-ID.                       77860000
778700     PERFORM 4340-SELECT-DRIVER-RATIO.                            77870000
778800     MOVE RECITM-PREPK-RATO-QTY TO PV-DRIVER-RATIO                77880000
778900                                   ASC-DRIVER-RATIO.              77890000
779000     IF RECITM-STATUS-CDE = 'VE'                                  77900000
779100         IF RECITM-VRFD-USR-ID (1:2) = 'TK'                       77910000
779110         OR RECITM-VRFD-USR-ID (1:2) = 'TC'                       77911000
779120         OR RECITM-VRFD-USR-ID (1:2) = 'TV'                       77912000
779200          OR SPACES                                               77920000
779300             MOVE 'MANUAL' TO LQW-VERFYD-SOURCE (PV-SUB)          77930000
779400         ELSE                                                     77940000
779500             MOVE RECITM-VRFD-USR-ID TO LQW-VERFYD-SOURCE         77950000
779600                                           (PV-SUB)               77960000
779700          END-IF                                                  77970000
779800     ELSE                                                         77980000
779900         MOVE RECITM-ORD-LNE-NBR TO DK-HOLD-LNE-NBR               77990000
780000         PERFORM 5460-SELECT-TDISTHD                              78000000
780100         IF PS-NO-TDISTHD-FOUND                                   78010000
780200             MOVE 'MANUAL' TO LQW-VERFYD-SOURCE (PV-SUB)          78020000
780300         ELSE                                                     78030000
780400             IF DISTHD-TOT-CART-CNT = 0                           78040000
780500                 MOVE 'MANUAL' TO LQW-VERFYD-SOURCE (PV-SUB)      78050000
780600             ELSE                                                 78060000
780700                 IF (DISTHD-P2L-CART-CNT = 0                      78070000
780800                    AND (DISTHD-FCSE-CART-CNT > 0                 78080000
780900                    OR DISTHD-INPK-CART-CNT > 0))                 78090000
781000                      MOVE 'CASE' TO LQW-VERFYD-SOURCE (PV-SUB)   78100000
781100                 ELSE                                             78110000
781200                   IF (DISTHD-P2L-CART-CNT > 0                    78120000
781300                     AND (DISTHD-FCSE-CART-CNT > 0                78130000
781400                       OR DISTHD-INPK-CART-CNT > 0))              78140000
781500                       MOVE 'P2L/CASE'                            78150000
781600                                TO LQW-VERFYD-SOURCE (PV-SUB)     78160000
781700                   ELSE                                           78170000
781800                   IF (DISTHD-P2L-CART-CNT > 0                    78180000
781900                      AND (DISTHD-FCSE-CART-CNT = 0               78190000
782000                      AND DISTHD-INPK-CART-CNT = 0))              78200000
782100                      MOVE 'P2L'  TO LQW-VERFYD-SOURCE (PV-SUB)   78210000
782200                   ELSE                                           78220000
782300                       MOVE 'MANUAL' TO LQW-VERFYD-SOURCE (PV-SUB)78230000
782400                   END-IF                                         78240000
782500                   END-IF                                         78250000
782600                 END-IF                                           78260000
782700             END-IF                                               78270000
782800         END-IF                                                   78280000
782900     END-IF.                                                      78290000
783000     PERFORM 4350-CALL-RCKUT128.                                  78300000
783100**                                                                78310000
785300     SUBTRACT LQW-PKSLIP-PACKS (PV-SUB) FROM                      78530000
785400                               ASC-TOT-PKSLIP-PACKS.              78540000
785500     MOVE RC074-TOTAL-INVC-PACK-QTY                               78550000
785600                           TO  LQW-PKSLIP-PACKS (PV-SUB).         78560000
785700     ADD RC074-TOTAL-INVC-PACK-QTY                                78570000
785800                           TO  ASC-TOT-PKSLIP-PACKS.              78580000
785900     SUBTRACT LQW-ACTUAL-PACKS (PV-SUB) FROM                      78590000
786000                               ASC-TOT-ACTUAL-PACKS.              78600000
786100     MOVE RC074-TOTAL-ACTL-PACK-QTY                               78610000
786200                           TO  LQW-ACTUAL-PACKS (PV-SUB).         78620000
786300     ADD RC074-TOTAL-ACTL-PACK-QTY                                78630000
786400                           TO  ASC-TOT-ACTUAL-PACKS.              78640000
786500     SUBTRACT LQW-VERFYD-PACKS (PV-SUB) FROM                      78650000
786600                               ASC-TOT-VERFYD-PACKS.              78660000
786700     MOVE RC074-VERIFY-PACK-QTY                                   78670000
786800                           TO  LQW-VERFYD-PACKS (PV-SUB).         78680000
786900     ADD RC074-VERIFY-PACK-QTY                                    78690000
787000                           TO  ASC-TOT-VERFYD-PACKS.              78700000
787100     IF  RECITM-STATUS-CDE EQUAL 'VE'                             78710000
787200         MOVE RC074-VERIFY-ODD-QTY     TO PV-ODD-UNITS            78720000
787300     ELSE                                                         78730000
787400         MOVE RC074-ACTUAL-ODD-QTY TO PV-ODD-UNITS                78740000
787500     END-IF.                                                      78750000
787600     SUBTRACT LQW-ODD-UNITS (PV-SUB) FROM                         78760000
787700                               ASC-TOT-ODD-UNITS.                 78770000
787800     MOVE PV-ODD-UNITS     TO  LQW-ODD-UNITS (PV-SUB).            78780000
787900     ADD PV-ODD-UNITS      TO  ASC-TOT-ODD-UNITS.                 78790000
788000     SUBTRACT LQW-TOT-ACT-UNTS (PV-SUB) FROM                      78800000
788100                               ASC-HDR-TOT-ACT-UNTS.              78810000
788200     MOVE RC074-TOTAL-ACTL-ITM-QTY                                78820000
788300                       TO  LQW-TOT-ACT-UNTS (PV-SUB).             78830000
788400     ADD RC074-TOTAL-ACTL-ITM-QTY                                 78840000
788500                       TO  ASC-HDR-TOT-ACT-UNTS.                  78850000
788600     SUBTRACT LQW-TOT-VERFYD-UNTS (PV-SUB) FROM                   78860000
788700                               ASC-HDR-TOT-VERFYD-UNTS.           78870000
788800     MOVE RC074-VERIFY-ITM-QTY                                    78880000
788900                       TO  LQW-TOT-VERFYD-UNTS (PV-SUB).          78890000
789000     ADD RC074-VERIFY-ITM-QTY                                     78900000
789100                       TO  ASC-HDR-TOT-VERFYD-UNTS.               78910000
789200     MOVE POPRPK-PK-SKU-NBR                                       78920000
789300                       TO  LQW-PACK-SKU (PV-SUB).                 78930000
789400     MOVE PURCHS-DEPT-NBR                                         78940000
789500                       TO ASC-DEPT-NBR.                           78950000
789600                                                                  78960000
789700******************************************************************78970000
789800*    THIS PARAGRAPH WILL GET THE CURRENT DATE FROM THE SYSTEM    *78980000
789900*    SO THAT IT CAN BE USED TO COMPARE TO THE DC FLUSH DATE TO   *78990000
790000*    DETERMINE IF THERE ARE STORES IN AN INVENTORY FLUSH PERIOD. *79000000
790100******************************************************************79010000
790200 7010-GET-CURRENT-DATE.                                           79020000
790300                                                                  79030000
790400     EXEC SQL                                                     79040000
790500         SET :PV-CURR-DATE = CURRENT_DATE                         79050000
790600     END-EXEC.                                                    79060000
790700                                                                  79070000
790800     MOVE PV-CURR-DATE     TO PV-CURRENT-DATE.                    79080000
790900     MOVE PV-CURRENT-CC    TO PV-HOLD-CURR-CC.                    79090000
791000     MOVE PV-CURRENT-YY    TO PV-HOLD-CURR-YY.                    79100000
791100     MOVE PV-CURRENT-MM    TO PV-HOLD-CURR-MM.                    79110000
791200     MOVE PV-CURRENT-DD    TO PV-HOLD-CURR-DD.                    79120000
791300                                                                  79130000
791400*----------------------------------------------------------------*79140000
791500*    SELECT THE CURR OPER UNIT FROM TRECEIV                       79150000
791600* IF THE CURR OPER UNIT IS A DC BUT THE OPER-UNT-ID IS A STORE    79160000
791700* THEN WE WANT THE SWITCH TO SAY THAT THIS IS NOT A DC.           79170000
791800* 4/2002 - DEANNA BRANTER                                         79180000
791900*----------------------------------------------------------------*79190000
792000 8000-SELECT-TRECEIV.                                             79200000
792100     EXEC SQL                                                     79210000
792200          SELECT CURR_OPER_UNT_ID                                 79220000
792300           INTO :RECEIV-CURR-OPER-UNT-ID                          79230000
792400          FROM  TRECEIV                                           79240000
792500          WHERE  ORD_NBR          =  :DK-PO-NBR                   79250000
792600          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              79260000
792700          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              79270000
792800          AND    FCLTY_ID         =  :DK-FCLTY-ID                 79280000
792900          AND    VER_STATUS_CDE   =  'A'                          79290000
793000     END-EXEC.                                                    79300000
793100                                                                  79310000
793200     EVALUATE TRUE                                                79320000
793300         WHEN SQLCODE = ZERO                                      79330000
793400              MOVE RECEIV-CURR-OPER-UNT-ID TO DK-OPER-UNT-ID      79340000
793500              PERFORM 8100-CHECK-OPER                             79350000
793600              IF PS-OPER-UNT-IS-DC AND                            79360000
793700                 ASC-OPER-UNT-ID NOT = RECEIV-CURR-OPER-UNT-ID    79370000
793800                    MOVE ASC-OPER-UNT-ID TO DK-OPER-UNT-ID        79380000
793900                    PERFORM 8100-CHECK-OPER                       79390000
794000              END-IF                                              79400000
794100         WHEN SQLCODE = +100                                      79410000
794200              SET PS-OPER-UNT-NOT-DC TO  TRUE                     79420000
794300         WHEN SQLCODE = -904                                      79430000
794400         WHEN SQLCODE = -911                                      79440000
794500         WHEN SQLCODE = -913                                      79450000
794600              PERFORM 9900-SOFT-ABORT                             79460000
794700         WHEN SQLWARN0 NOT = SPACE                                79470000
794800         WHEN SQLCODE NOT = ZERO                                  79480000
794900              MOVE '8000-SELECT-TRECEIV' TO DP013-PARAGRAPH       79490000
795000              MOVE 'SELECT TRECEIV'                               79500000
795100                               TO DP013-MESSAGE-TEXT (1)          79510000
795200              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        79520000
795300              MOVE SQLCA       TO DP013-SQLCA                     79530000
795400              SET DP013-DB2-ABEND                                 79540000
795500                               TO TRUE                            79550000
795600              PERFORM DP013-0000-PROCESS-ABEND                    79560000
795700     END-EVALUATE.                                                79570000
795800                                                                  79580000
795900*----------------------------------------------------------------*79590000
796000*  CHECK RECEIV-CURR-OPER-UNT-ID TO MAKE SURE IT IS A DC.         79600000
796100*  THIS WAS CHANGED TO ALSO CHECK THE OPER-UNT-ID FIELD DUE TO    79610000
796200*  DIRECT TO STORE ORDERS WHICH WE DON'T WANT TO INCLUDE ON THE   79620000
796300*  UNITS WORKED TABLES.                                           79630000
796400*  4/2002 - DEANNA BRANTNER                                       79640000
796500*----------------------------------------------------------------*79650000
796600 8100-CHECK-OPER.                                                 79660000
796700     EXEC SQL                                                     79670000
796800          SELECT LOC_TYP_CDE                                      79680000
796900            INTO :XLT00010-LOC-TYP-CDE                            79690000
797000            FROM XLT_LOC                                          79700000
797100          WHERE LOC_NBR  =  :DK-OPER-UNT-ID                       79710000
797200      END-EXEC.                                                   79720000
797300                                                                  79730000
797400     EVALUATE TRUE                                                79740000
797500         WHEN SQLCODE = ZERO                                      79750000
797600              IF XLT00010-LOC-TYP-CDE = 'DC'                      79760000
797700                  SET PS-OPER-UNT-IS-DC TO TRUE                   79770000
797800              ELSE                                                79780000
797900                  SET PS-OPER-UNT-NOT-DC TO TRUE                  79790000
798000              END-IF                                              79800000
798100         WHEN SQLCODE = +100                                      79810000
798200              SET PS-OPER-UNT-NOT-DC TO TRUE                      79820000
798300         WHEN SQLCODE = -904                                      79830000
798400         WHEN SQLCODE = -911                                      79840000
798500         WHEN SQLCODE = -913                                      79850000
798600              PERFORM 9900-SOFT-ABORT                             79860000
798700         WHEN SQLWARN0 NOT = SPACE                                79870000
798800         WHEN SQLCODE NOT = ZERO                                  79880000
798900              MOVE '8100-CHECK-OPER'  TO DP013-PARAGRAPH          79890000
799000              MOVE 'SELECT XLT_LOC'                               79900000
799100                               TO DP013-MESSAGE-TEXT (1)          79910000
799200              MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)        79920000
799300              MOVE SQLCA       TO DP013-SQLCA                     79930000
799400              SET DP013-DB2-ABEND TO TRUE                         79940000
799500              PERFORM DP013-0000-PROCESS-ABEND                    79950000
799600     END-EVALUATE.                                                79960000
799700                                                                  79970000
799800*----------------------------------------------------------------*79980000
799900*    CALL THE UNITS WORKED UPDATE MODULE PCKCS756                 79990000
800000*----------------------------------------------------------------*80000000
800100 8500-UPDATE-UNITS-WRKD.                                          80010000
800200* THIS WILL CALL PCKCS756 WHICH WILL UPDATE THE TABLES FOR UNITS  80020000
800300* WORKED OR VERIFIED                                              80030000
800400                                                                  80040000
800500     EXEC SQL                                                     80050000
800600         SET :PV-CURRENT-TIMESTAMP =  CURRENT_TIMESTAMP           80060000
800700     END-EXEC.                                                    80070000
800800                                                                  80080000
800900     MOVE PV-CURRENT-TIMESTAMP        TO PC238-WRKD-TMST.         80090000
801000     MOVE RECEIV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.  80100000
801100     MOVE ASC-PO-NBR                  TO PC238-PO-NBR.            80110000
801200     MOVE ASC-REC-SEQ-NBR             TO PC238-RCVR-SEQ-NBR.      80120000
801300     IF PC238-TRANS-TYPE-CDE = 'W' OR 'Y'                         80130000
801400         MOVE ZEROES                  TO PC238-PO-LNE-NBR         80140000
801500     ELSE                                                         80150000
801600         MOVE RECDIS-ORD-LNE-NBR      TO PC238-PO-LNE-NBR         80160000
801700     END-IF.                                                      80170000
801800     MOVE SPACES                      TO PC238-PRCG-AREA-CDE.     80180000
801900     MOVE 'M'                         TO PC238-VERIFY-TYPE-CDE.   80190000
802000     MOVE LENGTH OF PC238-COMM-AREA   TO PV-COMMAREA-LENGTH.      80200000
802100                                                                  80210000
802200     EXEC CICS                                                    80220000
802300         LINK                                                     80230000
802400             PROGRAM   (PC-UNTS-WRKD-PGRM-NAME)                   80240000
802500             COMMAREA  (PC238-COMM-AREA)                          80250000
802600             LENGTH    (PV-COMMAREA-LENGTH)                       80260000
802700             RESP      (PV-CICS-RESP)                             80270000
802800     END-EXEC.                                                    80280000
802900                                                                  80290000
803000     EVALUATE TRUE                                                80300000
803100         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     80310000
803200              EVALUATE TRUE                                       80320000
803300                  WHEN PC238-MOD-SUCCESSFUL                       80330000
803400                       CONTINUE                                   80340000
803500                 WHEN PC238-MOD-UNSUCCESSFUL                      80350000
803600                     MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER     80360000
803700                     SET DP020-MSG-FATAL TO TRUE                  80370000
803800                     SET PS-ERROR TO TRUE                         80380000
803900                     PERFORM 8600-MOD-UNSUCCESSFUL                80390000
804000             END-EVALUATE                                         80400000
804100         WHEN OTHER                                               80410000
804200             MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER             80420000
804300             SET DP020-MSG-FATAL TO TRUE                          80430000
804400             SET PS-ERROR TO TRUE                                 80440000
804500     END-EVALUATE.                                                80450000
804600                                                                  80460000
804700 8600-MOD-UNSUCCESSFUL.                                           80470000
804800                                                                  80480000
804900     MOVE PC238-PO-NBR              TO PV-DISP-PO-NBR.            80490000
805000     MOVE PC238-RCVR-SEQ-NBR        TO PV-DISP-REC-SEQ-NBR.       80500000
805100     MOVE PC238-PO-LNE-NBR          TO PV-DISP-LNE-NBR.           80510000
805200     MOVE PC238-WRKD-OPER-UNT-ID    TO PV-DISP-OPER-UNT-ID.       80520000
805300     MOVE PC238-BAD-SQL-CDE         TO PV-DISPLAY-SQL-CODE        80530000
805400                                       SQLCODE.                   80540000
805500     SET  PS-UNITS-WORKED-ERROR                                   80550000
805600          PS-UPDATES-DONE           TO TRUE.                      80560000
805700                                                                  80570000
805800     IF  PC238-MOD-BAD-TMST                                       80580000
805900         STRING ' RCKCS817 - '      DELIMITED BY SIZE             80590000
806000                ' 8500-UPDATE-UNITS-WRKD '                        80600000
806100                                    DELIMITED BY SIZE             80610000
806200                ' BAD TIMESTAMP '   DELIMITED BY SIZE             80620000
806300                PC238-WRKD-TMST     DELIMITED BY SIZE             80630000
806400                             INTO PV-CICS-MSG-AREA                80640000
806500         MOVE LENGTH OF PV-CICS-MSG-AREA                          80650000
806600                               TO PV-COMMAREA-LENGTH              80660000
806700         PERFORM 9200-WRITE-TO-CICS-LOG                           80670000
806800         STRING ' RCKCS817 - '      DELIMITED BY SIZE             80680000
806900                ' 8500-UPDATE-UNITS-WRKD '                        80690000
807000                                    DELIMITED BY SIZE             80700000
807100                ' KEY INFO - '      DELIMITED BY SIZE             80710000
807200                PV-DISP-PO-NBR      DELIMITED BY SIZE             80720000
807300                ' - '               DELIMITED BY SIZE             80730000
807400                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             80740000
807500                ' - '               DELIMITED BY SIZE             80750000
807600                PV-DISP-LNE-NBR     DELIMITED BY SIZE             80760000
807700                             INTO PV-CICS-MSG-AREA                80770000
807800         MOVE LENGTH OF PV-CICS-MSG-AREA                          80780000
807900                               TO PV-COMMAREA-LENGTH              80790000
808000         PERFORM 9200-WRITE-TO-CICS-LOG                           80800000
808100         PERFORM 9900-SOFT-ABORT                                  80810000
808200     ELSE                                                         80820000
808300     IF  PC238-MOD-BAD-OPER                                       80830000
808400         STRING ' RCKCS817 - '      DELIMITED BY SIZE             80840000
808500                ' 8500-UPDATE-UNITS-WRKD '                        80850000
808600                                    DELIMITED BY SIZE             80860000
808700                ' BAD OPER UNIT '   DELIMITED BY SIZE             80870000
808800                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             80880000
808900                             INTO PV-CICS-MSG-AREA                80890000
809000         MOVE LENGTH OF PV-CICS-MSG-AREA                          80900000
809100                               TO PV-COMMAREA-LENGTH              80910000
809200         PERFORM 9200-WRITE-TO-CICS-LOG                           80920000
809300         STRING ' RCKCS817 - '      DELIMITED BY SIZE             80930000
809400                ' 8500-UPDATE-UNITS-WRKD '                        80940000
809500                                    DELIMITED BY SIZE             80950000
809600                ' KEY INFO - '      DELIMITED BY SIZE             80960000
809700                PV-DISP-PO-NBR      DELIMITED BY SIZE             80970000
809800                ' - '               DELIMITED BY SIZE             80980000
809900                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             80990000
810000                ' - '               DELIMITED BY SIZE             81000000
810100                PV-DISP-LNE-NBR     DELIMITED BY SIZE             81010000
810200                             INTO PV-CICS-MSG-AREA                81020000
810300         MOVE LENGTH OF PV-CICS-MSG-AREA                          81030000
810400                               TO PV-COMMAREA-LENGTH              81040000
810500         PERFORM 9200-WRITE-TO-CICS-LOG                           81050000
810600         PERFORM 9900-SOFT-ABORT                                  81060000
810700     ELSE                                                         81070000
810800     IF  PC238-MOD-BAD-TRANS-TYPE                                 81080000
810900         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81090000
811000                ' 8500-UPDATE-UNITS-WRKD '                        81100000
811100                                    DELIMITED BY SIZE             81110000
811200                ' BAD TRAN TYPE '   DELIMITED BY SIZE             81120000
811300                PC238-TRANS-TYPE-CDE                              81130000
811400                                    DELIMITED BY SIZE             81140000
811500                             INTO PV-CICS-MSG-AREA                81150000
811600         MOVE LENGTH OF PV-CICS-MSG-AREA                          81160000
811700                               TO PV-COMMAREA-LENGTH              81170000
811800         PERFORM 9200-WRITE-TO-CICS-LOG                           81180000
811900         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81190000
812000                ' 8500-UPDATE-UNITS-WRKD '                        81200000
812100                                    DELIMITED BY SIZE             81210000
812200                ' KEY INFO - '      DELIMITED BY SIZE             81220000
812300                PV-DISP-PO-NBR      DELIMITED BY SIZE             81230000
812400                ' - '               DELIMITED BY SIZE             81240000
812500                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             81250000
812600                ' - '               DELIMITED BY SIZE             81260000
812700                PV-DISP-LNE-NBR     DELIMITED BY SIZE             81270000
812800                             INTO PV-CICS-MSG-AREA                81280000
812900         MOVE LENGTH OF PV-CICS-MSG-AREA                          81290000
813000                               TO PV-COMMAREA-LENGTH              81300000
813100         PERFORM 9200-WRITE-TO-CICS-LOG                           81310000
813200         PERFORM 9900-SOFT-ABORT                                  81320000
813300     ELSE                                                         81330000
813400     IF  PC238-MOD-BAD-PO                                         81340000
813500         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81350000
813600                ' 8500-UPDATE-UNITS-WRKD '                        81360000
813700                                    DELIMITED BY SIZE             81370000
813800                ' BAD PO NUMBER '   DELIMITED BY SIZE             81380000
813900                PV-DISP-PO-NBR      DELIMITED BY SIZE             81390000
814000                             INTO PV-CICS-MSG-AREA                81400000
814100         MOVE LENGTH OF PV-CICS-MSG-AREA                          81410000
814200                               TO PV-COMMAREA-LENGTH              81420000
814300         PERFORM 9200-WRITE-TO-CICS-LOG                           81430000
814400         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81440000
814500                ' 8500-UPDATE-UNITS-WRKD '                        81450000
814600                                    DELIMITED BY SIZE             81460000
814700                ' KEY INFO - '      DELIMITED BY SIZE             81470000
814800                PV-DISP-PO-NBR      DELIMITED BY SIZE             81480000
814900                ' - '               DELIMITED BY SIZE             81490000
815000                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             81500000
815100                ' - '               DELIMITED BY SIZE             81510000
815200                PV-DISP-LNE-NBR     DELIMITED BY SIZE             81520000
815300                             INTO PV-CICS-MSG-AREA                81530000
815400         MOVE LENGTH OF PV-CICS-MSG-AREA                          81540000
815500                               TO PV-COMMAREA-LENGTH              81550000
815600         PERFORM 9200-WRITE-TO-CICS-LOG                           81560000
815700         PERFORM 9900-SOFT-ABORT                                  81570000
815800     ELSE                                                         81580000
815900     IF  PC238-MOD-BAD-RCVR                                       81590000
816000         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81600000
816100                ' 8500-UPDATE-UNITS-WRKD '                        81610000
816200                                    DELIMITED BY SIZE             81620000
816300                ' BAD RCVR NBR  '   DELIMITED BY SIZE             81630000
816400                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             81640000
816500                             INTO PV-CICS-MSG-AREA                81650000
816600         MOVE LENGTH OF PV-CICS-MSG-AREA                          81660000
816700                               TO PV-COMMAREA-LENGTH              81670000
816800         PERFORM 9200-WRITE-TO-CICS-LOG                           81680000
816900         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81690000
817000                ' 8500-UPDATE-UNITS-WRKD '                        81700000
817100                                    DELIMITED BY SIZE             81710000
817200                ' KEY INFO - '      DELIMITED BY SIZE             81720000
817300                PV-DISP-PO-NBR      DELIMITED BY SIZE             81730000
817400                ' - '               DELIMITED BY SIZE             81740000
817500                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             81750000
817600                ' - '               DELIMITED BY SIZE             81760000
817700                PV-DISP-LNE-NBR     DELIMITED BY SIZE             81770000
817800                             INTO PV-CICS-MSG-AREA                81780000
817900         MOVE LENGTH OF PV-CICS-MSG-AREA                          81790000
818000                               TO PV-COMMAREA-LENGTH              81800000
818100         PERFORM 9200-WRITE-TO-CICS-LOG                           81810000
818200         PERFORM 9900-SOFT-ABORT                                  81820000
818300     ELSE                                                         81830000
818400     IF  PC238-MOD-BAD-LINE                                       81840000
818500         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81850000
818600                ' 8500-UPDATE-UNITS-WRKD '                        81860000
818700                                    DELIMITED BY SIZE             81870000
818800                ' BAD LINE NBR  '   DELIMITED BY SIZE             81880000
818900                PV-DISP-LNE-NBR     DELIMITED BY SIZE             81890000
819000                             INTO PV-CICS-MSG-AREA                81900000
819100         MOVE LENGTH OF PV-CICS-MSG-AREA                          81910000
819200                               TO PV-COMMAREA-LENGTH              81920000
819300         PERFORM 9200-WRITE-TO-CICS-LOG                           81930000
819400         STRING ' RCKCS817 - '      DELIMITED BY SIZE             81940000
819500                ' 8500-UPDATE-UNITS-WRKD '                        81950000
819600                                    DELIMITED BY SIZE             81960000
819700                ' KEY INFO - '      DELIMITED BY SIZE             81970000
819800                PV-DISP-PO-NBR      DELIMITED BY SIZE             81980000
819900                ' - '               DELIMITED BY SIZE             81990000
820000                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             82000000
820100                ' - '               DELIMITED BY SIZE             82010000
820200                PV-DISP-LNE-NBR     DELIMITED BY SIZE             82020000
820300                             INTO PV-CICS-MSG-AREA                82030000
820400         MOVE LENGTH OF PV-CICS-MSG-AREA                          82040000
820500                               TO PV-COMMAREA-LENGTH              82050000
820600         PERFORM 9200-WRITE-TO-CICS-LOG                           82060000
820700         PERFORM 9900-SOFT-ABORT                                  82070000
820800     ELSE                                                         82080000
820900     IF  PC238-MOD-BAD-NO-SHIFT                                   82090000
821000         STRING ' RCKCS817 - '      DELIMITED BY SIZE             82100000
821100                ' 8500-UPDATE-UNITS-WRKD '                        82110000
821200                                    DELIMITED BY SIZE             82120000
821300                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             82130000
821400                PC238-WRKD-TMST     DELIMITED BY SIZE             82140000
821500                ' FOR OPER '        DELIMITED BY SIZE             82150000
821600                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             82160000
821700                             INTO PV-CICS-MSG-AREA                82170000
821800         MOVE LENGTH OF PV-CICS-MSG-AREA                          82180000
821900                               TO PV-COMMAREA-LENGTH              82190000
822000         PERFORM 9200-WRITE-TO-CICS-LOG                           82200000
822100         STRING ' RCKCS817 - '      DELIMITED BY SIZE             82210000
822200                ' 8500-UPDATE-UNITS-WRKD '                        82220000
822300                                    DELIMITED BY SIZE             82230000
822400                ' KEY INFO - '      DELIMITED BY SIZE             82240000
822500                PV-DISP-PO-NBR      DELIMITED BY SIZE             82250000
822600                ' - '               DELIMITED BY SIZE             82260000
822700                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             82270000
822800                ' - '               DELIMITED BY SIZE             82280000
822900                PV-DISP-LNE-NBR     DELIMITED BY SIZE             82290000
823000                             INTO PV-CICS-MSG-AREA                82300000
823100         MOVE LENGTH OF PV-CICS-MSG-AREA                          82310000
823200                               TO PV-COMMAREA-LENGTH              82320000
823300         PERFORM 9200-WRITE-TO-CICS-LOG                           82330000
823400         PERFORM 9900-SOFT-ABORT                                  82340000
823500     ELSE                                                         82350000
823600         STRING ' RCKCS817 - '      DELIMITED BY SIZE             82360000
823700                ' 8500-UPDATE-UNITS-WRKD '                        82370000
823800                                    DELIMITED BY SIZE             82380000
823900                ' DB ERROR - SQL CODE '                           82390000
824000                                    DELIMITED BY SIZE             82400000
824100                PV-DISPLAY-SQL-CODE DELIMITED BY SIZE             82410000
824200                ' FUNC: '           DELIMITED BY SIZE             82420000
824300                PC238-BAD-TABLE-FUNCTION                          82430000
824400                                    DELIMITED BY SIZE             82440000
824500                ' TABLE: '          DELIMITED BY SIZE             82450000
824600                PC238-BAD-TABLE-NAME                              82460000
824700                                    DELIMITED BY SIZE             82470000
824800                             INTO PV-CICS-MSG-AREA                82480000
824900         MOVE LENGTH OF PV-CICS-MSG-AREA                          82490000
825000                               TO PV-COMMAREA-LENGTH              82500000
825100         PERFORM 9200-WRITE-TO-CICS-LOG                           82510000
825200         STRING ' RCKCS817 - '      DELIMITED BY SIZE             82520000
825300                ' 8500-UPDATE-UNITS-WRKD '                        82530000
825400                                    DELIMITED BY SIZE             82540000
825500                ' KEY INFO - '      DELIMITED BY SIZE             82550000
825600                PV-DISP-PO-NBR      DELIMITED BY SIZE             82560000
825700                ' - '               DELIMITED BY SIZE             82570000
825800                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             82580000
825900                ' - '               DELIMITED BY SIZE             82590000
826000                PV-DISP-LNE-NBR     DELIMITED BY SIZE             82600000
826100                             INTO PV-CICS-MSG-AREA                82610000
826200         MOVE LENGTH OF PV-CICS-MSG-AREA                          82620000
826300                               TO PV-COMMAREA-LENGTH              82630000
826400         PERFORM 9200-WRITE-TO-CICS-LOG                           82640000
826500         PERFORM 9900-SOFT-ABORT                                  82650000
826600     END-IF                                                       82660000
826700     END-IF                                                       82670000
826800     END-IF                                                       82680000
826900     END-IF                                                       82690000
827000     END-IF                                                       82700000
827100     END-IF                                                       82710000
827200     END-IF.                                                      82720000
827300                                                                  82730000
827400                                                                  82740000
827500 9000-CALL-PO-RCVR-TRKING-MOD.                                    82750000
827600                                                                  82760000
827700     INITIALIZE RC071-FIELDS.                                     82770000
827800     MOVE ASC-PO-NBR                TO RC071-PO-NBR               82780000
827900     MOVE ASC-REC-SEQ-NBR           TO RC071-PO-RCVR              82790000
828000     MOVE LQW-PACK-ID (LQW-IDX)     TO RC071-PREPK-ID             82800000
828100     MOVE ZEROES                    TO RC071-PO-LINE              82810000
828200     MOVE ASC-OPER-UNT-ID           TO RC071-SIGNON-LOCATION      82820000
828300     MOVE DP020-USERID              TO RC071-USER-ID              82830000
828400     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      82840000
828500     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    82850000
828600         MOVE '17'                      TO RC071-DC-FUNCTION-CODE 82860000
828700     ELSE                                                         82870000
828800         IF ASC-CONFIRM-UNVERIFY                                  82880000
828900             MOVE '19'                  TO RC071-DC-FUNCTION-CODE 82890000
829000         ELSE                                                     82900000
829100             MOVE '18'                  TO RC071-DC-FUNCTION-CODE 82910000
829200         END-IF                                                   82920000
829300     END-IF.                                                      82930000
829400                                                                  82940000
829500     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        82950000
829600                                                                  82960000
829700     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  82970000
829800                                        RC071-COMMAREA            82980000
829900                                        RC071-FIELDS.             82990000
830000                                                                  83000000
830100     IF RC071-SUCCESSFUL                                          83010000
830200         CONTINUE                                                 83020000
830300     ELSE                                                         83030000
830400         MOVE '9000-CALL-PO-RCVR-TRKING-MOD'                      83040000
830500                                 TO DP013-PARAGRAPH               83050000
830600         MOVE ASC-PO-NBR          TO PV-DISP-PO-NBR               83060000
830700         MOVE ASC-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR          83070000
830800         MOVE ASC-OPER-UNT-ID     TO PV-DISP-OPER-UNT-ID          83080000
830900         MOVE RC071-PREPK-ID      TO PV-DISP-PREPK-ID             83090000
831000         STRING ' RCKCS817-RC137'   DELIMITED BY SIZE             83100000
831100                ' RCVR: '           DELIMITED BY SIZE             83110000
831200                PV-DISP-PO-NBR      DELIMITED BY SIZE             83120000
831300                '-'                 DELIMITED BY SIZE             83130000
831400                PV-DISP-REC-SEQ-NBR                               83140000
831500                                    DELIMITED BY SIZE             83150000
831600                '  PACK: '          DELIMITED BY SIZE             83160000
831700                PV-DISP-PREPK-ID                                  83170000
831800                                    DELIMITED BY SIZE             83180000
831900                '  FCLTY: '         DELIMITED BY SIZE             83190000
832000                PV-DISP-OPER-UNT-ID                               83200000
832100                                    DELIMITED BY SIZE             83210000
832200                                 INTO PV-CICS-MSG-AREA            83220000
832300         MOVE LENGTH OF PV-CICS-MSG-AREA                          83230000
832400                                   TO PV-COMMAREA-LENGTH          83240000
832500         PERFORM 9200-WRITE-TO-CICS-LOG                           83250000
832600         MOVE 'UNSUCCESSFUL CALL TO TRACKING MOD'                 83260000
832700                                     TO DP013-MESSAGE-TEXT (1)    83270000
832800         MOVE RC071-CRA-RET-MSG      TO DP013-MESSAGE-TEXT (2)    83280000
832900         STRING ' OPER: '            DELIMITED BY SIZE            83290000
833000              PV-DISP-OPER-UNT-ID    DELIMITED BY SIZE            83300000
833100                ' RCVR: '            DELIMITED BY SIZE            83310000
833200              PV-DISP-PO-NBR         DELIMITED BY SIZE            83320000
833300              '-'                    DELIMITED BY SIZE            83330000
833400              PV-DISP-REC-SEQ-NBR    DELIMITED BY SIZE            83340000
833500              ' IND: '               DELIMITED BY SIZE            83350000
833600              RC071-SUCCESS-IND      DELIMITED BY SIZE            83360000
833700                               INTO DP013-MESSAGE-TEXT (3)        83370000
833800         STRING ' PACK: '            DELIMITED BY SIZE            83380000
833900              PV-DISP-PREPK-ID       DELIMITED BY SIZE            83390000
834000                               INTO DP013-MESSAGE-TEXT (4)        83400000
834100         MOVE '9000-CALL-PO-RCVR-TRKING-MOD'                      83410000
834200                                   TO DP013-PARAGRAPH             83420000
834300         SET DP013-XCTL-DISPLAY-RESTART                           83430000
834400             DP013-DB2-ABEND     TO TRUE                          83440000
834500         SET PS-ERROR                    TO TRUE                  83450000
834600         PERFORM DP013-0000-PROCESS-ABEND                         83460000
834700                                                                  83470000
834800      END-IF.                                                     83480000
834900                                                                  83490000
835000*----------------------------------------------------------------*83500000
835100 9200-WRITE-TO-CICS-LOG.                                          83510000
835200                                                                  83520000
835300     EXEC CICS                                                    83530000
835400          WRITEQ TD                                               83540000
835500          QUEUE  ('CSSL')                                         83550000
835600          FROM  (PV-CICS-MSG-AREA)                                83560000
835700          LENGTH  (PV-COMMAREA-LENGTH)                            83570000
835800          RESP  (PV-CICS-RESP)                                    83580000
835900     END-EXEC.                                                    83590000
836000                                                                  83600000
836100     MOVE SPACES TO PV-CICS-MSG-AREA.                             83610000
836200                                                                  83620000
836300******************************************************************83630000
836400*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *83640000
836500*    AND THE ERROR SWITCHES.                                     *83650000
836600******************************************************************83660000
836700 9900-SOFT-ABORT.                                                 83670000
836800     SET PS-ERROR         TO TRUE.                                83680000
836900     SET DP020-MSG-FATAL  TO TRUE.                                83690000
837000     IF SQLCODE = -913                                            83700000
837100         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 83710000
837200     END-IF.                                                      83720000
837300     IF PS-UPDATES-DONE                                           83730000
837400        PERFORM 9901-BACKUP                                       83740000
837500     END-IF.                                                      83750000
837600     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          83760000
837700     PERFORM 0001-CALL-CICS-ARCH-API.                             83770000
837800                                                                  83780000
837900 9901-BACKUP.                                                     83790000
838000     EXEC CICS SYNCPOINT                                          83800000
838100          ROLLBACK                                                83810000
838200     END-EXEC.                                                    83820000
838300                                                                  83830000
838400*----------------------------------------------------------------*83840000
838500*    ABEND PROCESSOR MODULE                                      *83850000
838600*----------------------------------------------------------------*83860000
838700                                                                  83870000
838800     COPY DPPD013.                                                83880000
