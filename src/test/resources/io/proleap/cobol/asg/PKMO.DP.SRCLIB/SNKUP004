00001  ID DIVISION.                                                     07/27/93
00002                                                                   SNKUP004
00003  PROGRAM-ID.    SNKUP004.                                            LV001
00004                                                                   SNKUP004
00005  AUTHOR.        GEORGE POWELL.                                    SNKUP004
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          SNKUP004
00007  DATE-WRITTEN.  MAY 19, 1992.                                     SNKUP004
00008  DATE-COMPILED.                                                   SNKUP004
00009                                                                   SNKUP004
00010 ******************************************************************SNKUP004
00011 *   THIS PROGRAM WILL SET THE PRINT INDICATOR FOR AN ASN HEADER **SNKUP004
00012 *   ROW TO 'Y' IF THE INDICATOR IS CURRENTLY AN 'N'.            **SNKUP004
00013 *                                                               **SNKUP004
00014 ******************************************************************SNKUP004
00015                                                                   SNKUP004
00016      EJECT                                                        SNKUP004
00017  ENVIRONMENT DIVISION.                                            SNKUP004
00018                                                                   SNKUP004
00019  INPUT-OUTPUT SECTION.                                            SNKUP004
00020                                                                   SNKUP004
00021  DATA DIVISION.                                                   SNKUP004
00022                                                                   SNKUP004
00023  FILE SECTION.                                                    SNKUP004
00024                                                                   SNKUP004
00025  EJECT                                                            SNKUP004
00026  WORKING-STORAGE SECTION.                                         SNKUP004
00027 *                                                                 SNKUP004
00028  01  FILLER.                                                      SNKUP004
00029      05  FILLER                    PIC  X(36)  VALUE              SNKUP004
00030          ' ***** WORKING STORAGE PGM=SNKUP004 '.                  SNKUP004
00031      05  PGM-COMPILED              PIC  X(20)  VALUE SPACE.       SNKUP004
00032      05  FILLER                    PIC  X(10)  VALUE              SNKUP004
00033                                                ' LOCATION='.      SNKUP004
00034      05  PGM-LOCATION              PIC  X(04)  VALUE SPACE.       SNKUP004
00035      05  FILLER                    PIC  X(06)  VALUE              SNKUP004
00036                                                ' *****'.          SNKUP004
00037  01  ABEND-CODE                    PIC S9(04)  VALUE ZERO         SNKUP004
00038                                                COMP SYNC.         SNKUP004
00039  01  ABEND-PARAGRAPH               PIC  X(30)  VALUE SPACE.       SNKUP004
00040 *                                                                 SNKUP004
00041  EJECT                                                            SNKUP004
00042  01  PM-PROGRAM-CONSTANTS.                                        SNKUP004
00043      05  PC-100                    PIC S9(04)  VALUE +100         SNKUP004
00044                                                COMP SYNC.         SNKUP004
00045      05  PC-ZERO                   PIC S9(05)  VALUE +0           SNKUP004
00046                                                COMP-3.            SNKUP004
00047      05  PC-N                      PIC  X(01)  VALUE 'N'.         SNKUP004
00048      05  PC-Y                      PIC  X(01)  VALUE 'Y'.         SNKUP004
00049  EJECT                                                            SNKUP004
00050 ******************************************************************SNKUP004
00051 *    DB2 DATABASE AREA                                            SNKUP004
00052 ******************************************************************SNKUP004
00053  EJECT                                                            SNKUP004
00054 *    DCLGEN ========= ASN HEADER TABLE                            SNKUP004
00055      EXEC SQL                                                     SNKUP004
00056          INCLUDE TASNHDR                                          SNKUP004
00057      END-EXEC.                                                    SNKUP004
00058  EJECT                                                            SNKUP004
00059 *    SQL COMMUNICATION AREA                                       SNKUP004
00060      EXEC SQL                                                     SNKUP004
00061          INCLUDE SQLCA                                            SNKUP004
00062      END-EXEC.                                                    SNKUP004
00063  EJECT                                                            SNKUP004
00064 *    SQL COMMUNICATION AREA 2                                     SNKUP004
00065      COPY SQLCA2.                                                 SNKUP004
00066  EJECT                                                            SNKUP004
00067  PROCEDURE DIVISION.                                              SNKUP004
00068 *                                                                 SNKUP004
00069  A000-MAIN-DRIVER.                                                SNKUP004
00070      MOVE 'A000'                 TO PGM-LOCATION.                 SNKUP004
00071      MOVE WHEN-COMPILED          TO PGM-COMPILED.                 SNKUP004
00072 *                                                                 SNKUP004
00073      PERFORM W000-RESET-TASNHDR-PRINT-IND.                        SNKUP004
00074 *                                                                 SNKUP004
00075      GOBACK.                                                      SNKUP004
00076 *                                                                 SNKUP004
00077  EJECT                                                            SNKUP004
00078 ***************************************************************** SNKUP004
00079 *    THIS PARAGRAPH SETS ALL ASN PRINT INDICATORS TO 'Y' IF THE   SNKUP004
00080 *    INDICATOR IS CURRENTLY AN 'N'.                               SNKUP004
00081 ***************************************************************** SNKUP004
00082  W000-RESET-TASNHDR-PRINT-IND.                                    SNKUP004
00083 *                                                                 SNKUP004
00084      MOVE 'W000'                 TO PGM-LOCATION.                 SNKUP004
00085      MOVE 'W000-RESET-TASNHDR-PRINT-IND'                          SNKUP004
00086                                  TO ABEND-PARAGRAPH.              SNKUP004
00087 *                                                                 SNKUP004
00088      EXEC SQL                                                     SNKUP004
00089          UPDATE TASNHDR                                           SNKUP004
00090             SET PRINT_IND = :PC-Y                                 SNKUP004
00091             WHERE PRINT_IND = :PC-N                               SNKUP004
00092      END-EXEC.                                                    SNKUP004
00093 *                                                                 SNKUP004
00094      IF  SQLCODE < ZERO                                           SNKUP004
00095          PERFORM Z998-SQL-ERROR                                   SNKUP004
00096      END-IF.                                                      SNKUP004
00097 *                                                                 SNKUP004
00098  EJECT                                                            SNKUP004
00099 ***************************************************************** SNKUP004
00100 *    THIS MODULE PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT  SNKUP004
00101 *    THAT AN SQL ERROR CODE OCCURS.                               SNKUP004
00102 ***************************************************************** SNKUP004
00103  Z998-SQL-ERROR.                                                  SNKUP004
00104      DISPLAY 'Z998'.                                              SNKUP004
00105      MOVE SQLCODE                TO SQLCODE2.                     SNKUP004
00106      MOVE SQLERRD(3)             TO SQLERRD3.                     SNKUP004
00107      DISPLAY '** ABEND **         ** = SQLERROR'.                 SNKUP004
00108      DISPLAY '** PROGRAM          ** = SNKUP004'.                 SNKUP004
00109      DISPLAY '** PARAGRAPH        ** = ' ABEND-PARAGRAPH.         SNKUP004
00110      DISPLAY '** SQLCODE          ** = ' SQLCODE2.                SNKUP004
00111      DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                SNKUP004
00112      DISPLAY '** SQLERRM          ** = ' SQLERRM.                 SNKUP004
00113      DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                SNKUP004
00114      MOVE +4013                  TO ABEND-CODE.                   SNKUP004
00115      CALL 'ILBOABN0'             USING ABEND-CODE.                SNKUP004
