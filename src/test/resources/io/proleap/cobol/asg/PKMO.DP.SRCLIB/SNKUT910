000100******************************************************************00010019
000200 IDENTIFICATION DIVISION.                                         00020019
000300******************************************************************00030019
000400                                                                  00040019
000500 PROGRAM-ID.    SNKUT910.                                         00050019
000600 AUTHOR.        RON KRIER                                         00060019
000700 INSTALLATION.  KOHLS.                                            00070019
000800 DATE-WRITTEN   FEBRUARY, 2014.                                   00080019
000900 DATE-COMPILED.                                                   00090019
001000                                                                  00100019
001100******************************************************************00110019
001200*  THIS PROGRAM IS USED TO HELP BUILD TEST ASN DATA FROM THE      00120019
001300*  PO'S BEING REQUESTED ON THE INPUT FILE.                        00130019
001400*  THIS PROGRAM WILL TAKE THIS INITIAL FILE AND GENERATE A FILE   00140019
001500*  AT THE DC/TRAILER LEVEL WHICH WILL THEN BE TAKEN INTO PROGRAM  00150019
001600*  SNKUT911 TO BUILD THE ACTUAL ASN DATA.                         00160019
001700*  THIS PROGRAM WILL EXPAND THE INITIAL REQUEST INTO A FILE THAT  00170019
001800*  WILL HAVE AN ENTRY FOR THE SPECIFIC DC'S FOR THE PO'S AND      00180019
001900*  WILL ALSO GROUP THE PO'S AT THE DC LEVEL BY THE TRAILER.       00190019
002000******************************************************************00200019
002100******************************************************************00210019
002200 ENVIRONMENT DIVISION.                                            00220019
002300******************************************************************00230019
002400                                                                  00240019
002500 CONFIGURATION SECTION.                                           00250019
002600                                                                  00260019
002700 SOURCE-COMPUTER.        IBM-3090.                                00270019
002800 OBJECT-COMPUTER.        IBM-3090.                                00280019
002900                                                                  00290019
003000 INPUT-OUTPUT SECTION.                                            00300019
003100                                                                  00310019
003200 FILE-CONTROL.                                                    00320019
003300                                                                  00330019
003400                                                                  00340019
003500     SELECT INPUT-FILE                                            00350019
003600         ASSIGN TO INP01.                                         00360019
003700                                                                  00370019
003800     SELECT OUTPUT-FILE                                           00380019
003900         ASSIGN TO OUT01.                                         00390019
004000******************************************************************00400019
004100 DATA DIVISION.                                                   00410019
004200******************************************************************00420019
004300                                                                  00430019
004400 FILE SECTION.                                                    00440019
004500                                                                  00450019
004600 FD  INPUT-FILE                                                   00460019
004700     RECORDING MODE IS F                                          00470019
004800     LABEL RECORDS ARE STANDARD                                   00480019
004900     BLOCK CONTAINS 0 RECORDS.                                    00490019
005000                                                                  00500019
005100 01  INPUT-RECORD                     PIC   X(80).                00510019
005200                                                                  00520019
005300 FD  OUTPUT-FILE                                                  00530019
005400     RECORDING MODE IS F                                          00540019
005500     LABEL RECORDS ARE STANDARD                                   00550019
005600     RECORD CONTAINS 80                                           00560019
005700     BLOCK CONTAINS 0 RECORDS                                     00570019
005800     DATA RECORD IS OUTPUT-RECORD.                                00580019
005900                                                                  00590019
006000 01  OUTPUT-RECORD                    PIC   X(80).                00600019
006100*                                                                 00610019
006200******************************************************************00620019
006300 WORKING-STORAGE SECTION.                                         00630019
006400******************************************************************00640019
006500*                                                                 00650019
006600 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00660019
006700                                                   COMP SYNC.     00670019
006800                                                                  00680019
006900 01  PS-PROGRAM-SWITCHES.                                         00690019
007000     05  PS-EOF-INPUT-SW             PIC  X(01)    VALUE 'N'.     00700019
007100         88  PS-EOF-INPUT                          VALUE 'Y'.     00710019
007200         88  PS-MORE-INPUT                         VALUE 'N'.     00720019
007300     05  PS-PRINT-INFO-SW            PIC  X(01)    VALUE 'N'.     00730019
007400         88  PS-PRINT-INFO                         VALUE 'Y'.     00740019
007500         88  PS-NOT-PRINT-INFO                     VALUE 'N'.     00750019
007600     05  PS-INBOUND-LINE-SW          PIC  X(01)    VALUE 'N'.     00760019
007700         88  PS-INBOUND-LINE-FOUND                 VALUE 'Y'.     00770019
007800         88  PS-INBOUND-LINE-NOT-FOUND             VALUE 'N'.     00780019
007900     05  PS-EOF-CURSOR-SW            PIC  X(01)    VALUE 'N'.     00790019
008000         88  PS-EOF-CURSOR                         VALUE 'Y'.     00800019
008100         88  PS-NOT-EOF-CURSOR                     VALUE 'N'.     00810019
008200                                                                  00820019
008300 01  PC-PROGRAM-CONSTANTS.                                        00830019
008400     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     00840019
008500                                                   COMP SYNC.     00850019
008600     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00860019
008700         'SNKUT910'.                                              00870019
008800     05  PC-CURRENT-OPERATING-COMPANY                             00880019
008900                                     PIC  X(02)    VALUE '03'.    00890019
009000     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       00900019
009100                                                   COMP SYNC.     00910019
009200     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  00920019
009300                                                                  00930019
009400                                                                  00940019
009410 01  PV-PROGRAM-VARIABLES.                                        00941019
009420     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    00942019
009430     05  PV-NUM-FIELD                PIC  9(06)    VALUE ZERO.    00943019
009440     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  00944019
009450     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00945019
009460     05  PV-INPUT-COUNTER            PIC S9(09)    VALUE ZERO     00946019
009470                                                   COMP SYNC.     00947019
009480     05  PV-INPUT-DISPLAY-COUNTER    PIC S9(09)    VALUE ZERO     00948019
009490                                                   COMP SYNC.     00949019
009500     05  PV-OUTPUT-COUNTER           PIC S9(09)    VALUE ZERO     00950019
009600                                                   COMP SYNC.     00960019
009700     05  PV-MULT-PKITEM-COUNTER      PIC S9(09)    VALUE ZERO     00970019
009800                                                   COMP SYNC.     00980019
009900     05  PV-NO-PKITEM-COUNTER        PIC S9(09)    VALUE ZERO     00990019
010000                                                   COMP SYNC.     01000019
010100     05  PV-YES-PKITEM-COUNTER       PIC S9(09)    VALUE ZERO     01010019
010200                                                   COMP SYNC.     01020019
010300     05  PV-NO-MATCH-INBOUND-COUNTER PIC S9(09)    VALUE ZERO     01030019
010400                                                   COMP SYNC.     01040019
010500     05  PV-MATCH-INBOUND-COUNTER    PIC S9(09)    VALUE ZERO     01050019
010600                                                   COMP SYNC.     01060019
010700     05  PV-YES-INBOUND-COUNTER      PIC S9(09)    VALUE ZERO     01070019
010800                                                   COMP SYNC.     01080019
010900     05  PV-NO-INBOUND-COUNTER       PIC S9(09)    VALUE ZERO     01090019
011000                                                   COMP SYNC.     01100019
011100     05  PV-MULT-INBOUND-COUNTER     PIC S9(09)    VALUE ZERO     01110019
011200                                                   COMP SYNC.     01120019
011300     05  PV-MATCH-COUNTER            PIC S9(09)    VALUE ZERO     01130019
011400                                                   COMP SYNC.     01140019
011500     05  PV-MISMATCH-COUNTER         PIC S9(09)    VALUE ZERO     01150019
011600                                                   COMP SYNC.     01160019
011700     05  PV-MULT-DATA-COUNTER        PIC S9(09)    VALUE ZERO     01170019
011800                                                   COMP SYNC.     01180019
011900     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             01190019
012000                                                                  01200019
012100     05  PV-TEMP-FIELD               PIC S9(09)    VALUE ZERO     01210019
012200                                                   COMP SYNC.     01220019
012300     05  PV-IO-TOT-PKSLP-ITM-QTY     PIC S9(09)    VALUE ZERO     01230019
012400                                                   COMP SYNC.     01240019
012500     05  PV-IO-TOT-NBR-OF-CRTNS      PIC S9(09)    VALUE ZERO     01250019
012600                                                   COMP SYNC.     01260019
012700     05  PV-IO-TOT-CRSDCK-CRTN-QTY   PIC S9(09)    VALUE ZERO     01270019
012800                                                   COMP SYNC.     01280019
012900     05  PV-IO-TOT-P2L-CRTN-QTY      PIC S9(09)    VALUE ZERO     01290019
013000                                                   COMP SYNC.     01300019
013100     05  PV-IO-TOT-HRTW-CRTN-QTY     PIC S9(09)    VALUE ZERO     01310019
013200                                                   COMP SYNC.     01320019
013300     05  PV-IO-TOT-JWLRY-CRTN-QTY    PIC S9(09)    VALUE ZERO     01330019
013400                                                   COMP SYNC.     01340019
013500     05  PV-IO-TOT-CRSDCK-UNIT-QTY   PIC S9(09)    VALUE ZERO     01350019
013600                                                   COMP SYNC.     01360019
013700     05  PV-IO-TOT-P2L-UNIT-QTY      PIC S9(09)    VALUE ZERO     01370019
013800                                                   COMP SYNC.     01380019
013900     05  PV-IO-TOT-HRTW-UNIT-QTY     PIC S9(09)    VALUE ZERO     01390019
014000                                                   COMP SYNC.     01400019
014100     05  PV-IO-TOT-JWLRY-UNIT-QTY    PIC S9(09)    VALUE ZERO     01410019
014200                                                   COMP SYNC.     01420019
014300                                                                  01430019
014400     05  PV-IN-TOT-PKSLP-ITM-QTY     PIC S9(09)    VALUE ZERO     01440019
014500                                                   COMP SYNC.     01450019
014600     05  PV-IN-TOT-NBR-OF-CRTNS      PIC S9(09)    VALUE ZERO     01460019
014700                                                   COMP SYNC.     01470019
014800     05  PV-IN-TOT-CRSDCK-CRTN-QTY   PIC S9(09)    VALUE ZERO     01480019
014900                                                   COMP SYNC.     01490019
015000     05  PV-IN-TOT-P2L-CRTN-QTY      PIC S9(09)    VALUE ZERO     01500019
015100                                                   COMP SYNC.     01510019
015200     05  PV-IN-TOT-HRTW-CRTN-QTY     PIC S9(09)    VALUE ZERO     01520019
015300                                                   COMP SYNC.     01530019
015400     05  PV-IN-TOT-JWLRY-CRTN-QTY    PIC S9(09)    VALUE ZERO     01540019
015500                                                   COMP SYNC.     01550019
015600     05  PV-IN-TOT-CRSDCK-UNIT-QTY   PIC S9(09)    VALUE ZERO     01560019
015700                                                   COMP SYNC.     01570019
015800     05  PV-IN-TOT-P2L-UNIT-QTY      PIC S9(09)    VALUE ZERO     01580019
015900                                                   COMP SYNC.     01590019
016000     05  PV-IN-TOT-HRTW-UNIT-QTY     PIC S9(09)    VALUE ZERO     01600019
016100                                                   COMP SYNC.     01610019
016200     05  PV-IN-TOT-JWLRY-UNIT-QTY    PIC S9(09)    VALUE ZERO     01620019
016300                                                   COMP SYNC.     01630019
016400     05  PV-SHPD-QTY                 PIC  9(07)    VALUE ZEROS.   01640019
016500                                                                  01650019
016600     05  PV-PKSL-ITM-QTY             PIC  9(07)    VALUE ZEROS.   01660019
016700                                                                  01670019
016800     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     01680019
016900                                                   COMP-3.        01690019
017000     05  PV-DISPLAY-OPER              PIC 9(04)     VALUE ZERO.   01700019
017100     05  PV-DISPLAY-PO                PIC 9(09)     VALUE ZERO.   01710019
017200     05  PV-DISPLAY-LINE              PIC 9(03)     VALUE ZERO.   01720019
017300     05  PV-DISPLAY-SEQ-NBR           PIC 9(09)     VALUE ZERO.   01730019
017400     05  PV-DISPLAY-ITEM-NBR          PIC 9(18)     VALUE ZERO.   01740019
017500     05  PV-DISPLAY-SKU-NBR           PIC 9(08)     VALUE ZERO.   01750019
017600     05  PV-DISPLAY-ERROR-NBR         PIC 9(02)     VALUE ZERO.   01760019
017700     05  PV-DISPLAY-LOC-NBR           PIC 9(04)     VALUE ZERO.   01770019
017800     05  PV-DISPLAY-OPER-UNT          PIC 9(04)     VALUE ZERO.   01780019
017900     05  PV-DISPLAY-FIELD             PIC ZZZZZZZZ9 VALUE ZERO.   01790019
018000     05  PV-DISPLAY-FIELD-2           PIC ZZZZZZZZ9 VALUE ZERO.   01800019
018100     05  PV-DISPLAY-FIELD-3           PIC ZZZZZZZZ9 VALUE ZERO.   01810019
018200     05  PV-DISPLAY-TEXT-FIELD        PIC X(30)     VALUE SPACES. 01820019
018300                                                                  01830019
018400 01  PV-ABEND-FIELDS.                                             01840019
018500     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         01850019
018600                                                 COMP SYNC.       01860019
018700     05  PV-SQLCODE                   PIC  Z(08)9-.               01870019
018800     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01880019
018900     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01890019
019000     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    01900019
019100     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    01910019
019200     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01920019
019300     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01930019
019400     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01940019
019500     05  PV-DB2-TABLE-NAME-1          PIC  X(15) VALUE SPACE.     01950019
019600     05  PV-DB2-TABLE-NAME-2          PIC  X(15) VALUE SPACE.     01960019
019700     05  PV-DB2-TABLE-NAME-3          PIC  X(15) VALUE SPACE.     01970019
019800     05  PV-DB2-TABLE-NAME-4          PIC  X(15) VALUE SPACE.     01980019
019900                                                                  01990019
020000 01  PV-INPUT.                                                    02000019
020100     05  FILLER                       PIC  X(01) VALUE SPACES.    02010019
020200     05  PVI-DC-NBR                   PIC  9(04) VALUE ZEROS.     02020019
020300     05  FILLER                       PIC  X(01) VALUE SPACES.    02030019
020400     05  PVI-TRAILER-NBR              PIC  9(04) VALUE ZEROS.     02040019
020500     05  FILLER                       PIC  X(01) VALUE SPACES.    02050019
020600     05  PVI-PO-NBR                   PIC  9(08) VALUE ZEROS.     02060019
020700     05  FILLER                       PIC  X(01) VALUE SPACES.    02070019
020800     05  PVI-PERCENT-OF-PO-UNITS      PIC  9(03) VALUE ZEROS.     02080019
020900         88  PVI-ALL-PO-UNITS                    VALUE 100.       02090019
021000     05  FILLER                       PIC  X(01) VALUE SPACE.     02100019
021100     05  PVI-PREPACK-ASN-BUILD-CDE    PIC  X(01) VALUE ZEROS.     02110019
021200         88 PVI-BUILD-PACK-AND-COMP              VALUE 'A'.       02120019
021300         88 PVI-BUILD-PACK-ONLY                  VALUE 'B'.       02130019
021400         88 PVI-BUILD-COMP-ONLY                  VALUE 'C'.       02140019
021500     05  FILLER                       PIC  X(01) VALUE SPACE.     02150019
021600     05  PVI-BULK-CASE-ASN-BUILD-CDE  PIC  X(01) VALUE ZEROS.     02160019
021700         88 PVI-BUILD-PICK-PACK                  VALUE 'P'.       02170019
021800         88 PVI-BUILD-STANDARD-PACK              VALUE 'S'.       02180019
021900     05  FILLER                       PIC  X(01) VALUE SPACE.     02190019
022000     05  PVI-BUILD-AS-PBS-ASN-CDE     PIC  X(01) VALUE ZEROS.     02200019
022100         88 PVI-BUILD-AS-PBS-ASN                 VALUE 'Y'.       02210019
022200     05  FILLER                       PIC  X(01) VALUE SPACE.     02220019
022300     05  PVI-PACK-RAT-LNE1-DF-NBR     PIC  9(03) VALUE ZEROS.     02230019
022400     05  FILLER                       PIC  X(01) VALUE SPACE.     02240019
022500     05  PVI-PACK-RAT-LNE1-DF-CDE     PIC  X(01) VALUE SPACE.     02250019
022600         88 PVI-PACK-RAT-LNE1-DF-PLUS            VALUE 'P'.       02260019
022700         88 PVI-PACK-RAT-LNE1-DF-NEG             VALUE 'N'.       02270019
022800     05  FILLER                       PIC  X(01) VALUE SPACE.     02280019
022900     05  PVI-PACK-RAT-LNE1-DF-QTY     PIC  9(03) VALUE ZEROS.     02290019
023000     05  FILLER                       PIC  X(01) VALUE SPACE.     02300019
023100     05  PVI-PACK-RAT-LNE2-DF-NBR     PIC  9(03) VALUE ZEROS.     02310019
023200     05  FILLER                       PIC  X(01) VALUE SPACE.     02320019
023300     05  PVI-PACK-RAT-LNE2-DF-CDE     PIC  X(01) VALUE SPACE.     02330019
023400         88 PVI-PACK-RAT-LNE2-DF-PLUS            VALUE 'P'.       02340019
023500         88 PVI-PACK-RAT-LNE2-DF-NEG             VALUE 'N'.       02350019
023600     05  FILLER                       PIC  X(01) VALUE SPACE.     02360019
023700     05  PVI-PACK-RAT-LNE2-DF-QTY     PIC  9(03) VALUE ZEROS.     02370019
023800     05  FILLER                       PIC  X(01) VALUE SPACE.     02380019
023900     05  PVI-PACK-COMP-BYPASS-LNE-NBR PIC  9(03) VALUE ZEROS.     02390019
024000     05  FILLER                       PIC  X(01) VALUE SPACE.     02400019
024100     05  PVI-PACK-COMP-RPLACE-LNE-NBR PIC  9(03) VALUE ZEROS.     02410019
024200* DMH 3/9/16 - ADDED FOR CARRIER PACKAGE ID                       02420019
024300     05  FILLER                       PIC  X(01) VALUE SPACE.     02430019
024400     05  PVI-GENERATE-CARR-TRACK      PIC  X(01) VALUE SPACE.     02440019
024500         88  PVI-NO-CARR-TRACK-NO                VALUE 'N' ' '.   02450019
024600         88  PVI-GENERATE-UPS-TRACK              VALUE 'U'.       02460019
024700* DMH 3/9/16                                                      02470019
024800     05  FILLER                       PIC  X(21) VALUE SPACE.     02480019
024900                                                                  02490019
025000 01  PV-OUTPUT.                                                   02500019
025100     05  FILLER                       PIC  X(01) VALUE SPACES.    02510019
025200     05  PVO-DC-NBR                   PIC  9(04) VALUE ZEROS.     02520019
025300     05  FILLER                       PIC  X(01) VALUE SPACES.    02530019
025400     05  PVO-TRAILER-NBR              PIC  9(08) VALUE ZEROS.     02540019
025500     05  FILLER                       PIC  X(01) VALUE SPACES.    02550019
025600     05  PVO-PO-NBR                   PIC  9(08) VALUE ZEROS.     02560019
025700     05  FILLER                       PIC  X(01) VALUE SPACES.    02570019
025800     05  PVO-PERCENT-OF-PO-UNITS      PIC  9(03) VALUE ZEROS.     02580019
025900         88  PVO-ALL-PO-UNITS                    VALUE 100.       02590019
026000     05  FILLER                       PIC  X(01) VALUE SPACE.     02600019
026100     05  PVO-PREPACK-ASN-BUILD-CDE    PIC  X(01) VALUE ZEROS.     02610019
026200         88 PVO-BUILD-PACK-AND-COMP              VALUE 'A'.       02620019
026300         88 PVO-BUILD-PACK-ONLY                  VALUE 'B'.       02630019
026400         88 PVO-BUILD-COMP-ONLY                  VALUE 'C'.       02640019
026500     05  FILLER                       PIC  X(01) VALUE SPACE.     02650019
026600     05  PVO-ID-SEGMENT-STRUC-CDE     PIC  X(04) VALUE ZEROS.     02660019
026700         88 PVO-ID-SEG-STRUC-PICK-PACK           VALUE '0001'.    02670019
026800         88 PVO-ID-SEG-STRUC-STANDARD            VALUE '0002'.    02680019
026900     05  FILLER                       PIC  X(01) VALUE SPACE.     02690019
027000     05  PVO-ENT-ID                   PIC  9(09) VALUE ZEROS.     02700019
027100     05  FILLER                       PIC  X(01) VALUE SPACE.     02710019
027200     05  PVO-BUILD-AS-PBS-ASN-CDE     PIC  X(01) VALUE ZEROS.     02720019
027300         88 PVO-BUILD-AS-PBS-ASN                 VALUE 'Y'.       02730019
027400     05  FILLER                       PIC  X(01) VALUE SPACE.     02740019
027500     05  PVO-PACK-RAT-LNE1-DF-NBR     PIC  9(03) VALUE ZEROS.     02750019
027600     05  FILLER                       PIC  X(01) VALUE SPACE.     02760019
027700     05  PVO-PACK-RAT-LNE1-DF-CDE     PIC  X(01) VALUE SPACE.     02770019
027800         88 PVO-PACK-RAT-LNE1-DF-PLUS            VALUE 'P'.       02780019
027900         88 PVO-PACK-RAT-LNE1-DF-NEG             VALUE 'N'.       02790019
028000     05  FILLER                       PIC  X(01) VALUE SPACE.     02800019
028100     05  PVO-PACK-RAT-LNE1-DF-QTY     PIC  9(03) VALUE ZEROS.     02810019
028200     05  FILLER                       PIC  X(01) VALUE SPACE.     02820019
028300     05  PVO-PACK-RAT-LNE2-DF-NBR     PIC  9(03) VALUE ZEROS.     02830019
028400     05  FILLER                       PIC  X(01) VALUE SPACE.     02840019
028500     05  PVO-PACK-RAT-LNE2-DF-CDE     PIC  X(01) VALUE SPACE.     02850019
028600         88 PVO-PACK-RAT-LNE2-DF-PLUS            VALUE 'P'.       02860019
028700         88 PVO-PACK-RAT-LNE2-DF-NEG             VALUE 'N'.       02870019
028800     05  FILLER                       PIC  X(01) VALUE SPACE.     02880019
028900     05  PVO-PACK-RAT-LNE2-DF-QTY     PIC  9(03) VALUE ZEROS.     02890019
029000     05  FILLER                       PIC  X(01) VALUE SPACE.     02900019
029100     05  PVO-PACK-COMP-BYPASS-LNE-NBR PIC  9(03) VALUE ZEROS.     02910019
029200     05  FILLER                       PIC  X(01) VALUE SPACE.     02920019
029300     05  PVO-PACK-COMP-RPLACE-LNE-NBR PIC  9(03) VALUE ZEROS.     02930019
029400* DMH 3/9/16 - ADDED FOR CARRIER PACKAGE ID                       02940019
029500     05  FILLER                       PIC  X(01) VALUE SPACE.     02950019
029600     05  PVO-GENERATE-CARR-TRACK      PIC  X(01) VALUE SPACE.     02960019
029610         88  PVO-NO-CARR-TRACK-NO                VALUE 'N' ' '.   02961019
029620         88  PVO-GENERATE-UPS-TRACK              VALUE 'U'.       02962019
029630* DMH 3/9/16                                                      02963019
029640     05  FILLER                       PIC  X(04) VALUE SPACE.     02964019
029650                                                                  02965019
029660                                                                  02966019
029670 01  SD-SYSTEM-DATE.                                              02967019
029680     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  02968019
029690     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  02969019
029700     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  02970019
029800                                                                  02980019
029900 01  DK-DB-KEYS.                                                  02990019
030000     05 DK-PO-NBR                     PIC S9(09) COMP.            03000019
030100     05 DK-PO-LNE-NBR                 PIC S9(09) COMP.            03010019
030200     05 DK-LOC-NBR                    PIC S9(04) COMP.            03020019
030300                                                                  03030019
030400******************************************************************03040019
030500*  DB2 FORMATTED MESSAGE AREA                                     03050019
030600******************************************************************03060019
030700     COPY DPWS004.                                                03070019
030800*                                                                 03080019
030900******************************************************************03090019
031000*  COMMUNICATIONS AREA FOR DB2                                    03100019
031100******************************************************************03110019
031200     EXEC SQL                                                     03120019
031300          INCLUDE SQLCA                                           03130019
031400     END-EXEC.                                                    03140019
031500*                                                                 03150019
031600******************************************************************03160019
031700*   TPURCHS TABLE                                                 03170019
031800******************************************************************03180019
031900     EXEC SQL                                                     03190019
032000          INCLUDE TPURCHS                                         03200019
032100     END-EXEC.                                                    03210019
032200*                                                                 03220019
032300******************************************************************03230019
032400*   TPURITM TABLE                                                 03240019
032500******************************************************************03250019
032600     EXEC SQL                                                     03260019
032700          INCLUDE TPURITM                                         03270019
032800     END-EXEC.                                                    03280019
032810*                                                                 03281019
032900******************************************************************03290019
033000*   XLT_LOC TABLE                                                 03300019
033100******************************************************************03310019
033200     EXEC SQL                                                     03320019
033300          INCLUDE XLT00010                                        03330019
033400     END-EXEC.                                                    03340019
033500                                                                  03350019
033600                                                                  03360019
033700******************************************************************03370019
033800 PROCEDURE DIVISION.                                              03380019
033900******************************************************************03390019
034000                                                                  03400019
034100 0000-PROGRAM-MAINLINE.                                           03410019
034200******************************************************************03420019
034300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     03430019
034400*      PROGRAM.                                                   03440019
034500******************************************************************03450019
034600                                                                  03460019
034700     PERFORM 1000-INITIALIZE.                                     03470019
034800                                                                  03480019
034900     IF PS-MORE-INPUT                                             03490019
035000         PERFORM 2000-PROCESS-INPUT                               03500019
035100            UNTIL PS-EOF-INPUT                                    03510019
035200     END-IF.                                                      03520019
035300                                                                  03530019
035400     PERFORM 9000-EOJ-ROUTINE.                                    03540019
035500                                                                  03550019
035600     STOP RUN.                                                    03560019
035700                                                                  03570019
035800 1000-INITIALIZE.                                                 03580019
035900******************************************************************03590019
036000*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    03600019
036100******************************************************************03610019
036200                                                                  03620019
036300     OPEN INPUT INPUT-FILE.                                       03630019
036400     OPEN OUTPUT OUTPUT-FILE.                                     03640019
036500     PERFORM 8000-READ-INPUT.                                     03650019
036600                                                                  03660019
036700 2000-PROCESS-INPUT.                                              03670019
036800******************************************************************03680019
036900*  PROCESS THE FILE AND COMPARE THE FIELDS                        03690019
037000******************************************************************03700019
037100                                                                  03710019
037200     MOVE PVI-PO-NBR      TO DK-PO-NBR.                           03720019
037300     PERFORM 3200-VALIDATE-PO.                                    03730019
037400     MOVE PVI-PO-NBR      TO PVO-PO-NBR.                          03740019
037500     MOVE PURCHS-ENT-ID   TO PVO-ENT-ID.                          03750019
037600                                                                  03760019
037700     IF  PURCHS-PKGNG-CDE = 'B'                                   03770019
037800     OR  PURCHS-PKGNG-CDE = 'C'                                   03780019
037900         IF  PVI-BUILD-PICK-PACK                                  03790019
038000             SET PVO-ID-SEG-STRUC-PICK-PACK TO TRUE               03800019
038100         ELSE                                                     03810019
038200             IF  PVI-BUILD-AS-PBS-ASN                             03820019
038300                 SET PVO-ID-SEG-STRUC-PICK-PACK TO TRUE           03830019
038400             ELSE                                                 03840019
038500                 SET PVO-ID-SEG-STRUC-STANDARD  TO TRUE           03850019
038600             END-IF                                               03860019
038700         END-IF                                                   03870019
038800     ELSE                                                         03880019
038900         SET PVO-ID-SEG-STRUC-PICK-PACK TO TRUE                   03890019
039000     END-IF.                                                      03900019
039100                                                                  03910019
039200     MOVE PVI-DC-NBR  TO DK-LOC-NBR.                              03920019
039300     PERFORM 3600-VALIDATE-LOC.                                   03930019
039400     MOVE PVI-DC-NBR TO PVO-DC-NBR.                               03940019
039500                                                                  03950019
039600     MOVE PVI-TRAILER-NBR TO PVO-TRAILER-NBR.                     03960019
039700                                                                  03970019
039800     MOVE PVI-PERCENT-OF-PO-UNITS TO PVO-PERCENT-OF-PO-UNITS.     03980019
039900     MOVE PVI-PREPACK-ASN-BUILD-CDE TO PVO-PREPACK-ASN-BUILD-CDE. 03990019
040000     MOVE PVI-BUILD-AS-PBS-ASN-CDE  TO PVO-BUILD-AS-PBS-ASN-CDE.  04000019
040100                                                                  04010019
040200     IF  PURCHS-PKGNG-CDE = 'M'                                   04020019
040300     OR  PURCHS-PKGNG-CDE = 'I'                                   04030019
040400         IF  PVI-PACK-RAT-LNE1-DF-NBR = 0                         04040019
040500         OR  PVI-PACK-RAT-LNE1-DF-NBR = SPACES                    04050019
040600             NEXT SENTENCE                                        04060019
040700         ELSE                                                     04070019
040800             MOVE PVI-PACK-RAT-LNE1-DF-NBR TO DK-PO-LNE-NBR       04080019
040900                                              PV-DISPLAY-LINE     04090019
041000             MOVE 'PVI-PACK-RAT-LNE1-DF-NBR'  TO                  04100019
041100                  PV-DISPLAY-TEXT-FIELD                           04110019
041200             PERFORM 4000-VALIDATE-LINE                           04120019
041300         END-IF                                                   04130019
041400     END-IF.                                                      04140019
041500                                                                  04150019
041600     IF  PURCHS-PKGNG-CDE = 'M'                                   04160019
041700     OR  PURCHS-PKGNG-CDE = 'I'                                   04170019
041800         IF  PVI-PACK-RAT-LNE2-DF-NBR = 0                         04180019
041900         OR  PVI-PACK-RAT-LNE2-DF-NBR = SPACES                    04190019
042000             NEXT SENTENCE                                        04200019
042100         ELSE                                                     04210019
042200             MOVE PVI-PACK-RAT-LNE2-DF-NBR TO DK-PO-LNE-NBR       04220019
042300                                              PV-DISPLAY-LINE     04230019
042310             MOVE 'PVI-PACK-RAT-LNE2-DF-NBR'  TO                  04231019
042320                  PV-DISPLAY-TEXT-FIELD                           04232019
042330             PERFORM 4000-VALIDATE-LINE                           04233019
042340         END-IF                                                   04234019
042350     END-IF.                                                      04235019
042360                                                                  04236019
042370     IF  PURCHS-PKGNG-CDE = 'M'                                   04237019
042380     OR  PURCHS-PKGNG-CDE = 'I'                                   04238019
042390         IF  PVI-PACK-COMP-BYPASS-LNE-NBR = 0                     04239019
042391         OR  PVI-PACK-COMP-BYPASS-LNE-NBR = SPACES                04239119
042392             NEXT SENTENCE                                        04239219
042393         ELSE                                                     04239319
042394             MOVE PVI-PACK-COMP-BYPASS-LNE-NBR TO DK-PO-LNE-NBR   04239419
042395                                                  PV-DISPLAY-LINE 04239519
042396             MOVE 'PVI-PACK-COMP-BYPASS-LNE-NBR' TO               04239619
042397                  PV-DISPLAY-TEXT-FIELD                           04239719
042398             PERFORM 4000-VALIDATE-LINE                           04239819
042399         END-IF                                                   04239919
042400     END-IF.                                                      04240019
042401                                                                  04240119
042402     IF  PURCHS-PKGNG-CDE = 'M'                                   04240219
042403     OR  PURCHS-PKGNG-CDE = 'I'                                   04240319
042404         IF  PVI-PACK-COMP-RPLACE-LNE-NBR = 0                     04240419
042405         OR  PVI-PACK-COMP-RPLACE-LNE-NBR = SPACES                04240519
042406             NEXT SENTENCE                                        04240619
042407         ELSE                                                     04240719
042408             MOVE PVI-PACK-COMP-RPLACE-LNE-NBR TO DK-PO-LNE-NBR   04240819
042409                                                  PV-DISPLAY-LINE 04240919
042410             MOVE 'PVI-PACK-COMP-RPLACE-LNE-NBR' TO               04241019
042411                  PV-DISPLAY-TEXT-FIELD                           04241119
042412             PERFORM 4000-VALIDATE-LINE                           04241219
042413         END-IF                                                   04241319
042414     END-IF.                                                      04241419
042415                                                                  04241519
042416     IF  PVI-PACK-RAT-LNE1-DF-NBR = SPACES                        04241619
042417         MOVE ZEROS TO PVO-PACK-RAT-LNE1-DF-NBR                   04241719
042418     ELSE                                                         04241819
042419         MOVE PVI-PACK-RAT-LNE1-DF-NBR  TO                        04241919
042420              PVO-PACK-RAT-LNE1-DF-NBR                            04242019
042430     END-IF.                                                      04243019
042440                                                                  04244019
042450     MOVE PVI-PACK-RAT-LNE1-DF-CDE  TO PVO-PACK-RAT-LNE1-DF-CDE.  04245019
042460                                                                  04246019
042470     IF  PVI-PACK-RAT-LNE1-DF-QTY = SPACES                        04247019
042480         MOVE ZEROS TO PVO-PACK-RAT-LNE1-DF-QTY                   04248019
042490     ELSE                                                         04249019
042500         MOVE PVI-PACK-RAT-LNE1-DF-QTY TO                         04250019
042510              PVO-PACK-RAT-LNE1-DF-QTY                            04251019
042520     END-IF.                                                      04252019
042530                                                                  04253019
042540     IF  PVI-PACK-RAT-LNE2-DF-NBR = SPACES                        04254019
042550         MOVE ZEROS TO PVO-PACK-RAT-LNE2-DF-NBR                   04255019
042560     ELSE                                                         04256019
042570         MOVE PVI-PACK-RAT-LNE2-DF-NBR  TO                        04257019
042580              PVO-PACK-RAT-LNE2-DF-NBR                            04258019
042590     END-IF.                                                      04259019
042600                                                                  04260019
042610     MOVE PVI-PACK-RAT-LNE2-DF-CDE  TO PVO-PACK-RAT-LNE2-DF-CDE.  04261019
042620                                                                  04262019
042630     IF  PVI-PACK-RAT-LNE2-DF-QTY = SPACES                        04263019
042640         MOVE ZEROS TO PVO-PACK-RAT-LNE2-DF-QTY                   04264019
042650     ELSE                                                         04265019
042660         MOVE PVI-PACK-RAT-LNE2-DF-QTY TO                         04266019
042670              PVO-PACK-RAT-LNE2-DF-QTY                            04267019
042680     END-IF.                                                      04268019
042690                                                                  04269019
042691     IF  PVI-PACK-COMP-BYPASS-LNE-NBR = SPACES                    04269119
042692         MOVE ZEROS TO PVO-PACK-COMP-BYPASS-LNE-NBR               04269219
042693     ELSE                                                         04269319
042694         MOVE PVI-PACK-COMP-BYPASS-LNE-NBR TO                     04269419
042695              PVO-PACK-COMP-BYPASS-LNE-NBR                        04269519
042696     END-IF.                                                      04269619
042697                                                                  04269719
042698     IF  PVI-PACK-COMP-RPLACE-LNE-NBR = SPACES                    04269819
042699         MOVE ZEROS TO PVO-PACK-COMP-RPLACE-LNE-NBR               04269919
042700     ELSE                                                         04270019
042800         MOVE PVI-PACK-COMP-RPLACE-LNE-NBR TO                     04280019
042900              PVO-PACK-COMP-RPLACE-LNE-NBR                        04290019
043000     END-IF.                                                      04300019
043100                                                                  04310019
043110* DMH                                                             04311019
043120     MOVE PVI-GENERATE-CARR-TRACK  TO  PVO-GENERATE-CARR-TRACK.   04312019
043130* DMH                                                             04313019
043140                                                                  04314019
043150                                                                  04315019
043160     PERFORM 8400-WRITE-OUTPUT-RECORD.                            04316019
043170                                                                  04317019
043180     PERFORM 8000-READ-INPUT.                                     04318019
043190                                                                  04319019
043200                                                                  04320019
043300******************************************************************04330019
043400* CHECK IF PO NUMBER ON INPUT IS A VALID PO NUMBER                04340019
043500******************************************************************04350019
043600 3200-VALIDATE-PO.                                                04360019
043700                                                                  04370019
043800      MOVE '3200-VALIDATE-PO       '      TO PV-ABEND-PARAGRAPH.  04380019
043900                                                                  04390019
044000      EXEC SQL                                                    04400019
044100                SELECT PO_NBR, PKGNG_CDE, ENT_ID                  04410019
044200                INTO  :PURCHS-PO-NBR                              04420019
044300                     ,:PURCHS-PKGNG-CDE                           04430019
044400                     ,:PURCHS-ENT-ID                              04440019
044500                FROM TPURCHS                                      04450019
044600                WHERE   PO_NBR         = :DK-PO-NBR               04460019
044700                  AND   VER_STATUS_CDE  = 'A'                     04470019
044800                WITH UR                                           04480019
044900      END-EXEC.                                                   04490019
045000                                                                  04500019
045100       EVALUATE TRUE                                              04510019
045200            WHEN SQLCODE = ZERO                                   04520019
045300                CONTINUE                                          04530019
045400            WHEN SQLCODE = +100                                   04540019
045500                MOVE  SQLCODE          TO  PV-SQLCODE             04550019
045600                MOVE 'VALIDATE PO - INVALID PO'                   04560019
045700                                     TO PV-DB2-OPERATION-MESSAGE-104570019
045800                STRING ' PO NUMBER -  '        DELIMITED BY SIZE  04580019
045900                       PVI-PO-NBR              DELIMITED BY SIZE  04590019
046000                                   INTO PV-DB2-OPERATION-MESSAGE-204600019
046100                MOVE 'TPURCHS'           TO PV-DB2-TABLE-NAME-1   04610019
046200                PERFORM 9999-SQL-ABEND                            04620019
046300            WHEN OTHER                                            04630019
046400                MOVE  SQLCODE          TO  PV-SQLCODE             04640019
046500                MOVE 'VALIDATE PO - DB ERROR  '                   04650019
046600                                     TO PV-DB2-OPERATION-MESSAGE-104660019
046700                STRING ' PO NUMBER -  '        DELIMITED BY SIZE  04670019
046800                       PVI-PO-NBR              DELIMITED BY SIZE  04680019
046900                                   INTO PV-DB2-OPERATION-MESSAGE-204690019
047000                MOVE 'TPURCHS'           TO PV-DB2-TABLE-NAME-1   04700019
047100                PERFORM 9999-SQL-ABEND                            04710019
047200        END-EVALUATE.                                             04720019
047300                                                                  04730019
047400                                                                  04740019
047500******************************************************************04750019
047600* CHECK IF DC NUMBER ON INPUT IS A VALID DC NUMBER                04760019
047700******************************************************************04770019
047800 3600-VALIDATE-LOC.                                               04780019
047900                                                                  04790019
048000      MOVE '3600-VALIDATE-LOC      '      TO PV-ABEND-PARAGRAPH.  04800019
048100                                                                  04810019
048200      EXEC SQL                                                    04820019
048300                SELECT LOC_NBR                                    04830019
048400                INTO  :XLT00010-LOC-NBR                           04840019
048500                FROM XLT_LOC                                      04850019
048600                WHERE   LOC_NBR        = :DK-LOC-NBR              04860019
048700                  AND   LOC_TYP_CDE    = 'DC'                     04870019
048800                WITH UR                                           04880019
048900      END-EXEC.                                                   04890019
049000                                                                  04900019
049100       EVALUATE TRUE                                              04910019
049200            WHEN SQLCODE = ZERO                                   04920019
049300                CONTINUE                                          04930019
049400            WHEN SQLCODE = +100                                   04940019
049500                MOVE  SQLCODE          TO  PV-SQLCODE             04950019
049600                MOVE 'VALIDATE DC - INVALID DC'                   04960019
049700                                     TO PV-DB2-OPERATION-MESSAGE-104970019
049800                STRING ' DC NUMBER -  '        DELIMITED BY SIZE  04980019
049900                       PVI-DC-NBR              DELIMITED BY SIZE  04990019
050000                                   INTO PV-DB2-OPERATION-MESSAGE-205000019
050100                MOVE 'XLT_LOC'           TO PV-DB2-TABLE-NAME-1   05010019
050200                PERFORM 9999-SQL-ABEND                            05020019
050300            WHEN OTHER                                            05030019
050400                MOVE  SQLCODE          TO  PV-SQLCODE             05040019
050500                MOVE 'VALIDATE DC - DB ERROR  '                   05050019
050600                                     TO PV-DB2-OPERATION-MESSAGE-105060019
050700                STRING ' DC NUMBER -  '        DELIMITED BY SIZE  05070019
050800                       PVI-DC-NBR              DELIMITED BY SIZE  05080019
050900                                   INTO PV-DB2-OPERATION-MESSAGE-205090019
051000                MOVE 'XLT_LOC'           TO PV-DB2-TABLE-NAME-1   05100019
051100                PERFORM 9999-SQL-ABEND                            05110019
051200        END-EVALUATE.                                             05120019
051300                                                                  05130019
051400                                                                  05140019
051500******************************************************************05150019
051600* CHECK IF LINE NUMBER ON IMPUT IS A VALID LINE NUMBER            05160019
051700******************************************************************05170019
051800 4000-VALIDATE-LINE.                                              05180019
051900                                                                  05190019
052000      MOVE '4000-VALIDATE-LINE     '      TO PV-ABEND-PARAGRAPH.  05200019
052100                                                                  05210019
052200      EXEC SQL                                                    05220019
052300                SELECT PO_NBR, PO_LNE_NBR                         05230019
052400                INTO  :PURITM-PO-NBR                              05240019
052500                     ,:PURITM-PO-LNE-NBR                          05250019
052600                FROM TPURITM                                      05260019
052700                WHERE   PO_NBR         = :DK-PO-NBR               05270019
052800                  AND   PO_LNE_NBR     = :DK-PO-LNE-NBR           05280019
052900                  AND   VER_STATUS_CDE  = 'A'                     05290019
053000                WITH UR                                           05300019
053100      END-EXEC.                                                   05310019
053200                                                                  05320019
053300       EVALUATE TRUE                                              05330019
053400            WHEN SQLCODE = ZERO                                   05340019
053500                CONTINUE                                          05350019
053600            WHEN SQLCODE = +100                                   05360019
053700                MOVE  SQLCODE          TO  PV-SQLCODE             05370019
053800                MOVE 'VALIDATE LINE - INVALID LINE'               05380019
053900                                     TO PV-DB2-OPERATION-MESSAGE-105390019
054000                STRING ' PO NUMBER -  '        DELIMITED BY SIZE  05400019
054100                       PVI-PO-NBR              DELIMITED BY SIZE  05410019
054200                       ' LINE NUMBER - '       DELIMITED BY SIZE  05420019
054300                       PV-DISPLAY-LINE         DELIMITED BY SIZE  05430019
054400                                   INTO PV-DB2-OPERATION-MESSAGE-205440019
054500                STRING ' INPUT LINE FIELD - '  DELIMITED BY SIZE  05450019
054600                       PV-DISPLAY-TEXT-FIELD   DELIMITED BY SIZE  05460019
054700                                   INTO PV-DB2-OPERATION-MESSAGE-305470019
054800                MOVE 'TPURITM'           TO PV-DB2-TABLE-NAME-1   05480019
054900                PERFORM 9999-SQL-ABEND                            05490019
055000            WHEN OTHER                                            05500019
055100                MOVE  SQLCODE          TO  PV-SQLCODE             05510019
055200                MOVE 'VALIDATE LINE - DB ERROR  '                 05520019
055300                                     TO PV-DB2-OPERATION-MESSAGE-105530019
055400                STRING ' PO NUMBER -  '        DELIMITED BY SIZE  05540019
055500                       PVI-PO-NBR              DELIMITED BY SIZE  05550019
055600                       ' LINE NUMBER - '       DELIMITED BY SIZE  05560019
055610                       PV-DISPLAY-LINE         DELIMITED BY SIZE  05561019
055620                                   INTO PV-DB2-OPERATION-MESSAGE-205562019
055630                STRING ' INPUT LINE FIELD - '  DELIMITED BY SIZE  05563019
055640                       PV-DISPLAY-TEXT-FIELD   DELIMITED BY SIZE  05564019
055650                                   INTO PV-DB2-OPERATION-MESSAGE-305565019
055660                MOVE 'TPURITM'           TO PV-DB2-TABLE-NAME-1   05566019
055670                PERFORM 9999-SQL-ABEND                            05567019
055680        END-EVALUATE.                                             05568019
055690                                                                  05569019
055700                                                                  05570019
055800 8000-READ-INPUT.                                                 05580019
055900******************************************************************05590019
056000*  READ THE INPUT FILE                                            05600019
056100******************************************************************05610019
056200     READ INPUT-FILE                                              05620019
056300          INTO PV-INPUT                                           05630019
056400          AT END                                                  05640019
056500             SET PS-EOF-INPUT TO TRUE.                            05650019
056600                                                                  05660019
056700     IF PS-EOF-INPUT                                              05670019
056800        CONTINUE                                                  05680019
056900     ELSE                                                         05690019
057000        ADD +1 TO PV-INPUT-COUNTER                                05700019
057100     END-IF.                                                      05710019
057200                                                                  05720019
057300******************************************************************05730019
057400* WRITES TO THE OUTPUT FILE                                       05740019
057500******************************************************************05750019
057600 8400-WRITE-OUTPUT-RECORD.                                        05760019
057700                                                                  05770019
057800     WRITE OUTPUT-RECORD                                          05780019
057900        FROM PV-OUTPUT.                                           05790019
058000        ADD  1  TO  PV-OUTPUT-COUNTER.                            05800019
058100                                                                  05810019
058200 9000-EOJ-ROUTINE.                                                05820019
058300******************************************************************05830019
058400*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                          05840019
058500******************************************************************05850019
058600     CLOSE INPUT-FILE.                                            05860019
058700     CLOSE OUTPUT-FILE.                                           05870019
058800                                                                  05880019
058900     MOVE PV-INPUT-COUNTER TO PV-DISPLAY-COUNT.                   05890019
059000     DISPLAY 'INPUT RECORDS READ:        ' PV-DISPLAY-COUNT.      05900019
059100     MOVE PV-OUTPUT-COUNTER TO PV-DISPLAY-COUNT.                  05910019
059200     DISPLAY 'OUTPUT RECORDS WRITTEN:    ' PV-DISPLAY-COUNT.      05920019
059300                                                                  05930019
059400******************************************************************05940019
059500* ABEND PROCEDURE                                                *05950019
059600******************************************************************05960019
059700 9999-SQL-ABEND.                                                  05970019
059800     DISPLAY '** ABEND           ** = SQLABEND'.                  05980019
059900     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  05990019
060000     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       06000019
060100     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-1.      06010019
060200     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-2.      06020019
060300     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-3.      06030019
060400     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-4.      06040019
060500     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-106050019
060600     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-206060019
060700     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-306070019
060800     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               06080019
060900     COPY DPPD004.                                                06090019
061000     MOVE +4013                  TO PV-ABEND-CODE.                06100019
061100     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       06110019
