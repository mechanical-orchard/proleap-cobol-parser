000010 IDENTIFICATION DIVISION.                                                 
000020 PROGRAM-ID.         MLKUT702.                                            
000030 AUTHOR.             TESS BESTE.                                          
000040 INSTALLATION.       KOHLS DEPARTMENT STORES.                             
000050 DATE-WRITTEN.       05/28/98.                                            
000060 DATE-COMPILED.                                                           
000070                                                                          
000080******************************************************************        
000082* THIS PROGRAM CAN BE USED TO DO TIMINGS ON DB2 SQL TO                    
000083* DETERMINE THE MOST EFFICIENT WAY OF CODING THE SQL.                     
000084*                                                                         
000085* CHANGE THE PROGRAM AS FOLLOWS BEFORE COMPILING AND EXECUTING IT:        
000086*    1) CHANGE THE CODE IN PARAGRAPH 1000-PROCESS TO PERFORM              
000087*       THE SQL YOU WANT TO TIME.                                         
000088*    2) CHANGE THE COUNT IN THE PERFORM STATEMENT TO THE NUMBER OF        
000089*       TIMES YOU WANT TO PERFORM THE SQL.                                
000090*                                                                         
000091*  THERE IS ALSO A SIMILAR PROGRAM FOR DOING TIMINGS ON COBOL             
000092*  INSTRUCTIONS.                                                          
000100******************************************************************        
000280                                                                          
000290 ENVIRONMENT DIVISION.                                                    
000300 CONFIGURATION SECTION.                                                   
000310 INPUT-OUTPUT SECTION.                                                    
000320 FILE-CONTROL.                                                            
000370                                                                          
000380 DATA DIVISION.                                                           
000390 FILE SECTION.                                                            
000510                                                                          
000520 WORKING-STORAGE SECTION.                                                 
000530                                                                          
000543 01  PV-PROGRAM-VARIABLES.                                                
000544     05  PV-DB2-OPER-ATTEMPTED        PIC X(30).                          
000545     05  PV-PARAGRAPH-NAME            PIC X(30).                          
000549 01  ABEND-CODE                       PIC S9(04) COMP                     
000550                                                 VALUE ZERO.              
000668                                                                          
000669******************************************************************        
000670*  DB2 ERROR MESSAGES FORMAT AREA.                                        
000671******************************************************************        
000672     COPY DPWS004.                                                        
000673                                                                          
000674******************************************************************        
000675*  USED FOR DB2 ERRORS                                                    
000676******************************************************************        
000677     EXEC SQL                                                             
000678         INCLUDE SQLCA                                                    
000679     END-EXEC.                                                            
000680                                                                          
000681******************************************************************        
000682*  M/L MONTH-TO-DATE MAJOR CLASS TABLE                                    
000683******************************************************************        
000684     EXEC SQL                                                             
000685         INCLUDE TMNMCL                                                   
000686     END-EXEC.                                                            
000687                                                                          
003420 LINKAGE SECTION.                                                         
003430                                                                          
003440 PROCEDURE DIVISION.                                                      
003450                                                                          
003460                                                                          
003470 A100-MAIN-MODULE.                                                        
003480                                                                          
003530     PERFORM 1000-PROCESS 10000 TIMES.                                    
003650                                                                          
003660     STOP RUN.                                                            
003670                                                                          
003680                                                                          
003681 1000-PROCESS.                                                            
003700                                                                          
003703     EXEC SQL                                                             
003704         SELECT SLS_RTL_AMT                                               
003705               ,MKDN_RTL_AMT                                              
003706               ,MKUP_RTL_AMT                                              
003707               ,XFER_IN_RTL_AMT                                           
003708               ,XFER_OUT_RTL_AMT                                          
003709               ,RCPT_RTL_AMT                                              
003710               ,RCPT_NET_COST_AMT                                         
003711               ,PADJ_RTL_AMT                                              
003712               ,PADJ_NET_COST_AMT                                         
003713               ,INV_ADJ_RTL_AMT                                           
003714           INTO :MNMCL-SLS-RTL-AMT                                        
003715               ,:MNMCL-MKDN-RTL-AMT                                       
003716               ,:MNMCL-MKUP-RTL-AMT                                       
003717               ,:MNMCL-XFER-IN-RTL-AMT                                    
003718               ,:MNMCL-XFER-OUT-RTL-AMT                                   
003719               ,:MNMCL-RCPT-RTL-AMT                                       
003720               ,:MNMCL-RCPT-NET-COST-AMT                                  
003721               ,:MNMCL-PADJ-RTL-AMT                                       
003722               ,:MNMCL-PADJ-NET-COST-AMT                                  
003723               ,:MNMCL-INV-ADJ-RTL-AMT                                    
003724         FROM TMNMCL                                                      
003726         WHERE  FSCL_MN_END_DTE     = '2013-02-02'                        
003727          AND   FSCL_MN_NBR         = '12'                                
003728          AND   DEPT_NBR            = '949'                               
003729          AND   MAJ_CL_NBR          = '90'                                
003730     END-EXEC.                                                            
003731                                                                          
003732     EVALUATE SQLCODE                                                     
003733         WHEN 0                                                           
003734             CONTINUE                                                     
003736         WHEN OTHER                                                       
003737             MOVE '1000-PROCESS'         TO PV-PARAGRAPH-NAME             
003738             MOVE 'SELECT'               TO PV-DB2-OPER-ATTEMPTED         
003740             PERFORM 9999-SQL-ABEND                                       
003800     END-EVALUATE.                                                        
003801                                                                          
003802                                                                          
003803 9999-SQL-ABEND.                                                          
003804                                                                          
003805     MOVE +4013 TO ABEND-CODE.                                            
003806     DISPLAY '** ABEND **         ** = SQLERROR'.                         
003807     DISPLAY '** PROGRAM          ** = MLKUT702'.                         
003808     DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.               
003809     DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.           
003810                                                                          
003811*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
003812*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
003813     COPY  DPPD004.                                                       
003820                                                                          
003900     CALL 'ILBOABN0'  USING ABEND-CODE.                                   
