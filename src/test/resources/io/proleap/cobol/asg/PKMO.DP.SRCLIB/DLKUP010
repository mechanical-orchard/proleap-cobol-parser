000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             DLKUP010.                                00050001
000600 AUTHOR.                 AYAN SARKAR.                             00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JUNE 2015.                               00080001
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001200*  THIS PROGRAM PURGES DLT_DC_DOOR_SUM TABLE BASED ON PURGE     * 00120001
001300*  TIMESTAMP DETERMINED USING PARM "DLDCPG".                    * 00130001
001700***************************************************************** 00170000
001800 ENVIRONMENT DIVISION.                                            00180000
002100 CONFIGURATION SECTION.                                           00210000
002200                                                                  00220000
002300 SOURCE-COMPUTER.        IBM-3090.                                00230000
002400 OBJECT-COMPUTER.        IBM-3090.                                00240000
002500                                                                  00250000
002600 INPUT-OUTPUT SECTION.                                            00260000
002800 FILE-CONTROL.                                                    00280000
003300*                                                                 00330001
003400 DATA DIVISION.                                                   00340000
004400 WORKING-STORAGE SECTION.                                         00440000
004500*                                                                 00450000
004600 01  ABEND-CODE                      PIC S9(04)    VALUE +0.      00460000
004700*                                                                 00470000
004800 01  PROGRAM-SWITCHES.                                            00480000
004900     05  PS-EOF-DC-DOOR-CSR1-SW      PIC  X(01)    VALUE 'N'.     00490002
005000         88  PS-EOF-DC-DOOR-CSR1                   VALUE 'Y'.     00500002
005100         88  PS-NOT-EOF-DC-DOOR-CSR1               VALUE 'N'.     00510002
005110     05  PS-EOF-DC-DOOR-CSR2-SW      PIC  X(01)    VALUE 'N'.     00511002
005120         88  PS-EOF-DC-DOOR-CSR2                   VALUE 'Y'.     00512002
005130         88  PS-NOT-EOF-DC-DOOR-CSR2               VALUE 'N'.     00513002
005200                                                                  00520000
005300 01  PC-PROGRAM-CONSTANTS.                                        00530000
005400     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00540000
005500                                                 'DLKUP010'.      00550001
005600     05  PC-COMMIT-HOLD              PIC  9(03)    VALUE 300.     00560000
005700                                                                  00570000
005800 01  PV-PROGRAM-VARIABLES.                                        00580000
005900     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  00590000
006000     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00600000
006100                                                                  00610000
006200     05  PV-FETCH-CNT                PIC  9(09)    VALUE ZERO.    00620000
006210     05  PV-TOTAL-FETCH-CNT          PIC  9(09)    VALUE ZERO.    00621004
006300     05  PV-DELETE-CNT               PIC  9(09)    VALUE ZERO.    00630000
006400     05  PV-TOTAL-DEL-CNT            PIC  9(09)    VALUE ZERO.    00640000
006700     05  PV-COMMIT-CNT               PIC  9(09)    VALUE ZERO.    00670000
006800     05  PV-DISPLAY-COUNT            PIC  Z(8)9    VALUE ZERO.    00680000
007000                                                                  00700000
007200 01  PT-DC-DOOR-SUM.                                              00720002
007300     05 PT-OPER-UNT-ID               PIC S9(04) COMP              00730003
007310                                     OCCURS 100 TIMES.            00731003
007320     05 PT-DOOR-ID                   PIC  X(04)                   00732003
007321                                     OCCURS 100 TIMES.            00732103
007322     05 PT-DOOR-SUM-END-TMST         PIC  X(26)                   00732203
007323                                     OCCURS 100 TIMES.            00732303
007376                                                                  00737600
007379 01  DK-DB-KEYS.                                                  00737900
007380     05  DK-PURGE-TMST-HOLD          PIC  X(26).                  00738002
007390     05  DK-PURGE-TMST               PIC  X(26).                  00739002
007400                                                                  00740000
007500******************************************************************00750000
007600*  DB2 FORMATTED MESSAGE AREA                                     00760000
007700******************************************************************00770000
007800     COPY DPWS004.                                                00780000
007900                                                                  00790000
008000******************************************************************00800000
008100*  COPY BOOK FOR THE PARAMETER TABLE                              00810000
008200******************************************************************00820000
008300     EXEC SQL                                                     00830000
008400          INCLUDE TKRPRPM                                         00840000
008500     END-EXEC.                                                    00850000
008600                                                                  00860000
008700******************************************************************00870000
008800*   DC DOOR SUMMARY TABLE - DLT_DC_DOOR_SUM                       00880001
008900******************************************************************00890000
009000     EXEC SQL                                                     00900000
009100          INCLUDE DLT00011                                        00910001
009200     END-EXEC.                                                    00920000
009300                                                                  00930000
009400******************************************************************00940000
009500*  DB2 COMMUNICATION AREA                                         00950000
009600******************************************************************00960000
009700     EXEC SQL                                                     00970000
009800         INCLUDE SQLCA                                            00980000
009900     END-EXEC.                                                    00990000
010000                                                                  01000000
010100******************************************************************01010000
010200*  CURSOR TO FETCH UNIQUE DC/DOOR COMBINATION                    *01020001
010300******************************************************************01030000
010310     EXEC SQL                                                     01031001
010320        DECLARE DC-DOOR-CSR1 CURSOR WITH HOLD FOR                 01032002
010330           SELECT OPER_UNT_ID                                     01033001
010340                 ,DOOR_ID                                         01034001
010350                 ,MAX(DOOR_SUM_CRE_TMST)                          01035001
010360             FROM DLT_DC_DOOR_SUM                                 01036001
010370            GROUP BY OPER_UNT_ID,DOOR_ID                          01037001
010380            ORDER BY OPER_UNT_ID,DOOR_ID                          01038001
010390           WITH UR                                                01039001
010392     END-EXEC.                                                    01039201
010393                                                                  01039301
010394******************************************************************01039401
010395*  CURSOR TO FETCH RECORDS WHICH MEET PURGE CRITERIA             *01039501
010396******************************************************************01039601
010397                                                                  01039701
010400     EXEC SQL                                                     01040000
010500        DECLARE DC-DOOR-CSR2 CURSOR WITH ROWSET POSITIONING       01050002
010600                                    WITH HOLD FOR                 01060006
010700         SELECT  OPER_UNT_ID                                      01070001
010800                ,DOOR_ID                                          01080001
010900                ,DOOR_SUM_END_TMST                                01090001
012280           FROM DLT_DC_DOOR_SUM                                   01228001
012290          WHERE OPER_UNT_ID       = :DLT00011-OPER-UNT-ID         01229006
012300            AND DOOR_ID           = :DLT00011-DOOR-ID             01230001
012400            AND DOOR_SUM_CRE_TMST < :DK-PURGE-TMST                01240002
012430          FOR UPDATE                                              01243007
012440     END-EXEC.                                                    01244000
012450*                                                                 01245000
012460 PROCEDURE DIVISION.                                              01246000
012470*                                                                 01247000
012480************************************************************      01248000
012490 0000-MAINLINE-PROCESSING.                                        01249000
012500************************************************************      01250000
012600                                                                  01260000
012700     PERFORM 1000-INITIALIZATION.                                 01270000
012800     PERFORM 2000-PROCESS-DC-DOOR-SUM.                            01280002
012900     PERFORM 9000-EOJ.                                            01290000
013000     STOP RUN.                                                    01300000
013100                                                                  01310000
013200************************************************************      01320000
013300 1000-INITIALIZATION.                                             01330000
013400************************************************************      01340000
013500                                                                  01350000
013800     PERFORM 7000-DETERMINE-PURGE-TMST.                           01380002
013900                                                                  01390000
014000     SET  PS-NOT-EOF-DC-DOOR-CSR1    TO  TRUE.                    01400002
014100                                                                  01410000
014200************************************************************      01420000
014300 2000-PROCESS-DC-DOOR-SUM.                                        01430002
014400************************************************************      01440000
014500                                                                  01450000
014600     PERFORM 2100-OPEN-DC-DOOR-CSR1.                              01460002
014700                                                                  01470000
014800     PERFORM 2200-FETCH-DC-DOOR-CSR1                              01480002
014900       UNTIL PS-EOF-DC-DOOR-CSR1.                                 01490002
015000                                                                  01500000
015100     PERFORM 2300-CLOSE-DC-DOOR-CSR1.                             01510002
015200                                                                  01520000
015300     IF PV-DELETE-CNT > 0                                         01530000
015400         PERFORM 8100-TAKE-COMMIT                                 01540003
015500     END-IF.                                                      01550000
015600                                                                  01560000
015700************************************************************      01570000
015800 2100-OPEN-DC-DOOR-CSR1.                                          01580002
015900************************************************************      01590000
016000                                                                  01600000
016100     EXEC SQL                                                     01610000
016200          OPEN DC-DOOR-CSR1                                       01620002
016300     END-EXEC.                                                    01630000
016400                                                                  01640000
016500     EVALUATE TRUE                                                01650000
016600         WHEN SQLCODE = 0                                         01660000
016700             CONTINUE                                             01670000
016800         WHEN SQLWARN0 NOT = SPACES                               01680000
016900         WHEN SQLCODE < ZERO                                      01690000
017000         WHEN SQLCODE > ZERO                                      01700000
017100             MOVE '2100-OPEN-DC-DOOR-CSR1'                        01710002
017200                                     TO PV-ABEND-PARAGRAPH        01720000
017300             MOVE 'OPEN DC-DOOR-CSR1'                             01730002
017400                                     TO PV-DB2-OPERATION-ATTEMPTED01740000
017500             PERFORM 9100-SQL-ABEND                               01750000
017600     END-EVALUATE.                                                01760000
017700                                                                  01770000
017800************************************************************      01780000
017900 2200-FETCH-DC-DOOR-CSR1.                                         01790002
018000************************************************************      01800000
018001                                                                  01800102
018002     EXEC SQL                                                     01800202
018003         FETCH DC-DOOR-CSR1                                       01800302
018004          INTO :DLT00011-OPER-UNT-ID                              01800402
018005              ,:DLT00011-DOOR-ID                                  01800502
018006              ,:DLT00011-DOOR-SUM-CRE-TMST                        01800602
018007     END-EXEC.                                                    01800702
018008                                                                  01800802
018009     EVALUATE TRUE                                                01800902
018010        WHEN SQLCODE = ZERO                                       01801002
018011            SET  PS-NOT-EOF-DC-DOOR-CSR2                          01801109
018012                                     TO TRUE                      01801209
018013            PERFORM 3000-PROCESS-DC-DOOR-RECORD                   01801302
018014        WHEN SQLCODE = +100                                       01801402
018015           SET PS-EOF-DC-DOOR-CSR1   TO TRUE                      01801502
018016        WHEN SQLWARN0 NOT = SPACES                                01801602
018017        WHEN SQLCODE < ZERO                                       01801702
018018        WHEN SQLCODE > ZERO                                       01801802
018019           MOVE '2200-FETCH-DC-DOOR-CSR1'                         01801902
018020                                     TO PV-ABEND-PARAGRAPH        01802002
018021           MOVE 'FETCH DC-DOOR-CSR1' TO PV-DB2-OPERATION-ATTEMPTED01802102
018022          PERFORM 9100-SQL-ABEND                                  01802202
018023     END-EVALUATE.                                                01802302
018024                                                                  01802402
018025************************************************************      01802502
018026 2300-CLOSE-DC-DOOR-CSR1.                                         01802606
018027************************************************************      01802702
018028                                                                  01802802
018029     EXEC SQL                                                     01802902
018030          CLOSE DC-DOOR-CSR1                                      01803002
018031     END-EXEC.                                                    01803102
018032                                                                  01803202
018033     EVALUATE TRUE                                                01803302
018034         WHEN SQLCODE = 0                                         01803402
018035             CONTINUE                                             01803502
018036         WHEN SQLWARN0 NOT = SPACES                               01803602
018037         WHEN SQLCODE < ZERO                                      01803702
018038         WHEN SQLCODE > ZERO                                      01803802
018039             MOVE '2300-CLOSE-DC-DOOR-CSR1'                       01803902
018040                                     TO PV-ABEND-PARAGRAPH        01804002
018041             MOVE 'CLOSE DC-DOOR-CSR1'                            01804102
018042                                     TO PV-DB2-OPERATION-ATTEMPTED01804202
018043             PERFORM 9100-SQL-ABEND                               01804302
018044     END-EVALUATE.                                                01804402
018045                                                                  01804502
018046************************************************************      01804602
018047 3000-PROCESS-DC-DOOR-RECORD.                                     01804702
018048************************************************************      01804802
018049                                                                  01804902
018050     IF DK-PURGE-TMST-HOLD >= DLT00011-DOOR-SUM-CRE-TMST THEN     01805004
018051        MOVE DLT00011-DOOR-SUM-CRE-TMST                           01805102
018052                                     TO DK-PURGE-TMST             01805202
018053     ELSE                                                         01805302
018054        MOVE DK-PURGE-TMST-HOLD      TO DK-PURGE-TMST             01805402
018055     END-IF.                                                      01805502
018056                                                                  01805602
018057     PERFORM 3100-OPEN-DC-DOOR-CSR2.                              01805702
018058     PERFORM 3200-FETCH-DC-DOOR-CSR2                              01805802
018059       UNTIL PS-EOF-DC-DOOR-CSR2.                                 01805902
018060     PERFORM 3300-CLOSE-DC-DOOR-CSR2.                             01806002
018061                                                                  01806102
018062************************************************************      01806202
018063 3100-OPEN-DC-DOOR-CSR2.                                          01806302
018064************************************************************      01806402
018065                                                                  01806502
018066     EXEC SQL                                                     01806602
018067          OPEN DC-DOOR-CSR2                                       01806702
018068     END-EXEC.                                                    01806802
018069                                                                  01806902
018070     EVALUATE TRUE                                                01807002
018071         WHEN SQLCODE = 0                                         01807102
018072             CONTINUE                                             01807202
018073         WHEN SQLWARN0 NOT = SPACES                               01807302
018074         WHEN SQLCODE < ZERO                                      01807402
018075         WHEN SQLCODE > ZERO                                      01807502
018076             MOVE '2100-OPEN-DC-DOOR-CSR2'                        01807602
018077                                     TO PV-ABEND-PARAGRAPH        01807702
018078             MOVE 'OPEN DC-DOOR-CSR2'                             01807802
018079                                     TO PV-DB2-OPERATION-ATTEMPTED01807902
018080             PERFORM 9100-SQL-ABEND                               01808002
018081     END-EVALUATE.                                                01808102
018082                                                                  01808202
018083                                                                  01808302
018084************************************************************      01808402
018085 3200-FETCH-DC-DOOR-CSR2.                                         01808502
018090************************************************************      01809002
018100                                                                  01810000
018400     EXEC SQL                                                     01840000
018500          FETCH NEXT ROWSET                                       01850000
018600           FROM DC-DOOR-CSR2                                      01860003
018700            FOR 100 ROWS                                          01870000
018800           INTO :PT-OPER-UNT-ID                                   01880003
018900               ,:PT-DOOR-ID                                       01890003
019000               ,:PT-DOOR-SUM-END-TMST                             01900003
019903     END-EXEC.                                                    01990300
019904                                                                  01990400
019905     EVALUATE TRUE                                                01990500
019906       WHEN SQLCODE = ZEROS                                       01990600
019907            ADD SQLERRD(3)           TO  PV-TOTAL-FETCH-CNT       01990703
019920            PERFORM 8000-DELETE-EXTRACT-RECORD                    01992003
019930       WHEN SQLCODE = +100                                        01993000
019940            IF SQLERRD(3) > 0 THEN                                01994000
019950               ADD SQLERRD(3)        TO  PV-TOTAL-FETCH-CNT       01995003
019990               PERFORM 8000-DELETE-EXTRACT-RECORD                 01999003
020000            END-IF                                                02000000
020100            SET PS-EOF-DC-DOOR-CSR2  TO TRUE                      02010004
020200       WHEN SQLWARN0 NOT = SPACES                                 02020000
020300       WHEN SQLCODE < ZERO                                        02030000
020400       WHEN SQLCODE > ZERO                                        02040000
020500           MOVE '2200-FETCH-DC-DOOR-CSR2'                         02050002
020600                                     TO PV-ABEND-PARAGRAPH        02060000
020700           MOVE 'FETCH DC-DOOR-CSR2' TO PV-DB2-OPERATION-ATTEMPTED02070002
020900           PERFORM 9100-SQL-ABEND                                 02090000
021000     END-EVALUATE.                                                02100000
021100                                                                  02110000
021200************************************************************      02120003
021300 3300-CLOSE-DC-DOOR-CSR2.                                         02130003
021400************************************************************      02140003
021500                                                                  02150003
021600     EXEC SQL                                                     02160003
021700          CLOSE DC-DOOR-CSR2                                      02170003
021800     END-EXEC.                                                    02180003
021900                                                                  02190003
022000     EVALUATE TRUE                                                02200003
022100         WHEN SQLCODE = 0                                         02210003
022200             CONTINUE                                             02220003
022300         WHEN SQLWARN0 NOT = SPACES                               02230003
022400         WHEN SQLCODE < ZERO                                      02240003
022500         WHEN SQLCODE > ZERO                                      02250003
022600             MOVE '2300-CLOSE-DC-DOOR-CSR2'                       02260003
022700                                     TO PV-ABEND-PARAGRAPH        02270003
022800             MOVE 'CLOSE DC-DOOR-CSR2'                            02280003
022900                                     TO PV-DB2-OPERATION-ATTEMPTED02290003
023000             PERFORM 9100-SQL-ABEND                               02300003
023100     END-EVALUATE.                                                02310003
023200                                                                  02320003
023300************************************************************      02330000
023400 7000-DETERMINE-PURGE-TMST.                                       02340002
023500************************************************************      02350000
023600                                                                  02360000
024700     EXEC SQL                                                     02470000
024800        SELECT (CURRENT TIMESTAMP - FUNC_QTY DAYS)                02480002
024900          INTO :DK-PURGE-TMST-HOLD                                02490002
024910          FROM TKRPRPM                                            02491000
024911         WHERE LOC_ID            =  90                            02491100
024912           AND INTFC_SYS_CDE     = 'KHL'                          02491200
024913           AND SYS_PRC_FUNC_CDE  = 'DLDCPG'                       02491302
024914           AND FUNC_PRC_STAT_CDE = 'AC'                           02491400
024915        WITH UR                                                   02491500
024916     END-EXEC.                                                    02491600
024917                                                                  02491700
024918     EVALUATE TRUE                                                02491800
024919         WHEN SQLCODE = 0                                         02491900
024920             CONTINUE                                             02492000
024930         WHEN SQLWARN0 NOT = SPACES                               02493000
024940         WHEN SQLCODE < ZERO                                      02494000
024950         WHEN SQLCODE > ZERO                                      02495000
024960             MOVE '7000-DETERMINE-PURGE-TMST'                     02496002
024970                                     TO PV-ABEND-PARAGRAPH        02497000
024980             MOVE 'SELECT FROM TKRPRPM'                           02498002
024990                                     TO PV-DB2-OPERATION-ATTEMPTED02499000
025000             PERFORM 9100-SQL-ABEND                               02500000
025010     END-EVALUATE.                                                02501000
025020                                                                  02502000
027748                                                                  02774800
027749************************************************************      02774900
027750 8000-DELETE-EXTRACT-RECORD.                                      02775003
027760************************************************************      02776000
027761                                                                  02776100
027762     EXEC SQL                                                     02776200
027763         DELETE                                                   02776300
027764             FROM DLT_DC_DOOR_SUM                                 02776402
027765             WHERE CURRENT OF DC-DOOR-CSR2                        02776507
027767     END-EXEC.                                                    02776700
027768                                                                  02776800
027769     EVALUATE TRUE                                                02776900
027770       WHEN SQLCODE = ZEROS                                       02777000
027771            ADD  SQLERRD(3)          TO  PV-DELETE-CNT            02777100
027772                                         PV-TOTAL-DEL-CNT         02777200
027773            IF PV-DELETE-CNT >= PC-COMMIT-HOLD                    02777310
027774                PERFORM 8100-TAKE-COMMIT                          02777403
027775            END-IF                                                02777500
027778       WHEN SQLCODE = +100                                        02777808
027779            CONTINUE                                              02777908
027780       WHEN SQLWARN0 NOT = SPACES                                 02778008
027781       WHEN SQLCODE < ZERO                                        02778108
027782       WHEN SQLCODE > ZERO                                        02778208
027783           MOVE '8000-DELETE-EXTRACT-RECORD'                      02778310
027784                                     TO PV-ABEND-PARAGRAPH        02778408
027785           MOVE 'DELETE FROM DLT_DC_DOOR_SUM'                     02778510
027786                                     TO PV-DB2-OPERATION-ATTEMPTED02778608
027787           PERFORM 9100-SQL-ABEND                                 02778708
027788     END-EVALUATE.                                                02778808
027789                                                                  02778908
027790************************************************************      02779008
027791 8100-TAKE-COMMIT.                                                02779108
027792************************************************************      02779208
027793                                                                  02779308
027794     EXEC SQL                                                     02779408
027795         COMMIT                                                   02779508
027796     END-EXEC.                                                    02779608
027797                                                                  02779708
027798     EVALUATE TRUE                                                02779808
027799       WHEN SQLCODE = ZEROS                                       02779908
027800            MOVE 0                   TO PV-DELETE-CNT             02780008
027801            ADD +1                   TO PV-COMMIT-CNT             02780108
027802       WHEN SQLWARN0 NOT = SPACES                                 02780208
027803       WHEN SQLCODE < ZERO                                        02780308
027804       WHEN SQLCODE > ZERO                                        02780408
027805           MOVE '8100-TAKE-COMMIT'   TO PV-ABEND-PARAGRAPH        02780508
027806           MOVE 'COMMIT'             TO PV-DB2-OPERATION-ATTEMPTED02780608
027807           PERFORM 9100-SQL-ABEND                                 02780708
027808     END-EVALUATE.                                                02780808
027809                                                                  02780908
027810************************************************************      02781008
027811 9000-EOJ.                                                        02781108
027812************************************************************      02781208
027813                                                                  02781300
027814     DISPLAY '** ' PC-CURRENT-PROGRAM-NAME ' **'.                 02781400
027815     DISPLAY '** PURGE TIMESTAMP          : ' DK-PURGE-TMST-HOLD. 02781502
027819                                                                  02781900
027820     MOVE PV-TOTAL-FETCH-CNT         TO   PV-DISPLAY-COUNT.       02782003
027821     DISPLAY '** NUMBER OF RECORD FETCHED : ' PV-DISPLAY-COUNT.   02782100
027822     MOVE PV-TOTAL-DEL-CNT           TO   PV-DISPLAY-COUNT.       02782209
027825     DISPLAY '** NUMBER OF RECORD DELETED : ' PV-DISPLAY-COUNT.   02782500
027826     MOVE PV-COMMIT-CNT              TO   PV-DISPLAY-COUNT.       02782600
027827     DISPLAY '** NUMBER OF COMMIT TAKEN   : ' PV-DISPLAY-COUNT.   02782700
027828                                                                  02782800
027829************************************************************      02782900
027830 9100-SQL-ABEND.                                                  02783000
027840************************************************************      02784000
027850*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN        02785002
027860*  ERROR OR WARNING CODE OCCURS.                                  02786000
027870************************************************************      02787000
027880     DISPLAY '9100-SQL-ABEND'.                                    02788000
027890     DISPLAY '** ABEND     **'.                                   02789000
027900     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        02790000
028000     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             02800000
028100     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     02810000
028200                                                                  02820000
028300************************************************************      02830000
028400* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STAT      02840000
028500* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         02850000
028600* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABL      02860000
028700* FORMAT.                                                         02870000
028800************************************************************      02880000
028900     COPY DPPD004.                                                02890000
029000                                                                  02900000
029100     MOVE +4013                      TO ABEND-CODE.               02910000
029200     CALL 'ILBOABN0' USING ABEND-CODE.                            02920000
029300                                                                  02930000
