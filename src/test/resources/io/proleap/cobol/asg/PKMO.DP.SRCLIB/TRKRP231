000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    TRKRP231.                                         00050000
000600 AUTHOR.        DAVE PHELPS                                       00060000
000700*               MIKE FRIESS - MAJOR REVISION 11/22/99             00070000
000800 INSTALLATION.  KOHLS.                                            00080000
000900 DATE-WRITTEN   AUG.,1998.                                        00090000
001000 DATE-COMPILED.                                                   00100000
001100                                                                  00110000
001200*----------------------------------------------------------------*00120000
001300*  THIS PROGRAM CREATES AN ERROR REPORT OF DATA THAT WAS NOT      00130000
001400*  LOADED TO THE DB2 TABLES IN TRKUP235.                          00140000
001500*----------------------------------------------------------------*00150000
001600                                                                  00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900******************************************************************00190000
002000                                                                  00200000
002100 CONFIGURATION SECTION.                                           00210000
002200                                                                  00220000
002300 SOURCE-COMPUTER.        IBM-3090.                                00230000
002400 OBJECT-COMPUTER.        IBM-3090.                                00240000
002500                                                                  00250000
002600 INPUT-OUTPUT SECTION.                                            00260000
002700                                                                  00270000
002800 FILE-CONTROL.                                                    00280000
002900                                                                  00290000
003000     SELECT ERROR-FILE                                            00300000
003100         ASSIGN TO INP01.                                         00310000
003200                                                                  00320000
003300     SELECT ERROR-REPORT-FILE                                     00330000
003400         ASSIGN TO RPT01.                                         00340000
003500                                                                  00350000
003600******************************************************************00360000
003700 DATA DIVISION.                                                   00370000
003800******************************************************************00380000
003900                                                                  00390000
004000 FILE SECTION.                                                    00400000
004100                                                                  00410000
004200 FD  ERROR-FILE                                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     BLOCK CONTAINS 0 RECORDS.                                    00450000
004600                                                                  00460000
004700 01  ERROR-RECORD                     PIC  X(508).                00470000
004800                                                                  00480000
004900                                                                  00490000
005000 FD  ERROR-REPORT-FILE                                            00500000
005100     RECORDING MODE IS F                                          00510000
005200     LABEL RECORDS ARE STANDARD                                   00520000
005300     BLOCK CONTAINS 0 RECORDS.                                    00530000
005400                                                                  00540000
005500 01  ERROR-REPORT-RECORD              PIC  X(132).                00550000
005600                                                                  00560000
005700                                                                  00570000
005800*----------------------------------------------------------------*00580000
005900 WORKING-STORAGE SECTION.                                         00590000
006000*----------------------------------------------------------------*00600000
006100                                                                  00610000
006200*----------------------------------------------------------------*00620000
006300***  WORK FIELDS FOR THE ERROR REPORT                             00630000
006400*----------------------------------------------------------------*00640000
006500     COPY TRRD231.                                                00650014
006600                                                                  00660000
006700*----------------------------------------------------------------*00670000
006800***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00680000
006900*----------------------------------------------------------------*00690000
007000     COPY DPWS132O.                                               00700013
007100                                                                  00710000
007200 01  HL-P1-PAGE-HEADER-1.                                         00720000
007300         10 FILLER                   PIC  X(02)      VALUE SPACES.00730000
007400     05  HL-P1-TRANS-DATE.                                        00740000
007500         10 HL-P1-TRANS-MM           PIC  X(02)      VALUE SPACE. 00750000
007600         10 FILLER                   PIC  X(01)      VALUE '/'.   00760000
007700         10 HL-P1-TRANS-DD           PIC  X(02)      VALUE SPACE. 00770000
007800         10 FILLER                   PIC  X(01)      VALUE '/'.   00780000
007900         10 HL-P1-TRANS-YY           PIC  X(02)      VALUE SPACE. 00790000
008000     05  FILLER                      PIC  X(02)      VALUE SPACE. 00800000
008100     05  HL-P1-TRANS-TIME.                                        00810000
008200         10 HL-P1-TRANS-TIME-HH      PIC  X(02)      VALUE SPACE. 00820000
008300         10 FILLER                   PIC  X(01)      VALUE ':'.   00830000
008400         10 HL-P1-TRANS-TIME-MM      PIC  X(02)      VALUE SPACE. 00840000
008500     05  FILLER                      PIC  X(01)      VALUE SPACE. 00850000
008600     05  FILLER                      PIC  X(13)      VALUE        00860000
008700         'TRANSMIT DATE'.                                         00870000
008800     05  FILLER                      PIC  X(16)      VALUE SPACE. 00880000
008900     05  FILLER                      PIC  X(38)      VALUE        00890000
009000         '    IMPORT PURCHASE ORDER TRACKING    '.                00900000
009100     05  FILLER                      PIC  X(16)      VALUE SPACE. 00910000
009200     05  FILLER                      PIC  X(07)      VALUE        00920000
009300         'FILE ID'.                                               00930000
009400     05  FILLER                      PIC  X(02)      VALUE SPACE. 00940000
009500     05  HL-P1-FILE-ID               PIC  X(09)      VALUE SPACE. 00950000
009600     05  FILLER                      PIC  X(13)      VALUE SPACE. 00960000
009700                                                                  00970000
009800 01  HL-P2-PAGE-HEADER-2.                                         00980000
009900         10 FILLER                   PIC  X(02)      VALUE SPACES.00990000
010000     05  HL-P2-LOAD-DATE.                                         01000000
010100         10 HL-P2-LOAD-MM            PIC  X(02)      VALUE SPACE. 01010000
010200         10 FILLER                   PIC  X(01)      VALUE '/'.   01020000
010300         10 HL-P2-LOAD-DD            PIC  X(02)      VALUE SPACE. 01030000
010400         10 FILLER                   PIC  X(01)      VALUE '/'.   01040000
010500         10 HL-P2-LOAD-YY            PIC  X(02)      VALUE SPACE. 01050000
010600     05  FILLER                      PIC  X(02)      VALUE SPACE. 01060000
010700     05  HL-P2-LOAD-TIME.                                         01070000
010800         10 HL-P2-LOAD-TIME-HH       PIC  X(02)      VALUE SPACE. 01080000
010900         10 FILLER                   PIC  X(01)      VALUE ':'.   01090000
011000         10 HL-P2-LOAD-TIME-MM       PIC  X(02)      VALUE SPACE. 01100000
011100     05  FILLER                      PIC  X(01)      VALUE SPACE. 01110000
011200     05  FILLER                      PIC  X(13)      VALUE        01120000
011300         'LOAD DATE    '.                                         01130000
011400     05  FILLER                      PIC  X(16)      VALUE SPACE. 01140000
011500     05  FILLER                      PIC  X(38)      VALUE        01150000
011600         '  VESSEL / VOYAGE ARRIVAL LOAD ERRORS '.                01160000
011700     05  FILLER                      PIC  X(16)      VALUE SPACE. 01170000
011800     05  HL-P2-ENTITY                PIC  X(30)      VALUE SPACES.01180000
011900     05  FILLER                      PIC  X(01)      VALUE SPACE. 01190000
012000                                                                  01200000
012100 01  HL-C1-CNTNR-HEADER-1.                                        01210000
012200     05  FILLER                      PIC  X(14)      VALUE SPACE. 01220000
012300     05  FILLER                      PIC  X(07)      VALUE        01230000
012400         'CARRIER'.                                               01240000
012500     05  FILLER                      PIC  X(23)      VALUE SPACE. 01250000
012600     05  FILLER                      PIC  X(06)      VALUE        01260000
012700         'VOYAGE'.                                                01270000
012800     05  FILLER                      PIC  X(82)      VALUE SPACE. 01280000
012900                                                                  01290000
013000 01  HL-C2-CNTNR-HEADER-2.                                        01300000
013100     05  FILLER                      PIC  X(09)      VALUE        01310000
013200         'CONTAINER'.                                             01320000
013300     05  FILLER                      PIC  X(05)      VALUE SPACE. 01330000
013400     05  FILLER                      PIC  X(04)      VALUE        01340000
013500         'SCAC'.                                                  01350000
013600     05  FILLER                      PIC  X(08)      VALUE SPACE. 01360000
013700     05  FILLER                      PIC  X(14)      VALUE        01370000
013800         'TRIP TYPE CODE'.                                        01380000
013900     05  FILLER                      PIC  X(04)      VALUE SPACE. 01390000
014000     05  FILLER                      PIC  X(06)      VALUE        01400000
014100         'NUMBER'.                                                01410000
014200     05  FILLER                      PIC  X(09)      VALUE SPACE. 01420000
014300     05  FILLER                      PIC  X(11)      VALUE        01430000
014400         'VESSEL NAME'.                                           01440000
014500     05  FILLER                      PIC  X(07)      VALUE SPACE. 01450010
014600     05  HL-C2-TEXT-MSG              PIC  X(40)      VALUE SPACE. 01460002
014700     05  FILLER                      PIC  X(15)      VALUE SPACE. 01470010
014800                                                                  01480000
014900 01  DL-C1-CNTNR-LINE.                                            01490000
015000     05  DL-C1-CONTAINER            PIC  X(12)    VALUE SPACES.   01500000
015100     05  FILLER                     PIC  X(02)    VALUE SPACES.   01510000
015200     05  DL-C1-CARRIER-SCAC         PIC  X(04)    VALUE SPACES.   01520000
015300     05  FILLER                     PIC  X(13)    VALUE SPACES.   01530000
015400     05  DL-C1-TRIP-TYPE            PIC  X(01)    VALUE SPACES.   01540000
015500     05  FILLER                     PIC  X(12)    VALUE SPACES.   01550000
015600     05  DL-C1-VOYAGE-NBR           PIC  X(10)    VALUE SPACES.   01560000
015700     05  FILLER                     PIC  X(05)    VALUE SPACES.   01570000
015800     05  DL-C1-VESSEL-NAME          PIC  X(25)    VALUE SPACES.   01580000
015900     05  FILLER                     PIC  X(60)    VALUE SPACES.   01590000
016000                                                                  01600000
016100 01  HL-D1-DETAIL-HEADER-1.                                       01610000
016200     05  FILLER                      PIC  X(04)      VALUE        01620000
016300         'RECD'.                                                  01630000
016400     05  FILLER                      PIC  X(03)      VALUE SPACE. 01640000
016500     05  FILLER                      PIC  X(03)      VALUE        01650000
016600         'TRN'.                                                   01660000
016700     05  FILLER                      PIC  X(16)      VALUE SPACE. 01670000
016800     05  FILLER                      PIC  X(08)      VALUE        01680000
016900         'EXTERNAL'.                                              01690000
017000     05  FILLER                      PIC  X(43)      VALUE SPACE. 01700000
017100     05  FILLER                      PIC  X(05)      VALUE        01710000
017200         'KOHLS'.                                                 01720000
017300     05  FILLER                      PIC  X(04)      VALUE SPACE. 01730001
017400     05  FILLER                      PIC  X(05)      VALUE        01740001
017500         'KOHLS'.                                                 01750001
017600     05  FILLER                      PIC  X(41)      VALUE SPACE. 01760001
017700                                                                  01770001
017800 01  HL-D2-DETAIL-HEADER-2.                                       01780001
017900     05  FILLER                      PIC  X(04)      VALUE        01790001
018000         'TYPE'.                                                  01800001
018100     05  FILLER                      PIC  X(03)      VALUE SPACE. 01810001
018200     05  FILLER                      PIC  X(04)      VALUE        01820001
018300         'TYPE'.                                                  01830001
018400     05  FILLER                      PIC  X(03)      VALUE SPACE. 01840001
018500     05  FILLER                      PIC  X(09)      VALUE        01850001
018600         'PO NUMBER'.                                             01860001
018700     05  FILLER                      PIC  X(03)      VALUE SPACE. 01870001
018800     05  FILLER                      PIC  X(13)      VALUE        01880001
018900         'REFERENCE NBR'.                                         01890001
019000     05  FILLER                      PIC  X(05)      VALUE SPACE. 01900001
019100     05  HL-D2-POE-COL-HDR           PIC  X(30)      VALUE SPACE. 01910001
019200     05  FILLER                      PIC  X(03)      VALUE SPACE. 01920001
019300     05  FILLER                      PIC  X(06)      VALUE        01930001
019400         'PO FOB'.                                                01940001
019500     05  FILLER                      PIC  X(03)      VALUE SPACE. 01950001
019600     05  FILLER                      PIC  X(04)      VALUE        01960001
019700         'SCAC'.                                                  01970001
019800     05  FILLER                      PIC  X(05)      VALUE SPACE. 01980001
019900     05  HL-D2-TIME-1-COL-HDR        PIC  X(17)      VALUE SPACE. 01990001
020000     05  FILLER                      PIC  X(20)      VALUE SPACE. 02000001
020100                                                                  02010001
020200 01  DL-D1-DETAIL-LINE.                                           02020001
020300     05  DL-D1-RECD-TYPE            PIC  X(06)    VALUE SPACES.   02030001
020400     05  FILLER                     PIC  X(03)    VALUE SPACES.   02040001
020500     05  DL-D1-TRN-TYP              PIC  X(01)    VALUE SPACES.   02050001
020600     05  FILLER                     PIC  X(04)    VALUE SPACES.   02060001
020700     05  DL-D1-PO-NBR               PIC  X(09)    VALUE SPACES.   02070001
020800     05  FILLER                     PIC  X(03)    VALUE SPACES.   02080001
020900     05  DL-D1-EXTL-REF-NBR         PIC  X(15)    VALUE SPACES.   02090001
021000     05  FILLER                     PIC  X(03)    VALUE SPACES.   02100001
021100     05  DL-D1-POE-NM               PIC  X(30)    VALUE SPACES.   02110001
021200     05  FILLER REDEFINES DL-D1-POE-NM.                           02120001
021300         10 DL-D1-ACTL-LBD-NME  PIC  X(18).                       02130001
021400         10 FILLER              PIC  X(12).                       02140001
021500     05  FILLER                     PIC  X(03)    VALUE SPACES.   02150001
021600     05  DL-D1-FOB-CDE              PIC  X(03)    VALUE SPACES.   02160001
021700     05  FILLER                     PIC  X(06)    VALUE SPACES.   02170001
021800     05  DL-D1-KOHLS-SCAC-CDE       PIC  X(04)    VALUE SPACES.   02180001
021900     05  FILLER                     PIC  X(05)    VALUE SPACES.   02190001
022000     05  DL-D1-DATE-1.                                            02200001
022100         10  DL-D1-DATE-1-MM        PIC  X(02)    VALUE SPACES.   02210001
022200         10  DL-D1-DATE-1-SLASH-1   PIC  X(01)    VALUE SPACES.   02220001
022300         10  DL-D1-DATE-1-DD        PIC  X(02)    VALUE SPACES.   02230001
022400         10  DL-D1-DATE-1-SLASH-2   PIC  X(01)    VALUE SPACES.   02240001
022500         10  DL-D1-DATE-1-CCYY      PIC  X(04)    VALUE SPACES.   02250001
022600     05  FILLER                     PIC  X(02)    VALUE SPACES.   02260001
022700     05  DL-D1-TIME-1.                                            02270001
022800         10  DL-D1-TIME-1-HH        PIC  X(02)    VALUE SPACES.   02280001
022900         10  DL-D1-TIME-1-COLON     PIC  X(01)    VALUE SPACES.   02290001
023000         10  DL-D1-TIME-1-MM        PIC  X(02)    VALUE SPACES.   02300001
023100     05  FILLER                     PIC  X(30)    VALUE SPACES.   02310001
023200                                                                  02320001
023300 01  HL-ERROR-HEADING-LINE.                                       02330001
023400     05  FILLER                      PIC  X(26)      VALUE SPACE. 02340001
023500     05  FILLER                      PIC  X(13)      VALUE        02350001
023600         'DATA IN ERROR'.                                         02360001
023700     05  FILLER                      PIC  X(05)      VALUE SPACE. 02370001
023800     05  FILLER                      PIC  X(10)      VALUE        02380001
023900         'DATA VALUE'.                                            02390001
024000     05  FILLER                      PIC  X(16)      VALUE SPACE. 02400001
024100     05  FILLER                      PIC  X(04)      VALUE        02410001
024200         'TYPE'.                                                  02420001
024300     05  FILLER                      PIC  X(03)      VALUE SPACE. 02430001
024400     05  FILLER                      PIC  X(07)      VALUE        02440001
024500         'MESSAGE'.                                               02450001
024600     05  FILLER                      PIC  X(48)      VALUE SPACE. 02460001
024700                                                                  02470001
024800 01  EL-ERROR-DETAIL-LINE.                                        02480001
024900     05  FILLER                     PIC  X(26)    VALUE SPACES.   02490001
025000     05  EL-DATA-ERROR              PIC  X(15)    VALUE SPACES.   02500001
025100     05  FILLER                     PIC  X(03)    VALUE SPACES.   02510001
025200     05  EL-DATA-VALUE              PIC  X(20)    VALUE SPACES.   02520001
025300     05  FILLER                     PIC  X(06)    VALUE SPACES.   02530001
025400     05  EL-DATA-TYPE               PIC  X(03)    VALUE SPACES.   02540001
025500     05  FILLER                     PIC  X(04)    VALUE SPACES.   02550001
025600     05  EL-DATA-MSG                PIC  X(50)    VALUE SPACES.   02560001
025700     05  FILLER                     PIC  X(05)    VALUE SPACES.   02570001
025800                                                                  02580001
025900 01  INVALID-HEADING-1.                                           02590001
026000     05  FILLER                      PIC  X(04)      VALUE        02600001
026100         'RECD'.                                                  02610001
026200     05  FILLER                      PIC  X(03)      VALUE SPACE. 02620001
026300     05  FILLER                      PIC  X(04)      VALUE        02630001
026400         'TRN '.                                                  02640001
026500     05  FILLER                      PIC  X(120)     VALUE SPACE. 02650001
026600                                                                  02660001
026700 01  INVALID-HEADING-2.                                           02670001
026800     05  FILLER                      PIC  X(04)      VALUE        02680001
026900         'TYPE'.                                                  02690001
027000     05  FILLER                      PIC  X(03)      VALUE SPACE. 02700001
027100     05  FILLER                      PIC  X(04)      VALUE        02710001
027200         'TYPE'.                                                  02720001
027300     05  FILLER                      PIC  X(03)      VALUE SPACES.02730001
027400     05  FILLER                      PIC  X(13)      VALUE        02740001
027500         'DATA IN ERROR'.                                         02750001
027600     05  FILLER                      PIC  X(10)      VALUE SPACE. 02760001
027700     05  FILLER                      PIC  X(10)      VALUE        02770001
027800         'DATA VALUE'.                                            02780001
027900     05  FILLER                      PIC  X(12)      VALUE SPACE. 02790001
028000     05  FILLER                      PIC  X(04)      VALUE        02800001
028100         'TYPE'.                                                  02810001
028200     05  FILLER                      PIC  X(04)      VALUE SPACE. 02820001
028300     05  FILLER                      PIC  X(07)      VALUE        02830001
028400         'MESSAGE'.                                               02840001
028500     05  FILLER                      PIC  X(58)      VALUE SPACE. 02850001
028600                                                                  02860001
028700 01  INVALID-DETAIL-1.                                            02870001
028800     05  INVALID-RECD-TYPE          PIC  X(06)    VALUE SPACES.   02880001
028900     05  FILLER                     PIC  X(03)    VALUE SPACES.   02890001
029000     05  INVALID-TRN-TYPE           PIC  X(01)    VALUE SPACES.   02900001
029100     05  FILLER                     PIC  X(04)    VALUE SPACES.   02910001
029200     05  INVALID-DATA-ERROR         PIC  X(15)    VALUE SPACES.   02920001
029300     05  FILLER                     PIC  X(08)    VALUE SPACES.   02930001
029400     05  INVALID-DATA-VALUE         PIC  X(20)    VALUE SPACES.   02940001
029500     05  FILLER                     PIC  X(02)    VALUE SPACES.   02950001
029600     05  INVALID-DATA-TYPE          PIC  X(03)    VALUE SPACES.   02960001
029700     05  FILLER                     PIC  X(05)    VALUE SPACES.   02970001
029800     05  INVALID-DATA-MSG           PIC  X(50)    VALUE SPACES.   02980001
029900     05  FILLER                     PIC  X(15)    VALUE SPACES.   02990001
030000                                                                  03000001
030100 01  TRL-HEADING-LINE-1.                                          03010001
030200     05  FILLER                      PIC  X(31)      VALUE        03020001
030300         'A = ADD, C = CHANGE, D = DELETE'.                       03030001
030400     05  FILLER                      PIC  X(101)     VALUE SPACE. 03040001
030500                                                                  03050001
030600 01  ER-END-OF-REPORT-LINE.                                       03060001
030700     05  FILLER                     PIC  X(54)    VALUE SPACE.    03070001
030800     05  FILLER                     PIC  X(25)    VALUE           03080001
030900         '***** END OF REPORT *****'.                             03090001
031000     05  FILLER                     PIC  X(53)    VALUE SPACE.    03100001
031100                                                                  03110001
031200 01  EP-EMPTY-REPORT-LINE.                                        03120001
031300     05  FILLER                     PIC  X(25)    VALUE           03130001
031400         '******* NO DATA *********'.                             03140001
031500     05  FILLER                     PIC  X(107)   VALUE SPACE.    03150001
031600                                                                  03160001
031700 01  PS-PROGRAM-SWITCHES.                                         03170001
031800     05  PS-EOF-ERROR-FILE-SW       PIC  X(01)    VALUE SPACE.    03180001
031900         88  PS-EOF-ERROR-FILE                    VALUE 'Y'.      03190001
032000     05  PS-NEW-PAGE-SW             PIC  X(01)    VALUE SPACE.    03200001
032100         88  PS-NEW-PAGE                          VALUE 'Y'.      03210001
032200         88  PS-NEW-PAGE-NO                       VALUE 'N'.      03220001
032300     05  PS-DETAIL-SW               PIC  X(01)    VALUE 'Y'.      03230001
032400         88  PS-DETAIL                            VALUE 'Y'.      03240001
032500         88  PS-DETAIL-NO                         VALUE 'N'.      03250001
032600                                                                  03260001
032700 01 PC-PROGRAM-CONSTANTS.                                         03270001
032800     05  PC-PAGE-SIZE-054           PIC S9(04)    VALUE +054      03280001
032900                                                  COMP SYNC.      03290001
033000     05  PC-PAGE-SIZE-060           PIC S9(04)    VALUE +060      03300001
033100                                                  COMP SYNC.      03310001
033200     05  PC-HEADING-SIZE            PIC S9(04)    VALUE +6        03320001
033300                                                  COMP SYNC.      03330001
033400     05  PC-MAX-RETRIES             PIC S9(04)    VALUE +3        03340001
033500                                                  COMP SYNC.      03350001
033600     05  PC-MAX-TABLE-ENTRIES       PIC S9(04)    VALUE +20       03360001
033700                                                  COMP SYNC.      03370001
033800     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           03380001
033900         'TRKRP231'.                                              03390001
034000     05  PC-A                       PIC  X(01)    VALUE 'A'.      03400001
034100     05  PC-01                      PIC  X(02)    VALUE '01'.     03410001
034200     05  PC-DEFAULT-DATE            PIC  X(10)    VALUE           03420001
034300         '01 01 0001'.                                            03430001
034400     05  PC-DEFAULT-TIME            PIC  X(05)    VALUE           03440001
034500         '00 00'.                                                 03450001
034600                                                                  03460001
034700 01  PV-PROGRAM-VARIABLES.                                        03470001
034800     05  PV-LINES-USED              PIC S9(04)    VALUE ZERO      03480001
034900                                                  COMP SYNC.      03490001
035000     05  PV-DELY-DTE-PREV           PIC  X(08)    VALUE SPACES.   03500001
035100     05  PV-TRN-TYPE-PREV           PIC  X(01)    VALUE SPACES.   03510001
035200     05  PV-REC-TYP-CDE-PREV        PIC  X(06)    VALUE SPACES.   03520001
035300         88 PV-ADU-REC-TYP-CDE-ADU       VALUE 'ADU  '.           03530001
035400         88 PV-ADD-REC-TYP-CDE-ADD       VALUE 'ADD  '.           03540001
035500         88 PV-ETA-REC-TYP-CDE-ETA       VALUE 'ETA  '.           03550001
035600     05  PV-PREV-CONTNR-ID          PIC  X(15)    VALUE SPACES.   03560001
035700     05  PV-PREV-TRN-TYP            PIC  X(01)    VALUE SPACES.   03570001
035800     05  PV-PREV-EXTL-REF-NBR       PIC  X(15)    VALUE SPACES.   03580008
035900     05  PV-BLANK-LINE              PIC  X(132)   VALUE SPACES.   03590001
036000     05  PV-NO-OF-POS-IN-ERROR      PIC  S9(06)   VALUE ZEROES.   03600001
036100     05  PV-PAGE-COUNT              PIC  9(05)    VALUE ZERO.     03610001
036200                                                                  03620001
036300 01  SD-SYSTEM-DATE.                                              03630001
036400     05  SD-SYSTEM-DATE-YY          PIC  9(02)      VALUE ZERO.   03640001
036500     05  SD-SYSTEM-DATE-MM          PIC  9(02)      VALUE ZERO.   03650001
036600     05  SD-SYSTEM-DATE-DD          PIC  9(02)      VALUE ZERO.   03660001
036700                                                                  03670001
036800 01  ST-SYSTEM-TIME.                                              03680001
036900     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   03690001
037000     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   03700001
037100     05  FILLER                     PIC  9(04)      VALUE ZERO.   03710001
037200                                                                  03720001
037300******************************************************************03730001
037400 PROCEDURE DIVISION.                                              03740001
037500******************************************************************03750001
037600                                                                  03760001
037700*----------------------------------------------------------------*03770001
037800* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     03780001
037900*      PROGRAM.                                                   03790001
038000*----------------------------------------------------------------*03800001
038100                                                                  03810001
038200 0000-PROGRAM-MAINLINE.                                           03820001
038300                                                                  03830001
038400     PERFORM 1000-INITIALIZE.                                     03840001
038500                                                                  03850001
038600     IF PS-DETAIL-NO                                              03860001
038700        CONTINUE                                                  03870001
038800     ELSE                                                         03880001
038900        PERFORM 2000-PROCESS-REPORT-DATA                          03890001
039000          UNTIL PS-EOF-ERROR-FILE.                                03900001
039100                                                                  03910001
039200     PERFORM 9000-EOJ-ROUTINE.                                    03920001
039300                                                                  03930001
039400     STOP RUN.                                                    03940001
039500                                                                  03950001
039600******************************************************************03960001
039700*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    03970001
039800*    -- OPEN FILES                                                03980001
039900*    -- SET UP AND PRINT REPORT HEADINGS                          03990001
040000******************************************************************04000001
040100                                                                  04010001
040200 1000-INITIALIZE.                                                 04020001
040300                                                                  04030001
040400     OPEN INPUT  ERROR-FILE                                       04040001
040500          OUTPUT ERROR-REPORT-FILE.                               04050001
040600                                                                  04060001
040700     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04070001
040800     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04080001
040900                                                                  04090001
041000     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04100001
041100     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04110001
041200     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04120001
041300     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04130001
041400     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04140001
041500                                                                  04150001
041600     MOVE PC-CURRENT-PROGRAM-NAME                                 04160001
041700                                 TO DP132O-PROGRAM-NAME.          04170001
041800                                                                  04180001
041900     MOVE 1                      TO DP132O-REPORT-NUMBER.         04190001
042000                                                                  04200001
042100     INITIALIZE     PS-NEW-PAGE-SW.                               04210001
042200                                                                  04220001
042300     PERFORM 7000-READ-ERROR-FILE UNTIL                           04230001
042400             PS-EOF-ERROR-FILE OR                                 04240001
042500            (TR231-RPT-TYP-ERROR AND                              04250001
042600             NOT TR231-REC-TYP-HDR-CDE-HDR).                      04260001
042700                                                                  04270001
042800     IF PS-EOF-ERROR-FILE                                         04280001
042900        CONTINUE                                                  04290001
043000     ELSE                                                         04300001
043100        MOVE TR231-CONTNR-ID  TO DL-C1-CONTAINER                  04310001
043200                                 PV-PREV-CONTNR-ID                04320001
043300        MOVE TR231-TRN-TYP    TO PV-PREV-TRN-TYP                  04330001
043400        MOVE TR231-EXTL-REF-NBR                                   04340008
043500                              TO PV-PREV-EXTL-REF-NBR             04350008
043600        MOVE TR231-ETA-CARR-SCAC-ID                               04360001
043700                              TO DL-C1-CARRIER-SCAC               04370001
043800        MOVE TR231-ETA-IMPRT-VEH-NM                               04380001
043900                              TO DL-C1-VESSEL-NAME                04390001
044000        MOVE TR231-ETA-IMPRT-TRIP-ID                              04400001
044100                              TO DL-C1-VOYAGE-NBR                 04410001
044200        MOVE TR231-ETA-TRIP-TYP-CDE-MOM                           04420001
044300                              TO DL-C1-TRIP-TYPE                  04430001
044400     END-IF.                                                      04440001
044500                                                                  04450001
044600     PERFORM  8000-WRITE-PAGE-HEADINGS.                           04460001
044700                                                                  04470001
044800     IF TR231-ERROR-TYPE = 'EMT' OR                               04480001
044900           PS-EOF-ERROR-FILE                                      04490001
045000        SET PS-DETAIL-NO TO TRUE                                  04500001
045100     ELSE                                                         04510001
045200        PERFORM 2025-BUILD-ERROR-RPT-DATA                         04520001
045300     END-IF.                                                      04530001
045400                                                                  04540001
045500****************************************************************  04550001
045600*  PROCESSING FOR ERROR RECORDS.                                  04560001
045700******************************************************************04570001
045800                                                                  04580001
045900 2000-PROCESS-REPORT-DATA.                                        04590001
046000                                                                  04600001
046100     MOVE SPACES TO TR231-RPT-TYP.                                04610001
046200                                                                  04620001
046300     PERFORM 7000-READ-ERROR-FILE UNTIL                           04630001
046400             PS-EOF-ERROR-FILE OR                                 04640001
046500            (TR231-RPT-TYP-ERROR AND                              04650001
046600             NOT TR231-REC-TYP-HDR-CDE-HDR)                       04660001
046700                                                                  04670001
046800     IF PS-EOF-ERROR-FILE                                         04680001
046900        CONTINUE                                                  04690001
047000     ELSE                                                         04700001
047100        IF TR231-RPT-TYP-ERROR                                    04710001
047200           PERFORM 2025-BUILD-ERROR-RPT-DATA                      04720001
047300        END-IF                                                    04730001
047400     END-IF.                                                      04740001
047500                                                                  04750001
047600******************************************************************04760001
047700*  BUILD THE LINES FOR THE REPORT.                                04770001
047800******************************************************************04780001
047900                                                                  04790001
048000 2025-BUILD-ERROR-RPT-DATA.                                       04800001
048100                                                                  04810001
048200     IF TR231-REC-TYP-ADU-CDE-ADU                                 04820001
048300        PERFORM 3100-MOVE-ADU-TO-DETAIL                           04830001
048400     END-IF.                                                      04840001
048500                                                                  04850001
048600     IF TR231-REC-TYP-ADURD-CDE-ADURDA                            04860003
048700        PERFORM 3200-MOVE-ADURD-TO-DETAIL                         04870004
048800     END-IF.                                                      04880003
048900                                                                  04890003
049000     IF TR231-REC-TYP-ETA-CDE-ETA                                 04900001
049100        PERFORM 3300-MOVE-ETA-TO-DETAIL                           04910001
049200     END-IF.                                                      04920001
049300                                                                  04930001
049400*    *********************************************                04940001
049500*    * CLEAN UP DATE/TIME FIELDS BEFORE PRINT    *                04950001
049600*    *********************************************                04960001
049700     IF DL-D1-DATE-1-MM      NOT NUMERIC OR                       04970001
049800        DL-D1-DATE-1       = PC-DEFAULT-DATE                      04980001
049900        MOVE SPACES TO DL-D1-DATE-1                               04990001
050000     ELSE                                                         05000001
050100        MOVE '/'   TO DL-D1-DATE-1-SLASH-1                        05010001
050200                      DL-D1-DATE-1-SLASH-2                        05020001
050300     END-IF.                                                      05030001
050400                                                                  05040001
050500*    IF DL-D1-DATE-2-MM      NOT NUMERIC OR                       05050001
050600*       DL-D1-DATE-2       = PC-DEFAULT-DATE                      05060001
050700*       MOVE SPACES TO DL-D1-DATE-2                               05070001
050800*    ELSE                                                         05080001
050900*       MOVE '/'   TO DL-D1-DATE-2-SLASH-1                        05090001
051000*                     DL-D1-DATE-2-SLASH-2                        05100001
051100*    END-IF.                                                      05110001
051200                                                                  05120001
051300     IF DL-D1-TIME-1-HH      NOT NUMERIC OR                       05130001
051400        DL-D1-TIME-1       = PC-DEFAULT-TIME                      05140001
051500        MOVE SPACES TO DL-D1-TIME-1                               05150001
051600     ELSE                                                         05160001
051700        MOVE ':' TO DL-D1-TIME-1-COLON                            05170001
051800     END-IF.                                                      05180001
051900                                                                  05190001
052000*    IF DL-D1-TIME-2-HH      NOT NUMERIC OR                       05200001
052100*       DL-D1-TIME-2       = PC-DEFAULT-TIME                      05210001
052200*       MOVE SPACES TO DL-D1-TIME-2                               05220001
052300*    ELSE                                                         05230001
052400*       MOVE ':' TO DL-D1-TIME-2-COLON                            05240001
052500*    END-IF.                                                      05250001
052600*    *********************************************                05260001
052700                                                                  05270001
052800                                                                  05280001
052900     IF TR231-ERROR-TYPE = 'EDI'                                  05290001
053000        PERFORM 3800-MOVE-ERROR-TO-DETAIL                         05300001
053100     END-IF.                                                      05310001
053200                                                                  05320001
053300     PERFORM 2050-CHECK-FOR-PREVIOUS.                             05330001
053400                                                                  05340001
053500     PERFORM 8100-WRITE-ERROR-RPT-DETAIL.                         05350001
053600                                                                  05360001
053700****************************************************************  05370001
053800*  CHECKS TO SEE IF THERE IS A BREAK, IF THERE IS NOT             05380001
053900*  DATA IS NOT REPEATED FOR CONTAINER-NO                          05390001
054000* *************************************************************** 05400001
054100                                                                  05410001
054200 2050-CHECK-FOR-PREVIOUS.                                         05420001
054300                                                                  05430001
054400                                                                  05440001
054500     IF ((TR231-CONTNR-ID  = PV-PREV-CONTNR-ID  AND               05450011
054600          TR231-CONTNR-ID NOT EQUAL SPACES      AND               05460012
054700          TR231-TRN-TYP    = PV-PREV-TRN-TYP)    OR               05470011
054800         (TR231-CONTNR-ID  = SPACES   AND                         05480011
054900          TR231-EXTL-REF-NBR                                      05490009
055000                           = PV-PREV-EXTL-REF-NBR)) AND           05500011
055100        (TR231-ERROR-TYPE   NOT =  'EDI')                         05510001
055200        CONTINUE                                                  05520001
055300     ELSE                                                         05530001
055400        MOVE TR231-CONTNR-ID     TO DL-C1-CONTAINER               05540001
055500                                    PV-PREV-CONTNR-ID             05550001
055600        MOVE TR231-TRN-TYP    TO PV-PREV-TRN-TYP                  05560001
055700        MOVE TR231-EXTL-REF-NBR                                   05570008
055800                              TO PV-PREV-EXTL-REF-NBR             05580008
055900        MOVE TR231-ETA-CARR-SCAC-ID                               05590001
056000                              TO DL-C1-CARRIER-SCAC               05600001
056100        MOVE TR231-ETA-IMPRT-VEH-NM                               05610001
056200                              TO DL-C1-VESSEL-NAME                05620001
056300        MOVE TR231-ETA-IMPRT-TRIP-ID                              05630001
056400                              TO DL-C1-VOYAGE-NBR                 05640001
056500        MOVE TR231-ETA-TRIP-TYP-CDE-MOM                           05650001
056600                              TO DL-C1-TRIP-TYPE                  05660001
056700                                                                  05670001
056800        SET PS-NEW-PAGE         TO TRUE                           05680001
056900        PERFORM  8000-WRITE-PAGE-HEADINGS                         05690001
057000     END-IF.                                                      05700001
057100                                                                  05710001
057200                                                                  05720001
057300******************************************************************05730001
057400* MOVE ADU DATA TO REPORT DETAIL LINE                             05740001
057500******************************************************************05750001
057600 3100-MOVE-ADU-TO-DETAIL.                                         05760001
057700                                                                  05770001
057800     INITIALIZE   DL-D1-DETAIL-LINE.                              05780001
057900                                                                  05790001
058000     MOVE TR231-REC-TYP-ADU-CDE       TO DL-D1-RECD-TYPE.         05800001
058100     MOVE TR231-TRN-TYP               TO DL-D1-TRN-TYP.           05810001
058200     IF TR231-PO-NBR = ZERO                                       05820001
058300       MOVE SPACES                    TO DL-D1-PO-NBR             05830001
058400     ELSE                                                         05840001
058500       MOVE TR231-PO-NBR              TO DL-D1-PO-NBR             05850001
058600     END-IF.                                                      05860001
058700     MOVE TR231-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05870001
058800     MOVE TR231-FOB-CDE               TO DL-D1-FOB-CDE.           05880001
058900     MOVE TR231-EXTENT-SCAC-CDE       TO DL-D1-KOHLS-SCAC-CDE.    05890001
059000                                                                  05900001
059100     MOVE TR231-ADU-ACTL-DEST-POE-NM  TO DL-D1-POE-NM.            05910001
059200                                                                  05920001
059300     MOVE TR231-ADU-ACTL-POE-DELY-DTE (1:4) TO                    05930001
059400         DL-D1-DATE-1-CCYY.                                       05940001
059500     MOVE TR231-ADU-ACTL-POE-DELY-DTE (5:2) TO                    05950001
059600         DL-D1-DATE-1-MM.                                         05960001
059700     MOVE TR231-ADU-ACTL-POE-DELY-DTE (7:2) TO                    05970001
059800         DL-D1-DATE-1-DD.                                         05980001
059900                                                                  05990001
060000     MOVE TR231-ADU-ACTL-POE-DELY-TM (1:2) TO                     06000001
060100           DL-D1-TIME-1-HH.                                       06010001
060200     MOVE TR231-ADU-ACTL-POE-DELY-TM (3:2) TO                     06020001
060300           DL-D1-TIME-1-MM.                                       06030001
060400                                                                  06040001
060500     MOVE 'ACTUAL PORT OF ENTRY         '                         06050001
060600                             TO HL-D2-POE-COL-HDR.                06060001
060700     MOVE 'ATA              '                                     06070001
060800                             TO HL-D2-TIME-1-COL-HDR.             06080001
060900*    MOVE SPACES             TO HL-D2-LBD-COL-HDR.                06090001
061000*    MOVE SPACES             TO HL-D2-TIME-2-COL-HDR.             06100001
061100                                                                  06110001
061200                                                                  06120001
061300     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           06130001
061400                                                                  06140001
061500******************************************************************06150003
061600* MOVE ADURD DATA TO REPORT DETAIL LINE                           06160003
061700******************************************************************06170003
061800 3200-MOVE-ADURD-TO-DETAIL.                                       06180003
061900                                                                  06190003
062000     INITIALIZE   DL-D1-DETAIL-LINE.                              06200003
062100                                                                  06210003
062200     MOVE TR231-REC-TYP-ADU-CDE(1:3)  TO DL-D1-RECD-TYPE.         06220005
062300     MOVE TR231-TRN-TYP               TO DL-D1-TRN-TYP.           06230003
062400     IF TR231-PO-NBR = ZERO                                       06240003
062500       MOVE SPACES                    TO DL-D1-PO-NBR             06250003
062600     ELSE                                                         06260003
062700       MOVE TR231-PO-NBR              TO DL-D1-PO-NBR             06270003
062800     END-IF.                                                      06280003
062900     MOVE TR231-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      06290003
063000     MOVE TR231-FOB-CDE               TO DL-D1-FOB-CDE.           06300003
063100     MOVE TR231-EXTENT-SCAC-CDE       TO DL-D1-KOHLS-SCAC-CDE.    06310003
063200                                                                  06320003
063300     MOVE TR231-ADURD-ACTL-DEST-POE-NM  TO DL-D1-POE-NM.          06330003
063400                                                                  06340003
063500     MOVE TR231-ADURD-ACTL-POE-DELY-DTE (1:4) TO                  06350003
063600         DL-D1-DATE-1-CCYY.                                       06360003
063700     MOVE TR231-ADURD-ACTL-POE-DELY-DTE (5:2) TO                  06370003
063800         DL-D1-DATE-1-MM.                                         06380003
063900     MOVE TR231-ADURD-ACTL-POE-DELY-DTE (7:2) TO                  06390003
064000         DL-D1-DATE-1-DD.                                         06400003
064100                                                                  06410003
064200     MOVE TR231-ADURD-ACTL-POE-DELY-TM (1:2) TO                   06420003
064300           DL-D1-TIME-1-HH.                                       06430003
064400     MOVE TR231-ADURD-ACTL-POE-DELY-TM (3:2) TO                   06440003
064500           DL-D1-TIME-1-MM.                                       06450003
064600                                                                  06460003
064700     MOVE 'ACTUAL PORT OF ENTRY         '                         06470003
064800                             TO HL-D2-POE-COL-HDR.                06480003
064900     MOVE 'ATA              '                                     06490003
065000                             TO HL-D2-TIME-1-COL-HDR.             06500003
065100*    MOVE SPACES             TO HL-D2-LBD-COL-HDR.                06510003
065200*    MOVE SPACES             TO HL-D2-TIME-2-COL-HDR.             06520003
065300                                                                  06530003
065400                                                                  06540003
065500     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           06550003
065600                                                                  06560003
065700******************************************************************06570003
065800*MOVE ETA DATA TO REPORT DETAIL LINE                              06580001
065900******************************************************************06590001
066000                                                                  06600001
066100 3300-MOVE-ETA-TO-DETAIL.                                         06610001
066200                                                                  06620001
066300     INITIALIZE   DL-D1-DETAIL-LINE.                              06630001
066400                                                                  06640001
066500     MOVE TR231-REC-TYP-ETA-CDE       TO DL-D1-RECD-TYPE.         06650001
066600     MOVE TR231-TRN-TYP               TO DL-D1-TRN-TYP.           06660001
066700     IF TR231-PO-NBR = ZERO                                       06670001
066800       MOVE SPACES                    TO DL-D1-PO-NBR             06680001
066900     ELSE                                                         06690001
067000       MOVE TR231-PO-NBR              TO DL-D1-PO-NBR             06700001
067100     END-IF.                                                      06710001
067200     MOVE TR231-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      06720001
067300     MOVE TR231-FOB-CDE               TO DL-D1-FOB-CDE.           06730001
067400     MOVE TR231-EXTENT-SCAC-CDE       TO DL-D1-KOHLS-SCAC-CDE.    06740001
067500                                                                  06750001
067600     MOVE TR231-ETA-DEST-POE-NM       TO DL-D1-POE-NM.            06760001
067700                                                                  06770001
067800     MOVE TR231-ETA-EST-POE-DELY-DTE (1:4) TO                     06780001
067900         DL-D1-DATE-1-CCYY.                                       06790001
068000     MOVE TR231-ETA-EST-POE-DELY-DTE (5:2) TO                     06800001
068100         DL-D1-DATE-1-MM.                                         06810001
068200     MOVE TR231-ETA-EST-POE-DELY-DTE (7:2) TO                     06820001
068300         DL-D1-DATE-1-DD.                                         06830001
068400                                                                  06840001
068500     MOVE TR231-ETA-EST-POE-DELY-TM (1:2) TO                      06850001
068600           DL-D1-TIME-1-HH.                                       06860001
068700     MOVE TR231-ETA-EST-POE-DELY-TM (3:2) TO                      06870001
068800           DL-D1-TIME-1-MM.                                       06880001
068900                                                                  06890001
069000*    MOVE TR231-ETA-EST-LBD-NM        TO                          06900001
069100*        DL-D1-EST-LBD-NM.                                        06910001
069200                                                                  06920001
069300*    MOVE TR231-ETA-EST-LBD-DTE (1:4) TO                          06930001
069400*        DL-D1-DATE-2-CCYY.                                       06940001
069500*    MOVE TR231-ETA-EST-LBD-DTE (5:2) TO                          06950001
069600*        DL-D1-DATE-2-MM.                                         06960001
069700*    MOVE TR231-ETA-EST-LBD-DTE (7:2) TO                          06970001
069800*        DL-D1-DATE-2-DD.                                         06980001
069900                                                                  06990001
070000*    MOVE TR231-ETA-EST-LBD-TM (1:2) TO                           07000001
070100*          DL-D1-TIME-2-HH.                                       07010001
070200*    MOVE TR231-ETA-EST-LBD-TM (3:2) TO                           07020001
070300*          DL-D1-TIME-2-MM.                                       07030001
070400                                                                  07040001
070500     MOVE 'ESTIMATED PORT OF ENTRY      '                         07050001
070600                             TO HL-D2-POE-COL-HDR.                07060001
070700     MOVE 'ETA              '                                     07070001
070800                             TO HL-D2-TIME-1-COL-HDR.             07080001
070900*    MOVE 'EST LBD DEST '                                         07090001
071000*                            TO HL-D2-LBD-COL-HDR.                07100001
071100*    MOVE 'EST LB DATE  TIME'                                     07110001
071200*                            TO HL-D2-TIME-2-COL-HDR.             07120001
071300                                                                  07130001
071400     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           07140001
071500                                                                  07150001
071600******************************************************************07160001
071700*3800-MOVE-ERROR-TO-DETAIL.                                       07170001
071800******************************************************************07180001
071900                                                                  07190001
072000 3800-MOVE-ERROR-TO-DETAIL.                                       07200001
072100                                                                  07210001
072200     MOVE TR231-DATA-IN-ERROR    TO EL-DATA-ERROR.                07220001
072300     MOVE TR231-DATA-VALUE-NUM   TO EL-DATA-VALUE.                07230001
072400     MOVE TR231-ERROR-TYPE       TO EL-DATA-TYPE.                 07240001
072500     MOVE TR231-ERROR-MSG        TO EL-DATA-MSG.                  07250001
072600                                                                  07260001
072700******************************************************************07270001
072800*  READ THE ERROR-FILE                                           *07280001
072900******************************************************************07290001
073000 7000-READ-ERROR-FILE.                                            07300001
073100                                                                  07310001
073200     READ ERROR-FILE                                              07320001
073300        INTO TR231-RECORD                                         07330001
073400           AT END                                                 07340001
073500              SET PS-EOF-ERROR-FILE TO TRUE.                      07350001
073600                                                                  07360001
073700     IF TR231-REC-TYP-HDR-CDE-HDR                                 07370001
073800        MOVE TR231-HDR-CONSOL-TRNS-DTE (5:2) TO                   07380001
073900           HL-P1-TRANS-MM                                         07390001
074000        MOVE TR231-HDR-CONSOL-TRNS-DTE (7:2) TO                   07400001
074100           HL-P1-TRANS-DD                                         07410001
074200        MOVE TR231-HDR-CONSOL-TRNS-DTE (3:2) TO                   07420001
074300           HL-P1-TRANS-YY                                         07430001
074400        MOVE TR231-HDR-CONSOL-TRNS-TM (1:2) TO                    07440001
074500           HL-P1-TRANS-TIME-HH                                    07450001
074600        MOVE TR231-HDR-CONSOL-TRNS-TM (3:2) TO                    07460001
074700           HL-P1-TRANS-TIME-MM                                    07470001
074800        MOVE TR231-HDR-CONSOL-FIL-ID TO                           07480001
074900           HL-P1-FILE-ID                                          07490001
075000        MOVE TR231-HDR-LOAD-DTE (5:2) TO                          07500001
075100           HL-P2-LOAD-MM                                          07510001
075200        MOVE TR231-HDR-LOAD-DTE (7:2) TO                          07520001
075300           HL-P2-LOAD-DD                                          07530001
075400        MOVE TR231-HDR-LOAD-DTE (3:2) TO                          07540001
075500           HL-P2-LOAD-YY                                          07550001
075600        MOVE TR231-HDR-LOAD-TM (1:2) TO                           07560001
075700           HL-P2-LOAD-TIME-HH                                     07570001
075800        MOVE TR231-HDR-LOAD-TM (3:2) TO                           07580001
075900           HL-P2-LOAD-TIME-MM                                     07590001
076000        MOVE TR231-HDR-CONSOL-ENTNME TO                           07600001
076100           HL-P2-ENTITY                                           07610001
076200        MOVE TR231-REC-TYP-HDR-CDE TO                             07620001
076300           PV-REC-TYP-CDE-PREV                                    07630001
076400     END-IF.                                                      07640001
076500                                                                  07650001
076600***************************************************************** 07660001
076700*  PRINT THE HEADINGS ON EACH PAGE.                             * 07670001
076800***************************************************************** 07680001
076900 8000-WRITE-PAGE-HEADINGS.                                        07690001
077000                                                                  07700001
077100     ADD 1                TO PV-PAGE-COUNT.                       07710001
077200     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  07720001
077300                                                                  07730001
077400     IF PV-PAGE-COUNT > 1                                         07740001
077500        PERFORM                                                   07750001
077600           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          07760001
077700           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 07770001
077800                                                                  07780001
077900           WRITE ERROR-REPORT-RECORD FROM PV-BLANK-LINE           07790001
078000              AFTER ADVANCING 1 LINE                              07800001
078100                                                                  07810001
078200        END-PERFORM                                               07820001
078300                                                                  07830001
078400        IF PV-LINES-USED > PC-PAGE-SIZE-060                       07840001
078500           WRITE ERROR-REPORT-RECORD FROM TRL-HEADING-LINE-1      07850001
078600              AFTER ADVANCING 2 LINES                             07860001
078700        END-IF                                                    07870001
078800     END-IF.                                                      07880001
078900                                                                  07890001
079000     WRITE ERROR-REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS07900001
079100        AFTER ADVANCING PAGE.                                     07910001
079200                                                                  07920001
079300     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       07930001
079400                                                                  07940001
079500     WRITE ERROR-REPORT-RECORD FROM HL-P1-PAGE-HEADER-1           07950001
079600        AFTER ADVANCING 1 LINE.                                   07960001
079700                                                                  07970001
079800     WRITE ERROR-REPORT-RECORD FROM HL-P2-PAGE-HEADER-2           07980001
079900        AFTER ADVANCING 1 LINE.                                   07990001
080000                                                                  08000001
080100     WRITE ERROR-REPORT-RECORD FROM HL-C1-CNTNR-HEADER-1          08010001
080200        AFTER ADVANCING 2 LINES.                                  08020001
080300                                                                  08030001
080400     IF TR231-REC-TYP-ADURD-CDE-ADURDA                            08040002
080500        MOVE TR231-ADURD-TEXT-MSG1    TO HL-C2-TEXT-MSG           08050002
080600     ELSE                                                         08060002
080700         MOVE SPACES                  TO HL-C2-TEXT-MSG           08070002
080800     END-IF.                                                      08080002
080900                                                                  08090002
081000     WRITE ERROR-REPORT-RECORD FROM HL-C2-CNTNR-HEADER-2          08100001
081100        AFTER ADVANCING 1 LINES.                                  08110001
081200                                                                  08120001
081300     WRITE ERROR-REPORT-RECORD FROM DL-C1-CNTNR-LINE              08130001
081400        AFTER ADVANCING 1 LINES.                                  08140001
081500                                                                  08150001
081600     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   08160001
081700                                                                  08170001
081800******************************************************************08180001
081900*  WRITE THE ERROR REPORT DETAIL RECORD.                          08190001
082000******************************************************************08200001
082100 8100-WRITE-ERROR-RPT-DETAIL.                                     08210001
082200                                                                  08220001
082300     IF PV-LINES-USED >= PC-PAGE-SIZE-054                         08230001
082400        SET PS-NEW-PAGE  TO TRUE                                  08240001
082500        PERFORM 8000-WRITE-PAGE-HEADINGS                          08250001
082600     END-IF.                                                      08260001
082700                                                                  08270001
082800     EVALUATE TRUE                                                08280001
082900                                                                  08290001
083000       WHEN TR231-REC-TYP-ADU-CDE-ADU                             08300001
083100       WHEN TR231-REC-TYP-ADURD-CDE-ADURDA                        08310007
083200       WHEN TR231-REC-TYP-ETA-CDE-ETA                             08320001
083300        PERFORM 8200-WRITE-DETAIL-RECORD                          08330001
083400                                                                  08340001
083500       WHEN TR231-ERROR-TYPE = 'EDI'                              08350001
083600        WRITE ERROR-REPORT-RECORD FROM HL-ERROR-HEADING-LINE      08360001
083700           AFTER ADVANCING 1 LINES                                08370001
083800        WRITE ERROR-REPORT-RECORD FROM EL-ERROR-DETAIL-LINE       08380001
083900           AFTER ADVANCING 1 LINES                                08390001
084000        ADD 2 TO PV-LINES-USED                                    08400001
084100        SET PS-NEW-PAGE-NO TO TRUE                                08410001
084200        MOVE TR231-REC-TYP-HDR-CDE TO  PV-REC-TYP-CDE-PREV        08420001
084300                                                                  08430001
084400       WHEN OTHER                                                 08440001
084500        PERFORM 8500-INVALID-RECORD-TYPE                          08450001
084600                                                                  08460001
084700     END-EVALUATE.                                                08470001
084800                                                                  08480001
084900******************************************************************08490001
085000*  PRINT DETAIL ERROR RECORD                                      08500001
085100******************************************************************08510001
085200                                                                  08520001
085300 8200-WRITE-DETAIL-RECORD.                                        08530001
085400                                                                  08540001
085500     IF TR231-REC-TYP-ETA-CDE = PV-REC-TYP-CDE-PREV AND           08550001
085600        PS-NEW-PAGE-NO                                            08560001
085700        CONTINUE                                                  08570001
085800     ELSE                                                         08580001
085900        WRITE ERROR-REPORT-RECORD FROM HL-D1-DETAIL-HEADER-1      08590001
086000           AFTER ADVANCING 2 LINES                                08600001
086100        WRITE ERROR-REPORT-RECORD FROM HL-D2-DETAIL-HEADER-2      08610001
086200           AFTER ADVANCING 1 LINES                                08620001
086300        ADD 3 TO PV-LINES-USED                                    08630001
086400     END-IF.                                                      08640001
086500                                                                  08650001
086600     WRITE ERROR-REPORT-RECORD FROM DL-D1-DETAIL-LINE             08660001
086700        AFTER ADVANCING 1 LINES.                                  08670001
086800     WRITE ERROR-REPORT-RECORD FROM HL-ERROR-HEADING-LINE         08680001
086900        AFTER ADVANCING 1 LINES.                                  08690001
087000     WRITE ERROR-REPORT-RECORD FROM EL-ERROR-DETAIL-LINE          08700001
087100        AFTER ADVANCING 1 LINES.                                  08710001
087200     ADD 3 TO PV-LINES-USED.                                      08720001
087300                                                                  08730001
087400     SET PS-NEW-PAGE-NO TO TRUE.                                  08740001
087500     MOVE TR231-REC-TYP-ADU-CDE TO  PV-REC-TYP-CDE-PREV.          08750001
087600                                                                  08760001
087700                                                                  08770001
087800******************************************************************08780001
087900* PRINT LINE WHEN RECORD TYPE INVALID                             08790001
088000******************************************************************08800001
088100                                                                  08810001
088200 8500-INVALID-RECORD-TYPE.                                        08820001
088300                                                                  08830001
088400     MOVE TR231-REC-TYP-HDR-CDE  TO INVALID-RECD-TYPE.            08840001
088500     MOVE TR231-TRN-TYP          TO INVALID-TRN-TYPE.             08850001
088600     MOVE TR231-DATA-IN-ERROR    TO INVALID-DATA-ERROR.           08860001
088700     MOVE TR231-DATA-VALUE-NUM   TO INVALID-DATA-VALUE.           08870001
088800     MOVE TR231-ERROR-TYPE       TO INVALID-DATA-TYPE.            08880001
088900     MOVE TR231-ERROR-MSG        TO INVALID-DATA-MSG.             08890001
089000                                                                  08900001
089100     IF TR231-REC-TYP-ETA-CDE = PV-REC-TYP-CDE-PREV AND           08910001
089200        PS-NEW-PAGE-NO                                            08920001
089300        CONTINUE                                                  08930001
089400     ELSE                                                         08940001
089500        WRITE ERROR-REPORT-RECORD FROM INVALID-HEADING-1          08950001
089600           AFTER ADVANCING 2 LINES                                08960001
089700                                                                  08970001
089800        WRITE ERROR-REPORT-RECORD FROM INVALID-HEADING-2          08980001
089900           AFTER ADVANCING 1 LINES                                08990001
090000                                                                  09000001
090100        ADD 3 TO PV-LINES-USED                                    09010001
090200                                                                  09020001
090300     END-IF.                                                      09030001
090400                                                                  09040001
090500     WRITE ERROR-REPORT-RECORD FROM INVALID-DETAIL-1              09050001
090600           AFTER ADVANCING 1 LINES.                               09060001
090700                                                                  09070001
090800     ADD 1 TO PV-LINES-USED.                                      09080001
090900     SET PS-NEW-PAGE-NO TO TRUE.                                  09090001
091000     MOVE TR231-REC-TYP-ETA-CDE TO  PV-REC-TYP-CDE-PREV.          09100001
091100                                                                  09110001
091200******************************************************************09120001
091300*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  09130001
091400*  THE CURSOR.                                                    09140001
091500******************************************************************09150001
091600 9000-EOJ-ROUTINE.                                                09160001
091700                                                                  09170001
091800     IF PS-DETAIL-NO                                              09180001
091900        WRITE ERROR-REPORT-RECORD FROM EP-EMPTY-REPORT-LINE       09190001
092000            AFTER ADVANCING 2 LINES                               09200001
092100                                                                  09210001
092200        WRITE ERROR-REPORT-RECORD FROM ER-END-OF-REPORT-LINE      09220001
092300            AFTER ADVANCING 2 LINES                               09230001
092400     ELSE                                                         09240001
092500        IF PV-LINES-USED > PC-PAGE-SIZE-060                       09250001
092600           PERFORM 8000-WRITE-PAGE-HEADINGS                       09260001
092700        END-IF                                                    09270001
092800                                                                  09280001
092900        WRITE ERROR-REPORT-RECORD FROM ER-END-OF-REPORT-LINE      09290001
093000            AFTER ADVANCING 2 LINES                               09300001
093100                                                                  09310001
093200        ADD 2 TO PV-LINES-USED                                    09320001
093300                                                                  09330001
093400        PERFORM                                                   09340001
093500           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          09350001
093600           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 09360001
093700                                                                  09370001
093800           WRITE ERROR-REPORT-RECORD FROM PV-BLANK-LINE           09380001
093900              AFTER ADVANCING 1 LINE                              09390001
094000                                                                  09400001
094100        END-PERFORM                                               09410001
094200                                                                  09420001
094300        IF PV-LINES-USED > PC-PAGE-SIZE-060                       09430001
094400           WRITE ERROR-REPORT-RECORD FROM TRL-HEADING-LINE-1      09440001
094500              AFTER ADVANCING 2 LINES                             09450001
094600        END-IF                                                    09460001
094700     END-IF.                                                      09470001
094800                                                                  09480001
094900     CLOSE ERROR-FILE                                             09490001
095000           ERROR-REPORT-FILE.                                     09500001
