000100*##############################################################   00010001
000200*    ARKRP029 - G/L INTERFACE REPORT                              00020009
000300*##############################################################   00030001
000400 IDENTIFICATION DIVISION.                                         00040001
000500 PROGRAM-ID.     ARKRP029.                                        00050009
000600 AUTHOR.         BASKAR SRINI.                                    00060012
000700 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00070012
000800 DATE-WRITTEN    09-07-11.                                        00080012
000900 DATE-COMPILED.                                                   00090001
001000/                                                                 00100001
001100 ENVIRONMENT DIVISION.                                            00110001
001200******************************************************************00120001
001300**DESC: G/L INTERFACE REPORT                                      00130001
001400* THIS REPORT WAS MOVED FROM TANDEM-RP6126CB.                     00140001
001500******************************************************************00150001
001600 CONFIGURATION SECTION.                                           00160011
001700                                                                  00170011
001800 SOURCE-COMPUTER.        IBM-3090.                                00180011
001900 OBJECT-COMPUTER.        IBM-3090.                                00190011
002000                                                                  00200011
002100 INPUT-OUTPUT SECTION.                                            00210011
002200                                                                  00220011
002300 FILE-CONTROL.                                                    00230011
002400                                                                  00240011
002500     SELECT FD-GLTR-UPDATE-FILE  ASSIGN TO INP01.                 00250011
002600     SELECT GL-IF-REPORT         ASSIGN TO RPT01.                 00260011
002700                                                                  00270011
002800******************************************************************00280011
002900 DATA DIVISION.                                                   00290011
003000******************************************************************00300011
003100                                                                  00310011
003200 FILE SECTION.                                                    00320011
003300 FD  FD-GLTR-UPDATE-FILE                                          00330011
003400     LABEL RECORDS ARE STANDARD                                   00340011
003500     BLOCK CONTAINS 0 RECORDS                                     00350011
003600     RECORD CONTAINS 184 CHARACTERS                               00360011
003700     DATA RECORD IS FD-GL-UPDATE-RECORD.                          00370011
003800                                                                  00380011
003900 01  FD-GL-UPDATE-RECORD         PIC X(184).                      00390011
004000                                                                  00400011
004100                                                                  00410011
004200 FD  GL-IF-REPORT                                                 00420011
004300     RECORDING MODE IS F                                          00430011
004400     BLOCK CONTAINS 0 RECORDS                                     00440011
004500     LABEL RECORDS ARE STANDARD.                                  00450011
004600                                                                  00460011
004700 01  GL-IF-RECORD                PIC X(132).                      00470011
004800                                                                  00480011
004900*                                                                 00490011
005000******************************************************************00500001
005100 WORKING-STORAGE              SECTION.                            00510001
005200******************************************************************00520001
005300*                     LOCAL WORKING STORAGE                       00530001
005400*                     ---------------------                       00540001
005500******************************************************************00550001
005600 01  WS-LOCAL-DATA.                                               00560004
005700     05 WS-DATA                       PIC X.                      00570016
005800     05 WS-PGM-NAME                   PIC X(08)  VALUE "ARKRP029".00580016
005900     05 WS-ERRORS                     PIC 9(10).                  00590016
006000     05 WS-RESULTS                    PIC S9(04) COMP.            00600016
006100     05 WS-HOLD-TYPE                  PIC X(04).                  00610016
006200     05 WS-HOLD-COMPANY               PIC 9(04).                  00620016
006300     05 WS-HOLD-DIVISION              PIC 9(04).                  00630016
006400     05 WS-HOLD-DEPARTMENT            PIC 9(04).                  00640016
006500     05 WS-HOLD-ACCOUNT               PIC 9(10).                  00650016
006600     05 WS-ACCOUNTTOT-DEBITS          PIC S9(14)V9(2)             00660016
006700                                      SIGN LEADING SEPARATE.      00670016
006800     05 WS-DEPARTMENTTOT-DEBITS       PIC S9(14)V9(2)             00680016
006900                                      SIGN LEADING SEPARATE.      00690016
007000     05 WS-DIVISIONTOT-DEBITS         PIC S9(14)V9(2)             00700016
007100                                      SIGN LEADING SEPARATE.      00710016
007200     05 WS-COMPANYTOT-DEBITS          PIC S9(14)V9(2)             00720016
007300                                      SIGN LEADING SEPARATE.      00730016
007400     05 WS-ACCOUNTTOT-CREDITS         PIC S9(14)V9(2)             00740016
007500                                      SIGN LEADING SEPARATE.      00750016
007600     05 WS-DEPARTMENTTOT-CREDITS      PIC S9(14)V9(2)             00760016
007700                                      SIGN LEADING SEPARATE.      00770016
007800     05 WS-DIVISIONTOT-CREDITS        PIC S9(14)V9(2)             00780016
007900                                      SIGN LEADING SEPARATE.      00790016
008000     05 WS-COMPANYTOT-CREDITS         PIC S9(14)V9(2)             00800016
008100                                      SIGN LEADING SEPARATE.      00810016
008200     05 WS-SUBTOT-DEBITS              PIC S9(14)V9(2)             00820016
008300                                      SIGN LEADING SEPARATE.      00830016
008400     05 WS-SUBTOT-CREDITS             PIC S9(14)V9(2)             00840016
008500                                      SIGN LEADING SEPARATE.      00850016
008600     05 WS-GRANDTOT-DEBITS            PIC S9(14)V9(2)             00860016
008700                                      SIGN LEADING SEPARATE.      00870016
008800     05 WS-GRANDTOT-CREDITS           PIC S9(14)V9(2)             00880016
008900                                      SIGN LEADING SEPARATE.      00890016
009000                                                                  00900001
009100 01  WS-LOCAL-CONSTANTS.                                          00910004
009200     05 WS-FILE-USED               PIC X     VALUE "Y".           00920016
009300     05 WS-END-OF-FILE             PIC X(02) VALUE "10".          00930016
009400     05 WS-GLTR-EOF                PIC X     VALUE "N".           00940016
009500        88 GLTR-EOF                          VALUE "Y".           00950016
009600     05 WS-HEADER-RECORD           PIC 9(06) VALUE ZEROS.         00960016
009700     05 WS-TRAILER-RECORD          PIC 9(06) VALUE 999999.        00970016
009800     05 PR-REPORT-LINES            PIC S9(04) COMP VALUE +0.      00980016
009900     05 PR-LINES-PAGE              PIC S9(04) COMP VALUE +0.      00990016
010000     05 PR-PAGE-COUNT              PIC S9(04) COMP VALUE +0.      01000016
010100     05 PR-REPORT-NBR              PIC S9(04) COMP VALUE +1.      01010016
010200*                                                                 01020009
010300                                                                  01030009
010400*** GL DATA LAYOUT - 184 BYTES.                                   01040009
010500     COPY ARWS030.                                                01050009
010600                                                                  01060009
010700*** STANDARD HEADER LINE - 132 BYTES.                             01070009
010800     COPY DPWS132O.                                               01080009
010900                                                                  01090009
011000/***********************************************************      01100002
011100 01  WS-REPORT-LINES.                                             01110011
011200     05 PR-REPORT-HEADER.                                         01120011
011300        10 FILLER             PIC X(45)    VALUE SPACE.                   
011400        10 FILLER             PIC X(40)                                   
011500                         VALUE "GENERAL LEDGER INTERFACE REPORT". 01130002
011200     05 PR-REPORT-HEADER-ISSCAG.                                  01120011
011300        10 FILLER             PIC X(01)    VALUE SPACE.                   
011400        10 FILLER             PIC X(33)                                   
011500                      VALUE "Issuer: 1010 A/R SUBJECT TO SEC I".  01130002
011300        10 FILLER             PIC X(04)    VALUE SPACE.                   
011400        10 FILLER             PIC X(50)                                   
011500            VALUE "Card Agreement: 1010 KOHL'S DEPARTMENT ST".    01130002
011600     05 PR-REPORT-HEADER-LINE1.                                   01140011
011700        10 FILLER             PIC X(01)    VALUE SPACE.           01150014
011800        10 FILLER             PIC X(07)    VALUE "Posting".       01160014
011900        10 FILLER             PIC X(05)    VALUE SPACES.          01170014
012000        10 FILLER             PIC X(07)    VALUE "Posting".       01180014
012100        10 FILLER             PIC X(22)    VALUE SPACES.          01190014
012200        10 FILLER             PIC X(03)    VALUE "G/L".           01200014
012300        10 FILLER             PIC X(06)    VALUE SPACES.          01210014
012400        10 FILLER             PIC X(03)    VALUE "G/L".           01220014
012500******************************************************************01230002
012600* G/L AUDIT REPORT COLUMN HEADER TWO.                             01240002
012700******************************************************************01250002
012800     05 PR-REPORT-HEADER-LINE2.                                   01260011
012900        10 FILLER            PIC X(02)  VALUE SPACES.             01270004
013000        10 FILLER            PIC X(04)  VALUE "Date".             01280004
013100        10 FILLER            PIC X(08)  VALUE SPACES.             01290004
013200        10 FILLER            PIC X(04)  VALUE "Time".             01300004
013300        10 FILLER            PIC X(05)  VALUE SPACES.             01310004
013400        10 FILLER            PIC X(04)  VALUE "Cmpy".             01320004
013500        10 FILLER            PIC X(01)  VALUE SPACES.             01330004
013600        10 FILLER            PIC X(04)  VALUE "Divn".             01340004
013700        10 FILLER            PIC X(01)  VALUE SPACES.             01350004
013800        10 FILLER            PIC X(04)  VALUE "Dept".             01360004
013900        10 FILLER            PIC X(03)  VALUE SPACES.             01370004
014000        10 FILLER            PIC X(07)  VALUE "Account".          01380004
014100        10 FILLER            PIC X(01)  VALUE SPACES.             01390004
014200        10 FILLER            PIC X(08)  VALUE "Sub-Acct".         01400004
014300        10 FILLER            PIC X(12)  VALUE SPACES.             01410004
014400        10 FILLER            PIC X(11)  VALUE "Description".      01420004
014500        10 FILLER            PIC X(17)  VALUE SPACES.             01430004
014600        10 FILLER            PIC X(12)  VALUE "Debit Amount".     01440004
014700        10 FILLER            PIC X(11)  VALUE SPACES.             01450004
014800        10 FILLER            PIC X(13)  VALUE "Credit Amount".    01460004
014900*                                                                 01470002
015000* G/L audit report detail line one.                               01480002
015100*                                                                 01490002
015200     05 PR-REPORT-DETAIL-LINE1.                                   01500011
015300        10 WS-RPT-MONTH      PIC X(02).                           01510004
015400        10 FILLER            PIC X      VALUE "/".                01520004
015500        10 WS-RPT-DAY        PIC X(02).                           01530004
015600        10 FILLER            PIC X      VALUE "/".                01540004
015700        10 WS-RPT-YEAR       PIC X(04).                           01550004
015800        10 FILLER            PIC X(01)  VALUE SPACES.             01560004
015900        10 WS-RPT-HOURS      PIC 9(02).                           01570004
016000        10 FILLER            PIC X      VALUE ":".                01580004
016100        10 WS-RPT-MINS       PIC 9(02).                           01590004
016200        10 FILLER            PIC X      VALUE ":".                01600004
016300        10 WS-RPT-SECS       PIC 9(02).                           01610004
016400        10 FILLER            PIC X      VALUE ":".                01620004
016500        10 WS-RPT-HSCS       PIC 9(02).                           01630004
016600        10 FILLER            PIC X      VALUE SPACES.             01640004
016700        10 WS-RPT-COMPANY    PIC ZZZZ.                            01650004
016800        10 FILLER            PIC X(01)  VALUE SPACES.             01660004
016900        10 WS-RPT-DIVISION   PIC ZZZZ.                            01670004
017000**      10 FILLER            PIC X(01)  VALUE SPACES.             01680004
017100        10 WS-RPT-GL-DEPARTMENT  PIC ZZZZ.                        01690004
017200        10 FILLER            PIC X(01)  VALUE SPACES.             01700004
017300        10 WS-RPT-GL-ACCOUNT PIC ZZZZZZZZZZ.                      01710004
017400        10 FILLER            PIC X(01)  VALUE SPACES.             01720004
017500        10 WS-RPT-GL-SUBACCT PIC ZZZZZZZZ.                        01730004
017600        10 FILLER            PIC X(01)  VALUE SPACES.             01740004
017700        10 WS-RPT-GL-DESCRIPTION PIC X(32).                       01750004
017800**      10 FILLER                PIC X(01)  VALUE SPACE.          01760004
017900        10 WS-RPT-DEBIT-AMOUNT   PIC ZZZZZZZZ,ZZZ,ZZZ.99-.              04
018000        10 FILLER                PIC X(02)  VALUE SPACE.          01780004
018100        10 WS-RPT-CREDIT-AMOUNT  PIC ZZZZZ,ZZZ,ZZZ,ZZZ.99-.       01790012
018200                                                                  01810003
018300/***********************************************************      01820003
018400* G/L audit report sub-total line.                                01830003
018500/***********************************************************      01840003
018600     05 WS-REPORT-SUBTOT-LINE.                                    01850004
018700        10 WS-SUB-TOTAL-TITLE    PIC X(40)  VALUE SPACES.         01860004
018800        10 FILLER                PIC X(47)  VALUE SPACES.         01870004
018900        10 WS-RPT-SUBTOT-DEBITS  PIC ZZ,ZZZ,ZZZ,ZZZ,ZZZ.99-.      01880004
019000        10 FILLER                PIC X(01)  VALUE SPACES.         01890004
019100        10 WS-RPT-SUBTOT-CREDITS PIC ZZ,ZZZ,ZZZ,ZZZ,ZZZ.99-.      01900004
019200/***********************************************************      01910003
019300* G/L audit report grand total line.                              01920003
019400/***********************************************************      01930003
019500     05 WS-REPORT-GRANDTOT-LINE.                                  01940004
019600        10 FILLER       PIC X(11)   VALUE "Grand Total".          01950004
019700        10 FILLER       PIC X(76)   VALUE SPACES.                 01960004
019800        10 WS-RPT-GRANDTOT-DEBITS  PIC ZZ,ZZZ,ZZZ,ZZZ,ZZZ.99-.    01980004
019900        10 FILLER       PIC X(01)  VALUE SPACES.                  01990004
020000        10 WS-RPT-GRANDTOT-CREDITS PIC ZZ,ZZZ,ZZZ,ZZZ,ZZZ.99-.    02000004
020100                                                                  02010003
020200 01  WS-LOCAL-FLAGS.                                              02020004
020300     05 WS-PROGRAM-ABORT-FLAG       PIC  9     VALUE 0.           02030004
020400        88 DONOT-ABORT-PROGRAM                 VALUE 0.           02040004
020500        88 ABORT-PROGRAM                       VALUE 1.           02050004
020600                                                                  02060003
020700 01  WS-DATE-TIME.                                                02070012
020800     05 WS-DATE-TIME-YYYY.                                        02080004
020900        10 WS-DATE-TIME-CENTURY    PIC  9(02).                    02090004
021000        10 WS-DATE-TIME-YEAR       PIC  9(02).                    02100004
021100     05 WS-DATE-TIME-MONTH         PIC  9(02).                    02110004
021200     05 WS-DATE-TIME-DAY           PIC  9(02).                    02120004
021300     05 WS-DATE-TIME-HOURS         PIC  9(02).                    02130004
021400     05 WS-DATE-TIME-MINS          PIC  9(02).                    02140004
021500     05 WS-DATE-TIME-SECS          PIC  9(02).                    02150004
021600     05 WS-DATE-TIME-HSCS          PIC  9(02).                    02160004
021700                                                                  02170003
021800 01  WS-DATE-YYYYMMDD.                                            02180012
021900     05 WS-DATE-YYYYMMDD-YYYY.                                    02190004
022000        10 WS-DATE-YYYYMMDD-CENTURY PIC  9(02).                   02200004
022100        10 WS-DATE-YYYYMMDD-YEAR    PIC  9(02).                   02210004
022200     05 WS-DATE-YYYYMMDD-MONTH      PIC  9(02).                   02220004
022300     05 WS-DATE-YYYYMMDD-DAY        PIC  9(02).                   02230004
022400                                                                  02240003
022500 01  WS-TIME-HHMMSSCC.                                            02250004
022600     05 WS-TIME-HHMMSSCC-HOURS      PIC  9(02).                   02260004
022700     05 WS-TIME-HHMMSSCC-MINS       PIC  9(02).                   02270004
022800     05 WS-TIME-HHMMSSCC-SECS       PIC  9(02).                   02280004
022900     05 WS-TIME-HHMMSSCC-HSCS       PIC  9(02).                   02290004
023000                                                                  02300003
023100 01  WS-DATE-YYMMDD.                                              02310004
023200     05 WS-DATE-YYMMDD-YEAR         PIC  9(02).                   02320004
023300     05 WS-DATE-YYMMDD-MONTH        PIC  9(02).                   02330004
023400     05 WS-DATE-YYMMDD-DAY          PIC  9(02).                   02340004
023500                                                                  02350003
023600 01  WS-TIME-HHMMSS.                                              02360004
023700     05 WS-TIME-HHMMSS-HOURS        PIC  9(02).                   02370004
023800     05 WS-TIME-HHMMSS-MINS         PIC  9(02).                   02380004
023900     05 WS-TIME-HHMMSS-SECS         PIC  9(02).                   02390004
024000     05 WS-TIME-HHMMSS-HSCS         PIC  9(02).                   02400004
024100                                                                  02410003
024200 01  WS-JULIAN-DATES.                                             02420004
024300     05 WS-SYSTEM-PROCESSING-DATE   PIC S9(09) COMP.              02430004
024400     05 WS-JULIAN-DATE              PIC S9(09) COMP.              02440004
024500 01  WS-DATES.                                                            
024600     05  WS-CURRENT-DATE.                                                 
024700         10 WS-CURRENT-YY        PIC 9(02)    VALUE ZEROES.               
024800         10 WS-CURRENT-MM        PIC 9(02)    VALUE ZEROES.               
024900         10 WS-CURRENT-DD        PIC 9(02)    VALUE ZEROES.               
025000     05  WS-CURRENT-TIME.                                                 
025100         10 WS-CURRENT-HOUR      PIC 9(02)    VALUE ZEROES.               
025200         10 WS-CURRENT-MINUTE    PIC 9(02)    VALUE ZEROES.               
025300                                                                  02450003
025400 PROCEDURE DIVISION.                                              02460004
025500 0000-MAIN SECTION.                                               02470009
025600                                                                  02480003
025700     PERFORM 1000-INITIALIZE.                                     02490005
025900                                                                  02510003
026000     PERFORM 2000-PROCESS-GLTR-RECORDS                            02520006
026100       UNTIL GLTR-EOF.                                            02530006
026200                                                                          
026300     IF GLTR-EOF                                                          
026400        PERFORM GL-3500-RAPUP-GLTR-FILE                           02760010
026500     END-IF.                                                              
026600                                                                  02540003
026700     PERFORM 9999-CLOSE                                           02550011
026800                                                                  02560003
026900     GOBACK.                                                      02570006
027000                                                                  02580003
027100 1000-INITIALIZE.                                                 02590005
027200                                                                  02600003
027300     OPEN INPUT  FD-GLTR-UPDATE-FILE                              02610012
027400          OUTPUT GL-IF-REPORT.                                    02620011
027500                                                                  02630006
027600     PERFORM 2000-GLTR-READ-FILE.                                 02640008
027700                                                                  02650008
027800     PERFORM RPT-0000-SETUP-REPORT.                               02800010
027900                                                                          
028000 2000-GLTR-READ-FILE.                                             02660008
028100                                                                  02670008
028200     READ FD-GLTR-UPDATE-FILE                                     02680013
028300     INTO AR030-SELECT-GL-UPDATE-DATA                             02690006
028400       AT END                                                     02700006
028500          SET GLTR-EOF TO TRUE.                                   02710006
028600                                                                  02720006
028700 2000-PROCESS-GLTR-RECORDS.                                       02730006
028800*                                                                 02740010
028900     IF AR030-GL-TR-ENTRY-SEQ-NBR     = WS-TRAILER-RECORD         02750010
029000        PERFORM GL-3500-RAPUP-GLTR-FILE                           02760010
029100        SET GLTR-EOF TO TRUE                                      02770010
029200     ELSE                                                         02780010
029300        IF AR030-GL-TR-ENTRY-SEQ-NBR  = WS-HEADER-RECORD          02790010
029400           PERFORM 2000-GLTR-READ-FILE                            02810010
029500        ELSE                                                      02820010
029600           PERFORM RPT-3000-PRINT-DETAILS                         02830010
029700           PERFORM 2000-GLTR-READ-FILE                            02840010
029800        END-IF                                                    02850010
029900     END-IF.                                                      02860010
030000*                                                                 02870010
030100/*****************************************************************02880010
030200*                          SETUP REPORT                           02890010
030300*                          ------------                           02900010
030400* This section controls the setting up of the batch audit report. 02910010
030500******************************************************************02920010
030600 RPT-0000-SETUP-REPORT.                                           02930010
030700*                                                                 02940010
030800     MOVE AR030-TR-COMPANY             TO WS-HOLD-COMPANY         02950012
030900     MOVE AR030-TR-DIVISION            TO WS-HOLD-DIVISION        02960012
031000     MOVE AR030-TR-DEPARTMENT          TO WS-HOLD-DEPARTMENT      02970012
031100     MOVE AR030-TR-ACCOUNT             TO WS-HOLD-ACCOUNT         02980012
031200                                                                  02990010
031300* Initialize the working storage variables                        03000010
031400*                                                                 03010010
031500     MOVE ZEROES   TO WS-GRANDTOT-DEBITS                          03020010
031600                      WS-SUBTOT-DEBITS                            03030015
031700                      WS-COMPANYTOT-DEBITS                        03040010
031800                      WS-DIVISIONTOT-DEBITS                       03050010
031900                      WS-DEPARTMENTTOT-DEBITS                     03060010
032000                      WS-ACCOUNTTOT-DEBITS                        03070010
032100                      WS-GRANDTOT-CREDITS                         03080010
032200                      WS-SUBTOT-CREDITS                           03090015
032300                      WS-COMPANYTOT-CREDITS                       03100010
032400                      WS-DIVISIONTOT-CREDITS                      03110010
032500                      WS-DEPARTMENTTOT-CREDITS                    03120010
032600                      WS-ACCOUNTTOT-CREDITS.                      03130010
032700                                                                  03140010
032800* SET REPORT HEADER DATE AND TIME                                         
032900     ACCEPT WS-CURRENT-DATE FROM DATE.                                    
033000     ACCEPT WS-CURRENT-TIME FROM TIME.                                    
033100                                                                          
033200     MOVE WS-CURRENT-YY            TO DP132O-RUN-YEAR.                    
033300     MOVE WS-CURRENT-MM            TO DP132O-RUN-MONTH.                   
033400     MOVE WS-CURRENT-DD            TO DP132O-RUN-DAY.                     
033500                                                                          
033600     MOVE WS-CURRENT-HOUR          TO DP132O-RUN-HOUR.                    
033700     MOVE WS-CURRENT-MINUTE        TO DP132O-RUN-MINUTE.                  
033800                                                                          
033900     MOVE WS-PGM-NAME              TO DP132O-PROGRAM-NAME.                
034000     PERFORM 9200-WRITE-HEADERS.                                  03150011
034100*                                                                 03160011
034200/*****************************************************************03170010
034300*                              PRINT DETAILS                      03180010
034400*                              -------------                      03190010
034500* This section controls the printing of the batch audit report det03200010
034600******************************************************************03210010
034700 RPT-3000-PRINT-DETAILS.                                          03220010
034800                                                                  03230010
034900     MOVE AR030-GL-TR-ADD-DATE-MONTH  TO WS-RPT-MONTH             03240012
035000     MOVE AR030-GL-TR-ADD-DATE-DAY    TO WS-RPT-DAY               03250012
035100     MOVE AR030-GL-TR-ADD-DATE-YEAR   TO WS-RPT-YEAR              03260012
035200                                                                  03270010
035300     MOVE AR030-GL-TR-ADD-TIME-HOURS  TO WS-RPT-HOURS             03280012
035400     MOVE AR030-GL-TR-ADD-TIME-MINS   TO WS-RPT-MINS              03290012
035500     MOVE AR030-GL-TR-ADD-TIME-SECS   TO WS-RPT-SECS              03300012
035600     MOVE AR030-GL-TR-ADD-TIME-HSCS   TO WS-RPT-HSCS              03310012
035700                                                                  03320010
035800     MOVE AR030-TR-COMPANY            TO WS-RPT-COMPANY           03330012
035900     MOVE AR030-TR-DIVISION           TO WS-RPT-DIVISION          03340012
036000     MOVE AR030-TR-DEPARTMENT         TO WS-RPT-GL-DEPARTMENT.    03350012
036100                                                                  03360010
036200     MOVE AR030-TR-ACCOUNT            TO WS-RPT-GL-ACCOUNT        03370010
036300     MOVE AR030-TR-SUBACCT            TO WS-RPT-GL-SUBACCT        03380010
036400                                                                  03390010
036500     MOVE AR030-GL-TR-DESCRIPTION     TO WS-RPT-GL-DESCRIPTION    03400010
036600                                                                  03410010
036700     IF AR030-GL-TR-AMT  > 0                                      03420012
036800        MOVE AR030-GL-TR-AMT          TO WS-RPT-DEBIT-AMOUNT      03430012
036900        MOVE ZERO                     TO WS-RPT-CREDIT-AMOUNT     03440010
037000     ELSE                                                         03450010
037100        MOVE ZERO                     TO WS-RPT-DEBIT-AMOUNT      03460010
037200        MOVE AR030-GL-TR-AMT          TO WS-RPT-CREDIT-AMOUNT     03470012
037300     END-IF                                                       03480010
037400                                                                  03490010
037500     PERFORM RPT-3100-CHECK-NEED-PRINT-TOTS                       03500010
037600                                                                  03510010
037700     WRITE GL-IF-RECORD  FROM PR-REPORT-DETAIL-LINE1              03520012
037800                        AFTER ADVANCING 1 LINE.                   03530011
037900     ADD 1 TO PR-LINES-PAGE.                                      03540011
038000     PERFORM 9200-WRITE-HEADERS.                                  03550011
038100                                                                  03560010
038200     MOVE AR030-TR-COMPANY            TO WS-HOLD-COMPANY          03570012
038300     MOVE AR030-TR-DIVISION           TO WS-HOLD-DIVISION         03580012
038400     MOVE AR030-TR-DEPARTMENT         TO WS-HOLD-DEPARTMENT       03590012
038500     MOVE AR030-TR-ACCOUNT            TO WS-HOLD-ACCOUNT          03600012
038600                                                                  03610010
038700     IF AR030-GL-TR-AMT  > 0                                      03620012
038800        ADD AR030-GL-TR-AMT           TO WS-COMPANYTOT-DEBITS     03630012
038900                                         WS-DIVISIONTOT-DEBITS    03640010
039000                                         WS-DEPARTMENTTOT-DEBITS  03650010
039100                                         WS-ACCOUNTTOT-DEBITS     03660010
039200                                         WS-GRANDTOT-DEBITS       03670010
039300     ELSE                                                         03680010
039400        ADD AR030-GL-TR-AMT           TO WS-COMPANYTOT-CREDITS    03690012
039500                                         WS-DIVISIONTOT-CREDITS   03700010
039600                                         WS-DEPARTMENTTOT-CREDITS 03710010
039700                                         WS-ACCOUNTTOT-CREDITS    03720010
039800                                         WS-GRANDTOT-CREDITS      03730012
039900     END-IF.                                                      03740010
040000                                                                  03750010
040100/*****************************************************************03760004
040200*                    RAPUP SORT FILE                              03770004
040300*                    ---------------                              03780004
040400* This section controls the inserting of a trailer record.        03790004
040500******************************************************************03800004
040600 GL-3500-RAPUP-GLTR-FILE.                                         03810012
040700                                                                  03820003
040800     IF  WS-ACCOUNTTOT-DEBITS  > 0  OR                            03830004
040900         WS-ACCOUNTTOT-CREDITS < 0                                03840004
041000         PERFORM RPT-4000-PRINT-ACCT-SUBTOT                       03850010
041100     END-IF                                                       03860004
041200     IF  WS-DEPARTMENTTOT-DEBITS  > 0  OR                         03870008
041300         WS-DEPARTMENTTOT-CREDITS < 0                             03880004
041400         PERFORM RPT-5000-PRINT-DEPT-SUBTOT                       03890010
041500     END-IF                                                       03900004
041600     IF  WS-DIVISIONTOT-DEBITS  > 0  OR                           03910008
041700         WS-DIVISIONTOT-CREDITS < 0                               03920004
041800         PERFORM RPT-6000-PRINT-DIVN-SUBTOT                       03930010
041900     END-IF                                                       03940004
042000     IF  WS-COMPANYTOT-DEBITS   > 0  OR                           03950008
042100         WS-COMPANYTOT-CREDITS  < 0                               03960008
042200         PERFORM RPT-7000-PRINT-COMP-SUBTOT                       03970010
042300     END-IF                                                       03980004
042400     PERFORM RPT-9000-PRINT-GRANDTOTALS.                          03990010
042500*                                                                 04000008
042600/*****************************************************************04010007
042700*                          CHECK NEED PRINT TOTS                  04020007
042800*                          ---------------------                  04030007
042900* This section controls the evaluation of what sub-total need to  04040007
043000***************************************************************** 04050007
043100 RPT-3100-CHECK-NEED-PRINT-TOTS.                                  04060010
043200                                                                  04070003
043300     EVALUATE TRUE                                                04080007
043400              WHEN AR030-TR-COMPANY    = WS-HOLD-COMPANY          04090007
043500               AND AR030-TR-DIVISION   = WS-HOLD-DIVISION         04100007
043600               AND AR030-TR-DEPARTMENT = WS-HOLD-DEPARTMENT       04110007
043700               AND AR030-TR-ACCOUNT    = WS-HOLD-ACCOUNT          04120007
043800                   CONTINUE                                       04130007
043900                                                                  04140007
044000              WHEN AR030-TR-COMPANY NOT = WS-HOLD-COMPANY         04150007
044100                   PERFORM RPT-4000-PRINT-ACCT-SUBTOT             04160010
044200                   PERFORM RPT-5000-PRINT-DEPT-SUBTOT             04170010
044300                   PERFORM RPT-6000-PRINT-DIVN-SUBTOT             04180010
044400                   PERFORM RPT-7000-PRINT-COMP-SUBTOT             04190010
044500                                                                  04200007
044600              WHEN AR030-TR-DIVISION NOT = WS-HOLD-DIVISION       04210007
044700                   PERFORM RPT-4000-PRINT-ACCT-SUBTOT             04220010
044800                   PERFORM RPT-5000-PRINT-DEPT-SUBTOT             04230010
044900                   PERFORM RPT-6000-PRINT-DIVN-SUBTOT             04240010
045000                                                                  04250007
045100              WHEN AR030-TR-DEPARTMENT NOT = WS-HOLD-DEPARTMENT   04260007
045200                   PERFORM RPT-4000-PRINT-ACCT-SUBTOT             04270010
045300                   PERFORM RPT-5000-PRINT-DEPT-SUBTOT             04280010
045400                                                                  04290007
045500              WHEN AR030-TR-ACCOUNT NOT = WS-HOLD-ACCOUNT         04300007
045600                   PERFORM RPT-4000-PRINT-ACCT-SUBTOT             04310010
045700     END-EVALUATE                                                 04320007
045800     .                                                            04330007
045900                                                                  04340003
046000/*****************************************************************04350007
046100*                            PRINT ACCT SUBTOT                    04360007
046200*                            -----------------                    04370007
046300* This section controls the printing of the account sub-totals.   04380007
046400***************************************************************** 04390007
046500 RPT-4000-PRINT-ACCT-SUBTOT.                                      04400010
046600                                                                  04410003
046700     MOVE WS-ACCOUNTTOT-DEBITS      TO WS-SUBTOT-DEBITS           04420007
046800     MOVE WS-ACCOUNTTOT-CREDITS     TO WS-SUBTOT-CREDITS          04430007
046900     STRING "Sub-Total Account: "   DELIMITED BY SIZE,            04440007
047000            WS-HOLD-ACCOUNT         DELIMITED BY SIZE,            04450007
047100            "           "           DELIMITED BY SIZE             04460007
047200       INTO WS-SUB-TOTAL-TITLE                                    04470007
047300     END-STRING                                                   04480007
047400                                                                  04490003
047500     PERFORM RPT-8000-PRINT-SUBTOTALS                             04500010
047600                                                                  04510003
047700     MOVE ZERO  TO WS-ACCOUNTTOT-DEBITS                           04520007
047800                   WS-ACCOUNTTOT-CREDITS                          04530007
047900     .                                                            04540007
048000/*****************************************************************04550007
048100*                            PRINT DEPT SUBTOT                    04560007
048200*                            -----------------                    04570007
048300* This section controls the printing of the Department sub-totals 04580007
048400***************************************************************** 04590007
048500 RPT-5000-PRINT-DEPT-SUBTOT.                                      04600010
048600                                                                  04610003
048700     MOVE WS-DEPARTMENTTOT-DEBITS    TO WS-SUBTOT-DEBITS          04620007
048800     MOVE WS-DEPARTMENTTOT-CREDITS   TO WS-SUBTOT-CREDITS         04630007
048900     STRING "Sub-Total Department: " DELIMITED BY SIZE,           04640007
049000            WS-HOLD-DEPARTMENT       DELIMITED BY SIZE,           04650007
049100            "              "         DELIMITED BY SIZE            04660007
049200       INTO WS-SUB-TOTAL-TITLE                                    04670007
049300     END-STRING                                                   04680007
049400                                                                  04690003
049500     PERFORM RPT-8000-PRINT-SUBTOTALS                             04700010
049600                                                                  04710003
049700     MOVE ZERO  TO WS-DEPARTMENTTOT-DEBITS                        04720007
049800                   WS-DEPARTMENTTOT-CREDITS.                      04730007
049900/*****************************************************************04740007
050000*                            PRINT DIVN SUBTOT                    04750007
050100*                            -----------------                    04760007
050200* This section controls the printing of the division sub-totals   04770007
050300***************************************************************** 04780007
050400 RPT-6000-PRINT-DIVN-SUBTOT.                                      04790010
050500                                                                  04800003
050600     MOVE WS-DIVISIONTOT-DEBITS      TO WS-SUBTOT-DEBITS          04810007
050700     MOVE WS-DIVISIONTOT-CREDITS     TO WS-SUBTOT-CREDITS         04820007
050800     MOVE "Division "                TO WS-SUB-TOTAL-TITLE        04830007
050900     STRING "Sub-Total Division: "   DELIMITED BY SIZE,           04840007
051000            WS-HOLD-DIVISION         DELIMITED BY SIZE,           04850007
051100            "                "       DELIMITED BY SIZE            04860007
051200       INTO WS-SUB-TOTAL-TITLE                                    04870007
051300     END-STRING                                                   04880007
051400                                                                  04890003
051500     PERFORM RPT-8000-PRINT-SUBTOTALS                             04900010
051600                                                                  04910003
051700     MOVE ZERO  TO WS-DIVISIONTOT-DEBITS                          04920007
051800                   WS-DIVISIONTOT-CREDITS.                        04930007
051900/*****************************************************************04940007
052000*                            PRINT COMP SUBTOT                    04950007
052100*                            -----------------                    04960007
052200* This section controls the printing of the company sub-totals.   04970007
052300***************************************************************** 04980007
052400 RPT-7000-PRINT-COMP-SUBTOT.                                      04990010
052500                                                                  05000003
052600     MOVE WS-COMPANYTOT-DEBITS      TO WS-SUBTOT-DEBITS           05010007
052700     MOVE WS-COMPANYTOT-CREDITS     TO WS-SUBTOT-CREDITS          05020007
052800     STRING "Sub-Total Company: "   DELIMITED BY SIZE,            05030007
052900            WS-HOLD-COMPANY         DELIMITED BY SIZE,            05040007
053000            "                 "     DELIMITED BY SIZE             05050007
053100       INTO WS-SUB-TOTAL-TITLE                                    05060007
053200     END-STRING                                                   05070007
053300                                                                  05080003
053400     PERFORM RPT-8000-PRINT-SUBTOTALS                             05090010
053500                                                                  05100003
053600     MOVE ZERO  TO WS-COMPANYTOT-DEBITS                           05110007
053700                   WS-COMPANYTOT-CREDITS.                         05120007
053800                                                                  05130003
053900/*****************************************************************05140007
054000*                             PRINT SUB-TOTALS                    05150007
054100*                             ----------------                    05160007
054200* This section controls the printing of the batch audit report su 05170007
054300***************************************************************** 05180007
054400 RPT-8000-PRINT-SUBTOTALS.                                        05190010
054500                                                                  05200003
054600     MOVE WS-SUBTOT-DEBITS      TO WS-RPT-SUBTOT-DEBITS           05210007
054700     MOVE WS-SUBTOT-CREDITS     TO WS-RPT-SUBTOT-CREDITS          05220007
054800                                                                  05230003
054900     PERFORM 9100-WRITE-SPACES                                    05240011
055000                                                                  05250003
055100     WRITE GL-IF-RECORD                                           05260011
055200      FROM WS-REPORT-SUBTOT-LINE   AFTER ADVANCING 1 LINE         05270011
055300     ADD 1 TO PR-LINES-PAGE                                       05280011
055400     PERFORM 9200-WRITE-HEADERS                                   05290011
055500                                                                  05300003
055600     PERFORM 9100-WRITE-SPACES.                                   05310011
055700                                                                  05320003
055800/*****************************************************************05330007
055900*                            PRINT GRAND TOTALS                   05340007
056000*                            ------------------                   05350007
056100* This section controls the printing of the batch audit report    05360007
056200* Grand totals                                                    05370007
056300******************************************************************05380007
056400 RPT-9000-PRINT-GRANDTOTALS.                                      05390012
056500                                                                  05400003
056600     MOVE WS-GRANDTOT-DEBITS      TO WS-RPT-GRANDTOT-DEBITS       05410007
056700     MOVE WS-GRANDTOT-CREDITS     TO WS-RPT-GRANDTOT-CREDITS      05420007
056800                                                                  05430003
056900     PERFORM 9100-WRITE-SPACES                                    05440011
057000                                                                  05450003
057100     WRITE GL-IF-RECORD                                           05460011
057200      FROM WS-REPORT-GRANDTOT-LINE AFTER ADVANCING 1 LINE         05470011
057300     ADD 1 TO PR-LINES-PAGE                                       05480011
057400     PERFORM 9200-WRITE-HEADERS                                   05490011
057500                                                                  05500003
057600     PERFORM 9100-WRITE-SPACES.                                   05510011
057700                                                                  05520003
057800 9100-WRITE-SPACES.                                               05530011
057900                                                                  05540011
058000     MOVE SPACES TO GL-IF-RECORD.                                 05550011
058100     WRITE GL-IF-RECORD.                                          05560011
058200                                                                  05570011
058300     ADD 1 TO PR-LINES-PAGE.                                      05580011
058400     PERFORM 9200-WRITE-HEADERS.                                  05590011
058500                                                                  05600011
058600 9200-WRITE-HEADERS.                                              05610011
058700                                                                  05620011
058800      IF PR-LINES-PAGE = 0                                        05630011
058900      OR PR-LINES-PAGE > 61                                       05640011
059000         ADD  1                 TO PR-PAGE-COUNT                  05650011
059100         MOVE PR-PAGE-COUNT     TO DP132O-PAGE-NUMBER             05660011
059200         MOVE 0                 TO PR-LINES-PAGE                  05670011
059300         MOVE PR-REPORT-NBR     TO DP132O-REPORT-NUMBER           05680011
059400         WRITE GL-IF-RECORD     FROM                              05690011
059500                                DP132O-STANDRD-HEADER-132-COLS    05700011
059600                AFTER ADVANCING PAGE                              05710011
059700         WRITE GL-IF-RECORD     FROM PR-REPORT-HEADER             05720011
059800               AFTER ADVANCING 2 LINES                            05730011
059700         WRITE GL-IF-RECORD     FROM PR-REPORT-HEADER-ISSCAG      05720011
059800               AFTER ADVANCING 2 LINES                            05730011
059900         WRITE GL-IF-RECORD     FROM PR-REPORT-HEADER-LINE1       05740011
060000               AFTER ADVANCING 2 LINES                            05750011
060100         WRITE GL-IF-RECORD     FROM PR-REPORT-HEADER-LINE2       05760011
060200               AFTER ADVANCING 1 LINE                             05770011
060300         ADD 13 TO PR-LINES-PAGE                                  05780011
060400     END-IF.                                                      05790011
060500                                                                  05800011
060600 9999-CLOSE.                                                      05810011
060700                                                                  05820011
060800     CLOSE FD-GLTR-UPDATE-FILE                                    05830011
060900           GL-IF-REPORT.                                          05840011
