       IDENTIFICATION DIVISION.                                         00010010
       PROGRAM-ID.             PMKRP131.                                00020010
       AUTHOR.                 KELLY LARUM.                             00030010
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040010
       DATE-WRITTEN.           DECEMBER 2003.                           00050010
       DATE-COMPILED.                                                   00060010
      *-----------------------------------------------------------      00070010
      *  PMKRP131 -- BUSINESS RULE BOGO OVERLAP EXCEPTION REPORT        00080010
      *    THIS REPORT READS PMT_SKU_LVL_PRICG_BY_LOC ORACLE TABLE      00090010
      *    LOOKING FOR SKUS THAT ARE PROMOTED AS BOGO AND NON BOGO      00100010
      *    WITHIN THE SAME ADEVENT.  THIS PROGRAM IS RUN ON DEMAND      00110010
      *    FOR A PARTICULAR ADEVENT PASSED IN.                          00120010
      *    THE FORMAT OF THIS REPORT IS SIMILAR TO PMKRP130.            00130010
      *    PMKRP130 WAS THE STARTING POINT FOR THIS PROGRAM.            00140010
      *    WHEREVER IT SAYS MAIN - THINK OF IT AS BOGO AND              00150010
      *    WHEREVER IT SAYS NON MAIN - THINK OF IT AS NON BOGO.         00160010
      *    I DIDN'T CHANGE THAT BECAUSE I WANTED TO USE THE             00170010
      *    PMKUT117 SUBROUTINE TO GET THE SIGN #S.                      00180010
      *-----------------------------------------------------------      00190010
      *----------------------------------------------------------       00200010
      * HISTORY LOG:                                                    00210010
      *----------------------------------------------------------       00220010
      * DATE:        01/09/2004                                         00230010
      * WR/IR#:      WR25854                                            00240010
      * PROGRAMMER:  COLLEEN CUMMINGS                                   00250010
      * DESCRIPTION: FOR NEW BOGO, CHECK FOR 'GBP' (GROUP BOGO PERCENT) 00260010
      *  AND 'GPO' (FOR FUTURE) - WHEN CHECKING IF SHOULD               00270010
      *  PRINT '%' SIGN FOR PERCENT OFF ON REPORT.                      00280010
      *                                                                 00290010
      * DATE:        01/14/2004                                         00300010
      * WR/IR#:      P000623934                                         00310010
      * PROGRAMMER:  COLLEEN CUMMINGS                                   00320010
      * DESCRIPTION: CHANGED CSR TO IGNORE PRICG-TYP-CDE OF 'UNS'       00330010
      *  (UNSPECIFIED) - NOT A REAL PRICG-TYP-CDE - SO NO OVERLAP.      00340010
      *                                                                 00350010
      * DATE:        02/02/2004                                         00360010
      * WR/IR#:      WR26451                                            00370010
      * PROGRAMMER:  COLLEEN CUMMINGS                                   00380010
      * DESCRIPTION: ADDED ADV-IND AND SCL TO REPORT.                   00390010
      *                                                                 00400010
      * DATE:        11/16/2004                                         00410010
      * WR/IR#:      P000711394                                         00420010
      * PROGRAMMER:  COLLEEN CUMMINGS                                   00430010
      * DESCRIPTION: FIX TO ADD STRT/END TMST COMPARE LOGIC FOR         00440010
      *              PROMOTIONS IN SAME AD EVENT THAT DO NOT OVERLAP    00450010
      *              WITH BOGO.                                         00460010
      *                                                                 00470010
      * DATE:        05/20/2005                                         00480010
      * WR/IR#:      WR28665                                            00490010
      * PROGRAMMER:  TOM BOYD                                           00500010
      * DESCRIPTION: ADDED LOGIC FOR ADDITIONAL RUN OF THE REPORT.      00510010
      *              (POST CORRECTION #2).                              00520010
      *                                                                 00530010
      * DATE:        07/11/2005                                         00540010
      * WR/IR#:      WR28438                                            00550010
      * PROGRAMMER:  TOM BOYD                                           00560010
      * DESCRIPTION: REPORT AUTOMATION                                  00570010
      *                                                                 00580010
      * DATE:        07/29/2005                                         00590010
      * WR/IR#:      WR28438                                            00600010
      * PROGRAMMER:  TOM BOYD                                           00610010
      * DESCRIPTION: CHANGED REPORT HEADING TO DISPLAY PROMO NAME       00620010
      *                                                                 00630010
      * DATE:        10/31/2005                                         00640016
      * WR/IR#:      P000816549                                         00650013
      * PROGRAMMER:  COLLEEN CUMMINGS                                   00660011
      * DESCRIPTION: CHANGED ADV-IND TO DISPLAY A/U VS. Y/N.            00670011
      *                                                                 00680011
      *----------------------------------------------------------       00690010
      *                                                                 00691017
      * DATE:        07/20/2010                                         00692017
      * WR/IR#:      WR37986                                            00693017
      * PROGRAMMER:  PATTY JAEGER                                       00694017
      * DESCRIPTION: CHANGES MADE TO EXCLUDE WEB STORE DATA FROM        00695017
      *              THE REPORT                                         00696017
C08622*                                                                 00696138
C08622* DATE:        03/24/2015                                         00696238
C08622* WR/IR#:      CHG0108622                                         00696338
C08622* PROGRAMMER:  JOHN SELWITSCHKA                                   00696438
C08622* DESCRIPTION: INCLUDE SKUS PRICED MORE THAN ONCE IN PROMO.       00696541
C08622*              REMOVE SIGN NUMBER FROM REPORT. REMOVE CALL TO     00696641
C08622*              PMKUT117 TO GET SIGN NBR AND SKU DESC. GET         00696741
C08622*              SKU DESC FROM XKT_SKU TABLE.                       00696841
C09985*                                                                 00696942
C09985* DATE:        04/20/2015                                         00697042
C09985* WR/IR#:      CHG0109985                                         00697142
C09985* PROGRAMMER:  JOHN SELWITSCHKA                                   00697242
C09985* DESCRIPTION: ADD REPORT TITLE FOR POST CORRECTIONS #3           00697342
C16571*                                                                 00697446
C16571* DATE:        07/08/2015                                         00697546
C16571* WR/IR#:      CHG0116571                                         00697646
C16571* PROGRAMMER:  JOHN SELWITSCHKA                                   00697746
C16571* DESCRIPTION: INCLUDE SKUS PRICED MORE THAN ONCE IN PROMO        00697846
C16571*              THAT HAVE PROMO_PRICG_TYP_CDE 'SPO' OR 'SPP'.      00697946
C16858*                                                                 00698048
C16858* DATE:        07/10/2015                                         00698148
C16858* WR/IR#:      CHG0116858                                         00698248
C16858* PROGRAMMER:  JOHN SELWITSCHKA                                   00698348
C16858* DESCRIPTION: INCLUDE SKUS PRICED MORE THAN ONCE IN PROMO        00698448
C16858*              THAT HAVE PROMO_PRICG_TYP_CDE 'SPO' OR 'SPP'       00698548
      *                                                                 00698652
070941* DATE:        07/30/2018                                         00698752
070941* WR/IR#:      CHG0204126                                         00698852
070941* PROGRAMMER:  COGNIZANT                                          00698952
070941* DESCRIPTION: ORACLE LOGON STANDARDS PROGRAM CHANGE              00699052
      *----------------------------------------------------------       00699952
       ENVIRONMENT DIVISION.                                            00700010
       CONFIGURATION SECTION.                                           00710010
       SOURCE-COMPUTER. IBM-3090.                                       00720010
       OBJECT-COMPUTER. IBM-3090.                                       00730010
                                                                        00740010
       INPUT-OUTPUT SECTION.                                            00750010
       FILE-CONTROL.                                                    00760010
                                                                        00770010
           SELECT CC-RPT-IN-FILE                                        00780010
              ASSIGN                     TO INP01.                      00790010
                                                                        00800010
W37986     SELECT SMPL-STR-INFILE                                       00801017
W37986        ASSIGN                     TO INP02.                      00802017
W37986                                                                  00803017
070941     SELECT ORACLE-LOGON-FILE                                     00804049
070941         ASSIGN                    TO ORALOGON.                   00805050
070941                                                                  00806049
070941                                                                  00807049
           SELECT PR-BOGO-RPT                                           00821510
               ASSIGN                    TO RPT01.                      00822010
                                                                        00830010
       DATA DIVISION.                                                   00840010
                                                                        00850010
       FILE SECTION.                                                    00860010
                                                                        00870010
       FD  CC-RPT-IN-FILE                                               00880010
           RECORDING MODE F                                             00890010
           BLOCK CONTAINS 0 RECORDS                                     00900010
           LABEL RECORDS ARE OMITTED                                    00910010
           DATA RECORD IS CC-RPT-IN-REC.                                00920010
       01  CC-RPT-IN-REC                   PIC X(80).                   00930010
                                                                        00940010
W37986 FD  SMPL-STR-INFILE                                              00941017
W37986     RECORDING MODE F                                             00942017
W37986     BLOCK CONTAINS 0 RECORDS                                     00943017
W37986     LABEL RECORDS ARE OMITTED                                    00944017
W37986     DATA RECORD IS SMPL-STR-INFILE-REC.                          00945017
W37986 01  SMPL-STR-INFILE-REC           PIC X(80).                     00946017
W37986                                                                  00947017
070941 FD  ORACLE-LOGON-FILE                                            00948049
070941     RECORDING MODE IS F                                          00949049
070941     LABEL RECORDS ARE STANDARD                                   00949149
070941     BLOCK CONTAINS 0 RECORDS                                     00949249
070941     RECORD CONTAINS 80 CHARACTERS                                00949349
070941     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00949449
070941 01  OL-ORACLE-LOGON-RECORD        PIC X(80).                     00949550
070941                                                                  00949650
       FD  PR-BOGO-RPT                                                  00950010
           RECORDING MODE F                                             00960010
           BLOCK CONTAINS 0 RECORDS                                     00970010
           LABEL RECORDS ARE OMITTED.                                   00980010
       01  PR-BOGO-RPT-LINE              PIC X(175).                    00990010
                                                                        01000010
       WORKING-STORAGE SECTION.                                         01010010
                                                                        01020010
       01  ABEND-CODE                    PIC S9(04) COMP VALUE +0.      01030010
           88  ABEND-4001-WRITE-ERROR               VALUE +4001.        01040010
           88  ABEND-4002-READ-ERROR                VALUE +4002.        01050010
           88  ABEND-4003-CTRL-CARD-ERROR           VALUE +4003.        01060010
           88  ABEND-4004-TABLE-ERROR               VALUE +4004.        01070010
           88  ABEND-4005-OPEN-ERROR                VALUE +4005.        01080010
           88  ABEND-4006-CLOSE-ERROR               VALUE +4006.        01090010
           88  ABEND-4007-SEQUENCE-ERROR            VALUE +4007.        01100010
           88  ABEND-4008-DATA-ERROR                VALUE +4008.        01110010
           88  ABEND-4009-KEY-DATA-ERROR            VALUE +4009.        01120010
           88  ABEND-4013-SQL-ERROR                 VALUE +4013.        01130010
           88  ABEND-4014-ORACLE-LOGON-ERROR        VALUE +4014.        01140010
           88  ABEND-4019-DATE-ROUTINE-ERROR        VALUE +4019.        01150010
           88  ABEND-4444-FORCED-ABEND              VALUE +4444.        01160010
                                                                        01170010
       01  CD-CPU-DATE.                                                 01180010
           05  CD-CPU-YR                  PIC 9(02) VALUE ZERO.         01190010
           05  CD-CPU-MO                  PIC 9(02) VALUE ZERO.         01200010
           05  CD-CPU-DY                  PIC 9(02) VALUE ZERO.         01210010
                                                                        01220010
       01  CD-CPU-DATE-GREG.                                            01230010
           05  CD-CPU-MM                  PIC 9(02) VALUE ZERO.         01240010
           05  CD-CPU-DD                  PIC 9(02) VALUE ZERO.         01250010
           05  CD-CPU-YY                  PIC 9(02) VALUE ZERO.         01260010
                                                                        01270010
       01  CT-CPU-TIME.                                                 01280010
           05  CT-CPU-HR                  PIC 9(02) VALUE ZERO.         01290010
           05  CT-CPU-MIN                 PIC 9(02) VALUE ZERO.         01300010
           05  CT-CPU-SEC                 PIC 9(02) VALUE ZERO.         01310010
           05  CT-CPU-HSEC                PIC 9(02) VALUE ZERO.         01320010
                                                                        01330010
       01  LEGAL-LINE.                                                  01340010
           05  FILLER                       PIC X(44)      VALUE SPACES.01350010
           05  FILLER                       PIC X(43)      VALUE        01360010
               '** PRIVILEGED AND CONFIDENTIAL, ATTORNEY-CL'.           01370010
           05  FILLER                       PIC X(43)      VALUE        01380010
               'IENT PRIVILEGE AND ATTORNEY WORK PRODUCT **'.           01390010
           05  FILLER                       PIC X(45)      VALUE SPACES.01400010
                                                                        01410010
       01  END-OF-REPORT-LINE.                                          01420010
           05  FILLER                     PIC X(77) VALUE SPACES.       01430010
           05  FILLER                     PIC X(20) VALUE               01440010
               ' ** END OF REPORT **'.                                  01450010
           05  FILLER                     PIC X(78) VALUE SPACES.       01460010
                                                                        01470010
       01  NOTHING-TO-REPORT-LINE.                                      01480010
           05  FILLER                     PIC X(79) VALUE SPACES.       01490010
           05  FILLER                     PIC X(24) VALUE               01500010
               ' ** NOTHING TO REPORT **'.                              01510010
           05  FILLER                     PIC X(80) VALUE SPACES.       01520010
                                                                        01530010
       01  HEADER-01.                                                   01540010
           05  FILLER                     PIC X(56) VALUE SPACES.       01550010
           05  HDR-01-TITLE               PIC X(38) VALUE SPACES.       01560010
           05  FILLER                     PIC X(81) VALUE SPACES.       01570010
                                                                        01580010
       01  HEADER-02.                                                   01590010
           05  FILLER                     PIC X(51) VALUE SPACES.       01600010
           05  HDR-02-TITLE-1             PIC X(12) VALUE SPACES.       01610010
           05  FILLER                     PIC X(01) VALUE SPACES.       01620010
           05  HDR-02-TITLE-2             PIC X(28) VALUE SPACES.       01630010
           05  FILLER                     PIC X(01) VALUE SPACES.       01640010
           05  FILLER                     PIC X(01) VALUE '-'.          01650010
           05  FILLER                     PIC X(01) VALUE SPACES.       01660010
           05  HDR-02-TITLE-3             PIC X(28) VALUE SPACES.       01670010
           05  FILLER                     PIC X(52) VALUE SPACES.       01680010
                                                                        01690010
           05  FILLER                     PIC  X(12) VALUE SPACES.      01700010
                                                                        01710010
       01  HEADER-04.                                                   01720010
           05  FILLER                     PIC  X(63) VALUE SPACES.      01730010
           05  HDR-04-TITLE               PIC  X(30) VALUE SPACES.      01740010
           05  FILLER                     PIC  X(82) VALUE SPACES.      01750010
                                                                        01760010
       01  HEADER-GMM.                                                  01770010
           05  FILLER                     PIC X(07) VALUE               01780010
               'GMM:   '.                                               01790010
           05  FILLER                     PIC X(01) VALUE SPACES.       01800010
           05  HDR-GMM-NBR                PIC X(04).                    01810010
           05  FILLER                     PIC X(01) VALUE SPACES.       01820010
           05  HDR-GMM-NAME               PIC X(36).                    01830010
           05  FILLER                     PIC X(127) VALUE SPACES.      01840010
                                                                        01850010
       01  HEADER-DMM.                                                  01860010
           05  FILLER                     PIC X(07) VALUE               01870010
               'DMM:   '.                                               01880010
           05  FILLER                     PIC X(01) VALUE SPACES.       01890010
           05  HDR-DMM-NBR                PIC X(04).                    01900010
           05  FILLER                     PIC X(01) VALUE SPACES.       01910010
           05  HDR-DMM-NAME               PIC X(36).                    01920010
           05  FILLER                     PIC X(127) VALUE SPACES.      01930010
                                                                        01940010
       01  HEADER-BUYER.                                                01950010
           05  FILLER                     PIC X(08) VALUE               01960010
               'BUYER:  '.                                              01970010
           05  HDR-BYR-NBR              PIC X(04).                      01980010
           05  FILLER                     PIC X(01) VALUE SPACES.       01990010
           05  HDR-BYR-NAME             PIC X(36).                      02000010
           05  FILLER                     PIC X(126) VALUE SPACES.      02010010
                                                                        02020010
       01  HEADER-DEPT.                                                 02030010
           05  FILLER                     PIC X(08) VALUE               02040010
               'DEPT:   '.                                              02050010
           05  HDR-DEPT-NBR               PIC X(04).                    02060010
           05  FILLER                     PIC X(01) VALUE SPACES.       02070010
           05  HDR-DEPT-NAME              PIC X(36).                    02080010
           05  FILLER                     PIC X(126) VALUE SPACES.      02090010
                                                                        02100010
       01  HEADER-05.                                                   02110010
           05  FILLER                     PIC X(03) VALUE               02120010
               'DPT'.                                                   02130010
           05  FILLER                     PIC X(02) VALUE SPACES.       02140010
           05  FILLER                     PIC X(03) VALUE               02150010
               'SCL'.                                                   02160010
           05  FILLER                     PIC X(02) VALUE SPACES.       02170010
           05  FILLER                     PIC X(08) VALUE               02180010
               'SKU NBR'.                                               02190010
           05  FILLER                     PIC X(22) VALUE SPACES.       02200010
           05  FILLER                     PIC X(15) VALUE               02210010
               'PROMOTION'.                                             02220010
           05  FILLER                     PIC X(01) VALUE SPACES.       02230010
           05  FILLER                     PIC X(10) VALUE               02240010
               'BEGIN DATE'.                                            02250010
           05  FILLER                     PIC X(01) VALUE SPACES.       02260010
           05  FILLER                     PIC X(10) VALUE               02270010
               'END DATE  '.                                            02280010
           05  FILLER                     PIC X(01) VALUE SPACES.       02290010
           05  FILLER                     PIC X(22) VALUE               02300010
               'PROMO ITEM DESCRIPTION'.                                02310010
           05  FILLER                     PIC X(03) VALUE SPACES.       02320010
           05  FILLER                     PIC X(03) VALUE               02330010
               'A/U'.                                                   02340010
C08622*    05  FILLER                     PIC X(01) VALUE SPACES.       02350038
C08622*    05  FILLER                     PIC X(07) VALUE               02360038
C08622*        'SGN NBR'.                                               02370038
C08622*    05  FILLER                     PIC X(09) VALUE SPACES.       02380038
C08622     05  FILLER                     PIC X(17) VALUE SPACES.       02381038
           05  FILLER                     PIC X(12) VALUE               02390010
               ' PROMO PRICE'.                                          02400010
           05  FILLER                     PIC X(01) VALUE SPACES.       02410010
           05  FILLER                     PIC X(17) VALUE               02420010
               'GP QTY / GP PRICE'.                                     02430010
           05  FILLER                     PIC X(01) VALUE SPACES.       02440010
           05  FILLER                     PIC X(04) VALUE               02450010
               '%/PP'.                                                  02460010
           05  FILLER                     PIC X(01) VALUE SPACES.       02470010
           05  FILLER                     PIC X(15) VALUE               02480010
               'PRICE VIOLATION'.                                       02490010
           05  FILLER                     PIC X(05) VALUE SPACES.       02500010
                                                                        02510010
       01  BLANK-PAGE-NOTE.                                             02520010
           05  FILLER                     PIC X(64) VALUE SPACES.       02530010
           05  FILLER                     PIC X(46) VALUE               02540010
               '***** THIS PAGE INTENTIONALLY LEFT BLANK *****'.        02550010
           05  FILLER                     PIC X(65) VALUE SPACES.       02560010
                                                                        02570010
       01  DETAIL-01.                                                   02580010
           05  DTL-01-DEPT-NBR            PIC X(04).                    02590010
           05  FILLER                     PIC X(01) VALUE SPACES.       02600010
           05  DTL-01-SUB-CL-NBR          PIC X(04).                    02610010
           05  FILLER                     PIC X(01) VALUE SPACES.       02620010
           05  DTL-01-SKU-NBR             PIC X(08).                    02630010
           05  FILLER                     PIC X(01) VALUE SPACES.       02640010
           05  DTL-01-SKU-DESC            PIC X(20).                    02650010
           05  FILLER                     PIC X(01) VALUE SPACES.       02660010
           05  DTL-01-PROMO-NAME-1        PIC X(15).                    02670010
           05  FILLER                     PIC X(01) VALUE SPACES.       02680010
           05  DTL-01-PROMO-BEG-DTE-1     PIC X(10).                    02690010
           05  FILLER                     PIC X(01) VALUE SPACES.       02700010
           05  DTL-01-PROMO-END-DTE-1     PIC X(10).                    02710010
           05  FILLER                     PIC X(01) VALUE SPACES.       02720010
           05  DTL-01-PROMO-ITM-DESC-1    PIC X(25).                    02730010
           05  FILLER                     PIC X(01) VALUE SPACES.       02740010
           05  DTL-01-ADV-IND-1           PIC X(01).                    02750010
           05  FILLER                     PIC X(02) VALUE SPACES.       02760010
C08622*    05  DTL-01-SIGN-NBR            PIC X(10).                    02770038
C08622*    05  FILLER                     PIC X(09) VALUE SPACES.       02780038
C08622     05  FILLER                     PIC X(19) VALUE SPACES.       02781038
           05  DTL-01-PROMO-PRICE-1       PIC ZZ,ZZZ.99.                02790010
           05  FILLER                     PIC X(01) VALUE SPACES.       02800010
           05  DTL-01-PROMO-GRP-QTY-1     PIC Z,ZZZ.                    02810010
           05  FILLER                     PIC X(01) VALUE SPACES.       02820010
           05  DTL-01-SLASH-1             PIC X(01) VALUE SPACES.       02830010
           05  FILLER                     PIC X(01) VALUE SPACES.       02840010
           05  DTL-01-PROMO-GRP-AMT-1     PIC ZZ,ZZZ.ZZ.                02850010
           05  FILLER                     PIC X(02) VALUE SPACES.       02860010
           05  DTL-01-PC-PP-IND           PIC X(02).                    02870010
           05  FILLER                     PIC X(21) VALUE SPACES.       02880010
                                                                        02890010
       01  DETAIL-SGN.                                                  02900010
           05  FILLER                     PIC X(107) VALUE SPACES.      02910010
           05  DTL-NEXT-SGN-NBR           PIC X(07).                    02920010
           05  FILLER                     PIC X(67) VALUE SPACES.       02930010
                                                                        02940010
       01  DETAIL-PRINT-01                PIC X(175) VALUE SPACES.      02950010
                                                                        02960010
       01  DETAIL-02.                                                   02970010
           05  FILLER                     PIC X(40) VALUE SPACES.       02980010
           05  DTL-02-PROMO-NAME-2        PIC X(15).                    02990010
           05  FILLER                     PIC X(01) VALUE SPACES.       03000010
           05  DTL-02-PROMO-BEG-DTE-2     PIC X(10).                    03010010
           05  FILLER                     PIC X(01) VALUE SPACES.       03020010
           05  DTL-02-PROMO-END-DTE-2     PIC X(10).                    03030010
           05  FILLER                     PIC X(01) VALUE SPACES.       03040010
           05  DTL-02-PROMO-ITM-DESC-2    PIC X(25).                    03050010
           05  FILLER                     PIC X(01) VALUE SPACES.       03060010
           05  DTL-02-ADV-IND-2           PIC X(01).                    03070010
C08622*    05  FILLER                     PIC X(02) VALUE SPACES.       03080038
C08622*    05  DTL-02-SIGN-NBR            PIC X(10).                    03090038
C08622*    05  FILLER                     PIC X(09) VALUE SPACES.       03100038
C08622     05  FILLER                     PIC X(21) VALUE SPACES.       03101038
           05  DTL-02-PROMO-PRICE-2       PIC ZZ,ZZZ.99.                03110010
           05  FILLER                     PIC X(01) VALUE SPACES.       03120010
           05  DTL-02-PROMO-GRP-QTY-2     PIC Z,ZZZ.                    03130010
           05  FILLER                     PIC X(01) VALUE SPACES.       03140010
           05  DTL-02-SLASH-2             PIC X(01) VALUE SPACES.       03150010
           05  FILLER                     PIC X(01) VALUE SPACES.       03160010
           05  DTL-02-PROMO-GRP-AMT-2     PIC ZZ,ZZZ.ZZ.                03170010
           05  FILLER                     PIC X(02) VALUE SPACES.       03180010
           05  DTL-02-PC-PP-IND           PIC X(02).                    03190010
           05  FILLER                     PIC X(02) VALUE SPACES.       03200010
           05  DTL-02-WINNER-IND          PIC X(02).                    03210010
           05  FILLER                     PIC X(01) VALUE SPACES.       03220010
           05  DTL-02-WINNER-REASON       PIC X(15).                    03230010
                                                                        03240010
       01  DETAIL-PRINT-02                PIC X(175) VALUE SPACES.      03250010
                                                                        03260010
       01  PC-PROGRAM-CONSTANTS.                                        03270010
           05  PC-MAX-LINES               PIC S9(04) COMP VALUE +59.    03280010
           05  PC-CURRENT-PROGRAM-NAME    PIC  X(08) VALUE 'PMKRP131'.  03290010
           05  PC-RDS-REPORT-NAME         PIC  X(02) VALUE SPACES.      03300010
           05  PC-ONE                     PIC  9(02)  VALUE 01.         03310010
           05  PC-HDR1-TITLE1             PIC  X(38) VALUE              03320010
               'BOGO PRICING OVERLAP REPORT'.                           03330010
C08622*    05  PC-PMKUT117-PGM            PIC  X(08) VALUE 'PMKUT117'.  03340040
           05  PC-HDR1-TITLE4-01          PIC  X(30) VALUE              03350010
               '  POST INITIAL DUE DATE       '.                        03360010
           05  PC-HDR1-TITLE4-02          PIC  X(30) VALUE              03370010
               '  PRE CORRECTIONS             '.                        03380010
           05  PC-HDR1-TITLE4-03          PIC  X(30) VALUE              03390010
               '  POST CORRECTIONS            '.                        03400010
           05  PC-HDR1-TITLE4-04          PIC  X(30) VALUE              03410010
               '  POST CORRECTIONS #2         '.                        03420010
C09985     05  PC-HDR1-TITLE4-05          PIC  X(30) VALUE              03421042
C09985         '  POST CORRECTIONS #3         '.                        03422042
                                                                        03430010
      *-----------------------------------------------------------      03440010
      * PS PROGRAM SWITCHES                                             03450010
      *-----------------------------------------------------------      03460010
       01  PS-PROGRAM-SWITCHES.                                         03470010
           05  PS-SAME-SKU-SW               PIC X(01) VALUE 'N'.        03480010
               88  PS-SAME-SKU                        VALUE 'Y'.        03490010
               88  PS-NOT-SAME-SKU                    VALUE 'N'.        03500010
           05  PS-CONTROL-CARD-SW           PIC X(01) VALUE 'N'.        03510010
               88  PS-CONTROL-CARD-EOF                VALUE 'Y'.        03520010
               88  PS-CONTROL-CARD-NOT-EOF            VALUE 'N'.        03530010
W37986     05  PS-FIRST-TIME-IN-SW          PIC X(01) VALUE 'N'.        03531017
W37986         88  PS-NOT-FIRST-TIME-IN               VALUE 'Y'.        03532017
W37986         88  PS-FIRST-TIME-IN                   VALUE 'N'.        03533017
           05  PS-ADEVNT-AVAIL-SW           PIC X(01) VALUE 'N'.        03540010
               88  PS-NO-ADEVNT                       VALUE 'Y'.        03550010
               88  PS-ADEVNT-AVAIL                    VALUE 'N'.        03560010
           05  PS-SKIP-RECORD-SW            PIC X(01) VALUE 'N'.        03570010
               88  PS-SKIP-RECORD                     VALUE 'Y'.        03580010
               88  PS-NOT-SKIP-RECORD                 VALUE 'N'.        03590010
           05  PS-END-OF-PR-BOGO-SR-SW      PIC X(01) VALUE 'N'.        03600010
               88  PS-END-OF-PR-BOGO-CSR              VALUE 'Y'.        03610010
               88  PS-NOT-END-OF-PR-BOGO-CSR          VALUE 'N'.        03620010
C08622     05  PS-END-OF-PR-BOGO-CSR2-SW    PIC X(01) VALUE 'N'.        03620138
C08622         88  PS-END-OF-PR-BOGO-CSR2             VALUE 'Y'.        03620238
C08622         88  PS-NOT-END-OF-PR-BOGO-CSR2         VALUE 'N'.        03620338
W37986     05  PS-CONTROL-CARD-STR-SW       PIC X(01) VALUE 'N'.        03621017
W37986         88  PS-END-OF-CC-FILE-STR              VALUE 'Y'.        03622017
W37986         88  PS-NOT-END-OF-CC-FILE-STR          VALUE 'N'.        03623017
070941     05  PS-END-OF-LOGON-FILE-SW      PIC X(1)  VALUE 'N'.        03623150
070941         88  PS-END-OF-LOGON-FILE               VALUE 'Y'.        03623250
070941     05  PS-ORA-SRC-CTL-DONE-SW       PIC X(1)  VALUE 'N'.        03623350
070941         88  PS-ORA-SRC-EMPTY                   VALUE 'Y'.        03623450
070941                                                                  03623549
070941 01  CC-ORACLE-CONNECTION.                                        03623649
070941     05  CC-ORACLE-USERID             PIC X(40).                  03623749
070941         88 CC-AUTO-LOGON                       VALUE '/'.        03623850
070941     05  CC-ORACLE-PASSWORD           PIC X(40).                  03623949
070941                                                                  03624049
                                                                        03625017
                                                                        03630010
       01  PV-PROGRAM-VARIABLES.                                        03640010
070941     05  PV-ORACLE-USERID-LEN       PIC S9(4) VALUE ZEROS         03641049
070941                                              COMP SYNC.          03642049
070941     05  PV-ORACLE-PASSWORD-LEN     PIC S9(4) VALUE ZEROS         03643049
070941                                              COMP SYNC.          03644049
           05 PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.       03650010
           05 PV-TABLE-NAME               PIC X(30) VALUE SPACES.       03660010
           05 PV-OPERATION-MSG-1          PIC X(40) VALUE SPACES.       03670010
           05 PV-OPERATION-MSG-2          PIC X(40) VALUE SPACES.       03680010
           05 PV-CPU-TIME                 PIC 9(08) VALUE ZERO.         03690010
           05 PV-PAGE-CNT                 PIC 9(05) VALUE ZERO.         03700010
           05 PV-ADVANCE-LINES            PIC S9(04) COMP VALUE +1.     03710010
           05 PV-ADVANCE-CNT              PIC S9(04) COMP VALUE +0.     03720010
           05 PV-LINE-CNT                 PIC S9(04) COMP VALUE +0.     03730010
           05 PV-SKU-CNT                  PIC S9(04) COMP VALUE +0.     03740010
           05 PV-MAIN-INDEX               PIC S9(04)  VALUE +0          03750010
                                                        COMP SYNC.      03760010
           05 PV-NON-MAIN-INDEX           PIC S9(04)  VALUE +0          03770010
                                                        COMP SYNC.      03780010
           05 PV-PAGE-DIV                 PIC S9(05) VALUE +0.          03790010
           05 PV-PAGE-REM                 PIC S9(03) VALUE +0.          03800010
           05 PV-UPC-ID                   PIC S9(9) COMP VALUE ZEROS.   03810010
           05 PV-PROMO-NBR                PIC S9(3)V COMP-3.            03820010
           05 PV-SGN-NBR                  PIC 9(07) COMP VALUE ZEROS.   03830010
           05 PV-SIGN-COUNT               PIC S9(9) VALUE ZERO COMP-3.  03840010
           05 PV-AD-EVNT-NM               PIC X(25) VALUE SPACES.       03850010
           05 PV-AD-EVNT-NBR-TXT          PIC X(15) VALUE SPACES.       03860010
           05 PV-AD-EVNT-NBR-TXT-SV       PIC X(15) VALUE SPACES.       03870010
           05 PV-MDSE-SELN-LNE-ID         PIC S9(10) COMP-3 VALUE +0.   03880010
           05 PV-MDSE-SELN-LNE-ID-S       PIC S9(10) COMP-3 VALUE +0.   03890010
           05 PV-AD-EVNT-ID               PIC S9(10) COMP-3 VALUE +0.   03900010
           05 PV-PROMO-ID                 PIC S9(10) COMP-3 VALUE +0.   03910010
           05 PV-REPORT-TYPE              PIC X(02) VALUE SPACES.       03920010
           05 PV-MAIN-PROMO-ID            PIC S9(10) COMP-3 VALUE +0.   03930010
           05 PV-MAIN-PROMO-NM            PIC X(25) VALUE SPACES.       03940010
           05 PV-NON-MAIN-PROMO-ID        PIC S9(10) COMP-3 VALUE +0.   03950010
           05 PV-NON-MAIN-PROMO-ID-SAVED  PIC S9(10) COMP-3 VALUE +0.   03960010
           05 PV-NON-MAIN-PROMO-NM        PIC X(25) VALUE SPACES.       03970010
           05 PV-MAIN-PROMO-STRT-TMST     PIC X(19) VALUE SPACES.       03980010
           05 PV-MAIN-PROMO-END-TMST      PIC X(19) VALUE SPACES.       03990010
           05 PV-NON-MAIN-PROMO-STRT-TMST PIC X(19) VALUE SPACES.       04000010
           05 PV-NON-MAIN-PROMO-END-TMST  PIC X(19) VALUE SPACES.       04010010
           05 PV-MAIN-PROMO-ITM-ID        PIC S9(10) COMP-3 VALUE +0.   04020010
           05 PV-NON-MAIN-PROMO-ITM-ID    PIC S9(10) COMP-3 VALUE +0.   04030010
           05 PV-MAIN-PROMO-ITM-DESC      PIC X(25) VALUE SPACES.       04040010
           05 PV-NON-MAIN-PROMO-ITM-DESC  PIC X(25) VALUE SPACES.       04050010
           05 PV-MAIN-ADV-IND             PIC X(01) VALUE SPACES.       04060010
           05 PV-NON-MAIN-ADV-IND         PIC X(01) VALUE SPACES.       04070010
           05 PV-DEPT-NBR                 PIC S9(04) COMP-3 VALUE +0.   04080010
           05 PV-DEPT-NBR-SAVED           PIC S9(04) COMP-3 VALUE +0.   04090010
           05 PV-SUB-CL-NBR               PIC S9(04) COMP-3 VALUE +0.   04100010
           05 PV-SKU-NBR                  PIC S9(08) COMP-3 VALUE +0.   04110010
           05 PV-SKU-NBR-SAVED            PIC S9(08) COMP-3 VALUE +0.   04120010
           05 PV-MAIN-PRIC-PT-AMT       PIC S9(10)V9(3) COMP-3 VALUE +0.04130010
           05 PV-NON-MAIN-PRIC-PT-AMT   PIC S9(10)V9(3) COMP-3 VALUE +0.04140010
           05 PV-NON-MAIN-PRIC-PT-AMT-S PIC S9(10)V9(3) COMP-3 VALUE +0.04150010
           05 PV-MAIN-PROMO-GP-QTY        PIC S9(05) COMP-3 VALUE +0.   04160010
           05 PV-NON-MAIN-PROMO-GP-QTY    PIC S9(05) COMP-3 VALUE +0.   04170010
           05 PV-MAIN-PROMO-GP-AMT      PIC S9(09)V9(2) COMP-3 VALUE +0.04180010
           05 PV-NON-MAIN-PROMO-GP-AMT  PIC S9(09)V9(2) COMP-3 VALUE +0.04190010
           05 PV-MAIN-PRICG-TYP-CDE       PIC X(03) VALUE SPACES.       04200010
           05 PV-NON-MAIN-PRICG-TYP-CDE   PIC X(03) VALUE SPACES.       04210010
           05 PV-LOC-NBR                  PIC S9(05) COMP-3 VALUE +0.   04220010
           05 PV-DEPT-NM                  PIC X(20) VALUE SPACES.       04230010
           05 PV-GMA-NBR                  PIC S9(4) COMP-3 VALUE +0.    04240010
           05 PV-GMA-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    04250010
           05 PV-DMA-NBR                  PIC S9(4) COMP-3 VALUE +0.    04260010
           05 PV-DMA-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    04270010
           05 PV-BYR-NBR                  PIC S9(4) COMP-3 VALUE +0.    04280010
           05 PV-BYR-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    04290010
           05 PV-GMM-FRST-NM              PIC X(20).                    04300010
           05 PV-GMM-LAST-NM              PIC X(30).                    04310010
           05 PV-DMM-FRST-NM              PIC X(20).                    04320010
           05 PV-DMM-LAST-NM              PIC X(30).                    04330010
           05 PV-BYR-FRST-NM              PIC X(20).                    04340010
           05 PV-BYR-LAST-NM              PIC X(30).                    04350010
C08622     05 PV-SKU-DESC                 PIC X(30)  VALUE SPACES.      04351038
           05 PV-TEMP-VALUE               PIC X(25)  VALUE SPACES.      04360010
           05 PV-TEMP-VALUE-2             PIC X(10)  VALUE SPACES.      04370010
W37986     05 PV-CNT-STRS                 PIC 9(02)  VALUE ZEROES.      04371017
W37986     05 PV-HOST-STRS.                                             04372017
W37986        10  PV-HOST-STR-1           PIC S9(04) VALUE +0 COMP-3.   04373017
W37986        10  PV-HOST-STR-2           PIC S9(04) VALUE +0 COMP-3.   04374017
W37986        10  PV-HOST-STR-3           PIC S9(04) VALUE +0 COMP-3.   04375017
W37986        10  PV-HOST-STR-4           PIC S9(04) VALUE +0 COMP-3.   04376017
W37986        10  PV-HOST-STR-5           PIC S9(04) VALUE +0 COMP-3.   04377017
W37986        10  PV-HOST-STR-6           PIC S9(04) VALUE +0 COMP-3.   04378017
W37986        10  PV-HOST-STR-7           PIC S9(04) VALUE +0 COMP-3.   04379017
W37986        10  PV-HOST-STR-8           PIC S9(04) VALUE +0 COMP-3.   04379117
W37986        10  PV-HOST-STR-9           PIC S9(04) VALUE +0 COMP-3.   04379217
W37986        10  PV-HOST-STR-10          PIC S9(04) VALUE +0 COMP-3.   04379317
W37986        10  PV-HOST-STR-11          PIC S9(04) VALUE +0 COMP-3.   04379417
W37986        10  PV-HOST-STR-12          PIC S9(04) VALUE +0 COMP-3.   04379517
W37986        10  PV-HOST-STR-13          PIC S9(04) VALUE +0 COMP-3.   04379617
W37986        10  PV-HOST-STR-14          PIC S9(04) VALUE +0 COMP-3.   04379717
W37986        10  PV-HOST-STR-15          PIC S9(04) VALUE +0 COMP-3.   04379817
                                                                        04380010
      ***************************************************************** 04390010
      *    THE LAYOUT FOR THE INPUT CONTROL CARD                      * 04400010
      ***************************************************************** 04410010
       01 CC-ADEVNT-RPT-FILE.                                           04420010
          05 CC-AD-EVNT-ID                PIC 9(10) VALUE 0.            04430010
          05 FILLER                       PIC X(01) VALUE SPACES.       04440010
          05 CC-PROMO-ID                  PIC 9(10) VALUE 0.            04450010
          05 FILLER                       PIC X(01) VALUE SPACES.       04460010
          05 CC-REPORT-TYPE               PIC 9(02) VALUE 0.            04470010
                                                                        04480010
      ***************************************************************** 04490010
      *  STANDARD HEADER LINE - KOHLS 175 COL                           04500010
      ***************************************************************** 04510010
           COPY DPWS150O.                                               04520010
                                                                        04530010
C08622***************************************************************** 04540040
C08622*    THE LAYOUT FOR THE GET SIGN NUMBER AND SKU DESCRIPTION     * 04550040
C08622*    PROGRAM PMKUT117 PARAMETER LIST.                           * 04560040
C08622***************************************************************** 04570040
C08622*    COPY PMRD117.                                                04580040
C08622*                                                                 04590041
W37986***************************************************************** 04591017
W37986*    THE LAYOUT FOR INPUT FILE - SMPL-STR-INFILE                * 04592017
W37986***************************************************************** 04593017
W37986 01  CC-SMPL-STR-INFILE-REC.                                      04594017
W37986     05  CC-STR-NBR                     PIC 9(04) VALUE 0.        04595017
W37986     05  FILLER                         PIC X(76) VALUE SPACES.   04596017
W37986                                                                  04597017
      ***************************************************************** 04600010
      *                      O  R  A  C  L  E                           04610010
      *----------------------------------------------------------------*04620010
      *    ORACLE DECLARE SECTION                                       04630010
      *----------------------------------------------------------------*04640010
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     04650010
                                                                        04660010
      *---------------------------------------------------------------* 04670010
      * ORACLE LOGON WORKING STORAGE COPYBOOK                           04680010
      *---------------------------------------------------------------* 04690010
       01      PC-ENT01-TYPE-CDE          PIC X(02)      VALUE '01'.    04700010
       01      PV-ORACLE-ID               PIC X(1)       VALUE '/'.     04710010
                                                                        04720010
       01      USERNAME                   PIC X(10)      VARYING.       04730010
       01      PASSWD                     PIC X(10)      VARYING.       04740010
                                                                        04750010
       01      ORACLE-RETURN              PIC X(200)     VALUE SPACES.  04760010
                                                                        04770010
           EXEC SQL END DECLARE SECTION END-EXEC.                       04780010
           EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       04790010
                                                                        04800010
       PROCEDURE DIVISION.                                              04810010
      ***************************************************************** 04820010
      * MAINLINE ROUTINE                                                04830010
      ***************************************************************** 04840010
       A100-MAINLINE.                                                   04850010
                                                                        04860010
           PERFORM B100-INITIALIZE.                                     04870010
                                                                        04880010
           IF NOT PS-CONTROL-CARD-EOF                                   04890010
              PERFORM B200-READ-RPT-IN-FILE                             04900010
                      UNTIL PS-CONTROL-CARD-EOF                         04910010
           END-IF.                                                      04920010
                                                                        04930010
           PERFORM B900-CLOSE-FILES.                                    04940010
W37986     GOBACK.                                                      04950024
                                                                        04960010
      ***************************************************************** 04970010
      * INITIALIZE ROUTINE                                              04980010
      ***************************************************************** 04990010
       B100-INITIALIZE.                                                 05000010
                                                                        05010010
           OPEN INPUT  CC-RPT-IN-FILE                                   05020010
W37986                 SMPL-STR-INFILE                                  05021022
                OUTPUT PR-BOGO-RPT.                                     05030010
                                                                        05040010
           MOVE ZEROES                   TO PV-GMA-NBR-SAVED.           05050010
                                                                        05060010
070941*    PERFORM PM700-A000-ORACLE-SETUP.                             05070051
070941     PERFORM B110-ORACLE-SETUP.                                   05071049
                                                                        05080010
      * SETS THE CURRENT DATE AND TIME ON THE TITLE OF THE REPORT.      05090010
           ACCEPT CD-CPU-DATE FROM DATE.                                05100010
           MOVE CD-CPU-YR                TO CD-CPU-YY.                  05110010
           MOVE CD-CPU-MO                TO CD-CPU-MM                   05120010
           MOVE CD-CPU-DY                TO CD-CPU-DD.                  05130010
                                                                        05140010
           ACCEPT CT-CPU-TIME FROM TIME.                                05150010
           MOVE CT-CPU-HR                TO DP150O-RUN-HOUR.            05160010
           MOVE CT-CPU-MIN               TO DP150O-RUN-MINUTE.          05170010
           MOVE CD-CPU-MO                TO DP150O-RUN-MONTH.           05180010
           MOVE CD-CPU-DY                TO DP150O-RUN-DAY.             05190010
           MOVE CD-CPU-YR                TO DP150O-RUN-YEAR.            05200010
           MOVE PC-CURRENT-PROGRAM-NAME  TO DP150O-PROGRAM-NAME.        05210010
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       05220010
                                                                        05230010
           PERFORM B200-READ-RPT-IN-FILE.                               05240010
                                                                        05250010
070941                                                                  05260849
070941 B110-ORACLE-SETUP.                                               05260949
070941                                                                  05261049
070941     OPEN INPUT ORACLE-LOGON-FILE.                                05261149
070941                                                                  05261249
070941     PERFORM B120-READ-ORACLE-LOGON.                              05261349
070941                                                                  05261449
070941     CLOSE ORACLE-LOGON-FILE.                                     05261549
070941                                                                  05261649
070941     IF ((PS-END-OF-LOGON-FILE)                                   05261749
070941             OR (CC-ORACLE-CONNECTION = SPACES))                  05261849
070941         DISPLAY '** ABEND **'                                    05261949
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          05262049
070941                 ' - ORACLE LOGON CONTROL CARD '                  05262149
070941                   'NOT PROVIDED'                                 05262249
070941         SET PS-ORA-SRC-EMPTY TO TRUE                             05262349
070941         CALL 'ILBOABN0' USING ABEND-CODE                         05262449
070941     END-IF.                                                      05262549
070941                                                                  05262649
070941     IF CC-AUTO-LOGON                                             05262749
070941         DISPLAY PC-CURRENT-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'05262849
070941         EXEC SQL                                                 05262949
070941              CONNECT :USERNAME                                   05263049
070941         END-EXEC                                                 05263149
070941     ELSE                                                         05263249
070941         INITIALIZE PV-ORACLE-USERID-LEN                          05263349
070941                    PV-ORACLE-PASSWORD-LEN                        05263449
070941         INSPECT CC-ORACLE-USERID                                 05263549
070941             TALLYING PV-ORACLE-USERID-LEN                        05263649
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     05263749
070941      INSPECT CC-ORACLE-PASSWORD                                  05263849
070941          TALLYING PV-ORACLE-PASSWORD-LEN                         05263949
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     05264049
070941      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           05264149
070941                USERNAME-ARR                                      05264249
070941      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   05264349
070941      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       05264449
070941                PASSWD-ARR                                        05264549
070941      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   05264649
070941      DISPLAY PC-CURRENT-PROGRAM-NAME                             05264749
070941              ' - LOGON TO ORACLE AS USER '                       05264849
070941                USERNAME-ARR                                      05264949
070941      EXEC SQL                                                    05265049
070941        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   05265149
070941      END-EXEC                                                    05265249
070941      INITIALIZE CC-ORACLE-PASSWORD                               05265349
070941                 PASSWD                                           05265449
070941      END-IF.                                                     05265549
070941                                                                  05265649
070941     IF (SQLCODE NOT = 0)                                         05265749
070941         DISPLAY PV-PARAGRAPH-NAME                                05265849
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          05265949
070941                 ' - ERROR LOGGING ON TO ORACLE'                  05266049
070941         PERFORM Z100-ABEND                                       05266149
070941     END-IF.                                                      05266249
070941                                                                  05266349
070941******************************************************************05266449
070941* NEEDS TO BE IN FOR NOW TIL KURT FIXES CURSOR SHARING BUG        05266549
070941* OTHERWISE GET AN ORACLE ERROR (IE: 3113).                       05266649
070941******************************************************************05266749
070941     EXEC SQL                                                     05266849
070941      ALTER SESSION                                               05266949
070941            SET CURSOR_SHARING = 'EXACT'                          05267049
070941     END-EXEC.                                                    05267149
070941                                                                  05267249
070941                                                                  05267349
070941***************************************************************** 05267449
070941*  B120-READ-ORACLE-LOGON.                                      * 05267549
070941* ==> PROCESSES:                                                * 05267649
070941*   - READ ORCALE CONTROL CARD                                  * 05267749
070941* ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 05267849
070941***************************************************************** 05267949
070941 B120-READ-ORACLE-LOGON.                                          05268049
070941                                                                  05268149
070941     READ ORACLE-LOGON-FILE                                       05268249
070941         INTO CC-ORACLE-CONNECTION                                05268349
070941         AT END                                                   05268449
070941             SET PS-END-OF-LOGON-FILE TO TRUE                     05268549
070941     END-READ.                                                    05268649
      ****************************************************************  05269010
      * B200-READ-RPT-IN-FILE.                                          05270010
      *     READ IN THE AD EVNT ID AND RPT TYPE FROM THE INPUT CC.      05280010
      ****************************************************************  05290010
       B200-READ-RPT-IN-FILE.                                           05300010
                                                                        05310010
           READ CC-RPT-IN-FILE INTO CC-ADEVNT-RPT-FILE                  05320010
              AT END                                                    05330010
                 SET PS-CONTROL-CARD-EOF TO TRUE                        05340010
           END-READ.                                                    05350010
                                                                        05360010
           IF PS-CONTROL-CARD-EOF                                       05370010
               DISPLAY ' '                                              05380010
               DISPLAY 'AT END OF ADEVENT CC'                           05390010
           ELSE                                                         05400010
W37986         IF PS-FIRST-TIME-IN                                      05401117
W37986             SET PS-NOT-FIRST-TIME-IN TO TRUE                     05401217
W37986                                                                  05401317
W37986             PERFORM UNTIL PS-END-OF-CC-FILE-STR                  05401417
W37986                PERFORM B240-READ-SMPL-STR-FILE                   05401517
W37986             END-PERFORM                                          05401617
W37986                                                                  05401717
W37986         END-IF                                                   05401817
               MOVE CC-AD-EVNT-ID    TO PV-AD-EVNT-ID                   05410010
               MOVE CC-PROMO-ID      TO PV-PROMO-ID                     05420010
               MOVE CC-REPORT-TYPE  TO PV-REPORT-TYPE                   05430010
                                       PC-RDS-REPORT-NAME               05440010
               DISPLAY 'PV-AD-EVNT-ID: ' PV-AD-EVNT-ID                  05450010
               DISPLAY 'PV-PROMO-ID  : ' PV-PROMO-ID                    05460010
               DISPLAY 'PV-REPORT-TYPE: ' PV-REPORT-TYPE                05470010
               PERFORM B250-SELECT-ADEVNT-INFO                          05480010
                                                                        05490010
               IF PS-ADEVNT-AVAIL                                       05500010
                 PERFORM C100-DECLARE-PR-BOGO-CSR                       05510036
                 PERFORM C200-OPEN-PR-BOGO-CSR                          05520036
                 PERFORM C300-FETCH-PR-BOGO-CSR                         05530036
                                                                        05540036
                 IF NOT PS-END-OF-PR-BOGO-CSR                           05550036
                    PERFORM C400-PROCESS-PR-BOGO-CSR                    05560036
                           UNTIL PS-END-OF-PR-BOGO-CSR                  05570036
                 END-IF                                                 05580036
                                                                        05590036
                 PERFORM C500-CLOSE-PR-BOGO-CSR                         05600036
C08622                                                                  05600138
C08622           PERFORM F000-PROCESS-MAIN-PROMO-OVRLP                  05601038
               END-IF                                                   05610010
           END-IF.                                                      05620010
                                                                        05630010
W37986****************************************************************  05631019
W37986* B240-READ-SMPL-STR-FILE.                                        05632019
W37986*     READ IN SAMPLE STORE INFO FROM SMPL-STR-INFILE              05633019
W37986****************************************************************  05634019
W37986 B240-READ-SMPL-STR-FILE.                                         05635019
W37986                                                                  05636019
W37986     READ SMPL-STR-INFILE INTO CC-SMPL-STR-INFILE-REC             05637019
W37986       AT END                                                     05638019
W37986          SET PS-END-OF-CC-FILE-STR        TO TRUE                05639019
W37986     END-READ.                                                    05639119
W37986                                                                  05639219
W37986     ADD 1                                 TO PV-CNT-STRS.        05639319
W37986     IF  PS-END-OF-CC-FILE-STR                                    05639419
W37986     AND PV-CNT-STRS = 1                                          05639519
W37986         MOVE 'B240-READ-SMPL-STR-FILE'    TO PV-PARAGRAPH-NAME   05639619
W37986         MOVE 'CONTROL CARD IS EMPTY'      TO PV-OPERATION-MSG-1  05639719
W37986         SET ABEND-4003-CTRL-CARD-ERROR    TO TRUE                05639819
W37986         PERFORM Z200-ABEND                                       05639920
W37986     END-IF                                                       05640019
W37986                                                                  05640119
W37986     IF PS-END-OF-CC-FILE-STR                                     05640219
W37986        CONTINUE                                                  05640319
W37986     ELSE                                                         05640419
W37986        EVALUATE TRUE                                             05640519
W37986          WHEN PV-CNT-STRS = 1                                    05640619
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-1       05640719
W37986          WHEN PV-CNT-STRS = 2                                    05640819
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-2       05640919
W37986          WHEN PV-CNT-STRS = 3                                    05641019
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-3       05641119
W37986          WHEN PV-CNT-STRS = 4                                    05641219
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-4       05641319
W37986          WHEN PV-CNT-STRS = 5                                    05641419
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-5       05641519
W37986          WHEN PV-CNT-STRS = 6                                    05641619
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-6       05641719
W37986          WHEN PV-CNT-STRS = 7                                    05641819
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-7       05641919
W37986          WHEN PV-CNT-STRS = 8                                    05642019
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-8       05642119
W37986          WHEN PV-CNT-STRS = 9                                    05642219
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-9       05642319
W37986          WHEN PV-CNT-STRS = 10                                   05642419
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-10      05642519
W37986          WHEN PV-CNT-STRS = 11                                   05642619
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-11      05642719
W37986          WHEN PV-CNT-STRS = 12                                   05642819
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-12      05642919
W37986          WHEN PV-CNT-STRS = 13                                   05643019
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-13      05643119
W37986          WHEN PV-CNT-STRS = 14                                   05643219
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-14      05643319
W37986          WHEN PV-CNT-STRS = 15                                   05643419
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-15      05643519
W37986        END-EVALUATE                                              05643619
W37986     END-IF.                                                      05643719
      ****************************************************************  05644010
      * B250-SELECT-ADEVNT-INFO.                                        05650010
      *     CHECK TO SEE THAT ROWS FOR THE AD-EVNT-ID PASSED IN         05660010
      *     EXIST.                                                      05670010
      ****************************************************************  05680010
       B250-SELECT-ADEVNT-INFO.                                         05690010
                                                                        05700010
           EXEC SQL                                                     05710010
               SELECT  B.AD_EVNT_NM                                     05720010
                      ,B.AD_EVNT_NBR_TXT                                05730010
                 INTO  :PV-TEMP-VALUE                                   05740010
                      ,:PV-TEMP-VALUE-2                                 05750010
                 FROM  PMT_SKU_LVL_PRICG_BY_LOC A                       05760010
                      ,PMV_PROMO_DIM B                                  05770010
                WHERE  A.AD_EVNT_ID   = :PV-AD-EVNT-ID                  05780010
                  AND  A.AD_EVNT_ID   = B.AD_EVNT_ID                    05790010
W37986            AND  A.LOC_NBR                                        05791019
W37986              NOT IN ( SELECT LOC_NBR                             05792019
W37986                         FROM XKT_LOC                             05793019
W37986                        WHERE E_BUS_IND = 'Y'                     05794019
W37986                          AND LOC_NBR IN ( :PV-HOST-STR-1         05795019
W37986                                          ,:PV-HOST-STR-2         05796019
W37986                                          ,:PV-HOST-STR-3         05797019
W37986                                          ,:PV-HOST-STR-4         05798019
W37986                                          ,:PV-HOST-STR-5         05799019
W37986                                          ,:PV-HOST-STR-6         05799119
W37986                                          ,:PV-HOST-STR-7         05799219
W37986                                          ,:PV-HOST-STR-8         05799319
W37986                                          ,:PV-HOST-STR-9         05799419
W37986                                          ,:PV-HOST-STR-10        05799519
W37986                                          ,:PV-HOST-STR-11        05799619
W37986                                          ,:PV-HOST-STR-12        05799719
W37986                                          ,:PV-HOST-STR-13        05799819
W37986                                          ,:PV-HOST-STR-14        05799919
W37986                                          ,:PV-HOST-STR-15        05800019
W37986                                          )                       05800119
W37986                      )                                           05800219
           END-EXEC.                                                    05801010
                                                                        05810010
           EVALUATE TRUE                                                05820010
             WHEN SQLCODE = ZEROES                                      05830010
             WHEN SQLCODE = 2112                                        05840010
             WHEN SQLCODE = -2112                                       05850010
                  SET PS-ADEVNT-AVAIL TO TRUE                           05860010
             WHEN SQLCODE = 1403                                        05870010
                  SET PS-NO-ADEVNT TO TRUE                              05880010
                  DISPLAY 'NO INFORMATION FOR THE AD EVENT EXISTS'      05890010
                  DISPLAY 'PV-AD-EVNT-ID ' PV-AD-EVNT-ID                05900010
                  DISPLAY '*** NOTHING TO REPORT ***'                   05910010
             WHEN OTHER                                                 05920010
                  SET ABEND-4013-SQL-ERROR TO TRUE                      05930010
                  MOVE 'PMT_SKU_LVL_PRICG_BY_LOC' TO PV-TABLE-NAME      05940010
                  MOVE 'B250-SELECT-ADEVNT-INFO'                        05950010
                                             TO PV-PARAGRAPH-NAME       05960010
                  MOVE 'ERROR ON SELECT ADEVNT INFO'                    05970010
                                             TO PV-OPERATION-MSG-1      05980010
                  PERFORM Z100-ABEND                                    05990010
           END-EVALUATE.                                                06000010
                                                                        06010010
      ***************************************************************** 06020010
      *    CLOSE FILES                                                  06030010
      ***************************************************************** 06040010
       B900-CLOSE-FILES.                                                06050010
                                                                        06060010
           CLOSE  CC-RPT-IN-FILE                                        06070010
W37986            SMPL-STR-INFILE                                       06071022
                  PR-BOGO-RPT.                                          06080010
                                                                        06090010
      ***********************************************************       06100010
      * C100-DECLARE-PR-BOGO-CSR.                                       06110010
      ***********************************************************       06120010
       C100-DECLARE-PR-BOGO-CSR.                                        06130010
                                                                        06140010
           EXEC SQL                                                     06150010
                DECLARE BOGOCSR CURSOR FOR                              06160010
                SELECT                                                  06170010
                      C.AD_EVNT_NBR_TXT,                                06180010
                      C.AD_EVNT_NM,                                     06190010
                      A.PROMO_ID,                                       06200010
                      C.PROMO_NM,                                       06210010
                      A2.PROMO_ID,                                      06220010
                      C2.PROMO_NM,                                      06230010
                      A2.MDSE_SELN_LNE_ID,                              06240010
                      A.PROMO_STRT_TMST,                                06250010
                      A2.PROMO_STRT_TMST,                               06260010
                      A.PROMO_END_TMST,                                 06270010
                      A2.PROMO_END_TMST,                                06280010
                      A.PROMO_ITM_ID,                                   06290010
                      A2.PROMO_ITM_ID,                                  06300010
                      A.DEPT_NBR,                                       06310010
                      A.SUB_CL_NBR,                                     06320010
                      A.SKU_NBR,                                        06330010
                      A.PROMO_PRIC_PT_AMT,                              06340010
                      A2.PROMO_PRIC_PT_AMT,                             06350010
                      A.PROMO_GP_QTY,                                   06360010
                      A2.PROMO_GP_QTY,                                  06370010
                      A.PROMO_GP_AMT,                                   06380010
                      A2.PROMO_GP_AMT,                                  06390010
                      A.PROMO_PRICG_TYP_CDE,                            06400010
                      A2.PROMO_PRICG_TYP_CDE,                           06410010
                      A.LOC_NBR,                                        06420010
                      B.PROMO_ITM_DESC,                                 06430010
                      B2.PROMO_ITM_DESC,                                06440010
                      B.ADV_IND,                                        06450010
                      B2.ADV_IND,                                       06460010
                      D.DEPT_NM,                                        06470010
                      D.GMA_NBR,                                        06480010
                      D.DMA_NBR,                                        06490010
                      D.BYR_NBR,                                        06500010
                      D.GMM_FRST_NM,                                    06510010
                      D.GMM_LAST_NM,                                    06520010
                      D.DMM_FRST_NM,                                    06530010
                      D.DMM_LAST_NM,                                    06540010
                      D.BYR_FRST_NM,                                    06550010
C08622*               D.BYR_LAST_NM                                     06560039
C08622                D.BYR_LAST_NM,                                    06560139
C08622                E.SKU_DESC                                        06561038
                 FROM PMT_SKU_LVL_PRICG_BY_LOC A,                       06570010
                      PMT_SKU_LVL_PRICG_BY_LOC A2,                      06580010
                      PMT_PROMO_ITM B,                                  06590010
                      PMT_PROMO_ITM B2,                                 06600010
                      PMV_PROMO_DIM C,                                  06610010
                      PMV_PROMO_DIM C2,                                 06620010
C08622*               PMV_PRSN_MDSE_HIER D                              06630038
C08622                PMV_PRSN_MDSE_HIER D,                             06631038
C08622                XKT_SKU E                                         06632038
                WHERE C.PROMO_STAT_CDE    = 'S'                         06640010
                  AND A.PROMO_ID          = :PV-PROMO-ID                06650010
                  AND A2.PROMO_ID        <> :PV-PROMO-ID                06660033
                  AND A2.AD_EVNT_ID       = A.AD_EVNT_ID                06670010
                  AND A.PROMO_STRT_TMST  <=                             06680010
                      A2.PROMO_END_TMST                                 06690010
                  AND A.PROMO_END_TMST   >=                             06700010
                      A2.PROMO_STRT_TMST                                06710010
                  AND A.SKU_NBR           = A2.SKU_NBR                  06720010
C08622            AND A.SKU_NBR           = E.SKU_NBR                   06721038
                  AND A.LOC_NBR           = A2.LOC_NBR                  06730010
W37986            AND A.LOC_NBR                                         06732119
W37986              NOT IN ( SELECT LOC_NBR                             06732219
W37986                         FROM XKT_LOC                             06732319
W37986                        WHERE E_BUS_IND = 'Y'                     06732419
W37986                          AND LOC_NBR IN ( :PV-HOST-STR-1         06732519
W37986                                          ,:PV-HOST-STR-2         06732619
W37986                                          ,:PV-HOST-STR-3         06732719
W37986                                          ,:PV-HOST-STR-4         06732819
W37986                                          ,:PV-HOST-STR-5         06732919
W37986                                          ,:PV-HOST-STR-6         06733019
W37986                                          ,:PV-HOST-STR-7         06733119
W37986                                          ,:PV-HOST-STR-8         06733219
W37986                                          ,:PV-HOST-STR-9         06733319
W37986                                          ,:PV-HOST-STR-10        06733419
W37986                                          ,:PV-HOST-STR-11        06733519
W37986                                          ,:PV-HOST-STR-12        06733619
W37986                                          ,:PV-HOST-STR-13        06733719
W37986                                          ,:PV-HOST-STR-14        06733819
W37986                                          ,:PV-HOST-STR-15        06733919
W37986                                          )                       06734019
W37986                      )                                           06734119
                  AND A.DEPT_NBR          = A2.DEPT_NBR                 06740010
                  AND A.PROMO_ID          = C.PROMO_ID                  06750010
                  AND A2.PROMO_ID         = C2.PROMO_ID                 06760010
                  AND A.AD_EVNT_ID        = C.AD_EVNT_ID                06770010
                  AND A2.AD_EVNT_ID        = C2.AD_EVNT_ID              06780010
                  AND A.PROMO_ITM_ID      = B.PROMO_ITM_ID              06790010
                  AND A2.PROMO_ITM_ID     = B2.PROMO_ITM_ID             06800010
                  AND A.DEPT_NBR            = D.DEPT_NBR                06810010
                  AND A2.DEPT_NBR           = D.DEPT_NBR                06820010
                  AND A.PROMO_PRICG_TYP_CDE  IN ('GBL', 'GBD', 'GBP')   06830010
                  AND A2.PROMO_PRICG_TYP_CDE <> 'UNS'                   06840010
                  AND A.PROMO_PRICG_TYP_CDE <> A2.PROMO_PRICG_TYP_CDE   06850010
                ORDER BY D.GMA_NBR,                                     06860010
                         D.DMA_NBR,                                     06870010
                         D.BYR_NBR,                                     06880010
                         A.DEPT_NBR,                                    06890010
                         A.SKU_NBR,                                     06900010
                         A2.MDSE_SELN_LNE_ID                            06910010
           END-EXEC.                                                    06920010
                                                                        06930010
      ***********************************************************       06940010
      * C200-OPEN-PR-BOGO-CSR.                                          06950010
      ***********************************************************       06960010
       C200-OPEN-PR-BOGO-CSR.                                           06970010
           ACCEPT PV-CPU-TIME FROM TIME.                                06980010
           DISPLAY ' '.                                                 06990010
           DISPLAY 'START PR CONF CSR OPEN: ' PV-CPU-TIME.              07000010
           SET PS-NOT-END-OF-PR-BOGO-CSR TO TRUE.                       07010010
                                                                        07020010
           EXEC SQL                                                     07030010
               OPEN BOGOCSR                                             07040010
           END-EXEC.                                                    07050010
                                                                        07060010
           EVALUATE TRUE                                                07070010
               WHEN SQLCODE = ZERO                                      07080010
               WHEN SQLCODE = 1403                                      07090010
                   CONTINUE                                             07100010
               WHEN SQLCODE = 8103                                      07110010
                   DISPLAY '*** NO PR-BOGO TO REPORT ***'               07120010
                   MOVE PV-TEMP-VALUE TO PV-AD-EVNT-NM                  07130010
                   MOVE PV-TEMP-VALUE-2 TO PV-AD-EVNT-NBR-TXT           07140010
                   DISPLAY 'C200-OPEN-PR-BOGO-CSR'                      07150010
                   PERFORM H100-WRITE-PAGE-HEADER                       07160010
                   PERFORM W300-WRITE-LEGAL-LINE                        07170010
                   PERFORM W401-WRITE-NOTHING-TO-RPT-LINE               07180010
                   SET PS-END-OF-PR-BOGO-CSR TO TRUE                    07190010
               WHEN OTHER                                               07200010
                   MOVE 'C200-OPEN-PR-BOGO-CSR'                         07210010
                                                 TO PV-PARAGRAPH-NAME   07220010
                   DISPLAY PV-PARAGRAPH-NAME                            07230010
                   PERFORM Z100-ABEND                                   07240010
           END-EVALUATE.                                                07250010
                                                                        07260010
      ***********************************************************       07270010
      * C300-FETCH-PR-BOGO-CSR.                                         07280010
      ***********************************************************       07290010
       C300-FETCH-PR-BOGO-CSR.                                          07300010
                                                                        07310010
           EXEC SQL                                                     07320010
               FETCH BOGOCSR                                            07330010
                 INTO :PV-AD-EVNT-NBR-TXT                               07340010
                     ,:PV-AD-EVNT-NM                                    07350010
                     ,:PV-MAIN-PROMO-ID                                 07360010
                     ,:PV-MAIN-PROMO-NM                                 07370010
                     ,:PV-NON-MAIN-PROMO-ID                             07380010
                     ,:PV-NON-MAIN-PROMO-NM                             07390010
                     ,:PV-MDSE-SELN-LNE-ID                              07400010
                     ,:PV-MAIN-PROMO-STRT-TMST                          07410010
                     ,:PV-NON-MAIN-PROMO-STRT-TMST                      07420010
                     ,:PV-MAIN-PROMO-END-TMST                           07430010
                     ,:PV-NON-MAIN-PROMO-END-TMST                       07440010
                     ,:PV-MAIN-PROMO-ITM-ID                             07450010
                     ,:PV-NON-MAIN-PROMO-ITM-ID                         07460010
                     ,:PV-DEPT-NBR                                      07470010
                     ,:PV-SUB-CL-NBR                                    07480010
                     ,:PV-SKU-NBR                                       07490010
                     ,:PV-MAIN-PRIC-PT-AMT                              07500010
                     ,:PV-NON-MAIN-PRIC-PT-AMT                          07510010
                     ,:PV-MAIN-PROMO-GP-QTY                             07520010
                     ,:PV-NON-MAIN-PROMO-GP-QTY                         07530010
                     ,:PV-MAIN-PROMO-GP-AMT                             07540010
                     ,:PV-NON-MAIN-PROMO-GP-AMT                         07550010
                     ,:PV-MAIN-PRICG-TYP-CDE                            07560010
                     ,:PV-NON-MAIN-PRICG-TYP-CDE                        07570010
                     ,:PV-LOC-NBR                                       07580010
                     ,:PV-MAIN-PROMO-ITM-DESC                           07590010
                     ,:PV-NON-MAIN-PROMO-ITM-DESC                       07600010
                     ,:PV-MAIN-ADV-IND                                  07610010
                     ,:PV-NON-MAIN-ADV-IND                              07620010
                     ,:PV-DEPT-NM                                       07630010
                     ,:PV-GMA-NBR                                       07640010
                     ,:PV-DMA-NBR                                       07650010
                     ,:PV-BYR-NBR                                       07660010
                     ,:PV-GMM-FRST-NM                                   07670010
                     ,:PV-GMM-LAST-NM                                   07680010
                     ,:PV-DMM-FRST-NM                                   07690010
                     ,:PV-DMM-LAST-NM                                   07700010
                     ,:PV-BYR-FRST-NM                                   07710010
                     ,:PV-BYR-LAST-NM                                   07720010
C08622               ,:PV-SKU-DESC                                      07721038
           END-EXEC.                                                    07730010
                                                                        07740010
           EVALUATE TRUE                                                07750010
               WHEN SQLCODE = ZERO                                      07760010
               WHEN SQLCODE = -1405                                     07770010
                  CONTINUE                                              07780010
                                                                        07790010
               WHEN SQLCODE = 1403                                      07800010
                   MOVE PV-TEMP-VALUE TO PV-AD-EVNT-NM                  07810010
                   MOVE PV-TEMP-VALUE-2 TO PV-AD-EVNT-NBR-TXT           07820010
                   PERFORM H100-WRITE-PAGE-HEADER                       07830010
                   PERFORM W300-WRITE-LEGAL-LINE                        07840010
                                                                        07850010
                   IF PV-SKU-CNT > 0                                    07860010
                     PERFORM W400-WRITE-END-OF-RPT-LINE                 07870010
                     DISPLAY '*** END OF BOGO OVERLAPS TO RPT ***'      07880010
                   ELSE                                                 07890010
                     PERFORM W401-WRITE-NOTHING-TO-RPT-LINE             07900010
                     DISPLAY '***  NOTHING TO REPORT  ***'              07910010
                     DISPLAY '***  ADEVENT EXISTS ON  ***'              07920010
                     DISPLAY '***  TABLE BUT NO BOGO OVERLAP ***'       07930010
                   END-IF                                               07940010
                   SET PS-END-OF-PR-BOGO-CSR TO TRUE                    07950010
                                                                        07960010
               WHEN OTHER                                               07970010
                   MOVE 'C300-FETCH-PR-BOGO-CSR'                        07980010
                                           TO PV-PARAGRAPH-NAME         07990010
                   DISPLAY PV-PARAGRAPH-NAME                            08000010
                   PERFORM Z100-ABEND                                   08010010
           END-EVALUATE.                                                08020010
                                                                        08030010
      ***********************************************************       08040010
      * C400-PROCESS-PR-BOGO-CSR.                                       08050010
      ***********************************************************       08060010
       C400-PROCESS-PR-BOGO-CSR.                                        08070010
                                                                        08080010
           PERFORM D100-PROCESS-BREAKS.                                 08090010
                                                                        08100010
           IF PS-NOT-SKIP-RECORD                                        08110010
              PERFORM D200-PROCESS-DETAIL                               08120010
           END-IF.                                                      08130010
                                                                        08140010
           SET PS-NOT-SKIP-RECORD TO TRUE.                              08150010
           PERFORM C300-FETCH-PR-BOGO-CSR.                              08160010
                                                                        08170010
      ***********************************************************       08180010
      * C500-CLOSE-PR-BOGO-CSR.                                         08190010
      ***********************************************************       08200010
       C500-CLOSE-PR-BOGO-CSR.                                          08210010
                                                                        08220010
           EXEC SQL                                                     08230010
               CLOSE BOGOCSR                                            08240010
           END-EXEC.                                                    08250010
                                                                        08260010
           EVALUATE TRUE                                                08270010
               WHEN SQLCODE = ZERO                                      08280010
               WHEN SQLCODE = 1403                                      08290010
                   CONTINUE                                             08300010
               WHEN OTHER                                               08310010
                   MOVE 'C500-CLOSE-PR-BOGO-CSR'                        08320010
                                                TO PV-PARAGRAPH-NAME    08330010
                   DISPLAY PV-PARAGRAPH-NAME                            08340010
                   PERFORM Z100-ABEND                                   08350010
           END-EVALUATE.                                                08360010
                                                                        08370010
      ***************************************************************** 08380010
      * PROCESS BREAKS                                                  08390010
      * CHECK TO SEE IF PROCESSING NEW GMM, NEW DMM, NEW BUYER OR       08400010
      * NEW DEPT - WRITE OUT NEW PAGE HEADER IF ANY OF THESE ARE TRUE.  08410010
      *                                                                 08420010
      * IF NOT ON ANY OF THOSE NEW ITEMS - NEED TO SEE IF WE ARE        08430010
      * PROCESSING A RECORD FOR THE SAME SKU WITH THE SAME              08440010
      * NON MAIN MDSE SELN LINE ID AND SAME NON MAIN PRICE POINT -      08450010
      * IF THIS IS THE CASE WE WANT TO SKIP OVER THIS RECORD TO         08460010
      * ELIMINATE DUPLICATING THE INFORMATION FOR ALL LOCATIONS         08470010
      * THAT ARE SETUP FOR THIS SKU/MDSE SELN LINE ID /PRICE.           08480010
      ***************************************************************** 08490010
       D100-PROCESS-BREAKS.                                             08500010
                                                                        08510010
           IF (PV-GMA-NBR     NOT = PV-GMA-NBR-SAVED) OR                08520010
              (PV-DMA-NBR     NOT = PV-DMA-NBR-SAVED) OR                08530010
              (PV-BYR-NBR     NOT = PV-BYR-NBR-SAVED) OR                08540010
              (PV-DEPT-NBR    NOT = PV-DEPT-NBR-SAVED)                  08550010
                                                                        08560010
               IF PV-GMA-NBR-SAVED NOT = ZEROES                         08570010
                   PERFORM H010-WRITE-BLANK-PAGE-IF-NEED                08580010
               END-IF                                                   08590010
                                                                        08600010
              PERFORM H100-WRITE-PAGE-HEADER                            08610010
                                                                        08620010
           ELSE                                                         08630010
               IF (PV-SKU-NBR = PV-SKU-NBR-SAVED) AND                   08640010
                  (PV-SKU-NBR-SAVED NOT = 0) AND                        08650010
                  (PV-MDSE-SELN-LNE-ID = PV-MDSE-SELN-LNE-ID-S) AND     08660010
                  (PV-NON-MAIN-PRIC-PT-AMT = PV-NON-MAIN-PRIC-PT-AMT-S) 08670010
                  SET PS-SKIP-RECORD TO TRUE                            08680010
               END-IF                                                   08690010
                                                                        08700010
           END-IF.                                                      08710010
                                                                        08720010
           MOVE PV-AD-EVNT-NBR-TXT      TO PV-AD-EVNT-NBR-TXT-SV.       08730010
           MOVE PV-NON-MAIN-PROMO-ID    TO PV-NON-MAIN-PROMO-ID-SAVED.  08740010
           MOVE PV-GMA-NBR              TO PV-GMA-NBR-SAVED.            08750010
           MOVE PV-DMA-NBR              TO PV-DMA-NBR-SAVED.            08760010
           MOVE PV-BYR-NBR              TO PV-BYR-NBR-SAVED.            08770010
           MOVE PV-DEPT-NBR             TO PV-DEPT-NBR-SAVED.           08780010
           MOVE PV-SKU-NBR              TO PV-SKU-NBR-SAVED.            08790010
           MOVE PV-MDSE-SELN-LNE-ID     TO PV-MDSE-SELN-LNE-ID-S.       08800010
           MOVE PV-NON-MAIN-PRIC-PT-AMT TO PV-NON-MAIN-PRIC-PT-AMT-S.   08810010
           ADD +1 TO PV-SKU-CNT.                                        08820010
                                                                        08830010
                                                                        08840010
      ***************************************************************** 08850010
      * PROCESS DETAIL                                                  08860010
      ***************************************************************** 08870010
       D200-PROCESS-DETAIL.                                             08880010
                                                                        08890010
           MOVE '**'                 TO DTL-02-WINNER-IND.              08900010
           MOVE 'OVERLAP     '       TO DTL-02-WINNER-REASON.           08910010
           PERFORM D400-POPULATE-DETAIL1.                               08920010
           PERFORM D500-POPULATE-DETAIL2.                               08930010
C08622*    PERFORM D350-GET-SIGN-AND-DESC.                              08940038
                                                                        08950010
      *IF NOT THE SAME SKU, WRITE A BLANK DIVIDER LINE FIRST            08960010
           IF (PV-SKU-NBR NOT = PV-SKU-NBR-SAVED)                       08970010
               MOVE 'N'                  TO PS-SAME-SKU-SW              08980010
           ELSE                                                         08990010
               MOVE 'Y'                  TO PS-SAME-SKU-SW              09000010
           END-IF.                                                      09010010
                                                                        09020010
                                                                        09030010
           IF PS-NOT-SAME-SKU THEN                                      09040010
               PERFORM W700-WRITE-BLANK-LINE                            09050010
           END-IF.                                                      09060010
                                                                        09070010
C08622*    IF PM117-MAIN-INDEX GREATER ZERO                             09080040
C08622*      MOVE PC-ONE TO PV-MAIN-INDEX                               09090040
C08622*      PERFORM D355-FILL-IN-BOGO-SIGN-NBR                         09100040
C08622*           UNTIL PV-MAIN-INDEX > PM117-MAIN-INDEX                09110040
C08622*    ELSE                                                         09120040
C08622*      MOVE DETAIL-01            TO DETAIL-PRINT-01               09130040
C08622*      PERFORM W200-WRITE-RPT-DETAIL-LINE1                        09140040
C08622*    END-IF.                                                      09150040
C08622     MOVE DETAIL-01            TO DETAIL-PRINT-01.                09151040
C08622     PERFORM W200-WRITE-RPT-DETAIL-LINE1.                         09152040
                                                                        09160010
C08622*    IF PM117-NON-MAIN-INDEX GREATER ZERO                         09170040
C08622*      MOVE PC-ONE TO PV-NON-MAIN-INDEX                           09180040
C08622*      PERFORM D356-FILL-IN-NON-BOGO-SIGN-NBR                     09190040
C08622*           UNTIL PV-NON-MAIN-INDEX > PM117-NON-MAIN-INDEX        09200040
C08622*    ELSE                                                         09210040
C08622*      MOVE DETAIL-02                TO DETAIL-PRINT-02           09220040
C08622*      PERFORM W250-WRITE-RPT-DETAIL-LINE2                        09230040
C08622*    END-IF.                                                      09240040
C08622     MOVE DETAIL-02                TO DETAIL-PRINT-02.            09241040
C08622     PERFORM W250-WRITE-RPT-DETAIL-LINE2.                         09242040
                                                                        09250010
C08622***************************************************************** 09260040
C08622* GET SKU DESC AND SIGN NUMBERS USING PMKUT117 DB2 SUBROUTINE     09270040
C08622***************************************************************** 09280040
C08622*D350-GET-SIGN-AND-DESC.                                          09290040
C08622*                                                                 09300040
C08622*    INITIALIZE PM117-PARAMETERS.                                 09310040
C08622*    MOVE PV-SKU-NBR            TO PM117-SKU-NBR.                 09320040
C08622*    MOVE  SPACES               TO PM117-SKU-DESC.                09330040
C08622*    MOVE  ZEROES               TO PM117-UPC-ID.                  09340040
C08622*                                                                 09350040
C08622*    SET PM117-GET-DESC TO TRUE.                                  09360040
C08622*    CALL PC-PMKUT117-PGM USING PM117-PARAMETERS.                 09370040
C08622*                                                                 09380040
C08622*    IF PM117-UNSUCCESSFUL-CALL                                   09390040
C08622*       DISPLAY 'SKU NBR = ' PM117-SKU-NBR                        09400040
C08622*       DISPLAY 'UPC ID  = ' PM117-UPC-ID                         09410040
C08622*       MOVE PM117-ERROR-MESSAGE      TO PV-OPERATION-MSG-1       09420040
C08622*       MOVE PM117-SQLCODE            TO SQLCODE                  09430040
C08622*       MOVE 'TSIESGN XST_SKU'        TO PV-TABLE-NAME            09440040
C08622*       MOVE 'D350-GET-SIGN-AND-DESC' TO PV-PARAGRAPH-NAME        09450040
C08622*       PERFORM Z100-ABEND                                        09460040
C08622*    ELSE                                                         09470040
C08622*       MOVE PM117-SKU-DESC           TO DTL-01-SKU-DESC          09480040
C08622*    END-IF.                                                      09490040
C08622*    DISPLAY 'PM117-UPC-ID: ' PM117-UPC-ID.                       09500040
C08622*    DISPLAY 'PM117-SKU-DESC: ' PM117-SKU-DESC.                   09510040
C08622*                                                                 09520040
C08622*    IF PM117-UPC-ID NOT EQUAL 0                                  09530040
C08622*     SET PM117-GET-SIGNS TO TRUE                                 09540040
C08622*     MOVE PV-MAIN-PROMO-ID      TO PM117-MAIN-PROMO-ID           09550040
C08622*     MOVE PV-NON-MAIN-PROMO-ID  TO PM117-NON-MAIN-PROMO-ID       09560040
C08622*     INITIALIZE PM117-MAIN-SIGN-TABLE-PARMS                      09570040
C08622*     INITIALIZE PM117-NMAIN-SIGN-TABLE-PARMS                     09580040
C08622*     CALL PC-PMKUT117-PGM USING PM117-PARAMETERS                 09590040
C08622*                                                                 09600040
C08622*     IF PM117-UNSUCCESSFUL-CALL                                  09610040
C08622*        DISPLAY 'MAIN PROMO ID = ' PM117-MAIN-PROMO-ID           09620040
C08622*        DISPLAY 'NONMAIN PROMO ID = ' PM117-NON-MAIN-PROMO-ID    09630040
C08622*        MOVE PM117-ERROR-MESSAGE      TO PV-OPERATION-MSG-1      09640040
C08622*        MOVE PM117-SQLCODE            TO SQLCODE                 09650040
C08622*        MOVE 'TSIESGN XST_SKU'        TO PV-TABLE-NAME           09660040
C08622*        MOVE 'D350-GET-SIGN-AND-DESC' TO PV-PARAGRAPH-NAME       09670040
C08622*        PERFORM Z100-ABEND                                       09680040
C08622*     END-IF                                                      09690040
C08622*    END-IF.                                                      09700040
C08622***************************************************************** 09710040
C08622* FILLS IN SIGN NUMBER FROM ARRAY PASSED BACK FROM SUBROUTINE     09720040
C08622* PMKUT117 FOR DETAIL-1                                           09730040
C08622***************************************************************** 09740040
C08622*D355-FILL-IN-BOGO-SIGN-NBR.                                      09750040
C08622*                                                                 09760040
C08622*    MOVE PM117-MAIN-SIGN-NBR(PV-MAIN-INDEX) TO DTL-01-SIGN-NBR.  09770038
C08622*    MOVE DETAIL-01            TO DETAIL-PRINT-01.                09780040
C08622*    PERFORM W200-WRITE-RPT-DETAIL-LINE1.                         09790040
C08622*    ADD PC-ONE TO PV-MAIN-INDEX.                                 09800040
C08622*                                                                 09810040
C08622***************************************************************** 09820040
C08622* FILLS IN SIGN NUMBER FROM ARRAY PASSED BACK FROM SUBROUTINE     09830040
C08622* PMKUT117 FOR DETAIL-2 - NON BOGO                                09840040
C08622***************************************************************** 09850040
C08622*D356-FILL-IN-NON-BOGO-SIGN-NBR.                                  09860040
C08622*    MOVE PM117-NON-MAIN-SIGN-NBR(PV-NON-MAIN-INDEX)              09870038
C08622*                                            TO DTL-02-SIGN-NBR.  09880038
C08622*    MOVE DETAIL-02                TO DETAIL-PRINT-02.            09890040
C08622*    PERFORM W250-WRITE-RPT-DETAIL-LINE2.                         09900040
C08622*    ADD PC-ONE TO PV-NON-MAIN-INDEX.                             09910040
C08622*                                                                 09920040
      ***************************************************************** 09930010
      * POPULATES THE FIRST DETAIL LINE (MAIN PROMO)                    09940010
      ***************************************************************** 09950010
       D400-POPULATE-DETAIL1.                                           09960010
                                                                        09970010
           MOVE PV-DEPT-NBR              TO DTL-01-DEPT-NBR.            09980010
           MOVE PV-SUB-CL-NBR            TO DTL-01-SUB-CL-NBR.          09990010
           MOVE PV-SKU-NBR               TO DTL-01-SKU-NBR.             10000010
C08622     MOVE PV-SKU-DESC              TO DTL-01-SKU-DESC.            10001038
                                                                        10010010
           MOVE PV-MAIN-PROMO-NM         TO DTL-01-PROMO-NAME-1.        10020010
           MOVE PV-MAIN-PROMO-STRT-TMST  TO DTL-01-PROMO-BEG-DTE-1.     10030010
           MOVE PV-MAIN-PROMO-END-TMST   TO DTL-01-PROMO-END-DTE-1.     10040010
           MOVE PV-MAIN-PROMO-ITM-DESC   TO DTL-01-PROMO-ITM-DESC-1.    10050010
           IF PV-MAIN-ADV-IND = 'Y'                                     10060011
               MOVE 'A' TO DTL-01-ADV-IND-1                             10070012
           ELSE                                                         10080011
               MOVE 'U' TO DTL-01-ADV-IND-1                             10090012
           END-IF.                                                      10100011
                                                                        10110010
           MOVE PV-MAIN-PRIC-PT-AMT      TO DTL-01-PROMO-PRICE-1.       10120010
                                                                        10130010
C08622*    MOVE ZEROES TO DTL-01-SIGN-NBR.                              10140038
                                                                        10150010
           IF PV-MAIN-PROMO-GP-QTY > 0                                  10160010
               MOVE '/' TO  DTL-01-SLASH-1                              10170010
               MOVE PV-MAIN-PROMO-GP-QTY     TO DTL-01-PROMO-GRP-QTY-1  10180010
               MOVE PV-MAIN-PROMO-GP-AMT     TO DTL-01-PROMO-GRP-AMT-1  10190010
           ELSE                                                         10200010
               MOVE SPACE  TO DTL-01-SLASH-1                            10210010
               MOVE 0      TO DTL-01-PROMO-GRP-QTY-1                    10220010
               MOVE 0      TO DTL-01-PROMO-GRP-AMT-1                    10230010
           END-IF.                                                      10240010
                                                                        10250010
           IF PV-MAIN-PRICG-TYP-CDE = 'SPO' OR 'GPO' OR 'GBP'           10260010
               MOVE '%'    TO DTL-01-PC-PP-IND                          10270010
           ELSE                                                         10280010
               MOVE 'PP'   TO DTL-01-PC-PP-IND                          10290010
           END-IF.                                                      10300010
                                                                        10310010
      ***************************************************************** 10320010
      * POPULATES THE SECOND DETAIL LINE (ALL OTHER PROMOS)             10330010
      ***************************************************************** 10340010
       D500-POPULATE-DETAIL2.                                           10350010
                                                                        10360010
           MOVE PV-NON-MAIN-PROMO-NM        TO DTL-02-PROMO-NAME-2.     10370010
           MOVE PV-NON-MAIN-PROMO-STRT-TMST TO DTL-02-PROMO-BEG-DTE-2.  10380010
           MOVE PV-NON-MAIN-PROMO-END-TMST  TO DTL-02-PROMO-END-DTE-2.  10390010
           MOVE PV-NON-MAIN-PROMO-ITM-DESC  TO DTL-02-PROMO-ITM-DESC-2. 10400010
           IF PV-NON-MAIN-ADV-IND = 'Y'                                 10410012
               MOVE 'A' TO DTL-02-ADV-IND-2                             10420012
           ELSE                                                         10430011
               MOVE 'U' TO DTL-02-ADV-IND-2                             10440012
           END-IF.                                                      10450011
                                                                        10460010
           MOVE PV-NON-MAIN-PRIC-PT-AMT  TO DTL-02-PROMO-PRICE-2.       10470010
                                                                        10480010
C08622*    MOVE ZEROES TO DTL-02-SIGN-NBR.                              10490038
                                                                        10500010
           IF PV-NON-MAIN-PROMO-GP-QTY > 0                              10510010
               MOVE '/' TO  DTL-02-SLASH-2                              10520010
               MOVE PV-NON-MAIN-PROMO-GP-QTY  TO DTL-02-PROMO-GRP-QTY-2 10530010
               MOVE PV-NON-MAIN-PROMO-GP-AMT  TO DTL-02-PROMO-GRP-AMT-2 10540010
           ELSE                                                         10550010
               MOVE SPACE  TO DTL-02-SLASH-2                            10560010
               MOVE 0      TO DTL-02-PROMO-GRP-QTY-2                    10570010
               MOVE 0      TO DTL-02-PROMO-GRP-AMT-2                    10580010
           END-IF.                                                      10590010
                                                                        10600010
           IF PV-NON-MAIN-PRICG-TYP-CDE = 'SPO' OR 'GPO' OR 'GBP'       10610010
               MOVE '%'    TO DTL-02-PC-PP-IND                          10620010
           ELSE                                                         10630010
               MOVE 'PP'   TO DTL-02-PC-PP-IND                          10640010
           END-IF.                                                      10650010
                                                                        10660010
C08622****************************************************************  10660138
C08622* F000-PROCESS-MAIN-PROMO-OVRLP                                   10660338
C08622*                                                                 10660438
C08622****************************************************************  10660538
C08622 F000-PROCESS-MAIN-PROMO-OVRLP.                                   10660638
C08622                                                                  10660738
C08622     IF PS-ADEVNT-AVAIL                                           10663338
C08622       PERFORM F100-DECLARE-PR-BOGO-CSR                           10663438
C08622       PERFORM F200-OPEN-PR-BOGO-CSR                              10663538
C08622       PERFORM F300-FETCH-PR-BOGO-CSR                             10663638
C08622                                                                  10663738
C08622       IF NOT PS-END-OF-PR-BOGO-CSR2                              10663838
C08622          PERFORM F400-PROCESS-PR-BOGO-CSR                        10663938
C08622                 UNTIL PS-END-OF-PR-BOGO-CSR2                     10664038
C08622       END-IF                                                     10664138
C08622                                                                  10664238
C08622       PERFORM F500-CLOSE-PR-BOGO-CSR                             10664338
C08622     END-IF.                                                      10664438
C08622                                                                  10664638
C08622***********************************************************       10664738
C08622* F100-DECLARE-PR-BOGO-CSR.                                       10664938
C08622***********************************************************       10665038
C08622 F100-DECLARE-PR-BOGO-CSR.                                        10665138
C08622                                                                  10665238
C08622     EXEC SQL                                                     10666038
C08622          DECLARE BOGOCSR2 CURSOR FOR                             10667038
C08622          SELECT                                                  10668038
C08622                C.AD_EVNT_NBR_TXT,                                10669038
C08622                C.AD_EVNT_NM,                                     10669138
C08622                A.PROMO_ID,                                       10669238
C08622                C.PROMO_NM,                                       10669338
C08622                A2.PROMO_ID,                                      10669438
C08622                C2.PROMO_NM,                                      10669538
C08622                A2.MDSE_SELN_LNE_ID,                              10669638
C08622                A.PROMO_STRT_TMST,                                10669738
C08622                A2.PROMO_STRT_TMST,                               10669838
C08622                A.PROMO_END_TMST,                                 10669938
C08622                A2.PROMO_END_TMST,                                10670038
C08622                A.PROMO_ITM_ID,                                   10670138
C08622                A2.PROMO_ITM_ID,                                  10670238
C08622                A.DEPT_NBR,                                       10670338
C08622                A.SUB_CL_NBR,                                     10670438
C08622                A.SKU_NBR,                                        10670538
C08622                A.PROMO_PRIC_PT_AMT,                              10670638
C08622                A2.PROMO_PRIC_PT_AMT,                             10670738
C08622                A.PROMO_GP_QTY,                                   10670838
C08622                A2.PROMO_GP_QTY,                                  10670938
C08622                A.PROMO_GP_AMT,                                   10671038
C08622                A2.PROMO_GP_AMT,                                  10671138
C08622                A.PROMO_PRICG_TYP_CDE,                            10671238
C08622                A2.PROMO_PRICG_TYP_CDE,                           10671338
C08622                A.LOC_NBR,                                        10671438
C08622                B.PROMO_ITM_DESC,                                 10671538
C08622                B2.PROMO_ITM_DESC,                                10671638
C08622                B.ADV_IND,                                        10671738
C08622                B2.ADV_IND,                                       10671838
C08622                D.DEPT_NM,                                        10671938
C08622                D.GMA_NBR,                                        10672038
C08622                D.DMA_NBR,                                        10672138
C08622                D.BYR_NBR,                                        10672238
C08622                D.GMM_FRST_NM,                                    10672338
C08622                D.GMM_LAST_NM,                                    10672438
C08622                D.DMM_FRST_NM,                                    10672538
C08622                D.DMM_LAST_NM,                                    10672638
C08622                D.BYR_FRST_NM,                                    10672738
C08622                D.BYR_LAST_NM,                                    10672838
C08622                E.SKU_DESC                                        10672938
C08622           FROM PMT_SKU_LVL_PRICG_BY_LOC A,                       10673038
C08622                PMT_SKU_LVL_PRICG_BY_LOC A2,                      10673138
C08622                PMT_PROMO_ITM B,                                  10673238
C08622                PMT_PROMO_ITM B2,                                 10673338
C08622                PMV_PROMO_DIM C,                                  10673438
C08622                PMV_PROMO_DIM C2,                                 10673538
C08622                PMV_PRSN_MDSE_HIER D,                             10673738
C08622                XKT_SKU E                                         10673838
C08622          WHERE C.PROMO_STAT_CDE    = 'S'                         10673938
C08622            AND A.PROMO_ID          = :PV-PROMO-ID                10674038
C08622            AND (A2.PROMO_ID        = :PV-PROMO-ID AND            10674238
C08622                 A.PROMO_ITM_ID    <> A2.PROMO_ITM_ID)            10674438
C08622            AND A2.AD_EVNT_ID       = A.AD_EVNT_ID                10674538
C08622            AND A.PROMO_STRT_TMST  <=                             10674638
C08622                A2.PROMO_END_TMST                                 10674738
C08622            AND A.PROMO_END_TMST   >=                             10674838
C08622                A2.PROMO_STRT_TMST                                10674938
C08622            AND A.SKU_NBR           = A2.SKU_NBR                  10675038
C08622            AND A.SKU_NBR           = E.SKU_NBR                   10675138
C08622            AND A.LOC_NBR           = A2.LOC_NBR                  10675238
C08622            AND A.LOC_NBR                                         10675338
C08622              NOT IN ( SELECT LOC_NBR                             10675438
C08622                         FROM XKT_LOC                             10675538
C08622                        WHERE E_BUS_IND = 'Y'                     10675638
C08622                          AND LOC_NBR IN ( :PV-HOST-STR-1         10675738
C08622                                          ,:PV-HOST-STR-2         10675838
C08622                                          ,:PV-HOST-STR-3         10675938
C08622                                          ,:PV-HOST-STR-4         10676038
C08622                                          ,:PV-HOST-STR-5         10676138
C08622                                          ,:PV-HOST-STR-6         10676238
C08622                                          ,:PV-HOST-STR-7         10676338
C08622                                          ,:PV-HOST-STR-8         10676438
C08622                                          ,:PV-HOST-STR-9         10676538
C08622                                          ,:PV-HOST-STR-10        10676638
C08622                                          ,:PV-HOST-STR-11        10676738
C08622                                          ,:PV-HOST-STR-12        10676838
C08622                                          ,:PV-HOST-STR-13        10676938
C08622                                          ,:PV-HOST-STR-14        10677038
C08622                                          ,:PV-HOST-STR-15        10677138
C08622                                          )                       10677238
C08622                      )                                           10677338
C08622            AND A.DEPT_NBR          = A2.DEPT_NBR                 10677438
C08622            AND A.PROMO_ID          = C.PROMO_ID                  10677538
C08622            AND A2.PROMO_ID         = C2.PROMO_ID                 10677638
C08622            AND A.AD_EVNT_ID        = C.AD_EVNT_ID                10677738
C08622            AND A2.AD_EVNT_ID        = C2.AD_EVNT_ID              10677838
C08622            AND A.PROMO_ITM_ID      = B.PROMO_ITM_ID              10677938
C08622            AND A2.PROMO_ITM_ID     = B2.PROMO_ITM_ID             10678038
C08622            AND A.DEPT_NBR            = D.DEPT_NBR                10678138
C08622            AND A2.DEPT_NBR           = D.DEPT_NBR                10678238
C16571*           AND A.PROMO_PRICG_TYP_CDE  IN ('GBL', 'GBD', 'GBP')   10678346
C16571*           AND A2.PROMO_PRICG_TYP_CDE  IN ('GBL', 'GBD', 'GBP')  10678546
C16858            AND ((A.PROMO_PRICG_TYP_CDE  IN ('GBL', 'GBD', 'GBP') 10678648
C16858             AND A2.PROMO_PRICG_TYP_CDE  IN ('GBL', 'GBD', 'GBP'))10678748
C16858             OR (A.PROMO_PRICG_TYP_CDE  IN ('GBL', 'GBD', 'GBP')  10678848
C16858             AND A2.PROMO_PRICG_TYP_CDE  IN ('SPO', 'SPP'))       10678948
C16858             OR (A.PROMO_PRICG_TYP_CDE  IN ('SPO', 'SPP')         10679048
C16858             AND A2.PROMO_PRICG_TYP_CDE IN ('GBL', 'GBD', 'GBP')))10679148
C08622          ORDER BY D.GMA_NBR,                                     10679238
C08622                   D.DMA_NBR,                                     10679338
C08622                   D.BYR_NBR,                                     10679438
C08622                   A.DEPT_NBR,                                    10679538
C08622                   A.SKU_NBR,                                     10679638
C08622                   A2.MDSE_SELN_LNE_ID                            10679738
C08622     END-EXEC.                                                    10679838
C08622                                                                  10679938
C08622***********************************************************       10680038
C08622* F200-OPEN-PR-BOGO-CSR.                                          10680138
C08622***********************************************************       10680238
C08622 F200-OPEN-PR-BOGO-CSR.                                           10680338
C08622     ACCEPT PV-CPU-TIME FROM TIME.                                10680438
C08622     DISPLAY ' '.                                                 10680538
C08622     DISPLAY 'START PR CONF CSR2 OPEN: ' PV-CPU-TIME.             10680638
C08622     SET PS-NOT-END-OF-PR-BOGO-CSR2 TO TRUE.                      10680743
C08622                                                                  10680838
C08622     EXEC SQL                                                     10680938
C08622         OPEN BOGOCSR2                                            10681038
C08622     END-EXEC.                                                    10681138
C08622                                                                  10681238
C08622     EVALUATE TRUE                                                10681338
C08622         WHEN SQLCODE = ZERO                                      10681438
C08622         WHEN SQLCODE = 1403                                      10681538
C08622             CONTINUE                                             10681638
C08622         WHEN SQLCODE = 8103                                      10681738
C08622             DISPLAY '*** NO PR-BOGO TO REPORT ***'               10681838
C08622             MOVE PV-TEMP-VALUE TO PV-AD-EVNT-NM                  10681938
C08622             MOVE PV-TEMP-VALUE-2 TO PV-AD-EVNT-NBR-TXT           10682038
C08622             DISPLAY 'F200-OPEN-PR-BOGO-CSR'                      10682138
C08622             PERFORM H100-WRITE-PAGE-HEADER                       10682238
C08622             PERFORM W300-WRITE-LEGAL-LINE                        10682338
C08622             PERFORM W401-WRITE-NOTHING-TO-RPT-LINE               10682438
C08622             SET PS-END-OF-PR-BOGO-CSR2 TO TRUE                   10682538
C08622         WHEN OTHER                                               10682638
C08622             MOVE 'F200-OPEN-PR-BOGO-CSR'                         10682738
C08622                                           TO PV-PARAGRAPH-NAME   10682838
C08622             DISPLAY PV-PARAGRAPH-NAME                            10682938
C08622             PERFORM Z100-ABEND                                   10683038
C08622     END-EVALUATE.                                                10683138
C08622                                                                  10683238
C08622***********************************************************       10683338
C08622* F300-FETCH-PR-BOGO-CSR.                                         10683438
C08622***********************************************************       10683538
C08622 F300-FETCH-PR-BOGO-CSR.                                          10683638
C08622                                                                  10683738
C08622     EXEC SQL                                                     10683838
C08622         FETCH BOGOCSR2                                           10683938
C08622           INTO :PV-AD-EVNT-NBR-TXT                               10684038
C08622               ,:PV-AD-EVNT-NM                                    10684138
C08622               ,:PV-MAIN-PROMO-ID                                 10684238
C08622               ,:PV-MAIN-PROMO-NM                                 10684338
C08622               ,:PV-NON-MAIN-PROMO-ID                             10684438
C08622               ,:PV-NON-MAIN-PROMO-NM                             10684538
C08622               ,:PV-MDSE-SELN-LNE-ID                              10684638
C08622               ,:PV-MAIN-PROMO-STRT-TMST                          10684738
C08622               ,:PV-NON-MAIN-PROMO-STRT-TMST                      10684838
C08622               ,:PV-MAIN-PROMO-END-TMST                           10684938
C08622               ,:PV-NON-MAIN-PROMO-END-TMST                       10685038
C08622               ,:PV-MAIN-PROMO-ITM-ID                             10685138
C08622               ,:PV-NON-MAIN-PROMO-ITM-ID                         10685238
C08622               ,:PV-DEPT-NBR                                      10685338
C08622               ,:PV-SUB-CL-NBR                                    10685438
C08622               ,:PV-SKU-NBR                                       10685538
C08622               ,:PV-MAIN-PRIC-PT-AMT                              10685638
C08622               ,:PV-NON-MAIN-PRIC-PT-AMT                          10685738
C08622               ,:PV-MAIN-PROMO-GP-QTY                             10685838
C08622               ,:PV-NON-MAIN-PROMO-GP-QTY                         10685938
C08622               ,:PV-MAIN-PROMO-GP-AMT                             10686038
C08622               ,:PV-NON-MAIN-PROMO-GP-AMT                         10686138
C08622               ,:PV-MAIN-PRICG-TYP-CDE                            10686238
C08622               ,:PV-NON-MAIN-PRICG-TYP-CDE                        10686338
C08622               ,:PV-LOC-NBR                                       10686438
C08622               ,:PV-MAIN-PROMO-ITM-DESC                           10686538
C08622               ,:PV-NON-MAIN-PROMO-ITM-DESC                       10686638
C08622               ,:PV-MAIN-ADV-IND                                  10686738
C08622               ,:PV-NON-MAIN-ADV-IND                              10686838
C08622               ,:PV-DEPT-NM                                       10686938
C08622               ,:PV-GMA-NBR                                       10687038
C08622               ,:PV-DMA-NBR                                       10687138
C08622               ,:PV-BYR-NBR                                       10687238
C08622               ,:PV-GMM-FRST-NM                                   10687338
C08622               ,:PV-GMM-LAST-NM                                   10687438
C08622               ,:PV-DMM-FRST-NM                                   10687538
C08622               ,:PV-DMM-LAST-NM                                   10687638
C08622               ,:PV-BYR-FRST-NM                                   10687738
C08622               ,:PV-BYR-LAST-NM                                   10687838
C08622               ,:PV-SKU-DESC                                      10687938
C08622     END-EXEC.                                                    10688038
C08622                                                                  10688138
C08622     EVALUATE TRUE                                                10688238
C08622         WHEN SQLCODE = ZERO                                      10688338
C08622         WHEN SQLCODE = -1405                                     10688438
C08622            CONTINUE                                              10688538
C08622                                                                  10688638
C08622         WHEN SQLCODE = 1403                                      10688738
C08622             MOVE PV-TEMP-VALUE TO PV-AD-EVNT-NM                  10688838
C08622             MOVE PV-TEMP-VALUE-2 TO PV-AD-EVNT-NBR-TXT           10688938
C08622             PERFORM H100-WRITE-PAGE-HEADER                       10689038
C08622             PERFORM W300-WRITE-LEGAL-LINE                        10689138
C08622                                                                  10689238
C08622             IF PV-SKU-CNT > 0                                    10689338
C08622               PERFORM W400-WRITE-END-OF-RPT-LINE                 10689438
C08622               DISPLAY '*** END OF BOGO OVERLAPS TO RPT ***'      10689538
C08622             ELSE                                                 10689638
C08622               PERFORM W401-WRITE-NOTHING-TO-RPT-LINE             10689738
C08622               DISPLAY '***  NOTHING TO REPORT  ***'              10689838
C08622               DISPLAY '***  ADEVENT EXISTS ON  ***'              10689938
C08622               DISPLAY '***  TABLE BUT NO BOGO OVERLAP ***'       10690038
C08622             END-IF                                               10690138
C08622             SET PS-END-OF-PR-BOGO-CSR2 TO TRUE                   10690238
C08622                                                                  10690338
C08622         WHEN OTHER                                               10690438
C08622             MOVE 'F300-FETCH-PR-BOGO-CSR'                        10690538
C08622                                     TO PV-PARAGRAPH-NAME         10690638
C08622             DISPLAY PV-PARAGRAPH-NAME                            10690738
C08622             PERFORM Z100-ABEND                                   10690838
C08622     END-EVALUATE.                                                10690938
C08622                                                                  10691038
C08622***********************************************************       10691138
C08622* F400-PROCESS-PR-BOGO-CSR.                                       10691238
C08622***********************************************************       10691338
C08622 F400-PROCESS-PR-BOGO-CSR.                                        10691438
C08622                                                                  10691538
C08622     PERFORM D100-PROCESS-BREAKS.                                 10691638
C08622                                                                  10691738
C08622     IF PS-NOT-SKIP-RECORD                                        10691838
C08622        PERFORM D200-PROCESS-DETAIL                               10691938
C08622     END-IF.                                                      10692038
C08622                                                                  10692138
C08622     SET PS-NOT-SKIP-RECORD TO TRUE.                              10692238
C08622     PERFORM F300-FETCH-PR-BOGO-CSR.                              10692338
C08622                                                                  10692438
C08622***********************************************************       10692538
C08622* F500-CLOSE-PR-BOGO-CSR.                                         10692638
C08622***********************************************************       10692738
C08622 F500-CLOSE-PR-BOGO-CSR.                                          10692838
C08622                                                                  10692938
C08622     EXEC SQL                                                     10693038
C08622         CLOSE BOGOCSR2                                           10693138
C08622     END-EXEC.                                                    10693238
C08622                                                                  10693338
C08622     EVALUATE TRUE                                                10693438
C08622         WHEN SQLCODE = ZERO                                      10693538
C08622         WHEN SQLCODE = 1403                                      10693638
C08622             CONTINUE                                             10693738
C08622         WHEN OTHER                                               10693838
C08622             MOVE 'F500-CLOSE-PR-BOGO-CSR'                        10693938
C08622                                          TO PV-PARAGRAPH-NAME    10694038
C08622             DISPLAY PV-PARAGRAPH-NAME                            10694138
C08622             PERFORM Z100-ABEND                                   10694238
C08622     END-EVALUATE.                                                10694338
C08622                                                                  10695038
      ***************************************************************** 10698610
      *   WRITES A BLANK PAGE SO NEW BUYER STARTS ON NEW SHEET.         10698710
      ***************************************************************** 10699010
       H010-WRITE-BLANK-PAGE-IF-NEED.                                   10700010
                                                                        10710010
           DIVIDE PV-PAGE-CNT BY 2                                      10720010
               GIVING PV-PAGE-DIV                                       10730010
               REMAINDER PV-PAGE-REM.                                   10740010
                                                                        10750010
           IF PV-PAGE-REM > 0                                           10760010
                PERFORM H030-WRITE-ONE-BLANK-PAGE                       10770010
           END-IF.                                                      10780010
                                                                        10790010
      ***************************************************************** 10800010
      *   WRITES THE HEADER LINES TO THE REPORT.                        10810010
      ***************************************************************** 10820010
       H030-WRITE-ONE-BLANK-PAGE.                                       10830010
                                                                        10840010
           IF  PV-PAGE-CNT >= 1                                         10850010
              PERFORM W300-WRITE-LEGAL-LINE                             10860010
           END-IF.                                                      10870010
                                                                        10880010
           ADD 1                         TO PV-PAGE-CNT.                10890010
           MOVE PV-PAGE-CNT              TO DP150O-PAGE-NUMBER.         10900010
                                                                        10910010
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       10920010
           MOVE DP150O-STANDRD-HEADER-150-COLS TO PR-BOGO-RPT-LINE.     10930010
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             10940010
                                                                        10950010
           MOVE HEADER-01                TO PR-BOGO-RPT-LINE.           10960010
           MOVE 2                        TO PV-ADVANCE-LINES.           10970010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          10980010
                                                                        10990010
           MOVE HEADER-02                TO PR-BOGO-RPT-LINE.           11000010
           MOVE 2                        TO PV-ADVANCE-LINES.           11010010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11020010
                                                                        11030010
                                                                        11040010
           PERFORM W700-WRITE-BLANK-LINE.                               11050010
                                                                        11060010
           MOVE HEADER-GMM               TO PR-BOGO-RPT-LINE.           11070010
           MOVE 1                        TO PV-ADVANCE-LINES.           11080010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11090010
                                                                        11100010
           MOVE HEADER-DMM               TO PR-BOGO-RPT-LINE.           11110010
           MOVE 1                        TO PV-ADVANCE-LINES.           11120010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11130010
                                                                        11140010
           MOVE HEADER-BUYER             TO PR-BOGO-RPT-LINE.           11150010
           MOVE 1                        TO PV-ADVANCE-LINES.           11160010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11170010
                                                                        11180010
           MOVE HEADER-DEPT              TO PR-BOGO-RPT-LINE.           11190010
           MOVE 1                        TO PV-ADVANCE-LINES.           11200010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11210010
                                                                        11220010
           MOVE BLANK-PAGE-NOTE          TO PR-BOGO-RPT-LINE.           11230010
           MOVE 10                       TO PV-ADVANCE-LINES.           11240010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11250010
                                                                        11260010
      ***************************************************************** 11270010
      *   WRITES THE HEADER LINES TO THE REPORT.                        11280010
      ***************************************************************** 11290010
       H100-WRITE-PAGE-HEADER.                                          11300010
                                                                        11310010
           IF  PV-PAGE-CNT >= 1                                         11320010
              PERFORM W300-WRITE-LEGAL-LINE                             11330010
           END-IF.                                                      11340010
                                                                        11350010
           ADD 1                         TO PV-PAGE-CNT.                11360010
           MOVE PV-PAGE-CNT              TO DP150O-PAGE-NUMBER.         11370010
                                                                        11380010
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       11390010
           MOVE DP150O-STANDRD-HEADER-150-COLS TO PR-BOGO-RPT-LINE.     11400010
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             11410010
                                                                        11420010
           MOVE PC-HDR1-TITLE1           TO HDR-01-TITLE.               11430010
           MOVE HEADER-01                TO PR-BOGO-RPT-LINE.           11440010
           MOVE 2                        TO PV-ADVANCE-LINES.           11450010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11460010
      ***** CHANGE TO PROMO NAME                                        11470010
      **   MOVE  'AD EVENT '             TO HDR-02-TITLE-1.             11480010
           MOVE   PV-AD-EVNT-NBR-TXT     TO HDR-02-TITLE-1.             11490010
           MOVE   PV-AD-EVNT-NM          TO HDR-02-TITLE-2.             11500010
           MOVE   PV-MAIN-PROMO-NM       TO HDR-02-TITLE-3.             11510010
           MOVE HEADER-02                TO PR-BOGO-RPT-LINE.           11520010
           MOVE 2                        TO PV-ADVANCE-LINES.           11530010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11540010
                                                                        11550010
                                                                        11560010
           MOVE SPACES TO HDR-04-TITLE.                                 11570010
           IF PV-REPORT-TYPE = '01'                                     11580010
              MOVE PC-HDR1-TITLE4-01 TO HDR-04-TITLE                    11590010
           END-IF.                                                      11600010
                                                                        11610010
           IF PV-REPORT-TYPE = '02'                                     11620010
              MOVE PC-HDR1-TITLE4-02 TO HDR-04-TITLE                    11630010
           END-IF.                                                      11640010
                                                                        11650010
           IF PV-REPORT-TYPE = '03'                                     11660010
              MOVE PC-HDR1-TITLE4-03 TO HDR-04-TITLE                    11670010
           END-IF.                                                      11680010
                                                                        11690010
           IF PV-REPORT-TYPE = '04'                                     11700010
              MOVE PC-HDR1-TITLE4-04 TO HDR-04-TITLE                    11710010
           END-IF.                                                      11720010
                                                                        11730010
C09985     IF PV-REPORT-TYPE = '05'                                     11731042
C09985        MOVE PC-HDR1-TITLE4-05 TO HDR-04-TITLE                    11732042
C09985     END-IF.                                                      11733042
C09985                                                                  11734042
           MOVE HEADER-04                TO PR-BOGO-RPT-LINE.           11740010
           MOVE 2                        TO PV-ADVANCE-LINES.           11750010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11760010
                                                                        11770010
           PERFORM W700-WRITE-BLANK-LINE.                               11780010
                                                                        11790010
           MOVE PV-GMA-NBR               TO HDR-GMM-NBR.                11800010
           MOVE SPACES                   TO HDR-GMM-NAME.               11810010
           STRING PV-GMM-FRST-NM DELIMITED BY SPACE                     11820010
                  ' '            DELIMITED BY SIZE                      11830010
                  PV-GMM-LAST-NM DELIMITED BY SPACE                     11840010
                                       INTO HDR-GMM-NAME.               11850010
           MOVE HEADER-GMM               TO PR-BOGO-RPT-LINE.           11860010
           MOVE 1                        TO PV-ADVANCE-LINES.           11870010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11880010
                                                                        11890010
           MOVE PV-DMA-NBR               TO HDR-DMM-NBR.                11900010
           MOVE SPACES                   TO HDR-DMM-NAME.               11910010
           STRING PV-DMM-FRST-NM DELIMITED BY SPACE                     11920010
                  ' '            DELIMITED BY SIZE                      11930010
                  PV-DMM-LAST-NM DELIMITED BY SPACE                     11940010
                                       INTO HDR-DMM-NAME.               11950010
           MOVE HEADER-DMM               TO PR-BOGO-RPT-LINE.           11960010
           MOVE 1                        TO PV-ADVANCE-LINES.           11970010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          11980010
                                                                        11990010
           MOVE PV-BYR-NBR               TO HDR-BYR-NBR.                12000010
           MOVE SPACES                   TO HDR-BYR-NAME.               12010010
           STRING PV-BYR-FRST-NM DELIMITED BY SPACE                     12020010
                  ' '            DELIMITED BY SIZE                      12030010
                  PV-BYR-LAST-NM DELIMITED BY SPACE                     12040010
                                       INTO HDR-BYR-NAME.               12050010
           MOVE HEADER-BUYER             TO PR-BOGO-RPT-LINE.           12060010
           MOVE 1                        TO PV-ADVANCE-LINES.           12070010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          12080010
                                                                        12090010
           MOVE PV-DEPT-NBR              TO HDR-DEPT-NBR.               12100010
           MOVE PV-DEPT-NM               TO HDR-DEPT-NAME.              12110010
           MOVE HEADER-DEPT              TO PR-BOGO-RPT-LINE.           12120010
           MOVE 1                        TO PV-ADVANCE-LINES.           12130010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          12140010
                                                                        12150010
           PERFORM W700-WRITE-BLANK-LINE.                               12160010
                                                                        12170010
           MOVE HEADER-05                TO PR-BOGO-RPT-LINE.           12180010
           MOVE 1                        TO PV-ADVANCE-LINES.           12190010
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          12200010
                                                                        12210010
           PERFORM W700-WRITE-BLANK-LINE.                               12220010
                                                                        12230010
      ***************************************************************** 12240010
      *     WRITE NEW PAGE                                              12250010
      ***************************************************************** 12260010
       W100-WRITE-RPT-NEW-PAGE.                                         12270010
                                                                        12280010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING PAGE.                 12290010
           MOVE 1                        TO PV-LINE-CNT.                12300010
                                                                        12310010
      ***************************************************************** 12320010
      *     WRITE HEADER LINE                                           12330010
      ***************************************************************** 12340010
       W150-WRITE-RPT-HEADER-LINE.                                      12350010
                                                                        12360010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING                       12370010
                                       PV-ADVANCE-LINES.                12380010
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                12390010
                                                                        12400010
      ***************************************************************** 12410010
      *     WRITE DETAIL LINE1                                          12420010
      ***************************************************************** 12430010
       W200-WRITE-RPT-DETAIL-LINE1.                                     12440010
                                                                        12450010
           IF PV-LINE-CNT >=  PC-MAX-LINES                              12460010
               PERFORM H100-WRITE-PAGE-HEADER                           12470010
           END-IF.                                                      12480010
                                                                        12490010
           MOVE 1                        TO PV-ADVANCE-LINES.           12500010
           MOVE DETAIL-PRINT-01          TO PR-BOGO-RPT-LINE.           12510010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING                       12520010
                                            PV-ADVANCE-LINES.           12530010
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                12540010
                                                                        12550010
           MOVE SPACES                   TO DETAIL-01.                  12560010
                                                                        12570010
      ***************************************************************** 12580010
      *     WRITE DETAIL LINE2                                          12590010
      ***************************************************************** 12600010
       W250-WRITE-RPT-DETAIL-LINE2.                                     12610010
                                                                        12620010
           IF PV-LINE-CNT >=  PC-MAX-LINES                              12630010
               PERFORM H100-WRITE-PAGE-HEADER                           12640010
           END-IF.                                                      12650010
                                                                        12660010
           MOVE 1                        TO PV-ADVANCE-LINES.           12670010
           MOVE DETAIL-PRINT-02          TO PR-BOGO-RPT-LINE.           12680010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING PV-ADVANCE-LINES.     12690010
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                12700010
                                                                        12710010
           MOVE SPACES                   TO DETAIL-02.                  12720010
                                                                        12730010
      ******************************************************************12740010
      *     WRITE LEGAL LINE VERBAGE PER KOHL'S LEGAL DEPT.            *12750010
      ******************************************************************12760010
       W300-WRITE-LEGAL-LINE.                                           12770010
                                                                        12780010
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       12790010
             GIVING PV-ADVANCE-CNT.                                     12800010
                                                                        12810010
           IF PV-ADVANCE-CNT < 1 THEN                                   12820010
               MOVE 2                  TO PV-ADVANCE-CNT                12830010
           ELSE                                                         12840010
               ADD 2                   TO PV-ADVANCE-CNT                12850010
           END-IF.                                                      12860010
                                                                        12870010
           MOVE LEGAL-LINE             TO PR-BOGO-RPT-LINE.             12880010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING PV-ADVANCE-CNT.       12890010
           ADD PV-ADVANCE-CNT          TO PV-LINE-CNT.                  12900010
                                                                        12910010
      ***************************************************************** 12920010
      *     WRITE END OF REPORT LINE                                    12930010
      ***************************************************************** 12940010
       W400-WRITE-END-OF-RPT-LINE.                                      12950010
                                                                        12960010
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       12970010
             GIVING PV-ADVANCE-CNT.                                     12980010
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           12990010
                                                                        13000010
           MOVE END-OF-REPORT-LINE       TO PR-BOGO-RPT-LINE.           13010010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING                       13020010
                                        PV-ADVANCE-LINES.               13030010
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                13040010
                                                                        13050010
      ***************************************************************** 13060010
      *     WRITE NOTHING TO REPORT LINE                                13070010
      ***************************************************************** 13080010
       W401-WRITE-NOTHING-TO-RPT-LINE.                                  13090010
                                                                        13100010
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       13110010
             GIVING PV-ADVANCE-CNT.                                     13120010
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           13130010
                                                                        13140010
           MOVE NOTHING-TO-REPORT-LINE   TO PR-BOGO-RPT-LINE.           13150010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING                       13160010
                                        PV-ADVANCE-LINES.               13170010
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                13180010
      ***************************************************************** 13190010
      *     WRITE BLANK LINE                                            13200010
      ***************************************************************** 13210010
       W700-WRITE-BLANK-LINE.                                           13220010
                                                                        13230010
           MOVE SPACES                   TO PR-BOGO-RPT-LINE.           13240010
           WRITE PR-BOGO-RPT-LINE AFTER ADVANCING 1.                    13250010
           ADD 1                         TO PV-LINE-CNT.                13260010
                                                                        13270010
      ******************************************************************13280010
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT     *13290010
      * LOGONS TO ORACLE.                                              *13300010
      ******************************************************************13310010
070941*    COPY PMPD700.                                                13320051
                                                                        13330010
      ***************************************************************** 13340010
      * Z100-ABEND.                                                   * 13350010
      *  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            * 13360010
      ***************************************************************** 13370010
       Z100-ABEND.                                                      13380010
                                                                        13390010
           DISPLAY '                       '.                           13400010
           DISPLAY '** ABEND **       ** = SQLERROR'.                   13410010
           DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.   13420010
           DISPLAY '** SQLCODE        ** = ' SQLCODE.                   13430010
           DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                13440010
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   13450010
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  13460010
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                13470010
           DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         13480010
           DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             13490010
           DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG-1.        13500010
           DISPLAY '                       '.                           13510010
                                                                        13520010
                                                                        13530010
           CALL 'ILBOABN0' USING ABEND-CODE.                            13540010
                                                                        13560020
W37986************************************************************      13570020
W37986* Z200-ABEND.                                                     13580020
W37986*     PERFORMS A NON-SQL-ABEND.                                   13590020
W37986************************************************************      13600020
W37986 Z200-ABEND.                                                      13610020
W37986                                                                  13620020
W37986     DISPLAY '** ABEND           **'.                             13630020
W37986     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  13640020
W37986     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        13650020
W37986     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       13660020
W37986     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       13670020
W37986                                                                  13680020
W37986     CALL 'ILBOABN0' USING ABEND-CODE.                            13690020
W37986                                                                  13700020
