000100***************************************************************** 00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300***************************************************************** 00030002
000400                                                                  00040002
000500 PROGRAM-ID.             SNKRP006.                                00050002
000600 AUTHOR.                 PAT LEE.                                 00060002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070002
000800 DATE-WRITTEN            06-11-92.                                00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100***************************************************************** 00110002
001200*     ASN/PO DETAIL REPORT FOR THE DC                           * 00120002
001300*                                                               * 00130002
001400*  THIS PROGRAM WILL PRINT A REPORT OF THE ASN DETAIL WHICH HAS * 00140002
001500*  BEEN TRANSMITTED FROM THE VENDORS SINCE THE LAST TIME THE    * 00150002
001600*  REPORTS WERE PRINTED.                                        * 00160002
001700*                                                               * 00170002
001800*  INITIALLY, SHIP NOTICE DETAIL WERE PRINTED IN ASCENDING      * 00180002
001900*  SEQUENCE BY SKU NUMBER.  THIS PROGRAM NOW IS DESIGNED        * 00190002
002000*  TO PRINT THE SHIP NOTICE DETAIL IN ASCENDING SEQUENCE        * 00200002
002100*  BY THE PURCHASE ORDER LINE NUMBER THE DETAIL HAS BEEN        * 00210002
002200*  ASSOCIATED TO AND ALSO LIST COST AND RETAIL INFORMATION      * 00220002
002300*  ASSOCIATED WITH THE PURCHASE ORDER LINE ITEM.                * 00230002
002400***************************************************************** 00240002
002500*  CHANGE MADE:                                                 * 00250002
002600*                                                               * 00260002
002700***************************************************************** 00270002
002800* CHANGED 07/21/92 BY PAT LEE                                     00280002
002900*   WR# P920721006                                                00290002
003000*            CHANGE SNKRP002 REPORT TO BYPASS LOGIC WHICH         00300002
003100*            RETRIEVES THE ANALYST (S300) AND BUYER (S400)        00310002
003200*            WHEN THE DEPARTMENT (S200) IS NOT FOUND.             00320002
003300* CHANGED 08/13/92 BY CHRISTINE CHARLESWORTH                      00330002
003400*   WR# PXXXXXXXXX                                                00340002
003500*            CHANGE SNKRP003 REPORT TO ACCEPT A CONTROL CARD      00350002
003600*            SIGNIFYING WHETHER IT IS A PRODUCTION OR TEST        00360002
003700*            RUN.                                                 00370002
003800* CHANGED 09/15/92 BY PAT LEE                                     00380002
003900*   WR# P920915004                                                00390002
004000*          - ADDED LOGIC TO HANDLE SEQ-NBR-IND (NEW ON TASNORD)   00400002
004100*          - REMOVE LOGIC TO CREATE DJDE                          00410002
004200* CHANGED 03/15/93 BY PAT LEE                                     00420002
004300*   WR# P930301007                                                00430002
004400*          - ADDED LOGIC TO EXTRACT TOTAL CARTONS FOR SHIPMENT    00440002
004500* CHANGED 04/13/93 BY DAN HINTZ                                   00450002
004600*   WR# 2178                                                      00460002
004700*          - ADDED LOGIC TO PROGRAM TO PRODUCE AN EXTRACT FILE.   00470002
004800*            THIS FILE WILL BE USED IN THE ASN TRANSCRIPTION      00480002
004900*            PROCESS (JOB RCK005).                                00490002
005000* CHANGED 04/20/93 BY DAN HINTZ                                   00500002
005100*   WR# 2178                                                      00510002
005200*          - ADDED LOGIC TO THE PROGRAM TO READ THE TVENDOR TABLE 00520002
005300*            TO RETRIEVE VENDOR TRANSCRIPTION INFORMATION FOR     00530002
005400*            USE IN THE ASN TRANSCRIPTION PROCESS.                00540002
005500* CHANGED 04/26/93 BY DAN HINTZ                                   00550002
005600*   WR# 2178                                                      00560002
005700*          - ADDED LOGIC TO THE PROGRAM TO ONLY WRITE OUT RECORDS 00570002
005800*            TO THE ASN TRANSCRIPTION EXTRACT FILE WHEN THE       00580002
005900*            DC_PRT_IND ON THE TASNHDR TABLE IS SET TO 'N'.       00590002
006000* CHANGED 06/03/93 BY DAN HINTZ                                   00600002
006100*   WR# 2178                                                      00610002
006200*          - ADDED LOGIC TO THE PROGRAM TO CHECK IF THE ROLLUP    00620002
006300*            INDICATOR HAS BEEN SET ON THE TVENDOR TABLE FOR A    00630002
006400*            SPECIFIC CARRIER.                                    00640002
006500*          - ADDED LOGIC TO THE PROGRAM TO ONLY WRITE RECORDS     00650002
006600*            TO THE EXTRACT FILE FOR THE VENDORS ON THE TVENDOR   00660002
006700*            TABLE WITH THE ASN_TRSCP_IND SET TO 'Y'.             00670002
006800* CHANGED 06/15/93 BY DAN HINTZ                                   00680002
006900*   WR# 2178                                                      00690002
007000*          - ADDED LOGIC TO THE PROGRAM TO ALSO RETRIEVE THE      00700002
007100*            CARRIER VENDOR ID FROM THE TVENDOR TABLE FOR A       00710002
007200*            SPECIFIC CARRIER.  THIS INFORMATION WILL BE USED     00720002
007300*            IN THE ASN TRANSCRIPTION PROCESS.                    00730002
007400* CHANGED 07/02/93 BY NATALIYA PALATNIK                           00740002
007500*   WR# 2178                                                      00750002
007600*          - ADDED LOGIC TO THE PROGRAM TO ALSO USE CARTON COUNT  00760002
007700*            INFORMATION FROM TD1 RECORD ON THE PO LEVEL          00770002
007800* CHANGED 09/23/93 BY DAN HINTZ                                   00780002
007900*   APM# P930915007                                               00790002
008000*          - ADDED LOGIC TO THE PROGRAM TO NOT WRITE ANY ASN'S    00800002
008100*            TO THE ASN EXTRACT FILE WHERE EITHER THE EDI VENDOR  00810002
008200*            ID OR CARRIER ID IS NOT PRESENT ON THE ASNHDR TABLE  00820002
008300*            (TASNHDR).                                           00830002
008400*   APM# P930915008                                               00840002
008500*          - ADDED LOGIC TO THE PROGRAM TO RETRIEVE THE PO NUMBER 00850002
008600*            FOR THE ASN EXTRACT FILE FROM THE TASNORD TABLE.     00860002
008700* CHANGED 09/28/93 BY DAN HINTZ                                   00870002
008800*   APM# P930821002                                               00880002
008900*          - ADDED LOGIC TO THE PROGRAM TO ALSO RETRIEVE THE      00890002
009000*            SCAC CODE FROM THE TVENDOR TABLE FOR A SPECIFIC      00900002
009100*            CARRIER.  THIS INFORMATION WILL BE USED IN THE       00910002
009200*            ASN TRANSCRIPTION PROCESS.                           00920002
009300* CHANGED 10/06/93 BY DAN HINTZ                                   00930002
009400*   APM# P931004011                                               00940002
009500*          - CORRECTED THE PROGRAM TO RETRIEVE THE PO NUMBER      00950002
009600*            FOR THE ASN EXTRACT FILE FROM THE TASNORD TABLE,     00960002
009700*            REGARDLESS OF HOW THE ASNORD-MTCH-PO-CDE INDICATOR   00970002
009800*            IS SET.                                              00980002
009900* CHANGED 04/23/94 BY DAN HINTZ                                   00990002
010000*    WR# 2598                                                     01000002
010100*          - CHANGED THE PROGRAM TO USE THE NEW EXTERNAL          01010002
010200*            ENTERPRISE TABLE (TEXTENT) AND THE ENTERPRISE        01020002
010300*            NAME TABLE (TENTNME) TO RETRIEVE VENDOR INFORMATION. 01030002
010400* CHANGED 06/27/94 BY KATHY AVERBECK/IBS.                         01040002
010500*    WR# ####                                                     01050002
010600*          - CHANGED PROGRAM TO CHECK THE TASHADR TABLE TO SEE    01060002
010700*            IF A VALID DC NUMBER WAS TRANSMITTED, AND TO PRINT   01070002
010800*            IT  ON THE REPORT.  "UNKNOWN" IS PRINTED IF IT WAS   01080002
010900*            NOT A VALID DC NUMBER.  THE DC IS ALSO WRITTEN TO    01090002
011000*            THE RC001 RECORD (HIGH-VALUES FOR UNKNOWN).          01100002
011100* CHANGED 04/96/95 BY DAN FRANKLIN.                               01110002
011200*    IR# P950406008                                               01120002
011300*          - CHANGED PROGRAM TO NOT INCLUDE PO_DTE AS A PART OF   01130002
011400*            THE ASN_HEADER_CURSOR.  NOT ONLY IS THIS COLUMN NOT  01140002
011500*            BEING USED, BUT IT IS CAUSING A PROBLEM WHEN WE HAVE 01150002
011600*            THE SAME ASN/PO/STORE WITH A DIFFERENT PO_DTE.  IT   01160002
011700*            CAUSES THE PROGRAM TO REPORT ON EACH ROW WITH A      01170002
011800*            DIFFERENT PO_DTE.  THIS CAUSES THE PROGRAM TO        01180002
011900*            REPORT ON THE SAME ASN/PO/STORE MORE THAN ONCE.      01190002
012000*            I COMMENTED OUT THE NECESSARY CODE, IN CASE THIS     01200002
012100*            CAUSES A PROBLEM.                                    01210002
012200* CHANGED 08/19/97 BY DARYL WOELFEL                               01220002
012300*    WR# 4371                                                     01230002
012400*          - ADDED MAN SEGMENT INDICATOR, EDI INDICATOR, AND      01240002
012500*            SCAC CODE TO HEADINGS.                               01250002
012600* CHANGED 08/19/97 BY DARYL WOELFEL                               01260002
012700*    WR# 4455                                                     01270002
012800*          - ADDED ERROR CHECKING OF DC AND STORE FOR BULK        01280002
012900*            SHIPMENTS.                                           01290002
013000* CHANGED 03/22/00 BY MIKE MACHNIK                                01300002
013100*    WR# 9900                                                     01310002
013200*          - CHANGED SQL IN PARA R600-RETRIEVE-MAN-SEGMENT.       01320002
013300*            THE WHERE CLAUSE CHECKS THE ASN CARTON FOR ZEROS.    01330002
013400*            WENT FROM CHECKING FIRST 15 CHARS TO FIRST 20 CHAR.  01340002
013500* CHANGED 07/11/00 BY MIKE MACHNIK                                01350002
013600*    WR# 20868                                                    01360002
013700*          - RETRIEVE CONTAINER NUMBER FROM TASNHDR (EQUIP_NBR,   01370002
013800*            EQUIP_INIT_CDE) AND MOVE TO OUTPUT FILE              01380002
013900*            (RC001-CONT-NBR). IN ADDITION MOVE SPACES TO         01390002
014000*            RC001-TRAILER-NBR (THE DATA THAT USED TO FILL THIS   01400002
014100*            FIELD IS NO LONGER AVAILABLE).                       01410002
014200*            ALSO CHANGED REPORT TO INCLUDE ISA# AND ADDED THE    01420002
014300*            EDI INPUT FILE (USED IN SNK000) AS INPUT TO THIS     01430002
014400*            PROGRAM TO BE ABLE TO IDENTIFY THE TRADING PARTNER   01440002
014500*            ID IF IMPORTS.                                       01450002
014600* CHANGED 09/07/00 BY MIKE MACHNIK                                01460002
014700*    WR# 09900                                                    01470002
014800*          - CORRECT PRINT LINE MANAGEMENT                        01480002
014900*          - CORRECT PROCESSING FOR 'PO4' EDI SEGMENTS FOR CARTON 01490002
015000*            QUANTITIES.  IF 'PO4' PRESENT IN EDI INPUT, IT WILL  01500002
015100*            PLACE A VALUE IN THE CARTON FOR QTY.  CODE WILL NOW  01510002
015200*            CHECK FOR PRESENCE OF CARTON QTY IN TASNCAR BEFORE   01520002
015300*            TAKING VALUE USED NOW FROM THE 'SN1' EDI SEGMENT.    01530002
015400* CHANGED 12/01/11 BY CHRISTINE TWIEHAUS                          01540002
015500*    WR# 40574                                                    01550002
015600*          - ADDED CAN (CARR-AUTH-ID) TO RCRD001                  01560002
015700* CHANGED 11/12/14 BY VENKATSUBBU (COGNIZANT)                     01570005
015800*    WR# CHG0094517                                               01580002
015900*          - CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE    01590002
016000*      OF PO# FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH C94517       01600002
016100* CHANGED 01/20/15 BY GERMAN BANDA                                01610002
016200*    WR# CHG0102650                                               01620002
016300*          - CHANGES TO PV-DETAIL-CARTON TO ADD FILLER OF 40      01630002
016400*      TO MATCH THE RCRD001 LAYOUT - WAS CAUSING OC7 ON EXCEPTIONS01640002
016500*                                                                 01650002
016600* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         01660002
016700* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     01670002
016800* MAKING THE CALL DYNAMIC VS STATIC.                              01680002
016900*                                                                 01690002
017000* CHANGED 10/06/2022    BY BOB MCASEY      WR: CHG0276960         01700004
017100* ADD DISPLAYS AND ADD 2 NEW RPORTING FIELDS                      01710005
017200***************************************************************** 01720002
017300 ENVIRONMENT DIVISION.                                            01730002
017400***************************************************************** 01740002
017500                                                                  01750002
017600 CONFIGURATION SECTION.                                           01760002
017700                                                                  01770002
017800 SOURCE-COMPUTER.        IBM-3090.                                01780002
017900 OBJECT-COMPUTER.        IBM-3090.                                01790002
018000                                                                  01800002
018100 INPUT-OUTPUT SECTION.                                            01810002
018200                                                                  01820002
018300 FILE-CONTROL.                                                    01830002
018400*                                                                 01840002
018500     SELECT ADV-SHIP-NOTICE-FILE                                  01850002
018600         ASSIGN TO INP01.                                         01860002
018700                                                                  01870002
018800     SELECT ASN-TRANSCRIPTION-FILE                                01880002
018900         FILE STATUS PV-ASN-TRANSCRIPTION-FL-ST                   01890002
019000         ASSIGN TO OUT01.                                         01900002
019100*                                                                 01910002
019200     SELECT REPORT-FILE-OUT-1                                     01920002
019300         FILE STATUS PV-REPORT-FILE-OUT-1-ST                      01930002
019400         ASSIGN TO RPT01.                                         01940002
019500*                                                                 01950002
019600     SELECT ASN-CARTON-ERROR-FILE                                 01960002
019700         FILE STATUS PV-ASN-ERROR-FILE-FL-ST                      01970002
019800         ASSIGN TO OUT02.                                         01980002
019900*                                                                 01990002
020000***************************************************************** 02000002
020100 DATA DIVISION.                                                   02010002
020200***************************************************************** 02020002
020300*                                                                 02030002
020400 FILE SECTION.                                                    02040002
020500*                                                                 02050002
020600 FD  ADV-SHIP-NOTICE-FILE                                         02060002
020700     RECORDING MODE F                                             02070002
020800     BLOCK CONTAINS 0 RECORDS                                     02080002
020900     RECORD CONTAINS 350 CHARACTERS                               02090002
021000     LABEL RECORDS ARE STANDARD                                   02100002
021100     DATA RECORD IS ADV-SHIP-NOTICE-RECORD.                       02110002
021200 01  ADV-SHIP-NOTICE-RECORD              PIC X(350).              02120002
021300*                                                                 02130002
021400 FD  ASN-TRANSCRIPTION-FILE                                       02140002
021500     RECORDING MODE IS F                                          02150002
021600     LABEL RECORDS ARE STANDARD                                   02160002
021700     RECORD CONTAINS 600 CHARACTERS                               02170002
021800     BLOCK CONTAINS 0  RECORDS.                                   02180002
021900 01  ASN-TRANSCRIPTION-RECORD        PIC  X(600).                 02190002
022000*                                                                 02200002
022100 FD  REPORT-FILE-OUT-1                                            02210002
022200     RECORDING MODE IS F                                          02220002
022300     LABEL RECORDS ARE STANDARD                                   02230002
022400     RECORD CONTAINS 132 CHARACTERS                               02240002
022500     BLOCK CONTAINS 0  RECORDS.                                   02250002
022600 01  REPORT-RECORD-OUT-1             PIC  X(132).                 02260002
022700*                                                                 02270002
022800 FD  ASN-CARTON-ERROR-FILE                                        02280002
022900     RECORDING MODE IS F                                          02290002
023000     LABEL RECORDS ARE STANDARD                                   02300002
023100     RECORD CONTAINS 120 CHARACTERS                               02310002
023200     BLOCK CONTAINS 0  RECORDS.                                   02320002
023300 01  ASN-CARTON-ERROR-RECORD         PIC  X(120).                 02330002
023400*                                                                 02340002
023500                                                                  02350002
023600 WORKING-STORAGE SECTION.                                         02360002
023700*                                                                 02370002
023800 01  FILLER.                                                      02380002
023900     05  FILLER                      PIC  X(36)    VALUE          02390002
024000         ' ***** WORKING STORAGE PGM=SNKRP006 '.                  02400002
024100     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   02410002
024200     05  FILLER                      PIC  X(10)    VALUE          02420002
024300         ' LOCATION='.                                            02430002
024400     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   02440002
024500     05  FILLER                      PIC  X(06)    VALUE          02450002
024600         ' *****'.                                                02460002
024700 EJECT                                                            02470002
024800 01  CC-CONTROL-CARD.                                             02480002
024900     05  CC-JOBNAME                   PIC X(08)  VALUE SPACES.    02490002
025000     05  CC-PARM-TYPE                 PIC X(04)  VALUE SPACES.    02500002
025100         88  CC-PARM-VALID                       VALUE 'TEST'     02510002
025200                                                       'PROD'     02520002
025300                                                       '    '.    02530002
025400         88  CC-PARM-TEST                        VALUE 'TEST'.    02540002
025500         88  CC-PARM-PROD                        VALUE 'PROD'.    02550002
025600/                                                                 02560002
025700 01  PROGRAM-SWITCHES.                                            02570002
025800     05  PS-END-OF-ASN-IND           PIC  X(01)    VALUE 'N'.     02580002
025900         88  PS-END-OF-ASN                         VALUE 'Y'.     02590002
026000     05  PS-END-OF-ASN-DETAIL-IND    PIC  X(01)    VALUE 'N'.     02600002
026100         88  PS-END-OF-ASN-DETAIL                  VALUE 'Y'.     02610002
026200         88  PS-NOT-END-OF-ASN-DETAIL              VALUE 'N'.     02620002
026300     05  PS-END-OF-CARTON-IND        PIC  X(01)    VALUE 'N'.     02630002
026400         88  PS-END-OF-CARTON                      VALUE 'Y'.     02640002
026500         88  PS-NOT-END-OF-CARTON                  VALUE 'N'.     02650002
026600     05  PS-NO-PO-IND                PIC  X(01)    VALUE 'N'.     02660002
026700         88  PS-NO-PO-FOUND                        VALUE 'N'.     02670002
026800         88  PS-PO-FOUND                           VALUE 'Y'.     02680002
026900     05  PS-FIRST-ASN-FOR-PO-IND     PIC  X(01)    VALUE 'N'.     02690002
027000         88  PS-NOT-FIRST-ASN-FOR-PO               VALUE 'N'.     02700002
027100         88  PS-FIRST-ASN-FOR-PO                   VALUE 'Y'.     02710002
027200     05  PS-ROLL-UP-BOL-FOR-PO-IND   PIC  X(01)    VALUE 'N'.     02720002
027300         88  PS-DONT-ROLL-UP-BOL-FOR-PO            VALUE 'N'.     02730002
027400         88  PS-ROLL-UP-BOL-FOR-PO                 VALUE 'Y'.     02740002
027500     05  PS-WRITE-EXTRACT-RECORD-IND PIC  X(01)    VALUE 'N'.     02750002
027600         88  PS-DONT-WRITE-EXTRACT-RECORD          VALUE 'N'.     02760002
027700         88  PS-WRITE-EXTRACT-RECORD               VALUE 'Y'.     02770002
027800     05  PS-PREV-DTL-SORT-IND-IND    PIC  X(01)    VALUE '1'.     02780002
027900         88  PS-PREV-DTL-SORT-1                    VALUE '1'.     02790002
028000         88  PS-PREV-DTL-SORT-2                    VALUE '2'.     02800002
028100     05  PS-EOF-INST-CSR-IND         PIC  X(01)    VALUE 'N'.     02810002
028200         88  PS-EOF-INST-CSR                       VALUE 'Y'.     02820002
028300         88  PS-NOT-EOF-INST-CSR                   VALUE 'N'.     02830002
028400     05  PS-VALID-SW                 PIC  X(01)    VALUE 'Y'.     02840002
028500         88  PS-VALID                              VALUE 'Y'.     02850002
028600         88  PS-VALIDATION-ERR                     VALUE 'N'.     02860002
028700     05  PS-DC-STR-FOUND-SW          PIC  X(01)    VALUE 'N'.     02870002
028800         88  DC-STR-FOUND                          VALUE 'Y'.     02880002
028900         88  DC-STR-NOT-FOUND                      VALUE 'N'.     02890002
029000     05  PS-DC-SHIP-FOUND-SW         PIC  X(01)    VALUE 'N'.     02900002
029100         88  DC-SHIP-FOUND                         VALUE 'Y'.     02910002
029200         88  DC-SHIP-NOT-FOUND                     VALUE 'N'.     02920002
029300     05  PS-DC-ORD-FOUND-SW          PIC  X(01)    VALUE 'N'.     02930002
029400         88  DC-ORD-FOUND                          VALUE 'Y'.     02940002
029500         88  DC-ORD-NOT-FOUND                      VALUE 'N'.     02950002
029600     05  PS-DS-SHIP-FOUND-SW         PIC  X(01)    VALUE 'N'.     02960002
029700         88  DS-SHIP-FOUND                         VALUE 'Y'.     02970002
029800         88  DS-SHIP-NOT-FOUND                     VALUE 'N'.     02980002
029900     05  PS-DS-ORD-FOUND-SW          PIC  X(01)    VALUE 'N'.     02990002
030000         88  DS-ORD-FOUND                          VALUE 'Y'.     03000002
030100         88  DS-ORD-NOT-FOUND                      VALUE 'N'.     03010002
030200     05  PS-ID-REC-SW                PIC  X(01)    VALUE 'N'.     03020002
030300         88  ID-REC-FOUND                          VALUE 'Y'.     03030002
030400         88  ID-REC-NOT-FOUND                      VALUE 'N'.     03040002
030500     05  PS-CNTL-NBR-SW              PIC  X(01)    VALUE 'N'.     03050002
030600         88  CNTL-NBR-FOUND                        VALUE 'Y'.     03060002
030700         88  CNTL-NBR-NOT-FOUND                    VALUE 'N'.     03070002
030800     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     03080002
030900         88  END-OF-INP01                          VALUE 'Y'.     03090002
031000         88  NOT-END-OF-INP01                      VALUE 'N'.     03100002
031010     05  PS-VALID-TRADE-PART-SW      PIC X(01)     VALUE 'N'.     03101007
031020         88  PS-VALID-TRADE-PART                   VALUE 'Y'.     03102007
031030         88  PS-NOT-VALID-TRADE-PART               VALUE 'N'.     03103007
031100*----------------------------------------------------------------*03110002
031200*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 230ZZ  *03120002
031300*----------------------------------------------------------------*03130002
031400     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        03140002
031500         88  PS-CALL-API-NO                     VALUE 'N'.        03150002
031600         88  PS-CALL-API-YES                    VALUE 'Y'.        03160002
031700*----------------------------------------------------------------*03170002
031800* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03180002
031900*----------------------------------------------------------------*03190002
032000*                                                                 03200002
032010 01  DK-DATABASE-KEYS.                                            03201007
032040     05  DK-PARTNER-ID               PIC X(15)     VALUE SPACES.  03204007
032041     05  DK-ENT-ID                   PIC S9(9)     COMP           03204107
032042                                                   VALUE ZEROS.   03204207
032050                                                                  03205007
032100 01  PC-ADDTL-ERROR-MESSAGES.                                     03210002
032200     05  PC-AEM-1                    PIC X(25)     VALUE          03220002
032300         'SHIPPED EARLY            '.                             03230002
032400     05  PC-AEM-2                    PIC X(25)     VALUE          03240002
032500         'SHIPPED LATE             '.                             03250002
032600     05  PC-AEM-3                    PIC X(30)     VALUE          03260002
032700         'PURCHASE ORDER NOT ON FILE    '.                        03270002
032800     05  PC-AEM-4                    PIC X(30)     VALUE          03280002
032900         'PO CANCELLED OR COMPLETE      '.                        03290002
033000     05  PC-AEM-5                    PIC X(06)     VALUE          03300002
033100         'ALLOC '.                                                03310002
033200     05  PC-AEM-6                    PIC X(06)     VALUE          03320002
033300         'PO LNE'.                                                03330002
033400     05  PC-AEM-7                    PIC X(06)     VALUE          03340002
033500         'DISC  '.                                                03350002
033600     05  PC-AEM-8                    PIC X(06)     VALUE          03360002
033700         'OVER  '.                                                03370002
033800     05  PC-AEM-9                    PIC X(06)     VALUE          03380002
033900         'PRICE '.                                                03390002
034000     05  PC-AEM-10                   PIC X(06)     VALUE          03400002
034100         'SHORT '.                                                03410002
034200*                                                                 03420002
034300 01  PC-CONSTANTS.                                                03430002
034400     05  PC-NEG-1                    PIC S9(04)    VALUE -1       03440002
034500                                                   COMP SYNC.     03450002
034600     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     03460002
034700                                                   COMP SYNC.     03470002
034800     05  PC-DUPLICATE                PIC S9(04)    VALUE -811     03480002
034900                                                   COMP SYNC.     03490002
035000     05  PC-FLNAME-LENGTH            PIC S9(03)    VALUE +30      03500002
035100                                                   COMP-3.        03510002
035200     05  PC-1                        PIC S9(03)    VALUE +1       03520002
035300                                                   COMP-3.        03530002
035400     05  PC-2                        PIC S9(03)    VALUE +2       03540002
035500                                                   COMP-3.        03550002
035600     05  PC-3                        PIC S9(03)    VALUE +3       03560002
035700                                                   COMP-3.        03570002
035800     05  PC-7                        PIC S9(01)    VALUE +7.      03580002
035900     05  PC-8                        PIC S9(01)    VALUE +8.      03590002
036000     05  PC-11                       PIC S9(03)    VALUE +11      03600002
036100                                                   COMP-3.        03610002
036200     05  PC-14                       PIC S9(03)    VALUE +14      03620002
036300                                                   COMP-3.        03630002
036400     05  PC-55                       PIC S9(03)    VALUE +55      03640002
036500                                                   COMP-3.        03650002
036600     05  PC-50                       PIC S9(03)    VALUE +55      03660002
036700                                                   COMP-3.        03670002
036800     05  PC-99                       PIC S9(03)    VALUE +99      03680002
036900                                                   COMP-3.        03690002
037000     05  PC-00                       PIC  X(02)    VALUE '00'.    03700002
037100     05  PC-01                       PIC  X(02)    VALUE '01'.    03710002
037200     05  PC-02                       PIC  X(02)    VALUE '02'.    03720002
037300     05  PC-03                       PIC  X(02)    VALUE '03'.    03730002
037400     05  PC-04                       PIC  X(02)    VALUE '04'.    03740002
037500     05  PC-TWO                      PIC  X(01)    VALUE '2'.     03750002
037600     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       03760002
037700     05  PC-DASH                     PIC  X(01)    VALUE '-'.     03770002
037800     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     03780002
037900     05  PC-A                        PIC  X(01)    VALUE 'A'.     03790002
038000     05  PC-B                        PIC  X(01)    VALUE 'B'.     03800002
038100     05  PC-C                        PIC  X(01)    VALUE 'C'.     03810002
038200     05  PC-E                        PIC  X(01)    VALUE 'E'.     03820002
038300     05  PC-L                        PIC  X(01)    VALUE 'L'.     03830002
038400     05  PC-N                        PIC  X(01)    VALUE 'N'.     03840002
038500     05  PC-O                        PIC  X(01)    VALUE 'O'.     03850002
038600     05  PC-P                        PIC  X(01)    VALUE 'P'.     03860002
038700     05  PC-S                        PIC  X(01)    VALUE 'S'.     03870002
038800     05  PC-U                        PIC  X(01)    VALUE 'U'.     03880002
038900     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     03890002
039000     05  PC-UP                       PIC  X(02)    VALUE 'UP'.    03900002
039100     05  PC-BUYER-BY                 PIC  X(02)    VALUE 'BY'.    03910002
039200     05  PC-BUYER-BYR                PIC  X(03)    VALUE 'BYR'.   03920002
039300     05  PC-ANALYST                  PIC  X(03)    VALUE 'ANL'.   03930002
039400     05  PC-DEPARTMENT               PIC  X(03)    VALUE 'DPT'.   03940002
039500     05  PC-EACH                     PIC  X(02)    VALUE 'EA'.    03950002
039600     05  PC-SNKRP006                 PIC  X(08)    VALUE          03960002
039700                                                   'SNKRP006'.    03970002
039800     05  PC-TEST                     PIC  X(08)    VALUE          03980002
039900                                                   '**TEST**'.    03990002
040000     05  PC-DPPD024                  PIC  X(08)    VALUE          04000002
040100                                                   'DPPD024 '.    04010002
040200     05  PC-ILBOABN0                 PIC  X(08)    VALUE          04020002
040300                                                   'ILBOABN0'.    04030002
040400     05  PC-ASTERISK                 PIC  X(30)    VALUE          04040002
040500         '*****************************'.                         04050002
040600     05  PC-NO-ASN-DETAIL            PIC  X(30)    VALUE          04060002
040700         'NO DETAIL FOR THIS ASN NUMBER'.                         04070002
040800     05  PC-NO-ASN-NUMBERS           PIC  X(30)    VALUE          04080002
040900         'NO ASN NUMBERS WERE FOUND    '.                         04090002
041000     05  PC-DEPT-NOT-FOUND           PIC  X(25)    VALUE          04100002
041100         'DEPARTMENT NOT VALID    '.                              04110002
041200     05  PC-SEQ-NBR-IND              PIC  X(14)    VALUE          04120002
041300         'SEQ ID:       '.                                        04130002
041400     05  PC-STR-NBR-IND              PIC  X(14)    VALUE          04140002
041500         'STORE ID:     '.                                        04150002
041600     05  PC-NOT-SENT                 PIC  X(08)    VALUE          04160002
041700         'NOT SENT'.                                              04170002
041800     05  PC-NOT-PBS                  PIC  X(07)    VALUE          04180002
041900         'NOT PBS'.                                               04190002
042000     05  PC-UNKNOWN                  PIC  X(07)    VALUE          04200002
042100         'UNKNOWN'.                                               04210002
042200     05  PC-DIR-TO-STORE             PIC  X(15)    VALUE          04220002
042300         'DIRECT TO STORE'.                                       04230002
042400*----------------------------------------------------------------*04240002
042500* INCLUDED NEW CONSTANTS PC-999 & PC-000      **     WR # 230ZZ  *04250002
042600*----------------------------------------------------------------*04260002
042700     05  PC-000                       PIC X(03) VALUE '000'.      04270002
042800     05  PC-999                       PIC X(03) VALUE '999'.      04280002
042900*----------------------------------------------------------------*04290002
043000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *04300002
043100*----------------------------------------------------------------*04310002
043200 EJECT                                                            04320002
043300*                                                                 04330002
043400 01  PV-NULL-INDICATORS.                                          04340002
043500     05  PV-GRO-WGHT-MSMT-NULL       PIC S9(04)    VALUE +0       04350002
043600                                                   COMP SYNC.     04360002
043700     05  PV-HDR-PRO-NBR-NULL         PIC S9(04)    VALUE +0       04370002
043800                                                   COMP SYNC.     04380002
043900     05  PV-HDR-GRO-WGHT-MSMT-NULL   PIC S9(04)    VALUE +0       04390002
044000                                                   COMP SYNC.     04400002
044100     05  PV-HDR-ANTC-DELY-DTE-NULL   PIC S9(04)    VALUE +0       04410002
044200                                                   COMP SYNC.     04420002
044300     05  PV-HDR-CARR-NAME-NULL       PIC S9(04)    VALUE +0       04430002
044400                                                   COMP SYNC.     04440002
044500     05  PV-HDR-CARR-ID-CDE-NULL     PIC S9(04)    VALUE +0       04450002
044600                                                   COMP SYNC.     04460002
044700     05  PV-HDR-EQUIP-INIT-CDE-NULL  PIC S9(04)    VALUE +0       04470002
044800                                                   COMP SYNC.     04480002
044900     05  PV-HDR-EQUIP-NBR-NULL       PIC S9(04)    VALUE +0       04490002
045000                                                   COMP SYNC.     04500002
045100     05  PV-HDR-GRO-WGHT-UM-CDE-NULL PIC S9(04)    VALUE +0       04510002
045200                                                   COMP SYNC.     04520002
045300*    05  PV-HDR-PO-DTE-NULL          PIC S9(04)    VALUE +0       04530002
045400* 4/6/95                                           COMP SYNC.     04540002
045500     05  PV-DTL-PKG-QTY-NULL         PIC S9(04)    VALUE +0       04550002
045600                                                   COMP SYNC.     04560002
045700     05  PV-PKG-QTY-NULL             PIC S9(04)    VALUE +0       04570002
045800                                                   COMP SYNC.     04580002
045900     05  PV-DTL-VEND-ORD-QTY-NULL    PIC S9(04)    VALUE +0       04590002
046000                                                   COMP SYNC.     04600002
046100     05  PV-DTL-ORD-QTY-UM-CDE-NULL  PIC S9(04)    VALUE +0       04610002
046200                                                   COMP SYNC.     04620002
046300     05  PV-PO-CARTONS-QTY-NULL      PIC S9(04)    VALUE +0       04630002
046400                                                   COMP SYNC.     04640002
046500     05  PV-STORE-CARTONS-QTY-NULL   PIC S9(04)    VALUE +0       04650002
046600                                                   COMP SYNC.     04660002
046700     05  PV-AD-DATE-NULL             PIC S9(04)    VALUE +0       04670002
046800                                                   COMP SYNC.     04680002
046900     05  PV-NAME-ID-CDE-NULL         PIC S9(04)    VALUE +0       04690002
047000                                                   COMP SYNC.     04700002
047100*                                                                 04710002
047200 01  WS-TABLES.                                                   04720002
047300     05  WS-PARTNER                  PIC X(15) VALUE SPACES.      04730002
047400     05  WS-PARTNER-ID               PIC X(2)  VALUE SPACES.      04740002
047500     05  WS-PARTNER-TABLE.                                        04750002
047600         10  WS-TRADING-PARTNER-TBL OCCURS 10000 TIMES.           04760002
047700             15  WS-ISA-CNTL-NBR         PIC 9(9).                04770002
047800             15  WS-TRADING-PARTNER      PIC X(15).               04780002
047900             15  WS-TRADING-PARTNER-ID   PIC X(2).                04790002
048000                                                                  04800007
048100*01  PS-TRADING-PARTNER.                                          04810007
048200*    05  PS-PARTNER-ID                PIC X(15).                  04820007
048300*        88  VALID-TRIANGLE-SHIP                 VALUE            04830007
048400*                                           '3056851047     '     04840007
048500*                                           '6152560988     '     04850007
048600*                                           '8004268560     '     04860007
048700*                                           '7045970923     '     04870007
048800*                                           '2013323333     '     04880007
048900*                                           '3054064423     '     04890007
049000*                                           '9093934777     '     04900007
049100*                                           '3108861300     '     04910007
049200*                                           '5623452200     '     04920007
049300*                                           'HUDDKOHL       '     04930007
049400*                                           'APSSAV         '     04940007
049500*                                           'SCHNEIDERPROD  '     04950007
049600*                                           'OCSNY          '.    04960007
049700 01  PV-ACCUMULATOR-FIELDS.                                       04970002
049800     05  SUB                         PIC 9(7)      VALUE 0.       04980002
049900     05  SUB1                        PIC 9(7)      VALUE 0.       04990002
050000     05  SUB2                        PIC 9(7)      VALUE 0.       05000002
050100     05  MAX-SUB                     PIC 9(7)      VALUE 0.       05010002
050200     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     05020002
050300                                                   COMP-3.        05030002
050400     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     05040002
050500                                                   COMP-3.        05050002
050600     05  PV-INSTR-CNT                PIC S9(03)    VALUE ZERO     05060002
050700                                                   COMP-3.        05070002
050800     05  PV-TABLE-SUB                PIC S9(03)    VALUE ZERO     05080002
050900                                                   COMP-3.        05090002
051000     05  PV-MAN-SEGMENT-COUNT        PIC S9(09)    VALUE ZERO     05100002
051100                                                   COMP-3.        05110002
051200     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     05120002
051300                                                   COMP-3.        05130002
051310     05  PV-INPUT-RECS-READ          PIC S9(07)    VALUE ZERO     05131003
051320                                                   COMP-3.        05132003
051330     05  PV-INPUT-ID-RECS-READ       PIC S9(07)    VALUE ZERO     05133003
051340                                                   COMP-3.        05134003
051400     05  PV-ASN-TRANS-RECS-WRITTEN   PIC S9(07)    VALUE ZERO     05140002
051500                                                   COMP-3.        05150002
051600     05  PV-ASN-ERROR-RECS-WRITTEN   PIC S9(07)    VALUE ZERO     05160002
051700                                                   COMP-3.        05170002
051701     05  PV-DISPLAY-PO-NBR           PIC 9(08)     VALUE ZERO.    05170109
051710     05  PV-DISPLAY-REC-NBR          PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  05171007
051720     05  PV-DISPLAY-ENT-ID           PIC ZZZZZZZZ9   VALUE ZERO.  05172007
051800     05  PV-LNAME-LENGTH             PIC S9(03)    VALUE +18      05180002
051900                                                   COMP-3.        05190002
052000     05  PV-GRO-WGHT-MSMT            PIC S9(09)V99 VALUE +0       05200002
052100                                                   COMP-3.        05210002
052200     05  PV-DOLLARS-SHIPPED          PIC S9(09)V99 VALUE +0       05220002
052300                                                   COMP-3.        05230002
052400     05  PV-HOLD-DOLLARS-SHIPPED     PIC S9(09)V99 VALUE +0       05240002
052500                                                   COMP-3.        05250002
052600     05  PV-DOLLARS-ORDERED          PIC S9(09)V99 VALUE +0       05260002
052700                                                   COMP-3.        05270002
052800     05  PV-TOTAL-CARTONS-SHPMT      PIC S9(08)    VALUE +0       05280002
052900                                                   COMP-3.        05290002
053000     05  PV-TOTAL-CARTONS-STORE      PIC S9(08)    VALUE +0       05300002
053100                                                   COMP-3.        05310002
053200     05  PV-TOTAL-CARTONS-PO         PIC S9(08)    VALUE +0       05320002
053300                                                   COMP-3.        05330002
053400     05  PV-DETAIL-TOTALS                          COMP-3.        05340002
053500         10  PV-DTL-TTL-DLLRS-ORD    PIC S9(09)V99 VALUE +0.      05350002
053600         10  PV-DTL-TTL-DLLRS-SHIPD  PIC S9(09)V99 VALUE +0.      05360002
053700         10  PV-DTL-TTL-QTY-ORD      PIC S9(07)    VALUE +0.      05370002
053800         10  PV-DTL-TTL-QTY-SHIP     PIC S9(07)    VALUE +0.      05380002
053900 EJECT                                                            05390002
054000*                                                                 05400002
054100 01  PV-MISC-FIELDS.                                              05410002
054200     05  PV-ASN-CARTON-NBR.                                       05420002
054300         10  PV-ASN-CARTON-NBR-2     PIC  X(02).                  05430002
054400         10  PV-ASN-CARTON-NBR-18    PIC  X(18).                  05440002
054500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     05450002
054600                                                   COMP SYNC.     05460002
054700     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  05470002
054800     05  PV-ASN-TRANSCRIPTION-FL-ST  PIC  X(02)    VALUE SPACES.  05480002
054900     05  PV-ASN-ERROR-FILE-FL-ST     PIC  X(02)    VALUE SPACES.  05490002
055000     05  PV-REPORT-FILE-OUT-1-ST     PIC  X(02)    VALUE SPACES.  05500002
055100     05  PV-CURR-ASNHDR-NBR          PIC  X(30)    VALUE SPACES.  05510002
055200     05  PV-CURR-BOL-NBR             PIC  X(30)    VALUE SPACES.  05520002
055300     05  PV-SAVE-BOL-NBR             PIC  X(30)    VALUE SPACES.  05530002
055400     05  PV-CURR-PO-NBR              PIC  X(22)    VALUE SPACES.  05540002
055500     05  PV-PREV-PO-NBR              PIC  X(22)    VALUE SPACES.  05550002
055600     05  PV-DATE-SHIPPED             PIC  9(08)    VALUE ZEROS.   05560002
055700     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZEROS.   05570002
055800     05  PV-SEQUENCE-NBR             PIC  9(07)    VALUE ZEROS.   05580002
055900     05  PV-SAVE-SEQUENCE-NBR        PIC  9(07)    VALUE ZEROS.   05590002
056000     05  PV-CARTON-SEQUENCE-NBR      PIC  9(07)    VALUE ZEROS.   05600002
056100     05  PV-VLD-CART-LBL-IND         PIC  X(01)    VALUE SPACES.  05610002
056200     05  PV-CURR-SKU-DESC            PIC  X(25)    VALUE SPACES.  05620002
056300     05  PV-CURR-TMST                PIC  X(26)    VALUE SPACES.  05630002
056400     05  PV-SCAC-CDE.                                             05640002
056500         10  PV-SCAC-CDE-1-4         PIC  X(04)    VALUE SPACES.  05650002
056600         10  PV-SCAC-CDE-5-17        PIC  X(13)    VALUE SPACES.  05660002
056700     05  PV-EDI-VEND-ID.                                          05670002
056800         10  PV-EDI-VEND-ID-1-9      PIC  X(09)    VALUE SPACES.  05680002
056900         10  PV-EDI-VEND-ID-10-17    PIC  9(08)    VALUE ZEROS.   05690002
057000     05  PV-CURR-ASNDTL-FIELDS.                                   05700002
057100         10  PV-CURR-UPC-NBR         PIC  9(15)    VALUE ZEROS.   05710002
057200         10  PV-CURR-SHIPT-UM-CDE    PIC  X(02)    VALUE SPACES.  05720002
057300         10  PV-CURR-SHIPT-QTY       PIC S9(07)    VALUE ZEROS.   05730002
057400         10  PV-CURR-PKG-QTY         PIC S9(07)    VALUE ZEROS.   05740002
057500         10  PV-ASNDTL-ASNDTL-NBR    PIC S9(07)    VALUE ZEROS    05750002
057600                                                   COMP-3.        05760002
057700         10  PV-CURR-ORD-QTY-UM-CDE  PIC  X(02)    VALUE SPACES.  05770002
057800         10  PV-CURR-PKG-QTY-NULL    PIC S9(04)    VALUE +0       05780002
057900                                                   COMP SYNC.     05790002
058000     05  PV-NAME-ID-CDE              PIC X(17).                   05800002
058100     05  PV-CURR-ASDTPL-FIELDS.                                   05810002
058200         10  PV-CURR-PO-LN-NBR       PIC  9(4)     VALUE ZEROS.   05820002
058300         10  PV-CURR-PO-LN-NBR-COMP  PIC S9(3)     VALUE ZEROS    05830002
058400                                                   COMP-3.        05840002
058500         10  PV-CURR-ASSOC-QTY       PIC S9(7)     VALUE +0       05850002
058600                                                   COMP-3.        05860002
058700         10  PV-CURR-ASSOC-QTY-CALC  PIC S9(7)     VALUE +0       05870002
058800                                                   COMP-3.        05880002
058900         10  PV-SAVE-ASSOC-QTY       PIC S9(7)     VALUE +0       05890002
059000                                                   COMP-3.        05900002
059100         10  PV-CURR-SHIPT-VAR-QTY   PIC S9(7)     VALUE +0       05910002
059200                                                   COMP-3.        05920002
059300         10  PV-CURR-PR-CHG-EFF-DAY-NBR                           05930002
059400                                     PIC S9(3)     VALUE +0       05940002
059500                                                   COMP-3.        05950002
059600         10  PV-CURR-PR-VAR-IND      PIC  X(01)    VALUE SPACES.  05960002
059700         10  PV-CURR-PR-DISC-IND     PIC  X(01)    VALUE SPACES.  05970002
059800         10  PV-CURR-ASDTPL-ALLOC-IND                             05980002
059900                                     PIC  X(01)    VALUE SPACES.  05990002
060000     05  PV-ASDTPL-ASSOC-QTY         PIC S9(7)     VALUE +0       06000002
060100                                                   COMP-3.        06010002
060200     05  PV-ASNDTL-SHIPT-QTY         PIC S9(7)     VALUE +0       06020002
060300                                                   COMP-3.        06030002
060400     05  PV-ASNDTL-UPC-NBR           PIC S9(15)    VALUE +0       06040002
060500                                                   COMP-3.        06050002
060600     05  PV-DB2-FORMAT-UPC           PIC S9(15)    COMP-3.        06060002
060700     05  PV-PREV-GRO-WGHT-UM-CDE     PIC  X(02)    VALUE SPACES.  06070002
060800     05  PV-CURR-SKU.                                             06080002
060900         10  PV-CURR-DEPT            PIC  X(03)    VALUE SPACES.  06090002
061000         10  PV-CURR-CLASS           PIC  X(02)    VALUE SPACES.  06100002
061100         10  PV-CURR-SEQ             PIC  X(03)    VALUE SPACES.  06110002
061200     05  PV-RPT-SKU-DESC.                                         06120002
061300         10  PV-RPT-SKU-CLR          PIC  X(06)    VALUE SPACES.  06130002
061400         10  FILLER                  PIC  X(01)    VALUE '/'.     06140002
061500         10  PV-RPT-SKU-SIZE         PIC  X(06)    VALUE SPACES.  06150002
061600         10  FILLER                  PIC  X(01)    VALUE '/'.     06160002
061700         10  PV-RPT-SKU-STYLE        PIC  X(06)    VALUE SPACES.  06170002
061800     05  PV-PROCESS-DATE.                                         06180002
061900         10  PV-PROCESS-DATE-CENT    PIC  X(02).                  06190002
062000         10  PV-PROCESS-DATE-YY      PIC  X(02).                  06200002
062100         10  FILLER                  PIC  X(01) VALUE '-'.        06210002
062200         10  PV-PROCESS-DATE-MM      PIC  X(02).                  06220002
062300         10  FILLER                  PIC  X(01) VALUE '-'.        06230002
062400         10  PV-PROCESS-DATE-DD      PIC  X(02).                  06240002
062500     05  PV-PROCESS-DATE-R REDEFINES PV-PROCESS-DATE              06250002
062600                                     PIC X(10).                   06260002
062700     05  PV-TODAYS-DAY               PIC  9(01)    VALUE ZERO.    06270002
062800     05  PV-TODAYS-DATE.                                          06280002
062900         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    06290002
063000         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    06300002
063100         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    06310002
063200     05  PV-MMDDYY.                                               06320002
063300         10  PV-MM                   PIC  9(02)    VALUE ZERO.    06330002
063400         10  PV-DD                   PIC  9(02)    VALUE ZERO.    06340002
063500         10  PV-YY                   PIC  9(02)    VALUE ZERO.    06350002
063600     05  PV-CUR-DATE-10.                                          06360002
063700         10  PV-CUR-CC               PIC  X(02)    VALUE SPACES.  06370002
063800         10  PV-CUR-YY               PIC  X(02)    VALUE SPACES.  06380002
063900         10  PV-DASH1                PIC  X(01)    VALUE '-'.     06390002
064000         10  PV-CUR-MM               PIC  X(02)    VALUE SPACES.  06400002
064100         10  PV-DASH2                PIC  X(01)    VALUE '-'.     06410002
064200         10  PV-CUR-DD               PIC  X(02)    VALUE SPACES.  06420002
064300     05  PV-CENTURY-DATE-MMDDCCYY.                                06430002
064400         10  PV-CENTURY-DATE-MM      PIC  9(02)    VALUE ZERO.    06440002
064500         10  PV-CENTURY-DATE-DD      PIC  9(02)    VALUE ZERO.    06450002
064600         10  PV-CENTURY-DATE-CCYY    PIC  9(04)    VALUE ZERO.    06460002
064700     05  PV-YYMMDD                   PIC  9(06)    VALUE ZERO.    06470002
064800     05  PV-RPT-END-DATE             PIC  9(06)    VALUE ZERO.    06480002
064900     05  PV-RPT-START-DATE.                                       06490002
065000         10  PV-RPT-START-YY         PIC  9(02)    VALUE ZERO.    06500002
065100         10  PV-RPT-START-MM         PIC  9(02)    VALUE ZERO.    06510002
065200         10  PV-RPT-START-DD         PIC  9(02)    VALUE ZERO.    06520002
065300     05  PV-RPT-DATE.                                             06530002
065400         10  PV-RPT-MONTH            PIC  X(09)    VALUE SPACES.  06540002
065500         10  FILLER                  PIC  X(02)    VALUE ', '.    06550002
065600         10  PV-RPT-DD               PIC  9(02)    VALUE ZERO.    06560002
065700         10  FILLER                  PIC  X(02)    VALUE ', '.    06570002
065800         10  PV-RPT-CENTURY          PIC  9(02)    VALUE ZERO.    06580002
065900         10  PV-RPT-YY               PIC  9(02)    VALUE ZERO.    06590002
066000     05  PV-TODAYS-TIME.                                          06600002
066100         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    06610002
066200         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    06620002
066300         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    06630002
066400         10  FILLER                  PIC  9(02)    VALUE ZERO.    06640002
066500     05  PV-SKU.                                                  06650002
066600         10  PV-DEPT                 PIC  X(03)    VALUE SPACES.  06660002
066700         10  FILLER                  PIC  X(01)    VALUE '-'.     06670002
066800         10  PV-CLASS                PIC  X(02)    VALUE SPACES.  06680002
066900         10  FILLER                  PIC  X(01)    VALUE '-'.     06690002
067000         10  PV-SEQ                  PIC  X(03)    VALUE SPACES.  06700002
067100     05  PV-PRINT-LINE               PIC X(132)    VALUE SPACES.  06710002
067200     05  PV-UNPK-PONUMB              PIC  9(08)    VALUE ZEROS.   06720002
067300     05  PV-INTEGER-PO-NBR           PIC S9(09)    COMP           06730002
067400                                                   VALUE ZERO.    06740002
067500     05  PV-INTEGER-PO-LNE-NBR       PIC S9(09)    COMP           06750002
067600                                                   VALUE ZERO.    06760002
067700     05  PV-RECIP-CDE-HOLD           PIC X(02)     VALUE SPACES.  06770002
067800     05  PV-ASNCAR-REDEF.                                         06780002
067900         10  PV-ASNCAR-FIRST-2       PIC  X(02)    VALUE SPACES.  06790002
068000         10  PV-ASNCAR-3-20          PIC  X(18)    VALUE SPACES.  06800002
068100         10  PV-ASNCAR-21-40         PIC  X(20)    VALUE SPACES.  06810002
068200     05  PV-DETAIL-CARTON.                                        06820002
068300         10  PV-DETAIL-KEY.                                       06830002
068400             15  FILLER              PIC  X(66).                  06840002
068500             15  PV-SEQUENCE-NUMBER  PIC  9(07).                  06850002
068600             15  PV-CARTON-IND       PIC  X(01).                  06860002
068700         10  PV-DETAIL-COMMON        PIC  X(86).                  06870002
068800         10  FILLER                  PIC  X(40)     VALUE SPACES. 06880002
068900         10  PV-DETAIL-CARTON-LAYOUT.                             06890002
069000             15  PV-CARTON-TABLE OCCURS 10 TIMES.                 06900002
069100                 20  PV-CARTON-NBR      PIC S9(18)  COMP-3.       06910002
069200                 20  PV-CARTON-QTY      PIC S9(09)  COMP-3.       06920002
069300                 20  PV-CTN-UPC         PIC S9(15)  COMP-3.       06930002
069400                 20  PV-CARTON-FIL      PIC  X(07).               06940002
069500             15  PV-CARTON-FILLER       PIC  X(100).              06950002
069600     05  PV-DC-STR-CHECK                PIC S9(04)  VALUE 0 COMP. 06960002
069700     05  PV-DONT-SHIP-BEF-DATE          PIC  X(10)  VALUE SPACES. 06970002
069800     05  PV-CURRENT-DATE                PIC  X(10)  VALUE SPACES. 06980002
069900     05  PV-DIST-CTR-NBR                PIC  9(04)  VALUE 0.      06990002
070000     05  PV-DIST-CTR-NAME               PIC  X(25)  VALUE SPACES. 07000002
070100     05  PV-SHIP-NBR                    PIC  9(04)  VALUE 0.      07010002
070200     05  PV-SHIP-NAME                   PIC  X(25)  VALUE SPACES. 07020002
070300     05  PV-ORD-NBR                     PIC  9(04)  VALUE 0.      07030002
070400     05  PV-ORD-NAME                    PIC  X(25)  VALUE SPACES. 07040002
070410     05  PV-DISPLAY-ASNHDR              PIC  X(30)  VALUE SPACES. 07041002
070420     05  PV-DISPLAY-EDI-VEND            PIC  X(09)  VALUE SPACES. 07042002
070430     05  PV-DISPLAY-PARTNER             PIC  X(15)  VALUE SPACES. 07043002
070440     05  PV-DISPLAY-PARTNER-ID          PIC  X(02)  VALUE SPACES. 07044002
070441     05  PV-DISPLAY-PARTNER-ASN         PIC  X(30)  VALUE SPACES. 07044111
070450*----------------------------------------------------------------*07045002
070460* ADDED NEW VARIABLES                          ** WR # 230ZZ     *07046002
070470*----------------------------------------------------------------*07047002
070480     05  PV-ABEND-230ZZ.                                          07048002
070490         10  PV-ABEND-MESSAGE-TEXT   PIC  X(40)    VALUE SPACES.  07049002
070500         10  PV-SQLCODE              PIC  S9(9)    VALUE ZEROES.  07050002
070600         10  PV-DB2-VIEW-NAME        PIC  X(10)    VALUE SPACES.  07060002
070700     05  PV-UNIT-COST-AMT            PIC  S9(7)V9(3) COMP-3       07070002
070800                                          VALUE ZEROES.           07080002
070900     05  PV-CUR-UNIT-RTL-AMT         PIC  S9(7)V9(2) COMP-3       07090002
071000                                          VALUE ZEROES.           07100002
071100     05  PV-SEQ-NMBR                 PIC  S9(8)V COMP-3           07110002
071200                                          VALUE ZEROES.           07120002
071300     05  PV-SEQ-NMBR-TEMP            PIC  9(8)                    07130002
071400                                          VALUE ZEROES.           07140002
071500     05  PV-VNDR-INNR-PACK-QTY       PIC S9(09)  COMP-3           07150002
071600                                          VALUE ZEROES.           07160002
071700     05  PV-SKU-DESC                 PIC  X(30)    VALUE SPACES.  07170002
071800     05  PV-SIZE-DESC                PIC  X(10)    VALUE SPACES.  07180002
071900     05  PV-VENDOR-STYLE-CODE        PIC  X(20)    VALUE SPACES.  07190002
072000     05  PV-COLOR-DESC               PIC  X(10)    VALUE SPACES.  07200002
072100     05  PV-MERCH-DEPT-NMBR          PIC  X(3)     VALUE SPACES.  07210002
072200     05  PV-MERCH-CLASS-NMBR         PIC  X(02)    VALUE SPACES.  07220002
072300     05  PV-H2-DEPT-TEMP             PIC  S9(4)V COMP-3.          07230002
072400     05  PV-H2-DEPT-TEMP-9           PIC  9(03).                  07240002
072410     05  PV-PREV-PARTNER-ID          PIC X(15)  VALUE SPACES.     07241007
072420     05  PV-ELEM-PARTNER-ID          PIC X(15)  VALUE SPACES.     07242007
072430     05  PV-ELEM-ALT-ENT-ID          PIC S9(10)V9(5) COMP-3       07243007
072440                                                VALUE ZEROS.      07244007
072500*----------------------------------------------------------------*07250002
072600* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *07260002
072700*----------------------------------------------------------------*07270002
072800                                                                  07280002
072900 EJECT                                                            07290002
073000     COPY DPWS024.                                                07300002
073100 EJECT                                                            07310002
073200*                                                                 07320002
073300*    NUMERIC EDIT LAYOUT                                          07330002
073400*                                                                 07340002
073500     COPY DPWS010I.                                               07350002
073600 EJECT                                                            07360002
073700                                                                  07370002
073800*--------------------------------------                           07380002
073900*    COPYBOOK FOR LOCATION CALL MODULE                            07390002
074000*--------------------------------------                           07400002
074100     COPY XLWS071.                                                07410002
074200                                                                  07420002
074300 EJECT                                                            07430002
074400*----------------------------------------------------------------*07440002
074500*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 230ZZ  *07450002
074600*----------------------------------------------------------------*07460002
074700     COPY XLWS001.                                                07470002
074800*----------------------------------------------------------------*07480002
074900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *07490002
075000*----------------------------------------------------------------*07500002
075100*                                                                 07510002
075200*    ASN TRANSCRIPTION FILE LAYOUT                                07520002
075300*                                                                 07530002
075400     COPY RCRD001.                                                07540002
075500*                                                                 07550002
075600*    ASN CARTON ERROR FILE LAYOUT                                 07560002
075700*                                                                 07570002
075800     COPY RCRD016.                                                07580002
075900 EJECT                                                            07590002
076000*                                                                 07600002
076100 01  PV-HEADING-LINES.                                            07610002
076200     05  PV-HEAD-0.                                               07620002
076300         10  PV-H0-TEST-IND            PIC X(08)   VALUE SPACES.  07630002
076400         10  FILLER                    PIC X(02)   VALUE SPACES.  07640002
076500         10  FILLER                    PIC X(41)   VALUE          07650002
076600             'EDI ADVANCE SHIPMENT NOTIFICATION - ASN: '.         07660002
076700         10  PV-H0-ASN-NBR             PIC X(27)   VALUE SPACES.  07670002
076800         10  FILLER                    PIC X(02)   VALUE SPACES.  07680002
076900         10  FILLER                    PIC X(11)   VALUE          07690002
077000             'PO NUMBER: '.                                       07700002
077100         10  PV-H0-PO-NBR              PIC X(12)   VALUE SPACES.  07710002
077200         10  FILLER                    PIC X(02)   VALUE SPACES.  07720002
077300         10  FILLER                    PIC X(14)   VALUE          07730002
077400             'DATE SHIPPED: '.                                    07740002
077500         10  PV-H0-DATE-SHIPPED.                                  07750002
077600             15  PV-H0-DS-MM           PIC X(02)   VALUE SPACES.  07760002
077700             15  FILLER                PIC X(01)   VALUE '/'.     07770002
077800             15  PV-H0-DS-DD           PIC X(02)   VALUE SPACES.  07780002
077900             15  FILLER                PIC X(01)   VALUE '/'.     07790002
078000             15  PV-H0-DS-CCYY         PIC X(04)   VALUE SPACES.  07800002
078100         10  FILLER                    PIC X(04)   VALUE SPACES.  07810002
078200*                                                                 07820002
078300     05  PV-HEAD-1.                                               07830002
078400         10  FILLER                    PIC X(12)   VALUE          07840002
078500             'DEPARTMENT: '.                                      07850002
078600         10  PV-H1-DEPT                PIC X(03)   VALUE SPACES.  07860002
078700         10  FILLER                    PIC X(01)   VALUE SPACES.  07870002
078800         10  PV-H1-DEPT-DESC           PIC X(25)   VALUE SPACES.  07880002
078900         10  FILLER                    PIC X(05)   VALUE SPACES.  07890002
079000         10  FILLER                    PIC X(15)   VALUE          07900002
079100             'PO DATE:       '.                                   07910002
079200         10  PV-H1-PO-DATE.                                       07920002
079300             15  PV-H1-PD-MM           PIC X(02)   VALUE SPACES.  07930002
079400             15  PV-H1-PD-SLASH1       PIC X(01)   VALUE '/'.     07940002
079500             15  PV-H1-PD-DD           PIC X(02)   VALUE SPACES.  07950002
079600             15  PV-H1-PD-SLASH2       PIC X(01)   VALUE '/'.     07960002
079700             15  PV-H1-PD-YY           PIC X(02)   VALUE SPACES.  07970002
079800         10  FILLER                    PIC X(11)   VALUE SPACES.  07980002
079900         10  FILLER                    PIC X(16)   VALUE          07990002
080000             'BILL OF LADING: '.                                  08000002
080100         10  PV-H1-BILL-OF-LADING      PIC X(30)   VALUE SPACES.  08010002
080200         10  FILLER                    PIC X(06)   VALUE SPACES.  08020002
080300*                                                                 08030002
080400     05  PV-HEAD-2.                                               08040002
080500         10  FILLER                    PIC X(07)   VALUE          08050002
080600             'BUYER: '.                                           08060002
080700         10  PV-H2-BUYER-ID            PIC 9(03)   VALUE ZEROS.   08070002
080800         10  PV-H2-BUYER-ID-X  REDEFINES                          08080002
080900             PV-H2-BUYER-ID            PIC X(03).                 08090002
081000         10  FILLER                    PIC X(02)   VALUE SPACES.  08100002
081100         10  PV-H2-BUYER               PIC X(32)   VALUE SPACES.  08110002
081200         10  FILLER                    PIC X(02)   VALUE SPACES.  08120002
081300         10  FILLER                    PIC X(15)   VALUE          08130002
081400             'REQ SHIP DATE: '.                                   08140002
081500         10  PV-H2-REQ-SHIP-DATE.                                 08150002
081600             15  PV-H2-RSD-MM          PIC X(02)   VALUE SPACES.  08160002
081700             15  PV-H2-RSD-SLASH1      PIC X(01)   VALUE '/'.     08170002
081800             15  PV-H2-RSD-DD          PIC X(02)   VALUE SPACES.  08180002
081900             15  PV-H2-RSD-SLASH2      PIC X(01)   VALUE '/'.     08190002
082000             15  PV-H2-RSD-YY          PIC X(02)   VALUE SPACES.  08200002
082100         10  FILLER                    PIC X(11)   VALUE SPACES.  08210002
082200         10  FILLER                    PIC X(16)   VALUE          08220002
082300             'CARRIER NAME:   '.                                  08230002
082400         10  PV-H2-CARRIER-NAME        PIC X(35)   VALUE SPACES.  08240002
082500         10  FILLER                    PIC X(01)   VALUE SPACES.  08250002
082600*                                                                 08260002
082700     05  PV-HEAD-3.                                               08270002
082800         10  FILLER                    PIC X(12)   VALUE          08280002
082900             'ANALYST:'.                                          08290002
083000         10  PV-H3-ANALYST             PIC X(32)   VALUE SPACES.  08300002
083100         10  FILLER                    PIC X(02)   VALUE SPACES.  08310002
083200         10  FILLER                    PIC X(15)   VALUE          08320002
083300             'CANCEL DATE:   '.                                   08330002
083400         10  PV-H3-CANCEL-DATE.                                   08340002
083500             15  PV-H3-CD-MM           PIC X(02)   VALUE SPACES.  08350002
083600             15  PV-H3-CD-SLASH1       PIC X(01)   VALUE '/'.     08360002
083700             15  PV-H3-CD-DD           PIC X(02)   VALUE SPACES.  08370002
083800             15  PV-H3-CD-SLASH2       PIC X(01)   VALUE '/'.     08380002
083900             15  PV-H3-CD-YY           PIC X(02)   VALUE SPACES.  08390002
084000         10  FILLER                    PIC X(11)   VALUE SPACES.  08400002
084100         10  FILLER                    PIC X(16)   VALUE          08410002
084200             'PRO NUMBER:     '.                                  08420002
084300         10  PV-H3-PRO-NUMBER          PIC X(30)   VALUE SPACES.  08430002
084400         10  FILLER                    PIC X(06)   VALUE SPACES.  08440002
084500*                                                                 08450002
084600     05  PV-HEAD-4.                                               08460002
084700         10  FILLER                    PIC X(12)   VALUE          08470002
084800             'VENDOR:'.                                           08480002
084900         10  PV-H1-VENDOR-NAME         PIC X(25)   VALUE SPACES.  08490002
085000         10  FILLER                    PIC X(09)   VALUE SPACES.  08500002
085100         10  FILLER                    PIC X(15)   VALUE          08510002
085200             'CANCEL DATE:   '.                                   08520002
085300         10  PV-H4-CAN-EXT-DATE.                                  08530002
085400             15  PV-H4-ED-MM           PIC X(02)   VALUE SPACES.  08540002
085500             15  PV-H4-ED-SLASH1       PIC X(01)   VALUE '/'.     08550002
085600             15  PV-H4-ED-DD           PIC X(02)   VALUE SPACES.  08560002
085700             15  PV-H4-ED-SLASH2       PIC X(01)   VALUE '/'.     08570002
085800             15  PV-H4-ED-YY           PIC X(02)   VALUE SPACES.  08580002
085900         10  FILLER                    PIC X(11)   VALUE SPACES.  08590002
086000         10  FILLER                    PIC X(18)   VALUE          08600002
086100             'TRAILER NUMBER:   '.                                08610002
086200         10  PV-H4-EQUIP-INIT-CDE      PIC X(03)   VALUE SPACES.  08620002
086300         10  FILLER                    PIC X(01)   VALUE SPACES.  08630002
086400         10  PV-H4-EQUIP-NBR           PIC X(07)   VALUE SPACES.  08640002
086500         10  FILLER                    PIC X(23)   VALUE SPACES.  08650002
086600*                                                                 08660002
086700     05  PV-HEAD-5.                                               08670002
086800         10  FILLER                    PIC X(46)   VALUE SPACES.  08680002
086900         10  FILLER                    PIC X(15)   VALUE          08690002
087000             'AD DATE:       '.                                   08700002
087100         10  PV-H5-AD-DATE.                                       08710002
087200             15  PV-H5-AD-MM           PIC X(02)   VALUE SPACES.  08720002
087300             15  PV-H5-AD-SLASH1       PIC X(01)   VALUE '/'.     08730002
087400             15  PV-H5-AD-DD           PIC X(02)   VALUE SPACES.  08740002
087500             15  PV-H5-AD-SLASH2       PIC X(01)   VALUE '/'.     08750002
087600             15  PV-H5-AD-YY           PIC X(02)   VALUE SPACES.  08760002
087700         10  FILLER                    PIC X(11)   VALUE SPACES.  08770002
087800         10  FILLER                    PIC X(17)   VALUE          08780002
087900             'SHIPMENT WEIGHT: '.                                 08790002
088000         10  PV-H5-SHIP-WEIGHT         PIC ZZZ,ZZZ,ZZ9.99         08800002
088100                                                   VALUE ZEROS.   08810002
088200         10  FILLER                    PIC X(01)   VALUE SPACES.  08820002
088300         10  PV-H5-UNIT-MEASURE        PIC X(02)   VALUE SPACES.  08830002
088400         10  FILLER                    PIC X(18)   VALUE SPACES.  08840002
088500                                                                  08850002
088600     05  PV-HEAD-5A.                                              08860002
088700*        10  FILLER                    PIC X(46)   VALUE SPACES.  08870002
088800         10  FILLER                    PIC X(17)   VALUE          08880002
088900             'PACKSLIP CREATE: '.                                 08890002
089000         10  PV-H5A-ASN-TRSCP-IND      PIC X(01)   VALUE SPACE.   08900002
089100         10  FILLER                    PIC X(28)   VALUE SPACES.  08910002
089200         10  FILLER                    PIC X(21)   VALUE          08920002
089300             'SHIP DIRECT TO STORE:'.                             08930002
089400         10  FILLER                    PIC X(01)   VALUE SPACE.   08940002
089500         10  PV-DIR-TO-STORE-IND       PIC X(01)   VALUE SPACE.   08950002
089600         10  FILLER                    PIC X(11)   VALUE SPACES.  08960002
089700         10  FILLER                    PIC X(12)   VALUE          08970002
089800             'MAN SEGMENT:'.                                      08980002
089900         10  FILLER                    PIC X(04)   VALUE SPACE.   08990002
090000         10  PV-MAN-SEGMENT-IND        PIC X(01)   VALUE SPACE.   09000002
090100         10  FILLER                    PIC X(35)   VALUE SPACES.  09010002
090200                                                                  09020002
090300     05  PV-HEAD-5B.                                              09030002
090400*        10  FILLER                    PIC X(46)   VALUE SPACES.  09040002
090500         10  FILLER                    PIC X(17)   VALUE          09050002
090510             'CARTON BUILD   : '.                                 09051002
090520         10  PV-H5B-CART-LBL-IND       PIC X(01)   VALUE SPACE.   09052002
090530         10  FILLER                    PIC X(28)   VALUE SPACES.  09053002
090540         10  FILLER                    PIC X(21)   VALUE          09054002
090550             'PACK BY STORE:       '.                             09055002
090560         10  FILLER                    PIC X(01)   VALUE SPACE.   09056002
090570         10  PV-PACK-BY-STORE-IND      PIC X(01)   VALUE SPACE.   09057002
090580         10  FILLER                    PIC X(11)   VALUE SPACE.   09058002
090590         10  FILLER                    PIC X(08)   VALUE          09059002
090600             'EDI IND:'.                                          09060002
090700         10  FILLER                    PIC X(08)   VALUE SPACE.   09070002
090800         10  PV-EDI-IND                PIC X(01)   VALUE SPACE.   09080002
090900         10  FILLER                    PIC X(35)   VALUE SPACES.  09090002
091000                                                                  09100002
091100     05  PV-HEAD-5C.                                              09110002
091200         10  FILLER                    PIC X(46)   VALUE SPACES.  09120002
091300         10  FILLER                    PIC X(21)   VALUE          09130002
091400             'NEW STORE PO:        '.                             09140002
091500         10  FILLER                    PIC X(01)   VALUE SPACE.   09150002
091600         10  PV-NEW-STORE-PO-IND       PIC X(01)   VALUE SPACE.   09160002
091700         10  FILLER                    PIC X(11)   VALUE SPACES.  09170002
091800         10  FILLER                    PIC X(10)   VALUE          09180002
091900             'SCAC CODE:'.                                        09190002
092000         10  FILLER                    PIC X(06)   VALUE SPACE.   09200002
092100         10  PV-SCAC-CODE              PIC X(17)   VALUE SPACE.   09210002
092200         10  FILLER                    PIC X(19)   VALUE SPACES.  09220002
092300                                                                  09230002
092400*                                                                 09240002
092500     05  PV-HEAD-6.                                               09250002
092600         10  FILLER                    PIC X(14)   VALUE          09260002
092700             'DIST CENTER:  '.                                    09270002
092800         10  PV-H6-DC-UNKN.                                       09280002
092900             15  PV-H6-DC-UNKNOWN      PIC X(07).                 09290002
093000             15  FILLER                PIC X(13).                 09300002
093100         10  PV-H6-DC-ID REDEFINES PV-H6-DC-UNKN.                 09310002
093200             15  PV-H6-DC-NBR          PIC 9999.                  09320002
093300             15  FILLER                PIC X.                     09330002
093400             15  PV-H6-DC-NAME         PIC X(15).                 09340002
093500         10  FILLER                    PIC X.                     09350002
093600         10  PV-H6-ASTERISK            PIC X.                     09360002
093700         10  PV-H6-MESSAGE             PIC X(19).                 09370002
093800         10  FILLER                    PIC X(77)   VALUE SPACES.  09380002
093900*                                                                 09390002
094000     05  PV-HEAD-7.                                               09400002
094100         10  PV-H7-SEQ-NBR-IND         PIC X(14)   VALUE SPACES.  09410002
094200         10  PV-H7-SEQ-NBR             PIC 9(4)    VALUE 0.       09420002
094300         10  FILLER                    PIC X       VALUE SPACES.  09430002
094400         10  PV-H7-STORE-NAME          PIC X(25)   VALUE SPACES.  09440002
094500         10  FILLER                    PIC X.                     09450002
094600         10  PV-H7-ASTERISK            PIC X.                     09460002
094700         10  PV-H7-MESSAGE             PIC X(19).                 09470002
094800         10  FILLER                    PIC X(66)   VALUE SPACES.  09480002
094900*                                                                 09490002
095000     05  PV-HEAD-8.                                               09500002
095100         10  FILLER                    PIC X(26)   VALUE          09510002
095200             'TOTAL CARTONS FOR STORE: '.                         09520002
095300         10  PV-H8-TOTAL-CARTONS-STORE PIC  ZZZZ,ZZ9              09530002
095400                                                   VALUE ZEROS.   09540002
095500         10  PV-H8-TOTAL-CARTONS-STORE-X REDEFINES                09550002
095600                                     PV-H8-TOTAL-CARTONS-STORE    09560002
095700                                       PIC X(08).                 09570002
095800         10  FILLER                    PIC X(13)   VALUE SPACES.  09580002
095900         10  FILLER                    PIC X(23)   VALUE          09590002
096000             'TOTAL CARTONS FOR PO: '.                            09600002
096100         10  PV-H8-TOTAL-CARTONS-PO    PIC ZZZZ,ZZ9               09610002
096200                                                   VALUE ZEROS.   09620002
096300         10  PV-H8-TOTAL-CARTONS-PO-X REDEFINES                   09630002
096400                                     PV-H8-TOTAL-CARTONS-PO       09640002
096500                                       PIC X(08).                 09650002
096600         10  FILLER                    PIC X(04)   VALUE SPACES.  09660002
096700         10  FILLER                    PIC X(29)   VALUE          09670002
096800             'TOTAL CARTONS FOR SHIPMENT: '.                      09680002
096900         10  PV-H8-TOTAL-CARTONS-SHPMT PIC ZZZZ,ZZ9               09690002
097000                                                   VALUE ZEROS.   09700002
097100         10  PV-H8-TOTAL-CARTONS-SHPMT-X REDEFINES                09710002
097200                                     PV-H8-TOTAL-CARTONS-SHPMT    09720002
097300                                       PIC X(08).                 09730002
097400         10  FILLER                    PIC X(16)   VALUE SPACES.  09740002
097500*                                                                 09750002
097600     05  PV-HEAD-9.                                               09760002
097700         10  FILLER                    PIC X(22)   VALUE          09770002
097800             'SPECIAL INSTRUCTIONS: '.                            09780002
097900         10  PV-H9-SI-1                PIC X(25)   VALUE SPACES.  09790002
098000         10  FILLER                    PIC X(01)   VALUE SPACES.  09800002
098100         10  PV-H9-SI-2                PIC X(25)   VALUE SPACES.  09810002
098200         10  FILLER                    PIC X(01)   VALUE SPACES.  09820002
098300         10  PV-H9-SI-3                PIC X(25)   VALUE SPACES.  09830002
098400         10  FILLER                    PIC X(33)   VALUE SPACES.  09840002
098500*                                                                 09850002
098600     05  INSTR-RECIP-LINE.                                        09860002
098700         10  FILLER                    PIC  X(13) VALUE           09870002
098800                                      '  RECIPIENT: '.            09880002
098900         10  INSTR-RECIP               PIC  X(15).                09890002
099000         10  FILLER                    PIC  X(122) VALUE SPACES.  09900002
099100                                                                  09910002
099200     05  INSTR-LINE.                                              09920002
099300         10  INSTR-DESC                PIC  X(150).               09930002
099400                                                                  09940002
099500*                                                                 09950002
099600     05  PV-HEAD-10.                                              09960002
099700         10  FILLER                    PIC X(16)   VALUE          09970002
099800             'GENERAL ERRORS: '.                                  09980002
099900         10  PV-H10-GE-1               PIC X(25)   VALUE SPACES.  09990002
100000         10  FILLER                    PIC X(01)   VALUE SPACES.  10000002
100100         10  PV-H10-GE-2               PIC X(30)   VALUE SPACES.  10010002
100200         10  FILLER                    PIC X(60)   VALUE SPACES.  10020002
100300*                                                                 10030002
100400     05  PV-BLANK-LINE                 PIC X(132)  VALUE SPACES.  10040002
100500     05  DC-NBR                        PIC X(3)    VALUE SPACES.  10050002
100600     05  DC-NAME                       PIC X(25)   VALUE SPACES.  10060002
100700 EJECT                                                            10070002
100800*                                                                 10080002
100900 01  PV-DETAIL-HEADINGS.                                          10090002
101000     05  PV-DETAIL-HEADING-1.                                     10100002
101100         10  FILLER                    PIC X(02)   VALUE SPACES.  10110002
101200         10  FILLER                    PIC X(8)    VALUE 'PO'.    10120002
101300         10  FILLER                    PIC X(9)    VALUE 'SKU'.   10130002
101400         10  FILLER                    PIC X(15)   VALUE          10140002
101500             'UPC NUMBER'.                                        10150002
101600         10  FILLER                    PIC X(17)   VALUE SPACES.  10160002
101700         10  FILLER                    PIC X(14)   VALUE 'SIZE/'. 10170002
101800         10  FILLER                    PIC X(11)   VALUE 'UNIT'.  10180002
101900         10  FILLER                    PIC X(11)   VALUE 'UNIT'.  10190002
102000         10  FILLER                    PIC X(12)   VALUE          10200002
102100             'DOLLARS'.                                           10210002
102200         10  FILLER                    PIC X(10)   VALUE          10220002
102300             'DOLLARS'.                                           10230002
102400         10  FILLER                    PIC X(12)   VALUE 'QTY'.   10240002
102500         10  FILLER                    PIC X(07)   VALUE 'QTY'.   10250002
102600*                                                                 10260002
102700     05  PV-DETAIL-HEADING-2.                                     10270002
102800         10  FILLER                    PIC X(01)   VALUE SPACES.  10280002
102900         10  FILLER                    PIC X(08)   VALUE 'LINE'.  10290002
103000         10  FILLER                    PIC X(10)   VALUE 'ISA #'. 10300002
103100         10  FILLER                    PIC X(15)   VALUE          10310002
103200             'DESCRIPTION'.                                       10320002
103300         10  FILLER                    PIC X(03)   VALUE SPACES.  10330002
103400         10  FILLER                    PIC X(14)   VALUE          10340002
103500             'VENDOR STYLE'.                                      10350002
103600         10  FILLER                    PIC X(14)   VALUE 'COLOR'. 10360002
103700         10  FILLER                    PIC X(10)   VALUE 'COST'.  10370002
103800         10  FILLER                    PIC X(12)   VALUE 'RETAIL'.10380002
103900         10  FILLER                    PIC X(12)   VALUE          10390002
104000             'ORDERED'.                                           10400002
104100         10  FILLER                    PIC X(08)   VALUE          10410002
104200             'SHIPPED'.                                           10420002
104300         10  FILLER                    PIC X(08)   VALUE          10430002
104400             'ORDERED'.                                           10440002
104500         10  FILLER                    PIC X(04)   VALUE 'UM'.    10450002
104600         10  FILLER                    PIC X(08)   VALUE          10460002
104700             'SHIPPED'.                                           10470002
104800         10  FILLER                    PIC X(03)   VALUE 'UM'.    10480002
104900 EJECT                                                            10490002
105000*                                                                 10500002
105100*----------------------------------------------------------------*10510002
105200*  INCREASED LENGTH OF SEQ AND CHANGED THE STRUCTURE WR # 230ZZ  *10520002
105300*----------------------------------------------------------------*10530002
105400 01  PV-DETAIL-LINES.                                             10540002
105500     05  PV-DETAIL-LINE1.                                         10550002
105600         10  FILLER                    PIC X(01)   VALUE SPACES.  10560002
105700         10  PV-DL1-PO-LINE            PIC X(03)   VALUE SPACES.  10570002
105800         10  FILLER                    PIC X(02)   VALUE SPACES.  10580002
105900         10  PV-DL1-SKU.                                          10590002
106000             15  PV-DL1-CLASS.                                    10600002
106100                 20  PV-DL1-CLASS-1    PIC X(01)   VALUE SPACES.  10610002
106200                 20  PV-DL1-CLASS-2    PIC X(01)   VALUE SPACES.  10620002
106300             15  PV-DL1-DASH           PIC X(01)   VALUE ' '.     10630002
106400             15  PV-DL1-SEQ            PIC X(08)   VALUE SPACES.  10640002
106500         10  FILLER                    PIC X(01)   VALUE SPACES.  10650002
106600         10  PV-DL1-UPC-NBR.                                      10660002
106700             15  PV-DL1-UPC-NBR-1      PIC X(01)   VALUE SPACES.  10670002
106800             15  PV-DL1-UPC-DASH1      PIC X(01)   VALUE '-'.     10680002
106900             15  PV-DL1-UPC-NBR-2-9    PIC X(08)   VALUE SPACES.  10690002
107000             15  PV-DL1-UPC-DASH2      PIC X(01)   VALUE '-'.     10700002
107100             15  PV-DL1-UPC-NBR-10-14  PIC X(05)   VALUE SPACES.  10710002
107200             15  PV-DL1-UPC-DASH3      PIC X(01)   VALUE '-'.     10720002
107300             15  PV-DL1-UPC-NBR-15     PIC X(01)   VALUE SPACES.  10730002
107400         10  FILLER                    PIC X(01)   VALUE SPACES.  10740002
107500         10  PV-DL1-VENDOR-STYLE       PIC X(12)   VALUE SPACES.  10750002
107600         10  FILLER                    PIC X(01)   VALUE SPACES.  10760002
107700         10  PV-DL1-SIZE               PIC X(10)   VALUE SPACES.  10770002
107800         10  FILLER                    PIC X(01)   VALUE SPACES.  10780002
107900         10  PV-DL1-UNIT-COST          PIC ZZZZZZZ.99             10790002
108000                                                   VALUE ZEROS.   10800002
108100         10  FILLER                    PIC X(01)   VALUE SPACES.  10810002
108200         10  PV-DL1-UNIT-RETAIL        PIC ZZZZZZZ.99             10820002
108300                                                   VALUE ZEROS.   10830002
108400         10  FILLER                    PIC X(01)   VALUE SPACES.  10840002
108500         10  PV-DL1-DOL-ORDERED        PIC ZZZZZZZZ.99            10850002
108600                                                   VALUE ZEROS.   10860002
108700         10  FILLER                    PIC X(01)   VALUE SPACES.  10870002
108800         10  PV-DL1-DOL-SHIPPED        PIC ZZZZZZZZ.99            10880002
108900                                                   VALUE ZEROS.   10890002
109000         10  FILLER                    PIC X(01)   VALUE SPACES.  10900002
109100         10  PV-DL1-QTY-ORDERED        PIC ZZZZZZ9 VALUE ZEROS.   10910002
109200         10  FILLER                    PIC X(01)   VALUE SPACES.  10920002
109300         10  PV-DL1-UNIT-MSR-1         PIC X(03)   VALUE SPACES.  10930002
109400         10  FILLER                    PIC X(01)   VALUE SPACES.  10940002
109500         10  PV-DL1-QTY-SHIPPED        PIC ZZZZZZ9 VALUE ZEROS.   10950002
109600         10  FILLER                    PIC X(01)   VALUE SPACES.  10960002
109700         10  PV-DL1-UNIT-MSR-2         PIC X(02)   VALUE SPACES.  10970002
109800         10  FILLER                    PIC X(01)   VALUE SPACES.  10980002
109900*----------------------------------------------------------------*10990002
110000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *11000002
110100*----------------------------------------------------------------*11010002
110200*                                                                 11020002
110300     05  PV-DETAIL-LINE2.                                         11030002
110400         10  FILLER                    PIC X(7)    VALUE SPACES.  11040002
110500         10  PV-DL2-ISA-NBR            PIC X(9)    VALUE SPACES.  11050002
110600         10  FILLER                    PIC X(3)    VALUE SPACES.  11060002
110700         10  PV-DL2-UPC-DESCRIPTION    PIC X(25)   VALUE SPACES.  11070002
110800         10  FILLER                    PIC X(06)   VALUE SPACES.  11080002
110900         10  PV-DL2-COLOR              PIC X(10)   VALUE SPACES.  11090002
111000         10  FILLER                    PIC X(72)   VALUE SPACES.  11100002
111100*                                                                 11110002
111200 EJECT                                                            11120002
111300*                                                                 11130002
111400*** PRINT LINES FOR TOTALS                                        11140002
111500*                                                                 11150002
111600 01  PV-DETAIL-TOTAL-HEADING-LINES.                               11160002
111700     05  PV-DETAIL-TTL-DASHES-1.                                  11170002
111800         10  FILLER                    PIC X(83)   VALUE SPACES.  11180002
111900         10  FILLER                    PIC X(11)   VALUE          11190002
112000             '-----------'.                                       11200002
112100         10  FILLER                    PIC X(01)   VALUE SPACES.  11210002
112200         10  FILLER                    PIC X(11)   VALUE          11220002
112300             '-----------'.                                       11230002
112400         10  FILLER                    PIC X(01)   VALUE SPACES.  11240002
112500         10  FILLER                    PIC X(07)   VALUE          11250002
112600             '-------'.                                           11260002
112700         10  FILLER                    PIC X(05)   VALUE SPACES.  11270002
112800         10  FILLER                    PIC X(07)   VALUE          11280002
112900             '-------'.                                           11290002
113000         10  FILLER                    PIC X(06)   VALUE SPACES.  11300002
113100 EJECT                                                            11310002
113200 01  PV-DETAIL-TOTAL-LINES.                                       11320002
113300     05  PV-DETAIL-TTL-LINE1.                                     11330002
113400         10  FILLER                    PIC X(83)   VALUE SPACES.  11340002
113500         10  PV-DTL1-DOL-ORDERED       PIC ZZZZZZZZ.99            11350002
113600                                                   VALUE ZEROS.   11360002
113700         10  FILLER                    PIC X(01)   VALUE SPACES.  11370002
113800         10  PV-DTL1-DOL-SHIPPED       PIC ZZZZZZZZ.99            11380002
113900                                                   VALUE ZEROS.   11390002
114000         10  FILLER                    PIC X(01)   VALUE SPACES.  11400002
114100         10  PV-DTL1-QTY-ORDERED       PIC ZZZZZZ9 VALUE ZEROS.   11410002
114200         10  FILLER                    PIC X(05)   VALUE SPACES.  11420002
114300         10  PV-DTL1-QTY-SHIPPED       PIC ZZZZZZ9 VALUE ZEROS.   11430002
114400         10  FILLER                    PIC X(04)   VALUE SPACES.  11440002
114500*                                                                 11450002
114600 EJECT                                                            11460002
114700     COPY SNRD001I.                                               11470002
114800 EJECT                                                            11480002
114900     COPY DPWS132O.                                               11490002
115000 EJECT                                                            11500002
115100     COPY MAWS900.                                                11510002
115200 EJECT                                                            11520002
115300*  TRADING PARTNER LAYOUT                                         11530002
115400*                                                                 11540002
115500     EXEC SQL                                                     11550002
115600         INCLUDE TTRDPRT                                          11560002
115700     END-EXEC.                                                    11570002
115800 EJECT                                                            11580002
115900     EXEC SQL                                                     11590002
116000         INCLUDE TTRDMLT                                          11600002
116100     END-EXEC.                                                    11610002
116200 EJECT                                                            11620002
116300*  MERCHANDISING AREA TABLE LAYOUT                                11630002
116400*                                                                 11640002
116500     EXEC SQL                                                     11650002
116600         INCLUDE TMDSEAR                                          11660002
116700     END-EXEC.                                                    11670002
116800 EJECT                                                            11680002
116900*  MERCHANDISING RESPONSIBILITY TABLE LAYOUT                      11690002
117000*                                                                 11700002
117100     EXEC SQL                                                     11710002
117200         INCLUDE TRSPBAR                                          11720002
117300     END-EXEC.                                                    11730002
117400 EJECT                                                            11740002
117500*  ASN HEADER TABLE LAYOUT                                        11750002
117600*                                                                 11760002
117700     EXEC SQL                                                     11770002
117800         INCLUDE TASNHDR                                          11780002
117900     END-EXEC.                                                    11790002
118000 EJECT                                                            11800002
118100*  ASN DETAIL TABLE LAYOUT                                        11810002
118200*                                                                 11820002
118300     EXEC SQL                                                     11830002
118400         INCLUDE TASNDTL                                          11840002
118500     END-EXEC.                                                    11850002
118600 EJECT                                                            11860002
118700*  ASN DETAIL-PO ITEM ASSOC TABLE LAYOUT                          11870002
118800*                                                                 11880002
118900     EXEC SQL                                                     11890002
119000         INCLUDE TASDTPL                                          11900002
119100     END-EXEC.                                                    11910002
119200 EJECT                                                            11920002
119300*  ASN ORDER TABLE LAYOUT                                         11930002
119400*                                                                 11940002
119500     EXEC SQL                                                     11950002
119600         INCLUDE TASNORD                                          11960002
119700     END-EXEC.                                                    11970002
119800 EJECT                                                            11980002
119900*  ASN PACKAGE TABLE LAYOUT                                       11990002
120000*                                                                 12000002
120100     EXEC SQL                                                     12010002
120200         INCLUDE TASNPKG                                          12020002
120300     END-EXEC.                                                    12030002
120400 EJECT                                                            12040002
120500*  ASN         TABLE LAYOUT                                       12050002
120600*                                                                 12060002
120700     EXEC SQL                                                     12070002
120800         INCLUDE TASOADR                                          12080002
120900     END-EXEC.                                                    12090002
121000 EJECT                                                            12100002
121100*  ASN CARTON  TABLE LAYOUT                                       12110002
121200*                                                                 12120002
121300     EXEC SQL                                                     12130002
121400         INCLUDE TASNCAR                                          12140002
121500     END-EXEC.                                                    12150002
121600*  ASN CARTON CRIT TABLE LAYOUT                                   12160002
121700*                                                                 12170002
121800     EXEC SQL                                                     12180002
121900         INCLUDE TASCRIT                                          12190002
122000     END-EXEC.                                                    12200002
122100                                                                  12210002
122200                                                                  12220002
122300*  VENDOR TABLE LAYOUT                                            12230002
122400*                                                                 12240002
122500*2/3 EXEC SQL                                                     12250002
122600*        INCLUDE TVENDOR                                          12260002
122700*    END-EXEC.                                                    12270002
122800                                                                  12280002
122900*  PO  TABLE LAYOUT                                               12290002
123000*                                                                 12300002
123100     EXEC SQL                                                     12310002
123200         INCLUDE TPURCHS                                          12320002
123300     END-EXEC.                                                    12330002
123400                                                                  12340002
123500*  PO ITEM TABLE LAYOUT                                           12350002
123600*                                                                 12360002
123700     EXEC SQL                                                     12370002
123800         INCLUDE TPURITM                                          12380002
123900     END-EXEC.                                                    12390002
124000                                                                  12400002
124100*  PO PLAN SHIPMENT TABLE LAYOUT                                  12410002
124200*                                                                 12420002
124300     EXEC SQL                                                     12430002
124400         INCLUDE TPLNSHP                                          12440002
124500     END-EXEC.                                                    12450002
124600 EJECT                                                            12460002
124700*  PO TPOAGMT TABLE LAYOUT                                        12470002
124800*                                                                 12480002
124900     EXEC SQL                                                     12490002
125000         INCLUDE TPOAGMT                                          12500002
125100     END-EXEC.                                                    12510002
125200 EJECT                                                            12520002
125300*  COPY BOOK FOR ASN SHIPPING ADDRESS TABLE                       12530002
125400*                                                                 12540002
125500     EXEC SQL                                                     12550002
125600          INCLUDE TASHADR                                         12560002
125700     END-EXEC.                                                    12570002
125800 EJECT                                                            12580002
125900*  COPY BOOK LOCATION TABLE                                       12590002
126000*                                                                 12600002
126100     EXEC SQL                                                     12610002
126200          INCLUDE XLT00010                                        12620002
126300     END-EXEC.                                                    12630002
126400 EJECT                                                            12640002
126500*  COPY BOOK LOCTION DC ASSIGNMENT                                12650002
126600*                                                                 12660002
126700     EXEC SQL                                                     12670002
126800          INCLUDE XLT00014                                        12680002
126900     END-EXEC.                                                    12690002
127000 EJECT                                                            12700002
127100*  EXTERNAL ENTITY TABLE LAYOUT                                   12710002
127200*                                                                 12720002
127300     EXEC SQL                                                     12730002
127400         INCLUDE TEXTENT                                          12740002
127500     END-EXEC.                                                    12750002
127600 EJECT                                                            12760002
127700*  ENTITY NAME TABLE LAYOUT                                       12770002
127800*                                                                 12780002
127900     EXEC SQL                                                     12790002
128000         INCLUDE TENTNME                                          12800002
128100     END-EXEC.                                                    12810002
128200 EJECT                                                            12820002
128300******************************************************************12830002
128400*  COPY BOOK FOR PO INSTRUCTION TABLE                             12840002
128500******************************************************************12850002
128600     EXEC SQL                                                     12860002
128700          INCLUDE TPOINST                                         12870002
128800     END-EXEC.                                                    12880002
128900******************************************************************12890002
129000*  COPY BOOK FOR INSTRUCTION CODE TABLE                           12900002
129100******************************************************************12910002
129200     EXEC SQL                                                     12920002
129300          INCLUDE TINSTCD                                         12930002
129400     END-EXEC.                                                    12940002
129500******************************************************************12950002
129600*  COPY BOOK FOR RECIPENT CODE TABLE                              12960002
129700******************************************************************12970002
129800     EXEC SQL                                                     12980002
129900          INCLUDE TINRCCD                                         12990002
130000     END-EXEC.                                                    13000002
130010***************************************************************** 13001007
130020*    WST_INTGRTN_TYP TABLE                                        13002007
130030***************************************************************** 13003007
130040     EXEC SQL                                                     13004007
130050          INCLUDE WST00008                                        13005007
130060     END-EXEC.                                                    13006007
130070                                                                  13007007
130080***************************************************************** 13008007
130090*    WST_ATTR_ELEM TABLE                                          13009007
130091***************************************************************** 13009107
130092     EXEC SQL                                                     13009207
130093          INCLUDE WST00009                                        13009307
130094     END-EXEC.                                                    13009407
130095                                                                  13009507
130096***************************************************************** 13009607
130097*    WST_ATTR_DEFN TABLE                                          13009707
130098***************************************************************** 13009807
130099     EXEC SQL                                                     13009907
130100          INCLUDE WST00010                                        13010007
130101     END-EXEC.                                                    13010107
130102                                                                  13010207
130110*  DB2 COMMUNICATION AREA                                         13011002
130200*                                                                 13020002
130300     EXEC SQL                                                     13030002
130400         INCLUDE SQLCA                                            13040002
130500     END-EXEC.                                                    13050002
130600 EJECT                                                            13060002
130700*  DB2 COMMUNICATION AREA2                                        13070002
130800*                                                                 13080002
130900     COPY SQLCA2.                                                 13090002
131000 EJECT                                                            13100002
131100*                                                                 13110002
131200*  CURSOR TO FETCH ASN HEADER/ORDER INFORMATION                   13120002
131300*                                                                 13130002
131400* CLT ADDED CARR-AUTH-ID WR40574 12-01-2011                       13140002
131500     EXEC SQL                                                     13150002
131600       DECLARE ASN_HEADER_CURSOR CURSOR FOR                       13160002
131700         SELECT DISTINCT                                          13170002
131800                A.OPERCO_NBR,                                     13180002
131900                A.EDI_VEND_ID,                                    13190002
132000                A.ASNHDR_NBR,                                     13200002
132100                A.SHIP_DTE,                                       13210002
132200                A.BOL_NBR,                                        13220002
132300                A.PRO_NBR,                                        13230002
132400                A.CART_SHIP_QTY,                                  13240002
132500                A.GRO_WGHT_MSMT,                                  13250002
132600                A.ANTC_DELY_DTE,                                  13260002
132700                A.CARR_NAME,                                      13270002
132800                A.CARR_ID_CDE,                                    13280002
132900                A.EQUIP_INIT_CDE,                                 13290002
133000                A.EQUIP_NBR,                                      13300002
133100                A.GRO_WGHT_UM_CDE,                                13310002
133200                A.DC_PRT_IND,                                     13320002
133300                A.ASNHDR_ID,                                      13330002
133400                A.EDIISA_CNTL_NBR,                                13340002
133500                B.PO_NBR,                                         13350002
133600                B.LOC_NBR,                                        13360002
133700                B.MDSEDP_NBR,                                     13370002
133800                B.SEQ_NBR_IND,                                    13380002
133900                B.MTCH_PO_CDE,                                    13390002
134000                B.EARLY_LTE_CDE,                                  13400002
134100                A.CARR_AUTH_ID                                    13410002
134200           FROM TASNHDR A,                                        13420002
134300                TASNORD B                                         13430002
134400           WHERE A.ASNHDR_ID  = B.ASNHDR_ID                       13440002
134500             AND A.PRINT_IND  = :PC-N                             13450002
135140           ORDER BY A.OPERCO_NBR,                                 13514002
135150                    A.EDI_VEND_ID,                                13515002
135160                    A.ASNHDR_NBR,                                 13516002
135170                    B.PO_NBR,                                     13517002
135180                    B.LOC_NBR                                     13518002
135190     END-EXEC.                                                    13519002
135200 EJECT                                                            13520002
135300*                                                                 13530002
135400*  CURSOR TO FETCH ASN DETAIL/ORDER INFORMATION                   13540002
135500*                                                                 13550002
135600     EXEC SQL                                                     13560002
135700       DECLARE ASN_DETAIL_CURSOR CURSOR FOR                       13570002
135800         SELECT A.ASNDTL_NBR,                                     13580002
135900                A.UPC_NBR,                                        13590002
136000                A.SHIPT_QTY,                                      13600002
136100                A.SHIPT_UM_CDE,                                   13610002
136200                A.PKG_QTY,                                        13620002
136300                A.ORD_QTY_UM_CDE,                                 13630002
136400                B.PO_LN_NBR,                                      13640002
136500                B.ASSOC_QTY,                                      13650002
136600                B.SHIPT_VAR_QTY,                                  13660002
136700                B.PR_CHG_EFF_DAY_NBR,                             13670002
136800                B.PR_VAR_IND,                                     13680002
136900                B.PR_DISC_IND,                                    13690002
137000                B.ASDTPL_ALLOC_IND                                13700002
137100           FROM TASNDTL A,                                        13710002
137200                TASDTPL B                                         13720002
137300           WHERE A.ASNHDR_ID        = :ASNHDR-ASNHDR-ID           13730002
137400             AND A.ASNHDR_ID        = B.ASNHDR_ID                 13740002
137500             AND A.PO_NBR           = :ASNORD-PO-NBR              13750002
137600             AND A.LOC_NBR          = :ASNORD-LOC-NBR             13760002
137700             AND A.ASNDTL_NBR       = B.ASNDTL_NBR                13770002
137800        ORDER BY B.PO_LN_NBR,                                     13780002
137900                 A.SHIPT_UM_CDE                                   13790002
138000     END-EXEC.                                                    13800002
138100                                                                  13810002
138200*                                                                 13820002
138300*  CURSOR TO FETCH ASN DETAIL INFORMATION WHERE NO MATCHING       13830002
138400*  RECORD EXISTS ON THE DETAIL PO/ITEM ASSOCIATION DATABASE       13840002
138500*                                                                 13850002
138600     EXEC SQL                                                     13860002
138700       DECLARE DTL_NOT_EXISTS_CSR CURSOR FOR                      13870002
138800         SELECT A.ASNDTL_NBR,                                     13880002
138900                A.UPC_NBR,                                        13890002
139000                A.SHIPT_QTY,                                      13900002
139100                A.SHIPT_UM_CDE,                                   13910002
139200                A.PKG_QTY,                                        13920002
139300                A.ORD_QTY_UM_CDE                                  13930002
139400           FROM TASNDTL A                                         13940002
139500           WHERE A.ASNHDR_ID          = :ASNHDR-ASNHDR-ID         13950002
139600             AND A.PO_NBR             = :ASNORD-PO-NBR            13960002
139700             AND A.LOC_NBR            = :ASNORD-LOC-NBR           13970002
139800             AND NOT EXISTS                                       13980002
139900               (SELECT *                                          13990002
140000                  FROM TASDTPL B                                  14000002
140100                  WHERE B.ASNHDR_ID   = :ASNHDR-ASNHDR-ID         14010002
140200                    AND B.ASNDTL_NBR  = A.ASNDTL_NBR)             14020002
140300               ORDER BY A.UPC_NBR,                                14030002
140400                        A.SHIPT_UM_CDE                            14040002
140500     END-EXEC.                                                    14050002
140600                                                                  14060002
140700*                                                                 14070002
140800*  CURSOR TO FETCH ASN CARTON DATABASE INFORMATION                14080002
140900*                                                                 14090002
141000     EXEC SQL                                                     14100002
141100       DECLARE ASN_CARTON_CURSOR CURSOR FOR                       14110002
141200         SELECT B.ASSOC_QTY,                                      14120002
141300                C.ASNCAR_NBR,                                     14130002
141400                A.UPC_NBR,                                        14140002
141500                C.PKG_QTY                                         14150002
141600           FROM TASNDTL A,                                        14160002
141700                TASDTPL B,                                        14170002
141800                TASNCAR C,                                        14180002
141900                TASCRIT D                                         14190002
142000           WHERE A.ASNHDR_ID        = :ASNHDR-ASNHDR-ID           14200002
142100             AND A.ASNHDR_ID        = B.ASNHDR_ID                 14210002
142200             AND A.ASNHDR_ID        = C.ASNHDR_ID                 14220002
142300             AND A.ASNHDR_ID        = D.ASNHDR_ID                 14230002
142400             AND C.ASNCAR_NBR       = D.ASNCAR_NBR                14240002
142500             AND A.ASNDTL_NBR       = B.ASNDTL_NBR                14250002
142600             AND A.ASNDTL_NBR       = D.ASNDTL_NBR                14260002
142700             AND A.ASNDTL_NBR       = A.ASNDTL_NBR                14270002
142800             AND B.PO_LN_NBR        = :PV-CURR-PO-LN-NBR-COMP     14280002
142900             AND A.PO_NBR           = :ASNORD-PO-NBR              14290002
143000             AND A.PO_NBR           = C.PO_NBR                    14300002
143100             AND A.LOC_NBR          = :ASNORD-LOC-NBR             14310002
143200             AND A.LOC_NBR          = C.LOC_NBR                   14320002
143300     END-EXEC.                                                    14330002
143400                                                                  14340002
143500*                                                                 14350002
143600*  CURSOR TO FETCH ASN CARTON DATABASE INFORMATION                14360002
143700*                                                                 14370002
143800     EXEC SQL                                                     14380002
143900       DECLARE ASN_CRN_NO_DTL_CSR CURSOR FOR                      14390002
144000         SELECT A.SHIPT_QTY,                                      14400002
144100                B.ASNCAR_NBR,                                     14410002
144200                A.UPC_NBR,                                        14420002
144300                B.PKG_QTY                                         14430002
144400           FROM TASNDTL A,                                        14440002
144500                TASNCAR B,                                        14450002
144600                TASCRIT C                                         14460002
144700           WHERE A.ASNHDR_ID        = :ASNHDR-ASNHDR-ID           14470002
144800             AND A.ASNHDR_ID        = B.ASNHDR_ID                 14480002
144900             AND A.ASNHDR_ID        = C.ASNHDR_ID                 14490002
145000             AND B.ASNCAR_NBR       = C.ASNCAR_NBR                14500002
145100             AND A.ASNDTL_NBR       = :PV-ASNDTL-ASNDTL-NBR       14510002
145200             AND A.ASNDTL_NBR       = C.ASNDTL_NBR                14520002
145300             AND A.PO_NBR           = :ASNORD-PO-NBR              14530002
145400             AND A.PO_NBR           = B.PO_NBR                    14540002
145500             AND A.LOC_NBR          = :ASNORD-LOC-NBR             14550002
145600             AND A.LOC_NBR          = B.LOC_NBR                   14560002
145700     END-EXEC.                                                    14570002
145800                                                                  14580002
145900 EJECT                                                            14590002
146000*                                                                 14600002
146100*  CURSOR TO FETCH GROSS WEIGHT - USED WHEN WEIGHT NULL OR        14610002
146200*  ZEROS ON ASNHDR                                                14620002
146300*                                                                 14630002
146400     EXEC SQL                                                     14640002
146500       DECLARE WEIGHT_CURSOR CURSOR FOR                           14650002
146600         SELECT CART_SHIP_QTY,                                    14660002
146700                GRO_WGHT_UM_CDE,                                  14670002
146800                GRO_WGHT_MSMT                                     14680002
146900           FROM TASNPKG                                           14690002
147000          WHERE ASNHDR_ID   = :ASNHDR-ASNHDR-ID                   14700002
147100     END-EXEC.                                                    14710002
147200 EJECT                                                            14720002
147300******************************************************************14730002
147400*  CURSOR FOR INSTRUCTIONS                                        14740002
147500******************************************************************14750002
147600     EXEC SQL                                                     14760002
147700         DECLARE INST-CSR CURSOR FOR                              14770002
147800         SELECT B.INSTR_DESC,                                     14780002
147900                B.INSTR_NBR,                                      14790002
148000                C.RECIP_CDE,                                      14800002
148100                C.RECIP_DESC                                      14810002
148200         FROM   TPOINST A,                                        14820002
148300                TINSTCD B,                                        14830002
148400                TINRCCD C                                         14840002
148500         WHERE A.PO_NBR = :PV-INTEGER-PO-NBR                      14850002
148600           AND B.INSTR_NBR = A.INSTR_NBR                          14860002
148700           AND C.RECIP_CDE = A.RECIP_CDE                          14870002
148800         ORDER BY RECIP_CDE, INSTR_NBR                            14880002
148900     END-EXEC.                                                    14890002
149000 EJECT                                                            14900002
149100***************************************************************** 14910002
149200*PROCEDURE DIVISION.                                              14920002
149300***************************************************************** 14930002
149400 PROCEDURE DIVISION.                                              14940002
149500*                                                                 14950002
149600 A000-MAINLINE-PROCESSING.                                        14960002
149700*                                                                 14970002
149800     DISPLAY '*************************************************'. 14980010
149900     DISPLAY 'START OF SNKRP006 - CHANGED VERSION DECEMBER 2022'. 14990010
150010     DISPLAY '*************************************************'. 15001010
150020     DISPLAY ' '.                                                 15002010
150100                                                                  15010002
150200     PERFORM A100-INITIALIZATION.                                 15020002
150300*                                                                 15030002
150400     PERFORM S000-FETCH-ASN-HEADER-INFO.                          15040002
150500*                                                                 15050002
150600     IF SQLCODE = PC-ROW-NOT-FOUND                                15060002
150700         MOVE PC-NO-ASN-NUMBERS     TO PV-H0-ASN-NBR              15070002
150800         PERFORM W300-WRITE-TOP-OF-FORM                           15080002
150900     ELSE                                                         15090002
151000         PERFORM B000-PROCESS-ASN                                 15100002
151100           UNTIL PS-END-OF-ASN                                    15110002
151200     END-IF.                                                      15120002
151300*                                                                 15130002
151400     PERFORM Y300-CLOSE-ASN-HEADER-CURSOR.                        15140002
151401                                                                  15140103
151410     DISPLAY '**************************************************'.15141003
151420     DISPLAY 'INPUT RECS READ   : ' PV-INPUT-RECS-READ.           15142003
151430     DISPLAY 'INPUT ID RECS READ: ' PV-INPUT-ID-RECS-READ.        15143003
151440     DISPLAY '**************************************************'.15144003
151500*                                                                 15150002
151600     DISPLAY '**************************************************'.15160002
151700     DISPLAY 'ASN TRANS RECS WRITTEN: ' PV-ASN-TRANS-RECS-WRITTEN.15170002
151800     DISPLAY '**************************************************'.15180002
151900*                                                                 15190002
152000     DISPLAY '**************************************************'.15200002
152100     DISPLAY 'ASN ERROR RECS WRITTEN: ' PV-ASN-ERROR-RECS-WRITTEN.15210002
152200     DISPLAY '**************************************************'.15220002
152300*                                                                 15230002
152400     CLOSE ASN-TRANSCRIPTION-FILE                                 15240002
152500           ASN-CARTON-ERROR-FILE                                  15250002
152600           REPORT-FILE-OUT-1.                                     15260002
152700*                                                                 15270002
152800     GOBACK.                                                      15280002
152900*                                                                 15290002
153000 EJECT                                                            15300002
153100******************************************************************15310002
153200** OPEN THE DB2 CURSOR AND SETUP STANDARD REPORT HEADER INFO.     15320002
153300******************************************************************15330002
153400 A100-INITIALIZATION.                                             15340002
153500*                                                                 15350002
153600     OPEN OUTPUT ASN-TRANSCRIPTION-FILE                           15360002
153700                 ASN-CARTON-ERROR-FILE                            15370002
153800                 REPORT-FILE-OUT-1.                               15380002
153900                                                                  15390002
154000     OPEN INPUT  ADV-SHIP-NOTICE-FILE.                            15400002
154100     PERFORM Z100-LOAD-TRADING-PART.                              15410002
154200     CLOSE  ADV-SHIP-NOTICE-FILE.                                 15420002
154300*                                                                 15430002
154400*  ** 08/13/92 **  CHANGE                                         15440002
154500     ACCEPT CC-CONTROL-CARD.                                      15450002
154600     IF NOT CC-PARM-VALID                                         15460002
154700         DISPLAY '** ABEND ** IN PROGRAM SNKRP006'                15470002
154800         DISPLAY 'SNKRP006 - CONTROL-CARD ERROR = '               15480002
154900                  CC-CONTROL-CARD                                 15490002
155000         MOVE +4003 TO PV-ABEND-CODE                              15500002
155100         CALL 'ILBOABN0' USING PV-ABEND-CODE                      15510002
155200     END-IF.                                                      15520002
155300*  ** 08/13/92 **  CHANGE END                                     15530002
155400*                                                                 15540002
155500*  ** 04/13/93 **  CHANGE                                         15550002
155600     IF  PV-ASN-TRANSCRIPTION-FL-ST NOT = '00'                    15560002
155700         DISPLAY '** ABEND IN SNKRP006 **'                        15570002
155800         DISPLAY 'ERROR OPENING ASN TRANSCRIPTION FILE'           15580002
155900         DISPLAY 'STATUS CODE IS '  PV-ASN-TRANSCRIPTION-FL-ST    15590002
156000         MOVE +4001              TO PV-ABEND-CODE                 15600002
156100         CALL 'ILBOABN0' USING PV-ABEND-CODE                      15610002
156200     END-IF.                                                      15620002
156300     IF  PV-ASN-ERROR-FILE-FL-ST NOT = '00'                       15630002
156400         DISPLAY '** ABEND IN SNKRP006 **'                        15640002
156500         DISPLAY 'ERROR OPENING ASN TRANSCRIPTION FILE'           15650002
156600         DISPLAY 'STATUS CODE IS '  PV-ASN-ERROR-FILE-FL-ST       15660002
156700         MOVE +4001              TO PV-ABEND-CODE                 15670002
156800         CALL 'ILBOABN0' USING PV-ABEND-CODE                      15680002
156900     END-IF.                                                      15690002
157000*  ** 04/13/93 **  CHANGE END                                     15700002
157100*                                                                 15710002
157200     IF  PV-REPORT-FILE-OUT-1-ST NOT = '00'                       15720002
157300         DISPLAY '** ABEND IN SNKRP006 **'                        15730002
157400         DISPLAY 'ERROR OPENING PRINT FILE 1 '                    15740002
157500         DISPLAY 'STATUS CODE IS '  PV-REPORT-FILE-OUT-1-ST       15750002
157600         MOVE +4001              TO PV-ABEND-CODE                 15760002
157700         CALL 'ILBOABN0' USING PV-ABEND-CODE                      15770002
157800     END-IF.                                                      15780002
157900*                                                                 15790002
158000     INITIALIZE PV-DETAIL-LINES.                                  15800002
158100     MOVE PC-N TO RC001-CARTON-IND.                               15810002
158200*                                                                 15820002
158300     ACCEPT PV-TODAYS-DATE                                        15830002
158400       FROM DATE.                                                 15840002
158500     ACCEPT PV-TODAYS-TIME                                        15850002
158600       FROM TIME.                                                 15860002
158700     ACCEPT PV-TODAYS-DAY                                         15870002
158800       FROM DAY-OF-WEEK.                                          15880002
158900*                                                                 15890002
159000     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         15900002
159100*                                                                 15910002
159200     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH              15920002
159300                                    PV-PROCESS-DATE-MM            15930002
159400                                    PV-CUR-MM                     15940002
159500                                    PV-MM.                        15950002
159600     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY                15960002
159700                                    PV-DD                         15970002
159800                                    PV-CUR-DD                     15980002
159900                                    PV-PROCESS-DATE-DD.           15990002
160000     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR               16000002
160100                                    PV-PROCESS-DATE-YY            16010002
160200                                    PV-CUR-YY                     16020002
160300                                    PV-YY.                        16030002
160400*                                                                 16040002
160500     IF PV-TODAYS-DATE-YY > 90                                    16050002
160600         MOVE 19                 TO PV-PROCESS-DATE-CENT          16060002
160700                                    PV-CUR-CC                     16070002
160800     ELSE                                                         16080002
160900         MOVE 20                 TO PV-PROCESS-DATE-CENT          16090002
161000                                    PV-CUR-CC                     16100002
161100     END-IF.                                                      16110002
161200     MOVE '-'                    TO PV-DASH1                      16120002
161300                                    PV-DASH2.                     16130002
161400     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              16140002
161500     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            16150002
161600     MOVE PC-SNKRP006            TO DP132O-PROGRAM-NAME.          16160002
161700     MOVE PC-99                  TO PV-LINE-CNT.                  16170002
161800*                                                                 16180002
161900     PERFORM Y000-OPEN-ASN-HEADER-CURSOR.                         16190002
162000*                                                                 16200002
162100 EJECT                                                            16210002
162200******************************************************************16220002
162300*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING ASN     *16230002
162400*  INFORMATION.                                                  *16240002
162500******************************************************************16250002
162600 B000-PROCESS-ASN.                                                16260002
162700*                                                                 16270002
162900     INITIALIZE RC001-ASN-TRANSCRIPTION-RECORD.                   16290002
163000*                                                                 16300002
163100     PERFORM R100-PROCESS-PO-INFORMATION.                         16310002
163200*                                                                 16320002
163300     IF PS-PO-FOUND                                               16330002
163400         PERFORM S200-GET-DEPT-DESCRIPTION                        16340002
163500     ELSE                                                         16350002
163600                                                                  16360002
163700         MOVE PC-DEPT-NOT-FOUND   TO MDSEAR-DESC                  16370002
163800         MOVE SPACES              TO PV-H2-BUYER                  16380002
163900                                     PV-H2-BUYER-ID-X             16390002
164000                                     PV-H3-ANALYST                16400002
164100     END-IF.                                                      16410002
164200*                                                                 16420002
164300*  ** 04/13/93 **  CHANGE                                         16430002
164400     IF PS-PO-FOUND                                               16440002
164500         IF ASNORD-PO-NBR = PV-PREV-PO-NBR                        16450002
164600             SET PS-NOT-FIRST-ASN-FOR-PO TO TRUE                  16460002
164700         ELSE                                                     16470002
164800             MOVE ASNORD-PO-NBR          TO PV-PREV-PO-NBR        16480002
164900             SET PS-FIRST-ASN-FOR-PO     TO TRUE                  16490002
165000         END-IF                                                   16500002
165100     END-IF.                                                      16510002
165200*  ** 04/13/93 **  CHANGE END                                     16520002
165300*                                                                 16530002
165400     PERFORM S500-GET-PACK-CODES.                                 16540002
165500*                                                                 16550002
165600*    PERFORM S600-COUNT-CARTONS-FOR-ORDER.                        16560002
165700*    PERFORM S650-COUNT-CARTONS-FOR-PO.                           16570002
165800     PERFORM S610-STORE-CARTONS-FROM-TD1.                         16580002
165900     PERFORM S655-PO-CARTONS-FROM-TD1.                            16590002
166000*                                                                 16600002
166100     PERFORM R000-GET-VENDOR-NAME.                                16610002
166200     PERFORM R025-GET-IMPORT-IND.                                 16620002
166300                                                                  16630002
166400     PERFORM R600-RETRIEVE-MAN-SEGMENT.                           16640002
166500*                                                                 16650002
166600     PERFORM S700-CHECK-FOR-ADDTL-ERRORS.                         16660002
166700*                                                                 16670002
166800     PERFORM D000-FORMAT-HEADER-LINES.                            16680002
166900     PERFORM W000-WRITE-REPORT-HEADERS.                           16690002
167000*                                                                 16700002
167100                                                                  16710002
167200*  ** 04/26/93 **  CHANGE                                         16720002
167300     IF (ASNHDR-DC-PRT-IND NOT = PC-Y AND                         16730002
167500         PS-WRITE-EXTRACT-RECORD)                                 16750002
167520         PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL                   16752002
167530     END-IF.                                                      16753002
167540*  ** 04/26/93 **  CHANGE END                                     16754002
167550*                                                                 16755002
167560     PERFORM Y100-OPEN-ASN-DETAIL-CURSOR.                         16756002
167570*                                                                 16757002
167580     PERFORM S100-FETCH-ASN-DETAIL-INFO.                          16758002
167590*                                                                 16759002
167600     IF PS-END-OF-ASN-DETAIL                                      16760002
167700         MOVE PC-NO-ASN-DETAIL        TO PV-DL2-UPC-DESCRIPTION   16770002
167800     ELSE                                                         16780002
167900         PERFORM B200-SAVE-CURRENT-DATA                           16790002
168000         PERFORM B100-PROCESS-ASN-DETAIL-INFO                     16800002
168100             UNTIL PS-END-OF-ASN-DETAIL                           16810002
168200     END-IF.                                                      16820002
168300*                                                                 16830002
168400     PERFORM Y200-CLOSE-ASN-DETAIL-CURSOR.                        16840002
168500*                                                                 16850002
168600     MOVE SPACES                      TO PV-DETAIL-LINE1.         16860002
168700     MOVE ZEROES                      TO PV-CURR-ASSOC-QTY.       16870002
168800*                                                                 16880002
168900     PERFORM Y400-OPEN-ASN-DTL-NOT-EXISTS.                        16890002
169000     PERFORM S900-FETCH-ASN-DTL-NOT-EXISTS.                       16900002
169100*                                                                 16910002
169200     IF PS-END-OF-ASN-DETAIL                                      16920002
169300         IF PV-DL2-UPC-DESCRIPTION = PC-NO-ASN-DETAIL             16930002
169400             PERFORM W500-WRITE-DETAIL-LINES                      16940002
169500*  ** 04/26/93 **  CHANGE                                         16950002
169600             IF (ASNHDR-DC-PRT-IND NOT = PC-Y AND                 16960002
169800                 PS-WRITE-EXTRACT-RECORD)                         16980002
169900                 INITIALIZE RC001-DETAIL-LAYOUT                   16990002
170000                 MOVE HIGH-VALUES     TO RC001-PO-LINE-NBR        17000002
170100                 MOVE PC-NO-ASN-DETAIL                            17010002
170200                                      TO RC001-UPC-DESC           17020002
170300                 MOVE PC-N            TO RC001-ASDTPL-ALLOC-IND   17030002
170400                                         RC001-ASDTPL-MATCH-IND   17040002
170500                                         RC001-ASDTPL-PR-DISC-IND 17050002
170600                                         RC001-ASDTPL-PR-VAR-IND  17060002
170700                                         RC001-CARTON-IND         17070002
170800                 MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR       17080002
171000                 PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL           17100002
171100             END-IF                                               17110002
171200*  ** 04/26/93 **  CHANGE END                                     17120002
171300         ELSE                                                     17130002
171400             PERFORM D300-FORMAT-DETAIL-TOTALS                    17140002
171500             PERFORM W600-WRITE-DETAIL-TOTAL-LINES                17150002
171600         END-IF                                                   17160002
171700     ELSE                                                         17170002
171800         INITIALIZE PV-CURR-ASDTPL-FIELDS                         17180002
171900                    DCLTASDTPL                                    17190002
172000         PERFORM B400-SAVE-CURRENT-NO-ASN-DATA                    17200002
172100         MOVE ZEROES TO PV-DOLLARS-SHIPPED                        17210002
172200         MOVE 0 TO PV-TABLE-SUB                                   17220002
172300         INITIALIZE PV-DETAIL-CARTON-LAYOUT                       17230002
172400         PERFORM B300-PROCESS-NO-ASN-DTL                          17240002
172500             UNTIL PS-END-OF-ASN-DETAIL                           17250002
172600         PERFORM D300-FORMAT-DETAIL-TOTALS                        17260002
172700         PERFORM W600-WRITE-DETAIL-TOTAL-LINES                    17270002
172800     END-IF.                                                      17280002
172900*                                                                 17290002
173000     PERFORM Y500-CLOSE-ASN-DTL-NOT-EXISTS.                       17300002
173100*                                                                 17310002
173200     PERFORM B050-DISPLAY-TIMESTAMP.                              17320002
173300*                                                                 17330002
173400     PERFORM S000-FETCH-ASN-HEADER-INFO.                          17340002
173500*                                                                 17350002
173600 EJECT                                                            17360002
173700******************************************************************17370002
173800*     DISPLAY CURRENT TIMESTAMP                                  *17380002
173900*                                                                *17390002
174000******************************************************************17400002
174100 B050-DISPLAY-TIMESTAMP.                                          17410002
174200*                                                                 17420002
174300     EXEC SQL                                                     17430002
174400         SET :PV-CURR-TMST = CURRENT TIMESTAMP                    17440002
174500     END-EXEC.                                                    17450002
174600*                                                                 17460002
174700     IF SQLCODE = +0                                              17470002
174800         DISPLAY 'ASN ' ASNHDR-ASNHDR-NBR                         17480002
174900                 ' WAS PROCESSED AT ' PV-CURR-TMST                17490002
174910                 ' PO NBR WAS ' PV-DISPLAY-PO-NBR                 17491009
175000     ELSE                                                         17500002
175100         DISPLAY 'PARAGRAPH B050, BAD SET FOR CURRENT TIMESTAMP'  17510002
175200         DISPLAY ' '                                              17520002
175300         PERFORM Z999-SQL-ERROR                                   17530002
175400     END-IF.                                                      17540002
175500*                                                                 17550002
175600 EJECT                                                            17560002
175700******************************************************************17570002
175800*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING ASN     *17580002
175900*  INFORMATION.                                                  *17590002
176000******************************************************************17600002
176100 B100-PROCESS-ASN-DETAIL-INFO.                                    17610002
176200*                                                                 17620002
176400     INITIALIZE RC001-DETAIL-LAYOUT.                              17640002
176500*                                                                 17650002
176600     MOVE PC-N TO RC001-CARTON-IND.                               17660002
176700     IF ASDTPL-PO-LN-NBR    = PV-CURR-PO-LN-NBR    AND            17670002
176800        ASNDTL-SHIPT-UM-CDE = PV-CURR-SHIPT-UM-CDE                17680002
177000         ADD ASDTPL-ASSOC-QTY        TO PV-CURR-ASSOC-QTY         17700002
177100*                                                                 17710002
177200*  ** 04/13/93 **  CHANGE                                         17720002
177300         IF ASDTPL-PR-CHG-EFF-DAY-NBR NOT = ZERO                  17730002
177400             MOVE ASDTPL-PR-CHG-EFF-DAY-NBR                       17740002
177500                                     TO PV-CURR-PR-CHG-EFF-DAY-NBR17750002
177600         END-IF                                                   17760002
177700*  ** 04/13/93 **  CHANGE                                         17770002
177800*                                                                 17780002
177900     ELSE                                                         17790002
178000         PERFORM R400-READ-PO-LINE-DETAIL                         17800002
178100*----------------------------------------------------------------*17810002
178200*                                               **   WR # 230ZZ  *17820002
178300* INITIALIZED XL001-ITEM-COMMAREA.                               *17830002
178400* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *17840002
178500*----------------------------------------------------------------*17850002
178600                                                                  17860002
178700         INITIALIZE XL001-ITEM-COMMAREA                           17870002
178800                                                                  17880002
178900         IF (PURITM-SKU-SEQ-NBR = PC-000)                         17890002
179000            MOVE '00000000'    TO PV-DL1-SEQ                      17900002
179100         ELSE                                                     17910002
179200            IF (PURITM-SKU-SEQ-NBR = PC-999)                      17920002
179300               MOVE '99999999' TO PV-DL1-SEQ                      17930002
179400            END-IF                                                17940002
179500         END-IF                                                   17950002
179600                                                                  17960002
179700         IF PS-CALL-API-YES                    AND                17970002
179800            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                17980002
179900             (PURITM-SKU-SEQ-NBR NOT = PC-999))                   17990002
180000              PERFORM R450-CALL-XLKUT-DOMAIN-PGM                  18000002
180100         END-IF                                                   18010002
180200                                                                  18020002
180300*----------------------------------------------------------------*18030002
180400* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *18040002
180500*----------------------------------------------------------------*18050002
180600         PERFORM S800-DERIVE-ERROR-CODES                          18060002
180700         IF PV-LINE-CNT > PC-50                                   18070002
180800             PERFORM W000-WRITE-REPORT-HEADERS                    18080002
180900         END-IF                                                   18090002
181000         PERFORM D100-FORMAT-ASN-LINES                            18100002
181100         PERFORM W500-WRITE-DETAIL-LINES                          18110002
181200*                                                                 18120002
181700*  ** 04/26/93 **  CHANGE                                         18170002
181800         IF (ASNHDR-DC-PRT-IND NOT = PC-Y AND                     18180002
181820             PS-WRITE-EXTRACT-RECORD)                             18182002
181830             MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR           18183002
181850             PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL               18185002
181860             IF PV-VLD-CART-LBL-IND = 'Y'                         18186002
181870                 MOVE 0 TO PV-TABLE-SUB                           18187002
181880                 PERFORM E100-OPEN-CARTON-CURSOR                  18188002
181890                 PERFORM E200-FETCH-CARTON-CURSOR                 18189002
181900                 SET PS-VALID TO TRUE                             18190002
182000                 INITIALIZE RC001-DETAIL-CARTON-LAYOUT            18200002
182100                 PERFORM E300-PROCESS-CARTON-CURSOR               18210002
182200                     UNTIL PS-END-OF-CARTON                       18220002
182600                 IF PV-TABLE-SUB > 0                              18260002
182700                     MOVE PC-Y TO RC001-CARTON-IND                18270002
182800                     MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR   18280002
183000                     PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL       18300002
183100                 ELSE                                             18310002
183200                     IF PS-VALIDATION-ERR                         18320002
183300                         CONTINUE                                 18330002
183400                     ELSE                                         18340002
183500                         MOVE PC-04 TO RC016-ASN-CARTON-ERR       18350002
183600                         PERFORM G100-WRITE-ERROR-FILE            18360002
183700                     END-IF                                       18370002
183800                 END-IF                                           18380002
183900                 PERFORM E400-CLOSE-CARTON-CURSOR                 18390002
184000                 MOVE PC-N TO RC001-CARTON-IND                    18400002
184100                 INITIALIZE RC001-DETAIL-LAYOUT                   18410002
184200             END-IF                                               18420002
184300         END-IF                                                   18430002
184400*  ** 04/26/93 **  CHANGE END                                     18440002
184500*                                                                 18450002
184600         ADD ASDTPL-ASSOC-QTY        TO PV-CURR-ASSOC-QTY         18460002
184700         PERFORM B200-SAVE-CURRENT-DATA                           18470002
184800     END-IF.                                                      18480002
184900*                                                                 18490002
185000     PERFORM S100-FETCH-ASN-DETAIL-INFO.                          18500002
185100*                                                                 18510002
185200     EVALUATE TRUE                                                18520002
185300       WHEN SQLCODE = PC-ROW-NOT-FOUND                            18530002
185400         PERFORM R400-READ-PO-LINE-DETAIL                         18540002
185500*----------------------------------------------------------------*18550002
185600*                                               **   WR # 230ZZ  *18560002
185700* INITIALIZED XL001-ITEM-COMMAREA.                               *18570002
185800* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *18580002
185900*----------------------------------------------------------------*18590002
186000                                                                  18600002
186100         INITIALIZE XL001-ITEM-COMMAREA                           18610002
186200                                                                  18620002
186300         IF (PURITM-SKU-SEQ-NBR = PC-000)                         18630002
186400            MOVE '00000000'    TO PV-DL1-SEQ                      18640002
186500         ELSE                                                     18650002
186600            IF (PURITM-SKU-SEQ-NBR = PC-999)                      18660002
186700               MOVE '99999999' TO PV-DL1-SEQ                      18670002
186800            END-IF                                                18680002
186900         END-IF                                                   18690002
187000                                                                  18700002
187100         IF PS-CALL-API-YES                    AND                18710002
187200            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                18720002
187300             (PURITM-SKU-SEQ-NBR NOT = PC-999))                   18730002
187400              PERFORM R450-CALL-XLKUT-DOMAIN-PGM                  18740002
187500         END-IF                                                   18750002
187600                                                                  18760002
187700*----------------------------------------------------------------*18770002
187800* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *18780002
187900*----------------------------------------------------------------*18790002
188000         PERFORM S800-DERIVE-ERROR-CODES                          18800002
188100         IF PV-LINE-CNT > PC-50                                   18810002
188200             PERFORM W000-WRITE-REPORT-HEADERS                    18820002
188300         END-IF                                                   18830002
188400         PERFORM D100-FORMAT-ASN-LINES                            18840002
188500         PERFORM W500-WRITE-DETAIL-LINES                          18850002
188600*                                                                 18860002
188700*  ** 04/26/93 **  CHANGE                                         18870002
188800         IF (ASNHDR-DC-PRT-IND NOT = PC-Y AND                     18880002
189000             PS-WRITE-EXTRACT-RECORD)                             18900002
189100             MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR           18910002
189300             PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL               18930002
189400             IF PV-VLD-CART-LBL-IND = 'Y'                         18940002
189500                 MOVE 0 TO PV-TABLE-SUB                           18950002
189600                 PERFORM E100-OPEN-CARTON-CURSOR                  18960002
189700                 PERFORM E200-FETCH-CARTON-CURSOR                 18970002
189800                 SET PS-VALID TO TRUE                             18980002
189900                 INITIALIZE RC001-DETAIL-CARTON-LAYOUT            18990002
190100                 PERFORM E300-PROCESS-CARTON-CURSOR               19010002
190200                     UNTIL PS-END-OF-CARTON                       19020002
190300                 IF PV-TABLE-SUB > 0                              19030002
190400                     MOVE PC-Y TO RC001-CARTON-IND                19040002
190500                     MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR   19050002
190520                     PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL       19052002
190530                 ELSE                                             19053002
190540                     IF PS-VALIDATION-ERR                         19054002
190550                         CONTINUE                                 19055002
190560                     ELSE                                         19056002
190570                         MOVE PC-04 TO RC016-ASN-CARTON-ERR       19057002
190580                         PERFORM G100-WRITE-ERROR-FILE            19058002
190590                     END-IF                                       19059002
190600                 END-IF                                           19060002
190700                 PERFORM E400-CLOSE-CARTON-CURSOR                 19070002
190800                 MOVE PC-N TO RC001-CARTON-IND                    19080002
190900                 INITIALIZE RC001-DETAIL-LAYOUT                   19090002
191000             END-IF                                               19100002
191100         END-IF                                                   19110002
191200*  ** 04/26/93 **  CHANGE END                                     19120002
191300*                                                                 19130002
191400     END-EVALUATE.                                                19140002
191500*                                                                 19150002
191600 EJECT                                                            19160002
191700******************************************************************19170002
191800*  THIS PARAGRAPH SAVES ALL NEEDED FIELDS FROM THE CURRENT ROW   *19180002
191900******************************************************************19190002
192000 B200-SAVE-CURRENT-DATA.                                          19200002
192100*                                                                 19210002
192200     MOVE ASNDTL-UPC-NBR          TO PV-CURR-UPC-NBR.             19220002
192300     MOVE ASNDTL-SHIPT-UM-CDE     TO PV-CURR-SHIPT-UM-CDE.        19230002
192400     MOVE ASNDTL-SHIPT-QTY        TO PV-CURR-SHIPT-QTY.           19240002
192500     MOVE ASDTPL-ASSOC-QTY        TO PV-SAVE-ASSOC-QTY            19250002
192600     MOVE ASDTPL-PO-LN-NBR        TO PV-CURR-PO-LN-NBR            19260002
192700                                     PV-CURR-PO-LN-NBR-COMP.      19270002
192800     MOVE ASDTPL-SHIPT-VAR-QTY    TO PV-CURR-SHIPT-VAR-QTY.       19280002
192900     MOVE ASDTPL-PR-CHG-EFF-DAY-NBR                               19290002
193000                                  TO PV-CURR-PR-CHG-EFF-DAY-NBR.  19300002
193100     MOVE ASDTPL-PR-VAR-IND       TO PV-CURR-PR-VAR-IND.          19310002
193200     MOVE ASDTPL-PR-DISC-IND      TO PV-CURR-PR-DISC-IND.         19320002
193300     MOVE ASDTPL-ASDTPL-ALLOC-IND TO PV-CURR-ASDTPL-ALLOC-IND.    19330002
193400     MOVE PV-DTL-PKG-QTY-NULL     TO PV-CURR-PKG-QTY-NULL.        19340002
193500*                                                                 19350002
193600     IF PV-DTL-ORD-QTY-UM-CDE-NULL = PC-NEG-1                     19360002
193700         MOVE ASNDTL-SHIPT-UM-CDE TO PV-CURR-ORD-QTY-UM-CDE       19370002
193800     ELSE                                                         19380002
193900         MOVE ASNDTL-ORD-QTY-UM-CDE                               19390002
194000                                  TO PV-CURR-ORD-QTY-UM-CDE       19400002
194100     END-IF.                                                      19410002
194200*                                                                 19420002
194300     IF PV-DTL-PKG-QTY-NULL = PC-NEG-1                            19430002
194400         MOVE ZEROS               TO PV-CURR-PKG-QTY              19440002
194500     ELSE                                                         19450002
194600         MOVE ASNDTL-PKG-QTY      TO PV-CURR-PKG-QTY              19460002
194700     END-IF.                                                      19470002
194800*                                                                 19480002
194900 EJECT                                                            19490002
195000******************************************************************19500002
195100*  THIS PARAGRAPH PROCESSES CASES WHERE DATA EXISTS ON THE DETAIL*19510002
195200*  TABLE BUT NOT ON THE DETAIL PO ITEM ASSOCIATION TABLE.        *19520002
195300******************************************************************19530002
195400 B300-PROCESS-NO-ASN-DTL.                                         19540002
195500*                                                                 19550002
195700     INITIALIZE                         RC001-DETAIL-LAYOUT.      19570002
195800     MOVE PC-N TO RC001-CARTON-IND.                               19580002
195900     MOVE HIGH-VALUES                    TO RC001-PO-LINE-NBR.    19590002
196000     MOVE RC001-ASN-TRANSCRIPTION-KEY    TO PV-DETAIL-KEY.        19600002
196100     MOVE RC001-ASN-COMMON-FIELDS-LAYOUT TO PV-DETAIL-COMMON.     19610002
196200     IF ASNDTL-UPC-NBR      = PV-CURR-UPC-NBR  AND                19620002
196300        ASNDTL-SHIPT-UM-CDE = PV-CURR-SHIPT-UM-CDE                19630002
196400*----------------------------------------------------------------*19640002
196500*                                               **   WR # 230ZZ  *19650002
196600* ADDED CODE TO CALL XLKUT001                                    *19660002
196700*----------------------------------------------------------------*19670002
196800                                                                  19680002
196900         IF PV-CURR-UPC-NBR  > 0                                  19690002
197000            PERFORM S995-CALL-XLKUT-DOMAIN-PGM                    19700002
197100         END-IF                                                   19710002
197200                                                                  19720002
197300*----------------------------------------------------------------*19730002
197400* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *19740002
197500*----------------------------------------------------------------*19750002
197600         PERFORM D250-ACCUM-NO-ASN-LINES                          19760002
197700         PERFORM B400-SAVE-CURRENT-NO-ASN-DATA                    19770002
197800         IF PV-VLD-CART-LBL-IND = 'Y'                             19780002
197900             MOVE PV-SEQUENCE-NBR TO PV-SAVE-SEQUENCE-NBR         19790002
198000             ADD 1 TO PV-SEQUENCE-NBR                             19800002
198100             PERFORM F100-OPEN-CARTON-CURSOR                      19810002
198200             PERFORM F200-FETCH-CARTON-CURSOR                     19820002
198300             SET PS-VALID TO TRUE                                 19830002
198400             PERFORM F300-PROCESS-CARTON-CURSOR                   19840002
198500                 UNTIL PS-END-OF-CARTON                           19850002
198600             PERFORM F400-CLOSE-CARTON-CURSOR                     19860002
198700             MOVE PV-SEQUENCE-NBR TO PV-CARTON-SEQUENCE-NBR       19870002
198800             MOVE PV-SAVE-SEQUENCE-NBR TO PV-SEQUENCE-NBR         19880002
198900         END-IF                                                   19890002
199000     ELSE                                                         19900002
199100*----------------------------------------------------------------*19910002
199200*                                               **   WR # 230ZZ  *19920002
199300* ADDED CODE TO CALL XLKUT001                                    *19930002
199400*----------------------------------------------------------------*19940002
199500                                                                  19950002
199600         IF PV-CURR-UPC-NBR  > 0                                  19960002
199700            PERFORM S995-CALL-XLKUT-DOMAIN-PGM                    19970002
199800         END-IF                                                   19980002
199900                                                                  19990002
200000*----------------------------------------------------------------*20000002
200100* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *20010002
200200*----------------------------------------------------------------*20020002
200300         IF PV-LINE-CNT > PC-50                                   20030002
200400             PERFORM W000-WRITE-REPORT-HEADERS                    20040002
200500         END-IF                                                   20050002
200600         PERFORM D200-FORMAT-NO-ASN-LINES                         20060002
200700         PERFORM W500-WRITE-DETAIL-LINES                          20070002
200800*                                                                 20080002
200900*  ** 04/26/93 **  CHANGE                                         20090002
201000         IF (ASNHDR-DC-PRT-IND NOT = PC-Y AND                     20100002
201200             PS-WRITE-EXTRACT-RECORD)                             20120002
201300             MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR           20130002
201500             PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL               20150002
201600             IF PV-VLD-CART-LBL-IND = 'Y'                         20160002
201700                 IF PV-CARTON-SEQUENCE-NBR <= PV-SEQUENCE-NBR     20170002
201800                     CONTINUE                                     20180002
201900                 ELSE                                             20190002
202000                     MOVE PV-CARTON-SEQUENCE-NBR                  20200002
202100                                  TO PV-SEQUENCE-NBR              20210002
202200                 END-IF                                           20220002
202300                 IF PV-TABLE-SUB > 0                              20230002
202400                     MOVE PC-Y TO PV-CARTON-IND                   20240002
202500                     MOVE PV-SEQUENCE-NBR TO PV-SEQUENCE-NUMBER   20250002
202700                     PERFORM W800-WRITE-ASN-EXTRACT-HDR-DTL       20270002
202800                 ELSE                                             20280002
202900                     IF PS-VALIDATION-ERR                         20290002
203000                         CONTINUE                                 20300002
203100                     ELSE                                         20310002
203200                         MOVE PC-04 TO RC016-ASN-CARTON-ERR       20320002
203300                         PERFORM G100-WRITE-ERROR-FILE            20330002
203400                     END-IF                                       20340002
203500                 END-IF                                           20350002
203600                 MOVE 0 TO PV-TABLE-SUB                           20360002
203700                 MOVE PC-N TO RC001-CARTON-IND                    20370002
203800                 INITIALIZE RC001-DETAIL-LAYOUT                   20380002
203900                 INITIALIZE PV-DETAIL-CARTON-LAYOUT               20390002
204000             END-IF                                               20400002
204100         END-IF                                                   20410002
204200*  ** 04/26/93 **  CHANGE END                                     20420002
204300*                                                                 20430002
204400         PERFORM D250-ACCUM-NO-ASN-LINES                          20440002
204500         PERFORM B400-SAVE-CURRENT-NO-ASN-DATA                    20450002
204600         IF PV-VLD-CART-LBL-IND = 'Y'                             20460002
204700             MOVE PV-SEQUENCE-NBR TO PV-SAVE-SEQUENCE-NBR         20470002
204800             ADD 1 TO PV-SEQUENCE-NBR                             20480002
204900             PERFORM F100-OPEN-CARTON-CURSOR                      20490002
205000             PERFORM F200-FETCH-CARTON-CURSOR                     20500002
205100             SET PS-VALID TO TRUE                                 20510002
205200             PERFORM F300-PROCESS-CARTON-CURSOR                   20520002
205300                 UNTIL PS-END-OF-CARTON                           20530002
205400             PERFORM F400-CLOSE-CARTON-CURSOR                     20540002
205500             MOVE PV-SEQUENCE-NBR                                 20550002
205600                                 TO PV-CARTON-SEQUENCE-NBR        20560002
205700             MOVE PV-SAVE-SEQUENCE-NBR TO PV-SEQUENCE-NBR         20570002
205800         END-IF                                                   20580002
205900     END-IF.                                                      20590002
206000*                                                                 20600002
206100     PERFORM S900-FETCH-ASN-DTL-NOT-EXISTS.                       20610002
206200*                                                                 20620002
206300     EVALUATE TRUE                                                20630002
206400       WHEN SQLCODE = PC-ROW-NOT-FOUND                            20640002
206500*----------------------------------------------------------------*20650002
206600*                                               **   WR # 230ZZ  *20660002
206700* ADDED CODE TO CALL XLKUT001                                    *20670002
206800*----------------------------------------------------------------*20680002
206900                                                                  20690002
207000         IF PV-CURR-UPC-NBR  > 0                                  20700002
207100            PERFORM S995-CALL-XLKUT-DOMAIN-PGM                    20710002
207200         END-IF                                                   20720002
207300                                                                  20730002
207400*----------------------------------------------------------------*20740002
207500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *20750002
207600*----------------------------------------------------------------*20760002
207700         IF PV-LINE-CNT > PC-50                                   20770002
207800             PERFORM W000-WRITE-REPORT-HEADERS                    20780002
207900         END-IF                                                   20790002
208000         PERFORM D200-FORMAT-NO-ASN-LINES                         20800002
208100         PERFORM W500-WRITE-DETAIL-LINES                          20810002
208200*                                                                 20820002
208300*  ** 04/26/93 **  CHANGE                                         20830002
208400         IF (ASNHDR-DC-PRT-IND NOT = PC-Y AND                     20840002
208600             PS-WRITE-EXTRACT-RECORD)                             20860002
208700             MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR           20870002
208900             PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL               20890002
209000             IF PV-VLD-CART-LBL-IND = 'Y'                         20900002
209100                 IF PV-CARTON-SEQUENCE-NBR <= PV-SEQUENCE-NBR     20910002
209200                     CONTINUE                                     20920002
209300                 ELSE                                             20930002
209400                     MOVE PV-CARTON-SEQUENCE-NBR                  20940002
209500                                  TO PV-SEQUENCE-NBR              20950002
209600                 END-IF                                           20960002
209700                 IF PV-TABLE-SUB > 0                              20970002
209800                     MOVE PC-Y TO PV-CARTON-IND                   20980002
209900                     MOVE PV-SEQUENCE-NBR TO PV-SEQUENCE-NUMBER   20990002
210100                     PERFORM W800-WRITE-ASN-EXTRACT-HDR-DTL       21010002
210200                 ELSE                                             21020002
210300                     IF PS-VALIDATION-ERR                         21030002
210400                         CONTINUE                                 21040002
210500                     ELSE                                         21050002
210600                         MOVE PC-04 TO RC016-ASN-CARTON-ERR       21060002
210700                         PERFORM G100-WRITE-ERROR-FILE            21070002
210800                     END-IF                                       21080002
210900                 END-IF                                           21090002
211000                 MOVE 0 TO PV-TABLE-SUB                           21100002
211100                 MOVE PC-N TO RC001-CARTON-IND                    21110002
211200                 INITIALIZE RC001-DETAIL-LAYOUT                   21120002
211300                 INITIALIZE PV-DETAIL-CARTON-LAYOUT               21130002
211400             END-IF                                               21140002
211500         END-IF                                                   21150002
211600*  ** 04/26/93 **  CHANGE END                                     21160002
211700*                                                                 21170002
211800     END-EVALUATE.                                                21180002
211900*                                                                 21190002
212000 EJECT                                                            21200002
212100******************************************************************21210002
212200*  THIS PARAGRAPH SAVES ALL NEEDED FIELDS FROM THE CURRENT ROW   *21220002
212300******************************************************************21230002
212400 B400-SAVE-CURRENT-NO-ASN-DATA.                                   21240002
212500*                                                                 21250002
212600     MOVE ASNDTL-UPC-NBR             TO PV-CURR-UPC-NBR.          21260002
212700     MOVE ASNDTL-ASNDTL-NBR          TO PV-ASNDTL-ASNDTL-NBR.     21270002
212800     MOVE ASNDTL-SHIPT-UM-CDE        TO PV-CURR-SHIPT-UM-CDE.     21280002
212900     MOVE ASNDTL-SHIPT-QTY           TO PV-CURR-SHIPT-QTY         21290002
213000*                                                                 21300002
213100     IF PV-DTL-ORD-QTY-UM-CDE-NULL = PC-NEG-1                     21310002
213200         MOVE ASNDTL-SHIPT-UM-CDE    TO PV-CURR-ORD-QTY-UM-CDE    21320002
213300     ELSE                                                         21330002
213400         MOVE ASNDTL-ORD-QTY-UM-CDE  TO PV-CURR-ORD-QTY-UM-CDE    21340002
213500     END-IF.                                                      21350002
213600*                                                                 21360002
213700     IF PV-DTL-PKG-QTY-NULL = PC-NEG-1                            21370002
213800         MOVE ZEROS                  TO PV-CURR-PKG-QTY           21380002
213900     ELSE                                                         21390002
214000         MOVE ASNDTL-PKG-QTY         TO PV-CURR-PKG-QTY           21400002
214100     END-IF.                                                      21410002
214200*                                                                 21420002
214300 EJECT                                                            21430002
214400******************************************************************21440002
214500*  THIS PARAGRAPH FORMATS THE HEADER LINES WHEN AN ASN NUMBER    *21450002
214600*  CHANGES.                                                      *21460002
214700******************************************************************21470002
214800 D000-FORMAT-HEADER-LINES.                                        21480002
214900*                                                                 21490002
215000     MOVE ZEROS                   TO RC001-SEQUENCE-NBR.          21500002
215100     MOVE ZEROS                   TO PV-SEQUENCE-NBR.             21510002
215200* ** 08/13/92 ** CHANGE                                           21520002
215300     IF CC-PARM-TEST                                              21530002
215400         MOVE PC-TEST             TO PV-H0-TEST-IND               21540002
215500     ELSE                                                         21550002
215600         MOVE SPACES              TO PV-H0-TEST-IND               21560002
215700     END-IF.                                                      21570002
215800* ** 08/13/92 ** CHANGE END                                       21580002
215900*                                                                 21590002
216000     MOVE ASNHDR-OPERCO-NBR       TO RC001-OPERATING-COMPANY.     21600002
216100     MOVE ASNHDR-ASNHDR-NBR       TO PV-H0-ASN-NBR                21610002
216200                                     PV-CURR-ASNHDR-NBR           21620002
216300                                     RC001-ASNHDR-NBR.            21630002
216400*                                                                 21640002
216500     MOVE ASNHDR-SHIP-DTE (1:4)   TO PV-H0-DS-CCYY                21650002
216600                                     PV-CENTURY-DATE-CCYY.        21660002
216700     MOVE ASNHDR-SHIP-DTE (6:2)   TO PV-H0-DS-MM                  21670002
216800                                     PV-CENTURY-DATE-MM.          21680002
216900     MOVE ASNHDR-SHIP-DTE (9:2)   TO PV-H0-DS-DD                  21690002
217000                                     PV-CENTURY-DATE-DD.          21700002
217100     MOVE PV-CENTURY-DATE-MMDDCCYY TO RC001-DATE-SHIPPED          21710002
217200                                      PV-DATE-SHIPPED.            21720002
217300     MOVE ASNORD-PO-NBR           TO PV-H0-PO-NBR                 21730002
217400                                     PV-CURR-PO-NBR.              21740002
217500*                                                                 21750002
217600* ** 10/06/93 ** CHANGE                                           21760002
217700     IF   ASNORD-PO-NBR (1:3)   = 'AMC'                           21770002
217800       MOVE ASNORD-PO-NBR (5:8)     TO DP010I-UNEDITED-FIELD      21780002
217900     ELSE                                                         21790002
218000       MOVE ASNORD-PO-NBR (1:8)     TO DP010I-UNEDITED-FIELD      21800002
218100     END-IF.                                                      21810002
218200     MOVE PC-8                    TO DP010I-MAXIMUM-DIGITS.       21820002
218300     MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS.     21830002
218400     SET DP010I-NEGATIVE-NOT-ALLOWED                              21840002
218500                                  TO TRUE.                        21850002
218600*                                                                 21860002
218700     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21870002
218800          USING DP010I-NUMERIC-EDIT-AREA.                         21880002
218900*                                                                 21890002
219000     IF DP010I-ERROR-DETECTED                                     21900002
219100         DISPLAY 'D000-FORMAT-HEADER-LINES'                       21910002
219200         DISPLAY 'ERROR IN CONVERTING PO NUMBER TO NUMERIC: '     21920002
219300                  DP010I-UNEDITED-FIELD                           21930002
219400     END-IF.                                                      21940002
219500                                                                  21950002
219600     MOVE DP010I-NUMERIC-FIELD    TO PV-UNPK-PONUMB.              21960002
219700     MOVE PV-UNPK-PONUMB          TO RC001-PO-NBR.                21970002
219800* ** 10/06/93 ** CHANGE END                                       21980002
219900*                                                                 21990002
220000     MOVE ZEROS                   TO RC001-PO-LINE-NBR.           22000002
220100     MOVE ASNHDR-BOL-NBR          TO PV-H1-BILL-OF-LADING.        22010002
220200*                                                                 22020002
220300* ** 09/28/93 ** CHANGE                                           22030002
220400     IF PV-HDR-CARR-ID-CDE-NULL = PC-NEG-1                        22040002
220500         MOVE SPACES              TO RC001-CARRIER-SCAC-CODE      22050002
220600     ELSE                                                         22060002
220700         MOVE ASNHDR-CARR-ID-CDE (1:4)                            22070002
220800                                  TO RC001-CARRIER-SCAC-CODE      22080002
220900     END-IF.                                                      22090002
221000* ** 09/28/93 ** CHANGE END                                       22100002
221100*                                                                 22110002
221200     IF PV-HDR-CARR-NAME-NULL = PC-NEG-1                          22120002
221300         IF PV-HDR-CARR-ID-CDE-NULL = PC-NEG-1                    22130002
221400             MOVE SPACES          TO PV-H2-CARRIER-NAME           22140002
221500                                     RC001-CARRIER-NAME           22150002
221600             MOVE ZEROS           TO PV-HDR-CARR-NAME-NULL        22160002
221700*****        MOVE ZEROS           TO PV-HDR-CARR-ID-CDE-NULL      22170002
221800         ELSE                                                     22180002
221900             MOVE ASNHDR-CARR-ID-CDE                              22190002
222000                                  TO PV-H2-CARRIER-NAME           22200002
222100                                     RC001-CARRIER-NAME           22210002
222200         END-IF                                                   22220002
222300     ELSE                                                         22230002
222400         MOVE ASNHDR-CARR-NAME    TO PV-H2-CARRIER-NAME           22240002
222500                                     RC001-CARRIER-NAME           22250002
222600     END-IF.                                                      22260002
222700*                                                                 22270002
222800     IF PV-HDR-PRO-NBR-NULL = PC-NEG-1                            22280002
222900         MOVE SPACES              TO PV-H3-PRO-NUMBER             22290002
223000                                     RC001-PRO-NBR                22300002
223100         MOVE ZEROS               TO PV-HDR-CARR-NAME-NULL        22310002
223200     ELSE                                                         22320002
223300         MOVE ASNHDR-PRO-NBR      TO PV-H3-PRO-NUMBER             22330002
223400                                     RC001-PRO-NBR                22340002
223500     END-IF.                                                      22350002
223600*                                                                 22360002
223700* CLT START WR40574 12-01-2011                                    22370002
223800     MOVE ASNHDR-CARR-AUTH-ID     TO RC001-CARR-AUTH-ID           22380002
223900* CLT END   WR40574 12-01-2011                                    22390002
224000     MOVE MDSEAR-DESC             TO PV-H1-DEPT-DESC              22400002
224100                                     RC001-DEPT-DESC.             22410002
224200*                                                                 22420002
224300*  CONTAINER NUMBER                                               22430002
224400*                                                                 22440002
224500     IF PV-HDR-EQUIP-INIT-CDE-NULL = PC-NEG-1                     22450002
224600        MOVE SPACES TO RC001-CONT-NBR (1:4)                       22460002
224700     ELSE                                                         22470002
224800        MOVE ASNHDR-EQUIP-INIT-CDE TO RC001-CONT-NBR (1:4)        22480002
224900     END-IF.                                                      22490002
225000                                                                  22500002
225100     IF PV-HDR-EQUIP-NBR-NULL = PC-NEG-1                          22510002
225200        MOVE SPACES TO RC001-CONT-NBR (5:8)                       22520002
225300     ELSE                                                         22530002
225400        MOVE ASNHDR-EQUIP-NBR TO RC001-CONT-NBR (5:8)             22540002
225500     END-IF.                                                      22550002
225600*                                                                 22560002
225700     MOVE SPACES                  TO PV-H4-EQUIP-INIT-CDE.        22570002
225800     MOVE SPACES                  TO PV-H4-EQUIP-NBR.             22580002
225900     MOVE SPACES                  TO RC001-TRAILER-NBR.           22590002
226000*                                                                 22600002
226100*  ** 04/20/93 **  CHANGE                                         22610002
226200*                                                                 22620002
226300*  ** 03/14/94 **  CHANGE                                         22630002
226400     SET PS-DONT-ROLL-UP-BOL-FOR-PO       TO TRUE.                22640002
226500*                                                                 22650002
226600*  ** 03/14/94 **  CHANGE END                                     22660002
226700*                                                                 22670002
226800     IF EXTENT-ASN-TRSCP-IND = 'Y'                                22680002
226900        SET RC001-VENDOR-TRSCP-YES        TO TRUE                 22690002
227000        SET PS-WRITE-EXTRACT-RECORD       TO TRUE                 22700002
227100     ELSE                                                         22710002
227200         IF EXTENT-ASN-TRSCP-IND = 'P'                            22720002
227300            SET RC001-CREATE-PACKSLIP         TO TRUE             22730002
227400            SET PS-WRITE-EXTRACT-RECORD       TO TRUE             22740002
227500         ELSE                                                     22750002
227600            SET RC001-VENDOR-TRSCP-NO         TO TRUE             22760002
227700            SET PS-DONT-WRITE-EXTRACT-RECORD  TO TRUE             22770002
227800         END-IF                                                   22780002
227900     END-IF.                                                      22790002
228000                                                                  22800002
228100     INITIALIZE DCLTEXTENT.                                       22810002
228200*                                                                 22820002
228300     IF PV-HDR-CARR-ID-CDE-NULL = PC-NEG-1                        22830002
228400        MOVE SPACES                          TO PV-SCAC-CDE       22840002
228500                                                PV-SCAC-CODE      22850002
228600     ELSE                                                         22860002
228700        MOVE ASNHDR-CARR-ID-CDE              TO PV-SCAC-CDE       22870002
228800                                                PV-SCAC-CODE      22880002
228900     END-IF.                                                      22890002
229000*                                                                 22900002
229100     IF PV-SCAC-CDE-1-4 = SPACES                                  22910002
229200        MOVE ZEROS                        TO RC001-CARR-VEND-ID   22920002
229300     ELSE                                                         22930002
229400        PERFORM R500-GET-ASN-VEND-CARRIER-INFO                    22940002
229500     END-IF.                                                      22950002
229600                                                                  22960002
229700     IF ASNHDR-BOL-NBR = SPACES                                   22970002
229800         PERFORM D400-BOL-NBR-NOT-PRESENT                         22980002
229900     ELSE                                                         22990002
230000         MOVE ASNHDR-BOL-NBR             TO PV-CURR-BOL-NBR       23000002
230100     END-IF.                                                      23010002
230200                                                                  23020002
230300     IF PS-FIRST-ASN-FOR-PO                                       23030002
230400         MOVE PV-CURR-BOL-NBR            TO PV-SAVE-BOL-NBR       23040002
230500     END-IF.                                                      23050002
230600                                                                  23060002
230700*2/3 IF PS-ROLL-UP-BOL-FOR-PO                                     23070002
230800*2/3     MOVE PV-SAVE-BOL-NBR         TO RC001-BILL-OF-LADING-NBR 23080002
230900*2/3     MOVE PV-CURR-BOL-NBR         TO RC001-ORIG-BOL-NBR       23090002
231000*2/3 ELSE                                                         23100002
231100         MOVE PV-CURR-BOL-NBR         TO RC001-BILL-OF-LADING-NBR 23110002
231200                                         RC001-ORIG-BOL-NBR       23120002
231300*2/3     SET RC001-ROLL-UP-VENDOR-NO  TO TRUE                     23130002
231400*2/3 END-IF.                                                      23140002
231500                                                                  23150002
231600     MOVE ASNORD-LOC-NBR          TO RC001-STORE-NBR.             23160002
231700     IF ASNORD-SEQ-NBR-IND = PC-Y                                 23170002
231800         MOVE PC-SEQ-NBR-IND      TO PV-H7-SEQ-NBR-IND            23180002
231900         MOVE ASNORD-SEQ-NBR-IND  TO RC001-SEQ-NBR-IND            23190002
232000     ELSE                                                         23200002
232100         MOVE PC-STR-NBR-IND      TO PV-H7-SEQ-NBR-IND            23210002
232200         MOVE PC-N                TO RC001-SEQ-NBR-IND            23220002
232300     END-IF.                                                      23230002
232400                                                                  23240002
232500     SET DC-STR-NOT-FOUND TO TRUE.                                23250002
232600     IF PV-PACK-BY-STORE-IND = 'Y'                                23260002
232700         PERFORM D050-PBS-DC-STORE-INFO                           23270002
232800     ELSE                                                         23280002
232900         PERFORM D055-BULK-DC-STORE-INFO                          23290002
233000     END-IF                                                       23300002
233100                                                                  23310002
233200     IF PV-TOTAL-CARTONS-SHPMT = ZERO                             23320002
233300         MOVE ASNHDR-CART-SHIP-QTY                                23330002
233400                                  TO PV-H8-TOTAL-CARTONS-SHPMT    23340002
233500                                     RC001-CARTON-CNT-SHPMT       23350002
233600         IF ASNHDR-CART-SHIP-QTY = ZERO                           23360002
233700           MOVE PC-NOT-SENT      TO PV-H8-TOTAL-CARTONS-SHPMT-X   23370002
233800         END-IF                                                   23380002
233900     END-IF.                                                      23390002
234000                                                                  23400002
234100     MOVE PC-N                    TO RC001-LINE-ERROR-IND.        23410002
234200                                                                  23420002
234300 EJECT                                                            23430002
234400******************************************************************23440002
234500*  THIS PARAGRAPH FORMATS THE DC AND STORE HEADING LINES FOR     *23450002
234600*  PACK-BY-STORE ORDERS                                          *23460002
234700******************************************************************23470002
234800 D050-PBS-DC-STORE-INFO.                                          23480002
234900                                                                  23490002
235000     PERFORM T090-EDIT-DO-NOT-SHIP-B4-DATE.                       23500002
235100     PERFORM T110-CHECK-TASHADR-FOR-DC.                           23510002
235200     MOVE ASNORD-LOC-NBR             TO PV-DC-STR-CHECK           23520002
235300     IF DC-STR-FOUND                                              23530002
235400         MOVE XLT00010-LOC-NBR       TO RC001-DIST-CNTR           23540002
235500                                        PV-H6-DC-NBR              23550002
235600         MOVE XLT00010-LOC-NM        TO PV-H6-DC-NAME             23560002
235700         MOVE SPACES                 TO PV-H6-ASTERISK            23570002
235800                                        PV-H6-MESSAGE             23580002
235900         PERFORM T000-OBTAIN-STORE-NAME                           23590002
236000         IF DC-STR-FOUND                                          23600002
236100             MOVE ASNORD-LOC-NBR     TO PV-H7-SEQ-NBR             23610002
236200             MOVE XLT00010-LOC-NM    TO PV-H7-STORE-NAME          23620002
236300             MOVE SPACES             TO PV-H7-ASTERISK            23630002
236400                                        PV-H7-MESSAGE             23640002
236500         ELSE                                                     23650002
236600             MOVE 0                  TO PV-H7-SEQ-NBR             23660002
236700             MOVE PC-UNKNOWN         TO PV-H7-STORE-NAME          23670002
236800             MOVE SPACES             TO PV-H7-ASTERISK            23680002
236900                                        PV-H7-MESSAGE             23690002
237000     ELSE                                                         23700002
237100         PERFORM T115-DC-VALIDATION                               23710002
237200         IF DC-STR-FOUND                                          23720002
237300             MOVE XLT00010-LOC-NBR   TO RC001-DIST-CNTR           23730002
237400                                        PV-H6-DC-NBR              23740002
237500                                        PV-H7-SEQ-NBR             23750002
237600             MOVE XLT00010-LOC-NM    TO PV-H6-DC-NAME             23760002
237700                                        PV-H7-STORE-NAME          23770002
237800             MOVE '*'                TO PV-H6-ASTERISK            23780002
237900             MOVE PC-NOT-SENT        TO PV-H6-MESSAGE             23790002
238000             MOVE SPACES             TO PV-H7-ASTERISK            23800002
238100                                        PV-H7-MESSAGE             23810002
238200         ELSE                                                     23820002
238300            PERFORM T100-VALIDATE-DC                              23830002
238400            IF DC-STR-FOUND                                       23840002
238500               MOVE XL071-ASGMT-DC-NBR                            23850002
238600                                       TO RC001-DIST-CNTR         23860002
238700               MOVE XL071-ASGMT-DC-NBR                            23870002
238800                                       TO PV-H6-DC-NBR            23880002
238900               IF XLT00010-LOC-NM = SPACES                        23890002
239000                  MOVE PC-UNKNOWN      TO PV-H6-DC-NAME           23900002
239100               ELSE                                               23910002
239200                  MOVE XLT00010-LOC-NM TO PV-H6-DC-NAME           23920002
239300               END-IF                                             23930002
239400                                                                  23940002
239500               MOVE XL071-LOCATION-NUMBER                         23950002
239600                                       TO PV-H7-SEQ-NBR           23960002
239700               MOVE XL071-LOC-NM       TO PV-H7-STORE-NAME        23970002
239800                                                                  23980002
239900               MOVE '*'                TO PV-H6-ASTERISK          23990002
240000               MOVE PC-NOT-SENT        TO PV-H6-MESSAGE           24000002
240100               MOVE SPACES             TO PV-H7-ASTERISK          24010002
240200                                          PV-H7-MESSAGE           24020002
240300            ELSE                                                  24030002
240400               MOVE PC-UNKNOWN         TO PV-H6-DC-NAME           24040002
240500                                          PV-H7-STORE-NAME        24050002
240600               MOVE 0                  TO RC001-DIST-CNTR         24060002
240700                                          PV-H6-DC-NBR            24070002
240800                                          PV-H7-SEQ-NBR           24080002
240900               MOVE SPACES             TO PV-H6-ASTERISK          24090002
241000                                          PV-H6-MESSAGE           24100002
241100                                          PV-H7-ASTERISK          24110002
241200                                          PV-H7-MESSAGE           24120002
241300            END-IF                                                24130002
241400         END-IF                                                   24140002
241500     END-IF.                                                      24150002
241600                                                                  24160002
241700******************************************************************24170002
241800*  THIS PARAGRAPH FORMATS THE DC AND STORE HEADING LINES FOR     *24180002
241900*  BULK ORDERS                                                   *24190002
242000******************************************************************24200002
242100 D055-BULK-DC-STORE-INFO.                                         24210002
242200                                                                  24220002
242300     PERFORM T090-EDIT-DO-NOT-SHIP-B4-DATE.                       24230002
242400                                                                  24240002
242500* EVALUATE SHIPMENT AND ORDER LEVEL DC/STORE CODES                24250002
242600     PERFORM T120-EVALUATE-BULK-CODES.                            24260002
242700                                                                  24270002
242800* MOVE OUT H6 & H7 FIELDS BASED ON INDICATORS SET IN T120         24280002
242900     EVALUATE TRUE                                                24290002
243000* 1    SAME DC PASSED AT SHIPMENT AND ORDER LEVELS (WOOHOO!)      24300002
243100       WHEN DC-SHIP-FOUND AND                                     24310002
243200            DC-ORD-FOUND AND                                      24320002
243300            PV-SHIP-NBR = PV-ORD-NBR                              24330002
243400         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        24340002
243500         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       24350002
243600         MOVE SPACES       TO PV-H6-ASTERISK                      24360002
243700         MOVE SPACES       TO PV-H6-MESSAGE                       24370002
243800         MOVE PV-SHIP-NBR  TO PV-H7-SEQ-NBR                       24380002
243900         MOVE PV-SHIP-NAME TO PV-H7-STORE-NAME                    24390002
244000         MOVE SPACES       TO PV-H7-ASTERISK                      24400002
244100         MOVE SPACES       TO PV-H7-MESSAGE                       24410002
244200* 2    DC AT SHIP LEVEL; DIFFERENT DC AT ORDER LEVEL              24420002
244300       WHEN DC-SHIP-FOUND AND                                     24430002
244400            DC-ORD-FOUND AND                                      24440002
244500            PV-SHIP-NBR NOT = PV-ORD-NBR                          24450002
244600         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        24460002
244700         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       24470002
244800         MOVE '*'          TO PV-H6-ASTERISK                      24480002
244900         MOVE PC-UNKNOWN   TO PV-H6-MESSAGE                       24490002
245000         MOVE PV-ORD-NBR   TO PV-H7-SEQ-NBR                       24500002
245100         MOVE PV-ORD-NAME  TO PV-H7-STORE-NAME                    24510002
245200         MOVE '*'          TO PV-H7-ASTERISK                      24520002
245300         MOVE PC-UNKNOWN   TO PV-H7-MESSAGE                       24530002
245400* 3    DC AT SHIP LEVEL; STORE AT ORDER LEVEL                     24540002
245500       WHEN DC-SHIP-FOUND AND                                     24550002
245600            DS-ORD-FOUND                                          24560002
245700         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        24570002
245800         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       24580002
245900         MOVE SPACES       TO PV-H6-ASTERISK                      24590002
246000         MOVE SPACES       TO PV-H6-MESSAGE                       24600002
246100         MOVE PV-ORD-NBR   TO PV-H7-SEQ-NBR                       24610002
246200         MOVE PV-ORD-NAME  TO PV-H7-STORE-NAME                    24620002
246300         MOVE '*'          TO PV-H7-ASTERISK                      24630002
246400         MOVE PC-NOT-PBS   TO PV-H7-MESSAGE                       24640002
246500* 4    DC AT SHIP LEVEL; NOTHING OR JUNK AT ORDER LEVEL           24650002
246600       WHEN DC-SHIP-FOUND AND                                     24660002
246700            DC-ORD-NOT-FOUND AND                                  24670002
246800            DS-ORD-NOT-FOUND                                      24680002
246900         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        24690002
247000         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       24700002
247100         MOVE SPACES       TO PV-H6-ASTERISK                      24710002
247200         MOVE SPACES       TO PV-H6-MESSAGE                       24720002
247300         MOVE 0            TO PV-H7-SEQ-NBR                       24730002
247400         MOVE SPACES       TO PV-H7-STORE-NAME                    24740002
247500         MOVE '*'          TO PV-H7-ASTERISK                      24750002
247600         MOVE PC-NOT-SENT  TO PV-H7-MESSAGE                       24760002
247700* 5    NOTHING OR JUNK AT SHIP LEVEL; DC AT ORDER LEVEL           24770002
247800       WHEN DC-SHIP-NOT-FOUND AND                                 24780002
247900            DS-SHIP-NOT-FOUND AND                                 24790002
248000            DC-ORD-FOUND                                          24800002
248100         MOVE PV-ORD-NBR   TO PV-H6-DC-NBR                        24810002
248200         MOVE PV-ORD-NAME  TO PV-H6-DC-NAME                       24820002
248300         MOVE '*'          TO PV-H6-ASTERISK                      24830002
248400         MOVE PC-NOT-SENT  TO PV-H6-MESSAGE                       24840002
248500         MOVE PV-ORD-NBR   TO PV-H7-SEQ-NBR                       24850002
248600         MOVE PV-ORD-NAME  TO PV-H7-STORE-NAME                    24860002
248700         MOVE SPACES       TO PV-H7-ASTERISK                      24870002
248800         MOVE SPACES       TO PV-H7-MESSAGE                       24880002
248900* 6    STORE AT SHIP LEVEL; STORE AT ORDER LEVEL                  24890002
249000       WHEN DS-SHIP-FOUND AND                                     24900002
249100            DS-ORD-FOUND                                          24910002
249200         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        24920002
249300         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       24930002
249400         MOVE '*'          TO PV-H6-ASTERISK                      24940002
249500         MOVE PC-NOT-PBS   TO PV-H6-MESSAGE                       24950002
249600         MOVE PV-ORD-NBR   TO PV-H7-SEQ-NBR                       24960002
249700         MOVE PV-ORD-NAME  TO PV-H7-STORE-NAME                    24970002
249800         MOVE '*'          TO PV-H7-ASTERISK                      24980002
249900         MOVE PC-NOT-PBS   TO PV-H7-MESSAGE                       24990002
250000* 7    STORE AT SHIP LEVEL; DC AT ORDER LEVEL                     25000002
250100       WHEN DS-SHIP-FOUND AND                                     25010002
250200            DC-ORD-FOUND                                          25020002
250300         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        25030002
250400         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       25040002
250500         MOVE '*'          TO PV-H6-ASTERISK                      25050002
250600         MOVE PC-NOT-PBS   TO PV-H6-MESSAGE                       25060002
250700         MOVE PV-ORD-NBR   TO PV-H7-SEQ-NBR                       25070002
250800         MOVE PV-ORD-NAME  TO PV-H7-STORE-NAME                    25080002
250900         MOVE SPACES       TO PV-H7-ASTERISK                      25090002
251000         MOVE SPACES       TO PV-H7-MESSAGE                       25100002
251100* 8    STORE AT SHIP LEVEL; NOTHING OR JUNK AT ORDER LEVEL        25110002
251200       WHEN DS-SHIP-FOUND AND                                     25120002
251300            DC-ORD-NOT-FOUND AND                                  25130002
251400            DS-ORD-NOT-FOUND                                      25140002
251500         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        25150002
251600         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       25160002
251700         MOVE '*'          TO PV-H6-ASTERISK                      25170002
251800         MOVE PC-NOT-PBS   TO PV-H6-MESSAGE                       25180002
251900         MOVE 0            TO PV-H7-SEQ-NBR                       25190002
252000         MOVE SPACES       TO PV-H7-STORE-NAME                    25200002
252100         MOVE '*'          TO PV-H7-ASTERISK                      25210002
252200         MOVE PC-NOT-SENT  TO PV-H7-MESSAGE                       25220002
252300* 9    NOTHING OR JUNK AT SHIP LEVEL; STORE AT ORDER LEVEL        25230002
252400       WHEN DC-SHIP-NOT-FOUND AND                                 25240002
252500            DS-SHIP-NOT-FOUND AND                                 25250002
252600            DS-ORD-FOUND                                          25260002
252700         MOVE 0            TO PV-H6-DC-NBR                        25270002
252800         MOVE SPACES       TO PV-H6-DC-NAME                       25280002
252900         MOVE '*'          TO PV-H6-ASTERISK                      25290002
253000         MOVE PC-NOT-SENT  TO PV-H6-MESSAGE                       25300002
253100         MOVE PV-ORD-NBR   TO PV-H7-SEQ-NBR                       25310002
253200         MOVE PV-ORD-NAME  TO PV-H7-STORE-NAME                    25320002
253300         MOVE '*'          TO PV-H7-ASTERISK                      25330002
253400         MOVE PC-NOT-PBS   TO PV-H7-MESSAGE                       25340002
253500* 10   NOTHING OR JUNK AT SHIP LEVEL AND ORDER LEVEL              25350002
253600       WHEN DC-SHIP-NOT-FOUND AND                                 25360002
253700            DS-SHIP-NOT-FOUND AND                                 25370002
253800            DC-ORD-NOT-FOUND AND                                  25380002
253900            DS-ORD-NOT-FOUND                                      25390002
254000         MOVE 0            TO PV-H6-DC-NBR                        25400002
254100         MOVE SPACES       TO PV-H6-DC-NAME                       25410002
254200         MOVE '*'          TO PV-H6-ASTERISK                      25420002
254300         MOVE PC-NOT-SENT  TO PV-H6-MESSAGE                       25430002
254400         MOVE 0            TO PV-H7-SEQ-NBR                       25440002
254500         MOVE SPACES       TO PV-H7-STORE-NAME                    25450002
254600         MOVE '*'          TO PV-H7-ASTERISK                      25460002
254700         MOVE PC-NOT-SENT  TO PV-H7-MESSAGE                       25470002
254800* ??   ANYTHING ELSE THAT MAY HAVE BEEN MISSED                    25480002
254900       WHEN OTHER                                                 25490002
255000         MOVE PV-SHIP-NBR  TO PV-H6-DC-NBR                        25500002
255100         MOVE PV-SHIP-NAME TO PV-H6-DC-NAME                       25510002
255200         MOVE '*'          TO PV-H6-ASTERISK                      25520002
255300         MOVE PC-UNKNOWN   TO PV-H6-MESSAGE                       25530002
255400         MOVE PV-ORD-NBR   TO PV-H7-SEQ-NBR                       25540002
255500         MOVE PV-ORD-NAME  TO PV-H7-STORE-NAME                    25550002
255600         MOVE '*'          TO PV-H7-ASTERISK                      25560002
255700         MOVE PC-UNKNOWN   TO PV-H7-MESSAGE                       25570002
255800     END-EVALUATE.                                                25580002
255900*                                                                 25590002
256000******************************************************************25600002
256100*  THIS PARAGRAPH FORMATS THE DETAIL LINES FOR AN ASN NUMBER.    *25610002
256200******************************************************************25620002
256300 D100-FORMAT-ASN-LINES.                                           25630002
256400*                                                                 25640002
256500     IF PV-CURR-PO-LN-NBR = ZEROS                                 25650002
256600         MOVE SPACES              TO PV-DL1-PO-LINE               25660002
256700         MOVE HIGH-VALUES         TO RC001-PO-LINE-NBR            25670002
256800     ELSE                                                         25680002
256900         MOVE PV-CURR-PO-LN-NBR (2:3)                             25690002
257000                                  TO PV-DL1-PO-LINE               25700002
257100         MOVE PV-CURR-PO-LN-NBR   TO RC001-PO-LINE-NBR-9          25710002
257200     END-IF.                                                      25720002
257300*                                                                 25730002
257400     MOVE PURCHS-DEPT-NBR         TO RC001-SKU-DEPT-NBR.          25740002
257500                                                                  25750002
257600     MOVE PURITM-CL-NBR           TO PV-DL1-CLASS.                25760002
257700*                                                                 25770002
257800     MOVE PV-DL1-CLASS            TO RC001-SKU-CLASS-NBR.         25780002
257900     MOVE PURITM-SKU-SEQ-NBR      TO RC001-SKU-SEQ-NBR.           25790002
258000*    MOVE PV-SEQ-NMBR             TO PV-DL1-SEQ                   25800002
258100     MOVE PV-SEQ-NMBR             TO PV-SEQ-NMBR-TEMP.            25810002
258200     MOVE PV-SEQ-NMBR-TEMP        TO RC001-SKU-NBR.               25820002
258300*    MOVE PV-SEQ-NMBR-TEMP(6:3)   TO RC001-SKU-SEQ-NBR.           25830002
258400                                                                  25840002
258500     IF PURCHS-DEPT-NBR > SPACES                                  25850002
258600         MOVE PC-DASH             TO PV-DL1-DASH                  25860002
258700     END-IF.                                                      25870002
258800*                                                                 25880002
258900     MOVE PV-CURR-UPC-NBR         TO PV-UPC-NBR                   25890002
259000                                     RC001-UPC-NBR.               25900002
259100     MOVE PV-UPC-NBR (1:1)        TO PV-DL1-UPC-NBR-1.            25910002
259200     MOVE PV-UPC-NBR (2:8)        TO PV-DL1-UPC-NBR-2-9.          25920002
259300     MOVE PV-UPC-NBR (10:5)       TO PV-DL1-UPC-NBR-10-14.        25930002
259400     MOVE PV-UPC-NBR (15:1)       TO PV-DL1-UPC-NBR-15.           25940002
259500     MOVE PC-DASH                 TO PV-DL1-UPC-DASH1             25950002
259600                                     PV-DL1-UPC-DASH2             25960002
259700                                     PV-DL1-UPC-DASH3.            25970002
259800     MOVE PURITM-VEND-STYL-NAME   TO PV-DL1-VENDOR-STYLE          25980002
259900                                     RC001-VENDOR-STYLE.          25990002
260000     MOVE PURITM-SIZE-DESC        TO PV-DL1-SIZE.                 26000002
260100*CHG0143857 - START                                               26010002
260200*    MOVE PV-SIZE-DESC            TO RC001-SIZE.                  26020002
260300*CHG0143857 - END                                                 26030002
260400     MOVE PURITM-COLOR-DESC       TO PV-DL2-COLOR.                26040002
260500     MOVE ASNHDR-EDIISA-CNTL-NBR  TO PV-DL2-ISA-NBR.              26050002
260600*CHG0143857 - START                                               26060002
260700*    MOVE PV-COLOR-DESC           TO RC001-COLOR.                 26070002
260800*CHG0143857 - END                                                 26080002
260900                                                                  26090002
261000*----------------------------------------------------------------*26100002
261100*                                               **   WR # 230ZZ  *26110002
261200* ADDED CODE TO CALL XLKUT001                                    *26120002
261300*----------------------------------------------------------------*26130002
261400                                                                  26140002
261500         IF PV-CURR-UPC-NBR  > 0                                  26150002
261600            PERFORM S995-CALL-XLKUT-DOMAIN-PGM                    26160002
261700         END-IF                                                   26170002
261800                                                                  26180002
261900*----------------------------------------------------------------*26190002
262000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *26200002
262100*----------------------------------------------------------------*26210002
262200*CHG0143857 - START                                               26220002
262300     MOVE PV-SIZE-DESC            TO RC001-SIZE.                  26230002
262400     MOVE PV-COLOR-DESC           TO RC001-COLOR.                 26240002
262500*CHG0143857 - END                                                 26250002
262600     MOVE PV-VNDR-INNR-PACK-QTY    TO RC001-DIST-PACK-QTY.        26260002
262700                                                                  26270002
262800     MOVE PURITM-UNT-COST-AMT     TO PV-DL1-UNIT-COST             26280002
262900                                     RC001-UNIT-COST.             26290002
263000     MOVE PURITM-UNT-RTL-PR-AMT   TO PV-DL1-UNIT-RETAIL           26300002
263100                                     RC001-UNIT-RETAIL.           26310002
263200*                                                                 26320002
263300*    IF PV-CURR-ORD-QTY-UM-CDE = PC-EACH                          26330002
263400*        COMPUTE PV-DOLLARS-ORDERED =                             26340002
263500*            POCUNRTL * POCTQANT                                  26350002
263600*    ELSE                                                         26360002
263700*        COMPUTE PV-DOLLARS-ORDERED =                             26370002
263800*            (POCUNRTL * POCTQANT * PV-CURR-PKG-QTY)              26380002
263900*    END-IF.                                                      26390002
264000*                                                                 26400002
264100     IF PV-CURR-SHIPT-UM-CDE = PC-EACH OR                         26410002
264200        PV-CURR-PKG-QTY-NULL = PC-NEG-1                           26420002
264300         COMPUTE PV-DOLLARS-SHIPPED =                             26430002
264400         PURITM-UNT-RTL-PR-AMT * PV-CURR-ASSOC-QTY                26440002
264500     ELSE                                                         26450002
264600         COMPUTE PV-DOLLARS-SHIPPED =                             26460002
264700     (PURITM-UNT-RTL-PR-AMT * PV-CURR-ASSOC-QTY * PV-CURR-PKG-QTY)26470002
264800     END-IF.                                                      26480002
264900*                                                                 26490002
265000     MOVE PURITM-TOT-VAL-RTL-AMT  TO PV-DL1-DOL-ORDERED.          26500002
265100     MOVE PV-DOLLARS-SHIPPED      TO PV-DL1-DOL-SHIPPED.          26510002
265200     MOVE PURITM-UNT-QTY          TO PV-DL1-QTY-ORDERED           26520002
265300                                     RC001-QTY-ORDERED.           26530002
265400     MOVE PV-CURR-ASSOC-QTY       TO PV-DL1-QTY-SHIPPED           26540002
265500                                     RC001-QTY-SHIPPED.           26550002
265600     MOVE PV-CURR-PR-CHG-EFF-DAY-NBR                              26560002
265700                                  TO RC001-PR-CHG-EFF-DAYS.       26570002
265800     MOVE PURITM-UM-IND           TO PV-DL1-UNIT-MSR-1            26580002
265900                                     RC001-QTY-ORDERED-UM.        26590002
266000     MOVE PURITM-SKU-DESC         TO PV-DL2-UPC-DESCRIPTION       26600002
266100                                     RC001-UPC-DESC.              26610002
266200     MOVE PV-CURR-SHIPT-UM-CDE    TO PV-DL1-UNIT-MSR-2            26620002
266300                                     RC001-QTY-SHIPPED-UM.        26630002
266400*                                                                 26640002
266500     ADD PV-DOLLARS-SHIPPED       TO PV-DTL-TTL-DLLRS-SHIPD.      26650002
266600     ADD PURITM-TOT-VAL-RTL-AMT   TO PV-DTL-TTL-DLLRS-ORD.        26660002
266700     ADD PURITM-UNT-QTY           TO PV-DTL-TTL-QTY-ORD.          26670002
266800     ADD PV-CURR-ASSOC-QTY        TO PV-DTL-TTL-QTY-SHIP.         26680002
266900*                                                                 26690002
267000     MOVE ZEROS                   TO PV-CURR-ASSOC-QTY.           26700002
267100*                                                                 26710002
267200 EJECT                                                            26720002
267300******************************************************************26730002
267400*  THIS PARAGRAPH FORMATS THE DETAIL LINES FOR NO ASN NUMBER.    *26740002
267500******************************************************************26750002
267600 D200-FORMAT-NO-ASN-LINES.                                        26760002
267700*                                                                 26770002
267800     MOVE SPACES                  TO PV-DL1-PO-LINE.              26780002
267900     MOVE HIGH-VALUES             TO RC001-PO-LINE-NBR.           26790002
268000     MOVE PC-N                    TO RC001-ASDTPL-ALLOC-IND       26800002
268100                                     RC001-ASDTPL-MATCH-IND       26810002
268200                                     RC001-ASDTPL-PR-DISC-IND     26820002
268300                                     RC001-ASDTPL-PR-VAR-IND.     26830002
268400*                                                                 26840002
268500     MOVE PV-MERCH-DEPT-NMBR      TO RC001-SKU-DEPT-NBR.          26850002
268600                                                                  26860002
268700     MOVE PV-MERCH-CLASS-NMBR     TO PV-DL1-CLASS                 26870002
268800                                     RC001-SKU-CLASS-NBR.         26880002
268900*    MOVE PV-SEQ-NMBR             TO PV-DL1-SEQ.                  26890002
269000                                                                  26900002
269100     MOVE PV-SEQ-NMBR             TO PV-SEQ-NMBR-TEMP.            26910002
269200     MOVE PV-SEQ-NMBR-TEMP        TO RC001-SKU-NBR.               26920002
269300     MOVE PV-SEQ-NMBR-TEMP(6:3)   TO RC001-SKU-SEQ-NBR.           26930002
269400                                                                  26940002
269500     IF PV-MERCH-DEPT-NMBR > SPACES                               26950002
269600         MOVE PC-DASH             TO PV-DL1-DASH                  26960002
269700     END-IF.                                                      26970002
269800*                                                                 26980002
269900     MOVE PV-CURR-UPC-NBR         TO PV-UPC-NBR                   26990002
270000                                     RC001-UPC-NBR.               27000002
270100     MOVE PV-UPC-NBR (1:1)        TO PV-DL1-UPC-NBR-1.            27010002
270200     MOVE PV-UPC-NBR (2:8)        TO PV-DL1-UPC-NBR-2-9.          27020002
270300     MOVE PV-UPC-NBR (10:5)       TO PV-DL1-UPC-NBR-10-14.        27030002
270400     MOVE PV-UPC-NBR (15:1)       TO PV-DL1-UPC-NBR-15.           27040002
270500     MOVE PC-DASH                 TO PV-DL1-UPC-DASH1             27050002
270600                                     PV-DL1-UPC-DASH2             27060002
270700                                     PV-DL1-UPC-DASH3.            27070002
270800     MOVE PV-VENDOR-STYLE-CODE    TO PV-DL1-VENDOR-STYLE          27080002
270900                                     RC001-VENDOR-STYLE.          27090002
271000     MOVE PV-SIZE-DESC            TO PV-DL1-SIZE                  27100002
271100                                     RC001-SIZE.                  27110002
271200     MOVE PV-COLOR-DESC           TO PV-DL2-COLOR                 27120002
271300                                     RC001-COLOR.                 27130002
271400     MOVE ASNHDR-EDIISA-CNTL-NBR  TO PV-DL2-ISA-NBR.              27140002
271500     MOVE PV-UNIT-COST-AMT        TO PV-DL1-UNIT-COST             27150002
271600                                     RC001-UNIT-COST.             27160002
271700     MOVE PV-CUR-UNIT-RTL-AMT     TO PV-DL1-UNIT-RETAIL           27170002
271800                                     RC001-UNIT-RETAIL.           27180002
271900*                                                                 27190002
272000     MOVE ZEROS                   TO PV-DL1-DOL-ORDERED.          27200002
272100     MOVE PV-DOLLARS-SHIPPED      TO PV-DL1-DOL-SHIPPED.          27210002
272200     MOVE ZEROS                   TO PV-DL1-QTY-ORDERED           27220002
272300                                     RC001-QTY-ORDERED.           27230002
272400     MOVE PV-CURR-ASSOC-QTY       TO PV-DL1-QTY-SHIPPED           27240002
272500                                     RC001-QTY-SHIPPED.           27250002
272600     MOVE SPACES                  TO PV-DL1-UNIT-MSR-1            27260002
272700                                     RC001-QTY-ORDERED-UM.        27270002
272800     MOVE PV-SKU-DESC             TO PV-DL2-UPC-DESCRIPTION       27280002
272900                                     RC001-UPC-DESC.              27290002
273000     MOVE PV-CURR-SHIPT-UM-CDE    TO PV-DL1-UNIT-MSR-2            27300002
273100                                     RC001-QTY-SHIPPED-UM.        27310002
273200     MOVE ZEROS                   TO PV-CURR-ASSOC-QTY.           27320002
273300     MOVE ZEROS                   TO PV-DOLLARS-SHIPPED.          27330002
273400*                                                                 27340002
273500******************************************************************27350002
273600*  THIS PARAGRAPH ACCUMULATES DETAIL LINE INFO FOR NO ASN NUMBER.*27360002
273700******************************************************************27370002
273800 D250-ACCUM-NO-ASN-LINES.                                         27380002
273900                                                                  27390002
274000     MOVE ASNDTL-SHIPT-QTY        TO PV-CURR-ASSOC-QTY-CALC.      27400002
274100     ADD  ASNDTL-SHIPT-QTY        TO PV-CURR-ASSOC-QTY            27410002
274200                                     PV-DTL-TTL-QTY-SHIP.         27420002
274300                                                                  27430002
274400     IF PV-CURR-SHIPT-UM-CDE = PC-EACH OR                         27440002
274500        PV-CURR-PKG-QTY-NULL = PC-NEG-1                           27450002
274600         COMPUTE PV-HOLD-DOLLARS-SHIPPED =                        27460002
274700             PV-CUR-UNIT-RTL-AMT * PV-CURR-ASSOC-QTY-CALC         27470002
274800     ELSE                                                         27480002
274900         COMPUTE PV-HOLD-DOLLARS-SHIPPED =                        27490002
275000             PV-CUR-UNIT-RTL-AMT *                                27500002
275100             PV-CURR-ASSOC-QTY-CALC *                             27510002
275200             PV-CURR-PKG-QTY                                      27520002
275300     END-IF.                                                      27530002
275400                                                                  27540002
275500     ADD  PV-HOLD-DOLLARS-SHIPPED TO PV-DOLLARS-SHIPPED           27550002
275600                                     PV-DTL-TTL-DLLRS-SHIPD.      27560002
275700                                                                  27570002
275800******************************************************************27580002
275900*  THIS PARAGRAPH FORMATS THE DETAIL TOTAL LINES.                *27590002
276000******************************************************************27600002
276100 D300-FORMAT-DETAIL-TOTALS.                                       27610002
276200*                                                                 27620002
276300     MOVE PV-DTL-TTL-DLLRS-ORD    TO PV-DTL1-DOL-ORDERED.         27630002
276400     MOVE PV-DTL-TTL-DLLRS-SHIPD  TO PV-DTL1-DOL-SHIPPED.         27640002
276500     MOVE PV-DTL-TTL-QTY-ORD      TO PV-DTL1-QTY-ORDERED.         27650002
276600     MOVE PV-DTL-TTL-QTY-SHIP     TO PV-DTL1-QTY-SHIPPED.         27660002
276700*                                                                 27670002
276800     MOVE ZEROS                   TO PV-DTL-TTL-DLLRS-ORD         27680002
276900                                     PV-DTL-TTL-DLLRS-SHIPD       27690002
277000                                     PV-DTL-TTL-QTY-ORD           27700002
277100                                     PV-DTL-TTL-QTY-SHIP.         27710002
277200*                                                                 27720002
277300 EJECT                                                            27730002
277400******************************************************************27740002
277500*  IF THE BILL OF LADING NUMBER IS NOT SUPPLIED FOR THIS ASN,    *27750002
277600*  THEN USE THE TRAILER NUMBER, OR THE PRO NUMBER.  IF NEITHER   *27760002
277700*  ARE PRESENT, THEN LEAVE BOL NUMBER BLANK.  A PO CANNOT BE     *27770002
277800*  ROLLED UP WITHOUT SOMETHING IN THIS BOL NUMBER FIELD.         *27780002
277900******************************************************************27790002
278000*                                                                 27800002
278100 D400-BOL-NBR-NOT-PRESENT.                                        27810002
278200*                                                                 27820002
278300     MOVE 'D400'                  TO PGM-LOCATION.                27830002
278400     MOVE 'D400-BOL-NBR-NOT-PRESENT    '                          27840002
278500                                  TO PV-ABEND-PARAGRAPH.          27850002
278600*                                                                 27860002
278700     EVALUATE TRUE                                                27870002
278800       WHEN RC001-PRO-NBR NOT = SPACES                            27880002
278900         MOVE RC001-PRO-NBR             TO PV-CURR-BOL-NBR        27890002
279000       WHEN OTHER                                                 27900002
279100         MOVE SPACES                    TO PV-CURR-BOL-NBR        27910002
279200         SET PS-DONT-ROLL-UP-BOL-FOR-PO TO TRUE                   27920002
279300     END-EVALUATE.                                                27930002
279400 EJECT                                                            27940002
279500 E100-OPEN-CARTON-CURSOR.                                         27950002
279600     MOVE 'E100'                  TO PGM-LOCATION.                27960002
279700     MOVE 'E100-OPEN-CARTON-CURSOR'                               27970002
279800                                  TO PV-ABEND-PARAGRAPH.          27980002
279900                                                                  27990002
280000     EXEC SQL                                                     28000002
280100         OPEN ASN_CARTON_CURSOR                                   28010002
280200     END-EXEC.                                                    28020002
280300                                                                  28030002
280400     EVALUATE TRUE                                                28040002
280500       WHEN SQLCODE         = ZERO                                28050002
280600       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    28060002
280700         CONTINUE                                                 28070002
280800       WHEN OTHER                                                 28080002
280900         DISPLAY PV-ABEND-PARAGRAPH                               28090002
281000         PERFORM Z999-SQL-ERROR                                   28100002
281100     END-EVALUATE.                                                28110002
281200                                                                  28120002
281300 EJECT                                                            28130002
281400 E200-FETCH-CARTON-CURSOR.                                        28140002
281500     MOVE 'E200'                  TO PGM-LOCATION.                28150002
281600     MOVE 'E200-FETCH-CARTON-CURSOR'                              28160002
281700                                  TO PV-ABEND-PARAGRAPH.          28170002
281800                                                                  28180002
281900     EXEC SQL                                                     28190002
282000         FETCH ASN_CARTON_CURSOR                                  28200002
282100           INTO :PV-ASDTPL-ASSOC-QTY,                             28210002
282200                :ASNCAR-ASNCAR-NBR,                               28220002
282300                :PV-ASNDTL-UPC-NBR,                               28230002
282400                :ASNCAR-PKG-QTY:PV-PKG-QTY-NULL                   28240002
282500     END-EXEC.                                                    28250002
282600                                                                  28260002
282700     EVALUATE TRUE                                                28270002
282800       WHEN SQLCODE = ZEROS                                       28280002
282900         SET PS-NOT-END-OF-CARTON TO TRUE                         28290002
283000                                                                  28300002
283100       WHEN SQLCODE = PC-ROW-NOT-FOUND                            28310002
283200         SET PS-END-OF-CARTON     TO TRUE                         28320002
283300                                                                  28330002
283400       WHEN OTHER                                                 28340002
283500         DISPLAY PV-ABEND-PARAGRAPH                               28350002
283600         PERFORM Z999-SQL-ERROR                                   28360002
283700     END-EVALUATE.                                                28370002
283800                                                                  28380007
283900 EJECT                                                            28390002
284000 E300-PROCESS-CARTON-CURSOR.                                      28400002
284120                                                                  28412002
284130     SET PS-VALID TO TRUE.                                        28413002
284140     MOVE ASNCAR-ASNCAR-NBR   TO PV-ASNCAR-REDEF.                 28414002
284150     IF PV-ASNCAR-FIRST-2 NOT = PC-00                             28415002
284160         MOVE PC-01 TO RC016-ASN-CARTON-ERR                       28416002
284170         SET PS-VALIDATION-ERR TO TRUE                            28417002
284180     ELSE                                                         28418002
284190         IF PV-ASNCAR-3-20 IS NOT NUMERIC                         28419002
284200             MOVE PC-02 TO RC016-ASN-CARTON-ERR                   28420002
284300             SET PS-VALIDATION-ERR TO TRUE                        28430002
284400         ELSE                                                     28440002
284500             IF PV-ASNCAR-21-40 > SPACES                          28450002
284600                 MOVE PC-03 TO RC016-ASN-CARTON-ERR               28460002
284700                 SET PS-VALIDATION-ERR TO TRUE                    28470002
284800             END-IF                                               28480002
284900         END-IF                                                   28490002
285000     END-IF.                                                      28500002
285100     IF PS-VALID                                                  28510002
285200         ADD 1 TO PV-TABLE-SUB                                    28520002
285300         IF PV-TABLE-SUB > 10                                     28530002
285400             MOVE PC-Y TO RC001-CARTON-IND                        28540002
285500             MOVE PV-SEQUENCE-NBR TO RC001-SEQUENCE-NBR           28550002
285700             PERFORM W700-WRITE-ASN-EXTRACT-HDR-DTL               28570002
285800             INITIALIZE RC001-DETAIL-CARTON-LAYOUT                28580002
285900             MOVE 1 TO PV-TABLE-SUB                               28590002
286000         END-IF                                                   28600002
286100         IF PV-PKG-QTY-NULL = 0                                   28610002
286200            MOVE ASNCAR-PKG-QTY TO                                28620002
286300               RC001-CARTON-QTY (PV-TABLE-SUB)                    28630002
286400         ELSE                                                     28640002
286500            MOVE PV-ASDTPL-ASSOC-QTY TO                           28650002
286600               RC001-CARTON-QTY (PV-TABLE-SUB)                    28660002
286700         END-IF                                                   28670002
286800         MOVE PV-ASNCAR-3-20    TO RC001-CARTON-NBR (PV-TABLE-SUB)28680002
286900         MOVE PV-ASNDTL-UPC-NBR TO RC001-CTN-UPC(PV-TABLE-SUB)    28690002
287000     ELSE                                                         28700002
287100         PERFORM G100-WRITE-ERROR-FILE                            28710002
287200     END-IF.                                                      28720002
287300     PERFORM E200-FETCH-CARTON-CURSOR.                            28730002
287400                                                                  28740002
287500 E400-CLOSE-CARTON-CURSOR.                                        28750002
287600     MOVE 'E400'                  TO PGM-LOCATION.                28760002
287700     MOVE 'E400-CLOSE-CARTON-CURSOR'                              28770002
287800                                  TO PV-ABEND-PARAGRAPH.          28780002
287900                                                                  28790002
288000     EXEC SQL                                                     28800002
288100         CLOSE ASN_CARTON_CURSOR                                  28810002
288200     END-EXEC.                                                    28820002
288300                                                                  28830002
288400     EVALUATE TRUE                                                28840002
288500       WHEN SQLCODE         = ZERO                                28850002
288600       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    28860002
288700         CONTINUE                                                 28870002
288800       WHEN OTHER                                                 28880002
288900         DISPLAY PV-ABEND-PARAGRAPH                               28890002
289000         PERFORM Z999-SQL-ERROR                                   28900002
289100     END-EVALUATE.                                                28910002
289200                                                                  28920002
289300 EJECT                                                            28930002
289400 F100-OPEN-CARTON-CURSOR.                                         28940002
289500     MOVE 'F100'                  TO PGM-LOCATION.                28950002
289600     MOVE 'F100-OPEN-CARTON-CURSOR'                               28960002
289700                                  TO PV-ABEND-PARAGRAPH.          28970002
289800                                                                  28980002
289900     EXEC SQL                                                     28990002
290000         OPEN ASN_CRN_NO_DTL_CSR                                  29000002
290100     END-EXEC.                                                    29010002
290200                                                                  29020002
290300     EVALUATE TRUE                                                29030002
290400       WHEN SQLCODE         = ZERO                                29040002
290500       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    29050002
290600         CONTINUE                                                 29060002
290700       WHEN OTHER                                                 29070002
290800         DISPLAY PV-ABEND-PARAGRAPH                               29080002
290900         PERFORM Z999-SQL-ERROR                                   29090002
291000     END-EVALUATE.                                                29100002
291100                                                                  29110002
291200 EJECT                                                            29120002
291300 F200-FETCH-CARTON-CURSOR.                                        29130002
291400     MOVE 'F200'                  TO PGM-LOCATION.                29140002
291500     MOVE 'F200-FETCH-CARTON-CURSOR'                              29150002
291600                                  TO PV-ABEND-PARAGRAPH.          29160002
291700                                                                  29170002
291800     EXEC SQL                                                     29180002
291900         FETCH ASN_CRN_NO_DTL_CSR                                 29190002
292000           INTO :PV-ASNDTL-SHIPT-QTY,                             29200002
292100                :ASNCAR-ASNCAR-NBR,                               29210002
292200                :PV-ASNDTL-UPC-NBR,                               29220002
292300                :ASNCAR-PKG-QTY:PV-PKG-QTY-NULL                   29230002
292400     END-EXEC.                                                    29240002
292500                                                                  29250002
292600     EVALUATE TRUE                                                29260002
292700       WHEN SQLCODE = ZEROS                                       29270002
292800         SET PS-NOT-END-OF-CARTON TO TRUE                         29280002
292900                                                                  29290002
293000       WHEN SQLCODE = PC-ROW-NOT-FOUND                            29300002
293100         SET PS-END-OF-CARTON     TO TRUE                         29310002
293200                                                                  29320002
293300       WHEN OTHER                                                 29330002
293400         DISPLAY PV-ABEND-PARAGRAPH                               29340002
293500         PERFORM Z999-SQL-ERROR                                   29350002
293600     END-EVALUATE.                                                29360002
293700                                                                  29370007
293900 F300-PROCESS-CARTON-CURSOR.                                      29390002
294000     SET PS-VALID TO TRUE.                                        29400002
294100     MOVE ASNCAR-ASNCAR-NBR   TO PV-ASNCAR-REDEF.                 29410002
294200     IF PV-ASNCAR-FIRST-2 NOT = PC-00                             29420002
294300         MOVE PC-01 TO RC016-ASN-CARTON-ERR                       29430002
294400         SET PS-VALIDATION-ERR TO TRUE                            29440002
294500     ELSE                                                         29450002
294600         IF PV-ASNCAR-3-20 IS NOT NUMERIC                         29460002
294700             MOVE PC-02 TO RC016-ASN-CARTON-ERR                   29470002
294800             SET PS-VALIDATION-ERR TO TRUE                        29480002
294900         ELSE                                                     29490002
295000             IF PV-ASNCAR-21-40 > SPACES                          29500002
295100                 MOVE PC-03 TO RC016-ASN-CARTON-ERR               29510002
295200                 SET PS-VALIDATION-ERR TO TRUE                    29520002
295300             END-IF                                               29530002
295400         END-IF                                                   29540002
295500     END-IF.                                                      29550002
295600     IF PS-VALID                                                  29560002
295700         ADD 1 TO PV-TABLE-SUB                                    29570002
295800         IF PV-TABLE-SUB > 10                                     29580002
295900             MOVE PC-Y TO PV-CARTON-IND                           29590002
296000             MOVE PV-SEQUENCE-NBR TO PV-SEQUENCE-NUMBER           29600002
296100             PERFORM W800-WRITE-ASN-EXTRACT-HDR-DTL               29610002
296200             INITIALIZE PV-DETAIL-CARTON-LAYOUT                   29620002
296300             MOVE 1 TO PV-TABLE-SUB                               29630002
296400         END-IF                                                   29640002
296500         IF PV-PKG-QTY-NULL = 0                                   29650002
296600            MOVE ASNCAR-PKG-QTY TO                                29660002
296700               PV-CARTON-QTY (PV-TABLE-SUB)                       29670002
296800         ELSE                                                     29680002
296900            MOVE PV-ASNDTL-SHIPT-QTY TO                           29690002
297000               PV-CARTON-QTY (PV-TABLE-SUB)                       29700002
297100         END-IF                                                   29710002
297200         MOVE PV-ASNCAR-3-20    TO PV-CARTON-NBR (PV-TABLE-SUB)   29720002
297300         MOVE PV-ASNDTL-UPC-NBR TO PV-CTN-UPC(PV-TABLE-SUB)       29730002
297400     ELSE                                                         29740002
297500         PERFORM G100-WRITE-ERROR-FILE                            29750002
297600     END-IF.                                                      29760002
297700     PERFORM F200-FETCH-CARTON-CURSOR.                            29770002
297800                                                                  29780002
297900 F400-CLOSE-CARTON-CURSOR.                                        29790002
298000     MOVE 'F400'                  TO PGM-LOCATION.                29800002
298100     MOVE 'F400-CLOSE-CARTON-CURSOR'                              29810002
298200                                  TO PV-ABEND-PARAGRAPH.          29820002
298300                                                                  29830002
298400     EXEC SQL                                                     29840002
298500         CLOSE ASN_CRN_NO_DTL_CSR                                 29850002
298600     END-EXEC.                                                    29860002
298700                                                                  29870002
298800     EVALUATE TRUE                                                29880002
298900       WHEN SQLCODE         = ZERO                                29890002
299000       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    29900002
299100         CONTINUE                                                 29910002
299200       WHEN OTHER                                                 29920002
299300         DISPLAY PV-ABEND-PARAGRAPH                               29930002
299400         PERFORM Z999-SQL-ERROR                                   29940002
299500     END-EVALUATE.                                                29950002
299600                                                                  29960002
299700 EJECT                                                            29970002
299800 G100-WRITE-ERROR-FILE.                                           29980002
299900     MOVE 'G100'                  TO PGM-LOCATION.                29990002
300000     MOVE 'G100-WRITE-ERROR-FILE' TO PV-ABEND-PARAGRAPH.          30000002
300100                                                                  30010002
300200     ADD 1 TO PV-ASN-ERROR-RECS-WRITTEN.                          30020002
300300     IF RC016-ASN-CARTON-ERR = PC-04                              30030002
300400         MOVE SPACES              TO RC016-ASN-CARTON-NBR         30040002
300500     ELSE                                                         30050002
300600         MOVE ASNCAR-ASNCAR-NBR   TO RC016-ASN-CARTON-NBR         30060002
300700     END-IF.                                                      30070002
300800     MOVE RC001-PO-NBR        TO RC016-ASN-CARTON-PO.             30080002
300900     MOVE PV-CURR-ASNHDR-NBR  TO RC016-ASN-ASNHDR-NBR.            30090002
301000     MOVE PV-DATE-SHIPPED     TO RC016-ASN-DATE-SHIPPED.          30100002
301100     MOVE RC001-PO-LINE-NBR-9 TO RC016-ASN-PO-LINE-NBR-9.         30110002
301200     MOVE RC001-STORE-NBR     TO RC016-ASN-STORE-NBR.             30120002
301300     MOVE RC001-EDI-VEND-ID   TO RC016-ASN-VENDOR-NBR.            30130002
301400     MOVE RC001-DIST-CNTR     TO RC016-ASN-OPER-UNIT.             30140002
301500                                                                  30150002
301600     WRITE ASN-CARTON-ERROR-RECORD                                30160002
301700         FROM RC016-ASN-CARTON-ERRORS.                            30170002
301800                                                                  30180002
301900******************************************************************30190002
302000*  GETS THE VENDOR NAME FROM THE EXTERNAL ENTITY (TEXTENT) AND   *30200002
302100*  ENTITY NAME (TENTNME) DB2 TABLES.                             *30210002
302200******************************************************************30220002
302300 R000-GET-VENDOR-NAME.                                            30230002
302400                                                                  30240007
302600     MOVE 'R000'                  TO PGM-LOCATION.                30260002
302700     MOVE 'R000-GET-VENDOR-NAME      '                            30270002
302800                                  TO PV-ABEND-PARAGRAPH.          30280002
302900                                                                  30290007
303000     INITIALIZE DCLTEXTENT                                        30300002
303100                DCLTENTNME.                                       30310002
303200                                                                  30320007
303300     MOVE ASNHDR-EDI-VEND-ID      TO PV-EDI-VEND-ID.              30330002
303400                                                                  30340007
303500     EXEC SQL                                                     30350002
303600        SELECT A.DUN_NBR                                          30360002
303700              ,A.ASN_TRSCP_IND                                    30370002
303800              ,A.VLD_CART_LBL_IND                                 30380002
303900              ,B.ENT_NAME_DESC                                    30390002
304000        INTO :EXTENT-DUN-NBR                                      30400002
304100            ,:EXTENT-ASN-TRSCP-IND                                30410002
304200            ,:EXTENT-VLD-CART-LBL-IND                             30420002
304300            ,:ENTNME-ENT-NAME-DESC                                30430002
304400        FROM TEXTENT A,                                           30440002
304500             TENTNME B                                            30450002
304600        WHERE A.DUN_NBR  = :PV-EDI-VEND-ID-1-9                    30460002
304700          AND A.ENT_ID   =  B.ENT_ID                              30470002
304800          AND B.TYPE_CDE = :PC-01                                 30480002
304900        WITH UR                                                   30490002
305000     END-EXEC.                                                    30500002
305100                                                                  30510002
305200     EVALUATE TRUE                                                30520002
305300       WHEN SQLCODE = ZEROS                                       30530002
305400         MOVE ENTNME-ENT-NAME-DESC TO PV-H1-VENDOR-NAME           30540002
305500                                      RC001-EDI-VEND-NAME         30550002
305600         MOVE EXTENT-DUN-NBR       TO RC001-EDI-VEND-ID           30560002
305700         MOVE EXTENT-VLD-CART-LBL-IND                             30570002
305800                                   TO PV-VLD-CART-LBL-IND         30580002
305900         MOVE EXTENT-ASN-TRSCP-IND TO PV-H5A-ASN-TRSCP-IND        30590002
306000         MOVE EXTENT-VLD-CART-LBL-IND TO PV-H5B-CART-LBL-IND      30600002
306100         IF ASNHDR-ASNHDR-NBR IS NOT = PV-DISPLAY-ASNHDR          30610002
306200             DISPLAY 'R000-GET-VEND-NME ASN '                     30620002
306210             ASNHDR-ASNHDR-NBR ' DUN NBR '                        30621003
306220             PV-EDI-VEND-ID-1-9 ' - ASN-TRSCP-IND OF '            30622003
306230             EXTENT-ASN-TRSCP-IND ' - VLD-CART-LBL-IND OF '       30623003
306600             EXTENT-VLD-CART-LBL-IND                              30660002
306700             MOVE ASNHDR-ASNHDR-NBR  TO PV-DISPLAY-ASNHDR         30670002
306800         END-IF                                                   30680002
306900       WHEN SQLCODE = PC-ROW-NOT-FOUND                            30690002
307000       WHEN SQLCODE = PC-DUPLICATE                                30700002
307100         MOVE ZEROS                TO RC001-EDI-VEND-ID           30710002
307200         PERFORM R050-GET-VENDOR-DESC                             30720002
307300                                                                  30730002
307400       WHEN OTHER                                                 30740002
307500         DISPLAY PV-ABEND-PARAGRAPH                               30750002
307600         DISPLAY 'EDI VENDOR ID: '                                30760002
307700                  ASNHDR-EDI-VEND-ID                              30770002
307800         DISPLAY 'ASN HEADER NUMBER: '                            30780002
307900                  ASNHDR-ASNHDR-NBR                               30790002
308000         DISPLAY 'PO NUMBER: '                                    30800002
308100                  ASNORD-PO-NBR                                   30810002
308200         DISPLAY 'CART LBL IND: '                                 30820002
308300                  PV-VLD-CART-LBL-IND                             30830002
308400         PERFORM Z999-SQL-ERROR                                   30840002
308500     END-EVALUATE.                                                30850002
308600                                                                  30860002
308700 EJECT                                                            30870002
308800                                                                  30880002
308900******************************************************************30890002
309000*  GET EXTENT-ASN-TRSCP-IND IF DECONSOLIDATOR                     30900002
309100******************************************************************30910002
309200 R025-GET-IMPORT-IND.                                             30920002
309510                                                                  30951002
309520     MOVE 'R025'                  TO PGM-LOCATION.                30952002
309530     MOVE 'R025-GET-IMPORT-IND       '                            30953002
309540                                  TO PV-ABEND-PARAGRAPH.          30954002
309550                                                                  30955007
309560     PERFORM R035-CHECK-TRADING-PART                              30956002
309570                                                                  30957007
309580     IF CNTL-NBR-NOT-FOUND                                        30958002
309590        CONTINUE                                                  30959002
309600     ELSE                                                         30960002
309700        MOVE WS-TRADING-PARTNER(SUB2) TO WS-PARTNER               30970002
309800        MOVE WS-TRADING-PARTNER-ID(SUB2) TO WS-PARTNER-ID         30980002
309900        EXEC SQL                                                  30990002
310000           SELECT A.ASN_TRSCP_IND, A.VLD_CART_LBL_IND,            31000002
310100                  B.INACTV_DTE                                    31010002
310200           INTO :EXTENT-ASN-TRSCP-IND                             31020002
310300               ,:EXTENT-VLD-CART-LBL-IND                          31030002
310400               ,:TRDPRT-INACTV-DTE                                31040002
310500           FROM TEXTENT A,                                        31050002
310600                TTRDPRT B                                         31060002
310700           WHERE VEND_INCHG_ID       = :WS-PARTNER                31070002
310800             AND VEND_INCHG_ID_DESC  = :WS-PARTNER-ID             31080002
310900             AND INACTV_DTE          = '9999-09-09'               31090002
311000             AND A.ENT_ID            =  B.ENT_ID                  31100002
311100           WITH UR                                                31110002
311200        END-EXEC                                                  31120002
311300                                                                  31130002
311400        EVALUATE TRUE                                             31140002
311500          WHEN SQLCODE = ZERO                                     31150002
311600             MOVE EXTENT-VLD-CART-LBL-IND TO                      31160002
311700                PV-VLD-CART-LBL-IND                               31170002
311710         IF ASNHDR-ASNHDR-NBR = PV-DISPLAY-PARTNER-ASN            31171012
311800            IF WS-PARTNER NOT = PV-DISPLAY-PARTNER AND            31180012
311900               WS-PARTNER-ID NOT = PV-DISPLAY-PARTNER-ID          31190012
312000                DISPLAY 'R025-GET-IMPORT-IND - WS-PARTNER '       31200012
312100                 WS-PARTNER ' FOR PARTNER ID ' WS-PARTNER-ID      31210012
312200                ' EXTENT-ASN-TRSCP-IND ' EXTENT-ASN-TRSCP-IND     31220012
312300                ' EXTENT-CART-LBL-IND ' EXTENT-VLD-CART-LBL-IND   31230012
312400                MOVE WS-PARTNER    TO PV-DISPLAY-PARTNER          31240012
312500                MOVE WS-PARTNER-ID TO PV-DISPLAY-PARTNER-ID       31250012
312501            END-IF                                                31250112
312502         ELSE                                                     31250212
312503             DISPLAY 'R025-GET-IMPORT-IND - WS-PARTNER '          31250312
312504              WS-PARTNER ' FOR PARTNER ID ' WS-PARTNER-ID         31250412
312505             ' EXTENT-ASN-TRSCP-IND ' EXTENT-ASN-TRSCP-IND        31250512
312506             ' EXTENT-CART-LBL-IND ' EXTENT-VLD-CART-LBL-IND      31250612
312507             MOVE WS-PARTNER    TO PV-DISPLAY-PARTNER             31250712
312508             MOVE WS-PARTNER-ID TO PV-DISPLAY-PARTNER-ID          31250812
312510             MOVE ASNHDR-ASNHDR-NBR TO PV-DISPLAY-PARTNER-ASN     31251012
312600         END-IF                                                   31260002
312700         MOVE EXTENT-ASN-TRSCP-IND TO PV-H5A-ASN-TRSCP-IND        31270002
312800         MOVE EXTENT-VLD-CART-LBL-IND TO PV-H5B-CART-LBL-IND      31280002
312900          WHEN SQLCODE = -811                                     31290002
313000             PERFORM R026-TRY-AGAIN                               31300002
313100          WHEN OTHER                                              31310002
313200            DISPLAY '*****************************************'   31320002
313300            DISPLAY PV-ABEND-PARAGRAPH                            31330002
313400            DISPLAY ' TRADING PARTNER: ' WS-PARTNER-ID '-'        31340002
313500                                         WS-PARTNER               31350002
313600            DISPLAY ' CURRENT ASN TRSCP IND: '                    31360002
313700                                         EXTENT-ASN-TRSCP-IND     31370002
313800            DISPLAY ' INACTIVE DATE: '   TRDPRT-INACTV-DTE        31380002
313900            DISPLAY 'IF ASN TRSCP IND NOT = P, NO PACK SLIP FILE' 31390002
314000            DISPLAY '*****************************************'   31400002
314100            PERFORM Z999-SQL-ERROR                                31410002
314200        END-EVALUATE                                              31420002
314300     END-IF.                                                      31430002
314400                                                                  31440002
314500 EJECT                                                            31450002
314600******************************************************************31460002
314700*  GET EXTENT-ASN-TRSCP-IND IF THRU DECONSOLIDATOR - TRY AGAIN    31470002
314800******************************************************************31480002
314900 R026-TRY-AGAIN.                                                  31490002
315000                                                                  31500007
315100     MOVE 'R026'                  TO PGM-LOCATION.                31510002
315200     MOVE 'R026-TRY-AGAIN            '                            31520002
315300                                  TO PV-ABEND-PARAGRAPH.          31530002
315310     IF PV-ELEM-ALT-ENT-ID = 0                                    31531007
315320        EXEC SQL                                                  31532007
315330           SELECT A.ASN_TRSCP_IND, A.VLD_CART_LBL_IND             31533007
315340           INTO :EXTENT-ASN-TRSCP-IND                             31534007
315350               ,:EXTENT-VLD-CART-LBL-IND                          31535007
315360           FROM TEXTENT A,                                        31536007
315370                TTRDMLT B                                         31537007
315380           WHERE B.VND_INCHG_ID       = :WS-PARTNER               31538007
315390             AND B.VND_INCHG_ID_DESC  = :WS-PARTNER-ID            31539007
315391             AND A.ENT_ID             =  B.PRNT_ENT_ID            31539107
315392           WITH UR                                                31539207
315393        END-EXEC                                                  31539307
315394     ELSE                                                         31539407
315395        MOVE PV-ELEM-ALT-ENT-ID TO DK-ENT-ID                      31539507
315500        EXEC SQL                                                  31550002
315600           SELECT A.ASN_TRSCP_IND, A.VLD_CART_LBL_IND             31560002
315700           INTO :EXTENT-ASN-TRSCP-IND                             31570002
315800               ,:EXTENT-VLD-CART-LBL-IND                          31580002
315900           FROM TEXTENT A                                         31590002
316000           WHERE A.ENT_ID = :DK-ENT-ID                            31600007
316100           WITH UR                                                31610002
316200        END-EXEC                                                  31620002
316210        MOVE DK-ENT-ID TO PV-DISPLAY-ENT-ID                       31621007
316220        DISPLAY 'R026-TRY-AGAIN: PARTNER IS: '                    31622007
316230                WS-PARTNER                                        31623007
316240                ' USING ALT ENTITY ID: '                          31624007
316250                PV-DISPLAY-ENT-ID                                 31625007
316260     END-IF.                                                      31626007
318900                                                                  31890002
319000     EVALUATE TRUE                                                31900002
319100       WHEN SQLCODE = ZERO                                        31910002
319200          MOVE EXTENT-VLD-CART-LBL-IND TO                         31920002
319300             PV-VLD-CART-LBL-IND                                  31930002
319400          MOVE EXTENT-ASN-TRSCP-IND TO PV-H5A-ASN-TRSCP-IND       31940002
319410          MOVE EXTENT-VLD-CART-LBL-IND TO PV-H5B-CART-LBL-IND     31941002
319481          IF ASNHDR-ASNHDR-NBR = PV-DISPLAY-PARTNER-ASN           31948113
319490             IF WS-PARTNER NOT = PV-DISPLAY-PARTNER AND           31949013
319500                WS-PARTNER-ID NOT = PV-DISPLAY-PARTNER-ID         31950013
319600                DISPLAY 'R026-TRY-AGAIN - WS-PARTNER '            31960013
319700                 WS-PARTNER ' FOR PARTNER ID ' WS-PARTNER-ID      31970013
319800                ' EXTENT-ASN-TRSCP-IND ' EXTENT-ASN-TRSCP-IND     31980013
319900                ' EXTENT-CART-LBL-IND ' EXTENT-VLD-CART-LBL-IND   31990013
320000                MOVE WS-PARTNER    TO PV-DISPLAY-PARTNER          32000013
320100                MOVE WS-PARTNER-ID TO PV-DISPLAY-PARTNER-ID       32010013
320110             END-IF                                               32011013
320111          ELSE                                                    32011113
320112              DISPLAY 'R026-TRY-AGAIN - WS-PARTNER '              32011213
320113               WS-PARTNER ' FOR PARTNER ID ' WS-PARTNER-ID        32011313
320114              ' EXTENT-ASN-TRSCP-IND ' EXTENT-ASN-TRSCP-IND       32011413
320115              ' EXTENT-CART-LBL-IND ' EXTENT-VLD-CART-LBL-IND     32011513
320116              MOVE WS-PARTNER    TO PV-DISPLAY-PARTNER            32011613
320117              MOVE WS-PARTNER-ID TO PV-DISPLAY-PARTNER-ID         32011713
320118              MOVE ASNHDR-ASNHDR-NBR  TO PV-DISPLAY-PARTNER-ASN   32011813
320119          END-IF                                                  32011913
320130       WHEN OTHER                                                 32013002
320140         DISPLAY '*****************************************'      32014002
320150         DISPLAY PV-ABEND-PARAGRAPH                               32015002
320160         DISPLAY ' TRADING PARTNER: ' WS-PARTNER-ID '-'           32016002
320170                                      WS-PARTNER                  32017002
320171         DISPLAY ' CURRENT ASN TRNSCP IND: '                      32017113
320172                                      EXTENT-ASN-TRSCP-IND        32017213
320173         DISPLAY ' CURRENT VALID CART IND: '                      32017313
320174                                      EXTENT-VLD-CART-LBL-IND     32017413
320200         DISPLAY 'IF ASN TRSCP IND NOT = P, NO PACK SLIP FILE'    32020002
320300         DISPLAY '*****************************************'      32030002
320400         PERFORM Z999-SQL-ERROR                                   32040002
320500     END-EVALUATE.                                                32050002
320600                                                                  32060002
320800****************************************************************  32080002
320900*     R035-CHECK-TRADING-PART                                     32090002
321000*                                                                 32100002
321100*     -  CHECK FOR TRADING PARTNER VALUE                          32110002
321200****************************************************************  32120002
321300 R035-CHECK-TRADING-PART.                                         32130002
321400     MOVE 'R035-CHECK-TRADING-PART        '                       32140002
321500                                 TO PV-ABEND-PARAGRAPH.           32150002
321600     SET CNTL-NBR-NOT-FOUND TO TRUE.                              32160002
321700                                                                  32170002
321800     PERFORM                                                      32180002
321900        VARYING SUB1 FROM 1 BY 1                                  32190002
322000        UNTIL SUB1 > MAX-SUB OR CNTL-NBR-FOUND                    32200002
322100        IF WS-ISA-CNTL-NBR(SUB1) = ASNHDR-EDIISA-CNTL-NBR         32210002
322200           SET CNTL-NBR-FOUND TO TRUE                             32220002
322300           MOVE SUB1 TO SUB2                                      32230002
322400        ELSE                                                      32240002
322500           SET CNTL-NBR-NOT-FOUND TO TRUE                         32250002
322600        END-IF                                                    32260002
322700     END-PERFORM.                                                 32270002
322800                                                                  32280002
322900******************************************************************32290002
323000*  GETS THE VENDOR NAME FROM THE ENTNME DATABASE.                *32300002
323100******************************************************************32310002
323200                                                                  32320002
323300 R050-GET-VENDOR-DESC.                                            32330002
323400     MOVE 'R050'                 TO PGM-LOCATION.                 32340002
323500     MOVE 'R050-GET-VENDOR-DESC      '                            32350002
323600                                 TO PV-ABEND-PARAGRAPH.           32360002
323700     MOVE ASNORD-PO-NBR (1:8)    TO DP010I-UNEDITED-FIELD.        32370002
323800     MOVE PC-8                   TO DP010I-MAXIMUM-DIGITS.        32380002
323900     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      32390002
324000     SET DP010I-NEGATIVE-NOT-ALLOWED                              32400002
324100                                 TO TRUE.                         32410002
324200                                                                  32420002
324300     CALL DP010I-NUMERIC-EDIT-ROUTINE                             32430002
324400          USING DP010I-NUMERIC-EDIT-AREA.                         32440002
324500                                                                  32450002
324600     IF DP010I-ERROR-DETECTED                                     32460002
324700         DISPLAY 'ERROR IN CONVERTING PO NUMBER TO NUMERIC: '     32470002
324800                  DP010I-UNEDITED-FIELD                           32480002
324900     END-IF.                                                      32490002
325000                                                                  32500002
325100     MOVE DP010I-NUMERIC-FIELD   TO PV-UNPK-PONUMB.               32510002
325200     MOVE PV-UNPK-PONUMB         TO PV-INTEGER-PO-NBR.            32520002
325300                                                                  32530002
325400       EXEC SQL                                                   32540002
325500        SELECT ENT_NAME_DESC                                      32550002
325600        INTO  :ENTNME-ENT-NAME-DESC                               32560002
325700        FROM TPURCHS A,                                           32570002
325800             TENTNME B                                            32580002
325900        WHERE A.PO_NBR   = :PV-INTEGER-PO-NBR                     32590002
326000        AND   A.VER_STATUS_CDE = 'A'                              32600002
326100        AND   A.ENT_ID   = B.ENT_ID                               32610002
326200        AND   B.TYPE_CDE = :PC-01                                 32620002
326300       END-EXEC.                                                  32630002
326400                                                                  32640002
326500     EVALUATE TRUE                                                32650002
326600       WHEN SQLCODE = ZEROS                                       32660002
326700         MOVE ENTNME-ENT-NAME-DESC TO PV-H1-VENDOR-NAME           32670002
326800                                      RC001-EDI-VEND-NAME         32680002
326900       WHEN SQLCODE = PC-ROW-NOT-FOUND                            32690002
327000         MOVE 'NOT FOUND'          TO PV-H1-VENDOR-NAME           32700002
327100                                      RC001-EDI-VEND-NAME         32710002
327200       WHEN SQLCODE = PC-DUPLICATE                                32720002
327300         MOVE SPACES               TO PV-H1-VENDOR-NAME           32730002
327400                                      RC001-EDI-VEND-NAME         32740002
327500       WHEN OTHER                                                 32750002
327600         DISPLAY PV-ABEND-PARAGRAPH                               32760002
327700         DISPLAY 'EDI VENDOR ID: '                                32770002
327800                  ASNHDR-EDI-VEND-ID                              32780002
327900         DISPLAY 'ASN HEADER NUMBER: '                            32790002
328000                  ASNHDR-ASNHDR-NBR                               32800002
328100         DISPLAY 'PO NUMBER: '                                    32810002
328200                  ASNORD-PO-NBR                                   32820002
328300         PERFORM Z999-SQL-ERROR                                   32830002
328400     END-EVALUATE.                                                32840002
328500 EJECT                                                            32850002
328600                                                                  32860002
328700******************************************************************32870002
328800*  PROCESS THE MATCHING RECORD ON THE PO FILE                    *32880002
328900******************************************************************32890002
329000 R100-PROCESS-PO-INFORMATION.                                     32900002
329100*                                                                 32910002
329200                                                                  32920002
329300     MOVE SPACES                  TO PV-H1-DEPT                   32930002
329400                                     PV-H1-PO-DATE                32940002
329500                                     PV-H2-REQ-SHIP-DATE          32950002
329600                                     PV-H3-CANCEL-DATE            32960002
329700                                     PV-H4-CAN-EXT-DATE           32970002
329800                                     PV-H5-AD-DATE                32980002
329900                                     PV-H5A-ASN-TRSCP-IND         32990002
330000                                     PV-H5B-CART-LBL-IND          33000002
330100                                     PV-H9-SI-1                   33010002
330200                                     PV-H9-SI-2                   33020002
330300                                     PV-H9-SI-3                   33030002
330400                                     PV-H10-GE-1                  33040002
330500                                     PV-H10-GE-2.                 33050002
330600*                                                                 33060002
330700                                                                  33070002
330800     IF ASNORD-MTCH-PO-CDE = PC-Y OR PC-P OR PC-C                 33080002
330900         PERFORM R200-GET-PO-INFORMATION                          33090002
331000     ELSE                                                         33100002
331100         SET PS-NO-PO-FOUND       TO TRUE                         33110002
331200     END-IF.                                                      33120002
331300*                                                                 33130002
331400 EJECT                                                            33140002
331500******************************************************************33150002
331600*  GETS THE PURCHASE ORDER INFORMATION FROM THE IMS PO DATABASE  *33160002
331700******************************************************************33170002
331800 R200-GET-PO-INFORMATION.                                         33180002
331900                                                                  33190002
332000     MOVE 'R200'                 TO PGM-LOCATION.                 33200002
332100     MOVE 'R200-GET-PO-INFORMATION   '                            33210002
332200                                 TO PV-ABEND-PARAGRAPH.           33220002
332300                                                                  33230002
332400     MOVE ASNORD-PO-NBR (1:8)    TO DP010I-UNEDITED-FIELD.        33240002
332500     MOVE PC-8                   TO DP010I-MAXIMUM-DIGITS.        33250002
332600     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      33260002
332700     SET DP010I-NEGATIVE-NOT-ALLOWED                              33270002
332800                                 TO TRUE.                         33280002
332900                                                                  33290002
333000     CALL DP010I-NUMERIC-EDIT-ROUTINE                             33300002
333100          USING DP010I-NUMERIC-EDIT-AREA.                         33310002
333200                                                                  33320002
333300     IF DP010I-ERROR-DETECTED                                     33330002
333400         DISPLAY 'ERROR IN CONVERTING PO NUMBER TO NUMERIC: '     33340002
333500                  DP010I-UNEDITED-FIELD                           33350002
333600     END-IF.                                                      33360002
333700                                                                  33370002
333800     MOVE DP010I-NUMERIC-FIELD   TO PV-UNPK-PONUMB                33380002
333900                                    PV-INTEGER-PO-NBR.            33390002
333910     MOVE PV-INTEGER-PO-NBR      TO PV-DISPLAY-PO-NBR.            33391009
334000     SET PS-PO-FOUND TO TRUE.                                     33400002
334100                                                                  33410002
334200                                                                  33420002
334300     EXEC SQL                                                     33430002
334400        SELECT DISTINCT A.DEPT_NBR                                33440002
334500              ,A.ORD_DTE                                          33450002
334600              ,A.STATUS_CDE                                       33460002
334700              ,A.DIR_STR_IND                                      33470002
334800              ,A.NEW_STR_PO_IND                                   33480002
334900              ,A.EDI_IND                                          33490002
335000              ,B.DONT_SHIP_BEF_DTE                                33500002
335100              ,B.CAN_IFNOT_SHIP_DTE                               33510002
335200              ,B.EXT_CAN_DTE                                      33520002
335300        INTO :PURCHS-DEPT-NBR                                     33530002
335400            ,:PURCHS-ORD-DTE                                      33540002
335500            ,:PURCHS-STATUS-CDE                                   33550002
335600            ,:PURCHS-DIR-STR-IND                                  33560002
335700            ,:PURCHS-NEW-STR-PO-IND                               33570002
335800            ,:PURCHS-EDI-IND                                      33580002
335900            ,:PLNSHP-DONT-SHIP-BEF-DTE                            33590002
336000            ,:PLNSHP-CAN-IFNOT-SHIP-DTE                           33600002
336100            ,:PLNSHP-EXT-CAN-DTE                                  33610002
336200        FROM TPURCHS A,                                           33620002
336300             TPLNSHP B                                            33630002
336400        WHERE A.PO_NBR  = :PV-INTEGER-PO-NBR                      33640002
336500          AND A.PO_NBR  = B.PO_NBR                                33650002
336600          AND A.VER_STATUS_CDE     = 'A'                          33660002
336700          AND A.VER_STATUS_CDE     = B.VER_STATUS_CDE             33670002
336800     END-EXEC.                                                    33680002
336900                                                                  33690002
337000                                                                  33700002
337100     EVALUATE TRUE                                                33710002
337200       WHEN SQLCODE = ZEROS                                       33720002
337300         SET PS-NO-PO-FOUND      TO TRUE                          33730002
337400       WHEN SQLCODE = +100                                        33740002
337500         SET PS-NO-PO-FOUND      TO TRUE                          33750002
337600                                                                  33760002
337700       WHEN OTHER                                                 33770002
337800         DISPLAY PV-ABEND-PARAGRAPH                               33780002
337900         PERFORM Z999-SQL-ERROR                                   33790002
338000     END-EVALUATE.                                                33800002
338100                                                                  33810002
338200                                                                  33820002
338300                                                                  33830002
338400     IF SQLCODE = ZERO                                            33840002
338500                                                                  33850002
338600                                                                  33860002
338700       SET PS-PO-FOUND           TO TRUE                          33870002
338800         MOVE PURCHS-DEPT-NBR    TO PV-H1-DEPT                    33880002
338900                                    RC001-DEPT-NBR                33890002
339000         MOVE PURCHS-DIR-STR-IND TO PV-DIR-TO-STORE-IND           33900002
339100         MOVE PURCHS-NEW-STR-PO-IND  TO PV-NEW-STORE-PO-IND       33910002
339200         MOVE PURCHS-EDI-IND         TO PV-EDI-IND                33920002
339300         PERFORM R250-GET-PACK-BY-STORE                           33930002
339400                                                                  33940002
339500         IF PURCHS-ORD-DTE = '0001-01-01'                         33950002
339600             MOVE SPACES         TO PV-H1-PO-DATE                 33960002
339700             MOVE ZEROES         TO RC001-PO-DATE                 33970002
339800         ELSE                                                     33980002
339900             MOVE PURCHS-ORD-DTE (3:2) TO                         33990002
340000                                    PV-H1-PD-YY                   34000002
340100                                    RC001-PO-DATE (5:2)           34010002
340200             MOVE PURCHS-ORD-DTE (6:2) TO                         34020002
340300                                    PV-H1-PD-MM                   34030002
340400                                    RC001-PO-DATE (1:2)           34040002
340500             MOVE PURCHS-ORD-DTE (9:2) TO                         34050002
340600                                    PV-H1-PD-DD                   34060002
340700                                    RC001-PO-DATE (3:2)           34070002
340800             MOVE PC-SLASH       TO PV-H1-PD-SLASH1               34080002
340900                                    PV-H1-PD-SLASH2               34090002
341000         END-IF                                                   34100002
341100         IF PLNSHP-DONT-SHIP-BEF-DTE = '0001-01-01'               34110002
341200             MOVE SPACES         TO PV-H2-REQ-SHIP-DATE           34120002
341300             MOVE ZEROES         TO RC001-REQ-SHIP-DATE           34130002
341400         ELSE                                                     34140002
341500                                                                  34150002
341600             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2)                  34160002
341700                                 TO PV-H2-RSD-MM                  34170002
341800                                    RC001-REQ-SHIP-DATE (1:2)     34180002
341900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2)                  34190002
342000                                 TO PV-H2-RSD-DD                  34200002
342100                                    RC001-REQ-SHIP-DATE (3:2)     34210002
342200             MOVE PLNSHP-DONT-SHIP-BEF-DTE (3:2)                  34220002
342300                                 TO PV-H2-RSD-YY                  34230002
342400                                    RC001-REQ-SHIP-DATE (5:2)     34240002
342500             MOVE PC-SLASH       TO PV-H2-RSD-SLASH1              34250002
342600                                    PV-H2-RSD-SLASH2              34260002
342700         END-IF                                                   34270002
342800         IF PLNSHP-CAN-IFNOT-SHIP-DTE = '0001-01-01'              34280002
342900             MOVE SPACES         TO PV-H3-CANCEL-DATE             34290002
343000             MOVE ZEROES         TO RC001-CANCEL-DATE             34300002
343100         ELSE                                                     34310002
343200             MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (6:2)                 34320002
343300                                 TO PV-H3-CD-MM                   34330002
343400                                    RC001-CANCEL-DATE (1:2)       34340002
343500             MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (9:2)                 34350002
343600                                 TO PV-H3-CD-DD                   34360002
343700                                    RC001-CANCEL-DATE (3:2)       34370002
343800             MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (3:2)                 34380002
343900                                 TO PV-H3-CD-YY                   34390002
344000                                    RC001-CANCEL-DATE (5:2)       34400002
344100             MOVE PC-SLASH       TO PV-H3-CD-SLASH1               34410002
344200                                    PV-H3-CD-SLASH2               34420002
344300         END-IF                                                   34430002
344400         IF PLNSHP-EXT-CAN-DTE = '0001-01-01'                     34440002
344500             MOVE SPACES         TO PV-H4-CAN-EXT-DATE            34450002
344600             MOVE ZEROES         TO RC001-CANCEL-EXT-DATE         34460002
344700         ELSE                                                     34470002
344800             MOVE PLNSHP-EXT-CAN-DTE (6:2)                        34480002
344900                                 TO PV-H4-ED-MM                   34490002
345000                                    RC001-CANCEL-EXT-DATE (1:2)   34500002
345100             MOVE PLNSHP-EXT-CAN-DTE (9:2)                        34510002
345200                                 TO PV-H4-ED-DD                   34520002
345300                                    RC001-CANCEL-EXT-DATE (3:2)   34530002
345400             MOVE PLNSHP-EXT-CAN-DTE (3:2)                        34540002
345500                                 TO PV-H4-ED-YY                   34550002
345600                                    RC001-CANCEL-EXT-DATE (5:2)   34560002
345700             MOVE PC-SLASH       TO PV-H4-ED-SLASH1               34570002
345800                                    PV-H4-ED-SLASH2               34580002
345900         END-IF                                                   34590002
346000                                                                  34600002
346100                                                                  34610002
346200         EXEC SQL                                                 34620002
346300            SELECT MIN(AD_EVNT_DTE)                               34630002
346400             INTO :PURITM-AD-EVNT-DTE:PV-AD-DATE-NULL             34640002
346500             FROM TPURITM                                         34650002
346600            WHERE PO_NBR       = :PV-INTEGER-PO-NBR               34660002
346700              AND AD_EVNT_DTE ^= '0001-01-01'                     34670002
346800              AND VER_STATUS_CDE = 'A'                            34680002
346900         END-EXEC                                                 34690002
347000         EVALUATE TRUE                                            34700002
347100           WHEN SQLCODE = ZEROS                                   34710002
347200             IF PV-AD-DATE-NULL  = PC-NEG-1                       34720002
347300                MOVE SPACES TO PURITM-AD-EVNT-DTE                 34730002
347400             END-IF                                               34740002
347500           WHEN SQLCODE = +100                                    34750002
347600             CONTINUE                                             34760002
347700           WHEN OTHER                                             34770002
347800            DISPLAY 'GET-MIN-AD-EVENT-DATE'                       34780002
347900            DISPLAY 'PO-NBR =  ' PV-INTEGER-PO-NBR                34790002
348000            PERFORM Z999-SQL-ERROR                                34800002
348100         END-EVALUATE                                             34810002
348200                                                                  34820002
348300         IF SQLCODE = ZERO                                        34830002
348400                                                                  34840002
348500           IF PURITM-AD-EVNT-DTE  = SPACES OR LOW-VALUES          34850002
348600             MOVE SPACES         TO PV-H5-AD-DATE                 34860002
348700             MOVE ZEROES         TO RC001-AD-DATE                 34870002
348800           ELSE                                                   34880002
348900                                                                  34890002
349000             MOVE PURITM-AD-EVNT-DTE (6:2)                        34900002
349100                                 TO PV-H5-AD-MM                   34910002
349200                                    RC001-AD-DATE (1:2)           34920002
349300             MOVE PURITM-AD-EVNT-DTE (9:2)                        34930002
349400                                 TO PV-H5-AD-DD                   34940002
349500                                    RC001-AD-DATE (3:2)           34950002
349600             MOVE PURITM-AD-EVNT-DTE (3:2)                        34960002
349700                                 TO PV-H5-AD-YY                   34970002
349800                                    RC001-AD-DATE (5:2)           34980002
349900*            MOVE PC-1           TO PV-INSTR-CNT                  34990002
350000             MOVE PC-SLASH       TO PV-H5-AD-SLASH1               35000002
350100                                    PV-H5-AD-SLASH2               35010002
350200           END-IF                                                 35020002
350300         END-IF                                                   35030002
350400                                                                  35040002
350500*        PERFORM R300-GET-SPECIAL-INSTR                           35050002
350600                                                                  35060002
350700     END-IF.                                                      35070002
350800 EJECT                                                            35080002
350900******************************************************************35090002
351000*  GETS THE PACK BY STORE INFORMATION  FROM THE PO DATABASE      *35100002
351100******************************************************************35110002
351200 R250-GET-PACK-BY-STORE.                                          35120002
351300                                                                  35130002
351400     MOVE 'R250'                 TO PGM-LOCATION.                 35140002
351500     MOVE 'R250-GET-PACK-BY-STORE    '                            35150002
351600                                 TO PV-ABEND-PARAGRAPH.           35160002
351700                                                                  35170002
351800     MOVE 4                      TO POAGMT-AGRMT-TYP-ID.          35180002
351900     MOVE 4                      TO POAGMT-TYP-CDE.               35190002
352000                                                                  35200002
352100                                                                  35210002
352200         EXEC SQL                                                 35220002
352300              SELECT COUNT(*)                                     35230002
352400                INTO :PV-DB2-COUNT                                35240002
352500                FROM TPOAGMT                                      35250002
352600               WHERE PO_NBR  = :PV-INTEGER-PO-NBR                 35260002
352700                 AND AGRMT_TYP_ID   = :POAGMT-AGRMT-TYP-ID        35270002
352800                 AND VER_STATUS_CDE = 'A'                         35280002
352900                 AND TYP_CDE        = :POAGMT-TYP-CDE             35290002
353000         END-EXEC                                                 35300002
353100                                                                  35310002
353200         EVALUATE TRUE                                            35320002
353300             WHEN SQLCODE = +0                                    35330002
353400             WHEN SQLCODE = +100                                  35340002
353500                  CONTINUE                                        35350002
353600             WHEN OTHER                                           35360002
353700             DISPLAY PV-ABEND-PARAGRAPH                           35370002
353800             PERFORM Z999-SQL-ERROR                               35380002
353900         END-EVALUATE.                                            35390002
354000                                                                  35400002
354100         IF  PV-DB2-COUNT > +0                                    35410002
354200                    MOVE 'Y'  TO PV-PACK-BY-STORE-IND             35420002
354300         ELSE                                                     35430002
354400                    MOVE 'N'  TO PV-PACK-BY-STORE-IND             35440002
354500         END-IF.                                                  35450002
354600                                                                  35460002
354700                                                                  35470002
354800/                                                                 35480002
354900******************************************************************35490002
355000*  GETS THE SPECIAL INSTRUCTIONS FROM THE LINE ITEM SEGMENT      *35500002
355100******************************************************************35510002
355200 R300-GET-SPECIAL-INSTR.                                          35520002
355300                                                                  35530002
355400     MOVE 'R300'                 TO PGM-LOCATION.                 35540002
355500     MOVE 'R300-GET-SPECIAL-INSTR    '                            35550002
355600                                 TO PV-ABEND-PARAGRAPH.           35560002
355700     MOVE ASNORD-PO-NBR (1:8)    TO DP010I-UNEDITED-FIELD.        35570002
355800     MOVE PC-8                   TO DP010I-MAXIMUM-DIGITS.        35580002
355900     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      35590002
356000     SET DP010I-NEGATIVE-NOT-ALLOWED                              35600002
356100                                 TO TRUE.                         35610002
356200                                                                  35620002
356300     CALL DP010I-NUMERIC-EDIT-ROUTINE                             35630002
356400          USING DP010I-NUMERIC-EDIT-AREA.                         35640002
356500                                                                  35650002
356600     IF DP010I-ERROR-DETECTED                                     35660002
356700         DISPLAY 'ERROR IN CONVERTING PO NUMBER TO NUMERIC: '     35670002
356800                  DP010I-UNEDITED-FIELD                           35680002
356900     END-IF.                                                      35690002
357000                                                                  35700002
357100     MOVE DP010I-NUMERIC-FIELD   TO PV-UNPK-PONUMB.               35710002
357200     MOVE PV-UNPK-PONUMB         TO PV-INTEGER-PO-NBR.            35720002
357300     MOVE SPACES                 TO PV-RECIP-CDE-HOLD.            35730002
357400                                                                  35740002
357500     SET PS-NOT-EOF-INST-CSR TO TRUE.                             35750002
357600                                                                  35760002
357700     PERFORM R310-OPEN-INST-CSR.                                  35770002
357800     PERFORM R320-PROCESS-INST-CSR                                35780002
357900         UNTIL PS-EOF-INST-CSR.                                   35790002
358000     PERFORM R330-CLOSE-INST-CSR.                                 35800002
358100                                                                  35810002
358200 EJECT                                                            35820002
358300******************************************************************35830002
358400*  OPENS INSTRUCTION CODE CSR                                     35840002
358500******************************************************************35850002
358600 R310-OPEN-INST-CSR.                                              35860002
358700                                                                  35870002
358800     EXEC SQL                                                     35880002
358900         OPEN INST-CSR                                            35890002
359000     END-EXEC.                                                    35900002
359100                                                                  35910002
359200     EVALUATE TRUE                                                35920002
359300         WHEN SQLCODE = +0                                        35930002
359400             CONTINUE                                             35940002
359500         WHEN SQLWARN NOT = SPACE                                 35950002
359600         WHEN SQLCODE NOT = +0                                    35960002
359700             MOVE 'R310-OPEN-INST-CSR'                            35970002
359800                                   TO PV-ABEND-PARAGRAPH          35980002
359900            PERFORM Z999-SQL-ERROR                                35990002
360000     END-EVALUATE.                                                36000002
360100                                                                  36010002
360200                                                                  36020002
360300******************************************************************36030002
360400*  FETCHS INSTRUCTION CSR AND PRINTS                              36040002
360500******************************************************************36050002
360600 R320-PROCESS-INST-CSR.                                           36060002
360700                                                                  36070002
360800     EXEC SQL                                                     36080002
360900         FETCH INST-CSR                                           36090002
361000         INTO  :INSTCD-INSTR-DESC,                                36100002
361100               :INSTCD-INSTR-NBR,                                 36110002
361200               :INRCCD-RECIP-CDE,                                 36120002
361300               :INRCCD-RECIP-DESC                                 36130002
361400     END-EXEC.                                                    36140002
361500                                                                  36150002
361600     EVALUATE TRUE                                                36160002
361700         WHEN SQLCODE = +0                                        36170002
361800         WHEN SQLCODE = +100                                      36180002
361900             CONTINUE                                             36190002
362000         WHEN SQLWARN NOT = SPACE                                 36200002
362100         WHEN SQLCODE NOT = +0                                    36210002
362200             MOVE 'R320-PROCESS-INST-CSR'                         36220002
362300                                   TO PV-ABEND-PARAGRAPH          36230002
362400             PERFORM Z999-SQL-ERROR                               36240002
362500     END-EVALUATE.                                                36250002
362600                                                                  36260002
362700     IF SQLCODE = +100                                            36270002
362800         SET PS-EOF-INST-CSR       TO TRUE                        36280002
362900                                                                  36290002
363000     ELSE                                                         36300002
363100                                                                  36310002
363200         IF INRCCD-RECIP-CDE = PV-RECIP-CDE-HOLD                  36320002
363300             CONTINUE                                             36330002
363400         ELSE                                                     36340002
363500             MOVE INRCCD-RECIP-DESC                               36350002
363600                                   TO INSTR-RECIP                 36360002
363700             WRITE REPORT-RECORD-OUT-1 FROM INSTR-RECIP-LINE      36370002
363800                 AFTER ADVANCING 1 LINE                           36380002
363900             MOVE INRCCD-RECIP-CDE TO PV-RECIP-CDE-HOLD           36390002
364000             ADD +1                TO PV-LINE-CNT                 36400002
364100         END-IF                                                   36410002
364200                                                                  36420002
364300         MOVE INSTCD-INSTR-DESC    TO INSTR-DESC                  36430002
364400         WRITE REPORT-RECORD-OUT-1 FROM INSTR-LINE                36440002
364500             AFTER 1 LINES                                        36450002
364600         ADD +1                    TO PV-LINE-CNT                 36460002
364700     END-IF.                                                      36470002
364800                                                                  36480002
364900                                                                  36490002
365000******************************************************************36500002
365100*  CLOSES INSTRUCTION CODE CSR                                    36510002
365200******************************************************************36520002
365300 R330-CLOSE-INST-CSR.                                             36530002
365400                                                                  36540002
365500     EXEC SQL                                                     36550002
365600         CLOSE INST-CSR                                           36560002
365700     END-EXEC.                                                    36570002
365800                                                                  36580002
365900     EVALUATE TRUE                                                36590002
366000         WHEN SQLCODE = +0                                        36600002
366100             CONTINUE                                             36610002
366200         WHEN SQLWARN NOT = SPACE                                 36620002
366300         WHEN SQLCODE NOT = +0                                    36630002
366400             MOVE 'R330-CLOSE-INST-CSR'                           36640002
366500                                   TO PV-ABEND-PARAGRAPH          36650002
366600             PERFORM Z999-SQL-ERROR                               36660002
366700     END-EVALUATE.                                                36670002
366800                                                                  36680002
366900                                                                  36690002
367000 EJECT                                                            36700002
367100******************************************************************36710002
367200*  GETS THE PURCHASE LINE DETAIL SEGMENT                         *36720002
367300******************************************************************36730002
367400 R400-READ-PO-LINE-DETAIL.                                        36740002
367500                                                                  36750002
367600     MOVE 'R400'                 TO PGM-LOCATION.                 36760002
367700     MOVE 'R400-READ-PO-LINE-DETAIL  '                            36770002
367800                                 TO PV-ABEND-PARAGRAPH.           36780002
367900                                                                  36790002
368000     MOVE ASNORD-PO-NBR (1:8)    TO DP010I-UNEDITED-FIELD.        36800002
368100     MOVE PC-8                   TO DP010I-MAXIMUM-DIGITS.        36810002
368200     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      36820002
368300     SET DP010I-NEGATIVE-NOT-ALLOWED                              36830002
368400                                 TO TRUE.                         36840002
368500                                                                  36850002
368600     CALL DP010I-NUMERIC-EDIT-ROUTINE                             36860002
368700          USING DP010I-NUMERIC-EDIT-AREA.                         36870002
368800                                                                  36880002
368900     MOVE DP010I-NUMERIC-FIELD   TO PV-UNPK-PONUMB.               36890002
369000     MOVE PV-UNPK-PONUMB         TO PV-INTEGER-PO-NBR.            36900002
369100                                                                  36910002
369200     MOVE PV-CURR-PO-LN-NBR      TO DP010I-UNEDITED-FIELD.        36920002
369300     MOVE PC-7                   TO DP010I-MAXIMUM-DIGITS.        36930002
369400     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      36940002
369500     SET DP010I-NEGATIVE-NOT-ALLOWED                              36950002
369600                                 TO TRUE.                         36960002
369700                                                                  36970002
369800     CALL DP010I-NUMERIC-EDIT-ROUTINE                             36980002
369900          USING DP010I-NUMERIC-EDIT-AREA.                         36990002
370000                                                                  37000002
370100     MOVE DP010I-NUMERIC-FIELD   TO PV-INTEGER-PO-LNE-NBR.        37010002
370200                                                                  37020002
370300*----------------------------------------------------------------*37030002
370400*                                               **   WR # 230ZZ  *37040002
370500*  ADDED CODE TO RETRIEVE THE ITEM NUMBER FROM TPURITM TABLE.    *37050002
370600*----------------------------------------------------------------*37060002
370700                                                                  37070002
370800         EXEC SQL                                                 37080002
370900            SELECT  SKU_SEQ_NBR,                                  37090002
371000                    CL_NBR,                                       37100002
371100                    VEND_STYL_NAME,                               37110002
371200                    AD_EVNT_DTE,                                  37120002
371300                    COLOR_CDE,                                    37130002
371400                    COLOR_DESC,                                   37140002
371500                    SIZE_CDE,                                     37150002
371600                    SIZE_DESC,                                    37160002
371700                    SKU_DESC,                                     37170002
371800                    UNT_QTY,                                      37180002
371900                    UM_IND,                                       37190002
372000                    UNT_COST_AMT,                                 37200002
372100                    TOT_VAL_COST_AMT,                             37210002
372200                    UNT_RTL_PR_AMT,                               37220002
372300                    TOT_VAL_RTL_AMT,                              37230002
372400                    MU_PCT,                                       37240002
372500                    GP_RTL_AMT,                                   37250002
372600                    GP_QTY,                                       37260002
372700                    APP_PO_LNE_NBR,                               37270002
372800                    ITM_NBR                                       37280002
372900            INTO    :PURITM-SKU-SEQ-NBR,                          37290002
373000                    :PURITM-CL-NBR,                               37300002
373100                    :PURITM-VEND-STYL-NAME,                       37310002
373200                    :PURITM-AD-EVNT-DTE,                          37320002
373300                    :PURITM-COLOR-CDE,                            37330002
373400                    :PURITM-COLOR-DESC,                           37340002
373500                    :PURITM-SIZE-CDE,                             37350002
373600                    :PURITM-SIZE-DESC,                            37360002
373700                    :PURITM-SKU-DESC,                             37370002
373800                    :PURITM-UNT-QTY,                              37380002
373900                    :PURITM-UM-IND,                               37390002
374000                    :PURITM-UNT-COST-AMT,                         37400002
374100                    :PURITM-TOT-VAL-COST-AMT,                     37410002
374200                    :PURITM-UNT-RTL-PR-AMT,                       37420002
374300                    :PURITM-TOT-VAL-RTL-AMT,                      37430002
374400                    :PURITM-MU-PCT,                               37440002
374500                    :PURITM-GP-RTL-AMT,                           37450002
374600                    :PURITM-GP-QTY,                               37460002
374700                    :PURITM-APP-PO-LNE-NBR,                       37470002
374800                    :PURITM-ITM-NBR                               37480002
374900             FROM TPURITM                                         37490002
375000            WHERE PO_NBR       = :PV-INTEGER-PO-NBR               37500002
375100              AND APP_PO_LNE_NBR   = :PV-INTEGER-PO-LNE-NBR       37510002
375200              AND VER_STATUS_CDE = 'A'                            37520002
375300         END-EXEC.                                                37530002
375400         EVALUATE TRUE                                            37540002
375500           WHEN SQLCODE = ZEROS                                   37550002
375600             SET PS-CALL-API-YES       TO TRUE                    37560002
375700             CONTINUE                                             37570002
375800           WHEN SQLCODE = +100                                    37580002
375900             INITIALIZE DCLTPURITM                                37590002
376000           WHEN OTHER                                             37600002
376100            DISPLAY PV-ABEND-PARAGRAPH                            37610002
376200            PERFORM Z999-SQL-ERROR                                37620002
376300         END-EVALUATE.                                            37630002
376400                                                                  37640002
376500 EJECT                                                            37650002
376600*----------------------------------------------------------------*37660002
376700*                                               **   WR # 230ZZ  *37670002
376800* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *37680002
376900*----------------------------------------------------------------*37690002
377000 R450-CALL-XLKUT-DOMAIN-PGM.                                      37700002
377100                                                                  37710002
377200     MOVE '7010-SELECT-SKU-BY-SKU'                                37720002
377300                               TO PV-ABEND-PARAGRAPH.             37730002
377400     MOVE PURITM-ITM-NBR       TO XL001-KEY-ITM-NBR.              37740002
377500                                                                  37750002
377600     SET  XL001-BY-ITEM                                           37760002
377700          XL001-SELECT-SKU TO TRUE.                               37770002
377800                                                                  37780002
377900     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               37790002
378000                                                                  37800002
378100     EVALUATE TRUE                                                37810002
378200                                                                  37820002
378300      WHEN XL001-SKU-SQLCODE = +0                                 37830002
378400        MOVE XL001-SKU-NBR     TO  PV-DL1-SEQ,                    37840002
378500                                   PV-SEQ-NMBR                    37850002
378600                                                                  37860002
378700      WHEN XL001-SKU-SQLCODE = +100                               37870002
378800        CONTINUE                                                  37880002
378900                                                                  37890002
379000      WHEN XL001-SKU-CONTENTION                                   37900002
379100        MOVE '7010-SELECT-SKU-BY-SKU'                             37910002
379200                               TO PV-ABEND-PARAGRAPH              37920002
379300        MOVE 'XL001-SKU-CONTENTION'                               37930002
379400                               TO PV-ABEND-MESSAGE-TEXT           37940002
379500        MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                      37950002
379600        MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME                37960002
379700        PERFORM 9000-PROCESS-ABEND                                37970002
379800                                                                  37980002
379900      WHEN OTHER                                                  37990002
380000        MOVE '7010-SELECT-SKU-BY-SKU'                             38000002
380100                               TO PV-ABEND-PARAGRAPH              38010002
380200        MOVE 'SELECT ROW FROM XLV_SKU'                            38020002
380300                               TO PV-ABEND-MESSAGE-TEXT           38030002
380400        MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                      38040002
380500        MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME                38050002
380600        PERFORM 9000-PROCESS-ABEND                                38060002
380700                                                                  38070002
380800     END-EVALUATE.                                                38080002
380900                                                                  38090002
381000*----------------------------------------------------------------*38100002
381100* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *38110002
381200*----------------------------------------------------------------*38120002
381300******************************************************************38130002
381400*  RETRIEVES THE VENDOR PO ROLLUP INDICATOR FROM THE DB2 EXTERNAL*38140002
381500*  ENTITY TABLE FOR A SPECIFIC CARRIER.                          *38150002
381600******************************************************************38160002
381700*                                                                 38170002
381800 R500-GET-ASN-VEND-CARRIER-INFO.                                  38180002
381900                                                                  38190002
382000     MOVE 'R500'                  TO PGM-LOCATION.                38200002
382100     MOVE 'R500-GET-ASN-VEND-CARRIER-INFO'                        38210002
382200                                  TO PV-ABEND-PARAGRAPH.          38220002
382300                                                                  38230002
382400     EXEC SQL                                                     38240002
382500         SELECT ENT_ID                                            38250002
382600           INTO :EXTENT-ENT-ID                                    38260002
382700           FROM TEXTENT                                           38270002
382800           WHERE SCAC_CDE = :PV-SCAC-CDE-1-4                      38280002
382900           WITH UR                                                38290002
383000     END-EXEC.                                                    38300002
383100                                                                  38310002
383200     EVALUATE TRUE                                                38320002
383300       WHEN SQLCODE = ZEROS                                       38330002
383400         MOVE EXTENT-ENT-ID       TO RC001-CARR-VEND-ID           38340002
383500       WHEN SQLCODE = PC-ROW-NOT-FOUND                            38350002
383600         MOVE ZEROS               TO RC001-CARR-VEND-ID           38360002
383700       WHEN OTHER                                                 38370002
383800         DISPLAY PV-ABEND-PARAGRAPH                               38380002
383900         DISPLAY 'EDI VENDOR ID: '                                38390002
384000                  ASNHDR-EDI-VEND-ID                              38400002
384100         DISPLAY 'CARRIER ID: '                                   38410002
384200                  ASNHDR-CARR-ID-CDE                              38420002
384300         DISPLAY 'ASN HEADER NUMBER: '                            38430002
384400                  ASNHDR-ASNHDR-NBR                               38440002
384500         DISPLAY 'PO NUMBER: '                                    38450002
384600                  ASNORD-PO-NBR                                   38460002
384700         PERFORM Z999-SQL-ERROR                                   38470002
384800     END-EVALUATE.                                                38480002
384900 EJECT                                                            38490002
385000******************************************************************38500002
385100*  RETRIEVES THE MAN SEGMENT.                                    *38510002
385200******************************************************************38520002
385300                                                                  38530002
385400 R600-RETRIEVE-MAN-SEGMENT.                                       38540002
385500                                                                  38550002
385600     MOVE 'R600'                 TO PGM-LOCATION.                 38560002
385700     MOVE 'R600-RETRIEVE-MAN-SEGMENT '                            38570002
385800                                 TO PV-ABEND-PARAGRAPH.           38580002
385900                                                                  38590002
386000     EXEC SQL                                                     38600002
386100         SELECT COUNT(*)                                          38610002
386200           INTO :PV-MAN-SEGMENT-COUNT                             38620002
386300           FROM TASNCAR                                           38630002
386400           WHERE ASNHDR_ID = :ASNHDR-ASNHDR-ID                    38640002
386500             AND PO_NBR    = :ASNORD-PO-NBR                       38650002
386600             AND SUBSTR(ASNCAR_NBR,1,20) > '00000000000000000000' 38660002
386700     END-EXEC.                                                    38670002
386800                                                                  38680002
386900     EVALUATE TRUE                                                38690002
387000       WHEN SQLCODE = ZEROS                                       38700002
387100         IF PV-MAN-SEGMENT-COUNT > 0                              38710002
387200           MOVE 'Y' TO PV-MAN-SEGMENT-IND                         38720002
387300         ELSE                                                     38730002
387400           MOVE 'N' TO PV-MAN-SEGMENT-IND                         38740002
387500         END-IF                                                   38750002
387600       WHEN OTHER                                                 38760002
387700         DISPLAY PV-ABEND-PARAGRAPH                               38770002
387800         DISPLAY 'ASNHDR-ID: '                                    38780002
387900                  ASNHDR-ASNHDR-ID                                38790002
388000         DISPLAY 'CURR-PO-NBR: '                                  38800002
388100                  PV-CURR-PO-NBR                                  38810002
388200         PERFORM Z999-SQL-ERROR                                   38820002
388300     END-EVALUATE.                                                38830002
388400 EJECT                                                            38840002
388500******************************************************************38850002
388600*  FETCHES THE ASN HEADER INFORMATION.                           *38860002
388700******************************************************************38870002
388800 S000-FETCH-ASN-HEADER-INFO.                                      38880002
388900*                                                                 38890002
389000                                                                  38900002
389100     MOVE 'S000'                  TO PGM-LOCATION.                38910002
389200     MOVE 'S000-FETCH-ASN-HEADER-INFO'                            38920002
389300                                  TO PV-ABEND-PARAGRAPH.          38930002
389400*                                                                 38940002
389500* CLT ADDED CARR-AUTH-ID WR40574 12-01-2011                       38950002
389600     EXEC SQL                                                     38960002
389700         FETCH ASN_HEADER_CURSOR                                  38970002
389800           INTO :ASNHDR-OPERCO-NBR,                               38980002
389900                :ASNHDR-EDI-VEND-ID,                              38990002
390000                :ASNHDR-ASNHDR-NBR,                               39000002
390100                :ASNHDR-SHIP-DTE,                                 39010002
390200                :ASNHDR-BOL-NBR,                                  39020002
390300                :ASNHDR-PRO-NBR      :PV-HDR-PRO-NBR-NULL,        39030002
390400                :ASNHDR-CART-SHIP-QTY,                            39040002
390500                :ASNHDR-GRO-WGHT-MSMT:PV-HDR-GRO-WGHT-MSMT-NULL,  39050002
390600                :ASNHDR-ANTC-DELY-DTE:PV-HDR-ANTC-DELY-DTE-NULL,  39060002
390700                :ASNHDR-CARR-NAME    :PV-HDR-CARR-NAME-NULL,      39070002
390800                :ASNHDR-CARR-ID-CDE  :PV-HDR-CARR-ID-CDE-NULL,    39080002
390900                :ASNHDR-EQUIP-INIT-CDE                            39090002
391000                                     :PV-HDR-EQUIP-INIT-CDE-NULL, 39100002
391100                :ASNHDR-EQUIP-NBR    :PV-HDR-EQUIP-NBR-NULL,      39110002
391200                :ASNHDR-GRO-WGHT-UM-CDE                           39120002
391300                                     :PV-HDR-GRO-WGHT-UM-CDE-NULL,39130002
391400                :ASNHDR-DC-PRT-IND,                               39140002
391500                :ASNHDR-ASNHDR-ID,                                39150002
391600                :ASNHDR-EDIISA-CNTL-NBR,                          39160002
391700                :ASNORD-PO-NBR,                                   39170002
391800                :ASNORD-LOC-NBR,                                  39180002
391900                :ASNORD-MDSEDP-NBR,                               39190002
392000* 4/6/95        :ASNORD-PO-DTE :PV-HDR-PO-DTE-NULL,               39200002
392100                :ASNORD-SEQ-NBR-IND,                              39210002
392200                :ASNORD-MTCH-PO-CDE,                              39220002
392300                :ASNORD-EARLY-LTE-CDE,                            39230002
392400                :ASNHDR-CARR-AUTH-ID                              39240002
392500     END-EXEC.                                                    39250002
392600*                                                                 39260002
392700     EVALUATE TRUE                                                39270002
392800       WHEN SQLCODE = ZEROS                                       39280002
392900         CONTINUE                                                 39290002
393000       WHEN SQLCODE = PC-ROW-NOT-FOUND                            39300002
393100         SET PS-END-OF-ASN        TO TRUE                         39310002
393200       WHEN OTHER                                                 39320002
393300         DISPLAY PV-ABEND-PARAGRAPH                               39330002
393400         PERFORM Z999-SQL-ERROR                                   39340002
393500     END-EVALUATE.                                                39350002
393600*                                                                 39360002
393700 EJECT                                                            39370002
393800******************************************************************39380002
393900*  FETCHES THE ASN DETAIL INFORMATION.                           *39390002
394000******************************************************************39400002
394100*                                                                 39410002
394200 S100-FETCH-ASN-DETAIL-INFO.                                      39420002
394300*                                                                 39430002
394400     MOVE 'S100'                  TO PGM-LOCATION.                39440002
394500     MOVE 'S100-FETCH-ASN-DETAIL-INFO'                            39450002
394600                                  TO PV-ABEND-PARAGRAPH.          39460002
394700*                                                                 39470002
394800     EXEC SQL                                                     39480002
394900         FETCH ASN_DETAIL_CURSOR                                  39490002
395000           INTO :ASNDTL-ASNDTL-NBR,                               39500002
395100                :ASNDTL-UPC-NBR,                                  39510002
395200                :ASNDTL-SHIPT-QTY,                                39520002
395300                :ASNDTL-SHIPT-UM-CDE,                             39530002
395400                :ASNDTL-PKG-QTY :PV-DTL-PKG-QTY-NULL,             39540002
395500                :ASNDTL-ORD-QTY-UM-CDE:PV-DTL-ORD-QTY-UM-CDE-NULL,39550002
395600                :ASDTPL-PO-LN-NBR,                                39560002
395700                :ASDTPL-ASSOC-QTY,                                39570002
395800                :ASDTPL-SHIPT-VAR-QTY,                            39580002
395900                :ASDTPL-PR-CHG-EFF-DAY-NBR,                       39590002
396000                :ASDTPL-PR-VAR-IND,                               39600002
396100                :ASDTPL-PR-DISC-IND,                              39610002
396200                :ASDTPL-ASDTPL-ALLOC-IND                          39620002
396300     END-EXEC.                                                    39630002
396400*                                                                 39640002
396500     EVALUATE TRUE                                                39650002
396600       WHEN SQLCODE = ZEROS                                       39660002
396700         SET PS-NOT-END-OF-ASN-DETAIL                             39670002
396800                                  TO TRUE                         39680002
396900       WHEN SQLCODE = PC-ROW-NOT-FOUND                            39690002
397000         SET PS-END-OF-ASN-DETAIL TO TRUE                         39700002
397100       WHEN OTHER                                                 39710002
397200         DISPLAY PV-ABEND-PARAGRAPH                               39720002
397300         PERFORM Z999-SQL-ERROR                                   39730002
397400     END-EVALUATE.                                                39740002
397500 EJECT                                                            39750002
397600******************************************************************39760002
397700*  RETREIVES THE MERCHANDISE DEPT DESCRIPTION.                   *39770002
397800******************************************************************39780002
397900*                                                                 39790002
398000 S200-GET-DEPT-DESCRIPTION.                                       39800002
398100*                                                                 39810002
398200     MOVE 'S200'                  TO PGM-LOCATION.                39820002
398300     MOVE 'S200-GET-DEPT-DESCRIPTION '                            39830002
398400                                  TO PV-ABEND-PARAGRAPH.          39840002
398500*                                                                 39850002
398600     EXEC SQL                                                     39860002
398700         SELECT MDSEAR_DKEY,                                      39870002
398800                MDSEAR_DESC,                                      39880002
398900                BYR_NBR                                           39890002
399000           INTO :MDSEAR-DKEY,                                     39900002
399100                :MDSEAR-DESC,                                     39910002
399200                :MDSEAR-BYR-NBR                                   39920002
399300           FROM TMDSEAR                                           39930002
399400           WHERE DEPT_NBR          = :PV-H1-DEPT                  39940002
399500             AND MDSELV_CDE        = :PC-DEPARTMENT               39950002
399600             AND :PV-PROCESS-DATE-R BETWEEN                       39960002
399700                  STRT_DTE AND END_DTE                            39970002
399800     END-EXEC.                                                    39980002
399900*                                                                 39990002
400000     EVALUATE TRUE                                                40000002
400100       WHEN SQLCODE = ZEROS                                       40010002
400200         PERFORM S300-GET-ANALYST-NAME                            40020002
400300         PERFORM S400-GET-BUYER-NAME                              40030002
400400       WHEN SQLCODE = PC-ROW-NOT-FOUND                            40040002
400500         MOVE PC-DEPT-NOT-FOUND   TO MDSEAR-DESC                  40050002
400600         MOVE SPACES              TO PV-H2-BUYER                  40060002
400700                                     PV-H2-BUYER-ID-X             40070002
400800                                     PV-H3-ANALYST                40080002
400900       WHEN OTHER                                                 40090002
401000         DISPLAY PV-ABEND-PARAGRAPH                               40100002
401100         DISPLAY 'PURCHS-DEPT-NBR ='                              40110002
401200                  PURCHS-DEPT-NBR                                 40120002
401300         DISPLAY 'PC-DEPARTMENT: '                                40130002
401400                  PC-DEPARTMENT                                   40140002
401500         DISPLAY 'PV-PROCESS-DATE-R: '                            40150002
401600                  PV-PROCESS-DATE-R                               40160002
401700         PERFORM Z999-SQL-ERROR                                   40170002
401800     END-EVALUATE.                                                40180002
401900 EJECT                                                            40190002
402000******************************************************************40200002
402100*  RETREIVES THE ANALYST NAME.                                   *40210002
402200******************************************************************40220002
402300*                                                                 40230002
402400 S300-GET-ANALYST-NAME.                                           40240002
402500*                                                                 40250002
402600     MOVE 'S300'                  TO PGM-LOCATION.                40260002
402700     MOVE 'S300-GET-ANALYST-NAME     '                            40270002
402800                                  TO PV-ABEND-PARAGRAPH.          40280002
402900*                                                                 40290002
403000     EXEC SQL                                                     40300002
403100         SELECT WORKER_NBR,                                       40310002
403200                WORKER_FIR_NAME,                                  40320002
403300                WORKER_LAST_NAME                                  40330002
403400           INTO :RSPBAR-WORKER-NBR,                               40340002
403500                :RSPBAR-WORKER-FIR-NAME,                          40350002
403600                :RSPBAR-WORKER-LAST-NAME                          40360002
403700           FROM TRSPBAR                                           40370002
403800           WHERE MDSEAR_DKEY       = :MDSEAR-DKEY                 40380002
403900             AND RSPLVL_CDE        = :PC-ANALYST                  40390002
404000             AND :PV-PROCESS-DATE-R BETWEEN                       40400002
404100                 WORKER_STRT_DTE AND WORKER_END_DTE               40410002
404200     END-EXEC.                                                    40420002
404300*                                                                 40430002
404400     EVALUATE TRUE                                                40440002
404500       WHEN SQLCODE = ZEROS                                       40450002
404600         MOVE PC-FLNAME-LENGTH         TO DP024-FLNAME-LENGTH     40460002
404700         MOVE RSPBAR-WORKER-FIR-NAME   TO DP024-FNAME             40470002
404800         MOVE RSPBAR-WORKER-LAST-NAME  TO DP024-LNAME             40480002
404900         PERFORM DP024-0000-FORMAT-NAME                           40490002
405000         MOVE DP024-FLNAME             TO PV-H3-ANALYST           40500002
405100                                          RC001-ANALYST-NAME      40510002
405200       WHEN SQLCODE = PC-ROW-NOT-FOUND                            40520002
405300         MOVE SPACES                   TO PV-H3-ANALYST           40530002
405400       WHEN SQLCODE = PC-DUPLICATE                                40540002
405500         MOVE PC-ASTERISK              TO PV-H3-ANALYST           40550002
405600                                          RC001-ANALYST-NAME      40560002
405700       WHEN OTHER                                                 40570002
405800         DISPLAY PV-ABEND-PARAGRAPH                               40580002
405900         DISPLAY 'MDSEAR-DKEY: '                                  40590002
406000                  MDSEAR-DKEY                                     40600002
406100         DISPLAY 'PC-ANALYST: '                                   40610002
406200                  PC-ANALYST                                      40620002
406300         DISPLAY 'PV-PROCESS-DATE-R: '                            40630002
406400                  PV-PROCESS-DATE-R                               40640002
406500         PERFORM Z999-SQL-ERROR                                   40650002
406600     END-EVALUATE.                                                40660002
406700 EJECT                                                            40670002
406800******************************************************************40680002
406900*  RETREIVES THE BUYERS NAME.                                    *40690002
407000******************************************************************40700002
407100*                                                                 40710002
407200 S400-GET-BUYER-NAME.                                             40720002
407300*                                                                 40730002
407400     MOVE 'S400'                  TO PGM-LOCATION.                40740002
407500     MOVE 'S400-GET-BUYER-NAME       '                            40750002
407600                                  TO PV-ABEND-PARAGRAPH.          40760002
407700*                                                                 40770002
407800     EXEC SQL                                                     40780002
407900         SELECT WORKER_NBR,                                       40790002
408000                WORKER_FIR_NAME,                                  40800002
408100                WORKER_LAST_NAME                                  40810002
408200           INTO :RSPBAR-WORKER-NBR,                               40820002
408300                :RSPBAR-WORKER-FIR-NAME,                          40830002
408400                :RSPBAR-WORKER-LAST-NAME                          40840002
408500           FROM TRSPBAR A                                         40850002
408600           WHERE MDSEAR_DKEY       = :MDSEAR-DKEY                 40860002
408700             AND RSPLVL_CDE        = :PC-BUYER-BYR                40870002
408800             AND :PV-PROCESS-DATE-R BETWEEN                       40880002
408900                 WORKER_STRT_DTE AND WORKER_END_DTE               40890002
409000     END-EXEC.                                                    40900002
409100*                                                                 40910002
409200     EVALUATE TRUE                                                40920002
409300       WHEN SQLCODE = ZEROS                                       40930002
409400         MOVE PC-FLNAME-LENGTH         TO DP024-FLNAME-LENGTH     40940002
409500         MOVE RSPBAR-WORKER-FIR-NAME   TO DP024-FNAME             40950002
409600         MOVE RSPBAR-WORKER-LAST-NAME  TO DP024-LNAME             40960002
409700         PERFORM DP024-0000-FORMAT-NAME                           40970002
409800         MOVE DP024-FLNAME             TO PV-H2-BUYER             40980002
409900                                          RC001-BUYER-NAME        40990002
410000         MOVE MDSEAR-BYR-NBR           TO PV-H2-BUYER-ID          41000002
410100                                          RC001-BUYER-NBR         41010002
410200       WHEN SQLCODE = PC-ROW-NOT-FOUND                            41020002
410300         MOVE SPACES                   TO PV-H2-BUYER             41030002
410400                                          PV-H2-BUYER-ID-X        41040002
410500       WHEN OTHER                                                 41050002
410600         DISPLAY PV-ABEND-PARAGRAPH                               41060002
410700         DISPLAY 'MDSEAR-DKEY: '                                  41070002
410800                  MDSEAR-DKEY                                     41080002
410900         DISPLAY 'PC-BUYER-BYR: '                                 41090002
411000                  PC-BUYER-BYR                                    41100002
411100         DISPLAY 'PV-PROCESS-DATE-R: '                            41110002
411200                  PV-PROCESS-DATE-R                               41120002
411300         PERFORM Z999-SQL-ERROR                                   41130002
411400     END-EVALUATE.                                                41140002
411500 EJECT                                                            41150002
411600******************************************************************41160002
411700*  DETERMINES IF THERE ARE MULTIPLE WEIGHT CODES FOR THIS ASN.   *41170002
411800******************************************************************41180002
411900*                                                                 41190002
412000 S500-GET-PACK-CODES.                                             41200002
412100*                                                                 41210002
412200     MOVE 'S500'                  TO PGM-LOCATION.                41220002
412300     MOVE 'S500-GET-PACK-CODES   '                                41230002
412400                                  TO PV-ABEND-PARAGRAPH.          41240002
412500     PERFORM Y600-OPEN-WEIGHT-CURSOR.                             41250002
412600*                                                                 41260002
412700     MOVE ZEROS                   TO PV-GRO-WGHT-MSMT             41270002
412800                                     PV-TOTAL-CARTONS-SHPMT.      41280002
412900     MOVE SPACES                  TO PV-PREV-GRO-WGHT-UM-CDE.     41290002
413000*                                                                 41300002
413100     PERFORM S570-FETCH-GROSS-WGHT.                               41310002
413200*                                                                 41320002
413300     IF SQLCODE = ZERO                                            41330002
413400         MOVE ASNPKG-CART-SHIP-QTY                                41340002
413500                                  TO PV-TOTAL-CARTONS-SHPMT       41350002
413600         MOVE ASNPKG-GRO-WGHT-UM-CDE                              41360002
413700                                  TO PV-PREV-GRO-WGHT-UM-CDE      41370002
413800         ADD ASNPKG-GRO-WGHT-MSMT TO PV-GRO-WGHT-MSMT             41380002
413900     END-IF.                                                      41390002
414000*                                                                 41400002
414100     PERFORM S550-PROCESS-GROSS-WGHT                              41410002
414200         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        41420002
414300*                                                                 41430002
414400     MOVE PV-GRO-WGHT-MSMT        TO PV-H5-SHIP-WEIGHT            41440002
414500                                     RC001-SHIPMENT-WEIGHT.       41450002
414600     MOVE PV-PREV-GRO-WGHT-UM-CDE TO PV-H5-UNIT-MEASURE           41460002
414700                                     RC001-SHIP-WEIGHT-UM.        41470002
414800     MOVE PV-TOTAL-CARTONS-SHPMT  TO PV-H8-TOTAL-CARTONS-SHPMT    41480002
414900                                     RC001-CARTON-CNT-SHPMT.      41490002
415000                                                                  41500002
415100*                                                                 41510002
415200     PERFORM Y700-CLOSE-WEIGHT-CURSOR.                            41520002
415300*                                                                 41530002
415400 EJECT                                                            41540002
415500******************************************************************41550002
415600*  RETRIEVES THE ASNPKG RECORDS FOR THE ASN.  IF ALL THE UM      *41560002
415700*  CODES ARE EQUAL, SUM THE TOTAL GROSS WEIGHT.  OTHERWISE       *41570002
415800*  DEFAULT FILL THE FIELDS.                                      *41580002
415900******************************************************************41590002
416000*                                                                 41600002
416100 S550-PROCESS-GROSS-WGHT.                                         41610002
416200*                                                                 41620002
416300     MOVE 'S550'                  TO PGM-LOCATION.                41630002
416400     MOVE 'S550-PROCESS-GROSS-WGHT'                               41640002
416500                                  TO PV-ABEND-PARAGRAPH.          41650002
416600*                                                                 41660002
416700     PERFORM S570-FETCH-GROSS-WGHT.                               41670002
416800*                                                                 41680002
416900     EVALUATE TRUE                                                41690002
417000       WHEN SQLCODE         = ZERO                                41700002
417100         ADD ASNPKG-CART-SHIP-QTY TO PV-TOTAL-CARTONS-SHPMT       41710002
417200         IF ASNPKG-GRO-WGHT-UM-CDE = PV-PREV-GRO-WGHT-UM-CDE      41720002
417300             ADD ASNPKG-GRO-WGHT-MSMT                             41730002
417400                                  TO PV-GRO-WGHT-MSMT             41740002
417500         ELSE                                                     41750002
417600             MOVE ZEROS           TO PV-GRO-WGHT-MSMT             41760002
417700             MOVE SPACES          TO PV-PREV-GRO-WGHT-UM-CDE      41770002
417800             MOVE PC-ROW-NOT-FOUND                                41780002
417900                                  TO SQLCODE                      41790002
418000         END-IF                                                   41800002
418100       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    41810002
418200         CONTINUE                                                 41820002
418300       WHEN OTHER                                                 41830002
418400         DISPLAY PV-ABEND-PARAGRAPH                               41840002
418500         DISPLAY 'ASNHDR-ASNHDR-NBR: '                            41850002
418600                  ASNHDR-ASNHDR-NBR                               41860002
418700         DISPLAY 'ASNHDR-ASNHDR-ID: '                             41870002
418800                  ASNHDR-ASNHDR-ID                                41880002
418900         PERFORM Z999-SQL-ERROR                                   41890002
419000     END-EVALUATE.                                                41900002
419100 EJECT                                                            41910002
419200******************************************************************41920002
419300*  FETCHS THE WEIGHT CURSOR ROW                                  *41930002
419400******************************************************************41940002
419500*                                                                 41950002
419600 S570-FETCH-GROSS-WGHT.                                           41960002
419700*                                                                 41970002
419800     MOVE 'S570'                  TO PGM-LOCATION.                41980002
419900     MOVE 'S570-FETCH-GROSS-WGHT   '                              41990002
420000                                  TO PV-ABEND-PARAGRAPH.          42000002
420100*                                                                 42010002
420200     EXEC SQL                                                     42020002
420300         FETCH WEIGHT_CURSOR                                      42030002
420400          INTO :ASNPKG-CART-SHIP-QTY,                             42040002
420500               :ASNPKG-GRO-WGHT-UM-CDE,                           42050002
420600               :ASNPKG-GRO-WGHT-MSMT                              42060002
420700     END-EXEC.                                                    42070002
420800*                                                                 42080002
420900 EJECT                                                            42090002
421000******************************************************************42100002
421100*  RETREIVES COUNT OF CARTONS FOR SPECIFIED ORDER AND STORE FROM *42110002
421200*  TASNCAR TABLE.                                                *42120002
421300******************************************************************42130002
421400*                                                                 42140002
421500 S600-COUNT-CARTONS-FOR-ORDER.                                    42150002
421600*                                                                 42160002
421700     MOVE 'S600'                  TO PGM-LOCATION.                42170002
421800     MOVE 'S600-COUNT-CARTONS-FOR-ORDER'                          42180002
421900                                  TO PV-ABEND-PARAGRAPH.          42190002
422000*                                                                 42200002
422100     EXEC SQL                                                     42210002
422200         SELECT COUNT (*)                                         42220002
422300         INTO  :PV-TOTAL-CARTONS-STORE                            42230002
422400         FROM  TASNCAR                                            42240002
422500         WHERE ASNHDR_ID   = :ASNHDR-ASNHDR-ID                    42250002
422600           AND PO_NBR      = :ASNORD-PO-NBR                       42260002
422700           AND LOC_NBR     = :ASNORD-LOC-NBR                      42270002
422800     END-EXEC.                                                    42280002
422900*                                                                 42290002
423000     EVALUATE TRUE                                                42300002
423100       WHEN SQLCODE         = ZERO                                42310002
423200         MOVE PV-TOTAL-CARTONS-STORE                              42320002
423300                           TO PV-H8-TOTAL-CARTONS-STORE           42330002
423400                              RC001-CARTON-CNT-STORE              42340002
423500        IF PV-TOTAL-CARTONS-STORE = ZERO                          42350002
423600*         MOVE ZEROES      TO PV-H8-TOTAL-CARTONS-STORE           42360002
423700          MOVE ZEROES      TO RC001-CARTON-CNT-STORE              42370002
423800          MOVE PC-NOT-SENT TO PV-H8-TOTAL-CARTONS-STORE-X         42380002
423900        END-IF                                                    42390002
424000       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    42400002
424100            CONTINUE                                              42410002
424200       WHEN OTHER                                                 42420002
424300         DISPLAY PV-ABEND-PARAGRAPH                               42430002
424400         DISPLAY 'ASNHDR-ASNHDR-ID: '                             42440002
424500                  ASNHDR-ASNHDR-ID                                42450002
424600         DISPLAY 'ASNORD-PO-NBR: '                                42460002
424700                  ASNORD-PO-NBR                                   42470002
424800         DISPLAY 'ASNORD-LOC-NBR: '                               42480002
424900                  ASNORD-LOC-NBR                                  42490002
425000         PERFORM Z999-SQL-ERROR                                   42500002
425100     END-EVALUATE.                                                42510002
425200*                                                                 42520002
425300 EJECT                                                            42530002
425400******************************************************************42540002
425500*  GET CARTON COUNT INFORMATION FROM TASNORD TABLE( TD1 RECORD    42550002
425600*  ON PO LEVEL)                                                   42560002
425700******************************************************************42570002
425800 S610-STORE-CARTONS-FROM-TD1.                                     42580002
425900                                                                  42590002
426000     MOVE 'S610'                  TO PGM-LOCATION.                42600002
426100     MOVE 'S610-STORE-CARTONS-FROM-TD1'                           42610002
426200                                  TO PV-ABEND-PARAGRAPH.          42620002
426300                                                                  42630002
426400     EXEC SQL                                                     42640002
426500         SELECT SUM (CART_SHIP_QTY)                               42650002
426600         INTO  :PV-TOTAL-CARTONS-STORE:PV-STORE-CARTONS-QTY-NULL  42660002
426700         FROM  TASNORD                                            42670002
426800         WHERE ASNHDR_ID   = :ASNHDR-ASNHDR-ID                    42680002
426900           AND PO_NBR      = :ASNORD-PO-NBR                       42690002
427000           AND LOC_NBR     = :ASNORD-LOC-NBR                      42700002
427100     END-EXEC.                                                    42710002
427200                                                                  42720002
427300     EVALUATE TRUE                                                42730002
427400       WHEN SQLCODE         = ZERO                                42740002
427500        IF PV-STORE-CARTONS-QTY-NULL < ZERO                       42750002
427600                                                                  42760002
427700         MOVE ZEROES       TO PV-H8-TOTAL-CARTONS-STORE           42770002
427800                              RC001-CARTON-CNT-STORE              42780002
427900        ELSE                                                      42790002
428000          IF PV-TOTAL-CARTONS-STORE NOT = ZERO                    42800002
428100             MOVE PV-TOTAL-CARTONS-STORE                          42810002
428200                           TO PV-H8-TOTAL-CARTONS-STORE           42820002
428300                              RC001-CARTON-CNT-STORE              42830002
428400          ELSE                                                    42840002
428500           PERFORM  S600-COUNT-CARTONS-FOR-ORDER                  42850002
428600          END-IF                                                  42860002
428700        END-IF                                                    42870002
428800                                                                  42880002
428900       WHEN OTHER                                                 42890002
429000         DISPLAY PV-ABEND-PARAGRAPH                               42900002
429100         DISPLAY 'ASNHDR-ASNHDR-ID: '                             42910002
429200                  ASNHDR-ASNHDR-ID                                42920002
429300         DISPLAY 'ASNORD-PO-NBR: '                                42930002
429400                  ASNORD-PO-NBR                                   42940002
429500         DISPLAY 'ASNORD-LOC-NBR: '                               42950002
429600                  ASNORD-LOC-NBR                                  42960002
429700         PERFORM Z999-SQL-ERROR                                   42970002
429800     END-EVALUATE.                                                42980002
429900*                                                                 42990002
430000 EJECT                                                            43000002
430100******************************************************************43010002
430200*  RETREIVES COUNT OF CARTONS FOR SPECIFIED ORDER AND PO FROM    *43020002
430300*  TASNCAR TABLE.                                                *43030002
430400******************************************************************43040002
430500*                                                                 43050002
430600 S650-COUNT-CARTONS-FOR-PO.                                       43060002
430700*                                                                 43070002
430800     MOVE 'S650'                  TO PGM-LOCATION.                43080002
430900     MOVE 'S650-COUNT-CARTONS-FOR-PO   '                          43090002
431000                                  TO PV-ABEND-PARAGRAPH.          43100002
431100*                                                                 43110002
431200     EXEC SQL                                                     43120002
431300         SELECT COUNT (*)                                         43130002
431400         INTO  :PV-TOTAL-CARTONS-PO                               43140002
431500         FROM  TASNCAR                                            43150002
431600         WHERE ASNHDR_ID   = :ASNHDR-ASNHDR-ID                    43160002
431700           AND PO_NBR      = :ASNORD-PO-NBR                       43170002
431800     END-EXEC.                                                    43180002
431900*                                                                 43190002
432000     EVALUATE TRUE                                                43200002
432100       WHEN SQLCODE         = ZERO                                43210002
432200         MOVE PV-TOTAL-CARTONS-PO                                 43220002
432300                           TO PV-H8-TOTAL-CARTONS-PO              43230002
432400                              RC001-CARTON-CNT-PO                 43240002
432500         IF   PV-TOTAL-CARTONS-PO = ZERO                          43250002
432600          MOVE ZEROES      TO RC001-CARTON-CNT-PO                 43260002
432700          MOVE PC-NOT-SENT TO PV-H8-TOTAL-CARTONS-PO-X            43270002
432800         END-IF                                                   43280002
432900       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    43290002
433000           CONTINUE                                               43300002
433100       WHEN OTHER                                                 43310002
433200         DISPLAY PV-ABEND-PARAGRAPH                               43320002
433300         DISPLAY 'ASNHDR-ASNHDR-ID: '                             43330002
433400                  ASNHDR-ASNHDR-ID                                43340002
433500         DISPLAY 'ASNORD-PO-NBR: '                                43350002
433600                  ASNORD-PO-NBR                                   43360002
433700         PERFORM Z999-SQL-ERROR                                   43370002
433800     END-EVALUATE.                                                43380002
433900*                                                                 43390002
434000 EJECT                                                            43400002
434100******************************************************************43410002
434200*  GET CARTON COUNT INFORMATION FROM TASNORD TABLE( TD1 RECORD    43420002
434300*  ON PO LEVEL)                                                   43430002
434400******************************************************************43440002
434500 S655-PO-CARTONS-FROM-TD1.                                        43450002
434600                                                                  43460002
434700     MOVE 'S655'                  TO PGM-LOCATION.                43470002
434800     MOVE 'S655-PO-CARTONS-FROM-TD1.'                             43480002
434900                                  TO PV-ABEND-PARAGRAPH.          43490002
435000                                                                  43500002
435100     EXEC SQL                                                     43510002
435200         SELECT SUM (CART_SHIP_QTY)                               43520002
435300         INTO  :PV-TOTAL-CARTONS-PO:PV-PO-CARTONS-QTY-NULL        43530002
435400         FROM  TASNORD                                            43540002
435500         WHERE ASNHDR_ID   = :ASNHDR-ASNHDR-ID                    43550002
435600           AND PO_NBR      = :ASNORD-PO-NBR                       43560002
435700     END-EXEC.                                                    43570002
435800                                                                  43580002
435900     EVALUATE TRUE                                                43590002
436000       WHEN SQLCODE         = ZERO                                43600002
436100                                                                  43610002
436200        IF PV-PO-CARTONS-QTY-NULL < ZERO                          43620002
436300                                                                  43630002
436400         MOVE ZEROES       TO PV-H8-TOTAL-CARTONS-PO              43640002
436500                              RC001-CARTON-CNT-PO                 43650002
436600        ELSE                                                      43660002
436700                                                                  43670002
436800          IF PV-TOTAL-CARTONS-PO NOT = ZERO                       43680002
436900             MOVE PV-TOTAL-CARTONS-PO                             43690002
437000                           TO PV-H8-TOTAL-CARTONS-PO              43700002
437100                              RC001-CARTON-CNT-PO                 43710002
437200          ELSE                                                    43720002
437300           PERFORM S650-COUNT-CARTONS-FOR-PO                      43730002
437400          END-IF                                                  43740002
437500                                                                  43750002
437600        END-IF                                                    43760002
437700       WHEN OTHER                                                 43770002
437800         DISPLAY PV-ABEND-PARAGRAPH                               43780002
437900         DISPLAY 'ASNHDR-ASNHDR-ID: '                             43790002
438000                  ASNHDR-ASNHDR-ID                                43800002
438100         DISPLAY 'ASNORD-PO-NBR: '                                43810002
438200                  ASNORD-PO-NBR                                   43820002
438300         PERFORM Z999-SQL-ERROR                                   43830002
438400     END-EVALUATE.                                                43840002
438500*                                                                 43850002
438600*EJECT                                                            43860002
438700******************************************************************43870002
438800*  CHECKS IF THE ORDER WAS SHIPPED EARLY OR LATE, OR IF THE      *43880002
438900*  PURCHASE ORDER IS UNMATCHED                                   *43890002
439000******************************************************************43900002
439100*                                                                 43910002
439200 S700-CHECK-FOR-ADDTL-ERRORS.                                     43920002
439300     MOVE ASNORD-EARLY-LTE-CDE    TO RC001-ASNORD-EARLY-LTE-CDE.  43930002
439400*                                                                 43940002
439500     IF ASNORD-EARLY-LTE-CDE = PC-E                               43950002
439600         MOVE PC-AEM-1            TO PV-H10-GE-1                  43960002
439700     ELSE                                                         43970002
439800         IF ASNORD-EARLY-LTE-CDE = PC-L                           43980002
439900             MOVE PC-AEM-2        TO PV-H10-GE-1                  43990002
440000         END-IF                                                   44000002
440100     END-IF.                                                      44010002
440200*                                                                 44020002
440300     MOVE ASNORD-MTCH-PO-CDE      TO RC001-ASNORD-MTCH-PO-CDE.    44030002
440400*                                                                 44040002
440500     IF ASNORD-MTCH-PO-CDE = PC-U                                 44050002
440600         MOVE PC-AEM-3            TO PV-H10-GE-2                  44060002
440700     ELSE                                                         44070002
440800         IF ASNORD-MTCH-PO-CDE = PC-C                             44080002
440900             MOVE PC-AEM-4        TO PV-H10-GE-2                  44090002
441000         END-IF                                                   44100002
441100     END-IF.                                                      44110002
441200*                                                                 44120002
441300 EJECT                                                            44130002
441400******************************************************************44140002
441500*  CHECKS FOR OVER OR UNDER SHIPMENTS AND VENDOR SUBSTITUTIONS   *44150002
441600******************************************************************44160002
441700*                                                                 44170002
441800 S800-DERIVE-ERROR-CODES.                                         44180002
441900*                                                                 44190002
442000     MOVE PV-CURR-SHIPT-VAR-QTY   TO RC001-QTY-SHIPPED-VAR.       44200002
442100*                                                                 44210002
442200     IF PV-CURR-PO-LN-NBR = ZEROS                                 44220002
442300         MOVE PC-N                TO RC001-ASDTPL-MATCH-IND       44230002
442400     ELSE                                                         44240002
442500         MOVE PC-Y                TO RC001-ASDTPL-MATCH-IND       44250002
442600     END-IF.                                                      44260002
442700*                                                                 44270002
442800     IF PV-CURR-PR-VAR-IND = PC-Y                                 44280002
442900         MOVE PV-CURR-PR-VAR-IND  TO RC001-ASDTPL-PR-VAR-IND      44290002
443000     ELSE                                                         44300002
443100         MOVE PC-N                TO RC001-ASDTPL-PR-VAR-IND      44310002
443200     END-IF.                                                      44320002
443300*                                                                 44330002
443400     IF PV-CURR-PR-DISC-IND = PC-Y                                44340002
443500         MOVE PV-CURR-PR-DISC-IND TO RC001-ASDTPL-PR-DISC-IND     44350002
443600     ELSE                                                         44360002
443700         MOVE PC-N                TO RC001-ASDTPL-PR-DISC-IND     44370002
443800     END-IF.                                                      44380002
443900*                                                                 44390002
444000     IF PV-CURR-ASDTPL-ALLOC-IND = PC-Y                           44400002
444100         MOVE PV-CURR-ASDTPL-ALLOC-IND                            44410002
444200                                  TO RC001-ASDTPL-ALLOC-IND       44420002
444300     ELSE                                                         44430002
444400         MOVE PC-N                TO RC001-ASDTPL-ALLOC-IND       44440002
444500     END-IF.                                                      44450002
444600*                                                                 44460002
444700 EJECT                                                            44470002
444800******************************************************************44480002
444900*  FETCHES THE ASN DETAIL INFORMATION FOR RECORDS THAT DON'T     *44490002
445000*  HAVE A CORRESPONDING RECORD ON ASDTPL                         *44500002
445100******************************************************************44510002
445200*                                                                 44520002
445300 S900-FETCH-ASN-DTL-NOT-EXISTS.                                   44530002
445400*                                                                 44540002
445500     MOVE 'S900'                  TO PGM-LOCATION.                44550002
445600     MOVE 'S900-FETCH-ASN-DTL-NOT-EXISTS'                         44560002
445700                                  TO PV-ABEND-PARAGRAPH.          44570002
445800*                                                                 44580002
445900     EXEC SQL                                                     44590002
446000         FETCH DTL_NOT_EXISTS_CSR                                 44600002
446100           INTO :ASNDTL-ASNDTL-NBR,                               44610002
446200                :ASNDTL-UPC-NBR,                                  44620002
446300                :ASNDTL-SHIPT-QTY,                                44630002
446400                :ASNDTL-SHIPT-UM-CDE,                             44640002
446500                :ASNDTL-PKG-QTY :PV-DTL-PKG-QTY-NULL,             44650002
446600                :ASNDTL-ORD-QTY-UM-CDE :PV-DTL-ORD-QTY-UM-CDE-NULL44660002
446700     END-EXEC.                                                    44670002
446800*                                                                 44680002
446900     EVALUATE TRUE                                                44690002
447000       WHEN SQLCODE = ZEROS                                       44700002
447100         SET PS-NOT-END-OF-ASN-DETAIL                             44710002
447200                                  TO TRUE                         44720002
447300       WHEN SQLCODE = PC-ROW-NOT-FOUND                            44730002
447400         SET PS-END-OF-ASN-DETAIL TO TRUE                         44740002
447500       WHEN OTHER                                                 44750002
447600         DISPLAY PV-ABEND-PARAGRAPH                               44760002
447700         PERFORM Z999-SQL-ERROR                                   44770002
447800     END-EVALUATE.                                                44780002
447900*                                                                 44790002
448000 EJECT                                                            44800002
448100 S995-CALL-XLKUT-DOMAIN-PGM.                                      44810002
448200     INITIALIZE XL001-ITEM-COMMAREA.                              44820002
448300                                                                  44830002
448400     MOVE '7010-SELECT-SKU-BY-SKU'                                44840002
448500                               TO PV-ABEND-PARAGRAPH.             44850002
448600     MOVE PV-CURR-UPC-NBR      TO XL001-KEY-UPC-NBR.              44860002
448700                                                                  44870002
448800     SET  XL001-BY-UPC-NBR                                        44880002
448900          XL001-SELECT-VND-STYL                                   44890002
449000          XL001-SELECT-SKU-STR                                    44900002
449100          XL001-SELECT-UPC                                        44910002
449200          XL001-SELECT-SKU TO TRUE.                               44920002
449300                                                                  44930002
449400     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               44940002
449500         EVALUATE TRUE                                            44950002
449600         WHEN XL001-UPC-SQLCODE = ZEROS                           44960002
449700         PERFORM S996-SELECT-SKU                                  44970002
449800         WHEN XL001-UPC-SQLCODE = +100                            44980002
449900         MOVE ZEROS              TO PV-UNIT-COST-AMT              44990002
450000                                    PV-CUR-UNIT-RTL-AMT           45000002
450100                                    PV-SEQ-NMBR                   45010002
450200         MOVE SPACES             TO PV-MERCH-DEPT-NMBR            45020002
450300                                    PV-MERCH-CLASS-NMBR           45030002
450400                                    PV-VENDOR-STYLE-CODE          45040002
450500                                    PV-SKU-DESC                   45050002
450600                                    PV-SIZE-DESC                  45060002
450700                                    PV-COLOR-DESC                 45070002
450800          WHEN XL001-SKU-CONTENTION                               45080002
450900          WHEN XL001-VND-STYL-CONTENTION                          45090002
451000          WHEN XL001-SKU-STR-CONTENTION                           45100002
451100          WHEN XL001-UPC-CONTENTION                               45110002
451200               MOVE '7010-SELECT-SKU-BY-SKU'                      45120002
451300                                      TO PV-ABEND-PARAGRAPH       45130002
451400               MOVE 'CONTENTION ON VIEWS'                         45140002
451500                                      TO PV-ABEND-MESSAGE-TEXT    45150002
451600               MOVE XL001-SKU-SQLCODE TO PV-SQLCODE               45160002
451700               MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME         45170002
451800               PERFORM 9000-PROCESS-ABEND                         45180002
451900          WHEN OTHER                                              45190002
452000               DISPLAY PV-ABEND-PARAGRAPH                         45200002
452100               DISPLAY 'ASNHDR-OPERCO-NBR: '                      45210002
452200                        ASNHDR-OPERCO-NBR                         45220002
452300               DISPLAY 'ASNHDR-EDI-VEND-ID: '                     45230002
452400                        ASNHDR-EDI-VEND-ID                        45240002
452500               DISPLAY 'ASNHDR-ASNHDR-NBR: '                      45250002
452600                        ASNHDR-ASNHDR-NBR                         45260002
452700               DISPLAY 'ASNORD-PO-NBR: '                          45270002
452800                        ASNORD-PO-NBR                             45280002
452900               PERFORM Z999-SQL-ERROR                             45290002
453000         END-EVALUATE.                                            45300002
453100* ADDED LOGIC TO GET VALUES FROM UPC VIEW  # 230ZZ                45310002
453200 S996-SELECT-SKU.                                                 45320002
453300     MOVE '7300-SELECT-UPC'    TO PV-ABEND-PARAGRAPH.             45330002
453400                                                                  45340002
453500      EVALUATE TRUE                                               45350002
453600                                                                  45360002
453700      WHEN XL001-SKU-SQLCODE = +0                                 45370002
453800         MOVE XL001-SKU-NBR         TO PV-DL1-SEQ,                45380002
453900                                       PV-SEQ-NMBR                45390002
454000         MOVE XL001-SKU-DESC        TO PV-SKU-DESC                45400002
454100         MOVE XL001-SIZE-DESC       TO PV-SIZE-DESC               45410002
454200         MOVE XL001-CSTM-CLOR-DESC  TO PV-COLOR-DESC              45420002
454300         PERFORM S997-SELECT-VND-STYL                             45430002
454400         PERFORM S998-SELECT-SKU-STR                              45440002
454500      WHEN XL001-SKU-SQLCODE = +100                               45450002
454600          MOVE SPACE        TO PV-DL1-SEQ                         45460002
454700          MOVE ZERO         TO PV-SEQ-NMBR                        45470002
454800          MOVE SPACE        TO PV-SKU-DESC                        45480002
454900          MOVE SPACE        TO PV-SIZE-DESC                       45490002
455000          MOVE SPACE        TO PV-COLOR-DESC                      45500002
455100      END-EVALUATE.                                               45510002
455200* ADDED LOGIC TO GET VALUES FROM VND-STYL VIEW  # 230ZZ           45520002
455300 S997-SELECT-VND-STYL.                                            45530002
455400     MOVE '7300-SELECT-UPC'    TO PV-ABEND-PARAGRAPH.             45540002
455500                                                                  45550002
455600         EVALUATE TRUE                                            45560002
455700         WHEN XL001-VND-STYL-SQLCODE = +0                         45570002
455800              MOVE XL001-VS-NBR     TO PV-VENDOR-STYLE-CODE       45580002
455900              MOVE XL001-DEPT-NBR-3CH TO PV-MERCH-DEPT-NMBR       45590002
456000              MOVE XL001-SUB-CL-NBR-2CH TO PV-MERCH-CLASS-NMBR    45600002
456100         WHEN XL001-VND-STYL-SQLCODE = +100                       45610002
456200              MOVE SPACE       TO PV-VENDOR-STYLE-CODE            45620002
456300              MOVE SPACE       TO PV-MERCH-DEPT-NMBR              45630002
456400              MOVE SPACE       TO PV-MERCH-CLASS-NMBR             45640002
456500         END-EVALUATE.                                            45650002
456600* ADDED LOGIC TO GET VALUES FROM SKU-STR VIEW  # 230ZZ            45660002
456700 S998-SELECT-SKU-STR.                                             45670002
456800          EVALUATE TRUE                                           45680002
456900              WHEN XL001-SKU-STR-SQLCODE  = +0                    45690002
457000                MOVE XL001-UNT-COST-AMT   TO PV-UNIT-COST-AMT     45700002
457100                MOVE XL001-UNT-RTL-AMT    TO PV-CUR-UNIT-RTL-AMT  45710002
457200              WHEN XL001-SKU-STR-SQLCODE  = +100                  45720002
457300                MOVE ZERO      TO PV-UNIT-COST-AMT                45730002
457400                MOVE ZERO      TO PV-CUR-UNIT-RTL-AMT             45740002
457500          END-EVALUATE.                                           45750002
457600                                                                  45760002
457700*----------------------------------------------------------------*45770002
457800* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *45780002
457900*----------------------------------------------------------------*45790002
458000******************************************************************45800002
458100* OBTAINS STORE NAME FROM RF STORE TABLE                          45810002
458200******************************************************************45820002
458300 T000-OBTAIN-STORE-NAME.                                          45830002
458400     MOVE 'T000'                 TO PGM-LOCATION.                 45840002
458500     MOVE 'T000-OBTAIN-STORE-NAME    '                            45850002
458600                                 TO PV-ABEND-PARAGRAPH.           45860002
458700                                                                  45870002
458800     EXEC SQL                                                     45880002
458900         SELECT LOC_NM                                            45890002
459000           INTO :XLT00010-LOC-NM                                  45900002
459100           FROM XLT_LOC                                           45910002
459200          WHERE LOC_NBR = :PV-DC-STR-CHECK                        45920002
459300            AND DATE(:PV-DONT-SHIP-BEF-DATE) < CLO_DTE            45930002
459400     END-EXEC.                                                    45940002
459500     EVALUATE TRUE                                                45950002
459600       WHEN SQLCODE = ZEROS                                       45960002
459700         SET DC-STR-FOUND TO TRUE                                 45970002
459800       WHEN SQLCODE = PC-ROW-NOT-FOUND                            45980002
459900         SET DC-STR-NOT-FOUND TO TRUE                             45990002
460000       WHEN OTHER                                                 46000002
460100         DISPLAY PV-ABEND-PARAGRAPH                               46010002
460200         PERFORM Z999-SQL-ERROR                                   46020002
460300     END-EVALUATE.                                                46030002
460400                                                                  46040002
460500******************************************************************46050002
460600* DETERMINE THE PROPER HOST VARIABLE DATE                         46060002
460700******************************************************************46070002
460800 T090-EDIT-DO-NOT-SHIP-B4-DATE.                                   46080002
460900                                                                  46090002
461000     PERFORM T200-GET-DONT-SHIP-BEF-DATE.                         46100002
461100     IF PLNSHP-DONT-SHIP-BEF-DTE > PV-CURRENT-DATE                46110002
461200         MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DONT-SHIP-BEF-DATE   46120002
461300     ELSE                                                         46130002
461400         MOVE PV-CURRENT-DATE          TO PV-DONT-SHIP-BEF-DATE   46140002
461500     END-IF.                                                      46150002
461600                                                                  46160002
461700******************************************************************46170002
461800* OBTAINS SHIPPING ADDRESS ROW TO OBTAIN DC FROM STORE            46180002
461900* FINDS STORE ON THE LOCATION BLACK BOX AND GETS ASSIGNED DC.     46190002
462000* THEN SELECTS DC FROM XLT_LOC TO NAME. THIS REPLACES A NASTY     46200002
462100* UNION.  IS ONLY USED PBS AND WHEN INPUT DC IS NOT FOUND.        46210002
462200******************************************************************46220002
462300                                                                  46230002
462400 T100-VALIDATE-DC.                                                46240002
462500     MOVE 'T100'                 TO PGM-LOCATION.                 46250002
462600     MOVE 'T100-VALIDATE-DC          '                            46260002
462700                                 TO PV-ABEND-PARAGRAPH.           46270002
462800                                                                  46280002
462900     INITIALIZE XL071-COMMAREA-REC.                               46290002
463000                                                                  46300002
463100     MOVE PV-DC-STR-CHECK TO XL071-LOCATION-NUMBER.               46310002
463200                                                                  46320002
463300     CALL XL071-LOCATION-MODULE USING                             46330002
463400                                XL071-COMMAREA-REC.               46340002
463500                                                                  46350002
463600     EVALUATE TRUE                                                46360002
463700         WHEN XL071-NO-ERRORS                                     46370002
463800            SET DC-STR-FOUND TO TRUE                              46380002
463900         WHEN XL071-LOC-NOT-FOUND                                 46390002
464000            SET DC-STR-NOT-FOUND TO TRUE                          46400002
464100         WHEN XL071-DC-ASGMT-NOT-FND                              46410002
464200            SET DC-STR-NOT-FOUND TO TRUE                          46420002
464300         WHEN OTHER                                               46430002
464400            DISPLAY 'CALL TO XLKUT071-LOC BLACK BOX'              46440002
464500            DISPLAY PV-ABEND-PARAGRAPH                            46450002
464600            DISPLAY 'LOCATION NUMBER: '                           46460002
464700                     PV-DC-STR-CHECK                              46470002
464800            PERFORM Z999-SQL-ERROR                                46480002
464900     END-EVALUATE.                                                46490002
465000                                                                  46500002
465100     IF DC-STR-FOUND                                              46510002
465200        MOVE XL071-ASGMT-DC-NBR TO XLT00010-LOC-NBR               46520002
465300        EXEC SQL                                                  46530002
465400           SELECT LOC_NM                                          46540002
465500             INTO :XLT00010-LOC-NM                                46550002
465600             FROM XLT_LOC                                         46560002
465700            WHERE LOC_NBR = :XLT00010-LOC-NBR                     46570002
465800        END-EXEC                                                  46580002
465900                                                                  46590002
466000         EVALUATE TRUE                                            46600002
466100            WHEN SQLCODE = 0                                      46610002
466200               CONTINUE                                           46620002
466300            WHEN OTHER                                            46630002
466400               MOVE SPACES TO XLT00010-LOC-NM                     46640002
466500         END-EVALUATE                                             46650002
466600      END-IF.                                                     46660002
466700                                                                  46670002
466800******************************************************************46680002
466900* TRY TO PULL DC FROM THE TASHADR TABLE                           46690002
467000******************************************************************46700002
467100 T110-CHECK-TASHADR-FOR-DC.                                       46710002
467200                                                                  46720002
467300     EXEC SQL                                                     46730002
467400         SELECT NAME_ID_CDE                                       46740002
467500           INTO :PV-NAME-ID-CDE:PV-NAME-ID-CDE-NULL               46750002
467600           FROM TASHADR                                           46760002
467700           WHERE NAME_CDE          = 'ST'                         46770002
467800             AND ASNHDR_ID         = :ASNHDR-ASNHDR-ID            46780002
467900     END-EXEC.                                                    46790002
468000                                                                  46800002
468100                                                                  46810002
468200     EVALUATE TRUE                                                46820002
468300       WHEN SQLCODE = ZEROS                                       46830002
468400           IF PV-NAME-ID-CDE-NULL      < ZERO                     46840002
468500               SET DC-STR-NOT-FOUND TO TRUE                       46850002
468600           ELSE                                                   46860002
468700              MOVE PV-NAME-ID-CDE TO DP010I-UNEDITED-FIELD        46870002
468800              MOVE 4              TO DP010I-MAXIMUM-DIGITS        46880002
468900              MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS      46890002
469000              CALL DP010I-NUMERIC-EDIT-ROUTINE                    46900002
469100                   USING DP010I-NUMERIC-EDIT-AREA                 46910002
469200              IF DP010I-ERROR-DETECTED                            46920002
469300                 MOVE 0 TO PV-DC-STR-CHECK                        46930002
469400              ELSE                                                46940002
469500                 MOVE DP010I-NUMERIC-FIELD TO PV-DC-STR-CHECK     46950002
469600              END-IF                                              46960002
469700              PERFORM T115-DC-VALIDATION                          46970002
469800           END-IF                                                 46980002
469900       WHEN SQLCODE = PC-ROW-NOT-FOUND                            46990002
470000           SET DC-STR-NOT-FOUND TO TRUE                           47000002
470100       WHEN OTHER                                                 47010002
470200         DISPLAY PV-ABEND-PARAGRAPH                               47020002
470300         DISPLAY 'ASN HEADER   '                                  47030002
470400                  ASNHDR-ASNHDR-NBR                               47040002
470500         PERFORM Z999-SQL-ERROR                                   47050002
470600     END-EVALUATE.                                                47060002
470700                                                                  47070002
470800******************************************************************47080002
470900* VALIDATE THE DC FROM THE TASHADR TABLE IS VALID                 47090002
471000******************************************************************47100002
471100 T115-DC-VALIDATION.                                              47110002
471200                                                                  47120002
471300     MOVE 'T115'                 TO PGM-LOCATION.                 47130002
471400     MOVE 'T115-DC-VALIDATION        '                            47140002
471500                                 TO PV-ABEND-PARAGRAPH.           47150002
471600                                                                  47160002
471700     EXEC SQL                                                     47170002
471800         SELECT LOC_NBR, LOC_NM                                   47180002
471900           INTO :XLT00010-LOC-NBR,                                47190002
472000                :XLT00010-LOC-NM                                  47200002
472100           FROM XLT_LOC                                           47210002
472200          WHERE LOC_NBR     = :PV-DC-STR-CHECK                    47220002
472300            AND LOC_TYP_CDE = 'DC'                                47230002
472400            AND DATE(:PV-DONT-SHIP-BEF-DATE) < CLO_DTE            47240002
472500     END-EXEC.                                                    47250002
472600                                                                  47260002
472700     EVALUATE TRUE                                                47270002
472800       WHEN SQLCODE = ZEROS                                       47280002
472900             SET DC-STR-FOUND  TO TRUE                            47290002
473000       WHEN SQLCODE = PC-ROW-NOT-FOUND                            47300002
473100             SET DC-STR-NOT-FOUND  TO TRUE                        47310002
473200       WHEN OTHER                                                 47320002
473300         DISPLAY PV-ABEND-PARAGRAPH                               47330002
473400         PERFORM Z999-SQL-ERROR                                   47340002
473500     END-EVALUATE.                                                47350002
473600                                                                  47360002
473700******************************************************************47370002
473800* VALIDATE THE SHIPMENT AND ORDER LEVEL DC/STORE CODES (BULK ONLY)47380002
473900******************************************************************47390002
474000 T120-EVALUATE-BULK-CODES.                                        47400002
474100                                                                  47410002
474200     MOVE 'T120'                 TO PGM-LOCATION.                 47420002
474300     MOVE 'T120-EVALUATE-BULK-CODES  '                            47430002
474400                                 TO PV-ABEND-PARAGRAPH.           47440002
474500                                                                  47450002
474600* EVALUATE SHIPMENT LEVEL CODE                                    47460002
474700     EXEC SQL                                                     47470002
474800         SELECT NAME_ID_CDE                                       47480002
474900           INTO :PV-NAME-ID-CDE:PV-NAME-ID-CDE-NULL               47490002
475000           FROM TASHADR                                           47500002
475100           WHERE NAME_CDE          = 'ST'                         47510002
475200             AND ASNHDR_ID         = :ASNHDR-ASNHDR-ID            47520002
475300     END-EXEC                                                     47530002
475400                                                                  47540002
475500     EVALUATE TRUE                                                47550002
475600       WHEN SQLCODE = ZEROS                                       47560002
475700           IF PV-NAME-ID-CDE-NULL < ZERO                          47570002
475800               SET DC-SHIP-NOT-FOUND TO TRUE                      47580002
475900               SET DS-SHIP-NOT-FOUND TO TRUE                      47590002
476000               MOVE 0      TO PV-SHIP-NBR                         47600002
476100               MOVE SPACES TO PV-SHIP-NAME                        47610002
476200               MOVE 0      TO RC001-DIST-CNTR                     47620002
476300           ELSE                                                   47630002
476400              MOVE PV-NAME-ID-CDE TO DP010I-UNEDITED-FIELD        47640002
476500              MOVE 4              TO DP010I-MAXIMUM-DIGITS        47650002
476600              MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS      47660002
476700              CALL DP010I-NUMERIC-EDIT-ROUTINE                    47670002
476800                   USING DP010I-NUMERIC-EDIT-AREA                 47680002
476900              IF DP010I-ERROR-DETECTED                            47690002
477000                 MOVE 0 TO PV-DC-STR-CHECK                        47700002
477100              ELSE                                                47710002
477200                 MOVE DP010I-NUMERIC-FIELD TO PV-DC-STR-CHECK     47720002
477300              END-IF                                              47730002
477400              PERFORM T130-BULK-DC-SHIP-VALIDATION                47740002
477500                                                                  47750002
477600* NO DC AT SHIP LEVEL; NOW CHECK FOR STORE AT SHIP LEVEL          47760002
477700                                                                  47770002
477800              IF DC-SHIP-NOT-FOUND                                47780002
477900                 PERFORM T140-BULK-DS-SHIP-VALIDATION             47790002
478000              END-IF                                              47800002
478100           END-IF                                                 47810002
478200       WHEN SQLCODE = PC-ROW-NOT-FOUND                            47820002
478300           SET DC-SHIP-NOT-FOUND TO TRUE                          47830002
478400           SET DS-SHIP-NOT-FOUND TO TRUE                          47840002
478500           MOVE 0      TO PV-SHIP-NBR                             47850002
478600           MOVE SPACES TO PV-SHIP-NAME                            47860002
478700           MOVE 0      TO RC001-DIST-CNTR                         47870002
478800       WHEN OTHER                                                 47880002
478900         DISPLAY PV-ABEND-PARAGRAPH                               47890002
479000         DISPLAY 'ASN HEADER   '                                  47900002
479100                  ASNHDR-ASNHDR-NBR                               47910002
479200         PERFORM Z999-SQL-ERROR                                   47920002
479300     END-EVALUATE.                                                47930002
479400                                                                  47940002
479500* EVALUATE ORDER LEVEL CODE                                       47950002
479600     MOVE ASNORD-LOC-NBR TO PV-DC-STR-CHECK                       47960002
479700     PERFORM T135-BULK-DC-ORD-VALIDATION                          47970002
479800     IF DC-ORD-NOT-FOUND                                          47980002
479900* NO DC AT ORDER LEVEL; NOW CHECK FOR STORE AT ORDER LEVEL        47990002
480000         PERFORM T145-BULK-DS-ORD-VALIDATION                      48000002
480100     END-IF.                                                      48010002
480200                                                                  48020002
480300******************************************************************48030002
480400* VALIDATE THE DC FROM THE TASHADR TABLE IS VALID                 48040002
480500******************************************************************48050002
480600 T130-BULK-DC-SHIP-VALIDATION.                                    48060002
480700                                                                  48070002
480800     MOVE 'T130'                 TO PGM-LOCATION.                 48080002
480900     MOVE 'T130-BULK-DC-SHIP-VALIDATE'                            48090002
481000                                 TO PV-ABEND-PARAGRAPH.           48100002
481100                                                                  48110002
481200     EXEC SQL                                                     48120002
481300         SELECT LOC_NBR,LOC_NM                                    48130002
481400           INTO :XLT00010-LOC-NBR,                                48140002
481500                :XLT00010-LOC-NM                                  48150002
481600           FROM XLT_LOC                                           48160002
481700          WHERE LOC_NBR     = :PV-DC-STR-CHECK                    48170002
481800            AND LOC_TYP_CDE = 'DC'                                48180002
481900            AND DATE(:PV-DONT-SHIP-BEF-DATE) < CLO_DTE            48190002
482000     END-EXEC.                                                    48200002
482100                                                                  48210002
482200     EVALUATE TRUE                                                48220002
482300       WHEN SQLCODE = ZEROS                                       48230002
482400         SET DC-SHIP-FOUND       TO TRUE                          48240002
482500         SET DS-SHIP-NOT-FOUND   TO TRUE                          48250002
482600         MOVE XLT00010-LOC-NBR   TO PV-SHIP-NBR                   48260002
482700         MOVE XLT00010-LOC-NM    TO PV-SHIP-NAME                  48270002
482800         MOVE XLT00010-LOC-NBR   TO RC001-DIST-CNTR               48280002
482900       WHEN SQLCODE = PC-ROW-NOT-FOUND                            48290002
483000         SET DC-SHIP-NOT-FOUND   TO TRUE                          48300002
483100         SET DS-SHIP-NOT-FOUND   TO TRUE                          48310002
483200         MOVE 0                  TO PV-SHIP-NBR                   48320002
483300         MOVE SPACES             TO PV-SHIP-NAME                  48330002
483400         MOVE 0                  TO RC001-DIST-CNTR               48340002
483500       WHEN OTHER                                                 48350002
483600         DISPLAY PV-ABEND-PARAGRAPH                               48360002
483700         PERFORM Z999-SQL-ERROR                                   48370002
483800     END-EVALUATE.                                                48380002
483900                                                                  48390002
484000******************************************************************48400002
484100* VALIDATE THE DC FROM THE TASHADR TABLE IS VALID                 48410002
484200******************************************************************48420002
484300 T135-BULK-DC-ORD-VALIDATION.                                     48430002
484400                                                                  48440002
484500     MOVE 'T135'                 TO PGM-LOCATION.                 48450002
484600     MOVE 'T135-BULK-DC-ORD-VALIDATE '                            48460002
484700                                 TO PV-ABEND-PARAGRAPH.           48470002
484800                                                                  48480002
484900     EXEC SQL                                                     48490002
485000         SELECT LOC_NBR,LOC_NM                                    48500002
485100           INTO :XLT00010-LOC-NBR,                                48510002
485200                :XLT00010-LOC-NM                                  48520002
485300           FROM XLT_LOC                                           48530002
485400          WHERE LOC_NBR     = :PV-DC-STR-CHECK                    48540002
485500            AND LOC_TYP_CDE = 'DC'                                48550002
485600            AND DATE(:PV-DONT-SHIP-BEF-DATE) < CLO_DTE            48560002
485700     END-EXEC.                                                    48570002
485800                                                                  48580002
485900     EVALUATE TRUE                                                48590002
486000       WHEN SQLCODE = ZEROS                                       48600002
486100         SET DC-ORD-FOUND        TO TRUE                          48610002
486200         SET DS-ORD-NOT-FOUND    TO TRUE                          48620002
486300         MOVE XLT00010-LOC-NBR   TO PV-ORD-NBR                    48630002
486400         MOVE XLT00010-LOC-NM    TO PV-ORD-NAME                   48640002
486500         IF DC-SHIP-NOT-FOUND                                     48650002
486600           MOVE XLT00010-LOC-NBR   TO RC001-DIST-CNTR             48660002
486700         END-IF                                                   48670002
486800       WHEN SQLCODE = PC-ROW-NOT-FOUND                            48680002
486900         SET DC-ORD-NOT-FOUND    TO TRUE                          48690002
487000         SET DS-ORD-NOT-FOUND    TO TRUE                          48700002
487100         MOVE 0                  TO PV-ORD-NBR                    48710002
487200         MOVE SPACES             TO PV-ORD-NAME                   48720002
487300         IF DC-SHIP-NOT-FOUND                                     48730002
487400           MOVE 0                TO RC001-DIST-CNTR               48740002
487500         END-IF                                                   48750002
487600       WHEN OTHER                                                 48760002
487700         DISPLAY PV-ABEND-PARAGRAPH                               48770002
487800         PERFORM Z999-SQL-ERROR                                   48780002
487900     END-EVALUATE.                                                48790002
488000                                                                  48800002
488100******************************************************************48810002
488200* VALIDATE THE STORE FROM THE TASHADR TABLE IS VALID              48820002
488300******************************************************************48830002
488400 T140-BULK-DS-SHIP-VALIDATION.                                    48840002
488500                                                                  48850002
488600     MOVE 'T140'                 TO PGM-LOCATION.                 48860002
488700     MOVE 'T140-BULK-DS-SHIP-VALIDATE'                            48870002
488800                                 TO PV-ABEND-PARAGRAPH.           48880002
488900                                                                  48890002
489000     EXEC SQL                                                     48900002
489100         SELECT LOC_NBR,LOC_NM                                    48910002
489200           INTO :XLT00010-LOC-NBR,                                48920002
489300                :XLT00010-LOC-NM                                  48930002
489400           FROM XLT_LOC                                           48940002
489500          WHERE LOC_NBR     = :PV-DC-STR-CHECK                    48950002
489600            AND LOC_TYP_CDE = 'DS'                                48960002
489700            AND DATE(:PV-DONT-SHIP-BEF-DATE) < CLO_DTE            48970002
489800     END-EXEC.                                                    48980002
489900                                                                  48990002
490000     EVALUATE TRUE                                                49000002
490100       WHEN SQLCODE = ZEROS                                       49010002
490200         SET DC-SHIP-NOT-FOUND   TO TRUE                          49020002
490300         SET DS-SHIP-FOUND       TO TRUE                          49030002
490400         MOVE XLT00010-LOC-NBR   TO PV-SHIP-NBR                   49040002
490500         MOVE XLT00010-LOC-NM    TO PV-SHIP-NAME                  49050002
490600       WHEN SQLCODE = PC-ROW-NOT-FOUND                            49060002
490700         SET DC-SHIP-NOT-FOUND   TO TRUE                          49070002
490800         SET DS-SHIP-NOT-FOUND   TO TRUE                          49080002
490900         MOVE 0                  TO PV-SHIP-NBR                   49090002
491000         MOVE SPACES             TO PV-SHIP-NAME                  49100002
491100       WHEN OTHER                                                 49110002
491200         DISPLAY PV-ABEND-PARAGRAPH                               49120002
491300         PERFORM Z999-SQL-ERROR                                   49130002
491400     END-EVALUATE.                                                49140002
491500                                                                  49150002
491600******************************************************************49160002
491700* VALIDATE THE STORE FROM THE TASHADR TABLE IS VALID              49170002
491800******************************************************************49180002
491900 T145-BULK-DS-ORD-VALIDATION.                                     49190002
492000                                                                  49200002
492100     MOVE 'T145'                 TO PGM-LOCATION.                 49210002
492200     MOVE 'T145-BULK-DS-ORD-VALIDATE '                            49220002
492300                                 TO PV-ABEND-PARAGRAPH.           49230002
492400                                                                  49240002
492500     EXEC SQL                                                     49250002
492600         SELECT LOC_NBR,LOC_NM                                    49260002
492700           INTO :XLT00010-LOC-NBR,                                49270002
492800                :XLT00010-LOC-NM                                  49280002
492900           FROM XLT_LOC                                           49290002
493000          WHERE LOC_NBR     = :PV-DC-STR-CHECK                    49300002
493100            AND LOC_TYP_CDE = 'DS'                                49310002
493200            AND DATE(:PV-DONT-SHIP-BEF-DATE) < CLO_DTE            49320002
493300     END-EXEC.                                                    49330002
493400                                                                  49340002
493500     EVALUATE TRUE                                                49350002
493600       WHEN SQLCODE = ZEROS                                       49360002
493700         SET DC-ORD-NOT-FOUND    TO TRUE                          49370002
493800         SET DS-ORD-FOUND        TO TRUE                          49380002
493900         MOVE XLT00010-LOC-NBR   TO PV-ORD-NBR                    49390002
494000         MOVE XLT00010-LOC-NM    TO PV-ORD-NAME                   49400002
494100       WHEN SQLCODE = PC-ROW-NOT-FOUND                            49410002
494200         SET DC-ORD-NOT-FOUND    TO TRUE                          49420002
494300         SET DS-ORD-NOT-FOUND    TO TRUE                          49430002
494400         MOVE 0                  TO PV-ORD-NBR                    49440002
494500         MOVE SPACES             TO PV-ORD-NAME                   49450002
494600       WHEN OTHER                                                 49460002
494700         DISPLAY PV-ABEND-PARAGRAPH                               49470002
494800         PERFORM Z999-SQL-ERROR                                   49480002
494900     END-EVALUATE.                                                49490002
495000                                                                  49500002
495100******************************************************************49510002
495200*  GETS THE DO NOT SHIP BEFORE DATE                              *49520002
495300******************************************************************49530002
495400 T200-GET-DONT-SHIP-BEF-DATE.                                     49540002
495500                                                                  49550002
495600     MOVE 'T200'                 TO PGM-LOCATION.                 49560002
495700     MOVE 'T200-GET-DONT-SHIP-BEF-DATE'                           49570002
495800                                 TO PV-ABEND-PARAGRAPH.           49580002
495900                                                                  49590002
496000     MOVE ASNORD-PO-NBR (1:8)    TO DP010I-UNEDITED-FIELD.        49600002
496100     MOVE PC-8                   TO DP010I-MAXIMUM-DIGITS.        49610002
496200     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      49620002
496300     SET DP010I-NEGATIVE-NOT-ALLOWED                              49630002
496400                                 TO TRUE.                         49640002
496500                                                                  49650002
496600     CALL DP010I-NUMERIC-EDIT-ROUTINE                             49660002
496700          USING DP010I-NUMERIC-EDIT-AREA.                         49670002
496800                                                                  49680002
496900     IF DP010I-ERROR-DETECTED                                     49690002
497000         DISPLAY 'ERROR IN CONVERTING PO NUMBER TO NUMERIC: '     49700002
497100                  DP010I-UNEDITED-FIELD                           49710002
497200     END-IF.                                                      49720002
497300                                                                  49730002
497400     MOVE DP010I-NUMERIC-FIELD   TO PV-INTEGER-PO-NBR.            49740002
497500                                                                  49750002
497600     EXEC SQL                                                     49760002
497700        SELECT DONT_SHIP_BEF_DTE                                  49770002
497800              ,CURRENT DATE                                       49780002
497900        INTO :PLNSHP-DONT-SHIP-BEF-DTE                            49790002
498000            ,:PV-CURRENT-DATE                                     49800002
498100        FROM TPLNSHP                                              49810002
498200        WHERE PO_NBR  = :PV-INTEGER-PO-NBR                        49820002
498300          AND VER_STATUS_CDE     = 'A'                            49830002
498400     END-EXEC.                                                    49840002
498500                                                                  49850002
498600     EVALUATE TRUE                                                49860002
498700       WHEN SQLCODE = ZEROS                                       49870002
498800         CONTINUE                                                 49880002
498900       WHEN SQLCODE = +100                                        49890002
499000         SET PS-NO-PO-FOUND      TO TRUE                          49900002
499100         MOVE PV-CUR-DATE-10 TO PV-CURRENT-DATE                   49910002
499200       WHEN OTHER                                                 49920002
499300         DISPLAY PV-ABEND-PARAGRAPH                               49930002
499400         PERFORM Z999-SQL-ERROR                                   49940002
499500     END-EVALUATE.                                                49950002
499600******************************************************************49960002
499700*     SQL WARNING OR ERROR PROCESSING                            *49970002
499800*                                                                *49980002
499900******************************************************************49990002
500000 W000-WRITE-REPORT-HEADERS.                                       50000002
500100*                                                                 50010002
500200     MOVE 'W000'                  TO PGM-LOCATION.                50020002
500300     MOVE 'W000-WRITE-REPORT-HEADERS '                            50030002
500400                                  TO PV-ABEND-PARAGRAPH.          50040002
500500*                                                                 50050002
500600     ADD 1                        TO PV-PAGE-CNT.                 50060002
500700*                                                                 50070002
500800     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          50080002
500900*                                                                 50090002
501000     WRITE REPORT-RECORD-OUT-1                                    50100002
501100         FROM DP132O-STANDRD-HEADER-132-COLS                      50110002
501200         AFTER ADVANCING PAGE.                                    50120002
501300*                                                                 50130002
501400     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-0                     50140002
501500         AFTER ADVANCING 1 LINE.                                  50150002
501600*                                                                 50160002
501700     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-1                     50170002
501800         AFTER ADVANCING 2 LINES.                                 50180002
501900*                                                                 50190002
502000     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-2                     50200002
502100         AFTER ADVANCING 1 LINE.                                  50210002
502200*                                                                 50220002
502300     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-3                     50230002
502400         AFTER ADVANCING 1 LINE.                                  50240002
502500*                                                                 50250002
502600     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-4                     50260002
502700         AFTER ADVANCING 1 LINE.                                  50270002
502800*                                                                 50280002
502900     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-5                     50290002
503000         AFTER ADVANCING 1 LINE.                                  50300002
503100*                                                                 50310002
503200     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-5A                    50320002
503300         AFTER ADVANCING 1 LINE.                                  50330002
503400*                                                                 50340002
503500     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-5B                    50350002
503600         AFTER ADVANCING 1 LINE.                                  50360002
503700*                                                                 50370002
503800     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-5C                    50380002
503900         AFTER ADVANCING 1 LINE.                                  50390002
504000*                                                                 50400002
504100     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-6                     50410002
504200         AFTER ADVANCING 1 LINE.                                  50420002
504300*                                                                 50430002
504400     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-7                     50440002
504500         AFTER ADVANCING 1 LINE.                                  50450002
504600*                                                                 50460002
504700     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-8                     50470002
504800         AFTER ADVANCING 1 LINE.                                  50480002
504900*                                                                 50490002
505000     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-9                     50500002
505100         AFTER ADVANCING 1 LINE.                                  50510002
505200*                                                                 50520002
505300     MOVE PC-14                   TO PV-LINE-CNT.                 50530002
505400*                                                                 50540002
505500     PERFORM R300-GET-SPECIAL-INSTR.                              50550002
505600*                                                                 50560002
505700     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-10                    50570002
505800         AFTER ADVANCING 1 LINE.                                  50580002
505900*                                                                 50590002
506000     PERFORM W200-WRITE-DETAIL-HEADERS.                           50600002
506100*                                                                 50610002
506200 EJECT                                                            50620002
506300******************************************************************50630002
506400*     WRITES THE DETAIL LINE HEADERS                             *50640002
506500*                                                                *50650002
506600******************************************************************50660002
506700 W200-WRITE-DETAIL-HEADERS.                                       50670002
506800*                                                                 50680002
506900     MOVE 'W200'                  TO PGM-LOCATION.                50690002
507000     MOVE 'W200-WRITE-DETAIL-HEADERS  '                           50700002
507100                                  TO PV-ABEND-PARAGRAPH.          50710002
507200*                                                                 50720002
507300     WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-HEADING-1           50730002
507400         AFTER ADVANCING 2 LINES.                                 50740002
507500*                                                                 50750002
507600     WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-HEADING-2           50760002
507700         AFTER ADVANCING 1 LINES.                                 50770002
507800*                                                                 50780002
507900     ADD PC-3                     TO PV-LINE-CNT.                 50790002
508000*                                                                 50800002
508100 EJECT                                                            50810002
508200******************************************************************50820002
508300*     WRITES THE STANDARD REPORT HEADING.                        *50830002
508400*                                                                *50840002
508500******************************************************************50850002
508600 W300-WRITE-TOP-OF-FORM.                                          50860002
508700*                                                                 50870002
508800     MOVE 'W300'                  TO PGM-LOCATION.                50880002
508900     MOVE 'W300-WRITE-TOP-OF-FORM      '                          50890002
509000                                  TO PV-ABEND-PARAGRAPH.          50900002
509100*                                                                 50910002
509200     ADD 1                        TO PV-PAGE-CNT.                 50920002
509300*                                                                 50930002
509400     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          50940002
509500*                                                                 50950002
509600     WRITE REPORT-RECORD-OUT-1                                    50960002
509700         FROM DP132O-STANDRD-HEADER-132-COLS                      50970002
509800         AFTER ADVANCING PAGE.                                    50980002
509900*                                                                 50990002
510000     WRITE REPORT-RECORD-OUT-1 FROM PV-HEAD-0                     51000002
510100         AFTER ADVANCING 1 LINE.                                  51010002
510200 EJECT                                                            51020002
510300******************************************************************51030002
510400*     WRITES THE DETAIL LINE INFORMATION.                        *51040002
510500*                                                                *51050002
510600******************************************************************51060002
510700 W500-WRITE-DETAIL-LINES.                                         51070002
510800*                                                                 51080002
510900     MOVE 'W500'                  TO PGM-LOCATION.                51090002
511000     MOVE 'W500-WRITE-DETAIL-LINES    '                           51100002
511100                                  TO PV-ABEND-PARAGRAPH.          51110002
511200*                                                                 51120002
511300     IF PV-LINE-CNT > PC-50                                       51130002
511400        PERFORM W000-WRITE-REPORT-HEADERS                         51140002
511500     ELSE                                                         51150002
511600        WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-LINE1            51160002
511700            AFTER ADVANCING 1 LINES                               51170002
511800        WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-LINE2            51180002
511900            AFTER ADVANCING 1 LINES                               51190002
512000        ADD PC-2 TO PV-LINE-CNT                                   51200002
512100     END-IF.                                                      51210002
512200                                                                  51220002
512300*                                                                 51230002
512400 EJECT                                                            51240002
512500******************************************************************51250002
512600*     WRITES THE DETAIL LINE INFORMATION.                        *51260002
512700*                                                                *51270002
512800******************************************************************51280002
512900 W600-WRITE-DETAIL-TOTAL-LINES.                                   51290002
513000*                                                                 51300002
513100     MOVE 'W600'                  TO PGM-LOCATION.                51310002
513200     MOVE 'W600-WRITE-DETAIL-LINES    '                           51320002
513300                                  TO PV-ABEND-PARAGRAPH.          51330002
513400*                                                                 51340002
513500     IF PV-LINE-CNT > PC-50                                       51350002
513600        PERFORM W000-WRITE-REPORT-HEADERS                         51360002
513700        WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-TTL-DASHES-1     51370002
513800            AFTER ADVANCING 2 LINES                               51380002
513900        WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-TTL-LINE1        51390002
514000            AFTER ADVANCING 1 LINES                               51400002
514100        ADD PC-3 TO PV-LINE-CNT                                   51410002
514200     ELSE                                                         51420002
514300        WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-TTL-DASHES-1     51430002
514400            AFTER ADVANCING 2 LINES                               51440002
514500        WRITE REPORT-RECORD-OUT-1 FROM PV-DETAIL-TTL-LINE1        51450002
514600            AFTER ADVANCING 1 LINES                               51460002
514700        ADD PC-3 TO PV-LINE-CNT                                   51470002
514800     END-IF.                                                      51480002
514900*                                                                 51490002
515000 EJECT                                                            51500002
515100******************************************************************51510002
515200*     WRITES THE ASN TRANSCRIPTION EXTRACT HEADER AND            *51520002
515300*     DETAIL RECORDS.                                            *51530002
515400*                                                                *51540002
515500******************************************************************51550002
515600 W700-WRITE-ASN-EXTRACT-HDR-DTL.                                  51560002
515700*                                                                 51570002
515800                                                                  51580002
515900     MOVE 'W700'                  TO PGM-LOCATION.                51590002
516000     MOVE 'W700-WRITE-ASN-EXTRACT-HDR-DTL'                        51600002
516100                                  TO PV-ABEND-PARAGRAPH.          51610002
516200*                                                                 51620002
516300     WRITE ASN-TRANSCRIPTION-RECORD                               51630002
516400         FROM RC001-ASN-TRANSCRIPTION-RECORD.                     51640002
516500*                                                                 51650002
516600     ADD 1 TO PV-ASN-TRANS-RECS-WRITTEN.                          51660002
516700     ADD 1 TO PV-SEQUENCE-NBR.                                    51670002
516800*                                                                 51680002
516900 W800-WRITE-ASN-EXTRACT-HDR-DTL.                                  51690002
517000*                                                                 51700002
517100*    MOVE 'W700'                  TO PGM-LOCATION.                51710002
517200     MOVE 'W800'                  TO PGM-LOCATION.                51720002
517300*    MOVE 'W700-WRITE-ASN-EXTRACT-HDR-DTL'                        51730002
517400     MOVE 'W800-WRITE-ASN-EXTRACT-HDR-DTL'                        51740002
517500                                  TO PV-ABEND-PARAGRAPH.          51750002
517600*                                                                 51760002
517700     WRITE ASN-TRANSCRIPTION-RECORD                               51770002
517800         FROM PV-DETAIL-CARTON.                                   51780002
517900*                                                                 51790002
518000     ADD 1 TO PV-ASN-TRANS-RECS-WRITTEN.                          51800002
518100     ADD 1 TO PV-SEQUENCE-NBR.                                    51810002
518200*                                                                 51820002
518300 EJECT                                                            51830002
518400******************************************************************51840002
518500*     OPENS THE ASN HEADER CURSOR                                *51850002
518600*                                                                *51860002
518700******************************************************************51870002
518800 Y000-OPEN-ASN-HEADER-CURSOR.                                     51880002
518900*                                                                 51890002
519000     MOVE 'Y000'                  TO PGM-LOCATION.                51900002
519100     MOVE 'Y000-OPEN-ASN-HEADER-CURSOR'                           51910002
519200                                  TO PV-ABEND-PARAGRAPH.          51920002
519300*                                                                 51930002
519400     EXEC SQL                                                     51940002
519500         OPEN ASN_HEADER_CURSOR                                   51950002
519600     END-EXEC.                                                    51960002
519700*                                                                 51970002
519800     EVALUATE TRUE                                                51980002
519900       WHEN SQLCODE         = ZERO                                51990002
520000       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    52000002
520100         CONTINUE                                                 52010002
520200       WHEN OTHER                                                 52020002
520300         DISPLAY PV-ABEND-PARAGRAPH                               52030002
520400         PERFORM Z999-SQL-ERROR                                   52040002
520500     END-EVALUATE.                                                52050002
520600*                                                                 52060002
520700 EJECT                                                            52070002
520800******************************************************************52080002
520900*     OPENS THE ASN DETAIL CURSOR                                *52090002
521000*                                                                *52100002
521100******************************************************************52110002
521200 Y100-OPEN-ASN-DETAIL-CURSOR.                                     52120002
521300*                                                                 52130002
521400     MOVE 'Y100'                  TO PGM-LOCATION.                52140002
521500     MOVE 'Y100-OPEN-ASN-DETAIL-CURSOR'                           52150002
521600                                  TO PV-ABEND-PARAGRAPH.          52160002
521700*                                                                 52170002
521800     EXEC SQL                                                     52180002
521900         OPEN ASN_DETAIL_CURSOR                                   52190002
522000     END-EXEC.                                                    52200002
522100*                                                                 52210002
522200     EVALUATE TRUE                                                52220002
522300       WHEN SQLCODE         = ZERO                                52230002
522400       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    52240002
522500         CONTINUE                                                 52250002
522600       WHEN OTHER                                                 52260002
522700         DISPLAY PV-ABEND-PARAGRAPH                               52270002
522800         PERFORM Z999-SQL-ERROR                                   52280002
522900     END-EVALUATE.                                                52290002
523000*                                                                 52300002
523100 EJECT                                                            52310002
523200******************************************************************52320002
523300*     CLOSES THE OPEN ASN DETAIL CURSOR                          *52330002
523400*                                                                *52340002
523500******************************************************************52350002
523600 Y200-CLOSE-ASN-DETAIL-CURSOR.                                    52360002
523700*                                                                 52370002
523800     MOVE 'Y200'                  TO PGM-LOCATION.                52380002
523900     MOVE 'Y200-OPEN-ASN-DETAIL-CURSOR'                           52390002
524000                                  TO PV-ABEND-PARAGRAPH.          52400002
524100*                                                                 52410002
524200     EXEC SQL                                                     52420002
524300         CLOSE ASN_DETAIL_CURSOR                                  52430002
524400     END-EXEC.                                                    52440002
524500*                                                                 52450002
524600     EVALUATE TRUE                                                52460002
524700       WHEN SQLCODE         = ZERO                                52470002
524800       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    52480002
524900         CONTINUE                                                 52490002
525000       WHEN OTHER                                                 52500002
525100         DISPLAY PV-ABEND-PARAGRAPH                               52510002
525200         PERFORM Z999-SQL-ERROR                                   52520002
525300     END-EVALUATE.                                                52530002
525400*                                                                 52540002
525500 EJECT                                                            52550002
525600******************************************************************52560002
525700*     CLOSES THE OPEN ASN HEADER CURSOR                          *52570002
525800*                                                                *52580002
525900******************************************************************52590002
526000 Y300-CLOSE-ASN-HEADER-CURSOR.                                    52600002
526100*                                                                 52610002
526200     MOVE 'Y300'                  TO PGM-LOCATION.                52620002
526300     MOVE 'Y300-OPEN-ASN-HEADER-CURSOR'                           52630002
526400                                  TO PV-ABEND-PARAGRAPH.          52640002
526500*                                                                 52650002
526600     EXEC SQL                                                     52660002
526700         CLOSE ASN_HEADER_CURSOR                                  52670002
526800     END-EXEC.                                                    52680002
526900*                                                                 52690002
527000     EVALUATE TRUE                                                52700002
527100       WHEN SQLCODE         = ZERO                                52710002
527200       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    52720002
527300         CONTINUE                                                 52730002
527400       WHEN OTHER                                                 52740002
527500         DISPLAY PV-ABEND-PARAGRAPH                               52750002
527600         PERFORM Z999-SQL-ERROR                                   52760002
527700     END-EVALUATE.                                                52770002
527800*                                                                 52780002
527900 EJECT                                                            52790002
528000******************************************************************52800002
528100*     OPENS THE CURSOR FOR PROCESSING RECORDS WITH DATA ON       *52810002
528200*     ASNDTL BUT NOT ON ASDTPL                                   *52820002
528300******************************************************************52830002
528400 Y400-OPEN-ASN-DTL-NOT-EXISTS.                                    52840002
528500*                                                                 52850002
528600     MOVE 'Y400'                  TO PGM-LOCATION.                52860002
528700     MOVE 'Y400-OPEN-ASN-DTL-NOT-EXISTS'                          52870002
528800                                  TO PV-ABEND-PARAGRAPH.          52880002
528900*                                                                 52890002
529000     EXEC SQL                                                     52900002
529100         OPEN DTL_NOT_EXISTS_CSR                                  52910002
529200     END-EXEC.                                                    52920002
529300*                                                                 52930002
529400     EVALUATE TRUE                                                52940002
529500       WHEN SQLCODE         = ZERO                                52950002
529600       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    52960002
529700         CONTINUE                                                 52970002
529800       WHEN OTHER                                                 52980002
529900         DISPLAY PV-ABEND-PARAGRAPH                               52990002
530000         PERFORM Z999-SQL-ERROR                                   53000002
530100     END-EVALUATE.                                                53010002
530200*                                                                 53020002
530300 EJECT                                                            53030002
530400******************************************************************53040002
530500*     CLOSES THE OPEN ASN DETAIL NOT EXISTS CURSOR               *53050002
530600*                                                                *53060002
530700******************************************************************53070002
530800 Y500-CLOSE-ASN-DTL-NOT-EXISTS.                                   53080002
530900*                                                                 53090002
531000     MOVE 'Y500'                  TO PGM-LOCATION.                53100002
531100     MOVE 'Y500-CLOSE-ASN-DTL-NOT-EXISTS'                         53110002
531200                                  TO PV-ABEND-PARAGRAPH.          53120002
531300*                                                                 53130002
531400     EXEC SQL                                                     53140002
531500         CLOSE DTL_NOT_EXISTS_CSR                                 53150002
531600     END-EXEC.                                                    53160002
531700*                                                                 53170002
531800     EVALUATE TRUE                                                53180002
531900       WHEN SQLCODE         = ZERO                                53190002
532000       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    53200002
532100         CONTINUE                                                 53210002
532200       WHEN OTHER                                                 53220002
532300         DISPLAY PV-ABEND-PARAGRAPH                               53230002
532400         PERFORM Z999-SQL-ERROR                                   53240002
532500     END-EVALUATE.                                                53250002
532600*                                                                 53260002
532700 EJECT                                                            53270002
532800******************************************************************53280002
532900*     OPENS THE CURSOR FOR PROCESSING THE GROSS WEIGHT           *53290002
533000******************************************************************53300002
533100 Y600-OPEN-WEIGHT-CURSOR.                                         53310002
533200*                                                                 53320002
533300     MOVE 'Y600'                  TO PGM-LOCATION.                53330002
533400     MOVE 'Y600-OPEN-WEIGHT-CURSOR     '                          53340002
533500                                  TO PV-ABEND-PARAGRAPH.          53350002
533600*                                                                 53360002
533700     EXEC SQL                                                     53370002
533800         OPEN WEIGHT_CURSOR                                       53380002
533900     END-EXEC.                                                    53390002
534000*                                                                 53400002
534100     EVALUATE TRUE                                                53410002
534200       WHEN SQLCODE         = ZERO                                53420002
534300       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    53430002
534400         CONTINUE                                                 53440002
534500       WHEN OTHER                                                 53450002
534600         DISPLAY PV-ABEND-PARAGRAPH                               53460002
534700         PERFORM Z999-SQL-ERROR                                   53470002
534800     END-EVALUATE.                                                53480002
534900*                                                                 53490002
535000 EJECT                                                            53500002
535100******************************************************************53510002
535200*     CLOSES THE OPEN WEIGHT CURSOR                              *53520002
535300*                                                                *53530002
535400******************************************************************53540002
535500 Y700-CLOSE-WEIGHT-CURSOR.                                        53550002
535600*                                                                 53560002
535700     MOVE 'Y700'                  TO PGM-LOCATION.                53570002
535800     MOVE 'Y700-CLOSE-WEIGHT-CURSOR    '                          53580002
535900                                  TO PV-ABEND-PARAGRAPH.          53590002
536000*                                                                 53600002
536100     EXEC SQL                                                     53610002
536200         CLOSE WEIGHT_CURSOR                                      53620002
536300     END-EXEC.                                                    53630002
536400*                                                                 53640002
536500     EVALUATE TRUE                                                53650002
536600       WHEN SQLCODE         = ZERO                                53660002
536700       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    53670002
536800         CONTINUE                                                 53680002
536900       WHEN OTHER                                                 53690002
537000         DISPLAY PV-ABEND-PARAGRAPH                               53700002
537100         PERFORM Z999-SQL-ERROR                                   53710002
537200     END-EVALUATE.                                                53720002
537300*                                                                 53730002
537400 EJECT                                                            53740002
537500****************************************************************  53750002
537600*     READ-ADV-SHIP-NOTICE                                     *  53760002
537700*                                                              *  53770002
537800*     -  READ ADV-SHIP-NOTICE RECORD                           *  53780002
537900****************************************************************  53790002
538000 Z000-READ-ADV-SHIP-NOTICE.                                       53800002
538100     MOVE 'Z000-READ-ADV-SHIP-NOTICE      '                       53810002
538200                                 TO PV-ABEND-PARAGRAPH.           53820002
538300     SET ID-REC-NOT-FOUND TO TRUE.                                53830002
538400                                                                  53840002
538500     PERFORM                                                      53850002
538600        UNTIL ID-REC-FOUND OR END-OF-INP01                        53860002
538700           READ ADV-SHIP-NOTICE-FILE                              53870002
538800               INTO ADVANCE-SHIP-NOTICE-DTL-RECORD                53880002
538900               AT END SET END-OF-INP01 TO TRUE                    53890002
539000           END-READ                                               53900002
539010           ADD 1 TO PV-INPUT-RECS-READ                            53901003
539100           IF ID-IDENTIFICATION-REC                               53910002
539110              ADD 1 TO PV-INPUT-ID-RECS-READ                      53911003
539200              SET ID-REC-FOUND TO TRUE                            53920002
539300           ELSE                                                   53930002
539400              SET ID-REC-NOT-FOUND TO TRUE                        53940002
539500           END-IF                                                 53950002
539600     END-PERFORM.                                                 53960002
539700*                                                                 53970002
539800 EJECT                                                            53980002
539900****************************************************************  53990002
540000*     Z100-LOAD-TRADING-PART                                   *  54000002
540100*                                                              *  54010002
540200*     -  LOAD TRADING PARTNER TABLE                            *  54020002
540300****************************************************************  54030002
540400 Z100-LOAD-TRADING-PART.                                          54040002
540500                                                                  54050002
540600     MOVE 'Z100-LOAD-TRADING-PART         '                       54060002
540700                                 TO PV-ABEND-PARAGRAPH.           54070002
540800     INITIALIZE WS-PARTNER-TABLE.                                 54080002
540900                                                                  54090002
541000     PERFORM                                                      54100002
541100        UNTIL END-OF-INP01                                        54110002
541200        PERFORM Z000-READ-ADV-SHIP-NOTICE                         54120002
541300        IF END-OF-INP01                                           54130002
541400           CONTINUE                                               54140002
541500        ELSE                                                      54150002
541510           IF  SN001I-ISA-ID = PV-PREV-PARTNER-ID                 54151007
541520               CONTINUE                                           54152007
541530           ELSE                                                   54153007
541540               MOVE SN001I-ISA-ID      TO PV-PREV-PARTNER-ID      54154007
541550                                          DK-PARTNER-ID           54155007
541560               SET PS-NOT-VALID-TRADE-PART TO TRUE                54156007
541570               PERFORM Z120-CHECK-VALID-TRADE-PART                54157007
541580           END-IF                                                 54158007
541700           IF PS-VALID-TRADE-PART                                 54170007
541800              PERFORM Z200-CHECK-CNTL-NBR                         54180002
541900              IF CNTL-NBR-FOUND                                   54190002
542000                 CONTINUE                                         54200002
542100              ELSE                                                54210002
542200                 ADD 1 TO SUB                                     54220002
542300                 MOVE SUB TO MAX-SUB                              54230002
542400                 MOVE SN001I-ISA-CNTL-NBR TO WS-ISA-CNTL-NBR(SUB) 54240002
542500                 MOVE SN001I-ISA-ID TO WS-TRADING-PARTNER(SUB)    54250002
542600                 MOVE SN001I-ISA-ID-QUAL TO                       54260002
542700                    WS-TRADING-PARTNER-ID(SUB)                    54270002
542800              END-IF                                              54280002
542900           END-IF                                                 54290002
543000        END-IF                                                    54300002
543100     END-PERFORM.                                                 54310002
543200     DISPLAY '**************************************'.            54320002
543300     DISPLAY ' INTERNAL TRADING PARTNER TABLE       '.            54330002
543400     DISPLAY '**************************************'.            54340002
543500     PERFORM                                                      54350002
543600        VARYING SUB FROM 1 BY 1                                   54360002
543700        UNTIL SUB > MAX-SUB                                       54370002
543800        IF WS-ISA-CNTL-NBR(SUB) > 0                               54380002
543900           DISPLAY  'ISA CNTL NBR: ' WS-ISA-CNTL-NBR(SUB)         54390002
544000           DISPLAY  'TRADING PART: ' WS-TRADING-PARTNER(SUB)      54400002
544100           DISPLAY  'PARTNER ID:   ' WS-TRADING-PARTNER-ID(SUB)   54410002
544200        END-IF                                                    54420002
544300     END-PERFORM.                                                 54430002
544400     DISPLAY '**************************************'.            54440002
544500     DISPLAY ' END OF TABLE - ' MAX-SUB.                          54450002
544600     DISPLAY '**************************************'.            54460002
544700*                                                                 54470002
544800                                                                  54480007
544801****************************************************************  54480107
544802*     THIS PARAGRAPH WILL ACCESS A WST PARM TO SEE IF THE      *  54480207
544803*     EDI VENDOR ID FOR THE ASN IS DEFINED AS A VALID TRADING  *  54480307
544804*     PARTNER - THIS PARM CHECK REPLACED HARDCODING OF THE     *  54480407
544805*     VALID EDI VENDOR ID WITHIN THIS PROGRAM.                 *  54480507
544806****************************************************************  54480607
544808 Z120-CHECK-VALID-TRADE-PART.                                     54480807
544809                                                                  54480907
544810     MOVE 'Z120-CHECK-VALID-TRADE-PART    '                       54481007
544811                                 TO PV-ABEND-PARAGRAPH.           54481108
544812*    DISPLAY 'Z120-CHECK-VALID-TRADE-PART'.                       54481207
544813                                                                  54481307
544822     EXEC SQL                                                     54482208
544823       SELECT C.ATTR_ELEM_TXT                                     54482308
544824            , D.ATTR_ELEM_NBR                                     54482408
544825         INTO :PV-ELEM-PARTNER-ID                                 54482508
544826            , :PV-ELEM-ALT-ENT-ID                                 54482608
544827         FROM WST_INTGRTN_TYP A                                   54482708
544828            , WST_ATTR_DEFN   B                                   54482808
544829            , WST_ATTR_ELEM   C                                   54482908
544830            , WST_ATTR_ELEM   D                                   54483008
544831            , WST_ATTR_ELEM   E                                   54483108
544832            , WST_ATTR_ELEM   F                                   54483208
544833        WHERE A.INTGRTN_TYP_CDE   = 'ASNVTRDPRT'                  54483308
544834          AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE             54483408
544835          AND B.ATTR_DEFN_SEQ_NBR = 1                             54483508
544836          AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE             54483608
544837          AND C.ATTR_DEFN_SEQ_NBR = 1                             54483708
544838          AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE             54483808
544839          AND D.ATTR_DEFN_SEQ_NBR = 2                             54483908
544840          AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE             54484008
544841          AND E.ATTR_DEFN_SEQ_NBR = 3                             54484108
544842          AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE             54484208
544843          AND F.ATTR_DEFN_SEQ_NBR = 4                             54484308
544844          AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR           54484408
544845          AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR           54484508
544846          AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR           54484608
544847          AND C.ATTR_ELEM_TXT     = :DK-PARTNER-ID                54484708
544848          AND E.ATTR_ELEM_TXT     = 'Y'                           54484808
544849          AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP            54484908
544850        WITH UR                                                   54485008
544851     END-EXEC.                                                    54485108
544852                                                                  54485207
544853     EVALUATE TRUE                                                54485308
544854       WHEN SQLCODE = ZERO                                        54485408
544855       WHEN SQLCODE = -811                                        54485508
544856            SET PS-VALID-TRADE-PART TO TRUE                       54485608
544857                                                                  54485708
544858       WHEN SQLCODE = +100                                        54485808
544859            SET PS-NOT-VALID-TRADE-PART TO TRUE                   54485908
544860            MOVE SPACES TO PV-ELEM-PARTNER-ID                     54486008
544861                                                                  54486108
544862       WHEN OTHER                                                 54486208
544863           DISPLAY '**************************************'       54486308
544864           DISPLAY 'ERROR ISSUED ON SELECT OF WST PARM '          54486408
544865                   'TABLE FOR PARM:  ASNVTRDPRT'                  54486508
544866           DISPLAY 'DK-PARTNER-ID BEING PROCESSED IS: '           54486608
544867                    DK-PARTNER-ID                                 54486708
544868           MOVE PV-INPUT-RECS-READ  TO PV-DISPLAY-REC-NBR         54486808
544869           DISPLAY 'INPUT RECORD NUMBER BEING PROCESSED '         54486908
544870                    ' IS: ' PV-DISPLAY-REC-NBR                    54487008
544871           DISPLAY '**************************************'       54487108
544872           PERFORM Z999-SQL-ERROR                                 54487208
544873                                                                  54487308
544874     END-EVALUATE.                                                54487408
544877                                                                  54487707
544900****************************************************************  54490002
545000*     Z200-CHECK-CNTL-NBR                                         54500002
545100*                                                                 54510002
545200*     -  CHECK CNTLNBR/TRADING PARTNER TABLE FOR UNIQUE VALUES    54520002
545300****************************************************************  54530002
545400 Z200-CHECK-CNTL-NBR.                                             54540002
545500     MOVE 'Z200-CHECK-CNTL-NBR            '                       54550002
545600                                 TO PV-ABEND-PARAGRAPH.           54560002
545700     SET CNTL-NBR-NOT-FOUND TO TRUE.                              54570002
545800                                                                  54580002
545900     PERFORM                                                      54590002
546000        VARYING SUB1 FROM 1 BY 1                                  54600002
546100        UNTIL SUB1 > MAX-SUB OR CNTL-NBR-FOUND                    54610002
546200        IF WS-ISA-CNTL-NBR(SUB1) = SN001I-ISA-CNTL-NBR            54620002
546300           SET CNTL-NBR-FOUND TO TRUE                             54630002
546400        ELSE                                                      54640002
546500           SET CNTL-NBR-NOT-FOUND TO TRUE                         54650002
546600        END-IF                                                    54660002
546700     END-PERFORM.                                                 54670002
546800*                                                                 54680002
546900 EJECT                                                            54690002
547000******************************************************************54700002
547100*     SQL WARNING OR ERROR PROCESSING                            *54710002
547200*                                                                *54720002
547300******************************************************************54730002
547400                                                                  54740002
547500*                                                                 54750002
547600 Z999-SQL-ERROR.                                                  54760002
547700*---------------                                                  54770002
547800                                                                  54780002
547900     MOVE SQLCODE    TO SQLCODE2.                                 54790002
548000     MOVE SQLERRD(3) TO SQLERRD3.                                 54800002
548100     DISPLAY '** ABEND **       ** = SQLERROR'.                   54810002
548200     DISPLAY '** PROGRAM        ** = SNKRP006'.                   54820002
548300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  54830002
548400     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  54840002
548500     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   54850002
548600     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  54860002
548700     EXEC SQL                                                     54870002
548800         COMMIT                                                   54880002
548900     END-EXEC.                                                    54890002
549000     MOVE +4013 TO PV-ABEND-CODE.                                 54900002
549100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         54910002
549200*                                                                 54920002
549300 EJECT                                                            54930002
549400     COPY DPPD024.                                                54940002
549500*----------------------------------------------------------------*54950002
549600*                                               ** WR # 230ZZ    *54960002
549700* ADDED CODE TO DISPLAY MESSAGES,WHEN ABEND OCCURS FROM          *54970002
549800* LOGISTICS DOMAIN ITEM ACCESS MODULE.                           *54980002
549900*----------------------------------------------------------------*54990002
550000 9000-PROCESS-ABEND.                                              55000002
550100                                                                  55010002
550200     DISPLAY '** ABEND **       ** = SQLERROR'.                   55020002
550300     DISPLAY '** PROGRAM        ** = SNKRP005'.                   55030002
550400     DISPLAY '** ABEND PARAGRAPH **  ' PV-ABEND-PARAGRAPH.        55040002
550500     DISPLAY '** ERROR MESSAGE   **  ' PV-ABEND-MESSAGE-TEXT.     55050002
550600     DISPLAY '** SQLCODE         **  ' PV-SQLCODE.                55060002
550700     DISPLAY '** VIEW  NAME      **  ' PV-DB2-VIEW-NAME.          55070002
550800     MOVE +4013 TO PV-ABEND-CODE.                                 55080002
550900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         55090002
551000*----------------------------------------------------------------*55100002
551100* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *55110002
551200*----------------------------------------------------------------*55120002
