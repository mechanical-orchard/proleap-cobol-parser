000100 IDENTIFICATION DIVISION.                                         00010099
000200 TITLE 'APPLY LOGISTICS DOMAIN DEPARTMENT CLASS CHANGES'.         00020099
000300                                                                  00030099
000400 PROGRAM-ID.             XLKUP034.                                00040099
000500 AUTHOR.                 AL PETERS.                               00050099
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060099
000700 DATE-WRITTEN            JANUARY 2004.                            00070099
000800 DATE-COMPILED.                                                   00080099
000900 ENVIRONMENT DIVISION.                                            00090099
001000 CONFIGURATION SECTION.                                           00100099
001100 SOURCE-COMPUTER.        IBM-3090.                                00110099
001200 OBJECT-COMPUTER.        IBM-3090.                                00120099
001300 INPUT-OUTPUT SECTION.                                            00130099
001400                                                                  00140099
001500 FILE-CONTROL.                                                    00150099
001600                                                                  00160099
001700     SELECT XL-TRANS-FILE                                         00170099
001800         ASSIGN TO INP01.                                         00180099
001900                                                                  00190099
002000 DATA DIVISION.                                                   00200099
002100 FILE SECTION.                                                    00210099
002200                                                                  00220099
002300                                                                  00230099
002400 FD  XL-TRANS-FILE                                                00240099
002500     RECORDING MODE IS F                                          00250099
002600     LABEL RECORDS ARE STANDARD                                   00260099
002700     RECORD CONTAINS 80 CHARACTERS                                00270099
002800     BLOCK CONTAINS 0  RECORDS.                                   00280099
002900 01  XL-TRANS-REC                     PIC X(80).                  00290099
003000                                                                  00300099
003100 WORKING-STORAGE SECTION.                                         00310099
003200 01  PS-SWITCHES.                                                 00320099
003300     05  PS-EOF-TRANS-SW              PIC X(01) VALUE 'N'.        00330099
003400         88  PS-EOF-TRANS                       VALUE 'Y'.        00340099
                                                                        00350099
003500     05  PS-COMMIT-SW                 PIC X(01) VALUE SPACE.      00360099
003600         88  PS-COMMIT-NOW                      VALUE 'Y'.        00370099
003700         88  PS-AINT-TIME-YET-TO-COMMIT         VALUE 'N'.        00380099
                                                                        00390099
           05  PS-DEPT-DEL-SW               PIC X(01) VALUE 'N'.        00400099
               88  PS-DEPT-DEL-YES                    VALUE 'Y'.        00410099
               88  PS-DEPT-DEL-NO                     VALUE 'N'.        00420099
                                                                        00430099
           05  PS-BUS-AREA-DEL-SW           PIC X(01) VALUE 'N'.        00440099
               88  PS-BUS-AREA-DEL-YES                VALUE 'Y'.        00450099
               88  PS-BUS-AREA-DEL-NO                 VALUE 'N'.        00460099
                                                                        00470099
           05  PS-BUS-GP-DEL-SW             PIC X(01) VALUE 'N'.        00480099
               88  PS-BUS-GP-DEL-YES                  VALUE 'Y'.        00490099
               88  PS-BUS-GP-DEL-NO                   VALUE 'N'.        00500099
                                                                        00510099
           05  PS-MAJ-CL-DEL-SW             PIC X(01) VALUE 'N'.        00520099
               88  PS-MAJ-CL-DEL-YES                  VALUE 'Y'.        00530099
               88  PS-MAJ-CL-DEL-NO                   VALUE 'N'.        00540099
                                                                        00550099
           05  PS-SUB-CL-DEL-SW             PIC X(01) VALUE 'N'.        00560099
               88  PS-SUB-CL-DEL-YES                  VALUE 'Y'.        00570099
               88  PS-SUB-CL-DEL-NO                   VALUE 'N'.        00580099
                                                                        00590099
           05  PS-DPTCL-CHG-NF-SW           PIC X(01) VALUE 'N'.        00600099
               88  PS-DPTCL-CHG-NF-YES                VALUE 'Y'.        00610099
               88  PS-DPTCL-CHG-NF-NO                 VALUE 'N'.        00620099
                                                                        00630099
003900 01  PV-COUNTERS COMP-3.                                          00640099
004000     05  PV-RETRY-COUNTER             PIC S9(03) VALUE ZERO.      00650099
004100     05  PV-COMMIT-COUNT              PIC S9(07) VALUE ZERO.      00660099
004200     05  PV-TRANS-COUNT               PIC S9(07) VALUE ZERO.      00670099
004300     05  PV-WRITE-COUNT               PIC S9(07) VALUE ZERO.      00680099
004400                                                                  00690099
004500     05  PV-XLT00000-INSERT-COUNT     PIC S9(07) VALUE ZERO.      00700099
004600     05  PV-XLT00000-DUP-COUNT        PIC S9(07) VALUE ZERO.      00710099
004700     05  PV-XLT00001-INSERT-COUNT     PIC S9(07) VALUE ZERO.      00720099
004800     05  PV-XLT00001-DUP-COUNT        PIC S9(07) VALUE ZERO.      00730099
004900     05  PV-XLT00002-INSERT-COUNT     PIC S9(07) VALUE ZERO.      00740099
005000     05  PV-XLT00002-DUP-COUNT        PIC S9(07) VALUE ZERO.      00750099
005100     05  PV-XLT00022-INSERT-COUNT     PIC S9(07) VALUE ZERO.      00760099
005200     05  PV-XLT00022-DUP-COUNT        PIC S9(07) VALUE ZERO.      00770099
005300     05  PV-XLT00023-INSERT-COUNT     PIC S9(07) VALUE ZERO.      00780099
005400     05  PV-XLT00023-DUP-COUNT        PIC S9(07) VALUE ZERO.      00790099
006900                                                                  00800099
007000     05  PV-XLT00000-DEL-COUNT        PIC S9(07) VALUE ZERO.      00810099
007100     05  PV-XLT00000-DELNF-COUNT      PIC S9(07) VALUE ZERO.      00820099
007300     05  PV-XLT00001-DEL-COUNT        PIC S9(07) VALUE ZERO.      00830099
007400     05  PV-XLT00001-DELNF-COUNT      PIC S9(07) VALUE ZERO.      00840099
007600     05  PV-XLT00002-DEL-COUNT        PIC S9(07) VALUE ZERO.      00850099
007700     05  PV-XLT00002-DELNF-COUNT      PIC S9(07) VALUE ZERO.      00860099
007900     05  PV-XLT00022-DEL-COUNT        PIC S9(07) VALUE ZERO.      00870099
008000     05  PV-XLT00022-DELNF-COUNT      PIC S9(07) VALUE ZERO.      00880099
008200     05  PV-XLT00023-DEL-COUNT        PIC S9(07) VALUE ZERO.      00890099
008300     05  PV-XLT00023-DELNF-COUNT      PIC S9(07) VALUE ZERO.      00900099
010600                                                                  00910099
010700     05  PV-XLT00000-UPD-COUNT        PIC S9(07) VALUE ZERO.      00920099
010800     05  PV-XLT00000-NF-COUNT         PIC S9(07) VALUE ZERO.      00930099
010900     05  PV-XLT00001-UPD-COUNT        PIC S9(07) VALUE ZERO.      00940099
011000     05  PV-XLT00001-NF-COUNT         PIC S9(07) VALUE ZERO.      00950099
011100     05  PV-XLT00002-UPD-COUNT        PIC S9(07) VALUE ZERO.      00960099
011200     05  PV-XLT00002-NF-COUNT         PIC S9(07) VALUE ZERO.      00970099
011300     05  PV-XLT00022-UPD-COUNT        PIC S9(07) VALUE ZERO.      00980099
011400     05  PV-XLT00022-NF-COUNT         PIC S9(07) VALUE ZERO.      00990099
011500     05  PV-XLT00023-UPD-COUNT        PIC S9(07) VALUE ZERO.      01000099
011600     05  PV-XLT00023-NF-COUNT         PIC S9(07) VALUE ZERO.      01010099
013100                                                                  01020099
013200 01  PV-OTHER-STUFF.                                              01030099
013300     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XLKUP034'. 01040099
013400     05  PV-TMST                      PIC X(26) VALUE SPACES.     01050099
013500     05  PV-HOLD-TMST                 PIC X(26) VALUE SPACES.     01060099
013600     05  PC-MAX-RETRIES               PIC S9(04)    VALUE  +3     01070099
013700                                                   COMP.          01080099
013900     05  PV-ABEND-CODE                PIC S9(04) COMP SYNC        01090099
014000                                                 VALUE ZERO.      01100099
041500     05  PV-CURRENT-TMST              PIC X(26)  VALUE SPACES.    01110099
           05  PV-DISP-NBR                  PIC Z,ZZZ,ZZ9.              01120099
                                                                        01130099
014100 01  PV-ABEND-FIELDS.                                             01140099
014200     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'XLKUP034'.01150099
014300     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01160099
014400     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01170099
014500     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01180099
014600     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01190099
014700     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01200099
014800     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    01210099
014900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01220099
015000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01230099
015100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01240099
015200     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01250099
015300     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.       01260099
015400/                                                                 01270099
015500*    TRANSACTION RECORD                                           01280099
015600     COPY XLRD039.                                                01290099
015700/                                                                 01300099
015800*  USED FOR DB2 ERROR MESSAGE BUILDING                            01310099
015900     COPY DPWS004.                                                01320099
016000                                                                  01330099
016100*   DB2 SQL COMMUNICATION AREA                                    01340099
016200     EXEC SQL                                                     01350099
016300          INCLUDE SQLCA                                           01360099
016400     END-EXEC.                                                    01370099
016500     COPY SQLCA2.                                                 01380099
016600/                                                                 01390099
016700*    DEPARTMENT                                                   01400099
016800     EXEC SQL                                                     01410099
016900          INCLUDE XLT00002                                        01420099
017000     END-EXEC.                                                    01430099
017100                                                                  01440099
017200*    MAJOR CLASS                                                  01450099
017300     EXEC SQL                                                     01460099
017400          INCLUDE XLT00022                                        01470099
017500     END-EXEC.                                                    01480099
017600                                                                  01490099
017700*    SUB CLASS                                                    01500099
017800     EXEC SQL                                                     01510099
017900          INCLUDE XLT00023                                        01520099
018000     END-EXEC.                                                    01530099
018100                                                                  01540099
018200*    BUSINESS GROUP                                               01550099
018300     EXEC SQL                                                     01560099
018400          INCLUDE XLT00001                                        01570099
018500     END-EXEC.                                                    01580099
018600                                                                  01590099
018700*    BUSINESS AREA                                               01600099
018800     EXEC SQL                                                     01610099
018900          INCLUDE XLT00000                                        01620099
019000     END-EXEC.                                                    01630099
019100                                                                  01640099
022600                                                                  01650099
023100/                                                                 01660099
023200 PROCEDURE DIVISION.                                              01670099
023300     PERFORM 1000-INITIALIZE.                                     01680099
023400     PERFORM 2000-PROCESS UNTIL PS-EOF-TRANS.                     01690099
023500     PERFORM 9000-EOJ.                                            01700099
023600     GOBACK.                                                      01710099
023700                                                                  01720099
023800 1000-INITIALIZE.                                                 01730099
023900                                                                  01740099
024000     OPEN INPUT XL-TRANS-FILE                                     01750099
024100     PERFORM 8000-READ-TRANS-FILE.                                01760099
024200     IF PS-EOF-TRANS                                              01770099
024300         DISPLAY ALL '*'                                          01780099
024400         DISPLAY '**  INP01 TRANS FILE IS EMPTY **'               01790099
024500         DISPLAY ALL '*'                                          01800099
024600     END-IF.                                                      01810099
024700                                                                  01820099
024800 2000-PROCESS.                                                    01830099
024900                                                                  01840099
025000     EVALUATE TRUE                                                01850099
025100     WHEN XL039-ADD                                               01860099
025200         EVALUATE TRUE                                            01870099
025300             WHEN XL039-AREA                                      01880099
025400                 PERFORM 7000-INSERT-BUS-AREA                     01890099
025500             WHEN XL039-GROUP                                     01900099
025600                 PERFORM 7005-INSERT-BUS-GP                       01910099
025700             WHEN XL039-DEPT                                      01920099
025800                 PERFORM 7010-INSERT-DEPT                         01930099
025900             WHEN XL039-MAJ-CL                                    01940099
026000                 PERFORM 7015-INSERT-MAJ-CL                       01950099
026100             WHEN XL039-SUB-CL                                    01960099
026200                 PERFORM 7020-INSERT-SUB-CL                       01970099
027700         END-EVALUATE                                             01980099
027800                                                                  01990099
      **************************************************************    02000099
      **************  D E L E T E    D E P A R T M E N T  **********    02010099
      **************************************************************    02020099
      **** PROGRAM DOES NOT DELETE DEPT CLASS TABLE RECORDS       **    02030099
      **** SETS A SWITCH FOR A RETURN CODE OF 4092                **    02040099
      **** TO TRIGGER SENDING OF E-MAIL NOTIFICATION MESSAGE      **    02050099
      **************************************************************    02060099
                                                                        02070099
027900     WHEN XL039-DELETE                                            02080099
028000         EVALUATE TRUE                                            02090099
028100             WHEN XL039-AREA                                      02100099
                       SET PS-BUS-AREA-DEL-YES TO TRUE                  02110099
                       ADD 1         TO PV-XLT00000-DEL-COUNT           02120099
028200*                PERFORM 7100-DELETE-BUS-AREA                     02130099
028300             WHEN XL039-GROUP                                     02140099
                       SET PS-BUS-GP-DEL-YES TO TRUE                    02150099
                       ADD 1         TO PV-XLT00001-DEL-COUNT           02160099
028400*                PERFORM 7105-DELETE-BUS-GP                       02170099
028500             WHEN XL039-DEPT                                      02180099
                       SET PS-DEPT-DEL-YES TO TRUE                      02190099
                       ADD 1         TO PV-XLT00002-DEL-COUNT           02200099
028600*                PERFORM 7110-DELETE-DEPT                         02210099
028700             WHEN XL039-MAJ-CL                                    02220099
                       SET PS-MAJ-CL-DEL-YES TO TRUE                    02230099
                       ADD 1         TO PV-XLT00022-DEL-COUNT           02240099
028800*                PERFORM 7115-DELETE-MAJ-CL                       02250099
028900             WHEN XL039-SUB-CL                                    02260099
                       SET PS-SUB-CL-DEL-YES TO TRUE                    02270099
                       ADD 1         TO PV-XLT00023-DEL-COUNT           02280099
029000*                PERFORM 7120-DELETE-SUB-CL                       02290099
030500         END-EVALUATE                                             02300099
030600                                                                  02310099
030700     WHEN XL039-MODIFY                                            02320099
030800         EVALUATE TRUE                                            02330099
030900             WHEN XL039-AREA                                      02340099
031000                 PERFORM 7200-CHANGE-BUS-AREA                     02350099
031100             WHEN XL039-GROUP                                     02360099
031200                 PERFORM 7205-CHANGE-BUS-GP                       02370099
031300             WHEN XL039-DEPT                                      02380099
031400                 PERFORM 7210-CHANGE-DEPT                         02390099
031500             WHEN XL039-MAJ-CL                                    02400099
031600                 PERFORM 7215-CHANGE-MAJ-CL                       02410099
031700             WHEN XL039-SUB-CL                                    02420099
031800                 PERFORM 7220-CHANGE-SUB-CL                       02430099
033300         END-EVALUATE                                             02440099
033400                                                                  02450099
033500     END-EVALUATE.                                                02460099
033600                                                                  02470099
033700                                                                  02480099
033800     PERFORM 8000-READ-TRANS-FILE.                                02490099
033900                                                                  02500099
116200******************************************************************02510099
116300* SET THE CURRENT TIMESTAMP.                                      02520099
116400******************************************************************02530099
116500 2150-SET-CURRENT-TMST.                                           02540099
116600                                                                  02550099
117200     EXEC SQL                                                     02560099
117300         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 02570099
117400     END-EXEC                                                     02580099
117500                                                                  02590099
117600     EVALUATE TRUE                                                02600099
117700        WHEN SQLCODE = ZERO                                       02610099
117800            CONTINUE                                              02620099
117900                                                                  02630099
118000        WHEN SQLWARN0 NOT = SPACES                                02640099
118100        WHEN SQLCODE  NOT = ZERO                                  02650099
118200            DISPLAY '**************************************'      02660099
118300            DISPLAY '** ABEND                            **'      02670099
118400            DISPLAY '** PROGRAM = XLKUP034               **'      02680099
118500            DISPLAY '** PARAGRAPH = 2150-SET-CURRENT-TMST**'      02690099
118600            DISPLAY '** SET CURRENT TIMESTAMP            **'      02700099
118700            DISPLAY '** SQLCODE = ' SQLCODE                       02710099
118800            DISPLAY '**************************************'      02720099
118900            PERFORM 9900-SQL-ERROR                                02730099
119000     END-EVALUATE.                                                02740099
119100                                                                  02750099
185654******************************************************************02760000
185655* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     02770000
185656******************************************************************02780000
185657 6000-DB2-COMMIT.                                                 02790000
185658                                                                  02800000
185659     EXEC SQL                                                     02810000
185660         COMMIT                                                   02820000
185700     END-EXEC.                                                    02830000
185800                                                                  02840000
185900     EVALUATE TRUE                                                02850000
186000         WHEN SQLCODE = +0                                        02860000
186100              ADD +1  TO PV-COMMIT-COUNT                          02870000
186200         WHEN SQLWARN0 NOT = SPACES                               02880011
186300         WHEN SQLCODE  NOT = ZERO                                 02890011
186400         DISPLAY '****************************'                   02900000
186500         DISPLAY '** ABEND                  **'                   02910000
186600         DISPLAY '** PROGRAM = XLKUP034     **'                   02920099
186700         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   02930000
186800         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   02940000
186900         DISPLAY '****************************'                   02950000
187000         PERFORM 9900-SQL-ERROR                                   02960000
187100     END-EVALUATE.                                                02970000
187200                                                                  02980000
034000****************************************************************  02990099
034100****** START OF INSERT ROUTINES ******                            03000099
034200****************************************************************  03010099
034300                                                                  03020099
034400 7000-INSERT-BUS-AREA.                                            03030099
034500     MOVE '7000-INSERT-BUS-AREA'      TO PV-ABEND-PARAGRAPH.      03040099
034600                                                                  03050099
034700     MOVE XL039-AREA-ID               TO XLT00000-BUS-AREA-ID     03060099
034800     MOVE XL039-AREA-DESC             TO XLT00000-BUS-AREA-DESC   03070099
034900                                                                  03080099
035000                                                                  03090099
035100     PERFORM                                                      03100099
035200         WITH TEST AFTER                                          03110099
035300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     03120099
035400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            03130099
035500                (SQLCODE = ZERO) OR (SQLCODE = -803))             03140099
035600                                                                  03150099
035700     EXEC SQL                                                     03160099
035800         INSERT INTO XLT_BUS_AREA                                 03170099
035900             (BUS_AREA_ID                                         03180099
036000         ,    BUS_AREA_DESC                                       03190099
036100         )                                                        03200099
036200             VALUES                                               03210099
036300            (:XLT00000-BUS-AREA-ID                                03220099
036400         ,   :XLT00000-BUS-AREA-DESC                              03230099
036500         )                                                        03240099
036600         END-EXEC                                                 03250099
036700                                                                  03260099
036800         EVALUATE TRUE                                            03270099
036900             WHEN SQLCODE = ZERO                                  03280099
037000                 ADD 1                TO PV-XLT00000-INSERT-COUNT 03290099
      *COMMIT DB2 DATA TO TABLES.                                       03300099
                       PERFORM 6000-DB2-COMMIT                          03310099
037100             WHEN SQLCODE = -803                                  03320099
037200                 ADD 1                TO PV-XLT00000-DUP-COUNT    03330099
037300             WHEN SQLCODE = -904                                  03340099
037400             WHEN SQLCODE = -911                                  03350099
037500             WHEN SQLCODE = -913                                  03360099
037600                 CONTINUE                                         03370099
037700                                                                  03380099
037800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              03390099
037900                 DISPLAY '**************************************' 03400099
038000                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00000'   03410099
                       DISPLAY 'TABLE = XLT_BUS_AREA'                   03420099
038100                 DISPLAY 'BUS-AREA-ID =  '  XL039-AREA-ID         03430099
111200                 DISPLAY '**********************************'     03440099
038300                 PERFORM 9800-SQL-WARNING                         03450099
038400                                                                  03460099
038500             WHEN SQLCODE < ZERO                                  03470099
038600                 DISPLAY '**************************************' 03480099
038700                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00000   '  03490099
                       DISPLAY 'TABLE = XLT_BUS_AREA'                   03500099
038800                 DISPLAY 'BUS-AREA-ID =  '  XL039-AREA-ID         03510099
                       DISPLAY 'SQLCODE =' SQLCODE                      03520099
039000                 PERFORM 9900-SQL-ERROR                           03530099
039100                                                                  03540099
039200         END-EVALUATE                                             03550099
039300     END-PERFORM                                                  03560099
039400                                                                  03570099
039500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    03580099
039600         SQLCODE NOT = ZERO                                       03590099
039700         DISPLAY '**************************************'         03600099
039800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         03610099
039900         DISPLAY 'INSERT TO XLT_BUS_AREA                '         03620099
040000         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00000  '           03630099
040100         DISPLAY 'BUS-AREA-ID =  '  XL039-AREA-ID                 03640099
040200         DISPLAY '**************************************'         03650099
040300         PERFORM 9900-SQL-ERROR                                   03660099
040400     END-IF.                                                      03670099
040500                                                                  03680099
040600 7005-INSERT-BUS-GP.                                              03690099
040700     MOVE '7005-INSERT-BUS-GP'      TO PV-ABEND-PARAGRAPH.        03700099
040800                                                                  03710099
040900     MOVE XL039-GROUP-NBR           TO XLT00001-BUS-GP-NBR.       03720099
041000     MOVE XL039-GP-AREA-ID          TO XLT00001-BUS-AREA-ID.      03730099
041000     MOVE XL039-GROUP-DESC          TO XLT00001-BUS-GP-DESC.      03740099
041100                                                                  03750099
041200                                                                  03760099
041300     PERFORM                                                      03770099
041400         WITH TEST AFTER                                          03780099
041500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     03790099
041600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            03800099
041700                (SQLCODE = ZERO) OR (SQLCODE = -803))             03810099
041800                                                                  03820099
041900     EXEC SQL                                                     03830099
042000         INSERT INTO XLT_BUS_GP                                   03840099
042100             (BUS_GP_NBR                                          03850099
042200         ,    BUS_AREA_ID                                         03860099
042200         ,    BUS_GP_DESC                                         03870099
042300         )                                                        03880099
042400             VALUES                                               03890099
042500             (:XLT00001-BUS-GP-NBR                                03900099
042600         ,    :XLT00001-BUS-AREA-ID                               03910099
042600         ,    :XLT00001-BUS-GP-DESC                               03920099
042700         )                                                        03930099
042800         END-EXEC                                                 03940099
042900                                                                  03950099
043000         EVALUATE TRUE                                            03960099
043100             WHEN SQLCODE = ZERO                                  03970099
043200                 ADD 1                TO PV-XLT00001-INSERT-COUNT 03980099
      *COMMIT DB2 DATA TO TABLES.                                       03990099
                       PERFORM 6000-DB2-COMMIT                          04000099
043300             WHEN SQLCODE = -803                                  04010099
043400                 ADD 1                TO PV-XLT00001-DUP-COUNT    04020099
043500             WHEN SQLCODE = -904                                  04030099
043600             WHEN SQLCODE = -911                                  04040099
043700             WHEN SQLCODE = -913                                  04050099
043800                 CONTINUE                                         04060099
043900                                                                  04070099
044000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              04080099
044100                 DISPLAY '**************************************' 04090099
044200                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00001   '04100099
044200                 DISPLAY 'TABLE = XLT_BUS_GP'                     04110099
044300                 DISPLAY 'BUS-GP-NBR =  '  XL039-GROUP-NBR        04120099
044400                 DISPLAY '**********************************'     04130099
044500                 PERFORM 9800-SQL-WARNING                         04140099
044600                                                                  04150099
044700             WHEN SQLCODE < ZERO                                  04160099
044800                 DISPLAY '**************************************' 04170099
044900                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00001     '04180099
044200                 DISPLAY 'TABLE = XLT_BUS_GP'                     04190099
045000                 DISPLAY 'BUS-GP-NBR =  '  XL039-GROUP-NBR        04200099
045100                 DISPLAY '**************************************' 04210099
045200                 PERFORM 9900-SQL-ERROR                           04220099
045300                                                                  04230099
045400         END-EVALUATE                                             04240099
045500     END-PERFORM                                                  04250099
045600                                                                  04260099
045700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    04270099
045800         SQLCODE NOT = ZERO                                       04280099
045900         DISPLAY '**************************************'         04290099
046000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         04300099
046100         DISPLAY 'INSERT TO XLT_BUS_GP                  '         04310099
046200         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00001  '           04320099
046300         DISPLAY 'BUS-GP-NBR =  '  XL039-GROUP-NBR                04330099
046400         DISPLAY '**************************************'         04340099
046500         DISPLAY '**************************************'         04350099
046600         PERFORM 9900-SQL-ERROR                                   04360099
046700     END-IF.                                                      04370099
046800                                                                  04380099
046900 7010-INSERT-DEPT.                                                04390099
047000     MOVE '7010-INSERT-DEPT'          TO PV-ABEND-PARAGRAPH.      04400099
047100                                                                  04410099
047200     MOVE XL039-DEPT-NBR              TO XLT00002-DEPT-NBR        04420099
047300     MOVE XL039-DEPT-NAME             TO XLT00002-DEPT-NM         04430099
047300     MOVE XL039-MDSE-LNE-CDE          TO XLT00002-MDSE-LNE-CDE    04440099
047300     MOVE XL039-BUS-GP-NBR            TO XLT00002-BUS-GP-NBR      04450099
047300     MOVE XL039-STR-ZN-CDE            TO XLT00002-STR-ZN-CDE      04460099
047300     MOVE XL039-BYR-NBR               TO XLT00002-BYR-NBR         04470099
047300     MOVE XL039-DMA-NBR               TO XLT00002-DMA-NBR         04480099
047300     MOVE XL039-EXCLN-IND     TO XLT00002-CONT-CLR-EXCLN-IND      04490099
047400                                                                  04500099
047500                                                                  04510099
047600     PERFORM                                                      04520099
047700         WITH TEST AFTER                                          04530099
047800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     04540099
047900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            04550099
048000                (SQLCODE = ZERO) OR (SQLCODE = -803))             04560099
048100                                                                  04570099
048200     EXEC SQL                                                     04580099
048300         INSERT INTO XLT_DEPT                                     04590099
048400             (DEPT_NBR                                            04600099
048500         ,    DEPT_NM                                             04610099
048500         ,    MDSE_LNE_CDE                                        04620099
048500         ,    BUS_GP_NBR                                          04630099
048500         ,    STR_ZN_CDE                                          04640099
048500         ,    BYR_NBR                                             04650099
048500         ,    DMA_NBR                                             04660099
048500         ,    CONT_CLR_EXCLN_IND                                  04670099
048600         )                                                        04680099
048700             VALUES                                               04690099
048800             (:XLT00002-DEPT-NBR                                  04700099
048900         ,    :XLT00002-DEPT-NM                                   04710099
048900         ,    :XLT00002-MDSE-LNE-CDE                              04720099
048900         ,    :XLT00002-BUS-GP-NBR                                04730099
048900         ,    :XLT00002-STR-ZN-CDE                                04740099
048900         ,    :XLT00002-BYR-NBR                                   04750099
048900         ,    :XLT00002-DMA-NBR                                   04760099
048900         ,    :XLT00002-CONT-CLR-EXCLN-IND                        04770099
049000         )                                                        04780099
049100         END-EXEC                                                 04790099
049200                                                                  04800099
049300         EVALUATE TRUE                                            04810099
049400             WHEN SQLCODE = ZERO                                  04820099
049500                 ADD 1                TO PV-XLT00002-INSERT-COUNT 04830099
      *COMMIT DB2 DATA TO TABLES.                                       04840099
                       PERFORM 6000-DB2-COMMIT                          04850099
049600             WHEN SQLCODE = -803                                  04860099
049700                 ADD 1                TO PV-XLT00002-DUP-COUNT    04870099
049800             WHEN SQLCODE = -904                                  04880099
049900             WHEN SQLCODE = -911                                  04890099
050000             WHEN SQLCODE = -913                                  04900099
050100                 CONTINUE                                         04910099
050200                                                                  04920099
050300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              04930099
050400                 DISPLAY '**************************************' 04940099
050500                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00002  ' 04950099
050500                 DISPLAY 'TABLE = XLT_DEPT'                       04960099
050600                 DISPLAY 'DEPT-NBR    = '  XL039-DEPT-NBR         04970099
050700                 DISPLAY '**********************************'     04980099
050800                 PERFORM 9800-SQL-WARNING                         04990099
050900                                                                  05000099
051000             WHEN SQLCODE < ZERO                                  05010099
051100                 DISPLAY '**************************************' 05020099
051200                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00002 '    05030099
050500                 DISPLAY 'TABLE = XLT_DEPT'                       05040099
051300                 DISPLAY 'DEPT-NBR    = '  XL039-DEPT-NBR         05050099
051400                 DISPLAY '**************************************' 05060099
051500                 PERFORM 9900-SQL-ERROR                           05070099
051600                                                                  05080099
051700         END-EVALUATE                                             05090099
051800     END-PERFORM                                                  05100099
051900                                                                  05110099
052000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05120099
052100         SQLCODE NOT = ZERO                                       05130099
052200         DISPLAY '**************************************'         05140099
052300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         05150099
052400         DISPLAY 'INSERT TO XLT_DEPT                    '         05160099
052500         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00002  '           05170099
052600         DISPLAY 'DEPT-NBR    = '  XL039-DEPT-NBR                 05180099
052700         DISPLAY '**************************************'         05190099
052800         DISPLAY '**************************************'         05200099
052900         PERFORM 9900-SQL-ERROR                                   05210099
053000     END-IF.                                                      05220099
053100                                                                  05230099
053200 7015-INSERT-MAJ-CL.                                              05240099
053300     MOVE '7015-INSERT-MAJ-CL'        TO PV-ABEND-PARAGRAPH.      05250099
053400     MOVE XL039-MAJ-CL-DEPT-NBR       TO XLT00022-DEPT-NBR        05260099
053500     MOVE XL039-MAJ-CL-NBR            TO XLT00022-MAJ-CL-NBR      05270099
053600     MOVE XL039-MAJ-CL-NM             TO XLT00022-MAJ-CL-NM       05280099
053600     MOVE XL039-PUT-AWY-CDE           TO XLT00022-PUT-AWY-CDE     05290099
053700                                                                  05300099
053800                                                                  05310099
053900     PERFORM                                                      05320099
054000         WITH TEST AFTER                                          05330099
054100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     05340099
054200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            05350099
054300                (SQLCODE = ZERO) OR (SQLCODE = -803))             05360099
054400                                                                  05370099
054500     EXEC SQL                                                     05380099
054600         INSERT INTO XLT_MAJ_CL                                   05390099
054700             (DEPT_NBR                                            05400099
054800         ,    MAJ_CL_NBR                                          05410099
054900         ,    MAJ_CL_NM                                           05420099
054900         ,    PUT_AWY_CDE                                         05430099
055000         )                                                        05440099
055100             VALUES                                               05450099
055200             (:XLT00022-DEPT-NBR                                  05460099
055300         ,    :XLT00022-MAJ-CL-NBR                                05470099
055400         ,    :XLT00022-MAJ-CL-NM                                 05480099
055400         ,    :XLT00022-PUT-AWY-CDE                               05490099
055500         )                                                        05500099
055600         END-EXEC                                                 05510099
055700                                                                  05520099
055800         EVALUATE TRUE                                            05530099
055900             WHEN SQLCODE = ZERO                                  05540099
056000                 ADD 1                TO PV-XLT00022-INSERT-COUNT 05550099
      *COMMIT DB2 DATA TO TABLES.                                       05560099
                       PERFORM 6000-DB2-COMMIT                          05570099
056100             WHEN SQLCODE = -803                                  05580099
056200                 ADD 1                TO PV-XLT00022-DUP-COUNT    05590099
056300             WHEN SQLCODE = -904                                  05600099
056400             WHEN SQLCODE = -911                                  05610099
056500             WHEN SQLCODE = -913                                  05620099
056600                 CONTINUE                                         05630099
056700                                                                  05640099
056800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              05650099
056900                 DISPLAY '**************************************' 05660099
057000                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00022  ' 05670099
                       DISPLAY 'TABLE = XLT_MAJ_CL'                     05680099
057100                 DISPLAY 'DEPT-NBR    = '  XL039-MAJ-CL-DEPT-NBR  05690099
                       DISPLAY 'MAJ-CL-NBR  = '  XL039-MAJ-CL-NBR       05700099
057200                 DISPLAY '**********************************'     05710099
057300                 PERFORM 9800-SQL-WARNING                         05720099
057400                                                                  05730099
057500             WHEN SQLCODE < ZERO                                  05740099
057600                 DISPLAY '**************************************' 05750099
057700                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00022  '   05760099
                       DISPLAY 'TABLE = XLT_MAJ_CL'                     05770099
057800                 DISPLAY 'DEPT-NBR    = '  XL039-MAJ-CL-DEPT-NBR  05780099
                       DISPLAY 'MAJ-CL-NBR  = '  XL039-MAJ-CL-NBR       05790099
057900                 DISPLAY '**************************************' 05800099
058000                 PERFORM 9900-SQL-ERROR                           05810099
058100                                                                  05820099
058200         END-EVALUATE                                             05830099
058300     END-PERFORM                                                  05840099
058400                                                                  05850099
058500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05860099
058600         SQLCODE NOT = ZERO                                       05870099
058700         DISPLAY '**************************************'         05880099
058800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         05890099
058900         DISPLAY 'INSERT TO XLT_MAJ_CL                  '         05900099
059000         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00022  '           05910099
057800         DISPLAY 'DEPT-NBR    = '  XL039-MAJ-CL-DEPT-NBR          05920099
               DISPLAY 'MAJ-CL-NBR  = '  XL039-MAJ-CL-NBR               05930099
059200         DISPLAY '**************************************'         05940099
059300         DISPLAY '**************************************'         05950099
059400         PERFORM 9900-SQL-ERROR                                   05960099
059500     END-IF.                                                      05970099
059600                                                                  05980099
059700 7020-INSERT-SUB-CL.                                              05990099
059800     MOVE '7020-INSERT-SUB-CL'        TO PV-ABEND-PARAGRAPH.      06000099
059900     MOVE XL039-SUB-CL-DEPT-NBR       TO XLT00023-DEPT-NBR        06010099
060000     MOVE XL039-SUB-CL-MAJ-CL-NBR     TO XLT00023-MAJ-CL-NBR      06020099
060100     MOVE XL039-SUB-CL-NBR            TO XLT00023-SUB-CL-NBR      06030099
060200     MOVE XL039-SUB-CL-NM             TO XLT00023-SUB-CL-NM       06040099
060200     MOVE XL039-SUB-CL-MDSE-DESC      TO XLT00023-POS-MDSE-DESC   06050099
060200     MOVE XL039-TAX-DFLT-IND          TO XLT00023-TAX-DFLT-IND    06060099
060200     MOVE XL039-DISC-ELIG-IND         TO XLT00023-DISC-ELIG-IND   06070099
060300                                                                  06080099
060400                                                                  06090099
060500     PERFORM                                                      06100099
060600         WITH TEST AFTER                                          06110099
060700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     06120099
060800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            06130099
060900                (SQLCODE = ZERO) OR (SQLCODE = -803))             06140099
061000                                                                  06150099
061100     EXEC SQL                                                     06160099
061200         INSERT INTO XLT_SUB_CL                                   06170099
061300             (DEPT_NBR                                            06180099
061400         ,    MAJ_CL_NBR                                          06190099
061500         ,    SUB_CL_NBR                                          06200099
061600         ,    SUB_CL_NM                                           06210099
061600         ,    POS_MDSE_DESC                                       06220099
061600         ,    TAX_DFLT_IND                                        06230099
061600         ,    DISC_ELIG_IND                                       06240099
061700         )                                                        06250099
061800             VALUES                                               06260099
061900             (:XLT00023-DEPT-NBR                                  06270099
062000         ,    :XLT00023-MAJ-CL-NBR                                06280099
062100         ,    :XLT00023-SUB-CL-NBR                                06290099
062200         ,    :XLT00023-SUB-CL-NM                                 06300099
062200         ,    :XLT00023-POS-MDSE-DESC                             06310099
062200         ,    :XLT00023-TAX-DFLT-IND                              06320099
062200         ,    :XLT00023-DISC-ELIG-IND                             06330099
062300         )                                                        06340099
062400         END-EXEC                                                 06350099
062500                                                                  06360099
062600         EVALUATE TRUE                                            06370099
062700             WHEN SQLCODE = ZERO                                  06380099
062800                 ADD 1                TO PV-XLT00023-INSERT-COUNT 06390099
      *COMMIT DB2 DATA TO TABLES.                                       06400099
                       PERFORM 6000-DB2-COMMIT                          06410099
062900             WHEN SQLCODE = -803                                  06420099
063000                 ADD 1                TO PV-XLT00023-DUP-COUNT    06430099
063100             WHEN SQLCODE = -904                                  06440099
063200             WHEN SQLCODE = -911                                  06450099
063300             WHEN SQLCODE = -913                                  06460099
063400                 CONTINUE                                         06470099
063500                                                                  06480099
063600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              06490099
063700                 DISPLAY '**************************************' 06500099
063800                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00023  ' 06510099
                       DISPLAY 'TABLE = XLT_SUB_CL'                     06520099
063900                 DISPLAY 'DEPT-NBR    = '  XL039-SUB-CL-DEPT-NBR  06530099
                       DISPLAY 'MAJ-CL-NBR  =' XL039-SUB-CL-MAJ-CL-NBR  06540099
                       DISPLAY 'SUB-CL-NBR  = ' XL039-SUB-CL-NBR        06550099
064000                 DISPLAY '**********************************'     06560099
064100                 PERFORM 9800-SQL-WARNING                         06570099
064200                                                                  06580099
064300             WHEN SQLCODE < ZERO                                  06590099
064400                 DISPLAY '**************************************' 06600099
064500                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00023  '   06610099
                       DISPLAY 'TABLE = XLT_SUB_CL'                     06620099
064600                 DISPLAY 'DEPT-NBR    = '  XL039-SUB-CL-DEPT-NBR  06630099
                       DISPLAY 'MAJ-CL-NBR  = ' XL039-SUB-CL-MAJ-CL-NBR 06640099
                       DISPLAY 'SUB-CL-NBR  = ' XL039-SUB-CL-NBR        06650099
064700                 DISPLAY '**************************************' 06660099
064800                 PERFORM 9900-SQL-ERROR                           06670099
064900                                                                  06680099
065000         END-EVALUATE                                             06690099
065100     END-PERFORM                                                  06700099
065200                                                                  06710099
058500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    06720099
058600         SQLCODE NOT = ZERO                                       06730099
058700         DISPLAY '**************************************'         06740099
058800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         06750099
058900         DISPLAY 'INSERT TO XLT_SUB_CL                  '         06760099
059000         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00023  '           06770099
057800         DISPLAY 'DEPT-NBR    = ' XL039-SUB-CL-DEPT-NBR           06780099
               DISPLAY 'MAJ-CL-NBR  = ' XL039-SUB-CL-MAJ-CL-NBR         06790099
               DISPLAY 'SUB-CL-NBR  = ' XL039-SUB-CL-NBR                06800099
059200         DISPLAY '**************************************'         06810099
059300         DISPLAY '**************************************'         06820099
059400         PERFORM 9900-SQL-ERROR                                   06830099
059500     END-IF.                                                      06840099
                                                                        06850099
092700                                                                  06860099
127100****************************************************************  06870099
127200****** START OF DELETE ROUTINES ******                            06880099
127300****************************************************************  06890099
127400                                                                  06900099
127500 7100-DELETE-BUS-AREA.                                            06910099
127600     MOVE '7100-DELETE-BUS-AREA'      TO PV-ABEND-PARAGRAPH.      06920099
127700                                                                  06930099
127800     MOVE XL039-AREA-ID               TO XLT00000-BUS-AREA-ID     06940099
127900                                                                  06950099
128000                                                                  06960099
128100     PERFORM                                                      06970099
128200         WITH TEST AFTER                                          06980099
128300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     06990099
128400         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            07000099
128500                (SQLCODE = ZERO OR +100 OR -532)                  07010099
128600                                                                  07020099
128700     EXEC SQL                                                     07030099
128800         DELETE FROM XLT_BUS_AREA                                 07040099
128900         WHERE                                                    07050099
129000              BUS_AREA_ID   = :XLT00000-BUS-AREA-ID               07060099
129100         END-EXEC                                                 07070099
129200                                                                  07080099
129300         EVALUATE TRUE                                            07090099
129400             WHEN SQLCODE = ZERO                                  07100099
129500                 ADD 1                TO PV-XLT00000-DEL-COUNT    07110099
      *COMMIT DB2 DATA TO TABLES.                                       07120099
                       PERFORM 6000-DB2-COMMIT                          07130099
129600             WHEN SQLCODE = +100                                  07140099
129700                 ADD 1                TO PV-XLT00000-DELNF-COUNT  07150099
130000             WHEN SQLCODE = -904                                  07160099
130100             WHEN SQLCODE = -911                                  07170099
130200             WHEN SQLCODE = -913                                  07180099
130300                 CONTINUE                                         07190099
130400                                                                  07200099
130500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              07210099
130600                 DISPLAY '**************************************' 07220099
130700                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00000   '07230099
                       DISPLAY 'TABLE = XLT_BUS_AREA'                   07240099
130800                 DISPLAY 'BUS-AREA-ID =  '  XL039-AREA-ID         07250099
130900                 DISPLAY '**********************************'     07260099
131000                 PERFORM 9800-SQL-WARNING                         07270099
131100                                                                  07280099
131200             WHEN SQLCODE < ZERO                                  07290099
131300                 DISPLAY '**************************************' 07300099
131400                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00000   '  07310099
                       DISPLAY 'TABLE = XLT_BUS_AREA'                   07320099
131500                 DISPLAY 'BUS-AREA-ID =  '  XL039-AREA-ID         07330099
131600                 DISPLAY '**************************************' 07340099
131700                 PERFORM 9900-SQL-ERROR                           07350099
131800                                                                  07360099
131900         END-EVALUATE                                             07370099
132000     END-PERFORM                                                  07380099
132100                                                                  07390099
132200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07400099
132300         SQLCODE NOT = ZERO                                       07410099
132400         DISPLAY '**************************************'         07420099
132500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         07430099
132600         DISPLAY 'DELETE TO XLT_BUS_AREA                '         07440099
132700         DISPLAY 'ERROR ISSUED ON DELETE OF XLT0000   '           07450099
132800         DISPLAY 'BUS-AREA-ID =  '  XL039-AREA-ID                 07460099
132900         DISPLAY '**************************************'         07470099
133000         PERFORM 9900-SQL-ERROR                                   07480099
133100     END-IF.                                                      07490099
133200                                                                  07500099
133300 7105-DELETE-BUS-GP.                                              07510099
133400     MOVE '7105-DELETE-BUS-GP'        TO PV-ABEND-PARAGRAPH.      07520099
133500                                                                  07530099
133600     MOVE XL039-GROUP-NBR             TO XLT00001-BUS-GP-NBR      07540099
133700                                                                  07550099
133800                                                                  07560099
133900     PERFORM                                                      07570099
134000         WITH TEST AFTER                                          07580099
134100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07590099
134200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            07600099
134300                (SQLCODE = ZERO) OR (SQLCODE = +100))             07610099
134400                                                                  07620099
134500     EXEC SQL                                                     07630099
134600         DELETE FROM XLT_BUS_GP                                   07640099
134700         WHERE                                                    07650099
134800              BUS_GP_NBR    = :XLT00001-BUS-GP-NBR                07660099
134900         END-EXEC                                                 07670099
135000                                                                  07680099
135100         EVALUATE TRUE                                            07690099
135200             WHEN SQLCODE = ZERO                                  07700099
135300                 ADD 1                TO PV-XLT00001-DEL-COUNT    07710099
      *COMMIT DB2 DATA TO TABLES.                                       07720099
                       PERFORM 6000-DB2-COMMIT                          07730099
135400             WHEN SQLCODE = +100                                  07740099
135500                 ADD 1                TO PV-XLT00001-DELNF-COUNT  07750099
135600             WHEN SQLCODE = -904                                  07760099
135700             WHEN SQLCODE = -911                                  07770099
135800             WHEN SQLCODE = -913                                  07780099
135900                 CONTINUE                                         07790099
136000                                                                  07800099
136100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              07810099
136200                 DISPLAY '**************************************' 07820099
136300                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00001   '07830099
                       DISPLAY 'TABLE = XLT_BUS_GP'                     07840099
136400                 DISPLAY 'BUS-GP-NBR    =' XL039-GROUP-NBR        07850099
136500                 DISPLAY '**********************************'     07860099
136600                 PERFORM 9800-SQL-WARNING                         07870099
136700                                                                  07880099
136800             WHEN SQLCODE < ZERO                                  07890099
136900                 DISPLAY '**************************************' 07900099
137000                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00001 '    07910099
                       DISPLAY 'TABLE = XLT_BUS_GP'                     07920099
137100                 DISPLAY 'BUS-GP-NBR    =' XL039-GROUP-NBR        07930099
137200                 DISPLAY '**************************************' 07940099
137300                 PERFORM 9900-SQL-ERROR                           07950099
137400                                                                  07960099
137500         END-EVALUATE                                             07970099
137600     END-PERFORM                                                  07980099
137700                                                                  07990099
137800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08000099
137900         SQLCODE NOT = ZERO                                       08010099
138000         DISPLAY '**************************************'         08020099
138100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         08030099
138200         DISPLAY 'DELETE FROM XLT_BUS_GP                '         08040099
138300         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00001  '           08050099
138400         DISPLAY 'BUS-GP-NBR    =' XL039-GROUP-NBR                08060099
138500         DISPLAY '**************************************'         08070099
138600         DISPLAY '**************************************'         08080099
138700         PERFORM 9900-SQL-ERROR                                   08090099
138800     END-IF.                                                      08100099
138900                                                                  08110099
139000 7110-DELETE-DEPT.                                                08120099
139100     MOVE '7110-DELETE-DEPT'          TO PV-ABEND-PARAGRAPH.      08130099
139200                                                                  08140099
139300     MOVE XL039-DEPT-NBR              TO XLT00002-DEPT-NBR        08150099
139400                                                                  08160099
139500     PERFORM                                                      08170099
139600         WITH TEST AFTER                                          08180099
139700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08190099
139800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            08200099
139900                (SQLCODE = ZERO) OR (SQLCODE = +100))             08210099
140000                                                                  08220099
140100     EXEC SQL                                                     08230099
140200         DELETE FROM XLT_DEPT                                     08240099
140300         WHERE                                                    08250099
140400             DEPT_NBR     =  :XLT00002-DEPT-NBR                   08260099
140500         END-EXEC                                                 08270099
140600                                                                  08280099
140700         EVALUATE TRUE                                            08290099
140800             WHEN SQLCODE = ZERO                                  08300099
140900                 ADD 1                TO PV-XLT00002-DEL-COUNT    08310099
      *COMMIT DB2 DATA TO TABLES.                                       08320099
                       PERFORM 6000-DB2-COMMIT                          08330099
141000             WHEN SQLCODE = +100                                  08340099
141100                 ADD 1                TO PV-XLT00002-DELNF-COUNT  08350099
02Ù200             WHEN SQLCODE = -904                                  08360099
141300             WHEN SQLCODE = -911                                  08370099
141400             WHEN SQLCODE = -913                                  08380099
141500                 CONTINUE                                         08390099
141600                                                                  08400099
141700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              08410099
141800                 DISPLAY '**************************************' 08420099
141900                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00002  ' 08430099
                       DISPLAY 'TABLE = XLT_DEPT'                       08440099
142000                 DISPLAY 'DEPT-NBR = '  XL039-DEPT-NBR            08450099
142100                 DISPLAY '**********************************'     08460099
142200                 PERFORM 9800-SQL-WARNING                         08470099
142300                                                                  08480099
142400             WHEN SQLCODE < ZERO                                  08490099
142500                 DISPLAY '**************************************' 08500099
142600                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00002 '    08510099
                       DISPLAY 'TABLE = XLT_DEPT'                       08520099
142700                 DISPLAY 'DEPT-NBR = '  XL039-DEPT-NBR            08530099
142800                 DISPLAY '**************************************' 08540099
142900                 PERFORM 9900-SQL-ERROR                           08550099
143000                                                                  08560099
143100         END-EVALUATE                                             08570099
143200     END-PERFORM                                                  08580099
143300                                                                  08590099
143400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08600099
143500         SQLCODE NOT = ZERO                                       08610099
143600         DISPLAY '**************************************'         08620099
143700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         08630099
143800         DISPLAY 'DELETE FROM XLT_DEPT                  '         08640099
143900         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00002  '           08650099
144000         DISPLAY 'DEPT-NBR = '   XL039-DEPT-NBR                   08660099
144100         DISPLAY '**************************************'         08670099
144200         DISPLAY '**************************************'         08680099
144300         PERFORM 9900-SQL-ERROR                                   08690099
144400     END-IF.                                                      08700099
144500                                                                  08710099
                                                                        08720099
      ***   START HERE  ****                                            08730099
                                                                        08740099
144600 7115-DELETE-MAJ-CL.                                              08750099
144700     MOVE '7115-DELETE-MAJ-CL'        TO PV-ABEND-PARAGRAPH.      08760099
144800                                                                  08770099
144900     MOVE XL039-MAJ-CL-DEPT-NBR       TO XLT00022-DEPT-NBR        08780099
144900     MOVE XL039-MAJ-CL-NBR            TO XLT00022-MAJ-CL-NBR      08790099
144900     MOVE XL039-MAJ-CL-NM             TO XLT00022-MAJ-CL-NM       08800099
144900     MOVE XL039-PUT-AWY-CDE           TO XLT00022-PUT-AWY-CDE     08810099
145000                                                                  08820099
145100     PERFORM                                                      08830099
145200         WITH TEST AFTER                                          08840099
145300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08850099
145400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            08860099
145500                (SQLCODE = ZERO) OR (SQLCODE = +100))             08870099
145600                                                                  08880099
145700     EXEC SQL                                                     08890099
145800         DELETE FROM XLT_MAJ_CL                                   08900099
145900         WHERE                                                    08910099
146000               DEPT_NBR     =  :XLT00022-DEPT-NBR                 08920099
                 AND MAJ_CL_NBR   =  :XLT00022-MAJ-CL-NBR               08930099
146100         END-EXEC                                                 08940099
146200                                                                  08950099
146300         EVALUATE TRUE                                            08960099
146400             WHEN SQLCODE = ZERO                                  08970099
146500                 ADD 1                TO PV-XLT00022-DEL-COUNT    08980099
      *COMMIT DB2 DATA TO TABLES.                                       08990099
                       PERFORM 6000-DB2-COMMIT                          09000099
146600             WHEN SQLCODE = +100                                  09010099
146700                 ADD 1                TO PV-XLT00022-DELNF-COUNT  09020099
146800             WHEN SQLCODE = -904                                  09030099
146900             WHEN SQLCODE = -911                                  09040099
147000             WHEN SQLCODE = -913                                  09050099
147100                 CONTINUE                                         09060099
147200                                                                  09070099
147300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              09080099
147400                 DISPLAY '**************************************' 09090099
147500                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT_MAJ_CL' 09100099
147600                 DISPLAY 'DEPT-NBR    = ' XL039-MAJ-CL-DEPT-NBR   09110099
147600                 DISPLAY 'MAJ-CL-NBR  = ' XL039-MAJ-CL-NBR        09120099
147700                 DISPLAY '**********************************'     09130099
147800                 PERFORM 9800-SQL-WARNING                         09140099
147900                                                                  09150099
148000             WHEN SQLCODE < ZERO                                  09160099
148100                 DISPLAY '**************************************' 09170099
148200                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT_MAJ_CL'   09180099
147600                 DISPLAY 'DEPT-NBR    = ' XL039-MAJ-CL-DEPT-NBR   09190099
147600                 DISPLAY 'MAJ-CL-NBR  = ' XL039-MAJ-CL-NBR        09200099
148400                 DISPLAY '**************************************' 09210099
148500                 PERFORM 9900-SQL-ERROR                           09220099
148600                                                                  09230099
148700         END-EVALUATE                                             09240099
148800     END-PERFORM                                                  09250099
148900                                                                  09260099
149000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09270099
149100         SQLCODE NOT = ZERO                                       09280099
149200         DISPLAY '**************************************'         09290099
149300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         09300099
149400         DISPLAY 'DELETE FROM XLT_MAJ_CL                '         09310099
149500         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00022  '           09320099
147600         DISPLAY 'DEPT-NBR    = ' XL039-MAJ-CL-DEPT-NBR           09330099
147600         DISPLAY 'MAJ-CL-NBR  = ' XL039-MAJ-CL-NBR                09340099
149700         DISPLAY '**************************************'         09350099
149800         DISPLAY '**************************************'         09360099
149900         PERFORM 9900-SQL-ERROR                                   09370099
150000     END-IF.                                                      09380099
150100                                                                  09390099
150200                                                                  09400099
150300 7120-DELETE-SUB-CL.                                              09410099
150400     MOVE '7120-DELETE-SUB-CL'        TO PV-ABEND-PARAGRAPH.      09420099
150500                                                                  09430099
150600     MOVE XL039-SUB-CL-DEPT-NBR       TO XLT00023-DEPT-NBR        09440099
150600     MOVE XL039-SUB-CL-MAJ-CL-NBR     TO XLT00023-MAJ-CL-NBR      09450099
150600     MOVE XL039-SUB-CL-NBR            TO XLT00023-SUB-CL-NBR      09460099
150700                                                                  09470099
150800     PERFORM                                                      09480099
150900         WITH TEST AFTER                                          09490099
151000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09500099
151100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            09510099
151200                (SQLCODE = ZERO) OR (SQLCODE = +100))             09520099
151300                                                                  09530099
151400     EXEC SQL                                                     09540099
151500         DELETE FROM XLT_SUB_CL                                   09550099
151600         WHERE                                                    09560099
151700              DEPT_NBR     =  :XLT00023-DEPT-NBR                  09570099
                AND MAJ_CL_NBR   =  :XLT00023-MAJ-CL-NBR                09580099
                AND SUB_CL_NBR   =  :XLT00023-SUB-CL-NBR                09590099
151800         END-EXEC                                                 09600099
151900                                                                  09610099
152000         EVALUATE TRUE                                            09620099
152100             WHEN SQLCODE = ZERO                                  09630099
152200                 ADD 1                TO PV-XLT00023-DEL-COUNT    09640099
      *COMMIT DB2 DATA TO TABLES.                                       09650099
                       PERFORM 6000-DB2-COMMIT                          09660099
152300             WHEN SQLCODE = +100                                  09670099
152400                 ADD 1                TO PV-XLT00023-DELNF-COUNT  09680099
152500             WHEN SQLCODE = -904                                  09690099
152600             WHEN SQLCODE = -911                                  09700099
152700             WHEN SQLCODE = -913                                  09710099
152800                 CONTINUE                                         09720099
152900                                                                  09730099
153000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              09740099
153100                 DISPLAY '**************************************' 09750099
153200                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT_SUB_CL' 09760099
153300                 DISPLAY 'DEPT-NBR   = ' XL039-SUB-CL-DEPT-NBR    09770099
153300                 DISPLAY 'MAJ-CL-NBR = ' XL039-SUB-CL-MAJ-CL-NBR  09780099
153300                 DISPLAY 'SUB-CL-NBR = ' XL039-SUB-CL-NBR         09790099
153400                 DISPLAY '**********************************'     09800099
153500                 PERFORM 9800-SQL-WARNING                         09810099
153600                                                                  09820099
153700             WHEN SQLCODE < ZERO                                  09830099
153800                 DISPLAY '**************************************' 09840099
153900                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT_SUB_CL'   09850099
153300                 DISPLAY 'DEPT-NBR   = ' XL039-SUB-CL-DEPT-NBR    09860099
153300                 DISPLAY 'MAJ-CL-NBR = ' XL039-SUB-CL-MAJ-CL-NBR  09870099
153300                 DISPLAY 'SUB-CL-NBR = ' XL039-SUB-CL-NBR         09880099
154100                 DISPLAY '**************************************' 09890099
154200                 PERFORM 9900-SQL-ERROR                           09900099
154300                                                                  09910099
154400         END-EVALUATE                                             09920099
154500     END-PERFORM                                                  09930099
154600                                                                  09940099
154700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09950099
154800         SQLCODE NOT = ZERO                                       09960099
154900         DISPLAY '**************************************'         09970099
155000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         09980099
155100         DISPLAY 'DELETE FROM XLT_SUB_CL                '         09990099
155200         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00023  '           10000099
153300         DISPLAY 'DEPT-NBR   = ' XL039-SUB-CL-DEPT-NBR            10010099
153300         DISPLAY 'MAJ-CL-NBR = ' XL039-SUB-CL-MAJ-CL-NBR          10020099
153300         DISPLAY 'SUB-CL-NBR = ' XL039-SUB-CL-NBR                 10030099
155400         DISPLAY '**************************************'         10040099
155500         DISPLAY '**************************************'         10050099
155600         PERFORM 9900-SQL-ERROR                                   10060099
155700     END-IF.                                                      10070099
155800                                                                  10080099
196600****************************************************************  10090099
196700****** START OF CHANGE ROUTINES ******                            10100099
196800****************************************************************  10110099
      ******   IF ANY CHANGE GETS A SQLCODE OF +100 (NOT FOUND)         10120099
      ******   A RETURN CODE OF 4093 IS SET AND INFORMATION IS          10130099
      ******   DISPLAYED TO SYSOUT AND PROGRAM CONTINUES PROCESSING.    10140099
      ****************************************************************  10150099
196900                                                                  10160099
197000 7200-CHANGE-BUS-AREA.                                            10170099
197100     MOVE '7200-CHANGE-BUS-AREA'      TO PV-ABEND-PARAGRAPH.      10180099
197200                                                                  10190099
197300     MOVE XL039-AREA-ID               TO XLT00000-BUS-AREA-ID     10200099
197400     MOVE XL039-AREA-DESC             TO XLT00000-BUS-AREA-DESC   10210099
197500                                                                  10220099
197600                                                                  10230099
197700     PERFORM                                                      10240099
197800         WITH TEST AFTER                                          10250099
197900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10260099
198000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            10270099
198100                (SQLCODE = ZERO) OR (SQLCODE = +100) OR           10280099
                      (SQLCODE = -803))                                 10290099
198200                                                                  10300099
198300     EXEC SQL                                                     10310099
198400         UPDATE XLT_BUS_AREA                                      10320099
198500         SET                                                      10330099
198600              BUS_AREA_DESC  = :XLT00000-BUS-AREA-DESC            10340099
198700         WHERE                                                    10350099
198800              BUS_AREA_ID    = :XLT00000-BUS-AREA-ID              10360099
198900         END-EXEC                                                 10370099
199000                                                                  10380099
199100         EVALUATE TRUE                                            10390099
199200             WHEN SQLCODE = ZERO                                  10400099
199300                 ADD 1                TO PV-XLT00000-UPD-COUNT    10410099
      *COMMIT DB2 DATA TO TABLES.                                       10420099
                       PERFORM 6000-DB2-COMMIT                          10430099
199400             WHEN SQLCODE = +100                                  10440099
199500                 ADD 1                TO PV-XLT00000-NF-COUNT     10450099
                       SET PS-DPTCL-CHG-NF-YES TO TRUE                  10460099
200200                 DISPLAY '**************************************' 10470099
200300                 DISPLAY 'UPDATE OF BUS-AREA NOT FOUND  '         10480099
200400                 DISPLAY 'BUS-AREA-ID = '  XL039-AREA-ID          10490099
200500                 DISPLAY '**************************************' 10500099
037100             WHEN SQLCODE = -803                                  10510099
037200                 ADD 1                TO PV-XLT00000-DUP-COUNT    10520099
199600             WHEN SQLCODE = -904                                  10530099
199700             WHEN SQLCODE = -911                                  10540099
199800             WHEN SQLCODE = -913                                  10550099
199900                 CONTINUE                                         10560099
200000                                                                  10570099
200100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              10580099
200200                 DISPLAY '**************************************' 10590099
200300                 DISPLAY 'WARNING ISSUED ON UPDATE OF '           10600099
200300                 DISPLAY 'XLT_BUS_AREA '                          10610099
200400                 DISPLAY 'BUS-AREA-ID = ' XL039-AREA-ID           10620099
200500                 DISPLAY '**********************************'     10630099
200600                 PERFORM 9800-SQL-WARNING                         10640099
200700                                                                  10650099
200800             WHEN SQLCODE < ZERO                                  10660099
200900                 DISPLAY '**************************************' 10670099
201000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT_BUS_AREA' 10680099
201100                 DISPLAY 'BUS-AREA-ID = ' XL039-AREA-ID           10690099
201200                 DISPLAY '**************************************' 10700099
201300                 PERFORM 9900-SQL-ERROR                           10710099
201400                                                                  10720099
201500         END-EVALUATE                                             10730099
201600     END-PERFORM                                                  10740099
201700                                                                  10750099
201800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10760099
201900         SQLCODE NOT = ZERO                                       10770099
202000         DISPLAY '**************************************'         10780099
202100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         10790099
202200         DISPLAY 'UPDATE TO XLT_BUS_AREA                '         10800099
202300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00000  '           10810099
202400         DISPLAY 'BUS-AREA-ID = ' XL039-AREA-ID                   10820099
202500         DISPLAY '**************************************'         10830099
202600         DISPLAY '**************************************'         10840099
202700         PERFORM 9900-SQL-ERROR                                   10850099
202800     END-IF.                                                      10860099
202900                                                                  10870099
                                                                        10880099
203000 7205-CHANGE-BUS-GP.                                              10890099
203100     MOVE '7205-CHANGE-BUS-GP'        TO PV-ABEND-PARAGRAPH.      10900099
203200                                                                  10910099
203300     MOVE XL039-GROUP-NBR             TO XLT00001-BUS-GP-NBR      10920099
203400     MOVE XL039-GP-AREA-ID            TO XLT00001-BUS-AREA-ID     10930099
203400     MOVE XL039-GROUP-DESC            TO XLT00001-BUS-GP-DESC     10940099
203500                                                                  10950099
203600                                                                  10960099
203700     PERFORM                                                      10970099
203800         WITH TEST AFTER                                          10980099
203900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     10990099
204000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            11000099
204100                (SQLCODE = ZERO) OR (SQLCODE = -803))             11010099
204200                                                                  11020099
204300     EXEC SQL                                                     11030099
204400         UPDATE XLT_BUS_GP                                        11040099
204500         SET                                                      11050099
204600              BUS_AREA_ID    = :XLT00001-BUS-AREA-ID              11060099
204600             ,BUS_GP_DESC    = :XLT00001-BUS-GP-DESC              11070099
204700         WHERE                                                    11080099
204800              BUS_GP_NBR     = :XLT00001-BUS-GP-NBR               11090099
204900         END-EXEC                                                 11100099
205000                                                                  11110099
205100         EVALUATE TRUE                                            11120099
205200             WHEN SQLCODE = ZERO                                  11130099
205300                 ADD 1                TO PV-XLT00001-UPD-COUNT    11140099
      *COMMIT DB2 DATA TO TABLES.                                       11150099
                       PERFORM 6000-DB2-COMMIT                          11160099
205400             WHEN SQLCODE = +100                                  11170099
205500                 ADD 1                TO PV-XLT00001-NF-COUNT     11180099
                       SET PS-DPTCL-CHG-NF-YES TO TRUE                  11190099
206200                 DISPLAY '**************************************' 11200099
206300                 DISPLAY 'UPDATE OF BUS-GP-NBR  NOT FOUND     '   11210099
206400                 DISPLAY 'BUS-GP-NBR    =' XL039-GROUP-NBR        11220099
206500                 DISPLAY '**********************************'     11230099
037100             WHEN SQLCODE = -803                                  11240099
037200                 ADD 1                TO PV-XLT00001-DUP-COUNT    11250099
205600             WHEN SQLCODE = -904                                  11260099
205700             WHEN SQLCODE = -911                                  11270099
205800             WHEN SQLCODE = -913                                  11280099
205900                 CONTINUE                                         11290099
206000                                                                  11300099
206100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              11310099
206200                 DISPLAY '**************************************' 11320099
206300                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT_BUS_GP '11330099
206400                 DISPLAY 'BUS-GP-NBR    =' XL039-GROUP-NBR        11340099
206500                 DISPLAY '**********************************'     11350099
206600                 PERFORM 9800-SQL-WARNING                         11360099
206700                                                                  11370099
206800             WHEN SQLCODE < ZERO                                  11380099
206900                 DISPLAY '**************************************' 11390099
207000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT_BUS_GP'   11400099
207100                 DISPLAY 'BUS-GP-NBR    =' XL039-GROUP-NBR        11410099
207200                 DISPLAY '**************************************' 11420099
207300                 PERFORM 9900-SQL-ERROR                           11430099
207400                                                                  11440099
207500         END-EVALUATE                                             11450099
207600     END-PERFORM                                                  11460099
207700                                                                  11470099
207800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11480099
207900         SQLCODE NOT = ZERO                                       11490099
208000         DISPLAY '**************************************'         11500099
208100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         11510099
208200         DISPLAY 'UPDATE TO XLT_BUS_GP                  '         11520099
208300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00001  '           11530099
208400         DISPLAY 'BUS-GP-NBR    =' XL039-GROUP-NBR                11540099
208500         DISPLAY '**************************************'         11550099
208600         DISPLAY '**************************************'         11560099
208700         PERFORM 9900-SQL-ERROR                                   11570099
208800     END-IF.                                                      11580099
208900                                                                  11590099
209000 7210-CHANGE-DEPT.                                                11600099
209100     MOVE '7210-CHANGE-DEPT'          TO PV-ABEND-PARAGRAPH.      11610099
209200                                                                  11620099
209300     MOVE XL039-DEPT-NBR              TO XLT00002-DEPT-NBR        11630099
209400     MOVE XL039-DEPT-NAME             TO XLT00002-DEPT-NM         11640099
209400     MOVE XL039-MDSE-LNE-CDE          TO XLT00002-MDSE-LNE-CDE    11650099
209400     MOVE XL039-BUS-GP-NBR            TO XLT00002-BUS-GP-NBR      11660099
209400     MOVE XL039-STR-ZN-CDE            TO XLT00002-STR-ZN-CDE      11670099
209400     MOVE XL039-BYR-NBR               TO XLT00002-BYR-NBR         11680099
209400     MOVE XL039-DMA-NBR               TO XLT00002-DMA-NBR         11690099
209400     MOVE XL039-EXCLN-IND       TO XLT00002-CONT-CLR-EXCLN-IND    11700099
209500                                                                  11710099
209600                                                                  11720099
209700     PERFORM                                                      11730099
209800         WITH TEST AFTER                                          11740099
209900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11750099
210000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            11760099
210100                (SQLCODE = ZERO) OR (SQLCODE = +100) OR           11770099
                      (SQLCODE = -803))                                 11780099
210200                                                                  11790099
210300     EXEC SQL                                                     11800099
210400         UPDATE XLT_DEPT                                          11810099
210500         SET                                                      11820099
210600            DEPT_NM        = :XLT00002-DEPT-NM                    11830099
210600           ,MDSE_LNE_CDE   = :XLT00002-MDSE-LNE-CDE               11840099
210600           ,BUS_GP_NBR     = :XLT00002-BUS-GP-NBR                 11850099
210600           ,STR_ZN_CDE     = :XLT00002-STR-ZN-CDE                 11860099
210600           ,BYR_NBR        = :XLT00002-BYR-NBR                    11870099
210600           ,DMA_NBR        = :XLT00002-DMA-NBR                    11880099
210600           ,CONT_CLR_EXCLN_IND  = :XLT00002-CONT-CLR-EXCLN-IND    11890099
210700         WHERE                                                    11900099
210800              DEPT_NBR       = :XLT00002-DEPT-NBR                 11910099
210900         END-EXEC                                                 11920099
211000                                                                  11930099
211100         EVALUATE TRUE                                            11940099
211200             WHEN SQLCODE = ZERO                                  11950099
211300                 ADD 1                TO PV-XLT00002-UPD-COUNT    11960099
      *COMMIT DB2 DATA TO TABLES.                                       11970099
                       PERFORM 6000-DB2-COMMIT                          11980099
211400             WHEN SQLCODE = +100                                  11990099
211500                 ADD 1                TO PV-XLT00002-NF-COUNT     12000099
                       SET PS-DPTCL-CHG-NF-YES TO TRUE                  12010099
212200                 DISPLAY '**************************************' 12020099
212300                 DISPLAY 'UPDATE OF XLT_DEPT NOT FOUND        '   12030099
212400                 DISPLAY 'DEPT-NBR      =' XL039-DEPT-NBR         12040099
012500                 DISPLAY '**********************************'     12050099
037100             WHEN SQLCODE = -803                                  12060099
037200                 ADD 1                TO PV-XLT00002-DUP-COUNT    12070099
211600             WHEN SQLCODE = -904                                  12080099
211700             WHEN SQLCODE = -911                                  12090099
211800             WHEN SQLCODE = -913                                  12100099
211900                 CONTINUE                                         12110099
212000                                                                  12120099
212100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              12130099
212200                 DISPLAY '**************************************' 12140099
212300                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT_DEPT   '12150099
212400                 DISPLAY 'DEPT-NBR      =' XL039-DEPT-NBR         12160099
212500                 DISPLAY '**********************************'     12170099
212600                 PERFORM 9800-SQL-WARNING                         12180099
212700                                                                  12190099
212800             WHEN SQLCODE < ZERO                                  12200099
212900                 DISPLAY '**************************************' 12210099
213000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT_DEPT '    12220099
212400                 DISPLAY 'DEPT-NBR      =' XL039-DEPT-NBR         12230099
213200                 DISPLAY '**************************************' 12240099
213300                 PERFORM 9900-SQL-ERROR                           12250099
213400                                                                  12260099
213500         END-EVALUATE                                             12270099
213600     END-PERFORM                                                  12280099
213700                                                                  12290099
213800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    12300099
213900         SQLCODE NOT = ZERO                                       12310099
214000         DISPLAY '**************************************'         12320099
214100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         12330099
214200         DISPLAY 'UPDATE TO XLT_DEPT                    '         12340099
214300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00002  '           12350099
214400         DISPLAY 'DEPT-NBR      =' XL039-DEPT-NBR                 12360099
214500         DISPLAY '**************************************'         12370099
214600         DISPLAY '**************************************'         12380099
214700         PERFORM 9900-SQL-ERROR                                   12390099
214800     END-IF.                                                      12400099
214900                                                                  12410099
215000 7215-CHANGE-MAJ-CL.                                              12420099
215100     MOVE '7215-CHANGE-MAJ-CL'        TO PV-ABEND-PARAGRAPH.      12430099
215200                                                                  12440099
215300     MOVE XL039-MAJ-CL-DEPT-NBR       TO XLT00022-DEPT-NBR        12450099
215400     MOVE XL039-MAJ-CL-NBR            TO XLT00022-MAJ-CL-NBR      12460099
215500     MOVE XL039-MAJ-CL-NM             TO XLT00022-MAJ-CL-NM       12470099
215500     MOVE XL039-PUT-AWY-CDE           TO XLT00022-PUT-AWY-CDE     12480099
215600                                                                  12490099
215700                                                                  12500099
215800     PERFORM                                                      12510099
215900         WITH TEST AFTER                                          12520099
216000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     12530099
216100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            12540099
216200                (SQLCODE = ZERO) OR (SQLCODE = +100) OR           12550099
216300                (SQLCODE = -803))                                 12560099
                                                                        12570099
216400     EXEC SQL                                                     12580099
216500         UPDATE XLT_MAJ_CL                                        12590099
216600         SET                                                      12600099
216700              MAJ_CL_NM      = :XLT00022-MAJ-CL-NM                12610099
216700            , PUT_AWY_CDE    = :XLT00022-PUT-AWY-CDE              12620099
216900         WHERE                                                    12630099
217000              DEPT_NBR       = :XLT00022-DEPT-NBR                 12640099
                 AND MAJ_CL_NBR    = :XLT00022-MAJ-CL-NBR               12650099
                                                                        12660099
217100         END-EXEC                                                 12670099
217200                                                                  12680099
217300         EVALUATE TRUE                                            12690099
217400             WHEN SQLCODE = ZERO                                  12700099
217500                 ADD 1                TO PV-XLT00022-UPD-COUNT    12710099
      *COMMIT DB2 DATA TO TABLES.                                       12720099
                       PERFORM 6000-DB2-COMMIT                          12730099
217600             WHEN SQLCODE = +100                                  12740099
217700                 ADD 1                TO PV-XLT00022-NF-COUNT     12750099
                       SET PS-DPTCL-CHG-NF-YES TO TRUE                  12760099
218400                 DISPLAY '**************************************' 12770099
218500                 DISPLAY 'UPDATE OF XLT_MAJ_CL NOT FOUND '        12780099
218600                 DISPLAY 'DEPT-NBR      =' XL039-MAJ-CL-DEPT-NBR  12790099
                       DISPLAY 'MAJ-CL-NBR    =' XL039-MAJ-CL-NBR       12800099
                       DISPLAY 'MAJ-CL-NM     =' XL039-MAJ-CL-NM        12810099
218700                 DISPLAY '**********************************'     12820099
037100             WHEN SQLCODE = -803                                  12830099
037200                 ADD 1                TO PV-XLT00022-DUP-COUNT    12840099
217800             WHEN SQLCODE = -904                                  12850099
217900             WHEN SQLCODE = -911                                  12860099
218000             WHEN SQLCODE = -913                                  12870099
218100                 CONTINUE                                         12880099
218200                                                                  12890099
218300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              12900099
218400                 DISPLAY '**************************************' 12910099
218500                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT_MAJ_CL '12920099
218600                 DISPLAY 'DEPT-NBR      =' XL039-MAJ-CL-DEPT-NBR  12930099
                       DISPLAY 'MAJ-CL-NBR    =' XL039-MAJ-CL-NBR       12940099
                       DISPLAY 'MAJ-CL-NM     =' XL039-MAJ-CL-NM        12950099
                       DISPLAY 'PUT-AWY-CDE   =' XL039-PUT-AWY-CDE      12960099
218700                 DISPLAY '**********************************'     12970099
218800                 PERFORM 9800-SQL-WARNING                         12980099
218900                                                                  12990099
219000             WHEN SQLCODE < ZERO                                  13000099
219100                 DISPLAY '**************************************' 13010099
219200                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT_MAJ_CL'   13020099
218600                 DISPLAY 'DEPT-NBR      =' XL039-MAJ-CL-DEPT-NBR  13030099
                       DISPLAY 'MAJ-CL-NBR    =' XL039-MAJ-CL-NBR       13040099
                       DISPLAY 'MAJ-CL-NM     =' XL039-MAJ-CL-NM        13050099
                       DISPLAY 'PUT-AWY-CDE   =' XL039-PUT-AWY-CDE      13060099
219400                 DISPLAY '**************************************' 13070099
219500                 PERFORM 9900-SQL-ERROR                           13080099
219600                                                                  13090099
219700         END-EVALUATE                                             13100099
219800     END-PERFORM                                                  13110099
219900                                                                  13120099
220000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13130099
220100         SQLCODE NOT = ZERO                                       13140099
220200         DISPLAY '**************************************'         13150099
220300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         13160099
220400         DISPLAY 'UPDATE TO XLT_MAJ_CL                  '         13170099
220500         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00022  '           13180099
218600         DISPLAY 'DEPT-NBR      =' XL039-MAJ-CL-DEPT-NBR          13190099
               DISPLAY 'MAJ-CL-NBR    =' XL039-MAJ-CL-NBR               13200099
               DISPLAY 'MAJ-CL-NM     =' XL039-MAJ-CL-NM                13210099
               DISPLAY 'PUT-AWY-CDE   =' XL039-PUT-AWY-CDE              13220099
220700         DISPLAY '**************************************'         13230099
220800         DISPLAY '**************************************'         13240099
220900         PERFORM 9900-SQL-ERROR                                   13250099
221000     END-IF.                                                      13260099
221100                                                                  13270099
221200 7220-CHANGE-SUB-CL.                                              13280099
221300     MOVE '7220-CHANGE-SUB-CL'        TO PV-ABEND-PARAGRAPH.      13290099
221400                                                                  13300099
221500     MOVE XL039-SUB-CL-DEPT-NBR       TO XLT00023-DEPT-NBR        13310099
221600     MOVE XL039-SUB-CL-MAJ-CL-NBR     TO XLT00023-MAJ-CL-NBR      13320099
221700     MOVE XL039-SUB-CL-NBR            TO XLT00023-SUB-CL-NBR      13330099
221800     MOVE XL039-SUB-CL-NM             TO XLT00023-SUB-CL-NM       13340099
221800     MOVE XL039-SUB-CL-MDSE-DESC      TO XLT00023-POS-MDSE-DESC   13350099
221800     MOVE XL039-TAX-DFLT-IND          TO XLT00023-TAX-DFLT-IND    13360099
221800     MOVE XL039-DISC-ELIG-IND         TO XLT00023-DISC-ELIG-IND   13370099
221900                                                                  13380099
222000                                                                  13390099
222100     PERFORM                                                      13400099
222200         WITH TEST AFTER                                          13410099
222300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     13420099
222400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            13430099
222500                (SQLCODE = ZERO) OR (SQLCODE = +100) OR           13440099
                      (SQLCODE = -803))                                 13450099
222600                                                                  13460099
222700     EXEC SQL                                                     13470099
222800         UPDATE XLT_SUB_CL                                        13480099
222900         SET                                                      13490099
223000              SUB_CL_NM      = :XLT00023-SUB-CL-NM                13500099
223100         ,    POS_MDSE_DESC  = :XLT00023-POS-MDSE-DESC            13510099
223200         ,    TAX_DFLT_IND   = :XLT00023-TAX-DFLT-IND             13520099
223200         ,    DISC_ELIG_IND  = :XLT00023-DISC-ELIG-IND            13530099
223300         WHERE                                                    13540099
223400              DEPT_NBR       = :XLT00023-DEPT-NBR                 13550099
                 AND MAJ_CL_NBR    = :XLT00023-MAJ-CL-NBR               13560099
                 AND SUB_CL_NBR    = :XLT00023-SUB-CL-NBR               13570099
223500         END-EXEC                                                 13580099
223600                                                                  13590099
223700         EVALUATE TRUE                                            13600099
223800             WHEN SQLCODE = ZERO                                  13610099
223900                 ADD 1                TO PV-XLT00023-UPD-COUNT    13620099
      *COMMIT DB2 DATA TO TABLES.                                       13630099
                       PERFORM 6000-DB2-COMMIT                          13640099
224000             WHEN SQLCODE = +100                                  13650099
224100                 ADD 1                TO PV-XLT00023-NF-COUNT     13660099
                       SET PS-DPTCL-CHG-NF-YES TO TRUE                  13670099
224800                 DISPLAY '**************************************' 13680099
224900                 DISPLAY 'UPDATE OF XLT_SUB_CL NOT FOUND'         13690099
225000                 DISPLAY 'DEPT-NBR    =' XL039-SUB-CL-DEPT-NBR    13700099
                       DISPLAY 'MAJ-CL-NBR  =' XL039-SUB-CL-MAJ-CL-NBR  13710099
                       DISPLAY 'SUB-CL-NBR  =' XL039-SUB-CL-NBR         13720099
225100                 DISPLAY '**********************************'     13730099
037100             WHEN SQLCODE = -803                                  13740099
037200                 ADD 1                TO PV-XLT00023-DUP-COUNT    13750099
224200             WHEN SQLCODE = -904                                  13760099
224300             WHEN SQLCODE = -911                                  13770099
224400             WHEN SQLCODE = -913                                  13780099
224500                 CONTINUE                                         13790099
224600                                                                  13800099
224700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              13810099
224800                 DISPLAY '**************************************' 13820099
224900                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT_SUB_CL '13830099
225000                 DISPLAY 'DEPT-NBR    =' XL039-SUB-CL-DEPT-NBR    13840099
                       DISPLAY 'MAJ-CL-NBR  =' XL039-SUB-CL-MAJ-CL-NBR  13850099
                       DISPLAY 'SUB-CL-NBR  =' XL039-SUB-CL-NBR         13860099
225100                 DISPLAY '**********************************'     13870099
225200                 PERFORM 9800-SQL-WARNING                         13880099
225300                                                                  13890099
225400             WHEN SQLCODE < ZERO                                  13900099
225500                 DISPLAY '**************************************' 13910099
225600                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT_SUB_CL'   13920099
225000                 DISPLAY 'DEPT-NBR    =' XL039-SUB-CL-DEPT-NBR    13930099
                       DISPLAY 'MAJ-CL-NBR  =' XL039-SUB-CL-MAJ-CL-NBR  13940099
                       DISPLAY 'SUB-CL-NBR  =' XL039-SUB-CL-NBR         13950099
225800                 DISPLAY '**************************************' 13960099
225900                 PERFORM 9900-SQL-ERROR                           13970099
226000                                                                  13980099
226100         END-EVALUATE                                             13990099
226200     END-PERFORM                                                  14000099
226300                                                                  14010099
226400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    14020099
226500         SQLCODE NOT = ZERO                                       14030099
226600         DISPLAY '**************************************'         14040099
226700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         14050099
226800         DISPLAY 'UPDATE TO XLT_SUB_CL                  '         14060099
226900         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00023  '           14070099
225000         DISPLAY 'DEPT-NBR    =' XL039-SUB-CL-DEPT-NBR            14080099
               DISPLAY 'MAJ-CL-NBR  =' XL039-SUB-CL-MAJ-CL-NBR          14090099
               DISPLAY 'SUB-CL-NBR  =' XL039-SUB-CL-NBR                 14100099
227100         DISPLAY '**************************************'         14110099
227200         DISPLAY '**************************************'         14120099
227300         PERFORM 9900-SQL-ERROR                                   14130099
227400     END-IF.                                                      14140099
227500                                                                  14150099
280900/                                                                 14160099
281000                                                                  14170099
281100 8000-READ-TRANS-FILE.                                            14180099
281200     READ XL-TRANS-FILE                                           14190099
               INTO XL039-TRANS-REC                                     14200099
281400     AT END                                                       14210099
281500         SET PS-EOF-TRANS             TO TRUE                     14220099
               IF PS-DEPT-DEL-YES                                       14230099
                    OR PS-BUS-AREA-DEL-YES                              14240099
                    OR PS-BUS-GP-DEL-YES                                14250099
                    OR PS-MAJ-CL-DEL-YES                                14260099
                    OR PS-SUB-CL-DEL-YES                                14270099
                         MOVE 4092 TO RETURN-CODE                       14280099
               END-IF                                                   14290099
               IF PS-DPTCL-CHG-NF-YES                                   14300099
                   MOVE 4093 TO RETURN-CODE                             14310099
               END-IF                                                   14320099
281600     NOT AT END                                                   14330099
281700         ADD 1                        TO PV-TRANS-COUNT           14340099
281800     END-READ.                                                    14350099
281900/                                                                 14360099
282000 9000-EOJ.                                                        14370099
282100                                                                  14380099
282200     CLOSE XL-TRANS-FILE                                          14390099
282300     MOVE PV-TRANS-COUNT              TO PV-DISP-NBR              14400099
282400     DISPLAY 'TRANSACTIONS READ                 = ' PV-DISP-NBR   14410099
282500                                                                  14420099
282600     DISPLAY SPACES.                                              14430099
282700*  INSERT COUNTERS                                                14440099
282800     MOVE PV-XLT00000-INSERT-COUNT     TO PV-DISP-NBR             14450099
282900     DISPLAY 'BUS AREA ROWS INSERTED            = ' PV-DISP-NBR.  14460099
283000     MOVE PV-XLT00000-DUP-COUNT        TO PV-DISP-NBR             14470099
283100     DISPLAY 'DUPLICATE BUS AREA ROWS IGNORED   = ' PV-DISP-NBR.  14480099
283200                                                                  14490099
283300     MOVE PV-XLT00001-INSERT-COUNT     TO PV-DISP-NBR             14500099
283400     DISPLAY 'BUS GP ROWS INSERTED              = ' PV-DISP-NBR.  14510099
283500     MOVE PV-XLT00001-DUP-COUNT        TO PV-DISP-NBR             14520099
283600     DISPLAY 'DUPLICATE BUS-GP-ROWS IGNORED     = ' PV-DISP-NBR.  14530099
283700                                                                  14540099
283800     MOVE PV-XLT00002-INSERT-COUNT     TO PV-DISP-NBR             14550099
283900     DISPLAY 'DEPT ROWS INSERTED                = ' PV-DISP-NBR.  14560099
284000     MOVE PV-XLT00002-DUP-COUNT        TO PV-DISP-NBR             14570099
284100     DISPLAY 'DUPLICATE DEPT ROWS IGNORED       = ' PV-DISP-NBR.  14580099
284200                                                                  14590099
284300     MOVE PV-XLT00022-INSERT-COUNT     TO PV-DISP-NBR             14600099
284400     DISPLAY 'MAJ CL ROWS INSERTED              = ' PV-DISP-NBR.  14610099
284500     MOVE PV-XLT00022-DUP-COUNT        TO PV-DISP-NBR             14620099
284600     DISPLAY 'DUPLICATE MAJ CL ROWS IGNORED     = ' PV-DISP-NBR.  14630099
284700                                                                  14640099
284800     MOVE PV-XLT00023-INSERT-COUNT     TO PV-DISP-NBR             14650099
284900     DISPLAY 'SUB CL ROWS INSERTED              = ' PV-DISP-NBR.  14660099
285000     MOVE PV-XLT00023-DUP-COUNT        TO PV-DISP-NBR             14670099
285100     DISPLAY 'DUPLICATE SUB CL ROWS IGNORED     = ' PV-DISP-NBR.  14680099
285200                                                                  14690099
288700                                                                  14700099
288800                                                                  14710099
288900     DISPLAY SPACES.                                              14720099
289000*  DELETE COUNTERS                                                14730099
289100     MOVE PV-XLT00000-DEL-COUNT     TO PV-DISP-NBR                14740099
289200*    DISPLAY 'BUS AREA ROWS DELETED             = ' PV-DISP-NBR.  14750099
289200     DISPLAY 'BUS AREA ROWS FOUND TO DELETE     = ' PV-DISP-NBR.  14760099
289300     MOVE PV-XLT00000-DELNF-COUNT        TO PV-DISP-NBR           14770099
289400     DISPLAY 'BUS AREA ROWS NOT FOUND TO DELETE = ' PV-DISP-NBR.  14780099
289700                                                                  14790099
289800     MOVE PV-XLT00001-DEL-COUNT     TO PV-DISP-NBR                14800099
289900*    DISPLAY 'BUS GP ROWS DELETED               = ' PV-DISP-NBR.  14810099
289900     DISPLAY 'BUS GP ROWS FOUND TO DELETE       = ' PV-DISP-NBR.  14820099
290000     MOVE PV-XLT00001-DELNF-COUNT        TO PV-DISP-NBR           14830099
290100     DISPLAY 'BUS GP ROWS NOT FOUND TO DELETE   = ' PV-DISP-NBR.  14840099
290400                                                                  14850099
290500     MOVE PV-XLT00002-DEL-COUNT     TO PV-DISP-NBR                14860099
290600*    DISPLAY 'DEPT ROWS DELETED                 = ' PV-DISP-NBR.  14870099
289200     DISPLAY 'DEPT ROWS FOUND TO DELETE         = ' PV-DISP-NBR.  14880099
290700     MOVE PV-XLT00002-DELNF-COUNT        TO PV-DISP-NBR           14890099
290800     DISPLAY 'DEPT ROWS NOT FOUND TO DELETE     = ' PV-DISP-NBR.  14900099
291100                                                                  14910099
291200     MOVE PV-XLT00022-DEL-COUNT     TO PV-DISP-NBR                14920099
291300*    DISPLAY 'MAJ CL ROWS DELETED               = ' PV-DISP-NBR.  14930099
291300     DISPLAY 'MAJ CL ROWS FOUND TO DELETE       = ' PV-DISP-NBR.  14940099
291400     MOVE PV-XLT00022-DELNF-COUNT        TO PV-DISP-NBR           14950099
291500     DISPLAY 'MAJ CL ROWS NOT FOUND TO DELETE   = ' PV-DISP-NBR.  14960099
291800                                                                  14970099
291900     MOVE PV-XLT00023-DEL-COUNT     TO PV-DISP-NBR                14980099
292000*    DISPLAY 'SUB CL ROWS DELETED               = ' PV-DISP-NBR.  14990099
292000     DISPLAY 'SUB CL ROWS FOUND TO DELETE       = ' PV-DISP-NBR.  15000099
292100     MOVE PV-XLT00023-DELNF-COUNT        TO PV-DISP-NBR           15010099
292200     DISPLAY 'SUB CL ROWS NOT FOUND TO DELETE   = ' PV-DISP-NBR.  15020099
292500                                                                  15030099
  7600     DISPLAY SPACES.                                              15040099
297700*  UPDATE COUNTERS                                                15050099
297800     MOVE PV-XLT00000-UPD-COUNT     TO PV-DISP-NBR                15060099
297900     DISPLAY 'BUS AREA ROWS UPDATED             = ' PV-DISP-NBR.  15070099
298000     MOVE PV-XLT00000-NF-COUNT        TO PV-DISP-NBR              15080099
298100     DISPLAY 'BUS AREA ROWS NOT FOUND TO UPDATE = ' PV-DISP-NBR.  15090099
298200                                                                  15100099
298300     MOVE PV-XLT00001-UPD-COUNT     TO PV-DISP-NBR                15110099
298400     DISPLAY 'BUS GP ROWS UPDATED               = ' PV-DISP-NBR.  15120099
298500     MOVE PV-XLT00001-NF-COUNT        TO PV-DISP-NBR              15130099
298600     DISPLAY 'BUS GP ROWS NOT FOUND TO UPDATE   = ' PV-DISP-NBR.  15140099
298700                                                                  15150099
298800     MOVE PV-XLT00002-UPD-COUNT     TO PV-DISP-NBR                15160099
298900     DISPLAY 'DEPT ROWS UPDATED                 = ' PV-DISP-NBR.  15170099
299000     MOVE PV-XLT00002-NF-COUNT        TO PV-DISP-NBR              15180099
299100     DISPLAY 'DEPT ROWS NOT FOUND TO UPDATE     = ' PV-DISP-NBR.  15190099
299200                                                                  15200099
299300     MOVE PV-XLT00022-UPD-COUNT     TO PV-DISP-NBR                15210099
299400     DISPLAY 'MAJ CL ROWS UPDATED               = ' PV-DISP-NBR.  15220099
299500     MOVE PV-XLT00022-NF-COUNT        TO PV-DISP-NBR              15230099
299600     DISPLAY 'MAJ CL ROWS NOT FOUND TO UPDATE   = ' PV-DISP-NBR.  15240099
299700                                                                  15250099
299800     MOVE PV-XLT00023-UPD-COUNT     TO PV-DISP-NBR                15260099
299900     DISPLAY 'SUB CL ROWS UPDATED               = ' PV-DISP-NBR.  15270099
300000     MOVE PV-XLT00023-NF-COUNT        TO PV-DISP-NBR              15280099
300100     DISPLAY 'SUB CL ROWS NOT FOUND TO UPDATE   = ' PV-DISP-NBR.  15290099
300200                                                                  15300099
303700                                                                  15310099
303800     DISPLAY SPACES                                               15320099
297700*  COMMIT COUNTER                                                 15330099
303900     MOVE PV-COMMIT-COUNT             TO PV-DISP-NBR              15340099
304000     DISPLAY 'COMMITS TAKEN                     = ' PV-DISP-NBR.  15350099
304100                                                                  15360099
304200 9800-SQL-WARNING.                                                15370099
304300                                                                  15380099
            MOVE PV-TRANS-COUNT        TO PV-DISP-NBR.                  15390099
304400      MOVE SQLCODE               TO SQLCODE2.                     15400099
304500      MOVE SQLERRD(3)            TO SQLERRD3.                     15410099
304600      DISPLAY '** ABEND **       ** = SQLWARNING'.                15420099
304700      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.          15430099
304800      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       15440099
304900      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 15450099
305000      DISPLAY '** RECORDS READ   ** = ' PV-DISP-NBR.              15460099
305100      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 15470099
305200      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 15480099
305300      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 15490099
305400      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 15500099
305500      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 15510099
305600      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 15520099
305700      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 15530099
305800      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 15540099
305900                                                                  15550099
306000      MOVE 4013                  TO PV-ABEND-CODE                 15560099
306100      CALL 'ILBOABN0' USING PV-ABEND-CODE.                        15570099
306200                                                                  15580099
306300 9900-SQL-ERROR.                                                  15590099
306400                                                                  15600099
            MOVE PV-TRANS-COUNT        TO PV-DISP-NBR.                  15610099
306500      MOVE SQLCODE               TO SQLCODE2.                     15620099
306600      MOVE SQLERRD(3)            TO SQLERRD3.                     15630099
306700      DISPLAY '** ABEND **       ** = SQLERROR'.                  15640099
306800      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.          15650099
306900      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       15660099
307000      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 15670099
307100      DISPLAY '** RECORDS READ   ** = ' PV-DISP-NBR.              15680099
307200      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  15690099
307300      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 15700099
307400                                                                  15710099
307500      MOVE 4013                  TO PV-ABEND-CODE                 15720099
307600      CALL 'ILBOABN0' USING PV-ABEND-CODE.                        15730099
