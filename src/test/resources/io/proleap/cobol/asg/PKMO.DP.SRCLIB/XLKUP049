000100 IDENTIFICATION DIVISION.                                         00010010
000200 TITLE 'PURGE BRAND FROM XLT_BRND TABLE'.                         00020011
000300                                                                  00030011
000400 PROGRAM-ID.             XLKUP049.                                00040011
000500 AUTHOR.                 CHERI PARMLEY                            00050011
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060011
000700 DATE-WRITTEN            JULY, 2015.                              00070011
000800 DATE-COMPILED.                                                   00080011
000900******************************************************************00090011
000910* CHANGE DESCRIPTION                                              00091011
000920******************************************************************00092011
000930* DATE  04/08/2016                                                00093011
000940*  REMOVE SETTING OF THE 4095 RETURN CODE TO SEND EMAIL OF        00094011
000950*  BRANDS DELETED.                                                00095011
000960*  MADE BY: CHERI PARMLEY           TKID:TKMAF76                  00096011
000970*                                                                 00097011
000980******************************************************************00098011
001000 ENVIRONMENT DIVISION.                                            00100001
001100 CONFIGURATION SECTION.                                           00110001
001200 SOURCE-COMPUTER.        IBM-3090.                                00120001
001300 OBJECT-COMPUTER.        IBM-3090.                                00130001
001400 INPUT-OUTPUT SECTION.                                            00140001
001500                                                                  00150001
001600 FILE-CONTROL.                                                    00160001
001700                                                                  00170001
001800     SELECT XL-TRANS-FILE                                         00180001
001900         ASSIGN TO INP01.                                         00190001
002000                                                                  00200001
002010     SELECT DELETE-FILE                                           00201001
002020         ASSIGN TO OUT01.                                         00202001
002030                                                                  00203001
002100 DATA DIVISION.                                                   00210001
002200 FILE SECTION.                                                    00220001
002300                                                                  00230001
002400                                                                  00240001
002500 FD  XL-TRANS-FILE                                                00250001
002600     RECORDING MODE IS F                                          00260001
002700     LABEL RECORDS ARE STANDARD                                   00270001
002800     RECORD CONTAINS 50 CHARACTERS                                00280001
002900     BLOCK CONTAINS 0  RECORDS.                                   00290001
003000 01  XL-TRANS-REC                     PIC X(50).                  00300001
003100                                                                  00310001
003110 FD  DELETE-FILE                                                  00311002
003120     RECORDING MODE IS F                                          00312001
003130     BLOCK CONTAINS 0 RECORDS                                     00313001
003140     LABEL RECORDS ARE STANDARD.                                  00314001
003150                                                                  00315001
003160 01  DELETE-RECORD                PIC X(50).                      00316002
003170                                                                  00317001
003200 WORKING-STORAGE SECTION.                                         00320001
003300 01  WS-DB2-BEG-DATE.                                             00330001
003400     05  WS-DB2-BEG-YY           PIC X(04)  VALUE SPACES.         00340001
003500     05  FILLER                  PIC X(01)  VALUE '-'.            00350001
003600     05  WS-DB2-BEG-MM           PIC X(02)  VALUE SPACES.         00360001
003700     05  FILLER                  PIC X(01)  VALUE '-'.            00370001
003800     05  WS-DB2-BEG-DD           PIC X(02)  VALUE SPACES.         00380001
003900                                                                  00390001
004000 01  WS-EFF-BEG-DTE.                                              00400001
004100     05  WS-EFF-BEG-YY           PIC X(04)  VALUE SPACES.         00410001
004200     05  WS-EFF-BEG-MM           PIC X(02)  VALUE SPACES.         00420001
004300     05  WS-EFF-BEG-DD           PIC X(02)  VALUE SPACES.         00430001
004400                                                                  00440001
004500 01  WS-DB2-END-DATE.                                             00450001
004600     05  WS-DB2-END-YY           PIC X(04)  VALUE SPACES.         00460001
004700     05  FILLER                  PIC X(01)  VALUE '-'.            00470001
004800     05  WS-DB2-END-MM           PIC X(02)  VALUE SPACES.         00480001
004900     05  FILLER                  PIC X(01)  VALUE '-'.            00490001
005000     05  WS-DB2-END-DD           PIC X(02)  VALUE SPACES.         00500001
005100                                                                  00510001
005200 01  WS-EFF-END-DTE.                                              00520001
005300     05  WS-EFF-END-YY           PIC X(04)  VALUE SPACES.         00530001
005400     05  WS-EFF-END-MM           PIC X(02)  VALUE SPACES.         00540001
005500     05  WS-EFF-END-DD           PIC X(02)  VALUE SPACES.         00550001
005600                                                                  00560001
005700 01  PS-SWITCHES.                                                 00570001
005800     05  PS-EOF-TRANS-SW              PIC X(01) VALUE 'N'.        00580001
005900         88  PS-EOF-TRANS                       VALUE 'Y'.        00590001
006000                                                                  00600001
006100     05  PS-COMMIT-SW                 PIC X(01) VALUE SPACE.      00610001
006200         88  PS-COMMIT-NOW                      VALUE 'Y'.        00620001
006300         88  PS-AINT-TIME-YET-TO-COMMIT         VALUE 'N'.        00630001
006400                                                                  00640001
006500     05  PS-SKU-ASSN-CHG-NF-SW        PIC X(01) VALUE 'N'.        00650001
006600         88  PS-SKU-ASSN-CHG-NF-YES             VALUE 'Y'.        00660001
006700         88  PS-SKU-ASSN-CHG-NF-NO              VALUE 'N'.        00670001
006800                                                                  00680001
006810     05  PS-EXISTS                    PIC S9 COMP-3 VALUE ZERO.   00681002
006820         88  PS-ROW-EXISTS-YES              VALUE 1.              00682002
006830         88  PS-ROW-EXISTS-NO               VALUE ZERO.           00683002
006900                                                                  00690001
006910     05  PS-EMAIL-SW                  PIC X(01)  VALUE 'N'.       00691002
006920         88  PS-EMAIL-YES                        VALUE 'Y'.       00692002
006930         88  PS-EMAIL-NO                         VALUE 'N'.       00693002
006940                                                                  00694002
007000 01  PV-COUNTERS COMP-3.                                          00700001
007100     05  PV-RETRY-COUNTER             PIC S9(03) VALUE ZERO.      00710001
007200     05  PV-COMMIT-COUNT              PIC S9(07) VALUE ZERO.      00720001
007300     05  PV-TRANS-COUNT               PIC S9(07) VALUE ZERO.      00730001
007400     05  PV-WRITE-COUNT               PIC S9(07) VALUE ZERO.      00740001
007500                                                                  00750001
007800     05  PV-XLT00043-DEL-COUNT        PIC S9(07) VALUE ZERO.      00780002
007900     05  PV-XLT00043-DELNF-COUNT      PIC S9(07) VALUE ZERO.      00790002
008100     05  PV-XLT00043-532-COUNT        PIC S9(07) VALUE ZERO.      00810002
008200     05  PV-DEL-RECORDS-WRITTEN       PIC S9(07) VALUE ZERO.      00820002
008400                                                                  00840001
008500 01  PV-OTHER-STUFF.                                              00850001
008600     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'XLKUP049'.00860001
008700     05  PC-TABLE-NAME                PIC X(08)  VALUE            00870002
008800                                               'XLT_BRND'.        00880002
008900     05  PV-TMST                      PIC X(26)  VALUE SPACES.    00890001
009000     05  PV-HOLD-TMST                 PIC X(26)  VALUE SPACES.    00900001
009100     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00910001
009200                                                 COMP.            00920001
009300     05  PV-ABEND-CODE                PIC S9(04) COMP SYNC        00930001
009400                                                 VALUE ZERO.      00940001
009500     05  PV-CURRENT-TMST              PIC X(26)  VALUE SPACES.    00950001
009600     05  PV-DISP-NBR                  PIC Z,ZZZ,ZZ9.              00960001
009610     05  PV-BRND-ID                   PIC 9(05)  VALUE ZERO.      00961011
009700                                                                  00970001
009800 01  PV-ABEND-FIELDS.                                             00980001
009900     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'XLKUP049'.00990001
010000     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01000001
010100     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01010001
010200     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01020001
010300     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01030001
010400     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01040001
010500     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    01050001
010600     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01060001
010700     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01070001
010800     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01080001
010900     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01090001
011000     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      01100001
011100                                                                  01110001
011200 01  DK-RECORD-KEY.                                               01120004
011300     05  DK-BRND-ID              PIC S9(04) COMP.                 01130004
012000/                                                                 01200001
012100*    TRANSACTION RECORD                                           01210001
012110 01  XL065-RECORD.                                                01211002
012200     COPY XLRD065.                                                01220002
012300/                                                                 01230001
012400*  USED FOR DB2 ERROR MESSAGE BUILDING                            01240001
012500     COPY DPWS004.                                                01250001
012600                                                                  01260001
012700*   DB2 SQL COMMUNICATION AREA                                    01270001
012800     EXEC SQL                                                     01280001
012900          INCLUDE SQLCA                                           01290001
013000     END-EXEC.                                                    01300001
013100     COPY SQLCA2.                                                 01310001
013200/                                                                 01320001
013210*    XLT_VND_STYL                                                 01321005
013220     EXEC SQL                                                     01322005
013230          INCLUDE XLT00004                                        01323005
013240     END-EXEC.                                                    01324005
013250                                                                  01325005
013300*    XLT_BRND                                                     01330002
013400     EXEC SQL                                                     01340001
013500          INCLUDE XLT00043                                        01350002
013600     END-EXEC.                                                    01360001
013700/                                                                 01370001
013800 PROCEDURE DIVISION.                                              01380001
013900     PERFORM 1000-INITIALIZE.                                     01390001
014000     PERFORM 2000-PROCESS UNTIL PS-EOF-TRANS.                     01400001
014100     PERFORM 9000-EOJ.                                            01410001
014200     GOBACK.                                                      01420001
014300                                                                  01430001
014400 1000-INITIALIZE.                                                 01440001
014500                                                                  01450001
014510     SET PS-EMAIL-NO      TO TRUE.                                01451002
014520                                                                  01452002
014600     OPEN INPUT XL-TRANS-FILE                                     01460001
014610     OPEN OUTPUT DELETE-FILE                                      01461001
014700     PERFORM 8000-READ-TRANS-FILE.                                01470001
014800     IF PS-EOF-TRANS                                              01480001
014900         DISPLAY ALL '*'                                          01490001
015000         DISPLAY '**  INP01 TRANS FILE IS EMPTY **'               01500001
015100         DISPLAY ALL '*'                                          01510001
015200     END-IF.                                                      01520001
015300                                                                  01530001
015400 2000-PROCESS.                                                    01540001
015500                                                                  01550001
015600     MOVE XL065-BRND-ID        TO XLT00043-BRND-ID                01560002
015610                                  PV-BRND-ID                      01561011
015700                                  DK-BRND-ID.                     01570004
015800                                                                  01580001
015900     PERFORM 7000-CHECK-IF-STYL-EXISTS.                           01590002
016000     IF PS-ROW-EXISTS-NO                                          01600002
018100         PERFORM 7100-DELETE-BRAND                                01810002
018110         PERFORM 8100-WRITE-RECORD                                01811002
018200     END-IF.                                                      01820002
018500                                                                  01850001
018600     PERFORM 8000-READ-TRANS-FILE.                                01860001
018700                                                                  01870001
018800******************************************************************01880001
018900* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     01890001
019000******************************************************************01900001
019100 6000-DB2-COMMIT.                                                 01910001
019200                                                                  01920001
019300     EXEC SQL                                                     01930001
019400         COMMIT                                                   01940001
019500     END-EXEC.                                                    01950001
019600                                                                  01960001
019700     EVALUATE TRUE                                                01970001
019800         WHEN SQLCODE = +0                                        01980001
019900              ADD +1  TO PV-COMMIT-COUNT                          01990001
020000         WHEN SQLWARN0 NOT = SPACES                               02000001
020100         WHEN SQLCODE  NOT = ZERO                                 02010001
020200         DISPLAY '****************************'                   02020001
020300         DISPLAY '** ABEND                  **'                   02030001
020400         DISPLAY '** PROGRAM = XLKUP049     **'                   02040001
020500         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   02050001
020600         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   02060001
020700         DISPLAY '****************************'                   02070001
020800         PERFORM 9900-SQL-ERROR                                   02080001
020900     END-EVALUATE.                                                02090001
021000                                                                  02100001
021100******************************************************************02110002
021200 7000-CHECK-IF-STYL-EXISTS.                                       02120002
021300******************************************************************02130002
021400                                                                  02140002
021500*SELECT  VENDOR STYLE RECORD.                                     02150002
021600                                                                  02160002
021610       SET PS-ROW-EXISTS-YES TO TRUE.                             02161002
021620                                                                  02162002
021700       EXEC SQL                                                   02170002
021800           SELECT 1                                               02180002
022200           INTO                                                   02220002
022300                :PS-EXISTS                                        02230002
022600           FROM XLT_VND_STYL                                      02260002
022700           WHERE BRND_ID  =  :DK-BRND-ID                          02270002
022800       END-EXEC                                                   02280002
022810                                                                  02281002
022900     EVALUATE TRUE                                                02290002
023000         WHEN SQLCODE = ZERO                                      02300002
023001*CHG0140569 - START                                               02300110
023010         WHEN SQLCODE = -811                                      02301009
023020*CHG0140569 - END                                                 02302010
023100              CONTINUE                                            02310002
023600         WHEN SQLCODE = +100                                      02360002
023700              SET  PS-ROW-EXISTS-NO TO TRUE                       02370002
023800         WHEN SQLWARN0 NOT = SPACE                                02380002
023900         WHEN SQLCODE  NOT = +0                                   02390002
024000                 DISPLAY '**************************************' 02400002
024100                 DISPLAY 'ERROR ISSUED ON READ                  ' 02410002
024200                 DISPLAY 'XLT_VND_STYL                          ' 02420002
024300                 DISPLAY 'BRAND KEY = '  PV-BRND-ID               02430004
024400                 DISPLAY '**************************************' 02440002
024500                 PERFORM 9900-SQL-ERROR                           02450002
024600     END-EVALUATE.                                                02460002
024700                                                                  02470002
028200****************************************************************  02820001
028300****** DELETE XLT_BRND         ******                             02830002
028400****************************************************************  02840001
028500                                                                  02850001
028600 7100-DELETE-BRAND.                                               02860002
028700     MOVE '7000-DELETE-BRAND       '  TO PV-ABEND-PARAGRAPH.      02870002
028800                                                                  02880001
028900                                                                  02890001
029000     PERFORM                                                      02900001
029100         WITH TEST AFTER                                          02910001
029200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     02920001
029300         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            02930001
029400                (SQLCODE = ZERO OR +100 OR -532)                  02940001
029500                                                                  02950001
029600     EXEC SQL                                                     02960001
029700         DELETE FROM XLT_BRND                                     02970002
029800         WHERE                                                    02980001
029900              BRND_ID        = :XLT00043-BRND-ID                  02990002
030300         END-EXEC                                                 03030001
030400                                                                  03040001
030500         EVALUATE TRUE                                            03050001
030600             WHEN SQLCODE = ZERO                                  03060001
030700                 ADD 1                TO PV-XLT00043-DEL-COUNT    03070002
030800*COMMIT DB2 DATA TO TABLES.                                       03080001
030900                 PERFORM 6000-DB2-COMMIT                          03090001
031000             WHEN SQLCODE = +100                                  03100001
031100                 ADD 1                TO PV-XLT00043-DELNF-COUNT  03110002
031200             WHEN SQLCODE = -532                                  03120001
031300                 ADD 1                TO PV-XLT00043-532-COUNT    03130002
031400             WHEN SQLCODE = -904                                  03140001
031500             WHEN SQLCODE = -911                                  03150001
031600             WHEN SQLCODE = -913                                  03160001
031700                 CONTINUE                                         03170001
031800                                                                  03180001
031900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              03190001
032000                 DISPLAY '**************************************' 03200001
032100                 DISPLAY 'WARNING ISSUED ON DELETE OF           ' 03210001
032200                 DISPLAY 'XLT_BRND                              ' 03220002
032300                 DISPLAY 'BRAND ID = '  PV-BRND-ID                03230004
032400                 DISPLAY '**************************************' 03240001
032500                 PERFORM 9800-SQL-WARNING                         03250001
032600                                                                  03260001
032700             WHEN SQLCODE < ZERO                                  03270001
032800                 DISPLAY '**************************************' 03280001
032900                 DISPLAY 'ERROR ISSUED ON DELETE OF             ' 03290001
033000                 DISPLAY 'XLT_BRND                              ' 03300002
033100                 DISPLAY 'BRAND ID= '  PV-BRND-ID                 03310004
033200                 DISPLAY '**************************************' 03320001
033300                 PERFORM 9900-SQL-ERROR                           03330001
033400                                                                  03340001
033500         END-EVALUATE                                             03350001
033600     END-PERFORM                                                  03360001
033700                                                                  03370001
033800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    03380001
033900         SQLCODE NOT = ZERO                                       03390001
034000         DISPLAY '**************************************'         03400001
034100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         03410001
034200         DISPLAY 'DELETE TO XLT_BRND                    '         03420002
034300         DISPLAY 'BRAND ID   = '  PV-BRND-ID                      03430004
034400         DISPLAY '**************************************'         03440001
034500         PERFORM 9900-SQL-ERROR                                   03450001
034600     END-IF.                                                      03460001
034700                                                                  03470001
041600                                                                  04160001
041700                                                                  04170001
041800 8000-READ-TRANS-FILE.                                            04180001
041900     READ XL-TRANS-FILE                                           04190001
042000         INTO XL065-RECORD                                        04200003
042100     AT END                                                       04210001
042200         SET PS-EOF-TRANS             TO TRUE                     04220001
042600     NOT AT END                                                   04260001
042700         ADD 1                        TO PV-TRANS-COUNT           04270001
042800     END-READ.                                                    04280001
042900/                                                                 04290001
042910***************************************************************** 04291002
042920*  WRITE A LOGISTIC RECORD TO THE DELETE FILE                     04292002
042930***************************************************************** 04293002
042940 8100-WRITE-RECORD.                                               04294002
042950                                                                  04295002
042960     WRITE DELETE-RECORD FROM                                     04296002
042970         XL065-RECORD                                             04297002
042980     END-WRITE.                                                   04298002
042990     ADD +1                 TO PV-DEL-RECORDS-WRITTEN.            04299002
042991                                                                  04299102
042992*    SET SWITCH FOR E-MAIL NOTIFICATION OF ERRORS.                04299202
042993     SET PS-EMAIL-YES       TO TRUE.                              04299302
043000 9000-EOJ.                                                        04300001
043100                                                                  04310001
043200     CLOSE XL-TRANS-FILE                                          04320001
043210     CLOSE DELETE-FILE                                            04321001
043300                                                                  04330001
043400     DISPLAY '**************************************************'.04340001
043500     DISPLAY '* PROGRAM.......: ' PC-PROGRAM-NAME.                04350001
043600     DISPLAY '* TABLE.........: ' PC-TABLE-NAME.                  04360001
043700     DISPLAY '**************************************************'.04370001
043800                                                                  04380001
043900     DISPLAY SPACES.                                              04390001
044000     MOVE PV-TRANS-COUNT              TO PV-DISP-NBR              04400001
044100     DISPLAY 'TRANSACTIONS READ                 = ' PV-DISP-NBR   04410001
044200                                                                  04420001
045200     DISPLAY SPACES.                                              04520001
045300*  DELETE COUNTERS                                                04530001
045400     MOVE PV-XLT00043-DEL-COUNT     TO PV-DISP-NBR                04540003
045500     DISPLAY 'BRAND ROWS FOUND TO DELETE     = ' PV-DISP-NBR.     04550006
045600     MOVE PV-XLT00043-DELNF-COUNT        TO PV-DISP-NBR           04560003
045700     DISPLAY 'BRAND ROWS NOT FOUND TO DELETE = ' PV-DISP-NBR.     04570006
045800     MOVE PV-XLT00043-532-COUNT          TO PV-DISP-NBR           04580003
045900     DISPLAY 'BRAND ROWS DELETE RESTRICTED   = ' PV-DISP-NBR.     04590006
046000                                                                  04600001
046100     DISPLAY SPACES.                                              04610001
046900*  COMMIT COUNTER                                                 04690001
047000     MOVE PV-COMMIT-COUNT             TO PV-DISP-NBR              04700001
047100     DISPLAY 'COMMITS TAKEN                     = ' PV-DISP-NBR.  04710001
047200                                                                  04720001
047300     DISPLAY SPACES                                               04730001
047310     DISPLAY 'DELETE RECORDS WRITTEN TO FILE    = '               04731002
047320                                        PV-DEL-RECORDS-WRITTEN.   04732002
047400     DISPLAY '**************************************************'.04740001
047401                                                                  04740101
047402*CLP 04/08/2016 - NO NEED FOR ADDITIONAL EMAIL                    04740207
047410*    SET RETURN CODE IF E-MAIL SWITCH IS TRUE.                    04741001
047420*    IF PS-EMAIL-YES                                              04742007
047430*        MOVE 4095 TO RETURN-CODE                                 04743007
047440*    END-IF.                                                      04744007
047500                                                                  04750001
047600 9800-SQL-WARNING.                                                04760001
047700                                                                  04770001
047800      MOVE PV-TRANS-COUNT        TO PV-DISP-NBR.                  04780001
047900      MOVE SQLCODE               TO SQLCODE2.                     04790001
048000      MOVE SQLERRD(3)            TO SQLERRD3.                     04800001
048100      DISPLAY '** ABEND **       ** = SQLWARNING'.                04810001
048200      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.          04820001
048300      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       04830001
048400      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 04840001
048500      DISPLAY '** RECORDS READ   ** = ' PV-DISP-NBR.              04850001
048600      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 04860001
048700      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 04870001
048800      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 04880001
048900      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 04890001
049000      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 04900001
049100      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 04910001
049200      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 04920001
049300      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 04930001
049400                                                                  04940001
049500      MOVE 4013                  TO PV-ABEND-CODE                 04950001
049600      CALL 'ILBOABN0' USING PV-ABEND-CODE.                        04960001
049700                                                                  04970001
049800 9900-SQL-ERROR.                                                  04980001
049900                                                                  04990001
050000      MOVE PV-TRANS-COUNT        TO PV-DISP-NBR.                  05000001
050100      MOVE SQLCODE               TO SQLCODE2.                     05010001
050200      MOVE SQLERRD(3)            TO SQLERRD3.                     05020001
050300      DISPLAY '** ABEND **       ** = SQLERROR'.                  05030001
050400      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.          05040001
050500      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       05050001
050600      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 05060001
050700      DISPLAY '** RECORDS READ   ** = ' PV-DISP-NBR.              05070001
050800      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  05080001
050900      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 05090001
051000                                                                  05100001
051100      MOVE 4013                  TO PV-ABEND-CODE                 05110001
051200      CALL 'ILBOABN0' USING PV-ABEND-CODE.                        05120001
