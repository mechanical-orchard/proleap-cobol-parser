000100***************************************************************** 00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300***************************************************************** 00030099
000400                                                                  00040099
000500 PROGRAM-ID.             PCKRP007.                                00050099
000600 AUTHOR.                 DAVE PHELPS - KOHLS.                     00060099
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070099
000800 DATE-WRITTEN            APRIL, 1997                              00080099
000900 DATE-COMPILED.                                                   00090099
001000***************************************************************** 00100099
001100***************************************************************** 00110099
001200*                                                               * 00120099
001300*  THIS PROGRAM WILL PRINT THE PACK TO LIGHT VERIFICATION       * 00130099
001400*  EXCEPTIONS REPORT.                                           * 00140099
001500***************************************************************** 00150099
001600*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00160099
001700*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00170099
001800*                                                               * 00180099
001900***************************************************************** 00190099
002000***************************************************************** 00200099
002100 ENVIRONMENT DIVISION.                                            00210099
002200***************************************************************** 00220099
002300                                                                  00230099
002400 CONFIGURATION SECTION.                                           00240099
002500                                                                  00250099
002600 SOURCE-COMPUTER.        IBM-3090.                                00260099
002700 OBJECT-COMPUTER.        IBM-3090.                                00270099
002800                                                                  00280099
002900 INPUT-OUTPUT SECTION.                                            00290099
003000                                                                  00300099
003100 FILE-CONTROL.                                                    00310099
003200*                                                                 00320099
003300     SELECT EXTRACT-FILE                                          00330099
003400         ASSIGN TO INP01.                                         00340099
003500                                                                  00350099
003600     SELECT PC-CURRENT-ON-HAND-RPT                                00360099
003700         ASSIGN TO RPT01.                                         00370099
003800*                                                                 00380099
003900***************************************************************** 00390099
004000 DATA DIVISION.                                                   00400099
004100***************************************************************** 00410099
004200*                                                                 00420099
004300 FILE SECTION.                                                    00430099
004400*                                                                 00440099
004500 FD  EXTRACT-FILE                                                 00450099
004600     LABEL RECORDS ARE STANDARD                                   00460099
004700     RECORDING MODE IS F                                          00470099
004800     BLOCK CONTAINS 0 RECORDS                                     00480099
004900     RECORD CONTAINS 200 CHARACTERS.                              00490099
005000 01  EXTRACT-RECORD                  PIC X(200).                  00500099
005100                                                                  00510099
005200 FD  PC-CURRENT-ON-HAND-RPT                                       00520099
005300     RECORDING MODE IS F                                          00530099
005400     BLOCK CONTAINS 0  RECORDS.                                   00540099
005500 01  PC-CURRENT-ON-HAND-RECORD       PIC  X(132).                 00550099
005600*                                                                 00560099
005700                                                                  00570099
005800 WORKING-STORAGE SECTION.                                         00580099
005900*                                                                 00590099
006000 01  PROGRAM-SWITCHES.                                            00600099
006100     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00610099
006200         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00620099
006300         88  PS-PROCESS-EXTRACT                    VALUE 'N'.     00630099
006400     05  PS-VALID-DC-SW              PIC  X(01)    VALUE 'N'.     00640099
006500         88  PS-VALID-DC                           VALUE 'Y'.     00650099
006600         88  PS-INVALID-DC                         VALUE 'N'.     00660099
006700     05  PS-FIRST-PASS-SW            PIC  X(01)    VALUE 'Y'.     00670099
006800         88  PS-NOT-FIRST-PASS                     VALUE 'N'.     00680099
006900     05  PS-FIRST-DETAIL-REC-SW      PIC  X(01)    VALUE 'N'.     00690099
007000         88  PS-FIRST-DETAIL-REC                   VALUE 'Y'.     00700099
007100         88  PS-NOT-FIRST-DETAIL-REC               VALUE 'N'.     00710099
007200     05  PS-HEADER-ONLY-REC-SW       PIC  X(01)    VALUE 'N'.     00720099
007300         88  PS-HEADER-ONLY-REC                    VALUE 'Y'.     00730099
007400         88  PS-NOT-HEADER-ONLY-REC                VALUE 'N'.     00740099
007500*                                                                 00750099
007600 01  PC-CONSTANTS.                                                00760099
007700     05  PC-C                       PIC X      VALUE 'C'.         00770099
007800     05  PC-L                       PIC X      VALUE 'L'.         00780099
007900     05  PC-D                       PIC X      VALUE 'D'.         00790099
008000     05  PC-I                       PIC X      VALUE 'I'.         00800099
008100     05  PC-DOWNLOAD                PIC X(8)   VALUE 'DOWNLOAD'.  00810099
008200     05  PC-COMPLETE                PIC X(8)   VALUE 'COMPLETE'.  00820099
008300     05  PC-LAUNCHED                PIC X(8)   VALUE 'LAUNCHED'.  00830099
008400     05  PC-INPRCS                  PIC X(8)   VALUE 'IN PRCS '.  00840099
008500     05  PC-CONFIRMD                PIC X(8)   VALUE 'CONFIRMD'.  00850099
008600     05  PC-P2L                     PIC X(4)   VALUE 'P2L '.      00860099
008700     05  PC-FCSE                    PIC X(4)   VALUE 'FCSE'.      00870099
008800     05  PC-DASH                    PIC X      VALUE '-'.         00880099
008900     05  PC-DEFAULT                 PIC X(10)  VALUE '09/09/9999'.00890099
009000     05  PC-1                       PIC S9(03) VALUE +1           00900099
009100                                               COMP-3.            00910099
009200     05  PC-2                       PIC S9(03) VALUE +2           00920099
009300                                               COMP-3.            00930099
009400     05  PC-6                       PIC S9(03) VALUE +6           00940099
009500                                               COMP-3.            00950099
009600     05  PC-8                       PIC S9(03) VALUE +8           00960099
009700                                               COMP-3.            00970099
009800     05  PC-56                      PIC S9(03) VALUE +56          00980099
009900                                               COMP-3.            00990099
010000     05  PC-60                      PIC S9(03) VALUE +60          01000099
010100                                               COMP-3.            01010099
010200     05  PC-PCKRP007                PIC  X(08) VALUE              01020099
010300         'PCKRP007'.                                              01030099
010400     05  PC-REPORT-NBR              PIC  9(01) VALUE 1.           01040099
010500     05  PC-ENROUTE                 PIC  X(10) VALUE 'ENROUTE'.   01050099
010600     05  PC-ENRT                    PIC  X(04) VALUE 'ENRT'.      01060099
010700     05  PC-HERE                    PIC  X(04) VALUE 'HERE'.      01070099
010800     05  PC-RECEIVE-TOTAL           PIC  X(10) VALUE              01080099
010900         '   ONHAND'.                                             01090099
011000     05  PC-ENROUTE-TOTAL           PIC  X(10) VALUE              01100099
011100         '   ENROUTE'.                                            01110099
011200*                                                                 01120099
011300 01  PV-MISC-FIELDS.                                              01130099
011400     05  PV-PO-NBR                   PIC  9(8)  VALUE ZERO.       01140099
011500     05  PV-REC-SEQ                  PIC  9(4)  VALUE ZERO.       01150099
011600     05  PV-ORD-LNE                  PIC  9(4)  VALUE ZERO.       01160099
011700     05  PV-LINE-SUB                 PIC S9(03) VALUE ZERO        01170099
011800                                                   COMP-3.        01180099
011900     05  PV-LINE-CNT                 PIC S9(03) VALUE ZERO        01190099
012000                                                   COMP-3.        01200099
012100     05  PV-PO-LINE-CNT              PIC S9(03) VALUE ZERO        01210099
012200                                                   COMP-3.        01220099
012300     05  PV-PAGE-CNT                 PIC S9(04) VALUE ZERO        01230099
012400                                                   COMP-3.        01240099
012500     05  PV-VENDOR-COUNT             PIC S9(04) VALUE ZERO        01250099
012600                                                   COMP-3.        01260099
012700     05  PV-ABEND-CODE               PIC S9(04) VALUE ZERO        01270099
012800                                                   COMP SYNC.     01280099
012900     05  PV-SAVE-VENDOR-NAME         PIC X(25)  VALUE SPACES.     01290099
013000     05  PV-RECEIVER-STATUS          PIC  X(04)    VALUE SPACES.  01300099
013100     05  PV-CURRENT-OPER             PIC  S9(4) COMP.             01310099
013200     05  PV-SAVE-DATE                PIC  X(10)    VALUE SPACES.  01320099
013300     05  PV-SAVE-CURR-OPER           PIC  9(04)    VALUE ZERO.    01330099
013400     05  PV-SAVE-CURR-FCLTY          PIC  9(04)    VALUE ZERO.    01340099
013500*****05  PV-DATE-ITEM-QTY            PIC  9(09)    VALUE ZERO.    01350099
013600     05  PV-DC-TOTAL-QTY             PIC  9(09)    VALUE ZERO.    01360099
013700     05  PV-TOTAL-QTY                PIC  9(09)    VALUE ZERO.    01370099
013800     05  PV-PROCESS-ITEM-QTY         PIC  9(09)    VALUE ZERO.    01380099
013900     05  PV-GRAND-ITEM-QTY           PIC  9(09)    VALUE ZERO.    01390099
014000     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01400099
014100     05  PV-SAVE-PO                  PIC S9(09)    VALUE ZERO.    01410099
014200     05  PV-SAVE-RECEIVER            PIC  9(03)    VALUE ZERO.    01420099
014300     05  PV-DATE-DDMMYY.                                          01430099
014400         10  PV-DATE-DD              PIC  X(02).                  01440099
014500         10  PV-DATE-SLASH-1         PIC  X(01).                  01450099
014600         10  PV-DATE-MM              PIC  X(02).                  01460099
014700         10  PV-DATE-SLASH-2         PIC  X(01).                  01470099
014800         10  PV-DATE-YY              PIC  X(04).                  01480099
014900     05  PV-TODAYS-DATE.                                          01490099
015000         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01500099
015100         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01510099
015200         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01520099
015300     05  PV-TODAYS-TIME.                                          01530099
015400         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01540099
015500         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01550099
015600         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01560099
015700         10  FILLER                  PIC  9(02)    VALUE ZERO.    01570099
015800*                                                                 01580099
015900******************************************************************01590099
016000*  COPYBOOK INPUT FILE OF VERIFICATION EXCEPTION                  01600099
016100******************************************************************01610099
016200     COPY PCRD003.                                                01620099
016300                                                                  01630099
016400 EJECT                                                            01640099
016500*-----------------------------------------------------------------01650099
016600* COMMAREA FOR XLKUT071 - LOCATION MODULE                         01660099
016700*-----------------------------------------------------------------01670099
016800     COPY XLWS071.                                                01680099
016900*                                                                 01690099
017000******************************************************************01700099
017100*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01710099
017200******************************************************************01720099
017300     COPY DPWS132O.                                               01730099
017400*                                                                 01740099
017500*                                                                 01750099
017600 01  HEADING-LINES.                                               01760099
017700     05  HEADING-LINE-1.                                          01770099
017800         10  FILLER                  PIC  X(09)    VALUE          01780099
017900             'LOCATION '.                                         01790099
018000         10  HL1-OPER-UNIT           PIC  X(05).                  01800099
018100         10  HL1-FACILITY            PIC  X(04).                  01810099
018200         10  FILLER                  PIC  X(33)    VALUE SPACES.  01820099
018300         10  FILLER                  PIC  X(40)    VALUE          01830099
018400             'SUSPENDED VERIFICATION LISTING'.                    01840099
018500         10  FILLER                  PIC  X(51)    VALUE SPACES.  01850099
018600*                                                                 01860099
018700*    05  HEADING-LINE-2.                                          01870099
018800*        10  FILLER                  PIC  X(09)    VALUE          01880099
018900*            'LOCATION '.                                         01890099
019000*        10  HL1-OPER-UNIT           PIC  X(05).                  01900099
019100*        10  HL1-FACILITY            PIC  X(04).                  01910099
019200*        10  FILLER                  PIC  X(114)   VALUE SPACES.  01920099
019300*                                                                 01930099
019400     05  HEADING-LINE-3.                                          01940099
019500         10  FILLER                  PIC  X(45)  VALUE SPACES.    01950099
019600         10  FILLER                  PIC  X(07)  VALUE ' TOTAL '. 01960099
019700         10  FILLER                  PIC  X(37)  VALUE            01970099
019800             ' -------- PROCESS INFORMATION -------'.             01980099
019900         10  FILLER                  PIC  X(43)  VALUE SPACES.    01990099
020000*                                                                 02000099
020100     05  HEADING-LINE-4.                                          02010099
020200         10  FILLER                  PIC  X(16) VALUE SPACES.     02020099
020300         10  FILLER                  PIC  X(04) VALUE 'DATE'.     02030099
020400         10  FILLER                  PIC  X(04) VALUE SPACES.     02040099
020500         10  FILLER                  PIC  X(04) VALUE 'LINE'.     02050099
020600         10  FILLER                  PIC  X(01) VALUE SPACES.     02060099
020700         10  FILLER                  PIC  X(03) VALUE 'SKU'.      02070099
020800         10  FILLER                  PIC  X(13) VALUE SPACES.     02080099
020900         10  FILLER                  PIC  X(07) VALUE 'PROCESS'.  02090099
021000         10  FILLER                  PIC  X(06) VALUE SPACES.     02100099
021100         10  FILLER                  PIC  X(03) VALUE 'MOD'.      02110099
021200         10  FILLER                  PIC  X(04) VALUE SPACES.     02120099
021300         10  FILLER                  PIC  X(04) VALUE 'DATE'.     02130099
021400         10  FILLER                  PIC  X(04) VALUE SPACES.     02140099
021500         10  FILLER                  PIC  X(07) VALUE 'PROCESS'.  02150099
021600         10  FILLER                  PIC  X(11) VALUE SPACES.     02160099
021700         10  FILLER                  PIC  X(06) VALUE 'LATEST'.   02170099
021800*                                                                 02180099
021900     05  HEADING-LINE-5.                                          02190099
022000         10  FILLER                  PIC  X(11) VALUE             02200099
022100                 'PO/RECEIVER'.                                   02210099
022200         10  FILLER                  PIC  X(03) VALUE SPACES.     02220099
022300         10  FILLER                  PIC  X(08) VALUE             02230099
022400                 'RECEIVED'.                                      02240099
022500         10  FILLER                  PIC  X(02) VALUE SPACES.     02250099
022600         10  FILLER                  PIC  X(03) VALUE 'NBR'.      02260099
022700         10  FILLER                  PIC  X(02) VALUE SPACES.     02270099
022800         10  FILLER                  PIC  X(06) VALUE 'NUMBER'.   02280099
022900         10  FILLER                  PIC  X(12) VALUE SPACES.     02290099
023000         10  FILLER                  PIC  X(03) VALUE 'QTY'.      02300099
023100         10  FILLER                  PIC  X(03) VALUE SPACES.     02310099
023200         10  FILLER                  PIC  X(04) VALUE 'PRCS'.     02320099
023300         10  FILLER                  PIC  X(01) VALUE SPACES.     02330099
023400         10  FILLER                  PIC  X(03) VALUE 'NBR'.      02340099
023500         10  FILLER                  PIC  X(01) VALUE SPACES.     02350099
023600         10  FILLER                  PIC  X(10) VALUE             02360099
023700             'COMP/CNFRM'.                                        02370099
023800         10  FILLER                  PIC  X(03) VALUE SPACES.     02380099
023900         10  FILLER                  PIC  X(03) VALUE             02390099
024000             'QTY'.                                               02400099
024100         10  FILLER                  PIC  X(04) VALUE SPACES.     02410099
024200         10  FILLER                  PIC  X(06) VALUE             02420099
024300             'STATUS'.                                            02430099
024400         10  FILLER                  PIC  X(02) VALUE SPACES.     02440099
024500         10  FILLER                  PIC  X(09) VALUE             02450099
024600             'TRBL CODE'.                                         02460099
024700         10  FILLER                  PIC  X(03) VALUE SPACES.     02470099
024800         10  FILLER                  PIC  X(12) VALUE             02480099
024900             'OTHER ISSUES'.                                      02490099
025000*                                                                 02500099
025100 01  MISCELLANEOUS-LINES.                                         02510099
025200     05  END-OF-REPORT-LINE.                                      02520099
025300         10  FILLER                  PIC  X(44)    VALUE SPACES.  02530099
025400         10  FILLER                  PIC  X(45)    VALUE          02540099
025500             '*******   E N D   O F   R E P O R T   *******'.     02550099
025600         10  FILLER                  PIC  X(43)    VALUE SPACES.  02560099
025700     05  NO-DATA-TO-REPORT-LINE.                                  02570099
025800         10  FILLER                  PIC  X(40)    VALUE SPACES.  02580099
025900         10  FILLER                  PIC  X(52)    VALUE          02590099
026000         '*******  N O   D A T A   T O   R E P O R T   *******'.  02600099
026100         10  FILLER                  PIC  X(40)    VALUE SPACES.  02610099
026200*                                                                 02620099
026300 01  DETAIL-LINES.                                                02630099
026400     05  DETAIL-LINE1.                                            02640099
026500         10 DL1-PO-NBR               PIC  X(8).                   02650099
026600         10 DL1-DASH                 PIC  X(01)    VALUE '-'.     02660099
026700         10 DL1-REC-SEQ              PIC  999.                    02670099
026800         10 DL1-REC-SEQ-X REDEFINES DL1-REC-SEQ PIC XXX.          02680099
026900         10  FILLER                  PIC  X(01)    VALUE SPACES.  02690099
027000         10 DL1-REC-DATE             PIC  X(10).                  02700099
027100         10  FILLER                  PIC  X(01)    VALUE SPACES.  02710099
027200         10 DL1-ORD-LNE              PIC  9999.                   02720099
027300         10  FILLER                  PIC  X(01)    VALUE SPACES.  02730099
027400         10 DL1-SKU-DEPT             PIC  X(03).                  02740099
027500         10  FILLER                  PIC  X(01)    VALUE SPACES.  02750099
027600         10 DL1-SKU-CLASS            PIC  X(02).                  02760099
027700         10  FILLER                  PIC  X(01)    VALUE SPACES.  02770099
027800         10 DL1-SKU-NBR              PIC  X(08).                  02780099
027900         10  FILLER                  PIC  X(01)    VALUE SPACES.  02790099
028000         10 DL1-ITEM-QTY             PIC  ZZZZZZ9.                02800099
028100         10  FILLER                  PIC  X(01)    VALUE SPACES.  02810099
028200         10 DL1-PROCESS              PIC  X(04).                  02820099
028300         10  FILLER                  PIC  X(01)    VALUE SPACES.  02830099
028400         10 DL1-MOD-NBR              PIC  999.                    02840099
028500         10  FILLER                  PIC  X(01)    VALUE SPACES.  02850099
028600         10 DL1-COMP-DATE            PIC  X(10).                  02860099
028700         10  FILLER                  PIC  X(01)    VALUE SPACES.  02870099
028800         10 DL1-PROC-QTY             PIC  ZZZZZZ9.                02880099
028900         10  FILLER                  PIC  X(01)    VALUE SPACES.  02890099
029000         10 DL1-PROC-STATUS          PIC  X(08).                  02900099
029100         10  FILLER                  PIC  X(01)    VALUE SPACES.  02910099
029200         10 DL1-LATEST-TROUBLE       PIC  X(10).                  02920099
029300         10 DL1-MULTI-TROUBLE        PIC  X(01).                  02930099
029400         10  FILLER                  PIC  X(01)    VALUE SPACES.  02940099
029500         10 DL1-OTHER-ISSUES         PIC  X(30).                  02950099
029600     05  DETAIL-LINE2.                                            02960099
029700         10 DL2-VENDOR               PIC  X(25).                  02970099
029800         10  FILLER                  PIC  X(28)    VALUE SPACES.  02980099
029900         10 DL2-PROCESS              PIC  X(04).                  02990099
030000         10  FILLER                  PIC  X(05)    VALUE SPACES.  03000099
030100         10 DL2-COMP-DATE            PIC  X(10).                  03010099
030200         10  FILLER                  PIC  X(01)    VALUE SPACES.  03020099
030300         10 DL2-PROC-QTY             PIC  ZZZZZZZ.                03030099
030400         10  FILLER                  PIC  X(01)    VALUE SPACES.  03040099
030500         10 DL2-PROC-STATUS          PIC  X(08).                  03050099
030600         10  FILLER                  PIC  X(13)    VALUE SPACES.  03060099
030700         10 DL2-OTHER-ISSUES         PIC  X(30).                  03070099
030800*                                                                 03080099
030900 01  BLANK-LINE.                                                  03090099
031000     05  BLANK-LINE1.                                             03100099
031100         10  FILLER                  PIC  X(132)   VALUE SPACES.  03110099
031200                                                                  03120099
031300 01  TOTAL-LINES.                                                 03130099
031400     05  TOTAL-LINE-1.                                            03140099
031500         10  FILLER                  PIC  X(32)    VALUE SPACES.  03150099
031600         10  FILLER                  PIC  X(10)    VALUE          03160099
031700             'DC TOTAL: '.                                        03170099
031800         10  TL1-ITEM-QTY            PIC  ZZ,ZZZ,ZZ9.             03180099
031900         10  FILLER                  PIC  X(80)    VALUE SPACES.  03190099
032000                                                                  03200099
032100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          03210099
032200*  LOCATION TABLE                                                 03220099
032300*  (XLT_LOC)                                                      03230099
032400*                                                                 03240099
032500     EXEC SQL                                                     03250099
032600          INCLUDE XLT00010                                        03260099
032700     END-EXEC.                                                    03270099
032800                                                                  03280099
032900*    DB2 AREA FOR COMMUNICATIONS                                  03290099
033000                                                                  03300099
033100     EXEC SQL                                                     03310099
033200          INCLUDE SQLCA                                           03320099
033300     END-EXEC.                                                    03330099
033400                                                                  03340099
033500*    DB2 AREA FOR COMMUNICATIONS AREA2                            03350099
033600                                                                  03360099
033700     COPY SQLCA2.                                                 03370099
033800                                                                  03380099
033900*                                                                 03390099
034000 PROCEDURE DIVISION.                                              03400099
034100*                                                                 03410099
034200 0000-MAINLINE-PROCESSING.                                        03420099
034300******************************************************************03430099
034400**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03440099
034500******************************************************************03450099
034600     OPEN INPUT  EXTRACT-FILE                                     03460099
034700          OUTPUT PC-CURRENT-ON-HAND-RPT.                          03470099
034800*                                                                 03480099
034900     PERFORM 1000-INITIALIZATION.                                 03490099
035000*                                                                 03500099
035100     PERFORM 2000-PROCESS-EXTRACT                                 03510099
035200         UNTIL PS-END-OF-EXTRACT.                                 03520099
035300*                                                                 03530099
035400     IF PS-NOT-HEADER-ONLY-REC                                    03540099
035500         PERFORM 8401-WRITE-DETAIL-LINES                          03550099
035600         PERFORM 8600-DATE-TOTAL                                  03560099
035700     ELSE                                                         03570099
035800         WRITE PC-CURRENT-ON-HAND-RECORD                          03580099
035900           FROM NO-DATA-TO-REPORT-LINE                            03590099
036000             AFTER ADVANCING 2 LINES                              03600099
036100     END-IF.                                                      03610099
036200*                                                                 03620099
036300     WRITE PC-CURRENT-ON-HAND-RECORD                              03630099
036400       FROM END-OF-REPORT-LINE                                    03640099
036500         AFTER ADVANCING 2 LINES.                                 03650099
036600*                                                                 03660099
036700     CLOSE EXTRACT-FILE                                           03670099
036800           PC-CURRENT-ON-HAND-RPT.                                03680099
036900*                                                                 03690099
037000     GOBACK.                                                      03700099
037100*                                                                 03710099
037200*                                                                 03720099
037300 1000-INITIALIZATION.                                             03730099
037400******************************************************************03740099
037500**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03750099
037600******************************************************************03760099
037700                                                                  03770099
037800     ACCEPT PV-TODAYS-DATE                                        03780099
037900       FROM DATE.                                                 03790099
038000*                                                                 03800099
038100     ACCEPT PV-TODAYS-TIME                                        03810099
038200       FROM TIME.                                                 03820099
038300*                                                                 03830099
038400     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         03840099
038500     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             03850099
038600     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               03860099
038700     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              03870099
038800*                                                                 03880099
038900     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              03890099
039000     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            03900099
039100     MOVE PC-PCKRP007            TO DP132O-PROGRAM-NAME.          03910099
039200*                                                                 03920099
039300     PERFORM                                                      03930099
039400         WITH TEST AFTER                                          03940099
039500         UNTIL PS-FIRST-DETAIL-REC                                03950099
039600            OR PS-END-OF-EXTRACT                                  03960099
039700                                                                  03970099
039800          SET PS-FIRST-DETAIL-REC TO TRUE                         03980099
039900          PERFORM 2200-READ-EXTRACT                               03990099
040000          IF PC003-HEADER-RECORD                                  04000099
040100                SET PS-HEADER-ONLY-REC TO TRUE                    04010099
040200******                                                            04020099
040300            MOVE PC003-CURRENT-OPER   TO HL1-OPER-UNIT            04030099
040400                                         PV-SAVE-CURR-OPER        04040099
040500            MOVE PC003-CURRENT-FCLTY  TO HL1-FACILITY             04050099
040600                                         PV-SAVE-CURR-FCLTY       04060099
040700            MOVE PC003-CURRENT-OPER TO PV-CURRENT-OPER            04070099
040800            PERFORM 2300-VALIDATE-OPER-UNIT                       04080099
040900            IF PS-VALID-DC                                        04090099
041000                PERFORM 8000-WRITE-REPORT-HEADERS                 04100099
041100            END-IF                                                04110099
041200          END-IF                                                  04120099
041300     END-PERFORM.                                                 04130099
041400*                                                                 04140099
041500 2000-PROCESS-EXTRACT.                                            04150099
041600******************************************************************04160099
041700*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *04170099
041800*  PROCESS AREA CURRENT ON HAND REPORT                           *04180099
041900******************************************************************04190099
042000     IF (PC003-CURRENT-OPER NOT = PV-SAVE-CURR-OPER)              04200099
042100*****   (PC003-CURRENT-FCLTY NOT = PV-SAVE-CURR-FCLTY)            04210099
042200         MOVE PC003-CURRENT-OPER TO PV-CURRENT-OPER               04220099
042300             IF  PS-NOT-FIRST-DETAIL-REC                          04230099
042400                 IF PS-NOT-HEADER-ONLY-REC                        04240099
042500                     PERFORM 8401-WRITE-DETAIL-LINES              04250099
042600                     PERFORM 8600-DATE-TOTAL                      04260099
042700                     WRITE PC-CURRENT-ON-HAND-RECORD              04270099
042800                       FROM END-OF-REPORT-LINE                    04280099
042900                         AFTER ADVANCING 2 LINES                  04290099
043000                 ELSE                                             04300099
043100                     WRITE PC-CURRENT-ON-HAND-RECORD              04310099
043200                       FROM NO-DATA-TO-REPORT-LINE                04320099
043300                         AFTER ADVANCING 2 LINES                  04330099
043400                     WRITE PC-CURRENT-ON-HAND-RECORD              04340099
043500                       FROM END-OF-REPORT-LINE                    04350099
043600                         AFTER ADVANCING 2 LINES                  04360099
043700                 END-IF                                           04370099
043800             ELSE                                                 04380099
043900                 IF PS-HEADER-ONLY-REC                            04390099
044000                     WRITE PC-CURRENT-ON-HAND-RECORD              04400099
044100                       FROM NO-DATA-TO-REPORT-LINE                04410099
044200                         AFTER ADVANCING 2 LINES                  04420099
044300                     WRITE PC-CURRENT-ON-HAND-RECORD              04430099
044400                       FROM END-OF-REPORT-LINE                    04440099
044500                         AFTER ADVANCING 2 LINES                  04450099
044600                 END-IF                                           04460099
044700             END-IF                                               04470099
044800         PERFORM 2300-VALIDATE-OPER-UNIT                          04480099
044900         IF PS-VALID-DC                                           04490099
045000             IF  PV-LINE-CNT > PC-56                              04500099
045100                 PERFORM 8000-WRITE-REPORT-HEADERS                04510099
045200             END-IF                                               04520099
045300                                                                  04530099
045400             MOVE PC003-CURRENT-OPER   TO HL1-OPER-UNIT           04540099
045500                                          PV-SAVE-CURR-OPER       04550099
045600             MOVE PC003-CURRENT-FCLTY  TO HL1-FACILITY            04560099
045700                                          PV-SAVE-CURR-FCLTY      04570099
045800             MOVE 0                    TO PV-PAGE-CNT             04580099
045900             PERFORM 8000-WRITE-REPORT-HEADERS                    04590099
046000         END-IF                                                   04600099
046100         IF PC003-HEADER-RECORD                                   04610099
046200             SET PS-HEADER-ONLY-REC TO TRUE                       04620099
046300         ELSE                                                     04630099
046400             SET PS-NOT-HEADER-ONLY-REC TO TRUE                   04640099
046500         END-IF                                                   04650099
046600     END-IF.                                                      04660099
046700                                                                  04670099
046800                                                                  04680099
046900     IF PS-VALID-DC AND                                           04690099
047000        PS-NOT-HEADER-ONLY-REC                                    04700099
047100         PERFORM 2100-WRITE-REPORT                                04710099
047200     END-IF.                                                      04720099
047300                                                                  04730099
047400     PERFORM 2200-READ-EXTRACT.                                   04740099
047500                                                                  04750099
047600 2100-WRITE-REPORT.                                               04760099
047700******************************************************************04770099
047800*  WRITE THE REPORT.                                             *04780099
047900******************************************************************04790099
048000     IF PS-NOT-FIRST-PASS AND                                     04800099
048100        PS-NOT-FIRST-DETAIL-REC                                   04810099
048200         IF  PV-LINE-CNT > PC-56                                  04820099
048300            IF PV-PO-LINE-CNT > 1                                 04830099
048400               PERFORM 8000-WRITE-REPORT-HEADERS                  04840099
048500            END-IF                                                04850099
048600         END-IF                                                   04860099
048700**       IF PC003-CURRENT-FCLTY NOT = PV-SAVE-CURR-FCLTY          04870099
048800**           PERFORM 8600-DATE-TOTAL                              04880099
048900**       END-IF                                                   04890099
049000     ELSE                                                         04900099
049100         SET PS-NOT-FIRST-PASS                                    04910099
049200             PS-NOT-FIRST-DETAIL-REC TO TRUE                      04920099
049300     END-IF.                                                      04930099
049400                                                                  04940099
049500                                                                  04950099
049600********* IF SAME PC/REC/LINE THEN THERE IS A SECOND MESSAGE LINE 04960099
049700********* IF NOT, WRITE OUT THE LAST LINE FROM THE PREVIOUS ONE   04970099
049800********* AS IT MAY STILL BE WAITING TO BE WRITTEN OUT AS THERE   04980099
049900********* MAY HAVE BEEN ADDITIONAL  'OTHER ISSUES' MESSAGE        04990099
050000     IF PC003-PO-NBR = PV-PO-NBR AND                              05000099
050100       PC003-REC-SEQ-NBR = PV-REC-SEQ AND                         05010099
050200       PC003-ORD-LNE-NBR = PV-ORD-LNE                             05020099
050300        MOVE PC003-OTHER-ISSUES TO DL2-OTHER-ISSUES               05030099
050400        PERFORM 8401-WRITE-DETAIL-LINES                           05040099
050500     ELSE                                                         05050099
050600        PERFORM 8401-WRITE-DETAIL-LINES                           05060099
050700        IF   PC003-PO-NBR      = PV-PO-NBR                        05070099
050800        AND  PC003-REC-SEQ-NBR = PV-REC-SEQ                       05080099
050900        AND  PV-LINE-CNT > 8                                      05090099
051000           MOVE SPACES            TO DL1-PO-NBR                   05100099
051100                                     DL1-REC-DATE                 05110099
051200                                     DL1-DASH                     05120099
051300                                     DL1-REC-SEQ-X                05130099
051400        ELSE                                                      05140099
051500           MOVE PC003-PO-NBR         TO DL1-PO-NBR                05150099
051600           MOVE PC-DASH              TO DL1-DASH                  05160099
051700           MOVE PC003-REC-SEQ-NBR    TO DL1-REC-SEQ               05170099
051800           MOVE PC003-REC-DATE       TO DL1-REC-DATE              05180099
051900        END-IF                                                    05190099
052000        MOVE PC003-ORD-LNE-NBR    TO DL1-ORD-LNE                  05200099
052100        MOVE PC003-LATEST-TROUBLE TO DL1-LATEST-TROUBLE           05210099
052200        MOVE PC003-MULTI-TROUBLE  TO DL1-MULTI-TROUBLE            05220099
052300        MOVE PC003-OTHER-ISSUES   TO DL1-OTHER-ISSUES             05230099
052400        IF  PC003-VNDR-NME    = PV-SAVE-VENDOR-NAME               05240099
052500        AND PC003-PO-NBR      = PV-PO-NBR                         05250099
052600        AND PC003-REC-SEQ-NBR = PV-REC-SEQ                        05260099
052700        AND  PV-LINE-CNT > 8                                      05270099
052800           MOVE SPACES            TO DL2-VENDOR                   05280099
052900        ELSE                                                      05290099
053000           MOVE PC003-VNDR-NME    TO DL2-VENDOR                   05300099
053100                                     PV-SAVE-VENDOR-NAME          05310099
053200        END-IF                                                    05320099
053300        MOVE SPACES               TO DL2-OTHER-ISSUES             05330099
053400        MOVE PC003-SKU-NBR        TO DL1-SKU-NBR                  05340099
053500        MOVE PC003-DEPT-NBR       TO DL1-SKU-DEPT                 05350099
053600        MOVE PC003-SUB-CL-NBR     TO DL1-SKU-CLASS                05360099
053700        ADD PC003-P2L-UNT-QTY, PC003-FCSE-UNT-QTY                 05370099
053800            GIVING PV-TOTAL-QTY                                   05380099
053900        MOVE PV-TOTAL-QTY         TO DL1-ITEM-QTY                 05390099
054000        IF (PC003-P2L-UNT-QTY > 0 OR                              05400099
054100           (PC003-P2L-UNT-QTY = 0 AND PC003-FCSE-UNT-QTY = 0))    05410099
054200            MOVE PC003-P2L-UNT-QTY    TO DL1-PROC-QTY             05420099
054300            MOVE PC-P2L           TO DL1-PROCESS                  05430099
054400            IF PC003-P2L-DATE = PC-DEFAULT                        05440099
054500               MOVE SPACES            TO DL1-COMP-DATE            05450099
054600            ELSE                                                  05460099
054700               MOVE PC003-P2L-DATE    TO DL1-COMP-DATE            05470099
054800            END-IF                                                05480099
054900            MOVE PC003-PRC-AREA-MODU-ID                           05490099
055000                                  TO DL1-MOD-NBR                  05500099
055100            EVALUATE PC003-P2L-PRCS-CDE                           05510099
055200              WHEN PC-D                                           05520099
055300                 MOVE PC-DOWNLOAD TO DL1-PROC-STATUS              05530099
055400              WHEN PC-C                                           05540099
055500                 MOVE PC-COMPLETE TO DL1-PROC-STATUS              05550099
055600              WHEN PC-L                                           05560099
055700                 MOVE PC-LAUNCHED TO DL1-PROC-STATUS              05570099
055800              WHEN OTHER                                          05580099
055900                 MOVE SPACES      TO DL1-PROC-STATUS              05590099
056000            END-EVALUATE                                          05600099
056100            IF PC003-FCSE-UNT-QTY > 0                             05610099
056200               MOVE 1                     TO PV-PO-LINE-CNT       05620099
056300               MOVE PC003-FCSE-UNT-QTY    TO DL2-PROC-QTY         05630099
056400               MOVE PC-FCSE               TO DL2-PROCESS          05640099
056500               IF PC003-FCSE-DATE = PC-DEFAULT                    05650099
056600                  MOVE SPACES             TO DL2-COMP-DATE        05660099
056700               ELSE                                               05670099
056800                  MOVE PC003-FCSE-DATE    TO DL2-COMP-DATE        05680099
056900               END-IF                                             05690099
057000               EVALUATE PC003-FCSE-PRCS-CDE                       05700099
057100                 WHEN PC-I                                        05710099
057200                    MOVE PC-INPRCS    TO DL2-PROC-STATUS          05720099
057300                 WHEN PC-C                                        05730099
057400                    MOVE PC-CONFIRMD  TO DL2-PROC-STATUS          05740099
057500                 WHEN OTHER                                       05750099
057600                    MOVE SPACES       TO DL2-PROC-STATUS          05760099
057700               END-EVALUATE                                       05770099
057800            END-IF                                                05780099
057900         ELSE                                                     05790099
058000            MOVE 9                    TO PV-PO-LINE-CNT           05800099
058100            MOVE PC003-FCSE-UNT-QTY   TO DL1-PROC-QTY             05810099
058200            MOVE PC-FCSE              TO DL1-PROCESS              05820099
058300            IF PC003-FCSE-DATE = PC-DEFAULT                       05830099
058400               MOVE SPACES            TO DL1-COMP-DATE            05840099
058500            ELSE                                                  05850099
058600               MOVE PC003-FCSE-DATE   TO DL1-COMP-DATE            05860099
058700            END-IF                                                05870099
058800            MOVE PC003-PRC-AREA-MODU-ID                           05880099
058900                                      TO DL1-MOD-NBR              05890099
059000            EVALUATE PC003-FCSE-PRCS-CDE                          05900099
059100              WHEN PC-I                                           05910099
059200                 MOVE PC-INPRCS    TO DL1-PROC-STATUS             05920099
059300              WHEN PC-C                                           05930099
059400                 MOVE PC-CONFIRMD  TO DL1-PROC-STATUS             05940099
059500              WHEN OTHER                                          05950099
059600                 MOVE SPACES       TO DL1-PROC-STATUS             05960099
059700            END-EVALUATE                                          05970099
059800            MOVE 0                    TO DL2-PROC-QTY             05980099
059900            MOVE SPACES               TO DL2-PROCESS              05990099
060000                                         DL2-COMP-DATE            06000099
060100                                         DL2-PROC-STATUS          06010099
060200         END-IF                                                   06020099
060300            ADD PV-TOTAL-QTY          TO PV-DC-TOTAL-QTY          06030099
060400            PERFORM 8400-WRITE-DETAIL-LINES                       06040099
060500      END-IF.                                                     06050099
060600**                                                                06060099
060700**                                                                06070099
060800 2200-READ-EXTRACT.                                               06080099
060900     READ EXTRACT-FILE INTO PC003-RECEIVER-EXT-RECORD             06090099
061000        AT END                                                    06100099
061100           SET PS-END-OF-EXTRACT TO TRUE.                         06110099
061200                                                                  06120099
061300*                                                                 06130099
061400 2300-VALIDATE-OPER-UNIT.                                         06140099
061500******************************************************************06150099
061600* XLT_LOC (XLT00010)                                              06160099
061700* CALL LOCATION MODULE XLKUT071                                   06170099
061800******************************************************************06180099
061900                                                                  06190099
062000     INITIALIZE XL071-COMMAREA-REC.                               06200099
062100     MOVE PV-CURRENT-OPER            TO XL071-LOCATION-NUMBER.    06210099
062200                                                                  06220099
062300     CALL XL071-LOCATION-MODULE  USING XL071-COMMAREA-REC.        06230099
062400                                                                  06240099
062500        IF XL071-LOC-TYP-CDE = 'DC'                               06250099
062600           SET PS-VALID-DC             TO TRUE                    06260099
062700        ELSE                                                      06270099
062800           SET PS-INVALID-DC           TO TRUE                    06280099
062900        END-IF.                                                   06290099
063000                                                                  06300099
063100*                                                                 06310099
063200 8000-WRITE-REPORT-HEADERS.                                       06320099
063300******************************************************************06330099
063400*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *06340099
063500*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *06350099
063600******************************************************************06360099
063700     PERFORM 8200-WRITE-TOP-LINE.                                 06370099
063800*                                                                 06380099
063900     WRITE PC-CURRENT-ON-HAND-RECORD                              06390099
064000       FROM HEADING-LINE-1                                        06400099
064100         AFTER ADVANCING 2 LINE.                                  06410099
064200*                                                                 06420099
064300*    WRITE PC-CURRENT-ON-HAND-RECORD                              06430099
064400*      FROM HEADING-LINE-2                                        06440099
064500*        AFTER ADVANCING 1 LINES.                                 06450099
064600*                                                                 06460099
064700     WRITE PC-CURRENT-ON-HAND-RECORD                              06470099
064800       FROM HEADING-LINE-3                                        06480099
064900         AFTER ADVANCING 2 LINES.                                 06490099
065000*                                                                 06500099
065100     WRITE PC-CURRENT-ON-HAND-RECORD                              06510099
065200       FROM HEADING-LINE-4                                        06520099
065300         AFTER ADVANCING 1 LINES.                                 06530099
065400*                                                                 06540099
065500     WRITE PC-CURRENT-ON-HAND-RECORD                              06550099
065600       FROM HEADING-LINE-5                                        06560099
065700         AFTER ADVANCING 1 LINES.                                 06570099
065800*                                                                 06580099
065900     MOVE PC-8            TO PV-LINE-CNT.                         06590099
066000     MOVE PC-2            TO PV-LINE-SUB.                         06600099
066100*                                                                 06610099
066200*                                                                 06620099
066300 8200-WRITE-TOP-LINE.                                             06630099
066400******************************************************************06640099
066500*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *06650099
066600*     NEEDED FOR AN ASN NUMBER.                                  *06660099
066700******************************************************************06670099
066800     ADD 1                        TO PV-PAGE-CNT.                 06680099
066900*                                                                 06690099
067000     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          06700099
067100*                                                                 06710099
067200     WRITE PC-CURRENT-ON-HAND-RECORD                              06720099
067300       FROM DP132O-STANDRD-HEADER-132-COLS                        06730099
067400         AFTER ADVANCING PAGE.                                    06740099
067500*                                                                 06750099
067600*                                                                 06760099
067700 8400-WRITE-DETAIL-LINES.                                         06770099
067800******************************************************************06780099
067900*     WRITES THE DETAIL LINE INFORMATION.                        *06790099
068000******************************************************************06800099
068100                                                                  06810099
068200     MOVE PC003-PO-NBR      TO PV-PO-NBR.                         06820099
068300     MOVE PC003-REC-SEQ-NBR TO PV-REC-SEQ.                        06830099
068400     MOVE PC003-ORD-LNE-NBR TO PV-ORD-LNE.                        06840099
068500                                                                  06850099
068600     WRITE PC-CURRENT-ON-HAND-RECORD                              06860099
068700       FROM DETAIL-LINE1                                          06870099
068800         AFTER ADVANCING PV-LINE-SUB LINES.                       06880099
068900*                                                                 06890099
069000     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              06900099
069100     MOVE PC-1                       TO PV-LINE-SUB.              06910099
069200*                                                                 06920099
069300 8401-WRITE-DETAIL-LINES.                                         06930099
069400******************************************************************06940099
069500*     WRITES THE DETAIL LINE INFORMATION.                        *06950099
069600******************************************************************06960099
069700     IF (DL2-OTHER-ISSUES = SPACES OR LOW-VALUES) AND             06970099
069800        (DL2-PROCESS = SPACES OR LOW-VALUES) AND                  06980099
069900        (DL2-VENDOR = SPACES OR LOW-VALUES)                       06990099
070000        MOVE PC-2                       TO PV-LINE-SUB            07000099
070100     ELSE                                                         07010099
070200        WRITE PC-CURRENT-ON-HAND-RECORD                           07020099
070300          FROM DETAIL-LINE2                                       07030099
070400            AFTER ADVANCING PV-LINE-SUB LINES                     07040099
070500        INITIALIZE DETAIL-LINE2                                   07050099
070600        ADD PV-LINE-SUB                 TO PV-LINE-CNT            07060099
070700        ADD 1                           TO PV-PO-LINE-CNT         07070099
070800        MOVE PC-2                       TO PV-LINE-SUB            07080099
070900     END-IF.                                                      07090099
071000     IF  PV-LINE-CNT > PC-56                                      07100099
071100         IF PV-PO-LINE-CNT > 1                                    07110099
071200           PERFORM 8000-WRITE-REPORT-HEADERS                      07120099
071300         END-IF                                                   07130099
071400     END-IF.                                                      07140099
071500 8600-DATE-TOTAL.                                                 07150099
071600******************************************************************07160099
071700*     WRITES THE DATE TOTAL LINE                                 *07170099
071800******************************************************************07180099
071900**** MOVE PV-DATE-ITEM-QTY       TO TL1-RECEIVED-ITEM-QTY.        07190099
072000     MOVE PV-DC-TOTAL-QTY        TO TL1-ITEM-QTY.                 07200099
072100     WRITE PC-CURRENT-ON-HAND-RECORD                              07210099
072200       FROM TOTAL-LINE-1                                          07220099
072300         AFTER ADVANCING 2 LINES.                                 07230099
072400                                                                  07240099
072500     ADD PC-2                        TO PV-LINE-CNT.              07250099
072600     MOVE PC-2                       TO PV-LINE-SUB.              07260099
072700**** MOVE ZERO                       TO PV-DATE-ITEM-QTY.         07270099
072800     MOVE ZERO                       TO PV-DC-TOTAL-QTY.          07280099
072900                                                                  07290099
073000******************************************************************07300099
073100*     SQL WARNING OR ERROR PROCESSING                            *07310099
073200*                                                                *07320099
073300******************************************************************07330099
073400                                                                  07340099
073500*                                                                 07350099
073600 Z999-SQL-ERROR.                                                  07360099
073700*---------------                                                  07370099
073800                                                                  07380099
073900     MOVE SQLCODE    TO SQLCODE2.                                 07390099
074000     MOVE SQLERRD(3) TO SQLERRD3.                                 07400099
074100     DISPLAY '** ABEND **       ** = SQLERROR'.                   07410099
074200     DISPLAY '** PROGRAM        ** = PCKRP007'.                   07420099
074300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  07430099
074400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   07440099
074500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  07450099
074600     MOVE +4013 TO PV-ABEND-CODE.                                 07460099
074700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07470099
074800*                                                                 07480099
