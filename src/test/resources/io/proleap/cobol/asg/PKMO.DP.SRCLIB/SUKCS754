000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.    SUKCS754.                                         00020001
000300 AUTHOR.        DEANNA BRANTNER.                                  00030001
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040001
000500 DATE-WRITTEN.  FEBRUARY, 2003                                    00050001
000600 DATE-COMPILED.                                                   00060001
000700*----------------------------------------------------------------*00070001
000800     S754 - STORE UNIT ADJUSTMENT CRIT SPEC                       00080052
000900*----------------------------------------------------------------*00090001
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00092069
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00093069
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00094069
001130*                                                                 00094170
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00094270
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00094370
263968*---------------------------------------------------------------* 00095069
001000 ENVIRONMENT DIVISION.                                            00100001
001100 DATA DIVISION.                                                   00110001
001200                                                                  00120001
001300 WORKING-STORAGE SECTION.                                         00130001
001400*----------------------------------------------------------------*00140001
001500*   PROGRAM CONSTANTS                                            *00150001
001600*----------------------------------------------------------------*00160001
001700 01  PC-PROGRAM-CONSTANTS.                                        00170001
001800     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU754A  '.  00180001
001900     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM754 '.  00190001
002000     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS754'.  00200001
002100     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00210053
002200     05  PC-DFLT-FROM-MONTH        PIC  9(02)  VALUE 01.          00220053
002300     05  PC-DFLT-FROM-DAY          PIC  9(02)  VALUE 01.          00230053
002400                                                                  00240053
002500*-----------------------------------------------------------------00250053
002600*  DB2 KEYS                                                       00260053
002700*-----------------------------------------------------------------00270053
002800 01  DK-DB2-KEYS.                                                 00280053
002900                                                                  00290053
003000     05  DK-CURR-OPER-UNT-ID          PIC S9(04)  COMP VALUE +0.  00300053
003100     05  DK-CURR-FCLTY-ID             PIC S9(04)  COMP VALUE +0.  00310053
003200     05  DK-OPER-UNT-ID               PIC S9(04)  COMP VALUE +0.  00320053
003300     05  DK-STORE-NBR                 PIC S9(04)  COMP VALUE +0.  00330053
003400     05  DK-PO                        PIC S9(09)  COMP VALUE +0.  00340053
003500     05  DK-RCVR                      PIC S9(09)  COMP VALUE +0.  00350053
003600     05  DK-LINE                      PIC S9(09)  COMP VALUE +0.  00360053
003700     05  DK-AUDIT-NBR                 PIC S9(09)  COMP VALUE +0.  00370053
003800     05  DK-UPC-NBR                   PIC S9(15)V COMP-3 VALUE +0.00380053
003900     05  DK-SKU-NBR                   PIC S9(08)V COMP-3 VALUE +0.00390053
004000     05  DK-SML-NBR                   PIC S9(18)V COMP-3 VALUE +0.00400053
004100                                                                  00410053
004200*----------------------------------------------------------------*00420053
004300*  SYSTEM MESSAGES                                               *00430053
004400*----------------------------------------------------------------*00440053
004500*   00005 = INVALID VALUE                                         00450053
004600*   00007 = REQUIRED ENTRY                                        00460053
004700*   00008 = MUST BE NUMERIC                                       00470053
004800*   00009 = INVALID DATE                                          00480053
004900*   00045 = INVALID FUNCTION KEY                                  00490053
005000*   00840 = YOU ARE NOT AUTHORIZED TO VIEW THIS DATA              00500053
005100*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                  00510053
005200*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          00520053
005300*   02698 - DATE RANGE INVALID                                    00530053
005400*                                                                 00540053
005500*----------------------------------------------------------------*00550053
005600 01  PC-TSYMSG-NUMBERS.                                           00560053
005700     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          00570053
005800     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          00580053
005900     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          00590053
006000     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          00600053
006100     05  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.          00610053
006200     05  PC-TSYMSG-00308       PIC  9(05)  VALUE  00308.          00620063
006300     05  PC-TSYMSG-00840       PIC  9(05)  VALUE  00840.          00630053
006400     05  PC-TSYMSG-02224       PIC  9(05)  VALUE  02224.          00640053
006500     05  PC-TSYMSG-02227       PIC  9(05)  VALUE  02227.          00650053
006600     05  PC-TSYMSG-02307       PIC  9(05)  VALUE  02307.          00660053
006700     05  PC-TSYMSG-02697       PIC  9(05)  VALUE  02697.          00670053
006800     05  PC-TSYMSG-02698       PIC  9(05)  VALUE  02698.          00680053
006900                                                                  00690053
007000*----------------------------------------------------------------*00700053
007100*   PROGRAM MESSAGES                                             *00710053
007200*----------------------------------------------------------------*00720053
007300 01  PM-PROGRAM-MESSAGES.                                         00730053
007400     05  PM-ABEND-INFO-A.                                         00740053
007500         10  FILLER                PIC X(15)   VALUE              00750053
007600                                   'DP020-SRC-AID: '.             00760053
007700         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00770053
007800         10  FILLER                PIC X(19)   VALUE              00780053
007900                                   '. DP020-FK-ACTION: '.         00790053
008000         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00800053
008100         10  FILLER                PIC X(22)   VALUE              00810053
008200                                   '. DP020-FK-DISPN-IND: '.      00820053
008300         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00830053
008400         10  FILLER                PIC X(01)   VALUE '.'.         00840053
008500         10  FILLER                PIC X(19)   VALUE SPACE.       00850053
008600                                                                  00860053
008700*----------------------------------------------------------------*00870053
008800*   SWITCHES                                                     *00880053
008900*----------------------------------------------------------------*00890053
009000 01  PS-PROGRAM-SWITCHES.                                         00900053
009100     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00910053
009200         88  PS-ERROR                          VALUE  'Y'.        00920053
009300         88  PS-NO-ERROR                       VALUE  'N'.        00930053
009400     05  PS-CONFIRM-PROCESSING-IND PIC  X(01)  VALUE  'N'.        00940053
009500         88  PS-CONFIRM-PROCESSING             VALUE  'Y'.        00950053
009600         88  PS-NOT-CONFIRM-PROCESSING         VALUE  'N'.        00960053
009700     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   00970053
009800         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   00980053
009900         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   00990053
010000                                                                  01000053
010100*----------------------------------------------------------------*01010053
010200*   PROGRAM VARIABLES                                            *01020053
010300*----------------------------------------------------------------*01030053
010400 01  PV-PROGRAM-VARIABLES.                                        01040053
010500     05  PV-RACF-ERROR-CODE        PIC  9(04)  VALUE ZEROES.      01050053
010600     05  PV-USER-LOCATION          PIC  9(04)  VALUE  ZEROES.     01060053
010700     05  PV-USER-LOCATION-R REDEFINES PV-USER-LOCATION.           01070053
010800         10  FILLER                PIC  X(01).                    01080053
010900         10  PV-DP020-LOCATION     PIC  9(03).                    01090053
011000     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0.          01100053
011100     05  PV-CICS-RESPONSE          PIC S9(08) VALUE ZEROES        01110053
011200                                        COMP SYNC.                01120053
011300     05  PV-CICS-MSG-AREA2         PIC  X(100) VALUE SPACE.       01130053
012703     05  PV-SUB1                   PIC S9(4) COMP SYNC.           01270331
012704     05  PV-SUB2                   PIC S9(4) COMP SYNC.           01270431
012705                                                                  01270531
012710     05  PV-UPC-INPUT-FIELD                  PIC X(15).           01271046
012720     05  FILLER REDEFINES PV-UPC-INPUT-FIELD.                     01272046
012730         10  PV-UPC-INPUT-BYTES OCCURS 15 TIMES.                  01273046
012740             15  PV-UPC-IN-BYTE              PIC X(01).           01274046
012750                                                                  01275030
012760     05  PV-UPC-OUTPUT-FIELD                 PIC X(15).           01276046
012770     05  FILLER REDEFINES PV-UPC-OUTPUT-FIELD.                    01277046
012780         10  PV-UPC-OUTPUT-BYTE OCCURS 15 TIMES.                  01278046
012790             15  PV-UPC-OUT-BYTE             PIC X(01).           01279046
012791     05  PV-SML-CHECK.                                            01279152
012792         10  PV-SML-1-2                  PIC X(02).               01279252
012793         10  PV-SML-REST                 PIC X(18).               01279352
012794     05  PV-INPUT-FIELD                  PIC X(18).               01279452
012795     05  FILLER REDEFINES PV-INPUT-FIELD.                         01279552
012796         10  PV-INPUT-BYTES OCCURS 18 TIMES.                      01279652
012797             15  PV-IN-BYTE              PIC X(01).               01279752
012798                                                                  01279852
012799     05  PV-OUTPUT-FIELD                 PIC X(18).               01279952
012800     05  FILLER REDEFINES PV-OUTPUT-FIELD.                        01280052
012801         10  PV-OUTPUT-BYTE OCCURS 18 TIMES.                      01280152
012802             15  PV-OUT-BYTE             PIC X(01).               01280252
012803                                                                  01280352
012810     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      01281046
012900     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             01290001
013000         10  PV-CURR-YY            PIC  9(04).                    01300001
013100         10  FILLER                PIC  X(01).                    01310001
013200         10  PV-CURR-MM            PIC  9(02).                    01320001
013300         10  FILLER                PIC  X(01).                    01330001
013400         10  PV-CURR-DD            PIC  9(02).                    01340001
013500     05  PV-DEFAULT-FROM-DATE      PIC  X(10)  VALUE SPACES.      01350001
013600     05  PV-DEFAULT-DATE-R REDEFINES PV-DEFAULT-FROM-DATE.        01360001
013700         10  PV-DFLT-YY            PIC  9(04).                    01370001
013800         10  FILLER                PIC  X(01).                    01380001
013900         10  PV-DFLT-MM            PIC  9(02).                    01390001
014000         10  FILLER                PIC  X(01).                    01400001
014100         10  PV-DFLT-DD            PIC  9(02).                    01410001
014200                                                                  01420001
014300     05  PV-FROM-DATE-HOLD.                                       01430001
014400         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      01440001
014500         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      01450001
014600         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      01460001
014700                                                                  01470001
014800     05  PV-TO-DATE-HOLD.                                         01480001
014900         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      01490001
015000         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      01500001
015100         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      01510001
015200                                                                  01520001
015300*-----------------------------------------------------------------01530008
015400*  COPYBOOK FOR LOGISTIC MODULE XLKUT001                          01540008
015500*-----------------------------------------------------------------01550008
015600     COPY XLWS001.                                                01560008
015700                                                                  01570008
015800*----------------------------------------------------------------*01580001
015900*    MAP LAYOUT                                                  *01590001
016000*----------------------------------------------------------------*01600001
016100     COPY SUKM754.                                                01610001
016200                                                                  01620001
016300*----------------------------------------------------------------*01630001
016400**  SECURITY SUBROUTINE PARAMETERS                                01640001
016500*----------------------------------------------------------------*01650001
016600     COPY DPWS008.                                                01660059
016700                                                                  01670001
016800*----------------------------------------------------------------*01680001
016900*    CALENDAR ROUTINE                                            *01690001
017000*----------------------------------------------------------------*01700001
017100     COPY DPWS500.                                                01710059
017200                                                                  01720001
017300*---------------------------------------------------------------* 01730001
017400*  SENDING/RECEIVING AREA FOR THE CONFIRMATION ROUTINE          * 01740001
017500*  (CEKCS610)                                                   * 01750001
017600*---------------------------------------------------------------* 01760001
017700     COPY CEWS005.                                                01770001
017800                                                                  01780001
017900*----------------------------------------------------------------*01790001
018000*    ATTRIBUTE SETTINGS COPYBOOK.                                *01800001
018100*----------------------------------------------------------------*01810001
018200     COPY DPWS015.                                                01820059
018300                                                                  01830001
018400*----------------------------------------------------------------*01840001
018500*    FUNCTION KEYS COPYBOOK                                      *01850001
018600*----------------------------------------------------------------*01860001
018700     COPY DPWS016.                                                01870059
018800                                                                  01880001
018900*----------------------------------------------------------------*01890001
019000*    ABEND PROCESSING COPYBOOK.                                  *01900001
019100*----------------------------------------------------------------*01910001
019200     COPY DPWS013.                                                01920059
019300                                                                  01930001
019400*----------------------------------------------------------------*01940001
019500*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *01950001
019600*  SUB-ROUTINE (DPKUT100).                                       *01960001
019700*----------------------------------------------------------------*01970001
019800     COPY DPWS010I.                                               01980059
019900                                                                  01990001
020000*----------------------------------------------------------------*02000001
020200*  PARAMETERS FOR CALLING CICS ARCHITECTURE API                  *02020070
020300*----------------------------------------------------------------*02030001
020400     COPY DPWS030.                                                02040059
020400     COPY DPWS930.                                                02041070
020500                                                                  02050001
020600*----------------------------------------------------------------*02060001
020700*    STANDARD COMMAREA.                                          *02070001
020800*----------------------------------------------------------------*02080001
020900     COPY DPWS020.                                                02090059
021000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02100001
021100                                                                  02110001
021200*----------------------------------------------------------------*02120001
021300*    INTER-APPLICATION COMMAREA.                                 *02130001
021400*----------------------------------------------------------------*02140001
021500         10  INTER-APPL-COMM-AREA PIC X(200).                     02150001
021600     COPY SUWS037.                                                02160059
021700                                                                  02170001
021800*----------------------------------------------------------------*02180001
021900*    SPECIFIC COMMMAREA FOR SUKCS754.                            *02190001
022000*----------------------------------------------------------------*02200001
022100         10  ASC-SPECIFIC-COMMAREA.                               02210001
022200             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          02220001
022300             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 02230001
022400                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          02240001
022600             15  ASC-UNT-ADJ-TYP             PIC  X(01).          02260003
022700                 88  ASC-UNT-ADJ-ALL               VALUE 'A'.     02270003
022800                 88  ASC-UNT-ADJ-CNFRM             VALUE 'C'.     02280003
022900                 88  ASC-UNT-ADJ-POSTV             VALUE 'P'.     02290003
023000                 88  ASC-UNT-ADJ-VERFY             VALUE 'V'.     02300003
023010                 88  ASC-UNT-ADJ-P2L               VALUE 'Q'.     02301053
023100             15  ASC-FAIL-SUCCESS-IND        PIC X(01).           02310016
023200                 88  ASC-FAIL-SUCC-ALL             VALUE 'A'.     02320003
023300                 88  ASC-FAIL                      VALUE 'F'.     02330003
023400                 88  ASC-SUCCESS                   VALUE 'S'.     02340003
023500                 88  ASC-UNACKNOWLEDGED            VALUE 'U'.     02350006
023600             15  ASC-FROM-DATE.                                   02360003
023700                 20  ASC-FROM-MM             PIC  X(02).          02370001
023800                 20  ASC-FROM-DD             PIC  X(02).          02380001
023900                 20  ASC-FROM-YY             PIC  X(04).          02390001
024000             15  ASC-TO-DATE.                                     02400003
024100                 20  ASC-TO-MM               PIC  X(02).          02410001
024200                 20  ASC-TO-DD               PIC  X(02).          02420001
024300                 20  ASC-TO-YY               PIC  X(04).          02430001
024400             15  ASC-OPER-UNT-ID-X           PIC  X(04).          02440003
024500             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID-X.   02450018
024600                 20  ASC-OPER-UNT-ID         PIC  9(04).          02460004
024610             15  ASC-OPER-NAME               PIC  X(25).          02461024
024700             15  ASC-PO-X                    PIC  X(09).          02470020
024800             15  ASC-PO-N REDEFINES ASC-PO-X.                     02480003
024900                 20  ASC-PO                  PIC  9(09).          02490020
025000             15  ASC-RCVR-X                  PIC  X(04).          02500003
025100             15  ASC-RCVR-N REDEFINES ASC-RCVR-X.                 02510003
025200                 20  ASC-RCVR                PIC  9(04).          02520004
025300             15  ASC-LINE-X                  PIC X(04).           02530003
025400             15  ASC-LINE-N REDEFINES ASC-LINE-X.                 02540003
025500                 20  ASC-LINE                PIC  9(04).          02550004
025600             15  ASC-STR-NBR-X               PIC  X(04).          02560003
025700             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           02570003
025800                 20  ASC-STR-NBR             PIC  9(04).          02580003
025900             15  ASC-STR-NAME                PIC  X(20).          02590003
026000             15  ASC-AUDIT-NBR-X             PIC  X(09).          02600003
026100             15  ASC-AUDIT-NBR-N REDEFINES ASC-AUDIT-NBR-X.       02610003
026200                 20  ASC-AUDIT-NBR           PIC  9(09).          02620004
026300             15  ASC-AUDIT-SOURCE            PIC  X(01).          02630016
026400                 88  ASC-MANUAL-AUDIT             VALUE 'M'.      02640003
026500                 88  ASC-SYSTEM-AUDIT             VALUE 'S'.      02650003
026600             15  ASC-AUDIT-TYPE               PIC  X(01).         02660016
026700                 88  ASC-100-PERCENT              VALUE '1'.      02670003
026800                 88  ASC-SPOT                     VALUE '2'.      02680003
026900                 88  ASC-REWORK                   VALUE '3'.      02690003
026901             15  ASC-UPC-X                    PIC  X(15).         02690141
026910             15  ASC-UPC-N REDEFINES ASC-UPC-X.                   02691041
026920                 20  ASC-UPC                  PIC  9(15).         02692046
027100             15  ASC-SKU-X                    PIC  X(08).         02710033
027110             15  ASC-SKU-N REDEFINES ASC-SKU-X.                   02711033
027120                 20  ASC-SKU                  PIC  9(08).         02712033
027200             15  ASC-SML-X                    PIC  X(18).         02720052
027210             15  ASC-SML-N REDEFINES ASC-SML-X.                   02721032
027220                 20  ASC-SML                 PIC  9(18).          02722052
027230             15  ASC-PROCESS-GROUP           PIC  X(01).          02723055
027240                 88  ASC-GROUP-ALL                 VALUE 'A'.     02724055
027250                 88  ASC-GROUP-CRTN                VALUE 'C'.     02725055
027260                 88  ASC-GROUP-P2L                 VALUE 'P'.     02726055
027270             15  ASC-PROCESS-GRP-DESC        PIC  X(25).          02727058
027300                                                                  02730001
027400         10  ASC-HOLD-INTER-APPL             PIC  X(200).         02740001
027500                                                                  02750001
027600*-----------------------------------------------------------------02760001
027700*  LOCATION TABLE                                                 02770067
027800*-----------------------------------------------------------------02780001
027900     EXEC SQL                                                     02790001
028000          INCLUDE XLT00010                                        02800067
028100     END-EXEC.                                                    02810001
028200                                                                  02820001
028300*-----------------------------------------------------------------02830007
028400*  RECEIVING TABLE                                                02840007
028500*-----------------------------------------------------------------02850007
028600     EXEC SQL                                                     02860007
028700          INCLUDE TRECEIV                                         02870007
028800     END-EXEC.                                                    02880007
028900                                                                  02890007
029000*-----------------------------------------------------------------02900007
029100*  RECEIVING ITEM TABLE                                           02910007
029200*-----------------------------------------------------------------02920007
029300     EXEC SQL                                                     02930007
029400          INCLUDE TRECITM                                         02940007
029500     END-EXEC.                                                    02950007
029600                                                                  02960007
029700*-----------------------------------------------------------------02970001
029800*  CARTON AUDIT DATABASE                                          02980002
029900*-----------------------------------------------------------------02990001
030000     EXEC SQL                                                     03000001
030100          INCLUDE TSUNAUD                                         03010002
030200     END-EXEC.                                                    03020001
030300                                                                  03030001
030400*-----------------------------------------------------------------03040001
030500*  PROCESS GROUP DATABASE = SUT_PRC_GP                            03050057
030600*-----------------------------------------------------------------03060001
030700     EXEC SQL                                                     03070001
030800          INCLUDE SUT00033                                        03080057
030900     END-EXEC.                                                    03090001
031000                                                                  03100001
031010*-----------------------------------------------------------------03101057
031020*  PO AUDIT REQUEST DATABASE - SUT_PO_AUD_REQ                     03102057
031030*-----------------------------------------------------------------03103057
031040     EXEC SQL                                                     03104057
031050          INCLUDE SUT00015                                        03105057
031060     END-EXEC.                                                    03106057
031070                                                                  03107057
031100*-----------------------------------------------------------------03110012
031200*  OUTBOUND CARTON DATABASE - SUT_OTBND_CART                      03120012
031300*-----------------------------------------------------------------03130012
031400     EXEC SQL                                                     03140012
031500          INCLUDE SUT00024                                        03150013
031600     END-EXEC.                                                    03160012
031700                                                                  03170012
031800*-----------------------------------------------------------------03180001
031900*  PARM TABLE                                                     03190001
032000*-----------------------------------------------------------------03200001
032100     EXEC SQL                                                     03210001
032200          INCLUDE TKRPRPM                                         03220001
032300     END-EXEC.                                                    03230001
032400                                                                  03240001
032500*-----------------------------------------------------------------03250001
032600*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                03260001
032700*-----------------------------------------------------------------03270001
032800     EXEC SQL                                                     03280001
032900          INCLUDE SQLCA                                           03290001
033000     END-EXEC.                                                    03300001
033100                                                                  03310001
033200*-----------------------------------------------------------------03320001
033300 LINKAGE SECTION.                                                 03330001
033400*-----------------------------------------------------------------03340001
033500 01  DFHCOMMAREA.                                                 03350001
033600     05  FILLER                         OCCURS  1 TO 4072 TIMES   03360001
033700                                        DEPENDING ON EIBCALEN.    03370001
033800         10  FILLER                     PIC X.                    03380001
033900                                                                  03390001
034000                                                                  03400001
034100 PROCEDURE DIVISION.                                              03410001
034200*----------------------------------------------------------------*03420001
034300*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *03430001
034400*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *03440001
034500*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *03450001
034600*                                                                *03460001
034700*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *03470001
034800*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *03480001
034900*----------------------------------------------------------------*03490001
035000 0000-MAIN-MODULE.                                                03500001
035100     INITIALIZE DP030-CICS-API-FIELDS.                            03510001
035200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03520001
035300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03530001
035400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03540001
035500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03550001
035600     MOVE LENGTH OF SU754AI        TO DP030-MAP-LENGTH (1).       03560001
035700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03570001
035800     PERFORM 0001-CALL-CICS-ARCH-API.                             03580001
035900                                                                  03590001
036000     PERFORM 1000-CONTROL-PROCESSING                              03600001
036100                                                                  03610001
036200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03620001
036300     PERFORM 0001-CALL-CICS-ARCH-API.                             03630001
036400                                                                  03640001
036500*----------------------------------------------------------------*03650001
036600 0001-CALL-CICS-ARCH-API.                                         03660001
036700*    CALL 'DPKCS030' USING DFHEIBLK                               03670070
036700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03671070
036800                           DFHCOMMAREA                            03680001
036900                           DP030-CICS-API-FIELDS                  03690001
037000                           DP020-STANDARD-COMMAREA                03700001
037100                           SU754AI.                               03710001
037200                                                                  03720001
037300     IF  DP030-RC-CALL-SUCCESSFUL                                 03730001
037400         CONTINUE                                                 03740001
037500     ELSE                                                         03750001
037600         SET DP013-NO-ROLLBACK                                    03760001
037700             DP013-XCTL-DISPLAY-RESTART                           03770001
037800             DP013-CICS-ABEND      TO TRUE                        03780001
037900         MOVE 'BEFORE 0000-MAIN-MODULE'                           03790001
038000                                   TO DP013-PARAGRAPH             03800001
038100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL'                   03810070
038200*                                  TO DP013-MESSAGE-TEXT (2)      03820070
038100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03821070
038200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03822070
038300         MOVE  SPACES              TO DP013-MESSAGE-TEXT (3)      03830001
038400         STRING  'RETURN CODE - '     DELIMITED BY SIZE           03840001
038500                  DP030-RETURN-CODE   DELIMITED BY SIZE           03850001
038600                                 INTO DP013-MESSAGE-TEXT (3)      03860001
038700         PERFORM DP013-0000-PROCESS-ABEND                         03870001
038800     END-IF.                                                      03880001
038900                                                                  03890001
039000*----------------------------------------------------------------*03900001
039100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03910001
039200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03920001
039300*----------------------------------------------------------------*03930001
039400 1000-CONTROL-PROCESSING.                                         03940001
039500                                                                  03950001
039600     EVALUATE TRUE                                                03960001
039700         WHEN DP020-NEXT-ACT-INITIAL                              03970001
039800             INITIALIZE ASC-SPECIFIC-COMMAREA                     03980001
039900             PERFORM 4000-BUILD-INITIAL-PANEL                     03990001
040000             PERFORM 3200-RESET-ATTRIBUTES                        04000001
040100                                                                  04010001
040200         WHEN DP020-NEXT-ACT-READ-MAP                             04020001
040300             PERFORM 2000-FKEY-PROCESSING                         04030001
040400                                                                  04040001
040500         WHEN DP020-NEXT-ACT-RETURN                               04050001
040600             INITIALIZE ASC-SPECIFIC-COMMAREA                     04060001
040700             PERFORM 4000-BUILD-INITIAL-PANEL                     04070001
040800             PERFORM 3200-RESET-ATTRIBUTES                        04080001
040900                                                                  04090001
041000         WHEN OTHER                                               04100001
041100             SET DP013-LOGIC-ABEND                                04110001
041200                 DP013-NO-ROLLBACK TO TRUE                        04120001
041300             MOVE 'SUKCS754 - 1000-CONTROL-PROCESSING'            04130001
041400                                   TO  DP013-PARAGRAPH            04140001
041500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04150001
041600                                   TO  DP013-MESSAGE-TEXT(1)      04160001
041700             MOVE DP020-NEXT-APPL-ACTIVITY                        04170001
041800                                   TO DP013-MESSAGE-TEXT(2)       04180001
041900             PERFORM DP013-0000-PROCESS-ABEND                     04190001
042000     END-EVALUATE.                                                04200001
042100                                                                  04210001
042200*----------------------------------------------------------------*04220001
042300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04230001
042400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04240001
042500* EDITS.                                                         *04250001
042600*----------------------------------------------------------------*04260001
042700 2000-FKEY-PROCESSING.                                            04270001
042800                                                                  04280001
042900     EVALUATE TRUE                                                04290001
043000                                                                  04300001
043100         WHEN DP020-SRC-AID = DP016-CLEAR                         04310001
043200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04320001
043300             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 04330001
043400                                                                  04340001
043500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04350001
043600             INITIALIZE ASC-SPECIFIC-COMMAREA                     04360001
043700             PERFORM 4000-BUILD-INITIAL-PANEL                     04370001
043800             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 04380001
043900             PERFORM 3200-RESET-ATTRIBUTES                        04390001
044000                                                                  04400001
044100         WHEN OTHER                                               04410001
044200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04420001
044300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04430001
044400                                                                  04440001
044500             IF  PS-NO-ERROR                                      04450001
044600                 SET DP030-CONTINUE-GO TO TRUE                    04460001
044700                 PERFORM 2100-CHECK-FUNCTION-KEY                  04470001
044800                 IF  PS-NO-ERROR                                  04480001
044900                     PERFORM 8000-MOVE-COMMAREA-TO-SCREEN         04490001
045000                 ELSE                                             04500001
045100                     SET DP030-OVERRIDE-GO TO TRUE                04510001
045200                 END-IF                                           04520001
045300             ELSE                                                 04530001
045400                 SET DP030-OVERRIDE-GO TO TRUE                    04540001
045500             END-IF                                               04550001
045600     END-EVALUATE.                                                04560001
045700                                                                  04570001
045800*----------------------------------------------------------------*04580001
045900*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *04590001
046000*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *04600001
046100*  FROM THE CICS ARCHITECTURE API.                               *04610001
046200*----------------------------------------------------------------*04620001
046300 2100-CHECK-FUNCTION-KEY.                                         04630001
046400     EVALUATE TRUE                                                04640001
046500*                                                                 04650001
046600* ENTER                                                           04660001
046700         WHEN DP020-SRC-AID = DP016-ENTER                         04670001
046800              PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                04680001
046900                                                                  04690001
047000*                                                                 04700001
047100* F23 - PO LIST SCREEN                                            04710002
047200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04720051
047300             IF ASC-OPER-UNT-ID-X = SPACES AND                    04730064
047301                ASC-PO-X = SPACES AND                             04730164
047302                ASC-AUDIT-NBR-X = SPACES AND                      04730264
047303                ASC-SKU-X = SPACES AND                            04730364
047304                ASC-UPC-X = SPACES AND                            04730464
047305                ASC-SML-X = SPACES                                04730564
047306                 SET DP030-OVERRIDE-GO TO TRUE                    04730663
047307                 MOVE PC-TSYMSG-00308  TO DP020-MSG-NUMBER        04730763
047308                 SET DP020-MSG-WARNING TO TRUE                    04730863
047309             ELSE                                                 04730963
047320                 PERFORM 2110-PREPARE-INTER-APPL-COMM             04732063
047330             END-IF                                               04733063
047400                                                                  04740001
047500                                                                  04750003
047600* F24 - DETAIL LIST SCREEN                                        04760002
047700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              04770051
047710             IF ASC-OPER-UNT-ID-X = SPACES AND                    04771064
047720                ASC-PO-X = SPACES AND                             04772064
047730                ASC-AUDIT-NBR-X = SPACES AND                      04773064
047740                ASC-SKU-X = SPACES AND                            04774064
047750                ASC-UPC-X = SPACES AND                            04775064
047760                ASC-SML-X = SPACES                                04776064
047770                 SET DP030-OVERRIDE-GO TO TRUE                    04777064
047780                 MOVE PC-TSYMSG-00308  TO DP020-MSG-NUMBER        04778064
047790                 SET DP020-MSG-WARNING TO TRUE                    04779064
047791             ELSE                                                 04779164
047792                 PERFORM 2110-PREPARE-INTER-APPL-COMM             04779264
047793             END-IF                                               04779364
047900                                                                  04790001
047910                                                                  04791049
048000         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 04800001
048100         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   04810001
048200              PERFORM 2110-PREPARE-INTER-APPL-COMM                04820001
048300*                                                                 04830001
048400* OTHER                                                           04840001
048500         WHEN OTHER                                               04850001
048600              SET DP013-NO-ROLLBACK                               04860001
048700                  DP013-XCTL-DISPLAY-RESTART                      04870001
048800                  DP013-CICS-ABEND  TO TRUE                       04880001
048900              MOVE '2100-CHECK-FUNCTION-KEY'                      04890001
049000                                    TO DP013-PARAGRAPH            04900001
049100              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     04910001
049200                                   TO DP013-MESSAGE-TEXT (1)      04920001
049300             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 04930001
049400                                   TO DP013-MESSAGE-TEXT (2)      04940001
049500             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                04950001
049600             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 04960001
049700                                   TO PM-A-FK-ACTION              04970001
049800             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              04980001
049900                                   TO PM-A-FK-DISPN               04990001
050000             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      05000001
050100             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        05010001
050200                                   TO DP013-MESSAGE-TEXT (4)      05020001
050300             PERFORM DP013-0000-PROCESS-ABEND                     05030001
050400     END-EVALUATE.                                                05040001
050500                                                                  05050001
050600/                                                                 05060001
050700*----------------------------------------------------------------*05070001
050800* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     05080001
050900*----------------------------------------------------------------*05090001
051000 2105-RACF-ACCESS.                                                05100001
051100                                                                  05110001
051200     MOVE 'SUTRLRSL' TO DP008-FUNCTION-NAME                       05120005
051300      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  05130001
051400      SET DP008-ACCESS-TYPE-USE          TO TRUE                  05140001
051500                                                                  05150001
051600      EXEC CICS                                                   05160001
051700         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 05170001
051800              COMMAREA (DP008-SECURITY-COMMAREA)                  05180001
051900              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             05190001
052000      END-EXEC                                                    05200001
052100                                                                  05210001
052200      IF DP008-CALL-SUCCESSFUL                                    05220001
052300         IF DP008-ACCESS-ALLOWED                                  05230001
052400             SET PS-ACCESS-ALLOWED TO TRUE                        05240001
052500         ELSE                                                     05250001
052600             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    05260001
052700             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          05270001
052800             STRING ' SUKCS754- RACF -'  DELIMITED BY SIZE        05280001
052900                    ' DP008-ACCESS-SW- ' DELIMITED BY SIZE        05290001
053000                      DP008-ACCESS-SW    DELIMITED BY SIZE        05300001
053100                    ' RACF ERROR CODE-'  DELIMITED BY SIZE        05310001
053200                      PV-RACF-ERROR-CODE DELIMITED BY SIZE        05320001
053300                                    INTO PV-CICS-MSG-AREA2        05330001
053400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     05340001
053500               TO PV-COMMAREA-LENGTH                              05350001
053600             EXEC CICS                                            05360001
053700                  WRITEQ TD                                       05370001
053800                   QUEUE  ('CSSL')                                05380001
053900                    FROM  (PV-CICS-MSG-AREA2)                     05390001
054000                  LENGTH  (PV-COMMAREA-LENGTH)                    05400001
054100                    RESP  (PV-CICS-RESPONSE)                      05410001
054200             END-EXEC                                             05420001
054300         END-IF                                                   05430001
054400     ELSE                                                         05440001
054500         MOVE '2105-RACF-ACCESS' TO DP013-PARAGRAPH               05450001
054600          MOVE 'UNABLE TO ACCESS CICS'                            05460001
054700                               TO DP013-MESSAGE-TEXT (1)          05470001
054800          MOVE SQLCA                 TO DP013-SQLCA               05480001
054900          SET DP013-DB2-ABEND                                     05490001
055000              DP013-XCTL-DISPLAY-RESTART TO TRUE                  05500001
055100          PERFORM DP013-0000-PROCESS-ABEND                        05510001
055200      END-IF.                                                     05520001
055300                                                                  05530001
055400                                                                  05540001
055500*----------------------------------------------------------------*05550001
055600*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *05560001
055700*  INTER-APPLICATION COMMAREA.                                   *05570001
055800*----------------------------------------------------------------*05580001
055900 2110-PREPARE-INTER-APPL-COMM.                                    05590001
056000                                                                  05600001
056100     INITIALIZE SU037-INTER-APPL-COMMAREA.                        05610003
056200                                                                  05620001
056300     MOVE ASC-CURR-OPER-UNT-ID-N  TO SU037-CURR-OPER-UNT-ID.      05630003
056400     MOVE ASC-UNT-ADJ-TYP         TO SU037-UNT-ADJ-TYP.           05640037
056410     MOVE ASC-FAIL-SUCCESS-IND    TO SU037-FAIL-SUCCESS-IND.      05641037
056420     MOVE ASC-PROCESS-GROUP       TO SU037-PROCESS-GROUP.         05642055
056430     MOVE ASC-PROCESS-GRP-DESC    TO SU037-PROCESS-GRP-DESC.      05643057
056500     MOVE ASC-FROM-DATE           TO SU037-REQUEST-FROM-DATE.     05650003
056600     MOVE ASC-TO-DATE             TO SU037-REQUEST-TO-DATE.       05660003
056700     MOVE ASC-OPER-UNT-ID         TO SU037-OPER-UNT-ID.           05670003
056800     MOVE ASC-OPER-NAME           TO SU037-OPER-NAME.             05680003
056900     MOVE ASC-PO                  TO SU037-PO.                    05690003
057000     MOVE ASC-RCVR                TO SU037-RCVR.                  05700003
057100     MOVE ASC-LINE                TO SU037-LINE.                  05710003
057200     MOVE ASC-STR-NBR             TO SU037-STR-NBR.               05720003
057300     MOVE ASC-STR-NAME            TO SU037-STR-NAME.              05730003
057400     MOVE ASC-AUDIT-NBR           TO SU037-AUDIT-NBR.             05740003
057700     MOVE ASC-UPC                 TO SU037-UPC.                   05770003
057800     MOVE ASC-SKU                 TO SU037-SKU.                   05780003
057900     MOVE ASC-SML                 TO SU037-SML.                   05790003
058000                                                                  05800001
058100*----------------------------------------------------------------*05810001
058200* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*05820001
058300* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *05830001
058400* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *05840001
058500*----------------------------------------------------------------*05850001
058600 2200-MOVE-SCREEN-TO-COMMAREA.                                    05860001
058700                                                                  05870001
058800* UNIT ADJUST TYPE                                                05880004
058900     IF  AUNTADJL > ZERO                                          05890004
059000         MOVE AUNTADJI         TO ASC-UNT-ADJ-TYP                 05900004
059100     ELSE                                                         05910001
059200         IF AUNTADJF = DP015-ERASE-EOF                            05920004
059300             MOVE SPACES       TO ASC-UNT-ADJ-TYP                 05930004
059400         END-IF                                                   05940001
059500     END-IF.                                                      05950001
059600                                                                  05960001
059700* FAIL/SUCCESS/ALL                                                05970004
059800     IF  ASTATUSL > ZERO                                          05980004
059900         MOVE ASTATUSI         TO ASC-FAIL-SUCCESS-IND            05990004
060000     ELSE                                                         06000004
060100         IF ASTATUSF = DP015-ERASE-EOF                            06010004
060200             MOVE SPACES       TO ASC-FAIL-SUCCESS-IND            06020004
060300         END-IF                                                   06030004
060400     END-IF.                                                      06040004
060500                                                                  06050004
060510* PROCESS GROUP                                                   06051055
060520     IF  AGROUPL > ZERO                                           06052055
060530         MOVE AGROUPI          TO ASC-PROCESS-GROUP               06053055
060540     ELSE                                                         06054055
060550         IF AGROUPF = DP015-ERASE-EOF                             06055055
060560             MOVE SPACES       TO ASC-PROCESS-GROUP               06056055
060570         END-IF                                                   06057055
060580     END-IF.                                                      06058055
060590                                                                  06059055
060600* FROM DATE RANGE                                                 06060004
060700     IF  AFRMNTHL > ZERO                                          06070004
060800         MOVE AFRMNTHI         TO ASC-FROM-MM                     06080004
060900     ELSE                                                         06090004
061000         IF AFRMNTHF = DP015-ERASE-EOF                            06100004
061100             MOVE SPACES       TO ASC-FROM-MM                     06110004
061200         END-IF                                                   06120004
061300     END-IF.                                                      06130004
061400                                                                  06140004
061500     IF  AFRDAYL  > ZERO                                          06150004
061600         MOVE AFRDAYI          TO ASC-FROM-DD                     06160004
061700     ELSE                                                         06170004
061800         IF AFRDAYF = DP015-ERASE-EOF                             06180004
061900             MOVE SPACES       TO ASC-FROM-DD                     06190004
062000         END-IF                                                   06200004
062100     END-IF.                                                      06210004
062200                                                                  06220004
062300     IF  AFRYEARL  > ZERO                                         06230004
062400         MOVE AFRYEARI          TO ASC-FROM-YY                    06240004
062500     ELSE                                                         06250004
062600         IF AFRYEARF = DP015-ERASE-EOF                            06260004
062700              MOVE SPACES      TO ASC-FROM-YY                     06270004
062800         END-IF                                                   06280004
062900     END-IF.                                                      06290004
063000                                                                  06300004
063100* TO DATE RANGE                                                   06310004
063200     IF  ATOMNTHL  > ZERO                                         06320004
063300         MOVE ATOMNTHI          TO ASC-TO-MM                      06330004
063400     ELSE                                                         06340004
063500         IF ATOMNTHF = DP015-ERASE-EOF                            06350004
063600             MOVE SPACES       TO ASC-TO-MM                       06360004
063700         END-IF                                                   06370004
063800     END-IF.                                                      06380004
063900                                                                  06390004
064000     IF  ATODAYL  > ZERO                                          06400004
064100         MOVE ATODAYI         TO ASC-TO-DD                        06410004
064200     ELSE                                                         06420004
064300         IF ATODAYF = DP015-ERASE-EOF                             06430004
064400             MOVE SPACES      TO ASC-TO-DD                        06440004
064500         END-IF                                                   06450004
064600     END-IF.                                                      06460004
064700                                                                  06470004
064800     IF  ATOYEARL  > ZERO                                         06480004
064900         MOVE ATOYEARI         TO ASC-TO-YY                       06490004
065000     ELSE                                                         06500004
065100         IF ATOYEARF = DP015-ERASE-EOF                            06510004
065200             MOVE SPACES      TO ASC-TO-YY                        06520004
065300         END-IF                                                   06530004
065400     END-IF.                                                      06540004
065500                                                                  06550004
065600* OPER UNT ID                                                     06560004
065700     IF  AOPERL  > ZERO                                           06570004
065800         MOVE AOPERI           TO ASC-OPER-UNT-ID-X               06580004
065900     ELSE                                                         06590004
066000         IF AOPERF = DP015-ERASE-EOF                              06600004
066100             MOVE SPACES       TO ASC-OPER-UNT-ID-X               06610004
066110                                  ASC-OPER-NAME                   06611065
066200         END-IF                                                   06620004
066300     END-IF.                                                      06630004
066400                                                                  06640004
066500* PURCHASE ORDER                                                  06650004
066600     IF  APOL  > ZERO                                             06660004
066700         MOVE APOI           TO ASC-PO-X                          06670004
066800     ELSE                                                         06680004
066900         IF APOF = DP015-ERASE-EOF                                06690004
067000             MOVE SPACES     TO ASC-PO-X                          06700004
067100         END-IF                                                   06710004
067200     END-IF.                                                      06720004
067300                                                                  06730004
067400* RECEIVER SEQUENCE NUMBER                                        06740004
067500     IF  ARCVRL  > ZERO                                           06750004
067600         MOVE ARCVRI           TO ASC-RCVR-X                      06760004
067700     ELSE                                                         06770004
067800         IF ARCVRF = DP015-ERASE-EOF                              06780004
067900             MOVE SPACES     TO ASC-RCVR-X                        06790004
068000         END-IF                                                   06800004
068100     END-IF.                                                      06810004
068200                                                                  06820004
068300* LINE NUMBER                                                     06830004
068400     IF  ALINEL  > ZERO                                           06840004
068500         MOVE ALINEI         TO ASC-LINE-X                        06850017
068600     ELSE                                                         06860004
068700         IF ALINEF = DP015-ERASE-EOF                              06870004
068800             MOVE SPACES     TO ASC-LINE-X                        06880004
068900         END-IF                                                   06890004
069000     END-IF.                                                      06900004
069100                                                                  06910004
069200* STORE DESTINATION                                               06920004
069300     IF  ASTOREL  > ZERO                                          06930004
069400         MOVE ASTOREI             TO ASC-STR-NBR-X                06940004
069500     ELSE                                                         06950004
069600         IF ASTOREF = DP015-ERASE-EOF                             06960004
069700             MOVE SPACES          TO ASC-STR-NBR-X                06970004
069800         END-IF                                                   06980004
069900     END-IF.                                                      06990004
070000                                                                  07000004
070100* AUDIT NUMBER                                                    07010004
070200     IF  AAUDITL  > ZERO                                          07020004
070300         MOVE AAUDITI             TO ASC-AUDIT-NBR-X              07030004
070400     ELSE                                                         07040004
070500         IF AAUDITF = DP015-ERASE-EOF                             07050004
070600             MOVE SPACES          TO ASC-AUDIT-NBR-X              07060004
070700         END-IF                                                   07070004
070800     END-IF.                                                      07080004
070900                                                                  07090004
071000* UPC NUMBER                                                      07100004
071110     IF  AUPCL  > ZERO                                            07111044
071200         MOVE AUPCI             TO ASC-UPC-X                      07120041
071300     ELSE                                                         07130004
071400         IF AUPCF = DP015-ERASE-EOF                               07140004
071500             MOVE ZEROES        TO ASC-UPC-X                      07150045
071600         END-IF                                                   07160004
071700     END-IF.                                                      07170004
071800                                                                  07180004
071900* SKU NUMBER                                                      07190004
072000     IF  ASKUL  > ZERO                                            07200004
072100         MOVE ASKUI             TO ASC-SKU-X                      07210034
072200     ELSE                                                         07220004
072300         IF ASKUF = DP015-ERASE-EOF                               07230004
072400             MOVE ZEROES          TO ASC-SKU-X                    07240034
072500         END-IF                                                   07250004
072600     END-IF.                                                      07260004
072700                                                                  07270004
072800* SML NUMBER                                                      07280004
072900     IF  ASMLL  > ZERO                                            07290004
073000         MOVE ASMLI             TO PV-SML-CHECK                   07300052
073010         IF PV-SML-1-2  = '00'                                    07301052
073020             MOVE PV-SML-REST   TO ASC-SML-X                      07302052
073100         ELSE                                                     07310052
073101             MOVE PV-SML-CHECK  TO ASC-SML-X                      07310152
073102         END-IF                                                   07310252
073110     ELSE                                                         07311052
073200         IF ASMLF = DP015-ERASE-EOF                               07320004
073300             MOVE SPACES        TO ASC-SML-X                      07330032
073400         END-IF                                                   07340004
073500     END-IF.                                                      07350004
073600                                                                  07360004
073700*----------------------------------------------------------------*07370001
073800* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *07380001
073900* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *07390001
074000* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*07400001
074100* IN THE DESTINATION PROGRAM, NOT HERE.                          *07410001
074200*----------------------------------------------------------------*07420001
074300 3000-EDIT-DATA-IN-COMMAREA.                                      07430001
074400                                                                  07440001
074500     PERFORM 3200-RESET-ATTRIBUTES.                               07450001
074600                                                                  07460001
074700     IF  ASC-UNT-ADJ-TYP  =  'A' OR                               07470054
074701         ASC-UNT-ADJ-TYP  =  'C' OR                               07470154
074702         ASC-UNT-ADJ-TYP  =  'V' OR                               07470254
074703         ASC-UNT-ADJ-TYP  =  'P' OR                               07470354
074704         ASC-UNT-ADJ-TYP  =  'Q'                                  07470454
074706         CONTINUE                                                 07470654
074707     ELSE                                                         07470754
074800         SET PS-ERROR                                             07480005
074900             DP020-MSG-FATAL                                      07490005
075000             DP030-SET-CURSOR-APPL-1 TO TRUE                      07500005
075100         MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER          07510005
075200         MOVE DP015-UNP-ALP-BRT-OFF  TO AUNTADJA                  07520005
075300         MOVE DP015-RED              TO AUNTADJC                  07530005
075400         MOVE DP015-REVERSE          TO AUNTADJH                  07540005
075500         MOVE -1                     TO AUNTADJL                  07550005
075600     END-IF.                                                      07560005
075700     IF PS-NO-ERROR                                               07570005
075800         IF  ASC-FAIL-SUCCESS-IND  =  'A'  OR                     07580054
075801             ASC-FAIL-SUCCESS-IND  =  'F'  OR                     07580154
075802             ASC-FAIL-SUCCESS-IND  =  'S'  OR                     07580254
075803             ASC-FAIL-SUCCESS-IND  =  'U'                         07580354
075804             CONTINUE                                             07580454
075810         ELSE                                                     07581053
075900             SET PS-ERROR                                         07590005
076000                 DP020-MSG-FATAL                                  07600005
076100                 DP030-SET-CURSOR-APPL-1 TO TRUE                  07610005
076200             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      07620005
076300             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTATUSA              07630005
076400             MOVE DP015-RED              TO ASTATUSC              07640005
076500             MOVE DP015-REVERSE          TO ASTATUSH              07650005
076600             MOVE -1                     TO ASTATUSL              07660005
076700         END-IF                                                   07670005
076800     END-IF.                                                      07680005
076810     IF PS-NO-ERROR                                               07681055
076820         IF  ASC-PROCESS-GROUP     =  'A'  OR                     07682055
076830             ASC-PROCESS-GROUP     =  'C'  OR                     07683055
076840             ASC-PROCESS-GROUP     =  'P'                         07684055
076860             CONTINUE                                             07686055
076870         ELSE                                                     07687055
076880             SET PS-ERROR                                         07688055
076890                 DP020-MSG-FATAL                                  07689055
076891                 DP030-SET-CURSOR-APPL-1 TO TRUE                  07689155
076892             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      07689255
076893             MOVE DP015-UNP-ALP-BRT-OFF  TO AGROUPA               07689355
076894             MOVE DP015-RED              TO AGROUPC               07689455
076895             MOVE DP015-REVERSE          TO AGROUPH               07689555
076896             MOVE -1                     TO AGROUPL               07689655
076897         END-IF                                                   07689755
076898     END-IF.                                                      07689855
076899                                                                  07689957
076900     IF PS-NO-ERROR                                               07690057
076901         IF  ASC-PROCESS-GROUP     =  'A'                         07690157
076902             MOVE  'ALL'  TO ASC-PROCESS-GRP-DESC                 07690257
076903         ELSE                                                     07690357
076904             PERFORM 3012-GET-PROCESS-GRP-DESC                    07690457
076905             MOVE  SUT00033-PRC-GP-DESC                           07690557
076906               TO  ASC-PROCESS-GRP-DESC                           07690657
076907         END-IF                                                   07690757
076908     END-IF.                                                      07690857
076909                                                                  07690957
076910     IF PS-NO-ERROR                                               07691005
077000         PERFORM 3001-VALIDATE-DATES                              07700005
077100     END-IF.                                                      07710005
077200     IF PS-NO-ERROR                                               07720005
077300         IF ASC-OPER-UNT-ID-X > SPACES                            07730007
077400             PERFORM 3002-CHECK-OPER-UNIT                         07740007
077500         END-IF                                                   07750007
077600     END-IF.                                                      07760007
077700     IF PS-NO-ERROR                                               07770007
077800         IF ASC-PO-X > SPACES AND ASC-RCVR-X = SPACES AND         07780007
077900            ASC-LINE-X = SPACES                                   07790007
078000             PERFORM 3003-CHECK-PO-NBR                            07800007
078100         ELSE                                                     07810007
078200             IF ASC-PO-X > SPACES AND  ASC-RCVR-X > SPACES AND    07820017
078300                ASC-LINE-X = SPACES                               07830007
078400                 PERFORM 3004-CHECK-PO-RCVR                       07840007
078500             ELSE                                                 07850007
078600                 IF ASC-PO-X > SPACES AND  ASC-RCVR-X > SPACES    07860007
078700                    AND ASC-LINE-X > SPACES                       07870017
078800                     PERFORM 3005-CHECK-PO-RCVR-LINE              07880007
078900                 ELSE                                             07890007
079000                     IF ASC-PO-X = SPACES AND  ASC-RCVR-X > SPACES07900007
079100                        AND ASC-LINE-X = SPACES                   07910017
079200                         SET PS-ERROR                             07920007
079300                             DP020-MSG-FATAL                      07930007
079400                             DP030-SET-CURSOR-APPL-1 TO TRUE      07940007
079500                         MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER07950007
079600                         MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVRA    07960007
079700                         MOVE DP015-RED              TO ARCVRC    07970007
079800                         MOVE DP015-REVERSE          TO ARCVRH    07980007
079900                         MOVE -1                     TO ARCVRL    07990007
080000                     ELSE                                         08000007
080100                     IF ASC-PO-X = SPACES AND  ASC-RCVR-X = SPACES08010007
080200                        AND ASC-LINE-X > SPACES                   08020017
080300                         SET PS-ERROR                             08030007
080400                             DP020-MSG-FATAL                      08040007
080500                             DP030-SET-CURSOR-APPL-1 TO TRUE      08050007
080600                         MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER08060007
080700                         MOVE DP015-UNP-ALP-BRT-OFF  TO ALINEA    08070007
080800                         MOVE DP015-RED              TO ALINEC    08080007
080900                         MOVE DP015-REVERSE          TO ALINEH    08090007
081000                         MOVE -1                     TO ALINEL    08100007
081100                     END-IF                                       08110007
081200                     END-IF                                       08120007
081300                 END-IF                                           08130007
081400             END-IF                                               08140007
081500         END-IF                                                   08150007
081600     END-IF.                                                      08160007
081700     IF PS-NO-ERROR                                               08170007
081800         IF ASC-STR-NBR-X > SPACES                                08180007
081900             PERFORM 3006-CHECK-STORE-NBR                         08190007
082000         END-IF                                                   08200007
082100     END-IF.                                                      08210005
082200     IF PS-NO-ERROR                                               08220007
082300         IF ASC-AUDIT-NBR-X > SPACES                              08230007
082400             PERFORM 3007-CHECK-AUDIT-NBR                         08240007
082500         END-IF                                                   08250007
082600     END-IF.                                                      08260007
082700     IF PS-NO-ERROR                                               08270007
082800         IF ASC-UPC   > ZEROES                                    08280017
082900             PERFORM 3008-CHECK-UPC-NBR                           08290007
083000         END-IF                                                   08300007
083100     END-IF.                                                      08310007
083200     IF PS-NO-ERROR                                               08320007
083300         IF ASC-SKU   > ZEROES                                    08330017
083400             PERFORM 3009-CHECK-SKU-NBR                           08340007
083500         END-IF                                                   08350007
083600     END-IF.                                                      08360007
083700     IF PS-NO-ERROR                                               08370007
083800         IF ASC-SML   > ZEROES                                    08380017
083900             PERFORM 3010-CHECK-SML-NBR                           08390007
084000         END-IF                                                   08400007
084100     END-IF.                                                      08410007
084200                                                                  08420001
084300*-----------------------------------------------------------------08430005
084400*  VALIDATE FROM AND TO DATES                                     08440005
084500*-----------------------------------------------------------------08450005
084600 3001-VALIDATE-DATES.                                             08460005
084700                                                                  08470005
084800     MOVE  ASC-FROM-MM  TO  PV-FROM-MM.                           08480005
084900     MOVE  ASC-FROM-DD  TO  PV-FROM-DD.                           08490005
085000     MOVE  ASC-FROM-YY  TO  PV-FROM-YY.                           08500005
085100                                                                  08510005
085200     MOVE  ASC-TO-MM    TO  PV-TO-MM.                             08520005
085300     MOVE  ASC-TO-DD    TO  PV-TO-DD.                             08530005
085400     MOVE  ASC-TO-YY    TO  PV-TO-YY.                             08540005
085500                                                                  08550005
085600     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   08560005
085700         CONTINUE                                                 08570005
085800     ELSE                                                         08580005
085900*        DATE RANGE IS INVALID                                    08590005
086000         SET PS-ERROR                                             08600005
086100         DP020-MSG-FATAL             TO TRUE                      08610005
086200         MOVE PC-TSYMSG-02698        TO DP020-MSG-NUMBER          08620005
086300         MOVE DP015-UNP-ALP-BRT-OFF  TO AFRMNTHA                  08630005
086400                                        AFRDAYA                   08640005
086500                                        AFRYEARA                  08650005
086600                                        ATOMNTHA                  08660005
086700                                        ATODAYA                   08670005
086800                                        ATOYEARA                  08680005
086900         MOVE DP015-RED              TO AFRMNTHC                  08690005
087000                                        AFRDAYC                   08700005
087100                                        AFRYEARC                  08710005
087200                                        ATOMNTHC                  08720005
087300                                        ATODAYC                   08730005
087400                                        ATOYEARC                  08740005
087500         MOVE DP015-REVERSE          TO AFRMNTHH                  08750005
087600                                        AFRDAYH                   08760005
087700                                        AFRYEARH                  08770005
087800                                        ATOMNTHH                  08780005
087900                                        ATODAYH                   08790005
088000                                        ATOYEARH                  08800005
088100         MOVE -1                     TO AFRMNTHL                  08810005
088200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08820005
088300     END-IF.                                                      08830005
088400                                                                  08840005
088500     IF  PS-NO-ERROR                                              08850005
088600         INITIALIZE DPG51 DPG52 DPG53                             08860005
088700                    DPG54 DPG55 DPG56                             08870005
088800         SET  DPG51-ACTUAL-CALENDAR-ONLY                          08880005
088900              DPG51-DO-NOT-INCR-DECR-DATE                         08890005
089000                                    TO TRUE                       08900005
089100*            'CCYYMMDD'                                           08910005
089200         SET  DPG52-LK-DTE-ISO      TO TRUE                       08920005
089300         MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT        08930005
089400         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          08940005
089500                                       DPG54 DPG55 DPG56          08950005
089600         IF (DPG54-DATE-INVALID  OR                               08960005
089700             DPG54-SEVERE-ERROR)                                  08970005
089800             SET PS-ERROR                                         08980005
089900                 DP020-MSG-FATAL       TO TRUE                    08990005
090000             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        09000005
090100             MOVE DP015-UNP-ALP-BRT-OFF                           09010005
090200                                       TO AFRMNTHA                09020005
090300                                          AFRDAYA                 09030005
090400                                          AFRYEARA                09040005
090500             MOVE DP015-RED            TO AFRMNTHC                09050005
090600                                          AFRDAYC                 09060005
090700                                          AFRYEARC                09070005
090800             MOVE DP015-REVERSE        TO AFRMNTHH                09080005
090900                                          AFRDAYH                 09090005
091000                                          AFRYEARH                09100005
091100             MOVE -1                   TO AFRMNTHL                09110005
091200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09120005
091300         END-IF                                                   09130005
091400                                                                  09140005
091500         INITIALIZE DPG51 DPG52 DPG53                             09150005
091600                    DPG54 DPG55 DPG56                             09160005
091700         SET  DPG51-ACTUAL-CALENDAR-ONLY                          09170005
091800              DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                 09180005
091900*            'CCYYMMDD'                                           09190005
092000             SET  DPG52-LK-DTE-ISO  TO TRUE                       09200005
092100         MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT        09210005
092200         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          09220005
092300                                       DPG54 DPG55 DPG56          09230005
092400         IF (DPG54-DATE-INVALID                                   09240005
092500         OR  DPG54-SEVERE-ERROR)                                  09250005
092600             SET PS-ERROR                                         09260005
092700                 DP020-MSG-FATAL       TO TRUE                    09270005
092800             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        09280005
092900             MOVE DP015-UNP-ALP-BRT-OFF                           09290005
093000                                       TO ATOMNTHA                09300005
093100                                          ATODAYA                 09310005
093200                                          ATOYEARA                09320005
093300             MOVE DP015-RED            TO ATOMNTHC                09330005
093400                                          ATODAYC                 09340005
093500                                          ATOYEARC                09350005
093600             MOVE DP015-REVERSE        TO ATOMNTHH                09360005
093700                                          ATODAYH                 09370005
093800                                          ATOYEARH                09380005
093900             MOVE -1                   TO ATOMNTHL                09390005
094000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09400005
094100         END-IF                                                   09410005
094200     END-IF.                                                      09420005
094300                                                                  09430005
094400*-----------------------------------------------------------------09440001
094500* VERIFY THAT OPER UNIT ID IS NUMERIC                             09450001
094600*-----------------------------------------------------------------09460001
094700 3002-CHECK-OPER-UNIT.                                            09470005
094800     IF  ASC-OPER-UNT-ID-X >  SPACES                              09480005
094900         MOVE ASC-OPER-UNT-ID           TO DP010I-UNEDITED-FIELD  09490001
095000         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  09500001
095100         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09510001
095200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09520001
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09531069
263968              USING DP010I-NUMERIC-EDIT-AREA                      09532069
095400         IF  DP010I-ERROR-DETECTED                                09540001
095500             SET PS-ERROR                                         09550001
095600                 DP020-MSG-FATAL         TO TRUE                  09560001
095700             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      09570001
095800             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                09580001
095900             MOVE DP015-RED              TO AOPERC                09590001
096000             MOVE DP015-REVERSE          TO AOPERH                09600001
096100             MOVE -1                     TO AOPERL                09610001
096200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09620001
096300         ELSE                                                     09630001
096400             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID         09640028
096500                                          AOPERO                  09650001
096600                                          DK-STORE-NBR            09660001
096700             PERFORM 7010-STORE                                   09670001
096800             IF SQLCODE = +100   OR                               09680039
096810                XLT00010-LOC-TYP-CDE NOT = 'DC' AND 'HQ'          09681067
096900                 MOVE SPACES             TO ASC-OPER-NAME         09690001
097000                 SET PS-ERROR                                     09700001
097100                     DP020-MSG-FATAL                              09710001
097200                     DP030-SET-CURSOR-APPL-1 TO TRUE              09720001
097300                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09730001
097400                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            09740001
097500                 MOVE DP015-RED              TO AOPERC            09750001
097600                 MOVE DP015-REVERSE          TO AOPERH            09760001
097700                 MOVE -1                     TO AOPERL            09770001
097820             ELSE                                                 09782038
097821                 MOVE XLT00010-LOC-NM      TO ASC-OPER-NAME       09782167
097830             END-IF                                               09783038
097900         END-IF                                                   09790001
098000     END-IF.                                                      09800001
098100                                                                  09810001
098200*-----------------------------------------------------------------09820001
098300* VERIFY THAT PO NUMBER IS NUMERIC                                09830007
098400*-----------------------------------------------------------------09840001
098500 3003-CHECK-PO-NBR.                                               09850007
098600     IF  PS-NO-ERROR                                              09860001
098700         IF  ASC-PO-X     >  SPACES                               09870007
098800             MOVE ASC-PO                 TO DP010I-UNEDITED-FIELD 09880007
098900             MOVE LENGTH OF ASC-PO       TO DP010I-MAXIMUM-DIGITS 09890010
099000             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 09900001
099100             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              09910001
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     09921069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  09922069
099300             IF  DP010I-ERROR-DETECTED                            09930001
099400                 SET PS-ERROR                                     09940001
099500                     DP020-MSG-FATAL         TO TRUE              09950001
099600                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  09960001
099700                 MOVE DP015-UNP-ALP-BRT-OFF  TO APOA              09970007
099800                 MOVE DP015-RED              TO APOC              09980007
099900                 MOVE DP015-REVERSE          TO APOH              09990007
100000                 MOVE -1                     TO APOL              10000007
100100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10010001
100200             ELSE                                                 10020001
100300                 MOVE DP010I-NUMERIC-FIELD TO ASC-PO              10030007
100400                 MOVE ASC-PO               TO APOO                10040007
100500             END-IF                                               10050001
100600         END-IF                                                   10060001
100700     END-IF.                                                      10070001
100800                                                                  10080001
100900*-----------------------------------------------------------------10090001
101000* VERIFY THAT PO NUMBER ENTERED IS VALID                          10100007
101100*-----------------------------------------------------------------10110001
101200     IF  PS-NO-ERROR                                              10120001
101300         IF  ASC-PO  >  ZEROES                                    10130007
101400             MOVE  ASC-PO  TO  DK-PO                              10140007
101500             EXEC SQL                                             10150001
101600                  SELECT ORD_NBR                                  10160007
101700                    INTO :RECEIV-ORD-NBR                          10170007
101800                    FROM TRECEIV                                  10180007
101900                  WHERE ORD_NBR  =  :DK-PO                        10190007
102000              END-EXEC                                            10200001
102100                                                                  10210001
102200              EVALUATE TRUE                                       10220001
102300                  WHEN SQLCODE = +0                               10230001
102400                  WHEN SQLCODE = -811                             10240021
102500                       CONTINUE                                   10250007
102600                  WHEN SQLCODE = +100                             10260001
102700                       MOVE SPACES             TO ASC-PO-X        10270007
102800                       SET PS-ERROR                               10280001
102900                           DP020-MSG-FATAL         TO TRUE        10290001
103000                       MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER 10300001
103100                       MOVE DP015-UNP-ALP-BRT-OFF  TO APOA        10310007
103200                       MOVE DP015-RED              TO APOC        10320007
103300                       MOVE DP015-REVERSE          TO APOH        10330007
103400                       MOVE -1                     TO APOL        10340007
103500                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        10350001
103600                  WHEN OTHER                                      10360001
103700                      MOVE '3003-CHECK-PO-NBR     '               10370007
103800                                               TO DP013-PARAGRAPH 10380001
103900                      MOVE 'VALIDATE PURCHASE ORDER '             10390007
104000                                       TO DP013-MESSAGE-TEXT (1)  10400001
104100                      MOVE SQLCA   TO DP013-SQLCA                 10410001
104200                      MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1) 10420007
104300                      SET DP013-DB2-ABEND                         10430001
104400                          DP013-XCTL-DISPLAY-RESTART TO TRUE      10440001
104500                      PERFORM DP013-0000-PROCESS-ABEND            10450001
104600             END-EVALUATE                                         10460001
104700         END-IF                                                   10470001
104800     END-IF.                                                      10480001
104900                                                                  10490001
105000*-----------------------------------------------------------------10500007
105100* VERIFY THAT PO AND RCVR NUMBER ARE NUMERIC                      10510007
105200*-----------------------------------------------------------------10520007
105300 3004-CHECK-PO-RCVR.                                              10530007
105400     IF  PS-NO-ERROR                                              10540007
105500         IF  ASC-PO-X     >  SPACES                               10550007
105600             MOVE ASC-PO               TO DP010I-UNEDITED-FIELD   10560007
105700             MOVE LENGTH OF ASC-PO     TO DP010I-MAXIMUM-DIGITS   10570007
105800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 10580007
105900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              10590007
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     10601069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  10602069
106100             IF  DP010I-ERROR-DETECTED                            10610007
106200                 SET PS-ERROR                                     10620007
106300                     DP020-MSG-FATAL         TO TRUE              10630007
106400                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  10640007
106500                 MOVE DP015-UNP-ALP-BRT-OFF  TO APOA              10650007
106600                 MOVE DP015-RED              TO APOC              10660007
106700                 MOVE DP015-REVERSE          TO APOH              10670007
106800                 MOVE -1                     TO APOL              10680007
106900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10690007
107000             ELSE                                                 10700007
107100                 MOVE DP010I-NUMERIC-FIELD TO ASC-PO              10710007
107200                 MOVE ASC-PO               TO APOO                10720007
107300             END-IF                                               10730007
107400         END-IF                                                   10740007
107500         IF  ASC-RCVR-X     >  SPACES                             10750007
107600             MOVE ASC-RCVR             TO DP010I-UNEDITED-FIELD   10760007
107700             MOVE LENGTH OF ASC-RCVR   TO DP010I-MAXIMUM-DIGITS   10770007
107800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 10780007
107900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              10790007
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     10801069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  10802069
108100             IF  DP010I-ERROR-DETECTED                            10810007
108200                 SET PS-ERROR                                     10820007
108300                     DP020-MSG-FATAL         TO TRUE              10830007
108400                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  10840007
108500                 MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVRA            10850007
108600                 MOVE DP015-RED              TO ARCVRC            10860007
108700                 MOVE DP015-REVERSE          TO ARCVRH            10870007
108800                 MOVE -1                     TO ARCVRL            10880007
108900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10890007
109000             ELSE                                                 10900007
109100                 MOVE DP010I-NUMERIC-FIELD TO ASC-RCVR            10910007
109200                 MOVE ASC-RCVR             TO ARCVRO              10920007
109300             END-IF                                               10930007
109400         END-IF                                                   10940007
109500     END-IF.                                                      10950007
109600                                                                  10960007
109700*-----------------------------------------------------------------10970007
109800* VERIFY THAT PO AND RCVR NUMBER ENTERED ARE VALID                10980007
109900*-----------------------------------------------------------------10990007
110000     IF  PS-NO-ERROR                                              11000007
110100         IF  ASC-PO  >  ZEROES AND ASC-RCVR > ZEROES              11010007
110200             MOVE  ASC-PO   TO  DK-PO                             11020007
110300             MOVE  ASC-RCVR TO  DK-RCVR                           11030007
110400             EXEC SQL                                             11040007
110500                  SELECT ORD_NBR                                  11050007
110600                    INTO :RECEIV-ORD-NBR                          11060007
110700                    FROM TRECEIV                                  11070007
110800                  WHERE ORD_NBR      =  :DK-PO                    11080007
110900                    AND REC_SEQ_NBR  =  :DK-RCVR                  11090007
111000              END-EXEC                                            11100007
111100                                                                  11110007
111200              EVALUATE TRUE                                       11120007
111300                  WHEN SQLCODE = +0                               11130007
111400                  WHEN SQLCODE = -811                             11140021
111500                       CONTINUE                                   11150007
111600                  WHEN SQLCODE = +100                             11160007
111700                       MOVE SPACES             TO ASC-RCVR-X      11170007
111800                       SET PS-ERROR                               11180007
111900                           DP020-MSG-FATAL         TO TRUE        11190007
112000                       MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER 11200007
112100                       MOVE DP015-UNP-ALP-BRT-OFF  TO APOA        11210025
112110                                                      ARCVRA      11211025
112200                       MOVE DP015-RED              TO APOC        11220025
112320                                                      ARCVRC      11232025
112321                       MOVE DP015-REVERSE          TO APOH        11232125
112330                                                      ARCVRH      11233025
112400                       MOVE -1                     TO APOL        11240025
112500                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        11250007
112600                  WHEN OTHER                                      11260007
112700                      MOVE '3004-CHECK-PO-RCVR-NBR'               11270007
112800                                               TO DP013-PARAGRAPH 11280007
112900                      MOVE 'VALIDATE PO AND RCVR NBR'             11290007
113000                                       TO DP013-MESSAGE-TEXT (1)  11300007
113100                      MOVE SQLCA   TO DP013-SQLCA                 11310007
113200                      MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1) 11320007
113300                      SET DP013-DB2-ABEND                         11330007
113400                          DP013-XCTL-DISPLAY-RESTART TO TRUE      11340007
113500                      PERFORM DP013-0000-PROCESS-ABEND            11350007
113600             END-EVALUATE                                         11360007
113700         END-IF                                                   11370007
113800     END-IF.                                                      11380007
113900                                                                  11390007
114000*-----------------------------------------------------------------11400007
114100* VERIFY THAT PO, RCVR, AND LINE NUMBER ARE NUMERIC               11410007
114200*-----------------------------------------------------------------11420007
114300 3005-CHECK-PO-RCVR-LINE.                                         11430007
114400     IF  PS-NO-ERROR                                              11440007
114500         IF  ASC-PO-X     >  SPACES                               11450007
114600             MOVE ASC-PO               TO DP010I-UNEDITED-FIELD   11460007
114700             MOVE LENGTH OF ASC-PO     TO DP010I-MAXIMUM-DIGITS   11470007
114800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 11480007
114900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              11490007
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     11501069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  11502069
115100             IF  DP010I-ERROR-DETECTED                            11510007
115200                 SET PS-ERROR                                     11520007
115300                     DP020-MSG-FATAL         TO TRUE              11530007
115400                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  11540007
115500                 MOVE DP015-UNP-ALP-BRT-OFF  TO APOA              11550007
115600                 MOVE DP015-RED              TO APOC              11560007
115700                 MOVE DP015-REVERSE          TO APOH              11570007
115800                 MOVE -1                     TO APOL              11580007
115900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11590007
116000             ELSE                                                 11600007
116100                 MOVE DP010I-NUMERIC-FIELD TO ASC-PO              11610007
116200                 MOVE ASC-PO               TO APOO                11620007
116300             END-IF                                               11630007
116400         END-IF                                                   11640007
116500         IF  ASC-RCVR-X     >  SPACES                             11650007
116600             MOVE ASC-RCVR             TO DP010I-UNEDITED-FIELD   11660007
116700             MOVE LENGTH OF ASC-RCVR   TO DP010I-MAXIMUM-DIGITS   11670007
116800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 11680007
116900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              11690007
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     11701069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  11702069
117100             IF  DP010I-ERROR-DETECTED                            11710007
117200                 SET PS-ERROR                                     11720007
117300                     DP020-MSG-FATAL         TO TRUE              11730007
117400                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  11740007
117500                 MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVRA            11750007
117600                 MOVE DP015-RED              TO ARCVRC            11760007
117700                 MOVE DP015-REVERSE          TO ARCVRH            11770007
117800                 MOVE -1                     TO ARCVRL            11780007
117900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11790007
118000             ELSE                                                 11800007
118100                 MOVE DP010I-NUMERIC-FIELD TO ASC-RCVR            11810007
118200                 MOVE ASC-RCVR             TO ARCVRO              11820007
118300             END-IF                                               11830007
118400         END-IF                                                   11840007
118500         IF  ASC-LINE-X     >  SPACES                             11850007
118600             MOVE ASC-LINE             TO DP010I-UNEDITED-FIELD   11860007
118700             MOVE LENGTH OF ASC-LINE   TO DP010I-MAXIMUM-DIGITS   11870007
118800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 11880007
118900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              11890007
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     11901069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  11902069
119100             IF  DP010I-ERROR-DETECTED                            11910007
119200                 SET PS-ERROR                                     11920007
119300                     DP020-MSG-FATAL         TO TRUE              11930007
119400                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  11940007
119500                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALINEA            11950007
119600                 MOVE DP015-RED              TO ALINEC            11960007
119700                 MOVE DP015-REVERSE          TO ALINEH            11970007
119800                 MOVE -1                     TO ALINEL            11980007
119900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11990007
120000             ELSE                                                 12000007
120100                 MOVE DP010I-NUMERIC-FIELD TO ASC-LINE            12010007
120200                 MOVE ASC-LINE             TO ALINEO              12020007
120300             END-IF                                               12030007
120400         END-IF                                                   12040007
120500     END-IF.                                                      12050007
120600                                                                  12060007
120700*-----------------------------------------------------------------12070007
120800* VERIFY THAT PO, RCVR, AND LINE NUMBER ENTERED ARE VALID         12080007
120900*-----------------------------------------------------------------12090007
121000     IF  PS-NO-ERROR                                              12100007
121100         IF  ASC-PO  >  ZEROES AND ASC-RCVR > ZEROES AND          12110007
121200             ASC-LINE >  ZEROES                                   12120007
121300             MOVE  ASC-PO   TO  DK-PO                             12130007
121400             MOVE  ASC-RCVR TO  DK-RCVR                           12140007
121500             MOVE  ASC-LINE TO  DK-LINE                           12150007
121600             EXEC SQL                                             12160007
121700                  SELECT ORD_NBR                                  12170007
121800                    INTO :RECITM-ORD-NBR                          12180007
121900                    FROM TRECITM                                  12190007
122000                  WHERE ORD_NBR      =  :DK-PO                    12200007
122100                    AND REC_SEQ_NBR  =  :DK-RCVR                  12210007
122200                    AND ORD_LNE_NBR  =  :DK-LINE                  12220013
122300              END-EXEC                                            12230007
122400                                                                  12240007
122500              EVALUATE TRUE                                       12250007
122600                  WHEN SQLCODE = +0                               12260007
122700                       CONTINUE                                   12270007
122800                  WHEN SQLCODE = +100                             12280007
122900                       MOVE SPACES             TO ASC-LINE-X      12290007
123000                       SET PS-ERROR                               12300007
123100                           DP020-MSG-FATAL         TO TRUE        12310007
123200                       MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER 12320007
123210                       MOVE DP015-UNP-ALP-BRT-OFF  TO APOA        12321025
123220                                                      ARCVRA      12322025
123221                                                      ALINEA      12322125
123230                       MOVE DP015-RED              TO APOC        12323025
123240                                                      ARCVRC      12324025
123241                                                      ALINEC      12324125
123250                       MOVE DP015-REVERSE          TO APOH        12325025
123260                                                      ARCVRH      12326025
123261                                                      ALINEH      12326125
123270                       MOVE -1                     TO APOL        12327025
123700                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        12370007
123800                  WHEN OTHER                                      12380007
123900                      MOVE '3005-CHECK-PO-RCVR-LINE'              12390007
124000                                               TO DP013-PARAGRAPH 12400007
124100                      MOVE 'VALIDATE PO, RCVR, LINE NBR'          12410007
124200                                       TO DP013-MESSAGE-TEXT (1)  12420007
124300                      MOVE SQLCA   TO DP013-SQLCA                 12430007
124400                      MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1) 12440007
124500                      SET DP013-DB2-ABEND                         12450007
124600                          DP013-XCTL-DISPLAY-RESTART TO TRUE      12460007
124700                      PERFORM DP013-0000-PROCESS-ABEND            12470007
124800             END-EVALUATE                                         12480007
124900         END-IF                                                   12490007
125000     END-IF.                                                      12500007
125100                                                                  12510007
125200*-----------------------------------------------------------------12520007
125300* VERIFY THAT STORE NUMBER IS NUMERIC                             12530007
125400*-----------------------------------------------------------------12540007
125500 3006-CHECK-STORE-NBR.                                            12550007
125600     IF  PS-NO-ERROR                                              12560007
125700         IF  ASC-STR-NBR    >  ZEROES                             12570017
125800             MOVE ASC-STR-NBR            TO DP010I-UNEDITED-FIELD 12580017
125900             MOVE LENGTH OF ASC-STR-NBR    TO                     12590017
126000                                            DP010I-MAXIMUM-DIGITS 12600007
126100             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 12610007
126200             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              12620007
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12631069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  12632069
126400             IF  DP010I-ERROR-DETECTED                            12640007
126500                 SET PS-ERROR                                     12650007
126600                     DP020-MSG-FATAL         TO TRUE              12660007
126700                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  12670007
126800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTOREA           12680014
126900                 MOVE DP015-RED              TO ASTOREC           12690014
127000                 MOVE DP015-REVERSE          TO ASTOREH           12700014
127100                 MOVE -1                     TO ASTOREL           12710014
127200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12720007
127300             ELSE                                                 12730007
127400                 MOVE DP010I-NUMERIC-FIELD TO ASC-STR-NBR         12740017
127500                 MOVE ASC-STR-NBR          TO ASTOREO             12750017
127600                                              DK-STORE-NBR        12760010
127700             PERFORM 7010-STORE                                   12770010
127800             IF SQLCODE = +100                                    12780010
127900                 MOVE SPACES             TO ASC-STR-NAME          12790017
128000                 SET PS-ERROR                                     12800010
128100                     DP020-MSG-FATAL                              12810010
128200                     DP030-SET-CURSOR-APPL-1 TO TRUE              12820010
128300                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  12830010
128400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTOREA           12840010
128500                 MOVE DP015-RED              TO ASTOREC           12850010
128600                 MOVE DP015-REVERSE          TO ASTOREH           12860010
128700                 MOVE -1                     TO ASTOREL           12870010
128820             ELSE                                                 12882029
128830                 MOVE XLT00010-LOC-NM    TO ASC-STR-NAME          12883067
128840             END-IF                                               12884029
128900         END-IF                                                   12890007
129000     END-IF.                                                      12900007
129100                                                                  12910007
129200*-----------------------------------------------------------------12920007
129300* VERIFY THAT AUDIT NUMBER IS NUMERIC                             12930007
129400*-----------------------------------------------------------------12940007
129500 3007-CHECK-AUDIT-NBR.                                            12950007
129600     IF  PS-NO-ERROR                                              12960007
129700         IF  ASC-AUDIT-NBR  >  ZEROES                             12970007
129800             MOVE ASC-AUDIT-NBR          TO DP010I-UNEDITED-FIELD 12980007
129900             MOVE LENGTH OF ASC-AUDIT-NBR  TO                     12990007
130000                                            DP010I-MAXIMUM-DIGITS 13000007
130100             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13010007
130200             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13020007
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13031069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  13032069
130400             IF  DP010I-ERROR-DETECTED                            13040007
130500                 SET PS-ERROR                                     13050007
130600                     DP020-MSG-FATAL         TO TRUE              13060007
130700                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13070007
130800                 MOVE DP015-UNP-ALP-BRT-OFF  TO AAUDITA           13080007
130900                 MOVE DP015-RED              TO AAUDITC           13090007
131000                 MOVE DP015-REVERSE          TO AAUDITH           13100007
131100                 MOVE -1                     TO AAUDITL           13110007
131200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13120007
131300             ELSE                                                 13130007
131400                 MOVE DP010I-NUMERIC-FIELD TO ASC-AUDIT-NBR       13140007
131500                 MOVE ASC-AUDIT-NBR        TO AAUDITO             13150007
131600             END-IF                                               13160007
131700         END-IF                                                   13170007
131800     END-IF.                                                      13180007
131900                                                                  13190007
132000*-----------------------------------------------------------------13200007
132100* VERIFY THAT AUDIT NUMBER ENTERED IS VALID                       13210007
132200*-----------------------------------------------------------------13220007
132300     IF  PS-NO-ERROR                                              13230007
132400         IF  ASC-AUDIT-NBR  >  ZEROES                             13240007
132500             MOVE  ASC-AUDIT-NBR  TO  DK-AUDIT-NBR                13250007
132600             EXEC SQL                                             13260007
132700                  SELECT AUD_CNTL_NBR                             13270007
132800                    INTO :SUNAUD-AUD-CNTL-NBR                     13280012
132900                    FROM TSUNAUD                                  13290007
133000                  WHERE AUD_CNTL_NBR  =  :DK-AUDIT-NBR            13300007
133100              END-EXEC                                            13310007
133200                                                                  13320007
133300              EVALUATE TRUE                                       13330007
133400                  WHEN SQLCODE = +0                               13340007
133500                       CONTINUE                                   13350007
133600                  WHEN SQLCODE = +100                             13360007
133700                       SET PS-ERROR                               13370007
133800                           DP020-MSG-FATAL         TO TRUE        13380007
133900                       MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER 13390007
134000                       MOVE DP015-UNP-ALP-BRT-OFF  TO AAUDITA     13400007
134100                       MOVE DP015-RED              TO AAUDITC     13410007
134200                       MOVE DP015-REVERSE          TO AAUDITH     13420007
134300                       MOVE -1                     TO AAUDITL     13430007
134400                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        13440007
134500                  WHEN OTHER                                      13450007
134600                      MOVE '3007-CHECK-AUDIT-NBR    '             13460007
134700                                               TO DP013-PARAGRAPH 13470007
134800                      MOVE 'VALIDATE AUDIT NUMBER '               13480007
134900                                       TO DP013-MESSAGE-TEXT (1)  13490007
135000                      MOVE SQLCA   TO DP013-SQLCA                 13500007
135100                      MOVE 'TSUNAUD ' TO DP013-DB2-TABLE-NAME (1) 13510007
135200                      SET DP013-DB2-ABEND                         13520007
135300                          DP013-XCTL-DISPLAY-RESTART TO TRUE      13530007
135400                      PERFORM DP013-0000-PROCESS-ABEND            13540007
135500             END-EVALUATE                                         13550007
135600         END-IF                                                   13560007
135700     END-IF.                                                      13570007
135800                                                                  13580007
135900*-----------------------------------------------------------------13590007
136000* VERIFY THAT THE UPC NUMBER IS NUMERIC AND EXISTS                13600046
136010* CALL LOGISTICS ITEM ACCESS MODULE (XLKUT001)                    13601026
136100*-----------------------------------------------------------------13610007
136200 3008-CHECK-UPC-NBR.                                              13620007
136310     MOVE ASC-UPC             TO PV-UPC-INPUT-FIELD.              13631046
136320     MOVE SPACES              TO PV-UPC-OUTPUT-FIELD.             13632046
136330     MOVE +15                 TO PV-SUB2.                         13633048
136340                                                                  13634046
136350     PERFORM                                                      13635046
136360       VARYING PV-SUB1 FROM 15 BY -1                              13636048
136370         UNTIL PV-SUB1 = ZERO OR PS-ERROR                         13637046
136380                                                                  13638046
136390         IF PV-UPC-IN-BYTE (PV-SUB1) > SPACES                     13639046
136391             IF PV-UPC-IN-BYTE (PV-SUB1) NUMERIC                  13639146
136392                 MOVE PV-UPC-IN-BYTE (PV-SUB1)                    13639246
136393                   TO PV-UPC-OUT-BYTE (PV-SUB2)                   13639346
136394                 SUBTRACT 1 FROM PV-SUB2                          13639446
136395             ELSE                                                 13639546
136396                 SET PS-ERROR                                     13639646
136397                     DP020-MSG-FATAL         TO TRUE              13639746
136398                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13639846
136399                 MOVE DP015-UNP-ALP-BRT-OFF  TO AUPCA             13639946
136400                 MOVE DP015-RED              TO AUPCC             13640046
136410                 MOVE DP015-REVERSE          TO AUPCH             13641046
136420                 MOVE -1                     TO AUPCL             13642046
136430                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13643046
136440              END-IF                                              13644046
136450         END-IF                                                   13645046
136460     END-PERFORM.                                                 13646046
136470                                                                  13647046
136480     IF PS-NO-ERROR                                               13648046
136490         INSPECT PV-UPC-OUTPUT-FIELD                              13649046
136491           REPLACING ALL SPACES BY ZEROES                         13649146
136492             MOVE PV-UPC-OUTPUT-FIELD TO ASC-UPC                  13649246
136493     END-IF.                                                      13649346
136494                                                                  13649446
136500     IF PS-NO-ERROR                                               13650046
139100         INITIALIZE XL001-ITEM-COMMAREA                           13910046
139200         MOVE ASC-UPC      TO DK-UPC-NBR                          13920046
139300         MOVE DK-UPC-NBR   TO XL001-KEY-UPC-NBR                   13930046
139500         SET  XL001-BY-UPC-NBR                                    13950046
139600              XL001-SELECT-UPC TO TRUE                            13960046
139800         CALL XL001-VSM-PGM USING DFHEIBLK                        13980046
139900                               XL001-COMMAREA                     13990046
140000                               XL001-ITEM-COMMAREA                14000046
140200         EVALUATE TRUE                                            14020046
140300             WHEN XL001-SUCCESSFUL                                14030046
140400                  CONTINUE                                        14040046
140500             WHEN XL001-UPC-NOT-FOUND                             14050046
140600                 SET PS-ERROR                                     14060046
140700                     DP020-MSG-FATAL         TO TRUE              14070046
140800                  MOVE PC-TSYMSG-00005     TO DP020-MSG-NUMBER    14080046
140900                  MOVE DP015-UNP-ALP-BRT-OFF  TO AUPCA            14090046
141000                  MOVE DP015-RED              TO AUPCC            14100046
141100                  MOVE DP015-REVERSE          TO AUPCH            14110046
141200                  MOVE -1                     TO AUPCL            14120046
141300                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             14130046
141400               WHEN XL001-SQL-ERROR                               14140046
141500                 MOVE '3008-CHECK-UPC-NBR'  TO DP013-PARAGRAPH    14150046
141600                 MOVE 'VALIDATE UPC NUMBER' TO                    14160046
141610                                            DP013-MESSAGE-TEXT (1)14161034
141700                 MOVE SQLCA   TO DP013-SQLCA                      14170046
141800                 MOVE 'XLKUT001' TO DP013-DB2-TABLE-NAME (1)      14180046
141900                 SET DP013-DB2-ABEND                              14190046
142000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14200046
142100                 PERFORM DP013-0000-PROCESS-ABEND                 14210046
142200         END-EVALUATE                                             14220046
142210     ELSE                                                         14221046
142211         SET PS-ERROR                                             14221146
142212             DP020-MSG-FATAL         TO TRUE                      14221246
142213         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          14221346
142214         MOVE DP015-UNP-ALP-BRT-OFF  TO AUPCA                     14221446
142215         MOVE DP015-RED              TO AUPCC                     14221546
142216         MOVE DP015-REVERSE          TO AUPCH                     14221646
142217         MOVE -1                     TO AUPCL                     14221746
142218         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      14221846
142220     END-IF.                                                      14222034
142300                                                                  14230008
142400*-----------------------------------------------------------------14240008
142500* VERIFY THAT THE SKU NUMBER IS NUMERIC                           14250008
142600*-----------------------------------------------------------------14260008
142700 3009-CHECK-SKU-NBR.                                              14270008
142800     IF  PS-NO-ERROR                                              14280008
142900         IF  ASC-SKU      >  ZEROES                               14290015
143000             MOVE ASC-SKU              TO DP010I-UNEDITED-FIELD   14300015
143100             MOVE LENGTH OF ASC-SKU      TO                       14310015
143200                                            DP010I-MAXIMUM-DIGITS 14320008
143300             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 14330008
143400             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              14340008
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     14351069
263968                  USING DP010I-NUMERIC-EDIT-AREA                  14352069
143600             IF  DP010I-ERROR-DETECTED                            14360008
143700                 SET PS-ERROR                                     14370008
143800                     DP020-MSG-FATAL         TO TRUE              14380008
143900                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  14390008
144000                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA             14400008
144100                 MOVE DP015-RED              TO ASKUC             14410008
144200                 MOVE DP015-REVERSE          TO ASKUH             14420008
144300                 MOVE -1                     TO ASKUL             14430008
144400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14440008
144500             ELSE                                                 14450008
144600                 MOVE DP010I-NUMERIC-FIELD TO ASC-SKU             14460015
144700                 MOVE ASC-SKU              TO ASKUO               14470015
144800             END-IF                                               14480008
144900         END-IF                                                   14490008
145000     END-IF.                                                      14500008
145100                                                                  14510008
145200*-----------------------------------------------------------------14520008
145300* VERIFY THAT SKU NUMBER ENTERED IS VALID                         14530008
145400* CALL LOGISTICS ITEM ACCESS MODULE (XLKUT001)                    14540008
145500*---------------------------------------------------------------- 14550008
145600     INITIALIZE XL001-ITEM-COMMAREA.                              14560008
145700     MOVE ASC-SKU      TO DK-SKU-NBR.                             14570015
145800     MOVE DK-SKU-NBR   TO XL001-KEY-SKU.                          14580014
145900                                                                  14590008
146000     SET  XL001-BY-NUMERIC-SKU                                    14600017
146100          XL001-SELECT-SKU TO TRUE.                               14610008
146200                                                                  14620008
146300     CALL XL001-VSM-PGM USING DFHEIBLK                            14630008
146400                              XL001-COMMAREA                      14640008
146500                              XL001-ITEM-COMMAREA.                14650008
146600                                                                  14660008
146700     EVALUATE TRUE                                                14670008
146800         WHEN XL001-SUCCESSFUL                                    14680008
146900             CONTINUE                                             14690008
147000         WHEN XL001-SKU-NOT-FOUND                                 14700008
147100             SET PS-ERROR                                         14710008
147200                  DP020-MSG-FATAL         TO TRUE                 14720008
147300              MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER          14730008
147400              MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA                14740008
147500              MOVE DP015-RED              TO ASKUC                14750017
147600              MOVE DP015-REVERSE          TO ASKUH                14760008
147700              MOVE -1                     TO ASKUL                14770008
147800              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 14780008
147900          WHEN XL001-SQL-ERROR                                    14790008
148000              MOVE '3009-CHECK-SKU-NBR    '  TO DP013-PARAGRAPH   14800008
148100              MOVE 'VALIDATE SKU NUMBER' TO DP013-MESSAGE-TEXT (1)14810008
148200              MOVE SQLCA   TO DP013-SQLCA                         14820008
148300              MOVE 'XLKUT001' TO DP013-DB2-TABLE-NAME (1)         14830008
148400              SET DP013-DB2-ABEND                                 14840008
148500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              14850008
148600              PERFORM DP013-0000-PROCESS-ABEND                    14860008
148700         END-EVALUATE.                                            14870008
148800                                                                  14880008
148900*-----------------------------------------------------------------14890008
149010* VERIFY THAT SML NUMBER ENTERED IS NUMERIC                       14901030
149100*-----------------------------------------------------------------14910007
149200 3010-CHECK-SML-NBR.                                              14920007
149400                                                                  14940030
149500     MOVE ASC-SML             TO PV-INPUT-FIELD.                  14950030
149600     MOVE SPACES              TO PV-OUTPUT-FIELD.                 14960030
149700     MOVE +18                 TO PV-SUB2.                         14970030
149800                                                                  14980030
149900     PERFORM                                                      14990030
150000       VARYING PV-SUB1 FROM 18 BY -1                              15000030
150100         UNTIL PV-SUB1 = ZERO OR PS-ERROR                         15010030
150200                                                                  15020030
150300         IF PV-IN-BYTE (PV-SUB1) > SPACES                         15030030
150400             IF PV-IN-BYTE (PV-SUB1) NUMERIC                      15040030
150500                 MOVE PV-IN-BYTE (PV-SUB1)                        15050030
150600                   TO PV-OUT-BYTE (PV-SUB2)                       15060030
150700                 SUBTRACT 1 FROM PV-SUB2                          15070030
150800             ELSE                                                 15080030
150900                 SET PS-ERROR                                     15090030
151000                     DP020-MSG-FATAL         TO TRUE              15100030
151100                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  15110030
151200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASMLA             15120030
151300                 MOVE DP015-RED              TO ASMLC             15130030
151400                 MOVE DP015-REVERSE          TO ASMLH             15140030
151500                 MOVE -1                     TO ASMLL             15150030
151600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15160030
151700              END-IF                                              15170030
151800         END-IF                                                   15180030
151910     END-PERFORM.                                                 15191030
151920                                                                  15192030
151930     IF PS-NO-ERROR                                               15193030
151940         INSPECT PV-OUTPUT-FIELD                                  15194030
151950           REPLACING ALL SPACES BY ZEROES                         15195030
151960             MOVE PV-OUTPUT-FIELD TO ASC-SML                      15196030
151990     END-IF.                                                      15199030
151991                                                                  15199130
151992*-----------------------------------------------------------------15199230
151993* VERIFY THAT SML NUMBER ENTERED IS VALID                         15199330
151994*-----------------------------------------------------------------15199430
152000     IF  PS-NO-ERROR                                              15200007
152100         IF  ASC-SML      >  ZEROES                               15210015
152200             MOVE  ASC-SML      TO  DK-SML-NBR                    15220015
152300             EXEC SQL                                             15230007
152400                  SELECT SHIPT_UNT_ID                             15240007
152500                    INTO :SUT00024-SHIPT-UNT-ID                   15250013
152600                    FROM SUT_OTBND_CART                           15260007
152700                  WHERE SHIPT_UNT_ID  =  :DK-SML-NBR              15270007
152800              END-EXEC                                            15280007
152900                                                                  15290007
153000              EVALUATE TRUE                                       15300007
153100                  WHEN SQLCODE = +0                               15310007
153200                       CONTINUE                                   15320007
153300                  WHEN SQLCODE = +100                             15330007
153400                       SET PS-ERROR                               15340007
153500                           DP020-MSG-FATAL         TO TRUE        15350007
153600                       MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER 15360007
153700                       MOVE DP015-UNP-ALP-BRT-OFF  TO ASMLA       15370007
153800                       MOVE DP015-RED              TO ASMLC       15380007
153900                       MOVE DP015-REVERSE          TO ASMLH       15390007
154000                       MOVE -1                     TO ASMLL       15400007
154100                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        15410007
154200                  WHEN OTHER                                      15420007
154300                      MOVE '3010-CHECK-SML-NBR    '               15430007
154400                                               TO DP013-PARAGRAPH 15440007
154500                      MOVE 'VALIDATE SML NUMBER '                 15450007
154600                                       TO DP013-MESSAGE-TEXT (1)  15460007
154700                      MOVE SQLCA   TO DP013-SQLCA                 15470007
154800                      MOVE 'OTBND CT' TO DP013-DB2-TABLE-NAME (1) 15480007
154900                      SET DP013-DB2-ABEND                         15490007
155000                          DP013-XCTL-DISPLAY-RESTART TO TRUE      15500007
155100                      PERFORM DP013-0000-PROCESS-ABEND            15510007
155200             END-EVALUATE                                         15520007
155300         END-IF                                                   15530007
155400     END-IF.                                                      15540007
155500                                                                  15550007
155501                                                                  15550157
155502 3012-GET-PROCESS-GRP-DESC.                                       15550257
155540     EXEC SQL                                                     15554057
155550         SELECT PRC_GP_DESC                                       15555057
155590           INTO :SUT00033-PRC-GP-DESC                             15559057
155594           FROM SUT_PRC_GP                                        15559457
155595          WHERE PRC_GP_CDE = :ASC-PROCESS-GROUP                   15559557
155596     END-EXEC.                                                    15559657
155597                                                                  15559757
155598     EVALUATE TRUE                                                15559857
155599         WHEN SQLCODE = +0                                        15559957
155600             CONTINUE                                             15560057
155601                                                                  15560157
155602         WHEN SQLWARN0 NOT = +0                                   15560257
155603         WHEN SQLCODE < +0                                        15560357
155604         WHEN SQLCODE > +0                                        15560457
155605             SET PS-ERROR    TO TRUE                              15560557
155606             MOVE '3012-GET-PROCESS-GRP-DESC' TO DP013-PARAGRAPH  15560657
155607             MOVE 'GET PROGESS GROUP DESCRIPTION '                15560757
155608                                       TO DP013-MESSAGE-TEXT (1)  15560857
155609             MOVE SQLCA      TO DP013-SQLCA                       15560957
155610             MOVE 'SUT_PRC_GP' TO DP013-DB2-TABLE-NAME (1)        15561057
155611             SET DP013-DB2-ABEND                                  15561157
155612                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15561257
155613             PERFORM DP013-0000-PROCESS-ABEND                     15561357
155614     END-EVALUATE.                                                15561457
155615                                                                  15561557
155616                                                                  15561657
155620*----------------------------------------------------------------*15562001
155700*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *15570001
155800*  MAP.                                                          *15580001
155900*----------------------------------------------------------------*15590001
156000 3200-RESET-ATTRIBUTES.                                           15600001
156100                                                                  15610001
156200     MOVE DP015-UNP-ALP-NOR-OFF  TO                               15620009
156300                                      AUNTADJA                    15630009
156400                                      ASTATUSA                    15640010
156500                                      AFRMNTHA                    15650010
156600                                      AFRDAYA                     15660010
156700                                      AFRYEARA                    15670010
156800                                      ATOMNTHA                    15680010
156900                                      ATODAYA                     15690010
157000                                      ATOYEARA                    15700010
157100                                                                  15710001
157200     MOVE DP015-UNP-NUM-NOR-OFF    TO                             15720001
157300                                      AOPERA                      15730010
157400                                      APOA                        15740010
157500                                      ARCVRA                      15750010
157600                                      ALINEA                      15760010
157700                                      ASTOREA                     15770010
157800                                      AAUDITA                     15780010
157900                                      AUPCA                       15790010
158000                                      ASKUA                       15800010
158100                                      ASMLA.                      15810010
158200                                                                  15820001
158300     MOVE DP015-GREEN              TO                             15830010
158400                                      AUNTADJC                    15840010
158500                                      ASTATUSC                    15850010
158600                                      AFRMNTHC                    15860010
158700                                      AFRDAYC                     15870010
158800                                      AFRYEARC                    15880010
158900                                      ATOMNTHC                    15890010
159000                                      ATODAYC                     15900010
159100                                      ATOYEARC                    15910010
159200                                      AOPERC                      15920010
159300                                      APOC                        15930010
159400                                      ARCVRC                      15940010
159500                                      ALINEC                      15950010
159600                                      ASTOREC                     15960010
159700                                      AAUDITC                     15970010
159800                                      AUPCC                       15980010
159900                                      ASKUC                       15990010
160000                                      ASMLC                       16000010
160100                                                                  16010001
160200     MOVE DP015-BLUE               TO AOPRNAMEC                   16020010
160300                                      ASTRNAMEC.                  16030010
160400                                                                  16040001
160500     MOVE DP015-UNDERLINE          TO                             16050010
160600                                      AUNTADJH                    16060010
160700                                      ASTATUSH                    16070010
160800                                      AFRMNTHH                    16080010
160900                                      AFRDAYH                     16090010
161000                                      AFRYEARH                    16100010
161100                                      ATOMNTHH                    16110010
161200                                      ATODAYH                     16120010
161300                                      ATOYEARH                    16130010
161400                                      AOPERH                      16140010
161500                                      APOH                        16150010
161600                                      ARCVRH                      16160010
161700                                      ALINEH                      16170010
161800                                      ASTOREH                     16180010
161900                                      AAUDITH                     16190010
162000                                      AUPCH                       16200010
162100                                      ASKUH                       16210010
162200                                      ASMLH.                      16220010
162300                                                                  16230010
162400*----------------------------------------------------------------*16240001
162500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *16250001
162600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *16260001
162700*  IT HERE.                                                      *16270001
162800*----------------------------------------------------------------*16280001
162900 4000-BUILD-INITIAL-PANEL.                                        16290001
163000     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        16300001
163100     MOVE -1                       TO APOL.                       16310010
163200                                                                  16320001
163300     INITIALIZE PV-USER-LOCATION.                                 16330001
163400     MOVE DP020-LOCATION-NBR       TO DK-CURR-OPER-UNT-ID         16340067
163600                                      ASC-CURR-OPER-UNT-ID-N.     16360001
163700     MOVE ASC-CURR-OPER-UNT-ID-N   TO DK-STORE-NBR.               16370001
163800     PERFORM 4100-GET-DFLT-ST-NAME.                               16380001
163900                                                                  16390001
164000     IF XLT00010-LOC-TYP-CDE = 'DC'                               16400067
164100         MOVE XLT00010-LOC-NBR         TO AOPERO                  16410067
164200                                          ASC-OPER-UNT-ID         16420028
164300         MOVE XLT00010-LOC-NM          TO AOPRNAMEO               16430067
164400                                          ASC-OPER-NAME           16440010
164500     ELSE                                                         16450010
164800         MOVE SPACES                   TO AOPRNAMEO               16480010
164900                                          ASC-OPER-NAME           16490010
164910                                          ASC-OPER-UNT-ID-X       16491024
164920         MOVE ASC-OPER-UNT-ID          TO AOPERO                  16492024
165000     END-IF.                                                      16500010
165100                                                                  16510001
165200     MOVE PV-CURR-MM               TO ATOMNTHO                    16520005
165300                                      ASC-TO-MM                   16530001
165400     MOVE PV-CURR-DD               TO ATODAYO                     16540005
165500                                      ASC-TO-DD                   16550001
165600     MOVE PV-CURR-YY               TO ATOYEARO                    16560005
165700                                      ASC-TO-YY                   16570001
165800                                                                  16580001
165900     PERFORM 4200-GET-DFLT-FROM-DATE.                             16590001
166000     MOVE PV-DFLT-MM               TO AFRMNTHO                    16600005
166100                                      ASC-FROM-MM                 16610001
166200     MOVE PV-DFLT-DD               TO AFRDAYO                     16620005
166300                                      ASC-FROM-DD                 16630001
166400     MOVE PV-DFLT-YY               TO AFRYEARO                    16640005
166500                                      ASC-FROM-YY                 16650001
166600                                                                  16660001
166700     MOVE 'A'                      TO AUNTADJO                    16670011
166800                                      ASC-UNT-ADJ-TYP.            16680011
166900     MOVE 'A'                      TO ASTATUSO                    16690066
167000                                      ASC-FAIL-SUCCESS-IND.       16700062
167010     MOVE 'A'                      TO AGROUPO                     16701062
167020                                      ASC-PROCESS-GROUP.          16702056
167100                                                                  16710010
167200*----------------------------------------------------------------*16720001
167300*       GET STORE NAME                                            16730001
167400*----------------------------------------------------------------*16740001
167500 4100-GET-DFLT-ST-NAME.                                           16750001
167600     INITIALIZE DCLXLT00010.                                      16760067
167700                                                                  16770001
167800     EXEC SQL                                                     16780001
167900         SELECT LOC_NBR                                           16790067
168000              , LOC_NM                                            16800067
168100              , LOC_TYP_CDE                                       16810068
168200              , CURRENT DATE                                      16820001
168300           INTO :XLT00010-LOC-NBR                                 16830067
168400              , :XLT00010-LOC-NM                                  16840067
168500              , :XLT00010-LOC-TYP-CDE                             16850067
168600              , :PV-CURRENT-DATE                                  16860001
168700           FROM XLT_LOC                                           16870067
168800          WHERE LOC_NBR  = :DK-STORE-NBR                          16880067
168900     END-EXEC.                                                    16890001
169000                                                                  16900001
169100     EVALUATE TRUE                                                16910001
169200         WHEN SQLCODE = +0                                        16920001
169300             CONTINUE                                             16930001
169400                                                                  16940001
169500         WHEN SQLWARN0 NOT = +0                                   16950001
169600         WHEN SQLCODE < +0                                        16960001
169700         WHEN SQLCODE > +0                                        16970001
169800             SET PS-ERROR    TO TRUE                              16980001
169900             MOVE '4100-GET-DFLT-ST-NAME'   TO DP013-PARAGRAPH    16990010
170000             MOVE 'UNSUCCESSFUL SELECT ON LOCATION TABLE'         17000067
170100                                       TO DP013-MESSAGE-TEXT (1)  17010010
170200             MOVE SQLCA      TO DP013-SQLCA                       17020001
170300             MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)          17030067
170400             SET DP013-DB2-ABEND                                  17040001
170500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17050001
170600             PERFORM DP013-0000-PROCESS-ABEND                     17060001
170700     END-EVALUATE.                                                17070001
170800                                                                  17080001
170900*----------------------------------------------------------------*17090001
171000*       GET DEFAULT FROM DATE                                     17100001
171100*----------------------------------------------------------------*17110001
171200 4200-GET-DFLT-FROM-DATE.                                         17120001
171300     EXEC SQL                                                     17130001
171400         SELECT CURRENT DATE - FUNC_QTY DAYS                      17140001
171500           INTO   :PV-DEFAULT-FROM-DATE                           17150001
171600           FROM  TKRPRPM                                          17160001
171700          WHERE LOC_ID            = :DK-CURR-OPER-UNT-ID          17170001
171800            AND INTFC_SYS_CDE     = 'KHL'                         17180001
171900            AND SYS_PRC_FUNC_CDE  = 'STADJD'                      17190010
172000            AND FUNC_PRC_STAT_CDE = 'AC'                          17200001
172100      END-EXEC.                                                   17210001
172200                                                                  17220001
172300       EVALUATE TRUE                                              17230001
172400          WHEN SQLCODE = +0                                       17240001
172500              CONTINUE                                            17250001
172600          WHEN OTHER                                              17260001
172700              SET PS-ERROR    TO TRUE                             17270001
172800              MOVE '4200-GET-DFLT-FROM-DATE ' TO DP013-PARAGRAPH  17280001
172900              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)17290001
173000              MOVE SQLCA   TO DP013-SQLCA                         17300001
173100              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         17310001
173200              SET DP013-DB2-ABEND                                 17320001
173300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              17330001
173400              PERFORM DP013-0000-PROCESS-ABEND                    17340001
173500      END-EVALUATE.                                               17350001
173600                                                                  17360010
173700**************************************************************    17370010
173800*  VALIDATE OPER UNIT ID OR STORE                            *    17380010
173900**************************************************************    17390010
174000 7010-STORE.                                                      17400001
174100                                                                  17410001
174200         EXEC SQL                                                 17420001
174300              SELECT LOC_NM                                       17430067
174310                    ,LOC_TYP_CDE                                  17431067
174400                INTO :XLT00010-LOC-NM                             17440067
174410                    ,:XLT00010-LOC-TYP-CDE                        17441067
174500                FROM XLT_LOC                                      17450067
174600               WHERE LOC_NBR  =  :DK-STORE-NBR                    17460067
174700          END-EXEC                                                17470001
174800                                                                  17480001
174900          EVALUATE TRUE                                           17490001
175000              WHEN SQLCODE = ZERO                                 17500001
175200              WHEN SQLCODE = +100                                 17520001
175300                   CONTINUE                                       17530001
175400              WHEN OTHER                                          17540001
175500                   MOVE '7010-STORE'           TO DP013-PARAGRAPH 17550001
175600                   MOVE 'VALIDATE OPER UNIT ID  '                 17560001
175700                                       TO DP013-MESSAGE-TEXT (1)  17570001
175800                      MOVE SQLCA   TO DP013-SQLCA                 17580001
175900                      MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1) 17590067
176000                      SET DP013-DB2-ABEND                         17600001
176100                          DP013-XCTL-DISPLAY-RESTART TO TRUE      17610001
176200                      PERFORM DP013-0000-PROCESS-ABEND            17620001
176300         END-EVALUATE.                                            17630067
176400                                                                  17640001
176500*----------------------------------------------------------------*17650001
176600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *17660001
176700*----------------------------------------------------------------*17670001
176800 8000-MOVE-COMMAREA-TO-SCREEN.                                    17680001
176900     MOVE ASC-UNT-ADJ-TYP          TO AUNTADJO.                   17690011
177000     MOVE ASC-FAIL-SUCCESS-IND     TO ASTATUSO.                   17700011
177010     MOVE ASC-PROCESS-GROUP        TO AGROUPO.                    17701055
177100     MOVE ASC-FROM-MM              TO AFRMNTHO.                   17710005
177200     MOVE ASC-FROM-DD              TO AFRDAYO.                    17720005
177300     MOVE ASC-FROM-YY              TO AFRYEARO.                   17730005
177400     MOVE ASC-TO-MM                TO ATOMNTHO.                   17740005
177500     MOVE ASC-TO-DD                TO ATODAYO.                    17750005
177600     MOVE ASC-TO-YY                TO ATOYEARO.                   17760005
177700     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     17770028
177800     MOVE ASC-OPER-NAME            TO AOPRNAMEO.                  17780010
177900     MOVE ASC-PO                   TO APOO.                       17790011
178000     MOVE ASC-RCVR                 TO ARCVRO.                     17800011
178100     MOVE ASC-LINE                 TO ALINEO.                     17810011
178200                                                                  17820001
178300     IF  ASC-STR-NBR    > ZEROES                                  17830017
178400         MOVE ASC-STR-NBR          TO ASTOREO                     17840017
178500         MOVE ASC-STR-NAME         TO ASTRNAMEO                   17850017
178600     ELSE                                                         17860001
178700         MOVE ZEROES               TO ASTOREO                     17870014
178800         MOVE SPACES               TO ASTRNAMEO                   17880014
178900     END-IF.                                                      17890001
179000                                                                  17900001
179100     MOVE ASC-AUDIT-NBR            TO AAUDITO.                    17910011
179200     MOVE ASC-UPC                  TO AUPCO.                      17920011
179300     MOVE ASC-SKU                  TO ASKUO.                      17930011
179400     MOVE ASC-SML                  TO ASMLO.                      17940011
179500                                                                  17950010
179600*----------------------------------------------------------------*17960001
179700*    ABEND PROCESSOR MODULE                                      *17970001
179800*----------------------------------------------------------------*17980001
179900     COPY DPPD013.                                                17990001
