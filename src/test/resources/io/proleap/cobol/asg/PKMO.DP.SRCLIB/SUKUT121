000110******************************************************************00011001
000120 IDENTIFICATION DIVISION.                                         00012001
000130******************************************************************00013001
000140                                                                  00014001
000150 PROGRAM-ID.    SUKUT121.                                         00015053
000160 AUTHOR.        PAUL JORGENSEN.                                   00016068
000170 INSTALLATION.  KOHLS.                                            00017001
000180 DATE-WRITTEN   AUGUST, 2008.                                     00018052
000190 DATE-COMPILED.                                                   00019001
000191                                                                  00019101
000192******************************************************************00019201
000193*  THIS PROGRAM WILL CREATE AN EXTRACT FILE CONTAINING THE        00019352
000194*  ORDER/RECEIVER SEQUENCE NUMBER TO BE DELETED FROM THE TLBVRMG  00019468
000195*  TABLE.                                                         00019502
000196******************************************************************00019602
000197******************************************************************00019702
000198 ENVIRONMENT DIVISION.                                            00019802
000199******************************************************************00019902
000200 CONFIGURATION SECTION.                                           00020015
000201                                                                  00020115
000203 SOURCE-COMPUTER.        IBM-3090.                                00020315
000204 OBJECT-COMPUTER.        IBM-3090.                                00020415
000205                                                                  00020515
000206 INPUT-OUTPUT SECTION.                                            00020615
000207                                                                  00020715
000208 FILE-CONTROL.                                                    00020815
000209*                                                                 00020915
000210     SELECT UNLOAD-FILE                                           00021055
000211         ASSIGN TO INP01.                                         00021115
000212                                                                  00021215
000213     SELECT EXTRACT-FILE                                          00021399
000214         ASSIGN TO OUT01.                                         00021415
000215                                                                  00021515
000216     SELECT TIMESTAMP-FILE                                        00021699
000217         ASSIGN TO OUT02.                                         00021799
000218                                                                  00021899
000219*                                                                 00021915
000220******************************************************************00022002
000221 DATA DIVISION.                                                   00022102
000222******************************************************************00022202
000223*                                                                 00022302
000224 FILE SECTION.                                                    00022415
000225*                                                                 00022515
000226 FD  UNLOAD-FILE                                                  00022656
000227     RECORDING MODE IS F                                          00022715
000228     RECORD CONTAINS 34 CHARACTERS                                00022899
000229     LABEL RECORDS ARE STANDARD                                   00022915
000230     DATA RECORD IS UNLOAD-RECORD.                                00023099
000231 01  UNLOAD-RECORD                 PIC X(34).                     00023199
000232                                                                  00023215
000233 FD  EXTRACT-FILE                                                 00023356
000234     RECORDING MODE IS F                                          00023415
000235     RECORD CONTAINS 34 CHARACTERS                                00023599
000236     LABEL RECORDS ARE OMITTED                                    00023615
000237     DATA RECORD IS EXTRACT-RECORD.                               00023758
000238 01  EXTRACT-RECORD                 PIC X(34).                    00023899
000239                                                                  00023999
000240 FD  TIMESTAMP-FILE                                               00024099
000241     RECORDING MODE IS F                                          00024199
000242     LABEL RECORDS ARE STANDARD                                   00024299
000243     BLOCK CONTAINS 0 RECORDS.                                    00024399
000244                                                                  00024499
000245 01  TIMESTAMP-RECORD.                                            00024599
000246     05  TR-CONTROL-TMST            PIC X(26).                    00024699
000260     05  FILLER                     PIC X(01).                    00026099
000261     05  TR-CONTROL-TMST2           PIC X(26).                    00026199
000262     05  FILLER                     PIC X(07).                    00026299
000263                                                                  00026399
000264*                                                                 00026415
000265******************************************************************00026502
000266 WORKING-STORAGE SECTION.                                         00026602
000267******************************************************************00026702
000268*                                                                 00026802
000269******************************************************************00026902
000270*  DB2 FORMATTED MESSAGE AREA                                     00027002
000271******************************************************************00027102
000272     COPY DPWS004.                                                00027202
000273                                                                  00027302
000274******************************************************************00027402
000275*    COMMUNICATIONS AREA FOR DB2                                  00027502
000276******************************************************************00027602
000277                                                                  00027702
000278     EXEC SQL                                                     00027802
000279          INCLUDE SQLCA                                           00027902
000280     END-EXEC.                                                    00028002
000281                                                                  00028102
000282******************************************************************00028202
000283*                                                                 00028302
000284 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00028402
000285                                                   COMP SYNC.     00028502
000286                                                                  00028602
000287 01  PS-PROGRAM-SWITCHES.                                         00028702
000288     05  PS-END-OF-FILE-SW           PIC X(03)     VALUE 'N'.     00028820
000289         88  PS-END-OF-FILE                        VALUE 'Y'.     00028920
000290     05  PS-FIRST-TIME-SW            PIC X(01)     VALUE 'N'.     00029020
000291         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     00029120
000292         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00029220
000293     05  PS-EOF-PROCESS-SW          PIC  X(01)    VALUE 'N'.      00029302
000294         88  PS-EOF-PROCESS-YES                    VALUE 'Y'.     00029462
000295         88  PS-EOF-PROCESS-NO                     VALUE 'N'.     00029502
000296                                                                  00029620
000297                                                                  00029720
000298 01  PC-PROGRAM-CONSTANTS.                                        00029820
000299     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     00029920
000300                                                   COMP SYNC.     00030020
000301     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00030123
000302         'SUKUT121'.                                              00030299
000303     05  PC-CURRENT-OPERATING-COMPANY                             00030320
000304                                     PIC  X(02)    VALUE '03'.    00030420
000305     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       00030520
000306                                                   COMP SYNC.     00030620
000307                                                                  00030720
000308 01  PV-PROGRAM-VARIABLES.                                        00030820
000309     05  PV-DELETE-TMST              PIC  X(26)    VALUE SPACES.  00030999
000310     05  PV-MAX-DELETE-TMST          PIC  X(26)    VALUE SPACES.  00031099
000311     05  PV-SQL-RETURN-CD            PIC 999-.                    00031199
000312     05  PV-CICS-MSG-AREA            PIC  X(80)    VALUE SPACES.  00031299
000313     05  PV-COMMAREA-LENGTH          PIC S9(04)    VALUE +0       00031399
000314                                                   COMP SYNC.     00031499
000315     05  PV-CICS-RESPONSE            PIC S9(9)     VALUE ZERO     00031599
000316                                                   COMP SYNC.     00031699
000317                                                                  00031799
000318     05  PV-PO-NBR-MSG.                                           00031899
000319         10  FILLER                  PIC  X(09)    VALUE          00031999
000320         'PO NBR = '.                                             00032099
000321         10  PV-PO-NBR               PIC  9(09).                  00032199
000322     05  PV-REC-SEQ-NBR-MSG.                                      00032299
000323         10  FILLER                  PIC  X(15)    VALUE          00032399
000324         'RECEIVER NBR = '.                                       00032499
000325         10  PV-REC-SEQ-NBR          PIC  9(04).                  00032599
000326     05  PV-DONE-PROCESSING-SW       PIC  X(01)    VALUE 'N'.     00032699
000327         88  PV-DONE-PROCESSING                    VALUE 'Y'.     00032799
000328     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACE.   00032899
000329     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  00032999
000330     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00033099
000331                                                                  00033199
000332     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00033299
000333                                                   COMP SYNC.     00033399
000334     05  PV-ABEND-PARA-NAME          PIC X(30)     VALUE SPACES.  00033499
000335     05  PV-DB2-OPERATION-MSG-1      PIC X(40)     VALUE SPACES.  00033599
000336     05  PV-DB2-OPERATION-MSG-2      PIC X(40)     VALUE SPACES.  00033699
000337     05  PV-DB2-TABLE-NAME-1         PIC X(15)     VALUE SPACES.  00033799
000338     05  PV-DB2-TABLE-NAME-2         PIC X(15)     VALUE SPACES.  00033899
000339     05  PV-DB2-TABLE-NAME-3         PIC X(15)     VALUE SPACES.  00033999
000340     05  PV-SQLCODE                  PIC Z(8)9-.                  00034099
000341                                                                  00034199
000342                                                                  00034299
000343     05  PV-KEEP-DAYS                PIC S9(08)    COMP VALUE +0. 00034399
000344     05  PV-MAX-KEEP-DAYS            PIC S9(08)    COMP VALUE +0. 00034499
000345     05  PV-KEEP-DAYS-DISPLAY        PIC ZZZ,ZZZ,ZZ9.             00034599
000346     05  PV-MAX-KEEP-DAYS-DISPLAY    PIC ZZZ,ZZZ,ZZ9.             00034699
000347     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             00034747
000348                                                                  00034847
000349     05  PV-RECORDS-READ             PIC S9(07)    COMP-3         00034991
000350                                                   VALUE ZEROS.   00035047
000351     05  PV-RECORDS-DELETE-VE        PIC S9(07)    COMP-3         00035173
000352                                                   VALUE ZEROS.   00035247
000353     05  PV-RECORDS-DELETE-DE        PIC S9(07)    COMP-3         00035373
000354                                                   VALUE ZEROS.   00035473
000355     05  PV-RECORDS-DELETE-ACT       PIC S9(07)    COMP-3         00035573
000356                                                   VALUE ZEROS.   00035673
000357     05  PV-RECORDS-REUSE-ACT        PIC S9(07)    COMP-3         00035799
000358                                                   VALUE ZEROS.   00035899
000362 01  SD-SYSTEM-DATE.                                              00036247
000363     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  00036347
000364     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  00036447
000365     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  00036547
000366                                                                  00036647
000367 01  ST-SYSTEM-TIME.                                              00036747
000368     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   00036847
000369     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   00036947
000370     05  FILLER                     PIC  9(04)      VALUE ZERO.   00037047
000371                                                                  00037147
000372******************************************************************00037247
000373*    ABEND PROCESSING COPYBOOK.                                   00037347
000374******************************************************************00037447
000375                                                                  00037547
000376     COPY DPWS013.                                                00037647
000377                                                                  00037747
000378     EJECT                                                        00037847
000379******************************************************************00037947
000380*    OUTPUT RECORD LAYOUT.                                        00038047
000381******************************************************************00038147
000382                                                                  00038247
000383     COPY SURD078.                                                00038358
000384                                                                  00038447
000385******************************************************************00038547
000386*    DB2 AREA FOR THE RECEIVER TABLE.                             00038658
000387******************************************************************00038747
000388                                                                  00038847
000389     EXEC SQL                                                     00038947
000390         INCLUDE TRECEIV                                          00039058
000391     END-EXEC.                                                    00039147
000392                                                                  00039247
000393******************************************************************00039359
000394*  SQL AND COBOL DECLARATIONS FOR WST_INTGRTN_TYP                 00039459
000395******************************************************************00039559
000396     EXEC SQL                                                     00039659
000397          INCLUDE WST00008                                        00039759
000398     END-EXEC.                                                    00039859
000399******************************************************************00039959
000400*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_DEFN                   00040059
000401******************************************************************00040159
000402     EXEC SQL                                                     00040259
000403          INCLUDE WST00009                                        00040359
000404     END-EXEC.                                                    00040459
000405******************************************************************00040559
000406*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_ELEM                   00040659
000407******************************************************************00040759
000408     EXEC SQL                                                     00040859
000409          INCLUDE WST00010                                        00040959
000410     END-EXEC.                                                    00041059
000420                                                                  00042059
000460                                                                  00046027
000461******************************************************************00046127
000462 PROCEDURE DIVISION.                                              00046227
000463******************************************************************00046327
000464*                                                                 00046427
000465******************************************************************00046527
000466* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     00046627
000467*      PROGRAM.                                                   00046727
000468******************************************************************00046827
000469 0000-PROGRAM-MAINLINE.                                           00046927
000470*                                                                 00047027
000471     DISPLAY '**** START OF SUKUT121 ****'.                       00047199
000472     DISPLAY ' '.                                                 00047227
000473                                                                  00047327
000474      PERFORM 1000-INITIALIZE                                     00047427
000475      PERFORM 2000-MAIN-PROCESS                                   00047527
000476              UNTIL PS-EOF-PROCESS-YES                            00047699
000477      PERFORM 9000-END-PROCESS.                                   00047727
000478*                                                                 00047827
000479     STOP RUN.                                                    00047927
000480*                                                                 00048027
000481******************************************************************00048127
000482*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    00048227
000483*    -- OPEN FILES                                                00048327
000484******************************************************************00048427
000485 1000-INITIALIZE.                                                 00048527
000486                                                                  00048627
000487     OPEN INPUT  UNLOAD-FILE                                      00048760
000488         OUTPUT  EXTRACT-FILE                                     00048899
000489                 TIMESTAMP-FILE.                                  00048999
000490                                                                  00049099
000493*READ FIRST INPUT RECORD.                                         00049327
000494     PERFORM 7000-READ-UNLOAD-FILE.                               00049460
000495     IF PS-EOF-PROCESS-NO                                         00049599
000496         EXEC SQL                                                 00049699
000505         SELECT INT(C.ATTR_ELEM_NBR)                              00050599
000506              , CURRENT TIMESTAMP - (C.ATTR_ELEM_NBR) DAYS        00050699
000507              , INT(D.ATTR_ELEM_NBR)                              00050799
000508              , CURRENT TIMESTAMP - (D.ATTR_ELEM_NBR) DAYS        00050899
000509           INTO :PV-KEEP-DAYS                                     00050999
000510              , :PV-DELETE-TMST                                   00051099
000511              , :PV-MAX-KEEP-DAYS                                 00051199
000512              , :PV-MAX-DELETE-TMST                               00051299
000513           FROM WST_INTGRTN_TYP   A                               00051399
000514              , WST_ATTR_DEFN     B                               00051499
000515              , WST_ATTR_ELEM     C                               00051599
000516              , WST_ATTR_ELEM     D                               00051699
000517          WHERE A.INTGRTN_TYP_CDE    =  'MSGPURGE'                00051799
000518            AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE         00051899
000519            AND B.ATTR_DEFN_SEQ_NBR  =  1                         00051999
000520            AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE         00052099
000521            AND C.ATTR_DEFN_SEQ_NBR  =  1                         00052199
000522            AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE         00052299
000523            AND D.ATTR_DEFN_SEQ_NBR  =  2                         00052399
000524            AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR       00052499
000525         END-EXEC                                                 00052599
000526                                                                  00052699
000527         EVALUATE TRUE                                            00052799
000528             WHEN SQLCODE = ZERO                                  00052899
000529                  MOVE PV-KEEP-DAYS TO PV-KEEP-DAYS-DISPLAY       00052999
000530                  DISPLAY '**** NUMBER OF DAYS TO KEEP...: '      00053099
000531                                       PV-KEEP-DAYS-DISPLAY       00053199
000532                  DISPLAY '**** TIMESTAMP USED FOR DELETE: '      00053299
000533                                       PV-DELETE-TMST             00053399
000534                  MOVE PV-MAX-KEEP-DAYS TO                        00053499
000535                                       PV-MAX-KEEP-DAYS-DISPLAY   00053599
000536                  DISPLAY '**** NUMBER OF DAYS RE-USE....: '      00053699
000537                                       PV-KEEP-DAYS-DISPLAY       00053799
000538                  DISPLAY '**** TIMESTAMP FOR REUSE DELET: '      00053899
000539                                       PV-MAX-DELETE-TMST         00053999
000540                  PERFORM 7300-WRITE-TIMESTAMP                    00054099
000541             WHEN OTHER                                           00054199
000542                  MOVE '1000-INITIALIZE         '                 00054299
000543                                    TO PV-ABEND-PARA-NAME         00054399
000544                  MOVE 'SQL ERROR SELECT DELETE PARAMETERS'       00054499
000545                                    TO PV-DB2-OPERATION-MSG-1     00054599
000546                  MOVE 'WST_INTGRTN_TYP' TO PV-DB2-TABLE-NAME-1   00054699
000547                  MOVE 'WST_ATTR_DEFN'   TO PV-DB2-TABLE-NAME-2   00054799
000548                  MOVE 'WST_ATTR_ELEM'   TO PV-DB2-TABLE-NAME-3   00054899
000549                  PERFORM 9998-SQL-ABEND                          00054999
000550         END-EVALUATE                                             00055099
000551     END-IF.                                                      00055199
000552*                                                                 00055299
000553 2000-MAIN-PROCESS.                                               00055399
000560*                                                                 00056027
000595     EXEC SQL                                                     00059566
000596     SELECT A.STATUS_CDE                                          00059666
000597          , A.VERFYD_TMST                                         00059766
000606       INTO :RECEIV-STATUS-CDE                                    00060690
000607          , :RECEIV-VERFYD-TMST                                   00060799
000610       FROM TRECEIV  A                                            00061099
000614      WHERE ORD_NBR              =  :SU078-PO-NBR                 00061467
000615        AND REC_SEQ_NBR          =  :SU078-RCVR                   00061568
000621     END-EXEC.                                                    00062167
000622                                                                  00062267
000623     EVALUATE TRUE                                                00062325
000624         WHEN SQLCODE = ZERO                                      00062425
000625             EVALUATE RECEIV-STATUS-CDE                           00062585
000626                 WHEN 'DE'                                        00062685
000627                     PERFORM 7200-WRITE-EXTRACT-RECORD            00062786
000628                     ADD +1         TO PV-RECORDS-DELETE-DE       00062899
000629                 WHEN 'VE'                                        00062987
000630                     IF RECEIV-VERFYD-TMST < PV-DELETE-TMST       00063087
000631                         PERFORM 7200-WRITE-EXTRACT-RECORD        00063187
000632                         ADD +1     TO PV-RECORDS-DELETE-VE       00063299
000633                     END-IF                                       00063387
000634                 WHEN OTHER                                       00063499
000635                     IF  SU078-CRE-TMST  <  PV-MAX-DELETE-TMST    00063599
000636                         MOVE PV-MAX-DELETE-TMST                  00063699
000637                                              TO SU078-CRE-TMST   00063799
000638                         PERFORM 7200-WRITE-EXTRACT-RECORD        00063899
000639                         ADD +1        TO PV-RECORDS-REUSE-ACT    00063999
000640                  END-IF                                          00064099
000641             END-EVALUATE                                         00064199
000642         WHEN SQLCODE = +100                                      00064299
000643              IF SU078-RCVR = 0                                   00064399
000644                  IF SU078-CRE-TMST < PV-DELETE-TMST              00064499
000645                      MOVE PV-DELETE-TMST  TO SU078-CRE-TMST      00064599
000646                      PERFORM 7200-WRITE-EXTRACT-RECORD           00064699
000647                      ADD +1        TO PV-RECORDS-DELETE-ACT      00064799
000648                  END-IF                                          00064899
000649              ELSE                                                00064999
000650                  PERFORM 7200-WRITE-EXTRACT-RECORD               00065099
000651                  ADD +1            TO PV-RECORDS-DELETE-ACT      00065199
000652              END-IF                                              00065299
000653         WHEN OTHER                                               00065399
000654           MOVE '2000-MAIN-PROCESS         '                      00065499
000655                                    TO PV-ABEND-PARA-NAME         00065599
000656           MOVE SU078-PO-NBR        TO PV-PO-NBR                  00065699
000657           MOVE SU078-RCVR          TO PV-REC-SEQ-NBR             00065799
000658           MOVE PV-PO-NBR-MSG       TO PV-DB2-OPERATION-MSG-1     00065899
000659           MOVE PV-REC-SEQ-NBR-MSG  TO PV-DB2-OPERATION-MSG-2     00065999
000660           MOVE 'TRECEIV'           TO PV-DB2-TABLE-NAME-1        00066099
000661           MOVE SPACES              TO PV-DB2-TABLE-NAME-2        00066199
000662                                       PV-DB2-TABLE-NAME-3        00066299
000663           PERFORM 9998-SQL-ABEND                                 00066399
000664     END-EVALUATE.                                                00066499
000665                                                                  00066599
000670     PERFORM 7000-READ-UNLOAD-FILE.                               00067078
000696*                                                                 00069619
000697 7000-READ-UNLOAD-FILE.                                           00069760
000698******************************************************************00069813
000702     READ UNLOAD-FILE INTO SU078-EXTRACT-RECORD                   00070261
000703        AT END                                                    00070313
000704           SET PS-EOF-PROCESS-YES      TO TRUE                    00070462
000705        NOT AT END                                                00070513
000708            ADD  +1                    TO PV-RECORDS-READ         00070899
000709     END-READ.                                                    00070913
000710*                                                                 00071013
000721******************************************************************00072113
000722*  WRITE EXTRACT RECORD                                          *00072281
000723******************************************************************00072313
000724 7200-WRITE-EXTRACT-RECORD.                                       00072481
000725*                                                                 00072513
000726     WRITE EXTRACT-RECORD                                         00072690
000727         FROM SU078-EXTRACT-RECORD.                               00072799
000737                                                                  00073713
000738******************************************************************00073899
000739*  WRITE TIMESTAMP RECORD                                         00073999
000741***************************************************************** 00074199
000742 7300-WRITE-TIMESTAMP.                                            00074299
000743     INITIALIZE TIMESTAMP-RECORD.                                 00074399
000744     MOVE  PV-DELETE-TMST          TO  TR-CONTROL-TMST.           00074499
000745     MOVE  PV-MAX-DELETE-TMST      TO  TR-CONTROL-TMST2.          00074599
000746                                                                  00074699
000747     WRITE TIMESTAMP-RECORD.                                      00074799
000748                                                                  00074899
000749***************************************************************** 00074999
000750*     CLOSE FILES.                                              * 00075099
000751***************************************************************** 00075199
000752 9000-END-PROCESS.                                                00075299
000753     CLOSE UNLOAD-FILE                                            00075391
000754           EXTRACT-FILE                                           00075499
000755           TIMESTAMP-FILE.                                        00075599
000756*                                                                 00075699
000757     DISPLAY '**********************************'.                00075799
000758     DISPLAY '** SUKUT121 SUMMARY **'.                            00075899
000759     MOVE PV-RECORDS-READ       TO PV-DISPLAY-COUNT               00075999
000760     DISPLAY 'TOTAL INPUT RECORDS         = ' PV-DISPLAY-COUNT   .00076099
000761     MOVE PV-RECORDS-DELETE-VE  TO PV-DISPLAY-COUNT               00076199
000762     DISPLAY 'TOTAL VE STATUS DELETES     = ' PV-DISPLAY-COUNT   .00076299
000763     MOVE PV-RECORDS-DELETE-DE  TO PV-DISPLAY-COUNT               00076399
000764     DISPLAY 'TOTAL DE STATUS DELETES     = ' PV-DISPLAY-COUNT   .00076499
000765     MOVE PV-RECORDS-DELETE-ACT TO PV-DISPLAY-COUNT               00076599
000766     DISPLAY 'TOTAL DELETED RCVR DELETES  = ' PV-DISPLAY-COUNT   .00076699
000767     MOVE PV-RECORDS-REUSE-ACT  TO PV-DISPLAY-COUNT               00076799
000768     DISPLAY 'TOTAL RE-USE RCVR DELETED   = ' PV-DISPLAY-COUNT   .00076899
000769     DISPLAY '**********************************'.                00076999
000770*                                                                 00077099
000771******************************************************************00077199
000772*     SQL ERROR PROCESSING                                      **00077299
000773******************************************************************00077399
000774 9998-SQL-ABEND.                                                  00077499
000775     MOVE SQLCODE     TO PV-SQLCODE.                              00077599
000776     DISPLAY '** ABEND              ** = SQLABEND'.               00077699
000777     DISPLAY '** PROGRAM            ** = ' PC-PROGRAM-NAME.       00077799
000778     DISPLAY '** PARAGRAPH          ** = ' PV-ABEND-PARA-NAME     00077899
000779     DISPLAY '** 1ST TABLE AFFECTED ** = ' PV-DB2-TABLE-NAME-1.   00077999
000780     DISPLAY '** 2ND TABLE AFFECTED ** = ' PV-DB2-TABLE-NAME-2.   00078099
000781     DISPLAY '** 3RD TABLE AFFECTED ** = ' PV-DB2-TABLE-NAME-3.   00078199
000782     DISPLAY '** OPERATIONAL MSG    ** = ' PV-DB2-OPERATION-MSG-1.00078299
000783     DISPLAY '** OPERATIONAL MSG    ** = ' PV-DB2-OPERATION-MSG-2.00078399
000784     DISPLAY '** SQLCODE            ** = ' PV-SQLCODE.            00078499
000785     COPY DPPD004.                                                00078599
000786                                                                  00078699
000787     MOVE +4013                  TO PV-ABEND-CODE.                00078799
000788     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       00078899
000789*                                                                 00078999
000790                                                                  00079013
