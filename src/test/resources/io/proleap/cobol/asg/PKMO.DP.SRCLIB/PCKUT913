000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             PCKUT913.                                00050000
000600 AUTHOR.                 RON KRIER.                               00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            FEBRUARY, 2017.                          00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM STARTED AS A COPY OF SUKUT116.  THE PURPOSE OF    *00120000
001300* THIS PROGRAM IS TO TAKE IN A FILE OF SML NUMBERS AND CALL THE  *00130000
001400* PCKUT713 CARTON STATUS MODULE AND THEN DISPLAY THE DATA        *00140000
001410* RETURNED FROM THAT CALL VIA THE PCWS046 COPYBOOK.              *00141000
001420* THIS SERVES AS A PROGRAM TO SEE WHAT THE CARTON STATUS MODULE  *00142000
001430* WOULD RETURN FOR SML NUMBERS.                                  *00143000
001500*----------------------------------------------------------------*00150000
001600                                                                  00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900******************************************************************00190000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100                                                                  00210000
002200 FILE-CONTROL.                                                    00220000
002300                                                                  00230000
002400     SELECT SML-INPUT-FILE        ASSIGN TO INP01.                00240000
002600                                                                  00260000
002700******************************************************************00270000
002800 DATA DIVISION.                                                   00280000
002900******************************************************************00290000
003000 FILE SECTION.                                                    00300000
003100*                                                                 00310000
003200*                                                                 00320000
003300 FD  SML-INPUT-FILE                                               00330000
003400     RECORDING MODE IS F                                          00340000
003500     LABEL RECORDS ARE STANDARD                                   00350000
003600     BLOCK CONTAINS 0 RECORDS.                                    00360000
003700 01  SML-INPUT-RECORD            PIC X(50).                       00370000
004400                                                                  00440000
004500***************************************************************** 00450000
004600 WORKING-STORAGE SECTION.                                         00460000
004700                                                                  00470000
004800 01  PS-PROGRAM-SWITCHES.                                         00480000
004900     05  PS-END-OF-PO-CSR-SW      PIC X(01)   VALUE 'N'.          00490000
005000         88  PS-EOC-PO-CSR                    VALUE 'Y'.          00500000
005100         88  PS-NOT-EOC-PO-CSR                VALUE 'N'.          00510000
005200     05  PS-END-OF-INPUT-SW       PIC X(01)   VALUE 'N'.          00520000
005300         88  PS-END-OF-INPUT-FILE             VALUE 'Y'.          00530000
005400         88  PS-NOT-END-OF-INPUT-FILE         VALUE 'N'.          00540000
005500     05  PS-CHECK-DISTHD-SW       PIC X(01)   VALUE 'N'.          00550000
005600         88  PS-CHECK-DISTHD                  VALUE 'Y'.          00560000
005700         88  PS-DONT-CHECK-DISTHD             VALUE 'N'.          00570000
005710     05  PS-ROW-FOUND-SW          PIC X(01)   VALUE 'Y'.          00571000
005720         88  PS-ROW-FOUND-NO                  VALUE 'N'.          00572000
005730         88  PS-ROW-FOUND-YES                 VALUE 'Y'.          00573000
005740*                                                                 00574000
005750 01  PV-PROGRAM-VARIABLES.                                        00575000
005760     05  PV-SAVE-PO-NBR               PIC S9(9) COMP VALUE ZERO.  00576000
005770     05  PV-SAVE-RCVR-SEQ-NBR         PIC S9(9) COMP VALUE ZERO.  00577000
005780     05  PV-ACTIVE-CARTONS            PIC S9(9) COMP VALUE ZERO.  00578000
005790     05  PV-INACTIVE-CARTONS          PIC S9(9) COMP VALUE ZERO.  00579000
005800     05  PV-DB2-TABLE-NAME            PIC  X(08) VALUE SPACES.    00580000
005900     05  PV-DB2-TABLE-NAME1           PIC  X(08) VALUE SPACES.    00590000
006000     05  PV-DB2-TABLE-NAME2           PIC  X(08) VALUE SPACES.    00600000
006100     05  PV-DISP-FIELD-1              PIC  9(18).                 00610000
006200     05  PV-DISP-FIELD-2              PIC  9(18).                 00620000
006300     05  PV-DISP-FIELD-3              PIC  9(18).                 00630000
006400                                                                  00640000
006500     05  PV-READ-COUNTER              PIC S9(09) VALUE ZERO       00650000
006600                                                  COMP SYNC.      00660000
006700     05  PV-FETCH-COUNTER             PIC S9(09) VALUE ZERO       00670000
006800                                                  COMP SYNC.      00680000
006900     05  PV-WRITE-COUNTER             PIC S9(09) VALUE ZERO       00690000
007000                                                  COMP SYNC.      00700000
007100     05  PV-UNT-QTY-SUM               PIC S9(09) VALUE ZERO       00710000
007200                                                  COMP.           00720000
007300     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00730000
007400                                                                  00740000
007500     05  PV-DISPLAY-PO-NBR               PIC 999999999-.          00750000
007600     05  PV-DISPLAY-PO-LINE-NBR          PIC 999999999-.          00760000
007700     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 999999999-.          00770000
007710     05  PV-DISPLAY-4-DIGIT              PIC ZZZ9.                00771001
007720     05  PV-DISPLAY-9-DIGIT              PIC ZZZZZZZZ9.           00772001
007730     05  PV-DISPLAY-18-DIGIT             PIC ZZZZZZZZZZZZZZZZZ9.  00773001
007800                                                                  00780000
007900 01  DK-DB-KEYS.                                                  00790000
008000     05  DK-SHIPT-UNT-ID             PIC S9(18)V COMP-3.          00800000
008100     05  DK-PO-NBR                   PIC S9(09) COMP.             00810000
008200     05  DK-REC-SEQ-NBR              PIC S9(09) COMP.             00820000
008300     05  DK-LINE-NBR                 PIC S9(09) VALUE ZERO COMP.  00830002
008310                                                                  00831000
008320 01  IR-INPUT-RECORD.                                             00832000
008330     05  IR-CARTON-NUMBER            PIC 9(18) VALUE ZERO.        00833000
008340     05  IR-FILLER                   PIC X(32) VALUE SPACES.      00834000
008500                                                                  00850000
008600 01 PC-PROGRAM-CONSTANTS.                                         00860000
008700     05  PC-CRTN-STATUS-PGM          PIC  X(08)    VALUE          00870000
008800         'PCKUT713'.                                              00880000
008900     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'PCKUT913'. 00890000
009000                                                                  00900000
009100 01  PV-ABEND-FIELDS.                                             00910000
009200     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00920000
009300     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         00930000
009400                                                 COMP SYNC.       00940000
009500     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'PCKUT913'.00950000
009600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00960000
009700     05  PV-ABEND-OPERATION1          PIC  X(51) VALUE SPACES.    00970000
009800     05  PV-ABEND-OPERATION2          PIC  X(51) VALUE SPACES.    00980000
009900     05  PV-ABEND-OPERATION3          PIC  X(51) VALUE SPACES.    00990000
010000                                                                  01000000
010600*COPYBOOK FOR CARTON STATUS MODULE - PCKUT713                     01060000
010700     COPY PCWS046.                                                01070000
010800                                                                  01080000
010900*----------------------------------------------------------------*01090000
011000*    ABEND PROCESSING COPYBOOK.                                  *01100000
011100*----------------------------------------------------------------*01110000
011200                                                                  01120000
011300     COPY DPWS013.                                                01130000
011400                                                                  01140000
015400*DB2 AREA FOR SUT_OTBND_CART TABLE                                01540000
015500     EXEC SQL                                                     01550000
015600          INCLUDE SUT00024                                        01560000
015700     END-EXEC.                                                    01570000
015800******************************************************************01580000
015900*   DB2 SQL COMMUNICATION AREA                                    01590000
016000******************************************************************01600000
016100     EXEC SQL                                                     01610000
016200          INCLUDE SQLCA                                           01620000
016300     END-EXEC.                                                    01630000
016400                                                                  01640000
016500*DB2 AREA FOR COMMUNICATIONS AREA2                                01650000
016600     COPY SQLCA2.                                                 01660000
019900                                                                  01990000
020000 EJECT                                                            02000000
020100                                                                  02010000
020200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 02020000
020300 PROCEDURE DIVISION.                                              02030000
020400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 02040000
020500                                                                  02050000
020600***************************************************************** 02060000
020700 0000-MAINLINE.                                                   02070000
020800***************************************************************** 02080000
020900     DISPLAY '***BEGINNING PCKUT913***'.                          02090000
021000     PERFORM 1000-INITIALIZE.                                     02100000
021100                                                                  02110000
021200     PERFORM 2000-PROCESS-SML-FILE                                02120000
021300         UNTIL PS-END-OF-INPUT-FILE.                              02130000
021400                                                                  02140000
021500     MOVE PV-READ-COUNTER TO PV-DISPLAY-COUNT.                    02150000
021600     DISPLAY 'TOTAL RECORDS READ    '          PV-DISPLAY-COUNT.  02160000
021700                                                                  02170000
022400     CLOSE SML-INPUT-FILE.                                        02240000
022600                                                                  02260000
022700     GOBACK.                                                      02270000
022800                                                                  02280000
022900                                                                  02290000
023000***************************************************************** 02300000
023100 1000-INITIALIZE.                                                 02310000
023200***************************************************************** 02320000
023300     SET PS-NOT-END-OF-INPUT-FILE TO TRUE.                        02330000
023400                                                                  02340000
023500     OPEN INPUT  SML-INPUT-FILE.                                  02350000
023700                                                                  02370000
023800*FIRST READ                                                       02380000
023900     PERFORM 7100-READ-INPUT-FILE                                 02390000
024000                                                                  02400000
024100     IF PS-END-OF-INPUT-FILE                                      02410000
024200         DISPLAY '** INPUT FILE IS EMPTY **'                      02420000
024300     END-IF.                                                      02430000
024400                                                                  02440000
024500                                                                  02450000
024600***************************************************************** 02460000
024700 2000-PROCESS-SML-FILE.                                           02470000
024800***************************************************************** 02480000
024900     MOVE '2000-PROCESS-EXTRACTS   ' TO PV-ABEND-PARAGRAPH.       02490000
025000                                                                  02500000
025100     INITIALIZE PC046-COMMAREA-REC.                               02510000
025200                                                                  02520000
025300     MOVE IR-CARTON-NUMBER      TO PC046-CARTON-ID                02530000
025400                                   DK-SHIPT-UNT-ID.               02540000
025410                                                                  02541000
025502     PERFORM 2100-SELECT-CARTON.                                  02550200
025510                                                                  02551000
026100*NEXT READ                                                        02610000
026200     PERFORM 7100-READ-INPUT-FILE.                                02620000
026300                                                                  02630000
026400 2100-SELECT-CARTON.                                              02640000
026500                                                                  02650000
026600     MOVE PC-PROGRAM-NAME TO PC046-CALLING-PGM-NME                02660000
026700     CALL PC-CRTN-STATUS-PGM                                      02670000
026800        USING PC046-COMMAREA-REC.                                 02680000
026900                                                                  02690000
027000     IF  PC046-SUCCESSFUL                                         02700000
027100         PERFORM 2200-DISPLAY-COMMAREA                            02710000
027200     ELSE                                                         02720000
027300         DISPLAY '** ABEND - PROGRAM ' PC-PROGRAM-NAME            02730000
027400         DISPLAY '** BAD CALL TO CRTN STATUS PGM PCKUT713'        02740000
027500         DISPLAY 'PC046-CRA-RET-CDE = ' PC046-CRA-RET-CDE         02750000
027600         DISPLAY PC046-CRA-RET-MSG                                02760000
027700         MOVE +4019 TO PV-ABEND-CODE                              02770000
027800         CALL 'ILBOABN0' USING PV-ABEND-CODE                      02780000
027900     END-IF.                                                      02790000
028000                                                                  02800000
028100                                                                  02810000
028200 2200-DISPLAY-COMMAREA.                                           02820000
028210                                                                  02821000
028220     DISPLAY ' '.                                                 02822001
028300     DISPLAY 'COMMAREA DISPLAY FOR CARTON: '                      02830001
028400             IR-CARTON-NUMBER.                                    02840001
028500                                                                  02850001
028510     MOVE PC046-DEST-OPER-UNT-ID TO PV-DISPLAY-4-DIGIT.           02851001
028511     DISPLAY 'STORE NUMBER: ' PV-DISPLAY-4-DIGIT.                 02851101
028520                                                                  02852001
028530     DISPLAY 'STATUS USER ID: ' PC046-STATUS-USERID.              02853001
028540                                                                  02854001
028550     DISPLAY 'STATUS TIMESTAMP: ' PC046-CRTN-STAT-TMST,           02855001
028560                                                                  02856001
028570     IF PC046-INVALID-CRTN                                        02857001
028580        DISPLAY 'INVALID CARTON STATUS: ' PC046-CRTN-STATUS       02858001
028590     ELSE                                                         02859001
028592     IF PC046-INACTIVATED                                         02859201
028593        DISPLAY 'INACTIVE CARTON STATUS: ' PC046-CRTN-STATUS      02859301
028594     ELSE                                                         02859401
028595     IF PC046-SCANNED-OFF-TRLR                                    02859501
028596        DISPLAY 'SCANNED OFF TRAILER STATUS: ' PC046-CRTN-STATUS  02859601
028597     ELSE                                                         02859701
028598     IF PC046-SCANNED-ONTO-TRLR                                   02859801
028599        DISPLAY 'SCANNED ON TRAILER STATUS: ' PC046-CRTN-STATUS   02859901
028600     ELSE                                                         02860001
028601     IF PC046-DIVERTED-TO-TRLR                                    02860101
028602        DISPLAY 'DIVERTED TO TRAILER STATUS: ' PC046-CRTN-STATUS  02860201
028603     ELSE                                                         02860301
028604     IF PC046-LOADED-ONTO-TRLR                                    02860401
028605        DISPLAY 'LOADED ONTO TRAILER STATUS: ' PC046-CRTN-STATUS  02860501
028606     ELSE                                                         02860601
028607     IF PC046-CASEPACK-SPLIT                                      02860701
028608        DISPLAY 'CASEPACK SPLIT STATUS: ' PC046-CRTN-STATUS       02860801
028609     ELSE                                                         02860901
028610     IF PC046-CHECKED-IN                                          02861001
028611        DISPLAY 'CHECKED IN STATUS: ' PC046-CRTN-STATUS           02861101
028612     ELSE                                                         02861201
028613     IF PC046-ROUTED-FROM-P2L                                     02861301
028614        DISPLAY 'ROUTED FROM P2L STATUS: ' PC046-CRTN-STATUS      02861401
028615     ELSE                                                         02861501
028616     IF PC046-CRE-BY-RDM                                          02861601
028617        DISPLAY 'CREATED BY RDM STATUS: ' PC046-CRTN-STATUS       02861701
028618     ELSE                                                         02861801
028619     IF PC046-CRE-BY-RECV                                         02861901
028620        DISPLAY 'CREATED BY RECEIVING STATUS: ' PC046-CRTN-STATUS 02862002
028621     ELSE                                                         02862101
028622     IF PC046-CRE-BY-ASN                                          02862201
028623        DISPLAY 'CREATED BY ASN STATUS: ' PC046-CRTN-STATUS       02862302
028624     ELSE                                                         02862401
028625     IF PC046-CRE-BY-SMOOTHING                                    02862501
028626        DISPLAY 'CREATED BY SMOOTHING STATUS: ' PC046-CRTN-STATUS 02862602
028627     ELSE                                                         02862701
028628     IF PC046-CRE-BY-FAST-XFER                                    02862801
028629        DISPLAY 'CREATED BY FAST XFER STATUS: ' PC046-CRTN-STATUS 02862902
028630     ELSE                                                         02863001
028631     IF PC046-CRE-BY-MSTR-CNTR                                    02863101
028632        DISPLAY 'CREATED BY MASTER SML STATUS: ' PC046-CRTN-STATUS02863202
028633     ELSE                                                         02863301
028634     IF PC046-CRE-BY-CRTN-BULD                                    02863401
028635        DISPLAY 'CREATED BY CARTON BLD STATUS: ' PC046-CRTN-STATUS02863502
028636     ELSE                                                         02863601
028637     IF PC046-ROUTED-FROM-JWL                                     02863701
028638        DISPLAY 'ROUTED FROM JEWELRY STATUS: ' PC046-CRTN-STATUS  02863802
028639     ELSE                                                         02863901
028640     IF PC046-ROUTED-FROM-DMG                                     02864001
028641        DISPLAY 'ROUTED FROM DAMAGE STATUS: ' PC046-CRTN-STATUS   02864102
028642     ELSE                                                         02864201
028643     IF PC046-CRE-BY-3WD                                          02864303
028644        DISPLAY 'CREATED BY 3RD PARTY WRHSE:' PC046-CRTN-STATUS   02864403
028645     ELSE                                                         02864503
028646        DISPLAY 'UNKNOWN CODE STATUS: ' PC046-CRTN-STATUS.        02864602
028647                                                                  02864701
028648     DISPLAY 'CARTON STATUS DESCRIPTION: ' PC046-CRTN-STAT-DESC.  02864801
028649                                                                  02864901
028650     MOVE PC046-TRLR-SRL TO PV-DISPLAY-9-DIGIT.                   02865001
028651     DISPLAY 'TRAILER SERIAL NBR: ' PV-DISPLAY-9-DIGIT.           02865101
028652                                                                  02865201
028653     MOVE PC046-OTBD-TRIP-ID TO PV-DISPLAY-9-DIGIT.               02865301
028654     DISPLAY 'OUTBOUND TRIP ID: ' PV-DISPLAY-9-DIGIT.             02865401
028655                                                                  02865501
028656     DISPLAY 'OUTBOUND SCAC/TRAILER: ' PC046-SCAC ' '             02865601
028657             PC046-TRLR-ID.                                       02865701
028658                                                                  02865801
028660     DISPLAY 'DOOR NUMBER/TYP CODE: ' PC046-DOOR-ID ' '           02866001
028700             PC046-DOOR-TYP-CDE.                                  02870001
028800                                                                  02880001
028900     DISPLAY 'OUTBOUND TRIP STATUS: ' PC046-TRIP-STATUS.          02890001
029000                                                                  02900001
029100     DISPLAY 'OUTBOUND TRIP TIMESTAMP: ' PC046-TRIP-STAT-TMST.    02910001
029200                                                                  02920001
029300     DISPLAY 'CARTON SOURCE CODE: ' PC046-SHPUNT-SRC-ID.          02930001
029400                                                                  02940001
029410     MOVE PC046-NBR-UNITS TO PV-DISPLAY-9-DIGIT.                  02941001
029500     DISPLAY 'NBR UNITS IN CARTON: ' PV-DISPLAY-9-DIGIT.          02950001
029600                                                                  02960001
029700     MOVE PC046-VENDOR-SHIPT-UNT-ID TO PV-DISPLAY-18-DIGIT.       02970001
029800     DISPLAY 'INBOUND CARTON ID: ' PV-DISPLAY-18-DIGIT.           02980001
029900                                                                  02990001
030000     DISPLAY 'KOHLS BARCODE NBR: ' PC046-KOHLS-BARCODE.           03000001
030100                                                                  03010001
030200     DISPLAY 'PO NUMBER: ' PC046-PO-NBR.                          03020001
030300                                                                  03030001
030400     DISPLAY 'MULT PO INDICATOR: ' PC046-MULT-PO.                 03040001
030500                                                                  03050001
030600     DISPLAY 'RECEIVER NUMBER: ' PC046-RCVR-NBR.                  03060001
030700                                                                  03070001
030800     DISPLAY 'CALCULATED UNITS SW: ' PC046-CALC-UNITS-SW.         03080001
030900                                                                  03090001
031000     IF PC046-BEGIN-DIVERT                                        03100001
031100        DISPLAY 'BEGIN DIVERT: ' PC046-DIVERT-FLAG                03110001
031200     ELSE                                                         03120001
031300     IF PC046-END-DIVERT                                          03130001
031400        DISPLAY 'END DIVERT: ' PC046-DIVERT-FLAG                  03140001
031500     ELSE                                                         03150001
031600        DISPLAY 'NEITHER BEGIN/END DIVERT: ' PC046-DIVERT-FLAG.   03160001
031700                                                                  03170001
031800     DISPLAY 'OUTBOUND UPC TRN NBR: ' PC046-TRN-NBR.              03180001
031900                                                                  03190001
068400***************************************************************** 06840000
068500 7100-READ-INPUT-FILE.                                            06850000
068600******************************************************************06860000
068700     READ SML-INPUT-FILE INTO IR-INPUT-RECORD                     06870000
068800        AT END                                                    06880000
068900           SET PS-END-OF-INPUT-FILE TO TRUE                       06890000
069000        NOT AT END                                                06900000
069100           ADD +1 TO PV-READ-COUNTER                              06910000
069200     END-READ.                                                    06920000
069300                                                                  06930000
070100***************************************************************** 07010000
070200 9100-SQL-ABEND.                                                  07020000
070300***************************************************************** 07030000
070400     MOVE SQLCODE                     TO SQLCODE2.                07040000
070500     MOVE SQLERRD(3)                  TO SQLERRD3.                07050000
070600                                                                  07060000
070700     DISPLAY '** ABEND **         ** = SQLERROR'.                 07070000
070800     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                07080000
070900     DISPLAY '** PO NUMBER ** = ' PV-DISPLAY-PO-NBR.              07090000
071000     DISPLAY '** RECEIVER  ** = ' PV-DISPLAY-RCVR-SEQ-NBR.        07100000
071100     DISPLAY '** PO LNE NBR** = ' PV-DISPLAY-PO-LINE-NBR.         07110000
071200                                                                  07120000
071300                                                                  07130000
071400     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             07140000
071500     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07150000
071600     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME.              07160000
071700     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME1.             07170000
071800     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME2.             07180000
071900     DISPLAY '** FIELD 1   ** = ' PV-DISP-FIELD-1.                07190000
072000     DISPLAY '** FIELD 2   ** = ' PV-DISP-FIELD-2.                07200000
072100     DISPLAY '** FIELD 3   ** = ' PV-DISP-FIELD-3.                07210000
072200     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                07220000
072300     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                07230000
072400     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 07240000
072500     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                07250000
072600                                                                  07260000
072700                                                                  07270000
072800     MOVE +4013                       TO PV-ABEND-CODE.           07280000
072900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07290000
