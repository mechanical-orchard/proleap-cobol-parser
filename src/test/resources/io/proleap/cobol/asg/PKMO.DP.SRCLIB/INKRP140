       IDENTIFICATION DIVISION.                                                 
                                                                                
       PROGRAM-ID.    INKRP140.                                                 
       AUTHOR.        JULIE SEIDLER.                                            
       INSTALLATION.  KOHL CORPORATION.                                         
       DATE-WRITTEN.  JUNE 1987.                                                
       DATE-COMPILED.                                                           
      ***********************************************************               
      *    THIS PROGRAM READS THE INVENTORY ADJUSTMENT EXTRACT AND              
      *    PRINTS INVENTORY ADJUSTMENT REPORT BY DEPARTMENT.                    
      *                                                                         
      *    TOTALS PRINTED ARE BY DEPARTMENT,BUYER,MANAGER AND                   
      *    DIVISION.                                                            
      *                                                                         
      *    COPIED FROM MLKRP040.                                                
      *                                                                         
      ******************** HISTORY OF CHANGES **************************        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
WR9999*          03/04/99    SCOTT JACKSON                             *        
WR9999*                      ADD STORE NUMBER TO REPORT IN FIRST COLUMN*        
WR9999*                      JUST PRIOR TO STORE 10-DIGIT NAME.        *        
      * 21591    03-01-2002  MANIFEST PROJECT CHANGE FOR IN-TRANSIT    *        
      *                      REVERSAL FROM INVENTORY LEDGER            *        
W26600* W26600  04-05-2004 ROD JANSSEN INV LEDGER STORE EXPANSION               
R26600* W26600  06-07-2004 ROD JANSSEN ADJUST TOTAL LINE DETAIL                 
W27808* W27808  05-25-2005 S. JACKSON  NEW MANIFESTING/STORE-EXPECT CHGS        
      * W28545  11-01-2005 V.L. YANG   ESTIMATED DAILY INVENTORY LEDGER         
      *                                RECOMPILE FOR INRD013 CHANGES            
W28545* W28545  08-10-2006 B. GRAHAM - STRATAGEM                                
W28545* W28545             DEPARTMENT INVENTORY PROJECT                         
W28545* W28545             TINVPAR/TINCNTL JOIN                                 
W33304* W33304  09-23-2008 VIGNESH SUBRAMANIAN                                  
W33304*                    HOLDING INVENTORY LEDGER OPEN (HILO).                
RONNA1* CHG0305858                                                              
RONNA1*         02-27-2024 RONNA MCDONALD                                       
RONNA1*                    REMOVE LOGIC FOR ESTIMATED INVENTORY.                
RONNA1*                    THIS IS OBSOLETE.                                    
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT INVENTORY-ADJ-EXTR                                            
               ASSIGN INP01.                                                    
                                                                                
           SELECT INVENTORY-ADJ-RPT                                             
               ASSIGN RPT01.                                                    
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  INVENTORY-ADJ-EXTR                                                   
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
W33304 01  INVENTORY-ADJ-EXTR-REC PIC X(144).                                   
                                                                                
       FD  INVENTORY-ADJ-RPT                                                    
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
21591  01  INVENTORY-ADJ-RPT-RECORD      PIC X(200).                            
                                                                                
       EJECT                                                                    
       WORKING-STORAGE SECTION.                                                 
                                                                                
      ***************************************************************           
      *    NEW DATE SUBROUTINE WORK AREA                                        
      ***************************************************************           
                                                                                
           COPY DPWS500.                                                        
                                                                                
W33304******************************************************************        
W33304*  HEADER LINE                                                            
W33304******************************************************************        
W33304*01  DP085-GET-CURR-JOB-INFO-PGM.                                         
W33304*01  DP085-GET-CURR-JOB-INFO-PARMS.                                       
W33304     COPY DPWS085.                                                        
W33304                                                                          
      ***************************************************************           
      *    150 CHARACTER STANDARD HEADER.                                       
      ***************************************************************           
                                                                                
           COPY DPWS200O.                                                       
                                                                                
      ***************************************************************           
      *    ERROR MESSAGE AREA FOR DB2                                           
      ***************************************************************           
                                                                                
           COPY DPWS004.                                                        
                                                                                
                                                                                
      ***************************************************************           
      *    WORKING STORAGE AREA FOR THE NAME REFORMATTER                        
      *    ROUTINE DPPD024.                                                     
      ***************************************************************           
                                                                                
           COPY DPWS024.                                                        
                                                                                
       01  BT-BUYER-TOTALS.                                                     
W26600     05  BT-STORE-ENTRY               OCCURS 9999 TIMES.                  
W26600         10  BT-STORE-NO              PIC 9(05).                          
               10  BT-STORE-NAME            PIC X(10).                          
W33304         10  BT-INV-ID                PIC S9(09)    COMP.                 
               10  BT-STORE-CODE            PIC X(02).                          
               10  BT-STORE-TOTALS                        COMP-3.               
W26600             15  BT-BEG-INV           PIC S9(13)V99.                      
W26600             15  BT-RECEIPTS          PIC S9(13)V99.                      
W26600             15  BT-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  BT-PARL-SHIP         PIC S9(13)V99.                      
W27808             15  BT-ST-EXPECT         PIC S9(13)V99.                      
W26600             15  BT-SALES             PIC S9(13)V99.                      
W26600             15  BT-SHRINK            PIC S9(13)V99.                      
W26600             15  BT-XFER-IN           PIC S9(13)V99.                      
W26600             15  BT-XFER-OUT          PIC S9(13)V99.                      
W26600             15  BT-MKUP              PIC S9(13)V99.                      
W26600             15  BT-MKDN              PIC S9(13)V99.                      
W26600             15  BT-END-INV           PIC S9(13)V99.                      
               10  FILLER                   PIC X(02).                          
W33304                                                                          
W33304 01  CY-CYCLE-TOTALS.                                                     
W33304     05  CY-STORE-ENTRY               OCCURS 9999 TIMES.                  
W33304         10  CY-STORE-NO              PIC 9(05).                          
W33304         10  CY-STORE-NAME            PIC X(10).                          
W33304         10  CY-INV-ID                PIC S9(09)    COMP.                 
W33304         10  CY-STORE-CODE            PIC X(02).                          
W33304         10  CY-STORE-TOTALS                        COMP-3.               
W33304             15  CY-BEG-INV           PIC S9(13)V99.                      
W33304             15  CY-RECEIPTS          PIC S9(13)V99.                      
W33304             15  CY-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  CY-PARL-SHIP         PIC S9(13)V99.                      
W33304             15  CY-ST-EXPECT         PIC S9(13)V99.                      
W33304             15  CY-SALES             PIC S9(13)V99.                      
W33304             15  CY-SHRINK            PIC S9(13)V99.                      
W33304             15  CY-XFER-IN           PIC S9(13)V99.                      
W33304             15  CY-XFER-OUT          PIC S9(13)V99.                      
W33304             15  CY-MKUP              PIC S9(13)V99.                      
W33304             15  CY-MKDN              PIC S9(13)V99.                      
W33304             15  CY-END-INV           PIC S9(13)V99.                      
W33304         10  FILLER                   PIC X(02).                          
W33304                                                                          
W33304 01  MN-MONTH-TOTALS.                                                     
W33304     05  MN-STORE-ENTRY               OCCURS 9999 TIMES.                  
W33304         10  MN-STORE-NO              PIC 9(05).                          
W33304         10  MN-STORE-NAME            PIC X(10).                          
W33304         10  MN-INV-ID                PIC S9(09)    COMP.                 
W33304         10  MN-STORE-CODE            PIC X(02).                          
W33304         10  MN-STORE-TOTALS                        COMP-3.               
W33304             15  MN-BEG-INV           PIC S9(13)V99.                      
W33304             15  MN-RECEIPTS          PIC S9(13)V99.                      
W33304             15  MN-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  MN-PARL-SHIP         PIC S9(13)V99.                      
W33304             15  MN-ST-EXPECT         PIC S9(13)V99.                      
W33304             15  MN-SALES             PIC S9(13)V99.                      
W33304             15  MN-SHRINK            PIC S9(13)V99.                      
W33304             15  MN-XFER-IN           PIC S9(13)V99.                      
W33304             15  MN-XFER-OUT          PIC S9(13)V99.                      
W33304             15  MN-MKUP              PIC S9(13)V99.                      
W33304             15  MN-MKDN              PIC S9(13)V99.                      
W33304             15  MN-END-INV           PIC S9(13)V99.                      
W33304         10  FILLER                   PIC X(02).                          
                                                                                
       01  CT-CURRENT-TOTALS.                                                   
W26600     05  CT-STORE-ENTRY               OCCURS 9999 TIMES.                  
W26600         10  CT-STORE-NO              PIC 9(05).                          
               10  CT-STORE-NAME            PIC X(10).                          
W33304         10  CT-INV-ID                PIC S9(09)    COMP.                 
               10  CT-STORE-CODE            PIC X(02).                          
                   88  CT-FIN-CORP01                      VALUE '01'.           
                   88  CT-FIN-CORP02                      VALUE '02'.           
                   88  CT-FIN-CORP03                      VALUE '03'.           
               10  CT-STORE-TOTALS                        COMP-3.               
W26600             15  CT-BEG-INV           PIC S9(13)V99.                      
W26600             15  CT-RECEIPTS          PIC S9(13)V99.                      
W26600             15  CT-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  CT-PARL-SHIP         PIC S9(13)V99.                      
W27808             15  CT-ST-EXPECT         PIC S9(13)V99.                      
W26600             15  CT-SALES             PIC S9(13)V99.                      
W26600             15  CT-SHRINK            PIC S9(13)V99.                      
W26600             15  CT-XFER-IN           PIC S9(13)V99.                      
W26600             15  CT-XFER-OUT          PIC S9(13)V99.                      
W26600             15  CT-MKUP              PIC S9(13)V99.                      
W26600             15  CT-MKDN              PIC S9(13)V99.                      
W26600             15  CT-END-INV           PIC S9(13)V99.                      
               10  FILLER                   PIC X(02).                          
                                                                                
       01  DH-DETAIL-HEADING-1.                                                 
W26600     05  FILLER                       PIC X(21)     VALUE SPACES.         
           05  FILLER                       PIC X(09)     VALUE                 
           'BEGINNING'.                                                         
WR9999     05  FILLER                       PIC X(20)     VALUE SPACES.         
           05  FILLER                       PIC X(08)     VALUE                 
           'PURCHASE'.                                                          
W77808     05  FILLER                       PIC X(07)     VALUE SPACES.         
W27808     05  FILLER                       PIC X(05)     VALUE                 
W27808     'STORE'.                                                             
W27808     05  FILLER                       PIC X(09)     VALUE SPACES.         
OCFSFS     05  FILLER                       PIC X(07)     VALUE                 
OCFSFS     'PARTIAL'.                                                           
OCFSFS     05  FILLER                       PIC X(30)     VALUE SPACES.         
           05  FILLER                       PIC X(09)     VALUE                 
           'TRANSFERS'.                                                         
           05  FILLER                       PIC X(04)     VALUE SPACES.         
           05  FILLER                       PIC X(09)     VALUE                 
           'TRANSFERS'.                                                         
           05  FILLER                       PIC X(31)     VALUE SPACES.         
           05  FILLER                       PIC X(06)     VALUE                 
           'ENDING'.                                                            
                                                                                
       01  DH-DETAIL-HEADING-2.                                                 
WR9999     05  FILLER                       PIC X(03)     VALUE SPACES.         
WR9999     05  FILLER                       PIC X(09)     VALUE                 
WR9999     'STORE   '.                                                          
W26600     05  FILLER                       PIC X(09)     VALUE SPACES.         
           05  FILLER                       PIC X(10)     VALUE                 
           'INVENTORY'.                                                         
           05  FILLER                       PIC X(06)     VALUE SPACES.         
           05  FILLER                       PIC X(08)     VALUE                 
           'RECEIPTS'.                                                          
WR9999     05  FILLER                       PIC X(05)     VALUE SPACES.         
           05  FILLER                       PIC X(11)     VALUE                 
           'ADJUSTMENTS'.                                                       
W27808     05  FILLER                       PIC X(03)     VALUE SPACES.         
W27808     05  FILLER                       PIC X(08)     VALUE                 
W27808     'EXPECTED'.                                                          
WR9999     05  FILLER                       PIC X(08)     VALUE SPACES.         
OCFSFS     05  FILLER                       PIC X(05)     VALUE                 
OCFSFS     'SHIPS'.                                                             
OCFSFS     05  FILLER                       PIC X(07)     VALUE SPACES.         
           05  FILLER                       PIC X(06)     VALUE                 
           'SALES'.                                                             
WR9999     05  FILLER                       PIC X(06)     VALUE SPACES.         
           05  FILLER                       PIC X(06)     VALUE                 
           'SHRINK'.                                                            
           05  FILLER                       PIC X(10)     VALUE SPACES.         
           05  FILLER                       PIC X(02)     VALUE                 
           'IN'.                                                                
           05  FILLER                       PIC X(11)     VALUE SPACES.         
           05  FILLER                       PIC X(03)     VALUE                 
           'OUT'.                                                               
           05  FILLER                       PIC X(09)     VALUE SPACES.         
           05  FILLER                       PIC X(04)     VALUE                 
           'MKDN'.                                                              
           05  FILLER                       PIC X(09)     VALUE SPACES.         
           05  FILLER                       PIC X(04)     VALUE                 
           'MKUP'.                                                              
           05  FILLER                       PIC X(05)     VALUE SPACES.         
           05  FILLER                       PIC X(09)     VALUE                 
           'INVENTORY'.                                                         
                                                                                
WR9999 01  SV-STORE-NBR.                                                02730000
WR9999     05  SV-STORE-NBR-NUM             PIC S9(4).                  02730000
WR9999                                                                  02730000
                                                                        02710000
WR9999* ADD 5 BYTES FOR STORE NBR/SPACE. BORROW FROM FILLER             02710000
       01  DL-DETAIL-LINE.                                              02720000
WR9999     05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
W26600     05  DL-STORE-NBR                 PIC X(05)     VALUE SPACE.  02730000
WR9999     05  FILLER                       PIC X(01)     VALUE SPACE.  02780000
           05  DL-STORE-NAME                PIC X(10)     VALUE SPACES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-BEG-INVENTORY             PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-RECEIPTS                  PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-PURCH-ADJ                 PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
W27808     05  DL-ST-EXPECT                 PIC ZZ,ZZZ,ZZZ.Z-                   
21591                                                     VALUE ZEROES.         
OCFSFS     05  FILLER                       PIC X(02)     VALUE SPACES.         
OCFSFS     05  DL-PARL-SHIP                 PIC ZZ,ZZZ,ZZZ.Z-                   
OCFSFS                                                    VALUE ZEROES.         
21591      05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-SALES                     PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-SHRINK                    PIC Z,ZZZ,ZZZ.Z-                    
                                                          VALUE ZEROES.         
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-XFER-IN                   PIC ZZ,ZZZ,ZZZ.Z                    
                                                          VALUE ZEROES.         
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-XFER-OUT                  PIC ZZ,ZZZ,ZZZ.Z                    
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-MKDN                      PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-MKUP                      PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
      *    05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  DL-END-INV                   PIC ZZZ,ZZZ,ZZZ.Z-                  
                                                          VALUE ZEROES.         
                                                                                
       01  DT-DEPT-TOTALS.                                                      
W26600     05  DT-STORE-ENTRY               OCCURS 9999 TIMES.                  
W26600         10  DT-STORE-NO              PIC 9(05).                          
               10  DT-STORE-NAME            PIC X(10).                          
W33304         10  DT-INV-ID                PIC S9(09)    COMP.                 
               10  DT-STORE-CODE            PIC X(02).                          
               10  DT-STORE-TOTALS                        COMP-3.               
W26600             15  DT-BEG-INV           PIC S9(13)V99.                      
W26600             15  DT-RECEIPTS          PIC S9(13)V99.                      
W26600             15  DT-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  DT-PARL-SHIP         PIC S9(13)V99.                      
W27808             15  DT-ST-EXPECT         PIC S9(13)V99.                      
W26600             15  DT-SALES             PIC S9(13)V99.                      
W26600             15  DT-SHRINK            PIC S9(13)V99.                      
W26600             15  DT-XFER-IN           PIC S9(13)V99.                      
W26600             15  DT-XFER-OUT          PIC S9(13)V99.                      
W26600             15  DT-MKUP              PIC S9(13)V99.                      
W26600             15  DT-MKDN              PIC S9(13)V99.                      
W26600             15  DT-END-INV           PIC S9(13)V99.                      
               10  FILLER                   PIC X(02).                          
                                                                                
       01  DVT-DIVISION-TOTALS.                                                 
W26600     05  DVT-STORE-ENTRY              OCCURS 9999 TIMES.                  
W26600         10  DVT-STORE-NO             PIC 9(05).                          
               10  DVT-STORE-NAME           PIC X(10).                          
W33304         10  DVT-INV-ID               PIC S9(09)    COMP.                 
               10  DVT-STORE-CODE           PIC X(02).                          
               10  DVT-STORE-TOTALS                       COMP-3.               
W26600             15  DVT-BEG-INV          PIC S9(13)V99.                      
W26600             15  DVT-RECEIPTS         PIC S9(13)V99.                      
W26600             15  DVT-PURCH-ADJ        PIC S9(13)V99.                      
OCFSFS             15  DVT-PARL-SHIP        PIC S9(13)V99.                      
W27808             15  DVT-ST-EXPECT        PIC S9(13)V99.                      
W26600             15  DVT-SALES            PIC S9(13)V99.                      
W26600             15  DVT-SHRINK           PIC S9(13)V99.                      
W26600             15  DVT-XFER-IN          PIC S9(13)V99.                      
W26600             15  DVT-XFER-OUT         PIC S9(13)V99.                      
W26600             15  DVT-MKUP             PIC S9(13)V99.                      
W26600             15  DVT-MKDN             PIC S9(13)V99.                      
W26600             15  DVT-END-INV          PIC S9(13)V99.                      
               10  FILLER                   PIC X(02).                          
                                                                                
       01  DV-DISPLAY-VALUES.                                                   
           05  DV-DISPLAY-COUNTER           PIC ZZ,ZZ9    VALUE ZEROES.         
           05  DV-DISPLAY-TOTALS            PIC ZZZ,ZZZ,ZZ9.99-                 
                                                          VALUE ZEROES.         
                                                                                
       01  FT-FINAL-TOTALS.                                                     
W26600     05  FT-STORE-ENTRY               OCCURS 9999 TIMES.                  
W26600         10  FT-STORE-NO              PIC 9(05).                          
               10  FT-STORE-NAME            PIC X(10).                          
W33304         10  FT-INV-ID                PIC S9(09)    COMP.                 
               10  FT-STORE-CODE            PIC X(02).                          
               10  FT-FINAL-STORE-TOTALS                  COMP-3.               
W26600             15  FT-BEG-INV           PIC S9(13)V99.                      
W26600             15  FT-RECEIPTS          PIC S9(13)V99.                      
W26600             15  FT-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  FT-PARL-SHIP         PIC S9(13)V99.                      
W27808             15  FT-ST-EXPECT         PIC S9(13)V99.                      
W26600             15  FT-SALES             PIC S9(13)V99.                      
W26600             15  FT-SHRINK            PIC S9(13)V99.                      
W26600             15  FT-XFER-IN           PIC S9(13)V99.                      
W26600             15  FT-XFER-OUT          PIC S9(13)V99.                      
W26600             15  FT-MKUP              PIC S9(13)V99.                      
W26600             15  FT-MKDN              PIC S9(13)V99.                      
W26600             15  FT-END-INV           PIC S9(13)V99.                      
               10  FILLER                   PIC X(02).                          
                                                                                
       01  MT-MANAGER-TOTALS.                                                   
W26600     05  MT-STORE-ENTRY               OCCURS 9999 TIMES.                  
W26600         10  MT-STORE-NO              PIC 9(05).                          
               10  MT-STORE-NAME            PIC X(10).                          
W33304         10  MT-INV-ID                PIC S9(09)    COMP.                 
               10  MT-STORE-CODE            PIC X(02).                          
               10  MT-STORE-TOTALS                        COMP-3.               
W26600             15  MT-BEG-INV           PIC S9(13)V99.                      
W26600             15  MT-RECEIPTS          PIC S9(13)V99.                      
W26600             15  MT-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  MT-PARL-SHIP         PIC S9(13)V99.                      
W27808             15  MT-ST-EXPECT         PIC S9(13)V99.                      
W26600             15  MT-SALES             PIC S9(13)V99.                      
W26600             15  MT-SHRINK            PIC S9(13)V99.                      
W26600             15  MT-XFER-IN           PIC S9(13)V99.                      
W26600             15  MT-XFER-OUT          PIC S9(13)V99.                      
W26600             15  MT-MKUP              PIC S9(13)V99.                      
W26600             15  MT-MKDN              PIC S9(13)V99.                      
W26600             15  MT-END-INV           PIC S9(13)V99.                      
               10  FILLER                   PIC X(02).                          
                                                                                
       01  PC-PROGRAM-COUNTERS.                                                 
W27808     05  PC-MAX-STORE                 PIC  9(04)    VALUE 2000.           
           05  PC-PAGE-COUNTER              PIC S9(05)    VALUE +0              
                                                          COMP-3.               
           05  PC-LINE-COUNTER              PIC S9(04)    VALUE +0              
                                                          COMP SYNC.            
           05  PC-INPUT-COUNTER             PIC S9(05)    VALUE +0              
                                                          COMP-3.               
           05  PC-GOOD-COUNTER              PIC S9(05)    VALUE +0              
                                                          COMP-3.               
           05  PC-REJECT-COUNTER            PIC S9(05)    VALUE +0              
                                                          COMP-3.               
           05  PC-REJECT-INV-STORE          PIC S9(05)    VALUE +0              
                                                          COMP-3.               
           05  PC-SUB-CL-NBR                   PIC X(03)   VALUE '000'.         
           05  PC-MDSELV-CDE                   PIC X(03)   VALUE 'DPT'.         
           05  PC-RSPLVL-CDE-BYR               PIC X(03)   VALUE 'BYR'.         
           05  PC-RSPLVL-CDE-DMM               PIC X(03)   VALUE 'DMM'.         
           05  PC-OPERCO-NBR                   PIC X(02)   VALUE '03'.          
           05  PC-APLSYS-CDE                   PIC X(02)   VALUE 'ML'.          
           05  PC-MAX-RETRIES                  PIC S9(4)                        
                                               COMP SYNC   VALUE +2.            
           05  PC-CALENDAR-TYPE                PIC X(02)   VALUE 'F2'.          
           05  PC-SATURDAY                     PIC 9(01)   VALUE 7.             
                                                                                
       01  PH-PAGE-HEADING-2.                                                   
21591      05  FILLER                       PIC X(69)     VALUE SPACES.         
           05  FILLER                       PIC X(48)     VALUE                 
           'BEFORE INVENTORY ADJUSTMENT REPORT BY DEPT FOR  '.                  
           05  FILLER                       PIC X(01)     VALUE SPACES.         
W33304     03  PH-CYCLE-NAME                PIC X(20)     VALUE SPACES.         
W33304     03  FILLER                       PIC X(03)     VALUE SPACES.         
           03  PH-LEDGER-LIT                PIC X(20)     VALUE SPACES.         
           03  FILLER                       PIC X(05)     VALUE SPACES.         
                                                                                
       01  PH-PAGE-HEADING-3.                                                   
W33304     05  PH-CYCLE-MONTH               PIC X(06)     VALUE SPACES.         
W33304     05  PH-CYCLE                     PIC 9(05)     VALUE ZEROES.         
W33304     05  PH-MONTH REDEFINES PH-CYCLE                                      
W33304                                      PIC X(05).                          
W33304     05  FILLER                       PIC X(85)     VALUE SPACES.         
           05  FILLER                       PIC X(05)     VALUE                 
                                                          '($000'.              
           05  FILLER                       PIC X(01)     VALUE QUOTE.          
           05  FILLER                       PIC X(02)     VALUE                 
                                                          'S)'.                 
           05  FILLER                       PIC X(62)     VALUE SPACES.         
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-EXTR-EOF-SW               PIC X(01)     VALUE 'N'.            
               88  PS-EXTR-EOF                            VALUE 'Y'.            
           05  PS-OPEN-FSCL-MN-EOF-SW       PIC X(01)     VALUE 'N'.            
               88  PS-OPEN-FSCL-MN-EOF                    VALUE 'Y'.            
           05  PS-FIRST-RECORD-SW           PIC X(01)     VALUE 'Y'.            
               88  PS-FIRST-RECORD                        VALUE 'Y'.            
               88  PS-PASSED-FIRST-RECORD                 VALUE 'N'.            
           05  PS-VALID-STORE-SW            PIC X(01)     VALUE 'N'.            
               88  PS-VALID-STORE                         VALUE 'Y'.            
               88  PS-INVALID-STORE                       VALUE 'N'.            
           05  PS-BREAK-SW                  PIC 9(01)     VALUE 0.              
               88  PS-DEPT-BREAK                          VALUE 1.              
               88  PS-BUYER-BREAK                         VALUE 2.              
               88  PS-MANAGER-BREAK                       VALUE 3.              
               88  PS-DIVISION-BREAK                      VALUE 4.              
               88  PS-COMPANY-BREAK                       VALUE 5.              
W33304         88  PS-CYCLE-BREAK                         VALUE 6.              
W33304         88  PS-MONTH-BREAK                         VALUE 7.              
           05  PS-DONE-WITH-PAGE-SW         PIC X(01)     VALUE 'N'.            
               88  PS-START-PAGE                          VALUE 'N'.            
               88  PS-DONE-WITH-PAGE                      VALUE 'Y'.            
                                                                                
       01  PS-PROGRAM-SUBSCRIPTS.                                               
           05  PS-SUB                       PIC S9(04)    VALUE +0              
                                                          COMP SYNC.            
           05  PS-STORE-SUB                 PIC S9(04)    VALUE +0              
                                                          COMP SYNC.            
                                                                                
       01  PT1-PAGE-TOTALS                                COMP-3.               
W26600     15  PT1-BEG-INV                  PIC S9(13)V99.                      
W26600     15  PT1-RECEIPTS                 PIC S9(13)V99.                      
W26600     15  PT1-PURCH-ADJ                PIC S9(13)V99.                      
OCFSFS     15  PT1-PARL-SHIP                PIC S9(13)V99.                      
W27808     15  PT1-ST-EXPECT                PIC S9(13)V99.                      
W26600     15  PT1-SALES                    PIC S9(13)V99.                      
W26600     15  PT1-SHRINK                   PIC S9(13)V99.                      
W26600     15  PT1-XFER-IN                  PIC S9(13)V99.                      
W26600     15  PT1-XFER-OUT                 PIC S9(13)V99.                      
W26600     15  PT1-MKUP                     PIC S9(13)V99.                      
W26600     15  PT1-MKDN                     PIC S9(13)V99.                      
W26600     15  PT1-END-INV                  PIC S9(13)V99.                      
                                                                                
       01  PROGRAM-VARIABLES.                                                   
W33304     05  PV-JOB-INFO.                                                     
W33304         10  FILLER                  PIC X(01)       VALUE '('.           
W33304         10  PV-JOB-NAME             PIC X(08)       VALUE SPACES.        
W33304         10  FILLER                  PIC X(01)       VALUE ')'.           
           05  PV-CURRENT-DATE-X.                                               
               10  PV-CURR-CENTURY          PIC 9(2)      VALUE ZERO.           
               10  PV-CURR-YEAR             PIC 9(2)      VALUE ZERO.           
               10  FILLER                   PIC X         VALUE '-'.            
               10  PV-CURR-MONTH            PIC 9(2)      VALUE ZERO.           
               10  FILLER                   PIC X         VALUE '-'.            
               10  PV-CURR-DAY              PIC 9(2)      VALUE ZERO.           
           05  PV-CURRENT-DATE REDEFINES PV-CURRENT-DATE-X                      
                                            PIC X(10).                          
           05  PV-RETRY-COUNT                  PIC S9(4)                        
                                               COMP SYNC   VALUE +0.            
           05  PV-DEPT-NBR                     PIC X(03)   VALUE SPACE.         
           05  PV-DMA-NBR                      PIC X(02)   VALUE SPACE.         
           05  PV-BYR-NBR-GROUP.                                                
               10  PV-BYR-NBR-1                PIC X(01)   VALUE '0'.           
               10  PV-BYR-NBR-2-3              PIC X(02)   VALUE SPACE.         
           05  PV-BYR-NBR REDEFINES PV-BYR-NBR-GROUP                            
                                               PIC X(03).                       
           05  PV-PARAGRAPH-NAME               PIC X(30)   VALUE SPACE.         
           05  PV-DB2-OPERATION-ATTEMPTED      PIC X(30)   VALUE SPACE.         
           05  PV-WORK-CENTURY                 PIC 9(04).                       
           05  FILLER  REDEFINES  PV-WORK-CENTURY.                              
               10  PV-CENTURY                  PIC 9(02).                       
               10  FILLER                      PIC X(02).                       
           05  PV-DTATTR-KEY-DTE.                                               
               10  PV-MN-END-CENT           PIC 9(2)      VALUE ZERO.           
               10  PV-MN-END-YEAR           PIC 9(2)      VALUE ZERO.           
               10  FILLER                   PIC X         VALUE '-'.            
               10  PV-MN-END-MTH            PIC 9(2)      VALUE ZERO.           
               10  FILLER                   PIC X         VALUE '-'.            
               10  PV-MN-END-DAY            PIC 9(2)      VALUE ZERO.           
W33304     05  PV-MONTH                     PIC X(10)     VALUE SPACES.         
W33304     05  PV-INV-ID                    PIC S9(09)    COMP                  
W33304                                                    VALUE ZERO.           
W33304     05  PV-CUR-INV-ID                PIC S9(09)    COMP                  
W33304                                                    VALUE ZERO.           
W33304     05  PV-INV-NM                    PIC X(20)     VALUE SPACES.         
W33304     05  PV-MONTH-HEADER.                                                 
W33304         10  PV-MONTH-NBR             PIC 9(02)     VALUE ZERO.           
W33304         10  FILLER                   PIC X         VALUE '-'.            
W33304         10  PV-MONTH-NAME            PIC X(10)     VALUE SPACES.         
W33304         10  FILLER                   PIC X(07)     VALUE SPACES.         
W33304     05  PV-MONTH-NM REDEFINES PV-MONTH-HEADER                            
W33304                                      PIC X(20).                          
                                                                                
       01  SC-SAVE-CURRENT.                                                     
           05  SC-DIV                       PIC 9(01)     VALUE ZEROES.         
           05  SC-MGR                       PIC 9(02)     VALUE ZEROES.         
           05  SC-BUYER                     PIC 9(02)     VALUE ZEROES.         
           05  SC-DEPT                      PIC 9(03)     VALUE ZEROES.         
W33304     05  SC-CYCLE                     PIC 9(05)     VALUE ZEROES.         
W33304     05  SC-MONTH                     PIC X(10)     VALUE SPACES.         
                                                                                
       01  SD-SYSTEM-DATE.                                                      
           05  SD-YY                        PIC 9(02)     VALUE ZEROES.         
           05  SD-MM                        PIC 9(02)     VALUE ZEROES.         
           05  SD-DD                        PIC 9(02)     VALUE ZEROES.         
                                                                                
       01  SH-SUB-HEADING-1.                                                    
           05  FILLER                       PIC X(10)     VALUE                 
           'COMPANY:  '.                                                        
           05  FILLER                       PIC X(23)     VALUE                 
           'KOHLS DEPARTMENT STORES'.                                           
           05  FILLER                       PIC X(99)     VALUE SPACES.         
                                                                                
       01  SH-SUB-HEADING-2.                                                    
           05  FILLER                       PIC X(10)     VALUE                 
           'DIVISION: '.                                                        
           05  SH-DIVISION                  PIC X(01)     VALUE SPACES.         
           05  FILLER                       PIC X(121)    VALUE SPACES.         
                                                                                
       01  SH-SUB-HEADING-3.                                                    
           05  FILLER                       PIC X(09)     VALUE                 
           'MANAGER: '.                                                         
           05  SH-MANAGER-NO                PIC X(02)     VALUE SPACES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  SH-MANAGER-NAME              PIC X(20)     VALUE SPACES.         
           05  FILLER                       PIC X(100)    VALUE SPACES.         
                                                                                
       01  SH-SUB-HEADING-4.                                                    
           05  FILLER                       PIC X(09)     VALUE                 
           'BUYER:   '.                                                         
           05  SH-BUYER-NO                  PIC X(02)     VALUE SPACES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  SH-BUYER-NAME                PIC X(20)     VALUE SPACES.         
           05  FILLER                       PIC X(100)    VALUE SPACES.         
                                                                                
       01  SH-SUB-HEADING-5.                                                    
           05  FILLER                       PIC X(08)     VALUE                 
           'DEPT:   '.                                                          
           05  SH-DEPT-NO                   PIC X(03)     VALUE SPACES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  SH-DEPT-NAME                 PIC X(20)     VALUE SPACES.         
           05  FILLER                       PIC X(100)    VALUE SPACES.         
                                                                                
       01  SH-SUB-HEADING-6.                                                    
           05  SH-SUB-HEAD-FINCORP          PIC X(25)     VALUE SPACES.         
           05  FILLER                       PIC X(107)    VALUE SPACES.         
                                                                                
       01  SP-SAVE-PREVIOUS.                                                    
           05  SP-DIV                       PIC 9(01)     VALUE ZEROES.         
           05  SP-MGR                       PIC 9(02)     VALUE ZEROES.         
           05  SP-BUYER                     PIC 9(02)     VALUE ZEROES.         
           05  SP-DEPT                      PIC 9(03)     VALUE ZEROES.         
W33304     05  SP-CYCLE                     PIC 9(05)     VALUE ZEROES.         
W33304     05  SP-MONTH                     PIC X(10)     VALUE SPACES.         
                                                                                
       01  SPL-SPECIAL-LINES.                                                   
           05  FILLER                       PIC X(23)     VALUE                 
           '*** DEPT *** TOTALS    '.                                           
           05  FILLER                       PIC X(23)     VALUE                 
           '*** BUYER *** TOTALS   '.                                           
           05  FILLER                       PIC X(23)     VALUE                 
           '*** MANAGER *** TOTALS '.                                           
           05  FILLER                       PIC X(23)     VALUE                 
           '*** DIVISION *** TOTALS'.                                           
           05  FILLER                       PIC X(23)     VALUE                 
           '*** COMPANY *** TOTALS '.                                           
W33304     05  FILLER                       PIC X(23)     VALUE                 
W33304     '*** CYCLE *** TOTALS   '.                                           
W33304     05  FILLER                       PIC X(23)     VALUE                 
W33304     '*** MONTH *** TOTALS   '.                                           
                                                                                
       01  FILLER REDEFINES SPL-SPECIAL-LINES.                                  
W33304     05  SPL-SPECIAL-ENTRIES OCCURS 7 TIMES.                              
               10  SPL-SPECIAL-LINE         PIC X(23).                          
                                                                                
       01  ST-SYSTEM-TIME.                                                      
           05  ST-HR                        PIC 9(02)     VALUE ZEROES.         
           05  ST-MM                        PIC 9(02)     VALUE ZEROES.         
           05  ST-SS                        PIC 9(02)     VALUE ZEROES.         
           05  FILLER                       PIC 9(02)     VALUE ZEROES.         
                                                                                
       01  TA-TOTAL-ACCUMULATORS                          COMP-3.               
W26600     05  TA-DEPT-SALES                PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-DEPT-INV                  PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-BUYER-SALES               PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-BUYER-INV                 PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-MANAGER-SALES             PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-MANAGER-INV               PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-DIVISION-SALES            PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-DIVISION-INV              PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-FINAL-SALES               PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-FINAL-INV                 PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-DC-INV                    PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-CURRENT-SALES             PIC S9(13)V99 VALUE ZEROES.         
W26600     05  TA-CURRENT-INV               PIC S9(13)V99 VALUE ZEROES.         
W33304     05  TA-CYCLE-SALES               PIC S9(13)V99 VALUE ZEROES.         
W33304     05  TA-CYCLE-INV                 PIC S9(13)V99 VALUE ZEROES.         
W33304     05  TA-MONTH-SALES               PIC S9(13)V99 VALUE ZEROES.         
W33304     05  TA-MONTH-INV                 PIC S9(13)V99 VALUE ZEROES.         
                                                                                
       01  TL-TOTAL-LINE.                                                       
W33304     05  TL-FISCAL                    PIC X(07)     VALUE SPACES.         
W33304     05  TL-MONTH-TOTAL               PIC X(09)     VALUE SPACES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-BEG-INV                   PIC ZZZ,ZZZ,ZZZ.Z-                  
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-RECEIPTS                  PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-PURCH-ADJ                 PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
21591      05  FILLER                       PIC X(01)     VALUE SPACES.         
W27808     05  TL-ST-EXPECT                 PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
OCFSFS     05  FILLER                       PIC X(02)     VALUE SPACES.         
OCFSFS     05  TL-PARL-SHIP                 PIC ZZ,ZZZ,ZZZ.Z-                   
OCFSFS                                                    VALUE ZEROES.         
R26600     05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-SALES                     PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
R26600     05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-SHRINK                    PIC Z,ZZZ,ZZZ.Z-                    
                                                          VALUE ZEROES.         
R26600*    05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-XFER-IN                   PIC ZZ,ZZZ,ZZZ.Z                    
                                                          VALUE ZEROES.         
WR9999*    05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-XFER-OUT                  PIC ZZ,ZZZ,ZZZ.Z                    
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-MKDN                      PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
           05  FILLER                       PIC X(01)     VALUE SPACES.         
           05  TL-MKUP                      PIC ZZ,ZZZ,ZZZ.Z-                   
                                                          VALUE ZEROES.         
           05  TL-END-INV                   PIC ZZZ,ZZZ,ZZZ.Z-                  
                                                          VALUE ZEROES.         
W33304 01  MTH-TOTAL-LINE.                                                      
W33304     05  MTH-TOTAL                    PIC X(16)     VALUE                 
W33304            'MONTH TOTALS FOR'.                                           
W33304                                                                          
       01  WV-WORK-VARIABLES.                                                   
           05  WV-SALES                     PIC S9(11)V99 VALUE +0              
                                                          COMP-3.               
           05  WV-MKDN                      PIC S9(11)V99 VALUE +0              
                                                          COMP-3.               
           05  WV-SHRINKAGE                 PIC S9(11)V99 VALUE +0              
                                                          COMP-3.               
                                                                                
       01  ZT-ZERO-TOTALS.                                                      
W26600     05  ZT-STORE-ENTRY               OCCURS 9999 TIMES.                  
W26600         10  ZT-STORE-NO              PIC 9(05).                          
               10  ZT-STORE-NAME            PIC X(10).                          
W33304         10  ZT-INV-ID                PIC S9(09)    COMP.                 
               10  ZT-STORE-CODE            PIC X(02).                          
               10  ZT-STORE-TOTALS                        COMP-3.               
W26600             15  ZT-BEG-INV           PIC S9(13)V99.                      
W26600             15  ZT-RECEIPTS          PIC S9(13)V99.                      
W26600             15  ZT-PURCH-ADJ         PIC S9(13)V99.                      
OCFSFS             15  ZT-PARL-SHIP         PIC S9(13)V99.                      
W27808             15  ZT-ST-EXPECT         PIC S9(13)V99.                      
W26600             15  ZT-SALES             PIC S9(13)V99.                      
W26600             15  ZT-SHRINK            PIC S9(13)V99.                      
W26600             15  ZT-XFER-IN           PIC S9(13)V99.                      
W26600             15  ZT-XFER-OUT          PIC S9(13)V99.                      
W26600             15  ZT-MKUP              PIC S9(13)V99.                      
W26600             15  ZT-MKDN              PIC S9(13)V99.                      
W26600             15  ZT-END-INV           PIC S9(13)V99.                      
               10  ZT-TYPE-CODE             PIC X(02).                          
                                                                                
       01  ABEND-CODE                        PIC S9(04)   VALUE +0              
                                                          COMP SYNC.            
      ****************************************************************          
      * BEFORE INVENTORY ADJ EXTRACT                                            
      ****************************************************************          
      *01  IN013-INVENTORY-ADJ-EXTR-REC.                                        
W28545     COPY INRD013.                                                        
28545 *                                                                 01380000
28545 ******************************************************************01320000
28545 *  DCLGEN FOR THE INVENTORY CONTROL TABLE.                        01330000
28545 ******************************************************************01340000
28545      EXEC SQL                                                     01350000
28545          INCLUDE TINCNTL                                          01360000
28545      END-EXEC.                                                    01370000
28545 *                                                                 01380000
                                                                                
      ****************************************************************          
      * INVENTORY PARAMETERS TABLE                                              
      ****************************************************************          
                                                                                
W27808     EXEC SQL                                                             
               INCLUDE TINVPAR                                                  
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      * DATE ATTRIBUTE TABLE                                                    
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TDTATTR                                                  
           END-EXEC.                                                            
                                                                                
                                                                                
      ***************************************************************           
      *    USED FOR DB2 ERRORS.                                                 
      ***************************************************************           
                                                                                
           COPY SQLCA2.                                                         
                                                                                
      ***************************************************************           
      *    LAYOUT USED FOR DB2 STORE TABLE.                                     
      ***************************************************************           
                                                                                
           EXEC SQL                                                             
W26600         INCLUDE XMT00001                                                 
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  SQL AND COBOL DECLARATIONS FOR THE                            *        
      *  MERCHANDISE AREA TABLE (TMDSEAR)                              *        
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TMDSEAR                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  SQL AND COBOL DECLARATIONS FOR THE                            *        
      *  RESPONSIBILITY AREA TABLE (TRSPBAR)                           *        
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TRSPBAR                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  SQL AND COBOL DECLARATIONS FOR THE                            *        
      *  APPLICATION AVAILABILITY TABLE (TAPLAVL)                      *        
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TAPLAVL                                                  
           END-EXEC.                                                            
                                                                                
      ***************************************************************           
      *    USED FOR DB2 ERRORS.                                     *           
      ***************************************************************           
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
      ***************************************************************           
      *    CURSOR DECLARATION USED FOR ACCESSING DB2 STORE TABLE                
      ***************************************************************           
                                                                                
           EXEC SQL                                                             
               DECLARE STORE_CURSOR CURSOR FOR                                  
W26600             SELECT A.LOC_NBR,                                            
W26600                    LOC_TYP_CDE,                                          
W33304                    VALUE(LOC_10_ABBR_NM,'*****'),                        
W33304                    C.INV_ID                                              
W26600             FROM XMT_LOC A                                               
W27808                 ,TINVPAR B                                               
28545                  ,TINCNTL C                                               
W27808             WHERE B.ACTL_FIN_BK_DTE = '9999-09-09'                       
W27808               AND A.LOC_NBR = B.LOC_NBR                                  
W33304               AND B.LOC_INV_STAT_CDE = 'IN'                              
RONNA1****           AND B.SCHD_PHY_CNT_CDE <> 'EI'                             
28545                AND B.INV_ID = C.INV_ID                                    
28545                AND C.ACTV_IND = 'Y'                                       
W26600             ORDER BY A.LOC_NBR                                           
W26600             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
       LINKAGE SECTION.                                                         
       PROCEDURE DIVISION.                                                      
      ***************************************************************           
       A100-MAIN-MODULE.                                                        
      ***************************************************************           
                                                                                
           OPEN INPUT  INVENTORY-ADJ-EXTR                                       
                OUTPUT INVENTORY-ADJ-RPT.                                       
                                                                                
           PERFORM B100-INITIALIZE.                                             
                                                                                
           PERFORM B400-OPEN-CURSOR.                                            
           PERFORM Z300-FETCH-STORE.                                            
           PERFORM B500-LOAD-STORES                                             
               UNTIL SQLCODE IS EQUAL TO 100.                                   
W33304     PERFORM B600-CLOSE-CURSOR.                                           
                                                                                
           MOVE DT-DEPT-TOTALS TO BT-BUYER-TOTALS                               
                                  MT-MANAGER-TOTALS                             
                                  DVT-DIVISION-TOTALS                           
W33304                            CY-CYCLE-TOTALS                               
W33304                            MN-MONTH-TOTALS                               
                                  FT-FINAL-TOTALS.                              
                                                                                
           PERFORM Z350-READ-INVENTORY-ADJ-EXTR.                                
           PERFORM C200-PROCESS-RECORDS                                         
               UNTIL PS-EXTR-EOF.                                               
                                                                                
           IF PS-PASSED-FIRST-RECORD                                            
               PERFORM D100-TOTAL-BREAK                                         
               PERFORM E500-PRINT-FINAL-TOTAL                                   
           ELSE                                                                 
               PERFORM Z250-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           PERFORM Z700-DISPLAY-FINAL-TOTALS.                                   
                                                                                
           CLOSE  INVENTORY-ADJ-EXTR                                            
                  INVENTORY-ADJ-RPT.                                            
                                                                                
           STOP RUN.                                                            
       EJECT                                                                    
       B100-INITIALIZE.                                                         
                                                                                
      ***************************************************************           
      *    SET UP THE KOHLS STANDARD PAGE HEADING.                              
      *    INITIALIZE TABLES.                                                   
      ***************************************************************           
                                                                                
           ACCEPT SD-SYSTEM-DATE                                                
               FROM DATE.                                                       
           ACCEPT ST-SYSTEM-TIME                                                
               FROM TIME.                                                       
                                                                                
21591      MOVE SD-MM      TO DP200O-RUN-MONTH.                                 
21591      MOVE SD-DD      TO DP200O-RUN-DAY.                                   
21591      MOVE SD-YY      TO DP200O-RUN-YEAR.                                  
21591      MOVE ST-HR      TO DP200O-RUN-HOUR.                                  
21591      MOVE ST-MM      TO DP200O-RUN-MINUTE.                                
21591      MOVE 'INKRP140' TO DP200O-PROGRAM-NAME.                              
21591      MOVE 1          TO DP200O-REPORT-NUMBER.                             
                                                                                
W33304*  GET CURRENT JOB INFORMATION FOR USE IN THE REPORT                      
W33304     CALL DP085-GET-CURR-JOB-INFO-PGM                                     
W33304         USING DP085-GET-CURR-JOB-INFO-PARMS.                             
W33304     MOVE DP085-JOB-NAME     TO PV-JOB-NAME.                              
W33304                                                                          
W33304     MOVE PV-JOB-INFO                                                     
W33304         TO DP200O-STANDRD-HEADER-200-COLS(20:10).                        
W33304                                                                          
           MOVE 1 TO PS-SUB.                                                    
           PERFORM C100-INITIALIZE-DEPT-TABLE                                   
W27808*        UNTIL PS-SUB IS GREATER THAN 999.                                
W27808         UNTIL PS-SUB IS GREATER THAN PC-MAX-STORE.                       
           INITIALIZE PS-SUB                                                    
                      PT1-PAGE-TOTALS.                                          
                                                                                
                                                                                
           MOVE +20        TO DP024-FLNAME-LENGTH.                              
                                                                                
                                                                                
       EJECT                                                                    
       B200-GET-DATE-ATTRIBUTES.                                                
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNT FROM 1 BY 1                               
                 UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                        
                    OR (SQLCODE         = +000)                                 
                    OR (SQLCODE         = +100)                                 
                                                                                
               EXEC SQL                                                         
                    SELECT                                                      
                       FSCL_MN_END_DTE                                          
                    INTO                                                        
                       :DTATTR-FSCL-MN-END-DTE                                  
                    FROM                                                        
                        TDTATTR                                                 
                    WHERE                                                       
W33304                  KY_DTE = :INCNTL-OPN-FSCL-MN-DTE                        
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE        = +000                                   
                   WHEN SQLCODE        = -904                                   
                   WHEN SQLCODE        = -911                                   
                       CONTINUE                                                 
                   WHEN OTHER                                                   
W33304                 DISPLAY 'INCNTL-OPN-FSCL-MN-DTE: '                       
W33304                          INCNTL-OPN-FSCL-MN-DTE                          
                       MOVE    'B200-GET-DATE-ATTRIBUTES'                       
                                                TO PV-PARAGRAPH-NAME            
                       MOVE    'SELECT ROW FROM TDTATTR'                        
                                           TO PV-DB2-OPERATION-ATTEMPTED        
                       PERFORM Z960-SQL-WARNING                                 
               END-EVALUATE                                                     
                                                                                
           END-PERFORM.                                                         
                                                                                
                                                                                
       B300-CHECK-CALENDAR.                                                     
                                                                                
      ***************************************************************           
      *    READ THE CALENDAR DB.                                                
      *    MAKE SURE THE DATE IS THE LAST SATURDAY OF THE                       
      *    MONTH IN QUESTION.                                                   
      ***************************************************************           
                                                                                
           MOVE PC-CALENDAR-TYPE     TO  DPG51-CALENDAR-TYPE.                   
           SET DPG52-LK-DTE-GREG     TO  TRUE.                                  
           MOVE DTATTR-FSCL-MN-END-DTE TO PV-DTATTR-KEY-DTE.                    
           MOVE PV-MN-END-MTH        TO  DPG52-GREG-DATE-MO.                    
           MOVE PV-MN-END-DAY        TO  DPG52-GREG-DATE-DY.                    
           MOVE PV-MN-END-YEAR       TO  DPG52-GREG-DATE-YR.                    
                                                                                
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                        
                                                   DPG52                        
                                                   DPG53                        
                                                   DPG54                        
                                                   DPG55                        
                                                   DPG56.                       
                                                                                
           IF  DPG55-NUMERIC-WEEK-DAY EQUAL PC-SATURDAY                         
               CONTINUE                                                         
           ELSE                                                                 
               DISPLAY '*** ABEND *** IN INKRP140'                              
               DISPLAY 'DATE IS NOT A WEEK ENDING DATE '                        
               MOVE +4003 TO ABEND-CODE                                         
               CALL 'ILBOABN0' USING ABEND-CODE                                 
           END-IF.                                                              
                                                                                
           IF  DPG56-FISCAL-PERIOD-WEEK NOT EQUAL                               
               DPG56-NBR-FISCAL-PERIOD-WEEKS                                    
               DISPLAY '*** ABEND *** IN INKRP140'                              
               DISPLAY 'DATE MUST BE THE LAST WEEK OF THE MONTH'                
               MOVE +4003 TO ABEND-CODE                                         
               CALL 'ILBOABN0' USING ABEND-CODE                                 
           END-IF.                                                              
                                                                                
                                                                                
                                                                                
       B400-OPEN-CURSOR.                                                        
                                                                                
      ***************************************************************           
      *    OPEN THE DB2 STORE CURSOR.                                           
      ***************************************************************           
                                                                                
           EXEC SQL                                                             
               OPEN STORE_CURSOR                                                
           END-EXEC.                                                            
                                                                                
           IF SQLCODE < 0                                                       
               DISPLAY 'INKRP140 - OPEN UNSUCCESSFUL'                           
W26600         DISPLAY 'INKRP140 - STORE TABLE XMTLOC'                          
               PERFORM Z950-SQL-ERROR                                           
           ELSE                                                                 
               IF (SQLCODE > 0                                                  
                        AND SQLCODE NOT = +100)                                 
                        OR SQLWARN0 = 'W'                                       
                   DISPLAY 'INKRP140 - OPEN UNSUCCESSFUL'                       
W26600             DISPLAY 'INKRP140 - STORE TABLE XMTLOC'                      
                   PERFORM Z960-SQL-WARNING                                     
               END-IF                                                           
           END-IF.                                                              
                                                                                
       EJECT                                                                    
       B500-LOAD-STORES.                                                        
                                                                                
      ***************************************************************           
      *    USING THE DB2 STORE TABLE, FILL IN THE DEPT AND ZERO OUT             
      *    TABLES.  THE ZERO OUT TABLE IS USED TO REINITIALIZE ALL              
      *    TABLES.  ONLY USE STORES WITH A TYPE CODE OF 'DS', 'DC'              
      *    OR 'WH'.                                                             
      ***************************************************************           
                                                                                
           IF (XMT00001-LOC-TYP-CDE IS EQUAL TO 'DC') OR                        
              (XMT00001-LOC-TYP-CDE IS EQUAL TO 'DS') OR                        
              (XMT00001-LOC-TYP-CDE IS EQUAL TO 'RV') OR                        
              (XMT00001-LOC-TYP-CDE IS EQUAL TO 'CS') OR                        
              (XMT00001-LOC-TYP-CDE IS EQUAL TO 'DA')                           
               ADD  1                         TO PS-SUB                         
W26600         MOVE XMT00001-LOC-TYP-CDE      TO ZT-TYPE-CODE(PS-SUB)           
W26600         MOVE XMT00001-LOC-NBR          TO DT-STORE-NO(PS-SUB)            
                                                 ZT-STORE-NO(PS-SUB)            
W26600         MOVE XMT00001-LOC-10-ABBR-NM   TO DT-STORE-NAME(PS-SUB)          
                                                 ZT-STORE-NAME(PS-SUB)          
W26600         MOVE '01'                      TO DT-STORE-CODE(PS-SUB)          
                                                 ZT-STORE-CODE(PS-SUB)          
W33304         MOVE INCNTL-INV-ID             TO DT-INV-ID(PS-SUB)              
W33304                                           ZT-INV-ID(PS-SUB)              
           END-IF.                                                              
                                                                                
           PERFORM Z300-FETCH-STORE.                                            
       EJECT                                                                    
W33304 B600-CLOSE-CURSOR.                                                       
W33304                                                                          
W33304     EXEC SQL                                                             
W33304         CLOSE STORE_CURSOR                                               
W33304     END-EXEC.                                                            
W33304                                                                          
W33304     EVALUATE TRUE                                                        
W33304         WHEN SQLCODE = ZERO                                              
W33304             CONTINUE                                                     
W33304         WHEN OTHER                                                       
W33304             MOVE 'B600-CLOSE-CURSOR'                                     
W33304                                          TO PV-PARAGRAPH-NAME            
W33304             MOVE 'CLOSE STORE_CURSOR'    TO                              
W33304                                    PV-DB2-OPERATION-ATTEMPTED            
W33304             PERFORM Z960-SQL-WARNING                                     
W33304     END-EVALUATE.                                                        
W33304 EJECT                                                                    
       C100-INITIALIZE-DEPT-TABLE.                                              
                                                                                
      ***************************************************************           
      *    INITIALIZE THE DEPT AND ZERO OUT TABLES.                             
      *    THE ZERO OUT TABLE IS USED TO REINITIALIZE ALL TABLES.               
      ***************************************************************           
                                                                                
W27808*    MOVE 999          TO DT-STORE-NO(PS-SUB)                             
W27808     MOVE PC-MAX-STORE TO DT-STORE-NO(PS-SUB)                             
                                ZT-STORE-NO(PS-SUB).                            
           MOVE '**********' TO DT-STORE-NAME(PS-SUB)                           
                                ZT-STORE-NAME(PS-SUB).                          
           INITIALIZE           DT-STORE-CODE(PS-SUB)                           
                                ZT-STORE-CODE(PS-SUB)                           
                                DT-BEG-INV(PS-SUB)                              
                                ZT-BEG-INV(PS-SUB)                              
                                DT-RECEIPTS(PS-SUB)                             
                                ZT-RECEIPTS(PS-SUB)                             
                                DT-PURCH-ADJ(PS-SUB)                            
                                ZT-PURCH-ADJ(PS-SUB)                            
OCFSFS                          DT-PARL-SHIP (PS-SUB)                           
OCFSFS                          ZT-PARL-SHIP (PS-SUB)                           
W27808                          DT-ST-EXPECT(PS-SUB)                            
W27808                          ZT-ST-EXPECT(PS-SUB)                            
                                DT-SALES(PS-SUB)                                
                                ZT-SALES(PS-SUB)                                
                                DT-SHRINK(PS-SUB)                               
                                ZT-SHRINK(PS-SUB)                               
                                DT-XFER-IN(PS-SUB)                              
                                ZT-XFER-IN(PS-SUB)                              
                                DT-XFER-OUT(PS-SUB)                             
                                ZT-XFER-OUT(PS-SUB)                             
                                DT-MKUP(PS-SUB)                                 
                                ZT-MKUP(PS-SUB)                                 
                                DT-MKDN(PS-SUB)                                 
                                ZT-MKDN(PS-SUB)                                 
                                DT-END-INV(PS-SUB)                              
                                ZT-END-INV(PS-SUB)                              
                                ZT-TYPE-CODE(PS-SUB).                           
           ADD  1            TO PS-SUB.                                         
       EJECT                                                                    
       C200-PROCESS-RECORDS.                                                    
                                                                                
      ***************************************************************           
      *    PROCESS THE CURRENT RECORD.                                          
      *    IF THE CURRENT AND PREVIOUS RECORD ARE THE SAME,                     
      *    ACCUMULATE THE STORE TOTALS FOR ALL LEVELS.                          
      *    IF THE CURRENT AND PREVIOUS RECORD ARE DIFFERENT, DETERMINE          
      *    WHERE THE BREAK OCCURRED AND WHICH TOTALS TO PRINT.                  
      ***************************************************************           
                                                                                
           ADD 1 TO PC-INPUT-COUNTER.                                           
                                                                                
           INITIALIZE PS-STORE-SUB.                                             
           SET PS-INVALID-STORE TO TRUE.                                        
           PERFORM D300-VALIDATE-STORE                                          
W27808*        UNTIL (PS-STORE-SUB IS GREATER THAN 999) OR                      
W27808         UNTIL (PS-STORE-SUB IS GREATER THAN PC-MAX-STORE) OR             
                     (PS-VALID-STORE).                                          
           IF PS-VALID-STORE                                                    
               ADD 1           TO PC-GOOD-COUNTER                               
W33304         MOVE IN013-INV-ID  TO SC-CYCLE                                   
W33304         MOVE IN013-OPN-FSCL-MN-DTE                                       
W33304                            TO SC-MONTH                                   
               MOVE IN013-GMA-NBR TO SC-DIV                                     
               MOVE IN013-DMA-NBR TO SC-MGR                                     
               MOVE IN013-BYR-NBR TO SC-BUYER                                   
               MOVE IN013-DEPT-NBR TO SC-DEPT                                   
               IF PS-FIRST-RECORD                                               
                   MOVE SC-SAVE-CURRENT    TO SP-SAVE-PREVIOUS                  
W33304             MOVE IN013-INV-ID       TO PV-CUR-INV-ID                     
W33304             MOVE INCNTL-INV-NM-TEXT TO PV-INV-NM                         
W33304             MOVE INCNTL-OPN-FSCL-MN-NBR                                  
W33304                                     TO PV-MONTH-NBR                      
W33304             MOVE DPG56-FISCAL-PERIOD-NAME                                
W33304                                     TO PV-MONTH                          
                   SET PS-PASSED-FIRST-RECORD TO TRUE                           
               END-IF                                                           
               INITIALIZE PS-SUB                                                
               IF SP-SAVE-PREVIOUS NOT EQUAL TO SC-SAVE-CURRENT                 
                   PERFORM D100-TOTAL-BREAK                                     
               END-IF                                                           
               INITIALIZE PS-SUB                                                
               SET PS-INVALID-STORE TO TRUE                                     
               PERFORM D200-ACCUMULATE-DETAIL                                   
W27808*            UNTIL (PS-SUB IS GREATER THAN 999) OR                        
W27808             UNTIL (PS-SUB IS GREATER THAN PC-MAX-STORE) OR               
                         (PS-VALID-STORE)                                       
               MOVE SC-SAVE-CURRENT TO SP-SAVE-PREVIOUS                         
W33304         MOVE IN013-INV-ID    TO PV-CUR-INV-ID                            
W33304         MOVE INCNTL-INV-NM-TEXT                                          
W33304                              TO PV-INV-NM                                
W33304         MOVE INCNTL-OPN-FSCL-MN-NBR                                      
W33304                              TO PV-MONTH-NBR                             
W33304         MOVE DPG56-FISCAL-PERIOD-NAME                                    
W33304                              TO PV-MONTH                                 
W27808*        IF PS-SUB IS GREATER THAN 999                                    
W27808         IF PS-SUB IS GREATER THAN PC-MAX-STORE                           
                   DISPLAY '*** ABEND *** IN INKRP140'                          
                   DISPLAY 'INVALID STORE NUMBER ENCOUNTERED'                   
                   DISPLAY 'STORE NUMBER ' IN013-STR-NBR                        
                   MOVE +4008 TO ABEND-CODE                                     
                   CALL 'ILBOABN0' USING ABEND-CODE                             
               END-IF                                                           
           ELSE                                                                 
               ADD 1 TO PC-REJECT-INV-STORE                                     
           END-IF.                                                              
                                                                                
           PERFORM Z350-READ-INVENTORY-ADJ-EXTR.                                
       EJECT                                                                    
       D100-TOTAL-BREAK.                                                        
                                                                                
      ***************************************************************           
      *    COMPARE THE CURRENT AND PREVIOUS RECORD TO DETERMINE                 
      *    WHERE THE BREAK OCCURRED AND PRINT THE APPROPRIATE TOTALS.           
      ***************************************************************           
                                                                                
           PERFORM Z500-SELECT-DEPT.                                            
           MOVE MDSEAR-DEPT-NBR        TO SH-DEPT-NO.                           
           MOVE MDSEAR-DESC            TO SH-DEPT-NAME.                         
                                                                                
           PERFORM Z400-SELECT-BUYER.                                           
           MOVE SP-BUYER               TO SH-BUYER-NO.                          
           MOVE RSPBAR-WORKER-FIR-NAME TO DP024-FNAME.                          
           MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME.                         
           PERFORM DP024-0000-FORMAT-NAME.                                      
           MOVE DP024-FLNAME           TO SH-BUYER-NAME.                        
                                                                                
           PERFORM Z450-SELECT-MANAGER.                                         
           MOVE MDSEAR-DMA-NBR         TO SH-MANAGER-NO.                        
           MOVE RSPBAR-WORKER-FIR-NAME TO DP024-FNAME.                          
           MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME.                         
           PERFORM DP024-0000-FORMAT-NAME.                                      
           MOVE DP024-FLNAME           TO SH-MANAGER-NAME.                      
                                                                                
           MOVE SP-DIV    TO SH-DIVISION.                                       
                                                                                
W33304     IF SC-MONTH IS NOT EQUAL TO SP-MONTH                                 
W33304         PERFORM E100-PRINT-DEPT-TOTAL THRU                               
W33304                 E475-PRINT-MONTH-TOTAL                                   
W33304     ELSE                                                                 
W33304                                                                          
W33304         IF SC-CYCLE IS NOT EQUAL TO SP-CYCLE                             
W33304             PERFORM E100-PRINT-DEPT-TOTAL THRU                           
W33304                     E450-PRINT-CYCLE-TOTAL                               
W33304         ELSE                                                             
                                                                                
                   IF SC-DIV IS NOT EQUAL TO SP-DIV                             
                       PERFORM E100-PRINT-DEPT-TOTAL THRU                       
                               E400-PRINT-DIV-TOTAL                             
                   ELSE                                                         
                                                                                
                       IF SC-MGR IS NOT EQUAL TO SP-MGR                         
                           PERFORM E100-PRINT-DEPT-TOTAL THRU                   
                               E300-PRINT-MGR-TOTAL                             
                       ELSE                                                     
                                                                                
                           IF SC-BUYER IS NOT EQUAL TO SP-BUYER                 
                               PERFORM E100-PRINT-DEPT-TOTAL THRU               
                                   E200-PRINT-BUYER-TOTAL                       
                           ELSE                                                 
                               PERFORM E100-PRINT-DEPT-TOTAL                    
                           END-IF                                               
                                                                                
                       END-IF                                                   
                                                                                
W33304             END-IF                                                       
W33304                                                                          
W33304         END-IF                                                           
W33304                                                                          
           END-IF.                                                              
       EJECT                                                                    
       D200-ACCUMULATE-DETAIL.                                                  
                                                                                
      ***************************************************************           
      *    ACCUMULATE TOTALS AT ALL LEVELS FOR THE CURRENT STORE.               
      ***************************************************************           
                                                                                
           ADD 1 TO PS-SUB.                                                     
                                                                                
           IF IN013-STR-NBR IS EQUAL TO DT-STORE-NO(PS-SUB)                     
               SET PS-VALID-STORE TO TRUE                                       
                                                                                
               ADD  IN013-BEG-INV-RTL-AMT   TO DT-BEG-INV(PS-SUB)               
               ADD  IN013-BEG-INV-RTL-AMT   TO BT-BEG-INV(PS-SUB)               
               ADD  IN013-BEG-INV-RTL-AMT   TO MT-BEG-INV(PS-SUB)               
               ADD  IN013-BEG-INV-RTL-AMT   TO DVT-BEG-INV(PS-SUB)              
W33304         ADD  IN013-BEG-INV-RTL-AMT   TO CY-BEG-INV(PS-SUB)               
W33304         ADD  IN013-BEG-INV-RTL-AMT   TO MN-BEG-INV(PS-SUB)               
               ADD  IN013-BEG-INV-RTL-AMT   TO FT-BEG-INV(PS-SUB)               
                                                                                
               ADD  IN013-RCPT-RTL-AMT TO DT-RECEIPTS(PS-SUB)                   
               ADD  IN013-RCPT-RTL-AMT TO BT-RECEIPTS(PS-SUB)                   
               ADD  IN013-RCPT-RTL-AMT TO MT-RECEIPTS(PS-SUB)                   
               ADD  IN013-RCPT-RTL-AMT TO DVT-RECEIPTS(PS-SUB)                  
W33304         ADD  IN013-RCPT-RTL-AMT TO CY-RECEIPTS(PS-SUB)                   
W33304         ADD  IN013-RCPT-RTL-AMT TO MN-RECEIPTS(PS-SUB)                   
               ADD  IN013-RCPT-RTL-AMT TO FT-RECEIPTS(PS-SUB)                   
                                                                                
               ADD  IN013-PADJ-RTL-AMT TO DT-PURCH-ADJ(PS-SUB)                  
               ADD  IN013-PADJ-RTL-AMT TO BT-PURCH-ADJ(PS-SUB)                  
               ADD  IN013-PADJ-RTL-AMT TO MT-PURCH-ADJ(PS-SUB)                  
               ADD  IN013-PADJ-RTL-AMT TO DVT-PURCH-ADJ(PS-SUB)                 
W33304         ADD  IN013-PADJ-RTL-AMT TO CY-PURCH-ADJ(PS-SUB)                  
W33304         ADD  IN013-PADJ-RTL-AMT TO MN-PURCH-ADJ(PS-SUB)                  
               ADD  IN013-PADJ-RTL-AMT TO FT-PURCH-ADJ(PS-SUB)                  
                                                                                
OCFSFS         ADD  IN013-STR-PARL-SHIP-RTL-AMT                                 
OCFSFS                                      TO DT-PARL-SHIP (PS-SUB)            
OCFSFS         ADD  IN013-STR-PARL-SHIP-RTL-AMT                                 
OCFSFS                                      TO BT-PARL-SHIP (PS-SUB)            
OCFSFS         ADD  IN013-STR-PARL-SHIP-RTL-AMT                                 
OCFSFS                                      TO MT-PARL-SHIP (PS-SUB)            
OCFSFS         ADD  IN013-STR-PARL-SHIP-RTL-AMT                                 
OCFSFS                                      TO DVT-PARL-SHIP (PS-SUB)           
OCFSFS         ADD  IN013-STR-PARL-SHIP-RTL-AMT                                 
OCFSFS                                      TO FT-PARL-SHIP (PS-SUB)            
OCFSFS         ADD  IN013-STR-PARL-SHIP-RTL-AMT                                 
OCFSFS                                      TO CY-PARL-SHIP (PS-SUB)            
OCFSFS         ADD  IN013-STR-PARL-SHIP-RTL-AMT                                 
OCFSFS                                      TO MN-PARL-SHIP (PS-SUB)            
OCFSFS                                                                          
W27808         ADD  IN013-STR-EXPTED-RTL-AMT TO DT-ST-EXPECT(PS-SUB)            
W27808         ADD  IN013-STR-EXPTED-RTL-AMT TO BT-ST-EXPECT(PS-SUB)            
W27808         ADD  IN013-STR-EXPTED-RTL-AMT TO MT-ST-EXPECT(PS-SUB)            
W27808         ADD  IN013-STR-EXPTED-RTL-AMT TO DVT-ST-EXPECT(PS-SUB)           
W33304         ADD  IN013-STR-EXPTED-RTL-AMT TO CY-ST-EXPECT(PS-SUB)            
W33304         ADD  IN013-STR-EXPTED-RTL-AMT TO MN-ST-EXPECT(PS-SUB)            
W27808         ADD  IN013-STR-EXPTED-RTL-AMT TO FT-ST-EXPECT(PS-SUB)            
W27808                                                                          
               ADD  IN013-XFER-IN-RTL-AMT TO DT-XFER-IN(PS-SUB)                 
               ADD  IN013-XFER-IN-RTL-AMT TO BT-XFER-IN(PS-SUB)                 
               ADD  IN013-XFER-IN-RTL-AMT TO MT-XFER-IN(PS-SUB)                 
               ADD  IN013-XFER-IN-RTL-AMT TO DVT-XFER-IN(PS-SUB)                
W33304         ADD  IN013-XFER-IN-RTL-AMT TO CY-XFER-IN(PS-SUB)                 
W33304         ADD  IN013-XFER-IN-RTL-AMT TO MN-XFER-IN(PS-SUB)                 
               ADD  IN013-XFER-IN-RTL-AMT TO FT-XFER-IN(PS-SUB)                 
                                                                                
               ADD  IN013-XFER-OUT-RTL-AMT TO DT-XFER-OUT(PS-SUB)               
               ADD  IN013-XFER-OUT-RTL-AMT TO BT-XFER-OUT(PS-SUB)               
               ADD  IN013-XFER-OUT-RTL-AMT TO MT-XFER-OUT(PS-SUB)               
               ADD  IN013-XFER-OUT-RTL-AMT TO DVT-XFER-OUT(PS-SUB)              
W33304         ADD  IN013-XFER-OUT-RTL-AMT TO CY-XFER-OUT(PS-SUB)               
W33304         ADD  IN013-XFER-OUT-RTL-AMT TO MN-XFER-OUT(PS-SUB)               
               ADD  IN013-XFER-OUT-RTL-AMT TO FT-XFER-OUT(PS-SUB)               
                                                                                
               ADD  IN013-SLS-RTL-AMT TO DT-SALES(PS-SUB)                       
               ADD  IN013-SLS-RTL-AMT TO BT-SALES(PS-SUB)                       
               ADD  IN013-SLS-RTL-AMT TO MT-SALES(PS-SUB)                       
               ADD  IN013-SLS-RTL-AMT TO DVT-SALES(PS-SUB)                      
W33304         ADD  IN013-SLS-RTL-AMT TO CY-SALES(PS-SUB)                       
W33304         ADD  IN013-SLS-RTL-AMT TO MN-SALES(PS-SUB)                       
               ADD  IN013-SLS-RTL-AMT TO FT-SALES(PS-SUB)                       
               ADD  IN013-SLS-RTL-AMT TO TA-DEPT-SALES                          
               ADD  IN013-SLS-RTL-AMT TO TA-BUYER-SALES                         
               ADD  IN013-SLS-RTL-AMT TO TA-MANAGER-SALES                       
               ADD  IN013-SLS-RTL-AMT TO TA-DIVISION-SALES                      
W33304         ADD  IN013-SLS-RTL-AMT TO TA-CYCLE-SALES                         
W33304         ADD  IN013-SLS-RTL-AMT TO TA-MONTH-SALES                         
               ADD  IN013-SLS-RTL-AMT TO TA-FINAL-SALES                         
                                                                                
               ADD  IN013-SHNK-RTL-AMT TO DT-SHRINK(PS-SUB)                     
               ADD  IN013-SHNK-RTL-AMT TO BT-SHRINK(PS-SUB)                     
               ADD  IN013-SHNK-RTL-AMT TO MT-SHRINK(PS-SUB)                     
               ADD  IN013-SHNK-RTL-AMT TO DVT-SHRINK(PS-SUB)                    
W33304         ADD  IN013-SHNK-RTL-AMT TO CY-SHRINK(PS-SUB)                     
W33304         ADD  IN013-SHNK-RTL-AMT TO MN-SHRINK(PS-SUB)                     
               ADD  IN013-SHNK-RTL-AMT TO FT-SHRINK(PS-SUB)                     
                                                                                
               ADD  IN013-MKUP-RTL-AMT TO DT-MKUP(PS-SUB)                       
               ADD  IN013-MKUP-RTL-AMT TO BT-MKUP(PS-SUB)                       
               ADD  IN013-MKUP-RTL-AMT TO MT-MKUP(PS-SUB)                       
               ADD  IN013-MKUP-RTL-AMT TO DVT-MKUP(PS-SUB)                      
W33304         ADD  IN013-MKUP-RTL-AMT TO CY-MKUP(PS-SUB)                       
W33304         ADD  IN013-MKUP-RTL-AMT TO MN-MKUP(PS-SUB)                       
               ADD  IN013-MKUP-RTL-AMT TO FT-MKUP(PS-SUB)                       
                                                                                
               ADD  IN013-MKDN-RTL-AMT TO DT-MKDN(PS-SUB)                       
               ADD  IN013-MKDN-RTL-AMT TO BT-MKDN(PS-SUB)                       
               ADD  IN013-MKDN-RTL-AMT TO MT-MKDN(PS-SUB)                       
               ADD  IN013-MKDN-RTL-AMT TO DVT-MKDN(PS-SUB)                      
W33304         ADD  IN013-MKDN-RTL-AMT TO CY-MKDN(PS-SUB)                       
W33304         ADD  IN013-MKDN-RTL-AMT TO MN-MKDN(PS-SUB)                       
               ADD  IN013-MKDN-RTL-AMT TO FT-MKDN(PS-SUB)                       
                                                                                
               ADD  IN013-END-INV-RTL-AMT TO DT-END-INV(PS-SUB)                 
               ADD  IN013-END-INV-RTL-AMT TO BT-END-INV(PS-SUB)                 
               ADD  IN013-END-INV-RTL-AMT TO MT-END-INV(PS-SUB)                 
               ADD  IN013-END-INV-RTL-AMT TO DVT-END-INV(PS-SUB)                
W33304         ADD  IN013-END-INV-RTL-AMT TO CY-END-INV(PS-SUB)                 
W33304         ADD  IN013-END-INV-RTL-AMT TO MN-END-INV(PS-SUB)                 
               ADD  IN013-END-INV-RTL-AMT TO FT-END-INV(PS-SUB)                 
                                                                                
               IF ZT-TYPE-CODE(PS-SUB) = 'DC' OR 'CS' OR 'RV' OR 'DA'           
                   ADD IN013-END-INV-RTL-AMT TO TA-DC-INV                       
               ELSE                                                             
                   ADD IN013-END-INV-RTL-AMT TO TA-DEPT-INV                     
                   ADD IN013-END-INV-RTL-AMT TO TA-BUYER-INV                    
                   ADD IN013-END-INV-RTL-AMT TO TA-MANAGER-INV                  
                   ADD IN013-END-INV-RTL-AMT TO TA-DIVISION-INV                 
W33304             ADD IN013-END-INV-RTL-AMT TO TA-CYCLE-INV                    
W33304             ADD IN013-END-INV-RTL-AMT TO TA-MONTH-INV                    
                   ADD IN013-END-INV-RTL-AMT TO TA-FINAL-INV                    
               END-IF                                                           
                                                                                
           END-IF.                                                              
       EJECT                                                                    
       D300-VALIDATE-STORE.                                                     
                                                                                
      ***************************************************************           
      *    VALIDATE THE STORE NUMBER ON THE INPUT RECORD                        
      ***************************************************************           
                                                                                
           ADD 1 TO PS-STORE-SUB.                                               
                                                                                
           IF IN013-STR-NBR IS EQUAL TO DT-STORE-NO(PS-STORE-SUB)               
               SET PS-VALID-STORE TO TRUE.                                      
                                                                                
       EJECT                                                                    
       E100-PRINT-DEPT-TOTAL.                                                   
                                                                                
      ***************************************************************           
      *    PRINT THE DEPT TOTALS.                                               
      ***************************************************************           
                                                                                
           SET PS-DEPT-BREAK        TO TRUE.                                    
                                                                                
           MOVE DT-DEPT-TOTALS      TO CT-CURRENT-TOTALS.                       
           MOVE TA-DEPT-SALES       TO TA-CURRENT-SALES.                        
           MOVE TA-DEPT-INV         TO TA-CURRENT-INV.                          
                                                                                
           PERFORM E600-SET-UP-TOTALS.                                          
                                                                                
           MOVE ZT-ZERO-TOTALS      TO DT-DEPT-TOTALS.                          
                                                                                
           INITIALIZE                  TA-DEPT-SALES                            
                                       TA-DEPT-INV.                             
       EJECT                                                                    
       E200-PRINT-BUYER-TOTAL.                                                  
                                                                                
      ***************************************************************           
      *    PRINT THE BUYER TOTALS.                                              
      ***************************************************************           
                                                                                
           SET PS-BUYER-BREAK       TO TRUE.                                    
                                                                                
           MOVE BT-BUYER-TOTALS     TO CT-CURRENT-TOTALS.                       
           MOVE TA-BUYER-SALES      TO TA-CURRENT-SALES.                        
           MOVE TA-BUYER-INV        TO TA-CURRENT-INV.                          
                                                                                
           PERFORM E600-SET-UP-TOTALS.                                          
                                                                                
           MOVE ZT-ZERO-TOTALS      TO BT-BUYER-TOTALS.                         
                                                                                
           INITIALIZE                  TA-BUYER-SALES                           
                                       TA-BUYER-INV.                            
       EJECT                                                                    
       E300-PRINT-MGR-TOTAL.                                                    
                                                                                
      ***************************************************************           
      *    PRINT THE MANAGER TOTALS.                                            
      ***************************************************************           
                                                                                
           SET PS-MANAGER-BREAK     TO TRUE.                                    
                                                                                
           MOVE MT-MANAGER-TOTALS   TO CT-CURRENT-TOTALS.                       
           MOVE TA-MANAGER-SALES    TO TA-CURRENT-SALES.                        
           MOVE TA-MANAGER-INV      TO TA-CURRENT-INV.                          
                                                                                
           PERFORM E600-SET-UP-TOTALS.                                          
                                                                                
           MOVE ZT-ZERO-TOTALS      TO MT-MANAGER-TOTALS.                       
                                                                                
           INITIALIZE                  TA-MANAGER-SALES                         
                                       TA-MANAGER-INV.                          
       EJECT                                                                    
       E400-PRINT-DIV-TOTAL.                                                    
                                                                                
      ***************************************************************           
      *    PRINT THE DIVISIONAL TOTALS.                                         
      ***************************************************************           
                                                                                
           SET PS-DIVISION-BREAK    TO TRUE.                                    
                                                                                
           MOVE DVT-DIVISION-TOTALS TO CT-CURRENT-TOTALS.                       
           MOVE TA-DIVISION-SALES   TO TA-CURRENT-SALES.                        
           MOVE TA-DIVISION-INV     TO TA-CURRENT-INV.                          
                                                                                
           PERFORM E600-SET-UP-TOTALS.                                          
                                                                                
           MOVE ZT-ZERO-TOTALS      TO DVT-DIVISION-TOTALS.                     
                                                                                
           INITIALIZE                  TA-DIVISION-SALES                        
                                       TA-DIVISION-INV.                         
       EJECT                                                                    
W33304 E450-PRINT-CYCLE-TOTAL.                                                  
W33304                                                                          
W33304***************************************************************           
W33304*    PRINT THE CYCLE TOTALS.                                              
W33304***************************************************************           
W33304                                                                          
W33304     SET PS-CYCLE-BREAK    TO TRUE.                                       
W33304                                                                          
W33304     MOVE CY-CYCLE-TOTALS     TO CT-CURRENT-TOTALS.                       
W33304     MOVE TA-CYCLE-SALES      TO TA-CURRENT-SALES.                        
W33304     MOVE TA-CYCLE-INV        TO TA-CURRENT-INV.                          
W33304                                                                          
W33304     PERFORM E600-SET-UP-TOTALS.                                          
W33304                                                                          
W33304     MOVE ZT-ZERO-TOTALS      TO CY-CYCLE-TOTALS.                         
W33304                                                                          
W33304     INITIALIZE                  TA-CYCLE-SALES                           
W33304                                 TA-CYCLE-INV.                            
W33304 EJECT                                                                    
W33304 E475-PRINT-MONTH-TOTAL.                                                  
W33304                                                                          
W33304***************************************************************           
W33304*    PRINT THE MONTH TOTALS.                                              
W33304***************************************************************           
W33304                                                                          
W33304     SET PS-MONTH-BREAK    TO TRUE.                                       
W33304                                                                          
W33304     MOVE MN-MONTH-TOTALS     TO CT-CURRENT-TOTALS.                       
W33304     MOVE TA-MONTH-SALES      TO TA-CURRENT-SALES.                        
W33304     MOVE TA-MONTH-INV        TO TA-CURRENT-INV.                          
W33304                                                                          
W33304     PERFORM E700-SET-UP-MONTH-TOTALS.                                    
W33304                                                                          
W33304     MOVE ZT-ZERO-TOTALS      TO MN-MONTH-TOTALS.                         
W33304                                                                          
W33304     INITIALIZE                  TA-MONTH-SALES                           
W33304                                 TA-MONTH-INV.                            
W33304 EJECT                                                                    
       E500-PRINT-FINAL-TOTAL.                                                  
                                                                                
      ***************************************************************           
      *    PRINT THE FINAL TOTALS.                                              
      ***************************************************************           
                                                                                
           SET PS-COMPANY-BREAK     TO TRUE.                                    
                                                                                
           MOVE FT-FINAL-TOTALS     TO CT-CURRENT-TOTALS.                       
           MOVE TA-FINAL-SALES      TO TA-CURRENT-SALES.                        
           MOVE TA-FINAL-INV        TO TA-CURRENT-INV.                          
                                                                                
           PERFORM E600-SET-UP-TOTALS.                                          
                                                                                
       EJECT                                                                    
                                                                                
       E600-SET-UP-TOTALS.                                                      
      ***************************************************************           
      *    THIS CONTROLS PRINTING OF BREAKS FOR AS MANY FINANCIAL               
      *    CORPORATIONS AS THERE ARE ON THE DB2 FIN CORP TABLE.                 
      ***************************************************************           
                                                                                
           PERFORM Z250-PRINT-HEADINGS.                                         
                                                                                
           INITIALIZE                  PS-SUB                                   
                                       PT1-PAGE-TOTALS.                         
                                                                                
           SET PS-START-PAGE        TO TRUE.                                    
                                                                                
           PERFORM F100-COMM-PRINT-TOTALS THRU F100-EXIT                        
W27808*        UNTIL (PS-SUB IS GREATER THAN 999) OR                            
W27808         UNTIL (PS-SUB IS GREATER THAN PC-MAX-STORE) OR                   
                     (PS-DONE-WITH-PAGE).                                       
                                                                                
       EJECT                                                                    
W33304 E700-SET-UP-MONTH-TOTALS.                                                
W33304***************************************************************           
W33304*    THIS CONTROLS PRINTING OF BREAKS FOR MONTH TOTALS                    
W33304***************************************************************           
W33304                                                                          
W33304     PERFORM Z275-PRINT-MONTH-HEADINGS.                                   
W33304                                                                          
W33304     INITIALIZE                  PS-SUB                                   
W33304                                 PT1-PAGE-TOTALS.                         
W33304                                                                          
W33304     SET PS-START-PAGE        TO TRUE.                                    
W33304                                                                          
W33304     PERFORM F200-COMM-PRINT-MTH-TOTALS THRU F200-EXIT                    
W33304         UNTIL (PS-SUB IS GREATER THAN PC-MAX-STORE) OR                   
W33304               (PS-DONE-WITH-PAGE).                                       
W33304                                                                          
W33304 EJECT                                                                    
       F100-COMM-PRINT-TOTALS.                                                  
                                                                                
      ***************************************************************           
      *    SET UP A DETAIL LINE FOR EACH VALID STORE IN THE STORE               
      *    TABLE.  ACCUMULATE THE PAGE TOTALS FOR ALL STORES.                   
      ***************************************************************           
                                                                                
           ADD 1 TO PS-SUB.                                                     
                                                                                
W27808*    IF (CT-STORE-NO(PS-SUB)   IS EQUAL TO 999)          AND              
           IF (CT-STORE-NO(PS-SUB)   IS EQUAL TO PC-MAX-STORE) AND              
              (CT-STORE-NAME(PS-SUB) IS EQUAL TO '**********')                  
               PERFORM G100-PRINT-TOTAL                                         
W33304     ELSE                                                                 
W33304         IF CT-INV-ID(PS-SUB) = PV-CUR-INV-ID OR PS-COMPANY-BREAK         
WR9999             MOVE CT-STORE-NO(PS-SUB)          TO DL-STORE-NBR    15730007
WR9999                                                                  02730000
                   MOVE CT-STORE-NAME(PS-SUB)        TO DL-STORE-NAME           
                                                                                
                   COMPUTE DL-BEG-INVENTORY ROUNDED =                           
                           CT-BEG-INV(PS-SUB) / 1000                            
                                                                                
                   COMPUTE DL-RECEIPTS ROUNDED =                                
                           CT-RECEIPTS(PS-SUB) / 1000                           
                                                                                
                   COMPUTE DL-PURCH-ADJ ROUNDED =                               
                           CT-PURCH-ADJ(PS-SUB) / 1000                          
                                                                                
OCFSFS             COMPUTE DL-PARL-SHIP ROUNDED =                               
OCFSFS                     CT-PARL-SHIP (PS-SUB) / 1000                         
OCFSFS                                                                          
W27808             COMPUTE DL-ST-EXPECT  ROUNDED =                              
W27808                     CT-ST-EXPECT (PS-SUB) / 1000                         
W27808                                                                          
                   COMPUTE DL-SALES ROUNDED =                                   
                           CT-SALES(PS-SUB) / 1000                              
                                                                                
                   COMPUTE DL-SHRINK ROUNDED =                                  
                           CT-SHRINK(PS-SUB) / 1000                             
                                                                                
                   COMPUTE DL-XFER-IN ROUNDED =                                 
                           CT-XFER-IN(PS-SUB) / 1000                            
                                                                                
                   COMPUTE DL-XFER-OUT ROUNDED =                                
                          CT-XFER-OUT(PS-SUB) / 1000                            
                                                                                
                   COMPUTE DL-MKUP      ROUNDED =                               
                           CT-MKUP     (PS-SUB) / 1000                          
                                                                                
                   COMPUTE DL-MKDN ROUNDED =                                    
                           CT-MKDN(PS-SUB) / 1000                               
                                                                                
                   COMPUTE DL-END-INV ROUNDED =                                 
                           CT-END-INV(PS-SUB) / 1000                            
                                                                                
                   PERFORM Z600-PRINT-A-LINE                                    
                                                                                
                   ADD CT-BEG-INV(PS-SUB)           TO PT1-BEG-INV              
                   ADD CT-RECEIPTS(PS-SUB)          TO PT1-RECEIPTS             
                   ADD CT-PURCH-ADJ(PS-SUB)         TO PT1-PURCH-ADJ            
OCFSFS             ADD CT-PARL-SHIP (PS-SUB)        TO PT1-PARL-SHIP            
W27808             ADD CT-ST-EXPECT(PS-SUB)         TO PT1-ST-EXPECT            
                   ADD CT-SALES(PS-SUB)             TO PT1-SALES                
                   ADD CT-SHRINK(PS-SUB)            TO PT1-SHRINK               
                   ADD CT-XFER-IN(PS-SUB)           TO PT1-XFER-IN              
                   ADD CT-XFER-OUT(PS-SUB)          TO PT1-XFER-OUT             
                   ADD CT-MKUP(PS-SUB)              TO PT1-MKUP                 
                   ADD CT-MKDN(PS-SUB)              TO PT1-MKDN                 
                   ADD CT-END-INV(PS-SUB)           TO PT1-END-INV              
W33304         END-IF                                                           
           END-IF.                                                              
                                                                                
       F100-EXIT.                                                               
           EXIT.                                                                
       EJECT                                                                    
W33304 F200-COMM-PRINT-MTH-TOTALS.                                              
W33304                                                                          
W33304***************************************************************           
W33304*    SET UP A DETAIL LINE FOR EACH VALID STORE IN THE STORE               
W33304*    TABLE.  ACCUMULATE THE PAGE TOTALS FOR ALL STORES.                   
W33304***************************************************************           
W33304                                                                          
W33304     ADD 1 TO PS-SUB.                                                     
W33304                                                                          
W33304     IF (CT-STORE-NO(PS-SUB)   IS EQUAL TO PC-MAX-STORE) AND              
W33304        (CT-STORE-NAME(PS-SUB) IS EQUAL TO '**********')                  
W33304         PERFORM G200-PRINT-MONTH-TOTAL                                   
W33304     ELSE                                                                 
W33304                                                                          
W33304         ADD CT-BEG-INV(PS-SUB)           TO PT1-BEG-INV                  
W33304         ADD CT-RECEIPTS(PS-SUB)          TO PT1-RECEIPTS                 
W33304         ADD CT-PURCH-ADJ(PS-SUB)         TO PT1-PURCH-ADJ                
OCFSFS         ADD CT-PARL-SHIP(PS-SUB)         TO PT1-PARL-SHIP                
W33304         ADD CT-ST-EXPECT(PS-SUB)         TO PT1-ST-EXPECT                
W33304         ADD CT-SALES(PS-SUB)             TO PT1-SALES                    
W33304         ADD CT-SHRINK(PS-SUB)            TO PT1-SHRINK                   
W33304         ADD CT-XFER-IN(PS-SUB)           TO PT1-XFER-IN                  
W33304         ADD CT-XFER-OUT(PS-SUB)          TO PT1-XFER-OUT                 
W33304         ADD CT-MKUP(PS-SUB)              TO PT1-MKUP                     
W33304         ADD CT-MKDN(PS-SUB)              TO PT1-MKDN                     
W33304         ADD CT-END-INV(PS-SUB)           TO PT1-END-INV                  
W33304     END-IF.                                                              
W33304                                                                          
W33304 F200-EXIT.                                                               
W33304     EXIT.                                                                
W33304 EJECT                                                                    
       G100-PRINT-TOTAL.                                                        
                                                                                
      ***************************************************************           
      *    PRINT THE PAGE TOTAL FOR STORES.                                     
      ***************************************************************           
                                                                                
           SET PS-DONE-WITH-PAGE TO TRUE.                                       
                                                                                
           COMPUTE TL-BEG-INV ROUNDED =                                         
                   PT1-BEG-INV / 1000.                                          
                                                                                
           COMPUTE TL-RECEIPTS ROUNDED =                                        
                   PT1-RECEIPTS / 1000.                                         
                                                                                
           COMPUTE TL-PURCH-ADJ ROUNDED =                                       
                   PT1-PURCH-ADJ / 1000.                                        
                                                                                
OCFSFS     COMPUTE TL-PARL-SHIP ROUNDED =                                       
OCFSFS             PT1-PARL-SHIP / 1000.                                        
OCFSFS                                                                          
W27808     COMPUTE TL-ST-EXPECT ROUNDED =                                       
W27808             PT1-ST-EXPECT / 1000.                                        
W27808                                                                          
           COMPUTE TL-SALES ROUNDED =                                           
                   PT1-SALES / 1000.                                            
                                                                                
           COMPUTE TL-SHRINK ROUNDED =                                          
                   PT1-SHRINK / 1000.                                           
                                                                                
           COMPUTE TL-XFER-IN ROUNDED =                                         
                   PT1-XFER-IN / 1000.                                          
                                                                                
           COMPUTE TL-XFER-OUT ROUNDED =                                        
                   PT1-XFER-OUT / 1000.                                         
                                                                                
           COMPUTE TL-MKUP ROUNDED =                                            
                   PT1-MKUP / 1000.                                             
                                                                                
           COMPUTE TL-MKDN ROUNDED =                                            
                   PT1-MKDN / 1000.                                             
                                                                                
           COMPUTE TL-END-INV ROUNDED =                                         
                   PT1-END-INV / 1000.                                          
                                                                                
           PERFORM Z550-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE SPL-SPECIAL-LINE(PS-BREAK-SW) TO                                
                    INVENTORY-ADJ-RPT-RECORD.                                   
                                                                                
           PERFORM Z650-WRITE-SPECIAL-LINE.                                     
       EJECT                                                                    
W33304 G200-PRINT-MONTH-TOTAL.                                                  
W33304                                                                          
W33304***************************************************************           
W33304*    PRINT THE PAGE TOTAL FOR STORES.                                     
W33304***************************************************************           
W33304                                                                          
W33304     SET PS-DONE-WITH-PAGE TO TRUE.                                       
W33304                                                                          
W33304     COMPUTE TL-BEG-INV ROUNDED =                                         
W33304             PT1-BEG-INV / 1000.                                          
W33304                                                                          
W33304     COMPUTE TL-RECEIPTS ROUNDED =                                        
W33304             PT1-RECEIPTS / 1000.                                         
W33304                                                                          
W33304     COMPUTE TL-PURCH-ADJ ROUNDED =                                       
W33304             PT1-PURCH-ADJ / 1000.                                        
W33304                                                                          
OCFSFS     COMPUTE TL-PARL-SHIP ROUNDED =                                       
OCFSFS             PT1-PARL-SHIP / 1000.                                        
OCFSFS                                                                          
W33304     COMPUTE TL-ST-EXPECT ROUNDED =                                       
W33304             PT1-ST-EXPECT / 1000.                                        
W33304                                                                          
W33304     COMPUTE TL-SALES ROUNDED =                                           
W33304             PT1-SALES / 1000.                                            
W33304                                                                          
W33304     COMPUTE TL-SHRINK ROUNDED =                                          
W33304             PT1-SHRINK / 1000.                                           
W33304                                                                          
W33304     COMPUTE TL-XFER-IN ROUNDED =                                         
W33304             PT1-XFER-IN / 1000.                                          
W33304                                                                          
W33304     COMPUTE TL-XFER-OUT ROUNDED =                                        
W33304             PT1-XFER-OUT / 1000.                                         
W33304                                                                          
W33304     COMPUTE TL-MKUP ROUNDED =                                            
W33304             PT1-MKUP / 1000.                                             
W33304                                                                          
W33304     COMPUTE TL-MKDN ROUNDED =                                            
W33304             PT1-MKDN / 1000.                                             
W33304                                                                          
W33304     COMPUTE TL-END-INV ROUNDED =                                         
W33304             PT1-END-INV / 1000.                                          
W33304                                                                          
W33304     PERFORM Z575-PRINT-MONTH-TOTAL-LINE.                                 
W33304                                                                          
W33304     MOVE SPL-SPECIAL-LINE(PS-BREAK-SW) TO                                
W33304              INVENTORY-ADJ-RPT-RECORD.                                   
W33304                                                                          
W33304     PERFORM Z650-WRITE-SPECIAL-LINE.                                     
W33304 EJECT                                                                    
       Z250-PRINT-HEADINGS.                                                     
                                                                                
      ***************************************************************           
      *    PRINT THE PAGE HEADINGS.                                             
      *    PRINT THE APPROPRIATE SUB HEADINGS.                                  
      *    PRINT THE DETAIL HEADINGS.                                           
      ***************************************************************           
                                                                                
           ADD  1               TO PC-PAGE-COUNTER.                             
21591      MOVE PC-PAGE-COUNTER TO DP200O-PAGE-NUMBER.                          
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
21591          FROM DP200O-STANDRD-HEADER-200-COLS                              
               AFTER ADVANCING PAGE.                                            
                                                                                
W33304     MOVE PV-INV-NM       TO PH-CYCLE-NAME.                               
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               FROM PH-PAGE-HEADING-2                                           
               AFTER ADVANCING 1 LINE.                                          
W33304                                                                          
W33304     MOVE 'CYCLE '        TO PH-CYCLE-MONTH.                              
W33304     IF PS-COMPANY-BREAK                                                  
W33304         MOVE 99999       TO PH-CYCLE                                     
W33304     ELSE                                                                 
W33304         MOVE SP-CYCLE    TO PH-CYCLE                                     
W33304     END-IF.                                                              
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               FROM PH-PAGE-HEADING-3                                           
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           IF PS-COMPANY-BREAK                                                  
               WRITE INVENTORY-ADJ-RPT-RECORD                                   
                   FROM SH-SUB-HEADING-1                                        
                   AFTER ADVANCING 2 LINES                                      
           END-IF.                                                              
                                                                                
           IF (PS-DEPT-BREAK)     OR                                            
              (PS-BUYER-BREAK)    OR                                            
              (PS-MANAGER-BREAK)  OR                                            
              (PS-DIVISION-BREAK)                                               
               WRITE INVENTORY-ADJ-RPT-RECORD                                   
                   FROM SH-SUB-HEADING-2                                        
                   AFTER ADVANCING 2 LINES                                      
           END-IF.                                                              
                                                                                
           IF (PS-DEPT-BREAK)     OR                                            
              (PS-BUYER-BREAK)    OR                                            
              (PS-MANAGER-BREAK)                                                
               WRITE INVENTORY-ADJ-RPT-RECORD                                   
                   FROM SH-SUB-HEADING-3                                        
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
           IF (PS-DEPT-BREAK)     OR                                            
              (PS-BUYER-BREAK)                                                  
               WRITE INVENTORY-ADJ-RPT-RECORD                                   
                   FROM SH-SUB-HEADING-4                                        
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
           IF (PS-DEPT-BREAK)                                                   
               WRITE INVENTORY-ADJ-RPT-RECORD                                   
                   FROM SH-SUB-HEADING-5                                        
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               FROM DH-DETAIL-HEADING-1                                         
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               FROM DH-DETAIL-HEADING-2                                         
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           INITIALIZE INVENTORY-ADJ-RPT-RECORD.                                 
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           INITIALIZE PC-LINE-COUNTER.                                          
       EJECT                                                                    
W33304 Z275-PRINT-MONTH-HEADINGS.                                               
W33304                                                                          
W33304***************************************************************           
W33304*    PRINT THE PAGE HEADINGS.                                             
W33304*    PRINT THE DETAIL HEADINGS.                                           
W33304*    PRINT THE MONTH TOTAL LINE.                                          
W33304***************************************************************           
W33304                                                                          
W33304     ADD  1               TO PC-PAGE-COUNTER.                             
W33304     MOVE PC-PAGE-COUNTER TO DP200O-PAGE-NUMBER.                          
W33304                                                                          
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         FROM DP200O-STANDRD-HEADER-200-COLS                              
W33304         AFTER ADVANCING PAGE.                                            
W33304                                                                          
W33304     INITIALIZE PV-MONTH-NAME.                                            
W33304     MOVE PV-MONTH        TO PV-MONTH-NAME.                               
W33304     MOVE PV-MONTH-NM     TO PH-CYCLE-NAME.                               
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         FROM PH-PAGE-HEADING-2                                           
W33304         AFTER ADVANCING 1 LINE.                                          
W33304                                                                          
W33304     MOVE 'MONTH '        TO PH-CYCLE-MONTH.                              
W33304     INITIALIZE PH-MONTH.                                                 
W33304     MOVE PV-MONTH(1:3)   TO PH-MONTH.                                    
W33304                                                                          
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         FROM PH-PAGE-HEADING-3                                           
W33304         AFTER ADVANCING 1 LINE.                                          
W33304                                                                          
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         FROM DH-DETAIL-HEADING-1                                         
W33304         AFTER ADVANCING 2 LINES.                                         
W33304                                                                          
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         FROM DH-DETAIL-HEADING-2                                         
W33304         AFTER ADVANCING 1 LINE.                                          
W33304                                                                          
W33304     INITIALIZE INVENTORY-ADJ-RPT-RECORD.                                 
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         AFTER ADVANCING 1 LINE.                                          
W33304                                                                          
W33304     INITIALIZE PC-LINE-COUNTER.                                          
W33304 EJECT                                                                    
W33304                                                                          
       Z300-FETCH-STORE.                                                        
                                                                                
      ***************************************************************           
      *    FETCH A ROW FROM THE STORE TABLE.                                    
      ***************************************************************           
                                                                                
           EXEC SQL                                                             
               FETCH STORE_CURSOR                                               
W26600             INTO :XMT00001-LOC-NBR,                                      
W26600                  :XMT00001-LOC-TYP-CDE,                                  
W33304                  :XMT00001-LOC-10-ABBR-NM,                               
W33304                  :INCNTL-INV-ID                                          
           END-EXEC.                                                            
                                                                                
           IF SQLCODE < 0                                                       
               DISPLAY 'INKRP140 - FETCH UNSUCCESSFUL'                          
W26600         DISPLAY 'INKRP140 - STORE TABLE XMTLOC'                          
               PERFORM Z950-SQL-ERROR                                           
           ELSE                                                                 
               IF (SQLCODE > 0                                                  
                        AND SQLCODE NOT = +100)                                 
                        OR SQLWARN0 = 'W'                                       
                   DISPLAY 'INKRP140 - FETCH UNSUCCESSFUL'                      
W26600             DISPLAY 'INKRP140 - STORE TABLE XMTLOC'                      
                   PERFORM Z960-SQL-WARNING                                     
               END-IF                                                           
           END-IF.                                                              
                                                                                
       EJECT                                                                    
       Z350-READ-INVENTORY-ADJ-EXTR.                                            
                                                                                
      ***************************************************************           
      *    READ THE SALES FILE.                                                 
      ***************************************************************           
                                                                                
           READ INVENTORY-ADJ-EXTR INTO IN013-INVENTORY-ADJ-EXTR-REC            
           AT END                                                               
               SET PS-EXTR-EOF TO TRUE                                          
W33304         INITIALIZE SC-MONTH                                              
W33304     NOT AT END                                                           
W33304         IF IN013-INV-ID NOT = PV-INV-ID                                  
W33304             DISPLAY 'INVENTORY ID:      ' IN013-INV-ID                   
W33304             INITIALIZE INCNTL-INV-NM-TEXT                                
W33304             PERFORM Z375-READ-TINCNTL                                    
W33304             DISPLAY 'OPEN FISCAL MONTH: ' INCNTL-OPN-FSCL-MN-DTE         
W33304             PERFORM B200-GET-DATE-ATTRIBUTES                             
W33304             PERFORM B300-CHECK-CALENDAR                                  
W33304         END-IF                                                           
W33304         MOVE IN013-INV-ID       TO PV-INV-ID                             
W33304     END-READ.                                                            
       EJECT                                                                    
W33304 Z375-READ-TINCNTL.                                                       
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNT FROM 1 BY 1                               
                 UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                        
                    OR (SQLCODE         = +000)                                 
                    OR (SQLCODE         = +100)                                 
                                                                                
               EXEC SQL                                                         
                    SELECT                                                      
                        OPN_FSCL_MN_DTE                                         
                       ,OPN_FSCL_MN_NBR                                         
W33304                 ,INV_NM                                                  
                    INTO                                                        
W33304                 :INCNTL-OPN-FSCL-MN-DTE                                  
W33304                ,:INCNTL-OPN-FSCL-MN-NBR                                  
W33304                ,:INCNTL-INV-NM                                           
                    FROM                                                        
W33304                  TINCNTL                                                 
W33304              WHERE                                                       
W33304                  INV_ID = :IN013-INV-ID                                  
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE        = +000                                   
                   WHEN SQLCODE        = -904                                   
                   WHEN SQLCODE        = -911                                   
                       CONTINUE                                                 
                   WHEN OTHER                                                   
W33304                 MOVE    'Z375-READ-TINCNTL'                              
                                                TO PV-PARAGRAPH-NAME            
W33304                 MOVE    'SELECT ROW FROM TINCNTL'                        
                                         TO PV-DB2-OPERATION-ATTEMPTED          
                       PERFORM Z950-SQL-ERROR                                   
               END-EVALUATE                                                     
                                                                                
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
W33304         DISPLAY '** MAX RETRIES EXCEEDED ON TINCNTL **'                  
W33304         MOVE     'Z375-READ-TINCNTL'                                     
                                                TO PV-PARAGRAPH-NAME            
W33304         MOVE    'SELECT ROW FROM TINCNTL'                                
                                          TO PV-DB2-OPERATION-ATTEMPTED         
               PERFORM Z950-SQL-ERROR                                           
           END-IF.                                                              
                                                                                
       EJECT                                                                    
      ******************************************************************        
      *    SELECT BUYER FROM THE MBS.                                           
      ******************************************************************        
                                                                                
       Z400-SELECT-BUYER.                                                       
                                                                                
           MOVE SP-BUYER               TO PV-BYR-NBR-2-3.                       
           MOVE SP-DEPT                TO PV-DEPT-NBR.                          
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNT FROM 1 BY 1                               
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                         
                   OR (SQLCODE         = +000)                                  
                   OR (SQLCODE         = +100))                                 
                                                                                
               EXEC SQL                                                         
                                                                                
                    SELECT      DISTINCT                                        
                                A.BYR_NBR                                       
                         ,      B.WORKER_LAST_NAME                              
                         ,      B.WORKER_FIR_NAME                               
                      INTO     :MDSEAR-BYR-NBR                                  
                         ,     :RSPBAR-WORKER-LAST-NAME                         
                         ,     :RSPBAR-WORKER-FIR-NAME                          
                      FROM      TMDSEAR A                                       
                         ,      TRSPBAR B                                       
                         ,      TAPLAVL C                                       
                     WHERE     (A.BYR_NBR     = :PV-BYR-NBR)                    
                       AND     (A.DEPT_NBR    = :PV-DEPT-NBR)                   
                       AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-BYR)             
                       AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)                 
                       AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)                 
                       AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                 
                       AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)                 
                       AND     (CURRENT DATE                                    
                                BETWEEN CHAR(B.WORKER_STRT_DTE,ISO)             
                                AND     CHAR(B.WORKER_END_DTE,ISO))             
                       AND     (CURRENT DATE                                    
                                BETWEEN CHAR(C.MDSEAR_STRT_DTE,ISO)             
                                AND     CHAR(C.MDSEAR_END_DTE,ISO))             
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE        = +000                                   
                   WHEN SQLCODE        = -904                                   
                   WHEN SQLCODE        = -911                                   
                       CONTINUE                                                 
                   WHEN SQLCODE        = +100                                   
                       DISPLAY 'BYR NUMBER ' PV-BYR-NBR                         
                           ' NOT FOUND  '                                       
                       MOVE SP-BUYER    TO  SH-BUYER-NO                         
                       MOVE 'NOT FOUND' TO  RSPBAR-WORKER-FIR-NAME              
                       MOVE SPACE       TO  RSPBAR-WORKER-LAST-NAME             
                   WHEN OTHER                                                   
                       MOVE           'Z400-SELECT-BUYER  '                     
                                       TO PV-PARAGRAPH-NAME                     
                       MOVE 'SELECT ROW FROM TRSPBAR  '                         
                                       TO PV-DB2-OPERATION-ATTEMPTED            
                       PERFORM         Z950-SQL-ERROR                           
               END-EVALUATE                                                     
                                                                                
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT          > PC-MAX-RETRIES                         
               MOVE                    'Z400-SELECT-BUYER  '                    
                                       TO PV-PARAGRAPH-NAME                     
               MOVE 'MAX RETRIES EXCEEDED ON TRSPBAR '                          
                                       TO PV-DB2-OPERATION-ATTEMPTED            
               PERFORM                 Z950-SQL-ERROR                           
           END-IF.                                                              
                                                                                
       EJECT                                                                    
                                                                                
       Z450-SELECT-MANAGER.                                                     
      ******************************************************************        
      *    SELECT MANAGER FROM THE MBS.                                         
      ******************************************************************        
                                                                                
           MOVE SP-MGR                 TO PV-DMA-NBR.                           
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNT FROM 1 BY 1                               
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                         
                   OR (SQLCODE         = +000)                                  
                   OR (SQLCODE         = +100))                                 
                                                                                
               EXEC SQL                                                         
                                                                                
                    SELECT      A.DMA_NBR                                       
                         ,      B.WORKER_LAST_NAME                              
                         ,      B.WORKER_FIR_NAME                               
                      INTO     :MDSEAR-DMA-NBR                                  
                         ,     :RSPBAR-WORKER-LAST-NAME                         
                         ,     :RSPBAR-WORKER-FIR-NAME                          
                      FROM      TMDSEAR A                                       
                         ,      TRSPBAR B                                       
                         ,      TAPLAVL C                                       
                     WHERE     (A.DMA_NBR     = :PV-DMA-NBR)                    
                       AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-DMM)             
                       AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)                 
                       AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)                 
                       AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                 
                       AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)                 
                       AND     (CURRENT DATE                                    
                                BETWEEN CHAR(B.WORKER_STRT_DTE,ISO)             
                                AND     CHAR(B.WORKER_END_DTE,ISO))             
                       AND     (CURRENT DATE                                    
                                BETWEEN CHAR(C.MDSEAR_STRT_DTE,ISO)             
                                AND     CHAR(C.MDSEAR_END_DTE,ISO))             
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE        = +000                                   
                   WHEN SQLCODE        = -904                                   
                   WHEN SQLCODE        = -911                                   
                       CONTINUE                                                 
                   WHEN SQLCODE        = +100                                   
                       DISPLAY 'DMA NUMBER ' PV-DMA-NBR                         
                           ' NOT FOUND  '                                       
                       MOVE PV-DMA-NBR  TO  MDSEAR-DMA-NBR                      
                       MOVE 'NOT FOUND' TO  RSPBAR-WORKER-FIR-NAME              
                       MOVE SPACE       TO  RSPBAR-WORKER-LAST-NAME             
                   WHEN OTHER                                                   
                       MOVE           'Z450-SELECT-MANAGER'                     
                                       TO PV-PARAGRAPH-NAME                     
                       MOVE 'SELECT ROW FROM TRSPBAR  '                         
                                       TO PV-DB2-OPERATION-ATTEMPTED            
                       PERFORM         Z950-SQL-ERROR                           
               END-EVALUATE                                                     
                                                                                
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT          > PC-MAX-RETRIES                         
               MOVE                    'Z450-SELECT-MANAGER'                    
                                       TO PV-PARAGRAPH-NAME                     
               MOVE 'MAX RETRIES EXCEEDED ON TRSPBAR '                          
                                       TO PV-DB2-OPERATION-ATTEMPTED            
               PERFORM                 Z950-SQL-ERROR                           
           END-IF.                                                              
                                                                                
       EJECT                                                                    
       Z500-SELECT-DEPT.                                                        
      ******************************************************************        
      *      Z500-SELECT-DEPT                                          *        
      *  ==> PROCESSES:                                                *        
      *    - SELECTS DEPARTMENT DESCRIPTION FROM TMDSEAR               *        
      ******************************************************************        
                                                                                
           MOVE SP-DEPT                TO PV-DEPT-NBR.                          
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNT FROM 1 BY 1                               
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                         
                   OR (SQLCODE         = +000)                                  
                   OR (SQLCODE         = +100))                                 
                                                                                
                   EXEC SQL                                                     
                       SELECT     A.DEPT_NBR                                    
                            ,     A.MDSEAR_DESC                                 
                         INTO    :MDSEAR-DEPT-NBR                               
                            ,    :MDSEAR-DESC                                   
                         FROM     TMDSEAR A                                     
                            ,     TAPLAVL B                                     
                        WHERE    (A.DEPT_NBR    = :PV-DEPT-NBR)                 
                          AND    (A.MDSELV_CDE  = :PC-MDSELV-CDE)               
                          AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)               
                          AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)               
                          AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)               
                          AND    (CURRENT DATE     BETWEEN                      
                                  CHAR(B.MDSEAR_STRT_DTE,ISO)  AND              
                                  CHAR(B.MDSEAR_END_DTE,ISO))                   
                          AND    (CURRENT DATE     BETWEEN                      
                                  CHAR(A.STRT_DTE,ISO)         AND              
                                  CHAR(A.END_DTE,ISO))                          
                   END-EXEC                                                     
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE        = +000                                   
                   WHEN SQLCODE        = -904                                   
                   WHEN SQLCODE        = -911                                   
                       CONTINUE                                                 
                   WHEN SQLCODE        = +100                                   
                       DISPLAY 'DEPT NUMBER ' PV-DEPT-NBR                       
                           ' NOT FOUND  '                                       
                       MOVE SP-DEPT     TO MDSEAR-DEPT-NBR                      
                       MOVE 'NOT FOUND' TO MDSEAR-DESC                          
                   WHEN OTHER                                                   
                       MOVE           'Z500-SELECT-DEPT'                        
                                       TO PV-PARAGRAPH-NAME                     
                       MOVE 'SELECT DEPARTMENT ROW ON TMDSEAR'                  
                                       TO PV-DB2-OPERATION-ATTEMPTED            
                       DISPLAY 'PV-DEPT-NBR = ' PV-DEPT-NBR                     
                       PERFORM         Z950-SQL-ERROR                           
               END-EVALUATE                                                     
                                                                                
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNT          > PC-MAX-RETRIES                         
               MOVE                    'Z500-SELECT-DEPT'                       
                                       TO PV-PARAGRAPH-NAME                     
               MOVE 'MAX RETRIES EXCEEDED ON TMDSEAR '                          
                                       TO PV-DB2-OPERATION-ATTEMPTED            
               PERFORM                 Z950-SQL-ERROR                           
           END-IF.                                                              
                                                                                
       EJECT                                                                    
       Z550-PRINT-TOTAL-LINE.                                                   
                                                                                
      ***************************************************************           
      *    PRINT A TOTAL LINE.                                                  
      ***************************************************************           
W33304     MOVE SPACES           TO TL-FISCAL.                                  
W33304     MOVE 'TOTAL    '      TO TL-MONTH-TOTAL.                             
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               FROM TL-TOTAL-LINE                                               
               AFTER ADVANCING 2 LINES.                                         
       EJECT                                                                    
W33304 Z575-PRINT-MONTH-TOTAL-LINE.                                             
W33304                                                                          
W33304***************************************************************           
W33304*    PRINT A TOTAL LINE.                                                  
W33304***************************************************************           
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         FROM MTH-TOTAL-LINE                                              
W33304         AFTER ADVANCING 2 LINES.                                         
W33304                                                                          
W33304     MOVE 'FISCAL '        TO TL-FISCAL.                                  
W33304     MOVE PV-MONTH         TO TL-MONTH-TOTAL.                             
W33304                                                                          
W33304     WRITE INVENTORY-ADJ-RPT-RECORD                                       
W33304         FROM TL-TOTAL-LINE                                               
W33304         AFTER ADVANCING 1 LINE.                                          
W33304 EJECT                                                                    
       Z600-PRINT-A-LINE.                                                       
                                                                                
      ***************************************************************           
      *    PRINT A DETAIL LINE.                                                 
      ***************************************************************           
                                                                                
           IF PC-LINE-COUNTER IS GREATER THAN 47                                
               PERFORM Z250-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               FROM DL-DETAIL-LINE                                              
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           ADD 1 TO PC-LINE-COUNTER.                                            
       EJECT                                                                    
       Z650-WRITE-SPECIAL-LINE.                                                 
                                                                                
      ***************************************************************           
      *    WRITE THE SPECIAL LINE                                               
      ***************************************************************           
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           INITIALIZE INVENTORY-ADJ-RPT-RECORD                                  
                                                                                
           WRITE INVENTORY-ADJ-RPT-RECORD                                       
               AFTER ADVANCING 1 LINE.                                          
       EJECT                                                                    
       Z700-DISPLAY-FINAL-TOTALS.                                               
                                                                                
      ***************************************************************           
      *    DISPLAY THE TOTAL NUMBER OF SALES RECORDS READ, ACCEPTED,            
      *    AND REJECTED.  ALSO DISPLAY THE FINAL SALES AND ENDING               
      *    INVENTORY FIGURES.                                                   
      ***************************************************************           
                                                                                
           MOVE PC-INPUT-COUNTER  TO DV-DISPLAY-COUNTER.                        
           DISPLAY 'TOTAL  INPUT: ' DV-DISPLAY-COUNTER.                         
                                                                                
           MOVE PC-GOOD-COUNTER   TO DV-DISPLAY-COUNTER.                        
           DISPLAY '        GOOD: ' DV-DISPLAY-COUNTER.                         
                                                                                
           MOVE PC-REJECT-COUNTER TO DV-DISPLAY-COUNTER.                        
           DISPLAY '    REJECTED: ' DV-DISPLAY-COUNTER ' DEPT EXTRACT'          
               ' RECS'.                                                         
           MOVE PC-REJECT-INV-STORE TO DV-DISPLAY-COUNTER.                      
           DISPLAY '              ' DV-DISPLAY-COUNTER ' INVALID STORE'         
               ' RECS'.                                                         
                                                                                
           DISPLAY ' '                                                          
           DISPLAY '"FINAL TOTALS"'                                             
           DISPLAY ' '                                                          
                                                                                
           MOVE TA-FINAL-SALES    TO DV-DISPLAY-TOTALS.                         
           DISPLAY '       SALES: ' DV-DISPLAY-TOTALS.                          
                                                                                
           ADD  TA-DC-INV         TO TA-FINAL-INV.                              
           MOVE TA-FINAL-INV      TO DV-DISPLAY-TOTALS.                         
           DISPLAY '   INVENTORY: ' DV-DISPLAY-TOTALS.                          
       EJECT                                                                    
       Z950-SQL-ERROR.                                                          
                                                                                
      ***************************************************************           
      *    ABEND ON AN SQL ERROR                                                
      ***************************************************************           
                                                                                
           MOVE SQLCODE    TO SQLCODE2.                                         
           MOVE SQLERRD(3) TO SQLERRD3.                                         
                                                                                
           DISPLAY '*** ABEND ***'                                              
           DISPLAY 'INKRP140 - SQL ERROR'                                       
           DISPLAY 'SQLCODE        = ' SQLCODE2.                                
           DISPLAY 'SQLERRM        = ' SQLERRM.                                 
           DISPLAY 'SQLERRMC       = ' SQLERRMC.                                
           DISPLAY 'ROWS PROCESSED = ' SQLERRD3.                                
           DISPLAY 'PARAGRAPH NAME = ' PV-PARAGRAPH-NAME.                       
           DISPLAY 'OPERATION ATTEMPTED = ' PV-DB2-OPERATION-ATTEMPTED.         
                                                                                
           MOVE +4013 TO ABEND-CODE.                                            
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
       EJECT                                                                    
       Z960-SQL-WARNING.                                                        
                                                                                
       EJECT                                                                    
                                                                                
           MOVE +4013 TO ABEND-CODE.                                            
           DISPLAY '** ABEND **         ** = SQLERROR'.                         
           DISPLAY '** PROGRAM          ** = INKRP140'.                         
           DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.               
           DISPLAY '** OPERATION        ** = '                                  
                                         PV-DB2-OPERATION-ATTEMPTED.            
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
           COPY DPPD004.                                                        
                                                                                
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
      ******************************************************************        
      *    NAME REFORMATTER ROUTINE.                                            
      ******************************************************************        
           COPY DPPD024.                                                        
