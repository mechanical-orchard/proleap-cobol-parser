000100******************************************************************00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300******************************************************************00030004
000400                                                                  00040004
000500 PROGRAM-ID.      PMKUP100.                                       00050004
000600 AUTHOR.          ALEXIS KEIKER.                                  00060004
000700 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00070004
000800 DATE-WRITTEN.    JANUARY 2004.                                   00080004
000900 DATE-COMPILED.                                                   00090004
001000                                                                  00100004
001100******************************************************************00110004
001200* THIS PROGRAM CLEARS OUT COLUMNS IN THE XST_LPS_MIN_PRIC_W      *00120004
001300* TABLE.                                                         *00130004
001500******************************************************************00150004
001600**   CHANGE LOG:                                                 *00160004
001700******************************************************************00170004
001800 ENVIRONMENT DIVISION.                                            00180004
001900******************************************************************00190004
002000                                                                  00200004
002100 CONFIGURATION SECTION.                                           00210004
002200                                                                  00220004
002300 SOURCE-COMPUTER. IBM-3090.                                       00230004
002400 OBJECT-COMPUTER. IBM-3090.                                       00240004
002500                                                                  00250004
002600 INPUT-OUTPUT SECTION.                                            00260004
002700                                                                  00270004
002800 FILE-CONTROL.                                                    00280004
002900                                                                  00290004
003000     SELECT RUN-CONTROL-CARD                                      00300004
003100         ASSIGN TO INP01.                                         00310004
003200                                                                  00320004
003210     SELECT RPT-CONTROL-CARD                                      00321008
003220         ASSIGN TO INP02.                                         00322008
003230                                                                  00323008
003300******************************************************************00330004
003400 DATA DIVISION.                                                   00340004
003500******************************************************************00350004
003600                                                                  00360004
003700 FILE SECTION.                                                    00370004
003800                                                                  00380004
003900 FD  RUN-CONTROL-CARD                                             00390004
004000     RECORDING MODE F                                             00400004
004100     BLOCK CONTAINS 0 RECORDS                                     00410004
004200     LABEL RECORDS ARE STANDARD.                                  00420004
004300                                                                  00430004
004400 01  RUN-CONTROL-CARD-REC             PIC X(80).                  00440008
004500                                                                  00450004
004510 FD  RPT-CONTROL-CARD                                             00451008
004520     RECORDING MODE F                                             00452008
004530     BLOCK CONTAINS 0 RECORDS                                     00453008
004540     LABEL RECORDS ARE STANDARD.                                  00454008
004550                                                                  00455008
004560 01  RPT-CONTROL-CARD-REC             PIC X(80).                  00456010
004570                                                                  00457008
004600 WORKING-STORAGE SECTION.                                         00460004
004700                                                                  00470004
004800******************************************************************00480004
004900* PC PROGRAM CONSTANTS                                           *00490004
005000******************************************************************00500004
005100 01  PC-PROGRAM-CONSTANTS.                                        00510004
005200     05  PC-PROGRAM-NAME              PIC X(08)      VALUE        00520004
005300                                                     'PMKUP100'.  00530004
005400                                                                  00540004
005500******************************************************************00550004
005600* PV PROGRAM VARIABLES                                           *00560004
005700******************************************************************00570004
005800 01  PV-PROGRAM-VARIABLES.                                        00580004
005900     05  PV-PARAGRAPH-NAME            PIC X(40)      VALUE SPACES.00590004
006000     05  PV-DB2-OPERATION-ATTEMPTED   PIC X(40)      VALUE SPACES.00600004
006100                                                                  00610004
006200     05  PV-RUN-PROMO-IND             PIC X(01)    VALUE SPACES.  00620004
006300         88 PS-RUN-MAIN-PROMO                      VALUE 'M'.     00630004
006400         88 PS-RUN-NON-MAIN-PROMO                  VALUE 'N'.     00640004
006500         88 PS-RUN-LPS-PROMO                       VALUE 'L'.     00650004
006600                                                                  00660004
006700     05  PV-RUN-HISTORY-IND           PIC X(01)    VALUE SPACES.  00670004
006800         88 PS-RUN-HISTORY                         VALUE 'H'.     00680004
006900         88 PS-RUN-FUTURE                          VALUE 'F'.     00690004
007000         88 PS-RUN-LPS                             VALUE 'L'.     00700004
007100                                                                  00710004
007200******************************************************************00720004
007300* PS PROGRAM SWITCHES                                            *00730004
007400******************************************************************00740004
007500 01  PS-PROGRAM-SWITCHES.                                         00750004
007600     05  PS-END-OF-RUN-CNTL-CARD-SW      PIC X(01)     VALUE 'N'. 00760004
007700         88  PS-END-OF-RUN-CNTL-CARD                   VALUE 'Y'. 00770004
007710     05  PS-END-OF-RPT-CNTL-CARD-SW      PIC X(01)     VALUE 'N'. 00771008
007720         88  PS-END-OF-RPT-CNTL-CARD                   VALUE 'Y'. 00772008
007800                                                                  00780004
007900******************************************************************00790004
008000* CC CONTROL CARD RECORDS                                         00800004
008100******************************************************************00810004
008200 01  CC-RUN-CONTROL-CARD-RECORD.                                  00820004
008300     05  CC-PROMO-CLEAR-IND           PIC X(01) VALUE SPACES.     00830008
008400     05  FILLER                       PIC X(01) VALUE SPACES.     00840008
008500     05  CC-HIST-FUT-IND              PIC X(01) VALUE SPACES.     00850008
008600     05  FILLER                       PIC X(77) VALUE SPACES.     00860008
008700                                                                  00870004
008710 01  CC-CONTROL-CARD-REC.                                         00871008
008720     05  CC-RUN-DTE                   PIC X(08) VALUE SPACES.     00872008
008730     05  FILLER                       PIC X(01) VALUE SPACES.     00873008
008740     05  CC-RPT-IND                   PIC X(01) VALUE SPACES.     00874008
008750     05  FILLER                       PIC X(01) VALUE SPACES.     00875008
008760     05  CC-LPS-END-DTE               PIC X(08) VALUE SPACES.     00876008
008770     05  FILLER                       PIC X(61) VALUE SPACES.     00877008
008780                                                                  00878008
008800******************************************************************00880004
008900* PA PROGRAM ACCUMULATORS                                        *00890004
009000******************************************************************00900004
009100 01  PA-PROGRAM-ACCUMULATORS.                                     00910004
009200     05  PA-COMMIT-CNT                   PIC S9(11) COMP-3        00920004
009300                                                     VALUE ZEROES.00930004
009400                                                                  00940004
009500******************************************************************00950004
009600*    VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004     *00960004
009700******************************************************************00970004
009800     COPY DPWS004.                                                00980004
009900                                                                  00990004
010000******************************************************************01000004
010100*  TABLE INCLUDES                                                *01010004
010200******************************************************************01020004
010300*  TABLE XST_LPS_MIN_PRIC_W                                       01030004
010400     EXEC SQL INCLUDE XST00051  END-EXEC.                         01040004
010500******************************************************************01050004
010600                                                                  01060004
010700******************************************************************01070004
010800*    SQL COMMUNICATIONS AREA DCLGEN                              *01080004
010900******************************************************************01090004
011000     EXEC SQL                                                     01100004
011100         INCLUDE SQLCA                                            01110004
011200     END-EXEC.                                                    01120004
011300                                                                  01130004
011400     COPY SQLCA2.                                                 01140004
011500                                                                  01150004
011600******************************************************************01160004
011700* AC ABEND CODES                                                 *01170004
011800******************************************************************01180004
011900 01  ABEND-CODE                       PIC S9(04)   COMP VALUE +0. 01190004
012000     88  ABEND-4001-WRITE-ERROR                    VALUE +4001.   01200004
012100     88  ABEND-4002-READ-ERROR                     VALUE +4002.   01210004
012200     88  ABEND-4003-CTRL-CARD-ERROR                VALUE +4003.   01220004
012300     88  ABEND-4004-TABLE-ERROR                    VALUE +4004.   01230004
012400     88  ABEND-4005-OPEN-ERROR                     VALUE +4005.   01240004
012500     88  ABEND-4006-CLOSE-ERROR                    VALUE +4006.   01250004
012600     88  ABEND-4007-SEQUENCE-ERROR                 VALUE +4007.   01260004
012700     88  ABEND-4008-DATA-ERROR                     VALUE +4008.   01270004
012800     88  ABEND-4009-KEY-DATA-ERROR                 VALUE +4009.   01280004
012900     88  ABEND-4013-DB2-ERROR                      VALUE +4013.   01290004
013000     88  ABEND-4019-DATE-ROUTINE-ERROR             VALUE +4019.   01300004
013100     88  ABEND-4444-FORCED-ABEND                   VALUE +4444.   01310004
013200                                                                  01320004
013300 PROCEDURE DIVISION.                                              01330004
013400                                                                  01340004
013500******************************************************************01350004
013600* MAIN PROCESSING                                                 01360004
013700******************************************************************01370004
013800                                                                  01380004
013900 A100-PROGRAM-MAINLINE.                                           01390004
014000                                                                  01400004
014100     OPEN INPUT RUN-CONTROL-CARD                                  01410008
014110                RPT-CONTROL-CARD.                                 01411008
014200     PERFORM B150-READ-RUN-CONTROL-CARD.                          01420004
014300                                                                  01430004
014310     PERFORM B200-READ-RPT-CONTROL-CARD.                          01431013
014320                                                                  01432013
014400     IF NOT PS-END-OF-RUN-CNTL-CARD                               01440004
014500        PERFORM H050-CLEAR-XSTT-LPS-MIN-PRIC                      01450004
014600     END-IF.                                                      01460004
014700                                                                  01470004
014800     PERFORM B900-EOJ-ROUTINE.                                    01480004
014900                                                                  01490004
015000     GOBACK.                                                      01500004
015100                                                                  01510004
015200***************************************************************** 01520004
015300* B150-READ-RUN-CONTROL-CARD.                                   * 01530004
015400* ==> PROCESSES:                                                * 01540004
015500*  - READ IN THE RUN CONTROL CARD                               * 01550004
015600* ==> PERFORMED FROM: A100-MAINLINE                             * 01560004
015700***************************************************************** 01570004
015800 B150-READ-RUN-CONTROL-CARD.                                      01580004
015900                                                                  01590004
016000     READ RUN-CONTROL-CARD INTO CC-RUN-CONTROL-CARD-RECORD        01600004
016100         AT END                                                   01610004
016200             SET PS-END-OF-RUN-CNTL-CARD TO TRUE.                 01620004
016300                                                                  01630004
016410***************************************************************** 01641008
016420* B200-READ-RPT-CONTROL-CARD.                                   * 01642008
016430* ==> PROCESSES:                                                * 01643008
016440*  - READ IN THE RPT CONTROL CARD                               * 01644008
016450* ==> PERFORMED FROM: A100-MAINLINE                             * 01645008
016460***************************************************************** 01646008
016470 B200-READ-RPT-CONTROL-CARD.                                      01647008
016480                                                                  01648008
016490     READ RPT-CONTROL-CARD INTO CC-CONTROL-CARD-REC               01649008
016491         AT END                                                   01649108
016492             SET PS-END-OF-RPT-CNTL-CARD TO TRUE.                 01649208
016493                                                                  01649308
016494     IF PS-END-OF-RPT-CNTL-CARD                                   01649408
016495        MOVE 'B200-READ-RPT-CONTROL-CARD' TO PV-PARAGRAPH-NAME    01649508
016496        MOVE 'RPT CONTROL CARD IS EMPTY'  TO                      01649608
016497                           PV-DB2-OPERATION-ATTEMPTED             01649708
016498        PERFORM Z900-SQL-ABEND                                    01649811
016499     END-IF.                                                      01649908
016500                                                                  01650008
016510***************************************************************** 01651004
016600* B900-EOJ-ROUTINE.                                             * 01660004
016700* ==> PROCESSES:                                                * 01670004
016800*  - CLOSE FILES AND DISPLAY TOTALS                             * 01680004
016900* ==> PERFORMED FROM: A100-MAINLINE                             * 01690004
017000******************************************************************01700004
017100 B900-EOJ-ROUTINE.                                                01710004
017200                                                                  01720004
017300     CLOSE RUN-CONTROL-CARD                                       01730009
017400           RPT-CONTROL-CARD.                                      01740009
017500                                                                  01750004
017600******************************************************************01760004
017700 H050-CLEAR-XSTT-LPS-MIN-PRIC.                                    01770004
017800*   CLEARS COLUMNS IN XST_LPS_MIN_PRIC_W IF THE CLEAR COLUMNS FLAG01780004
017900*   IS SET.                                                       01790004
018000******************************************************************01800004
018100                                                                  01810004
018110     IF CC-RPT-IND = 'Y'                                          01811008
018120        PERFORM H100-CLEAR-LPS                                    01812008
018121        PERFORM H600-COMMIT                                       01812112
018122        PERFORM H300-CLEAR-MAIN-FUT                               01812208
018123        PERFORM H600-COMMIT                                       01812312
018124        PERFORM H500-CLEAR-NON-MAIN-FUT                           01812408
018125        PERFORM H600-COMMIT                                       01812508
018130     ELSE                                                         01813008
018200        IF CC-PROMO-CLEAR-IND = 'A'                               01820008
018300           PERFORM H100-CLEAR-LPS                                 01830008
018310           PERFORM H600-COMMIT                                    01831013
018400           PERFORM H200-CLEAR-MAIN-HIST                           01840008
018410           PERFORM H600-COMMIT                                    01841013
018500           PERFORM H300-CLEAR-MAIN-FUT                            01850008
018510           PERFORM H600-COMMIT                                    01851013
018600           PERFORM H400-CLEAR-NON-MAIN-HIST                       01860008
018610           PERFORM H600-COMMIT                                    01861013
018700           PERFORM H500-CLEAR-NON-MAIN-FUT                        01870008
018800           PERFORM H600-COMMIT                                    01880008
018900        ELSE                                                      01890008
019000           IF CC-PROMO-CLEAR-IND = 'L'                            01900008
019100              PERFORM H100-CLEAR-LPS                              01910008
019200              PERFORM H600-COMMIT                                 01920008
019300           ELSE                                                   01930008
019400              IF CC-PROMO-CLEAR-IND = 'M'                         01940008
019500                 IF CC-HIST-FUT-IND = 'H'                         01950008
019600                    PERFORM H200-CLEAR-MAIN-HIST                  01960008
019700                    PERFORM H600-COMMIT                           01970008
019800                 ELSE                                             01980008
019900                    PERFORM H300-CLEAR-MAIN-FUT                   01990008
020000                    PERFORM H600-COMMIT                           02000008
020100                 END-IF                                           02010008
020200              ELSE                                                02020008
020300                 IF CC-PROMO-CLEAR-IND = 'N'                      02030008
020400                    IF CC-HIST-FUT-IND = 'H'                      02040008
020500                       PERFORM H400-CLEAR-NON-MAIN-HIST           02050008
020600                       PERFORM H600-COMMIT                        02060008
020700                    ELSE                                          02070008
020800                       PERFORM H500-CLEAR-NON-MAIN-FUT            02080008
020900                       PERFORM H600-COMMIT                        02090008
021000                    END-IF                                        02100008
021100                 END-IF                                           02110008
021200              END-IF                                              02120008
021300           END-IF                                                 02130008
021400        END-IF                                                    02140008
021410     END-IF.                                                      02141008
021500                                                                  02150004
021600******************************************************************02160004
021700 H100-CLEAR-LPS.                                                  02170004
021710*    THIS CLEARS THE LPS PROMOTION COLUMNS ON                     02171006
021720*    THE XST_LPS_MIN_PRIC_W TABLE.                                02172006
021800******************************************************************02180004
021900                                                                  02190004
022000     DISPLAY 'CLEAR LPS MAIN DATA IN XST_LPS_MIN_PRIC_W'.         02200004
022100     EXEC SQL                                                     02210004
022200         UPDATE XST_LPS_MIN_PRIC_W                                02220004
022300             SET LPS_ADV_CDE = NULL                               02230004
022400                 , LPS_PROMO_ITM_ID = NULL                        02240004
022500                 , LPS_PRICG_AMT = NULL                           02250004
022600                 , LPS_PROMO_ID  = NULL                           02260004
022610             WHERE LPS_PROMO_ID  IS NOT NULL                      02261014
022700     END-EXEC.                                                    02270004
022800                                                                  02280004
022900     EVALUATE TRUE                                                02290004
023000         WHEN SQLCODE = +0                                        02300004
023100         WHEN SQLCODE = +100                                      02310004
023200             CONTINUE                                             02320004
023300                                                                  02330004
023400         WHEN OTHER                                               02340004
023500             MOVE 'H100-CLEAR-LPS'                                02350004
023600                               TO PV-PARAGRAPH-NAME               02360004
023700             MOVE 'UPDATE ERROR ON XST_LPS_MIN_PRIC_W'            02370004
023800                               TO PV-DB2-OPERATION-ATTEMPTED      02380004
023900             PERFORM Z900-SQL-ABEND                               02390004
024000     END-EVALUATE.                                                02400004
024100                                                                  02410004
024200******************************************************************02420004
024300 H200-CLEAR-MAIN-HIST.                                            02430004
024310*    THIS CLEARS THE MAIN PROMOTION HISTORY COLUMNS ON THE        02431006
024320*    XST_LPS_MIN_PRIC_W TABLE.                                    02432006
024400******************************************************************02440004
024500                                                                  02450004
024600     DISPLAY 'CLEAR MAIN PROMO HISTORY IN XST_LPS_MIN_PRIC_W.'    02460004
024700     EXEC SQL                                                     02470004
024800         UPDATE XST_LPS_MIN_PRIC_W                                02480004
024900             SET HIST_MP_PROMO_ID = NULL                          02490004
025000                 , HIST_MP_ITM_ID = NULL                          02500004
025100                 , HIST_MP_LO_AMT = NULL                          02510004
025200                 , LAST_MP_PROMO_ID = NULL                        02520004
025300     END-EXEC.                                                    02530004
025400                                                                  02540004
025500     EVALUATE TRUE                                                02550004
025600         WHEN SQLCODE = +0                                        02560004
025700         WHEN SQLCODE = +100                                      02570004
025800             CONTINUE                                             02580004
025900                                                                  02590004
026000         WHEN OTHER                                               02600004
026100             MOVE 'H200-CLEAR-MAIN-HIST'                          02610004
026200                               TO PV-PARAGRAPH-NAME               02620004
026300             MOVE 'UPDATE ERROR ON XST_LPS_MIN_PRIC_W'            02630004
026400                               TO PV-DB2-OPERATION-ATTEMPTED      02640004
026500             PERFORM Z900-SQL-ABEND                               02650004
026600     END-EVALUATE.                                                02660004
026700                                                                  02670004
026800******************************************************************02680004
026900 H300-CLEAR-MAIN-FUT.                                             02690004
026910*    THIS CLEARS THE MAIN PROMOTION FUTURE COLUMNS ON THE         02691006
026920*    XST_LPS_MIN_PRIC_W TABLE.                                    02692006
027000******************************************************************02700004
027100                                                                  02710004
027200     DISPLAY 'CLEAR MAIN PROMO FUTURE IN XST_LPS_MIN_PRIC_W'.     02720004
027300     EXEC SQL                                                     02730004
027400         UPDATE XST_LPS_MIN_PRIC_W                                02740004
027500             SET FUT_MP_PROMO_ID = NULL                           02750004
027600                 , FUT_MP_ITM_ID = NULL                           02760004
027700                 , FUT_MP_LO_AMT = NULL                           02770004
027710             WHERE FUT_MP_PROMO_ID IS NOT NULL                    02771014
027800     END-EXEC.                                                    02780004
027900                                                                  02790004
028000     EVALUATE TRUE                                                02800004
028100         WHEN SQLCODE = +0                                        02810004
028200         WHEN SQLCODE = +100                                      02820004
028300             CONTINUE                                             02830004
028400                                                                  02840004
028500         WHEN OTHER                                               02850004
028600             MOVE 'H300-CLEAR-MAIN-FUT'                           02860004
028700                               TO PV-PARAGRAPH-NAME               02870004
028800             MOVE 'UPDATE ERROR ON XST_LPS_MIN_PRIC_W'            02880004
028900                               TO PV-DB2-OPERATION-ATTEMPTED      02890004
029000             PERFORM Z900-SQL-ABEND                               02900004
029100     END-EVALUATE.                                                02910004
029200                                                                  02920004
029300******************************************************************02930004
029400 H400-CLEAR-NON-MAIN-HIST.                                        02940004
029410*    THIS CLEARS THE NON MAIN PROMOTION HISTORY COLUMNS ON        02941006
029420*    THE XST_LPS_MIN_PRIC_W TABLE.                                02942006
029500******************************************************************02950004
029600                                                                  02960004
029700     DISPLAY 'CLEAR NON-MAIN PROMO HISTORY IN XST_LPS_MIN_PRIC_W'.02970004
029800     EXEC SQL                                                     02980004
029900         UPDATE XST_LPS_MIN_PRIC_W                                02990004
030000             SET HIST_NMP_PROMO_ID = NULL                         03000004
030100                 , HIST_NMP_ITM_ID = NULL                         03010004
030200                 , HIST_NMP_LO_AMT = NULL                         03020004
030300                 , LAST_NMP_PROMO_ID = NULL                       03030004
030400     END-EXEC.                                                    03040004
030500                                                                  03050004
030600     EVALUATE TRUE                                                03060004
030700         WHEN SQLCODE = +0                                        03070004
030800         WHEN SQLCODE = +100                                      03080004
030900             CONTINUE                                             03090004
031000                                                                  03100004
031100         WHEN OTHER                                               03110004
031200             MOVE 'H400-CLEAR-NON-MAIN-HIST'                      03120004
031300                               TO PV-PARAGRAPH-NAME               03130004
031400             MOVE 'UPDATE ERROR ON XST_LPS_MIN_PRIC_W'            03140004
031500                               TO PV-DB2-OPERATION-ATTEMPTED      03150004
031600             PERFORM Z900-SQL-ABEND                               03160004
031700     END-EVALUATE.                                                03170004
031800                                                                  03180004
031900******************************************************************03190004
032000 H500-CLEAR-NON-MAIN-FUT.                                         03200004
032010*    THIS CLEARS THE NON MAIN PROMOTION FUTURE COLUMNS ON         03201006
032020*    THE XST_LPS_MIN_PRIC_W TABLE.                                03202006
032100******************************************************************03210004
032200                                                                  03220004
032300     DISPLAY 'CLEAR NON-MAIN PROMO FUTURE IN XST_LPS_MIN_PRIC_W'. 03230004
032400     EXEC SQL                                                     03240004
032500         UPDATE XST_LPS_MIN_PRIC_W                                03250004
032600             SET FUT_NMP_PROMO_ID = NULL                          03260004
032700                 , FUT_NMP_ITM_ID = NULL                          03270004
032800                 , FUT_NMP_LO_AMT = NULL                          03280004
032810             WHERE FUT_NMP_PROMO_ID IS NOT NULL                   03281014
032900     END-EXEC.                                                    03290004
033000                                                                  03300004
033100     EVALUATE TRUE                                                03310004
033200         WHEN SQLCODE = +0                                        03320004
033300         WHEN SQLCODE = +100                                      03330004
033400             CONTINUE                                             03340004
033500                                                                  03350004
033600         WHEN OTHER                                               03360004
033700             MOVE 'H500-CLEAR-NON-MAIN-FUT'                       03370004
033800                               TO PV-PARAGRAPH-NAME               03380004
033900             MOVE 'UPDATE ERROR ON XST_LPS_MIN_PRIC_W'            03390004
034000                               TO PV-DB2-OPERATION-ATTEMPTED      03400004
034100             PERFORM Z900-SQL-ABEND                               03410004
034200     END-EVALUATE.                                                03420004
034300                                                                  03430004
034400******************************************************************03440004
034500* H600-COMMIT.                                                   *03450006
034510*     COMMITS THE DATA.                                           03451006
034600******************************************************************03460004
034700 H600-COMMIT.                                                     03470004
034800                                                                  03480004
034900     EXEC SQL                                                     03490004
035000          COMMIT                                                  03500004
035100     END-EXEC.                                                    03510004
035200                                                                  03520004
035300     EVALUATE TRUE                                                03530004
035400         WHEN SQLCODE = +0                                        03540004
035500              ADD +1              TO PA-COMMIT-CNT                03550004
035600                                                                  03560004
035700         WHEN OTHER                                               03570004
035800             MOVE 'H600-COMMIT' TO PV-PARAGRAPH-NAME              03580004
035900             MOVE 'UNSUCCESSFUL COMMIT OF XST_LPS_MIN_PRIC_W'     03590004
036000                               TO PV-DB2-OPERATION-ATTEMPTED      03600004
036100             PERFORM Z900-SQL-ABEND                               03610004
036200     END-EVALUATE.                                                03620004
036300                                                                  03630004
036400******************************************************************03640004
036500* Z900-SQL-ABEND                                                 *03650006
036600* ==> PROCESSES:                                                 *03660004
036700*     - PERFORMS ABEND PROCESSING FOR SQL ERRORS.                *03670004
036800* ==> PERFORMED FROM:                                            *03680004
036900******************************************************************03690004
037000 Z900-SQL-ABEND.                                                  03700004
037100                                                                  03710004
037200     DISPLAY 'Z900-SQL-ABEND'.                                    03720004
037300     DISPLAY '**  ABEND     **'.                                  03730004
037400     DISPLAY '**  PROGRAM   **  = ' PC-PROGRAM-NAME.              03740004
037500     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            03750004
037600     DISPLAY '**  OPERATION **  = ' PV-DB2-OPERATION-ATTEMPTED.   03760004
037700                                                                  03770004
037800******************************************************************03780004
037900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *03790004
038000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *03800004
038100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *03810004
038200* FORMAT.                                                        *03820004
038300******************************************************************03830004
038400     COPY DPPD004.                                                03840004
038500                                                                  03850004
038600     SET ABEND-4013-DB2-ERROR TO TRUE.                            03860004
038700     CALL 'ILBOABN0' USING ABEND-CODE.                            03870004
