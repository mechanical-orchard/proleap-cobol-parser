000100 IDENTIFICATION DIVISION.                                         00010002
000200 PROGRAM-ID.    WSKCS300.                                         00020002
000300 AUTHOR.        JOE LAROSA.                                       00030002
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040002
000500 DATE-WRITTEN.  MARCH, 2007.                                      00050002
000600 DATE-COMPILED.                                                   00060002
000700******************************************************************00070002
000800*  CICS         W300 - UPDATE ITEM ATTRIBUTES               CICS *00080017
000900*  THIS PROGRAM WILL DISPLAY THE ITEM ATTRIBUTES FROM TWEBITM &  *00090002
001000*  IMT_ITM_DC_ASSN. THE DATA IS FROM THE EFC CUBISCAN PROCESS.   *00100006
001100*  THE ONLY KEYABLE FIELDS ON THIS SCREEN ARE USED BY PAT RISLOV *00110006
001200*  TO HANDLE DIRECT SHIP ('DS') SKUS.                            *00120006
001300******************************************************************00130002
001200*  3/31/2016 MARJ HOEFS - KOHL'S NO LONGER OFFERS GIFT WRAP      *00131036
001200*  SERVICE.  I TURNED OFF ABILITY TO UPDATE GIFT WRAP AVAILABLE  *00131136
001200*  INDICATOR.  WHEN UPDATING AN ITEM, ALWAYS SET THE GIFT WRAP   *00131236
001200*  GIFT WRAP TO "N".  THIS WILL AUTOMATICALLY CORRECT AN         *00131336
001200*  INDICATOR THAT WAS INCORRECTLY SET TO "Y" ON TWEBITM.  SINCE  *00131436
001200*  THIS CHANGE MAY NOT BE PERMANENT THE RELEVANT LINES WERE JUST *00131536
001200*  COMMENTED OUT.  TO MAKE GIFT WRAP INDICATOR UPDATABLE AGAIN,  *00131636
001200*  UNCOMMENT OUT THE LINES PREFIXED WITH "GFTWRP" EXCEPT FOR THE *00131736
001200*  LINES IN 7300-INSERT-TWEBITM WHICH SHOULD BE DELETED.  ALSO,  *00131836
001200*  IN MAP WSKM300, CHANGE AUPGIFT FROM "PROT" TO "UNPROT", ADD   *00131935
001200*  IN "HILIGHT=UNDERLINE", AND CHANGE COLOR FROM "BLUE" TO       *00132035
001200*  "GREEN".                                                      *00132135
001300******************************************************************00133033
263627*  CHANGED 11/19/2021    BY JIM HUNTER      WR: CHG0263627       *00135037
263627*  CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE   *00136037
263627*  MAKING THE CALL DYNAMIC VS STATIC.                            *00137037
263627******************************************************************00138037
CICS  *  CHANGED 11/04/2022    BY BARB SCHULTZ    WR: CHG0278176       *00139041
CICS  *                                                                *00139138
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL    *00139238
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.     *00139338
CICS  ******************************************************************00139438
001400 DATA DIVISION.                                                   00140002
001500 WORKING-STORAGE SECTION.                                         00150002
001600 01  PS-PROGRAM-SWITCHES.                                         00160002
001700     05  PS-ERROR-SW              PIC  X(01)  VALUE 'N'.          00170012
001800         88  PS-ERROR                         VALUE 'Y'.          00180012
001900         88  PS-NO-ERROR                      VALUE 'N'.          00190012
002000     05  PS-WEBITM-SW             PIC  X(01)  VALUE 'N'.          00200012
002100         88  PS-WEBITM-ERROR                  VALUE 'Y'.          00210012
002200         88  PS-NO-WEBITM-ERROR               VALUE 'N'.          00220012
002300     05  PS-SKU-SW                PIC  X(01)  VALUE 'N'.          00230012
002400         88  PS-SKU-ERROR                     VALUE 'Y'.          00240012
002500         88  PS-NO-SKU-ERROR                  VALUE 'N'.          00250012
002600     05  PS-DC-SW                 PIC  X(01)  VALUE 'N'.          00260012
002700         88  PS-DC-ERROR                      VALUE 'Y'.          00270012
002800         88  PS-NO-DC-ERROR                   VALUE 'N'.          00280012
002900     05  PS-STYL-SW               PIC  X(01)  VALUE 'N'.          00290012
003000         88  PS-STYL-ERROR                    VALUE 'Y'.          00300012
003100         88  PS-NO-STYL-ERROR                 VALUE 'N'.          00310012
003200     05  PS-CHG-SW                PIC  X(01)  VALUE 'N'.          00320012
003300         88  PS-SCR-CHG                       VALUE 'Y'.          00330012
003400         88  PS-NO-SCR-CHG                    VALUE 'N'.          00340012
003500     05  PS-UPDATE-SW             PIC  X(01)  VALUE 'N'.          00350012
003600         88  PS-UPDATE-OCCUR                  VALUE 'Y'.          00360012
003700         88  PS-NO-UPDATE-OCCUR               VALUE 'N'.          00370012
003800                                                                  00380002
003900 01  PC-PROGRAM-CONSTANTS.                                        00390002
004000     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE 'WS300A  '.   00400012
004100     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE 'WSKM300 '.   00410012
004200     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE 'WSKCS300'.   00420012
004300     05  PC-MAX-RETRIES           PIC S9(04)  VALUE +3 COMP.      00430012
004400     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE +3 COMP.      00440012
004500     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE +1  COMP.     00450012
004600     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00460002
004700     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00470002
004800     05  PC-APPL-MAP              PIC S9(04)  VALUE +1 COMP.      00480012
004900                                                                  00490012
005000     05  PC-TSYMSG-NUMBERS.                                       00500002
005100* REQUIRED ENTRY (DP)                                             00510006
005200         10  PC-TSYMSG-00007      PIC  9(05)  VALUE 00007.        00520012
005300* MUST BE NUMERIC (DP)                                            00530006
005400         10  PC-TSYMSG-00008      PIC  9(05)  VALUE 00008.        00540012
005500* INVALID FUNCTION KEY (DP)                                       00550006
005600         10  PC-TSYMSG-00045      PIC  9(05)  VALUE 00045.        00560012
005700* DATA NOT CHANGED; NO UPDATE PERFORMED (DP)                      00570006
005800         10  PC-TSYMSG-00046      PIC  9(05)  VALUE 00046.        00580012
005900* UPDATE(S) SUCCESSFUL (DP)                                       00590006
006000         10  PC-TSYMSG-00059      PIC  9(05)  VALUE 00059.        00600012
006100* Y/N REQUIRED (DP)                                               00610006
006200         10  PC-TSYMSG-00349      PIC  9(05)  VALUE 00349.        00620012
006300* PRESS F15 TO CONFIRM UPDATE (RF)                                00630006
006400         10  PC-TSYMSG-01100      PIC  9(05)  VALUE 01100.        00640012
006500* LOCATION DOES NOT EXIST (SA)                                    00650006
006600         10  PC-TSYMSG-02068      PIC  9(05)  VALUE 02068.        00660012
006700* ENTER SKU NUMBER (VL)                                           00670006
006800         10  PC-TSYMSG-02616      PIC  9(05)  VALUE 02616.        00680012
006900* MAKE SHIPPING ATTRIBUTE CHANGES (VL)                            00690006
007000         10  PC-TSYMSG-02617      PIC  9(05)  VALUE 02617.        00700012
007100* SKU NOT FOUND (VL)                                              00710006
007200         10  PC-TSYMSG-02618      PIC  9(05)  VALUE 02618.        00720012
007300* INVALID VALUE(S) (VL)                                           00730006
007400         10  PC-TSYMSG-02619      PIC  9(05)  VALUE 02619.        00740012
007500* VALUES MUST BE NUMERIC - 999.99                                 00750006
007600         10  PC-TSYMSG-02658      PIC  9(05)  VALUE 02658.        00760012
007700* UNABLE TO ASSIGN 'DS' TO SKU.  SKU'S VENDOR NOT A DIREC (WF)    00770006
007800         10  PC-TSYMSG-03408      PIC  9(05)  VALUE 03408.        00780012
007900* WEB SKU NOT FOUND.                                              00790006
008000         10  PC-TSYMSG-03547      PIC  9(05)  VALUE 03547.        00800012
008100* WEB SKU DC ATTRIBUTES NOT FOUND.                                00810012
008200         10  PC-TSYMSG-03551      PIC  9(05)  VALUE 03551.        00820012
008300                                                                  00830012
008400 01  DK-DB2-KEYS.                                                 00840002
008500     05  DK-SKU                   PIC S9(8)V COMP-3.              00850012
008600     05  DK-DC                    PIC S9(4) COMP.                 00860012
008700     05  DK-INTR-UPC-ID           PIC S9(9) COMP.                 00870012
008800                                                                  00880002
008900 01  PV-PROGRAM-VARIABLES.                                        00890002
009000     05  PV-CICS-RESPONSE         PIC S9(4) VALUE +0 COMP SYNC.   00900012
009100     05  PV-RETRY-COUNTER         PIC S9(4) VALUE +0 COMP SYNC.   00910012
009200     05  PV-LOCK-RETRY-COUNTER    PIC S9(4) VALUE +0 COMP SYNC.   00920012
009300     05  PV-NULL-IND-1            PIC S9(4) VALUE +0 COMP.        00930012
009400     05  PV-NULL-IND-2            PIC S9(4) VALUE +0 COMP.        00940012
009500     05  PV-NULL-IND-3            PIC S9(4) VALUE +0 COMP.        00950012
009600     05  PV-NULL-IND-4            PIC S9(4) VALUE +0 COMP.        00960012
009700     05  PV-HOLD-SKU-NBR          PIC X(08).                      00970002
009800     05  PV-HOLD-DC-NBR           PIC X(04).                      00980003
009900     05  PV-NUMERIC-4V3           PIC 9(4)V999.                   00990011
010000     05  PV-NUMERIC-3V2           PIC 9(3)V99.                    01000011
010100     05  PV-CURRENT-TMST          PIC X(26).                      01010012
010200     05  FILLER REDEFINES PV-CURRENT-TMST.                        01020012
010300         10  PV-CURRENT-DATE      PIC X(10).                      01030012
010400         10  PV-CURRENT-TIME      PIC X(16).                      01040012
010500                                                                  01050002
010600     05  ED-ASC-SHIP-LENGTH       PIC ZZZ9.999.                   01060011
010700     05  ED-ASC-SHIP-WIDTH        PIC ZZZ9.999.                   01070002
010800     05  ED-ASC-SHIP-HEIGHT       PIC ZZZ9.999.                   01080002
010900     05  ED-ASC-SHIP-WEIGHT       PIC ZZZZ9.999.                  01090012
011000     05  ED-ASC-STOR-AREA-CDE     PIC ZZZ9.                       01100002
011100     05  ED-ASC-PACK-CDE          PIC ZZZ9.                       01110002
011200     05  ED-ASC-SHIP-SERV-CDE     PIC ZZZ9.                       01120002
011300     05  ED-ASC-SHIP-REST-CDE     PIC ZZZ9.                       01130002
011400     05  ED-ASC-SHIP-GRP-CDE      PIC ZZZ9.                       01140002
011500     05  ED-ASC-SHIP-SURCHARGE    PIC ZZ9.99.                     01150002
011600     05  ED-ASC-UPC-ID            PIC ZZZZZZZZZ9.                 01160016
011700                                                                  01170002
011800 01  WS-EFFECTIVE-DTE.                                            01180002
011900     05  WS-EFF-MONTH              PIC X(2).                      01190002
012000     05  FILLER                    PIC X VALUE '/'.               01200002
012100     05  WS-EFF-DAY                PIC X(2).                      01210002
012200     05  FILLER                    PIC X VALUE '/'.               01220002
012300     05  WS-EFF-YEAR               PIC X(4).                      01230002
012400                                                                  01240002
012500*----------------------------------------------------------------*01250002
012600*    SECURITY SUBROUTINE PARAMETERS                              *01260002
012700*----------------------------------------------------------------*01270002
012800     COPY DPWS008.                                                01280002
012900                                                                  01290002
013000*----------------------------------------------------------------*01300002
013100*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *01310002
013200*    SUB-ROUTINE (DPKUT100).                                     *01320002
013300*----------------------------------------------------------------*01330002
013400     COPY DPWS010I.                                               01340002
013500                                                                  01350002
013600*----------------------------------------------------------------*01360002
013700*  WORK AREA PASSED IN CALL TO DPKUT500                          *01370002
013800*----------------------------------------------------------------*01380002
013900     COPY DPWS500.                                                01390002
014000                                                                  01400002
014100*----------------------------------------------------------------*01410002
014200*  COPYBOOK USED BY XLKUT001 (LOGISTICS DOMAIN MODULE)           *01420002
014300*----------------------------------------------------------------*01430002
014400     COPY XLWS001.                                                01440002
014500                                                                  01450002
014600*----------------------------------------------------------------*01460002
014700*    MAP LAYOUT                                                  *01470002
014800*----------------------------------------------------------------*01480002
014900     COPY WSKM300.                                                01490002
015000                                                                  01500002
015100*----------------------------------------------------------------*01510002
015200*    ATTRIBUTE SETTINGS COPYBOOK.                                *01520002
015300*----------------------------------------------------------------*01530002
015400     COPY DPWS015.                                                01540002
015500                                                                  01550002
015600*----------------------------------------------------------------*01560002
015700*    FUNCTION KEYS COPYBOOK                                      *01570002
015800*----------------------------------------------------------------*01580002
015900     COPY DPWS016.                                                01590002
016000                                                                  01600002
016100***************************************************************** 01610002
CICS  * PARAMETERS FOR THE CALLING THE CICS ARCHITECTURE API.           01620039
016300***************************************************************** 01630002
016400     COPY DPWS030.                                                01640002
CICS       COPY DPWS930.                                                01641038
016500                                                                  01650002
016600***************************************************************** 01660002
016700*    STANDARD COMMAREA.                                           01670002
016800***************************************************************** 01680002
016900     COPY DPWS020.                                                01690002
017000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01700002
017100                                                                  01710002
017200***************************************************************** 01720002
017300*    INTER-APPLICATION COMMAREA.                                  01730002
017400***************************************************************** 01740002
017500         10  INTER-APPL-COMM-AREA PIC X(200).                     01750009
017600                                                                  01760002
017700***************************************************************** 01770002
017800*    SPECIFIC COMMMAREA FOR WSKCS300.                             01780002
017900***************************************************************** 01790002
018000         10  ASC-SPECIFIC-COMMAREA.                               01800002
018100             15  ASC-SKU                     PIC X(8).            01810002
018200             15  ASC-DC                      PIC X(4).            01820002
018300             15  ASC-DC-N                    REDEFINES            01830002
018400                 ASC-DC                      PIC ZZZ9.            01840003
018500             15  ASC-UPC                     PIC X(10).           01850016
018600             15  ASC-UPC-N                   PIC S9(9) COMP.      01860003
018700             15  ASC-DC-DESC                 PIC X(20).           01870003
018800                                                                  01880002
018900             15  ASC-DEPT                    PIC X(3).            01890002
019000             15  ASC-DISPLAY-DEPT            PIC X(3).            01900003
019100             15  ASC-SUB-CLASS               PIC X(2).            01910002
019200             15  ASC-DISPLAY-CLASS           PIC X(2).            01920003
019300             15  ASC-DISPLAY-EFF-DATE        PIC X(10).           01930002
019400             15  ASC-SKU-DESC                PIC X(25).           01940003
019500                                                                  01950002
019600             15  ASC-SHIP-LENGTH             PIC X(8).            01960002
019700             15  ASC-SHIP-L-N                REDEFINES            01970002
019800                 ASC-SHIP-LENGTH             PIC ZZZ9.999.        01980002
019900             15  ASC-HAZARDOUS               PIC X(1).            01990003
020000             15  ASC-SHIP-WIDTH              PIC X(8).            02000003
020100             15  ASC-SHIP-W-N                REDEFINES            02010002
020200                 ASC-SHIP-WIDTH              PIC ZZZ9.999.        02020002
020300             15  ASC-BREAKABLE               PIC X(1).            02030003
020400             15  ASC-SHIP-HEIGHT             PIC X(8).            02040002
020500             15  ASC-SHIP-H-N                REDEFINES            02050002
020600                 ASC-SHIP-HEIGHT             PIC ZZZ9.999.        02060002
020700             15  ASC-GIFT-CARD               PIC X(1).            02070003
020800             15  ASC-SHIP-WEIGHT             PIC X(9).            02080012
020900             15  ASC-SHIP-WT-N               REDEFINES            02090002
021000                 ASC-SHIP-WEIGHT             PIC ZZZZ9.999.       02100012
021100             15  ASC-SHIPALONE               PIC X(1).            02110003
021200                                                                  02120003
021300             15  ASC-SHIP-SERV-CDE           PIC 9(4).            02130002
021400             15  ASC-DESC4                   PIC X(20).           02140002
021500             15  ASC-SHIP-REST-CDE           PIC 9(4).            02150002
021600             15  ASC-DESC5                   PIC X(20).           02160002
021700             15  ASC-SHIP-GRP-CDE            PIC 9(4).            02170002
021800             15  ASC-DESC6                   PIC X(20).           02180002
021900             15  ASC-GIFT-WRAP               PIC X(1).            02190002
022000             15  ASC-SHIP-SURCHARGE          PIC X(6).            02200002
022100             15  ASC-SHIP-SURCHARGE-N        REDEFINES            02210002
022200                 ASC-SHIP-SURCHARGE          PIC ZZ9.99.          02220002
022300                                                                  02230003
022400             15  ASC-BOX-SIZE                PIC X(10).           02240003
022500             15  ASC-CONVEYABLE              PIC X(1).            02250003
022600             15  ASC-SHIP-COST               PIC X(6).            02260003
022700             15  ASC-SHIP-COST-N             REDEFINES            02270003
022800                 ASC-SHIP-COST               PIC ZZ9.99.          02280003
022900             15  ASC-BAGGABLE                PIC X(1).            02290003
023000             15  ASC-PICK-LOC-TYPE           PIC X(3).            02300003
023100             15  ASC-SORT-CODE               PIC X(1).            02310003
023200                                                                  02320003
023300             15  ASC-VS-ID                   PIC S9(9) COMP.      02330002
023400             15  ASC-ENT-ID                  PIC S9(9) COMP.      02340002
023500             15  ASC-VS-NBR                  PIC X(20).           02350002
023600             15  ASC-PROCESS-FLAG            PIC X(1).            02360002
023700                 88  ASC-NEW-SKU                      VALUE '1'.  02370002
023800                 88  ASC-EDIT                         VALUE '2'.  02380002
023900                 88  ASC-CONFIRM                      VALUE '3'.  02390002
024000                 88  ASC-UPDATE                       VALUE '4'.  02400002
024100             15  PV-ASC-SHIP-LENGTH          PIC S9999V999.       02410002
024200             15  PV-ASC-SHIP-WIDTH           PIC S9999V999.       02420002
024300             15  PV-ASC-SHIP-HEIGHT          PIC S9999V999.       02430002
024400             15  PV-ASC-SHIP-WEIGHT          PIC S99999V999.      02440012
024500             15  PV-ASC-SHIP-SERV-CDE        PIC S9(4).           02450002
024600             15  PV-ASC-SHIP-REST-CDE        PIC S9(4).           02460002
024700             15  PV-ASC-SHIP-GRP-CDE         PIC S9(4).           02470002
024800             15  PV-ASC-SHIP-SURCHARGE       PIC S999V99.         02480002
024900         10  FILLER                          PIC X(2555).         02490012
025000                                                                  02500002
025100*----------------------------------------------------------------*02510002
025200*    ABEND PROCESSING COPYBOOK.                                  *02520002
025300*----------------------------------------------------------------*02530002
025400     COPY DPWS013.                                                02540002
025500                                                                  02550002
025600*DB2 AREA FOR SKU CROSS REFERENCE.                                02560004
025700     EXEC SQL                                                     02570002
025800          INCLUDE TSKXREF                                         02580004
025900     END-EXEC.                                                    02590002
026000                                                                  02600002
026100*DB2 AREA FOR LOGISTICS DOMAIN SKU.                               02610004
026200     EXEC SQL                                                     02620004
026300          INCLUDE XLT00003                                        02630004
026400     END-EXEC.                                                    02640004
026500                                                                  02650004
026600*DB2 AREA FOR LOGISTICS DOMAIN VENDOR STYLE.                      02660004
026700     EXEC SQL                                                     02670004
026800          INCLUDE XLT00004                                        02680004
026900     END-EXEC.                                                    02690004
027000                                                                  02700004
027100*DB2 AREA FOR LOGISTICS DOMAIN LOCATION.                          02710004
027200     EXEC SQL                                                     02720004
027300          INCLUDE XLT00010                                        02730004
027400     END-EXEC.                                                    02740004
027500                                                                  02750004
027600*DB2 AREA FOR LOGISTICS WEB SKU VIEW.                             02760004
027700     EXEC SQL                                                     02770004
027800          INCLUDE XLV00004                                        02780004
027900     END-EXEC.                                                    02790004
028000                                                                  02800004
028100*DB2 AREA FOR SKU WEB ATTRIBUTES.                                 02810004
028200     EXEC SQL                                                     02820004
028300          INCLUDE TWEBITM                                         02830004
028400     END-EXEC.                                                    02840004
028500                                                                  02850004
028600*DB2 AREA FOR DC SPECIFIC SKU ATTRIBUTES.                         02860004
028700     EXEC SQL                                                     02870002
028800          INCLUDE IMT00024                                        02880002
028900     END-EXEC.                                                    02890002
029000                                                                  02900002
029100*DB2 AREA FOR VENDOR CAPABILITIES.                                02910004
029200     EXEC SQL                                                     02920004
029300          INCLUDE VNT00001                                        02930004
029400     END-EXEC.                                                    02940004
029500                                                                  02950004
029600*DB2 AREA FOR VSM CHARACTER VALUES.                               02960004
029700     EXEC SQL                                                     02970002
029800          INCLUDE TVSCHVL                                         02980002
029900     END-EXEC.                                                    02990002
030000                                                                  03000002
030100*DB2 AREA FOR VSM RESERVATIONS.                                   03010004
030200     EXEC SQL                                                     03020002
030300          INCLUDE TVSRSVN                                         03030002
030400     END-EXEC.                                                    03040002
030500                                                                  03050002
030600*DB2 AREA FOR COMMUNICATIONS                                      03060002
030700     EXEC SQL                                                     03070002
030800          INCLUDE SQLCA                                           03080002
030900     END-EXEC.                                                    03090002
031000                                                                  03100002
031100/*****************************************************************03110002
031200 LINKAGE SECTION.                                                 03120002
031300******************************************************************03130002
031400 01  DFHCOMMAREA.                                                 03140002
031500     05  FILLER                         OCCURS  1 TO 4072 TIMES   03150002
031600                                        DEPENDING ON EIBCALEN.    03160002
031700         10  FILLER                     PIC  X(01).               03170002
031800                                                                  03180002
031900 PROCEDURE DIVISION.                                              03190002
032000***************************************************************** 03200002
032100** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03210002
032200** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03220002
032300** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03230002
032400**                                                             ** 03240002
032500** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03250002
032600** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03260002
032700***************************************************************** 03270002
032800 0000-MAIN-MODULE.                                                03280002
032900                                                                  03290002
033000     INITIALIZE DP030-CICS-API-FIELDS.                            03300002
033100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03310002
033200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03320002
033300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03330002
033400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03340002
033500     MOVE LENGTH OF WS300AI        TO DP030-MAP-LENGTH (1).       03350002
033600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03360002
033700     PERFORM 0001-CALL-CICS-ARCH-API.                             03370002
033800                                                                  03380002
033900     PERFORM 1000-CONTROL-PROCESSING                              03390002
034000                                                                  03400002
034100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03410002
034200     PERFORM 0001-CALL-CICS-ARCH-API.                             03420002
034300                                                                  03430002
034400******************************************************************03440002
034500 0001-CALL-CICS-ARCH-API.                                         03450002
034600                                                                  03460002
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03470038
034800                                    DFHCOMMAREA                   03480038
034900                                    DP030-CICS-API-FIELDS         03490038
035000                                    DP020-STANDARD-COMMAREA       03500038
035100                                    WS300AI.                      03510038
035200                                                                  03520002
035300     IF  DP030-RC-CALL-SUCCESSFUL                                 03530002
035400         CONTINUE                                                 03540002
035500     ELSE                                                         03550002
035600         SET DP013-NO-ROLLBACK                                    03560002
035700             DP013-XCTL-DISPLAY-RESTART                           03570002
035800             DP013-CICS-ABEND      TO TRUE                        03580002
CICS           MOVE '0001-CALL-CICS-ARCH-API'                           03590040
036000                                   TO DP013-PARAGRAPH             03600002
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03610038
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03620038
036300         MOVE DP030-RETURN-CODE                                   03630002
036400                                   TO DP013-MESSAGE-TEXT (3)      03640002
036500         PERFORM DP013-0000-PROCESS-ABEND                         03650002
036600     END-IF.                                                      03660002
036700                                                                  03670002
036800*----------------------------------------------------------------*03680002
036900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03690002
037000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03700002
037100*----------------------------------------------------------------*03710002
037200 1000-CONTROL-PROCESSING.                                         03720002
037300                                                                  03730002
037400     EVALUATE TRUE                                                03740002
037500       WHEN DP020-NEXT-ACT-INITIAL                                03750002
037600           INITIALIZE ASC-SPECIFIC-COMMAREA                       03760002
037700           MOVE ZEROES TO ASC-SHIP-L-N                            03770010
037800                          ASC-SHIP-H-N                            03780010
037900                          ASC-SHIP-W-N                            03790010
038000                          ASC-SHIP-WT-N                           03800010
038100                          ASC-SHIP-SURCHARGE-N                    03810010
038200                          ASC-SHIP-COST-N                         03820010
038300           PERFORM 1100-CHECK-SECURITY                            03830002
038400           PERFORM 3200-RESET-ATTRIBUTES                          03840014
038500           PERFORM 4000-BUILD-INITIAL-PANEL                       03850002
038600                                                                  03860002
038700       WHEN DP020-NEXT-ACT-READ-MAP                               03870002
038800           PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                   03880002
038900           IF  PS-ERROR                                           03890019
039000               CONTINUE                                           03900019
039100           ELSE                                                   03910019
039200               IF  ASC-NEW-SKU                                    03920018
039300                   PERFORM 4000-BUILD-INITIAL-PANEL               03930018
039400                   MOVE ' ' TO ASC-PROCESS-FLAG                   03940018
039500               ELSE                                               03950018
039600                   PERFORM 3100-NEW-SKU                           03960018
039700               END-IF                                             03970018
039800           END-IF                                                 03980018
039900                                                                  03990018
040000           IF  PS-SKU-ERROR  OR                                   04000018
040100               PS-DC-ERROR   OR                                   04010018
040200               PS-WEBITM-ERROR  OR                                04020018
040300               PS-ERROR                                           04030018
040400               CONTINUE                                           04040002
040500           ELSE                                                   04050002
040600               PERFORM 2000-PROCESS-PANEL                         04060002
040700           END-IF                                                 04070002
040800                                                                  04080002
040900       WHEN DP020-NEXT-ACT-RETURN                                 04090002
041000*          PERFORM 3000-EDIT-DATA-IN-COMMAREA                     04100017
041100           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   04110002
041200                                                                  04120002
041300       WHEN OTHER                                                 04130002
041400           SET DP013-LOGIC-ABEND                                  04140002
041500               DP013-NO-ROLLBACK TO TRUE                          04150002
041600           MOVE '1000-CONTROL-PROCESSING'                         04160002
041700                                 TO DP013-PARAGRAPH               04170002
041800           MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'     04180002
041900                                 TO DP013-MESSAGE-TEXT(1)         04190002
042000           MOVE DP020-NEXT-APPL-ACTIVITY                          04200002
042100                                 TO DP013-MESSAGE-TEXT(2)         04210002
042200           PERFORM DP013-0000-PROCESS-ABEND                       04220002
042300     END-EVALUATE.                                                04230002
042400                                                                  04240002
042500*----------------------------------------------------------------*04250002
042600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04260002
042700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04270002
042800*----------------------------------------------------------------*04280002
042900 1100-CHECK-SECURITY.                                             04290002
043000                                                                  04300002
043100     SET DP008-RSRC-TYPE-FUNC       TO TRUE.                      04310002
043200     SET DP008-ACCESS-TYPE-USE      TO TRUE.                      04320002
043300     PERFORM 1110-LINK-TO-SECURITY.                               04330002
043400                                                                  04340002
043500******************************************************************04350002
043600 1110-LINK-TO-SECURITY.                                           04360002
043700                                                                  04370002
043800     EXEC CICS LINK                                               04380002
043900               PROGRAM  (DP008-SECURITY-SUBROUTINE)               04390002
044000               COMMAREA (DP008-SECURITY-COMMAREA)                 04400002
044100               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          04410002
044200     END-EXEC.                                                    04420002
044300                                                                  04430002
044400     IF DP008-CALL-SUCCESSFUL                                     04440002
044500         CONTINUE                                                 04450002
044600     ELSE                                                         04460002
044700         SET DP013-XCTL-DISPLAY-LOGOFF TO TRUE                    04470002
044800         SET DP013-SECURITY-ABEND      TO TRUE                    04480002
044900         MOVE '1110-LINK-TO-SECURITY'  TO DP013-PARAGRAPH         04490002
045000         MOVE DP008-SECURITY-COMMAREA  TO DP013-SECURITY-INFO     04500002
045100         PERFORM DP013-0000-PROCESS-ABEND                         04510002
045200     END-IF.                                                      04520002
045300                                                                  04530002
045400*----------------------------------------------------------------*04540002
045500* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04550002
045600* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04560002
045700* EDITS.                                                         *04570002
045800*----------------------------------------------------------------*04580002
045900 2000-PROCESS-PANEL.                                              04590002
046000                                                                  04600002
046100     EVALUATE TRUE                                                04610002
046200       WHEN DP020-SRC-AID = DP016-CLEAR                           04620002
046300           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   04630002
046400           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     04640002
046500                                                                  04650002
046600       WHEN DP020-FK-REFRESH(DP020-SRC-AID)                       04660002
046700           INITIALIZE ASC-SPECIFIC-COMMAREA                       04670025
046800           MOVE ZEROES TO ASC-SHIP-L-N                            04680027
046900                          ASC-SHIP-H-N                            04690027
047000                          ASC-SHIP-W-N                            04700027
047100                          ASC-SHIP-WT-N                           04710027
047200                          ASC-SHIP-SURCHARGE-N                    04720027
047300                          ASC-SHIP-COST-N                         04730027
047400           PERFORM 3200-RESET-ATTRIBUTES                          04740026
047500           PERFORM 4000-BUILD-INITIAL-PANEL                       04750017
047600                                                                  04760002
047700       WHEN OTHER                                                 04770002
047800           PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                   04780002
047900           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     04790002
048000           IF PS-NO-ERROR                                         04800002
048100               SET DP030-CONTINUE-GO TO TRUE                      04810002
048200               PERFORM 2100-CHECK-FUNCTION-KEY                    04820002
048300           ELSE                                                   04830002
048400               SET DP030-OVERRIDE-GO TO TRUE                      04840002
048500               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               04850002
048600           END-IF                                                 04860002
048700     END-EVALUATE.                                                04870002
048800                                                                  04880002
048900******************************************************************04890002
049000** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **04900002
049100** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **04910002
049200** FROM THE CICS ARCHITECTURE API.                              **04920002
049300******************************************************************04930002
049400 2100-CHECK-FUNCTION-KEY.                                         04940002
049500                                                                  04950002
049600     EVALUATE TRUE                                                04960002
049700       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                04970002
049800           PERFORM 4300-GET-WEB-SKU                               04980002
049900           IF PS-WEBITM-ERROR                                     04990002
050000               SET PS-ERROR                                       05000002
050100                   DP020-MSG-FATAL         TO TRUE                05010002
050200* WEB ATTRIBUTES FOR SKU NOT FOUND                                05020007
050300               MOVE PC-TSYMSG-03547        TO DP020-MSG-NUMBER    05030007
050400               MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSKUA             05040002
050500               MOVE DP015-RED              TO AUPSKUC             05050002
050600               MOVE DP015-REVERSE          TO AUPSKUH             05060002
050700               MOVE -1                     TO AUPSKUL             05070002
050800               SET DP030-SET-CURSOR-APPL-1 TO TRUE                05080002
050900           ELSE                                                   05090002
051000               PERFORM 5000-CHECK-IF-UPDATE                       05100002
051100               IF PS-UPDATE-OCCUR                                 05110002
051200                   PERFORM 6100-INSERT-TVSRSVN                    05120002
051300                   PERFORM 7200-UPDATE-TWEBITM                    05130002
051400                   PERFORM 7300-INSERT-TWEBITM                    05140002
051500                   PERFORM 6200-DELETE-TVSRSVN                    05150002
051600                   IF PS-NO-ERROR                                 05160002
051700* UPDATE SUCCESSFUL MSG                                           05170006
051800                       MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER   05180002
051900                       MOVE DP015-UNP-ALP-BRT-OFF   TO AUPSKUA    05190002
052000                       MOVE -1                      TO AUPSKUL    05200002
052100                       SET DP030-SET-CURSOR-APPL-1                05210002
052200                           DP020-MSG-INFORMATIONAL  TO TRUE       05220002
052300                       MOVE XL001-EFF-BEG-TMST(6:2)               05230002
052400                         TO WS-EFF-MONTH                          05240002
052500                       MOVE XL001-EFF-BEG-TMST(9:2) TO WS-EFF-DAY 05250002
052600                       MOVE XL001-EFF-BEG-TMST(1:4) TO WS-EFF-YEAR05260002
052700                       MOVE WS-EFFECTIVE-DTE                      05270002
052800                         TO ASC-DISPLAY-EFF-DATE                  05280002
052900                   END-IF                                         05290002
053000               ELSE                                               05300002
053100                   IF PS-NO-UPDATE-OCCUR                          05310002
053200* DATA NOT CHANGED; NO UPDATE PERFORMED MSG                       05320006
053300                       MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER   05330002
053400                       MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSKUA     05340002
053500                       MOVE -1                     TO AUPSKUL     05350002
053600                       SET DP030-SET-CURSOR-APPL-1                05360002
053700                           DP020-MSG-INFORMATIONAL TO TRUE        05370002
053800                   END-IF                                         05380002
053900               END-IF                                             05390002
054000           END-IF                                                 05400002
054100                                                                  05410002
054200           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   05420002
054300           MOVE 0 TO ASC-PROCESS-FLAG                             05430002
054400                                                                  05440002
054500       WHEN DP020-SRC-AID = DP016-ENTER                           05450002
054600           IF ASC-UPDATE                                          05460002
054700               SET ASC-EDIT TO TRUE                               05470002
054800* MAKE SHIPPING ATTRIBUTE CHANGES MSG                             05480006
054900               MOVE PC-TSYMSG-02617 TO DP020-MSG-NUMBER           05490002
055000               SET DP020-MSG-INFORMATIONAL TO TRUE                05500002
055100           END-IF                                                 05510002
055200           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   05520002
055300                                                                  05530002
055400       WHEN OTHER                                                 05540002
055500           SET DP013-NO-ROLLBACK                                  05550002
055600               DP013-XCTL-DISPLAY-RESTART                         05560002
055700               DP013-CICS-ABEND  TO TRUE                          05570002
055800           MOVE '2100-CHECK-FUNCTION-KEY'                         05580002
055900                                 TO DP013-PARAGRAPH               05590002
056000           MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'        05600002
056100                                 TO DP013-MESSAGE-TEXT (1)        05610002
056200           PERFORM DP013-0000-PROCESS-ABEND                       05620002
056300     END-EVALUATE.                                                05630002
056400                                                                  05640002
056500*----------------------------------------------------------------*05650002
056600* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*05660002
056700* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *05670002
056800* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *05680002
056900*----------------------------------------------------------------*05690002
057000 2200-MOVE-SCREEN-TO-COMMAREA.                                    05700002
057100                                                                  05710002
057200     SET PS-NO-SCR-CHG TO TRUE.                                   05720002
057300                                                                  05730002
057400     IF AUPSKUL > ZERO                                            05740002
057500         INITIALIZE ASC-SPECIFIC-COMMAREA                         05750002
057600         MOVE ZEROES TO ASC-SHIP-L-N                              05760010
057700                        ASC-SHIP-H-N                              05770010
057800                        ASC-SHIP-W-N                              05780010
057900                        ASC-SHIP-WT-N                             05790010
058000                        ASC-SHIP-SURCHARGE-N                      05800010
058100                        ASC-SHIP-COST-N                           05810010
058200         MOVE AUPSKUI TO ASC-SKU                                  05820002
058300         SET PS-SCR-CHG TO TRUE                                   05830002
058400         SET ASC-NEW-SKU TO TRUE                                  05840002
058500***                                                               05850018
058600*** DMH BEGIN - 4/17/2007                                         05860018
058700     ELSE                                                         05870019
058800         IF  ASC-SKU  >  SPACES                                   05880021
058900             CONTINUE                                             05890021
059000         ELSE                                                     05900021
059100             SET PS-ERROR                                         05910021
059200                 DP020-MSG-FATAL         TO TRUE                  05920021
059300             MOVE PC-TSYMSG-02616        TO DP020-MSG-NUMBER      05930021
059400             MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSKUA               05940021
059500             MOVE DP015-RED              TO AUPSKUC               05950021
059600             MOVE DP015-REVERSE          TO AUPSKUH               05960021
059700             MOVE -1                     TO AUPSKUL               05970021
059800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05980021
059900         END-IF                                                   05990021
060000*** DMH END   - 4/17/2007                                         06000018
060100***                                                               06010018
060200                                                                  06020018
060300     END-IF.                                                      06030002
060400     IF AUPDCL > ZERO                                             06040002
060500         MOVE AUPDCI TO ASC-DC                                    06050002
060600         SET PS-SCR-CHG TO TRUE                                   06060002
060700         SET ASC-NEW-SKU TO TRUE                                  06070003
060800*-----------------------------------------------------------------06080022
060900* VERIFY THAT DC NUMBER IS NUMERIC                                06090022
061000*-----------------------------------------------------------------06100022
061100         MOVE ASC-DC                  TO DP010I-UNEDITED-FIELD    06110022
061200         MOVE LENGTH OF ASC-DC        TO DP010I-MAXIMUM-DIGITS    06120022
061300         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  06130022
061400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06140022
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06151037
263627              USING DP010I-NUMERIC-EDIT-AREA                      06152037
061600         IF  DP010I-ERROR-DETECTED                                06160022
061700             SET PS-ERROR                                         06170022
061800                 DP020-MSG-FATAL         TO TRUE                  06180022
061900             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06190022
062000             MOVE DP015-UNP-ALP-BRT-OFF  TO AUPDCA                06200022
062100             MOVE DP015-RED              TO AUPDCC                06210022
062200             MOVE DP015-REVERSE          TO AUPDCH                06220022
062300             MOVE -1                     TO AUPDCL                06230022
062400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06240022
062500         ELSE                                                     06250022
062600             MOVE DP010I-NUMERIC-FIELD TO ASC-DC-N                06260022
062700             MOVE ASC-DC               TO AUPDCO                  06270022
062800         END-IF                                                   06280022
062900     END-IF.                                                      06290002
063000                                                                  06300002
063100     IF AUPSHSCL > ZERO                                           06310002
063200        MOVE AUPSHSCI  TO ASC-SHIP-SERV-CDE                       06320002
063300        SET PS-SCR-CHG TO TRUE                                    06330002
063400     END-IF.                                                      06340002
063500     IF AUPSHRCL > ZERO                                           06350002
063600        MOVE AUPSHRCI  TO ASC-SHIP-REST-CDE                       06360002
063700        SET PS-SCR-CHG TO TRUE                                    06370002
063800     END-IF.                                                      06380002
063900     IF AUPSHGCL > ZERO                                           06390002
064000        MOVE AUPSHGCI  TO ASC-SHIP-GRP-CDE                        06400002
064100        SET PS-SCR-CHG TO TRUE                                    06410002
064200     END-IF.                                                      06420002
GFTWRP*    IF AUPGIFTL > ZERO                                           06430033
GFTWRP*       MOVE AUPGIFTI  TO ASC-GIFT-WRAP                           06440033
GFTWRP*       SET PS-SCR-CHG TO TRUE                                    06450033
GFTWRP*    END-IF.                                                      06460033
064700     IF AUPSHFEL > ZERO                                           06470002
064800        MOVE AUPSHFEI  TO ASC-SHIP-SURCHARGE                      06480002
064900        SET PS-SCR-CHG TO TRUE                                    06490002
065000     END-IF.                                                      06500002
065100                                                                  06510002
065200*----------------------------------------------------------------*06520002
065300* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *06530002
065400* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *06540002
065500* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *06550002
065600*----------------------------------------------------------------*06560002
065700 3000-EDIT-DATA-IN-COMMAREA.                                      06570002
065800                                                                  06580002
065900     PERFORM 3200-RESET-ATTRIBUTES.                               06590002
066000                                                                  06600002
066100*EDIT SKU                                                         06610002
066200     IF ASC-SKU > SPACES                                          06620002
066300         CONTINUE                                                 06630002
066400     ELSE                                                         06640002
066500         SET PS-ERROR                                             06650002
066600             DP020-MSG-FATAL         TO TRUE                      06660002
066700* ENTER SKU NUMBER MSG                                            06670006
066800         MOVE PC-TSYMSG-02616        TO DP020-MSG-NUMBER          06680006
066900         MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSKUA                   06690002
067000         MOVE DP015-RED              TO AUPSKUC                   06700002
067100         MOVE DP015-REVERSE          TO AUPSKUH                   06710002
067200         MOVE -1                     TO AUPSKUL                   06720002
067300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06730002
067400     END-IF.                                                      06740002
067500                                                                  06750002
067600*EDIT DC                                                          06760002
067700     IF ASC-DC > SPACES                                           06770002
067800         CONTINUE                                                 06780002
067900     ELSE                                                         06790002
068000         MOVE '0870' TO ASC-DC                                    06800006
068100     END-IF.                                                      06810002
068200                                                                  06820002
068300                                                                  06830021
068400                                                                  06840021
068500*EDIT SHIPPING SERVICE                                            06850002
068600     MOVE ASC-SHIP-SERV-CDE TO DP010I-UNEDITED-FIELD.             06860002
068700     MOVE 4                 TO DP010I-MAXIMUM-DIGITS.             06870002
068800     MOVE 0                 TO DP010I-MAXIMUM-DECIMALS.           06880002
068900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     06890002
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06901037
263627          USING DP010I-NUMERIC-EDIT-AREA.                         06902037
069100     IF DP010I-ERROR-DETECTED                                     06910002
069200         SET PS-ERROR                                             06920002
069300             DP020-MSG-FATAL        TO TRUE                       06930002
069400         MOVE AUPSHSCI              TO ASC-SHIP-SERV-CDE          06940002
069500* MUST BE NUMERIC MSG                                             06950006
069600         MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER           06960002
069700         MOVE DP015-UNP-ALP-BRT-OFF TO AUPSHSCA                   06970002
069800         MOVE DP015-RED             TO AUPSHSCC                   06980002
069900         MOVE DP015-REVERSE         TO AUPSHSCH                   06990002
070000         MOVE -1                    TO AUPSHSCL                   07000002
070100     ELSE                                                         07010002
070200         MOVE DP010I-NUMERIC-FIELD  TO PV-ASC-SHIP-SERV-CDE       07020002
070300         MOVE PV-ASC-SHIP-SERV-CDE  TO ASC-SHIP-SERV-CDE          07030002
070400     END-IF.                                                      07040002
070500                                                                  07050002
070600     IF PV-ASC-SHIP-SERV-CDE NUMERIC                              07060002
070700       AND PV-ASC-SHIP-SERV-CDE POSITIVE                          07070002
070800       AND NOT DP010I-ERROR-DETECTED                              07080002
070900         PERFORM 4400-CHECK-SHIP-SERV-CDE                         07090002
071000         IF PS-WEBITM-ERROR                                       07100002
071100             SET PS-ERROR                                         07110002
071200                 DP020-MSG-FATAL         TO TRUE                  07120002
071300* INVALID VALUE(S) MSG                                            07130006
071400             MOVE PC-TSYMSG-02619        TO DP020-MSG-NUMBER      07140002
071500             MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHSCA              07150002
071600             MOVE DP015-RED              TO AUPSHSCC              07160002
071700             MOVE DP015-REVERSE          TO AUPSHSCH              07170002
071800             MOVE -1                     TO AUPSHSCL              07180002
071900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07190002
072000         END-IF                                                   07200002
072100     ELSE                                                         07210002
072200         SET PS-ERROR                                             07220002
072300             DP020-MSG-FATAL         TO TRUE                      07230002
072400* INVALID VALUE(S) MSG                                            07240006
072500         MOVE PC-TSYMSG-02619        TO DP020-MSG-NUMBER          07250002
072600         MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHSCA                  07260002
072700         MOVE DP015-RED              TO AUPSHSCC                  07270002
072800         MOVE DP015-REVERSE          TO AUPSHSCH                  07280002
072900         MOVE -1                     TO AUPSHSCL                  07290002
073000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07300002
073100     END-IF.                                                      07310002
073200                                                                  07320002
073300*EDIT SHIPPING RESTRICTIONS                                       07330002
073400     MOVE ASC-SHIP-REST-CDE          TO DP010I-UNEDITED-FIELD.    07340002
073500     MOVE 4                          TO DP010I-MAXIMUM-DIGITS.    07350002
073600     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  07360002
073700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07370002
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07381037
263627          USING DP010I-NUMERIC-EDIT-AREA.                         07382037
073900     IF DP010I-ERROR-DETECTED                                     07390002
074000         SET PS-ERROR                                             07400002
074100             DP020-MSG-FATAL         TO TRUE                      07410002
074200         MOVE AUPSHSCI               TO ASC-SHIP-REST-CDE         07420002
074300* MUST BE NUMERIC MSG                                             07430006
074400         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          07440002
074500         MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHRCA                  07450002
074600         MOVE DP015-RED              TO AUPSHRCC                  07460002
074700         MOVE DP015-REVERSE          TO AUPSHRCH                  07470002
074800         MOVE -1                     TO AUPSHRCL                  07480002
074900     ELSE                                                         07490002
075000         MOVE DP010I-NUMERIC-FIELD   TO PV-ASC-SHIP-REST-CDE      07500002
075100         MOVE PV-ASC-SHIP-REST-CDE   TO ASC-SHIP-REST-CDE         07510002
075200     END-IF.                                                      07520002
075300                                                                  07530002
075400     IF PV-ASC-SHIP-REST-CDE = +0                                 07540002
075500         MOVE 'NONE' TO ASC-DESC5                                 07550006
075600     ELSE                                                         07560002
075700         IF PV-ASC-SHIP-REST-CDE NUMERIC                          07570002
075800           AND PV-ASC-SHIP-REST-CDE POSITIVE                      07580002
075900           AND NOT DP010I-ERROR-DETECTED                          07590002
076000             PERFORM 4500-CHECK-SHIP-REST-CDE                     07600002
076100             IF PS-WEBITM-ERROR                                   07610002
076200                 SET PS-ERROR                                     07620002
076300                     DP020-MSG-FATAL         TO TRUE              07630002
076400* INVALID VALUE(S) MSG                                            07640006
076500                 MOVE PC-TSYMSG-02619        TO DP020-MSG-NUMBER  07650002
076600                 MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHRCA          07660002
076700                 MOVE DP015-RED              TO AUPSHRCC          07670002
076800                 MOVE DP015-REVERSE          TO AUPSHRCH          07680002
076900                 MOVE -1                     TO AUPSHRCL          07690002
077000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07700002
077100             END-IF                                               07710002
077200         ELSE                                                     07720002
077300             SET PS-ERROR                                         07730002
077400                 DP020-MSG-FATAL          TO TRUE                 07740002
077500* INVALID VALUE(S) MSG                                            07750006
077600             MOVE PC-TSYMSG-02619         TO DP020-MSG-NUMBER     07760002
077700             MOVE DP015-UNP-ALP-BRT-OFF   TO AUPSHRCA             07770005
077800             MOVE DP015-RED               TO AUPSHRCC             07780005
077900             MOVE DP015-REVERSE           TO AUPSHRCH             07790005
078000             MOVE -1                      TO AUPSHRCL             07800005
078100             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 07810002
078200         END-IF                                                   07820002
078300     END-IF.                                                      07830002
078400                                                                  07840002
078500*EDIT SHIPPING GROUP                                              07850002
078600     MOVE ASC-SHIP-GRP-CDE           TO DP010I-UNEDITED-FIELD.    07860002
078700     MOVE 4                          TO DP010I-MAXIMUM-DIGITS.    07870002
078800     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  07880002
078900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07890002
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07901037
263627          USING DP010I-NUMERIC-EDIT-AREA.                         07902037
079100     IF DP010I-ERROR-DETECTED                                     07910002
079200         SET PS-ERROR                                             07920002
079300             DP020-MSG-FATAL         TO TRUE                      07930002
079400         MOVE AUPSHGCI               TO ASC-SHIP-GRP-CDE          07940002
079500* MUST BE NUMERIC MSG                                             07950006
079600         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          07960002
079700         MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHGCA                  07970002
079800         MOVE DP015-RED              TO AUPSHGCC                  07980002
079900         MOVE DP015-REVERSE          TO AUPSHGCH                  07990002
080000         MOVE -1                     TO AUPSHGCL                  08000002
080100     ELSE                                                         08010002
080200         MOVE DP010I-NUMERIC-FIELD   TO PV-ASC-SHIP-GRP-CDE       08020002
080300         MOVE PV-ASC-SHIP-GRP-CDE    TO ASC-SHIP-GRP-CDE          08030002
080400     END-IF.                                                      08040002
080500                                                                  08050002
080600     IF PV-ASC-SHIP-GRP-CDE NUMERIC                               08060002
080700       AND PV-ASC-SHIP-GRP-CDE POSITIVE                           08070002
080800       AND NOT DP010I-ERROR-DETECTED                              08080002
080900         PERFORM 4600-CHECK-SHIP-GRP-CDE                          08090002
081000         IF PS-WEBITM-ERROR                                       08100002
081100             SET PS-ERROR                                         08110002
081200                 DP020-MSG-FATAL         TO TRUE                  08120002
081300* INVALID VALUE(S) MSG                                            08130006
081400             MOVE PC-TSYMSG-02619        TO DP020-MSG-NUMBER      08140002
081500             MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHGCA              08150002
081600             MOVE DP015-RED              TO AUPSHGCC              08160002
081700             MOVE DP015-REVERSE          TO AUPSHGCH              08170002
081800             MOVE -1                     TO AUPSHGCL              08180002
081900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08190002
082000         ELSE                                                     08200002
082100             CONTINUE                                             08210002
082200         END-IF                                                   08220002
082300     ELSE                                                         08230002
082400         SET PS-ERROR                                             08240002
082500             DP020-MSG-FATAL         TO TRUE                      08250002
082600* INVALID VALUE(S) MSG                                            08260006
082700         MOVE PC-TSYMSG-02619        TO DP020-MSG-NUMBER          08270002
082800         MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHGCA                  08280002
082900         MOVE DP015-RED              TO AUPSHGCC                  08290002
083000         MOVE DP015-REVERSE          TO AUPSHGCH                  08300002
083100         MOVE -1                     TO AUPSHGCL                  08310002
083200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08320002
083300     END-IF.                                                      08330002
083400                                                                  08340002
083500*EDIT GIFTWRAP INDICATOR                                          08350002
GFTWRP*    IF ASC-GIFT-WRAP = 'N'                                       08360033
GFTWRP*      OR ASC-GIFT-WRAP = 'Y'                                     08370033
GFTWRP*      OR ASC-GIFT-WRAP = ' '                                     08380033
GFTWRP*        IF ASC-GIFT-WRAP = ' '                                   08390033
GFTWRP*            MOVE 'N' TO ASC-GIFT-WRAP                            08400033
GFTWRP*        END-IF                                                   08410033
GFTWRP*    ELSE                                                         08420033
GFTWRP*        SET PS-ERROR                                             08430033
GFTWRP*            DP020-MSG-FATAL          TO TRUE                     08440033
084500* Y/N REQUIRED MSG                                                08450006
GFTWRP*        MOVE PC-TSYMSG-00349         TO DP020-MSG-NUMBER         08460033
GFTWRP*        MOVE DP015-UNP-ALP-BRT-OFF   TO AUPGIFTA                 08470033
GFTWRP*        MOVE DP015-RED               TO AUPGIFTC                 08480033
GFTWRP*        MOVE DP015-REVERSE           TO AUPGIFTH                 08490033
GFTWRP*        MOVE -1                      TO AUPGIFTL                 08500033
GFTWRP*        SET DP030-SET-CURSOR-APPL-1  TO TRUE                     08510033
GFTWRP*    END-IF.                                                      08520033
085300                                                                  08530002
085400*EDIT SURCHARGE                                                   08540002
085500     MOVE ASC-SHIP-SURCHARGE         TO DP010I-UNEDITED-FIELD.    08550002
085600     MOVE 5                          TO DP010I-MAXIMUM-DIGITS.    08560002
085700     MOVE 2                          TO DP010I-MAXIMUM-DECIMALS.  08570002
085800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     08580002
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             08591037
263627          USING DP010I-NUMERIC-EDIT-AREA.                         08592037
086000     IF DP010I-ERROR-DETECTED                                     08600002
086100         SET PS-ERROR                                             08610002
086200             DP020-MSG-FATAL         TO TRUE                      08620002
086300         MOVE AUPSHGCI               TO ASC-SHIP-SURCHARGE        08630002
086400* VALUES MUST BE NUMERIC - 999.99 MSG                             08640006
086500         MOVE PC-TSYMSG-02658        TO DP020-MSG-NUMBER          08650006
086600         MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHFEA                  08660002
086700         MOVE DP015-RED              TO AUPSHFEC                  08670002
086800         MOVE DP015-REVERSE          TO AUPSHFEH                  08680002
086900         MOVE -1                     TO AUPSHFEL                  08690002
087000     ELSE                                                         08700002
087100         MOVE DP010I-NUMERIC-FIELD   TO ASC-SHIP-SURCHARGE-N      08710002
087200                                        PV-ASC-SHIP-SURCHARGE     08720002
087300         MOVE ASC-SHIP-SURCHARGE-N   TO AUPSHFEO                  08730002
087400         MOVE AUPSHFEO               TO ASC-SHIP-SURCHARGE        08740002
087500     END-IF.                                                      08750002
087600                                                                  08760002
087700     IF PS-NO-ERROR                                               08770002
087800         MOVE -1                     TO AUPSKUL                   08780002
087900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08790002
088000     END-IF.                                                      08800002
088100                                                                  08810002
088200*---------------------------------------------------------------* 08820002
088300*                                                                 08830002
088400*---------------------------------------------------------------* 08840003
088500 3100-NEW-SKU.                                                    08850002
088600                                                                  08860002
088700     MOVE ASC-SKU TO PV-HOLD-SKU-NBR.                             08870014
088800     IF ASC-DC NOT > SPACES                                       08880004
088900         MOVE '0870' TO ASC-DC                                    08890004
089000     END-IF.                                                      08900004
089100     MOVE ASC-DC  TO PV-HOLD-DC-NBR.                              08910014
089200                                                                  08920014
089300     IF PV-HOLD-SKU-NBR > SPACES                                  08930009
089400         PERFORM 3110-GET-SKU-DC                                  08940014
089500         IF PS-NO-SKU-ERROR                                       08950014
089600           AND PS-NO-DC-ERROR                                     08960014
089700             PERFORM 3120-GET-VND-STYL                            08970014
089800         END-IF                                                   08980014
089900     END-IF.                                                      08990014
090000                                                                  09000003
090100     IF PV-HOLD-SKU-NBR > SPACES                                  09010014
090200         IF PS-SKU-ERROR                                          09020014
090300             SET PS-ERROR                                         09030014
090400                 DP020-MSG-FATAL         TO TRUE                  09040014
090500* SKU NOT FOUND MSG                                               09050014
090600             MOVE PC-TSYMSG-02618        TO DP020-MSG-NUMBER      09060014
090700             MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSKUA               09070014
090800             MOVE DP015-RED              TO AUPSKUC               09080014
090900             MOVE DP015-REVERSE          TO AUPSKUH               09090014
091000             MOVE -1                     TO AUPSKUL               09100014
091100         ELSE                                                     09110014
091200         IF PS-DC-ERROR                                           09120014
091300             SET PS-ERROR                                         09130004
091400                 DP020-MSG-FATAL         TO TRUE                  09140004
091500* LOCATION DOES NOT EXIST MSG                                     09150006
091600             MOVE PC-TSYMSG-02068        TO DP020-MSG-NUMBER      09160006
091700             MOVE DP015-UNP-ALP-BRT-OFF  TO AUPDCA                09170004
091800             MOVE DP015-RED              TO AUPDCC                09180013
091900             MOVE DP015-REVERSE          TO AUPDCH                09190013
092000             MOVE -1                     TO AUPDCL                09200004
092100         END-IF                                                   09210004
092200         END-IF                                                   09220014
092300     END-IF.                                                      09230009
092400                                                                  09240002
092500******************************************************************09250004
092600* SKU INFORMATION WILL BE OBTAINED FROM TSKXREF/XLT_SKU           09260004
092700* DC INFORMATION WILL BE OBTAINED FROM XLT_LOC                    09270004
092800******************************************************************09280004
092900 3110-GET-SKU-DC.                                                 09290014
093000                                                                  09300004
093100     MOVE PV-HOLD-SKU-NBR TO DK-SKU.                              09310004
093200                                                                  09320004
093300     EXEC SQL                                                     09330004
093400        SELECT A.DEPT_NBR                                         09340004
093500             , A.CL_NBR                                           09350004
093600             , A.SKU_SEQ_NBR                                      09360004
093700             , A.SKU_STAT_CDE                                     09370004
093800             , A.ITM_NBR                                          09380004
093900             , A.INTR_UPC_ID                                      09390004
094000             , A.DEPT                                             09400004
094100             , A.CLASS                                            09410004
094200             , A.SUBCLASS                                         09420004
094300             , A.SKU                                              09430004
094400             , B.STYL_ID                                          09440004
094500             , B.SKU_DESC                                         09450004
094600          INTO :SKXREF-DEPT-NBR                                   09460004
094700             , :SKXREF-CL-NBR                                     09470004
094800             , :SKXREF-SKU-SEQ-NBR                                09480004
094900             , :SKXREF-SKU-STAT-CDE                               09490004
095000             , :SKXREF-ITM-NBR                                    09500004
095100             , :SKXREF-INTR-UPC-ID                                09510004
095200             , :SKXREF-DEPT                                       09520004
095300             , :SKXREF-CLASS                                      09530004
095400             , :SKXREF-SUBCLASS                                   09540004
095500             , :SKXREF-SKU                                        09550004
095600             , :XLT00003-STYL-ID                                  09560004
095700             , :XLT00003-SKU-DESC                                 09570004
095800          FROM TSKXREF A                                          09580005
095900             , XLT_SKU B                                          09590005
096000         WHERE A.SKU         = :DK-SKU                            09600014
096100           AND B.INTR_UPC_ID = A.INTR_UPC_ID                      09610004
096200     END-EXEC.                                                    09620004
096300                                                                  09630004
096400     EVALUATE TRUE                                                09640004
096500       WHEN SQLCODE = ZERO                                        09650004
096600           SET PS-NO-SKU-ERROR       TO TRUE                      09660004
096700           MOVE SKXREF-DEPT-NBR      TO ASC-DEPT                  09670004
096800           MOVE SKXREF-CL-NBR        TO ASC-SUB-CLASS             09680004
096900           MOVE SKXREF-INTR-UPC-ID   TO ASC-UPC-N                 09690004
097000                                        DK-INTR-UPC-ID            09700004
097100           MOVE XLT00003-SKU-DESC    TO ASC-SKU-DESC              09710004
097200                                                                  09720004
097300       WHEN SQLCODE = +100                                        09730004
097400           SET PS-SKU-ERROR TO TRUE                               09740004
097500                                                                  09750004
097600       WHEN OTHER                                                 09760004
097700           MOVE '3110-GET-SKU-DC' TO DP013-PARAGRAPH              09770014
097800           MOVE 'TSKXREF SELECT'  TO DP013-MESSAGE-TEXT (1)       09780014
097900           MOVE SQLCA             TO DP013-SQLCA                  09790014
098000           MOVE 'TSKXREF'         TO DP013-DB2-TABLE-NAME (1)     09800014
098100           SET DP013-DB2-ABEND                                    09810004
098200               DP013-XCTL-DISPLAY-RESTART TO TRUE                 09820004
098300           PERFORM DP013-0000-PROCESS-ABEND                       09830004
098400     END-EVALUATE.                                                09840004
098500                                                                  09850004
098600                                                                  09860004
098700     MOVE PV-HOLD-DC-NBR TO DK-DC.                                09870004
098800                                                                  09880004
098900     EXEC SQL                                                     09890004
099000        SELECT LOC_NBR                                            09900004
099100             , LOC_TYP_CDE                                        09910004
099200             , LOC_NM                                             09920004
099300             , LOC_10_ABBR_NM                                     09930004
099400          INTO :XLT00010-LOC-NBR                                  09940004
099500             , :XLT00010-LOC-TYP-CDE                              09950004
099600             , :XLT00010-LOC-NM                                   09960004
099700             , :XLT00010-LOC-10-ABBR-NM                           09970004
099800          FROM XLT_LOC                                            09980004
099900         WHERE LOC_NBR = :DK-DC                                   09990004
100000     END-EXEC.                                                    10000004
100100                                                                  10010004
100200     EVALUATE TRUE                                                10020004
100300       WHEN SQLCODE = ZERO                                        10030004
100400           SET PS-NO-DC-ERROR           TO TRUE                   10040004
100500           MOVE XLT00010-LOC-10-ABBR-NM TO ASC-DC-DESC            10050004
100600                                                                  10060004
100700       WHEN SQLCODE = +100                                        10070004
100800           SET PS-DC-ERROR TO TRUE                                10080004
100900                                                                  10090004
101000       WHEN OTHER                                                 10100004
101100           MOVE '3110-GET-SKU-DC' TO DP013-PARAGRAPH              10110014
101200           MOVE 'XLT-LOC SELECT'  TO DP013-MESSAGE-TEXT (1)       10120014
101300           MOVE SQLCA             TO DP013-SQLCA                  10130014
101400           MOVE 'XLT_LOC'         TO DP013-DB2-TABLE-NAME (1)     10140014
101500           SET DP013-DB2-ABEND                                    10150004
101600               DP013-XCTL-DISPLAY-RESTART TO TRUE                 10160004
101700           PERFORM DP013-0000-PROCESS-ABEND                       10170004
101800     END-EVALUATE.                                                10180004
101900                                                                  10190004
102000***************************************************************** 10200004
102100 3120-GET-VND-STYL.                                               10210014
102200                                                                  10220004
102300     MOVE ASC-SKU TO DK-SKU.                                      10230004
102400*GET RESERVATION KEYS FROM VENDOR-STYLE TABLE.                    10240004
102500     EXEC SQL                                                     10250004
102600         SELECT STYL_ID                                           10260004
102700              , VS_ID                                             10270004
102800              , VS_NBR                                            10280004
102900              , ENT_ID                                            10290004
103000           INTO :XLT00004-STYL-ID                                 10300004
103100              , :XLT00004-VS-ID                                   10310004
103200              , :XLT00004-VS-NBR                                  10320004
103300              , :XLT00004-ENT-ID                                  10330004
103400           FROM XLT_VND_STYL                                      10340004
103500          WHERE STYL_ID    = :XLT00003-STYL-ID                    10350005
103600     END-EXEC.                                                    10360004
103700                                                                  10370004
103800     EVALUATE TRUE                                                10380004
103900       WHEN SQLCODE = ZERO                                        10390004
104000           SET PS-NO-STYL-ERROR TO TRUE                           10400004
104100           MOVE XLT00004-VS-ID    TO ASC-VS-ID                    10410004
104200           MOVE XLT00004-VS-NBR   TO ASC-VS-NBR                   10420004
104300           MOVE XLT00004-ENT-ID   TO ASC-ENT-ID                   10430004
104400                                                                  10440004
104500       WHEN SQLCODE = +100                                        10450004
104600           SET PS-STYL-ERROR TO TRUE                              10460004
104700                                                                  10470004
104800       WHEN OTHER                                                 10480004
104900           MOVE '3120-GET-VND-STYL' TO DP013-PARAGRAPH            10490014
105000           MOVE 'XLT-VND-STYLE '    TO DP013-MESSAGE-TEXT (1)     10500014
105100           MOVE SQLCA               TO DP013-SQLCA                10510014
105200           MOVE 'XLT00004'          TO DP013-DB2-TABLE-NAME (1)   10520014
105300           SET DP013-DB2-ABEND                                    10530004
105400               DP013-XCTL-DISPLAY-RESTART TO TRUE                 10540004
105500           PERFORM DP013-0000-PROCESS-ABEND                       10550004
105600     END-EVALUATE.                                                10560004
105700                                                                  10570004
105800*---------------------------------------------------------------* 10580004
105900*                                                                 10590002
106000*---------------------------------------------------------------* 10600003
106100 3200-RESET-ATTRIBUTES.                                           10610002
106200                                                                  10620002
106300     MOVE DP015-GREEN                TO AUPSKUC                   10630003
106400                                        AUPDCC.                   10640003
106500     MOVE DP015-UNDERLINE            TO AUPSKUH                   10650003
106600                                        AUPDCH.                   10660003
106700     MOVE -1                         TO AUPSKUL.                  10670002
106800     SET DP030-SET-CURSOR-APPL-1     TO TRUE.                     10680002
106900     MOVE DP015-UNP-ALP-NOR-OFF      TO AUPSKUA                   10690002
107000                                        AUPDCA                    10700003
107100                                        AUPSHSCA                  10710002
107200                                        AUPSHRCA                  10720002
107300                                        AUPSHGCA                  10730002
GFTWRP*                                       AUPGIFTA                  10740033
107500                                        AUPSHFEA.                 10750002
107600     MOVE DP015-GREEN                TO AUPSHSCC                  10760003
107700                                        AUPSHRCC                  10770002
107800                                        AUPSHGCC                  10780002
GFTWRP*                                       AUPGIFTC                  10790033
108000                                        AUPSHFEC.                 10800002
108100     MOVE DP015-UNDERLINE            TO AUPSKUH                   10810002
108200                                        AUPDCH                    10820003
108300                                        AUPSHSCH                  10830002
108400                                        AUPSHRCH                  10840002
108500                                        AUPSHGCH                  10850002
GFTWRP*                                       AUPGIFTH                  10860033
108700                                        AUPSHFEH.                 10870033
108800                                                                  10880002
108900*---------------------------------------------------------------* 10890002
109000*                                                                 10900002
109100*-JPL-----------------------------------------------------------* 10910014
109200 3300-PROTECT-FULL-SCR.                                           10920002
109300                                                                  10930002
109400* PRESS F15 TO CONFIRM UPDATE MSG                                 10940006
109500     MOVE PC-TSYMSG-01100          TO DP020-MSG-NUMBER.           10950002
109600     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       10960002
109700     SET ASC-UPDATE                TO TRUE.                       10970002
109800                                                                  10980002
109900*----------------------------------------------------------------*10990002
110000* BUILD THE INITIAL PANEL OF THE SCREEN AND POSITION THE CURSOR  *11000002
110100* AT SKU                                                         *11010002
110200*----------------------------------------------------------------*11020005
110300 4000-BUILD-INITIAL-PANEL.                                        11030002
110400                                                                  11040021
110500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         11050014
110600                                                                  11060014
110700     MOVE DP015-UNP-ALP-NOR-OFF    TO AUPSKUA                     11070002
110800                                      AUPDCA.                     11080003
110900     MOVE DP015-GREEN              TO AUPSKUC                     11090002
111000                                      AUPDCC.                     11100003
111100     MOVE DP015-UNDERLINE          TO AUPSKUH                     11110003
111200                                      AUPDCH.                     11120003
111300     MOVE DP015-HL-OFF             TO AUPSHSCH                    11130021
111400                                      AUPSHRCH                    11140021
111500                                      AUPSHGCH                    11150021
GFTWRP*                                     AUPGIFTH                    11160033
111700                                      AUPSHFEH.                   11170021
111800     MOVE DP015-PRO-NOR-OFF        TO AUPSHSCA                    11180003
111900                                      AUPSHRCA                    11190002
112000                                      AUPSHGCA                    11200002
GFTWRP*                                     AUPGIFTA                    11210033
112200                                      AUPSHFEA.                   11220002
112300     MOVE DP015-BLUE               TO AUPSHSCC                    11230003
112400                                      AUPSHRCC                    11240002
112500                                      AUPSHGCC                    11250002
GFTWRP*                                     AUPGIFTC                    11260033
112700                                      AUPSHFEC.                   11270002
112800     MOVE -1                       TO AUPSKUL.                    11280014
112900                                                                  11290002
113000     PERFORM 3100-NEW-SKU.                                        11300024
113100                                                                  11310002
113200     IF  PV-HOLD-SKU-NBR NOT > SPACES                             11320024
113300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     11330024
113400         SET ASC-NEW-SKU       TO TRUE                            11340024
113500                                                                  11350024
113600* ENTER SKU NUMBER MSG                                            11360029
113700                                                                  11370024
113800         MOVE PC-TSYMSG-02616  TO DP020-MSG-NUMBER                11380024
113900         SET DP020-MSG-INFORMATIONAL TO TRUE                      11390024
114000     ELSE                                                         11400024
114100         IF  PS-NO-SKU-ERROR  AND                                 11410024
114200             PS-NO-DC-ERROR                                       11420024
114300             PERFORM 4300-GET-WEB-SKU                             11430024
114400             IF  PS-NO-WEBITM-ERROR                               11440024
114500                 PERFORM 4800-MOVE-WEBITM-TO-ASC                  11450024
114600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11460024
114700             ELSE                                                 11470024
114800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11480024
114900                 SET ASC-NEW-SKU       TO TRUE                    11490024
115000                                                                  11500024
115100* WEB ATTRIBUTES FOR SKU NOT FOUND                                11510024
115200                                                                  11520024
115300                 MOVE PC-TSYMSG-03547  TO DP020-MSG-NUMBER        11530024
115400                 SET DP020-MSG-INFORMATIONAL TO TRUE              11540024
115500             END-IF                                               11550024
115600         END-IF                                                   11560024
115700     END-IF.                                                      11570024
115800                                                                  11580002
115900                                                                  11590024
116000*---------------------------------------------------------------* 11600005
116100* WEB SKU INFORMATION WILL BE OBTAINED FROM XLV_WEB_SKU           11610002
116200*---------------------------------------------------------------* 11620002
116300 4300-GET-WEB-SKU.                                                11630003
116400                                                                  11640002
116500     EXEC SQL                                                     11650004
116600        SELECT INTR_UPC_ID                                        11660004
116700             , ASRT_BEG_DTE                                       11670004
116800             , ASRT_END_DTE                                       11680004
116900             , STRG_AREA_SEQ_NBR                                  11690004
117000             , STRG_AREA_DESC                                     11700004
117100             , SHIP_WD_QTY                                        11710004
117200             , SHIP_DPTH_QTY                                      11720004
117300             , SHIP_HT_QTY                                        11730004
117400             , SHIP_WT_QTY                                        11740004
117500             , SHIP_DIM_SRC_CDE                                   11750004
117600             , PKG_SEQ_NBR                                        11760004
117700             , PKG_CDE_DESC                                       11770004
117800             , SHIP_RSTRC_SEQ_NBR                                 11780004
117900             , SHIP_RSTRC_DESC                                    11790004
118000             , GFT_WRAP_AVL_IND                                   11800004
118100             , PRD_GP_NBR                                         11810004
118200             , PRD_GP_IND                                         11820004
118300             , SHIP_SRCHG_FEE_AMT                                 11830004
118400             , SHIP_SRVC_SEQ_NBR                                  11840004
118500             , SHIP_SRVC_DESC                                     11850004
118600             , SHIP_GP_SEQ_NBR                                    11860004
118700             , SHIP_GP_DESC                                       11870004
118800             , EFF_BEG_TMST                                       11880004
118900             , HAZDS_IND                                          11890004
119000             , BRKBL_IND                                          11900004
119100             , GC_IND                                             11910004
119200             , SHIP_ALN_IND                                       11920004
119300          INTO :XLV00004-INTR-UPC-ID                              11930004
119400             , :XLV00004-ASRT-BEG-DTE                             11940004
119500             , :XLV00004-ASRT-END-DTE                             11950004
119600             , :XLV00004-STRG-AREA-SEQ-NBR                        11960004
119700             , :XLV00004-STRG-AREA-DESC                           11970004
119800             , :XLV00004-SHIP-WD-QTY                              11980004
119900             , :XLV00004-SHIP-DPTH-QTY                            11990004
120000             , :XLV00004-SHIP-HT-QTY                              12000004
120100             , :XLV00004-SHIP-WT-QTY                              12010004
120200             , :XLV00004-SHIP-DIM-SRC-CDE                         12020004
120300             , :XLV00004-PKG-SEQ-NBR                              12030004
120400             , :XLV00004-PKG-CDE-DESC                             12040004
120500             , :XLV00004-SHIP-RSTRC-SEQ-NBR                       12050004
120600             , :XLV00004-SHIP-RSTRC-DESC                          12060004
120700             , :XLV00004-GFT-WRAP-AVL-IND                         12070004
120800             , :XLV00004-PRD-GP-NBR                               12080004
120900             , :XLV00004-PRD-GP-IND                               12090004
121000             , :XLV00004-SHIP-SRCHG-FEE-AMT                       12100004
121100             , :XLV00004-SHIP-SRVC-SEQ-NBR                        12110004
121200             , :XLV00004-SHIP-SRVC-DESC                           12120004
121300             , :XLV00004-SHIP-GP-SEQ-NBR                          12130004
121400             , :XLV00004-SHIP-GP-DESC                             12140004
121500             , :XLV00004-EFF-BEG-TMST                             12150004
121600             , :XLV00004-HAZDS-IND                                12160004
121700             , :XLV00004-BRKBL-IND                                12170004
121800             , :XLV00004-GC-IND                                   12180004
121900             , :XLV00004-SHIP-ALN-IND                             12190004
122000          FROM XLV_WEB_SKU                                        12200005
122100         WHERE INTR_UPC_ID  = :DK-INTR-UPC-ID                     12210004
122200     END-EXEC.                                                    12220004
122300                                                                  12230004
122400     EVALUATE TRUE                                                12240004
122500       WHEN SQLCODE = ZERO                                        12250004
122600           SET PS-NO-WEBITM-ERROR TO TRUE                         12260004
122700           PERFORM 4310-GET-TWEBITM                               12270014
122800                                                                  12280004
122900       WHEN SQLCODE = +100                                        12290004
123000           SET PS-WEBITM-ERROR TO TRUE                            12300004
123100                                                                  12310004
123200       WHEN OTHER                                                 12320004
123300           MOVE '4300-GET-WEB-SKU' TO DP013-PARAGRAPH             12330004
123400           MOVE 'SELECT FROM XLV_WEB_SKU'                         12340004
123500                                   TO DP013-MESSAGE-TEXT (1)      12350004
123600           MOVE SQLCA              TO DP013-SQLCA                 12360004
123700           MOVE 'XLV00004'         TO DP013-DB2-TABLE-NAME (1)    12370004
123800           SET DP013-DB2-ABEND                                    12380004
123900               DP013-XCTL-DISPLAY-RESTART TO TRUE                 12390004
124000           PERFORM DP013-0000-PROCESS-ABEND                       12400004
124100     END-EVALUATE.                                                12410004
124200                                                                  12420004
124300*----------------------------------------------------------------*12430014
124400 4310-GET-TWEBITM.                                                12440014
124500                                                                  12450014
124600     EXEC SQL                                                     12460014
124700        SELECT INTR_UPC_ID                                        12470014
124800             , EFF_BEG_TMST                                       12480014
124900             , EFF_END_TMST                                       12490014
125000             , ASRT_BEG_DTE                                       12500014
125100             , ASRT_END_DTE                                       12510014
125200             , STRG_AREA_SEQ_NBR                                  12520014
125300             , SHIP_WD_QTY                                        12530014
125400             , SHIP_DPTH_QTY                                      12540014
125500             , SHIP_HT_QTY                                        12550014
125600             , SHIP_WT_QTY                                        12560014
125700             , SHIP_DIM_SRC_CDE                                   12570014
125800             , PKG_SEQ_NBR                                        12580014
125900             , SHIP_RSTRC_SEQ_NBR                                 12590014
126000             , GFT_WRAP_AVL_IND                                   12600014
126100             , PRD_GP_NBR                                         12610014
126200             , PRD_GP_IND                                         12620014
126300             , SHIP_SRCHG_FEE_AMT                                 12630014
126400             , SHIP_SRVC_SEQ_NBR                                  12640014
126500             , SHIP_GP_SEQ_NBR                                    12650014
126600             , CRE_BY_USR_ID                                      12660014
126700             , WEB_ITM_DLTD_IND                                   12670014
126800             , HAZDS_IND                                          12680014
126900             , BRKBL_IND                                          12690014
127000             , GC_IND                                             12700014
127100             , SHIP_ALN_IND                                       12710014
127200             , WEB_EXCLV_IND                                      12720031
127300          INTO :WEBITM-INTR-UPC-ID                                12730014
127400             , :WEBITM-EFF-BEG-TMST                               12740014
127500             , :WEBITM-EFF-END-TMST :PV-NULL-IND-1                12750014
127600             , :WEBITM-ASRT-BEG-DTE                               12760014
127700             , :WEBITM-ASRT-END-DTE                               12770014
127800             , :WEBITM-STRG-AREA-SEQ-NBR                          12780014
127900             , :WEBITM-SHIP-WD-QTY                                12790014
128000             , :WEBITM-SHIP-DPTH-QTY                              12800014
128100             , :WEBITM-SHIP-HT-QTY                                12810014
128200             , :WEBITM-SHIP-WT-QTY                                12820014
128300             , :WEBITM-SHIP-DIM-SRC-CDE                           12830014
128400             , :WEBITM-PKG-SEQ-NBR                                12840014
128500             , :WEBITM-SHIP-RSTRC-SEQ-NBR                         12850014
128600             , :WEBITM-GFT-WRAP-AVL-IND                           12860014
128700             , :WEBITM-PRD-GP-NBR                                 12870014
128800             , :WEBITM-PRD-GP-IND                                 12880014
128900             , :WEBITM-SHIP-SRCHG-FEE-AMT                         12890014
129000             , :WEBITM-SHIP-SRVC-SEQ-NBR                          12900014
129100             , :WEBITM-SHIP-GP-SEQ-NBR                            12910014
129200             , :WEBITM-CRE-BY-USR-ID                              12920014
129300             , :WEBITM-WEB-ITM-DLTD-IND                           12930014
129400             , :WEBITM-HAZDS-IND                                  12940014
129500             , :WEBITM-BRKBL-IND                                  12950014
129600             , :WEBITM-GC-IND                                     12960014
129700             , :WEBITM-SHIP-ALN-IND                               12970014
129800             , :WEBITM-WEB-EXCLV-IND                              12980031
129900          FROM TWEBITM                                            12990014
130000         WHERE INTR_UPC_ID  = :DK-INTR-UPC-ID                     13000014
130100           AND EFF_END_TMST IS NULL                               13010014
130200     END-EXEC.                                                    13020014
130300                                                                  13030014
130400     EVALUATE TRUE                                                13040014
130500       WHEN SQLCODE = ZERO                                        13050014
130600       WHEN SQLCODE = +100                                        13060014
130700           CONTINUE                                               13070014
130800                                                                  13080014
130900       WHEN OTHER                                                 13090014
131000           MOVE '4310-GET-TWEBITM' TO DP013-PARAGRAPH             13100014
131100           MOVE 'SELECT TWEBITM'   TO DP013-MESSAGE-TEXT (1)      13110014
131200           MOVE SQLCA              TO DP013-SQLCA                 13120014
131300           MOVE 'TWEBITM'          TO DP013-DB2-TABLE-NAME (1)    13130014
131400           SET DP013-DB2-ABEND                                    13140014
131500               DP013-XCTL-DISPLAY-RESTART TO TRUE                 13150014
131600           PERFORM DP013-0000-PROCESS-ABEND                       13160014
131700     END-EVALUATE.                                                13170014
131800                                                                  13180014
131900*----------------------------------------------------------------*13190014
132000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *13200014
132100*----------------------------------------------------------------*13210014
132200 4400-MOVE-COMMAREA-TO-SCREEN.                                    13220014
132300                                                                  13230014
132400     MOVE ASC-SKU              TO AUPSKUO.                        13240014
132500     MOVE ASC-DC               TO AUPDCO.                         13250014
132600     MOVE ASC-DC-DESC          TO AUPDCDO.                        13260014
132700     MOVE ASC-UPC-N            TO ED-ASC-UPC-ID.                  13270014
132800     MOVE ED-ASC-UPC-ID        TO AUPUPCO.                        13280014
132900                                                                  13290014
133000     MOVE ASC-DEPT             TO ASC-DISPLAY-DEPT.               13300014
133100     MOVE ASC-DISPLAY-DEPT     TO ADEPTO.                         13310014
133200     MOVE ASC-SUB-CLASS        TO ASC-DISPLAY-CLASS.              13320014
133300     MOVE ASC-DISPLAY-CLASS    TO ACLASO.                         13330014
133400     MOVE ASC-DISPLAY-EFF-DATE TO EFFDTEO.                        13340014
133500                                                                  13350014
133600     MOVE ASC-SKU-DESC         TO ASDESCO.                        13360014
133700                                                                  13370014
133800     MOVE ASC-SHIP-LENGTH      TO AUPSHLNO.                       13380014
133900     MOVE ASC-HAZARDOUS        TO AUPHAZO.                        13390014
134000     MOVE ASC-SHIP-WIDTH       TO AUPSHWDO.                       13400014
134100     MOVE ASC-BREAKABLE        TO AUPBRKO.                        13410014
134200     MOVE ASC-SHIP-HEIGHT      TO AUPSHHTO.                       13420014
134300     MOVE ASC-GIFT-CARD        TO AUPGCO.                         13430014
134400     MOVE ASC-SHIP-WEIGHT      TO AUPSHWTO.                       13440014
134500     MOVE ASC-SHIPALONE        TO AUPSAO.                         13450014
134600                                                                  13460014
134700     IF ASC-SKU = SPACES                                          13470014
134800       OR PV-ASC-SHIP-SERV-CDE < 0                                13480014
134900         MOVE ASC-SHIP-SERV-CDE    TO AUPSHSCO                    13490014
135000     ELSE                                                         13500014
135100         MOVE PV-ASC-SHIP-SERV-CDE TO ED-ASC-SHIP-SERV-CDE        13510014
135200         MOVE ED-ASC-SHIP-SERV-CDE TO AUPSHSCO                    13520014
135300     END-IF.                                                      13530014
135400     MOVE ASC-DESC4                TO AUPDSC4O.                   13540014
135500                                                                  13550014
135600     IF ASC-SKU = SPACES                                          13560014
135700       OR PV-ASC-SHIP-REST-CDE < 0                                13570014
135800         MOVE ASC-SHIP-REST-CDE    TO AUPSHRCO                    13580014
135900     ELSE                                                         13590014
136000         MOVE PV-ASC-SHIP-REST-CDE TO ED-ASC-SHIP-REST-CDE        13600014
136100         MOVE ED-ASC-SHIP-REST-CDE TO AUPSHRCO                    13610014
136200     END-IF.                                                      13620014
136300     MOVE ASC-DESC5                TO AUPDSC5O.                   13630014
136400                                                                  13640014
136500     IF ASC-SKU = SPACES                                          13650014
136600       OR PV-ASC-SHIP-GRP-CDE < 0                                 13660014
136700         MOVE ASC-SHIP-GRP-CDE     TO AUPSHGCO                    13670014
136800     ELSE                                                         13680014
136900         MOVE PV-ASC-SHIP-GRP-CDE  TO ED-ASC-SHIP-GRP-CDE         13690014
137000         MOVE ED-ASC-SHIP-GRP-CDE  TO AUPSHGCO                    13700014
137100     END-IF.                                                      13710014
137200     MOVE ASC-DESC6                TO AUPDSC6O.                   13720014
137300                                                                  13730014
137400     MOVE ASC-GIFT-WRAP            TO AUPGIFTO.                   13740014
137500                                                                  13750014
137600     IF ASC-SKU = SPACES                                          13760014
137700       OR PV-ASC-SHIP-SURCHARGE < 0                               13770014
137800         MOVE ASC-SHIP-SURCHARGE   TO AUPSHFEO                    13780014
137900     ELSE                                                         13790014
138000         MOVE PV-ASC-SHIP-SURCHARGE TO ED-ASC-SHIP-SURCHARGE      13800014
138100         MOVE ED-ASC-SHIP-SURCHARGE TO AUPSHFEO                   13810014
138200     END-IF.                                                      13820014
138300                                                                  13830014
138400     MOVE ASC-BOX-SIZE       TO AUPBOXO.                          13840014
138500     MOVE ASC-CONVEYABLE     TO AUPCONO.                          13850014
138600     MOVE ASC-SHIP-COST-N    TO AUPAMTO.                          13860014
138700     MOVE ASC-BAGGABLE       TO AUPBAGO.                          13870014
138800     MOVE ASC-PICK-LOC-TYPE  TO AUPTYPO.                          13880014
138900     MOVE ASC-SORT-CODE      TO AUPSRTO.                          13890014
139000                                                                  13900014
139100*---------------------------------------------------------------* 13910002
139200*                                                                 13920002
139300*---------------------------------------------------------------* 13930002
139400 4400-CHECK-SHIP-SERV-CDE.                                        13940002
139500                                                                  13950002
139600     SET PS-NO-WEBITM-ERROR TO TRUE.                              13960002
139700     MOVE ASC-SHIP-SERV-CDE TO VSCHVL-CHARTC-SEQ-NBR.             13970002
139800                                                                  13980002
139900     EXEC SQL                                                     13990002
140000        SELECT CHARTC_VAL_DESC                                    14000002
140100          INTO :VSCHVL-CHARTC-VAL-DESC                            14010002
140200          FROM TVSCHVL                                            14020002
140300         WHERE CHARTC_SEQ_NBR = :VSCHVL-CHARTC-SEQ-NBR            14030002
140400           AND STAT_CDE       = 'A'                               14040002
140500           AND CHARTC_CDE     = 13                                14050002
140600     END-EXEC.                                                    14060002
140700                                                                  14070002
140800     EVALUATE TRUE                                                14080002
140900       WHEN SQLCODE = ZERO                                        14090002
141000       WHEN SQLCODE = +100                                        14100002
141100       WHEN SQLCODE = -904                                        14110002
141200       WHEN SQLCODE = -913                                        14120002
141300           CONTINUE                                               14130002
141400       WHEN SQLWARN0 NOT = SPACES                                 14140002
141500       WHEN SQLCODE < ZERO                                        14150002
141600       WHEN SQLCODE > ZERO                                        14160002
141700           MOVE '4400-CHECK-SHIP-SERV-CDE'                        14170002
141800                          TO DP013-PARAGRAPH                      14180002
141900           MOVE 'CHECK SHIP SERVICE CODE'                         14190002
142000                          TO DP013-MESSAGE-TEXT (1)               14200002
142100           MOVE SQLCA     TO DP013-SQLCA                          14210002
142200           MOVE 'TVSCHVL' TO DP013-DB2-TABLE-NAME (1)             14220002
142300           SET DP013-DB2-ABEND                                    14230002
142400               DP013-XCTL-DISPLAY-RESTART TO TRUE                 14240002
142500           PERFORM DP013-0000-PROCESS-ABEND                       14250002
142600     END-EVALUATE.                                                14260002
142700                                                                  14270002
142800     IF SQLCODE = 0                                               14280002
142900         MOVE VSCHVL-CHARTC-VAL-DESC TO ASC-DESC4                 14290002
143000     ELSE                                                         14300002
143100         MOVE 'NOT FOUND' TO ASC-DESC4                            14310002
143200         SET PS-WEBITM-ERROR TO TRUE                              14320002
143300     END-IF.                                                      14330002
143400                                                                  14340002
143500*---------------------------------------------------------------* 14350002
143600*                                                                 14360002
143700*---------------------------------------------------------------* 14370002
143800 4500-CHECK-SHIP-REST-CDE.                                        14380002
143900                                                                  14390002
144000     SET PS-NO-WEBITM-ERROR TO TRUE.                              14400002
144100     MOVE ASC-SHIP-REST-CDE TO VSCHVL-CHARTC-SEQ-NBR.             14410002
144200     PERFORM                                                      14420002
144300       WITH TEST AFTER                                            14430002
144400        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      14440002
144500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14450002
144600            OR (SQLCODE = ZERO)                                   14460002
144700            OR (SQLCODE = +100))                                  14470002
144800         EXEC SQL                                                 14480002
144900            SELECT CHARTC_VAL_DESC                                14490002
145000              INTO :VSCHVL-CHARTC-VAL-DESC                        14500002
145100              FROM TVSCHVL                                        14510002
145200             WHERE CHARTC_SEQ_NBR = :VSCHVL-CHARTC-SEQ-NBR        14520002
145300               AND STAT_CDE       = 'A'                           14530002
145400               AND CHARTC_CDE     = 17                            14540002
145500         END-EXEC                                                 14550002
145600                                                                  14560002
145700         EVALUATE TRUE                                            14570002
145800           WHEN SQLCODE = ZERO                                    14580002
145900           WHEN SQLCODE = +100                                    14590002
146000           WHEN SQLCODE = -904                                    14600002
146100           WHEN SQLCODE = -913                                    14610002
146200               CONTINUE                                           14620002
146300           WHEN SQLWARN0 NOT = SPACES                             14630002
146400           WHEN SQLCODE < ZERO                                    14640002
146500           WHEN SQLCODE > ZERO                                    14650002
146600               MOVE '4500-CHECK-SHIP-REST-CDE'                    14660002
146700                              TO DP013-PARAGRAPH                  14670002
146800               MOVE 'CHECK SHIP RESTRICTION CODE'                 14680002
146900                              TO DP013-MESSAGE-TEXT (1)           14690002
147000               MOVE SQLCA     TO DP013-SQLCA                      14700002
147100               MOVE 'TVSCHVL' TO DP013-DB2-TABLE-NAME (1)         14710002
147200               SET DP013-DB2-ABEND                                14720002
147300                   DP013-XCTL-DISPLAY-RESTART TO TRUE             14730002
147400               PERFORM DP013-0000-PROCESS-ABEND                   14740002
147500         END-EVALUATE                                             14750002
147600     END-PERFORM.                                                 14760002
147700                                                                  14770002
147800     IF SQLCODE = 0                                               14780002
147900         MOVE VSCHVL-CHARTC-VAL-DESC TO ASC-DESC5                 14790002
148000     ELSE                                                         14800002
148100         IF SQLCODE = +100                                        14810002
148200             MOVE 'NOT FOUND' TO ASC-DESC5                        14820002
148300             SET PS-WEBITM-ERROR TO TRUE                          14830002
148400         ELSE                                                     14840002
148500             SET PS-WEBITM-ERROR TO TRUE                          14850002
148600         END-IF                                                   14860002
148700     END-IF.                                                      14870002
148800                                                                  14880002
148900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14890002
149000         MOVE '4500-CHECK-SHIP-REST-CDE'                          14900002
149100                        TO DP013-PARAGRAPH                        14910002
149200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14920002
149300                        TO DP013-MESSAGE-TEXT (1)                 14930002
149400         MOVE 'SHIP RESTRICTION CODE'                             14940002
149500                        TO DP013-MESSAGE-TEXT (2)                 14950002
149600         MOVE SQLCA     TO DP013-SQLCA                            14960002
149700         MOVE 'TVSCHVL' TO DP013-DB2-TABLE-NAME (1)               14970002
149800         SET DP013-DB2-ABEND                                      14980002
149900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   14990002
150000         PERFORM DP013-0000-PROCESS-ABEND                         15000002
150100     END-IF.                                                      15010002
150200                                                                  15020002
150300*---------------------------------------------------------------* 15030002
150400*                                                                 15040002
150500*---------------------------------------------------------------* 15050002
150600 4600-CHECK-SHIP-GRP-CDE.                                         15060002
150700                                                                  15070002
150800     SET PS-NO-WEBITM-ERROR TO TRUE.                              15080002
150900     MOVE ASC-SHIP-GRP-CDE TO VSCHVL-CHARTC-SEQ-NBR.              15090002
151000                                                                  15100002
151100     PERFORM                                                      15110002
151200       WITH TEST AFTER                                            15120002
151300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     15130002
151400           UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)             15140002
151500              OR (SQLCODE = ZERO)                                 15150002
151600              OR (SQLCODE = +100))                                15160002
151700         EXEC SQL                                                 15170002
151800            SELECT CHARTC_VAL_DESC                                15180002
151900              INTO :VSCHVL-CHARTC-VAL-DESC                        15190002
152000              FROM TVSCHVL                                        15200002
152100             WHERE CHARTC_SEQ_NBR = :VSCHVL-CHARTC-SEQ-NBR        15210002
152200               AND STAT_CDE       = 'A'                           15220002
152300               AND CHARTC_CDE     = 18                            15230002
152400         END-EXEC                                                 15240002
152500                                                                  15250002
152600         EVALUATE TRUE                                            15260002
152700           WHEN SQLCODE = ZERO                                    15270002
152800           WHEN SQLCODE = +100                                    15280002
152900           WHEN SQLCODE = -904                                    15290002
153000           WHEN SQLCODE = -913                                    15300002
153100               CONTINUE                                           15310002
153200                                                                  15320002
153300           WHEN SQLWARN0 NOT = SPACES                             15330002
153400           WHEN SQLCODE < ZERO                                    15340002
153500           WHEN SQLCODE > ZERO                                    15350002
153600               MOVE '4600-CHECK-SHIP-GRP-CDE'                     15360002
153700                              TO DP013-PARAGRAPH                  15370002
153800               MOVE 'CHECK SHIP GROUP CODE'                       15380002
153900                              TO DP013-MESSAGE-TEXT (1)           15390002
154000               MOVE SQLCA     TO DP013-SQLCA                      15400002
154100               MOVE 'TVSCHVL' TO DP013-DB2-TABLE-NAME (1)         15410002
154200               SET DP013-DB2-ABEND                                15420002
154300                   DP013-XCTL-DISPLAY-RESTART TO TRUE             15430002
154400               PERFORM DP013-0000-PROCESS-ABEND                   15440002
154500         END-EVALUATE                                             15450002
154600     END-PERFORM.                                                 15460002
154700                                                                  15470002
154800     IF SQLCODE = 0                                               15480002
154900         MOVE VSCHVL-CHARTC-VAL-DESC TO ASC-DESC6                 15490002
155000         IF ASC-DESC6(1:2) = 'DS'                                 15500002
155100             PERFORM 4650-VALIDATE-VENDOR                         15510002
155200         END-IF                                                   15520002
155300     ELSE                                                         15530002
155400         IF SQLCODE = +100                                        15540002
155500             MOVE 'NOT FOUND' TO ASC-DESC6                        15550002
155600             SET PS-WEBITM-ERROR TO TRUE                          15560002
155700         ELSE                                                     15570002
155800             SET PS-WEBITM-ERROR TO TRUE                          15580002
155900         END-IF                                                   15590002
156000     END-IF.                                                      15600002
156100                                                                  15610002
156200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15620002
156300         MOVE '4600-CHECK-SHIP-GRP-CDE'                           15630002
156400                                   TO DP013-PARAGRAPH             15640002
156500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     15650002
156600                                   TO DP013-MESSAGE-TEXT (1)      15660002
156700         MOVE 'SHIP GROUP CODE'    TO DP013-MESSAGE-TEXT (2)      15670002
156800         MOVE SQLCA                TO DP013-SQLCA                 15680002
156900         MOVE 'TVSCHVL'            TO DP013-DB2-TABLE-NAME (1)    15690002
157000         SET DP013-XCTL-DISPLAY-RESTART                           15700002
157100             DP013-DB2-ABEND       TO TRUE                        15710002
157200         PERFORM DP013-0000-PROCESS-ABEND                         15720002
157300     END-IF.                                                      15730002
157400                                                                  15740002
157500******************************************************************15750002
157600 4650-VALIDATE-VENDOR.                                            15760002
157700                                                                  15770002
157800     MOVE ASC-SKU TO DK-SKU.                                      15780002
157900*GET ENT-ID FOR SKU.                                              15790002
158000     EXEC SQL                                                     15800002
158100         SELECT ENT_ID                                            15810002
158200           INTO :XLT00004-ENT-ID                                  15820002
158300           FROM XLT_SKU A                                         15830002
158400              , XLT_VND_STYL B                                    15840002
158500          WHERE A.SKU_NBR    = :DK-SKU                            15850002
158600            AND B.STYL_ID    = A.STYL_ID                          15860002
158700     END-EXEC.                                                    15870002
158800                                                                  15880002
158900     EVALUATE TRUE                                                15890002
159000       WHEN SQLCODE = ZERO                                        15900002
159100           CONTINUE                                               15910002
159200                                                                  15920002
159300       WHEN SQLCODE = +100                                        15930002
159400           MOVE 999999 TO XLT00004-ENT-ID                         15940002
159500                                                                  15950002
159600       WHEN OTHER                                                 15960002
159700           SET DP013-DB2-ABEND  TO TRUE                           15970002
159800           SET DP013-ROLLBACK   TO TRUE                           15980002
159900           MOVE 'XLT00004'      TO DP013-DB2-TABLE-NAME (1)       15990002
160000           MOVE '4650-VALIDATE-VENDOR'                            16000002
160100                                TO DP013-PARAGRAPH                16010002
160200           MOVE SQLCA           TO DP013-SQLCA                    16020002
160300           MOVE 'SELECT ENT-ID' TO DP013-MESSAGE-TEXT(1)          16030002
160400           MOVE DK-SKU          TO DP013-MESSAGE-TEXT (2)         16040002
160500           PERFORM DP013-0000-PROCESS-ABEND                       16050002
160600     END-EVALUATE.                                                16060002
160700                                                                  16070002
160800     EXEC SQL                                                     16080002
160900         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 16090002
161000     END-EXEC.                                                    16100002
161100                                                                  16110004
161200*CHECK IF ENT-ID IS 'CONSUMER DIRECT SHIP ELIGIBLE' (CDS).        16120002
161300     EXEC SQL                                                     16130002
161400         SELECT ENT_ID                                            16140002
161500           INTO :VNT00001-ENT-ID                                  16150002
161600           FROM VNT_VND_CPBL                                      16160002
161700          WHERE ENT_ID       = :XLT00004-ENT-ID                   16170002
161800            AND VND_CPBL_CDE = 'CDS'                              16180002
161900            AND EFF_BEG_DTE <= :PV-CURRENT-DATE                   16190002
162000            AND EFF_END_DTE >= :PV-CURRENT-DATE                   16200002
162100     END-EXEC.                                                    16210002
162200                                                                  16220002
162300     EVALUATE TRUE                                                16230002
162400       WHEN SQLCODE = ZERO                                        16240002
162500           CONTINUE                                               16250002
162600                                                                  16260002
162700       WHEN SQLCODE = +100                                        16270002
162800           SET PS-ERROR                                           16280002
162900               DP020-MSG-FATAL         TO TRUE                    16290002
163000*UNABLE TO ASSIGN 'DS' TO SKU.  SKU'S VENDOR NOT A DIREC MSG      16300006
163100           MOVE PC-TSYMSG-03408        TO DP020-MSG-NUMBER        16310002
163200           MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSHGCA                16320002
163300           MOVE DP015-RED              TO AUPSHGCC                16330002
163400           MOVE DP015-REVERSE          TO AUPSHGCH                16340002
163500           MOVE -1                     TO AUPSHGCL                16350002
163600           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16360002
163700                                                                  16370002
163800       WHEN OTHER                                                 16380002
163900           SET DP013-DB2-ABEND  TO TRUE                           16390002
164000           SET DP013-ROLLBACK   TO TRUE                           16400002
164100           MOVE 'VNT00001'      TO DP013-DB2-TABLE-NAME (1)       16410002
164200           MOVE '4650-VALIDATE-VENDOR'                            16420002
164300                                TO DP013-PARAGRAPH                16430002
164400           MOVE SQLCA           TO DP013-SQLCA                    16440002
164500           MOVE 'VERIFY ENT-ID' TO DP013-MESSAGE-TEXT (1)         16450005
164600           MOVE DK-SKU          TO DP013-MESSAGE-TEXT (2)         16460002
164700           MOVE XLT00004-ENT-ID TO DP013-MESSAGE-TEXT (3)         16470002
164800           PERFORM DP013-0000-PROCESS-ABEND                       16480002
164900     END-EVALUATE.                                                16490002
165000                                                                  16500002
165100*---------------------------------------------------------------* 16510002
165200*                                                                 16520002
165300*---------------------------------------------------------------* 16530005
165400 4800-MOVE-WEBITM-TO-ASC.                                         16540002
165500                                                                  16550002
165600     MOVE XLV00004-EFF-BEG-TMST(6:2)    TO WS-EFF-MONTH.          16560005
165700     MOVE XLV00004-EFF-BEG-TMST(9:2)    TO WS-EFF-DAY.            16570005
165800     MOVE XLV00004-EFF-BEG-TMST(1:4)    TO WS-EFF-YEAR.           16580005
165900     MOVE WS-EFFECTIVE-DTE              TO EFFDTEO.               16590002
166000     MOVE EFFDTEO                       TO ASC-DISPLAY-EFF-DATE.  16600002
166100                                                                  16610002
166200     MOVE XLV00004-SHIP-DPTH-QTY        TO PV-NUMERIC-4V3.        16620011
166300     MOVE PV-NUMERIC-4V3                TO ASC-SHIP-L-N.          16630011
166400     MOVE XLV00004-HAZDS-IND            TO ASC-HAZARDOUS.         16640005
166500                                                                  16650002
166600     MOVE XLV00004-SHIP-WD-QTY          TO PV-NUMERIC-4V3.        16660011
166700     MOVE PV-NUMERIC-4V3                TO ASC-SHIP-W-N.          16670011
166800     MOVE XLV00004-BRKBL-IND            TO ASC-BREAKABLE.         16680005
166900                                                                  16690005
167000     MOVE XLV00004-SHIP-HT-QTY          TO PV-NUMERIC-4V3.        16700011
167100     MOVE PV-NUMERIC-4V3                TO ASC-SHIP-H-N.          16710011
167200     MOVE XLV00004-GC-IND               TO ASC-GIFT-CARD.         16720005
167300                                                                  16730002
167400     MOVE XLV00004-SHIP-WT-QTY          TO PV-NUMERIC-4V3.        16740011
167500     MOVE PV-NUMERIC-4V3                TO ASC-SHIP-WT-N.         16750011
167600     MOVE XLV00004-SHIP-ALN-IND         TO ASC-SHIPALONE.         16760005
167700                                                                  16770002
167800     MOVE XLV00004-SHIP-SRVC-SEQ-NBR    TO ASC-SHIP-SERV-CDE.     16780005
167900     MOVE XLV00004-SHIP-SRVC-DESC       TO ASC-DESC4.             16790005
168000     MOVE XLV00004-SHIP-RSTRC-SEQ-NBR   TO ASC-SHIP-REST-CDE.     16800005
168100     MOVE XLV00004-SHIP-RSTRC-DESC      TO ASC-DESC5.             16810005
168200     MOVE XLV00004-SHIP-GP-SEQ-NBR      TO ASC-SHIP-GRP-CDE.      16820005
168300     MOVE XLV00004-SHIP-GP-DESC         TO ASC-DESC6.             16830005
168400     MOVE XLV00004-GFT-WRAP-AVL-IND     TO ASC-GIFT-WRAP.         16840005
168500     MOVE XLV00004-SHIP-SRCHG-FEE-AMT   TO PV-NUMERIC-3V2.        16850011
168600     MOVE PV-NUMERIC-3V2                TO ASC-SHIP-SURCHARGE-N.  16860011
168700                                                                  16870002
168800     PERFORM 4810-MOVE-DC-ATTR-TO-ASC.                            16880005
168900                                                                  16890005
169000***************************************************************** 16900005
169100 4810-MOVE-DC-ATTR-TO-ASC.                                        16910005
169200                                                                  16920005
169300     EXEC SQL                                                     16930005
169400         SELECT INTR_UPC_ID                                       16940005
169500              , DC_NBR                                            16950005
169600              , EFF_BEG_TMST                                      16960005
169700              , EFF_END_TMST                                      16970005
169800              , AUTO_SORT_CDE                                     16980005
169900              , SORT_BOX_SZ_DESC                                  16990005
170000              , PICK_LOC_TYP_CDE                                  17000005
170100              , CNVYB_IND                                         17010005
170200              , BAGBL_IND                                         17020005
170300              , SHIP_COST_AMT                                     17030005
170400           INTO :IMT00024-INTR-UPC-ID                             17040005
170500              , :IMT00024-DC-NBR                                  17050005
170600              , :IMT00024-EFF-BEG-TMST                            17060005
170700              , :IMT00024-EFF-END-TMST :PV-NULL-IND-1             17070012
170800              , :IMT00024-AUTO-SORT-CDE                           17080005
170900              , :IMT00024-SORT-BOX-SZ-DESC :PV-NULL-IND-2         17090012
171000              , :IMT00024-PICK-LOC-TYP-CDE :PV-NULL-IND-3         17100012
171100              , :IMT00024-CNVYB-IND                               17110005
171200              , :IMT00024-BAGBL-IND                               17120005
171300              , :IMT00024-SHIP-COST-AMT :PV-NULL-IND-4            17130012
171400           FROM IMT_ITM_DC_ASSN                                   17140005
171500          WHERE INTR_UPC_ID  = :DK-INTR-UPC-ID                    17150005
171600            AND DC_NBR       = :DK-DC                             17160005
171700            AND EFF_END_TMST IS NULL                              17170012
171800     END-EXEC.                                                    17180005
171900                                                                  17190005
172000     EVALUATE TRUE                                                17200005
172100       WHEN SQLCODE = ZERO                                        17210005
172200           MOVE IMT00024-SORT-BOX-SZ-DESC TO ASC-BOX-SIZE         17220005
172300           MOVE IMT00024-CNVYB-IND        TO ASC-CONVEYABLE       17230005
172400           MOVE IMT00024-SHIP-COST-AMT    TO PV-NUMERIC-3V2       17240011
172500           MOVE PV-NUMERIC-3V2            TO ASC-SHIP-COST-N      17250011
172600           MOVE IMT00024-BAGBL-IND        TO ASC-BAGGABLE         17260005
172700           MOVE IMT00024-PICK-LOC-TYP-CDE TO ASC-PICK-LOC-TYPE    17270005
172800           MOVE IMT00024-AUTO-SORT-CDE    TO ASC-SORT-CODE        17280005
172900                                                                  17290005
173000       WHEN SQLCODE = +100                                        17300005
173100           MOVE SPACES                    TO ASC-BOX-SIZE         17310005
173200           MOVE SPACES                    TO ASC-CONVEYABLE       17320005
173300           MOVE '   .00'                  TO ASC-SHIP-COST        17330005
173400           MOVE SPACES                    TO ASC-BAGGABLE         17340005
173500           MOVE SPACES                    TO ASC-PICK-LOC-TYPE    17350005
173600           MOVE SPACES                    TO ASC-SORT-CODE        17360005
173700           MOVE PC-TSYMSG-03551           TO DP020-MSG-NUMBER     17370012
173800                                                                  17380005
173900       WHEN OTHER                                                 17390005
174000           SET DP013-DB2-ABEND    TO TRUE                         17400005
174100           SET DP013-ROLLBACK     TO TRUE                         17410005
174200           MOVE 'IMT00024'        TO DP013-DB2-TABLE-NAME (1)     17420005
174300           MOVE '4810-MOVE-DC-ATTR-TO-ASC'                        17430005
174400                                  TO DP013-PARAGRAPH              17440005
174500           MOVE SQLCA             TO DP013-SQLCA                  17450005
174600           MOVE 'IMT_ITM_DC_ASSN' TO DP013-MESSAGE-TEXT (1)       17460005
174700           MOVE DK-SKU            TO DP013-MESSAGE-TEXT (2)       17470005
174800           PERFORM DP013-0000-PROCESS-ABEND                       17480005
174900     END-EVALUATE.                                                17490005
175000                                                                  17500005
175100*---------------------------------------------------------------* 17510002
175200*                                                                 17520002
175300*---------------------------------------------------------------* 17530002
175400 5000-CHECK-IF-UPDATE.                                            17540002
175500                                                                  17550002
175600     IF XL001-SHIP-SRVC-SEQ-NBR     = PV-ASC-SHIP-SERV-CDE        17560002
175700       AND XL001-SHIP-RSTRC-SEQ-NBR = PV-ASC-SHIP-REST-CDE        17570002
175800       AND XL001-SHIP-GP-SEQ-NBR    = PV-ASC-SHIP-GRP-CDE         17580002
GFTWRP*      AND XL001-GFT-WRAP-AVL-IND   = ASC-GIFT-WRAP               17590033
176000       AND XL001-SHIP-SRCHG-FEE-AMT = PV-ASC-SHIP-SURCHARGE       17600002
176100         SET PS-NO-UPDATE-OCCUR TO TRUE                           17610002
176200     ELSE                                                         17620002
176300         SET PS-UPDATE-OCCUR    TO TRUE                           17630002
176400     END-IF.                                                      17640002
176500                                                                  17650002
176600******************************************************************17660002
176700* 6100-INSERT-TVSRSVN.                                            17670002
176800*  ==> PROCESSES:                                                 17680002
176900*    - INSERTS A ROW INTO TVSRSVN TO RESERVE THE CURRENT SKU     *17690002
177000*    - JUST WHILE TWEBITM IS BEING UPDATED BY THIS PROGRAM.       17700002
177100*    - THIS SHOULD PROHIBIT THE USERS FROM UPDATING THE SAME     *17710002
177200*    - SKU WITH ANOTHER ON-LINE PROCESS AT THE SAME TIME.         17720002
177300******************************************************************17730002
177400 6100-INSERT-TVSRSVN.                                             17740002
177500                                                                  17750002
177600     INITIALIZE PV-RETRY-COUNTER.                                 17760002
177700                                                                  17770002
177800     MOVE ASC-ENT-ID TO VSRSVN-ENT-ID.                            17780002
177900     MOVE ASC-VS-NBR TO VSRSVN-VS-NBR.                            17790002
178000     MOVE ASC-VS-ID  TO VSRSVN-VS-ID.                             17800002
178100                                                                  17810002
178200     PERFORM  WITH TEST AFTER                                     17820002
178300       UNTIL SQLCODE = ZERO OR SQLCODE = +100                     17830002
178400         OR PV-RETRY-COUNTER > PC-MAX-RETRIES                     17840002
178500                                                                  17850002
178600         EXEC SQL                                                 17860002
178700             INSERT INTO TVSRSVN                                  17870002
178800                     (ENT_ID                                      17880002
178900                     ,VS_NBR                                      17890002
179000                     ,VS_ID                                       17900002
179100                     ,RSRV_TYP_CDE                                17910002
179200                     ,SKU_STRGY_CDE                               17920002
179300                     ,DEPT_MDSEAR_ID                              17930002
179400                     ,MAJ_CL_MDSEAR_ID                            17940002
179500                     ,SUB_CL_MDSEAR_ID                            17950002
179600                     ,RSRV_BY_USR_ID                              17960002
179700                     ,RSRV_TMST)                                  17970002
179800             VALUES (:VSRSVN-ENT-ID,                              17980002
179900                     :VSRSVN-VS-NBR,                              17990002
180000                     :VSRSVN-VS-ID,                               18000002
180100                      'M',                                        18010002
180200                      ' ',                                        18020002
180300                      0.0,                                        18030002
180400                      0.0,                                        18040002
180500                      0.0,                                        18050002
180600                     :PC-CURRENT-PROGRAM-NAME,                    18060002
180700                      CURRENT TIMESTAMP)                          18070002
180800         END-EXEC                                                 18080002
180900                                                                  18090002
181000         EVALUATE TRUE                                            18100002
181100           WHEN SQLCODE = ZERO                                    18110002
181200           WHEN SQLCODE = +100                                    18120002
181300              CONTINUE                                            18130002
181400           WHEN SQLCODE = -911                                    18140002
181500           WHEN SQLCODE = -913                                    18150002
181600               ADD 1 TO PV-RETRY-COUNTER                          18160002
181700           WHEN SQLCODE = -803                                    18170002
181800               SET DP013-DB2-ABEND TO TRUE                        18180002
181900               SET DP013-ROLLBACK  TO TRUE                        18190002
182000               MOVE 'TVSRSVN' TO DP013-DB2-TABLE-NAME (1)         18200002
182100               MOVE '6100-INSERT-TVSRSVN'                         18210002
182200                                   TO DP013-PARAGRAPH             18220002
182300               MOVE SQLCA          TO DP013-SQLCA                 18230002
182400               MOVE 'INSERT TVSRSVN      '                        18240002
182500                                   TO DP013-MESSAGE-TEXT(1)       18250002
182600               MOVE XL001-ENT-ID   TO DP013-MESSAGE-TEXT (2)      18260002
182700               MOVE XL001-VS-NBR   TO DP013-MESSAGE-TEXT (3)      18270002
182800               PERFORM DP013-0000-PROCESS-ABEND                   18280002
182900           WHEN OTHER                                             18290002
183000               SET DP013-DB2-ABEND TO TRUE                        18300002
183100               SET DP013-ROLLBACK  TO TRUE                        18310002
183200               MOVE 'TVSRSVN'      TO DP013-DB2-TABLE-NAME (1)    18320002
183300               MOVE '6100-INSERT-TVSRSVN'                         18330002
183400                                   TO DP013-PARAGRAPH             18340002
183500                 MOVE SQLCA        TO DP013-SQLCA                 18350002
183600                 MOVE 'INSERT TVSRSVN      '                      18360002
183700                                   TO DP013-MESSAGE-TEXT(1)       18370002
183800                 MOVE XL001-ENT-ID TO DP013-MESSAGE-TEXT (2)      18380002
183900                 MOVE XL001-VS-NBR TO DP013-MESSAGE-TEXT (3)      18390002
184000                 PERFORM DP013-0000-PROCESS-ABEND                 18400002
184100         END-EVALUATE                                             18410002
184200     END-PERFORM.                                                 18420002
184300                                                                  18430002
184400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         18440002
184500         SET DP013-DB2-ABEND TO TRUE                              18450002
184600         SET DP013-ROLLBACK  TO TRUE                              18460002
184700         MOVE 'TVSRSVN'      TO DP013-DB2-TABLE-NAME (1)          18470002
184800         MOVE '6100-INSERT-TVSRSVN'                               18480002
184900                             TO DP013-PARAGRAPH                   18490002
185000         MOVE SQLCA          TO DP013-SQLCA                       18500002
185100         MOVE 'INSERT TVSRSVN      '                              18510002
185200                             TO DP013-MESSAGE-TEXT(1)             18520002
185300         MOVE XL001-ENT-ID   TO DP013-MESSAGE-TEXT (2)            18530002
185400         MOVE XL001-VS-NBR   TO DP013-MESSAGE-TEXT (3)            18540002
185500         PERFORM DP013-0000-PROCESS-ABEND                         18550002
185600     END-IF.                                                      18560002
185700                                                                  18570002
185800******************************************************************18580002
185900* 6200-DELETE-TVSRSVN.                                            18590002
186000*  ==> PROCESSES:                                                 18600002
186100*    - DELETE THE CURRENT SKU RESERVATION FROM TVSRSVN TO RELEASE*18610002
186200*    - THE SKU AND MAKE IT AVAILABLE FOR ANY UPDATING THAT MAY   *18620002
186300*    - BE NECESSARY BY USERS USING OTHER ON-LINE PROCESSES.       18630002
186400******************************************************************18640002
186500 6200-DELETE-TVSRSVN.                                             18650002
186600                                                                  18660002
186700     INITIALIZE PV-RETRY-COUNTER.                                 18670002
186800                                                                  18680002
186900     PERFORM  WITH TEST AFTER                                     18690002
187000       UNTIL SQLCODE = ZERO OR SQLCODE = +100                     18700002
187100         OR PV-RETRY-COUNTER > PC-MAX-RETRIES                     18710002
187200                                                                  18720002
187300         EXEC SQL                                                 18730002
187400             DELETE FROM TVSRSVN                                  18740002
187500             WHERE (VS_ID  = :VSRSVN-VS-ID)                       18750003
187600               AND (VS_NBR = :VSRSVN-VS-NBR)                      18760003
187700               AND (ENT_ID = :VSRSVN-ENT-ID)                      18770003
187800         END-EXEC                                                 18780002
187900                                                                  18790002
188000         EVALUATE TRUE                                            18800002
188100           WHEN SQLCODE = ZERO                                    18810002
188200           WHEN SQLCODE = +100                                    18820002
188300               CONTINUE                                           18830002
188400           WHEN SQLCODE = -911                                    18840002
188500           WHEN SQLCODE = -913                                    18850002
188600               ADD +1 TO PV-RETRY-COUNTER                         18860002
188700           WHEN OTHER                                             18870002
188800               SET DP013-DB2-ABEND TO TRUE                        18880002
188900               SET DP013-ROLLBACK  TO TRUE                        18890002
189000               MOVE 'TVSRSVN'      TO DP013-DB2-TABLE-NAME (1)    18900002
189100               MOVE '6200-DELETE-TVSRSVN'                         18910002
189200                                   TO DP013-PARAGRAPH             18920002
189300               MOVE SQLCA          TO DP013-SQLCA                 18930002
189400               MOVE 'DELETE TVSRSVN      '                        18940002
189500                                   TO DP013-MESSAGE-TEXT(1)       18950002
189600               MOVE XL001-ENT-ID   TO DP013-MESSAGE-TEXT (2)      18960002
189700               MOVE XL001-VS-NBR   TO DP013-MESSAGE-TEXT (3)      18970002
189800               PERFORM DP013-0000-PROCESS-ABEND                   18980002
189900         END-EVALUATE                                             18990002
190000     END-PERFORM.                                                 19000002
190100                                                                  19010002
190200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         19020002
190300         SET DP013-DB2-ABEND     TO TRUE                          19030002
190400         SET DP013-ROLLBACK      TO TRUE                          19040002
190500         MOVE 'TVSRSVN'          TO DP013-DB2-TABLE-NAME (1)      19050002
190600         MOVE '6200-DELETE-TVSRSVN'                               19060002
190700                                 TO DP013-PARAGRAPH               19070002
190800         MOVE SQLCA              TO DP013-SQLCA                   19080002
190900         MOVE 'DELETE TVSRSVN      '                              19090002
191000                                 TO DP013-MESSAGE-TEXT(1)         19100002
191100         MOVE XL001-ENT-ID       TO DP013-MESSAGE-TEXT (2)        19110002
191200         MOVE XL001-VS-NBR       TO DP013-MESSAGE-TEXT (3)        19120002
191300         PERFORM DP013-0000-PROCESS-ABEND                         19130002
191400     END-IF.                                                      19140002
191500                                                                  19150002
191600*---------------------------------------------------------------* 19160002
191700*  UPDATE AN EXISTING ROW ON TWEBITM BEFORE INSERTING THE NEW ONE 19170002
191800*---------------------------------------------------------------* 19180002
191900 7200-UPDATE-TWEBITM.                                             19190002
192000                                                                  19200002
192100* CONTINUE TO TRY UPDATING UNTIL SUCCESSFUL...IF -803 SQLCODE,    19210002
192200* RETRY WITH THE NEW TIMESTAMP (PART OF THE KEY)                  19220002
192300     PERFORM   WITH TEST AFTER                                    19230002
192400       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       19240002
192500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19250002
192600               OR (SQLCODE = ZERO))                               19260002
192700                                                                  19270002
192800         EXEC SQL                                                 19280002
192900             UPDATE TWEBITM                                       19290002
193000                SET EFF_END_TMST   = CURRENT TIMESTAMP            19300002
193100              WHERE INTR_UPC_ID    = :DK-INTR-UPC-ID              19310013
193200                AND EFF_END_TMST     IS NULL                      19320002
193300         END-EXEC                                                 19330002
193400                                                                  19340002
193500         EVALUATE TRUE                                            19350002
193600           WHEN SQLCODE = ZERO                                    19360002
193700               CONTINUE                                           19370002
193800                                                                  19380002
193900           WHEN SQLCODE = -803                                    19390002
194000               CONTINUE                                           19400002
194100                                                                  19410002
194200           WHEN OTHER                                             19420002
194300               MOVE '7200-UPDATE-TWEBITM' TO DP013-PARAGRAPH      19430002
194400               MOVE 'UPDATE TWEBITM'      TO DP013-MESSAGE-TEXT(1)19440013
194500               MOVE WEBITM-EFF-END-TMST   TO DP013-MESSAGE-TEXT(2)19450013
194600               MOVE SQLCA                 TO DP013-SQLCA          19460013
194700               MOVE 'TWEBITM' TO DP013-DB2-TABLE-NAME(1)          19470013
194800               SET DP013-DB2-ABEND        TO TRUE                 19480013
194900               SET DP013-ROLLBACK         TO TRUE                 19490013
195000               SET DP013-XCTL-DISPLAY-RESTART                     19500013
195100                                          TO TRUE                 19510002
195200               PERFORM DP013-0000-PROCESS-ABEND                   19520013
195300         END-EVALUATE                                             19530002
195400     END-PERFORM.                                                 19540002
195500                                                                  19550002
195600*---------------------------------------------------------------* 19560002
195700* INSERT A NEW ROW INTO TWEBITM                                   19570002
195800*---------------------------------------------------------------* 19580002
195900 7300-INSERT-TWEBITM.                                             19590002
196000                                                                  19600002
196100* CONTINUE TO TRY INSERTING UNTIL SUCCESSFUL...IF -803 SQLCODE,   19610002
196200* RETRY WITH THE NEW TIMESTAMP (PART OF THE KEY)                  19620002
196300     PERFORM   WITH TEST AFTER                                    19630002
196400       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       19640002
196500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19650002
196600               OR (SQLCODE = ZERO))                               19660002
196700*JPL                                                              19670028
196800         MOVE PV-ASC-SHIP-REST-CDE   TO WEBITM-SHIP-RSTRC-SEQ-NBR 19680013
196900         IF PV-ASC-SHIP-REST-CDE = 1                              19690028
197000             MOVE 'Y' TO WEBITM-HAZDS-IND                         19700028
197100         ELSE                                                     19710028
197200             MOVE 'N' TO WEBITM-HAZDS-IND                         19720028
197300         END-IF                                                   19730028
197400         MOVE PV-ASC-SHIP-SERV-CDE   TO WEBITM-SHIP-SRVC-SEQ-NBR  19740013
197500         MOVE PV-ASC-SHIP-SURCHARGE  TO WEBITM-SHIP-SRCHG-FEE-AMT 19750013
197600         MOVE PV-ASC-SHIP-GRP-CDE    TO WEBITM-SHIP-GP-SEQ-NBR    19760028
197700         IF PV-ASC-SHIP-GRP-CDE = 2                               19770030
197800             MOVE 'Y' TO WEBITM-SHIP-ALN-IND                      19780030
197900         ELSE                                                     19790030
198000             MOVE 'N' TO WEBITM-SHIP-ALN-IND                      19800030
198100         END-IF                                                   19810030
198200         IF PV-ASC-SHIP-GRP-CDE = 4                               19820030
198300             MOVE 'Y' TO WEBITM-BRKBL-IND                         19830028
198400         ELSE                                                     19840028
198500             MOVE 'N' TO WEBITM-BRKBL-IND                         19850028
198600         END-IF                                                   19860028
198700         IF PV-ASC-SHIP-GRP-CDE = 6                               19870030
198800             MOVE 'Y' TO WEBITM-GC-IND                            19880028
198900         ELSE                                                     19890028
199000             MOVE 'N' TO WEBITM-GC-IND                            19900028
199100         END-IF                                                   19910028
199200                                                                  19920002
GFTWRP* SINCE WE NO LONGER OFFER GIFT WRAP SERVICE, ALWAYS SET          19921035
GFTWRP* THE GIFT WRAP AVAILABLE INDICATOR TO "N" WHEN UPDATING AN       19921135
GFTWRP* ITEM.  THIS WILL AUTOMATICALLY CORRECT ANY GIFT WRAP            19921235
GFTWRP* INDICATOR THAT WAS INCORRECTLY SET TO "Y".                      19921335
GFTWRP         MOVE 'N' TO ASC-GIFT-WRAP                                19921435
                                                                        19922035
199300         EXEC SQL                                                 19930002
199400             INSERT INTO TWEBITM                                  19940002
199500                   (INTR_UPC_ID                                   19950002
199600                  , EFF_BEG_TMST                                  19960002
199700                  , EFF_END_TMST                                  19970002
199800                  , ASRT_BEG_DTE                                  19980002
199900                  , ASRT_END_DTE                                  19990002
200000                  , STRG_AREA_SEQ_NBR                             20000002
200100                  , SHIP_WD_QTY                                   20010002
200200                  , SHIP_DPTH_QTY                                 20020002
200300                  , SHIP_HT_QTY                                   20030002
200400                  , SHIP_WT_QTY                                   20040002
200500                  , SHIP_DIM_SRC_CDE                              20050002
200600                  , PKG_SEQ_NBR                                   20060002
200700                  , SHIP_RSTRC_SEQ_NBR                            20070002
200800                  , GFT_WRAP_AVL_IND                              20080002
200900                  , PRD_GP_NBR                                    20090002
201000                  , PRD_GP_IND                                    20100002
201100                  , SHIP_SRCHG_FEE_AMT                            20110002
201200                  , SHIP_SRVC_SEQ_NBR                             20120002
201300                  , SHIP_GP_SEQ_NBR                               20130002
201400                  , CRE_BY_USR_ID                                 20140002
201500                  , WEB_ITM_DLTD_IND                              20150003
201600                  , HAZDS_IND                                     20160003
201700                  , BRKBL_IND                                     20170003
201800                  , GC_IND                                        20180003
201900                  , SHIP_ALN_IND                                  20190031
202000                  , WEB_EXCLV_IND)                                20200031
202100             VALUES                                               20210002
202200                   (:WEBITM-INTR-UPC-ID                           20220002
202300                  , CURRENT TIMESTAMP                             20230014
202400                  ,  NULL                                         20240014
202500                  , :WEBITM-ASRT-BEG-DTE                          20250002
202600                  , :WEBITM-ASRT-END-DTE                          20260002
202700                  , :WEBITM-STRG-AREA-SEQ-NBR                     20270002
202800                  , :WEBITM-SHIP-WD-QTY                           20280002
202900                  , :WEBITM-SHIP-DPTH-QTY                         20290002
203000                  , :WEBITM-SHIP-HT-QTY                           20300002
203100                  , :WEBITM-SHIP-WT-QTY                           20310002
203200                  , :WEBITM-SHIP-DIM-SRC-CDE                      20320002
203300                  , :WEBITM-PKG-SEQ-NBR                           20330002
203400                  , :WEBITM-SHIP-RSTRC-SEQ-NBR                    20340013
203500                  , :ASC-GIFT-WRAP                                20350013
203600                  , :WEBITM-PRD-GP-NBR                            20360002
203700                  , :WEBITM-PRD-GP-IND                            20370002
203800                  , :WEBITM-SHIP-SRCHG-FEE-AMT                    20380013
203900                  , :WEBITM-SHIP-SRVC-SEQ-NBR                     20390013
204000                  , :WEBITM-SHIP-GP-SEQ-NBR                       20400013
204100                  , :PC-CURRENT-PROGRAM-NAME                      20410013
204200                  , :WEBITM-WEB-ITM-DLTD-IND                      20420003
204300                  , :WEBITM-HAZDS-IND                             20430003
204400                  , :WEBITM-BRKBL-IND                             20440003
204500                  , :WEBITM-GC-IND                                20450003
204600                  , :WEBITM-SHIP-ALN-IND                          20460031
204700                  , :WEBITM-WEB-EXCLV-IND)                        20470031
204800         END-EXEC                                                 20480002
204900                                                                  20490002
205000         EVALUATE TRUE                                            20500002
205100           WHEN SQLCODE = ZERO                                    20510002
205200               PERFORM 7400-IMT00024-ATTRIBUTES                   20520030
205300           WHEN SQLCODE = -803                                    20530002
205400               CONTINUE                                           20540002
205500                                                                  20550002
205600           WHEN OTHER                                             20560002
205700               MOVE '7300-INSERT-TWEBITM' TO DP013-PARAGRAPH      20570002
205800               MOVE 'INSERT TWEBITM     ' TO DP013-MESSAGE-TEXT(1)20580002
205900               MOVE WEBITM-INTR-UPC-ID    TO DP013-MESSAGE-TEXT(2)20590002
206000               MOVE SQLCA                 TO DP013-SQLCA          20600002
206100               MOVE 'TWEBITM' TO DP013-DB2-TABLE-NAME(1)          20610002
206200               SET DP013-DB2-ABEND        TO TRUE                 20620002
206300               SET DP013-ROLLBACK         TO TRUE                 20630002
206400               SET DP013-XCTL-DISPLAY-RESTART TO TRUE             20640002
206500               PERFORM DP013-0000-PROCESS-ABEND                   20650002
206600         END-EVALUATE                                             20660002
206700     END-PERFORM.                                                 20670002
206800                                                                  20680002
206900*---------------------------------------------------------------* 20690030
207000 7400-IMT00024-ATTRIBUTES.                                        20700030
207100                                                                  20710030
207200     PERFORM 7410-UPDATE-IMT00024.                                20720030
207300     PERFORM 7420-LOAD-IMT00024.                                  20730030
207400                                                                  20740030
207500     EXEC SQL                                                     20750030
207600         SET :IMT00024-EFF-BEG-TMST = CURRENT TIMESTAMP           20760030
207700     END-EXEC                                                     20770030
207800                                                                  20780030
207900*INSERT NEW ROW.                                                  20790030
208000     EXEC SQL                                                     20800030
208100         INSERT INTO IMT_ITM_DC_ASSN                              20810030
208200               (INTR_UPC_ID                                       20820030
208300              , DC_NBR                                            20830030
208400              , EFF_BEG_TMST                                      20840030
208500              , EFF_END_TMST                                      20850030
208600              , AUTO_SORT_CDE                                     20860030
208700              , SORT_BOX_SZ_DESC                                  20870030
208800              , PICK_LOC_TYP_CDE                                  20880030
208900              , CNVYB_IND                                         20890030
209000              , BAGBL_IND                                         20900030
209100              , SHIP_COST_AMT)                                    20910030
209200         VALUES                                                   20920030
209300               (:IMT00024-INTR-UPC-ID                             20930030
209400              , :IMT00024-DC-NBR                                  20940030
209500              , :IMT00024-EFF-BEG-TMST                            20950030
209600              , NULL                                              20960030
209700              , :IMT00024-AUTO-SORT-CDE                           20970030
209800              , :IMT00024-SORT-BOX-SZ-DESC                        20980030
209900              , :IMT00024-PICK-LOC-TYP-CDE                        20990030
210000              , :IMT00024-CNVYB-IND                               21000030
210100              , :IMT00024-BAGBL-IND                               21010030
210200              , :IMT00024-SHIP-COST-AMT)                          21020030
210300     END-EXEC.                                                    21030030
210400                                                                  21040030
210500     EVALUATE TRUE                                                21050030
210600       WHEN SQLCODE = ZERO                                        21060030
210700       WHEN SQLCODE = -803                                        21070030
210800           CONTINUE                                               21080030
210900                                                                  21090030
211000       WHEN OTHER                                                 21100030
211100           MOVE '7400-IMT00024-ATTRIBUTES' TO DP013-PARAGRAPH     21110030
211200           MOVE 'INSERT ITM_DC_ASSN ' TO DP013-MESSAGE-TEXT(1)    21120030
211300           MOVE WEBITM-INTR-UPC-ID    TO DP013-MESSAGE-TEXT(2)    21130030
211400           MOVE 'IMT0024'             TO DP013-DB2-TABLE-NAME(1)  21140030
211500           MOVE SQLCA                      TO DP013-SQLCA         21150030
211600           SET DP013-DB2-ABEND             TO TRUE                21160030
211700           SET DP013-ROLLBACK              TO TRUE                21170030
211800           SET DP013-XCTL-DISPLAY-RESTART  TO TRUE                21180030
211900           PERFORM DP013-0000-PROCESS-ABEND                       21190030
212000     END-EVALUATE.                                                21200030
212100                                                                  21210030
212200*---------------------------------------------------------------* 21220030
212300 7410-UPDATE-IMT00024.                                            21230030
212400                                                                  21240030
212500*JPL - SET SHIPPING COST (DO NOT RE-CALCULATE).                   21250030
212600     EXEC SQL                                                     21260030
212700         SELECT SHIP_COST_AMT                                     21270030
212800           INTO :IMT00024-SHIP-COST-AMT                           21280030
212900           FROM IMT_ITM_DC_ASSN                                   21290030
213000          WHERE INTR_UPC_ID   = :DK-INTR-UPC-ID                   21300030
213100            AND EFF_END_TMST  IS NULL                             21310030
213200     END-EXEC.                                                    21320030
213300                                                                  21330030
213400     EVALUATE TRUE                                                21340030
213500       WHEN SQLCODE = ZERO                                        21350030
213600           CONTINUE                                               21360030
213700       WHEN SQLCODE = +100                                        21370030
213800         MOVE ZEROES TO IMT00024-SHIP-COST-AMT                    21380030
213900                                                                  21390030
214000       WHEN OTHER                                                 21400030
214100           MOVE '7410-UPDATE-IMT00024'    TO DP013-PARAGRAPH      21410030
214200           MOVE 'SELECT IMT_ITM_DC_ASSN'  TO DP013-MESSAGE-TEXT(1)21420030
214300           MOVE DK-INTR-UPC-ID            TO DP013-MESSAGE-TEXT(2)21430030
214400           MOVE SQLCA                     TO DP013-SQLCA          21440030
214500           MOVE 'IMT00024'              TO DP013-DB2-TABLE-NAME(1)21450030
214600           SET DP013-DB2-ABEND            TO TRUE                 21460030
214700           SET DP013-NO-ROLLBACK          TO TRUE                 21470030
214800           SET DP013-XCTL-DISPLAY-RESTART TO TRUE                 21480030
214900           PERFORM DP013-0000-PROCESS-ABEND                       21490030
215000     END-EVALUATE.                                                21500030
215100                                                                  21510030
215200* UPDATE EXISTING ROW.                                            21520030
215300     EXEC SQL                                                     21530030
215400         UPDATE IMT_ITM_DC_ASSN                                   21540030
215500            SET EFF_END_TMST   = CURRENT TIMESTAMP                21550030
215600          WHERE INTR_UPC_ID    = :DK-INTR-UPC-ID                  21560030
215700            AND EFF_END_TMST  IS NULL                             21570030
215800     END-EXEC.                                                    21580030
215900                                                                  21590030
216000     EVALUATE TRUE                                                21600030
216100       WHEN SQLCODE = ZERO                                        21610030
216200       WHEN SQLCODE = +100                                        21620030
216300           CONTINUE                                               21630030
216400                                                                  21640030
216500       WHEN OTHER                                                 21650030
216600           MOVE '7410-UPDATE-IMT00024'    TO DP013-PARAGRAPH      21660030
216700           MOVE 'UPDATE IMT_ITM_DC_ASSN'  TO DP013-MESSAGE-TEXT(1)21670030
216800           MOVE DK-INTR-UPC-ID            TO DP013-MESSAGE-TEXT(2)21680030
216900           MOVE SQLCA                     TO DP013-SQLCA          21690030
217000           MOVE 'IMT00024'              TO DP013-DB2-TABLE-NAME(1)21700030
217100           SET DP013-DB2-ABEND            TO TRUE                 21710030
217200           SET DP013-NO-ROLLBACK          TO TRUE                 21720030
217300           SET DP013-XCTL-DISPLAY-RESTART TO TRUE                 21730030
217400           PERFORM DP013-0000-PROCESS-ABEND                       21740030
217500     END-EVALUATE.                                                21750030
217600                                                                  21760030
217700*---------------------------------------------------------------* 21770030
217800 7420-LOAD-IMT00024.                                              21780030
217900                                                                  21790030
218000     MOVE DK-INTR-UPC-ID    TO IMT00024-INTR-UPC-ID.              21800030
218100     MOVE 870               TO IMT00024-DC-NBR.                   21810030
218200                                                                  21820030
218300*3 = 'HV'                                                         21830030
218400     IF WEBITM-SHIP-GP-SEQ-NBR = 3                                21840030
218500         MOVE 'C' TO IMT00024-AUTO-SORT-CDE                       21850030
218600     ELSE                                                         21860030
218700*4 = 'FR'                                                         21870030
218800         IF WEBITM-SHIP-GP-SEQ-NBR = 4                            21880030
218900             MOVE 'N' TO IMT00024-AUTO-SORT-CDE                   21890030
219000         ELSE                                                     21900030
219100             PERFORM 7421-SET-AUTO-SORT                           21910030
219200         END-IF                                                   21920030
219300     END-IF.                                                      21930030
219400                                                                  21940030
219500     PERFORM 7422-SET-PICK-ASSIGN.                                21950030
219600                                                                  21960030
219700     IF IMT00024-AUTO-SORT-CDE = 'C'                              21970030
219800         MOVE 'SMALL BIN ' TO IMT00024-SORT-BOX-SZ-DESC           21980030
219900     ELSE                                                         21990030
220000         IF IMT00024-AUTO-SORT-CDE = 'N'                          22000030
220100             MOVE 'LARGE BIN ' TO IMT00024-SORT-BOX-SZ-DESC       22010030
220200         ELSE                                                     22020030
220300             PERFORM 7423-SET-BIN-BOX                             22030030
220400         END-IF                                                   22040030
220500     END-IF.                                                      22050030
220600                                                                  22060030
220700     PERFORM 7424-SET-CONVEYABLE.                                 22070030
220800                                                                  22080030
220900*4 = 'FR'                                                         22090030
221000     IF WEBITM-SHIP-GP-SEQ-NBR = 4                                22100030
221100         MOVE 'N' TO IMT00024-BAGBL-IND                           22110030
221200     ELSE                                                         22120030
221300         PERFORM 7425-SET-BAGGABLE                                22130030
221400     END-IF.                                                      22140030
221500                                                                  22150030
221600******************************************************************22160030
221700*    D E T E R M I N E   I M T 0 0 0 2 4   F I E L D S            22170030
221800******************************************************************22180030
221900 7421-SET-AUTO-SORT.                                              22190030
222000                                                                  22200030
222100     MOVE 'S' TO IMT00024-AUTO-SORT-CDE.                          22210030
222200*MUST BE LESS THAN 25 POUNDS.                                     22220030
222300     IF WEBITM-SHIP-WT-QTY NOT < 25                               22230030
222400         MOVE 'N' TO IMT00024-AUTO-SORT-CDE                       22240030
222500     END-IF.                                                      22250030
222600*NO DIMENSION > 29                                                22260030
222700     IF WEBITM-SHIP-WD-QTY NOT < 29                               22270030
222800       OR WEBITM-SHIP-DPTH-QTY NOT < 29                           22280030
222900       OR WEBITM-SHIP-HT-QTY NOT < 29                             22290030
223000         MOVE 'N' TO IMT00024-AUTO-SORT-CDE                       22300030
223100     END-IF.                                                      22310030
223200*ONE DIMENSION < 15                                               22320030
223300     IF WEBITM-SHIP-WD-QTY NOT < 15                               22330030
223400       AND WEBITM-SHIP-DPTH-QTY NOT < 15                          22340030
223500       AND WEBITM-SHIP-HT-QTY NOT < 15                            22350030
223600         MOVE 'N' TO IMT00024-AUTO-SORT-CDE                       22360030
223700     END-IF.                                                      22370030
223800*TWO DIMENSIONS < 23                                              22380030
223900     IF (WEBITM-SHIP-WD-QTY NOT < 23                              22390030
224000       AND WEBITM-SHIP-DPTH-QTY NOT < 23)                         22400030
224100      OR (WEBITM-SHIP-DPTH-QTY NOT < 23                           22410030
224200       AND WEBITM-SHIP-HT-QTY NOT < 23)                           22420030
224300      OR (WEBITM-SHIP-WD-QTY NOT < 23                             22430030
224400       AND WEBITM-SHIP-HT-QTY NOT < 23)                           22440030
224500         MOVE 'N' TO IMT00024-AUTO-SORT-CDE                       22450030
224600     END-IF.                                                      22460030
224700                                                                  22470030
224800******************************************************************22480030
224900 7422-SET-PICK-ASSIGN.                                            22490030
225000                                                                  22500030
225100     IF IMT00024-AUTO-SORT-CDE = 'C'                              22510030
225200         MOVE 'C01' TO IMT00024-PICK-LOC-TYP-CDE                  22520030
225300     END-IF.                                                      22530030
225400                                                                  22540030
225500     IF IMT00024-AUTO-SORT-CDE = 'N'                              22550030
225600         MOVE 'N01' TO IMT00024-PICK-LOC-TYP-CDE                  22560030
225700     END-IF.                                                      22570030
225800                                                                  22580030
225900     IF IMT00024-AUTO-SORT-CDE = 'S'                              22590030
226000         MOVE 'P01' TO IMT00024-PICK-LOC-TYP-CDE                  22600030
226100         PERFORM 7430-CHECK-DEPT                                  22610030
226200         IF SKXREF-DEPT-NBR =  34 OR  35 OR 131 OR 151            22620030
226300                           OR 234 OR 252 OR 331 OR 343 OR 345     22630030
226400             MOVE 'P02' TO IMT00024-PICK-LOC-TYP-CDE              22640030
226500         END-IF                                                   22650030
226600     END-IF.                                                      22660030
226700                                                                  22670030
226800******************************************************************22680030
226900 7423-SET-BIN-BOX.                                                22690030
227000                                                                  22700030
227100     IF IMT00024-PICK-LOC-TYP-CDE = 'C01' OR 'P02'                22710030
227200         MOVE 'SMALL BIN ' TO IMT00024-SORT-BOX-SZ-DESC           22720030
227300     END-IF.                                                      22730030
227400                                                                  22740030
227500     IF IMT00024-PICK-LOC-TYP-CDE = 'P01'                         22750030
227600         MOVE 'MEDIUM BIN' TO IMT00024-SORT-BOX-SZ-DESC           22760030
227700     END-IF.                                                      22770030
227800                                                                  22780030
227900     IF IMT00024-PICK-LOC-TYP-CDE = 'N01'                         22790030
228000         MOVE 'LARGE BIN ' TO IMT00024-SORT-BOX-SZ-DESC           22800030
228100     END-IF.                                                      22810030
228200                                                                  22820030
228300******************************************************************22830030
228400 7424-SET-CONVEYABLE.                                             22840030
228500                                                                  22850030
228600     MOVE 'Y' TO IMT00024-CNVYB-IND.                              22860030
228700*MUST BE LESS THAN 60 POUNDS.                                     22870030
228800     IF WEBITM-SHIP-WT-QTY NOT < 60                               22880030
228900         MOVE 'N' TO IMT00024-CNVYB-IND                           22890030
229000     END-IF.                                                      22900030
229100*NO DIMENSION > 37 AND TWO DIMENSIONS < 26                        22910030
229200     IF (WEBITM-SHIP-WD-QTY < 37                                  22920030
229300       AND WEBITM-SHIP-DPTH-QTY < 26                              22930030
229400       AND WEBITM-SHIP-HT-QTY < 26)                               22940030
229500      OR (WEBITM-SHIP-WD-QTY < 26                                 22950030
229600       AND WEBITM-SHIP-DPTH-QTY < 37                              22960030
229700       AND WEBITM-SHIP-HT-QTY < 26)                               22970030
229800      OR (WEBITM-SHIP-WD-QTY < 26                                 22980030
229900       AND WEBITM-SHIP-DPTH-QTY < 26                              22990030
230000       AND WEBITM-SHIP-HT-QTY < 37)                               23000030
230100         CONTINUE                                                 23010030
230200     ELSE                                                         23020030
230300         MOVE 'N' TO IMT00024-CNVYB-IND                           23030030
230400     END-IF.                                                      23040030
230500                                                                  23050030
230600******************************************************************23060030
230700 7425-SET-BAGGABLE.                                               23070030
230800                                                                  23080030
230900     MOVE 'Y' TO IMT00024-BAGBL-IND.                              23090030
231000*MUST BE LESS THAN 20 POUNDS.                                     23100030
231100     IF WEBITM-SHIP-WT-QTY > 20                                   23110030
231200         MOVE 'N' TO IMT00024-BAGBL-IND                           23120030
231300     END-IF.                                                      23130030
231400*NO DIMENSION > 24                                                23140030
231500     IF WEBITM-SHIP-WD-QTY NOT < 24                               23150030
231600       OR WEBITM-SHIP-DPTH-QTY NOT < 24                           23160030
231700       OR WEBITM-SHIP-HT-QTY NOT < 24                             23170030
231800         MOVE 'N' TO IMT00024-BAGBL-IND                           23180030
231900     END-IF.                                                      23190030
232000*ONE DIMENSION < 8                                                23200030
232100     IF (WEBITM-SHIP-WD-QTY NOT < 8)                              23210030
232200       AND (WEBITM-SHIP-DPTH-QTY NOT < 8)                         23220030
232300       AND (WEBITM-SHIP-HT-QTY NOT < 8)                           23230030
232400         MOVE 'N' TO IMT00024-BAGBL-IND                           23240030
232500     END-IF.                                                      23250030
232600                                                                  23260030
232700******************************************************************23270030
232800 7430-CHECK-DEPT.                                                 23280030
232900                                                                  23290030
233000     EXEC SQL                                                     23300030
233100         SELECT DEPT_NBR                                          23310030
233200           INTO :SKXREF-DEPT-NBR                                  23320030
233300           FROM TSKXREF                                           23330030
233400          WHERE INTR_UPC_ID = :DK-INTR-UPC-ID                     23340030
233500            AND SKU_STAT_CDE <>'98'                               23350030
233600     END-EXEC.                                                    23360030
233700                                                                  23370030
233800     EVALUATE TRUE                                                23380030
233900       WHEN SQLCODE = ZERO                                        23390030
234000           CONTINUE                                               23400030
234100                                                                  23410030
234200       WHEN SQLCODE = +100                                        23420030
234300           MOVE ZEROES TO SKXREF-DEPT-NBR                         23430030
234400                                                                  23440030
234500       WHEN SQLCODE = -811                                        23450030
234600           MOVE ZEROES TO SKXREF-DEPT-NBR                         23460030
234700                                                                  23470030
234800       WHEN OTHER                                                 23480030
234900           MOVE '7430-CHECK-DEPT' TO DP013-PARAGRAPH              23490030
235000           MOVE 'SELECT TSKXREF ' TO DP013-MESSAGE-TEXT(1)        23500030
235100           MOVE DK-INTR-UPC-ID    TO DP013-MESSAGE-TEXT(2)        23510030
235200           MOVE SQLCA             TO DP013-SQLCA                  23520030
235300           MOVE 'TSKXREF '        TO DP013-DB2-TABLE-NAME(1)      23530030
235400           SET DP013-DB2-ABEND    TO TRUE                         23540030
235500           SET DP013-NO-ROLLBACK  TO TRUE                         23550030
235600           SET DP013-XCTL-DISPLAY-RESTART TO TRUE                 23560030
235700           PERFORM DP013-0000-PROCESS-ABEND                       23570030
235800     END-EVALUATE.                                                23580030
235900                                                                  23590030
236000*---------------------------------------------------------------* 23600002
236100*                                                                 23610002
236200*---------------------------------------------------------------* 23620005
236300 7999-UPDATE-DONE.                                                23630002
236400                                                                  23640002
236500     INITIALIZE ASC-SPECIFIC-COMMAREA.                            23650002
236600                                                                  23660002
236700     MOVE DP015-UNP-ALP-NOR-OFF TO AUPSKUA                        23670003
236800                                   AUPDCA.                        23680003
236900     MOVE DP015-GREEN           TO AUPSKUC                        23690003
237000                                   AUPDCC.                        23700003
237100     MOVE DP015-PRO-NOR-OFF     TO AUPSHSCA                       23710003
237200                                   AUPSHRCA                       23720003
237300                                   AUPSHGCA                       23730003
GFTWRP*                                  AUPGIFTA                       23740033
237500                                   AUPSHFEA.                      23750003
237600     MOVE DP015-BLUE            TO AUPSHSCC                       23760005
237700                                   AUPSHRCC                       23770003
237800                                   AUPSHGCC                       23780003
GFTWRP*                                  AUPGIFTC                       23790033
238000                                   AUPSHFEC.                      23800003
238100     MOVE DP015-UNDERLINE       TO AUPSKUH                        23810003
238200                                   AUPDCH.                        23820021
238300** DMH                             AUPSHSCH                       23830021
238400** DMH                             AUPSHRCH                       23840021
238500** DMH                             AUPSHGCH                       23850021
238600** DMH                             AUPGIFTH                       23860021
238700** DMH                             AUPSHFEH.                      23870021
238800     MOVE -1         TO AUPSKUL.                                  23880003
238900     SET ASC-NEW-SKU TO TRUE.                                     23890002
239000                                                                  23900002
239100* UPDATE(S) SUCCESSFUL MSG                                        23910006
239200     MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER.             23920002
239300     MOVE DP015-UNP-ALP-BRT-OFF  TO AUPSKUA.                      23930002
239400     MOVE -1                     TO AUPSKUL.                      23940003
239500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         23950002
239600                                                                  23960002
239700*---------------------------------------------------------------* 23970002
239800*                                                                 23980002
239900*---------------------------------------------------------------* 23990003
240000 7999-INITIALIZE-IO.                                              24000002
240100                                                                  24010002
240200     MOVE SPACES TO AUPSKUI                                       24020002
240300                    AUPDCI                                        24030003
240400                    AUPDCDI                                       24040003
240500                    AUPUPCI                                       24050003
240600                    ADEPTI                                        24060003
240700                    ACLASI                                        24070003
240800                    EFFDTEI                                       24080003
240900                    ASDESCI                                       24090003
241000                    AUPSHLNI                                      24100003
241100                    AUPHAZI                                       24110003
241200                    AUPSHWDI                                      24120003
241300                    AUPBRKI                                       24130003
241400                    AUPSHHTI                                      24140003
241500                    AUPGCI                                        24150003
241600                    AUPSHWTI                                      24160003
241700                    AUPSAI                                        24170003
241800                    AUPSHSCI                                      24180003
241900                    AUPDSC4I                                      24190002
242000                    AUPSHRCI                                      24200002
242100                    AUPDSC5I                                      24210002
242200                    AUPSHGCI                                      24220002
242300                    AUPDSC6I                                      24230002
242400                    AUPGIFTI                                      24240002
242500                    AUPSHFEI                                      24250003
242600                    AUPBOXI                                       24260003
242700                    AUPCONI                                       24270003
242800                    AUPAMTI                                       24280003
242900                    AUPBAGI                                       24290003
243000                    AUPTYPI                                       24300003
243100                    AUPSRTI.                                      24310003
243200                                                                  24320003
243300*----------------------------------------------------------------*24330002
243400*    ABEND PROCESSOR MODULE                                      *24340002
243500*----------------------------------------------------------------*24350002
243600     COPY DPPD013.                                                24360002
243700                                                                  24370002
