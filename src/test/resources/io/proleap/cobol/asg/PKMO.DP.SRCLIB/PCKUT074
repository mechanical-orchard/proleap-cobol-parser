000100 IDENTIFICATION DIVISION.                                         00010011
000200 PROGRAM-ID.    PCKUT074.                                         00020012
000300 AUTHOR.        JEAN KURKOWSKI.                                   00030012
000400                                                                  00040012
000500******************************************************************00050012
000600* USED TO TAKE PACK-TO-LIGHT BUSINESS EVENT FOR AN                00060012
000700* OUTBOUND OPEN AND WRITE THE INFORMATION TO THE EAI              00070012
000800* BUSINESS EVENT EXPORT TABLES                                    00080012
000900*                                                                 00090008
001000* THIS PROGRAM WAS CONVERTED FROM PCKCS764 AND CHGD TO BATCH      00100008
001100*                                                                 00110008
001200******************************************************************00120001
001300                                                                  00130001
001400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00140001
001500 DATE-WRITTEN.  JULY 2007.                                        00150001
001600 DATE-COMPILED.                                                   00160001
001700                                                                  00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900 CONFIGURATION SECTION.                                           00190001
002000 SOURCE-COMPUTER. IBM-3090.                                       00200001
002100 OBJECT-COMPUTER. IBM-3090.                                       00210001
002200                                                                  00220001
002300 DATA DIVISION.                                                   00230001
002400 WORKING-STORAGE SECTION.                                         00240001
002500                                                                  00250001
002600 01  PS-SWITCHES.                                                 00260001
002700     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00270001
002800         88  PS-ERROR-YES                       VALUE 'Y'.        00280001
002900         88  PS-ERROR-NO                        VALUE 'N'.        00290001
003000     05  PS-P4-INTERFACE-SW           PIC X(01) VALUE 'N'.        00300001
003100         88  PS-P4-INTERFACE-YES                VALUE 'Y'.        00310001
003200         88  PS-P4-INTERFACE-NO                 VALUE 'N'.        00320001
003300     05  PS-USER-FOUND-SW             PIC X(01) VALUE 'N'.        00330030
003400         88  PS-USER-FOUND-YES                  VALUE 'Y'.        00340030
003500         88  PS-USER-FOUND-NO                   VALUE 'N'.        00350030
003510     05  PS-CARTON-ON-TLBVRDA-SW      PIC X(01) VALUE 'N'.        00351052
003520         88  PS-CARTON-ON-TLBVRDA               VALUE 'Y'.        00352052
003530         88  PS-CARTON-ON-TLBVRDA-NO            VALUE 'N'.        00353052
003600                                                                  00360001
003700 01  DK-DB2-KEYS.                                                 00370018
003800     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00380001
003900     05  DK-MODU-NBR                  PIC S9(04) COMP.            00390001
004000                                                                  00400001
004100 01  PV-PROGRAM-VARIABLES.                                        00410018
004200     05  PV-DISP-SQLCODE              PIC -999    VALUE ZEROES.   00420018
004300     05  PV-DISP-SQLCODE-2            PIC -999    VALUE ZEROES.   00430018
004400     05  PV-DISP-SQLCODE-3            PIC -999    VALUE ZEROES.   00440027
004500     05  PV-DISP-OPER                 PIC 9(04)   VALUE ZEROES.   00450027
004600     05  PV-USER-ID                   PIC X(08)   VALUE SPACES.   00460018
004700     05  PV-PICK-MADE-TM.                                         00470001
004800         10  PV-PICK-BYTE OCCURS 25   PIC X(01).                  00480001
004900     05  PV-PLACE-PTR                 PIC S9(03) COMP-3.          00490001
005000     05  PV-SUB                       PIC S9(03) COMP-3.          00500001
005100     05  PV-HOLD-TWO                  PIC X(02).                  00510001
005200     05  PV-HOLD-FOUR                 PIC X(04).                  00520001
005300     05  PV-HOLD-PTR                  PIC S9(03) COMP-3.          00530001
005400     05  PV-START-TIMESTAMP.                                      00540001
005500         10 PV-START-DATE.                                        00550001
005600             15 PV-START-CCYY         PIC X(04).                  00560001
005700             15 FILLER                PIC X(01) VALUE '-'.        00570001
005800             15 PV-START-MM           PIC X(02).                  00580001
005900             15 FILLER                PIC X(01) VALUE '-'.        00590001
006000             15 PV-START-DD           PIC X(02).                  00600001
006100         10 PV-START-TIME.                                        00610001
006200             15 FILLER                PIC X(01) VALUE '-'.        00620001
006300             15 PV-START-HOUR.                                    00630001
006400                 20 PV-START-HOUR-N   PIC 9(02).                  00640001
006500             15 FILLER                PIC X(01) VALUE '.'.        00650001
006600             15 PV-START-MIN          PIC X(02).                  00660001
006700             15 FILLER                PIC X(01) VALUE '.'.        00670001
006800             15 PV-START-SEC          PIC X(02).                  00680001
006900             15 FILLER                PIC X(01) VALUE '.'.        00690001
007000             15 FILLER                PIC X(06) VALUE ZERO.       00700001
007100                                                                  00710001
007200     05  PV-HOLD-LOCATION             PIC X(10).                  00720001
007300     05  PV-LENGTH                    PIC S9(03) COMP-3.          00730001
007400     05  PV-DUMMY                     PIC S9(03) COMP-3           00740001
007500                                          VALUE ZERO.             00750001
007600                                                                  00760001
007700     05  PV-LABOR-ASGMT-STRT-DTE      PIC X(10) VALUE SPACES.     00770001
007800     05  PV-LABOR-ASGMT-NBR-TXT       PIC X(10) VALUE SPACES.     00780001
007900     05  PV-LABOR-ASGMT-NBR-SEQ-NBR   PIC S9(09) COMP VALUE ZERO. 00790001
008000     05  PV-LABOR-SEQ-START-NBR       PIC S9(09) COMP VALUE ZERO. 00800001
008100                                                                  00810001
008200     05  PV-CURRENT-TIME.                                         00820001
008300         10  PV-CURRENT-HOUR          PIC 99.                     00830001
008400         10  PV-CURRENT-MINUTE        PIC 99.                     00840001
008500         10  PV-CURRENT-SECOND        PIC 99.                     00850001
008600         10  PV-CURRENT-HUNDRETH      PIC 99.                     00860001
008700                                                                  00870001
008800     05  PV-FORMAT-TIME.                                          00880001
008900         10  PV-FORMAT-HH             PIC 99.                     00890001
009000         10  FILLER                   PIC X(01) VALUE ':'.        00900001
009100         10  PV-FORMAT-MM             PIC 99.                     00910001
009200         10  FILLER                   PIC X(01) VALUE ':'.        00920001
009300         10  PV-FORMAT-SS             PIC 99.                     00930001
009400         10  FILLER                   PIC X(01) VALUE ':'.        00940001
009500         10  PV-FORMAT-HUND           PIC 99.                     00950001
009600     05  PV-LOG-MSG                   PIC X(110) VALUE SPACES.    00960016
009601                                                                  00960143
009610     05  PV-CART-SRC                  PIC X(03).                  00961043
009700                                                                  00970001
009800 01  PV-ERROR-MSG.                                                00980001
009900     05  FILLER                       PIC X(12)                   00990001
010000         VALUE ' PCKUT074 '.                                      01000004
010100     05  PV-ERROR-TIME                PIC X(11).                  01010001
010200     05  FILLER                       PIC X(06)                   01020001
010300                                           VALUE ' PARA-'.        01030001
010400     05  PV-ERROR-PARA                PIC X(05) VALUE SPACES.     01040001
010500     05  FILLER                       PIC X(02) VALUE SPACES.     01050001
010600     05  PV-ERROR-TEXT                PIC X(44) VALUE SPACES.     01060001
010610                                                                  01061036
010611     05  PV-OPEN-DATE                 PIC X(10) VALUE SPACES.     01061136
010612     05  PV-OPEN-TIME                 PIC X(08) VALUE SPACES.     01061236
010620                                                                  01062036
010630     05  PV-DISP-SML                  PIC 9(18) VALUE ZEROES.     01063046
010640     05  PV-DISP-ORGN                 PIC 9(04) VALUE ZEROES.     01064046
010650     05  PV-DISP-DEST                 PIC 9(05) VALUE ZEROES.     01065046
010660     05  PV-DISP-PRNT                 PIC 9(18) VALUE ZEROES.     01066046
010670     05  PV-DISP-ORIG                 PIC 9(18) VALUE ZEROES.     01067046
010680     05  PV-DISP-RVSN                 PIC 9(04) VALUE ZEROES.     01068046
010690     05  PV-SML-WORK.                                             01069047
010691         10  FILLER                   PIC X(02) VALUE ZEROES.     01069147
010692         10  PV-SML-18                PIC 9(18) VALUE ZEROES.     01069247
010700                                                                  01070001
010800 01  PV-KEY-MSGS.                                                 01080001
010900     05  PV-OPER-TEXT.                                            01090001
011000         10  FILLER                   PIC X(06)                   01100001
011100             VALUE ' LOC= '.                                      01110001
011200         10  PV-MSG-OPER              PIC 9(04).                  01120001
011300                                                                  01130001
011400     05  PV-MODU-TEXT.                                            01140001
011500         10  FILLER                   PIC X(05)                   01150001
011600             VALUE ' DC= '.                                       01160001
011700         10  PV-MSG-MODU-DC           PIC 9(04).                  01170001
011800         10  FILLER                   PIC X(07)                   01180001
011900             VALUE ' MODU= '.                                     01190001
012000         10  PV-MSG-MODU              PIC 9(02).                  01200001
012100                                                                  01210001
012200     05  PV-DLKUT410-TEXT1.                                       01220010
012300         10  FILLER                   PIC X(07)                   01230001
012400             VALUE ' USER= '.                                     01240001
012500         10  PV-DLKUT410-USER         PIC X(08).                  01250010
012600                                                                  01260001
012700         10  FILLER                   PIC X(08)                   01270001
012800             VALUE ' WKTYP= '.                                    01280001
012900         10  PV-DLKUT410-WK-TYP       PIC X(15).                  01290010
013000                                                                  01300001
013100         10  FILLER                   PIC X(13)                   01310001
013200             VALUE ' WKTYP DESC= '.                               01320001
013300         10  PV-DLKUT410-WK-TYP-DESC  PIC X(15).                  01330010
013400                                                                  01340001
013500     05  PV-DLKUT410-TEXT2.                                       01350010
013600                                                                  01360001
013700         10  FILLER                   PIC X(09)                   01370001
013800             VALUE ' WKAREA= '.                                   01380001
013900         10  PV-DLKUT410-WK-AREA-DESC PIC X(20).                  01390010
014000                                                                  01400001
014100         10  FILLER                   PIC X(08)                   01410001
014200             VALUE ' DC=  '.                                      01420001
014300         10  PV-DLKUT410-DC-NBR       PIC 9(04).                  01430010
014400                                                                  01440001
014500         10  FILLER                   PIC X(10)                   01450001
014600             VALUE ' CRE USER='.                                  01460001
014700         10  PV-DLKUT410-CRE-USERID   PIC X(08).                  01470010
014800                                                                  01480001
014900         10  FILLER                   PIC X(10)                   01490001
015000             VALUE ' USER TYP='.                                  01500001
015100         10  PV-DLKUT410-USER-TYP     PIC X(01).                  01510010
015200                                                                  01520001
015300                                                                  01530001
015400     05  PV-XLKUP046-TEXT1.                                       01540015
015500         10  FILLER                   PIC X(07)                   01550001
015600             VALUE ' USER= '.                                     01560001
015700         10  PV-XLKUP046-USER         PIC X(08).                  01570015
015800                                                                  01580001
015900         10  FILLER                   PIC X(10)                   01590001
016000             VALUE ' OBJ TXT= '.                                  01600001
016100         10  PV-XLKUP046-OBJTXT       PIC X(40).                  01610015
016200                                                                  01620001
016300     05  PV-XLKUP046-TEXT2.                                       01630015
016400         10  FILLER                   PIC X(15)                   01640001
016500             VALUE ' OBJ ACTN TXT= '.                             01650001
016600         10  PV-XLKUP046-OBJACTNTXT   PIC X(40).                  01660015
016700                                                                  01670001
016800     05  PV-XLKUT067-TEXT.                                        01680001
016900         10  FILLER                   PIC X(09)                   01690001
017000             VALUE ' PICKER= '.                                   01700001
017100         10  PV-XLKUT067-USERID       PIC X(10).                  01710001
017200         10  FILLER                   PIC X(16)                   01720001
017300             VALUE ' RETURN FIELDS= '.                            01730001
017400         10  PV-XLKUT067-RETURN-FIELDS                            01740001
017500                                      PIC X(57).                  01750001
017600                                                                  01760001
017700     05  PV-DLKUP024-TEXT.                                        01770015
017800         10  FILLER                   PIC X(12)                   01780001
017900             VALUE ' START DTE= '.                                01790001
018000         10  PV-DLKUP024-DATE         PIC X(10).                  01800015
018100         10  FILLER                   PIC X(12)                   01810001
018200             VALUE ' ASGMT TXT= '.                                01820001
018300         10  PV-DLKUP024-TXT          PIC X(10).                  01830015
018400         10  FILLER                   PIC X(12)                   01840001
018500             VALUE ' ASGMT SEQ= '.                                01850001
018600         10  PV-DLKUP024-SEQ          PIC 9(09).                  01860015
018700                                                                  01870001
018800*    FOR FORMATTING SLQCA INTO SOMETHING READABLE                 01880001
018900     COPY DPWS004.                                                01890001
019000/                                                                 01900001
019100*    DLKUP024 COMMAREA                                            01910015
019200     COPY DLWS020.                                                01920014
019300***  COPY DLWS001.   (COMMAREA FOR CICS VERSION - DLKUP001)       01930014
019400/                                                                 01940001
019500*    DLKUT410 COMMAREA                                            01950010
019600     COPY DLWS019.                                                01960010
019700/                                                                 01970001
019800*    XLKUT067                                                     01980001
019900     COPY XLWS067.                                                01990001
020000/                                                                 02000001
020100*    XLKUP046 COMMAREA                                            02010015
020200     COPY XLWS091.                                                02020013
020300***  COPY XLWS072.  (COMMAREA FOR CICS VERSION - XLKUP033)        02030013
020400/                                                                 02040001
020500*    FORMAT FOR PCT_BUS_EVNT_DTL                                  02050001
020600     COPY PCWS242.                                                02060001
020700                                                                  02070001
020710*    FORMAT FOR BARCODES                                          02071036
020720     COPY PCWS160.                                                02072036
020730                                                                  02073036
020740*    UPLOAD ERROR FORMAT WHEN CARTON ALREADY EXISTS               02074057
020750     COPY PCWS059.                                                02075057
020760                                                                  02076057
020800*    FORMATTING TEMPLATE                                          02080001
020900     COPY DLWS011.                                                02090001
021000                                                                  02100001
021100*    ABEND FIELDS                                                 02110001
021200*    COPY DPWS013.                                                02120001
021300/                                                                 02130001
021400*    CORP PARM TABLE                                              02140001
021500     EXEC SQL                                                     02150001
021600         INCLUDE TKRPRPM                                          02160001
021700     END-EXEC.                                                    02170001
021800                                                                  02180001
021900*    PACK-TO-LITE MODULES                                         02190001
022000     EXEC SQL                                                     02200001
022100         INCLUDE TP2LMOD                                          02210001
022200     END-EXEC.                                                    02220001
022300                                                                  02230001
022400*     XLT_USR                                                     02240031
022500     EXEC SQL                                                     02250031
022600         INCLUDE XLT00024                                         02260031
022700     END-EXEC.                                                    02270031
022800                                                                  02280031
022900*     DLT_TMP_EMP                                                 02290031
023000     EXEC SQL                                                     02300031
023100         INCLUDE DLT00002                                         02310031
023200     END-EXEC.                                                    02320031
023300                                                                  02330031
023310*     TUPLDER - UPLOAD ERROR                                      02331036
023320     EXEC SQL                                                     02332036
023330         INCLUDE TUPLDER                                          02333036
023340     END-EXEC.                                                    02334036
023350                                                                  02335036
023360*     SUT00024 - SUT_OTBND_CART                                   02336036
023370     EXEC SQL                                                     02337036
023380         INCLUDE SUT00024                                         02338036
023390     END-EXEC.                                                    02339036
023391                                                                  02339136
023392*     SUT00028 - SUT_OTBND_UPC                                    02339249
023393     EXEC SQL                                                     02339336
023394         INCLUDE SUT00028                                         02339436
023395     END-EXEC.                                                    02339536
023396                                                                  02339636
023397*     SUT00027 - SUT_OTBND_LOC                                    02339749
023398     EXEC SQL                                                     02339849
023399         INCLUDE SUT00027                                         02339949
023400     END-EXEC.                                                    02340049
023401                                                                  02340149
023402*     TLBVRDA  - TLBVRDA                                          02340252
023403     EXEC SQL                                                     02340352
023404         INCLUDE TLBVRDA                                          02340452
023405     END-EXEC.                                                    02340552
023406                                                                  02340652
023410     EXEC SQL                                                     02341001
023500          INCLUDE SQLCA                                           02350001
023600     END-EXEC.                                                    02360001
023700                                                                  02370001
023800                                                                  02380001
023900 LINKAGE SECTION.                                                 02390001
024000                                                                  02400001
024100     COPY PCWS245.                                                02410001
024200/                                                                 02420001
024300 PROCEDURE DIVISION USING PC245-COMMAREA.                         02430001
024400                                                                  02440001
024500     INITIALIZE PS-SWITCHES                                       02450026
024600                PV-PROGRAM-VARIABLES.                             02460026
024700                                                                  02470026
024800     PERFORM 1000-INITIALIZE.                                     02480001
024900                                                                  02490001
025000     IF PS-ERROR-NO                                               02500001
025100         IF PS-P4-INTERFACE-YES                                   02510001
025200             PERFORM 2000-OPEN-DA-BOX                             02520001
025300         END-IF                                                   02530001
025400     END-IF.                                                      02540001
025500                                                                  02550001
025600     PERFORM 9999-RETURN.                                         02560001
025700                                                                  02570001
025800 1000-INITIALIZE.                                                 02580001
025900                                                                  02590001
026000     SET PS-ERROR-NO                                              02600001
026100         PS-P4-INTERFACE-NO                                       02610025
026200         PC245-SUCCESSFUL             TO TRUE.                    02620025
026300                                                                  02630001
026400     MOVE FUNCTION UPPER-CASE(PC245-BOXOPEN-USER-ID)              02640005
026500                                      TO PV-USER-ID.              02650005
026600                                                                  02660001
026700     PERFORM 7030-SELECT-TKRPRPM.                                 02670001
026800                                                                  02680001
026900     IF PS-ERROR-NO                                               02690001
027000         IF KRPRPM-FUNC-TXT = 'Y'                                 02700001
027100         STRING 'PCKUT074 BO - '                                  02710016
027200                PC245-DC-NBR                                      02720001
027300                ' '                                               02730001
027400                PC245-LOCATION-NM                                 02740001
027500                ' '                                               02750001
027600                PC245-BOX-BAR-CODE-NBR                            02760001
027700                ' '                                               02770001
027800                PC245-BOXOPEN-DATE                                02780001
027900***              DELIMITED BY SIZE                                02790016
028000***                                     INTO PV-LOG-MSG           02800016
028100***      PERFORM 9900-WRITE-LOG                                   02810016
028200***      STRING PC245-BOXOPEN-TIME                                02820016
028300                ' '                                               02830016
028400                PC245-BOXOPEN-TIME                                02840016
028500                ' '                                               02850001
028600                PC245-BOXOPEN-USER-ID                             02860001
028700                 DELIMITED BY SIZE                                02870001
028800                                        INTO PV-LOG-MSG           02880001
028900         PERFORM 9900-WRITE-LOG                                   02890002
029000     END-IF.                                                      02900001
029100                                                                  02910001
029200     IF PS-ERROR-NO                                               02920001
029300         PERFORM 7000-SELECT-TKRPRPM                              02930001
029400     END-IF.                                                      02940001
029500                                                                  02950001
029600     IF PS-ERROR-NO                                               02960001
029700         IF PS-P4-INTERFACE-YES                                   02970001
029800***          PERFORM 8600-CALL-XLKUT067                           02980030
029900                                                                  02990030
030000             MOVE SPACES              TO XL067-USER-FOUND-CODE    03000030
030100             PERFORM 7100-KOHLS-USER                              03010034
030200                                                                  03020030
030300***          IF XL067-SUCCESSFUL                                  03030030
030400***              IF XL067-USER-NOT-FOUND                          03040030
030500***                  SET PS-ERROR-YES     TO TRUE                 03050030
030600***              END-IF                                           03060030
030700***          ELSE                                                 03070030
030800***              SET PS-ERROR-YES         TO TRUE                 03080030
030900***          END-IF                                               03090030
031000         END-IF                                                   03100001
031100     END-IF.                                                      03110001
031200                                                                  03120001
031300 2000-OPEN-DA-BOX.                                                03130001
031400     IF KRPRPM-FUNC-TXT = 'Y'                                     03140001
031500         MOVE ' PCKUT074 START 2000- PARA '     TO PV-LOG-MSG     03150008
031600         PERFORM 9900-WRITE-LOG                                   03160002
031700     END-IF.                                                      03170001
031800                                                                  03180001
031900     PERFORM 3000-MANAGE-ASSIGNMENT                               03190001
032000     IF PS-ERROR-NO                                               03200001
032100         PERFORM 4000-CREATE-BUSINESS-EVENT                       03210001
032200     END-IF.                                                      03220001
032300                                                                  03230001
032301*                                                                 03230136
032310** DMH BEGIN - 10/12 - CREATE SUT_OTBND_CART                      03231036
032311*                                                                 03231136
032312     SET  PS-CARTON-ON-TLBVRDA-NO  TO  TRUE                       03231252
032313                                                                  03231352
032314     IF PS-ERROR-NO                                               03231452
032315        PERFORM 6000-CHECK-VIRTUAL-LABEL                          03231552
032316     END-IF.                                                      03231652
032317                                                                  03231752
032318     IF PS-CARTON-ON-TLBVRDA                                      03231852
032319        CONTINUE                                                  03231952
032320     ELSE                                                         03232052
032321         IF PS-ERROR-NO                                           03232152
032322             PERFORM 5000-CREATE-OTBND-CART                       03232252
032323         END-IF                                                   03232352
032324     END-IF.                                                      03232452
032325                                                                  03232552
032326     PERFORM 5037-COMMIT.                                         03232652
032327*                                                                 03232752
032328** DMH END   - 10/12 - CREATE SUT_OTBND_CART                      03232852
032329*                                                                 03232952
032330                                                                  03233036
032400     IF KRPRPM-FUNC-TXT = 'Y'                                     03240001
032500         MOVE ' PCKUT074 END 2000- PARA '     TO PV-LOG-MSG       03250008
032600         PERFORM 9900-WRITE-LOG                                   03260002
032700     END-IF.                                                      03270001
032800 3000-MANAGE-ASSIGNMENT.                                          03280001
032900     IF KRPRPM-FUNC-TXT = 'Y'                                     03290001
033000         MOVE ' PCKUT074 START 3000- PARA '     TO PV-LOG-MSG     03300008
033100         PERFORM 9900-WRITE-LOG                                   03310002
033200     END-IF.                                                      03320001
033300                                                                  03330001
033400     PERFORM 3120-DETERMINE-MOD-NBR.                              03340001
033500                                                                  03350001
033600     PERFORM 7050-SELECT-TP2LMOD.                                 03360001
033700     IF P2LMOD-MODU-MDSE-TYP-CDE = 'H'                            03370001
033800         MOVE 'HRTW '                  TO P2LMOD-DFLT-STR-ZN-ID   03380001
033900     END-IF.                                                      03390001
034000                                                                  03400001
034100     IF PS-ERROR-NO                                               03410001
034200         PERFORM 8450-LINK-DLKUT410                               03420010
034300     END-IF.                                                      03430001
034400     IF KRPRPM-FUNC-TXT = 'Y'                                     03440001
034500         MOVE ' PCKUT074 END 3000- PARA '     TO PV-LOG-MSG       03450008
034600         PERFORM 9900-WRITE-LOG                                   03460002
034700     END-IF.                                                      03470001
034800                                                                  03480001
034900/                                                                 03490001
035000 3120-DETERMINE-MOD-NBR.                                          03500001
035100     IF KRPRPM-FUNC-TXT = 'Y'                                     03510001
035200         MOVE ' PCKUT074 START 3120- PARA '     TO PV-LOG-MSG     03520008
035300         PERFORM 9900-WRITE-LOG                                   03530002
035400     END-IF.                                                      03540001
035500                                                                  03550001
035600     MOVE PC245-LOCATION-NM           TO PV-HOLD-LOCATION.        03560001
035700     PERFORM VARYING PV-LENGTH FROM 10 BY -1                      03570001
035800             UNTIL PV-HOLD-LOCATION (PV-LENGTH:1) NOT = SPACES    03580001
035900         ADD 1                        TO PV-DUMMY                 03590001
036000     END-PERFORM.                                                 03600001
036100                                                                  03610001
036200     EVALUATE PV-LENGTH                                           03620001
036300         WHEN 4                                                   03630001
036400             MOVE PV-HOLD-LOCATION(1:1)                           03640001
036500                                      TO DK-MODU-NBR              03650001
036600         WHEN 5                                                   03660001
036700             MOVE PV-HOLD-LOCATION(1:2)                           03670001
036800                                      TO DK-MODU-NBR              03680001
036900         WHEN OTHER                                               03690001
037000             MOVE ZEROES              TO DK-MODU-NBR              03700001
037100     END-EVALUATE.                                                03710001
037200     IF KRPRPM-FUNC-TXT = 'Y'                                     03720001
037300         MOVE ' PCKUT074 END 3120- PARA '     TO PV-LOG-MSG       03730008
037400         PERFORM 9900-WRITE-LOG                                   03740002
037500     END-IF.                                                      03750001
037600/                                                                 03760001
037700 4000-CREATE-BUSINESS-EVENT.                                      03770001
037800     IF KRPRPM-FUNC-TXT = 'Y'                                     03780001
037900         MOVE ' PCKUT074 START 4000- PARA '     TO PV-LOG-MSG     03790008
038000         PERFORM 9900-WRITE-LOG                                   03800002
038100     END-IF.                                                      03810001
038200                                                                  03820001
038300*    GET THE NEXT ASSIGNMENT SEQUENCE NUMBER                      03830001
038400     PERFORM 8400-CALL-DLKUP024.                                  03840015
038500                                                                  03850001
038600*    UPDATE EAI TABLES                                            03860001
038700     IF PS-ERROR-NO                                               03870001
038800         PERFORM 8410-CALL-XLKUP046                               03880015
038900     END-IF.                                                      03890001
039000     IF KRPRPM-FUNC-TXT = 'Y'                                     03900001
039100         MOVE ' PCKUT074 END 4000- PARA '     TO PV-LOG-MSG       03910008
039200         PERFORM 9900-WRITE-LOG                                   03920002
039300     END-IF.                                                      03930001
039400                                                                  03940001
044110******************************************************************04411036
044111* THIS LOGIC IS BEING ADDED SO THAT WE CAN CLAIM THE SML NUMBER  *04411136
044112* AS SOON AS THE CARTON IS OPENED IN P2L                         *04411236
044113* THIS WILL PREVENT THIS SML FROM ALSO BEING USED BY ANOTHER     *04411336
044114* APPLICATION (EX: MASTER CONTAINER)                             *04411436
044115*                                                                *04411536
044120** DMH BEGIN - 10/12 - CREATE SUT_OTBND_CART                     *04412036
044121******************************************************************04412136
044150 5000-CREATE-OTBND-CART.                                          04415036
044151                                                                  04415136
044152     IF KRPRPM-FUNC-TXT = 'Y'                                     04415236
044153         MOVE ' 5000-CREATE-OTBND-CART    '     TO PV-LOG-MSG     04415336
044154         PERFORM 9900-WRITE-LOG                                   04415436
044155     END-IF.                                                      04415536
044156                                                                  04415636
044157     MOVE PC245-BOX-BAR-CODE-NBR      TO PV-SML-WORK              04415748
044158                                         PC160-BTCH-BARCODE.      04415847
044159                                                                  04415947
044173     PERFORM 5005-BUILD-OPEN-DATE.                                04417338
044178                                                                  04417836
044179     MOVE PV-SML-18                TO SUT00024-SHIPT-UNT-ID       04417947
044180                                      SUT00024-PRNT-CART-ID       04418036
044181                                      SUT00024-ORIG-CART-ID.      04418136
044182                                                                  04418236
044184     MOVE PC245-DC-NBR             TO SUT00024-ORGN-LOC-NBR.      04418436
044185     MOVE PC160-BTCH-SML-BC-DIVERT-CDE                            04418536
044186                                   TO SUT00024-DEST-LOC-NBR.      04418636
044187                                                                  04418736
044188     IF  P2LMOD-MODU-MDSE-TYP-CDE = 'F'                           04418836
044189         MOVE 'JWL'                TO SUT00024-CART-SRC-CDE       04418936
044190     ELSE                                                         04419036
044191         MOVE 'P2L'                TO SUT00024-CART-SRC-CDE       04419136
044192     END-IF.                                                      04419236
044193                                                                  04419336
044194     MOVE PV-OPEN-DATE             TO SUT00024-CRE-DTE.           04419436
044195     MOVE PV-OPEN-TIME             TO SUT00024-CRE-TM.            04419536
044196     MOVE PC245-BOXOPEN-USER-ID    TO SUT00024-CRE-USR-ID.        04419636
044197     MOVE 'PCKUT074'               TO SUT00024-CRE-PGM-NM.        04419736
044198     MOVE 'N'                      TO SUT00024-MSTR-CART-IND.     04419836
044202     MOVE ZERO                     TO SUT00024-CART-RVSN-NBR.     04420236
044204     MOVE 'Y'                      TO SUT00024-ACTV-IND.          04420436
044207                                                                  04420736
044209     MOVE PV-SML-18                TO SUT00028-SHIPT-UNT-ID.      04420947
044210     MOVE ZEROES                   TO SUT00028-TRN-NBR.           04421036
044211     MOVE ZEROES                   TO SUT00028-RCVR-SEQ-NBR.      04421136
044212     MOVE ZEROES                   TO SUT00028-TRN-LNE-NBR.       04421236
044213     MOVE 'PO'                     TO SUT00028-TRN-TYP-CDE.       04421336
044214     MOVE ZEROES                   TO SUT00028-UPC-NBR.           04421436
044215     MOVE ZEROES                   TO SUT00028-SHPD-UNT-QTY.      04421536
044220                                                                  04422036
044221     PERFORM 5020-CREATE-OTBND-CART.                              04422136
044222                                                                  04422236
044225     IF KRPRPM-FUNC-TXT = 'Y'                                     04422536
044226         MOVE ' 5000-CREATE-OTBND-CART  '     TO PV-LOG-MSG       04422636
044227         PERFORM 9900-WRITE-LOG                                   04422736
044228     END-IF.                                                      04422836
044229                                                                  04422936
044230                                                                  04423036
044231******************************************************************04423136
044232* BUILD THE CREATE DATE/TIME FROM DATE RECEIVED FROM THE LABOR   *04423236
044233* EVENT.                                                         *04423336
044234*                                                                *04423436
044235** DMH BEGIN - 10/12 - CREATE SUT_OTBND_CART                     *04423536
044236******************************************************************04423636
044237 5005-BUILD-OPEN-DATE.                                            04423738
044238                                                                  04423836
044239     IF KRPRPM-FUNC-TXT = 'Y'                                     04423936
044240         MOVE ' 5005-BUILD-OPEN-DATE    '     TO PV-LOG-MSG       04424036
044241         PERFORM 9900-WRITE-LOG                                   04424136
044242     END-IF.                                                      04424236
044243                                                                  04424336
044244     STRING                                                       04424436
044245          PC245-BOXOPEN-DATE-YYYY                                 04424536
044246          '-'                                                     04424636
044247          PC245-BOXOPEN-DATE-MM                                   04424736
044248          '-'                                                     04424836
044249          PC245-BOXOPEN-DATE-DD                                   04424936
044250          DELIMITED BY SIZE                                       04425036
044251          INTO PV-OPEN-DATE.                                      04425136
044252                                                                  04425236
044253     STRING                                                       04425336
044254          PC245-BOXOPEN-TIME-HH                                   04425436
044255          '.'                                                     04425536
044256          PC245-BOXOPEN-TIME-MM                                   04425636
044257          '.'                                                     04425736
044258          PC245-BOXOPEN-TIME-SS                                   04425836
044259          DELIMITED BY SIZE                                       04425936
044260          INTO PV-OPEN-TIME.                                      04426036
044261                                                                  04426136
044262     IF KRPRPM-FUNC-TXT = 'Y'                                     04426236
044263         MOVE ' 5005-BUILD-OPEN-DATE    '     TO PV-LOG-MSG       04426336
044264         PERFORM 9900-WRITE-LOG                                   04426436
044265     END-IF.                                                      04426536
044266                                                                  04426636
044267                                                                  04426736
044268******************************************************************04426836
044269* CREATE SUT_OTBND_CART ENTRY ---  REVISION NUBMER = 0           *04426936
044270*                                                                *04427036
044271* IF THE SML ALREADY EXISTS WRITE AN ERROR RECORD TO TUPLDER     *04427136
044272*                                                                *04427236
044273** DMH BEGIN - 10/12 - CREATE SUT_OTBND_CART                     *04427336
044274******************************************************************04427436
044275 5020-CREATE-OTBND-CART.                                          04427536
044276                                                                  04427636
044277     IF KRPRPM-FUNC-TXT = 'Y'                                     04427736
044278         MOVE ' 5020-CREATE-OTBND-CART    '     TO PV-LOG-MSG     04427836
044279         PERFORM 9900-WRITE-LOG                                   04427936
044280     END-IF.                                                      04428036
044283                                                                  04428336
044284     EXEC SQL                                                     04428436
044285         INSERT INTO SUT_OTBND_CART                               04428536
044304             (SHIPT_UNT_ID                                        04430436
044305         ,    ORGN_LOC_NBR                                        04430536
044306         ,    DEST_LOC_NBR                                        04430636
044307         ,    CART_SRC_CDE                                        04430736
044308         ,    CRE_DTE                                             04430845
044309         ,    CRE_TM                                              04430945
044310         ,    CRE_USR_ID                                          04431045
044311         ,    CRE_PGM_NM                                          04431145
044312         ,    MSTR_CART_IND                                       04431236
044313         ,    PRNT_CART_ID                                        04431336
044314         ,    ORIG_CART_ID                                        04431436
044315         ,    CART_RVSN_NBR                                       04431545
044317         ,    ACTV_IND                                            04431736
044318         ,    CART_TYP_CDE                                        04431836
044319         )                                                        04431936
044320             VALUES                                               04432036
044321            (:SUT00024-SHIPT-UNT-ID                               04432140
044322         ,   :SUT00024-ORGN-LOC-NBR                               04432236
044323         ,   :SUT00024-DEST-LOC-NBR                               04432336
044324         ,   :SUT00024-CART-SRC-CDE                               04432436
044325         ,   :PV-OPEN-DATE                                        04432545
044326         ,   :PV-OPEN-TIME                                        04432645
044327         ,   :SUT00024-CRE-USR-ID                                 04432745
044328         ,   :SUT00024-CRE-PGM-NM                                 04432845
044329         ,   :SUT00024-MSTR-CART-IND                              04432936
044330         ,   :SUT00024-PRNT-CART-ID                               04433036
044331         ,   :SUT00024-ORIG-CART-ID                               04433136
044332         ,   :SUT00024-CART-RVSN-NBR                              04433245
044334         ,   :SUT00024-ACTV-IND                                   04433445
044335         ,   'S'                                                  04433536
044336         )                                                        04433636
044337         END-EXEC                                                 04433736
044338                                                                  04433836
044339     EVALUATE TRUE                                                04433936
044340         WHEN SQLCODE = ZERO                                      04434036
044341              PERFORM 5030-CREATE-OTBND-UPC                       04434136
044342              PERFORM 5035-CREATE-OTBND-LOC                       04434249
044344                                                                  04434451
044345         WHEN SQLCODE = -803                                      04434551
044346              PERFORM 5040-CHECK-CART-SOURCE                      04434651
044347                                                                  04434751
044348         WHEN SQLCODE = -904                                      04434851
044349         WHEN SQLCODE = -911                                      04434951
044350         WHEN SQLCODE = -913                                      04435051
044351             MOVE SQLCODE             TO PV-DISP-SQLCODE          04435151
044352             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04435251
044353             DISPLAY ' PCKUT074 - 5020 - '                        04435351
044354                     ' SQLCODE:'         PV-DISP-SQLCODE          04435451
044355                     ' SUT_OTBND_CART '  PV-SML-18                04435551
044356                     ' MOD:'             DK-MODU-NBR              04435651
044357             MOVE '5020-'             TO PV-ERROR-PARA            04435751
044358             MOVE 'SQL ERROR - SUT_OTBND_CART'                    04435851
044359                                      TO PV-ERROR-TEXT            04435951
044360             PERFORM 9700-SQL-ERROR                               04436051
044361             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04436151
044362             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04436251
044363             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04436351
044364             PERFORM 9900-WRITE-LOG                               04436451
044365                                                                  04436551
044366         WHEN SQLWARN0 NOT = SPACES                               04436651
044367         WHEN SQLCODE  NOT = ZERO                                 04436751
044368             MOVE SQLCODE             TO PV-DISP-SQLCODE          04436851
044369             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04436951
044370             DISPLAY ' PCKUT074 - 5020 - '                        04437051
044371                     ' SQLCODE:'         PV-DISP-SQLCODE          04437151
044372                     ' SUT_OTBND_CART '  PV-SML-18                04437251
044373                     ' MOD:'             DK-MODU-NBR              04437351
044376                     ' DATE:'            PV-OPEN-DATE             04437645
044377                     ' TIME:'            PV-OPEN-TIME             04437745
044378                                                                  04437846
044379             MOVE SUT00024-SHIPT-UNT-ID  TO  PV-DISP-SML          04437946
044380             MOVE SUT00024-ORGN-LOC-NBR  TO  PV-DISP-ORGN         04438046
044381             MOVE SUT00024-DEST-LOC-NBR  TO  PV-DISP-DEST         04438146
044388             DISPLAY ' PCKUT074:'        PV-DISP-SML              04438846
044389                     ' '                 PV-DISP-ORGN             04438946
044390                     ' '                 PV-DISP-DEST             04439046
044391                     ' '                 SUT00024-CART-SRC-CDE    04439146
044392                     ' '                 SUT00024-MSTR-CART-IND   04439246
044393                                                                  04439346
044394              MOVE SUT00024-PRNT-CART-ID  TO  PV-DISP-PRNT        04439446
044395              MOVE SUT00024-ORIG-CART-ID  TO  PV-DISP-ORIG        04439546
044396              MOVE SUT00024-CART-RVSN-NBR TO  PV-DISP-RVSN        04439646
044398              DISPLAY ' PCKUT074:'       PV-DISP-PRNT             04439846
044399                      ' '                PV-DISP-ORIG             04439946
044400                      ' '                PV-DISP-RVSN             04440046
044401                      ' '                SUT00024-ACTV-IND        04440146
044402                                                                  04440246
044403             DISPLAY ' PCKUT074:'        PC245-COMMAREA           04440345
044404             MOVE '5020-'             TO PV-ERROR-PARA            04440437
044405             MOVE 'SQL ERROR - SUT_OTBND_CART'                    04440537
044406                                      TO PV-ERROR-TEXT            04440637
044407             PERFORM 9700-SQL-ERROR                               04440737
044408             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04440837
044409             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04440937
044410             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04441037
044411             PERFORM 9900-WRITE-LOG                               04441137
044412     END-EVALUATE.                                                04441236
044413                                                                  04441336
044414     IF KRPRPM-FUNC-TXT = 'Y'                                     04441436
044415         MOVE ' 5020-CREATE-OTBND-CART  '     TO PV-LOG-MSG       04441536
044416         PERFORM 9900-WRITE-LOG                                   04441636
044417     END-IF.                                                      04441736
044418                                                                  04441836
044419                                                                  04441936
044420******************************************************************04442036
044421* CREATE SUT_OTBND_UPC  ENTRY ---  0 ENTRY NEEDED                *04442136
044422*                                                                *04442236
044423** DMH BEGIN - 10/12 - CREATE SUT_OTBND_CART                     *04442336
044424******************************************************************04442436
044425 5030-CREATE-OTBND-UPC.                                           04442536
044426                                                                  04442636
044427     IF KRPRPM-FUNC-TXT = 'Y'                                     04442736
044428         MOVE ' 5030-CREATE-OTBND-UPC     '     TO PV-LOG-MSG     04442836
044429         PERFORM 9900-WRITE-LOG                                   04442936
044430     END-IF.                                                      04443036
044431                                                                  04443136
044432     EXEC SQL                                                     04443236
044433         INSERT INTO SUT_OTBND_UPC                                04443336
044434             (                                                    04443436
044435                 SHIPT_UNT_ID                                     04443536
044436             ,   TRN_NBR                                          04443636
044437             ,   TRN_LNE_NBR                                      04443736
044438             ,   TRN_TYP_CDE                                      04443836
044439             ,   UPC_NBR                                          04443936
044440             ,   SHPD_UNT_QTY                                     04444036
044441             ,   RCVR_SEQ_NBR                                     04444136
044442             )                                                    04444236
044443             VALUES                                               04444336
044444             (                                                    04444436
044445                 :SUT00028-SHIPT-UNT-ID                           04444540
044446             ,   :SUT00028-TRN-NBR                                04444640
044447             ,   :SUT00028-TRN-LNE-NBR                            04444740
044448             ,   :SUT00028-TRN-TYP-CDE                            04444840
044449             ,   :SUT00028-UPC-NBR                                04444940
044450             ,   :SUT00028-SHPD-UNT-QTY                           04445036
044451             ,   :SUT00028-RCVR-SEQ-NBR                           04445140
044452             )                                                    04445236
044453     END-EXEC.                                                    04445336
044454                                                                  04445436
044455     EVALUATE TRUE                                                04445536
044456         WHEN SQLCODE = ZERO                                      04445636
044457             CONTINUE                                             04445736
044458         WHEN SQLCODE = -904                                      04445837
044459         WHEN SQLCODE = -911                                      04445937
044460         WHEN SQLCODE = -913                                      04446037
044461             MOVE SQLCODE             TO PV-DISP-SQLCODE          04446137
044462             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04446237
044463             DISPLAY ' PCKUT074 - 5030 - '                        04446337
044464                     ' SQLCODE:'         PV-DISP-SQLCODE          04446437
044465                     ' SUT_OTBND_UPC  '  PV-SML-18                04446547
044466                     ' MOD:'             DK-MODU-NBR              04446637
044467             MOVE '5030-'             TO PV-ERROR-PARA            04446737
044468             MOVE 'SQL ERROR - SUT_OTBND_UPC '                    04446837
044469                                      TO PV-ERROR-TEXT            04446937
044470             PERFORM 9700-SQL-ERROR                               04447037
044471             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04447137
044472             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04447237
044473             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04447337
044474             PERFORM 9900-WRITE-LOG                               04447437
044475                                                                  04447537
044476         WHEN SQLWARN0 NOT = SPACES                               04447637
044477         WHEN SQLCODE  NOT = ZERO                                 04447737
044478             MOVE SQLCODE             TO PV-DISP-SQLCODE          04447837
044479             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04447937
044480             DISPLAY ' PCKUT074 - 5030 - '                        04448037
044481                     ' SQLCODE:'         PV-DISP-SQLCODE          04448137
044482                     ' SUT_OTBND_UPC  '  PV-SML-18                04448247
044483                     ' MOD:'             DK-MODU-NBR              04448337
044484             MOVE '5030-'             TO PV-ERROR-PARA            04448437
044485             MOVE 'SQL ERROR - SUT_OTBND_UPC '                    04448537
044486                                      TO PV-ERROR-TEXT            04448637
044487             PERFORM 9700-SQL-ERROR                               04448737
044488             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04448837
044489             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04448937
044490             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04449037
044491             PERFORM 9900-WRITE-LOG                               04449137
044500     END-EVALUATE.                                                04450037
044505                                                                  04450536
044507     IF KRPRPM-FUNC-TXT = 'Y'                                     04450736
044508         MOVE ' 5030-CREATE-OTBND-UPC   '     TO PV-LOG-MSG       04450836
044509         PERFORM 9900-WRITE-LOG                                   04450936
044510     END-IF.                                                      04451036
044511                                                                  04451136
044512                                                                  04451249
044514******************************************************************04451449
044515* CREATE SUT_OTBND_LOC  ENTRY ---  0 ENTRY NEEDED                *04451549
044516*                                                                *04451649
044517** DMH BEGIN - 10/12 - CREATE SUT_OTBND_LOC                      *04451749
044518******************************************************************04451849
044520 5035-CREATE-OTBND-LOC.                                           04452049
044521                                                                  04452149
044522     IF KRPRPM-FUNC-TXT = 'Y'                                     04452249
044523         MOVE ' 5035-CREATE-OTBND-LOC     '     TO PV-LOG-MSG     04452349
044524         PERFORM 9900-WRITE-LOG                                   04452449
044525     END-IF.                                                      04452549
044526                                                                  04452649
044527     EXEC SQL                                                     04452749
044528         INSERT INTO SUT_OTBND_LOC                                04452849
044529             (                                                    04452949
044530              SHIPT_UNT_ID                                        04453049
044531             ,CRE_TMST                                            04453149
044532             ,OTBND_TRIP_ID                                       04453249
044533             ,LOC_NBR                                             04453349
044534             ,SCN_CDE                                             04453449
044535             ,CRE_USR_ID                                          04453549
044536             ,ACTV_CDE                                            04453649
044537             ,INBD_TRIP_ID                                        04453749
044542             )                                                    04454249
044543             VALUES                                               04454349
044544             (                                                    04454449
044545                 :SUT00028-SHIPT-UNT-ID                           04454549
044546             ,    CURRENT TIMESTAMP                               04454649
044547             ,    NULL                                            04454749
044548             ,   :SUT00024-ORGN-LOC-NBR                           04454849
044549             ,   'LTP'                                            04454949
044550             ,   'PCKUT074'                                       04455049
044551             ,   'A'                                              04455149
044552             ,    0                                               04455250
044553             )                                                    04455349
044554     END-EXEC.                                                    04455449
044555                                                                  04455549
044556     EVALUATE TRUE                                                04455649
044557         WHEN SQLCODE = ZERO                                      04455749
044558             CONTINUE                                             04455849
044559         WHEN SQLCODE = -904                                      04455949
044560         WHEN SQLCODE = -911                                      04456049
044561         WHEN SQLCODE = -913                                      04456149
044562             MOVE SQLCODE             TO PV-DISP-SQLCODE          04456249
044563             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04456349
044564             DISPLAY ' PCKUT074 - 5035 - '                        04456449
044565                     ' SQLCODE:'         PV-DISP-SQLCODE          04456549
044566                     ' SUT_OTBND_LOC  '  PV-SML-18                04456649
044567                     ' MOD:'             DK-MODU-NBR              04456749
044568             MOVE '5035-'             TO PV-ERROR-PARA            04456849
044569             MOVE 'SQL ERROR - SUT_OTBND_LOC '                    04456949
044570                                      TO PV-ERROR-TEXT            04457049
044571             PERFORM 9700-SQL-ERROR                               04457149
044572             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04457249
044573             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04457349
044574             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04457449
044575             PERFORM 9900-WRITE-LOG                               04457549
044576                                                                  04457649
044577         WHEN SQLWARN0 NOT = SPACES                               04457749
044578         WHEN SQLCODE  NOT = ZERO                                 04457849
044579             MOVE SQLCODE             TO PV-DISP-SQLCODE          04457949
044580             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04458049
044581             DISPLAY ' PCKUT074 - 5035 - '                        04458149
044582                     ' SQLCODE:'         PV-DISP-SQLCODE          04458249
044583                     ' SUT_OTBND_LOC  '  PV-SML-18                04458349
044584                     ' MOD:'             DK-MODU-NBR              04458449
044585             MOVE '5035-'             TO PV-ERROR-PARA            04458549
044586             MOVE 'SQL ERROR - SUT_OTBND_LOC '                    04458649
044587                                      TO PV-ERROR-TEXT            04458749
044588             PERFORM 9700-SQL-ERROR                               04458849
044589             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04458949
044590             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04459049
044591             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04459149
044592             PERFORM 9900-WRITE-LOG                               04459249
044593     END-EVALUATE.                                                04459349
044594                                                                  04459449
044595     IF KRPRPM-FUNC-TXT = 'Y'                                     04459549
044596         MOVE ' 5035-CREATE-OTBND-LOC   '     TO PV-LOG-MSG       04459649
044597         PERFORM 9900-WRITE-LOG                                   04459749
044598     END-IF.                                                      04459849
044601                                                                  04460149
044602                                                                  04460251
044604******************************************************************04460451
044605*                                                                *04460551
044606******************************************************************04460651
044607 5037-COMMIT.                                                     04460751
044609                                                                  04460951
044610     EXEC SQL                                                     04461051
044611          COMMIT                                                  04461151
044612     END-EXEC.                                                    04461251
044613                                                                  04461351
044614     EVALUATE TRUE                                                04461451
044615         WHEN SQLCODE = ZERO                                      04461551
044616         WHEN SQLCODE = +100                                      04461651
044617             CONTINUE                                             04461751
044618         WHEN OTHER                                               04461851
044619              DISPLAY 'PCKUT074 - ERROR ON COMMIT'                04461951
044620     END-EVALUATE.                                                04462051
044621                                                                  04462151
044622                                                                  04462251
044623                                                                  04462351
044624                                                                  04462451
044625******************************************************************04462551
044626* SML IS ALREADY IN THE OUTBOUND CARTON TABLE                    *04462651
044627* CHECK TO SEE WHAT THE CREATE SOURCE IS FOR THE CARTON          *04462751
044628** DMH BEGIN - 10/12 -        SUT_OTBND_CART                     *04462851
044629******************************************************************04462951
044630 5040-CHECK-CART-SOURCE.                                          04463051
044631                                                                  04463151
044632     IF KRPRPM-FUNC-TXT = 'Y'                                     04463251
044633         MOVE ' 5040-CHECK-CART-SOURCE    '     TO PV-LOG-MSG     04463351
044634         PERFORM 9900-WRITE-LOG                                   04463451
044635     END-IF.                                                      04463551
044636                                                                  04463651
044637     EXEC SQL                                                     04463751
044638         SELECT  CART_SRC_CDE                                     04463851
044639           INTO :PV-CART-SRC                                      04463951
044640           FROM  SUT_OTBND_CART                                   04464051
044641          WHERE  SHIPT_UNT_ID  =  :SUT00024-SHIPT-UNT-ID          04464151
044642           WITH UR                                                04464251
044643     END-EXEC.                                                    04464351
044644                                                                  04464451
044645     EVALUATE TRUE                                                04464551
044646         WHEN SQLCODE = ZERO                                      04464651
044647              IF  PV-CART-SRC  =  SUT00024-CART-SRC-CDE           04464751
044648                  MOVE '103'        TO UPLDER-ERR-CDE             04464851
044649              ELSE                                                04464951
044650                  MOVE '104'        TO UPLDER-ERR-CDE             04465051
044651              END-IF                                              04465151
044652              PERFORM 5050-CREATE-TUPLDER                         04465251
044653                                                                  04465351
044654         WHEN SQLCODE = -904                                      04465451
044655         WHEN SQLCODE = -911                                      04465551
044656         WHEN SQLCODE = -913                                      04465651
044657             MOVE SQLCODE             TO PV-DISP-SQLCODE          04465751
044658             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04465851
044659             DISPLAY ' PCKUT074 - 5040 - '                        04465951
044660                     ' SQLCODE:'         PV-DISP-SQLCODE          04466051
044661                     ' SUT_OTBND_CART '  PV-SML-18                04466151
044662                     ' MOD:'             DK-MODU-NBR              04466251
044663             MOVE '5040-'             TO PV-ERROR-PARA            04466351
044664             MOVE 'SQL ERROR - SUT_OTBND_CART'                    04466451
044665                                      TO PV-ERROR-TEXT            04466551
044666             PERFORM 9700-SQL-ERROR                               04466651
044667             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04466751
044668             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04466851
044669             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04466951
044670             PERFORM 9900-WRITE-LOG                               04467051
044671                                                                  04467151
044672         WHEN SQLWARN0 NOT = SPACES                               04467251
044673         WHEN SQLCODE  NOT = ZERO                                 04467351
044674             MOVE SQLCODE             TO PV-DISP-SQLCODE          04467451
044675             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04467551
044676             DISPLAY ' PCKUT074 - 5040 - '                        04467651
044677                     ' SQLCODE:'         PV-DISP-SQLCODE          04467751
044678                     ' SUT_OTBND_CART '  PV-SML-18                04467851
044679                     ' MOD:'             DK-MODU-NBR              04467951
044680             MOVE '5040-'             TO PV-ERROR-PARA            04468051
044681             MOVE 'SQL ERROR - SUT_OTBND_CART'                    04468151
044682                                      TO PV-ERROR-TEXT            04468251
044683             PERFORM 9700-SQL-ERROR                               04468351
044684             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04468451
044685             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04468551
044686             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04468651
044687             PERFORM 9900-WRITE-LOG                               04468751
044688     END-EVALUATE.                                                04468851
044689                                                                  04468951
044690     IF KRPRPM-FUNC-TXT = 'Y'                                     04469051
044691         MOVE ' 5040-CHECK-CART-SOURCE  '     TO PV-LOG-MSG       04469151
044692         PERFORM 9900-WRITE-LOG                                   04469251
044693     END-IF.                                                      04469351
044694                                                                  04469451
044695                                                                  04469551
044696******************************************************************04469651
044697* CREATE TUPLDER ROW IF THE SML IS ALREADY IN DATABASE           *04469751
044698*                                                                *04469851
044699** DMH BEGIN - 10/12 - CREATE SUT_OTBND_CART                     *04469951
044700******************************************************************04470051
044701 5050-CREATE-TUPLDER.                                             04470151
044702                                                                  04470251
044703     IF KRPRPM-FUNC-TXT = 'Y'                                     04470351
044704         MOVE ' 5050-CREATE-TUPLDER       '     TO PV-LOG-MSG     04470451
044705         PERFORM 9900-WRITE-LOG                                   04470551
044706     END-IF.                                                      04470651
044707                                                                  04470751
044708     INITIALIZE                       UPLDER-PKT-TXT              04470851
044709                                      UPLDER-UPLD-TRN-CDE         04470956
044710                                      PC059-UPLOAD-ERROR-RECORD   04471056
044711                                      PC059-ERROR-DATA.           04471156
044712                                                                  04471256
044713     SET  PC059-BOX-OPEN  TO  TRUE                                04471356
044715                                                                  04471556
044717     MOVE PC245-CRA-RET-CDE          TO  PC059-BO-RET-CDE.        04471756
044718     MOVE PC245-DC-NBR               TO  PC059-BO-DC-NBR.         04471856
044719     MOVE PC245-LOCATION-NM          TO  PC059-BO-LOCATION-NM.    04471956
044720     MOVE PC245-BOX-BAR-CODE-NBR     TO  PC059-BO-BOX-BARCODE.    04472056
044721     MOVE PC245-BOXOPEN-DATE         TO  PC059-BO-BOXOPEN-DATE.   04472156
044722     MOVE PC245-BOXOPEN-TIME         TO  PC059-BO-BOXOPEN-TIME.   04472256
044723     MOVE PC245-BOXOPEN-USER-ID      TO  PC059-BO-PICKER-BARCODE. 04472356
044724     MOVE PC245-BOXOPEN-USER-ID      TO  PC059-BO-PICKER-NAME.    04472456
044725                                                                  04472556
044727     MOVE PC059-UPLOAD-ERROR-RECORD  TO UPLDER-PKT-TXT.           04472756
044728                                                                  04472856
044732     MOVE ZEROES                     TO UPLDER-UPLD-SEQ-NBR.      04473256
044733                                                                  04473356
044734     DISPLAY  ' '                                                 04473456
044735     DISPLAY  ' PCKUT074 - 5050 - SML ALREADY IN DATABASE'        04473556
044736     DISPLAY  ' PCKUT074 - 5050 - '                               04473656
044737                UPLDER-PKT-TXT.                                   04473756
044738     DISPLAY  ' '                                                 04473856
044739                                                                  04473956
044740     EXEC SQL                                                     04474056
044741     INSERT INTO TUPLDER                                          04474156
044742         (                                                        04474256
044743           OPER_UNT_ID                                            04474356
044744         , UPLD_TRN_CDE                                           04474456
044745         , ERR_CDE                                                04474556
044746         , PRC_TMST                                               04474656
044747         , UPLD_SEQ_NBR                                           04474756
044748         , PKT_TXT                                                04474856
044749         )                                                        04474956
044750         VALUES                                                   04475056
044751         (                                                        04475156
044752           :DK-OPER-UNT-ID                                        04475256
044753         , 'A'                                                    04475356
044754         , :UPLDER-ERR-CDE                                        04475456
044755         , CURRENT TIMESTAMP                                      04475556
044756         , :UPLDER-UPLD-SEQ-NBR                                   04475656
044757         , :UPLDER-PKT-TXT                                        04475756
044758         )                                                        04475856
044759     END-EXEC.                                                    04475956
044760                                                                  04476056
044761     EVALUATE TRUE                                                04476156
044762         WHEN SQLCODE = ZERO                                      04476256
044763             CONTINUE                                             04476356
044764         WHEN SQLCODE = -904                                      04476456
044765         WHEN SQLCODE = -911                                      04476556
044766         WHEN SQLCODE = -913                                      04476656
044767             MOVE SQLCODE             TO PV-DISP-SQLCODE          04476756
044768             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04476856
044769             DISPLAY ' PCKUT074 - 5050 - '                        04476956
044770                     ' SQLCODE:'         PV-DISP-SQLCODE          04477056
044771                     ' TUPLDER '         PV-SML-18                04477156
044772                     ' MOD:'             DK-MODU-NBR              04477256
044773             MOVE '5050-'             TO PV-ERROR-PARA            04477356
044774             MOVE 'SQL ERROR - TUPLDER       '                    04477456
044775                                      TO PV-ERROR-TEXT            04477556
044776             PERFORM 9700-SQL-ERROR                               04477656
044777             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04477756
044778             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04477856
044779             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04477956
044780             PERFORM 9900-WRITE-LOG                               04478056
044781                                                                  04478156
044782         WHEN SQLWARN0 NOT = SPACES                               04478256
044783         WHEN SQLCODE  NOT = ZERO                                 04478356
044784             MOVE SQLCODE             TO PV-DISP-SQLCODE          04478456
044785             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04478556
044786             DISPLAY ' PCKUT074 - 5050 - '                        04478656
044787                     ' SQLCODE:'         PV-DISP-SQLCODE          04478756
044788                     ' UPLDER         '  PV-SML-18                04478856
044789                     ' MOD:'             DK-MODU-NBR              04478956
044790             MOVE '5050-'             TO PV-ERROR-PARA            04479056
044791             MOVE 'SQL ERROR - TUPLDER       '                    04479156
044792                                      TO PV-ERROR-TEXT            04479256
044793             PERFORM 9700-SQL-ERROR                               04479356
044794             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04479456
044795             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04479556
044796             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04479656
044797             PERFORM 9900-WRITE-LOG                               04479756
044798     END-EVALUATE.                                                04479856
044799                                                                  04479956
044800     IF KRPRPM-FUNC-TXT = 'Y'                                     04480056
044801         MOVE ' 5050-CREATE-TUPLDER     '     TO PV-LOG-MSG       04480156
044802         PERFORM 9900-WRITE-LOG                                   04480256
044803     END-IF.                                                      04480356
044804                                                                  04480456
044805                                                                  04480556
044806******************************************************************04480656
044807* CHECK TO SEE IF A VIRTUAL LABEL HAS BEEN CREATED FOR THIS SML  *04480756
044808*                                                                *04480856
044809** DMH BEGIN - 10/12 - CHECK VIRTUAL LABEL                       *04480956
044810******************************************************************04481056
044811 6000-CHECK-VIRTUAL-LABEL.                                        04481156
044812                                                                  04481256
044813     IF KRPRPM-FUNC-TXT = 'Y'                                     04481356
044814         MOVE ' 6000-CHECK-VIRTUAL LABEL  '     TO PV-LOG-MSG     04481456
044815         PERFORM 9900-WRITE-LOG                                   04481556
044816     END-IF.                                                      04481656
044820                                                                  04482052
044830     PERFORM 6005-CHECK-TLBVRDA-TABLE.                            04483052
044831                                                                  04483152
044835     IF KRPRPM-FUNC-TXT = 'Y'                                     04483552
044836         MOVE ' 6000-CHECK-VIRTUAL LABEL  '     TO PV-LOG-MSG     04483652
044837         PERFORM 9900-WRITE-LOG                                   04483752
044838     END-IF.                                                      04483852
044839                                                                  04483952
044840                                                                  04484052
044841******************************************************************04484152
044842* CHECK TO SEE IF A VIRTUAL LABEL HAS BEEN CREATED FOR THIS SML  *04484252
044843* IF CARTON IS ON TLBVRDA - THEN IT CANNOT BE USED IN P2L        *04484352
044844*                                                                *04484452
044845** DMH BEGIN - 10/12 - CHECK TLBVRDA LABEL                       *04484552
044846******************************************************************04484652
044847 6005-CHECK-TLBVRDA-TABLE.                                        04484752
044848                                                                  04484852
044849     IF KRPRPM-FUNC-TXT = 'Y'                                     04484952
044850         MOVE ' 6005-CHECK-TLBVRDA-TABLE  '     TO PV-LOG-MSG     04485052
044851         PERFORM 9900-WRITE-LOG                                   04485152
044852     END-IF.                                                      04485252
044853                                                                  04485352
044854     MOVE PC245-BOX-BAR-CODE-NBR      TO LBVRDA-BRCDE-NBR.        04485452
044855                                                                  04485552
044856     EXEC SQL                                                     04485652
044857         SELECT  LBL_ASG_IND                                      04485752
044858           INTO :LBVRDA-LBL-ASG-IND                               04485852
044859           FROM  TLBVRDA                                          04485952
044860          WHERE  BRCDE_NBR     =  :LBVRDA-BRCDE-NBR               04486052
044861           WITH UR                                                04486152
044862     END-EXEC.                                                    04486252
044863                                                                  04486352
044864     EVALUATE TRUE                                                04486452
044865         WHEN SQLCODE = ZERO                                      04486552
044866              SET PS-CARTON-ON-TLBVRDA  TO  TRUE                  04486655
044867              MOVE '105'            TO UPLDER-ERR-CDE             04486752
044870              PERFORM 5050-CREATE-TUPLDER                         04487052
044871                                                                  04487152
044872         WHEN SQLCODE = +100                                      04487252
044873              SET PS-CARTON-ON-TLBVRDA-NO TO TRUE                 04487354
044874                                                                  04487452
044876         WHEN SQLCODE = -904                                      04487652
044877         WHEN SQLCODE = -911                                      04487752
044878         WHEN SQLCODE = -913                                      04487852
044879             MOVE SQLCODE             TO PV-DISP-SQLCODE          04487952
044880             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04488052
044881             DISPLAY ' PCKUT074 - 6005 - '                        04488152
044882                     ' SQLCODE:'         PV-DISP-SQLCODE          04488252
044883                     ' TLBVRDA        '  PV-SML-18                04488352
044884                     ' MOD:'             DK-MODU-NBR              04488452
044885             MOVE '6005-'             TO PV-ERROR-PARA            04488552
044886             MOVE 'SQL ERROR - TLBVRDA       '                    04488652
044887                                      TO PV-ERROR-TEXT            04488752
044888             PERFORM 9700-SQL-ERROR                               04488852
044889             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04488952
044890             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04489052
044891             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04489152
044892             PERFORM 9900-WRITE-LOG                               04489252
044893                                                                  04489352
044894         WHEN SQLWARN0 NOT = SPACES                               04489452
044895         WHEN SQLCODE  NOT = ZERO                                 04489552
044896             MOVE SQLCODE             TO PV-DISP-SQLCODE          04489652
044897             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04489752
044898             DISPLAY ' PCKUT074 - 6005 - '                        04489852
044899                     ' SQLCODE:'         PV-DISP-SQLCODE          04489952
044900                     ' TLBVRDA        '  PV-SML-18                04490052
044901                     ' MOD:'             DK-MODU-NBR              04490152
044902             MOVE '6005-'             TO PV-ERROR-PARA            04490252
044903             MOVE 'SQL ERROR - TLBVRDA      T'                    04490352
044904                                      TO PV-ERROR-TEXT            04490452
044905             PERFORM 9700-SQL-ERROR                               04490552
044906             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04490652
044907             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04490752
044908             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04490852
044909             PERFORM 9900-WRITE-LOG                               04490952
044910     END-EVALUATE.                                                04491052
044911                                                                  04491152
044912                                                                  04491252
044913     IF KRPRPM-FUNC-TXT = 'Y'                                     04491352
044914         MOVE ' 6005-CHECK-TLBVRDA-TABLE  '     TO PV-LOG-MSG     04491452
044915         PERFORM 9900-WRITE-LOG                                   04491552
044916     END-IF.                                                      04491652
044917                                                                  04491752
044918                                                                  04491852
044929*                                                                 04492952
044930** DMH END   - 10/12 - CREATE SUT_OTBND_CART                      04493052
044931*                                                                 04493152
044932                                                                  04493252
044933                                                                  04493352
044934******************************************************************04493452
044935*                                                                *04493552
044936*                                                                *04493652
044937*                                                                *04493752
044938******************************************************************04493852
044939 7000-SELECT-TKRPRPM.                                             04493952
044940     IF KRPRPM-FUNC-TXT = 'Y'                                     04494052
044941         MOVE ' PCKUT074 START 7000- PARA '     TO PV-LOG-MSG     04494152
044942         PERFORM 9900-WRITE-LOG                                   04494252
044943     END-IF.                                                      04494352
044944                                                                  04494452
044945     MOVE PC245-DC-NBR                TO KRPRPM-LOC-ID.           04494552
044946     SET PS-P4-INTERFACE-NO           TO TRUE.                    04494652
044947     EXEC SQL                                                     04494752
044948         SELECT FUNC_TXT                                          04494852
044949         INTO :PS-P4-INTERFACE-SW                                 04494952
044950         FROM                                                     04495052
044951             TKRPRPM                                              04495152
044952         WHERE                                                    04495252
044953             LOC_ID                   = :KRPRPM-LOC-ID            04495352
044954         AND INTFC_SYS_CDE            = 'DLX'                     04495452
044955         AND SYS_PRC_FUNC_CDE         = 'DLP2LI'                  04495552
044956         WITH UR                                                  04495652
044957     END-EXEC.                                                    04495752
044958                                                                  04495852
044959     EVALUATE TRUE                                                04495952
044960         WHEN SQLCODE = ZERO                                      04496052
044961             CONTINUE                                             04496152
044962         WHEN OTHER                                               04496252
044963***                                                               04496352
044964*** DMH ADDED DISPLAYS - 8/21/2007                                04496452
044965***                                                               04496552
044966             MOVE SQLCODE             TO PV-DISP-SQLCODE          04496652
044967             MOVE KRPRPM-LOC-ID       TO PV-DISP-OPER             04496752
044968             DISPLAY ' PCKUT074 - 7000 - '                        04496852
044969                     ' SQLCODE:'         PV-DISP-SQLCODE          04496952
044970                     ' TKRPRPM '                                  04497052
044971                     ' DLX  DLP2LI'                               04497152
044972***                                                               04497252
044973             MOVE '7000-'             TO PV-ERROR-PARA            04497352
044974             MOVE 'SQL ERROR - TKRPRPM'                           04497452
044975                                      TO PV-ERROR-TEXT            04497552
044976             PERFORM 9700-SQL-ERROR                               04497652
044977                                                                  04497752
044978     END-EVALUATE.                                                04497852
044979                                                                  04497952
044980     IF KRPRPM-FUNC-TXT = 'Y'                                     04498052
044981         MOVE ' PCKUT074 END 7000- PARA '     TO PV-LOG-MSG       04498152
044982         PERFORM 9900-WRITE-LOG                                   04498252
044983     END-IF.                                                      04498352
044984                                                                  04498452
044985                                                                  04498552
044986 7030-SELECT-TKRPRPM.                                             04498652
044987                                                                  04498752
044988     MOVE PC245-DC-NBR                TO KRPRPM-LOC-ID.           04498852
044989                                                                  04498952
044990     EXEC SQL                                                     04499052
044991         SELECT FUNC_TXT                                          04499152
044992         INTO :KRPRPM-FUNC-TXT                                    04499252
044993         FROM                                                     04499301
045000             TKRPRPM                                              04500001
045100         WHERE                                                    04510001
045200             LOC_ID                   = :KRPRPM-LOC-ID            04520001
045300         AND INTFC_SYS_CDE            = 'DLX'                     04530001
045400         AND SYS_PRC_FUNC_CDE         = 'DLPLDI'                  04540001
045500         AND CURRENT TIMESTAMP BETWEEN                            04550001
045600             FUNC_BEG_TMST AND FUNC_END_TMST                      04560001
045700         WITH UR                                                  04570001
045800     END-EXEC.                                                    04580001
045900                                                                  04590001
046000     EVALUATE TRUE                                                04600001
046100         WHEN SQLCODE = ZERO                                      04610001
046200             CONTINUE                                             04620001
046300         WHEN OTHER                                               04630001
046400***                                                               04640019
046500*** DMH ADDED DISPLAYS - 8/21/2007                                04650019
046600***                                                               04660019
046700             MOVE SQLCODE             TO PV-DISP-SQLCODE          04670019
046800             MOVE KRPRPM-LOC-ID       TO PV-DISP-OPER             04680019
046900             DISPLAY ' PCKUT074 - 7030 - '                        04690023
047000                     ' SQLCODE:'         PV-DISP-SQLCODE          04700019
047100                     ' TKRPRPM '                                  04710019
047200                     ' DLX  DLPLDI'                               04720019
047300***                                                               04730019
047400             MOVE '7030-'             TO PV-ERROR-PARA            04740019
047500             MOVE 'SQL ERROR - TKRPRPM'                           04750001
047600                                      TO PV-ERROR-TEXT            04760001
047700             PERFORM 9700-SQL-ERROR                               04770001
047800                                                                  04780001
047900     END-EVALUATE.                                                04790001
048000                                                                  04800001
048100 7050-SELECT-TP2LMOD.                                             04810001
048200     IF KRPRPM-FUNC-TXT = 'Y'                                     04820001
048300         MOVE ' PCKUT074 START 7050- PARA '     TO PV-LOG-MSG     04830008
048400         PERFORM 9900-WRITE-LOG                                   04840002
048500     END-IF.                                                      04850001
048600                                                                  04860001
048700     MOVE PC245-DC-NBR               TO DK-OPER-UNT-ID.           04870001
048800     EXEC SQL                                                     04880001
048900         SELECT                                                   04890001
049000             MODU_NBR                                             04900001
049100            ,DFLT_STR_ZN_ID                                       04910001
049200            ,MODU_MDSE_TYP_CDE                                    04920001
049300         INTO                                                     04930001
049400             :P2LMOD-MODU-NBR                                     04940001
049500            ,:P2LMOD-DFLT-STR-ZN-ID                               04950001
049600            ,:P2LMOD-MODU-MDSE-TYP-CDE                            04960001
049700         FROM                                                     04970001
049800             TP2LMOD                                              04980001
049900         WHERE                                                    04990001
050000             OPER_UNT_ID              = :DK-OPER-UNT-ID           05000001
050100         AND FCLTY_ID                 = 1                         05010001
050200         AND MODU_NBR                 = :DK-MODU-NBR              05020001
050300         WITH UR                                                  05030001
050400     END-EXEC.                                                    05040001
050500                                                                  05050001
050600     EVALUATE TRUE                                                05060001
050700         WHEN SQLCODE = ZERO                                      05070001
050800             CONTINUE                                             05080001
050900         WHEN SQLCODE = +100                                      05090001
051000***                                                               05100019
051100*** DMH ADDED DISPLAYS - 8/21/2007                                05110019
051200***                                                               05120019
051300             MOVE SQLCODE             TO PV-DISP-SQLCODE          05130019
051400             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             05140019
051500             DISPLAY ' PCKUT074 - 7050 - '                        05150023
051600                     ' SQLCODE:'         PV-DISP-SQLCODE          05160019
051700                     ' TP2LMOD '                                  05170019
051800                     ' MOD:'             DK-MODU-NBR              05180019
051900***                                                               05190019
052000             MOVE '7050-'             TO PV-ERROR-PARA            05200001
052100             MOVE 'STR ZN NOTFOUND'   TO PV-ERROR-TEXT            05210001
052200             PERFORM 9700-SQL-ERROR                               05220001
052300             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           05230001
052400             MOVE DK-MODU-NBR         TO PV-MSG-MODU              05240001
052500             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               05250001
052600             PERFORM 9900-WRITE-LOG                               05260002
052700                                                                  05270001
052800         WHEN SQLCODE = -904                                      05280001
052900         WHEN SQLCODE = -913                                      05290001
053000         WHEN SQLCODE = -911                                      05300001
053100***                                                               05310019
053200*** DMH ADDED DISPLAYS - 8/21/2007                                05320019
053300***                                                               05330019
053400             MOVE SQLCODE             TO PV-DISP-SQLCODE          05340019
053500             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             05350019
053600             DISPLAY ' PCKUT074 - 7050 - '                        05360023
053700                     ' SQLCODE:'         PV-DISP-SQLCODE          05370019
053800                     ' TP2LMOD '                                  05380019
053900                     ' MOD:'             DK-MODU-NBR              05390019
054000***                                                               05400019
054100             MOVE '7050-'             TO PV-ERROR-PARA            05410001
054200             MOVE 'SQL ERROR - TP2LMOD'                           05420001
054300                                      TO PV-ERROR-TEXT            05430001
054400             PERFORM 9700-SQL-ERROR                               05440001
054500             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           05450001
054600             MOVE DK-MODU-NBR         TO PV-MSG-MODU              05460001
054700             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               05470001
054800             PERFORM 9900-WRITE-LOG                               05480002
054900                                                                  05490001
055000         WHEN SQLWARN0 NOT = SPACES                               05500001
055100         WHEN SQLCODE NOT = ZERO                                  05510001
055200***                                                               05520019
055300*** DMH ADDED DISPLAYS - 8/21/2007                                05530019
055400***                                                               05540019
055500             MOVE SQLCODE             TO PV-DISP-SQLCODE          05550019
055600             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             05560019
055700             DISPLAY ' PCKUT074 - 7050 - '                        05570023
055800                     ' SQLCODE:'         PV-DISP-SQLCODE          05580019
055900                     ' TP2LMOD '                                  05590019
056000                     ' MOD:'             DK-MODU-NBR              05600019
056100***                                                               05610019
056200             MOVE '7050-'             TO PV-ERROR-PARA            05620001
056300             MOVE 'SQL ERROR - TP2LMOD'                           05630001
056400                                      TO PV-ERROR-TEXT            05640001
056500             PERFORM 9700-SQL-ERROR                               05650001
056600             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           05660001
056700             MOVE DK-MODU-NBR         TO PV-MSG-MODU              05670001
056800             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               05680001
056900             PERFORM 9900-WRITE-LOG                               05690002
057000                                                                  05700001
057100     END-EVALUATE.                                                05710001
057200     IF KRPRPM-FUNC-TXT = 'Y'                                     05720001
057300         MOVE ' PCKUT074 END 7050- PARA '     TO PV-LOG-MSG       05730008
057400         PERFORM 9900-WRITE-LOG                                   05740002
057500     END-IF.                                                      05750001
057600/                                                                 05760001
057700 7100-KOHLS-USER.                                                 05770030
057800                                                                  05780030
057900     IF KRPRPM-FUNC-TXT = 'Y'                                     05790030
058000         MOVE ' PCKUT074 START 7100- PARA '     TO PV-LOG-MSG     05800030
058100         PERFORM 9900-WRITE-LOG                                   05810030
058200     END-IF.                                                      05820030
058300                                                                  05830030
058400     SET PS-USER-FOUND-NO             TO TRUE                     05840030
058500     MOVE PV-USER-ID                  TO XLT00024-USR-ID          05850030
058600                                                                  05860030
058700                                                                  05870030
058800     EXEC SQL                                                     05880030
058900         SELECT  'Y'                                              05890030
059000              INTO  :PS-USER-FOUND-SW                             05900030
059100              FROM   XLT_USR    USR                               05910030
059200          WHERE  USR.USR_ID       = :XLT00024-USR-ID              05920030
059300          WITH UR                                                 05930030
059400     END-EXEC                                                     05940030
059500                                                                  05950030
059600     EVALUATE TRUE                                                05960030
059700         WHEN SQLCODE = ZERO                                      05970030
059800             SET XL067-USER-IS-KOHLS  TO TRUE                     05980030
059900                                                                  05990030
060000              IF KRPRPM-FUNC-TXT = 'Y'                            06000030
060100                 MOVE ' PCKUT074 START 7100- KOHLS ASSOCIATE'     06010030
060200                                            TO PV-LOG-MSG         06020030
060300                 PERFORM 9900-WRITE-LOG                           06030030
060400               END-IF                                             06040030
060500                                                                  06050030
060600         WHEN SQLCODE = +100                                      06060030
060700                                                                  06070030
060800              IF KRPRPM-FUNC-TXT = 'Y'                            06080030
060900                 MOVE ' PCKUT074 START 7100- NOT KOHLS ASSOCIATE' 06090030
061000                                            TO PV-LOG-MSG         06100030
061100                 PERFORM 9900-WRITE-LOG                           06110030
061200               END-IF                                             06120030
061300                                                                  06130030
061400             PERFORM 7105-TEMP-USER                               06140030
061500                                                                  06150030
061600         WHEN SQLCODE = -904                                      06160030
061700         WHEN SQLCODE = -911                                      06170030
061800         WHEN SQLCODE = -913                                      06180030
061900         WHEN SQLWARN0 NOT = SPACES                               06190030
062000              AND SQLCODE NOT = ZERO                              06200030
062100                                                                  06210030
062200             SET PS-ERROR-YES         TO TRUE                     06220030
062300             MOVE SQLCODE             TO  PV-DISP-SQLCODE         06230030
062400             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            06240030
062500             DISPLAY ' PCKUT074 - 7100 - '                        06250030
062600                     ' SQLCODE: '         PV-DISP-SQLCODE         06260030
062700                     ' XLT_USR '                                  06270036
062800             DISPLAY ' PCKUT074 - 7100 - '                        06280030
062900                     ' OPER: '            PV-DISP-OPER            06290030
063000                     ' MODULE: '          DK-MODU-NBR             06300030
063100                                                                  06310030
063200             MOVE '7100-'             TO PV-ERROR-PARA            06320030
063300             MOVE 'SQL ERROR - XLT_USR'                           06330036
063400                                      TO PV-ERROR-TEXT            06340030
063500             PERFORM 9700-SQL-ERROR                               06350030
063600             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           06360030
063700             MOVE DK-MODU-NBR         TO PV-MSG-MODU              06370030
063800             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               06380030
063900             PERFORM 9900-WRITE-LOG                               06390030
064000                                                                  06400030
064100     END-EVALUATE.                                                06410030
064200/                                                                 06420030
064300 7105-TEMP-USER.                                                  06430030
064400                                                                  06440030
064500     IF KRPRPM-FUNC-TXT = 'Y'                                     06450030
064600         MOVE ' PCKUT074 START 7105- PARA '     TO PV-LOG-MSG     06460030
064700         PERFORM 9900-WRITE-LOG                                   06470030
064800     END-IF.                                                      06480030
064900                                                                  06490030
065000                                                                  06500030
065100     SET PS-USER-FOUND-NO             TO TRUE                     06510030
065200     MOVE PV-USER-ID                  TO DLT00002-TMP-USR-ID      06520030
065300                                                                  06530030
065400     EXEC SQL                                                     06540030
065500         SELECT  'Y'                                              06550030
065600              INTO  :PS-USER-FOUND-SW                             06560030
065700              FROM   DLT_TMP_EMP                                  06570030
065800          WHERE  TMP_USR_ID       = :DLT00002-TMP-USR-ID          06580030
065900          WITH UR                                                 06590030
066000     END-EXEC                                                     06600030
066100                                                                  06610030
066200     EVALUATE TRUE                                                06620030
066300         WHEN SQLCODE = ZERO                                      06630030
066400             SET XL067-USER-IS-TEMP TO TRUE                       06640030
066500                                                                  06650030
066600              IF KRPRPM-FUNC-TXT = 'Y'                            06660030
066700                 MOVE ' PCKUT074 START 7105- TEMP ASSOCIATE'      06670030
066800                                            TO PV-LOG-MSG         06680030
066900                 PERFORM 9900-WRITE-LOG                           06690030
067000               END-IF                                             06700030
067100                                                                  06710030
067200                                                                  06720030
067300         WHEN SQLCODE = +100                                      06730030
067400             SET PS-ERROR-YES                                     06740030
067500                 XL067-USER-NOT-FOUND                             06750033
067600                 PC245-UNKNOWN-USER   TO TRUE                     06760033
067700                                                                  06770033
067800              IF KRPRPM-FUNC-TXT = 'Y'                            06780033
067900                 MOVE ' PCKUT074 START 7105- NOT FOUND ASSOC'     06790033
068000                                            TO PV-LOG-MSG         06800033
068100                 PERFORM 9900-WRITE-LOG                           06810033
068200               END-IF                                             06820033
068300                                                                  06830033
068400         WHEN SQLCODE = -904                                      06840033
068500         WHEN SQLCODE = -911                                      06850033
068600         WHEN SQLCODE = -913                                      06860033
068700         WHEN SQLWARN0 NOT = SPACES                               06870033
068800              AND SQLCODE NOT = ZERO                              06880033
068900                                                                  06890033
069000             MOVE SQLCODE             TO  PV-DISP-SQLCODE         06900033
069100             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            06910033
069200             DISPLAY ' PCKUT074 - 7105 - '                        06920033
069300                     ' SQLCODE: '         PV-DISP-SQLCODE         06930033
069400                     ' DLT_TMP_EMP '                              06940036
069500             DISPLAY ' PCKUT074 - 7105 - '                        06950033
069600                     ' OPER: '            PV-DISP-OPER            06960033
069700                     ' MODULE: '          DK-MODU-NBR             06970033
069800                                                                  06980033
069900             MOVE '7105-'             TO PV-ERROR-PARA            06990033
070000             MOVE 'SQL ERROR - DLT_TMP_EMP '                      07000036
070100                                      TO PV-ERROR-TEXT            07010033
070200             PERFORM 9700-SQL-ERROR                               07020033
070300             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           07030033
070400             MOVE DK-MODU-NBR         TO PV-MSG-MODU              07040033
070500             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               07050033
070600             PERFORM 9900-WRITE-LOG                               07060033
070700                                                                  07070033
070800     END-EVALUATE.                                                07080033
070900                                                                  07090033
071000 8400-CALL-DLKUP024.                                              07100015
071100     IF KRPRPM-FUNC-TXT = 'Y'                                     07110001
071200         MOVE ' PCKUT074 START 8400- PARA '     TO PV-LOG-MSG     07120008
071300         PERFORM 9900-WRITE-LOG                                   07130002
071400     END-IF.                                                      07140001
071500                                                                  07150001
071600     INITIALIZE DL020-ASGMT-COMMAREA.                             07160011
071700                                                                  07170001
071800     SET DL020-BY-ASGMT-KEY                                       07180011
071900         DL020-COMMIT-UPDATE                                      07190011
072000         DL020-FIND-NEXT-ASGMT        TO TRUE.                    07200011
072100                                                                  07210001
072200     MOVE DL019-ESO-ASGMT-START-DTE   TO DL020-KEY-START-DTE      07220011
072300                                         PV-LABOR-ASGMT-STRT-DTE. 07230001
072400     MOVE DL019-ESO-ASGMT-NBR-TXT     TO DL020-KEY-NBR-TXT        07240011
072500                                         PV-LABOR-ASGMT-NBR-TXT.  07250001
072600     MOVE DL019-ESO-ASGMT-NBR-SEQ-NBR TO DL020-KEY-NBR-SEQ-NBR    07260011
072700                                       PV-LABOR-ASGMT-NBR-SEQ-NBR.07270001
072800                                                                  07280001
072900     MOVE 1                          TO DL020-NBR-OF-NBRS-NEED-QTY07290011
073000     MOVE 'PCKUT074'                  TO DL020-ORIG-CALLING-PGM-NM07300011
073100                                                                  07310001
073200     CALL DL020-USER-PGM USING DL020-ASGMT-COMMAREA.              07320011
073300                                                                  07330001
073400     IF DL020-SUCCESSFUL                                          07340011
073500         IF DL020-ASGMT-NEXT-USED                                 07350011
073600             MOVE DL020-NXT-START-DTE                             07360011
073700                                   TO PV-LABOR-ASGMT-STRT-DTE     07370001
073800             MOVE DL020-NXT-NBR-TXT                               07380011
073900                                   TO PV-LABOR-ASGMT-NBR-TXT      07390001
074000             MOVE DL020-NXT-NBR-SEQ-NBR                           07400011
074100                                   TO PV-LABOR-ASGMT-NBR-SEQ-NBR  07410001
074200             MOVE DL020-SEQ-START-NBR                             07420011
074300                                   TO PV-LABOR-SEQ-START-NBR      07430001
074400         ELSE                                                     07440001
074500             MOVE DL020-SEQ-START-NBR                             07450011
074600                                   TO PV-LABOR-SEQ-START-NBR      07460001
074700         END-IF                                                   07470001
074800                                                                  07480001
074900     ELSE                                                         07490001
075000         MOVE '8400-'                 TO PV-ERROR-PARA            07500001
075100         MOVE 'SQL ERROR IN DLKUP024'                             07510015
075200                                      TO PV-ERROR-TEXT            07520001
075300         MOVE DL020-SQLCA             TO SQLCA                    07530011
075400         PERFORM 9700-SQL-ERROR                                   07540001
075500                                                                  07550001
075600         MOVE DL020-KEY-START-DTE     TO PV-DLKUP024-DATE         07560015
075700         MOVE DL020-KEY-NBR-TXT       TO PV-DLKUP024-TXT          07570015
075800         MOVE DL020-KEY-NBR-SEQ-NBR   TO PV-DLKUP024-SEQ          07580015
075900         MOVE PV-DLKUP024-TEXT        TO PV-LOG-MSG               07590015
076000         PERFORM 9900-WRITE-LOG                                   07600002
076100                                                                  07610001
076200         STRING ' PARA= '                                         07620001
076300                DL020-SQL-ERROR-PARA                              07630011
076400                 ' PGM= '                                         07640001
076500               DL020-CALL-MOD-FAIL-NM                             07650011
076600                 ' ERR CODE= '                                    07660001
076700               DL020-CALL-MOD-FAIL-ERR-CDE                        07670011
076800                 DELIMITED BY SIZE INTO PV-LOG-MSG                07680001
076900         PERFORM 9900-WRITE-LOG                                   07690002
077000                                                                  07700001
077100     END-IF.                                                      07710001
077200     IF KRPRPM-FUNC-TXT = 'Y'                                     07720001
077300         MOVE ' PCKUT074 END 8400- PARA '     TO PV-LOG-MSG       07730008
077400         PERFORM 9900-WRITE-LOG                                   07740002
077500     END-IF.                                                      07750001
077600/                                                                 07760001
077700 8410-CALL-XLKUP046.                                              07770015
077800     IF KRPRPM-FUNC-TXT = 'Y'                                     07780001
077900         MOVE ' PCKUT074 START 8410- PARA '     TO PV-LOG-MSG     07790008
078000         PERFORM 9900-WRITE-LOG                                   07800002
078100     END-IF.                                                      07810001
078200                                                                  07820001
078300     INITIALIZE XL091-EAI-EXPORT-COMMAREA                         07830011
078400                PC242-DTL-TXT-AREA.                               07840001
078500                                                                  07850001
078600     SET XL091-PC-APP-ID          TO TRUE.                        07860011
078700     SET XL091-COMMIT-UPDATE      TO TRUE.                        07870011
078800                                                                  07880001
078900     MOVE 'PCKUT074'              TO XL091-ORIG-CALLING-PGM-NM.   07890011
079000     MOVE 'PACKTOLIGHT'           TO XL091-EVNT-OBJ-TXT.          07900011
079100     MOVE 'OUTBOUND OPEN'         TO XL091-EVNT-OBJ-ACTN-TXT.     07910011
079200     MOVE PV-USER-ID              TO XL091-CRE-BY-USR-ID.         07920011
079300     MOVE 'PCKUT074'              TO XL091-CRE-PGM-NM.            07930011
079400                                                                  07940001
079500     MOVE PC245-DC-NBR            TO XL091-EVNT-KY-1-NBR.         07950011
079600                                                                  07960001
079700     MOVE DK-MODU-NBR             TO XL091-EVNT-KY-1-TXT.         07970011
079800     MOVE PC245-BOX-BAR-CODE-NBR  TO XL091-EVNT-KY-2-TXT.         07980011
079900                                                                  07990001
080000     MOVE PC245-BOXOPEN-DATE-YYYY TO PV-START-CCYY.               08000001
080100     MOVE PC245-BOXOPEN-DATE-MM   TO PV-START-MM.                 08010001
080200     MOVE PC245-BOXOPEN-DATE-DD   TO PV-START-DD.                 08020001
080300                                                                  08030001
080400     MOVE PC245-BOXOPEN-TIME-HH   TO PV-START-HOUR-N.             08040001
080500     MOVE PC245-BOXOPEN-TIME-MM   TO PV-START-MIN.                08050001
080600     MOVE PC245-BOXOPEN-TIME-SS   TO PV-START-SEC.                08060001
080700     MOVE PV-START-TIMESTAMP      TO XL091-EVNT-KY-1-TMST.        08070011
080800                                                                  08080001
080900*    POPULATE DETAIL AREA                                         08090001
081000     SET XL091-PCWS242-COPYBOOK TO TRUE.                          08100011
081100                                                                  08110001
081200     INITIALIZE PC242-DTL-TXT-AREA.                               08120001
081300                                                                  08130001
081400     SET PC242-P2L-OPEN-OTBND-CRTN    TO TRUE.                    08140001
081500                                                                  08150001
081600     MOVE PV-LABOR-ASGMT-STRT-DTE     TO PC242-AL-ASGMT-STRT-DTE. 08160001
081700     MOVE PV-LABOR-ASGMT-NBR-TXT      TO PC242-AL-ASGMT-NBR-TXT.  08170001
081800     MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR  TO                          08180001
081900                                   PC242-AL-ASGMT-NBR-SEQ-NBR.    08190001
082000     MOVE PV-LABOR-SEQ-START-NBR      TO                          08200001
082100                                   PC242-AL-ASGMT-SEQ-DTL-NBR.    08210001
082200                                                                  08220001
082300     MOVE P2LMOD-DFLT-STR-ZN-ID TO PC242-AL-STR-ZN-ID.            08230001
082400                                                                  08240001
082500     MOVE PC242-DTL-TXT-AREA          TO XL091-DTL-TXT.           08250011
082600                                                                  08260001
082700     CALL XL091-USER-PGM USING XL091-EAI-EXPORT-COMMAREA.         08270011
082800                                                                  08280001
082900     IF XL091-SUCCESSFUL                                          08290011
083000        CONTINUE                                                  08300001
083100     ELSE                                                         08310001
083200         MOVE PV-USER-ID              TO PV-XLKUP046-USER         08320015
083300                                                                  08330001
083400         MOVE 'OUTBOUND OPEN'         TO PV-XLKUP046-OBJTXT       08340015
083500         MOVE PV-XLKUP046-TEXT1       TO PV-LOG-MSG               08350015
083600         PERFORM 9900-WRITE-LOG                                   08360002
083700                                                                  08370001
083800         MOVE 'INBOUND LAUNCH'        TO PV-XLKUP046-OBJACTNTXT   08380015
083900         MOVE PV-XLKUP046-TEXT2       TO PV-LOG-MSG               08390015
084000         PERFORM 9900-WRITE-LOG                                   08400002
084100                                                                  08410001
084200         IF XL091-SQL-ERROR                                       08420011
084300             MOVE '8410-'             TO PV-ERROR-PARA            08430001
084400             MOVE 'SQL ERROR IN XLKUP046'                         08440015
084500                                      TO PV-ERROR-TEXT            08450001
084600             MOVE XL091-SQLCA         TO SQLCA                    08460011
084700             PERFORM 9700-SQL-ERROR                               08470001
084800                                                                  08480001
084900         END-IF                                                   08490001
085000                                                                  08500001
085100     END-IF.                                                      08510001
085200     IF KRPRPM-FUNC-TXT = 'Y'                                     08520001
085300         MOVE ' PCKUT074 END 8410- PARA '     TO PV-LOG-MSG       08530008
085400         PERFORM 9900-WRITE-LOG                                   08540002
085500     END-IF.                                                      08550001
085600/                                                                 08560001
085700 8450-LINK-DLKUT410.                                              08570010
085800     IF KRPRPM-FUNC-TXT = 'Y'                                     08580001
085900         MOVE ' PCKUT074 START 8450- PARA '     TO PV-LOG-MSG     08590008
086000         PERFORM 9900-WRITE-LOG                                   08600002
086100     END-IF.                                                      08610001
086200                                                                  08620001
086300     INITIALIZE DL019-PGM-COMMAREA.                               08630010
086400                                                                  08640001
086500     SET DL019-ESTABLISH-ASGMT        TO TRUE.                    08650010
086600     SET DL019-COMMIT-UPDATE          TO TRUE.                    08660010
086700     MOVE 'PCKUT074'                  TO DL019-CALLING-PGM-NM.    08670010
086800     MOVE PV-USER-ID                  TO DL019-SIGN-ON-USR-ID.    08680010
086900                                                                  08690001
087000     SET DL011-AN-P2L-WRK-TYP         TO TRUE.                    08700001
087100     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL019-ASGMT-NBR-WRK-TYP. 08710010
087200                                                                  08720001
087300     SET DL011-P2L-WRK-TYP            TO TRUE.                    08730001
087400     MOVE DL011-KEY-WK-TYP            TO DL019-EAI-WK-TYP-DESC.   08740010
087500                                                                  08750001
087600     MOVE P2LMOD-DFLT-STR-ZN-ID       TO DL011-P2-WRK-AREA-5-9.   08760001
087700     MOVE P2LMOD-MODU-NBR             TO DL011-P2-WRK-AREA-MOD-4-608770001
087800     MOVE DL011-P2L-MOD-WRK-AREA      TO DL019-EAI-WK-AREA-DESC.  08780010
087900                                                                  08790001
088000     MOVE PC245-DC-NBR                TO DL019-EAI-DC-NBR.        08800010
088100                                                                  08810001
088200     MOVE PV-USER-ID                  TO DL019-EAI-CRE-BY-USR-ID. 08820010
088300                                                                  08830001
088400                                                                  08840001
088500*    THIS IS KNOWN FROM THE VERIFICATION OF THE USERID            08850001
088600     IF XL067-USER-IS-KOHLS                                       08860001
088700         SET DL019-EAI-USR-IS-KOHLS   TO TRUE                     08870010
088800     ELSE                                                         08880001
088900         SET DL019-EAI-USR-IS-TMP     TO TRUE                     08890010
089000     END-IF.                                                      08900001
089100                                                                  08910001
089200     CALL DL019-USER-PGM USING DL019-PGM-COMMAREA.                08920010
089300                                                                  08930001
089400     EVALUATE TRUE                                                08940001
089500         WHEN DL019-SUCCESSFUL                                    08950010
089600                 CONTINUE                                         08960001
089700                                                                  08970001
089800         WHEN DL019-SQL-ERROR                                     08980010
089900***                                                               08990020
090000*** DMH ADDED DISPLAYS - 8/21/2007                                09000020
090100***                                                               09010020
090200             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           09020020
090300             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        09030020
090400             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    09040027
090500                                       TO  PV-DISP-SQLCODE-3      09050027
090600             DISPLAY ' PCKUT074 - 8450 - CALL TO DLKUT410 - '     09060020
090700             DISPLAY ' PCKUT074 - DLWS019 '                       09070020
090800                     ' PROCESS CODE:'   DL019-PROCESS-CDE         09080020
090900                     ' COMMIT CODE:'    DL019-COMMIT-CDE          09090020
091000                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      09100020
091100                     ' USER ID:'        DL019-SIGN-ON-USR-ID      09110020
091200                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   09120020
091300             DISPLAY ' PCKUT074 - DLWS019 '                       09130020
091400                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     09140020
091500                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    09150020
091600                     ' DC:'             PV-DISP-OPER              09160020
091700                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   09170020
091800                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     09180020
091900             DISPLAY ' PCKUT074 - DLWS019 '                       09190020
092000                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 09200020
092100             DISPLAY ' PCKUT074 - DLWS019 '                       09210020
092200                     ' RETURN CODE:'     DL019-RETURN-CODE        09220022
092300                     ' SQLCODE:'         PV-DISP-SQLCODE          09230020
092400                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    09240020
092500                     '-'          DL019-CALL-MOD-FAIL-NM          09250020
092600                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     09260020
092700                     '-'          PV-DISP-SQLCODE-3               09270027
092800***                                                               09280020
092900             MOVE '8450-'             TO PV-ERROR-PARA            09290001
093000             MOVE 'SQL ERROR IN DLKUT410'                         09300010
093100                                      TO PV-ERROR-TEXT            09310001
093200             MOVE DL019-SQLCA         TO SQLCA                    09320010
093300             PERFORM 9700-SQL-ERROR                               09330001
093400                                                                  09340001
093500         WHEN DL019-CALLED-MODULE-FAILURE AND                     09350010
093600              DL019-CALL-MOD-FAIL-SQL-PARA NOT = SPACES           09360010
093700***                                                               09370020
093800*** DMH ADDED DISPLAYS - 8/21/2007                                09380020
093900***                                                               09390020
094000             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           09400020
094100             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        09410020
094200             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    09420027
094300                                       TO  PV-DISP-SQLCODE-3      09430027
094400             DISPLAY ' PCKUT074 - 8450 - CALL TO DLKUT410 - '     09440020
094500             DISPLAY ' PCKUT074 - DLWS019 '                       09450020
094600                     ' PROCESS CODE:'   DL019-PROCESS-CDE         09460020
094700                     ' COMMIT CODE:'    DL019-COMMIT-CDE          09470020
094800                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      09480020
094900                     ' USER ID:'        DL019-SIGN-ON-USR-ID      09490020
095000                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   09500020
095100             DISPLAY ' PCKUT074 - DLWS019 '                       09510020
095200                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     09520020
095300                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    09530020
095400                     ' DC:'             PV-DISP-OPER              09540020
095500                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   09550020
095600                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     09560020
095700             DISPLAY ' PCKUT074 - DLWS019 '                       09570020
095800                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 09580020
095900             DISPLAY ' PCKUT074 - DLWS019 '                       09590020
096000                     ' RETURN CODE:'     DL019-RETURN-CODE        09600024
096100                     ' SQLCODE:'         PV-DISP-SQLCODE          09610020
096200                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    09620020
096300                     '-'          DL019-CALL-MOD-FAIL-NM          09630020
096400                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     09640020
096500                     '-'          PV-DISP-SQLCODE-3               09650027
096600***                                                               09660020
096700                                                                  09670001
096800             MOVE '8450-'             TO PV-ERROR-PARA            09680001
096900             SET PC245-SQL-ERROR      TO TRUE                     09690001
097000                                                                  09700001
097100*            HANDLE EACH KIND OF SQL ERROR AS NEEDED              09710001
097200             MOVE DL019-CALL-MOD-FAIL-SQL-CDE                     09720010
097300                                      TO SQLCODE                  09730001
097400                                                                  09740001
097500             IF SQLCODE = ZERO                                    09750001
097600                 CONTINUE                                         09760001
097700             ELSE                                                 09770001
097800                 PERFORM 8451-ERROR                               09780001
097900             END-IF                                               09790001
098000                                                                  09800001
098100         WHEN DL019-INVALID-ACCESS                                09810010
098200***                                                               09820021
098300*** DMH ADDED DISPLAYS - 8/21/2007                                09830021
098400***                                                               09840021
098500             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           09850021
098600             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        09860021
098700             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    09870027
098800                                       TO  PV-DISP-SQLCODE-3      09880027
098900             DISPLAY ' PCKUT074 - 8450 - CALL TO DLKUT410 - '     09890021
099000             DISPLAY ' PCKUT074 - DLWS019 '                       09900021
099100                     ' PROCESS CODE:'   DL019-PROCESS-CDE         09910021
099200                     ' COMMIT CODE:'    DL019-COMMIT-CDE          09920021
099300                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      09930021
099400                     ' USER ID:'        DL019-SIGN-ON-USR-ID      09940021
099500                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   09950021
099600             DISPLAY ' PCKUT074 - DLWS019 '                       09960021
099700                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     09970021
099800                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    09980021
099900                     ' DC:'             PV-DISP-OPER              09990021
100000                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   10000021
100100                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     10010021
100200             DISPLAY ' PCKUT074 - DLWS019 '                       10020021
100300                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 10030021
100400             DISPLAY ' PCKUT074 - DLWS019 '                       10040021
100500                     ' RETURN CODE:'     DL019-RETURN-CODE        10050022
100600                     ' SQLCODE:'         PV-DISP-SQLCODE          10060021
100700                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    10070021
100800                     '-'          DL019-CALL-MOD-FAIL-NM          10080021
100900                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     10090021
101000                     '-'          PV-DISP-SQLCODE-3               10100027
101100***                                                               10110021
101200             SET PS-ERROR-YES         TO TRUE                     10120001
101300             MOVE '8450-'             TO PV-ERROR-PARA            10130001
101400             MOVE 'INVALID ACCESS - DLKUT410'                     10140010
101500                                      TO PV-ERROR-TEXT            10150001
101600             PERFORM 9001-GENERIC-ERROR                           10160001
101700                                                                  10170001
101800                                                                  10180001
101900         WHEN OTHER                                               10190001
102000***                                                               10200021
102100*** DMH ADDED DISPLAYS - 8/21/2007                                10210021
102200***                                                               10220021
102300             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           10230021
102400             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        10240021
102500             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    10250027
102600                                       TO  PV-DISP-SQLCODE-3      10260027
102700             DISPLAY ' PCKUT074 - 8450 - CALL TO DLKUT410 - '     10270021
102800             DISPLAY ' PCKUT074 - DLWS019 '                       10280021
102900                     ' PROCESS CODE:'   DL019-PROCESS-CDE         10290021
103000                     ' COMMIT CODE:'    DL019-COMMIT-CDE          10300021
103100                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      10310021
103200                     ' USER ID:'        DL019-SIGN-ON-USR-ID      10320021
103300                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   10330021
103400             DISPLAY ' PCKUT074 - DLWS019 '                       10340021
103500                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     10350021
103600                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    10360021
103700                     ' DC:'             PV-DISP-OPER              10370021
103800                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   10380021
103900                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     10390021
104000             DISPLAY ' PCKUT074 - DLWS019 '                       10400021
104100                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 10410021
104200             DISPLAY ' PCKUT074 - DLWS019 '                       10420021
104300                     ' RETURN CODE:'     DL019-RETURN-CODE        10430022
104400                     ' SQLCODE:'         PV-DISP-SQLCODE          10440021
104500                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    10450021
104600                     '-'          DL019-CALL-MOD-FAIL-NM          10460021
104700                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     10470021
104800                     '-'          PV-DISP-SQLCODE-3               10480027
104900***                                                               10490021
105000             SET PS-ERROR-YES         TO TRUE                     10500001
105100             MOVE '8450-'             TO PV-ERROR-PARA            10510001
105200             STRING                                               10520001
105300                  'DLKUT410 - ERROR= '                            10530010
105400                  DL019-RETURN-CODE                               10540010
105500                  ' / MODULE= ' DL019-CALL-MOD-FAIL-NM            10550010
105600                  DELIMITED BY SIZE                               10560001
105700                                    INTO PV-ERROR-TEXT            10570001
105800             PERFORM 9001-GENERIC-ERROR                           10580001
105900     END-EVALUATE.                                                10590001
106000     IF KRPRPM-FUNC-TXT = 'Y'                                     10600001
106100         MOVE ' PCKUT074 END 8450- PARA '     TO PV-LOG-MSG       10610008
106200         PERFORM 9900-WRITE-LOG                                   10620002
106300     END-IF.                                                      10630001
106400                                                                  10640001
106500 8451-ERROR.                                                      10650001
106600     PERFORM 9001-GENERIC-ERROR.                                  10660001
106700     MOVE  DL019-CALL-MOD-FAIL-SQL-CDE TO PV-DISP-SQLCODE-3       10670027
106800     STRING 'MODULE ERROR - '                                     10680001
106900         DL019-CALL-MOD-FAIL-SQL-PARA                             10690010
107000      ' / ' DL019-CALL-MOD-FAIL-NM                                10700010
107100      ' / '   DL019-CALL-MOD-FAIL-ERR-CDE                         10710010
107200      ' / '   PV-DISP-SQLCODE-3                                   10720027
107300         DELIMITED BY SIZE                                        10730001
107400         INTO PV-LOG-MSG.                                         10740001
107500     PERFORM 9900-WRITE-LOG.                                      10750002
107600                                                                  10760001
107700     MOVE PV-USER-ID                  TO PV-DLKUT410-USER.        10770010
107800     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO PV-DLKUT410-WK-TYP.      10780010
107900     MOVE DL011-KEY-WK-TYP            TO PV-DLKUT410-WK-TYP-DESC. 10790010
108000     MOVE DL011-P2L-MOD-WRK-AREA      TO PV-DLKUT410-WK-AREA-DESC.10800010
108100     MOVE PC245-DC-NBR                TO PV-DLKUT410-DC-NBR.      10810010
108200     MOVE PV-USER-ID                  TO PV-DLKUT410-CRE-USERID.  10820010
108300     MOVE DL019-EAI-USR-TYP-CDE       TO PV-DLKUT410-USER-TYP.    10830010
108400                                                                  10840001
108500     MOVE PV-DLKUT410-TEXT1           TO PV-LOG-MSG.              10850010
108600     PERFORM 9900-WRITE-LOG.                                      10860002
108700     MOVE PV-DLKUT410-TEXT2           TO PV-LOG-MSG.              10870010
108800     PERFORM 9900-WRITE-LOG.                                      10880002
108900                                                                  10890001
109000     PERFORM 9700-SQL-ERROR.                                      10900001
109100/                                                                 10910001
109200*8600-CALL-XLKUT067.                                              10920030
109300***                                                               10930030
109400***  IF KRPRPM-FUNC-TXT = 'Y'                                     10940030
109500***      MOVE ' PCKUT074 START 8600- PARA '     TO PV-LOG-MSG     10950030
109600***      PERFORM 9900-WRITE-LOG                                   10960030
109700***  END-IF.                                                      10970030
109800***                                                               10980030
109900***  INITIALIZE XL067-USER-COMMAREA.                              10990030
110000***                                                               11000030
110100***  MOVE SPACES  TO  XL067-USER-FOUND-CODE                       11010030
110200***                   XL067-FIRST-NAME                            11020030
110300***                   XL067-LAST-NAME                             11030030
110400***                   XL067-MIDDLE-INITIAL                        11040030
110500***                   XL067-USERID                                11050030
110600***                   XL067-KEY-USER-ID.                          11060030
110700***                                                               11070030
110800***  SET XL067-BY-USER-ID                                         11080030
110900***      XL067-SELECT-BOTH-USERS      TO TRUE.                    11090030
111000***                                                               11100030
111100***  MOVE PV-USER-ID                  TO XL067-KEY-USER-ID.       11110030
111200***  MOVE 'PCKUT074'                  TO XL067-ORIG-CALLING-PGM-NM11120030
111300***                                                               11130030
111400***  CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               11140030
111500***                                                               11150030
111600***  IF KRPRPM-FUNC-TXT = 'Y'                                     11160030
111700***      MOVE SPACES TO PV-LOG-MSG                                11170030
111800***      STRING ' PCKUT074 - XL067-USER-FOUND-CODE:'              11180030
111900***           XL067-USER-FOUND-CODE      DELIMITED BY SIZE        11190030
112000***                                 INTO PV-LOG-MSG               11200030
112100***      PERFORM 9900-WRITE-LOG                                   11210030
112200***  END-IF.                                                      11220030
112300***                                                               11230030
112400***                                                               11240017
112500*** DMH ADDED ADDITIONAL DISPLAYS - 8/21/2007                     11250017
112600***                                                               11260017
112700***  EVALUATE TRUE                                                11270030
112800***      WHEN XL067-SUCCESSFUL                                    11280030
112900***          CONTINUE                                             11290030
113000***      WHEN OTHER                                               11300030
113100***           MOVE  XL067-KOHLS-SQLCODE  TO  PV-DISP-SQLCODE      11310030
113200***           MOVE  XL067-TEMP-SQLCODE   TO  PV-DISP-SQLCODE-2    11320030
113300***           DISPLAY ' PCKUT074 - CALL XLKUT067 '                11330030
113400***           DISPLAY ' XLWS067 - '                               11340030
113500***                   ' ACCESS METHOD:' XL067-ACCESS-METHOD       11350030
113600***                   ' VIEW:'          XL067-VIEW-SELECTION      11360030
113700***           DISPLAY ' XLWS067 - '                               11370030
113800***                   ' KEYS:'          XL067-KEYS                11380030
113900***                   ' RETURN CODE:'   XL067-RETURN-CODE         11390030
114000***                   ' KOHLS SQLCODE:' PV-DISP-SQLCODE           11400030
114100***                   ' TEMP SQLCODE:'  PV-DISP-SQLCODE-2         11410030
114200***           DISPLAY ' XLWS067 - '                               11420030
114300***                   ' CALLING PGM:' XL067-ORIG-CALLING-PGM-NM   11430030
114400***                   ' PARA: '  XL067-KOHLS-NOT-FOUND-NBR        11440030
114500***                   '-'        XL067-KOHLS-CONTENTION-NBR       11450030
114600***                   '-'        XL067-KOHLS-ERROR-NBR            11460030
114700***                   '-'        XL067-TEMP-NOT-FOUND-NBR         11470030
114800***                   '-'        XL067-TEMP-CONTENTION-NBR        11480030
114900***                   '-'        XL067-TEMP-ERROR-NBR             11490030
115000***                   '-'        XL067-CALL-MOD-FAIL-NM           11500030
115100***                   '-'        XL067-CALL-MOD-FAIL-ERR-CDE      11510030
115200***  END-EVALUATE.                                                11520030
115300***                                                               11530017
115400***  EVALUATE TRUE                                                11540030
115500***      WHEN XL067-SUCCESSFUL                                    11550030
115600***          CONTINUE                                             11560030
115700***      WHEN XL067-SQL-ERROR                                     11570030
115800***          SET PC245-SQL-ERROR      TO TRUE                     11580030
115900***          PERFORM 8601-ERROR                                   11590030
116000***      WHEN XL067-INVALID-ACCESS                                11600030
116100***          SET PC245-ERROR          TO TRUE                     11610030
116200***          PERFORM 8601-ERROR                                   11620030
116300***      WHEN OTHER                                               11630030
116400***          SET PC245-ERROR          TO TRUE                     11640030
116500***          PERFORM 8601-ERROR                                   11650030
116600***  END-EVALUATE.                                                11660030
116700***                                                               11670030
116800*8601-ERROR.                                                      11680030
116900***                                                               11690030
117000***  MOVE XL067-SQLCA                 TO SQLCA.                   11700030
117100***  MOVE '8601-'                     TO PV-ERROR-PARA.           11710030
117200***  STRING 'CALL XLKUT067-'                                      11720030
117300***          PC245-DC-NBR                                         11730030
117400***          '-CHK PICKERBARCODE IN PCC'                          11740030
117500***          DELIMITED BY SIZE                                    11750030
117600***     INTO PV-ERROR-TEXT.                                       11760030
117700***  PERFORM 9700-SQL-ERROR.                                      11770030
117800***                                                               11780030
117900***  MOVE PV-USER-ID                  TO PV-XLKUT067-USERID.      11790030
118000***  STRING                                                       11800030
118100***          XL067-KOHLS-NOT-FOUND-NBR                            11810030
118200***      '/' XL067-KOHLS-CONTENTION-NBR                           11820030
118300***      '/' XL067-KOHLS-ERROR-NBR                                11830030
118400***      '/' XL067-TEMP-NOT-FOUND-NBR                             11840030
118500***      '/' XL067-TEMP-CONTENTION-NBR                            11850030
118600***      '/' XL067-TEMP-ERROR-NBR                                 11860030
118700***      '/' XL067-CALL-MOD-FAIL-NM                               11870030
118800***      '/' XL067-CALL-MOD-FAIL-ERR-CDE                          11880030
118900***          DELIMITED BY SIZE                                    11890030
119000***     INTO PV-XLKUT067-RETURN-FIELDS.                           11900030
119100***                                                               11910030
119200***  MOVE PV-XLKUT067-TEXT            TO PV-LOG-MSG.              11920030
119300***  PERFORM 9900-WRITE-LOG.                                      11930030
119400***                                                               11940030
119500                                                                  11950030
119600 9000-FORMAT-TIME.                                                11960001
119700     ACCEPT PV-CURRENT-TIME FROM TIME.                            11970001
119800     MOVE PV-CURRENT-HOUR             TO PV-FORMAT-HH.            11980001
119900     MOVE PV-CURRENT-MINUTE           TO PV-FORMAT-MM.            11990001
120000     MOVE PV-CURRENT-SECOND           TO PV-FORMAT-SS.            12000001
120100     MOVE PV-CURRENT-HUNDRETH         TO PV-FORMAT-HUND.          12010001
120200                                                                  12020001
120300 9001-GENERIC-ERROR.                                              12030001
120400     SET PC245-ERROR                  TO TRUE.                    12040001
120500     PERFORM 9000-FORMAT-TIME.                                    12050001
120600     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           12060001
120700     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              12070001
120800     PERFORM 9900-WRITE-LOG.                                      12080002
120900                                                                  12090001
121000 9700-SQL-ERROR.                                                  12100001
121100                                                                  12110001
121200     SET PC245-SQL-ERROR                                          12120001
121300         PS-ERROR-YES                 TO TRUE.                    12130001
121400     MOVE SPACES                      TO PV-LOG-MSG.              12140001
121500     PERFORM 9900-WRITE-LOG.                                      12150002
121600     PERFORM 9000-FORMAT-TIME.                                    12160001
121700     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           12170001
121800     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              12180001
121900     PERFORM 9900-WRITE-LOG.                                      12190002
122000                                                                  12200001
122100***  PERFORM 9800-WRITE-SQLCA.                                    12210001
122200                                                                  12220001
122300                                                                  12230001
122400 9800-WRITE-SQLCA.                                                12240001
122500*                                                                 12250001
122600**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               12260001
122700*                                                                 12270001
122800     CALL 'DSNTIAR' USING SQLCA                                   12280001
122900                          DP004-FORMATTED-MESSAGE                 12290001
123000                          DP004-ERROR-LINE-LENGTH.                12300001
123100*                                                                 12310001
123200     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG.              12320001
123300     PERFORM 9900-WRITE-LOG.                                      12330002
123400                                                                  12340001
123500     PERFORM                                                      12350001
123600         VARYING DP004-MSG-IDX                                    12360001
123700         FROM 1 BY 1                                              12370001
123800         UNTIL DP004-MSG-IDX > DP004-MAX-MESSAGE-LINES            12380001
123900             MOVE DP004-MESSAGE-LINE (DP004-MSG-IDX)              12390001
124000                                      TO PV-LOG-MSG               12400001
124100             PERFORM 9900-WRITE-LOG                               12410002
124200     END-PERFORM.                                                 12420001
124300                                                                  12430001
124400     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG.              12440001
124500     PERFORM 9900-WRITE-LOG.                                      12450002
124600                                                                  12460001
124700 9900-WRITE-LOG.                                                  12470002
124800                                                                  12480001
124900     DISPLAY PV-LOG-MSG.                                          12490002
125000     MOVE SPACES                      TO PV-LOG-MSG.              12500001
125100                                                                  12510001
125200 9999-RETURN.                                                     12520001
125300                                                                  12530001
125400     GOBACK.                                                      12540001
