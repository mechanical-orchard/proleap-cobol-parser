       IDENTIFICATION DIVISION.                                                 
                                                                                
       PROGRAM-ID.         IMKUP993.                                            
       AUTHOR.             VIKRAM N.                                    00040024
       INSTALLATION.       KOHLS DEPARTMENT STORES.                             
       DATE-WRITTEN.       06-17-16.                                            
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      * IMKUP993                                                                
      *                                                                *        
      * PROGRAM OVERVIEW : THE PROGRAM IS A TEMPORARY PROGRAM TO FIX            
      *                    ISSUE DUE TO MDM ACCIDENTAL DELETE. THE              
      *                    STYLE AND SKU ARE OLD AND WERE ACCIDENTALY           
      *                    DELETED DURING RESEEDING PROCESS. HENCE              
      *                    PROGRAM IS REQUIRED TO FIX THIS BY                   
      *                    LOADING THE TABLES WITH BACKUP FROM ITEM             
      *                    DAILY BACKUP. THIS PROGRAM LOADS TABLE WITH          
      *                    ITEM INFORMATION FROM BACKUP FILES.                  
      *-----------------------------------------------------------*             
      *  CHANGE LOG:                                              *             
      * 06/21/16                                                  *             
      *     INITIAL INSTALLATION.                                 *             
      * MADE BY: COGNIZANT                       CR # CHG0144822  *             
      *-----------------------------------------------------------*             
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER.    IBM-3090.                                            
       OBJECT-COMPUTER.    IBM-3090.                                            
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
                                                                                
           SELECT IN-STYLE-DETAILS       ASSIGN TO INP01.                       
                                                                                
           SELECT ITEMSKU-FILE           ASSIGN TO INP02.                       
                                                                                
           SELECT TSKSTUNLD-FILE         ASSIGN TO INP03.                       
                                                                                
           SELECT TUPCSKU-FILE           ASSIGN TO INP04.                       
                                                                                
           SELECT TPPCPRC-ITEM           ASSIGN TO INP05.                       
                                                                                
           SELECT TPPCPRC-FILE           ASSIGN TO INP06.                       
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  IN-STYLE-DETAILS                                                     
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  IN-STYLE-DETAILS-REC             PIC  X(25).                         
                                                                                
       FD  ITEMSKU-FILE                                                         
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  ITEMSKU-RECORD                   PIC  X(500).                        
                                                                                
       FD  TSKSTUNLD-FILE                                                       
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  TSKSTUN-RECORD                   PIC  X(360).                        
                                                                                
       FD  TUPCSKU-FILE                                                         
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  TUPCSKU-RECORD                   PIC  X(056).                        
                                                                                
       FD  TPPCPRC-ITEM                                                         
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  TPPCPRC-ITEM-RECORD              PIC  X(020).                        
                                                                                
       FD  TPPCPRC-FILE                                                         
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  TPPCPRC-RECORD                   PIC  X(081).                        
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  ABEND-CODE                       PIC S9(04) COMP SYNC                
                                                       VALUE +0.                
                                                                                
       01  PROGRAM-ACCUMULATORS.                                                
           05  PA-TMDARVS-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TVNDSTL-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TWEBITM-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TUPCPLS-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TUPC-COUNT                PIC 9(09) VALUE 0.                  
           05  PA-TIMTCHC-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TIMTSKU-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TSKXREF-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TSKST-COUNT               PIC 9(09) VALUE 0.                  
           05  PA-TUPCSKU-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TPPCPRC-COUNT             PIC 9(09) VALUE 0.                  
           05  PA-TSK-COUNT                 PIC 9(09) VALUE 0.                  
                                                                                
       01  PROGRAM-CONSTANTS.                                                   
           05  PV-ORIG-CLR-NULL-IND           PIC S9(04)   VALUE +0             
                                                           COMP.                
           05  PV-MKDN-CDE-NULL-IND           PIC S9(04)   VALUE +0             
                                                           COMP.                
           05  PC-MAX-RETRIES               PIC S9(04) COMP SYNC                
                                                       VALUE +3.                
           05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'IMKUP993'.        
                                                                                
       01  PROGRAM-SWITCHES.                                                    
           05  PS-END-OF-TMDARVS-CSR-SW     PIC X      VALUE 'N'.               
               88  PS-END-OF-TMDARVS-CSR               VALUE 'Y'.               
               88  PS-PROCESS-TMDARVS-CSR              VALUE 'N'.               
           05  PS-TVNDSTL-FOUND-SW          PIC X      VALUE 'N'.               
               88  PS-TVNDSTL-FOUND                    VALUE 'Y'.               
               88  PS-TVNDSTL-NOT-FOUND                VALUE 'N'.               
           05  PS-END-EXTRACT-SW            PIC X      VALUE 'N'.               
               88  MORE-EXTRACT                        VALUE 'N'.               
               88  END-OF-EXTRACT                      VALUE 'Y'.               
           05  PS-END-TPPCITM-SW            PIC X      VALUE 'N'.               
               88  MORE-TPP-ITMEXT                     VALUE 'N'.               
               88  END-OF-TPP-ITMEXT                   VALUE 'Y'.               
           05  PS-END-TPPCPRC-SW            PIC X      VALUE 'N'.               
               88  MORE-TPP-EXTRACT                    VALUE 'N'.               
               88  END-OF-TPP-EXTRACT                  VALUE 'Y'.               
           05  PS-END-TUPCSKU-SW            PIC X      VALUE 'N'.               
               88  MORE-PCSKU-EXTRACT                  VALUE 'N'.               
               88  END-OF-PCSKU-EXTRACT                VALUE 'Y'.               
           05  PS-END-SKU-EXTRACT-SW        PIC X      VALUE 'N'.               
               88  MORE-SKU-EXTRACT                    VALUE 'N'.               
               88  END-OF-SKU-EXTRACT                  VALUE 'Y'.               
           05  PS-END-SKS-EXTRACT-SW        PIC X      VALUE 'N'.               
               88  MORE-SKS-EXTRACT                    VALUE 'N'.               
               88  END-OF-SKS-EXTRACT                  VALUE 'Y'.               
           05  PS-END-OF-TUPC-CSR-SW        PIC X(01)  VALUE 'Y'.               
               88  END-OF-TUPC-CSR                     VALUE 'N'.               
               88  NOT-END-OF-TUPC-CSR                 VALUE 'Y'.               
           05  PS-END-OF-TUPCV-CSR-SW       PIC X(01)  VALUE 'Y'.               
               88  END-OF-TUPCV-CSR                    VALUE 'N'.               
               88  NOT-END-OF-TUPCV-CSR                VALUE 'Y'.               
           05  PS-END-OF-TUPCPLS-CSR-SW     PIC X(01)  VALUE 'Y'.               
               88  END-OF-TUPCPLS-CSR                  VALUE 'N'.               
               88  NOT-END-OF-TUPCPLS-CSR              VALUE 'Y'.               
           05  PS-END-OF-TWEB-CSR-SW        PIC X(01)  VALUE 'Y'.               
               88  END-OF-TWEB-CSR                     VALUE 'Y'.               
               88  NOT-END-OF-TWEB-CSR                 VALUE 'N'.               
                                                                                
       01  PROGRAM-VARIABLES.                                                   
           05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30) VALUE SPACE.             
           05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.             
           05  PV-ONE                       PIC  S9(7) VALUE ZERO               
                                                        COMP-3.                 
       01  IN-STYLE-DETAILS-INP.                                                
           05  RMS-VS-ID                    PIC  9(09) VALUE 0.                 
           05  FILLER                       PIC  X(01) VALUE ','.               
           05  RMS-STYLE-ID                 PIC  9(08) VALUE 0.                 
           05  FILLER                       PIC  X(07) VALUE SPACES.            
       01  IN-TPPCPRC-ITEM-INP.                                                 
           05  TPPCP-ITEM-NBR               PIC  9(15) VALUE 0.                 
           05  FILLER                       PIC  X(05) VALUE SPACES.            
      *****************************************************************         
      * DB2 FORMATTED ERROR MESSAGE                                             
      *****************************************************************         
                                                                                
           COPY DPWS004.                                                        
           COPY IMRD053.                                                        
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE UPC TABLE                                                
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TUPC                                                     
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE MERCHANDISE AREA VENDOR STYLE TABLE                      
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TMDARVS                                                  
           END-EXEC.                                                            
      *****************************************************************         
      * DCLGEN FOR THE IMT CUST SKU TABLE                                       
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE IMT00027                                                 
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE VENDOR STYLE TABLE                                       
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TVNDSTL                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE TPPCPRC TABLE                                            
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TPPCPRC                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE TUPCPLS TABLE                                            
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TUPCPLS                                                  
           END-EXEC.                                                            
      *****************************************************************         
      * DCLGEN FOR THE TSKXREF TABLE                                            
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TSKXREF                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE TSKST TABLE                                              
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TSKST                                                    
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE TSK TABLE                                                
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TSK                                                      
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE TWEBITM TABLE                                            
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TWEBITM                                                  
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE IMT CUST CHOICE TABLE                                    
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE IMT00026                                                 
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DCLGEN FOR THE TUPCSKU TABLE                                            
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
               INCLUDE TUPCSKU                                                  
           END-EXEC.                                                            
                                                                                
       01  IM999-ITEM-SKU-DOMAIN-REC.                                           
           10 IM999-ITEM-NMBR               PIC  S9(15)V COMP-3.                
           10 IM999-LOC-NBR                 PIC  S9(4) COMP.                    
           10 IM999-LAST-SALE-DATE          PIC  S9(7)V COMP-3.                 
           10 IM999-LAST-RCVD-DATE          PIC  S9(7)V COMP-3.                 
           10 IM999-ONHAND-QTY              PIC  S9(7)V COMP-3.                 
           10 IM999-FIRST-RCVD-DATE         PIC  S9(7)V COMP-3.                 
           10 IM999-FIRST-SALE-DATE         PIC  S9(7)V COMP-3.                 
           10 IM999-YTD-SALES-UNIT-QTY      PIC  S9(7)V COMP-3.                 
           10 IM999-YTD-SALES-AMT           PIC  S9(7)V9(2) COMP-3.             
           10 IM999-LAST-UPD-TMST           PIC   X(26).                        
           10  IM999-SKU-NMBR.                                                  
               15 IM999-MERCH-DEPT-NMBR     PIC   X(3).                         
               15 IM999-MERCH-CLASS-NMBR    PIC   X(2).                         
               15 IM999-SEQ-NMBR            PIC   X(3).                         
           10 IM999-CUM-SALES-UNIT-QTY      PIC  S9(7)V COMP-3.                 
           10 IM999-RTL-UNIT-RCVD-QTY       PIC  S9(7)V COMP-3.                 
           10 IM999-COST-UNIT-MSRMNT        PIC   X(4).                         
           10 IM999-RTL-UNIT-MSRMNT         PIC   X(4).                         
           10 IM999-UNIT-COST-AMT           PIC  S9(4)V9(3) COMP-3.             
           10 IM999-CUR-UNIT-RTL-AMT        PIC  S9(5)V9(2) COMP-3.             
           10 IM999-ORIG-UNIT-RTL-AMT       PIC  S9(5)V9(2) COMP-3.             
           10 IM999-VNDR-INNR-PACK-QTY      PIC  S9(5)V COMP-3.                 
           10 IM999-SHPMT-COUNT-QTY         PIC  S9(3)V COMP-3.                 
           10 IM999-VENDOR-STYLE-CODE       PIC   X(15).                        
           10 IM999-STAT-CHNGD-DATE         PIC  S9(7)V COMP-3.                 
           10 IM999-STATUS-CODE             PIC  S9(3)V COMP-3.                 
           10 IM999-AUTO-RORD-MTH-CODE      PIC   X(1).                         
           10 IM999-RTL-CST-CVRSN-FCTR      PIC  S9(3)V COMP-3.                 
           10 IM999-SETUP-DATE              PIC  S9(7)V COMP-3.                 
           10 IM999-PRICE-CHNG-DATE         PIC  S9(7)V COMP-3.                 
           10 IM999-GROUP-CODE              PIC   X(3).                         
           10 IM999-SKU-DESC                PIC   X(25).                        
           10 IM999-SIZE-DESC               PIC   X(5).                         
           10 IM999-COLOR-DESC              PIC   X(4).                         
           10 IM999-REORDER-FRMT-CODE       PIC   X(1).                         
           10 IM999-MERCH-DIV-CODE          PIC  S9(1)V COMP-3.                 
           10 IM999-DMM-NMBR                PIC  S9(3)V COMP-3.                 
           10 IM999-BUYER-NMBR              PIC  S9(3)V COMP-3.                 
           10 IM999-VENDOR-NMBR             PIC  S9(5)V COMP-3.                 
           10 IM999-VNDR-IN-HSE-NMBR        PIC  S9(3)V COMP-3.                 
           10 IM999-MKDN-PGM-CODE           PIC   X(1).                         
           10 IM999-LOWST-UNIT-RTL-AMT      PIC  S9(5)V9(2) COMP-3.             
           10 IM999-LOW-RTL-PRICE-DATE      PIC  S9(7)V COMP-3.                 
           10 IM999-ITEM-NMBR-TSK           PIC  S9(15)V COMP-3.                
           10 IM999-GP-RTL-AMT              PIC  S9(5)V9(2) COMP-3.             
           10 IM999-ORIG-GP-QTY             PIC  S9(3)V COMP-3.                 
           10 IM999-ORIG-GP-RTL-AMT         PIC  S9(5)V9(2) COMP-3.             
           10 IM999-FS-RPT-IND              PIC   X(1).                         
           10 IM999-GP-QTY                  PIC  S9(3)V COMP-3.                 
           10 IM999-MULT-PR-PT-IND          PIC   X(1).                         
           10 IM999-PLU-DWNLD-EXCL-IND      PIC   X(1).                         
           10 IM999-LAST-PO-REV-DTE         PIC   X(10).                        
           10 IM999-PO-REV-DAY-NBR          PIC  S9(3)V COMP-3.                 
           10 IM999-PO-REV-SUN-WK-NBR       PIC  S9(1)V COMP-3.                 
           10 IM999-PO-REV-MON-WK-NBR       PIC  S9(1)V COMP-3.                 
           10 IM999-PO-REV-TUE-WK-NBR       PIC  S9(1)V COMP-3.                 
           10 IM999-PO-REV-WED-WK-NBR       PIC  S9(1)V COMP-3.                 
           10 IM999-PO-REV-THU-WK-NBR       PIC  S9(1)V COMP-3.                 
           10 IM999-PO-REV-FRI-WK-NBR       PIC  S9(1)V COMP-3.                 
           10 IM999-PO-REV-SAT-WK-NBR       PIC  S9(1)V COMP-3.                 
           10 IM999-CENT-STK-CDE            PIC   X(2).                         
           10 IM999-MEITGP-NBR              PIC  S9(9) COMP.                    
           10 IM999-SKU-TYP-CDE             PIC   X(1).                         
           10 IM999-VEND-OUTR-PACK-QTY      PIC  S9(5)V COMP-3.                 
           10 IM999-LONG-VENDOR-STYLE       PIC   X(20).                        
           10 IM999-SIZE-CDE                PIC   X(5).                         
           10 IM999-LONG-SIZE-DESC          PIC   X(20).                        
           10 IM999-COLOR-CDE               PIC   X(3).                         
           10 IM999-LONG-COLOR-DESC         PIC   X(20).                        
           10 IM999-STICKER-NBR             PIC   X(3).                         
           10 IM999-ENT-ID                  PIC  S9(9) COMP.                    
           10 IM999-TKT-FMT-ID              PIC   X(6).                         
           10 IM999-KY-ITM-IND              PIC   X(1).                         
           10 IM999-VS-CHARTC-CDE           PIC  S9(4) COMP.                    
           10 IM999-VS-CHARTC-SEQ-NBR       PIC  S9(4) COMP.                    
           10 IM999-UNT-COST-1ST-AMT        PIC  S9(7)V9(3) COMP-3.             
           10 IM999-REGN-PRIC-IND           PIC   X(1).                         
           10 FILLER                        PIC  X(20).                         
                                                                                
       01  DCLTUPC-INT.                                                         
           10 IN-UPC-UPC-ID                 PIC  S9(9) COMP.                    
           10 IN-UPC-UPC-NBR                PIC  S9(15)V COMP-3.                
           10 IN-UPC-SUB-CL-MDSEAR-ID       PIC  S9(6)V COMP-3.                 
           10 IN-UPC-VS-ID                  PIC  S9(9) COMP.                    
           10 IN-UPC-INTR-UPC-ID            PIC  S9(9) COMP.                    
           10 IN-UPC-EFF-BEG-DTE            PIC   X(10).                        
           10 IN-UPC-EFF-END-DTE            PIC   X(10).                        
           10 IN-UPC-UPC-TYP-CDE            PIC   X(1).                         
           10 IN-UPC-KOHLS-SIZE-CDE         PIC  S9(9) COMP.                    
           10 IN-UPC-NRF-SIZE-IND           PIC   X(1).                         
           10 IN-UPC-NRF-CLOR-CDE           PIC   X(3).                         
           10 IN-UPC-NRF-CLOR-IND           PIC   X(1).                         
           10 IN-UPC-CSTM-CLOR-DESC         PIC   X(10).                        
           10 IN-UPC-EDI-ORD-IND            PIC   X(1).                         
           10 IN-UPC-PREPK-IND              PIC   X(1).                         
           10 IN-UPC-GP-CDE                 PIC   X(3).                         
           10 IN-UPC-CERTD-IND              PIC   X(1).                         
           10 IN-UPC-CERTD-DTE              PIC   X(10).                        
           10 IN-UPC-RPLNMT-IND             PIC   X(1).                         
           10 IN-UPC-KY-ITM-IND             PIC   X(1).                         
           10 IN-UPC-UNT-COST-1ST-AMT       PIC  S9(7)V9(3) COMP-3.             
           10 IN-UPC-UPC-SRC-CDE            PIC   X(1).                         
           10 IN-UPC-INNR-PK-QTY            PIC  S9(4) COMP.                    
           10 IN-UPC-OUTR-PK-QTY            PIC  S9(4) COMP.                    
           10 IN-UPC-SEA-SEQ-NBR            PIC  S9(4) COMP.                    
           10 IN-UPC-CRE-BY-USR-ID          PIC   X(8).                         
           10 IN-UPC-LAST-UPD-BY-USR-ID     PIC   X(8).                         
           10 IN-UPC-LAST-UPD-TMST          PIC   X(26).                        
           10 IN-UPC-WD-UM-QTY              PIC  S9(4)V9(3) COMP-3.             
           10 IN-UPC-DPTH-UM-QTY            PIC  S9(4)V9(3) COMP-3.             
           10 IN-UPC-HT-UM-QTY              PIC  S9(4)V9(3) COMP-3.             
           10 IN-UPC-SIZE-UM-CDE            PIC   X(2).                         
           10 IN-UPC-WT-UM-QTY              PIC  S9(5)V9(3) COMP-3.             
           10 IN-UPC-WT-UM-CDE              PIC   X(2).                         
           10 IN-UPC-POG-IND                PIC   X(1).                         
           10 IN-UPC-REGN-PRIC-IND          PIC   X(1).                         
           10 IN-UPC-TX-PRD-CDE-SEQ-NBR     PIC  S9(4) COMP.                    
           10 IN-UPC-CUSTFACG-CLOR-DESC     PIC   X(22).                        
           10 IN-UPC-INTR-UPC-DESC          PIC   X(30).                        
           10 IN-UPC-TRNSTN-IND             PIC   X(1).                         
           10 IN-UPC-PO-SHRT-CYC-IND        PIC   X(1).                         
           10 IN-UPC-TST-PRD-TYP-SEQ-NBR    PIC  S9(4) COMP.                    
           10 IN-UPC-WHSE-RPLNT-IND         PIC   X(1).                         
                                                                                
       01  DCLTUPC-VND.                                                         
           10 VN-UPC-UPC-ID                 PIC  S9(9) COMP.                    
           10 VN-UPC-UPC-NBR                PIC  S9(15)V COMP-3.                
           10 VN-UPC-SUB-CL-MDSEAR-ID       PIC  S9(6)V COMP-3.                 
           10 VN-UPC-VS-ID                  PIC  S9(9) COMP.                    
           10 VN-UPC-INTR-UPC-ID            PIC  S9(9) COMP.                    
           10 VN-UPC-EFF-BEG-DTE            PIC   X(10).                        
           10 VN-UPC-EFF-END-DTE            PIC   X(10).                        
           10 VN-UPC-UPC-TYP-CDE            PIC   X(1).                         
           10 VN-UPC-KOHLS-SIZE-CDE         PIC  S9(9) COMP.                    
           10 VN-UPC-NRF-SIZE-IND           PIC   X(1).                         
           10 VN-UPC-NRF-CLOR-CDE           PIC   X(3).                         
           10 VN-UPC-NRF-CLOR-IND           PIC   X(1).                         
           10 VN-UPC-CSTM-CLOR-DESC         PIC   X(10).                        
           10 VN-UPC-EDI-ORD-IND            PIC   X(1).                         
           10 VN-UPC-PREPK-IND              PIC   X(1).                         
           10 VN-UPC-GP-CDE                 PIC   X(3).                         
           10 VN-UPC-CERTD-IND              PIC   X(1).                         
           10 VN-UPC-CERTD-DTE              PIC   X(10).                        
           10 VN-UPC-RPLNMT-IND             PIC   X(1).                         
           10 VN-UPC-KY-ITM-IND             PIC   X(1).                         
           10 VN-UPC-UNT-COST-1ST-AMT       PIC  S9(7)V9(3) COMP-3.             
           10 VN-UPC-UPC-SRC-CDE            PIC   X(1).                         
           10 VN-UPC-INNR-PK-QTY            PIC  S9(4) COMP.                    
           10 VN-UPC-OUTR-PK-QTY            PIC  S9(4) COMP.                    
           10 VN-UPC-SEA-SEQ-NBR            PIC  S9(4) COMP.                    
           10 VN-UPC-CRE-BY-USR-ID          PIC   X(8).                         
           10 VN-UPC-LAST-UPD-BY-USR-ID     PIC   X(8).                         
           10 VN-UPC-LAST-UPD-TMST          PIC   X(26).                        
           10 VN-UPC-WD-UM-QTY              PIC  S9(4)V9(3) COMP-3.             
           10 VN-UPC-DPTH-UM-QTY            PIC  S9(4)V9(3) COMP-3.             
           10 VN-UPC-HT-UM-QTY              PIC  S9(4)V9(3) COMP-3.             
           10 VN-UPC-SIZE-UM-CDE            PIC   X(2).                         
           10 VN-UPC-WT-UM-QTY              PIC  S9(5)V9(3) COMP-3.             
           10 VN-UPC-WT-UM-CDE              PIC   X(2).                         
           10 VN-UPC-POG-IND                PIC   X(1).                         
           10 VN-UPC-REGN-PRIC-IND          PIC   X(1).                         
           10 VN-UPC-TX-PRD-CDE-SEQ-NBR     PIC  S9(4) COMP.                    
           10 VN-UPC-CUSTFACG-CLOR-DESC     PIC   X(22).                        
           10 VN-UPC-INTR-UPC-DESC          PIC   X(30).                        
           10 VN-UPC-TRNSTN-IND             PIC   X(1).                         
           10 VN-UPC-PO-SHRT-CYC-IND        PIC   X(1).                         
           10 VN-UPC-TST-PRD-TYP-SEQ-NBR    PIC  S9(4) COMP.                    
           10 VN-UPC-WHSE-RPLNT-IND         PIC   X(1).                         
      ******************************************************************        
      * SQL COMMUNICATIONS WORK AREA                                            
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  TUPC CURSOR DECLARATION                                                
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
             DECLARE TUPC_CSR CURSOR WITH HOLD FOR                              
              SELECT UPC_ID                                                     
                    ,UPC_NBR                                                    
                    ,SUB_CL_MDSEAR_ID                                           
                    ,VS_ID                                                      
                    ,INTR_UPC_ID                                                
                    ,EFF_BEG_DTE                                                
                    ,UPC_TYP_CDE                                                
                    ,KOHLS_SIZE_CDE                                             
                    ,NRF_SIZE_IND                                               
                    ,NRF_CLOR_CDE                                               
                    ,NRF_CLOR_IND                                               
                    ,CSTM_CLOR_DESC                                             
                    ,EDI_ORD_IND                                                
                    ,PREPK_IND                                                  
                    ,GP_CDE                                                     
                    ,CERTD_IND                                                  
                    ,CERTD_DTE                                                  
                    ,RPLNMT_IND                                                 
                    ,KY_ITM_IND                                                 
                    ,UNT_COST_1ST_AMT                                           
                    ,UPC_SRC_CDE                                                
                    ,INNR_PK_QTY                                                
                    ,OUTR_PK_QTY                                                
                    ,SEA_SEQ_NBR                                                
                    ,CRE_BY_USR_ID                                              
                    ,LAST_UPD_BY_USR_ID                                         
                    ,LAST_UPD_TMST                                              
                    ,WD_UM_QTY                                                  
                    ,DPTH_UM_QTY                                                
                    ,HT_UM_QTY                                                  
                    ,SIZE_UM_CDE                                                
                    ,WT_UM_QTY                                                  
                    ,WT_UM_CDE                                                  
                    ,POG_IND                                                    
                    ,REGN_PRIC_IND                                              
                    ,TX_PRD_CDE_SEQ_NBR                                         
                    ,CUSTFACG_CLOR_DESC                                         
                    ,INTR_UPC_DESC                                              
                    ,TRNSTN_IND                                                 
                    ,PO_SHRT_CYC_IND                                            
                    ,TST_PRD_TYP_SEQ_NBR                                        
                    ,WHSE_RPLNT_IND                                             
               FROM   TUPC A                                                    
               WHERE A.VS_ID       = :MDARVS-VS-ID                              
                 AND A.INTR_UPC_ID = :IM053-INTR-UPC-ID                         
                 AND A.EFF_END_DTE = '2016-10-21'                               
               ORDER BY A.UPC_TYP_CDE                                           
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  TUPCPLS CURSOR DECLARATION                                             
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
             DECLARE TUPCPLS_CSR CURSOR WITH HOLD FOR                           
              SELECT UPC_ID                                                     
                    ,OPERCO_NBR                                                 
                    ,STR_NBR                                                    
                    ,EFF_BEG_TMST                                               
                    ,UPC_STAT_CDE                                               
                    ,UNT_COST_AMT                                               
                    ,UNT_RTL_AMT                                                
                    ,MEITGP_NBR                                                 
                    ,CRE_BY_USR_ID                                              
                    ,CRE_TMST                                                   
                    ,ITM_NBR                                                    
                    ,PLU_IND                                                    
                    ,UPC_STAT_CHG_DTE                                           
                    ,UNT_RTL_CHG_DTE                                            
                    ,ORIG_CLR_DTE                                               
                    ,MKDN_CDE                                                   
               FROM   TUPCPLS                                                   
               WHERE ITM_NBR = :IM999-ITEM-NMBR-TSK                             
                 AND STR_NBR = 0                                                
                 AND EFF_END_TMST BETWEEN '2016-10-21-00.00.00.000000'          
                                      AND '2016-10-22-00.00.00.000000'          
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       0000-MAINLINE-PROCESSING.                                                
                                                                                
           PERFORM 1000-INITIALIZATION.                                         
           DISPLAY 'START OF STYLE UPDATE'.                                     
           PERFORM R000-STYLE-UPDATES.                                          
           INITIALIZE DCLTMDARVS.                                               
           DISPLAY 'START OF SKU UPDATE'.                                       
           PERFORM S000-SKU-UPDATES                                             
             UNTIL END-OF-SKU-EXTRACT                                           
                OR END-OF-SKS-EXTRACT.                                          
           PERFORM T000-TUPCSKU-UPDATE.                                         
           PERFORM W100-READ-TPPITM-FILE                                        
             UNTIL END-OF-TPP-ITMEXT.                                           
           PERFORM R900-COMMIT.                                                 
           PERFORM U100-READ-TPPCPRC-FILE                                       
             UNTIL END-OF-TPP-EXTRACT.                                          
           PERFORM 9000-EOJ-ROUTINE.                                            
           STOP RUN.                                                            
                                                                                
       R000-STYLE-UPDATES.                                                      
           PERFORM R100-READ-STYLE-FILE                                         
             UNTIL END-OF-EXTRACT.                                              
           PERFORM R900-COMMIT.                                                 
                                                                                
       1000-INITIALIZATION.                                                     
           OPEN INPUT IN-STYLE-DETAILS.                                         
           OPEN INPUT ITEMSKU-FILE.                                             
           OPEN INPUT TSKSTUNLD-FILE.                                           
           OPEN INPUT TUPCSKU-FILE.                                             
           OPEN INPUT TPPCPRC-ITEM.                                             
           OPEN INPUT TPPCPRC-FILE.                                             
                                                                                
       T000-TUPCSKU-UPDATE.                                                     
           PERFORM T100-READ-TPCSKU-FILE                                        
             UNTIL END-OF-PCSKU-EXTRACT.                                        
           PERFORM R900-COMMIT.                                                 
                                                                                
       R100-READ-STYLE-FILE.                                                    
           READ IN-STYLE-DETAILS                                                
               INTO  IN-STYLE-DETAILS-INP                                       
               AT END                                                           
                   SET END-OF-EXTRACT    TO TRUE                                
               NOT AT END                                                       
                   MOVE RMS-STYLE-ID TO MDARVS-RMS-STYL-ID                      
                   MOVE RMS-VS-ID   TO VNDSTL-VS-ID                             
                   PERFORM R200-PROCESS-PARA                                    
           END-READ.                                                            
                                                                                
       T100-READ-TPCSKU-FILE.                                                   
           READ TUPCSKU-FILE                                                    
               INTO  DCLTUPCSKU                                                 
               AT END                                                           
                   SET END-OF-PCSKU-EXTRACT    TO TRUE                          
               NOT AT END                                                       
                   PERFORM T200-TUPCSKU-INSERT                                  
           END-READ.                                                            
                                                                                
       W100-READ-TPPITM-FILE.                                                   
           READ TPPCPRC-ITEM                                                    
               INTO  IN-TPPCPRC-ITEM-INP                                        
               AT END                                                           
                   SET END-OF-TPP-ITMEXT    TO TRUE                             
               NOT AT END                                                       
                   MOVE TPPCP-ITEM-NBR  TO PPCPRC-TSK-ITM-NBR                   
                   PERFORM W200-TPPCPRC-DELETE                                  
           END-READ.                                                            
                                                                                
       U100-READ-TPPCPRC-FILE.                                                  
           READ TPPCPRC-FILE                                                    
               INTO  DCLTPPCPRC                                                 
               AT END                                                           
                   SET END-OF-TPP-EXTRACT      TO TRUE                          
               NOT AT END                                                       
                   PERFORM U200-TPPCPRC-INSERT                                  
           END-READ.                                                            
                                                                                
       S000-SKU-UPDATES.                                                        
           PERFORM S100-READ-SKU-FILE.                                          
           PERFORM T100-READ-TSK-FILE.                                          
           PERFORM R900-COMMIT.                                                 
                                                                                
                                                                                
       S100-READ-SKU-FILE.                                                      
           READ ITEMSKU-FILE                                                    
               INTO  IM053-ITEM-SKU-DOMAIN-REC                                  
               AT END                                                           
                   SET END-OF-SKU-EXTRACT    TO TRUE                            
           END-READ.                                                            
                                                                                
       T100-READ-TSK-FILE.                                                      
           READ TSKSTUNLD-FILE                                                  
               INTO  IM999-ITEM-SKU-DOMAIN-REC                                  
               AT END                                                           
                   SET END-OF-SKS-EXTRACT    TO TRUE                            
               NOT AT END                                                       
                      MOVE IM053-RMS-STYL-ID TO MDARVS-RMS-STYL-ID              
                   PERFORM S200-PROCESS-PARA                                    
           END-READ.                                                            
                                                                                
       R200-PROCESS-PARA.                                                       
      *   PROCESS TVNDSTL UPDATE                                                
           PERFORM R400-TVNDSTL-SELECT.                                         
      *   PROCESS TMDARVS UPDATE                                                
           PERFORM R300-TMDARVS-SELECT.                                         
      *   PROCESS IMT CUST CHC UPDATE                                           
           PERFORM R500-CUSTCHC-UPDATE.                                         
           DISPLAY 'STYLE RECORD UPDATED'.                                      
                                                                                
       S200-PROCESS-PARA.                                                       
             IF IM053-ITM-NBR = IM999-ITEM-NMBR-TSK                             
      *   PROCESS INTERNAL TUPC UPDATE                                          
           PERFORM S105-TMDARVS-SELECT                                          
           PERFORM S110-TUPC-SELECT                                             
      *   PROCESS TUPCPLS UPDATE                                                
           PERFORM S210-TUPCPLS-SELECT                                          
      *   PROCESS TSK UPDATE                                                    
           PERFORM S610-TSK-SELECT                                              
      *   PROCESS TSKXREF UPDATE                                                
           PERFORM S310-TSKXREF-SELECT                                          
      *   PROCESS TSKST UPDATE                                                  
           PERFORM S410-TSKST-SELECT                                            
      *   PROCESS TWEBITM UPDATE                                                
           PERFORM S510-TWEBITM-SELECT                                          
           PERFORM R900-COMMIT                                                  
      *   PROCESS VENDOR TUPC INSERT                                            
           IF END-OF-TUPCV-CSR                                                  
             INITIALIZE DCLTUPC                                                 
             PERFORM S132-TUPC-VND-MOVE                                         
             PERFORM S130-TUPC-INSERT                                           
             SET NOT-END-OF-TUPCV-CSR TO TRUE                                   
           END-IF                                                               
      *   PROCESS IMT SKU UPDATE                                                
           PERFORM S900-CUSTSKU-UPDATE                                          
           DISPLAY 'SKU RECORD UPDATED'                                         
           INITIALIZE DCLTUPC-INT                                               
           INITIALIZE DCLTUPC-VND                                               
           INITIALIZE DCLTUPC                                                   
             END-IF.                                                            
                                                                                
      ******************************************************************        
       S105-TMDARVS-SELECT.                                                     
           EXEC SQL                                                             
             SELECT VS_ID                                                       
                   ,DEPT_NBR                                                    
                   ,MAJ_CL_NBR                                                  
                   ,SUB_CL_NBR                                                  
               INTO :MDARVS-VS-ID                                               
                   ,:MDARVS-DEPT-NBR                                            
                   ,:MDARVS-MAJ-CL-NBR                                          
                   ,:MDARVS-SUB-CL-NBR                                          
               FROM TMDARVS                                                     
               WHERE RMS_STYL_ID = :IM053-RMS-STYL-ID                           
                 AND ACTV_IND    = 'Y'                                          
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        CONTINUE                                                
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TMDARVS SELECT CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S105-TMDARVS-SELECT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
                                                                                
       R300-TMDARVS-SELECT.                                                     
           EXEC SQL                                                             
             SELECT  SUB_CL_MDSEAR_ID                                           
                    ,VS_ID                                                      
                    ,ACTV_IND                                                   
                    ,VS_DESC                                                    
                    ,STKR_NBR                                                   
                    ,TKT_TYP_SEQ_NBR                                            
                    ,LBL_SEQ_NBR                                                
                    ,HNG_FOLD_SEQ_NBR                                           
                    ,KY_CLSN_SEQ_NBR                                            
                    ,FBRCN_SEQ_NBR                                              
                    ,FNSH_SEQ_NBR                                               
                    ,RMS_STYL_ID                                                
                    ,STYL_RECLS_IND                                             
                    ,RTL_CLSN_SEQ_NBR                                           
                    ,DEPT_NBR                                                   
                    ,MAJ_CL_NBR                                                 
                    ,SUB_CL_NBR                                                 
                    ,ESL_SEQ_NBR                                                
                    ,RPT_HIER_SEQ_NBR                                           
                    ,BDY_STYL_SEQ_NBR                                           
                    ,CONST_SEQ_NBR                                              
                    ,FUNC_SEQ_NBR                                               
                    ,GNDR_SEQ_NBR                                               
                    ,PATRN_SEQ_NBR                                              
                    ,SLHTT_SEQ_NBR                                              
                    ,CLLCTN_SEQ_NBR                                             
                    ,MAP_UNT_RTL_AMT                                            
                    ,C_O_ORGN_CDE                                               
                    ,PRIC_TIER_SEQ_NBR                                          
                    ,LFSTYL_SEQ_NBR                                             
                    ,CUST_INTFC_DESC                                            
                    ,FSHN_PYRMD_SEQ_NBR                                         
                    ,PRFL_GP_NM_TXT                                             
                    ,CTG_SEQ_NBR                                                
                    ,MAJ_CTG_SEQ_NBR                                            
                    ,MTRL_SEQ_NBR                                               
                    ,PRIM_TRND_SEQ_NBR                                          
                    ,SEC_TRND_SEQ_NBR                                           
                    ,ATTR_1_SEQ_NBR                                             
                    ,ATTR_2_SEQ_NBR                                             
                    ,NW_SLHTT_SEQ_NBR                                           
                 INTO                                                           
                     :MDARVS-SUB-CL-MDSEAR-ID                                   
                    ,:MDARVS-VS-ID                                              
                    ,:MDARVS-ACTV-IND                                           
                    ,:MDARVS-VS-DESC                                            
                    ,:MDARVS-STKR-NBR                                           
                    ,:MDARVS-TKT-TYP-SEQ-NBR                                    
                    ,:MDARVS-LBL-SEQ-NBR                                        
                    ,:MDARVS-HNG-FOLD-SEQ-NBR                                   
                    ,:MDARVS-KY-CLSN-SEQ-NBR                                    
                    ,:MDARVS-FBRCN-SEQ-NBR                                      
                    ,:MDARVS-FNSH-SEQ-NBR                                       
                    ,:MDARVS-RMS-STYL-ID                                        
                    ,:MDARVS-STYL-RECLS-IND                                     
                    ,:MDARVS-RTL-CLSN-SEQ-NBR                                   
                    ,:MDARVS-DEPT-NBR                                           
                    ,:MDARVS-MAJ-CL-NBR                                         
                    ,:MDARVS-SUB-CL-NBR                                         
                    ,:MDARVS-ESL-SEQ-NBR                                        
                    ,:MDARVS-RPT-HIER-SEQ-NBR                                   
                    ,:MDARVS-BDY-STYL-SEQ-NBR                                   
                    ,:MDARVS-CONST-SEQ-NBR                                      
                    ,:MDARVS-FUNC-SEQ-NBR                                       
                    ,:MDARVS-GNDR-SEQ-NBR                                       
                    ,:MDARVS-PATRN-SEQ-NBR                                      
                    ,:MDARVS-SLHTT-SEQ-NBR                                      
                    ,:MDARVS-CLLCTN-SEQ-NBR                                     
                    ,:MDARVS-MAP-UNT-RTL-AMT                                    
                    ,:MDARVS-C-O-ORGN-CDE                                       
                    ,:MDARVS-PRIC-TIER-SEQ-NBR                                  
                    ,:MDARVS-LFSTYL-SEQ-NBR                                     
                    ,:MDARVS-CUST-INTFC-DESC                                    
                    ,:MDARVS-FSHN-PYRMD-SEQ-NBR                                 
                    ,:MDARVS-PRFL-GP-NM-TXT                                     
                    ,:MDARVS-CTG-SEQ-NBR                                        
                    ,:MDARVS-MAJ-CTG-SEQ-NBR                                    
                    ,:MDARVS-MTRL-SEQ-NBR                                       
                    ,:MDARVS-PRIM-TRND-SEQ-NBR                                  
                    ,:MDARVS-SEC-TRND-SEQ-NBR                                   
                    ,:MDARVS-ATTR-1-SEQ-NBR                                     
                    ,:MDARVS-ATTR-2-SEQ-NBR                                     
                    ,:MDARVS-NW-SLHTT-SEQ-NBR                                   
                FROM  TMDARVS A                                                 
                WHERE A.RMS_STYL_ID      = :MDARVS-RMS-STYL-ID                  
                  AND A.ACTV_IND         = 'N'                                  
               WITH UR                                                          
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        MOVE 'Y' TO MDARVS-ACTV-IND                             
                        PERFORM R305-TMDARVS-UPDATE                             
                        ADD  +1  TO PA-TMDARVS-COUNT                            
                   WHEN SQLCODE = +100                                          
                        DISPLAY 'TMDARVS ROW NOT FOUND:'                        
                        DISPLAY 'STYL_ID:' MDARVS-RMS-STYL-ID                   
                   WHEN OTHER                                                   
                        DISPLAY 'STYL_ID:' MDARVS-RMS-STYL-ID                   
                        MOVE 'TMDARVS SELECT CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R300-TMDARVS-SELECT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R305-TMDARVS-UPDATE.                                                     
           EXEC SQL                                                             
             UPDATE TMDARVS                                                     
                SET ACTV_IND            = :MDARVS-ACTV-IND                      
                WHERE  RMS_STYL_ID      = :MDARVS-RMS-STYL-ID                   
                  AND  ACTV_IND         = 'N'                                   
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM R900-COMMIT                                     
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TMDARVS UPDATE CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R305-TMDARVS-UPDATE'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R400-TVNDSTL-SELECT.                                                     
           EXEC SQL                                                             
             SELECT  VS_ID                                                      
                    ,ENT_ID                                                     
                    ,VS_NBR                                                     
                    ,EFF_BEG_DTE                                                
                    ,COST_UM_CDE                                                
                    ,RTL_UM_CDE                                                 
                    ,BYP_CAT_IND                                                
                    ,CRE_BY_USR_ID                                              
                    ,LAST_UPD_BY_USR_ID                                         
                    ,LAST_UPD_TMST                                              
                 INTO                                                           
                     :VNDSTL-VS-ID                                              
                    ,:VNDSTL-ENT-ID                                             
                    ,:VNDSTL-VS-NBR                                             
                    ,:VNDSTL-EFF-BEG-DTE                                        
                    ,:VNDSTL-COST-UM-CDE                                        
                    ,:VNDSTL-RTL-UM-CDE                                         
                    ,:VNDSTL-BYP-CAT-IND                                        
                    ,:VNDSTL-CRE-BY-USR-ID                                      
                    ,:VNDSTL-LAST-UPD-BY-USR-ID                                 
                    ,:VNDSTL-LAST-UPD-TMST                                      
                FROM  TVNDSTL B                                                 
                WHERE B.VS_ID      = :VNDSTL-VS-ID                              
                  AND B.EFF_END_DTE = '2016-10-21'                              
               WITH UR                                                          
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM R405-TVNDSTL-DELETE                             
                        PERFORM R410-TVNDSTL-INSERT                             
                        ADD  +1  TO PA-TVNDSTL-COUNT                            
                   WHEN SQLCODE = +100                                          
                        DISPLAY 'ROW NOT FOUND IN TVNDSTL'                      
                        DISPLAY 'VS ID:' VNDSTL-VS-ID                           
                   WHEN OTHER                                                   
                        DISPLAY 'VS ID:' VNDSTL-VS-ID                           
                        MOVE 'TVNDSTL SELECT CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R400-TVNDSTL-SELECT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R405-TVNDSTL-DELETE.                                                     
           EXEC SQL                                                             
             DELETE FROM TVNDSTL                                                
              WHERE VS_ID        = :VNDSTL-VS-ID                                
                AND EFF_END_DTE  = '2016-10-21'                                 
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM R900-COMMIT                                     
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TVNDSTL DELETE CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R405-TVNDSTL-SELECT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R410-TVNDSTL-INSERT.                                                     
           EXEC SQL                                                             
                INSERT INTO TVNDSTL                                             
                    (VS_ID                                                      
                    ,ENT_ID                                                     
                    ,VS_NBR                                                     
                    ,EFF_BEG_DTE                                                
                    ,COST_UM_CDE                                                
                    ,RTL_UM_CDE                                                 
                    ,BYP_CAT_IND                                                
                    ,CRE_BY_USR_ID                                              
                    ,LAST_UPD_BY_USR_ID                                         
                    ,LAST_UPD_TMST)                                             
                  VALUES                                                        
                    (:VNDSTL-VS-ID                                              
                    ,:VNDSTL-ENT-ID                                             
                    ,:VNDSTL-VS-NBR                                             
                    ,:VNDSTL-EFF-BEG-DTE                                        
                    ,:VNDSTL-COST-UM-CDE                                        
                    ,:VNDSTL-RTL-UM-CDE                                         
                    ,:VNDSTL-BYP-CAT-IND                                        
                    ,:VNDSTL-CRE-BY-USR-ID                                      
                    ,:VNDSTL-LAST-UPD-BY-USR-ID                                 
                    ,:VNDSTL-LAST-UPD-TMST)                                     
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        CONTINUE                                                
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TVNDSTL INSERT CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R410-TVNDSTL-INSERT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R500-CUSTCHC-UPDATE.                                                     
           EXEC SQL                                                             
             UPDATE IMT_CUST_CHC                                                
                    SET EFF_END_DTE = NULL                                      
                    WHERE STYL_ID   = :MDARVS-RMS-STYL-ID                       
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD  +1  TO PA-TIMTCHC-COUNT                            
                   WHEN SQLCODE = +100                                          
                        DISPLAY 'ROW NOT FOUND IN IMT CUST CHC'                 
                        DISPLAY 'STYLE ID:' MDARVS-RMS-STYL-ID                  
                   WHEN OTHER                                                   
                        MOVE 'CUST CHC UPDATE CURSOR'                           
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R500-CUSTCHC-UPDATE'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S110-TUPC-SELECT.                                                        
           EXEC SQL                                                             
              OPEN TUPC_CSR                                                     
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM S120-TUPC-FETCH                                 
                          UNTIL END-OF-TUPC-CSR                                 
                        PERFORM S140-TUPC-CLOSE                                 
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPC OPEN CURSOR'                                 
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S110-TUPC-SELECT'                                 
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S120-TUPC-FETCH.                                                         
           EXEC SQL                                                             
              FETCH TUPC_CSR                                                    
               INTO  :UPC-UPC-ID                                                
                    ,:UPC-UPC-NBR                                               
                    ,:UPC-SUB-CL-MDSEAR-ID                                      
                    ,:UPC-VS-ID                                                 
                    ,:UPC-INTR-UPC-ID                                           
                    ,:UPC-EFF-BEG-DTE                                           
                    ,:UPC-UPC-TYP-CDE                                           
                    ,:UPC-KOHLS-SIZE-CDE                                        
                    ,:UPC-NRF-SIZE-IND                                          
                    ,:UPC-NRF-CLOR-CDE                                          
                    ,:UPC-NRF-CLOR-IND                                          
                    ,:UPC-CSTM-CLOR-DESC                                        
                    ,:UPC-EDI-ORD-IND                                           
                    ,:UPC-PREPK-IND                                             
                    ,:UPC-GP-CDE                                                
                    ,:UPC-CERTD-IND                                             
                    ,:UPC-CERTD-DTE                                             
                    ,:UPC-RPLNMT-IND                                            
                    ,:UPC-KY-ITM-IND                                            
                    ,:UPC-UNT-COST-1ST-AMT                                      
                    ,:UPC-UPC-SRC-CDE                                           
                    ,:UPC-INNR-PK-QTY                                           
                    ,:UPC-OUTR-PK-QTY                                           
                    ,:UPC-SEA-SEQ-NBR                                           
                    ,:UPC-CRE-BY-USR-ID                                         
                    ,:UPC-LAST-UPD-BY-USR-ID                                    
                    ,:UPC-LAST-UPD-TMST                                         
                    ,:UPC-WD-UM-QTY                                             
                    ,:UPC-DPTH-UM-QTY                                           
                    ,:UPC-HT-UM-QTY                                             
                    ,:UPC-SIZE-UM-CDE                                           
                    ,:UPC-WT-UM-QTY                                             
                    ,:UPC-WT-UM-CDE                                             
                    ,:UPC-POG-IND                                               
                    ,:UPC-REGN-PRIC-IND                                         
                    ,:UPC-TX-PRD-CDE-SEQ-NBR                                    
                    ,:UPC-CUSTFACG-CLOR-DESC                                    
                    ,:UPC-INTR-UPC-DESC                                         
                    ,:UPC-TRNSTN-IND                                            
                    ,:UPC-PO-SHRT-CYC-IND                                       
                    ,:UPC-TST-PRD-TYP-SEQ-NBR                                   
                    ,:UPC-WHSE-RPLNT-IND                                        
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                     IF UPC-UPC-TYP-CDE = 'I'                                   
                       PERFORM S122-TUPC-INT-MOVE                               
                     ELSE                                                       
                       PERFORM S123-TUPC-VND-MOVE                               
                       SET END-OF-TUPCV-CSR TO TRUE                             
                     END-IF                                                     
                   WHEN SQLCODE = +100                                          
                      SET END-OF-TUPC-CSR TO TRUE                               
                   WHEN OTHER                                                   
                        DISPLAY 'INTR-UPC-ID' UPC-INTR-UPC-ID                   
                        MOVE 'TUPC FETCH CURSOR'                                
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S120-TUPC-FETCH'                                  
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S122-TUPC-INT-MOVE.                                                      
             MOVE  UPC-UPC-ID            TO IN-UPC-UPC-ID.                      
             MOVE  UPC-UPC-NBR           TO IN-UPC-UPC-NBR.                     
             MOVE  UPC-SUB-CL-MDSEAR-ID  TO IN-UPC-SUB-CL-MDSEAR-ID.            
             MOVE  UPC-VS-ID             TO IN-UPC-VS-ID.                       
             MOVE  UPC-INTR-UPC-ID       TO IN-UPC-INTR-UPC-ID.                 
             MOVE  UPC-EFF-BEG-DTE       TO IN-UPC-EFF-BEG-DTE.                 
             MOVE  UPC-UPC-TYP-CDE       TO IN-UPC-UPC-TYP-CDE.                 
             MOVE  UPC-KOHLS-SIZE-CDE    TO IN-UPC-KOHLS-SIZE-CDE.              
             MOVE  UPC-NRF-SIZE-IND      TO IN-UPC-NRF-SIZE-IND.                
             MOVE  UPC-NRF-CLOR-CDE      TO IN-UPC-NRF-CLOR-CDE.                
             MOVE  UPC-NRF-CLOR-IND      TO IN-UPC-NRF-CLOR-IND.                
             MOVE  UPC-CSTM-CLOR-DESC    TO IN-UPC-CSTM-CLOR-DESC.              
             MOVE  UPC-EDI-ORD-IND       TO IN-UPC-EDI-ORD-IND.                 
             MOVE  UPC-PREPK-IND         TO IN-UPC-PREPK-IND.                   
             MOVE  UPC-GP-CDE            TO IN-UPC-GP-CDE.                      
             MOVE  UPC-CERTD-IND         TO IN-UPC-CERTD-IND.                   
             MOVE  UPC-CERTD-DTE         TO IN-UPC-CERTD-DTE.                   
             MOVE  UPC-RPLNMT-IND        TO IN-UPC-RPLNMT-IND.                  
             MOVE  UPC-KY-ITM-IND        TO IN-UPC-KY-ITM-IND.                  
             MOVE  UPC-UNT-COST-1ST-AMT  TO IN-UPC-UNT-COST-1ST-AMT.            
             MOVE  UPC-UPC-SRC-CDE       TO IN-UPC-UPC-SRC-CDE.                 
             MOVE  UPC-INNR-PK-QTY       TO IN-UPC-INNR-PK-QTY.                 
             MOVE  UPC-OUTR-PK-QTY       TO IN-UPC-OUTR-PK-QTY.                 
             MOVE  UPC-SEA-SEQ-NBR       TO IN-UPC-SEA-SEQ-NBR.                 
             MOVE  UPC-CRE-BY-USR-ID     TO IN-UPC-CRE-BY-USR-ID.               
             MOVE  UPC-LAST-UPD-BY-USR-ID TO IN-UPC-LAST-UPD-BY-USR-ID.         
             MOVE  UPC-LAST-UPD-TMST      TO IN-UPC-LAST-UPD-TMST.              
             MOVE  UPC-WD-UM-QTY          TO IN-UPC-WD-UM-QTY.                  
             MOVE  UPC-DPTH-UM-QTY        TO IN-UPC-DPTH-UM-QTY.                
             MOVE  UPC-HT-UM-QTY          TO IN-UPC-HT-UM-QTY.                  
             MOVE  UPC-SIZE-UM-CDE        TO IN-UPC-SIZE-UM-CDE.                
             MOVE  UPC-WT-UM-QTY          TO IN-UPC-WT-UM-QTY.                  
             MOVE  UPC-WT-UM-CDE          TO IN-UPC-WT-UM-CDE.                  
             MOVE  UPC-POG-IND            TO IN-UPC-POG-IND.                    
             MOVE  UPC-REGN-PRIC-IND      TO IN-UPC-REGN-PRIC-IND.              
             MOVE  UPC-TX-PRD-CDE-SEQ-NBR TO IN-UPC-TX-PRD-CDE-SEQ-NBR.         
             MOVE  UPC-CUSTFACG-CLOR-DESC TO IN-UPC-CUSTFACG-CLOR-DESC.         
             MOVE  UPC-INTR-UPC-DESC      TO IN-UPC-INTR-UPC-DESC.              
             MOVE  UPC-TRNSTN-IND         TO IN-UPC-TRNSTN-IND.                 
             MOVE  UPC-PO-SHRT-CYC-IND    TO IN-UPC-PO-SHRT-CYC-IND.            
            MOVE UPC-TST-PRD-TYP-SEQ-NBR TO IN-UPC-TST-PRD-TYP-SEQ-NBR.         
             MOVE  UPC-WHSE-RPLNT-IND     TO IN-UPC-WHSE-RPLNT-IND.             
      ******************************************************************        
       S123-TUPC-VND-MOVE.                                                      
             MOVE  UPC-UPC-ID            TO VN-UPC-UPC-ID.                      
             MOVE  UPC-UPC-NBR           TO VN-UPC-UPC-NBR.                     
             MOVE  UPC-SUB-CL-MDSEAR-ID  TO VN-UPC-SUB-CL-MDSEAR-ID.            
             MOVE  UPC-VS-ID             TO VN-UPC-VS-ID.                       
             MOVE  UPC-INTR-UPC-ID       TO VN-UPC-INTR-UPC-ID.                 
             MOVE  UPC-EFF-BEG-DTE       TO VN-UPC-EFF-BEG-DTE.                 
             MOVE  UPC-UPC-TYP-CDE       TO VN-UPC-UPC-TYP-CDE.                 
             MOVE  UPC-KOHLS-SIZE-CDE    TO VN-UPC-KOHLS-SIZE-CDE.              
             MOVE  UPC-NRF-SIZE-IND      TO VN-UPC-NRF-SIZE-IND.                
             MOVE  UPC-NRF-CLOR-CDE      TO VN-UPC-NRF-CLOR-CDE.                
             MOVE  UPC-NRF-CLOR-IND      TO VN-UPC-NRF-CLOR-IND.                
             MOVE  UPC-CSTM-CLOR-DESC    TO VN-UPC-CSTM-CLOR-DESC.              
             MOVE  UPC-EDI-ORD-IND       TO VN-UPC-EDI-ORD-IND.                 
             MOVE  UPC-PREPK-IND         TO VN-UPC-PREPK-IND.                   
             MOVE  UPC-GP-CDE            TO VN-UPC-GP-CDE.                      
             MOVE  UPC-CERTD-IND         TO VN-UPC-CERTD-IND.                   
             MOVE  UPC-CERTD-DTE         TO VN-UPC-CERTD-DTE.                   
             MOVE  UPC-RPLNMT-IND        TO VN-UPC-RPLNMT-IND.                  
             MOVE  UPC-KY-ITM-IND        TO VN-UPC-KY-ITM-IND.                  
             MOVE  UPC-UNT-COST-1ST-AMT  TO VN-UPC-UNT-COST-1ST-AMT.            
             MOVE  UPC-UPC-SRC-CDE       TO VN-UPC-UPC-SRC-CDE.                 
             MOVE  UPC-INNR-PK-QTY       TO VN-UPC-INNR-PK-QTY.                 
             MOVE  UPC-OUTR-PK-QTY       TO VN-UPC-OUTR-PK-QTY.                 
             MOVE  UPC-SEA-SEQ-NBR       TO VN-UPC-SEA-SEQ-NBR.                 
             MOVE  UPC-CRE-BY-USR-ID     TO VN-UPC-CRE-BY-USR-ID.               
             MOVE  UPC-LAST-UPD-BY-USR-ID TO VN-UPC-LAST-UPD-BY-USR-ID.         
             MOVE  UPC-LAST-UPD-TMST      TO VN-UPC-LAST-UPD-TMST.              
             MOVE  UPC-WD-UM-QTY          TO VN-UPC-WD-UM-QTY.                  
             MOVE  UPC-DPTH-UM-QTY        TO VN-UPC-DPTH-UM-QTY.                
             MOVE  UPC-HT-UM-QTY          TO VN-UPC-HT-UM-QTY.                  
             MOVE  UPC-SIZE-UM-CDE        TO VN-UPC-SIZE-UM-CDE.                
             MOVE  UPC-WT-UM-QTY          TO VN-UPC-WT-UM-QTY.                  
             MOVE  UPC-WT-UM-CDE          TO VN-UPC-WT-UM-CDE.                  
             MOVE  UPC-POG-IND            TO VN-UPC-POG-IND.                    
             MOVE  UPC-REGN-PRIC-IND      TO VN-UPC-REGN-PRIC-IND.              
             MOVE  UPC-TX-PRD-CDE-SEQ-NBR TO VN-UPC-TX-PRD-CDE-SEQ-NBR.         
             MOVE  UPC-CUSTFACG-CLOR-DESC TO VN-UPC-CUSTFACG-CLOR-DESC.         
             MOVE  UPC-INTR-UPC-DESC      TO VN-UPC-INTR-UPC-DESC.              
             MOVE  UPC-TRNSTN-IND         TO VN-UPC-TRNSTN-IND.                 
             MOVE  UPC-PO-SHRT-CYC-IND    TO VN-UPC-PO-SHRT-CYC-IND.            
            MOVE UPC-TST-PRD-TYP-SEQ-NBR TO VN-UPC-TST-PRD-TYP-SEQ-NBR.         
             MOVE  UPC-WHSE-RPLNT-IND     TO VN-UPC-WHSE-RPLNT-IND.             
      ******************************************************************        
       S125-TUPC-DELETE.                                                        
           EXEC SQL                                                             
             DELETE FROM TUPC                                                   
              WHERE                                                             
                    VS_ID       = :UPC-VS-ID                                    
                AND INTR_UPC_ID = :UPC-INTR-UPC-ID                              
                AND EFF_END_DTE  = '2016-10-21'                                 
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM R900-COMMIT                                     
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPC DELETE CURSOR'                               
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S125-TUPC-DELETE'                                 
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S130-TUPC-INSERT.                                                        
           EXEC SQL                                                             
              INSERT INTO TUPC                                                  
                    (UPC_ID                                                     
                    ,UPC_NBR                                                    
                    ,SUB_CL_MDSEAR_ID                                           
                    ,VS_ID                                                      
                    ,INTR_UPC_ID                                                
                    ,EFF_BEG_DTE                                                
                    ,UPC_TYP_CDE                                                
                    ,KOHLS_SIZE_CDE                                             
                    ,NRF_SIZE_IND                                               
                    ,NRF_CLOR_CDE                                               
                    ,NRF_CLOR_IND                                               
                    ,CSTM_CLOR_DESC                                             
                    ,EDI_ORD_IND                                                
                    ,PREPK_IND                                                  
                    ,GP_CDE                                                     
                    ,CERTD_IND                                                  
                    ,CERTD_DTE                                                  
                    ,RPLNMT_IND                                                 
                    ,KY_ITM_IND                                                 
                    ,UNT_COST_1ST_AMT                                           
                    ,UPC_SRC_CDE                                                
                    ,INNR_PK_QTY                                                
                    ,OUTR_PK_QTY                                                
                    ,SEA_SEQ_NBR                                                
                    ,CRE_BY_USR_ID                                              
                    ,LAST_UPD_BY_USR_ID                                         
                    ,LAST_UPD_TMST                                              
                    ,WD_UM_QTY                                                  
                    ,DPTH_UM_QTY                                                
                    ,HT_UM_QTY                                                  
                    ,SIZE_UM_CDE                                                
                    ,WT_UM_QTY                                                  
                    ,WT_UM_CDE                                                  
                    ,POG_IND                                                    
                    ,REGN_PRIC_IND                                              
                    ,TX_PRD_CDE_SEQ_NBR                                         
                    ,CUSTFACG_CLOR_DESC                                         
                    ,INTR_UPC_DESC                                              
                    ,TRNSTN_IND                                                 
                    ,PO_SHRT_CYC_IND                                            
                    ,TST_PRD_TYP_SEQ_NBR                                        
                    ,WHSE_RPLNT_IND)                                            
             VALUES (:UPC-UPC-ID                                                
                    ,:UPC-UPC-NBR                                               
                    ,:UPC-SUB-CL-MDSEAR-ID                                      
                    ,:UPC-VS-ID                                                 
                    ,:UPC-INTR-UPC-ID                                           
                    ,:UPC-EFF-BEG-DTE                                           
                    ,:UPC-UPC-TYP-CDE                                           
                    ,:UPC-KOHLS-SIZE-CDE                                        
                    ,:UPC-NRF-SIZE-IND                                          
                    ,:UPC-NRF-CLOR-CDE                                          
                    ,:UPC-NRF-CLOR-IND                                          
                    ,:UPC-CSTM-CLOR-DESC                                        
                    ,:UPC-EDI-ORD-IND                                           
                    ,:UPC-PREPK-IND                                             
                    ,:UPC-GP-CDE                                                
                    ,:UPC-CERTD-IND                                             
                    ,:UPC-CERTD-DTE                                             
                    ,:UPC-RPLNMT-IND                                            
                    ,:UPC-KY-ITM-IND                                            
                    ,:UPC-UNT-COST-1ST-AMT                                      
                    ,:UPC-UPC-SRC-CDE                                           
                    ,:UPC-INNR-PK-QTY                                           
                    ,:UPC-OUTR-PK-QTY                                           
                    ,:UPC-SEA-SEQ-NBR                                           
                    ,:UPC-CRE-BY-USR-ID                                         
                    ,:UPC-LAST-UPD-BY-USR-ID                                    
                    ,:UPC-LAST-UPD-TMST                                         
                    ,:UPC-WD-UM-QTY                                             
                    ,:UPC-DPTH-UM-QTY                                           
                    ,:UPC-HT-UM-QTY                                             
                    ,:UPC-SIZE-UM-CDE                                           
                    ,:UPC-WT-UM-QTY                                             
                    ,:UPC-WT-UM-CDE                                             
                    ,:UPC-POG-IND                                               
                    ,:UPC-REGN-PRIC-IND                                         
                    ,:UPC-TX-PRD-CDE-SEQ-NBR                                    
                    ,:UPC-CUSTFACG-CLOR-DESC                                    
                    ,:UPC-INTR-UPC-DESC                                         
                    ,:UPC-TRNSTN-IND                                            
                    ,:UPC-PO-SHRT-CYC-IND                                       
                    ,:UPC-TST-PRD-TYP-SEQ-NBR                                   
                    ,:UPC-WHSE-RPLNT-IND)                                       
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD +1 TO PA-TUPC-COUNT                                 
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPC INSERT CURSOR'                               
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S130-TUPC-INSERT'                                 
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S131-TUPC-INT-MOVE.                                                      
             MOVE  IN-UPC-UPC-ID           TO UPC-UPC-ID.                       
             MOVE  IN-UPC-UPC-NBR          TO UPC-UPC-NBR.                      
             MOVE  IN-UPC-SUB-CL-MDSEAR-ID TO UPC-SUB-CL-MDSEAR-ID.             
             MOVE  IN-UPC-VS-ID            TO UPC-VS-ID.                        
             MOVE  IN-UPC-INTR-UPC-ID      TO UPC-INTR-UPC-ID.                  
             MOVE  IN-UPC-EFF-BEG-DTE      TO UPC-EFF-BEG-DTE.                  
             MOVE  IN-UPC-UPC-TYP-CDE      TO UPC-UPC-TYP-CDE.                  
             MOVE  IN-UPC-KOHLS-SIZE-CDE   TO UPC-KOHLS-SIZE-CDE.               
             MOVE  IN-UPC-NRF-SIZE-IND     TO UPC-NRF-SIZE-IND.                 
             MOVE  IN-UPC-NRF-CLOR-CDE     TO UPC-NRF-CLOR-CDE.                 
             MOVE  IN-UPC-NRF-CLOR-IND     TO UPC-NRF-CLOR-IND.                 
             MOVE  IN-UPC-CSTM-CLOR-DESC   TO UPC-CSTM-CLOR-DESC.               
             MOVE  IN-UPC-EDI-ORD-IND      TO UPC-EDI-ORD-IND.                  
             MOVE  IN-UPC-PREPK-IND        TO UPC-PREPK-IND.                    
             MOVE  IN-UPC-GP-CDE           TO UPC-GP-CDE.                       
             MOVE  IN-UPC-CERTD-IND        TO UPC-CERTD-IND.                    
             MOVE  IN-UPC-CERTD-DTE        TO UPC-CERTD-DTE.                    
             MOVE  IN-UPC-RPLNMT-IND       TO UPC-RPLNMT-IND.                   
             MOVE  IN-UPC-KY-ITM-IND       TO UPC-KY-ITM-IND.                   
             MOVE  IN-UPC-UNT-COST-1ST-AMT TO UPC-UNT-COST-1ST-AMT.             
             MOVE  IN-UPC-UPC-SRC-CDE      TO UPC-UPC-SRC-CDE.                  
             MOVE  IN-UPC-INNR-PK-QTY      TO UPC-INNR-PK-QTY.                  
             MOVE  IN-UPC-OUTR-PK-QTY      TO UPC-OUTR-PK-QTY.                  
             MOVE  IN-UPC-SEA-SEQ-NBR      TO UPC-SEA-SEQ-NBR.                  
             MOVE  IN-UPC-CRE-BY-USR-ID    TO UPC-CRE-BY-USR-ID.                
             MOVE  IN-UPC-LAST-UPD-BY-USR-ID TO UPC-LAST-UPD-BY-USR-ID.         
             MOVE  IN-UPC-LAST-UPD-TMST    TO UPC-LAST-UPD-TMST.                
             MOVE  IN-UPC-WD-UM-QTY        TO UPC-WD-UM-QTY.                    
             MOVE  IN-UPC-DPTH-UM-QTY      TO UPC-DPTH-UM-QTY.                  
             MOVE  IN-UPC-HT-UM-QTY        TO UPC-HT-UM-QTY.                    
             MOVE  IN-UPC-SIZE-UM-CDE      TO UPC-SIZE-UM-CDE.                  
             MOVE  IN-UPC-WT-UM-QTY        TO UPC-WT-UM-QTY.                    
             MOVE  IN-UPC-WT-UM-CDE        TO UPC-WT-UM-CDE.                    
             MOVE  IN-UPC-POG-IND          TO UPC-POG-IND.                      
             MOVE  IN-UPC-REGN-PRIC-IND    TO UPC-REGN-PRIC-IND.                
             MOVE  IN-UPC-TX-PRD-CDE-SEQ-NBR TO UPC-TX-PRD-CDE-SEQ-NBR.         
             MOVE  IN-UPC-CUSTFACG-CLOR-DESC TO UPC-CUSTFACG-CLOR-DESC.         
             MOVE  IN-UPC-INTR-UPC-DESC    TO UPC-INTR-UPC-DESC.                
             MOVE  IN-UPC-TRNSTN-IND       TO UPC-TRNSTN-IND.                   
             MOVE  IN-UPC-PO-SHRT-CYC-IND  TO UPC-PO-SHRT-CYC-IND.              
            MOVE IN-UPC-TST-PRD-TYP-SEQ-NBR TO UPC-TST-PRD-TYP-SEQ-NBR.         
             MOVE  IN-UPC-WHSE-RPLNT-IND   TO  UPC-WHSE-RPLNT-IND.              
      ******************************************************************        
       S132-TUPC-VND-MOVE.                                                      
             MOVE  VN-UPC-UPC-ID           TO UPC-UPC-ID.                       
             MOVE  VN-UPC-UPC-NBR          TO UPC-UPC-NBR.                      
             MOVE  VN-UPC-SUB-CL-MDSEAR-ID TO UPC-SUB-CL-MDSEAR-ID.             
             MOVE  VN-UPC-VS-ID            TO UPC-VS-ID.                        
             MOVE  VN-UPC-INTR-UPC-ID      TO UPC-INTR-UPC-ID.                  
             MOVE  VN-UPC-EFF-BEG-DTE      TO UPC-EFF-BEG-DTE.                  
             MOVE  VN-UPC-UPC-TYP-CDE      TO UPC-UPC-TYP-CDE.                  
             MOVE  VN-UPC-KOHLS-SIZE-CDE   TO UPC-KOHLS-SIZE-CDE.               
             MOVE  VN-UPC-NRF-SIZE-IND     TO UPC-NRF-SIZE-IND.                 
             MOVE  VN-UPC-NRF-CLOR-CDE     TO UPC-NRF-CLOR-CDE.                 
             MOVE  VN-UPC-NRF-CLOR-IND     TO UPC-NRF-CLOR-IND.                 
             MOVE  VN-UPC-CSTM-CLOR-DESC   TO UPC-CSTM-CLOR-DESC.               
             MOVE  VN-UPC-EDI-ORD-IND      TO UPC-EDI-ORD-IND.                  
             MOVE  VN-UPC-PREPK-IND        TO UPC-PREPK-IND.                    
             MOVE  VN-UPC-GP-CDE           TO UPC-GP-CDE.                       
             MOVE  VN-UPC-CERTD-IND        TO UPC-CERTD-IND.                    
             MOVE  VN-UPC-CERTD-DTE        TO UPC-CERTD-DTE.                    
             MOVE  VN-UPC-RPLNMT-IND       TO UPC-RPLNMT-IND.                   
             MOVE  VN-UPC-KY-ITM-IND       TO UPC-KY-ITM-IND.                   
             MOVE  VN-UPC-UNT-COST-1ST-AMT TO UPC-UNT-COST-1ST-AMT.             
             MOVE  VN-UPC-UPC-SRC-CDE      TO UPC-UPC-SRC-CDE.                  
             MOVE  VN-UPC-INNR-PK-QTY      TO UPC-INNR-PK-QTY.                  
             MOVE  VN-UPC-OUTR-PK-QTY      TO UPC-OUTR-PK-QTY.                  
             MOVE  VN-UPC-SEA-SEQ-NBR      TO UPC-SEA-SEQ-NBR.                  
             MOVE  VN-UPC-CRE-BY-USR-ID    TO UPC-CRE-BY-USR-ID.                
             MOVE  VN-UPC-LAST-UPD-BY-USR-ID TO UPC-LAST-UPD-BY-USR-ID.         
             MOVE  VN-UPC-LAST-UPD-TMST    TO UPC-LAST-UPD-TMST.                
             MOVE  VN-UPC-WD-UM-QTY        TO UPC-WD-UM-QTY.                    
             MOVE  VN-UPC-DPTH-UM-QTY      TO UPC-DPTH-UM-QTY.                  
             MOVE  VN-UPC-HT-UM-QTY        TO UPC-HT-UM-QTY.                    
             MOVE  VN-UPC-SIZE-UM-CDE      TO UPC-SIZE-UM-CDE.                  
             MOVE  VN-UPC-WT-UM-QTY        TO UPC-WT-UM-QTY.                    
             MOVE  VN-UPC-WT-UM-CDE        TO UPC-WT-UM-CDE.                    
             MOVE  VN-UPC-POG-IND          TO UPC-POG-IND.                      
             MOVE  VN-UPC-REGN-PRIC-IND    TO UPC-REGN-PRIC-IND.                
             MOVE  VN-UPC-TX-PRD-CDE-SEQ-NBR TO UPC-TX-PRD-CDE-SEQ-NBR.         
             MOVE  VN-UPC-CUSTFACG-CLOR-DESC TO UPC-CUSTFACG-CLOR-DESC.         
             MOVE  VN-UPC-INTR-UPC-DESC    TO UPC-INTR-UPC-DESC.                
             MOVE  VN-UPC-TRNSTN-IND       TO UPC-TRNSTN-IND.                   
             MOVE  VN-UPC-PO-SHRT-CYC-IND  TO UPC-PO-SHRT-CYC-IND.              
            MOVE VN-UPC-TST-PRD-TYP-SEQ-NBR TO UPC-TST-PRD-TYP-SEQ-NBR.         
             MOVE  VN-UPC-WHSE-RPLNT-IND   TO  UPC-WHSE-RPLNT-IND.              
      ******************************************************************        
       S140-TUPC-CLOSE.                                                         
           EXEC SQL                                                             
              CLOSE TUPC_CSR                                                    
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                      PERFORM S131-TUPC-INT-MOVE                                
                      PERFORM S125-TUPC-DELETE                                  
                      PERFORM S130-TUPC-INSERT                                  
                      SET NOT-END-OF-TUPC-CSR TO TRUE                           
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPC CLOSE CURSOR'                                
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S140-TUPC-CLOSE'                                  
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S210-TUPCPLS-SELECT.                                                     
           MOVE IM053-ITM-NBR  TO UPCPLS-ITM-NBR                                
           EXEC SQL                                                             
              OPEN TUPCPLS_CSR                                                  
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM S220-TUPCPLS-FETCH                              
                          UNTIL END-OF-TUPCPLS-CSR                              
                        PERFORM S240-TUPCPLS-CLOSE                              
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPCPLS OPEN CURSOR'                              
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S210-TUPCPLS-SELECT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S220-TUPCPLS-FETCH.                                                      
           EXEC SQL                                                             
              FETCH TUPCPLS_CSR                                                 
               INTO  :UPCPLS-UPC-ID                                             
                    ,:UPCPLS-OPERCO-NBR                                         
                    ,:UPCPLS-STR-NBR                                            
                    ,:UPCPLS-EFF-BEG-TMST                                       
                    ,:UPCPLS-UPC-STAT-CDE                                       
                    ,:UPCPLS-UNT-COST-AMT                                       
                    ,:UPCPLS-UNT-RTL-AMT                                        
                    ,:UPCPLS-MEITGP-NBR                                         
                    ,:UPCPLS-CRE-BY-USR-ID                                      
                    ,:UPCPLS-CRE-TMST                                           
                    ,:UPCPLS-ITM-NBR                                            
                    ,:UPCPLS-PLU-IND                                            
                    ,:UPCPLS-UPC-STAT-CHG-DTE                                   
                    ,:UPCPLS-UNT-RTL-CHG-DTE                                    
                    ,:UPCPLS-ORIG-CLR-DTE :PV-ORIG-CLR-NULL-IND                 
                    ,:UPCPLS-MKDN-CDE :PV-MKDN-CDE-NULL-IND                     
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        IF PV-ORIG-CLR-NULL-IND < 0                             
                            MOVE SPACES TO UPCPLS-ORIG-CLR-DTE                  
                        END-IF                                                  
                        IF PV-MKDN-CDE-NULL-IND < 0                             
                            MOVE SPACES TO UPCPLS-MKDN-CDE                      
                        END-IF                                                  
                        PERFORM S225-TUPCPLS-DELETE                             
                        PERFORM S230-TUPCPLS-INSERT                             
                   WHEN SQLCODE = +100                                          
                      SET END-OF-TUPCPLS-CSR TO TRUE                            
                   WHEN OTHER                                                   
                        DISPLAY 'UPC ID:' UPCPLS-UPC-ID                         
                        MOVE 'TUPCPLS FETCH CURSOR'                             
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S220-TUPCPLS-FETCH'                               
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S225-TUPCPLS-DELETE.                                                     
           EXEC SQL                                                             
             DELETE FROM TUPCPLS                                                
              WHERE UPC_ID       = :UPCPLS-UPC-ID                               
                AND STR_NBR      = :UPCPLS-STR-NBR                              
                AND EFF_BEG_TMST = :UPCPLS-EFF-BEG-TMST                         
                AND ITM_NBR      = :UPCPLS-ITM-NBR                              
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM R900-COMMIT                                     
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPCPLS DELETE CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S225-TUPCPLS-DELETE'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S230-TUPCPLS-INSERT.                                                     
           IF UPCPLS-MKDN-CDE = SPACE                                           
               MOVE -1 TO PV-MKDN-CDE-NULL-IND                                  
           ELSE                                                                 
               MOVE 0  TO PV-MKDN-CDE-NULL-IND                                  
           END-IF.                                                              
           IF UPCPLS-ORIG-CLR-DTE = SPACE                                       
               MOVE -1 TO PV-ORIG-CLR-NULL-IND                                  
           ELSE                                                                 
               MOVE 0  TO PV-ORIG-CLR-NULL-IND                                  
           END-IF.                                                              
           EXEC SQL                                                             
              INSERT INTO TUPCPLS                                               
                    (UPC_ID                                                     
                    ,OPERCO_NBR                                                 
                    ,STR_NBR                                                    
                    ,EFF_BEG_TMST                                               
                    ,UPC_STAT_CDE                                               
                    ,UNT_COST_AMT                                               
                    ,UNT_RTL_AMT                                                
                    ,MEITGP_NBR                                                 
                    ,CRE_BY_USR_ID                                              
                    ,CRE_TMST                                                   
                    ,ITM_NBR                                                    
                    ,PLU_IND                                                    
                    ,UPC_STAT_CHG_DTE                                           
                    ,UNT_RTL_CHG_DTE                                            
                    ,ORIG_CLR_DTE                                               
                    ,MKDN_CDE)                                                  
             VALUES (:UPCPLS-UPC-ID                                             
                    ,:UPCPLS-OPERCO-NBR                                         
                    ,:UPCPLS-STR-NBR                                            
                    ,:UPCPLS-EFF-BEG-TMST                                       
                    ,:UPCPLS-UPC-STAT-CDE                                       
                    ,:UPCPLS-UNT-COST-AMT                                       
                    ,:UPCPLS-UNT-RTL-AMT                                        
                    ,:UPCPLS-MEITGP-NBR                                         
                    ,:UPCPLS-CRE-BY-USR-ID                                      
                    ,:UPCPLS-CRE-TMST                                           
                    ,:UPCPLS-ITM-NBR                                            
                    ,:UPCPLS-PLU-IND                                            
                    ,:UPCPLS-UPC-STAT-CHG-DTE                                   
                    ,:UPCPLS-UNT-RTL-CHG-DTE                                    
                    ,:UPCPLS-ORIG-CLR-DTE:PV-ORIG-CLR-NULL-IND                  
                    ,:UPCPLS-MKDN-CDE:PV-MKDN-CDE-NULL-IND)                     
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD +1 TO PA-TUPCPLS-COUNT                              
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPCPLS INSERT CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S230-TUPCPLS-INSERT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S240-TUPCPLS-CLOSE.                                                      
           EXEC SQL                                                             
              CLOSE TUPCPLS_CSR                                                 
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                      SET NOT-END-OF-TUPCPLS-CSR TO TRUE                        
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TUPCPLS CLOSE CURSOR'                             
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S240-TUPC-CLOSE'                                  
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R900-COMMIT.                                                             
           EXEC SQL                                                             
               COMMIT                                                           
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        CONTINUE                                                
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'COMMIT ISSUE'                                     
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R900-COMMIT'                                      
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S310-TSKXREF-SELECT.                                                     
             MOVE  IM053-SKU             TO SKXREF-SKU.                         
             MOVE  SPACES                TO SKXREF-DEPT-NBR.                    
             MOVE  SPACES                TO SKXREF-CL-NBR.                      
             MOVE  SPACES                TO SKXREF-SKU-SEQ-NBR.                 
             MOVE  IM053-SKU-STAT-CDE    TO SKXREF-SKU-STAT-CDE.                
             MOVE  IM053-ITM-NBR         TO SKXREF-ITM-NBR.                     
             MOVE  IM053-INTR-UPC-ID     TO SKXREF-INTR-UPC-ID.                 
             MOVE  MDARVS-DEPT-NBR       TO SKXREF-DEPT.                        
             MOVE  MDARVS-MAJ-CL-NBR     TO SKXREF-CLASS.                       
             MOVE  MDARVS-SUB-CL-NBR     TO SKXREF-SUBCLASS.                    
             PERFORM S320-TSKXREF-INSERT.                                       
      ******************************************************************        
       S320-TSKXREF-INSERT.                                                     
               EXEC SQL                                                         
                    INSERT INTO TSKXREF                                         
                            (DEPT_NBR                                           
                            ,CL_NBR                                             
                            ,SKU_SEQ_NBR                                        
                            ,SKU_STAT_CDE                                       
                            ,ITM_NBR                                            
                            ,INTR_UPC_ID                                        
                            ,DEPT                                               
                            ,CLASS                                              
                            ,SUBCLASS                                           
                            ,SKU)                                               
                    VALUES  (:SKXREF-DEPT-NBR                                   
                            ,:SKXREF-CL-NBR                                     
                            ,:SKXREF-SKU-SEQ-NBR                                
                            ,:SKXREF-SKU-STAT-CDE                               
                            ,:SKXREF-ITM-NBR                                    
                            ,:SKXREF-INTR-UPC-ID                                
                            ,:SKXREF-DEPT                                       
                            ,:SKXREF-CLASS                                      
                            ,:SKXREF-SUBCLASS                                   
                            ,:SKXREF-SKU)                                       
               END-EXEC.                                                        
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD +1 TO PA-TSKXREF-COUNT                              
                   WHEN SQLCODE = -803                                          
                        DISPLAY 'SKU ALREADY AVAILABLE IN TSKXREF'              
                        DISPLAY 'TSKXREF SKU:' SKXREF-SKU                       
                   WHEN OTHER                                                   
                        DISPLAY 'TSKXREF SKU:' SKXREF-SKU                       
                        MOVE 'TSKXREF INSERT ISSUE'                             
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S320-TSKXREF-INSERT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       T200-TUPCSKU-INSERT.                                                     
               EXEC SQL                                                         
                    INSERT INTO TUPCSKU                                         
                            (UPC_NBR                                            
                            ,ITEM_NBR                                           
                            ,EDI_ORD_IND                                        
                            ,PLU_DWNLD_IND                                      
                            ,XREF_CRE_DTE                                       
                            ,UPC_DESC                                           
                            ,CERT_IND                                           
                            ,CERT_DTE                                           
                            ,UPC_SRC_IND                                        
                            ,UMDCLN_IND)                                        
                    VALUES  (:TUPCSKU-UPC-NBR                                   
                            ,:TUPCSKU-ITEM-NBR                                  
                            ,:TUPCSKU-EDI-ORD-IND                               
                            ,:TUPCSKU-PLU-DWNLD-IND                             
                            ,:TUPCSKU-XREF-CRE-DTE                              
                            ,:TUPCSKU-UPC-DESC                                  
                            ,:TUPCSKU-CERT-IND                                  
                            ,:TUPCSKU-CERT-DTE                                  
                            ,:TUPCSKU-UPC-SRC-IND                               
                            ,:TUPCSKU-UMDCLN-IND)                               
               END-EXEC.                                                        
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD +1 TO PA-TUPCSKU-COUNT                              
                   WHEN SQLCODE = -803                                          
                        DISPLAY 'UPC NBR ALREADY AVAILABLE IN TUPCSKU'          
                        DISPLAY 'TUPCSKU UPC NBR:' TUPCSKU-UPC-NBR              
                   WHEN OTHER                                                   
                        DISPLAY 'TUPCSKU ITEM NBR' TUPCSKU-ITEM-NBR             
                        MOVE 'TUPCSKU INSERT ISSUE'                             
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'T200-TUPCSKU-INSERT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S410-TSKST-SELECT.                                                       
      * INSERTING DIRECTLY SINCE THE FILE IS IN THE FORMAT OF TSKST             
             MOVE IM999-ITEM-NMBR          TO TSKST-ITEM-NMBR.                  
             MOVE IM999-LOC-NBR            TO TSKST-LOC-NBR.                    
             MOVE IM999-LAST-SALE-DATE     TO TSKST-LAST-SALE-DATE.             
             MOVE IM999-LAST-RCVD-DATE     TO TSKST-LAST-RCVD-DATE.             
             MOVE IM999-ONHAND-QTY         TO TSKST-ONHAND-QTY.                 
             MOVE IM999-FIRST-RCVD-DATE    TO TSKST-FIRST-RCVD-DATE.            
             MOVE IM999-FIRST-SALE-DATE    TO TSKST-FIRST-SALE-DATE.            
             MOVE IM999-YTD-SALES-UNIT-QTY TO TSKST-YTD-SALES-UNIT-QTY.         
             MOVE IM999-YTD-SALES-AMT      TO TSKST-YTD-SALES-AMT.              
             MOVE IM999-LAST-UPD-TMST      TO TSKST-LAST-UPD-TMST.              
             PERFORM S420-TSKST-INSERT.                                         
      ******************************************************************        
       S420-TSKST-INSERT.                                                       
               EXEC SQL                                                         
                    INSERT INTO TSKST                                           
                          (ITEM_NMBR                                            
                          ,LOC_NBR                                              
                          ,LAST_SALE_DATE                                       
                          ,LAST_RCVD_DATE                                       
                          ,ONHAND_QTY                                           
                          ,FIRST_RCVD_DATE                                      
                          ,FIRST_SALE_DATE                                      
                          ,YTD_SALES_UNIT_QTY                                   
                          ,YTD_SALES_AMT                                        
                          ,LAST_UPD_TMST)                                       
                    VALUES (:TSKST-ITEM-NMBR                                    
                            ,:TSKST-LOC-NBR                                     
                            ,:TSKST-LAST-SALE-DATE                              
                            ,:TSKST-LAST-RCVD-DATE                              
                            ,:TSKST-ONHAND-QTY                                  
                            ,:TSKST-FIRST-RCVD-DATE                             
                            ,:TSKST-FIRST-SALE-DATE                             
                            ,:TSKST-YTD-SALES-UNIT-QTY                          
                            ,:TSKST-YTD-SALES-AMT                               
                            ,:TSKST-LAST-UPD-TMST)                              
               END-EXEC.                                                        
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD +1 TO PA-TSKST-COUNT                                
                   WHEN SQLCODE = -803                                          
                        DISPLAY 'ITEM ALREADY AVAILABLE IN TSKST'               
                        DISPLAY 'TSKST ITEM NMBR:' TSKST-ITEM-NMBR              
                   WHEN OTHER                                                   
                        DISPLAY 'TSKST ITEM NMBR:' TSKST-ITEM-NMBR              
                        MOVE 'TSKST INSERT ISSUE'                               
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S420-TSKST-INSERT'                                
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S610-TSK-SELECT.                                                         
             MOVE IM999-MERCH-DEPT-NMBR    TO TSK-MERCH-DEPT-NMBR.              
             MOVE IM999-MERCH-CLASS-NMBR   TO TSK-MERCH-CLASS-NMBR.             
             MOVE IM999-SEQ-NMBR           TO TSK-SEQ-NMBR.                     
             MOVE IM999-CUM-SALES-UNIT-QTY TO TSK-CUM-SALES-UNIT-QTY.           
             MOVE IM999-RTL-UNIT-RCVD-QTY  TO TSK-RTL-UNIT-RCVD-QTY.            
             MOVE IM999-COST-UNIT-MSRMNT   TO TSK-COST-UNIT-MSRMNT.             
             MOVE IM999-RTL-UNIT-MSRMNT    TO TSK-RTL-UNIT-MSRMNT.              
             MOVE IM999-UNIT-COST-AMT      TO TSK-UNIT-COST-AMT.                
             MOVE IM999-CUR-UNIT-RTL-AMT   TO TSK-CUR-UNIT-RTL-AMT.             
             MOVE IM999-ORIG-UNIT-RTL-AMT  TO TSK-ORIG-UNIT-RTL-AMT.            
             MOVE IM999-VNDR-INNR-PACK-QTY TO TSK-VNDR-INNR-PACK-QTY.           
             MOVE IM999-SHPMT-COUNT-QTY    TO TSK-SHPMT-COUNT-QTY.              
             MOVE IM999-VENDOR-STYLE-CODE  TO TSK-VENDOR-STYLE-CODE.            
             MOVE IM999-STAT-CHNGD-DATE    TO TSK-STAT-CHNGD-DATE.              
             MOVE IM999-STATUS-CODE        TO TSK-STATUS-CODE.                  
             MOVE IM999-AUTO-RORD-MTH-CODE TO TSK-AUTO-RORD-MTH-CODE.           
             MOVE IM999-RTL-CST-CVRSN-FCTR TO TSK-RTL-CST-CVRSN-FCTR.           
             MOVE IM999-SETUP-DATE         TO TSK-SETUP-DATE.                   
             MOVE IM999-PRICE-CHNG-DATE    TO TSK-PRICE-CHNG-DATE.              
             MOVE IM999-GROUP-CODE         TO TSK-GROUP-CODE.                   
             MOVE IM999-SKU-DESC           TO TSK-SKU-DESC.                     
             MOVE IM999-SIZE-DESC          TO TSK-SIZE-DESC.                    
             MOVE IM999-COLOR-DESC         TO TSK-COLOR-DESC.                   
             MOVE IM999-REORDER-FRMT-CODE  TO TSK-REORDER-FRMT-CODE.            
             MOVE IM999-MERCH-DIV-CODE     TO TSK-MERCH-DIV-CODE.               
             MOVE IM999-DMM-NMBR           TO TSK-DMM-NMBR.                     
             MOVE IM999-BUYER-NMBR         TO TSK-BUYER-NMBR.                   
             MOVE IM999-VENDOR-NMBR        TO TSK-VENDOR-NMBR.                  
             MOVE IM999-VNDR-IN-HSE-NMBR   TO TSK-VNDR-IN-HSE-NMBR.             
             MOVE IM999-MKDN-PGM-CODE      TO TSK-MKDN-PGM-CODE.                
             MOVE IM999-LOWST-UNIT-RTL-AMT TO TSK-LOWST-UNIT-RTL-AMT.           
             MOVE IM999-LOW-RTL-PRICE-DATE TO TSK-LOW-RTL-PRICE-DATE.           
             MOVE IM999-ITEM-NMBR-TSK      TO TSK-ITEM-NMBR.                    
             MOVE IM999-GP-RTL-AMT         TO TSK-GP-RTL-AMT.                   
             MOVE IM999-ORIG-GP-QTY        TO TSK-ORIG-GP-QTY.                  
             MOVE IM999-ORIG-GP-RTL-AMT    TO TSK-ORIG-GP-RTL-AMT.              
             MOVE IM999-FS-RPT-IND         TO TSK-FS-RPT-IND.                   
             MOVE IM999-GP-QTY             TO TSK-GP-QTY.                       
             MOVE IM999-MULT-PR-PT-IND     TO TSK-MULT-PR-PT-IND.               
             MOVE IM999-PLU-DWNLD-EXCL-IND TO TSK-PLU-DWNLD-EXCL-IND.           
             MOVE IM999-LAST-PO-REV-DTE    TO TSK-LAST-PO-REV-DTE.              
             MOVE IM999-PO-REV-DAY-NBR     TO TSK-PO-REV-DAY-NBR.               
             MOVE IM999-PO-REV-SUN-WK-NBR  TO TSK-PO-REV-SUN-WK-NBR.            
             MOVE IM999-PO-REV-MON-WK-NBR  TO TSK-PO-REV-MON-WK-NBR.            
             MOVE IM999-PO-REV-TUE-WK-NBR  TO TSK-PO-REV-TUE-WK-NBR.            
             MOVE IM999-PO-REV-WED-WK-NBR  TO TSK-PO-REV-WED-WK-NBR.            
             MOVE IM999-PO-REV-THU-WK-NBR  TO TSK-PO-REV-THU-WK-NBR.            
             MOVE IM999-PO-REV-FRI-WK-NBR  TO TSK-PO-REV-FRI-WK-NBR.            
             MOVE IM999-PO-REV-SAT-WK-NBR  TO TSK-PO-REV-SAT-WK-NBR.            
             MOVE IM999-CENT-STK-CDE       TO TSK-CENT-STK-CDE.                 
             MOVE IM999-MEITGP-NBR         TO TSK-MEITGP-NBR.                   
             MOVE IM999-SKU-TYP-CDE        TO TSK-SKU-TYP-CDE.                  
             MOVE IM999-VEND-OUTR-PACK-QTY TO TSK-VEND-OUTR-PACK-QTY.           
             MOVE IM999-LONG-VENDOR-STYLE  TO TSK-LONG-VENDOR-STYLE.            
             MOVE IM999-SIZE-CDE           TO TSK-SIZE-CDE.                     
             MOVE IM999-LONG-SIZE-DESC     TO TSK-LONG-SIZE-DESC.               
             MOVE IM999-COLOR-CDE          TO TSK-COLOR-CDE.                    
             MOVE IM999-LONG-COLOR-DESC    TO TSK-LONG-COLOR-DESC.              
             MOVE IM999-STICKER-NBR        TO TSK-STICKER-NBR.                  
             MOVE IM999-ENT-ID             TO TSK-ENT-ID.                       
             MOVE IM999-TKT-FMT-ID         TO TSK-TKT-FMT-ID.                   
             MOVE IM999-KY-ITM-IND         TO TSK-KY-ITM-IND.                   
             MOVE IM999-VS-CHARTC-CDE      TO TSK-VS-CHARTC-CDE.                
             MOVE IM999-VS-CHARTC-SEQ-NBR  TO TSK-VS-CHARTC-SEQ-NBR.            
             MOVE IM999-UNT-COST-1ST-AMT   TO TSK-UNT-COST-1ST-AMT.             
             MOVE IM999-REGN-PRIC-IND      TO TSK-REGN-PRIC-IND.                
             PERFORM S620-TSK-INSERT.                                           
      ******************************************************************        
       S620-TSK-INSERT.                                                         
               EXEC SQL                                                         
                    INSERT INTO TSK                                             
                           (MERCH_DEPT_NMBR                                     
                            ,MERCH_CLASS_NMBR                                   
                            ,SEQ_NMBR                                           
                            ,CUM_SALES_UNIT_QTY                                 
                            ,RTL_UNIT_RCVD_QTY                                  
                            ,COST_UNIT_MSRMNT                                   
                            ,RTL_UNIT_MSRMNT                                    
                            ,UNIT_COST_AMT                                      
                            ,CUR_UNIT_RTL_AMT                                   
                            ,ORIG_UNIT_RTL_AMT                                  
                            ,VNDR_INNR_PACK_QTY                                 
                            ,SHPMT_COUNT_QTY                                    
                            ,VENDOR_STYLE_CODE                                  
                            ,STAT_CHNGD_DATE                                    
                            ,STATUS_CODE                                        
                            ,AUTO_RORD_MTH_CODE                                 
                            ,RTL_CST_CVRSN_FCTR                                 
                            ,SETUP_DATE                                         
                            ,PRICE_CHNG_DATE                                    
                            ,GROUP_CODE                                         
                            ,SKU_DESC                                           
                            ,SIZE_DESC                                          
                            ,COLOR_DESC                                         
                            ,REORDER_FRMT_CODE                                  
                            ,MERCH_DIV_CODE                                     
                            ,DMM_NMBR                                           
                            ,BUYER_NMBR                                         
                            ,VENDOR_NMBR                                        
                            ,VNDR_IN_HSE_NMBR                                   
                            ,MKDN_PGM_CODE                                      
                            ,LOWST_UNIT_RTL_AMT                                 
                            ,LOW_RTL_PRICE_DATE                                 
                            ,ITEM_NMBR                                          
                            ,GP_RTL_AMT                                         
                            ,ORIG_GP_QTY                                        
                            ,ORIG_GP_RTL_AMT                                    
                            ,FS_RPT_IND                                         
                            ,GP_QTY                                             
                            ,MULT_PR_PT_IND                                     
                            ,PLU_DWNLD_EXCL_IND                                 
                            ,LAST_PO_REV_DTE                                    
                            ,PO_REV_DAY_NBR                                     
                            ,PO_REV_SUN_WK_NBR                                  
                            ,PO_REV_MON_WK_NBR                                  
                            ,PO_REV_TUE_WK_NBR                                  
                            ,PO_REV_WED_WK_NBR                                  
                            ,PO_REV_THU_WK_NBR                                  
                            ,PO_REV_FRI_WK_NBR                                  
                            ,PO_REV_SAT_WK_NBR                                  
                            ,CENT_STK_CDE                                       
                            ,MEITGP_NBR                                         
                            ,SKU_TYP_CDE                                        
                            ,VEND_OUTR_PACK_QTY                                 
                            ,LONG_VENDOR_STYLE                                  
                            ,SIZE_CDE                                           
                            ,LONG_SIZE_DESC                                     
                            ,COLOR_CDE                                          
                            ,LONG_COLOR_DESC                                    
                            ,STICKER_NBR                                        
                            ,ENT_ID                                             
                            ,TKT_FMT_ID                                         
                            ,KY_ITM_IND                                         
                            ,VS_CHARTC_CDE                                      
                            ,VS_CHARTC_SEQ_NBR                                  
                            ,UNT_COST_1ST_AMT                                   
                            ,REGN_PRIC_IND)                                     
                    VALUES                                                      
                             (:TSK-MERCH-DEPT-NMBR                              
                            ,:TSK-MERCH-CLASS-NMBR                              
                            ,:TSK-SEQ-NMBR                                      
                            ,:TSK-CUM-SALES-UNIT-QTY                            
                            ,:TSK-RTL-UNIT-RCVD-QTY                             
                            ,:TSK-COST-UNIT-MSRMNT                              
                            ,:TSK-RTL-UNIT-MSRMNT                               
                            ,:TSK-UNIT-COST-AMT                                 
                            ,:TSK-CUR-UNIT-RTL-AMT                              
                            ,:TSK-ORIG-UNIT-RTL-AMT                             
                            ,:TSK-VNDR-INNR-PACK-QTY                            
                            ,:TSK-SHPMT-COUNT-QTY                               
                            ,:TSK-VENDOR-STYLE-CODE                             
                            ,:TSK-STAT-CHNGD-DATE                               
                            ,:TSK-STATUS-CODE                                   
                            ,:TSK-AUTO-RORD-MTH-CODE                            
                            ,:TSK-RTL-CST-CVRSN-FCTR                            
                            ,:TSK-SETUP-DATE                                    
                            ,:TSK-PRICE-CHNG-DATE                               
                            ,:TSK-GROUP-CODE                                    
                            ,:TSK-SKU-DESC                                      
                            ,:TSK-SIZE-DESC                                     
                            ,:TSK-COLOR-DESC                                    
                            ,:TSK-REORDER-FRMT-CODE                             
                            ,:TSK-MERCH-DIV-CODE                                
                            ,:TSK-DMM-NMBR                                      
                            ,:TSK-BUYER-NMBR                                    
                            ,:TSK-VENDOR-NMBR                                   
                            ,:TSK-VNDR-IN-HSE-NMBR                              
                            ,:TSK-MKDN-PGM-CODE                                 
                            ,:TSK-LOWST-UNIT-RTL-AMT                            
                            ,:TSK-LOW-RTL-PRICE-DATE                            
                            ,:TSK-ITEM-NMBR                                     
                            ,:TSK-GP-RTL-AMT                                    
                            ,:TSK-ORIG-GP-QTY                                   
                            ,:TSK-ORIG-GP-RTL-AMT                               
                            ,:TSK-FS-RPT-IND                                    
                            ,:TSK-GP-QTY                                        
                            ,:TSK-MULT-PR-PT-IND                                
                            ,:TSK-PLU-DWNLD-EXCL-IND                            
                            ,:TSK-LAST-PO-REV-DTE                               
                            ,:TSK-PO-REV-DAY-NBR                                
                            ,:TSK-PO-REV-SUN-WK-NBR                             
                            ,:TSK-PO-REV-MON-WK-NBR                             
                            ,:TSK-PO-REV-TUE-WK-NBR                             
                            ,:TSK-PO-REV-WED-WK-NBR                             
                            ,:TSK-PO-REV-THU-WK-NBR                             
                            ,:TSK-PO-REV-FRI-WK-NBR                             
                            ,:TSK-PO-REV-SAT-WK-NBR                             
                            ,:TSK-CENT-STK-CDE                                  
                            ,:TSK-MEITGP-NBR                                    
                            ,:TSK-SKU-TYP-CDE                                   
                            ,:TSK-VEND-OUTR-PACK-QTY                            
                            ,:TSK-LONG-VENDOR-STYLE                             
                            ,:TSK-SIZE-CDE                                      
                            ,:TSK-LONG-SIZE-DESC                                
                            ,:TSK-COLOR-CDE                                     
                            ,:TSK-LONG-COLOR-DESC                               
                            ,:TSK-STICKER-NBR                                   
                            ,:TSK-ENT-ID                                        
                            ,:TSK-TKT-FMT-ID                                    
                            ,:TSK-KY-ITM-IND                                    
                            ,:TSK-VS-CHARTC-CDE                                 
                            ,:TSK-VS-CHARTC-SEQ-NBR                             
                            ,:TSK-UNT-COST-1ST-AMT                              
                            ,:TSK-REGN-PRIC-IND)                                
               END-EXEC.                                                        
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD +1 TO PA-TSK-COUNT                                  
                   WHEN SQLCODE = -803                                          
                        DISPLAY 'ITEM ALREADY AVAILABLE IN TSK'                 
                        DISPLAY 'ITEM NMBR:' TSK-ITEM-NMBR                      
                   WHEN OTHER                                                   
                        DISPLAY 'TSK-ITEM-NMBR' TSK-ITEM-NMBR                   
                        MOVE 'TSK INSERT ISSUE'                                 
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S620-TSK-INSERT'                                  
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S510-TWEBITM-SELECT.                                                     
           MOVE IM053-INTR-UPC-ID TO WEBITM-INTR-UPC-ID                         
           EXEC SQL                                                             
             SELECT  INTR_UPC_ID                                                
                    ,EFF_BEG_TMST                                               
                    ,ASRT_BEG_DTE                                               
                    ,ASRT_END_DTE                                               
                    ,STRG_AREA_SEQ_NBR                                          
                    ,SHIP_WD_QTY                                                
                    ,SHIP_DPTH_QTY                                              
                    ,SHIP_HT_QTY                                                
                    ,SHIP_WT_QTY                                                
                    ,SHIP_DIM_SRC_CDE                                           
                    ,PKG_SEQ_NBR                                                
                    ,SHIP_RSTRC_SEQ_NBR                                         
                    ,GFT_WRAP_AVL_IND                                           
                    ,PRD_GP_NBR                                                 
                    ,PRD_GP_IND                                                 
                    ,SHIP_SRCHG_FEE_AMT                                         
                    ,SHIP_SRVC_SEQ_NBR                                          
                    ,SHIP_GP_SEQ_NBR                                            
                    ,CRE_BY_USR_ID                                              
                    ,WEB_ITM_DLTD_IND                                           
                    ,HAZDS_IND                                                  
                    ,BRKBL_IND                                                  
                    ,GC_IND                                                     
                    ,SHIP_ALN_IND                                               
                    ,WEB_EXCLV_IND                                              
                 INTO                                                           
                     :WEBITM-INTR-UPC-ID                                        
                    ,:WEBITM-EFF-BEG-TMST                                       
                    ,:WEBITM-ASRT-BEG-DTE                                       
                    ,:WEBITM-ASRT-END-DTE                                       
                    ,:WEBITM-STRG-AREA-SEQ-NBR                                  
                    ,:WEBITM-SHIP-WD-QTY                                        
                    ,:WEBITM-SHIP-DPTH-QTY                                      
                    ,:WEBITM-SHIP-HT-QTY                                        
                    ,:WEBITM-SHIP-WT-QTY                                        
                    ,:WEBITM-SHIP-DIM-SRC-CDE                                   
                    ,:WEBITM-PKG-SEQ-NBR                                        
                    ,:WEBITM-SHIP-RSTRC-SEQ-NBR                                 
                    ,:WEBITM-GFT-WRAP-AVL-IND                                   
                    ,:WEBITM-PRD-GP-NBR                                         
                    ,:WEBITM-PRD-GP-IND                                         
                    ,:WEBITM-SHIP-SRCHG-FEE-AMT                                 
                    ,:WEBITM-SHIP-SRVC-SEQ-NBR                                  
                    ,:WEBITM-SHIP-GP-SEQ-NBR                                    
                    ,:WEBITM-CRE-BY-USR-ID                                      
                    ,:WEBITM-WEB-ITM-DLTD-IND                                   
                    ,:WEBITM-HAZDS-IND                                          
                    ,:WEBITM-BRKBL-IND                                          
                    ,:WEBITM-GC-IND                                             
                    ,:WEBITM-SHIP-ALN-IND                                       
                    ,:WEBITM-WEB-EXCLV-IND                                      
                FROM  TWEBITM                                                   
                WHERE INTR_UPC_ID  = :WEBITM-INTR-UPC-ID                        
                 AND EFF_END_TMST BETWEEN '2016-10-21-00.00.00.000000'          
                                      AND '2016-10-22-00.00.00.000000'          
               WITH UR                                                          
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM R505-TWEBITM-DELETE                             
                        PERFORM R510-TWEBITM-INSERT                             
                        ADD  +1  TO PA-TWEBITM-COUNT                            
                   WHEN SQLCODE = +100                                          
                        DISPLAY 'TWEBITM ROW NOT FOUND'                         
                        DISPLAY 'INTR UPC ID:' WEBITM-INTR-UPC-ID               
                   WHEN OTHER                                                   
                        MOVE 'TWEBITM SELECT CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R510-TWEBITM-SELECT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R505-TWEBITM-DELETE.                                                     
           EXEC SQL                                                             
             DELETE FROM TWEBITM                                                
                WHERE INTR_UPC_ID  = :WEBITM-INTR-UPC-ID                        
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        PERFORM R900-COMMIT                                     
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TWEBITM DELETE CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R505-TWEBITM-SELECT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       R510-TWEBITM-INSERT.                                                     
           EXEC SQL                                                             
                INSERT INTO TWEBITM                                             
                    (INTR_UPC_ID                                                
                    ,EFF_BEG_TMST                                               
                    ,ASRT_BEG_DTE                                               
                    ,ASRT_END_DTE                                               
                    ,STRG_AREA_SEQ_NBR                                          
                    ,SHIP_WD_QTY                                                
                    ,SHIP_DPTH_QTY                                              
                    ,SHIP_HT_QTY                                                
                    ,SHIP_WT_QTY                                                
                    ,SHIP_DIM_SRC_CDE                                           
                    ,PKG_SEQ_NBR                                                
                    ,SHIP_RSTRC_SEQ_NBR                                         
                    ,GFT_WRAP_AVL_IND                                           
                    ,PRD_GP_NBR                                                 
                    ,PRD_GP_IND                                                 
                    ,SHIP_SRCHG_FEE_AMT                                         
                    ,SHIP_SRVC_SEQ_NBR                                          
                    ,SHIP_GP_SEQ_NBR                                            
                    ,CRE_BY_USR_ID                                              
                    ,WEB_ITM_DLTD_IND                                           
                    ,HAZDS_IND                                                  
                    ,BRKBL_IND                                                  
                    ,GC_IND                                                     
                    ,SHIP_ALN_IND                                               
                    ,WEB_EXCLV_IND)                                             
             VALUES (:WEBITM-INTR-UPC-ID                                        
                    ,:WEBITM-EFF-BEG-TMST                                       
                    ,:WEBITM-ASRT-BEG-DTE                                       
                    ,:WEBITM-ASRT-END-DTE                                       
                    ,:WEBITM-STRG-AREA-SEQ-NBR                                  
                    ,:WEBITM-SHIP-WD-QTY                                        
                    ,:WEBITM-SHIP-DPTH-QTY                                      
                    ,:WEBITM-SHIP-HT-QTY                                        
                    ,:WEBITM-SHIP-WT-QTY                                        
                    ,:WEBITM-SHIP-DIM-SRC-CDE                                   
                    ,:WEBITM-PKG-SEQ-NBR                                        
                    ,:WEBITM-SHIP-RSTRC-SEQ-NBR                                 
                    ,:WEBITM-GFT-WRAP-AVL-IND                                   
                    ,:WEBITM-PRD-GP-NBR                                         
                    ,:WEBITM-PRD-GP-IND                                         
                    ,:WEBITM-SHIP-SRCHG-FEE-AMT                                 
                    ,:WEBITM-SHIP-SRVC-SEQ-NBR                                  
                    ,:WEBITM-SHIP-GP-SEQ-NBR                                    
                    ,:WEBITM-CRE-BY-USR-ID                                      
                    ,:WEBITM-WEB-ITM-DLTD-IND                                   
                    ,:WEBITM-HAZDS-IND                                          
                    ,:WEBITM-BRKBL-IND                                          
                    ,:WEBITM-GC-IND                                             
                    ,:WEBITM-SHIP-ALN-IND                                       
                    ,:WEBITM-WEB-EXCLV-IND)                                     
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        CONTINUE                                                
                   WHEN SQLCODE NOT = ZERO                                      
                        MOVE 'TWEBITM INSERT CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'R510-TWEBITM-INSERT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       S900-CUSTSKU-UPDATE.                                                     
           EXEC SQL                                                             
             UPDATE IMT_CUST_CHC_SKU_ASSN                                       
                    SET EFF_END_TMST = NULL                                     
                    WHERE SKU_NBR    = :IM053-SKU                               
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD  +1  TO PA-TIMTSKU-COUNT                            
                   WHEN SQLCODE = +100                                          
                        DISPLAY 'CUST SKU NOT AVAILABLE'                        
                        DISPLAY 'SKU:' IM053-SKU                                
                   WHEN OTHER                                                   
                        MOVE 'CUST SKU UPDATE CURSOR'                           
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'S900-CUSTSKU-UPDATE'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       W200-TPPCPRC-DELETE.                                                     
           EXEC SQL                                                             
             DELETE FROM TPPCPRC                                                
              WHERE TSK_ITM_NBR  = :PPCPRC-TSK-ITM-NBR                          
           END-EXEC.                                                            
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        CONTINUE                                                
                   WHEN SQLCODE = +100                                          
                        DISPLAY 'ROW NOT AVAILABLE IN TPPCPRC'                  
                        DISPLAY 'TSK ITEM NUMBER:' PPCPRC-TSK-ITM-NBR           
                   WHEN OTHER                                                   
                        MOVE 'TPPCPRC DELETE CURSOR'                            
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'W200-TPPCPRC-DELETE'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
       U200-TPPCPRC-INSERT.                                                     
               EXEC SQL                                                         
                    INSERT INTO TPPCPRC                                         
                            (TSK_ITM_NBR                                        
                            ,STRT_TMST                                          
                            ,STR_NBR                                            
                            ,END_TMST                                           
                            ,MEITGP_NBR                                         
                            ,RTL_AMT                                            
                            ,STATUS_CDE                                         
                            ,UID_NBR)                                           
                    VALUES  (:PPCPRC-TSK-ITM-NBR                                
                            ,:PPCPRC-STRT-TMST                                  
                            ,:PPCPRC-STR-NBR                                    
                            ,:PPCPRC-END-TMST                                   
                            ,:PPCPRC-MEITGP-NBR                                 
                            ,:PPCPRC-RTL-AMT                                    
                            ,:PPCPRC-STATUS-CDE                                 
                            ,:PPCPRC-UID-NBR)                                   
               END-EXEC.                                                        
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = 0                                             
                        ADD +1 TO PA-TPPCPRC-COUNT                              
                   WHEN SQLCODE = -803                                          
                        DISPLAY 'TPPCPRC ITEM NUMBER ALREADY AVAILABLE'         
                        DISPLAY 'TPPCPRC UPC NBR:' PPCPRC-TSK-ITM-NBR           
                   WHEN OTHER                                                   
                        DISPLAY 'TPPCPRC ITEM NBR' PPCPRC-TSK-ITM-NBR           
                        MOVE 'TPPCPRC INSERT ISSUE'                             
                                   TO PV-DB2-OPERATION-ATTEMPTED                
                        MOVE 'U200-TPPCPRC-INSERT'                              
                                   TO PV-PARAGRAPH-NAME                         
                        PERFORM 9999-SQL-ABEND                                  
               END-EVALUATE.                                                    
      ******************************************************************        
      *    - CLOSE THE FILES PROCESSED BY PROGRAM                      *        
      *    - DISPLAY OUTPUT RECORD COUNTS                              *        
      ******************************************************************        
       9000-EOJ-ROUTINE.                                                        
                                                                                
           CLOSE IN-STYLE-DETAILS.                                              
           CLOSE ITEMSKU-FILE.                                                  
           CLOSE TSKSTUNLD-FILE.                                                
           CLOSE TUPCSKU-FILE.                                                  
           CLOSE TPPCPRC-ITEM.                                                  
           CLOSE TPPCPRC-FILE.                                                  
           DISPLAY SPACE.                                                       
           DISPLAY 'TMDARVS INSERTED COUNT:' PA-TMDARVS-COUNT.                  
           DISPLAY 'TVNDSTL INSERTED COUNT:' PA-TVNDSTL-COUNT.                  
           DISPLAY 'IMT CHC UPDATE COUNT  :' PA-TIMTCHC-COUNT.                  
           DISPLAY 'IMT SKU UPDATE COUNT  :' PA-TIMTSKU-COUNT.                  
           DISPLAY 'TUPC INSERTED COUNT   :' PA-TUPC-COUNT.                     
           DISPLAY 'TUPCPLS INSERTED COUNT:' PA-TUPCPLS-COUNT.                  
           DISPLAY 'TSKXREF INSERTED COUNT:' PA-TSKXREF-COUNT.                  
           DISPLAY 'TSKST INSERTED COUNT  :' PA-TSKST-COUNT.                    
           DISPLAY 'TSK   INSERTED COUNT  :' PA-TSK-COUNT.                      
           DISPLAY 'TWEBITM INSERTED COUNT:' PA-TWEBITM-COUNT.                  
           DISPLAY 'TUPCSKU INSERTED COUNT:' PA-TUPCSKU-COUNT.                  
           DISPLAY 'TPPCPRC INSERTED COUNT:' PA-TPPCPRC-COUNT.                  
                                                                                
                                                                                
      ******************************************************************        
      * ABEND THE PROGRAM IN THE EVENT THAT AN SQL ERROR OR WARNING             
      * CODE OCCURS.                                                            
      ******************************************************************        
       9999-SQL-ABEND.                                                          
                                                                                
           DISPLAY '** ABEND     **'.                                           
           DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                        
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
                                                                                
      *-----------------------------------------------------------------        
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
      * MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
      * FORMAT.                                                                 
      *-----------------------------------------------------------------        
                                                                                
           COPY DPPD004.                                                        
                                                                                
           MOVE +4013 TO ABEND-CODE.                                            
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
                                                                               
