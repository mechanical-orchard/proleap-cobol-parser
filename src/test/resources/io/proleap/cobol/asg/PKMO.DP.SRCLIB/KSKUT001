000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             KSKUT001.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           08-27-2012.                              00080003
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       CREATE AN EXTRACT OF LOCATION INFORMATION FOR USE IN     *00120000
001210*  THE SERVICE MANAGEMENT SOLUTION.  LOCATION INFORMATION WILL   *00121000
001220*  BE DRIVEN FROM RMS SYSTEM OF RECORD EXTRACTS, PROCESSING, IN  *00122000
001230*  SEQUENCE, STORE LOCATIONS, WAREHOUSE (DC) LOCATIONS, AND      *00123000
001240*  OUTLOCS (OUTSIDE LOCATIONS, SUCH AS HEADQUARTERS).  DURING    *00124000
001250*  INITIALIZATION, REFERENCE INFORMATION WILL BE LOADED INTO     *00125000
001260*  CORE TABLES FOR LOOKUPS.  THIS INCLUDES: CURRENT DC           *00126000
001270*  ASSIGNMENTS FOR SELLING LOCATIONS, LOCATION TYPE              *00127000
001280*  DESCRIPTION, STORE FORMAT CODE DESCRIPTION, AND ATTRIBUTES    *00128000
001290*  NOT OTHERWISE MANAGED BY THE SYSTEM OF RECORD.                *00129003
001291*                                                                *00129103
001293*       LOCATION DETAILS NOT CORRECTLY DEFINED WITHIN A WINDOW   *00129304
001294*  OF LOCATION OPENING WILL GENERATE A WARNING, WHICH WILL       *00129404
001295*  ESCALATE TO AN ERROR AT STORE OPENING.  ERRORS AND WARNINGS   *00129504
001296*  SUCH AS THESE, THAT DO NOT INHIBIT THE CREATION OF THE        *00129604
001297*  EXTRACT FILE, WILL BE POSTED TO A FILE FOR EXTERNAL           *00129704
001298*  COMMUNICATION AFTER COMPLETION OF THE EXTRACT PROCESS.        *00129804
001300*                                                                *00130000
001301*       CLOSED LOCATIONS WILL BE INCLUDED IN THE EXTRACT, BUT    *00130100
001302*  NO DETECTED ERROR OR WARNING CONDITIONS WILL BE REPORTED.     *00130200
001303*  ONLY DC LOCATIONS WITHIN THE WAREHOUSE SYSTEM OF RECORD       *00130300
001304*  EXTRACT WILL BE INCLUDED IN THE EXTRACT, AND ONLY             *00130400
001305*  HEADQUARTERS AND NON-MERCHANDISE LOCATIONS WILL BE INCLUDED   *00130500
001306*  IN THE EXTRACT.  NON-MERCHANDISE LOCATIONS WILL INCLUDE       *00130600
001307*  SOME LOCATIONS THAT DO NOT REPRESENT PHYSICAL LOCATIONS, BUT  *00130700
001308*  THERE IS NO ATTRIBUTE THAT CAN BE USED TO FILTER OUT NON-     *00130800
001309*  PHYSICAL LOCATIONS.  OUTLOC ERROR AND WARNING CONDITIONS      *00130900
001310*  ARE PARTIALLY MUTED AS A RESULT.                              *00131000
001311*                                                                *00131100
001312*       BECAUSE OF AN INCONSISTENCY IN THE DEFINITION OF THE     *00131200
001313*  CORPORATE HEADQUARTERS LOCATION NUMBER BETWEEN THE SYSTEM     *00131300
001314*  OF RECORD (AS LOCATION 90), AND PAYROLL/HR (AS LOCATION       *00131400
001315*  900), A SPECIAL PAYROLL/HR IMAGE OF THE CORPORATE LOCATION    *00131500
001316*  WILL BE GENERATED, IF NOT DETECTED, FOR THE EXTRACT FILE.     *00131600
001317*  THE IMAGE OF THE CORPORATE HEADQUARTERS EXTRACT RECORD WILL   *00131700
001318*  BE RETAINED, AND ADDITIONALLY WRITTEN USING THE PAYROLL/HR    *00131800
001319*  LOCATION NUMBER.  THIS IS REQUIRED FOR CORRECT ASSOCIATION    *00131900
001320*  DURING THE SERVICE MANAGEMENT SOLUTION'S PEOPLE FEED.         *00132000
001330******************************************************************00133000
001340                                                                  00134000
001350******************************************************************00135000
001360 ENVIRONMENT DIVISION.                                            00136000
001370******************************************************************00137000
001380                                                                  00138000
001390 CONFIGURATION SECTION.                                           00139000
001400                                                                  00140000
001500 SOURCE-COMPUTER.        IBM-3090.                                00150000
001600 OBJECT-COMPUTER.        IBM-3090.                                00160000
001700                                                                  00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900                                                                  00190000
002000 FILE-CONTROL.                                                    00200000
002100                                                                  00210000
002200     SELECT STORE-LOCATION-FILE                                   00220000
002300         ASSIGN TO INP01.                                         00230000
002400                                                                  00240000
002500     SELECT WAREHOUSE-LOCATION-FILE                               00250000
002600         ASSIGN TO INP02.                                         00260000
002700                                                                  00270000
002800     SELECT OUTSIDE-LOCATION-FILE                                 00280000
002900         ASSIGN TO INP03.                                         00290000
003000                                                                  00300000
003100     SELECT DC-LOC-ASSIGNMENT-FILE                                00310000
003200         ASSIGN TO INP04.                                         00320000
003300                                                                  00330000
003400     SELECT LOCATION-TYPE-FILE                                    00340000
003500         ASSIGN TO INP05.                                         00350000
003600                                                                  00360000
003700     SELECT STORE-FORMAT-FILE                                     00370000
003800         ASSIGN TO INP06.                                         00380000
003900                                                                  00390000
004000     SELECT UNMANAGED-ATTRB-FILE                                  00400000
004100         ASSIGN TO INP07.                                         00410000
004200                                                                  00420000
004300     SELECT SERVICE-MGT-LOCATION-FILE                             00430000
004400         ASSIGN TO OUT01.                                         00440000
004500                                                                  00450000
004600     SELECT ERROR-WARNING-FILE                                    00460000
004700         ASSIGN TO OUT02.                                         00470000
004800                                                                  00480000
004900******************************************************************00490000
005000 DATA DIVISION.                                                   00500000
005100******************************************************************00510000
005200                                                                  00520000
005300 FILE SECTION.                                                    00530000
005400                                                                  00540000
005500 FD  STORE-LOCATION-FILE                                          00550000
005600     RECORDING MODE IS F                                          00560000
005700     LABEL RECORDS ARE STANDARD                                   00570000
005800     BLOCK CONTAINS 0 RECORDS                                     00580000
005900     RECORD CONTAINS 687 CHARACTERS                               00590000
006000     DATA RECORD IS SL-STORE-LOCATION-RECORD.                     00600000
006100                                                                  00610000
006200 01  SL-STORE-LOCATION-RECORD    PIC X(687).                      00620000
006300                                                                  00630000
006400 FD  WAREHOUSE-LOCATION-FILE                                      00640000
006500     RECORDING MODE IS F                                          00650000
006600     LABEL RECORDS ARE STANDARD                                   00660000
006700     BLOCK CONTAINS 0 RECORDS                                     00670000
006800     RECORD CONTAINS 192 CHARACTERS                               00680000
006900     DATA RECORD IS WL-WAREHOUSE-LOCATION-RECORD.                 00690000
007000                                                                  00700000
007100 01  WL-WAREHOUSE-LOCATION-RECORD                                 00710000
007200                                 PIC X(192).                      00720000
007300                                                                  00730000
007400 FD  OUTSIDE-LOCATION-FILE                                        00740000
007500     RECORDING MODE IS F                                          00750000
007600     LABEL RECORDS ARE STANDARD                                   00760000
007700     BLOCK CONTAINS 0 RECORDS                                     00770000
007800     RECORD CONTAINS 194 CHARACTERS                               00780000
007900     DATA RECORD IS OL-OUTSIDE-LOCATION-RECORD.                   00790000
008000                                                                  00800000
008100 01  OL-OUTSIDE-LOCATION-RECORD  PIC X(194).                      00810000
008200                                                                  00820000
008300 FD  DC-LOC-ASSIGNMENT-FILE                                       00830000
008400     RECORDING MODE IS F                                          00840000
008500     LABEL RECORDS ARE STANDARD                                   00850000
008600     BLOCK CONTAINS 0 RECORDS                                     00860000
008700     RECORD CONTAINS 30 CHARACTERS                                00870000
008800     DATA RECORD IS DL-DC-LOC-ASSIGNMENT-RECORD.                  00880000
008900                                                                  00890000
009000 01  DL-DC-LOC-ASSIGNMENT-RECORD PIC X(30).                       00900000
009100                                                                  00910000
009200 FD  LOCATION-TYPE-FILE                                           00920000
009300     RECORDING MODE IS F                                          00930000
009400     LABEL RECORDS ARE STANDARD                                   00940000
009500     BLOCK CONTAINS 0 RECORDS                                     00950000
009600     RECORD CONTAINS 34 CHARACTERS                                00960000
009700     DATA RECORD IS LT-LOCATION-TYPE-RECORD.                      00970000
009800                                                                  00980000
009900 01  LT-LOCATION-TYPE-RECORD     PIC X(34).                       00990000
010000                                                                  01000000
010100 FD  STORE-FORMAT-FILE                                            01010000
010200     RECORDING MODE IS F                                          01020000
010300     LABEL RECORDS ARE STANDARD                                   01030000
010400     BLOCK CONTAINS 0 RECORDS                                     01040000
010500     RECORD CONTAINS 35 CHARACTERS                                01050000
010600     DATA RECORD IS SF-STORE-FORMAT-RECORD.                       01060000
010700                                                                  01070000
010800 01  SF-STORE-FORMAT-RECORD      PIC X(35).                       01080000
010900                                                                  01090000
011000 FD  UNMANAGED-ATTRB-FILE                                         01100000
011100     RECORDING MODE IS F                                          01110000
011200     LABEL RECORDS ARE STANDARD                                   01120000
011300     BLOCK CONTAINS 0 RECORDS                                     01130000
011400     RECORD CONTAINS 80 CHARACTERS                                01140000
011500     DATA RECORD IS UA-UNMANAGED-ATTRB-RECORD.                    01150000
011600                                                                  01160000
011700 01  UA-UNMANAGED-ATTRB-RECORD   PIC X(80).                       01170000
011800                                                                  01180000
011900 FD  SERVICE-MGT-LOCATION-FILE                                    01190000
012000     RECORDING MODE IS F                                          01200000
012100     LABEL RECORDS ARE STANDARD                                   01210000
012200     BLOCK CONTAINS 0 RECORDS                                     01220000
012300     RECORD CONTAINS 400 CHARACTERS                               01230000
012400     DATA RECORD IS SM-SERVICE-MGT-LOCATION-RECORD.               01240000
012500                                                                  01250000
012600 01  SM-SERVICE-MGT-LOCATION-RECORD                               01260000
012610                                 PIC X(400).                      01261000
012700                                                                  01270000
012800 FD  ERROR-WARNING-FILE                                           01280000
012900     RECORDING MODE IS F                                          01290000
013000     LABEL RECORDS ARE STANDARD                                   01300000
013100     BLOCK CONTAINS 0 RECORDS                                     01310000
013200     RECORD CONTAINS 80 CHARACTERS                                01320000
013300     DATA RECORD IS EW-ERROR-WARNING-RECORD.                      01330000
013400                                                                  01340000
013500 01  EW-ERROR-WARNING-RECORD     PIC X(80).                       01350000
013600                                                                  01360000
013700 WORKING-STORAGE SECTION.                                         01370000
013800                                                                  01380000
013900*                                                                 01390000
014000*  RMS SOR EXTRACT FOR STORE/STORE_ATTRIBUTE - STORE              01400000
014100*                                                                 01410000
014200                                                                  01420000
014300     COPY HORD013.                                                01430000
014400                                                                  01440000
014500*                                                                 01450000
014600*  RMS SOR EXTRACT FOR WH/WH_ATTRIBUTES - WAREHOUSE               01460000
014700*                                                                 01470000
014800                                                                  01480000
014900     COPY HORD014.                                                01490000
015000                                                                  01500000
015100*                                                                 01510000
015200*  RMS SOR EXTRACT FOR OUTLOC - OUTSIDE LOCATION                  01520000
015300*                                                                 01530000
015400                                                                  01540000
015500     COPY HORD015.                                                01550000
015600                                                                  01560000
015700*                                                                 01570000
015800*  RMS SOR EXTRACT FOR WH_STORE_ASSIGN - DC LOCATION ASSIGNMENT   01580000
015900*                                                                 01590000
016000                                                                  01600000
016100     COPY HORD016.                                                01610000
016200                                                                  01620000
016300*                                                                 01630000
016400*  RMS SOR EXTRACT FOR RMS CODE DETAIL TABLES FOR LOCATION TYPE   01640000
016500*                                                                 01650000
016600                                                                  01660000
016700     COPY HORD021.                                                01670000
016800                                                                  01680000
016900*                                                                 01690000
017000*  RMS SOR EXTRACT FOR RMS CODE DETAIL TABLES FOR STORE FORMAT    01700000
017100*                                                                 01710000
017200                                                                  01720000
017300     COPY HORD022.                                                01730000
017400                                                                  01740000
017500*                                                                 01750000
017600*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01760000
017700*                                                                 01770000
017800                                                                  01780000
017900     COPY DPWS500.                                                01790000
018000                                                                  01800000
018600                                                                  01860000
018700 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          01870000
018800                                              COMP SYNC.          01880000
018900     88  AC-TABLE-OVERFLOW-ERROR              VALUE +4004.        01890000
019000     88  AC-FILE-SEQUENCE-ERROR               VALUE +4007.        01900000
019100     88  AC-INVLD-DATA-ON-DATASET-ERROR       VALUE +4008.        01910000
019300     88  AC-CALENDAR-ROUTINE-ERROR            VALUE +4019.        01930000
019400                                                                  01940000
019500 01  PS-PROGRAM-SWITCHES.                                         01950000
019600     05  PS-END-OF-STORE-FILE-SW PIC X(1)     VALUE 'N'.          01960000
019700         88  PS-END-OF-STORE-FILE             VALUE 'Y'.          01970000
019800     05  PS-END-OF-WAREHOUSE-FILE-SW                              01980000
019900                                 PIC X(1)     VALUE 'N'.          01990000
020000         88  PS-END-OF-WAREHOUSE-FILE         VALUE 'Y'.          02000000
020100     05  PS-END-OF-OUTSIDE-FILE-SW                                02010000
020200                                 PIC X(1)     VALUE 'N'.          02020000
020300         88  PS-END-OF-OUTSIDE-FILE           VALUE 'Y'.          02030000
020400     05  PS-END-OF-DC-LOC-FILE-SW                                 02040000
020500                                 PIC X(1)     VALUE 'N'.          02050000
020600         88  PS-END-OF-DC-LOC-FILE            VALUE 'Y'.          02060000
020700     05  PS-END-OF-LOC-TYPE-FILE-SW                               02070000
020800                                 PIC X(1)     VALUE 'N'.          02080000
020900         88  PS-END-OF-LOC-TYPE-FILE          VALUE 'Y'.          02090000
021000     05  PS-END-OF-STR-FMT-FILE-SW                                02100000
021100                                 PIC X(1)     VALUE 'N'.          02110000
021200         88  PS-END-OF-STR-FMT-FILE           VALUE 'Y'.          02120000
021300     05  PS-END-OF-UNMANAGED-FILE-SW                              02130000
021400                                 PIC X(1)     VALUE 'N'.          02140000
021500         88  PS-END-OF-UNMANAGED-FILE         VALUE 'Y'.          02150000
021600     05  PS-HR-HQ-LOC-FOUND-SW   PIC X(1)     VALUE 'N'.          02160000
021700         88  PS-HR-HQ-LOC-FOUND               VALUE 'Y'.          02170000
021800                                                                  02180000
021900 01  PC-PROGRAM-CONSTANTS.                                        02190000
022000     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'KSKUT001'.   02200000
022300     05  PC-MAXIMUM-DC-LOC-COUNT PIC S9(4)    VALUE +5000         02230000
022400                                              COMP SYNC.          02240000
022500     05  PC-MAXIMUM-LOCATION-TYPE-COUNT                           02250000
022600                                 PIC S9(4)    VALUE +100          02260000
022700                                              COMP SYNC.          02270000
022800     05  PC-MAXIMUM-STORE-FORMAT-COUNT                            02280000
022900                                 PIC S9(4)    VALUE +10           02290000
023000                                              COMP SYNC.          02300000
023100     05  PC-MAXIMUM-MISS-ATTR-LOC-COUNT                           02310000
023200                                 PIC S9(4)    VALUE +1000         02320000
023300                                              COMP SYNC.          02330000
023400     05  PC-LOC-FILE-HQ-LOC-NBR  PIC 9(4)     VALUE 90.           02340000
023500     05  PC-HR-HQ-LOC-NBR        PIC 9(4)     VALUE 900.          02350000
023600     05  PC-ERROR-COMPARE-TIMEFRAME                               02360000
023700                                 PIC S9(4)    VALUE +30           02370000
023800                                              COMP SYNC.          02380000
023900     05  PC-LOCATION-TYPES.                                       02390000
024000         10  PC-LT-DISTRIBUTION-CENTER                            02400000
024100                                 PIC X(2)     VALUE 'DC'.         02410000
024200         10  PC-LT-HEADQUARTERS  PIC X(2)     VALUE 'HQ'.         02420000
024300         10  PC-LT-NON-MERCHANDISE                                02430000
024400                                 PIC X(2)     VALUE 'ND'.         02440000
024500     05  PC-NULL-INDICATOR-VARIABLE                               02450000
024600                                 PIC S9(4)    VALUE -1            02460000
024700                                              COMP SYNC.          02470000
026200                                                                  02620000
026300 01  PV-PROGRAM-VARIABLES.                                        02630000
026400     05  PV-DC-LOC-COUNT         PIC S9(4)    VALUE ZEROS         02640000
026500                                              COMP SYNC.          02650000
026600     05  PV-HEADQUARTERS-LOCATION-IMAGE                           02660000
026700                                 PIC X(400)   VALUE SPACES.       02670000
026800     05  PV-LOCATION-TYPE-COUNT  PIC S9(4)    VALUE ZEROS         02680000
026900                                              COMP SYNC.          02690000
027000     05  PV-STORE-FORMAT-COUNT   PIC S9(4)    VALUE ZEROS         02700000
027100                                              COMP SYNC.          02710000
027200     05  PV-MISSING-ATTRB-LOC-COUNT                               02720000
027300                                 PIC S9(4)    VALUE ZEROS         02730000
027400                                              COMP SYNC.          02740000
027500     05  PV-ERROR-COMPARE-DATE   PIC X(10)    VALUE SPACES.       02750000
027600     05  PV-CURRENT-DATE         PIC X(10)    VALUE SPACES.       02760000
027700     05  FILLER                  REDEFINES PV-CURRENT-DATE.       02770000
027800         10  PV-CD-YEAR          PIC X(4).                        02780000
027900         10  FILLER              PIC X(1).                        02790000
028000             88  PV-CD-DATE-SEP-1             VALUE '-'.          02800000
028100         10  PV-CD-MONTH         PIC X(2).                        02810000
028200         10  FILLER              PIC X(1).                        02820000
028300             88  PV-CD-DATE-SEP-2             VALUE '-'.          02830000
028400         10  PV-CD-DAY           PIC X(2).                        02840000
029000                                                                  02900000
029100 01  PT-PROGRAM-TOTALS.                                           02910000
029200     05  PT-STORE-SOR-RCDS-READ  PIC S9(7)    VALUE ZEROS         02920000
029300                                              COMP-3.             02930000
029400     05  PT-WAREHOUSE-SOR-RCDS-READ                               02940000
029500                                 PIC S9(7)    VALUE ZEROS         02950000
029600                                              COMP-3.             02960000
029700     05  PT-OUTLOC-SOR-RCDS-READ                                  02970000
029800                                 PIC S9(7)    VALUE ZEROS         02980000
029900                                              COMP-3.             02990000
030000     05  PT-DC-LOC-ASG-SOR-RCDS-READ                              03000000
030100                                 PIC S9(7)    VALUE ZEROS         03010000
030200                                              COMP-3.             03020000
030300     05  PT-LOC-TYPE-SOR-RCDS-READ                                03030000
030400                                 PIC S9(7)    VALUE ZEROS         03040000
030500                                              COMP-3.             03050000
030600     05  PT-STORE-FMT-SOR-RCDS-READ                               03060000
030700                                 PIC S9(7)    VALUE ZEROS         03070000
030800                                              COMP-3.             03080000
030900     05  PT-UNMANAGD-ATTRB-RCDS-READ                              03090000
031000                                 PIC S9(7)    VALUE ZEROS         03100000
031100                                              COMP-3.             03110000
031200     05  PT-LOC-EXTRACT-RCDS-WRITTEN                              03120000
031300                                 PIC S9(7)    VALUE ZEROS         03130000
031400                                              COMP-3.             03140000
031500     05  PT-ERROR-WARN-RCDS-WRITTEN                               03150000
031600                                 PIC S9(7)    VALUE ZEROS         03160000
031700                                              COMP-3.             03170000
031800                                                                  03180000
031900 01  TD-TOTAL-DISPLAY-MESSAGE.                                    03190000
032000     05  TD-TOTAL-ID             PIC X(52)    VALUE SPACES.       03200000
032100         88  TD-STORE-SOR-RCDS-READ-ID        VALUE               03210000
032200             'STORE SYSTEM-OF-RECORD RECORDS READ . . . . . . . '.03220000
032300         88  TD-WAREHOUSE-SOR-RCDS-READ-ID    VALUE               03230000
032400             'WAREHOUSE SYSTEM-OF-RECORD RECORDS READ . . . . . '.03240000
032500         88  TD-OUTLOC-SOR-RCDS-READ-ID       VALUE               03250000
032600             'OUTSIDE LOCATION SYSTEM-OF-RECORD RECORDS READ  . '.03260000
032700         88  TD-DC-LOC-ASG-SOR-RCDS-READ-ID   VALUE               03270000
032800             'DC-LOC ASSIGNMENT SYSTEM-OF-RECORD RECORDS READ . '.03280000
032900         88  TD-LOC-TYPE-SOR-RCDS-READ-ID     VALUE               03290000
033000             'LOCATION TYPE SYSTEM-OF-RECORD RECORDS READ . . . '.03300000
033100         88  TD-STORE-FMT-SOR-RCDS-READ-ID    VALUE               03310000
033200             'STORE FORMAT SYSTEM-OF-RECORD RECORDS READ  . . . '.03320000
033300         88  TD-UNMANAGD-ATTRB-RCDS-READ-ID   VALUE               03330000
033400             'UNMANAGED ATTRIBUTE RECORDS READ  . . . . . . . . '.03340000
033500         88  TD-DC-LOC-ASSIGNMENT-LOADED-ID   VALUE               03350000
033600             'DC-LOCATION ASSIGNMENTS LOADED  . . . . . . . . . '.03360000
033700         88  TD-LOCATION-TYPES-LOADED-ID      VALUE               03370000
033800             'LOCATION TYPES LOADED . . . . . . . . . . . . . . '.03380000
033900         88  TD-STORE-FORMATS-LOADED-ID       VALUE               03390000
034000             'STORE FORMAT CODES LOADED . . . . . . . . . . . . '.03400000
034100         88  TD-MISSING-ATTRB-LOC-LOADED-ID   VALUE               03410000
034200             'UNMANAGED ATTRIBUTE LOCATIONS LOADED  . . . . . . '.03420000
034300         88  TD-LOC-EXTRACT-RCDS-WRITTEN-ID   VALUE               03430000
034400             'LOCATION EXTRACT RECORDS WRITTEN  . . . . . . . . '.03440000
034500         88  TD-ERROR-WARN-RCDS-WRITTEN-ID    VALUE               03450000
034600             'ERROR OR WARNING RECORDS WRITTEN  . . . . . . . . '.03460000
034700     05  TD-TOTAL-AMOUNT         PIC Z,ZZZ,ZZ9                    03470000
034800                                              VALUE ZEROS.        03480000
034900                                                                  03490000
035000 01  IV-INDICATOR-VARIABLES.                                      03500000
035100     05  IV-DSCVR-MERCH-NBR      PIC S9(4)    VALUE ZERO          03510000
035200                                              COMP SYNC.          03520000
035300     05  IV-BNKCRD-MERCH-NBR     PIC S9(4)    VALUE ZERO          03530000
035400                                              COMP SYNC.          03540000
035500     05  IV-AMEX-MERCH-NBR       PIC S9(4)    VALUE ZERO          03550000
035600                                              COMP SYNC.          03560000
035700                                                                  03570000
035800 01  LE-LOCATION-EXTRACT-RECORD.                                  03580000
035900     05  LE-LOC-NBR              PIC 9(4)     VALUE ZEROS.        03590000
036000     05  LE-LOC-TYP-CDE          PIC X(2)     VALUE SPACES.       03600000
036100     05  LE-LOC-NM               PIC X(40)    VALUE SPACES.       03610000
036200     05  LE-LNE-1-ADDR           PIC X(30)    VALUE SPACES.       03620000
036300     05  LE-LNE-2-ADDR           PIC X(30)    VALUE SPACES.       03630000
036400     05  LE-CITY                 PIC X(20)    VALUE SPACES.       03640000
036500     05  LE-ST-CDE               PIC X(2)     VALUE SPACES.       03650000
036600     05  LE-ZIP-10-CDE           PIC X(10)    VALUE SPACES.       03660000
036700     05  LE-PHN-NBR              PIC X(26)    VALUE SPACES.       03670000
036800     05  LE-OPN-DTE              PIC X(10)    VALUE SPACES.       03680000
036900     05  LE-CLS-DTE              PIC X(10)    VALUE SPACES.       03690000
037000     05  LE-FINCL-CLO-DTE        PIC X(10)    VALUE SPACES.       03700000
037100     05  LE-REPLT-STR-NBR        PIC 9(4)     VALUE ZEROS.        03710000
037200     05  LE-STD-TM-ZN-CDE        PIC X(3)     VALUE SPACES.       03720000
037300     05  LE-DST-IND              PIC X(1)     VALUE SPACES.       03730000
037400     05  LE-MGR-NM               PIC X(32)    VALUE SPACES.       03740000
037500     05  LE-E-BUS-IND            PIC X(1)     VALUE SPACES.       03750000
037600         88  LE-E-BUS-LOCATION                VALUE 'Y'.          03760000
037700     05  LE-STR-FMT-CDE          PIC 9(4)     VALUE ZEROS.        03770000
037800     05  LE-STR-FMT-DESC         PIC X(30)    VALUE SPACES.       03780000
037900     05  LE-DC-ASSIGNMENT-LOC-NBR                                 03790000
038000                                 PIC 9(4)     VALUE ZEROS.        03800000
038100     05  LE-LOC-TYP-DESC         PIC X(30)    VALUE SPACES.       03810000
038200     05  LE-EXTD-MALL-NM         PIC X(40)    VALUE SPACES.       03820000
038300     05  LE-GRND-OPN-DTE         PIC X(10)    VALUE SPACES.       03830000
038700     05  FILLER                  PIC X(47)    VALUE SPACES.       03870001
038800                                                                  03880000
038900 01  UA-UNMANAGED-ATTRB-RCD.                                      03890000
039000     05  UA-LOC-NBR-X            PIC X(4)     VALUE SPACES.       03900000
039100     05  UA-LOC-NBR              REDEFINES UA-LOC-NBR-X           03910000
039200                                 PIC 9(4).                        03920000
039300     05  UA-LOC-TYP-CDE          PIC X(2).                        03930000
039400     05  UA-STD-TM-ZN-CDE        PIC X(3).                        03940000
039500         88  UA-VALID-TM-ZN-CDE               VALUE 'EST', 'CST', 03950000
039600                                                    'MST', 'PST'. 03960000
039700     05  UA-DST-IND              PIC X(1).                        03970000
039800         88  UA-VALID-DST-IND                 VALUE 'Y', 'N'.     03980000
039900     05  UA-PHN-NBR              PIC X(26).                       03990000
040000     05  FILLER                  PIC X(44).                       04000000
040100                                                                  04010000
040200 01  EW-ERROR-WARNING-RCD.                                        04020000
040300     05  EW-ERROR-LEVEL          PIC X(13)    VALUE SPACES.       04030000
040400         88  EW-EL-ERROR                      VALUE               04040000
040500             '** ERROR   - '.                                     04050000
040600         88  EW-EL-WARNING                    VALUE               04060000
040700             '** WARNING - '.                                     04070000
040800     05  EW-ERROR-WARNING-DETAIL PIC X(67)    VALUE SPACES.       04080000
040900                                                                  04090000
041000 01  DL-DC-LOC-ASSIGNMENT-TABLE.                                  04100000
041100     05  DL-DC-LOC-ASSIGNMENT-ENTRY                               04110000
041200                                 OCCURS 5000 TIMES                04120000
041300                                 ASCENDING KEY DL-LOC-NBR         04130000
041400                                 INDEXED BY DL-INDEX.             04140000
041500         10  DL-LOC-NBR          PIC 9(4).                        04150000
041600             88  DL-UNUSED-ASSIGNMENT-ENTRY   VALUE 9999.         04160000
041700         10  DL-EFF-BEG-DTE      PIC X(10).                       04170000
041800         10  DL-DC-NBR           PIC 9(4).                        04180000
041900                                                                  04190000
042000 01  LT-LOCATION-TYPE-TABLE.                                      04200000
042100     05  LT-LOCATION-TYPE-ENTRY  OCCURS 100 TIMES                 04210000
042200                                 INDEXED BY LT-INDEX.             04220000
042300         10  LT-LOC-TYP-CDE      PIC X(2).                        04230000
042400         10  LT-LOC-TYP-DESC     PIC X(30).                       04240000
042500                                                                  04250000
042600 01  SF-STORE-FORMAT-TABLE.                                       04260000
042700     05  SF-STORE-FORMAT-ENTRY   OCCURS 10 TIMES                  04270000
042800                                 INDEXED BY SF-INDEX.             04280000
042900         10  SF-STR-FMT-CDE      PIC X(4).                        04290000
043000         10  SF-STR-FMT-DESC     PIC X(30).                       04300000
043100                                                                  04310000
043200 01  MA-MISSING-ATTRB-TABLE.                                      04320000
043300     05  MA-MISSING-ATTRB-ENTRY  OCCURS 1000 TIMES                04330000
043400                                 ASCENDING KEY MA-LOC-NBR         04340000
043500                                 INDEXED BY MA-INDEX.             04350000
043600         10  MA-LOC-NBR          PIC 9(4).                        04360000
043700             88  MA-UNUSED-LOC-ENTRY          VALUE 9999.         04370000
043800         10  MA-LOC-TYP-CDE      PIC X(2).                        04380000
043900         10  MA-STD-TM-ZN-CDE    PIC X(3).                        04390000
044000         10  MA-DST-IND          PIC X(1).                        04400000
044100         10  MA-PHN-NBR          PIC X(26).                       04410000
044200                                                                  04420000
046100******************************************************************04610000
046200 PROCEDURE DIVISION.                                              04620000
046300******************************************************************04630000
046400                                                                  04640000
046500 0000-MAINLINE.                                                   04650000
046600                                                                  04660000
046700     PERFORM 1000-INITIALIZE.                                     04670000
046800                                                                  04680000
046900     PERFORM 2000-PROCESS-STORE-LOCATION                          04690000
047000         UNTIL PS-END-OF-STORE-FILE.                              04700000
047100                                                                  04710000
047200     PERFORM                                                      04720000
047300             UNTIL (PS-END-OF-WAREHOUSE-FILE)                     04730000
047400         IF (HO014-WH-TYP-CDE = PC-LT-DISTRIBUTION-CENTER)        04740000
047500             PERFORM 3000-PROCESS-WAREHSE-LOCATION                04750000
047600         END-IF                                                   04760000
047700         PERFORM 7100-READ-WAREHOUSE-FILE                         04770000
047800     END-PERFORM.                                                 04780000
047900                                                                  04790000
048000     PERFORM                                                      04800000
048100             UNTIL (PS-END-OF-OUTSIDE-FILE)                       04810000
048200         IF ((HO015-OTLC-TYPE = PC-LT-HEADQUARTERS)               04820000
048300                 OR (HO015-OTLC-TYPE = PC-LT-NON-MERCHANDISE))    04830000
048400             PERFORM 4000-PROCESS-OUTSIDE-LOCATION                04840000
048500         END-IF                                                   04850000
048600         PERFORM 7200-READ-OUTSIDE-FILE                           04860000
048700     END-PERFORM.                                                 04870000
048800                                                                  04880000
048900*                                                                 04890000
049000*  IF THE PAYROLL/HR CORPORATE HEADQUARTERS LOCATION NUMBER WAS   04900000
049100*  NOT DETECTED DURING THE EXTRACT PROCESS, BUILD ONE (FOR        04910000
049200*  USE IN ASSOCIATING WITH PEOPLE INFORMATION) USING THE          04920000
049300*  INFORMATION EXTRACTED FOR THE SYSTEM OF RECORD CORPORATE       04930000
049400*  HEADQUARTER LOCATION NUMBER.                                   04940000
049410*                                                                 04941000
049420                                                                  04942000
049430     IF (NOT PS-HR-HQ-LOC-FOUND)                                  04943000
049440         MOVE PV-HEADQUARTERS-LOCATION-IMAGE TO                   04944000
049450                   LE-LOCATION-EXTRACT-RECORD                     04945000
049460         MOVE PC-HR-HQ-LOC-NBR TO LE-LOC-NBR                      04946000
049470         PERFORM 8000-WRITE-LOCATION-RECORD                       04947000
049480         DISPLAY ' '                                              04948000
049490         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - HR HQ LOCATION '    04949000
049500                   PC-HR-HQ-LOC-NBR  ' NOT FOUND'                 04950000
049600         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXTRACT RECORD '    04960000
049700                   'CREATED USING INFORMATION FOR STANDARD '      04970000
049800                   'HQ LOCATION '  PC-LOC-FILE-HQ-LOC-NBR         04980000
049900     END-IF.                                                      04990000
050000                                                                  05000000
050100     PERFORM 1500-DISPLAY-PROGRAM-TOTALS.                         05010000
050200                                                                  05020000
050300     PERFORM 9000-EOJ-ROUTINE.                                    05030000
050400                                                                  05040000
050500     GOBACK.                                                      05050000
050600                                                                  05060000
050700******************************************************************05070000
050800*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES.  ACQUIRE  *05080000
050900*  THE SYSTEM DATE AND COMPUTE THE ERROR VS. WARNING EVENT       *05090000
051000*  DATE.  LOAD CORE TABLES FOR CURRENT DC-LOCATION ASSIGNMENT,   *05100000
051100*  LOCATION TYPE DESCRIPTION, STORE FORMAT DESCRIPTION, AND      *05110000
051200*  ALL REQUIRED LOCATION ATTRIBUTES NOT PRESENTLY MANAGED BY THE *05120000
051300*  SYSTEM OF RECORD OR ANY DOMAIN IMAGE OF THE DATA.  EXECUTE A  *05130000
051400*  PRIMING READ OF THE THREE SYSTEM OF RECORD EXTRACTS FOR THE   *05140000
051500*  LOCATION TYPE AGGREGATIONS (STORE, WAREHOUSE/DC, OUTSIDE      *05150000
051600*  LOCATION).                                                    *05160000
051700******************************************************************05170000
051800                                                                  05180000
051900 1000-INITIALIZE.                                                 05190000
052000     OPEN INPUT  STORE-LOCATION-FILE                              05200000
052100                 WAREHOUSE-LOCATION-FILE                          05210000
052200                 OUTSIDE-LOCATION-FILE                            05220000
052300                 DC-LOC-ASSIGNMENT-FILE                           05230000
052400                 LOCATION-TYPE-FILE                               05240000
052500                 STORE-FORMAT-FILE                                05250000
052600                 UNMANAGED-ATTRB-FILE                             05260000
052700          OUTPUT SERVICE-MGT-LOCATION-FILE                        05270000
052800                 ERROR-WARNING-FILE.                              05280000
052900                                                                  05290000
053000     MOVE FUNCTION CURRENT-DATE (1:4) TO PV-CD-YEAR.              05300000
053100     SET PV-CD-DATE-SEP-1 TO TRUE.                                05310000
053200     MOVE FUNCTION CURRENT-DATE (5:2) TO PV-CD-MONTH.             05320000
053300     SET PV-CD-DATE-SEP-2 TO TRUE.                                05330000
053400     MOVE FUNCTION CURRENT-DATE (7:2) TO PV-CD-DAY.               05340000
053500                                                                  05350000
053600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05360000
053700     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      05370000
053800     SET DPG51-DECREMENT-DATE TO TRUE.                            05380000
053900     MOVE PC-ERROR-COMPARE-TIMEFRAME TO DPG51-INCR-DECR-DAYS-9.   05390000
054000     SET DPG52-LK-DTE-ISO TO TRUE.                                05400000
054100     MOVE FUNCTION CURRENT-DATE (1:8) TO DPG52-DB2-ISO-DATE.      05410000
054200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                05420000
054300                                             DPG52                05430000
054400                                             DPG53                05440000
054500                                             DPG54                05450000
054600                                             DPG55                05460000
054700                                             DPG56.               05470000
054800     IF DPG54-NO-ERROR                                            05480000
054900         MOVE DPG55-DB2-ISO-DATE-FMT TO PV-ERROR-COMPARE-DATE     05490000
055000         DISPLAY PC-CURRENT-PROGRAM-NAME ' - COMPARISION DATE '   05500000
055100                   'RELATIVE TO OPEN DATE FOR POSTING MISSING '   05510000
055200                   'ATTRIBUTE WARNING MESSAGES IS '               05520000
055300                   PV-ERROR-COMPARE-DATE                          05530000
055400     ELSE                                                         05540000
055500         DISPLAY '** ABEND **'                                    05550000
055600         DISPLAY PC-CURRENT-PROGRAM-NAME ' - CALENDAR ROUTINE '   05560000
055700                   'ERROR WHEN COMPUTING COMPARISON DATE '        05570000
055800                   'RELATIVE TO OPEN DATE FOR POSTING WARNING '   05580000
055900                   'MESSAGES'                                     05590000
056000         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ERROR MESSAGE = '    05600000
056100                   DPG54-ERROR-MESSAGE                            05610000
056200         SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                    05620000
056300         CALL 'ILBOABN0' USING ABEND-CODE                         05630000
056400     END-IF.                                                      05640000
056500                                                                  05650000
056600     PERFORM 1100-LOAD-DC-LOC-ASSIGNMENT.                         05660000
056700                                                                  05670000
056800     PERFORM 1200-LOAD-LOCATION-TYPE.                             05680000
056900                                                                  05690000
057000     PERFORM 1300-LOAD-STORE-FORMAT.                              05700000
057100                                                                  05710000
057200     PERFORM 1400-LOAD-UNMANAGED-ATTRB.                           05720000
057300                                                                  05730000
057400     PERFORM 7000-READ-STORE-FILE.                                05740000
057500                                                                  05750000
057600     PERFORM 7100-READ-WAREHOUSE-FILE.                            05760000
057700                                                                  05770000
057800     PERFORM 7200-READ-OUTSIDE-FILE.                              05780000
057900*1000-EXIT.                                                       05790000
058000                                                                  05800000
058100******************************************************************05810000
058200*  LOAD A CORE TABLE WITH THE CURRENT LOCATION TO DC ASSIGNMENTS.*05820000
058300*  THE TABLE MUST BE LOADED WITH AN ASCENDING LOCATION KEY       *05830000
058400*  TO ENABLE BINARY SEARCHES.  FOR EACH LOCATION, INCREMENT THE  *05840000
058500*  TABLE ENTRY COUNT AND LOAD THE ASSIGNMENT DETAILS AS A NEW    *05850000
058600*  LOCATION IS ENCOUNTERED.  READ THROUGH THE FILE TO EVALUATE   *05860000
058700*  ADDITIONAL ROWS, AND OVERLAY THE DETAILS IF A MORE RECENTLY   *05870000
058800*  EFFECTIVE CHANGE IS FOUND.  IF THE LOCATIONS ARE NOT FOUND    *05880000
058900*  TO BE IN ASCENDING SEQUENCE, ABEND THE PROCESS.  IF A TABLE   *05890000
058910*  OVERFLOW IS DETECTED, ABEND THE PROCESS.  AFTER ALL LOCATIONS *05891000
058920*  ARE LOADED, LOAD A HIGH VALUE LOCATION NUMBER TO ALL UNUSED   *05892000
058930*  ENTRIES IN THE TABLE, TO ENABLE A PROPER BINARY SEARCH.       *05893000
058940******************************************************************05894000
058950                                                                  05895000
058960 1100-LOAD-DC-LOC-ASSIGNMENT.                                     05896000
058970     INITIALIZE DL-DC-LOC-ASSIGNMENT-TABLE.                       05897000
058980                                                                  05898000
058990     INITIALIZE PV-DC-LOC-COUNT.                                  05899000
059000     PERFORM 7300-READ-DC-LOC-ASSIGN-FILE.                        05900000
059100                                                                  05910000
059200     PERFORM                                                      05920000
059300             VARYING DL-INDEX                                     05930000
059400             FROM 1 BY 1                                          05940000
059500             UNTIL ((DL-INDEX > PC-MAXIMUM-DC-LOC-COUNT)          05950000
059600                     OR (PS-END-OF-DC-LOC-FILE))                  05960000
059700         ADD +1 TO PV-DC-LOC-COUNT                                05970000
059800         MOVE HO016-DCLOC-LOC-NBR TO DL-LOC-NBR (DL-INDEX)        05980000
059900         MOVE HO016-DCLOC-EFF-BEG-DTE TO DL-EFF-BEG-DTE (DL-INDEX)05990000
060000         MOVE HO016-DCLOC-DC-NBR TO DL-DC-NBR (DL-INDEX)          06000000
060100         PERFORM 7300-READ-DC-LOC-ASSIGN-FILE                     06010000
060200         PERFORM                                                  06020000
060300                 UNTIL ((PS-END-OF-DC-LOC-FILE)                   06030000
060400                         OR (HO016-DCLOC-LOC-NBR NOT =            06040000
060500                                          DL-LOC-NBR (DL-INDEX))) 06050000
060600             IF (HO016-DCLOC-EFF-BEG-DTE >                        06060000
060700                                        DL-EFF-BEG-DTE (DL-INDEX))06070000
060800                 MOVE HO016-DCLOC-EFF-BEG-DTE TO                  06080000
060900                           DL-EFF-BEG-DTE (DL-INDEX)              06090000
061000                 MOVE HO016-DCLOC-DC-NBR TO DL-DC-NBR (DL-INDEX)  06100000
061100             END-IF                                               06110000
061200             PERFORM 7300-READ-DC-LOC-ASSIGN-FILE                 06120000
061300         END-PERFORM                                              06130000
061400         IF ((NOT PS-END-OF-DC-LOC-FILE)                          06140000
061500                 AND (HO016-DCLOC-LOC-NBR <                       06150000
061600                                          DL-LOC-NBR (DL-INDEX))) 06160000
061700             DISPLAY '** ABEND **'                                06170000
061800             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - DC TO LOCATION '06180000
061900                       'ASSIGNMENT FILE NOT IN ASCENDING '        06190000
062000                       'LOCATION SEQUENCE'                        06200000
062100             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  06210000
062200                       'BETWEEN RECORDS FOR LOCATION '            06220000
062300                       DL-LOC-NBR (DL-INDEX)  ' AND '             06230000
062400                       HO016-DCLOC-LOC-NBR                        06240000
062500             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   06250000
062600             CALL 'ILBOABN0' USING ABEND-CODE                     06260000
062700         END-IF                                                   06270000
062800     END-PERFORM.                                                 06280000
062900                                                                  06290000
063000     IF ((DL-INDEX > PC-MAXIMUM-DC-LOC-COUNT)                     06300000
063100             AND (NOT PS-END-OF-DC-LOC-FILE))                     06310000
063200         DISPLAY '** ABEND **'                                    06320000
063300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 06330000
063400                   'UNIQUE LOCATIONS IN DC TO LOCATION '          06340000
063500                   'ASSIGNMENT EXCEEDED'                          06350000
063600         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  06360000
063700                   'AND RERUN'                                    06370000
063800         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      06380000
063900         CALL 'ILBOABN0' USING ABEND-CODE                         06390000
064000     END-IF.                                                      06400000
064100                                                                  06410000
064200     SET DL-INDEX TO PV-DC-LOC-COUNT.                             06420000
064300     SET DL-INDEX UP BY 1.                                        06430000
064400     PERFORM                                                      06440000
064500             UNTIL (DL-INDEX > PC-MAXIMUM-DC-LOC-COUNT)           06450000
064600         SET DL-UNUSED-ASSIGNMENT-ENTRY (DL-INDEX) TO TRUE        06460000
064700         SET DL-INDEX UP BY 1                                     06470000
064800     END-PERFORM.                                                 06480000
064900*1100-EXIT.                                                       06490000
065000                                                                  06500000
065100******************************************************************06510000
065200*  LOAD A CORE TABLE WITH THE LOCATION TYPE CODE TO DESCRIPTION  *06520000
065300*  ASSOCIATION.  THE TABLE WILL BE USED IN SERIAL SEARCHES.      *06530000
065400*  BEFORE LOADING EACH RECORD, TEST TO SEE IF THE SYSTEM OF      *06540000
065500*  RECORD EXTRACT FILE WITH THE ASSOCIATION IS USING POSITIONS   *06550000
065600*  OF THE TYPE CODE FIELD NOT ALLOWED BY THE INTERFACING         *06560000
065700*  SYSTEMS, WHICH WILL LEAD TO UNPREDICTABLE RESULTS.  IF A      *06570000
065800*  TABLE OVERFLOW IS DETECTED, ABEND THE PROCESS.                *06580000
065900******************************************************************06590000
066000                                                                  06600000
066100 1200-LOAD-LOCATION-TYPE.                                         06610000
066200     INITIALIZE LT-LOCATION-TYPE-TABLE                            06620000
066300                PV-LOCATION-TYPE-COUNT.                           06630000
066400                                                                  06640000
066500     PERFORM 7400-READ-LOCATION-TYPE-FILE.                        06650000
066600                                                                  06660000
066700     PERFORM                                                      06670000
066800             VARYING LT-INDEX                                     06680000
066900             FROM 1 BY 1                                          06690000
067000             UNTIL ((LT-INDEX > PC-MAXIMUM-LOCATION-TYPE-COUNT)   06700000
067100                     OR (PS-END-OF-LOC-TYPE-FILE))                06710000
067200         IF (HO021-LOC-TYP-CDE (3:2) NOT = SPACES)                06720000
067300             INITIALIZE EW-ERROR-WARNING-DETAIL                   06730000
067400             SET EW-EL-ERROR TO TRUE                              06740000
067500             STRING 'LOCATION TYPE '             DELIMITED BY SIZE06750000
067600                    HO021-LOC-TYP-CDE            DELIMITED BY SIZE06760000
067700                    ' USES MORE THAN POSITIONS 1-2'               06770000
067800                                                 DELIMITED BY SIZE06780000
067900                 INTO EW-ERROR-WARNING-DETAIL                     06790000
068000             PERFORM 8100-WRITE-ERROR-WARN-RECORD                 06800000
068100         END-IF                                                   06810000
068200         ADD +1 TO PV-LOCATION-TYPE-COUNT                         06820000
068300         MOVE HO021-LOC-TYP-CDE (1:2) TO                          06830000
068400                   LT-LOC-TYP-CDE (LT-INDEX)                      06840000
068500         MOVE HO021-LOC-TYP-DESC TO                               06850000
068600                   LT-LOC-TYP-DESC (LT-INDEX)                     06860000
068700         PERFORM 7400-READ-LOCATION-TYPE-FILE                     06870000
068800     END-PERFORM.                                                 06880000
068900                                                                  06890000
069000     IF ((LT-INDEX > PC-MAXIMUM-LOCATION-TYPE-COUNT)              06900000
069100             AND (NOT PS-END-OF-LOC-TYPE-FILE))                   06910000
069200         DISPLAY '** ABEND **'                                    06920000
069300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 06930000
069400                   'LOCATION TYPE RECORDS EXCEEDED'               06940000
069500         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  06950000
069600                   'AND RERUN'                                    06960000
069700         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      06970000
069800         CALL 'ILBOABN0' USING ABEND-CODE                         06980000
069900     END-IF.                                                      06990000
070000*1200-EXIT.                                                       07000000
070100                                                                  07010000
070200******************************************************************07020000
070210*  LOAD A CORE TABLE WITH THE STORE FORMAT CODE TO DESCRIPTION   *07021000
070220*  ASSOCIATION.  THE TABLE WILL BE USED IN SERIAL SEARCHES.      *07022000
070230*  IF A TABLE OVERFLOW IS DETECTED, ABEND THE PROCESS.           *07023000
070240******************************************************************07024000
070250                                                                  07025000
070260 1300-LOAD-STORE-FORMAT.                                          07026000
070270     INITIALIZE SF-STORE-FORMAT-TABLE                             07027000
070280                PV-STORE-FORMAT-COUNT.                            07028000
070290                                                                  07029000
070300     PERFORM 7400-READ-STORE-FORMAT-FILE.                         07030000
070400                                                                  07040000
070500     PERFORM                                                      07050000
070600             VARYING SF-INDEX                                     07060000
070700             FROM 1 BY 1                                          07070000
070800             UNTIL ((SF-INDEX > PC-MAXIMUM-STORE-FORMAT-COUNT)    07080000
070900                     OR (PS-END-OF-STR-FMT-FILE))                 07090000
071000         ADD +1 TO PV-STORE-FORMAT-COUNT                          07100000
071100         MOVE HO022-STR-FMT-CDE TO                                07110000
071200                   SF-STR-FMT-CDE (SF-INDEX)                      07120000
071300         MOVE HO022-STR-FMT-DESC TO                               07130000
071400                   SF-STR-FMT-DESC (SF-INDEX)                     07140000
071500         PERFORM 7400-READ-STORE-FORMAT-FILE                      07150000
071600     END-PERFORM.                                                 07160000
071700                                                                  07170000
071800     IF ((SF-INDEX > PC-MAXIMUM-STORE-FORMAT-COUNT)               07180000
071900             AND (NOT PS-END-OF-STR-FMT-FILE))                    07190000
072000         DISPLAY '** ABEND **'                                    07200000
072100         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 07210000
072200                   'STORE FORMAT RECORDS EXCEEDED'                07220000
072300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  07230000
072400                   'AND RERUN'                                    07240000
072500         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      07250000
072600         CALL 'ILBOABN0' USING ABEND-CODE                         07260000
072700     END-IF.                                                      07270000
072800*1300-EXIT.                                                       07280000
072900                                                                  07290000
073000******************************************************************07300000
073100*  LOAD A CORE TABLE WITH THE CURRENT LOCATION TO UNMANAGED      *07310000
073200*  ATTRIBUTE DETAILS.  THE TABLE MUST BE LOADED WITH AN          *07320000
073300*  ASCENDING LOCATION KEY TO ENABLE BINARY SEARCHES.  FOR EACH   *07330000
073400*  LOCATION, EVALUATE, BASED ON THE LOCATION TYPE, IS THE        *07340000
073500*  RECORD CONTAINS THE CORRECT DETAIL THAT REPRESENTS THE        *07350000
073600*  ATTRIBUTES THAT ARE NOT BEING MANAGED BY THE SYSTEM OF RECORD.*07360000
073700*  IF ANY ERRORS ARE DETECTED, ABEND THE PROCESS TO REQUIRE      *07370000
073800*  IMMEDIATE INFORMATION CORRECTION.  INCREMENT THE TABLE ENTRY  *07380000
073810*  COUNT AND LOAD THE ATTRIBUTE DETAILS FOR EACH VALID RECORD.   *07381000
073820*  IF THE LOCATIONS ARE NOT FOUND TO BE IN ASCENDING SEQUENCE,   *07382000
073830*  ABEND THE PROCESS.  IF A TABLE OVERFLOW IS DETECTED, ABEND    *07383000
073840*  THE PROCESS.  AFTER ALL LOCATIONS ARE LOADED, LOAD A HIGH     *07384000
073850*  VALUE LOCATION NUMBER TO ALL UNUSED ENTRIES IN THE TABLE, TO  *07385000
073860*  ENABLE A PROPER BINARY SEARCH.                                *07386000
073870******************************************************************07387000
073880                                                                  07388000
073890 1400-LOAD-UNMANAGED-ATTRB.                                       07389000
073900     INITIALIZE MA-MISSING-ATTRB-TABLE.                           07390000
074000                                                                  07400000
074100     INITIALIZE PV-MISSING-ATTRB-LOC-COUNT.                       07410000
074200     PERFORM 7500-READ-UNMANAGED-ATTRB-FILE.                      07420000
074300                                                                  07430000
074400     PERFORM                                                      07440000
074500             VARYING MA-INDEX                                     07450000
074600             FROM 1 BY 1                                          07460000
074700             UNTIL ((MA-INDEX > PC-MAXIMUM-MISS-ATTR-LOC-COUNT)   07470000
074800                     OR (PS-END-OF-UNMANAGED-FILE))               07480000
074900         EVALUATE TRUE                                            07490000
075000             WHEN (UA-LOC-TYP-CDE = PC-LT-DISTRIBUTION-CENTER)    07500000
075100                 IF (NOT UA-VALID-TM-ZN-CDE)                      07510000
075200                     DISPLAY '** ABEND **'                        07520000
075300                     DISPLAY PC-CURRENT-PROGRAM-NAME ' - '        07530000
075400                           'LOCATION '  UA-LOC-NBR  ' DOES NOT '  07540000
075500                           'HAVE A VALID TIME ZONE CODE - "'      07550000
075600                           UA-STD-TM-ZN-CDE  '" SPECIFIED'        07560000
075700                     SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE   07570000
075800                     CALL 'ILBOABN0' USING ABEND-CODE             07580000
075900                 END-IF                                           07590000
076000                 IF (UA-DST-IND NOT = SPACES)                     07600000
076100                     DISPLAY '** ABEND **'                        07610000
076200                     DISPLAY PC-CURRENT-PROGRAM-NAME ' - '        07620000
076300                           'LOCATION '  UA-LOC-NBR  ' CANNOT '    07630000
076400                           'SPECIFY A DST IND - IT IS MANAGED '   07640000
076500                           'FOR LOCATION TYPE '  UA-LOC-TYP-CDE   07650000
076600                     SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE   07660000
076700                     CALL 'ILBOABN0' USING ABEND-CODE             07670000
076800                 END-IF                                           07680000
076900                 IF (UA-PHN-NBR = SPACES)                         07690000
077000                     DISPLAY '** ABEND **'                        07700000
077100                     DISPLAY PC-CURRENT-PROGRAM-NAME ' - '        07710000
077200                           'LOCATION '  UA-LOC-NBR  ' DOES NOT '  07720000
077300                           'HAVE A PHONE NUMBER SPECIFIED - IT '  07730000
077400                           'IS REQUIRED FOR THIS LOCATION TYPE'   07740000
077500                     SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE   07750000
077600                     CALL 'ILBOABN0' USING ABEND-CODE             07760000
077700                 END-IF                                           07770000
077800             WHEN (UA-LOC-TYP-CDE = PC-LT-HEADQUARTERS)           07780000
077900             WHEN (UA-LOC-TYP-CDE = PC-LT-NON-MERCHANDISE)        07790000
078000                 IF (NOT UA-VALID-TM-ZN-CDE)                      07800000
078100                     DISPLAY '** ABEND **'                        07810000
078200                     DISPLAY PC-CURRENT-PROGRAM-NAME ' - '        07820000
078300                           'LOCATION '  UA-LOC-NBR  ' DOES NOT '  07830000
078400                           'HAVE A VALID TIME ZONE CODE - "'      07840000
078500                           UA-STD-TM-ZN-CDE  '" SPECIFIED'        07850000
078600                     SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE   07860000
078700                     CALL 'ILBOABN0' USING ABEND-CODE             07870000
078800                 END-IF                                           07880000
078900                 IF (NOT UA-VALID-DST-IND)                        07890000
079000                     DISPLAY '** ABEND **'                        07900000
079100                     DISPLAY PC-CURRENT-PROGRAM-NAME ' - '        07910000
079200                           'LOCATION '  UA-LOC-NBR  ' DOES NOT '  07920000
079300                           'HAVE A VALID DAYLIGHT SAVINGS IND - "'07930000
079400                           UA-DST-IND  '" SPECIFIED'              07940000
079500                     SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE   07950000
079600                     CALL 'ILBOABN0' USING ABEND-CODE             07960000
079700                 END-IF                                           07970000
079800                 IF (UA-PHN-NBR NOT = SPACES)                     07980000
079900                     DISPLAY '** ABEND **'                        07990000
080000                     DISPLAY PC-CURRENT-PROGRAM-NAME ' - '        08000000
080100                           'LOCATION '  UA-LOC-NBR  ' CANNOT '    08010000
080200                           'SPECIFY A PHONE NBR - IT IS MANAGED ' 08020000
080300                           'FOR LOCATION TYPE '  UA-LOC-TYP-CDE   08030000
080400                     SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE   08040000
080500                     CALL 'ILBOABN0' USING ABEND-CODE             08050000
080600                 END-IF                                           08060000
080700             WHEN OTHER                                           08070000
080800                 DISPLAY '** ABEND **'                            08080000
080900                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - LOCATION '  08090000
081000                           'TYPE '  UA-LOC-TYP-CDE  ' SHOULD '    08100000
081100                           'NOT HAVE UNMANAGED ATTRIBUTES'        08110000
081200                 SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE       08120000
081300                 CALL 'ILBOABN0' USING ABEND-CODE                 08130000
081400         END-EVALUATE                                             08140000
081500         ADD +1 TO PV-MISSING-ATTRB-LOC-COUNT                     08150000
081600         MOVE UA-LOC-NBR TO MA-LOC-NBR (MA-INDEX)                 08160000
081700         MOVE UA-LOC-TYP-CDE TO MA-LOC-TYP-CDE (MA-INDEX)         08170000
081800         MOVE UA-STD-TM-ZN-CDE TO MA-STD-TM-ZN-CDE (MA-INDEX)     08180000
081900         MOVE UA-DST-IND TO MA-DST-IND (MA-INDEX)                 08190000
082000         MOVE UA-PHN-NBR TO MA-PHN-NBR (MA-INDEX)                 08200000
082100         PERFORM 7500-READ-UNMANAGED-ATTRB-FILE                   08210000
082200         IF ((NOT PS-END-OF-UNMANAGED-FILE)                       08220000
082300                 AND (UA-LOC-NBR < MA-LOC-NBR (MA-INDEX)))        08230000
082400             DISPLAY '** ABEND **'                                08240000
082500             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - UNMANAGED '     08250000
082600                       'ATTRIBUTES BY LOCATION FILE NOT IN '      08260000
082700                       'ASCENDING LOCATION SEQUENCE'              08270000
082800             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  08280000
082900                       'BETWEEN RECORDS FOR LOCATION '            08290000
083000                       MA-LOC-NBR (MA-INDEX)  ' AND '             08300000
083100                       UA-LOC-NBR                                 08310000
083200             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   08320000
083300             CALL 'ILBOABN0' USING ABEND-CODE                     08330000
083400         END-IF                                                   08340000
083500     END-PERFORM.                                                 08350000
083600                                                                  08360000
083700     IF ((MA-INDEX > PC-MAXIMUM-MISS-ATTR-LOC-COUNT)              08370000
083800             AND (NOT PS-END-OF-UNMANAGED-FILE))                  08380000
083900         DISPLAY '** ABEND **'                                    08390000
084000         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 08400000
084100                   'LOCATIONS FOR UNMANAGED ATTRIBUTES '          08410000
084200                   'EXCEEDED'                                     08420000
084300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  08430000
084400                   'AND RERUN'                                    08440000
084500         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      08450000
084600         CALL 'ILBOABN0' USING ABEND-CODE                         08460000
084700     END-IF.                                                      08470000
084800                                                                  08480000
084900     SET MA-INDEX TO PV-MISSING-ATTRB-LOC-COUNT.                  08490000
085000     SET MA-INDEX UP BY 1.                                        08500000
085100     PERFORM                                                      08510000
085200             UNTIL (MA-INDEX > PC-MAXIMUM-MISS-ATTR-LOC-COUNT)    08520000
085300         SET MA-UNUSED-LOC-ENTRY (MA-INDEX) TO TRUE               08530000
085400         SET MA-INDEX UP BY 1                                     08540000
085500     END-PERFORM.                                                 08550000
085600*1400-EXIT.                                                       08560000
085700                                                                  08570000
085800******************************************************************08580000
085900*  DISPLAY SUMMARY TOTALS OF I/O ACTIVITY.                       *08590000
086000******************************************************************08600000
086100                                                                  08610000
086200 1500-DISPLAY-PROGRAM-TOTALS.                                     08620000
086300     DISPLAY ' '.                                                 08630000
086400                                                                  08640000
086500     SET TD-STORE-SOR-RCDS-READ-ID TO TRUE.                       08650000
086600     MOVE PT-STORE-SOR-RCDS-READ TO TD-TOTAL-AMOUNT.              08660000
086700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08670000
086800               TD-TOTAL-DISPLAY-MESSAGE.                          08680000
086900                                                                  08690000
087000     SET TD-WAREHOUSE-SOR-RCDS-READ-ID TO TRUE.                   08700000
087100     MOVE PT-WAREHOUSE-SOR-RCDS-READ TO TD-TOTAL-AMOUNT.          08710000
087200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08720000
087300               TD-TOTAL-DISPLAY-MESSAGE.                          08730000
087400                                                                  08740000
087500     SET TD-OUTLOC-SOR-RCDS-READ-ID TO TRUE.                      08750000
087600     MOVE PT-OUTLOC-SOR-RCDS-READ TO TD-TOTAL-AMOUNT.             08760000
087700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08770000
087800               TD-TOTAL-DISPLAY-MESSAGE.                          08780000
087900                                                                  08790000
088000     SET TD-DC-LOC-ASG-SOR-RCDS-READ-ID TO TRUE.                  08800000
088100     MOVE PT-DC-LOC-ASG-SOR-RCDS-READ TO TD-TOTAL-AMOUNT.         08810000
088200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08820000
088300               TD-TOTAL-DISPLAY-MESSAGE.                          08830000
088400                                                                  08840000
088500     SET TD-LOC-TYPE-SOR-RCDS-READ-ID TO TRUE.                    08850000
088600     MOVE PT-LOC-TYPE-SOR-RCDS-READ TO TD-TOTAL-AMOUNT.           08860000
088700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08870000
088800               TD-TOTAL-DISPLAY-MESSAGE.                          08880000
088900                                                                  08890000
089000     SET TD-STORE-FMT-SOR-RCDS-READ-ID TO TRUE.                   08900000
089100     MOVE PT-STORE-FMT-SOR-RCDS-READ TO TD-TOTAL-AMOUNT.          08910000
089200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08920000
089300               TD-TOTAL-DISPLAY-MESSAGE.                          08930000
089400                                                                  08940000
089500     SET TD-UNMANAGD-ATTRB-RCDS-READ-ID TO TRUE.                  08950000
089600     MOVE PT-UNMANAGD-ATTRB-RCDS-READ TO TD-TOTAL-AMOUNT.         08960000
089700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       08970000
089800               TD-TOTAL-DISPLAY-MESSAGE.                          08980000
089900                                                                  08990000
090000     DISPLAY ' '.                                                 09000000
090100                                                                  09010000
090200     SET TD-DC-LOC-ASSIGNMENT-LOADED-ID TO TRUE.                  09020000
090300     MOVE PV-DC-LOC-COUNT TO TD-TOTAL-AMOUNT.                     09030000
090400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09040000
090500               TD-TOTAL-DISPLAY-MESSAGE.                          09050000
090600                                                                  09060000
090700     SET TD-LOCATION-TYPES-LOADED-ID TO TRUE.                     09070000
090800     MOVE PV-LOCATION-TYPE-COUNT TO TD-TOTAL-AMOUNT.              09080000
090900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09090000
091000               TD-TOTAL-DISPLAY-MESSAGE.                          09100000
091100                                                                  09110000
091200     SET TD-STORE-FORMATS-LOADED-ID TO TRUE.                      09120000
091300     MOVE PV-STORE-FORMAT-COUNT TO TD-TOTAL-AMOUNT.               09130000
091400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09140000
091500               TD-TOTAL-DISPLAY-MESSAGE.                          09150000
091600                                                                  09160000
091700     SET TD-MISSING-ATTRB-LOC-LOADED-ID TO TRUE.                  09170000
091800     MOVE PV-MISSING-ATTRB-LOC-COUNT TO TD-TOTAL-AMOUNT.          09180000
091900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09190000
092000               TD-TOTAL-DISPLAY-MESSAGE.                          09200000
092100                                                                  09210000
092200     DISPLAY ' '.                                                 09220000
092300                                                                  09230000
092400     SET TD-LOC-EXTRACT-RCDS-WRITTEN-ID TO TRUE.                  09240000
092500     MOVE PT-LOC-EXTRACT-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.         09250000
092600     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09260000
092700               TD-TOTAL-DISPLAY-MESSAGE.                          09270000
092800                                                                  09280000
092900     SET TD-ERROR-WARN-RCDS-WRITTEN-ID TO TRUE.                   09290000
093000     MOVE PT-ERROR-WARN-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.          09300000
093100     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       09310000
093200               TD-TOTAL-DISPLAY-MESSAGE.                          09320000
093300*1500-EXIT.                                                       09330000
093400                                                                  09340000
093500******************************************************************09350000
093600*  CREATE A SERVICE MGMT EXTRACT FOR EACH STORE LOCATION FROM THE*09360000
093700*  STORE SYSTEM OF RECORD EXTRACT.  FOR THE STORE FORMAT CODE,   *09370000
093800*  LOOK UP THE DESCRIPTION IN THE CORE TABLE, AND LOG ANY ERROR  *09380000
093900*  OR WARNING CONDITION IF IT IS NOT DEFINED AND WITHIN THE      *09390000
093910*  PROPER WINDOW OF STORE OPENING.  FOR THE LOCATION TO DC       *09391000
093920*  ASSIGNMENT, LOOK UP THE CURRENT ASSIGNMENT IN THE CORE TABLE, *09392000
093930*  AND LOG ANY ERROR OR WARNING CONDITION IF IT IS NOT DEFINED   *09393000
093940*  AND WITHIN THE PROPER WINDOW OF STORE OPENING.  FOR THE       *09394000
093950*  LOCATION TYPE CODE, LOOK UP THE DESCRIPTION IN THE CORE       *09395000
093960*  TABLE.  ACQUIRE THE MERCHANT NUMBERS FOR THE LOCATION FROM    *09396000
093970*  SELLING DOMAIN LOCATION ATTRIBUTE TABLE.  FOR EACH MERCHANT   *09397000
093980*  NUMBER, LOG ANY ERROR OR WARNING CONDITION IF IT IS NOT       *09398000
093990*  DEFINED AND WITHIN THE PROPER WINDOW OF STORE OPENING.        *09399000
093991*  WRITE THE COMPLETED EXTRACT RECORD.                           *09399100
093992******************************************************************09399200
093993                                                                  09399300
093994 2000-PROCESS-STORE-LOCATION.                                     09399400
093995     INITIALIZE LE-LOCATION-EXTRACT-RECORD.                       09399500
093996                                                                  09399600
093997     MOVE HO013-LOC-NBR TO LE-LOC-NBR.                            09399700
093998     MOVE HO013-LOC-TYP-CDE TO LE-LOC-TYP-CDE.                    09399800
093999     MOVE HO013-LOC-NM TO LE-LOC-NM.                              09399900
094000     MOVE HO013-LOC-LNE-1-ADDR TO LE-LNE-1-ADDR.                  09400000
094100     MOVE HO013-LOC-LNE-2-ADDR TO LE-LNE-2-ADDR.                  09410000
094200     MOVE HO013-LOC-CITY TO LE-CITY.                              09420000
094300     MOVE HO013-LOC-ST-CDE TO LE-ST-CDE.                          09430000
094400     MOVE HO013-LOC-ZIP-10-CDE TO LE-ZIP-10-CDE.                  09440000
094500     MOVE HO013-LOC-PHONE-NUMBER TO LE-PHN-NBR.                   09450000
094600     MOVE HO013-LOC-OPEN-DATE TO LE-OPN-DTE.                      09460000
094700     MOVE HO013-LOC-CLOSE-DATE TO LE-CLS-DTE.                     09470000
094800     MOVE HO013-LOC-FINCL-CLO-DTE TO LE-FINCL-CLO-DTE.            09480000
094900     MOVE HO013-LOC-REPLT-STR-NBR TO LE-REPLT-STR-NBR.            09490000
095000     MOVE HO013-LOC-STD-TM-ZN-CDE TO LE-STD-TM-ZN-CDE.            09500000
095100     MOVE HO013-LOC-DST-IND TO LE-DST-IND.                        09510000
095200     MOVE HO013-LOC-MGR-NM TO LE-MGR-NM.                          09520000
095300     MOVE HO013-LOC-E-BUS-IND TO LE-E-BUS-IND.                    09530000
095400                                                                  09540000
095500     MOVE HO013-LOC-FMT-CDE TO LE-STR-FMT-CDE.                    09550000
095600     SET SF-INDEX TO 1.                                           09560000
095700     SEARCH SF-STORE-FORMAT-ENTRY                                 09570000
095800         VARYING SF-INDEX                                         09580000
095900         AT END                                                   09590000
096000             INITIALIZE EW-ERROR-WARNING-RCD                      09600000
096100             EVALUATE TRUE                                        09610000
096200                 WHEN (LE-CLS-DTE < PV-CURRENT-DATE)              09620000
096300                 WHEN (LE-E-BUS-LOCATION)                         09630000
096400                     CONTINUE                                     09640000
096500                 WHEN (LE-OPN-DTE <= PV-CURRENT-DATE)             09650000
096600                     SET EW-EL-ERROR TO TRUE                      09660000
096700                 WHEN (LE-OPN-DTE <= PV-ERROR-COMPARE-DATE)       09670000
096800                     SET EW-EL-WARNING TO TRUE                    09680000
096900             END-EVALUATE                                         09690000
097000             IF (EW-ERROR-LEVEL NOT = SPACES)                     09700000
097100                 INITIALIZE EW-ERROR-WARNING-DETAIL               09710000
097200                 SET EW-EL-ERROR TO TRUE                          09720000
097300                 STRING 'STORE '                 DELIMITED BY SIZE09730000
097400                        LE-LOC-NBR               DELIMITED BY SIZE09740000
097500                        ' FORMAT CODE '          DELIMITED BY SIZE09750000
097600                        LE-STR-FMT-CDE           DELIMITED BY SIZE09760000
097700                        ' NOT FOUND'             DELIMITED BY SIZE09770000
097800                     INTO EW-ERROR-WARNING-DETAIL                 09780000
097900                 PERFORM 8100-WRITE-ERROR-WARN-RECORD             09790000
098000             END-IF                                               09800000
098100         WHEN LE-STR-FMT-CDE = SF-STR-FMT-CDE (SF-INDEX)          09810000
098200             MOVE SF-STR-FMT-DESC (SF-INDEX) TO LE-STR-FMT-DESC   09820000
098300     END-SEARCH.                                                  09830000
098400                                                                  09840000
098500     SEARCH ALL DL-DC-LOC-ASSIGNMENT-ENTRY                        09850000
098600         AT END                                                   09860000
098700             INITIALIZE EW-ERROR-WARNING-RCD                      09870000
098800             EVALUATE TRUE                                        09880000
098900                 WHEN (LE-CLS-DTE < PV-CURRENT-DATE)              09890000
099000                     CONTINUE                                     09900000
099100                 WHEN (LE-OPN-DTE <= PV-CURRENT-DATE)             09910000
099200                     SET EW-EL-ERROR TO TRUE                      09920000
099300                 WHEN (LE-OPN-DTE <= PV-ERROR-COMPARE-DATE)       09930000
099400                     SET EW-EL-WARNING TO TRUE                    09940000
099500             END-EVALUATE                                         09950000
099600             IF (EW-ERROR-LEVEL NOT = SPACES)                     09960000
099700                 STRING 'STORE '                 DELIMITED BY SIZE09970000
099800                        LE-LOC-NBR               DELIMITED BY SIZE09980000
099900                        ' MISSING DC ASSIGNMENT - OPEN DATE IS '  09990000
100000                                                 DELIMITED BY SIZE10000000
100100                        LE-OPN-DTE               DELIMITED BY SIZE10010000
100200                     INTO EW-ERROR-WARNING-DETAIL                 10020000
100300                 PERFORM 8100-WRITE-ERROR-WARN-RECORD             10030000
100400             END-IF                                               10040000
100500         WHEN DL-LOC-NBR (DL-INDEX) = LE-LOC-NBR                  10050000
100600             MOVE DL-DC-NBR (DL-INDEX) TO LE-DC-ASSIGNMENT-LOC-NBR10060000
100700     END-SEARCH.                                                  10070000
100800                                                                  10080000
100900     SET LT-INDEX TO 1.                                           10090000
101000     SEARCH LT-LOCATION-TYPE-ENTRY                                10100000
101100         VARYING LT-INDEX                                         10110000
101200         AT END                                                   10120000
101300             INITIALIZE EW-ERROR-WARNING-DETAIL                   10130000
101400             SET EW-EL-ERROR TO TRUE                              10140000
101500             STRING 'STORE '                     DELIMITED BY SIZE10150000
101600                    LE-LOC-NBR                   DELIMITED BY SIZE10160000
101700                    ' LOCATION TYPE CODE '       DELIMITED BY SIZE10170000
101800                    LE-LOC-TYP-CDE               DELIMITED BY SIZE10180000
101900                    ' NOT FOUND'                 DELIMITED BY SIZE10190000
102000                 INTO EW-ERROR-WARNING-DETAIL                     10200000
102100             PERFORM 8100-WRITE-ERROR-WARN-RECORD                 10210000
102200         WHEN LE-LOC-TYP-CDE = LT-LOC-TYP-CDE (LT-INDEX)          10220000
102300             MOVE LT-LOC-TYP-DESC (LT-INDEX) TO LE-LOC-TYP-DESC   10230000
102400     END-SEARCH.                                                  10240000
102500                                                                  10250000
102600     MOVE HO013-LOC-EXTD-MALL-NM TO LE-EXTD-MALL-NM.              10260000
102700     MOVE HO013-LOC-GRND-OPN-DTE TO LE-GRND-OPN-DTE.              10270000
109500                                                                  10950000
109600     PERFORM 8000-WRITE-LOCATION-RECORD.                          10960000
109700                                                                  10970000
109800     PERFORM 7000-READ-STORE-FILE.                                10980000
109900*2000-EXIT.                                                       10990000
110000                                                                  11000000
110100******************************************************************11010000
110200*  CREATE A SERVICE MGMT EXTRACT FOR A WAREHOUSE LOCATION FROM   *11020000
110300*  THE WAREHOUSE SYSTEM OF RECORD EXTRACT.  RECORDS WILL BE      *11030000
110400*  PRE-FILTERED BEFORE ENTERING THIS PARAGRAPH TO ONLY INCLUDE   *11040000
110500*  THE REQUIRED WAREHOUSE LOCATION TYPES.  LOOK UP THE NON-      *11050000
110600*  MANAGED ATTRIBUTES IN THE CORE TABLE AND LOG ANY ERROR OR     *11060000
110700*  WARNING CONDITIONS IF IT IS NOT DEFINED AND WITHIN THE PROPER *11070000
110800*  WINDOW OF STORE OPENING, OR IF THE TWO FILES DO NOT HAVE THE  *11080000
110900*  SAME LOCATION TYPE CODE REFERENCED.  FOR THE LOCATION TYPE    *11090000
110910*  CODE, LOOK UP THE DESCRIPTION IN THE CORE TABLE.  WRITE THE   *11091000
110920*  COMPLETED EXTRACT RECORD.                                     *11092000
110930******************************************************************11093000
110940                                                                  11094000
110950 3000-PROCESS-WAREHSE-LOCATION.                                   11095000
110960     INITIALIZE LE-LOCATION-EXTRACT-RECORD.                       11096000
110970                                                                  11097000
110980     MOVE HO014-WH-NBR TO LE-LOC-NBR.                             11098000
110990     MOVE HO014-WH-TYP-CDE TO LE-LOC-TYP-CDE.                     11099000
111000     MOVE HO014-WH-NM TO LE-LOC-NM.                               11100000
111100     MOVE HO014-WH-LNE-1-ADDR TO LE-LNE-1-ADDR.                   11110000
111200     MOVE HO014-WH-LNE-2-ADDR TO LE-LNE-2-ADDR.                   11120000
111300     MOVE HO014-WH-CITY TO LE-CITY.                               11130000
111400     MOVE HO014-WH-ST-CDE TO LE-ST-CDE.                           11140000
111500     MOVE HO014-WH-ZIP-10-CDE TO LE-ZIP-10-CDE.                   11150000
111600     MOVE HO014-WH-OPEN-DATE TO LE-OPN-DTE.                       11160000
111700     MOVE HO014-WH-CLOSE-DATE TO LE-CLS-DTE.                      11170000
111800     MOVE HO014-WH-DST-IND TO LE-DST-IND.                         11180000
111900                                                                  11190000
112000     SEARCH ALL MA-MISSING-ATTRB-ENTRY                            11200000
112100         AT END                                                   11210000
112200             INITIALIZE EW-ERROR-WARNING-RCD                      11220000
112300             EVALUATE TRUE                                        11230000
112400                 WHEN (LE-CLS-DTE < PV-CURRENT-DATE)              11240000
112500                     CONTINUE                                     11250000
112600                 WHEN (LE-OPN-DTE <= PV-CURRENT-DATE)             11260000
112700                     SET EW-EL-ERROR TO TRUE                      11270000
112800                 WHEN (LE-OPN-DTE <= PV-ERROR-COMPARE-DATE)       11280000
112900                     SET EW-EL-WARNING TO TRUE                    11290000
113000             END-EVALUATE                                         11300000
113100             IF (EW-ERROR-LEVEL NOT = SPACES)                     11310000
113200                 STRING LE-LOC-TYP-CDE           DELIMITED BY SIZE11320000
113300                        ' LOC '                  DELIMITED BY SIZE11330000
113400                        LE-LOC-NBR               DELIMITED BY SIZE11340000
113500                        ' HAS NO UNMANAGED ATTR ENTRY - '         11350000
113600                                                 DELIMITED BY SIZE11360000
113700                        'OPEN DATE IS '          DELIMITED BY SIZE11370000
113800                        LE-OPN-DTE               DELIMITED BY SIZE11380000
113900                     INTO EW-ERROR-WARNING-DETAIL                 11390000
114000                 PERFORM 8100-WRITE-ERROR-WARN-RECORD             11400000
114100             END-IF                                               11410000
114200         WHEN MA-LOC-NBR (MA-INDEX) = LE-LOC-NBR                  11420000
114300             IF (MA-LOC-TYP-CDE (MA-INDEX) NOT = LE-LOC-TYP-CDE)  11430000
114400                 DISPLAY '** ABEND **'                            11440000
114500                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - WAREHOUSE '  11450000
114600                           'LOCATION '  LE-LOC-NBR  ' DOES NOT '  11460000
114700                           'HAVE THE SAME LOCATION TYPE CODE '    11470000
114800                           'ON THE UNMANAGED ATTRIBUTES FILE'     11480000
114900                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - SYSTEM OF '  11490000
115000                           'RECORD HAS LOCATION TYPE AS  '        11500000
115100                           LE-LOC-TYP-CDE  ' AND UNMANAGED '      11510000
115200                           'ATTRIBUTES FILE HAS LOCATION TYPE AS '11520000
115300                           MA-LOC-TYP-CDE (MA-INDEX)              11530000
115400                 SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE       11540000
115500                 CALL 'ILBOABN0' USING ABEND-CODE                 11550000
115600             END-IF                                               11560000
115700             MOVE MA-PHN-NBR (MA-INDEX) TO LE-PHN-NBR             11570000
115800             MOVE MA-STD-TM-ZN-CDE (MA-INDEX) TO LE-STD-TM-ZN-CDE 11580000
115900     END-SEARCH.                                                  11590000
116000                                                                  11600000
116100     SET LT-INDEX TO 1.                                           11610000
116200     SEARCH LT-LOCATION-TYPE-ENTRY                                11620000
116300         VARYING LT-INDEX                                         11630000
116400         AT END                                                   11640000
116500             INITIALIZE EW-ERROR-WARNING-DETAIL                   11650000
116600             SET EW-EL-ERROR TO TRUE                              11660000
116700             STRING 'STORE '                     DELIMITED BY SIZE11670000
116800                    LE-LOC-NBR                   DELIMITED BY SIZE11680000
116900                    ' LOCATION TYPE CODE '       DELIMITED BY SIZE11690000
117000                    LE-LOC-TYP-CDE               DELIMITED BY SIZE11700000
117100                    ' NOT FOUND'                 DELIMITED BY SIZE11710000
117200                 INTO EW-ERROR-WARNING-DETAIL                     11720000
117300             PERFORM 8100-WRITE-ERROR-WARN-RECORD                 11730000
117400         WHEN LE-LOC-TYP-CDE = LT-LOC-TYP-CDE (LT-INDEX)          11740000
117500             MOVE LT-LOC-TYP-DESC (LT-INDEX) TO LE-LOC-TYP-DESC   11750000
117600     END-SEARCH.                                                  11760000
117700                                                                  11770000
117800     PERFORM 8000-WRITE-LOCATION-RECORD.                          11780000
117900*3000-EXIT.                                                       11790000
118000                                                                  11800000
118100******************************************************************11810000
118200*  CREATE A SERVICE MANAGEMENT EXTRACT FOR AN OUTSIDE LOCATION   *11820000
118300*  FROM THE OUTLOC SYSTEM OF RECORD EXTRACT.  RECORDS WILL BE    *11830000
118400*  PRE-FILTERED BEFORE ENTERING THIS PARAGRAPH TO ONLY INCLUDE   *11840000
118500*  THE REQUIRED OUTLOC LOCATION TYPES.  LOOK UP THE NON-MANAGED  *11850000
118600*  ATTRIBUTES IN THE CORE TABLE AND LOG ANY ERROR OR WARNING     *11860000
118700*  CONDITIONS IF IT IS NOT DEFINED AND WITHIN THE PROPER WINDOW  *11870000
118800*  OF STORE OPENING, OR IF THE TWO FILES DO NOT HAVE THE SAME    *11880000
118900*  LOCATION TYPE CODE REFERENCED.  FOR THE LOCATION TYPE CODE,   *11890000
118910*  LOOK UP THE DESCRIPTION IN THE CORE TABLE.  IF THE SYSTEM OF  *11891000
118920*  RECORD CORPORATE HEADQUARTERS RECORD IS DETECTED, SAME AN     *11892000
118930*  IMAGE OF THE EXTRACT RECORD.  IF THE PAYROLL/HR CORPORATE     *11893000
118940*  HEADQUARTERS LOCATION IS DETECTED, SET AN INDICATOR FOR       *11894000
118950*  END-OF-JOB PROCESSING.  WRITE THE COMPLETED EXTRACT RECORD.   *11895000
118960******************************************************************11896000
118970                                                                  11897000
118980 4000-PROCESS-OUTSIDE-LOCATION.                                   11898000
118990     INITIALIZE LE-LOCATION-EXTRACT-RECORD.                       11899000
119000                                                                  11900000
119100     MOVE HO015-OUTLC-ID-2-5 TO LE-LOC-NBR.                       11910000
119200     MOVE HO015-OTLC-TYPE TO LE-LOC-TYP-CDE.                      11920000
119300     MOVE HO015-OTLC-DESC TO LE-LOC-NM.                           11930000
119400     MOVE HO015-OTLC-LNE-1-ADDR TO LE-LNE-1-ADDR.                 11940000
119500     MOVE HO015-OTLC-LNE-2-ADDR TO LE-LNE-2-ADDR.                 11950000
119600     MOVE HO015-OTLC-CTY-NM TO LE-CITY.                           11960000
119700     MOVE HO015-OTLC-ST-CDE TO LE-ST-CDE.                         11970000
119800     MOVE HO015-OTLC-ZIP-10-CDE TO LE-ZIP-10-CDE.                 11980000
119900     MOVE HO015-OTLC-OPN-DTE TO LE-OPN-DTE.                       11990000
120000     MOVE HO015-OTLC-CLO-DTE TO LE-CLS-DTE.                       12000000
120100     MOVE HO015-OTLC-PHN-NBR TO LE-PHN-NBR.                       12010000
120200                                                                  12020000
120300     SEARCH ALL MA-MISSING-ATTRB-ENTRY                            12030000
120400         AT END                                                   12040000
120500             INITIALIZE EW-ERROR-WARNING-RCD                      12050000
120600             EVALUATE TRUE                                        12060000
120700                 WHEN (LE-CLS-DTE < PV-CURRENT-DATE)              12070000
120800                     CONTINUE                                     12080000
120900                 WHEN (LE-OPN-DTE <= PV-CURRENT-DATE)             12090000
121000                     SET EW-EL-ERROR TO TRUE                      12100000
121100                 WHEN (LE-OPN-DTE <= PV-ERROR-COMPARE-DATE)       12110000
121200                     SET EW-EL-WARNING TO TRUE                    12120000
121300             END-EVALUATE                                         12130000
121400*                                                                 12140000
121500*  INHIBIT WARNINGS FROM NON MERCHANDISE LOCATIONS, SINCE THERE   12150000
121600*  IS NOT A KNOWN CONSISTENCY WITH THE DEFINITION AND MANAGEMENT  12160000
121700*                                                                 12170000
121800             IF (LE-LOC-TYP-CDE = PC-LT-NON-MERCHANDISE)          12180000
121900                 INITIALIZE EW-ERROR-LEVEL                        12190000
122000             END-IF                                               12200000
122100             IF (EW-ERROR-LEVEL NOT = SPACES)                     12210000
122200                 STRING LE-LOC-TYP-CDE           DELIMITED BY SIZE12220000
122300                        ' LOC '                  DELIMITED BY SIZE12230000
122400                        LE-LOC-NBR               DELIMITED BY SIZE12240000
122500                        ' HAS NO UNMANAGED ATTR ENTRY - '         12250000
122600                                                 DELIMITED BY SIZE12260000
122700                        'OPEN DATE IS '          DELIMITED BY SIZE12270000
122800                        LE-OPN-DTE               DELIMITED BY SIZE12280000
122900                     INTO EW-ERROR-WARNING-DETAIL                 12290000
123000                 PERFORM 8100-WRITE-ERROR-WARN-RECORD             12300000
123100             END-IF                                               12310000
123200         WHEN MA-LOC-NBR (MA-INDEX) = LE-LOC-NBR                  12320000
123300             IF (MA-LOC-TYP-CDE (MA-INDEX) NOT = LE-LOC-TYP-CDE)  12330000
123400                 DISPLAY '** ABEND **'                            12340000
123500                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - OUTSIDE '    12350000
123600                           'LOCATION '  LE-LOC-NBR  ' DOES NOT '  12360000
123700                           'HAVE THE SAME LOCATION TYPE CODE '    12370000
123800                           'ON THE UNMANAGED ATTRIBUTES FILE'     12380000
123900                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - SYSTEM OF '  12390000
124000                           'RECORD HAS LOCATION TYPE AS  '        12400000
124100                           LE-LOC-TYP-CDE  ' AND UNMANAGED '      12410000
124200                           'ATTRIBUTES FILE HAS LOCATION TYPE AS '12420000
124300                           MA-LOC-TYP-CDE (MA-INDEX)              12430000
124400                 SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE       12440000
124500                 CALL 'ILBOABN0' USING ABEND-CODE                 12450000
124600             END-IF                                               12460000
124700             MOVE MA-STD-TM-ZN-CDE (MA-INDEX) TO LE-STD-TM-ZN-CDE 12470000
124800             MOVE MA-DST-IND (MA-INDEX) TO LE-DST-IND             12480000
124900     END-SEARCH.                                                  12490000
125000                                                                  12500000
125100     SET LT-INDEX TO 1.                                           12510000
125200     SEARCH LT-LOCATION-TYPE-ENTRY                                12520000
125300         VARYING LT-INDEX                                         12530000
125400         AT END                                                   12540000
125500             INITIALIZE EW-ERROR-WARNING-DETAIL                   12550000
125600             SET EW-EL-ERROR TO TRUE                              12560000
125700             STRING 'STORE '                     DELIMITED BY SIZE12570000
125800                    LE-LOC-NBR                   DELIMITED BY SIZE12580000
125900                    ' LOCATION TYPE CODE '       DELIMITED BY SIZE12590000
126000                    LE-LOC-TYP-CDE               DELIMITED BY SIZE12600000
126100                    ' NOT FOUND'                 DELIMITED BY SIZE12610000
126200                 INTO EW-ERROR-WARNING-DETAIL                     12620000
126300             PERFORM 8100-WRITE-ERROR-WARN-RECORD                 12630000
126400         WHEN LE-LOC-TYP-CDE = LT-LOC-TYP-CDE (LT-INDEX)          12640000
126500             MOVE LT-LOC-TYP-DESC (LT-INDEX) TO LE-LOC-TYP-DESC   12650000
126600     END-SEARCH.                                                  12660000
126700                                                                  12670000
126800     IF (LE-LOC-NBR = PC-LOC-FILE-HQ-LOC-NBR)                     12680000
126900         MOVE LE-LOCATION-EXTRACT-RECORD TO                       12690000
127000                   PV-HEADQUARTERS-LOCATION-IMAGE                 12700000
127100     END-IF.                                                      12710000
127200                                                                  12720000
127300     IF (LE-LOC-NBR = PC-HR-HQ-LOC-NBR)                           12730000
127400         SET PS-HR-HQ-LOC-FOUND TO TRUE                           12740000
127500     END-IF.                                                      12750000
127600                                                                  12760000
127700     PERFORM 8000-WRITE-LOCATION-RECORD.                          12770000
127800*4000-EXIT.                                                       12780000
127900                                                                  12790000
128000******************************************************************12800000
128100*  READ A STORE LOCATION RECORD FROM THE SYSTEM OF RECORD        *12810000
128200*  EXTRACT FOR STORE LOCATIONS.                                  *12820000
128300******************************************************************12830000
128400                                                                  12840000
128500 7000-READ-STORE-FILE.                                            12850000
128600     READ STORE-LOCATION-FILE                                     12860000
128700         INTO HO013-LOCATION-DATA                                 12870000
128800         AT END                                                   12880000
128900             SET PS-END-OF-STORE-FILE TO TRUE                     12890000
129000             SUBTRACT +1 FROM PT-STORE-SOR-RCDS-READ              12900000
129100     END-READ.                                                    12910000
129200                                                                  12920000
129300     ADD +1 TO PT-STORE-SOR-RCDS-READ.                            12930000
129400*7000-EXIT.                                                       12940000
129500                                                                  12950000
129600******************************************************************12960000
129700*  READ A WAREHOUSE LOCATION RECORD FROM THE SYSTEM OF RECORD    *12970000
129800*  EXTRACT FOR WAREHOUSE LOCATIONS.                              *12980000
129900******************************************************************12990000
130000                                                                  13000000
130100 7100-READ-WAREHOUSE-FILE.                                        13010000
130200     READ WAREHOUSE-LOCATION-FILE                                 13020000
130300         INTO HO014-WH-DATA                                       13030000
130400         AT END                                                   13040000
130500             SET PS-END-OF-WAREHOUSE-FILE TO TRUE                 13050000
130600             SUBTRACT +1 FROM PT-WAREHOUSE-SOR-RCDS-READ          13060000
130700     END-READ.                                                    13070000
130800                                                                  13080000
130900     ADD +1 TO PT-WAREHOUSE-SOR-RCDS-READ.                        13090000
131000*7100-EXIT.                                                       13100000
131100                                                                  13110000
131200******************************************************************13120000
131300*  READ AN OUTSIDE LOCATION RECORD FROM THE SYSTEM OF RECORD     *13130000
131400*  EXTRACT FOR OUTLOC LOCATIONS.                                 *13140000
131500******************************************************************13150000
131600                                                                  13160000
131700 7200-READ-OUTSIDE-FILE.                                          13170000
131800     READ OUTSIDE-LOCATION-FILE                                   13180000
131900         INTO HO015-OUTLOC-DATA                                   13190000
132000         AT END                                                   13200000
132100             SET PS-END-OF-OUTSIDE-FILE TO TRUE                   13210000
132200             SUBTRACT +1 FROM PT-OUTLOC-SOR-RCDS-READ             13220000
132300     END-READ.                                                    13230000
132400                                                                  13240000
132500     ADD +1 TO PT-OUTLOC-SOR-RCDS-READ.                           13250000
132600*7200-EXIT.                                                       13260000
132700                                                                  13270000
132800******************************************************************13280000
132900*  READ A LOCATION TO DC ASSIGNMENT RECORD FROM THE SYSTEM OF    *13290000
133000*  RECORD EXTRACT FOR LOCATION TO DC ASSIGNMENTS.                *13300000
133100******************************************************************13310000
133200                                                                  13320000
133300 7300-READ-DC-LOC-ASSIGN-FILE.                                    13330000
133400     READ DC-LOC-ASSIGNMENT-FILE                                  13340000
133500         INTO HO016-DCLOCASG-DATA                                 13350000
133600         AT END                                                   13360000
133700             SET PS-END-OF-DC-LOC-FILE TO TRUE                    13370000
133800             SUBTRACT +1 FROM PT-DC-LOC-ASG-SOR-RCDS-READ         13380000
133900     END-READ.                                                    13390000
134000                                                                  13400000
134100     ADD +1 TO PT-DC-LOC-ASG-SOR-RCDS-READ.                       13410000
134200*7300-EXIT.                                                       13420000
134300                                                                  13430000
134400******************************************************************13440000
134500*  READ A LOCATION TYPE RECORD FROM THE SYSTEM OF RECORD EXTRACT *13450000
134600*  FOR THE LOCATION TYPE DESCRIPTION ASSOCIATION.                *13460000
134700******************************************************************13470000
134800                                                                  13480000
134900 7400-READ-LOCATION-TYPE-FILE.                                    13490000
135000     READ LOCATION-TYPE-FILE                                      13500000
135100         INTO HO021-LOCATION-TYPE-DATA                            13510000
135200         AT END                                                   13520000
135300             SET PS-END-OF-LOC-TYPE-FILE TO TRUE                  13530000
135400             SUBTRACT +1 FROM PT-LOC-TYPE-SOR-RCDS-READ           13540000
135500     END-READ.                                                    13550000
135600                                                                  13560000
135700     ADD +1 TO PT-LOC-TYPE-SOR-RCDS-READ.                         13570000
135800*7400-EXIT.                                                       13580000
135900                                                                  13590000
136000******************************************************************13600000
136010*  READ A STORE FORMAT CODE RECORD FROM THE SYSTEM OF RECORD     *13601000
136020*  EXTRACT FOR THE STORE FORMAT CODE DESCRIPTION ASSOCIATION.    *13602000
136030******************************************************************13603000
136040                                                                  13604000
136050 7400-READ-STORE-FORMAT-FILE.                                     13605000
136060     READ STORE-FORMAT-FILE                                       13606000
136070         INTO HO022-STORE-FORMAT-DATA                             13607000
136080         AT END                                                   13608000
136090             SET PS-END-OF-STR-FMT-FILE TO TRUE                   13609000
136100             SUBTRACT +1 FROM PT-STORE-FMT-SOR-RCDS-READ          13610000
136200     END-READ.                                                    13620000
136300                                                                  13630000
136400     ADD +1 TO PT-STORE-FMT-SOR-RCDS-READ.                        13640000
136500*7400-EXIT.                                                       13650000
136600                                                                  13660000
136700******************************************************************13670000
136800*  READ AN UNMANAGED ATTRIBUTE FILE RECORD (FOR ATTRIBUTES       *13680000
136900*  REQUIRED FOR SERVICE MANAGEMENT, BUT NOT MANAGED BY THE       *13690000
136910*  SYSTEM OF RECORD).                                            *13691000
137000******************************************************************13700000
137100                                                                  13710000
137200 7500-READ-UNMANAGED-ATTRB-FILE.                                  13720000
137300     READ UNMANAGED-ATTRB-FILE                                    13730000
137400         INTO UA-UNMANAGED-ATTRB-RCD                              13740000
137500         AT END                                                   13750000
137600             SET PS-END-OF-UNMANAGED-FILE TO TRUE                 13760000
137700             SUBTRACT +1 FROM PT-UNMANAGD-ATTRB-RCDS-READ         13770000
137800     END-READ.                                                    13780000
137900                                                                  13790000
138000     ADD +1 TO PT-UNMANAGD-ATTRB-RCDS-READ.                       13800000
138100*7500-EXIT.                                                       13810000
146000                                                                  14600000
146100******************************************************************14610000
146200*  WRITE A SERVICE MANAGEMENT LOCATION EXTRACT RECORD.           *14620000
146300******************************************************************14630000
146400                                                                  14640000
146500 8000-WRITE-LOCATION-RECORD.                                      14650000
146600     WRITE SM-SERVICE-MGT-LOCATION-RECORD                         14660000
146700         FROM LE-LOCATION-EXTRACT-RECORD.                         14670000
146800                                                                  14680000
146900     ADD +1 TO PT-LOC-EXTRACT-RCDS-WRITTEN.                       14690000
147000*8000-EXIT.                                                       14700000
147100                                                                  14710000
147200******************************************************************14720000
147300*  WRITE A NON-FATAL SERVICE MANAGEMENT LOCATION ERROR/WARNING   *14730000
147310*  RECORD.                                                       *14731000
147400******************************************************************14740000
147500                                                                  14750000
147600 8100-WRITE-ERROR-WARN-RECORD.                                    14760000
147700     WRITE EW-ERROR-WARNING-RECORD                                14770000
147800         FROM EW-ERROR-WARNING-RCD.                               14780000
147900                                                                  14790000
148000     ADD +1 TO PT-ERROR-WARN-RCDS-WRITTEN.                        14800000
148100*8100-EXIT.                                                       14810000
148200                                                                  14820000
148300******************************************************************14830000
148400*  CLOSE ALL FILES.                                              *14840000
148500******************************************************************14850000
148600                                                                  14860000
148700 9000-EOJ-ROUTINE.                                                14870000
148800     CLOSE STORE-LOCATION-FILE                                    14880000
148900           WAREHOUSE-LOCATION-FILE                                14890000
149000           OUTSIDE-LOCATION-FILE                                  14900000
149100           DC-LOC-ASSIGNMENT-FILE                                 14910000
149200           LOCATION-TYPE-FILE                                     14920000
149300           STORE-FORMAT-FILE                                      14930000
149400           UNMANAGED-ATTRB-FILE                                   14940000
149500           SERVICE-MGT-LOCATION-FILE                              14950000
149600           ERROR-WARNING-FILE.                                    14960000
149700*9000-EXIT.                                                       14970000
