000100 IDENTIFICATION DIVISION.                                                 
000200 TITLE 'INVENTORY STORES TRAILER SUSPENSE REPORT BY DC'.                  
000300 PROGRAM-ID.             SUKRP044.                                        
000400 AUTHOR.                 DENNIS STEFFEN.                                  
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000600 DATE-WRITTEN            SEPTEMBER 2005.                                  
000700 DATE-COMPILED.                                                           
000800*****************************************************************         
000900*  THIS PROGRAM WILL CREATE THE DAILY TRAILER SUSPENSE REPORT - *         
001000*  SHIPPED BUT NOT OPENED AT STORE REPORT.                      *         
001100*****************************************************************         
001200 ENVIRONMENT DIVISION.                                                    
001300 CONFIGURATION SECTION.                                                   
001400 SOURCE-COMPUTER.        IBM-3090.                                        
001500 OBJECT-COMPUTER.        IBM-3090.                                        
001600                                                                          
001700 INPUT-OUTPUT SECTION.                                                    
001800 FILE-CONTROL.                                                            
001900                                                                          
002000     SELECT INPUT-FILE                                                    
002100         ASSIGN TO INP01.                                                 
002200                                                                          
002300     SELECT REPORT-FILE                                                   
002400         ASSIGN TO RPT01.                                                 
002500                                                                          
002600 DATA DIVISION.                                                           
002700 FILE SECTION.                                                            
002800                                                                          
002900 FD  INPUT-FILE                                                           
003000     RECORDING MODE IS F                                                  
003100     LABEL RECORDS ARE STANDARD                                           
003200     BLOCK CONTAINS 0 RECORDS                                             
003300     RECORD CONTAINS 106 CHARACTERS.                                      
003400 01  INPUT-RECORD                    PIC  X(106).                         
003500                                                                          
003600 FD  REPORT-FILE                                                          
003700     RECORDING MODE IS F                                                  
003800     BLOCK CONTAINS 0  RECORDS.                                           
003900 01  REPORT-RECORD                   PIC  X(132).                         
004000                                                                          
004100                                                                          
004200 WORKING-STORAGE SECTION.                                                 
004300                                                                          
004400 01  PROGRAM-SWITCHES.                                                    
004500     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.                 
004600         88  PS-END-OF-INPUT                   VALUE 'Y'.                 
004700         88  PS-NOT-END-OF-INPUT               VALUE 'N'.                 
004800                                                                          
004900 01  PV-CURR-KEY.                                                         
005000     05  PV-CURR-OPER                 PIC 9(04).                          
005100                                                                          
005200 01  PV-PREV-KEY.                                                         
005300     05  PV-PREV-OPER                 PIC 9(04).                          
005400                                                                          
005500 01  PV-CURR-KEY-2.                                                       
005600     05  PV-CURR-PLND-INV-DTE         PIC X(10).                          
005700 01  PV-PREV-KEY-2.                                                       
005800     05  PV-PREV-PLND-INV-DTE         PIC X(10).                          
005900                                                                          
006000 01  PV-PROGRAM-CONSTANTS.                                                
006100     05  PV-TIMESTAMP                PIC X(26).                           
006200                                                                          
006300     05  PC-SUKRP044                 PIC X(08) VALUE  'SUKRP044'.         
006400     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.                
006500                                                                          
006600 01  PV-PROGRAM-VARIABLES.                                                
006700     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.               
006800     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO                 
006900                                                   COMP-3.                
007000     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO                 
007100                                                   COMP-3.                
007200     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60                  
007300                                                   COMP-3.                
007400     05  PV-READ-COUNT               PIC S9(9) VALUE ZERO                 
007500                                                   COMP-3.                
007600     05  PV-DETAIL-COUNT             PIC S9(9) VALUE ZERO                 
007700                                                   COMP-3.                
007800     05  PV-DISP-NBR                 PIC ZZZ,ZZZ,ZZ9.                     
007900     05  PV-OPER-UNT-ID              PIC S9(04) VALUE ZERO                
008000                                                   COMP.                  
008100     05  PV-STR-NBR                  PIC S9(04) VALUE ZERO                
008200                                                   COMP.                  
008300     05  PV-TODAYS-DATE.                                                  
008400         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.                
008500         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.                
008600         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.                
008700     05  PV-TODAYS-TIME.                                                  
008800         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.                
008900         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.                
009000         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.                
009100         10  FILLER                  PIC 9(02) VALUE ZERO.                
009200     05  PV-COMPARE-DATE.                                                 
009300         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.                
009400         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.                
009500         10  FILLER                  PIC X(01) VALUE '-'.                 
009600         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.                
009700         10  FILLER                  PIC X(01) VALUE '-'.                 
009800         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.                
009900     05  PV-PLAN-INV-DTE.                                                 
010000         10  PV-PLAN-INV-DTE-CCYY    PIC 9(04) VALUE ZERO.                
010100         10  FILLER                  PIC X(01) VALUE '-'.                 
010200         10  PV-PLAN-INV-DTE-MM      PIC 9(02) VALUE ZERO.                
010300         10  FILLER                  PIC X(01) VALUE '-'.                 
010400         10  PV-PLAN-INV-DTE-DD      PIC 9(02) VALUE ZERO.                
010500                                                                          
010600 01  PV-DATE-TIME.                                                        
010700     05  PV-DATE-TIME-CCYY            PIC X(04) VALUE SPACE.              
010800     05  FILLER                       PIC X(01) VALUE SPACE.              
010900     05  PV-DATE-TIME-MM              PIC X(02) VALUE SPACE.              
011000     05  FILLER                       PIC X(01) VALUE SPACE.              
011100     05  PV-DATE-TIME-DD              PIC X(02) VALUE SPACE.              
011200     05  FILLER                       PIC X(01) VALUE SPACE.              
011300     05  PV-DATE-TIME-HH              PIC X(02) VALUE SPACE.              
011400     05  FILLER                       PIC X(01) VALUE SPACE.              
011500     05  PV-DATE-TIME-MN              PIC X(02) VALUE SPACE.              
011600     05  FILLER                       PIC X(01) VALUE SPACE.              
011700     05  PV-DATE-TIME-SS              PIC X(02) VALUE SPACE.              
011800     05  FILLER                       PIC X(07) VALUE SPACE.              
011900                                                                          
012000 01  PV-DISPLAY-DATE.                                                     
012100     05  PV-DISPLAY-MM                PIC X(02) VALUE SPACE.              
012200     05  FILLER                       PIC X(01) VALUE '/'.                
012300     05  PV-DISPLAY-DD                PIC X(02) VALUE SPACE.              
012400     05  FILLER                       PIC X(01) VALUE '/'.                
012500     05  PV-DISPLAY-CCYY              PIC X(04) VALUE SPACE.              
012600                                                                          
012700 01  PV-DISPLAY-TIME.                                                     
012800     05  PV-DISPLAY-HH                PIC X(02) VALUE SPACE.              
012900     05  FILLER                       PIC X(01) VALUE ':'.                
013000     05  PV-DISPLAY-MN                PIC X(02) VALUE SPACE.              
013100                                                                          
013200 01  DK-DB2-KEY-FIELDS.                                                   
013300     05  DK-OPER-UNT-ID              PIC S9(04) COMP VALUE ZEROES.        
013400                                                                          
013500 01  ABEND-CODE                      PIC S9(4)  VALUE +0                  
013600                                                 COMP SYNC.               
013700                                                                          
013800******************************************************************        
013900* COPY BOOK FOR TRAILER SUSPENSE - SHIPPED BUT NOT OPENED AT STORE        
014000******************************************************************        
014100     COPY SURD055.                                                        
014200                                                                          
014300     COPY DPWS004.                                                        
014400                                                                          
014500     COPY DPWS132O.                                                       
014600                                                                          
014700 01  HEADING-LINES.                                                       
014800     05  HEADING-LINE-1.                                                  
014900         10  FILLER                  PIC  X(54)    VALUE SPACES.          
015000         10  FILLER                  PIC  X(23)    VALUE                  
015100             'TRAILER SUSPENSE REPORT'.                                   
015200         10  FILLER                  PIC  X(55)    VALUE SPACES.          
015300                                                                          
015400     05  HEADING-LINE-2.                                                  
015500         10  FILLER                  PIC  X(47)    VALUE SPACES.          
015600         10  FILLER                  PIC  X(37)    VALUE                  
015700             'INVENTORY STORES WITH CLOSED TRAILERS'.                     
015800         10  FILLER                  PIC  X(48)    VALUE SPACES.          
015900                                                                          
016000     05  HEADING-LINE-4.                                                  
016100         10  FILLER                  PIC  X(71)    VALUE SPACES.          
016200         10  FILLER                  PIC  X(07)    VALUE                  
016300             'TRAILER'.                                                   
016400         10  FILLER                  PIC  X(05)    VALUE SPACES.          
016500         10  FILLER                  PIC  X(07)    VALUE                  
016600             'TRAILER'.                                                   
016700         10  FILLER                  PIC  X(08)    VALUE SPACES.          
016800         10  FILLER                  PIC  X(14)    VALUE                  
016900             'TRAILER STATUS'.                                            
017000         10  FILLER                  PIC  X(06)    VALUE SPACES.          
017100         10  FILLER                  PIC  X(07)    VALUE                  
017200             'PLANNED'.                                                   
017300         10  FILLER                  PIC  X(09)    VALUE SPACES.          
017400                                                                          
017500     05  HEADING-LINE-5.                                                  
017600         10  FILLER                  PIC  X(02)    VALUE SPACES.          
017700         10  FILLER                  PIC  X(05)    VALUE                  
017800             'STORE'.                                                     
017900         10  FILLER                  PIC  X(04)    VALUE SPACES.          
018000         10  FILLER                  PIC  X(02)    VALUE                  
018100             'DC'.                                                        
018200         10  FILLER                  PIC  X(13)    VALUE SPACES.          
018300         10  FILLER                  PIC  X(10)    VALUE                  
018400             'STORE NAME'.                                                
018500         10  FILLER                  PIC  X(12)    VALUE SPACES.          
018600         10  FILLER                  PIC  X(04)    VALUE                  
018700             'SCAC'.                                                      
018800         10  FILLER                  PIC  X(05)    VALUE SPACES.          
018900         10  FILLER                  PIC  X(10)    VALUE                  
019000             'TRAILER ID'.                                                
019100         10  FILLER                  PIC  X(04)    VALUE SPACES.          
019200         10  FILLER                  PIC  X(06)    VALUE                  
019300             'SERIAL'.                                                    
019400         10  FILLER                  PIC  X(06)    VALUE SPACES.          
019500         10  FILLER                  PIC  X(08)    VALUE                  
019600             '# STATUS'.                                                  
019700         10  FILLER                  PIC  X(09)    VALUE SPACES.          
019800         10  FILLER                  PIC  X(09)    VALUE                  
019900             'DATE/TIME'.                                                 
020000         10  FILLER                  PIC  X(09)    VALUE SPACES.          
020100         10  FILLER                  PIC  X(08)    VALUE                  
020200             'INV DATE'.                                                  
020300         10  FILLER                  PIC  X(08)    VALUE SPACES.          
020400                                                                          
020500     05  HEADING-LINE-6.                                                  
020600         10  FILLER                  PIC  X(02)    VALUE SPACES.          
020700         10  FILLER                  PIC  X(05)    VALUE                  
020800             '-----'.                                                     
020900         10  FILLER                  PIC  X(03)    VALUE SPACES.          
021000         10  FILLER                  PIC  X(04)    VALUE                  
021100             '----'.                                                      
021200         10  FILLER                  PIC  X(02)    VALUE SPACES.          
021300         10  FILLER                  PIC  X(30)    VALUE                  
021400             '------------------------------'.                            
021500         10  FILLER                  PIC  X(02)    VALUE SPACES.          
021600         10  FILLER                  PIC  X(04)    VALUE                  
021700             '----'.                                                      
021800         10  FILLER                  PIC  X(05)    VALUE SPACES.          
021900         10  FILLER                  PIC  X(10)    VALUE                  
022000             '----------'.                                                
022100         10  FILLER                  PIC  X(04)    VALUE SPACES.          
022200         10  FILLER                  PIC  X(09)    VALUE                  
022300             '---------'.                                                 
022400         10  FILLER                  PIC  X(03)    VALUE SPACES.          
022500         10  FILLER                  PIC  X(10)    VALUE                  
022600             '----------'.                                                
022700         10  FILLER                  PIC  X(04)    VALUE SPACES.          
022800         10  FILLER                  PIC  X(17)    VALUE                  
022900             '-----------------'.                                         
023000         10  FILLER                  PIC  X(03)    VALUE SPACES.          
023100         10  FILLER                  PIC  X(10)    VALUE                  
023200             '----------'.                                                
023300         10  FILLER                  PIC  X(07)    VALUE SPACES.          
023400                                                                          
023500 01  DETAIL-LINES.                                                        
023600     05  DETAIL-LINE1.                                                    
023700         10  FILLER                 PIC  X(02)     VALUE SPACES.          
023800         10  DL1-STR-NBR            PIC  Z(04)     VALUE SPACES.          
023900         10  FILLER                 PIC  X(04)     VALUE SPACES.          
024000         10  DL1-OPER-UNT           PIC  Z(04)     VALUE SPACES.          
024100         10  FILLER                 PIC  X(02)     VALUE SPACES.          
024200         10  DL1-STORE-NM           PIC  X(30)     VALUE SPACES.          
024300         10  FILLER                 PIC  X(02)     VALUE SPACES.          
024400         10  DL1-SCAC               PIC  X(04)     VALUE SPACES.          
024500         10  FILLER                 PIC  X(06)     VALUE SPACES.          
024600         10  DL1-TRLR-ID            PIC  X(12)     VALUE SPACES.          
024700         10  FILLER                 PIC  X(01)     VALUE SPACES.          
024800         10  DL1-TRLR-SRL-NBR       PIC  X(09)     VALUE SPACES.          
024900         10  FILLER                 PIC  X(03)     VALUE SPACES.          
025000         10  DL1-TRLR-STATUS        PIC  X(10)     VALUE SPACES.          
025100         10  FILLER                 PIC  X(04)     VALUE SPACES.          
025200         10  DL1-DATE               PIC  X(10)     VALUE SPACES.          
025300         10  FILLER                 PIC  X(02)     VALUE SPACES.          
025400         10  DL1-TIME               PIC  X(05)     VALUE SPACES.          
025500         10  FILLER                 PIC  X(03)     VALUE SPACES.          
025600         10  DL1-PLAN-INV-DT        PIC  X(10)     VALUE SPACES.          
025700                                                                          
025800 01  MISCELLANEOUS-LINES.                                                 
025900     05  BLANK-LINE.                                                      
026000         10  FILLER                  PIC  X(132)   VALUE SPACES.          
026100     05  NO-DATA-LINE.                                                    
026200         10  FILLER                  PIC  X(42)    VALUE SPACES.          
026300         10  FILLER                  PIC  X(47)    VALUE                  
026400             '**** NO INFORMATION EXISTS FOR THIS REPORT ****'.           
026500         10  FILLER                  PIC  X(43)    VALUE SPACES.          
026600     05  END-OF-REPORT-LINE.                                              
026700         10  FILLER                  PIC  X(54)    VALUE SPACES.          
026800         10  FILLER                  PIC  X(44)    VALUE                  
026900             '  ** END OF REPORT **                       '.              
027000         10  FILLER                  PIC  X(44)    VALUE SPACES.          
027100     05  PV-BLANK-LINE.                                                   
027200         10  FILLER                  PIC  X(132)   VALUE SPACES.          
027300                                                                          
027400     EXEC SQL                                                             
027500          INCLUDE TSUOBSC                                                 
027600     END-EXEC.                                                            
027700                                                                          
027800     EXEC SQL                                                             
027900         INCLUDE SQLCA                                                    
028000     END-EXEC.                                                            
028100                                                                          
028200     COPY SQLCA2.                                                         
028300/                                                                         
028400 PROCEDURE DIVISION.                                                      
028500                                                                          
028600 0000-MAINLINE-PROCESSING.                                                
028700                                                                          
028800     PERFORM 1000-INITIALIZATION.                                         
028900                                                                          
029000     PERFORM 2000-PROCESS-INPUT UNTIL PS-END-OF-INPUT                     
029100                                                                          
029200     PERFORM 9000-END.                                                    
029300                                                                          
029400     GOBACK.                                                              
029500                                                                          
029600                                                                          
029700 1000-INITIALIZATION.                                                     
029800                                                                          
029900     DISPLAY '****** STARTING SUKRP044 ******'.                           
030000                                                                          
030100     OPEN INPUT INPUT-FILE                                                
030200          OUTPUT REPORT-FILE.                                             
030300                                                                          
030400     EXEC SQL SET :PV-TIMESTAMP = CURRENT TIMESTAMP                       
030500     END-EXEC.                                                            
030600                                                                          
030700     ACCEPT PV-TODAYS-DATE                                                
030800       FROM DATE.                                                         
030900                                                                          
031000     ACCEPT PV-TODAYS-TIME                                                
031100       FROM TIME.                                                         
031200                                                                          
031300     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                          
031400                                PV-COMPARE-DATE-MM.                       
031500     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                            
031600                                PV-COMPARE-DATE-DD.                       
031700     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                           
031800                                PV-COMPARE-DATE-YY.                       
031900     IF PV-COMPARE-DATE-YY  >  80                                         
032000         MOVE  19            TO PV-COMPARE-DATE-CC                        
032100     ELSE                                                                 
032200         MOVE  20            TO PV-COMPARE-DATE-CC                        
032300     END-IF.                                                              
032400                                                                          
032500     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                          
032600     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                        
032700                                                                          
032800     MOVE PC-SUKRP044        TO DP132O-PROGRAM-NAME.                      
032900     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.                     
033000                                                                          
033100     MOVE ZERO                        TO PV-PAGE-COUNT.                   
033200                                                                          
033300     SET PS-NOT-END-OF-INPUT TO TRUE.                                     
033400     PERFORM 8000-READ-EXTRACT-FILE                                       
033500     MOVE PV-CURR-KEY                 TO PV-PREV-KEY                      
033600                                                                          
033700     IF PS-END-OF-INPUT                                                   
033800         ADD +1                  TO PV-PAGE-COUNT                         
033900         MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER                    
034000         WRITE REPORT-RECORD                                              
034100                      FROM DP132O-STANDRD-HEADER-132-COLS                 
034200                      AFTER ADVANCING PAGE                                
034300         WRITE REPORT-RECORD                                              
034400                      FROM HEADING-LINE-1                                 
034500                      AFTER ADVANCING 2 LINES                             
034600         WRITE REPORT-RECORD                                              
034700                      FROM HEADING-LINE-2                                 
034800                      AFTER ADVANCING 1 LINE                              
034900         WRITE REPORT-RECORD                                              
035000                      FROM NO-DATA-LINE                                   
035100                      AFTER ADVANCING 2 LINES                             
035200     ELSE                                                                 
035300         PERFORM 2200-PAGE-BREAK                                          
035400     END-IF.                                                              
035500/                                                                         
035600 2000-PROCESS-INPUT.                                                      
035700     IF PV-CURR-KEY NOT = PV-PREV-KEY                                     
035800         MOVE PV-CURR-KEY        TO PV-PREV-KEY                           
035900         PERFORM 2200-PAGE-BREAK                                          
036000         PERFORM 2100-PRINT-DETAIL-LINE                                   
036100     ELSE                                                                 
036200         IF PV-CURR-KEY-2 = PV-PREV-KEY-2                                 
036300             PERFORM 2100-PRINT-DETAIL-LINE                               
036400         ELSE                                                             
036500             WRITE REPORT-RECORD  FROM PV-BLANK-LINE                      
036600             ADD +1                   TO PV-LINE-COUNT                    
036700             PERFORM 2100-PRINT-DETAIL-LINE                               
036800             MOVE PV-CURR-KEY-2       TO PV-PREV-KEY-2                    
036900         END-IF                                                           
037000     END-IF.                                                              
037100                                                                          
037200     PERFORM 8000-READ-EXTRACT-FILE.                                      
037300                                                                          
037400 2100-PRINT-DETAIL-LINE.                                                  
037500                                                                          
037600     MOVE SU055-LOC-NBR            TO DL1-STR-NBR.                        
037700     MOVE SU055-ORGN-OPER-UNT-ID   TO DL1-OPER-UNT.                       
037800     MOVE SU055-LOC-NM             TO DL1-STORE-NM.                       
037900     MOVE SU055-SHIP-SCAC-CDE      TO DL1-SCAC.                           
038000     MOVE SU055-TRLR-ID            TO DL1-TRLR-ID.                        
038100     MOVE SU055-TRLR-SRL-NBR       TO DL1-TRLR-SRL-NBR.                   
038200                                                                          
038300     MOVE SU055-OTBND-STAT-TMST    TO PV-DATE-TIME.                       
038400     MOVE PV-DATE-TIME-CCYY        TO PV-DISPLAY-CCYY.                    
038500     MOVE PV-DATE-TIME-MM          TO PV-DISPLAY-MM.                      
038600     MOVE PV-DATE-TIME-DD          TO PV-DISPLAY-DD.                      
038700     MOVE PV-DATE-TIME-HH          TO PV-DISPLAY-HH.                      
038800     MOVE PV-DATE-TIME-MN          TO PV-DISPLAY-MN.                      
038900     MOVE PV-DISPLAY-DATE          TO DL1-DATE.                           
039000     MOVE PV-DISPLAY-TIME          TO DL1-TIME.                           
039100     MOVE PV-DISPLAY-DATE          TO DL1-DATE.                           
039200     MOVE PV-DISPLAY-TIME          TO DL1-TIME.                           
039300     MOVE SU055-PLND-INV-DTE       TO DL1-PLAN-INV-DT.                    
039400                                                                          
039500     PERFORM 7000-GET-TRLR-STATUS.                                        
039600                                                                          
039700     ADD +1 TO PV-LINE-COUNT.                                             
039800     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                                 
039900         PERFORM 2200-PAGE-BREAK                                          
040000     END-IF.                                                              
040100                                                                          
040200     WRITE REPORT-RECORD                                                  
040300       FROM DETAIL-LINE1                                                  
040400         AFTER ADVANCING 1 LINE.                                          
040500                                                                          
040600     ADD 1                            TO PV-DETAIL-COUNT.                 
040700                                                                          
040800 2200-PAGE-BREAK.                                                         
040900                                                                          
041000     ADD +1                  TO PV-PAGE-COUNT.                            
041100     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.                       
041200                                                                          
041300     WRITE REPORT-RECORD                                                  
041400       FROM DP132O-STANDRD-HEADER-132-COLS                                
041500         AFTER ADVANCING PAGE.                                            
041600                                                                          
041700     WRITE REPORT-RECORD                                                  
041800       FROM HEADING-LINE-1                                                
041900         AFTER ADVANCING 2 LINES.                                         
042000                                                                          
042100     WRITE REPORT-RECORD                                                  
042200       FROM HEADING-LINE-2                                                
042300         AFTER ADVANCING 1 LINE.                                          
042400                                                                          
042500                                                                          
042600     WRITE REPORT-RECORD                                                  
042700       FROM HEADING-LINE-4                                                
042800         AFTER ADVANCING 2 LINE.                                          
042900                                                                          
043000     WRITE REPORT-RECORD                                                  
043100       FROM HEADING-LINE-5                                                
043200         AFTER ADVANCING 1 LINE.                                          
043300                                                                          
043400     WRITE REPORT-RECORD                                                  
043500       FROM HEADING-LINE-6                                                
043600         AFTER ADVANCING 1 LINE.                                          
043700                                                                          
043800     MOVE +7                 TO PV-LINE-COUNT.                            
043900     MOVE PV-CURR-KEY        TO PV-PREV-KEY.                              
044000     MOVE PV-CURR-KEY-2      TO PV-PREV-KEY-2.                            
044100                                                                          
044200                                                                          
044300                                                                          
044400 7000-GET-TRLR-STATUS.                                                    
044500                                                                          
044600     EXEC SQL                                                             
044700          SELECT STAT_SHRT_DESC                                           
044800            INTO :SUOBSC-STAT-SHRT-DESC                                   
044900            FROM TSUOBSC                                                  
045000           WHERE TRIP_STAT_CDE  =  :SU055-TRIP-STAT-CDE                   
045100     END-EXEC.                                                            
045200                                                                          
045300     EVALUATE TRUE                                                        
045400         WHEN SQLCODE EQUAL ZERO                                          
045500              MOVE  SUOBSC-STAT-SHRT-DESC TO  DL1-TRLR-STATUS             
045600                                                                          
045700         WHEN OTHER                                                       
045800              MOVE  'UNKNOWN'             TO  DL1-TRLR-STATUS             
045900     END-EVALUATE.                                                        
046000                                                                          
046100                                                                          
046200 8000-READ-EXTRACT-FILE.                                                  
046300     READ INPUT-FILE                                                      
046400       INTO SU055-EXTRACT-RECORD                                          
046500         AT END                                                           
046600           SET PS-END-OF-INPUT TO TRUE                                    
046700         NOT AT END                                                       
046800             ADD 1                    TO PV-READ-COUNT                    
046900             MOVE SU055-ORGN-OPER-UNT-ID                                  
047000                                      TO PV-CURR-OPER                     
047100             MOVE SU055-PLND-INV-DTE  TO PV-CURR-PLND-INV-DTE             
047200     END-READ.                                                            
047300                                                                          
047400                                                                          
047500 9000-END.                                                                
047600                                                                          
047700     WRITE REPORT-RECORD                                                  
047800       FROM END-OF-REPORT-LINE                                            
047900         AFTER ADVANCING 2 LINES.                                         
048000                                                                          
048100     CLOSE INPUT-FILE                                                     
048200           REPORT-FILE.                                                   
048300                                                                          
048400     MOVE PV-READ-COUNT               TO PV-DISP-NBR                      
048500     DISPLAY 'RECORDS READ         = ' PV-DISP-NBR.                       
048600                                                                          
048700     MOVE PV-DETAIL-COUNT             TO PV-DISP-NBR                      
048800     DISPLAY 'DETAIL LINES PRINTED = ' PV-DISP-NBR.                       
048900/                                                                         
049000 Z999-SQL-ERROR.                                                          
049100     MOVE SQLCODE    TO SQLCODE2.                                         
049200     MOVE SQLERRD(3) TO SQLERRD3.                                         
049300     DISPLAY '** ABEND **       ** = SQLERROR'.                           
049400     DISPLAY '** PROGRAM        ** = SUKRP044'.                           
049500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                          
049600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                          
049700     DISPLAY '** SQLERRM        ** = ' SQLERRM.                           
049800     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                          
049900                                                                          
050000                                                                          
050100                                                                          
050200                                                                          
050300                                                                          
050400                                                                          
050500                                                                          
050600     COPY DPPD004.                                                        
050700                                                                          
050800     MOVE +4003 TO  ABEND-CODE.                                           
050900     CALL 'ILBOABN0' USING ABEND-CODE.                                    
051000                                                                          
