000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - ASSOCIATE/TRAILER LOGON SCREEN'.            00020000
000300*****   THIS PROGRAM HAS CHANGES TO TEST THE TRAILER SUMMARY      00030000
000400*****   PROGRAM(SUKCS574).  THESE WERE MADE TO THE PCKRF743       00040000
000500*****   PROGRAM COPIED FROM QA ON 10/1.    LARRY                  00050000
000600*****   USE F4 TO CALL THE SUMMARY PROGRAM                        00060000
000700                                                                  00070000
000800 PROGRAM-ID.             PCKRF743.                                00080000
000900 AUTHOR.                 DENNIS STEFFEN.                          00090000
001000 INSTALLATION.           KOHLS.                                   00100000
001100 DATE-WRITTEN.           SEPTEMBER 2001.                          00110000
001200 DATE-COMPILED.                                                   00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400 DATA DIVISION.                                                   00140000
001500                                                                  00150000
001600 WORKING-STORAGE SECTION.                                         00160000
001700                                                                  00170000
001800 01  PC-PROGRAM-CONSTANTS.                                        00180000
001900     05  PC-TRANID                    PIC X(04) VALUE 'E743'.     00190000
002000     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRF743'. 00200000
002100     05  PC-TRAILER-PROGRAM           PIC X(08) VALUE 'PCKCS714'. 00210000
002200     05  PC-SUMMARY-PROGRAM           PIC X(08) VALUE 'SUKCS574'. 00220000
002300     05  PC-DUMMY-TIMESTAMP           PIC X(26) VALUE             00230000
002400            '9999-09-09-09.09.09.999999'.                         00240000
002500     05  PC-DLX                       PIC X(03) VALUE 'DLX'.      00250000
002600     05  PC-DLSHPI                    PIC X(06) VALUE 'DLSHPI'.   00260000
002700     05  PC-Y                         PIC X(01) VALUE 'Y'.        00270000
002710     05  PC-N                         PIC X(01) VALUE 'N'.        00271002
002800                                                                  00280000
002900                                                                  00290000
003000* ERROR MESSAGES                                                 *00300000
003100     05  PC-UNRECOGNIZED-PF-KEY-MSG   PIC X(19) VALUE             00310000
003200                                           'UNRECOGNIZED PF KEY'. 00320000
003300     05  PC-ENTER-THROUGH-MENU-MSG    PIC X(19) VALUE             00330000
003400                                           'ENTER THROUGH MENU '. 00340000
003500     05  PC-TRANS-UNAVAILABLE-MSG     PIC X(19) VALUE             00350000
003600                                           'TRANS NOT AVAILABLE'. 00360000
003700                                                                  00370000
003800 01  PS-PROGRAM-SWITCHES.                                         00380000
003900     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00390000
004000         88  PS-ERRORS-YES                        VALUE 'Y'.      00400000
004100         88  PS-ERRORS-NO                         VALUE 'N'.      00410000
004200     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00420000
004300         88  PS-XCTL-E871                       VALUE 'E871'.     00430000
004400         88  PS-XCTL-E874                       VALUE 'E874'.     00440000
004500     05  PS-TCNTRID-SW                PIC X(01) VALUE 'N'.        00450000
004600         88  PS-TCNTRID-YES                       VALUE 'Y'.      00460000
004700         88  PS-TCNTRID-NO                        VALUE 'N'.      00470000
004800     05  PS-TCNDCDR-SW                PIC X(01) VALUE 'N'.        00480000
004900         88  PS-TCNDCDR-YES                       VALUE 'Y'.      00490000
005000         88  PS-TCNDCDR-NO                        VALUE 'N'.      00500000
005100     05  PS-ACTIVE-TRIP-SW            PIC X(01) VALUE 'N'.        00510000
005200         88  PS-ACTIVE-TRIP-EXISTS              VALUE 'Y'.        00520000
005300         88  PS-NO-ACTIVE-TRIP-EXISTS           VALUE 'N'.        00530000
005400     05  PS-TRLR-SUMMRY-SW            PIC S9(08) COMP             00540000
005500                                                VALUE 1.          00550000
005600         88  PS-REFRESH-SUMMRY-NO               VALUE 0.          00560000
005700         88  PS-REFRESH-SUMMRY-YES              VALUE 1.          00570000
005800                                                                  00580000
005900     05  PS-DO-SUMMRY-SW              PIC X(01) VALUE 'N'.        00590000
006000         88  PS-SUMMARY-YES                     VALUE 'Y'.        00600000
006100         88  PS-SUMMARY-NO                      VALUE 'N'.        00610000
006200     05  PS-DOOR-GROUP-FOUND-SW       PIC X(01)  VALUE 'N'.       00620000
006300         88  PS-DOOR-GROUP-FOUND-YES              VALUE 'Y'.      00630000
006400         88  PS-DOOR-GROUP-FOUND-NO               VALUE 'N'.      00640000
006410     05  PS-CREATE-MANUAL-ADD-SW      PIC X(01) VALUE 'N'.        00641012
006420         88  PS-CREATE-MAN-ADD-YES              VALUE 'Y'.        00642012
006430         88  PS-CREATE-MAN-ADD-NO               VALUE 'N'.        00643012
006500 01  PV-PROGRAM-VARIABLES.                                        00650000
006600     05  PV-CHAR-COUNT                PIC S9(03) COMP-3           00660000
006700                                                 VALUE ZERO.      00670000
006800     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00680000
006900                                                     COMP SYNC.   00690000
007000     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    00700000
007100     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00710000
007200                                                     COMP SYNC.   00720000
007300     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    00730000
007400                                                                  00740000
007500     05  PV-DISPLAY-DOOR-ID           PIC  X(04)  VALUE SPACE.    00750000
007600     05  PV-DISPLAY-OPER              PIC  9(04)  VALUE ZEROES.   00760000
007700     05  PV-DISPLAY-DEST              PIC  9(04)  VALUE ZEROES.   00770000
007800     05  PV-DISPLAY-SRL-NBR           PIC  9(09)  VALUE ZEROES.   00780000
007900     05  PV-DISPLAY-SCAC              PIC  X(04)  VALUE SPACES.   00790000
008000     05  PV-DISPLAY-TRLR-ID           PIC  X(12)  VALUE ZEROES.   00800000
008100     05  PV-DISPLAY-TRIP              PIC  9(09)  VALUE ZEROES.   00810000
008110     05  PV-DISPLAY-SEQ-NBR           PIC  9(09)  VALUE ZEROES.   00811016
008200     05  PV-ELAPSED-MINUTES           PIC S9(09)  COMP            00820000
008300                                                  VALUE ZEROES.   00830000
008400     05  PV-CURRENT-TIMESTAMP         PIC  X(26)  VALUE SPACES.   00840000
008500     05  PV-DOOR-NBR                  PIC  X(04)  VALUE SPACES.   00850000
008600     05  PV-ERROR-MESSAGE             PIC  X(45)  VALUE SPACES.   00860000
008700     05  PV-CICS-MSG-AREA2            PIC X(100)  VALUE SPACES.   00870000
008800     05  PV-DISPLAY-SQLCODE           PIC -9(03).                 00880000
008810     05  PV-USERID-MAN-ADD            PIC  X(08).                 00881012
008900                                                                  00890000
008910     05  PV-START-TMST.                                           00891002
008920         10 PV-START-TMST-DATE.                                   00892002
008930             15 PV-START-TMST-YR      PIC 9(04).                  00893002
008940             15 PV-DASH-1             PIC X.                      00894002
008950             15 PV-START-TMST-MO      PIC 9(02).                  00895002
008960             15 PV-DASH-2             PIC X.                      00896002
008970             15 PV-START-TMST-DA      PIC 9(02).                  00897002
008980             15 PV-DASH-3             PIC X.                      00898002
008990         10 PV-START-TMST-TIME.                                   00899002
008991             15 PV-START-TMST-HR      PIC 9(02) VALUE ZEROES.     00899102
008992             15 PV-DEC-1              PIC X     VALUE '.'.        00899202
008993             15 PV-START-TMST-MN      PIC 9(02) VALUE ZEROES.     00899302
008994             15 PV-DEC-2              PIC X     VALUE '.'.        00899402
008995             15 PV-START-TMST-SS      PIC 9(02) VALUE ZEROES.     00899502
008996             15 PV-DEC-3              PIC X     VALUE '.'.        00899602
008997         10 PV-MILL-SEC               PIC 9(06) VALUE ZEROES.     00899702
008998                                                                  00899802
009000 01  PV-LOG-MSG.                                                  00900000
009100     05  FILLER                       PIC X(12) VALUE             00910000
009200         ' E743 ERROR '.                                          00920000
009300     05  FILLER                       PIC X(06) VALUE             00930000
009400         'USER= '.                                                00940000
009500     05  PV-USER-ID                   PIC X(08) VALUE SPACES.     00950000
009600     05  FILLER                       PIC X(10) VALUE             00960000
009700         ' SQLCODE= '.                                            00970000
009800     05  PV-SQLCODE                   PIC -9(03).                 00980000
009900     05  FILLER                       PIC X(06) VALUE             00990000
010000         ' ERR= '.                                                01000000
010100     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01010000
010200     05  FILLER                       PIC X(07) VALUE             01020000
010300         ' DOOR= '.                                               01030000
010400     05  PV-DISPLAY-DOOR              PIC X(04) VALUE ZEROES.     01040000
010500/                                                                 01050000
010600 01  PV-EDITING-FIELDS.                                           01060000
010700     05  PV-SCREEN-USER               PIC X(08).                  01070000
010800     05  PV-SCREEN-DOOR               PIC X(09).                  01080000
010900     05  PV-SCREEN-SERIAL-NBR         PIC X(09).                  01090000
011000                                                                  01100000
011100/                                                                 01110000
011200 01  CA-COMMAREA.                                                 01120000
011300     COPY PCWS233.                                                01130000
011400     05  CA-PRIVATE-COMMAREA          PIC X(100).                 01140000
011500     05  CA-REDEFINED-COMMAREA REDEFINES CA-PRIVATE-COMMAREA.     01150000
011600         10  CA-CURR-USER-ID          PIC X(08).                  01160000
011700         10  CA-CURR-DOOR             PIC X(04).                  01170000
011800         10  CA-CURR-SERIAL-NBR       PIC 9(09).                  01180000
011900         10  CA-SUMMARY-STARTED       PIC X(01).                  01190000
012000         10  CA-SCREEN-DOOR           PIC X(09).                  01200000
012100/                                                                 01210000
012200*  MAP LAYOUT                                                     01220000
012300     COPY PCKM743.                                                01230000
012400                                                                  01240000
012500* HELP SCREEN COMMAREA                                            01250000
012600     COPY PCWS192.                                                01260000
012700* HELP SCREEN WORK AREA                                           01270000
012800     COPY PCWS188.                                                01280000
012900                                                                  01290000
013000     COPY PCWS047.                                                01300000
013100                                                                  01310000
013200     COPY DLWS011.                                                01320000
013300                                                                  01330000
013400     COPY DLWS016.                                                01340000
013500                                                                  01350000
013600     COPY XLWS067.                                                01360000
013601                                                                  01360103
013610     COPY XLWS072.                                                01361003
013700/                                                                 01370000
013800     COPY DPWS010I.                                               01380000
013900*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01390000
014000     COPY DPWS015.                                                01400000
014100                                                                  01410000
014200*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01420000
014300     COPY DFHAID.                                                 01430000
014400                                                                  01440000
014500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01450000
014600     COPY DPWS013.                                                01460000
014700                                                                  01470000
014800/                                                                 01480000
014900*    DC DOOR MASTER                                               01490000
015000     EXEC SQL                                                     01500000
015100         INCLUDE TCNDCDR                                          01510000
015200     END-EXEC.                                                    01520000
015300                                                                  01530000
015400*    DC DOOR TYPES                                                01540000
015500     EXEC SQL                                                     01550000
015600         INCLUDE TCNDRTY                                          01560000
015700     END-EXEC.                                                    01570000
015800                                                                  01580000
015900*    DC DOOR/STORE CONNECTION                                     01590000
016000     EXEC SQL                                                     01600000
016100         INCLUDE TCNDRST                                          01610000
016200     END-EXEC.                                                    01620000
016300                                                                  01630000
016400*    TRAILER ID MASTER                                            01640000
016500     EXEC SQL                                                     01650000
016600         INCLUDE TCNTRID                                          01660000
016700     END-EXEC.                                                    01670000
016800                                                                  01680000
016900*    OUTBOUND TRAILER TRIP                                        01690000
017000     EXEC SQL                                                     01700000
017100         INCLUDE TSUOBTR                                          01710000
017200     END-EXEC.                                                    01720000
017300                                                                  01730000
017400*    OUTBOUND TRAILER TRIP STATUS                                 01740000
017500     EXEC SQL                                                     01750000
017600         INCLUDE TSUOBTS                                          01760000
017700     END-EXEC.                                                    01770000
017800                                                                  01780000
017900*    OUTBOUND TRAILER TRIP STATUS CODES                           01790000
018000     EXEC SQL                                                     01800000
018100         INCLUDE TSUOBSC                                          01810000
018200     END-EXEC.                                                    01820000
018300*                                                                 01830000
018400*    USER-TRAILER AUDIT                                           01840000
018500*    SUT_TRIP_WRKR_AUD                                            01850000
018600     EXEC SQL                                                     01860000
018700         INCLUDE SUT00006                                         01870000
018800     END-EXEC.                                                    01880000
018900                                                                  01890000
019000*    TRIP SUMMARY                                                 01900000
019100*    SUT_TRIP_SUM                                                 01910000
019200     EXEC SQL                                                     01920000
019300         INCLUDE SUT00007                                         01930000
019400     END-EXEC.                                                    01940000
019500                                                                  01950000
019600*    KOHLS TO RETEK PROCESSING PARAMETERS                         01960000
019700     EXEC SQL                                                     01970000
019800         INCLUDE TKRPRPM                                          01980000
019900     END-EXEC.                                                    01990000
020000                                                                  02000000
020100*    DOOR GROUP TEMPLATE                                          02010000
020200     EXEC SQL                                                     02020000
020300         INCLUDE DLT00000                                         02030000
020400     END-EXEC.                                                    02040000
020500                                                                  02050000
020600*    DOOR GROUP                                                   02060000
020700     EXEC SQL                                                     02070000
020800         INCLUDE DLT00001                                         02080000
020900     END-EXEC.                                                    02090000
021000                                                                  02100001
021010     EXEC SQL                                                     02101002
021020         INCLUDE DLT00003                                         02102002
021030     END-EXEC.                                                    02103002
021040                                                                  02104002
021050     EXEC SQL                                                     02105007
021060         INCLUDE DLT00004                                         02106007
021070     END-EXEC.                                                    02107007
021080                                                                  02108007
021100     EXEC SQL                                                     02110000
021200         INCLUDE SQLCA                                            02120000
021300     END-EXEC.                                                    02130000
021400                                                                  02140000
021500 LINKAGE SECTION.                                                 02150000
021600 01  DFHCOMMAREA.                                                 02160000
021700     05  FILLER                         OCCURS  1 TO 4072 TIMES   02170000
021800                                      DEPENDING ON EIBCALEN.      02180000
021900         10  FILLER                   PIC X.                      02190000
022000/                                                                 02200000
022100 PROCEDURE DIVISION.                                              02210000
022200 0000-PROGRAM-MAINLINE.                                           02220000
022300                                                                  02230000
022400     INITIALIZE CA-COMMAREA                                       02240000
022500     MOVE DFHCOMMAREA                 TO CA-COMMAREA              02250000
022600                                                                  02260000
022700     EVALUATE TRUE                                                02270000
022800         WHEN EIBCALEN = ZERO                                     02280000
022900             MOVE PC-ENTER-THROUGH-MENU-MSG                       02290000
023000                                      TO PV-MESSAGE-AREA          02300000
023100             PERFORM 8110-RETURN                                  02310000
023200                                                                  02320000
023300         WHEN EIBTRNID = 'Z278'                                   02330000
023400*            RETURNING FROM F1 HELP INFO SCREEN                   02340000
023500             MOVE DFHCOMMAREA         TO PC192-COMMAREA           02350000
023600             MOVE PC192-HOST-SAVE-AREA                            02360000
023700                                      TO CA-COMMAREA              02370000
023800             SET PC233-PROCESS-SCREEN TO TRUE                     02380000
023900             MOVE PC192-HOST-SAVE-MAP TO PC743AO                  02390000
024000             MOVE -1                  TO ADOORL                   02400000
024100             PERFORM 8000-SEND-MAP                                02410000
024200             PERFORM 8100-RETURN-TRANID                           02420000
024300                                                                  02430000
024400         WHEN PC233-INITIALIZE-SCREEN                             02440000
024500         WHEN EIBAID = DFHCLEAR                                   02450000
024600             PERFORM 1000-INITIALIZE                              02460000
024700             PERFORM 8000-SEND-MAP                                02470000
024800             PERFORM 8100-RETURN-TRANID                           02480000
024900                                                                  02490000
025000         WHEN EIBAID = DFHPF3                                     02500000
025100             IF CA-SUMMARY-STARTED = 'Y'                          02510000
025200                 SET PS-REFRESH-SUMMRY-NO     TO TRUE             02520000
025300             ELSE                                                 02530000
025400                 PERFORM 0001-CHECK-TRIP-SUMMRY-AGE               02540000
025500             END-IF                                               02550000
025600             IF PS-REFRESH-SUMMRY-YES AND                         02560000
025700                PC233-TRIP-ID > 0                                 02570000
025800                 PERFORM 8060-START                               02580000
025900             END-IF                                               02590000
026000             MOVE PC233-LAST-PROGRAM  TO PV-TRANSFER-PROGRAM      02600000
026100             PERFORM 8200-XCTL                                    02610000
026200                                                                  02620000
026300         WHEN EIBAID = DFHPF2                                     02630000
026400*            UPDATE DATABASE                                      02640000
026500             PERFORM 8020-RECEIVE-MAP                             02650000
026600             PERFORM 2100-EDIT-INPUT                              02660000
026700                                                                  02670000
026800             IF PS-ERRORS-NO                                      02680000
026900                 PERFORM 2000-PROCESS-SCREEN-FIELDS               02690000
027000             END-IF                                               02700000
027100                                                                  02710000
027200             IF CA-SUMMARY-STARTED = 'Y'                          02720000
027300                 SET PS-REFRESH-SUMMRY-NO     TO TRUE             02730000
027400             ELSE                                                 02740000
027500                 PERFORM 0001-CHECK-TRIP-SUMMRY-AGE               02750000
027600             END-IF                                               02760000
027700             IF PS-REFRESH-SUMMRY-YES AND                         02770000
027800                PC233-TRIP-ID > 0                                 02780000
027900                 PERFORM 8060-START                               02790000
028000             END-IF                                               02800000
028100                                                                  02810000
028200             IF PS-ERRORS-NO                                      02820000
028300                 IF PS-XCTL-E871                                  02830000
028400                     PERFORM 8210-XCTL-ERROR-SCREEN               02840000
028500                 ELSE                                             02850000
028600                     PERFORM 8000-SEND-MAP                        02860000
028700                     PERFORM 8100-RETURN-TRANID                   02870000
028800                 END-IF                                           02880000
028900             ELSE                                                 02890000
029000                 PERFORM 8000-SEND-MAP                            02900000
029100                 PERFORM 8100-RETURN-TRANID                       02910000
029200             END-IF                                               02920000
029300                                                                  02930000
029400         WHEN EIBAID = DFHPF4                                     02940000
029500*            LINK TO SUKCS574(SUMMARY PROGRAM)                    02950000
029600             PERFORM 8020-RECEIVE-MAP                             02960000
029700             PERFORM 2100-EDIT-INPUT                              02970000
029800                                                                  02980000
029900             IF PS-ERRORS-NO AND                                  02990000
030000                PC233-TRIP-ID > 0                                 03000000
030100                 PERFORM 8060-START                               03010000
030200             END-IF                                               03020000
030300             MOVE -1              TO ADOORL                       03030000
030400             PERFORM 8000-SEND-MAP                                03040000
030500             PERFORM 8100-RETURN-TRANID                           03050000
030600                                                                  03060000
030700         WHEN EIBAID = DFHENTER                                   03070000
030800*            EDIT ONLY                                            03080000
030900             PERFORM 8020-RECEIVE-MAP                             03090000
031000             PERFORM 2100-EDIT-INPUT                              03100000
031100                                                                  03110000
031200             IF PS-ERRORS-YES                                     03120000
031300                 IF PS-XCTL-E871                                  03130000
031400                     PERFORM 8210-XCTL-ERROR-SCREEN               03140000
031500                 ELSE                                             03150000
031600                     PERFORM 8000-SEND-MAP                        03160000
031700                     PERFORM 8100-RETURN-TRANID                   03170000
031800                 END-IF                                           03180000
031900             ELSE                                                 03190000
032000                 IF CA-SUMMARY-STARTED = 'Y'                      03200000
032100                     SET PS-REFRESH-SUMMRY-NO     TO TRUE         03210000
032200                 ELSE                                             03220000
032300                     PERFORM 0001-CHECK-TRIP-SUMMRY-AGE           03230000
032400                 END-IF                                           03240000
032500                 IF PS-REFRESH-SUMMRY-YES AND                     03250000
032600                    PC233-TRIP-ID > 0                             03260000
032700                     PERFORM 8060-START                           03270000
032800                 END-IF                                           03280000
032900                 MOVE -1              TO ADOORL                   03290000
033000                 PERFORM 8000-SEND-MAP                            03300000
033100                 PERFORM 8100-RETURN-TRANID                       03310000
033200             END-IF                                               03320000
033300                                                                  03330000
033400         WHEN EIBAID = DFHPF1                                     03340000
033500             PERFORM 8020-RECEIVE-MAP                             03350000
033600             MOVE PC743AO             TO PC192-HOST-SAVE-MAP      03360000
033700             PERFORM 1200-HELP-SCREEN                             03370000
033800                                                                  03380000
033900         WHEN OTHER                                               03390000
034000             PERFORM 8020-RECEIVE-MAP                             03400000
034100             MOVE -1                  TO ADOORL                   03410000
034200             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      03420000
034300                                      TO AMSGLNO                  03430000
034400             PERFORM 8000-SEND-MAP                                03440000
034500             PERFORM 8100-RETURN-TRANID                           03450000
034600     END-EVALUATE.                                                03460000
034700                                                                  03470000
034800     GOBACK.                                                      03480000
034900                                                                  03490000
035000 0001-CHECK-TRIP-SUMMRY-AGE.                                      03500000
035100*    GET THE VALUE OF PV-ELASED MINUTES FROM THE PARM TABLE       03510000
035200     PERFORM 7060-SELECT-TKRPRPM.                                 03520000
035300                                                                  03530000
035400*    IF NO ROW IS FOUND ON THE PARM TABLE WE DO NOT WANT TO       03540000
035500*    RESUMMARIZE THE TRAILER.  IT WOULD BE POINTLESS TO           03550000
035600*    CHECK FOR THE LAST SUMMARY IF THE AUTOMATIC FUNCTION WAS     03560000
035700*    INACTIVATED.                                                 03570000
035800                                                                  03580000
035900     IF PS-SUMMARY-YES                                            03590000
036000         PERFORM 7070-FIND-LAST-SUMMARY                           03600000
036100     ELSE                                                         03610000
036200         SET PS-REFRESH-SUMMRY-NO     TO TRUE                     03620000
036300     END-IF.                                                      03630000
036400                                                                  03640000
036500                                                                  03650000
036600 1000-INITIALIZE.                                                 03660000
036700                                                                  03670000
036800     SET PC233-PROCESS-SCREEN         TO TRUE                     03680000
036900     MOVE SPACES                      TO AMSGLNO                  03690000
037000     MOVE PC233-USER-ID               TO AUSERO                   03700000
037100*    MOVE DP015-ASK-NOR-MDT           TO AQTYA                    03710000
037200     MOVE -1                          TO ADOORL                   03720000
037300                                                                  03730000
037400     INITIALIZE CA-REDEFINED-COMMAREA                             03740000
037500                                                                  03750000
037600     MOVE PC-TRANID                   TO PC233-TRAN-ID.           03760000
037700                                                                  03770000
037800 1200-HELP-SCREEN.                                                03780000
037900     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03790000
038000     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       03800000
038100     COPY PCPD188.                                                03810000
038200     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03820000
038300     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     03830000
038400     PERFORM 8220-XCTL-TO-HELP.                                   03840000
038500                                                                  03850000
038600/                                                                 03860000
038700 2000-PROCESS-SCREEN-FIELDS.                                      03870000
038800*LMM                                                              03880000
038900     MOVE PV-SCREEN-USER TO PC233-USER-ID.                        03890000
039000     PERFORM 7400-INSERT-WRKR-AUD.                                03900000
039100                                                                  03910000
039200     PERFORM 3000-SELECT-TKRPRPM-DLSHPI.                          03920000
039300                                                                  03930000
039400     IF PC233-P4-INTERFACE-YES                                    03940000
039500**??    IF SUOBTS-DOOR-ID NOT = PC233-P4-DOOR-ID                  03950000
039600           PERFORM 3200-DETERMINE-DOOR-GROUP                      03960000
039700                                                                  03970000
039800**??       IF PS-DOOR-GROUP-FOUND-YES                             03980000
039900              IF DLT00001-DOOR-GP-NBR =                           03990000
040000                                       PC233-P4-DOOR-GP-NBR       04000000
040100                 MOVE SUOBTS-DOOR-ID TO PC233-P4-DOOR-ID          04010000
040200              ELSE                                                04020000
040300**??             PERFORM 3400-CALL-DLKCS410                       04030000
040400                 MOVE PC233-DOOR-ID TO PC233-P4-DOOR-ID           04040000
040500                 MOVE DLT00001-DOOR-GP-NBR TO                     04050000
040600                                    PC233-P4-DOOR-GP-NBR          04060000
040700              END-IF                                              04070000
040800              PERFORM 3400-CALL-DLKCS410                          04080000
040801*GB 7/01/15                                                       04080108
040802              IF DL016-SUCCESSFUL                                 04080202
040810                 PERFORM 3500-CREATE-ASGMNT-EVENT                 04081002
040820              END-IF                                              04082002
040821              IF DL016-SUCCESSFUL                                 04082112
040822                 PERFORM 3560-SEL-TEM-ASSGMT-USER                 04082212
040823                 IF PS-CREATE-MAN-ADD-YES                         04082312
040824                    PERFORM 3500-CREATE-ASGMNT-EVENT              04082412
040825                 END-IF                                           04082512
040826              END-IF                                              04082612
040830*GB 7/01/15                                                       04083008
040900**??       END-IF                                                 04090000
041000**??    END-IF                                                    04100000
041100     END-IF.                                                      04110000
041200                                                                  04120000
041300     INITIALIZE PC047-COMMAREA.                                   04130000
041400     SET PC047-BOTH-TOTAL             TO TRUE                     04140000
041500     MOVE PC233-TRIP-ID               TO PC047-OTBND-TRIP-ID.     04150000
041600     MOVE PC233-DOOR-TYPE-CDE         TO PC047-DOOR-TYPE-CDE.     04160000
041700     MOVE PC233-STR-NBR               TO PC047-DEST-OPER-UNT-ID.  04170000
041800     MOVE PC233-OPER-UNT-ID           TO PC047-OPER-UNT-ID.       04180000
041900                                                                  04190000
042000     PERFORM 8050-LINK.                                           04200000
042100     IF PC047-SUCCESSFUL                                          04210000
042200         MOVE PC233-STR-NBR           TO PC233-ERROR-STR-NBR      04220000
042300         MOVE PC047-TOTAL-CTN-COUNT   TO PC233-TOT-CARTONS        04230000
042400         ADD PC047-MISDIRECT-COUNT PC047-NO-DATA-COUNT            04240000
042500                    GIVING PC233-TOT-ERROR-CARTONS                04250000
042600         SET PS-XCTL-E871             TO TRUE                     04260000
042700         MOVE 37                      TO PC233-PGM-MSG-NBR        04270000
042800     ELSE                                                         04280000
042900         MOVE 1                       TO PV-ERROR-NBR             04290000
043000                                         PC233-ERROR-NBR          04300000
043100         PERFORM 9903-WRITE-CICS-LOG                              04310000
043200         MOVE '2000-PROCESS-SCREEN-FIELDS'                        04320000
043300                                      TO PC233-PARAGRAPH          04330000
043400         MOVE 'PCKRF743 - CALL TRAILER SUBPROGRAM'                04340000
043500                                      TO PC233-MESSAGE-TEXT(1)    04350000
043600         MOVE SQLCA                   TO PC233-SQLCA              04360000
043700         SET PC233-ABEND              TO TRUE                     04370000
043800         MOVE 99                      TO PC233-PGM-MSG-NBR        04380000
043900         PERFORM 8210-XCTL-ERROR-SCREEN                           04390000
044000     END-IF.                                                      04400000
044100/                                                                 04410000
044200 2100-EDIT-INPUT.                                                 04420000
044300                                                                  04430000
044400     SET PS-ERRORS-NO                 TO TRUE                     04440000
044500     MOVE SPACES                      TO AMSGLNO                  04450000
044600     INITIALIZE CA-CURR-DOOR                                      04460000
044700                CA-CURR-SERIAL-NBR                                04470000
044800                CA-CURR-USER-ID.                                  04480000
044900                                                                  04490000
045000     IF ADOORA = DP015-ERASE-EOF                                  04500000
045100         MOVE SPACES                  TO PV-SCREEN-DOOR           04510000
045200     ELSE                                                         04520000
045300         MOVE ADOORI                  TO PV-SCREEN-DOOR           04530000
045400     END-IF                                                       04540000
045500                                                                  04550000
045600     IF AUSERA = DP015-ERASE-EOF                                  04560000
045700         MOVE SPACES                  TO PV-SCREEN-USER           04570000
045800     ELSE                                                         04580000
045900         MOVE AUSERI                  TO PV-SCREEN-USER           04590000
046000     END-IF                                                       04600000
046100                                                                  04610000
046200     IF CA-SCREEN-DOOR NOT = PV-SCREEN-DOOR                       04620000
046300         INITIALIZE CA-SUMMARY-STARTED                            04630000
046400     END-IF.                                                      04640000
046500                                                                  04650000
046600     IF PV-SCREEN-USER = SPACES                                   04660000
046700         SET PS-ERRORS-YES            TO TRUE                     04670000
046800         MOVE -1                      TO AUSERL                   04680000
046900         MOVE 'USER ID REQUIRED   '   TO AMSGLNO                  04690000
047000     END-IF                                                       04700000
047100                                                                  04710000
047200     IF PV-SCREEN-DOOR = SPACES                                   04720000
047300         SET PS-ERRORS-YES            TO TRUE                     04730000
047400         MOVE -1                      TO ADOORL                   04740000
047500         MOVE 'DOOR/TRLR REQUIRED '   TO AMSGLNO                  04750000
047600     END-IF                                                       04760000
047700                                                                  04770000
047800     IF PS-ERRORS-NO                                              04780000
047900         PERFORM 7015-CALL-XLKUT067                               04790000
048000         IF XL067-USER-NOT-FOUND                                  04800000
048100             SET PS-ERRORS-YES    TO TRUE                         04810000
048200             MOVE -1              TO AUSERL                       04820000
048300             MOVE 'USER ID NOT FOUND  '                           04830000
048400                                      TO AMSGLNO                  04840000
048500         END-IF                                                   04850000
048600     END-IF                                                       04860000
048700                                                                  04870000
048800****************************************************************  04880000
048900*    FOLLOWING LOGIC CHECKS IF A TRAILER SERIAL NUMBER OR DOOR *  04890000
049000*    WAS ENTERED AND VALIDATES IT.                             *  04900000
049100*                                                              *  04910000
049200****************************************************************  04920000
049300                                                                  04930000
049400     IF PS-ERRORS-NO                                              04940000
049500         MOVE PV-SCREEN-DOOR          TO CA-SCREEN-DOOR           04950000
049600         INSPECT PV-SCREEN-DOOR                                   04960000
049700             TALLYING PV-CHAR-COUNT FOR CHARACTERS                04970000
049800             BEFORE INITIAL SPACE                                 04980000
049900                                                                  04990000
050000         EVALUATE TRUE                                            05000000
050100             WHEN PV-CHAR-COUNT = 4                               05010000
050200                 MOVE PV-SCREEN-DOOR (1:4) TO CA-CURR-DOOR        05020000
050300                 MOVE CA-CURR-DOOR TO PC233-DOOR-ID               05030000
050400                                      PC233-ERROR-DOOR-NBR        05040000
050500                 PERFORM 2130-EDIT-DOOR                           05050000
050600                                                                  05060000
050700                 IF PS-ERRORS-NO                                  05070000
050800                     PERFORM 7030-CHECK-OPEN-TRAILERS             05080000
050900                 END-IF                                           05090000
051000                                                                  05100000
051100             WHEN PV-CHAR-COUNT = 3                               05110000
051200                 MOVE PV-SCREEN-DOOR (1:3) TO CA-CURR-DOOR        05120000
051300                 MOVE CA-CURR-DOOR TO PC233-DOOR-ID               05130000
051400                                      PC233-ERROR-DOOR-NBR        05140000
051500                 PERFORM 2130-EDIT-DOOR                           05150000
051600                                                                  05160000
051700                 IF PS-ERRORS-NO                                  05170000
051800                     PERFORM 7030-CHECK-OPEN-TRAILERS             05180000
051900                 END-IF                                           05190000
052000                                                                  05200000
052100             WHEN PV-CHAR-COUNT = 9                               05210000
052200                 MOVE PV-SCREEN-DOOR (1:9)                        05220000
052300                                      TO CA-CURR-SERIAL-NBR       05230000
052400                 PERFORM 2120-EDIT-SERIAL-NBR                     05240000
052500                                                                  05250000
052600             WHEN OTHER                                           05260000
052700                 SET PS-ERRORS-YES    TO TRUE                     05270000
052800                 MOVE -1              TO ADOORL                   05280000
052900                 MOVE 'INVALID ENTRY      '                       05290000
053000                                      TO AMSGLNO                  05300000
053100     END-EVALUATE.                                                05310000
053200                                                                  05320000
053300**?? IF PS-ERRORS-NO                                              05330000
053400**??     IF CA-CURR-SERIAL-NBR > ZERO                             05340000
053500**??         PERFORM 2120-EDIT-SERIAL-NBR                         05350000
053600**??     ELSE                                                     05360000
053700**??         SET PS-ERRORS-YES            TO TRUE                 05370000
053800**??                                                              05380000
053900**??         MOVE ' TRAILER NOT FOUND '   TO AMSGLNO              05390000
054000**??     END-IF                                                   05400000
054100                                                                  05410000
054200**??     IF PS-ERRORS-NO                                          05420000
054300**??         IF CA-CURR-DOOR > SPACES                             05430000
054400**??             MOVE CA-CURR-DOOR        TO PC233-DOOR-ID        05440000
054500**??                                         PC233-ERROR-DOOR-NBR 05450000
054600**??             PERFORM 2130-EDIT-DOOR                           05460000
054700**??             IF PS-ERRORS-NO                                  05470000
054800**??                 PERFORM 7030-CHECK-OPEN-TRAILERS             05480000
054900**??             END-IF                                           05490000
055000**??         END-IF                                               05500000
055100**??     END-IF                                                   05510000
055200**?? END-IF.                                                      05520000
055300                                                                  05530000
055400/                                                                 05540000
055500 2120-EDIT-SERIAL-NBR.                                            05550000
055600* IS THIS SERIAL NBR CONNECTED TO A SCAC/TRAILER AT ALL?          05560000
055700                                                                  05570000
055800     MOVE CA-CURR-SERIAL-NBR         TO CNTRID-TRLR-SRL-NBR       05580000
055900     PERFORM 7000-SELECT-TCNTRID                                  05590000
056000     IF PS-TCNTRID-NO                                             05600000
056100         SET PS-ERRORS-YES            TO TRUE                     05610000
056200                                                                  05620000
056300         MOVE ' TRAILER NOT FOUND '   TO AMSGLNO                  05630000
056400     ELSE                                                         05640000
056500         MOVE CNTRID-SCAC-CDE         TO PC233-OWNER-SCAC-ID      05650000
056600                                         PC233-ERROR-SCAC-ID      05660000
056700         MOVE CNTRID-TRLR-ID          TO PC233-TRAILER            05670000
056800                                         PC233-ERROR-TRLR-ID      05680000
056900         MOVE CNTRID-TRLR-SRL-NBR     TO PC233-SERIAL-NBR         05690000
057000                                         PC233-ERROR-SRL-NBR      05700000
057100         PERFORM 2205-GET-TRAILER-INFO                            05710000
057200         PERFORM 2240-IS-TRAILER-CLOSED                           05720000
057300     END-IF.                                                      05730000
057400                                                                  05740000
057500 2130-EDIT-DOOR.                                                  05750000
057600* IS THIS A SHIPPING OR SHUTTLE DOOR IN THE CURRENT LOCATION?     05760000
057700     PERFORM 7010-SELECT-TCNDCDR                                  05770000
057800                                                                  05780000
057900     IF PS-TCNDCDR-YES                                            05790000
058000         CONTINUE                                                 05800000
058100     ELSE                                                         05810000
058200         SET PS-ERRORS-YES            TO TRUE                     05820000
058300         MOVE -1                      TO ADOORL                   05830000
058400         MOVE ' DOOR NOT DEFINED  '   TO AMSGLNO                  05840000
058500     END-IF.                                                      05850000
058600                                                                  05860000
058700                                                                  05870000
058800 2205-GET-TRAILER-INFO.                                           05880000
058900     PERFORM 7050-SELECT-TRAILER-STATUS.                          05890000
059000     MOVE SUOBTS-OTBND-TRIP-ID        TO PC233-TRIP-ID            05900000
059100                                         PC233-ERROR-TRIP-ID      05910000
059200                                         ATRIPO                   05920000
059300     MOVE CNTRID-SCAC-CDE             TO PC233-OWNER-SCAC-ID      05930000
059400                                         PC233-ERROR-SCAC-ID      05940000
059500     MOVE CNTRID-TRLR-ID              TO PC233-ERROR-TRLR-ID.     05950000
059600     MOVE SUOBTR-DEST-OPER-UNT-ID     TO PC233-STR-NBR.           05960000
059700     MOVE CNDCDR-DOOR-TYP-CDE         TO PC047-DOOR-TYPE-CDE      05970000
059800                                         PC233-DOOR-TYPE-CDE.     05980000
059900                                                                  05990000
060000/                                                                 06000000
060100 2240-IS-TRAILER-CLOSED.                                          06010000
060200                                                                  06020000
060300* SWITCH IS SET IN PARA 2205-GET-TRAILER-INFO                     06030000
060400     IF PS-ACTIVE-TRIP-EXISTS                                     06040000
060500         IF SUOBTS-TRIP-STAT-CDE = 'DO'                           06050000
060600             CONTINUE                                             06060000
060700         ELSE                                                     06070000
060800             SET PS-ERRORS-YES        TO TRUE                     06080000
060900             MOVE -1                  TO ADOORL                   06090000
061000                                                                  06100000
061100*            MOVE SUOBTS-OTBND-TRIP-ID                            06110000
061200*                                     TO PC233-TRIP-ID            06120000
061300*                                        PC233-ERROR-TRIP-ID      06130000
061400             MOVE ' TRLR MUST BE OPEN '                           06140000
061500                                      TO AMSGLNO                  06150000
061600         END-IF                                                   06160000
061700     ELSE                                                         06170000
061800         SET PS-ERRORS-YES            TO TRUE                     06180000
061900         MOVE -1                      TO ADOORL                   06190000
062000         MOVE ' NO ACTIVE TRIP    '   TO AMSGLNO                  06200000
062100     END-IF.                                                      06210000
062200                                                                  06220000
062300****************************************************************  06230000
062400*    DETERMINES WHETHER INTERFACING OF MANAGING OF ASSIGNMENTS *  06240000
062500*    NEEDS TO BE DONE.                                         *  06250000
062600****************************************************************  06260000
062700 3000-SELECT-TKRPRPM-DLSHPI.                                      06270000
062800                                                                  06280000
062900     EXEC SQL                                                     06290000
063000       SELECT                                                     06300000
063100               FUNC_TXT                                           06310000
063200         INTO                                                     06320000
063300              :KRPRPM-FUNC-TXT                                    06330000
063400         FROM  TKRPRPM                                            06340000
063500        WHERE  LOC_ID            = :PC233-OPER-UNT-ID             06350000
063600          AND  INTFC_SYS_CDE     = :PC-DLX                        06360000
063700          AND  SYS_PRC_FUNC_CDE  = :PC-DLSHPI                     06370000
063800                                                                  06380000
063900     END-EXEC.                                                    06390000
064000                                                                  06400000
064100     EVALUATE TRUE                                                06410000
064200         WHEN SQLCODE = ZERO                                      06420000
064300              IF KRPRPM-FUNC-TXT = 'Y'                            06430000
064400                 SET PC233-P4-INTERFACE-YES TO TRUE               06440000
064500              ELSE                                                06450000
064600                 SET PC233-P4-INTERFACE-NO  TO TRUE               06460000
064700              END-IF                                              06470000
064800         WHEN SQLCODE = +100                                      06480000
064900              SET PC233-P4-INTERFACE-NO  TO TRUE                  06490000
065000         WHEN SQLCODE = -904                                      06500000
065100         WHEN SQLCODE = -913                                      06510000
065200         WHEN SQLCODE = -911                                      06520000
065300              MOVE 16                  TO PV-ERROR-NBR            06530000
065400              PERFORM 9903-WRITE-CICS-LOG                         06540000
065500              PERFORM 9000-SOFT-ABORT                             06550000
065600         WHEN SQLWARN0 NOT = SPACES                               06560000
065700         WHEN SQLCODE NOT EQUAL ZERO                              06570000
065800              SET PC233-P4-INTERFACE-NO  TO TRUE                  06580000
065900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      06590000
066000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   06600000
066100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      06610000
066200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   06620000
066300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      06630000
066400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      06640000
066500              STRING  ' OPER-'               DELIMITED BY SIZE    06650000
066600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    06660000
066700                      '  DOOR-'              DELIMITED BY SIZE    06670000
066800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    06680000
066900                      '  DEST-'              DELIMITED BY SIZE    06690000
067000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    06700000
067100                                        INTO                      06710000
067200                                        PC233-MESSAGE-TEXT(2)     06720000
067300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    06730000
067400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    06740000
067500                      '   SCAC-'             DELIMITED BY SIZE    06750000
067600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    06760000
067700                      '   TRIP-'             DELIMITED BY SIZE    06770000
067800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    06780000
067900                                        INTO                      06790000
068000                                        PC233-MESSAGE-TEXT(3)     06800000
068100                                                                  06810000
068200             MOVE 17                  TO PV-ERROR-NBR             06820000
068300                                         PC233-ERROR-NBR          06830000
068400             PERFORM 9903-WRITE-CICS-LOG                          06840000
068500             MOVE '3000-SELECT-TKRPRPM-DLSHPI'                    06850000
068600                                      TO PC233-PARAGRAPH          06860000
068700             MOVE 'PCKRF743 - LOOKUP LABOR INTERFACING'           06870000
068800                                      TO PC233-MESSAGE-TEXT(1)    06880000
068900             MOVE SQLCA               TO PC233-SQLCA              06890000
069000             MOVE 'TKRPRPM'           TO PC233-DB2-TABLE-NAME(1)  06900000
069100             SET PC233-ABEND          TO TRUE                     06910000
069200             MOVE 99                  TO PC233-PGM-MSG-NBR        06920000
069300             PERFORM 8210-XCTL-ERROR-SCREEN                       06930000
069400     END-EVALUATE.                                                06940000
069500                                                                  06950000
069600****************************************************************  06960000
069700*                                                              *  06970000
069800*                                                              *  06980000
069900****************************************************************  06990000
070000 3200-DETERMINE-DOOR-GROUP.                                       07000000
070100                                                                  07010000
070200     EXEC SQL                                                     07020000
070300       SELECT                                                     07030000
070400               GP.DOOR_GP_NBR                                     07040000
070500         INTO                                                     07050000
070600              :DLT00001-DOOR-GP-NBR                               07060000
070700         FROM  DLT_DOOR_GP      GP                                07070000
070800              ,DLT_DOOR_GP_TMPL TMPL                              07080000
070900                                                                  07090000
071000        WHERE  TMPL.DC_NBR        = :PC233-OPER-UNT-ID            07100000
071100          AND  GP.DOOR_ID         = :SUOBTS-DOOR-ID               07110000
071200          AND  TMPL.ACTV_IND      = :PC-Y                         07120000
071300          AND  GP.DOOR_GP_TMPL_ID = TMPL.DOOR_GP_TMPL_ID          07130000
071400                                                                  07140000
071500     END-EXEC.                                                    07150000
071600                                                                  07160000
071700     EVALUATE TRUE                                                07170000
071800         WHEN SQLCODE = ZERO                                      07180000
071900              SET PS-DOOR-GROUP-FOUND-YES TO TRUE                 07190000
072000**??     WHEN SQLCODE = +100                                      07200000
072100**??          SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 07210000
072200         WHEN SQLCODE = -904                                      07220000
072300         WHEN SQLCODE = -913                                      07230000
072400         WHEN SQLCODE = -911                                      07240000
072500              MOVE 16                  TO PV-ERROR-NBR            07250000
072600              PERFORM 9903-WRITE-CICS-LOG                         07260000
072700              PERFORM 9000-SOFT-ABORT                             07270000
072800         WHEN SQLWARN0 NOT = SPACES                               07280000
072900         WHEN SQLCODE NOT EQUAL ZERO                              07290000
073000              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 07300000
073100              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      07310000
073200              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   07320000
073300              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      07330000
073400              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   07340000
073500              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      07350000
073600              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      07360000
073700              STRING  ' OPER-'               DELIMITED BY SIZE    07370000
073800                      PV-DISPLAY-OPER        DELIMITED BY SIZE    07380000
073900                      '  DOOR-'              DELIMITED BY SIZE    07390000
074000                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    07400000
074100                      '  DEST-'              DELIMITED BY SIZE    07410000
074200                      PV-DISPLAY-DEST        DELIMITED BY SIZE    07420000
074300                                        INTO                      07430000
074400                                        PC233-MESSAGE-TEXT(2)     07440000
074500             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    07450000
074600                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    07460000
074700                      '   SCAC-'             DELIMITED BY SIZE    07470000
074800                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    07480000
074900                      '   TRIP-'             DELIMITED BY SIZE    07490000
075000                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    07500000
075100                                        INTO                      07510000
075200                                        PC233-MESSAGE-TEXT(3)     07520000
075300                                                                  07530000
075400             MOVE 17                  TO PV-ERROR-NBR             07540000
075500                                         PC233-ERROR-NBR          07550000
075600             PERFORM 9903-WRITE-CICS-LOG                          07560000
075700             MOVE '3200-DETERMINE-DOOR-NUMBER'                    07570000
075800                                      TO PC233-PARAGRAPH          07580000
075900             MOVE 'PCKRF743 - FIND DOOR NUMBER        '           07590000
076000                                      TO PC233-MESSAGE-TEXT(1)    07600000
076100             MOVE SQLCA               TO PC233-SQLCA              07610000
076200             MOVE 'DLT_DOOR_GP'       TO PC233-DB2-TABLE-NAME(1)  07620000
076300             MOVE 'DLT_DOOR_GP_TMPL'  TO PC233-DB2-TABLE-NAME(2)  07630000
076400             SET PC233-ABEND          TO TRUE                     07640000
076500             MOVE 99                  TO PC233-PGM-MSG-NBR        07650000
076600             PERFORM 8210-XCTL-ERROR-SCREEN                       07660000
076700     END-EVALUATE.                                                07670000
076800                                                                  07680000
076900****************************************************************  07690000
077000*                                                              *  07700000
077100*                                                              *  07710000
077200****************************************************************  07720000
077300 3400-CALL-DLKCS410.                                              07730000
077400                                                                  07740000
077500     INITIALIZE  DL016-PGM-COMMAREA.                              07750000
077600     SET DL016-ESTABLISH-ASGMT TO TRUE.                           07760000
077700     SET DL016-COMMIT-UPDATE   TO TRUE.                           07770000
077800                                                                  07780000
077900     MOVE PC-CURRENT-PROGRAM-NAME TO DL016-CALLING-PGM-NM.        07790000
078000     MOVE PC233-USER-ID TO DL016-SIGN-ON-USR-ID.                  07800000
078100                                                                  07810000
078200     SET  DL011-AN-SHIP-WRK-TYP TO TRUE.                          07820000
078300     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL016-ASGMT-NBR-WRK-TYP. 07830000
078400                                                                  07840000
078500     SET  DL011-SHIP-WRK-TYP TO TRUE.                             07850000
078600     MOVE DL011-KEY-WK-TYP TO DL016-EAI-WK-TYP-DESC.              07860000
078700                                                                  07870000
078800     MOVE DLT00001-DOOR-GP-NBR TO                                 07880000
078900                                   DL011-SD-WRK-AREA-DOOR-GROUP.  07890000
079000     MOVE DL011-SHIP-DOORGRP-WRK-AREA TO DL016-EAI-WK-AREA-DESC.  07900000
079100                                                                  07910000
079200     MOVE PC233-OPER-UNT-ID TO DL016-EAI-DC-NBR.                  07920000
079300     MOVE PC233-USER-ID     TO DL016-EAI-CRE-BY-USR-ID.           07930000
079400     SET  DL016-EAI-USR-IS-UNKNOWN TO TRUE.                       07940000
079500                                                                  07950000
079600     MOVE LENGTH OF DL016-PGM-COMMAREA                            07960000
079700                                      TO PV-COMMAREA-LENGTH.      07970000
079800                                                                  07980000
079900     EXEC CICS LINK                                               07990000
080000         PROGRAM  (DL016-USER-PGM)                                08000000
080100         COMMAREA (DL016-PGM-COMMAREA)                            08010000
080200         LENGTH   (PV-COMMAREA-LENGTH)                            08020000
080300         RESP     (PV-CICS-RESPONSE)                              08030000
080400     END-EXEC.                                                    08040000
080500                                                                  08050000
080600     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      08060000
080700                                                                  08070000
080800     EVALUATE TRUE                                                08080000
080900         WHEN DL016-SUCCESSFUL                                    08090000
081000              MOVE DL016-ESO-ASGMT-START-DTE TO                   08100000
081100                             PC233-ASGMT-STRT-DTE                 08110000
081200              MOVE DL016-ESO-ASGMT-NBR-TXT   TO                   08120000
081300                             PC233-ASGMT-NBR-TXT                  08130000
081400              MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO                 08140000
081500                             PC233-ASGMT-NBR-SEQ-NBR              08150000
081600                                                                  08160000
081700         WHEN DL016-SQL-ERROR                                     08170000
081800              STRING ' DLKCS410 SQL ERROR FOR USER ID-'           08180000
081900                      PC233-USER-ID                               08190000
082000                      DELIMITED BY SIZE                           08200000
082100                      INTO PV-ERROR-MESSAGE                       08210000
082200                                                                  08220000
082300              PERFORM 4000-FORMAT-ERROR-MESSAGE                   08230000
082400                                                                  08240000
082500         WHEN DL016-CALLED-MODULE-FAILURE                         08250000
082600              STRING ' DLKCS410 CALLED MODULE FAILURE FOR '       08260000
082700                      PC233-USER-ID                               08270000
082800                      DELIMITED BY SIZE                           08280000
082900                      INTO PV-ERROR-MESSAGE                       08290000
083000                                                                  08300000
083100              PERFORM 4000-FORMAT-ERROR-MESSAGE                   08310000
083200                                                                  08320000
083300         WHEN DL016-INVALID-ACCESS                                08330000
083400              STRING ' DLKCS410 INVALID ACCESS FAILURE FOR '      08340000
083500                      PC233-USER-ID                               08350000
083600                      DELIMITED BY SIZE                           08360000
083700                      INTO PV-ERROR-MESSAGE                       08370000
083800                                                                  08380000
083900              PERFORM 4000-FORMAT-ERROR-MESSAGE                   08390000
084000                                                                  08400000
084100         WHEN OTHER                                               08410000
084200              STRING ' DLKCS410 OTHER TYPE FAILURE FOR '          08420000
084300                      PC233-USER-ID                               08430000
084400                      DELIMITED BY SIZE                           08440000
084500                      INTO PV-ERROR-MESSAGE                       08450000
084600                                                                  08460000
084700              PERFORM 4000-FORMAT-ERROR-MESSAGE                   08470000
084800                                                                  08480000
084900     END-EVALUATE                                                 08490000
085000     ELSE                                                         08500000
085100         MOVE '3400-CALL-DLKCS410' TO PC233-PARAGRAPH             08510000
085200         MOVE PV-CICS-RESPONSE     TO PC233-MESSAGE-TEXT (1)      08520000
085300         MOVE 'BAD RETURN FROM DLKCS410' TO                       08530000
085400                                      PC233-MESSAGE-TEXT (2)      08540000
085500         MOVE 2                    TO PC233-ERROR-NBR             08550000
085600         SET PC233-ABEND           TO TRUE                        08560000
085700         MOVE 99                   TO PC233-PGM-MSG-NBR           08570000
085800         PERFORM 8210-XCTL-ERROR-SCREEN                           08580000
085900     END-IF.                                                      08590000
086000                                                                  08600000
086100                                                                  08610000
086131******************************************************************08613109
086132*GB 7/01/14 ADDED LOGIC TO CREATE NEW EVENT ASSIGNMENT USER ADD   08613209
086133*   FOR LM LABOR THIS WILL CREATE VISIBILITY FOR THE 'HELPER'     08613309
086134*   ROLE WHERE THE ASSOCIATE IS ON A TEAM, BUT NOT CREATING       08613409
086135*   ACTUAL EVENTS TO THE DATABASE.                                08613509
086136******************************************************************08613609
086150 3500-CREATE-ASGMNT-EVENT.                                        08615002
086160                                                                  08616002
086170                                                                  08617002
086180     INITIALIZE XL072-EAI-EXPORT-COMMAREA                         08618002
086190                                                                  08619002
086191     SET XL072-PC-APP-ID         TO TRUE                          08619102
086192     MOVE 'DC LABOR'             TO XL072-EVNT-OBJ-TXT            08619202
086193     MOVE 'ASSIGNMENT USER ADD'  TO XL072-EVNT-OBJ-ACTN-TXT       08619302
086194                                                                  08619402
086195     MOVE PC233-USER-ID       TO XL072-CRE-BY-USR-ID              08619502
086196     MOVE 'PCKRF743'          TO XL072-CRE-PGM-NM                 08619602
086197     MOVE 'N/A'                   TO XL072-DTL-COPYBOOK-NM        08619702
086198                                                                  08619802
086199     MOVE PC233-ASGMT-NBR-SEQ-NBR TO XL072-EVNT-KY-1-NBR          08619906
086200     MOVE PC233-OPER-UNT-ID       TO XL072-EVNT-KY-2-NBR          08620002
086201                                                                  08620102
086202     MOVE PC233-ASGMT-NBR-TXT     TO XL072-EVNT-KY-1-TXT          08620206
086203     IF PS-CREATE-MAN-ADD-YES                                     08620312
086204        MOVE PV-USERID-MAN-ADD       TO XL072-EVNT-KY-2-TXT       08620412
086205     ELSE                                                         08620512
086206        MOVE PC233-USER-ID           TO XL072-EVNT-KY-2-TXT       08620612
086207     END-IF                                                       08620712
086208                                                                  08620812
086209     MOVE DL011-SHIP-DOORGRP-WRK-AREA TO                          08620912
086210                                 XL072-EVNT-KY-3-TXT              08621012
086211     MOVE DL011-KEY-WK-TYP      TO  XL072-EVNT-KY-4-TXT           08621112
086212                                                                  08621212
086213     MOVE PC233-ASGMT-STRT-DTE  TO   PV-START-TMST-DATE           08621312
086214     MOVE '-'                  TO    PV-DASH-1                    08621412
086215                                     PV-DASH-2                    08621512
086216                                     PV-DASH-3.                   08621612
086217     MOVE PV-START-TMST        TO   XL072-EVNT-KY-1-TMST          08621712
086218                                                                  08621812
086219     PERFORM 3550-SEL-ASGMT-STRT-TMST.                            08621912
086220     MOVE DLT00003-JN-TMST     TO   XL072-EVNT-KY-2-TMST          08622012
086221                                                                  08622112
086222     SET XL072-COMMIT-UPDATE  TO TRUE                             08622212
086223     MOVE 'PCKRF743'          TO XL072-ORIG-CALLING-PGM-NM        08622312
086224                                                                  08622412
086225     PERFORM 3600-CALL-XLKUP033.                                  08622512
086226                                                                  08622612
086227 3550-SEL-ASGMT-STRT-TMST.                                        08622712
086228                                                                  08622812
086229     EXEC SQL                                                     08622912
086230         SELECT                                                   08623012
086231                MAX(B.JN_TMST)                                    08623112
086232          INTO                                                    08623212
086233                :DLT00003-JN-TMST                                 08623312
086234          FROM  DLT_ASGMT A                                       08623412
086235              , DLT_TEM_ASGMT B                                   08623512
086236         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            08623612
086237           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         08623712
086238           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             08623812
086239           AND  A.ASGMT_STRT_DTE    = :PC233-ASGMT-STRT-DTE       08623912
086240           AND  A.ASGMT_NBR_SEQ_NBR = :PC233-ASGMT-NBR-SEQ-NBR    08624012
086241           AND  A.ASGMT_NBR_TXT     = :PC233-ASGMT-NBR-TXT        08624112
086242           AND (B.KOHLS_USR_ID      = :PC233-USER-ID OR           08624212
086243                B.TMP_USR_ID        = :PC233-USER-ID)             08624312
086250     END-EXEC                                                     08625011
086259                                                                  08625902
086260     EVALUATE TRUE                                                08626002
086261         WHEN SQLCODE = ZERO                                      08626102
086262             CONTINUE                                             08626202
086263         WHEN SQLCODE = +100                                      08626302
086264             MOVE SPACES TO DLT00003-JN-TMST                      08626402
086266         WHEN SQLCODE = -904                                      08626602
086267         WHEN SQLCODE = -913                                      08626702
086268         WHEN SQLCODE = -911                                      08626802
086269             MOVE 16                  TO PV-ERROR-NBR             08626902
086270             PERFORM 9903-WRITE-CICS-LOG                          08627002
086271             PERFORM 9000-SOFT-ABORT                              08627102
086272         WHEN SQLWARN0 NOT = SPACES                               08627202
086273         WHEN SQLCODE NOT EQUAL ZERO                              08627302
086275              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      08627502
086276              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   08627602
086277              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      08627702
086278              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   08627802
086279              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      08627902
086280              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      08628002
086281              STRING  ' OPER-'               DELIMITED BY SIZE    08628102
086282                      PV-DISPLAY-OPER        DELIMITED BY SIZE    08628202
086283                      '  DOOR-'              DELIMITED BY SIZE    08628302
086284                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    08628402
086285                      '  DEST-'              DELIMITED BY SIZE    08628502
086286                      PV-DISPLAY-DEST        DELIMITED BY SIZE    08628602
086287                                        INTO                      08628702
086288                                        PC233-MESSAGE-TEXT(2)     08628802
086289             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    08628902
086290                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    08629002
086291                      '   SCAC-'             DELIMITED BY SIZE    08629102
086292                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    08629202
086293                      '   TRIP-'             DELIMITED BY SIZE    08629302
086294                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    08629402
086295                                        INTO                      08629502
086296                                        PC233-MESSAGE-TEXT(3)     08629602
086297                                                                  08629702
086298             MOVE 17                  TO PV-ERROR-NBR             08629802
086299                                         PC233-ERROR-NBR          08629902
086300             PERFORM 9903-WRITE-CICS-LOG                          08630002
086301             MOVE '3550-SEL-ASGMT-STRT-TMST'                      08630111
086302                                      TO PC233-PARAGRAPH          08630202
086303             MOVE 'PCKRF743 - GET ASGMT START TMST'               08630311
086304                                      TO PC233-MESSAGE-TEXT(1)    08630402
086305             MOVE SQLCA               TO PC233-SQLCA              08630502
086306             MOVE 'DLT00004'          TO PC233-DB2-TABLE-NAME(1)  08630611
086307             MOVE 'DLT00003'          TO PC233-DB2-TABLE-NAME(2)  08630711
086308             SET PC233-ABEND          TO TRUE                     08630811
086309             MOVE 99                  TO PC233-PGM-MSG-NBR        08630911
086310             PERFORM 8210-XCTL-ERROR-SCREEN                       08631011
086311     END-EVALUATE.                                                08631111
086312                                                                  08631212
086313******************************************************************08631314
086314* CHECK THAT ADDING OF ASSOCIATE IS CHANGING ASSIGNMENT FROM AN   08631414
086315* INDIVIDUAL ASSIGNMENT TO A TEAM ASSIGNMENT. IF YES, SET SWITCH  08631514
086316* TO CREATE A SECOND ASSIGNMENT ADD EVENT FOR THE INDIVIDUAL      08631619
086317* THAT CREATED THE ASSIGNMENT.                                    08631719
086318******************************************************************08631814
086319 3560-SEL-TEM-ASSGMT-USER.                                        08631912
086320     SET  PS-CREATE-MAN-ADD-NO  TO TRUE                           08632012
086321                                                                  08632112
086322     EXEC SQL                                                     08632212
086323         SELECT                                                   08632312
086324                B.KOHLS_USR_ID                                    08632412
086325          INTO                                                    08632512
086326                :PV-USERID-MAN-ADD                                08632612
086327          FROM  DLT_ASGMT A                                       08632712
086328              , DLT_TEM_ASGMT B                                   08632812
086329         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            08632912
086330           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         08633012
086331           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             08633112
086332           AND  A.ASGMT_STRT_DTE    = :PC233-ASGMT-STRT-DTE       08633212
086333           AND  A.ASGMT_NBR_SEQ_NBR = :PC233-ASGMT-NBR-SEQ-NBR    08633312
086334           AND  A.ASGMT_NBR_TXT     = :PC233-ASGMT-NBR-TXT        08633412
086335           AND (B.KOHLS_USR_ID     <> :PC233-USER-ID OR           08633512
086336                B.TMP_USR_ID       <> :PC233-USER-ID)             08633612
086337           AND  B.LVE_TMST         IS NULL                        08633712
086338           AND  B.LVE_RSN_CDE       = 'N'                         08633812
086339     END-EXEC                                                     08633912
086340                                                                  08634012
086341                                                                  08634112
086342     EVALUATE TRUE                                                08634212
086343         WHEN SQLCODE = ZERO                                      08634312
086344              SET PS-CREATE-MAN-ADD-YES TO TRUE                   08634412
086345         WHEN SQLCODE = +100                                      08634512
086346         WHEN SQLCODE = -811                                      08634612
086347              SET PS-CREATE-MAN-ADD-NO TO TRUE                    08634712
086348         WHEN SQLCODE = -305                                      08634818
086349              PERFORM 3570-SEL-TEM-ASSGMT-TEMP                    08634918
086350         WHEN SQLCODE = -904                                      08635018
086351         WHEN SQLCODE = -913                                      08635118
086352         WHEN SQLCODE = -911                                      08635218
086353             MOVE 1                   TO PV-ERROR-NBR             08635318
086354             PERFORM 9903-WRITE-CICS-LOG                          08635418
086355             PERFORM 9000-SOFT-ABORT                              08635518
086356         WHEN SQLWARN0 NOT = SPACES                               08635618
086357         WHEN SQLCODE NOT EQUAL ZERO                              08635718
086358              MOVE PC233-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-SEQ-NBR  08635818
086362              STRING  ' OPER-'               DELIMITED BY SIZE    08636213
086363                      PV-DISPLAY-OPER        DELIMITED BY SIZE    08636313
086364                      '  DATE-'              DELIMITED BY SIZE    08636415
086365                      PC233-ASGMT-STRT-DTE   DELIMITED BY SIZE    08636515
086366                      '  SEQ -'              DELIMITED BY SIZE    08636615
086367                     PV-DISPLAY-SEQ-NBR      DELIMITED BY SIZE    08636716
086368                      ' NBR TX'              DELIMITED BY SIZE    08636815
086369                     PC233-ASGMT-NBR-TXT     DELIMITED BY SIZE    08636915
086370                      ' USER  '              DELIMITED BY SIZE    08637015
086371                     PC233-USER-ID           DELIMITED BY SIZE    08637115
086372                                        INTO                      08637215
086373                                        PC233-MESSAGE-TEXT(2)     08637315
086382                                                                  08638215
086383             MOVE 1                   TO PV-ERROR-NBR             08638315
086384                                         PC233-ERROR-NBR          08638415
086385             PERFORM 9903-WRITE-CICS-LOG                          08638515
086386             MOVE '3560-SEL-TEM-ASSGMT '                          08638615
086387                                      TO PC233-PARAGRAPH          08638715
086388             MOVE 'PCKRF743 - SEL ASGMT TEAM USER '               08638815
086389                                      TO PC233-MESSAGE-TEXT(1)    08638915
086390             MOVE SQLCA               TO PC233-SQLCA              08639015
086391             MOVE 'DLT00004'          TO PC233-DB2-TABLE-NAME(1)  08639115
086392             MOVE 'DLT00003'          TO PC233-DB2-TABLE-NAME(2)  08639215
086393             SET PC233-ABEND          TO TRUE                     08639315
086394             MOVE 99                  TO PC233-PGM-MSG-NBR        08639415
086400             PERFORM 8210-XCTL-ERROR-SCREEN                       08640013
086413     END-EVALUATE.                                                08641312
086420                                                                  08642012
086421 3570-SEL-TEM-ASSGMT-TEMP.                                        08642115
086422     SET  PS-CREATE-MAN-ADD-NO  TO TRUE                           08642215
086423                                                                  08642315
086424     EXEC SQL                                                     08642415
086425         SELECT                                                   08642515
086426                B.TMP_USR_ID                                      08642615
086427          INTO                                                    08642715
086428                :PV-USERID-MAN-ADD                                08642815
086429          FROM  DLT_ASGMT A                                       08642915
086430              , DLT_TEM_ASGMT B                                   08643015
086431         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            08643115
086432           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         08643215
086433           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             08643315
086434           AND  A.ASGMT_STRT_DTE    = :PC233-ASGMT-STRT-DTE       08643415
086435           AND  A.ASGMT_NBR_SEQ_NBR = :PC233-ASGMT-NBR-SEQ-NBR    08643515
086436           AND  A.ASGMT_NBR_TXT     = :PC233-ASGMT-NBR-TXT        08643615
086437           AND (B.KOHLS_USR_ID     <> :PC233-USER-ID OR           08643715
086438                B.TMP_USR_ID       <> :PC233-USER-ID)             08643815
086439           AND  B.LVE_TMST         IS NULL                        08643915
086440           AND  B.LVE_RSN_CDE       = 'N'                         08644015
086441     END-EXEC                                                     08644115
086442                                                                  08644215
086443                                                                  08644315
086444     EVALUATE TRUE                                                08644415
086445         WHEN SQLCODE = ZERO                                      08644515
086446              SET PS-CREATE-MAN-ADD-YES TO TRUE                   08644615
086447         WHEN SQLCODE = +100                                      08644715
086448         WHEN SQLCODE = -811                                      08644815
086449         WHEN SQLCODE = -305                                      08644918
086450              SET PS-CREATE-MAN-ADD-NO TO TRUE                    08645018
086451         WHEN SQLCODE = -904                                      08645118
086452         WHEN SQLCODE = -913                                      08645218
086453         WHEN SQLCODE = -911                                      08645318
086454             MOVE 1                   TO PV-ERROR-NBR             08645418
086455             PERFORM 9903-WRITE-CICS-LOG                          08645518
086456             PERFORM 9000-SOFT-ABORT                              08645618
086457         WHEN SQLWARN0 NOT = SPACES                               08645718
086458         WHEN SQLCODE NOT EQUAL ZERO                              08645818
086459              MOVE PC233-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-SEQ-NBR  08645918
086460              STRING  ' OPER-'               DELIMITED BY SIZE    08646018
086461                      PV-DISPLAY-OPER        DELIMITED BY SIZE    08646118
086470                      '  DATE-'              DELIMITED BY SIZE    08647017
086480                      PC233-ASGMT-STRT-DTE   DELIMITED BY SIZE    08648017
086481                      '  SEQ -'              DELIMITED BY SIZE    08648117
086482                     PV-DISPLAY-SEQ-NBR      DELIMITED BY SIZE    08648217
086483                      ' NBR TX'              DELIMITED BY SIZE    08648317
086484                     PC233-ASGMT-NBR-TXT     DELIMITED BY SIZE    08648417
086485                      ' USER  '              DELIMITED BY SIZE    08648517
086486                     PC233-USER-ID           DELIMITED BY SIZE    08648617
086487                                        INTO                      08648717
086488                                        PC233-MESSAGE-TEXT(2)     08648817
086489                                                                  08648917
086490             MOVE 1                   TO PV-ERROR-NBR             08649015
086491                                         PC233-ERROR-NBR          08649115
086492             PERFORM 9903-WRITE-CICS-LOG                          08649215
086493             MOVE '3570-SEL-TEM-ASSGMT-TEMP'                      08649315
086494                                      TO PC233-PARAGRAPH          08649415
086495             MOVE 'PCKRF743 - SEL TEAM TEMP USER  '               08649515
086496                                      TO PC233-MESSAGE-TEXT(1)    08649615
086497             MOVE SQLCA               TO PC233-SQLCA              08649715
086498             MOVE 'DLT00004'          TO PC233-DB2-TABLE-NAME(1)  08649815
086499             MOVE 'DLT00003'          TO PC233-DB2-TABLE-NAME(2)  08649915
086500             SET PC233-ABEND          TO TRUE                     08650015
086501             MOVE 99                  TO PC233-PGM-MSG-NBR        08650115
086502             PERFORM 8210-XCTL-ERROR-SCREEN                       08650215
086503     END-EVALUATE.                                                08650315
086504                                                                  08650415
086505*-----------------------------------------------------------------08650515
086506*  CALL XLKUP033 TO LOG AN AN EVENT TO THE EAI                   *08650615
086507*  BUSINESS EVENT TABLES.                                        *08650715
086508*-----------------------------------------------------------------08650815
086509 3600-CALL-XLKUP033.                                              08650915
086510                                                                  08651015
086511     CALL XL072-USER-PGM USING DFHEIBLK                           08651115
086512                              XL072-COMMAREA                      08651215
086513                              XL072-EAI-EXPORT-COMMAREA.          08651315
086514                                                                  08651415
086515     EVALUATE TRUE                                                08651515
086516         WHEN XL072-SUCCESSFUL                                    08651615
086517             CONTINUE                                             08651715
086518         WHEN OTHER                                               08651815
086519           MOVE XL072-EAI-DB-SQLCODE   TO PV-DISPLAY-SQLCODE      08651915
086520           MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER         08652015
086521                                                                  08652115
086522           INITIALIZE PV-CICS-MSG-AREA2                           08652215
086523           STRING ' PCKRF743-3600- '                              08652315
086524                   PV-DISPLAY-OPER   '-'                          08652415
086525                   PV-ERROR-MESSAGE                               08652515
086526                  ' SQLCODE=' PV-DISPLAY-SQLCODE                  08652615
086527                   DELIMITED BY SIZE                              08652715
086528                   INTO PV-CICS-MSG-AREA2                         08652815
086529           PERFORM 999A-WRITE-CSSL-MSG                            08652915
086530                                                                  08653015
086531           INITIALIZE PV-CICS-MSG-AREA2                           08653115
086532           STRING ' PCKRF743-' XL072-USER-PGM                     08653215
086533                  ' -- ' XL072-SQL-ERROR-PARA                     08653315
086534                  ' -- ' XL072-CALL-MOD-FAIL-NM                   08653415
086535                  ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE              08653515
086536                   DELIMITED BY SIZE                              08653615
086537                   INTO PV-CICS-MSG-AREA2                         08653715
086538           PERFORM 999A-WRITE-CSSL-MSG                            08653815
086539                                                                  08653915
086540     END-EVALUATE.                                                08654015
086541/                                                                 08654115
086542 4000-FORMAT-ERROR-MESSAGE.                                       08654215
086543                                                                  08654315
086544     MOVE DL016-ASGMT-SQLCODE    TO PV-DISPLAY-SQLCODE.           08654415
086550     MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER.              08655015
086600                                                                  08660000
086700     INITIALIZE PV-CICS-MSG-AREA2.                                08670000
086800     STRING ' PCKRF743-3400- '                                    08680000
086900             PV-DISPLAY-OPER   '-'                                08690000
087000             PV-ERROR-MESSAGE                                     08700000
087100            ' SQLCODE=' PV-DISPLAY-SQLCODE                        08710000
087200             DELIMITED BY SIZE                                    08720000
087300             INTO PV-CICS-MSG-AREA2.                              08730000
087400     PERFORM 999A-WRITE-CSSL-MSG.                                 08740000
087500                                                                  08750000
087600     INITIALIZE PV-CICS-MSG-AREA2.                                08760000
087700     STRING ' PCKRF743-' DL016-USER-PGM                           08770000
087800            ' -- ' DL016-CALL-MOD-FAIL-SQL-PARA                   08780000
087900            ' -- ' DL016-CALL-MOD-FAIL-NM                         08790000
088000            ' -- ' DL016-CALL-MOD-FAIL-ERR-CDE                    08800000
088100             DELIMITED BY SIZE                                    08810000
088200             INTO PV-CICS-MSG-AREA2.                              08820000
088300     PERFORM 999A-WRITE-CSSL-MSG.                                 08830000
088400                                                                  08840000
088500                                                                  08850000
088600/                                                                 08860000
088700 7000-SELECT-TCNTRID.                                             08870000
088800                                                                  08880000
088900     EXEC SQL                                                     08890000
089000         SELECT                                                   08900000
089100             TRID.SCAC_CDE                                        08910000
089200         ,   TRID.TRLR_ID                                         08920000
089300         INTO                                                     08930000
089400           :CNTRID-SCAC-CDE                                       08940000
089500         , :CNTRID-TRLR-ID                                        08950000
089600         FROM                                                     08960000
089700            TCNTRID TRID                                          08970000
089800         WHERE TRID.TRLR_SRL_NBR  =  :CNTRID-TRLR-SRL-NBR         08980000
089900     END-EXEC.                                                    08990000
090000                                                                  09000000
090100     EVALUATE TRUE                                                09010000
090200         WHEN SQLCODE = ZERO                                      09020000
090300             SET PS-TCNTRID-YES       TO TRUE                     09030000
090400         WHEN SQLCODE = +100                                      09040000
090500             SET PS-TCNTRID-NO        TO TRUE                     09050000
090600         WHEN SQLCODE = -904                                      09060000
090700         WHEN SQLCODE = -913                                      09070000
090800         WHEN SQLCODE = -911                                      09080000
090900             MOVE 2                   TO PV-ERROR-NBR             09090000
091000             PERFORM 9903-WRITE-CICS-LOG                          09100000
091100             PERFORM 9000-SOFT-ABORT                              09110000
091200         WHEN SQLWARN0 NOT = SPACES                               09120000
091300         WHEN SQLCODE NOT EQUAL ZERO                              09130000
091400              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      09140000
091500              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   09150000
091600              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      09160000
091700              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   09170000
091800              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      09180000
091900              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      09190000
092000              STRING  ' OPER-'               DELIMITED BY SIZE    09200000
092100                      PV-DISPLAY-OPER        DELIMITED BY SIZE    09210000
092200                      '  DOOR-'              DELIMITED BY SIZE    09220000
092300                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    09230000
092400                      '  DEST-'              DELIMITED BY SIZE    09240000
092500                      PV-DISPLAY-DEST        DELIMITED BY SIZE    09250000
092600                                        INTO                      09260000
092700                                        PC233-MESSAGE-TEXT(2)     09270000
092800             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    09280000
092900                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    09290000
093000                      '   SCAC-'             DELIMITED BY SIZE    09300000
093100                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    09310000
093200                      '   TRIP-'             DELIMITED BY SIZE    09320000
093300                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    09330000
093400                                        INTO                      09340000
093500                                        PC233-MESSAGE-TEXT(3)     09350000
093600                                                                  09360000
093700             MOVE 3                   TO PV-ERROR-NBR             09370000
093800                                         PC233-ERROR-NBR          09380000
093900             PERFORM 9903-WRITE-CICS-LOG                          09390000
094000             MOVE '7000-SELECT-TCNTRID'                           09400000
094100                                      TO PC233-PARAGRAPH          09410000
094200             MOVE 'PCKRF743 - CHECK TRAILER EXISTENCE'            09420000
094300                                      TO PC233-MESSAGE-TEXT(1)    09430000
094400             MOVE SQLCA               TO PC233-SQLCA              09440000
094500             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(1)  09450000
094600             SET PC233-ABEND          TO TRUE                     09460000
094700             MOVE 99                  TO PC233-PGM-MSG-NBR        09470000
094800             PERFORM 8210-XCTL-ERROR-SCREEN                       09480000
094900     END-EVALUATE.                                                09490000
095000/                                                                 09500000
095100 7010-SELECT-TCNDCDR.                                             09510000
095200                                                                  09520000
095300     EXEC SQL                                                     09530000
095400         SELECT                                                   09540000
095500             DCDR.DOOR_TYP_CDE                                    09550000
095600         ,   DCDR.DIVERT_NBR                                      09560000
095700         ,   DCDR.DIVERT_LOC_ID                                   09570000
095800         INTO                                                     09580000
095900             :CNDCDR-DOOR-TYP-CDE                                 09590000
096000         ,   :CNDCDR-DIVERT-NBR                                   09600000
096100         ,   :CNDCDR-DIVERT-LOC-ID                                09610000
096200         FROM TCNDCDR DCDR                                        09620000
096300         ,    TCNDRTY DRTY                                        09630000
096400         WHERE                                                    09640000
096500             DCDR.OPER_UNT_ID         = :PC233-OPER-UNT-ID        09650000
096600             AND DCDR.DOOR_ID         = :PC233-DOOR-ID            09660000
096700             AND  DCDR.DOOR_TYP_CDE   = DRTY.DOOR_TYP_CDE         09670000
096800             AND  DRTY.DIVERT_TYP_CDE = 'D'                       09680000
096900                                                                  09690000
097000     END-EXEC.                                                    09700000
097100                                                                  09710000
097200     EVALUATE TRUE                                                09720000
097300         WHEN SQLCODE = ZERO                                      09730000
097400             MOVE CNDCDR-DOOR-TYP-CDE TO PC233-DOOR-TYPE-CDE      09740000
097500             MOVE CNDCDR-DIVERT-NBR   TO PC233-DIVERT-NBR         09750000
097600             MOVE CNDCDR-DIVERT-LOC-ID                            09760000
097700                                      TO PC233-DIVERT-LOC-ID      09770000
097800             SET PS-TCNDCDR-YES       TO TRUE                     09780000
097900         WHEN SQLCODE = +100                                      09790000
098000             SET PS-TCNDCDR-NO        TO TRUE                     09800000
098100         WHEN SQLCODE = -904                                      09810000
098200         WHEN SQLCODE = -913                                      09820000
098300         WHEN SQLCODE = -911                                      09830000
098400             MOVE 4                   TO PV-ERROR-NBR             09840000
098500             PERFORM 9903-WRITE-CICS-LOG                          09850000
098600             PERFORM 9000-SOFT-ABORT                              09860000
098700         WHEN SQLWARN0 NOT = SPACES                               09870000
098800         WHEN SQLCODE NOT EQUAL ZERO                              09880000
098900              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      09890000
099000              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   09900000
099100              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      09910000
099200              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   09920000
099300              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      09930000
099400              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      09940000
099500              STRING  ' OPER-'               DELIMITED BY SIZE    09950000
099600                      PV-DISPLAY-OPER        DELIMITED BY SIZE    09960000
099700                      '  DOOR-'              DELIMITED BY SIZE    09970000
099800                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    09980000
099900                      '  DEST-'              DELIMITED BY SIZE    09990000
100000                      PV-DISPLAY-DEST        DELIMITED BY SIZE    10000000
100100                                        INTO                      10010000
100200                                        PC233-MESSAGE-TEXT(2)     10020000
100300             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    10030000
100400                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    10040000
100500                      '   SCAC-'             DELIMITED BY SIZE    10050000
100600                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    10060000
100700                      '   TRIP-'             DELIMITED BY SIZE    10070000
100800                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    10080000
100900                                        INTO                      10090000
101000                                        PC233-MESSAGE-TEXT(3)     10100000
101100                                                                  10110000
101200             MOVE 5                   TO PV-ERROR-NBR             10120000
101300                                         PC233-ERROR-NBR          10130000
101400             PERFORM 9903-WRITE-CICS-LOG                          10140000
101500             MOVE '7010-SELECT-TCNDCDR'                           10150000
101600                                      TO PC233-PARAGRAPH          10160000
101700             MOVE 'PCKRF743 - CHECK DOOR ID'                      10170000
101800                                      TO PC233-MESSAGE-TEXT(1)    10180000
101900             MOVE SQLCA               TO PC233-SQLCA              10190000
102000             MOVE 'TCNDCDR'           TO PC233-DB2-TABLE-NAME(1)  10200000
102100             SET PC233-ABEND          TO TRUE                     10210000
102200             MOVE 99                  TO PC233-PGM-MSG-NBR        10220000
102300             PERFORM 8210-XCTL-ERROR-SCREEN                       10230000
102400     END-EVALUATE.                                                10240000
102500/                                                                 10250000
102600                                                                  10260000
102700****************************************************************  10270000
102800*    FORMAT COMMAREA TO CALL XLKUT067 TO ACCESS INFORMATION    *  10280000
102900*    ABOUT A SPECIFIC USERID.                                  *  10290000
103000*                                                              *  10300000
103100****************************************************************  10310000
103200                                                                  10320000
103300 7015-CALL-XLKUT067.                                              10330000
103400                                                                  10340000
103500     INITIALIZE XL067-USER-COMMAREA.                              10350000
103600     SET XL067-BY-USER-ID TO TRUE.                                10360000
103700     SET XL067-SELECT-BOTH-USERS TO TRUE.                         10370000
103800                                                                  10380000
103900     MOVE PV-SCREEN-USER TO XL067-KEY-USER-ID.                    10390000
104000                                                                  10400000
104100     CALL XL067-USER-PGM USING DFHEIBLK                           10410000
104200                               XL067-COMMAREA                     10420000
104300                               XL067-USER-COMMAREA.               10430000
104400                                                                  10440000
104500     IF XL067-SUCCESSFUL                                          10450000
104600        CONTINUE                                                  10460000
104700     ELSE                                                         10470000
104800        MOVE 99                  TO PV-ERROR-NBR                  10480000
104900                                    PC233-ERROR-NBR               10490000
105000        PERFORM 9903-WRITE-CICS-LOG                               10500000
105100        MOVE '7015-CALL-XLKUT067'                                 10510000
105200                                 TO PC233-PARAGRAPH               10520000
105300        MOVE 'PCKRF743 - CALL XLKUT067 '                          10530000
105400                                 TO PC233-MESSAGE-TEXT(1)         10540000
105500        MOVE SQLCA               TO PC233-SQLCA                   10550000
105600        MOVE '       '           TO PC233-DB2-TABLE-NAME(1)       10560000
105700        SET PC233-ABEND          TO TRUE                          10570000
105800        MOVE 99                  TO PC233-PGM-MSG-NBR             10580000
105900        PERFORM 8210-XCTL-ERROR-SCREEN                            10590000
106000     END-IF.                                                      10600000
106100                                                                  10610000
106200/                                                                 10620000
106300 7030-CHECK-OPEN-TRAILERS.                                        10630000
106400                                                                  10640000
106500     EXEC SQL                                                     10650000
106600         SELECT OBTS.OTBND_TRIP_ID                                10660000
106700         ,      OBTR.TRLR_SRL_NBR                                 10670000
106800         ,      OBTS.DOOR_ID                                      10680000
106900         ,      OBTR.DEST_OPER_UNT_ID                             10690000
107000         INTO :SUOBTS-OTBND-TRIP-ID                               10700000
107100         ,    :SUOBTR-TRLR-SRL-NBR                                10710000
107200         ,    :SUOBTS-DOOR-ID                                     10720000
107300         ,    :SUOBTR-DEST-OPER-UNT-ID                            10730000
107400         FROM TSUOBTS OBTS                                        10740000
107500         ,    TSUOBTR OBTR                                        10750000
107600         WHERE OBTS.TRIP_STAT_CDE     = 'DO'                      10760000
107700         AND OBTS.DOOR_ID             = :PC233-DOOR-ID            10770000
107800         AND OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID        10780000
107900         AND OBTR.TRIP_ACTV_CDE       = 'A'                       10790000
108000         AND OBTR.OTBND_TRIP_ID       = OBTS.OTBND_TRIP_ID        10800000
108100         AND OBTS.OTBND_STAT_TMST     =                           10810000
108200         (                                                        10820000
108300          SELECT                                                  10830000
108400            MAX(OBTS1.OTBND_STAT_TMST)                            10840000
108500            FROM TSUOBTS OBTS1                                    10850000
108600            WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID        10860000
108700         )                                                        10870000
108800     END-EXEC.                                                    10880000
108900                                                                  10890000
109000     EVALUATE TRUE                                                10900000
109100         WHEN SQLCODE = ZERO                                      10910000
109200             MOVE SUOBTS-OTBND-TRIP-ID                            10920000
109300                                      TO PC233-TRIP-ID            10930000
109400                                         PC233-ERROR-TRIP-ID      10940000
109500                                         ATRIPO                   10950000
109600             MOVE SUOBTR-TRLR-SRL-NBR                             10960000
109700                                      TO PC233-SERIAL-NBR         10970000
109800                                         PC233-ERROR-SRL-NBR      10980000
109900             MOVE SUOBTS-DOOR-ID      TO PC233-DOOR-ID            10990000
110000                                         PC233-ERROR-DOOR-NBR     11000000
110100             MOVE SUOBTR-DEST-OPER-UNT-ID                         11010000
110200                                      TO PC233-STR-NBR            11020000
110300                                                                  11030000
110400         WHEN SQLCODE = +100                                      11040000
110500             SET PS-ERRORS-YES            TO TRUE                 11050000
110600             MOVE -1                      TO ADOORL               11060000
110700             MOVE 'NO TRLRS AT DOOR   '   TO AMSGLNO              11070000
110800         WHEN SQLCODE = -811                                      11080000
110900             CONTINUE                                             11090000
111000         WHEN SQLCODE = -904                                      11100000
111100         WHEN SQLCODE = -913                                      11110000
111200         WHEN SQLCODE = -911                                      11120000
111300             MOVE 8                   TO PV-ERROR-NBR             11130000
111400             PERFORM 9903-WRITE-CICS-LOG                          11140000
111500             PERFORM 9000-SOFT-ABORT                              11150000
111600         WHEN SQLWARN0 NOT = SPACES                               11160000
111700         WHEN SQLCODE NOT EQUAL ZERO                              11170000
111800              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      11180000
111900              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   11190000
112000              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      11200000
112100              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   11210000
112200              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      11220000
112300              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      11230000
112400              STRING  ' OPER-'               DELIMITED BY SIZE    11240000
112500                      PV-DISPLAY-OPER        DELIMITED BY SIZE    11250000
112600                      '  DOOR-'              DELIMITED BY SIZE    11260000
112700                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    11270000
112800                      '  DEST-'              DELIMITED BY SIZE    11280000
112900                      PV-DISPLAY-DEST        DELIMITED BY SIZE    11290000
113000                                        INTO                      11300000
113100                                        PC233-MESSAGE-TEXT(2)     11310000
113200             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    11320000
113300                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    11330000
113400                      '   SCAC-'             DELIMITED BY SIZE    11340000
113500                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    11350000
113600                      '   TRIP-'             DELIMITED BY SIZE    11360000
113700                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    11370000
113800                                        INTO                      11380000
113900                                        PC233-MESSAGE-TEXT(3)     11390000
114000                                                                  11400000
114100             MOVE 9                   TO PV-ERROR-NBR             11410000
114200                                         PC233-ERROR-NBR          11420000
114300             PERFORM 9903-WRITE-CICS-LOG                          11430000
114400             MOVE '7030-CHECK-OPEN-TRAILERS'                      11440000
114500                                      TO PC233-PARAGRAPH          11450000
114600             MOVE 'PCKRF743 - CHECK OPEN TRAILERS AT DOOR'        11460000
114700                                      TO PC233-MESSAGE-TEXT(1)    11470000
114800             MOVE SQLCA               TO PC233-SQLCA              11480000
114900             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  11490000
115000             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  11500000
115100             SET PC233-ABEND          TO TRUE                     11510000
115200             MOVE 99                  TO PC233-PGM-MSG-NBR        11520000
115300             PERFORM 8210-XCTL-ERROR-SCREEN                       11530000
115400     END-EVALUATE.                                                11540000
115500/                                                                 11550000
115600 7050-SELECT-TRAILER-STATUS.                                      11560000
115700                                                                  11570000
115800     INITIALIZE  SUOBTS-OTBND-TRIP-ID                             11580000
115900                 CNTRID-TRLR-ID                                   11590000
116000                 SUOBTS-TRIP-STAT-CDE                             11600000
116100                 SUOBTR-DEST-OPER-UNT-ID                          11610000
116200                                                                  11620000
116300     EXEC SQL                                                     11630000
116400       SELECT                                                     11640000
116500           OBTS.OTBND_TRIP_ID                                     11650000
116600       ,   TRID.TRLR_ID                                           11660000
116700       ,   OBTS.TRIP_STAT_CDE                                     11670000
116800       ,   OBTR.DEST_OPER_UNT_ID                                  11680000
116900       ,   A.DOOR_TYP_CDE                                         11690000
117000       ,   OBTS.DOOR_ID                                           11700000
117100       INTO                                                       11710000
117200           :SUOBTS-OTBND-TRIP-ID                                  11720000
117300       ,   :CNTRID-TRLR-ID                                        11730000
117400       ,   :SUOBTS-TRIP-STAT-CDE                                  11740000
117500       ,   :SUOBTR-DEST-OPER-UNT-ID                               11750000
117600       ,   :CNDCDR-DOOR-TYP-CDE                                   11760000
117700       ,   :SUOBTS-DOOR-ID                                        11770000
117800       FROM TSUOBTS OBTS                                          11780000
117900       ,    TSUOBTR OBTR                                          11790000
118000       ,    TCNTRID TRID                                          11800000
118100       ,    TCNDCDR A                                             11810000
118200       WHERE                                                      11820000
118300           OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID          11830000
118400       AND OBTR.TRLR_SRL_NBR        = :PC233-SERIAL-NBR           11840000
118500       AND OBTR.TRIP_ACTV_CDE       = 'A'                         11850000
118600       AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR           11860000
118700       AND OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID          11870000
118800       AND OBTS.DOOR_ID             = A.DOOR_ID                   11880000
118900       AND OBTS.STAT_OPER_UNT_ID    = A.OPER_UNT_ID               11890000
119000                                                                  11900000
119100       AND OBTS.OTBND_STAT_TMST =                                 11910000
119200           (SELECT MAX(OBTS1.OTBND_STAT_TMST)                     11920000
119300               FROM TSUOBTS OBTS1                                 11930000
119400               ,    TSUOBTR OBTR1                                 11940000
119500               WHERE                                              11950000
119600                 OBTR1.TRLR_SRL_NBR        = :PC233-SERIAL-NBR    11960000
119700               AND  OBTS1.OTBND_TRIP_ID    = OBTR1.OTBND_TRIP_ID) 11970000
119800                                                                  11980000
119900     END-EXEC.                                                    11990000
120000                                                                  12000000
120100     EVALUATE TRUE                                                12010000
120200         WHEN SQLCODE = ZERO                                      12020000
120300             SET PS-ACTIVE-TRIP-EXISTS                            12030000
120400                                      TO TRUE                     12040000
120500         WHEN SQLCODE = +100                                      12050000
120600             SET PS-NO-ACTIVE-TRIP-EXISTS                         12060000
120700                                      TO TRUE                     12070000
120800         WHEN SQLCODE = -904                                      12080000
120900         WHEN SQLCODE = -913                                      12090000
121000         WHEN SQLCODE = -911                                      12100000
121100             MOVE 10                  TO PV-ERROR-NBR             12110000
121200             PERFORM 9903-WRITE-CICS-LOG                          12120000
121300             PERFORM 9000-SOFT-ABORT                              12130000
121400         WHEN SQLWARN0 NOT = SPACES                               12140000
121500         WHEN SQLCODE NOT EQUAL ZERO                              12150000
121600              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      12160000
121700              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   12170000
121800              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      12180000
121900              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   12190000
122000              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      12200000
122100              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      12210000
122200              STRING  ' OPER-'               DELIMITED BY SIZE    12220000
122300                      PV-DISPLAY-OPER        DELIMITED BY SIZE    12230000
122400                      '  DOOR-'              DELIMITED BY SIZE    12240000
122500                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    12250000
122600                      '  DEST-'              DELIMITED BY SIZE    12260000
122700                      PV-DISPLAY-DEST        DELIMITED BY SIZE    12270000
122800                                        INTO                      12280000
122900                                        PC233-MESSAGE-TEXT(2)     12290000
123000             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    12300000
123100                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    12310000
123200                      '   SCAC-'             DELIMITED BY SIZE    12320000
123300                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    12330000
123400                      '   TRIP-'             DELIMITED BY SIZE    12340000
123500                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    12350000
123600                                        INTO                      12360000
123700                                        PC233-MESSAGE-TEXT(3)     12370000
123800                                                                  12380000
123900             MOVE 11                  TO PV-ERROR-NBR             12390000
124000                                         PC233-ERROR-NBR          12400000
124100             PERFORM 9903-WRITE-CICS-LOG                          12410000
124200             MOVE '7050-SELECT-TRAILER-STATUS'                    12420000
124300                                      TO PC233-PARAGRAPH          12430000
124400             MOVE 'PCKRF743 - CHECK TRLR AT ANOTHER DOOR'         12440000
124500                                      TO PC233-MESSAGE-TEXT(1)    12450000
124600             MOVE SQLCA               TO PC233-SQLCA              12460000
124700             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  12470000
124800             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  12480000
124900             SET PC233-ABEND          TO TRUE                     12490000
125000             MOVE 99                  TO PC233-PGM-MSG-NBR        12500000
125100             PERFORM 8210-XCTL-ERROR-SCREEN                       12510000
125200     END-EVALUATE.                                                12520000
125300/                                                                 12530000
125400 7060-SELECT-TKRPRPM.                                             12540000
125500*    THIS IS THE TIME THRESHOLD FOR RESUMMARIZING A TRAILER       12550000
125600                                                                  12560000
125700     EXEC SQL                                                     12570000
125800       SELECT                                                     12580000
125900           FUNC_QTY                                               12590000
126000       INTO :PV-ELAPSED-MINUTES                                   12600000
126100       FROM TKRPRPM                                               12610000
126200       WHERE                                                      12620000
126300           LOC_ID                   = :PC233-OPER-UNT-ID          12630000
126400       AND INTFC_SYS_CDE            = 'KHL'                       12640000
126500       AND SYS_PRC_FUNC_CDE         = 'TRLSUM'                    12650000
126600       AND (CURRENT_DATE                                          12660000
126700       BETWEEN DATE(FUNC_BEG_TMST) AND                            12670000
126800               DATE(FUNC_END_TMST) )                              12680000
126900                                                                  12690000
127000     END-EXEC.                                                    12700000
127100                                                                  12710000
127200     EVALUATE TRUE                                                12720000
127300         WHEN SQLCODE = ZERO                                      12730000
127400             SET PS-SUMMARY-YES       TO TRUE                     12740000
127500         WHEN SQLCODE = +100                                      12750000
127600             SET PS-SUMMARY-NO        TO TRUE                     12760000
127700         WHEN SQLCODE = -904                                      12770000
127800         WHEN SQLCODE = -913                                      12780000
127900         WHEN SQLCODE = -911                                      12790000
128000             MOVE 16                  TO PV-ERROR-NBR             12800000
128100             PERFORM 9903-WRITE-CICS-LOG                          12810000
128200             PERFORM 9000-SOFT-ABORT                              12820000
128300         WHEN SQLWARN0 NOT = SPACES                               12830000
128400         WHEN SQLCODE NOT EQUAL ZERO                              12840000
128500              SET PS-SUMMARY-NO           TO TRUE                 12850000
128600              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      12860000
128700              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   12870000
128800              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      12880000
128900              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   12890000
129000              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      12900000
129100              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      12910000
129200              STRING  ' OPER-'               DELIMITED BY SIZE    12920000
129300                      PV-DISPLAY-OPER        DELIMITED BY SIZE    12930000
129400                      '  DOOR-'              DELIMITED BY SIZE    12940000
129500                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    12950000
129600                      '  DEST-'              DELIMITED BY SIZE    12960000
129700                      PV-DISPLAY-DEST        DELIMITED BY SIZE    12970000
129800                                        INTO                      12980000
129900                                        PC233-MESSAGE-TEXT(2)     12990000
130000             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    13000000
130100                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    13010000
130200                      '   SCAC-'             DELIMITED BY SIZE    13020000
130300                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    13030000
130400                      '   TRIP-'             DELIMITED BY SIZE    13040000
130500                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    13050000
130600                                        INTO                      13060000
130700                                        PC233-MESSAGE-TEXT(3)     13070000
130800                                                                  13080000
130900             MOVE 17                  TO PV-ERROR-NBR             13090000
131000                                         PC233-ERROR-NBR          13100000
131100             PERFORM 9903-WRITE-CICS-LOG                          13110000
131200             MOVE '7060-SELECT-TKRPRPM'                           13120000
131300                                      TO PC233-PARAGRAPH          13130000
131400             MOVE 'PCKRF743 - LOOKUP DEFAULT MINUTES'             13140000
131500                                      TO PC233-MESSAGE-TEXT(1)    13150000
131600             MOVE SQLCA               TO PC233-SQLCA              13160000
131700             MOVE 'TKRPRPM'           TO PC233-DB2-TABLE-NAME(1)  13170000
131800             SET PC233-ABEND          TO TRUE                     13180000
131900             MOVE 99                  TO PC233-PGM-MSG-NBR        13190000
132000             PERFORM 8210-XCTL-ERROR-SCREEN                       13200000
132100     END-EVALUATE.                                                13210000
132200                                                                  13220000
132300 7070-FIND-LAST-SUMMARY.                                          13230000
132400                                                                  13240000
132500*    IF A SUMMARY IS FOUND THAT IS OLDER THAN THE THRESHOLD       13250000
132600*    TIME LIMIT, THE PS-TRLR-SUMMRY-SW WILL HAVE A VALUE OF       13260000
132700*    1 OTHERWISE IT WILL REMAIN A ZERO.                           13270000
132800                                                                  13280000
132900     MOVE ZERO                        TO PS-TRLR-SUMMRY-SW        13290000
133000     EXEC SQL                                                     13300000
133100           SELECT MAX(SUM.CRE_TMST) + :PV-ELAPSED-MINUTES         13310000
133200                                       MINUTES                    13320000
133300              ,  CURRENT TIMESTAMP                                13330000
133400           INTO :SUT00007-CRE-TMST                                13340000
133500              , :PV-CURRENT-TIMESTAMP                             13350000
133600           FROM                                                   13360000
133700           SUT_TRIP_SUM SUM                                       13370000
133800           WHERE                                                  13380000
133900           SUM.OTBND_TRIP_ID = :PC233-TRIP-ID                     13390000
134000     END-EXEC.                                                    13400000
134100                                                                  13410000
134200     EVALUATE TRUE                                                13420000
134300         WHEN SQLCODE = ZERO                                      13430000
134400             IF PV-CURRENT-TIMESTAMP > SUT00007-CRE-TMST          13440000
134500                 SET PS-REFRESH-SUMMRY-YES TO TRUE                13450000
134600             END-IF                                               13460000
134700         WHEN SQLCODE = +100                                      13470000
134800         WHEN SQLCODE = -305                                      13480000
134900             SET PS-REFRESH-SUMMRY-YES TO TRUE                    13490000
135000         WHEN SQLCODE = -904                                      13500000
135100         WHEN SQLCODE = -913                                      13510000
135200         WHEN SQLCODE = -911                                      13520000
135300             MOVE 14                  TO PV-ERROR-NBR             13530000
135400             PERFORM 9903-WRITE-CICS-LOG                          13540000
135500             PERFORM 9000-SOFT-ABORT                              13550000
135600         WHEN SQLWARN0 NOT = SPACES                               13560000
135700         WHEN SQLCODE NOT EQUAL ZERO                              13570000
135800              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      13580000
135900              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   13590000
136000              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      13600000
136100              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   13610000
136200              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      13620000
136300              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      13630000
136400              STRING  ' OPER-'               DELIMITED BY SIZE    13640000
136500                      PV-DISPLAY-OPER        DELIMITED BY SIZE    13650000
136600                      '  DOOR-'              DELIMITED BY SIZE    13660000
136700                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    13670000
136800                      '  DEST-'              DELIMITED BY SIZE    13680000
136900                      PV-DISPLAY-DEST        DELIMITED BY SIZE    13690000
137000                                        INTO                      13700000
137100                                        PC233-MESSAGE-TEXT(2)     13710000
137200             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    13720000
137300                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    13730000
137400                      '   SCAC-'             DELIMITED BY SIZE    13740000
137500                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    13750000
137600                      '   TRIP-'             DELIMITED BY SIZE    13760000
137700                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    13770000
137800                                        INTO                      13780000
137900                                        PC233-MESSAGE-TEXT(3)     13790000
138000                                                                  13800000
138100             MOVE 15                  TO PV-ERROR-NBR             13810000
138200                                         PC233-ERROR-NBR          13820000
138300             PERFORM 9903-WRITE-CICS-LOG                          13830000
138400             MOVE '7070-FIND-LAST-SUMMARY'                        13840000
138500                                      TO PC233-PARAGRAPH          13850000
138600             MOVE 'PCKRF743 - CHECK TRLR SUMMRY EXPIRATION'       13860000
138700                                      TO PC233-MESSAGE-TEXT(1)    13870000
138800             MOVE SQLCA               TO PC233-SQLCA              13880000
138900             MOVE 'SUT_TRIP_SUM'      TO PC233-DB2-TABLE-NAME(1)  13890000
139000             SET PC233-ABEND          TO TRUE                     13900000
139100             MOVE 99                  TO PC233-PGM-MSG-NBR        13910000
139200             PERFORM 8210-XCTL-ERROR-SCREEN                       13920000
139300     END-EVALUATE.                                                13930000
139400/                                                                 13940000
139500/                                                                 13950000
139600 7400-INSERT-WRKR-AUD.                                            13960000
139700     EXEC SQL                                                     13970000
139800         INSERT INTO SUT_TRIP_WRKR_AUD                            13980000
139900             (                                                    13990000
140000               OTBND_TRIP_ID                                      14000000
140100             , USR_ID                                             14010000
140200             , CRE_TMST                                           14020000
140300             , CRE_BY_PGM_NM                                      14030000
140400                 )                                                14040000
140500                                                                  14050000
140600             VALUES                                               14060000
140700                                                                  14070000
140800                 (                                                14080000
140900                 :PC233-TRIP-ID                                   14090000
141000             ,   :PC233-USER-ID                                   14100000
141100             ,   CURRENT TIMESTAMP                                14110000
141200             ,   'PCKRF743'                                       14120000
141300                 )                                                14130000
141400     END-EXEC.                                                    14140000
141500                                                                  14150000
141600     EVALUATE TRUE                                                14160000
141700         WHEN SQLCODE = ZERO                                      14170000
141800             CONTINUE                                             14180000
141900         WHEN SQLCODE = -904                                      14190000
142000         WHEN SQLCODE = -913                                      14200000
142100         WHEN SQLCODE = -911                                      14210000
142200             MOVE 12                  TO PV-ERROR-NBR             14220000
142300             PERFORM 9903-WRITE-CICS-LOG                          14230000
142400             PERFORM 9000-SOFT-ABORT                              14240000
142500         WHEN SQLWARN0 NOT = SPACES                               14250000
142600         WHEN SQLCODE NOT EQUAL ZERO                              14260000
142700              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      14270000
142800              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   14280000
142900              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      14290000
143000              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   14300000
143100              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      14310000
143200              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      14320000
143300              STRING  ' OPER-'               DELIMITED BY SIZE    14330000
143400                      PV-DISPLAY-OPER        DELIMITED BY SIZE    14340000
143500                      '  DOOR-'              DELIMITED BY SIZE    14350000
143600                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    14360000
143700                      '  DEST-'              DELIMITED BY SIZE    14370000
143800                      PV-DISPLAY-DEST        DELIMITED BY SIZE    14380000
143900                                        INTO                      14390000
144000                                        PC233-MESSAGE-TEXT(2)     14400000
144100             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    14410000
144200                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    14420000
144300                      '   SCAC-'             DELIMITED BY SIZE    14430000
144400                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    14440000
144500                      '   TRIP-'             DELIMITED BY SIZE    14450000
144600                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    14460000
144700                                        INTO                      14470000
144800                                        PC233-MESSAGE-TEXT(3)     14480000
144900                                                                  14490000
145000             MOVE 13                  TO PV-ERROR-NBR             14500000
145100                                         PC233-ERROR-NBR          14510000
145200             PERFORM 9903-WRITE-CICS-LOG                          14520000
145300             MOVE '7400-INSERT-WRKR-AUD'                          14530000
145400                                      TO PC233-PARAGRAPH          14540000
145500             MOVE 'PCKRF743 - INSERT WORKER AUDIT'                14550000
145600                                      TO PC233-MESSAGE-TEXT(1)    14560000
145700             MOVE SQLCA               TO PC233-SQLCA              14570000
145800             MOVE 'SUT00006'          TO PC233-DB2-TABLE-NAME(1)  14580000
145900             SET PC233-ABEND          TO TRUE                     14590000
146000             MOVE 99                  TO PC233-PGM-MSG-NBR        14600000
146100             PERFORM 8210-XCTL-ERROR-SCREEN                       14610000
146200     END-EVALUATE.                                                14620000
146300                                                                  14630001
146301*************************************************************     14630101
146302* INSERT A ROW INTO SUT_TRIP_WRKR_AUD TABLE WHEN TRAILER    *     14630201
146303* SUMMARIZATION HAS BEEN REQUESTED                          *     14630301
146304*************************************************************     14630401
146310 7500-INSERT-WRKR-AUD.                                            14631001
146311                                                                  14631101
146320     EXEC SQL                                                     14632001
146330         INSERT INTO SUT_TRIP_WRKR_AUD                            14633001
146340             (                                                    14634001
146350               OTBND_TRIP_ID                                      14635001
146360             , USR_ID                                             14636001
146370             , CRE_TMST                                           14637001
146380             , CRE_BY_PGM_NM                                      14638001
146390                 )                                                14639001
146391                                                                  14639101
146392             VALUES                                               14639201
146393                                                                  14639301
146394                 (                                                14639401
146395                 :PC233-TRIP-ID                                   14639501
146396             ,   :PC233-USER-ID                                   14639601
146397             ,   CURRENT TIMESTAMP                                14639701
146398             ,   'PCKR743A'                                       14639801
146399                 )                                                14639901
146400     END-EXEC.                                                    14640001
146401                                                                  14640101
146402     EVALUATE TRUE                                                14640201
146403         WHEN SQLCODE = ZERO                                      14640301
146404             CONTINUE                                             14640401
146405         WHEN SQLCODE = -904                                      14640501
146406         WHEN SQLCODE = -913                                      14640601
146407         WHEN SQLCODE = -911                                      14640701
146408             MOVE 12                  TO PV-ERROR-NBR             14640801
146409             PERFORM 9903-WRITE-CICS-LOG                          14640901
146410             PERFORM 9000-SOFT-ABORT                              14641001
146411         WHEN SQLWARN0 NOT = SPACES                               14641101
146412         WHEN SQLCODE NOT EQUAL ZERO                              14641201
146413              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      14641301
146414              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   14641401
146415              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      14641501
146416              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   14641601
146417              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      14641701
146418              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      14641801
146419              STRING  ' OPER-'               DELIMITED BY SIZE    14641901
146420                      PV-DISPLAY-OPER        DELIMITED BY SIZE    14642001
146421                      '  DOOR-'              DELIMITED BY SIZE    14642101
146422                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    14642201
146423                      '  DEST-'              DELIMITED BY SIZE    14642301
146424                      PV-DISPLAY-DEST        DELIMITED BY SIZE    14642401
146425                                        INTO                      14642501
146426                                        PC233-MESSAGE-TEXT(2)     14642601
146427             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    14642701
146428                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    14642801
146429                      '   SCAC-'             DELIMITED BY SIZE    14642901
146430                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    14643001
146431                      '   TRIP-'             DELIMITED BY SIZE    14643101
146432                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    14643201
146433                                        INTO                      14643301
146434                                        PC233-MESSAGE-TEXT(3)     14643401
146435                                                                  14643501
146436             MOVE 13                  TO PV-ERROR-NBR             14643601
146437                                         PC233-ERROR-NBR          14643701
146438             PERFORM 9903-WRITE-CICS-LOG                          14643801
146439             MOVE '7400-INSERT-WRKR-AUD'                          14643901
146440                                      TO PC233-PARAGRAPH          14644001
146441             MOVE 'PCKRF743A - REQUEST TRAILER SUM'               14644101
146442                                      TO PC233-MESSAGE-TEXT(1)    14644201
146443             MOVE SQLCA               TO PC233-SQLCA              14644301
146444             MOVE 'SUT00006'          TO PC233-DB2-TABLE-NAME(1)  14644401
146445             SET PC233-ABEND          TO TRUE                     14644501
146446             MOVE 99                  TO PC233-PGM-MSG-NBR        14644601
146447             PERFORM 8210-XCTL-ERROR-SCREEN                       14644701
146448     END-EVALUATE.                                                14644801
146449/                                                                 14644901
146450                                                                  14645000
146500 8000-SEND-MAP.                                                   14650000
146600                                                                  14660000
146700     EXEC CICS                                                    14670000
146800         SEND MAP       ('PC743A')                                14680000
146900              MAPSET    ('PCKM743')                               14690000
147000              ERASE                                               14700000
147100              CURSOR                                              14710000
147200              RESP      (PV-CICS-RESPONSE)                        14720000
147300     END-EXEC.                                                    14730000
147400                                                                  14740000
147500     EVALUATE TRUE                                                14750000
147600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14760000
147700             CONTINUE                                             14770000
147800         WHEN OTHER                                               14780000
147900             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          14790000
148000             MOVE 'PCKRF743 - UNABLE TO SEND MAP'                 14800000
148100                                      TO DP013-MESSAGE-TEXT (1)   14810000
148200             SET DP013-CICS-ABEND                                 14820000
148300                 DP013-ROLLBACK       TO TRUE                     14830000
148400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14840000
148500     END-EVALUATE.                                                14850000
148600                                                                  14860000
148700*8010-SEND-DATA-ONLY.                                             14870000
148800*                                                                 14880000
148900*    EXEC CICS                                                    14890000
149000*        SEND MAP       ('PC743A')                                14900000
149100*             MAPSET    ('PCKM743')                               14910000
149200*             CURSOR                                              14920000
149300*             DATAONLY                                            14930000
149400*             RESP      (PV-CICS-RESPONSE)                        14940000
149500*    END-EXEC.                                                    14950000
149600*                                                                 14960000
149700*    EVALUATE TRUE                                                14970000
149800*        WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14980000
149900*            CONTINUE                                             14990000
150000*        WHEN OTHER                                               15000000
150100*            MOVE '8010-SEND-DATA-ONLY'                           15010000
150200*                                     TO DP013-PARAGRAPH          15020000
150300*            MOVE 'PCKRF743 - UNABLE TO SEND DATA'                15030000
150400*                                     TO DP013-MESSAGE-TEXT (1)   15040000
150500*            SET DP013-CICS-ABEND                                 15050000
150600*                DP013-ROLLBACK       TO TRUE                     15060000
150700*            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15070000
150800*    END-EVALUATE.                                                15080000
150900                                                                  15090000
151000 8020-RECEIVE-MAP.                                                15100000
151100                                                                  15110000
151200     EXEC CICS                                                    15120000
151300         RECEIVE MAP    ('PC743A')                                15130000
151400                 MAPSET ('PCKM743')                               15140000
151500                 RESP   (PV-CICS-RESPONSE)                        15150000
151600     END-EXEC.                                                    15160000
151700                                                                  15170000
151800     EVALUATE TRUE                                                15180000
151900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15190000
152000             CONTINUE                                             15200000
152100         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                15210000
152200             CONTINUE                                             15220000
152300         WHEN OTHER                                               15230000
152400            MOVE '8020-RECEIVE-MAP'   TO DP013-PARAGRAPH          15240000
152500            MOVE 'PCKRF743 - UNABLE TO RECEIVE MAP'               15250000
152600                                      TO DP013-MESSAGE-TEXT (1)   15260000
152700            SET DP013-LOGIC-ABEND     TO TRUE                     15270000
152800            SET DP013-ROLLBACK        TO TRUE                     15280000
152900            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                15290000
153000     END-EVALUATE.                                                15300000
153100                                                                  15310000
153200****************************************************************  15320000
153300*    RETURNS A COUNT OF CARTONS ON A GIVEN TRAILER.            *  15330000
153400*                                                              *  15340000
153500****************************************************************  15350000
153600                                                                  15360000
153700 8050-LINK.                                                       15370000
153800     MOVE 'PCKRF743'                  TO PC047-CALLING-PROGRAM    15380000
153900     MOVE LENGTH OF PC047-COMMAREA    TO PV-COMMAREA-LENGTH       15390000
154000     EXEC CICS                                                    15400000
154100         LINK                                                     15410000
154200             PROGRAM   (PC-TRAILER-PROGRAM)                       15420000
154300             COMMAREA  (PC047-COMMAREA)                           15430000
154400             LENGTH    (PV-COMMAREA-LENGTH)                       15440000
154500     END-EXEC.                                                    15450000
154600                                                                  15460000
154700 8060-START.                                                      15470000
154710                                                                  15471001
154711     PERFORM 7500-INSERT-WRKR-AUD.                                15471101
154720                                                                  15472001
154800     INITIALIZE PC047-COMMAREA.                                   15480000
154900     SET PC047-BOTH-TOTAL             TO TRUE                     15490000
155000     MOVE PC233-OPER-UNT-ID           TO PC047-OPER-UNT-ID.       15500000
155100     MOVE PC233-DOOR-ID               TO PC047-DOOR-ID.           15510000
155200     MOVE PC233-TRIP-ID               TO PC047-OTBND-TRIP-ID.     15520000
155300     MOVE PC233-DOOR-TYPE-CDE         TO PC047-DOOR-TYPE-CDE.     15530000
155400     MOVE PC233-STR-NBR               TO PC047-DEST-OPER-UNT-ID.  15540000
155500                                                                  15550000
155600     MOVE 'PCKRF743'                  TO PC047-CALLING-PROGRAM    15560000
155700     MOVE LENGTH OF PC047-COMMAREA    TO PV-COMMAREA-LENGTH       15570000
155800                                                                  15580000
155900     EXEC CICS                                                    15590000
156000         START                                                    15600000
156100             TRANSID   ('S574')                                   15610000
156200             FROM      (PC047-COMMAREA)                           15620000
156300             LENGTH    (PV-COMMAREA-LENGTH)                       15630000
156400     END-EXEC.                                                    15640000
156500     MOVE 'Y'                         TO CA-SUMMARY-STARTED.      15650000
156600                                                                  15660000
156700 8100-RETURN-TRANID.                                              15670000
156800                                                                  15680000
156900     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       15690000
157000     EXEC CICS                                                    15700000
157100         RETURN TRANSID  (PC-TRANID)                              15710000
157200                COMMAREA (CA-COMMAREA)                            15720000
157300                LENGTH   (PV-COMMAREA-LENGTH)                     15730000
157400                RESP     (PV-CICS-RESPONSE)                       15740000
157500     END-EXEC.                                                    15750000
157600                                                                  15760000
157700     EVALUATE TRUE                                                15770000
157800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15780000
157900             CONTINUE                                             15790000
158000         WHEN OTHER                                               15800000
158100             MOVE '8100-RETURN-TRANIND'                           15810000
158200                                      TO DP013-PARAGRAPH          15820000
158300             MOVE 'PCKRF743 - UNABLE TO RETURN TO TRANID'         15830000
158400                 TO DP013-MESSAGE-TEXT (1)                        15840000
158500             SET DP013-CICS-ABEND     TO TRUE                     15850000
158600             SET DP013-ROLLBACK       TO TRUE                     15860000
158700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15870000
158800     END-EVALUATE.                                                15880000
158900                                                                  15890000
159000 8110-RETURN.                                                     15900000
159100                                                                  15910000
159200     EXEC CICS                                                    15920000
159300         SEND FROM (PV-MESSAGE-AREA)                              15930000
159400              LENGTH (19)                                         15940000
159500              ERASE                                               15950000
159600     END-EXEC.                                                    15960000
159700                                                                  15970000
159800     EXEC CICS                                                    15980000
159900         RETURN                                                   15990000
160000     END-EXEC.                                                    16000000
160100                                                                  16010000
160200 8200-XCTL.                                                       16020000
160300     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    16030000
160400     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      16040000
160500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       16050000
160600                                                                  16060000
160700     EXEC CICS                                                    16070000
160800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16080000
160900               COMMAREA  (CA-COMMAREA)                            16090000
161000               LENGTH    (PV-COMMAREA-LENGTH)                     16100000
161100               RESP      (PV-CICS-RESPONSE)                       16110000
161200     END-EXEC.                                                    16120000
161300                                                                  16130000
161400     EVALUATE TRUE                                                16140000
161500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16150000
161600             CONTINUE                                             16160000
161700         WHEN OTHER                                               16170000
161800             MOVE '8200-XCTL'                                     16180000
161900                                      TO DP013-PARAGRAPH          16190000
162000             MOVE 'PCKRF743 - UNABLE TO XCTL TO PROGRAM: '        16200000
162100                                      TO DP013-MESSAGE-TEXT (1)   16210000
162200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16220000
162300             SET DP013-CICS-ABEND                                 16230000
162400                 DP013-ROLLBACK       TO TRUE                     16240000
162500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16250000
162600             MOVE PC-TRANS-UNAVAILABLE-MSG                        16260000
162700                                      TO AMSGLNO                  16270000
162800             SET PC233-PROCESS-SCREEN TO TRUE                     16280000
162900             MOVE -1                  TO ADOORL                   16290000
163000             PERFORM 8000-SEND-MAP                                16300000
163100             PERFORM 8100-RETURN-TRANID                           16310000
163200     END-EVALUATE.                                                16320000
163300                                                                  16330000
163400 8210-XCTL-ERROR-SCREEN.                                          16340000
163500                                                                  16350000
163600     IF NOT PC233-ABEND                                           16360000
163700         SET PC233-INITIALIZE-SCREEN  TO TRUE                     16370000
163800     END-IF                                                       16380000
163900     IF PC233-PGM-MSG-NBR = ZERO                                  16390000
164000         SET  PC233-UNDEFINED-ERROR   TO TRUE                     16400000
164100     END-IF                                                       16410000
164200                                                                  16420000
164300     MOVE DFHEIBLK                    TO PC233-DFHEIBLK.          16430000
164400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       16440000
164500     MOVE 'PCKRF871'                  TO PV-TRANSFER-PROGRAM      16450000
164600                                                                  16460000
164700     EXEC CICS                                                    16470000
164800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16480000
164900               COMMAREA  (CA-COMMAREA)                            16490000
165000               LENGTH    (PV-COMMAREA-LENGTH)                     16500000
165100               RESP      (PV-CICS-RESPONSE)                       16510000
165200     END-EXEC.                                                    16520000
165300                                                                  16530000
165400     EVALUATE TRUE                                                16540000
165500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16550000
165600             CONTINUE                                             16560000
165700         WHEN OTHER                                               16570000
165800             MOVE '8200-XCTL'                                     16580000
165900                                      TO DP013-PARAGRAPH          16590000
166000             MOVE 'PCKRF743 - UNABLE TO XCTL TO PROGRAM: '        16600000
166100                                      TO DP013-MESSAGE-TEXT (1)   16610000
166200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16620000
166300             SET DP013-CICS-ABEND                                 16630000
166400                 DP013-ROLLBACK       TO TRUE                     16640000
166500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16650000
166600             MOVE PC-TRANS-UNAVAILABLE-MSG                        16660000
166700                                      TO AMSGLNO                  16670000
166800             SET PC233-PROCESS-SCREEN TO TRUE                     16680000
166900             MOVE -1                  TO ADOORL                   16690000
167000             PERFORM 8000-SEND-MAP                                16700000
167100             PERFORM 8100-RETURN-TRANID                           16710000
167200     END-EVALUATE.                                                16720000
167300                                                                  16730000
167400*                                                                 16740000
167500 8220-XCTL-TO-HELP.                                               16750000
167600                                                                  16760000
167700     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       16770000
167800                                                                  16780000
167900     EXEC CICS                                                    16790000
168000         XCTL                                                     16800000
168100             PROGRAM   (PV-TRANSFER-PROGRAM)                      16810000
168200             COMMAREA  (PC192-COMMAREA)                           16820000
168300             LENGTH    (PV-COMMAREA-LENGTH)                       16830000
168400             RESP      (PV-CICS-RESPONSE)                         16840000
168500     END-EXEC.                                                    16850000
168600                                                                  16860000
168700     EVALUATE TRUE                                                16870000
168800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16880000
168900              CONTINUE                                            16890000
169000         WHEN OTHER                                               16900000
169100             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          16910000
169200             MOVE 'PCKRF743 - UNABLE TO XCTL TO PROGRAM: '        16920000
169300                                      TO DP013-MESSAGE-TEXT (1)   16930000
169400             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16940000
169500             SET DP013-CICS-ABEND                                 16950000
169600                 DP013-ROLLBACK       TO TRUE                     16960000
169700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16970000
169800             MOVE PC-TRANS-UNAVAILABLE-MSG                        16980000
169900                                      TO AMSGLNO                  16990000
170000             SET PC233-PROCESS-SCREEN TO TRUE                     17000000
170100             MOVE -1                  TO ADOORL                   17010000
170200             PERFORM 8000-SEND-MAP                                17020000
170300             PERFORM 8100-RETURN-TRANID                           17030000
170400     END-EVALUATE.                                                17040000
170500/                                                                 17050000
170600 9000-SOFT-ABORT.                                                 17060000
170700                                                                  17070000
170800     EXEC CICS                                                    17080000
170900         SYNCPOINT ROLLBACK                                       17090000
171000     END-EXEC                                                     17100000
171100                                                                  17110000
171200     SET  PC233-DATABASE-BUSY         TO TRUE                     17120000
171300     MOVE SQLCODE                     TO PC233-SQLCODE            17130000
171400     PERFORM 8210-XCTL-ERROR-SCREEN.                              17140000
171500                                                                  17150000
171600                                                                  17160000
171700 9903-WRITE-CICS-LOG.                                             17170000
171800                                                                  17180000
171900     MOVE SQLCODE                     TO PV-SQLCODE               17190000
172000     MOVE PC233-DOOR-ID               TO PV-DISPLAY-DOOR          17200000
172100     MOVE PC233-USER-ID               TO PV-USER-ID               17210000
172200                                                                  17220000
172300     EXEC CICS                                                    17230000
172400         WRITEQ TD                                                17240000
172500             QUEUE  ('CSSL')                                      17250000
172600             FROM   (PV-LOG-MSG)                                  17260000
172700             RESP   (PV-CICS-RESPONSE)                            17270000
172800     END-EXEC.                                                    17280000
172900                                                                  17290000
173000 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  17300000
173100                                                                  17310000
173200     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           17320000
173300     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          17330000
173400     INITIALIZE DP013-SRC-TASK-NUMBER                             17340000
173500                DP013-STACK.                                      17350000
173600     SET DP013-LINK-RETURN            TO TRUE.                    17360000
173700                                                                  17370000
173800     EXEC CICS                                                    17380000
173900         LINK                                                     17390000
174000             PROGRAM   (DP013-NAME)                               17400000
174100             COMMAREA  (DP013-PARAMETERS)                         17410000
174200             LENGTH    (DP013-LENGTH)                             17420000
174300     END-EXEC.                                                    17430000
174400                                                                  17440000
174500 999A-WRITE-CSSL-MSG.                                             17450000
174600                                                                  17460000
174700     MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH.      17470000
174800                                                                  17480000
174900     EXEC CICS                                                    17490000
175000         WRITEQ TD                                                17500000
175100             QUEUE  ('CSSL')                                      17510000
175200             FROM   (PV-CICS-MSG-AREA2)                           17520000
175300           LENGTH   (PV-COMMAREA-LENGTH)                          17530000
175400             RESP   (PV-CICS-RESPONSE)                            17540000
175500     END-EXEC.                                                    17550000
175600                                                                  17560000
