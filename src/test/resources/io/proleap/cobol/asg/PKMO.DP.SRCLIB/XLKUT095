000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT095.                                         00040003
000500 AUTHOR.        ANIL VEDURUPARTHI.                                00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   APR 2021.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS BATCH DB2 PROGRAM READS THE FILE CREATED BY XLKUT011    * 00100000
001100*  CONTAINING VND STYL XREF INFORMATION.  THIS DATA IS INSERTED * 00110000
001200*  THE XLT_VND_STYL TABLE.                                      * 00120000
001300***************************************************************** 00130000
001400***************************************************************** 00140000
001500* CHANGE DESCRIPTION                                              00150000
001600***************************************************************** 00160000
001700* DATE  MM/DD/YYYY                                                00170018
001800*  MADE BY: XXXXX XXXXX     TKID:XXXXXXX                          00180000
001900*  XXXXXXXXXXXXXX XXXXXXXXXXX XXXXXXXXXX                          00190000
001901***************************************************************** 00190100
001902 ENVIRONMENT DIVISION.                                            00190200
001903 INPUT-OUTPUT SECTION.                                            00190300
001904                                                                  00190400
001905 FILE-CONTROL.                                                    00190500
001906                                                                  00190600
001907     SELECT STYL-UPDATE-FILE                                      00190700
002000         ASSIGN TO INP01.                                         00200000
002100                                                                  00210000
002200***************************************************************** 00220000
002300 DATA DIVISION.                                                   00230000
002400***************************************************************** 00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  STYL-UPDATE-FILE                                             00270000
002800     RECORDING MODE IS F                                          00280000
002810     BLOCK CONTAINS 0 RECORDS                                     00281000
002820     LABEL RECORDS ARE STANDARD.                                  00282000
002830                                                                  00283000
002840 01  STYL-UPDATE-FILE-RECORD      PIC X(150).                     00284000
002850                                                                  00285000
002860                                                                  00286000
002870***************************************************************** 00287000
002880 WORKING-STORAGE SECTION.                                         00288000
002890                                                                  00289000
002900 01  PA-DB2-COMMIT-COUNT              PIC S9(09) VALUE +0         00290000
003000                                                    COMP-3.       00300000
003100 01  PS-PROGRAM-SWITCHES.                                         00310000
003200     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00320000
003300         88  PS-EOF-INPUT-YES                    VALUE 'Y'.       00330000
003400         88  PS-EOF-INPUT-NO                     VALUE 'N'.       00340000
003500                                                                  00350000
003600 01  PC-PROGRAM-CONSTANTS.                                        00360000
003700     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT095'.00370004
003800                                                                  00380000
003900 01  PV-PROGRAM-VARIABLES.                                        00390000
004000     05  PV-RECORDS-READ              PIC  9(09) VALUE  0.        00400000
004000     05  PV-RECORDS-READ-A            PIC  9(09) VALUE  0.        00401016
004000     05  PV-RECORDS-READ-O            PIC  9(09) VALUE  0.        00402016
004100     05  PV-RECORDS-UPDATE            PIC  9(09) VALUE  0.        00410000
004110     05  PV-RECORDS-INSERTED          PIC  9(09) VALUE  0.        00411000
004110     05  PV-BRND-ID-NOT-FND           PIC  9(09) VALUE  0.        00412010
004200     05  PV-DISP-INTR-UPC-ID          PIC  9(09) VALUE  0.        00420000
004210     05  PV-DISP-UPC-ID               PIC  9(09) VALUE  0.        00421000
004300     05  PV-DISP-ITM-NBR              PIC  9(15) VALUE  0.        00430000
004301     05  PV-DISP-SKU                  PIC  9(08) VALUE  0.        00430100
004302     05  PV-DISP-STYL-ID              PIC  9(08) VALUE  0.        00430200
004302     05  PV-DISP-LBL-SEQ-NBR          PIC  9(04) VALUE  0.        00430305
004400     05  PV-SQLCODE                   PIC  S9(9) VALUE +0.        00440000
004400         88 PV-SQLCODE-SUCCESS                   VALUE +0.        00441014
004400         88 PV-SQLCODE-NOT-FOUND                 VALUE +100.      00442014
004500     05  PV-DISP-SQLCODE              PIC ZZZZZZ9-.               00450000
004600                                                                  00460000
004700                                                                  00470000
004800 01  PV-ABEND-FIELDS.                                             00480000
004900     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         00490000
005000                                                 COMP SYNC.       00500000
005100     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT095'.00510004
005200     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00520000
005300     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00530000
005400     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    00540000
005500     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    00550000
005600     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    00560000
005700     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    00570000
005800                                                                  00580000
005900                                                                  00590000
006000***********************************************************       00600000
006100*  COPYBOOK USED FOR THE VND STYL ERROR INPUT FILE        *       00610001
006200***********************************************************       00620000
006300     COPY XLRD007.                                                00630001
006400                                                                  00640000
006500***********************************************************       00650000
006600*  USED FOR DB2 ERROR MESSAGE BUILDING                    *       00660000
006700***********************************************************       00670000
006800     COPY DPWS004.                                                00680000
006900                                                                  00690000
007000***********************************************************       00700000
007100*  DB2 SQL COMMUNICATION AREA                             *       00710000
007200***********************************************************       00720000
007300     EXEC SQL                                                     00730000
007400          INCLUDE SQLCA                                           00740000
007500     END-EXEC.                                                    00750000
007600                                                                  00760000
007700***********************************************************       00770000
007800*  XLT_VND_STYL TABLE                                     *       00780001
007900***********************************************************       00790000
008000     EXEC SQL                                                     00800000
008100          INCLUDE XLT00004                                        00810001
008200     END-EXEC.                                                    00820000
008300                                                                  00830000
007700***********************************************************       00831006
007800*  BRND_ID TABLE                                          *       00832006
007900***********************************************************       00833006
008000     EXEC SQL                                                     00834006
008100          INCLUDE XLT00043                                        00835006
008200     END-EXEC.                                                    00836006
008300                                                                  00837006
008400***************************************************************** 00840000
008500 PROCEDURE DIVISION.                                              00850000
008600***************************************************************** 00860000
008700     DISPLAY '**** BEGINNING XLKUT095 ****'.                      00870004
008800     DISPLAY ' '.                                                 00880000
008900                                                                  00890000
009000     OPEN INPUT  STYL-UPDATE-FILE.                                00900000
009100                                                                  00910000
009200     PERFORM 1000-READ-INPUT-FILE.                                00920000
009300                                                                  00930000
009400     PERFORM 2000-PROCESS-INPUT-FILE                              00940000
009500       UNTIL PS-EOF-INPUT-YES.                                    00950000
009600                                                                  00960000
009700     CLOSE STYL-UPDATE-FILE.                                      00970000
009800                                                                  00980000
009900     PERFORM 3000-TABLE-COMMIT.                                   00990000
010000                                                                  01000000
010400     DISPLAY '****  XLKUT095 COUNTS  ****'.                       01001017
010100     DISPLAY '  INPUT VND STYL RECS READ  = ' PV-RECORDS-READ.    01010002
010100     DISPLAY '  SOR RECORDS READ          = ' PV-RECORDS-READ-A.  01010118
010100     DISPLAY '  XL INPUT RECORDS BYPASSED = ' PV-RECORDS-READ-O.  01010218
010100     DISPLAY '  BRND_ID NOT FOUND         = ' PV-BRND-ID-NOT-FND. 01011010
010200     DISPLAY '  XLT_VND_STYL ROWS UPDATED = ' PV-RECORDS-UPDATE.  01020111
010210     DISPLAY '  XLT_VND_STYL INSERTED     = '                     01021013
010210                                           PV-RECORDS-INSERTED.   01022013
010300     DISPLAY ' '.                                                 01030000
010400     DISPLAY '****  END OF  XLKUT095  ****'.                      01040004
010500                                                                  01050000
010600     GOBACK.                                                      01060000
010700                                                                  01070000
010800                                                                  01080000
010900***************************************************************** 01090000
011000*  READ A UPC ADD EXTRACT RECORD THAT WILL BE USED TO UPDATE    * 01100000
011100*  A ROW OF DATA INTO THE XLT_VND_STYL TABLE.                   * 01110002
011200***************************************************************** 01120000
011300 1000-READ-INPUT-FILE.                                            01130000
011400                                                                  01140000
011500     MOVE '1000-READ-INPUT-FILE    ' TO PV-ABEND-PARAGRAPH.       01150000
011600                                                                  01160000
011700     INITIALIZE XL007-STYLE-RECORD                                01170001
011800                PA-DB2-COMMIT-COUNT.                              01180000
011900                                                                  01190000
012000     READ STYL-UPDATE-FILE                                        01200000
012100          INTO XL007-STYLE-RECORD                                 01210001
012200            AT END                                                01220000
012300               SET PS-EOF-INPUT-YES TO TRUE                       01230000
012400                                                                  01240000
012500            NOT AT END                                            01250000
012600               SET PS-EOF-INPUT-NO  TO TRUE                       01260000
012700               ADD +1 TO PV-RECORDS-READ                          01270000
012800     END-READ.                                                    01280000
012900                                                                  01290000
013000                                                                  01300000
013100***************************************************************** 01310000
013200*  LOAD THE INFORMATION FROM THE UPC ADD EXTRACT FILE INTO THE  * 01320000
013300*  HOST VARIABLES AND PERFORM A PARAGRAPH TO INSERT THE NEW ROW * 01330000
013400*  INTO THE XLT_VND_STYL TABLE.                                 * 01340002
013500***************************************************************** 01350000
013600 2000-PROCESS-INPUT-FILE.                                         01360000
013700                                                                  01370000
013800     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       01380000
013900                                                                  01390000
014000     IF XL007-FILE-INDICATOR = 'A'                                01400001
              ADD 01 TO  PV-RECORDS-READ-A                              01400116
                                                                        01400216
              MOVE XL007-LBL-SEQ-NBR       TO XLT00043-BRND-ID          01401005
014100        PERFORM 2100-CHECK-BRAND-FIRST                            01410005
              IF PV-SQLCODE-SUCCESS                                     01410114
014100           PERFORM 2200-UPD-INS-STYL-TABLE                        01411015
014200        END-IF                                                    01420005
           ELSE                                                         01421016
              ADD 01 TO  PV-RECORDS-READ-O                              01422016
014200     END-IF.                                                      01430005
014900                                                                  01490000
015000     PERFORM 1000-READ-INPUT-FILE.                                01500000
015100                                                                  01510000
015300***************************************************************** 01510105
015400*  CHECK FOR BRND_ID FROM XLT_BRND TABLE                          01510205
015500***************************************************************** 01510305
       2100-CHECK-BRAND-FIRST.                                          01511005
                                                                        01512005
043511     EXEC SQL                                                     01513005
023400         SELECT BRND_ID                                           01514005
                  INTO :XLT00043-BRND-ID                                01515005
023800          FROM  XLT_BRND                                          01516005
                WHERE BRND_ID            = :XLT00043-BRND-ID            01517005
 25800     END-EXEC.                                                    01518005
                                                                        01519005
           MOVE SQLCODE TO PV-SQLCODE.                                  01519114
                                                                        01519214
299800     EVALUATE TRUE                                                01519305
299900         WHEN PV-SQLCODE-SUCCESS                                  01519414
300200              CONTINUE                                            01519514
300300         WHEN PV-SQLCODE-NOT-FOUND                                01519614
                    ADD 01 TO PV-BRND-ID-NOT-FND                        01519710
018700              MOVE XL007-STYL-ID        TO PV-DISP-STYL-ID        01519806
                    MOVE XL007-LBL-SEQ-NBR    TO PV-DISP-LBL-SEQ-NBR    01519906
018800              STRING ' STYL-ID '    DELIMITED BY SIZE             01520009
018900                     PV-DISP-STYL-ID    DELIMITED BY SIZE         01520106
018800                     ' VS-NBR '    DELIMITED BY SIZE              01520209
018900                     XL007-VS-NBR       DELIMITED BY SIZE         01520306
018800                     ' BRND-ID '    DELIMITED BY SIZE             01520409
018900                     PV-DISP-LBL-SEQ-NBR DELIMITED BY SIZE        01520506
019000                     ' NOT FOUND ON BRND_ID   '                   01520606
019100                                       DELIMITED BY SIZE          01520706
026700                                   INTO PV-DB2-OPERATION-MESSAGE-101520806
026800              DISPLAY '*** MESSAGE   = '                          01520906
026900                                        PV-DB2-OPERATION-MESSAGE-101521006
300600         WHEN OTHER                                               01521106
026912              MOVE '2100-CHECK-BRAND-FIRST'                       01521208
026913                                     TO PV-ABEND-PARAGRAPH        01521308
026914              MOVE 'SELECT BRND_ID'                               01521408
026915                                     TO PV-ABEND-OPERATION        01521508
018700              MOVE XL007-STYL-ID     TO PV-DISP-STYL-ID           01521608
                    MOVE XL007-LBL-SEQ-NBR TO PV-DISP-LBL-SEQ-NBR       01521708
018800              STRING ' STYL-ID     '    DELIMITED BY SIZE         01521808
018900                     PV-DISP-STYL-ID    DELIMITED BY SIZE         01521908
018800                     ' VS-NBR      '    DELIMITED BY SIZE         01522008
018900                     XL007-VS-NBR       DELIMITED BY SIZE         01522108
018800                     ' BRND-ID     '    DELIMITED BY SIZE         01522208
018900                     PV-DISP-LBL-SEQ-NBR DELIMITED BY SIZE        01522308
026919                                   INTO PV-DB2-OPERATION-MESSAGE-101522508
026920                                                                  01522608
026921              MOVE 'BRND_ID'    TO PV-ABEND-TABLE                 01522708
026922              PERFORM Z999-SQL-ABEND                              01522808
300800     END-EVALUATE.                                                01522906
015200                                                                  01523006
015300***************************************************************** 01530000
015400*  UPDATE THE VND STYL TABLE                                      01540001
015500***************************************************************** 01550000
015600 2200-UPD-INS-STYL-TABLE.                                         01560015
015700                                                                  01570000
015800     MOVE XL007-STYL-ID              TO XLT00004-STYL-ID.         01580001
015900     MOVE XL007-DEPT-NBR             TO XLT00004-DEPT-NBR.        01590001
016000     MOVE XL007-MAJ-CL-NBR           TO XLT00004-MAJ-CL-NBR.      01600001
016100     MOVE XL007-SUB-CL-NBR           TO XLT00004-SUB-CL-NBR.      01610001
016200     MOVE XL007-VS-ID                TO XLT00004-VS-ID.           01620001
016300     MOVE XL007-VS-NBR               TO XLT00004-VS-NBR.          01630001
016400     MOVE XL007-ENT-ID               TO XLT00004-ENT-ID.          01640001
016500     MOVE XL007-STKR-NBR             TO XLT00004-STKR-NBR.        01650001
016600     MOVE XL007-TKT-TYP-DESC         TO XLT00004-TKT-TYP-DESC.    01660001
016700     MOVE XL007-HNG-FOLD-DESC        TO XLT00004-HNG-FOLD-DESC.   01670001
016800     MOVE XL007-VS-DESC              TO XLT00004-VS-DESC.         01680001
016900     MOVE XL007-LBL-SEQ-NBR          TO XLT00004-BRND-ID.         01690001
017602                                                                  01760200
017603*TO INCLUDE THE NEW WAREHOUSE INDICATOR TO THE XLT_VND_STYL *     01760301
017605     EXEC SQL                                                     01760500
017606          UPDATE XLT_VND_STYL                                     01760601
017608       SET   DEPT_NBR       = :XLT00004-DEPT-NBR                  01760801
017609            ,MAJ_CL_NBR     = :XLT00004-MAJ-CL-NBR                01760901
017610            ,SUB_CL_NBR     = :XLT00004-SUB-CL-NBR                01761001
017620            ,VS_ID          = :XLT00004-VS-ID                     01762001
017630            ,VS_NBR         = :XLT00004-VS-NBR                    01763001
017640            ,ENT_ID         = :XLT00004-ENT-ID                    01764001
017650            ,STKR_NBR       = :XLT00004-STKR-NBR                  01765001
017660            ,TKT_TYP_DESC   = :XLT00004-TKT-TYP-DESC              01766001
017670            ,HNG_FOLD_DESC  = :XLT00004-HNG-FOLD-DESC             01767001
017680            ,LAST_UPD_TMST  = CURRENT TIMESTAMP                   01768001
017690            ,VS_DESC        = :XLT00004-VS-DESC                   01769001
017700            ,BRND_ID        = :XLT00004-BRND-ID                   01770001
018201       WHERE STYL_ID        = :XLT00004-STYL-ID                   01820101
018202     END-EXEC.                                                    01820302
018203                                                                  01820402
018204     EVALUATE TRUE                                                01820502
018205         WHEN SQLCODE = ZERO                                      01820602
018206              ADD +1                 TO PV-RECORDS-UPDATE         01820702
018207              ADD +1                 TO PA-DB2-COMMIT-COUNT       01820802
018208              IF PA-DB2-COMMIT-COUNT > 200                        01820902
018300                  PERFORM 3000-TABLE-COMMIT                       01830000
018400                  MOVE 0 TO PA-DB2-COMMIT-COUNT                   01840000
018500              END-IF                                              01850000
018600         WHEN SQLCODE = +100                                      01860000
018700              MOVE XLT00004-STYL-ID     TO PV-DISP-STYL-ID        01870002
018800              STRING ' STYL-ID '   DELIMITED BY SIZE              01880009
018900                     PV-DISP-STYL-ID    DELIMITED BY SIZE         01890002
019000                     ' NOT FOUND ON XLT_VND_STYL   '              01900001
019100                                       DELIMITED BY SIZE          01910000
026700                                   INTO PV-DB2-OPERATION-MESSAGE-102670000
026800              DISPLAY '*** MESSAGE   = '                          02680000
026900                                        PV-DB2-OPERATION-MESSAGE-102690000
026901              PERFORM 2300-INSERT-STYL                            02690105
026902         WHEN SQLCODE = -803                                      02690200
026903              MOVE XLT00004-STYL-ID     TO PV-DISP-STYL-ID        02690302
026904              STRING ' STYL-ID '   DELIMITED BY SIZE              02690402
026905                     PV-DISP-INTR-UPC-ID DELIMITED BY SIZE        02690500
026906                     ' ALREADY EXISTS ON XLT_VND_STYL ON UPD'     02690601
026907                                       DELIMITED BY SIZE          02690700
026908                                   INTO PV-DB2-OPERATION-MESSAGE-102690800
026909              DISPLAY '*** MESSAGE   = '                          02690900
026910                                        PV-DB2-OPERATION-MESSAGE-102691000
026911         WHEN SQLCODE NOT = +0                                    02691100
026912              MOVE '2200-UPD-INS-STYL-TABLE'                      02691215
026913                                     TO PV-ABEND-PARAGRAPH        02691302
026914              MOVE 'UPDATE XLT_VND_STYL'                          02691401
026915                                     TO PV-ABEND-OPERATION        02691500
026916              MOVE XLT00004-STYL-ID  TO PV-DISP-STYL-ID           02691602
026917              STRING 'STYL-ID    : '          DELIMITED BY SIZE   02691702
026918                     PV-DISP-STYL-ID          DELIMITED BY SIZE   02691802
026919                                   INTO PV-DB2-OPERATION-MESSAGE-102691900
026920                                                                  02692000
026921              MOVE 'XLT_VND_STYL'    TO PV-ABEND-TABLE            02692102
026922              PERFORM Z999-SQL-ABEND                              02692200
026923     END-EVALUATE.                                                02692300
026924                                                                  02692400
026925                                                                  02692500
026926***************************************************************** 02692600
026927* INSERT TO XLT_VND_STYL                                        * 02692701
026928***************************************************************** 02692800
026929 2300-INSERT-STYL.                                                02692905
026930                                                                  02693000
026940*TO INCLUDE THE NEW WAREHOUSE INDICATOR TO THE XLT_VND_STYL *     02694001
026942     EXEC SQL                                                     02694200
026943          INSERT                                                  02694300
026944          INTO  XLT_VND_STYL                                      02694401
026944              ( STYL_ID                                           02694501
026945               ,DEPT_NBR                                          02694601
026946               ,MAJ_CL_NBR                                        02694701
026947               ,SUB_CL_NBR                                        02694801
026948               ,VS_ID                                             02694901
026949               ,VS_NBR                                            02695001
026950               ,ENT_ID                                            02695101
026951               ,STKR_NBR                                          02695201
026952               ,TKT_TYP_DESC                                      02695301
026953               ,HNG_FOLD_DESC                                     02695401
026954               ,LAST_UPD_TMST                                     02695501
026955               ,VS_DESC                                           02695601
026956               ,BRND_ID)                                          02695701
026982          VALUES                                                  02698200
026983             (   :XLT00004-STYL-ID                                02698301
026983               , :XLT00004-DEPT-NBR                               02698401
026984               , :XLT00004-MAJ-CL-NBR                             02698501
026985               , :XLT00004-SUB-CL-NBR                             02698601
026986               , :XLT00004-VS-ID                                  02698701
026987               , :XLT00004-VS-NBR                                 02698801
026988               , :XLT00004-ENT-ID                                 02698901
026989               , :XLT00004-STKR-NBR                               02699001
026990               , :XLT00004-TKT-TYP-DESC                           02699101
026991               , :XLT00004-HNG-FOLD-DESC                          02699201
026992               , CURRENT TIMESTAMP                                02699301
026993               , :XLT00004-VS-DESC                                02699401
026994               , :XLT00004-BRND-ID )                              02699501
027002     END-EXEC.                                                    02700301
027003                                                                  02700401
027004     EVALUATE TRUE                                                02700501
027005         WHEN SQLCODE = ZERO                                      02700601
027006              ADD +1                 TO PV-RECORDS-INSERTED       02700701
027007         WHEN SQLCODE = -803                                      02700801
027008              MOVE XLT00004-STYL-ID     TO PV-DISP-INTR-UPC-ID    02700901
027009              STRING ' INTR UPC ID '   DELIMITED BY SIZE          02701001
027010                     PV-DISP-INTR-UPC-ID DELIMITED BY SIZE        02701101
027020                     ' ALREADY EXISTS ON XLT_VND_STYL ON INSERT ' 02702002
027021                                       DELIMITED BY SIZE          02702100
027022                                   INTO PV-DB2-OPERATION-MESSAGE-102702200
027023              DISPLAY '*** MESSAGE   = '                          02702300
027024                                        PV-DB2-OPERATION-MESSAGE-102702400
027025         WHEN SQLCODE = -530                                      02702500
027026              MOVE XLT00004-STYL-ID TO PV-DISP-STYL-ID            02702601
027029              STRING ' SKU '           DELIMITED BY SIZE          02702900
027030                     PV-DISP-SKU       DELIMITED BY SIZE          02703000
027040                     ' NOT INSERTED DUE TO RI FOR STYLE '         02704000
027050                                       DELIMITED BY SIZE          02705000
027051                     PV-DISP-STYL-ID   DELIMITED BY SIZE          02705100
027052                                   INTO PV-DB2-OPERATION-MESSAGE-102705200
027053              DISPLAY '*** MESSAGE   = '                          02705300
027054                                        PV-DB2-OPERATION-MESSAGE-102705400
027055         WHEN SQLCODE NOT = +0                                    02705500
027056              MOVE '2200-INSERT-XLT-SKU'                          02705605
027057                                     TO PV-ABEND-PARAGRAPH        02705700
027058              MOVE 'INSERT XLT_VND_STYL'                          02705802
027059                                     TO PV-ABEND-OPERATION        02705900
027060              MOVE XLT00004-STYL-ID  TO PV-DISP-STYL-ID           02706002
027062              STRING 'STYL-ID : '             DELIMITED BY SIZE   02706202
027063                     PV-DISP-STYL-ID          DELIMITED BY SIZE   02706302
027066                                   INTO PV-DB2-OPERATION-MESSAGE-102706600
027067                                                                  02706700
027068              MOVE 'XLT_VND_STYL'    TO PV-ABEND-TABLE            02706802
027069              PERFORM Z999-SQL-ABEND                              02706900
027100     END-EVALUATE.                                                02710000
027200                                                                  02720000
027300                                                                  02730000
027301***************************************************************** 02730100
027302* COMMIT THE PENDING TABLE CHANGES.                             * 02730200
027303***************************************************************** 02730300
027304 3000-TABLE-COMMIT.                                               02730400
027305                                                                  02730500
027306     EXEC SQL                                                     02730600
027307          COMMIT                                                  02730700
027308     END-EXEC.                                                    02730800
027309                                                                  02730900
027310                                                                  02731000
027311***************************************************************** 02731100
027312*  DISPLAY DB2 ERROR INFORMATION, ROLLBACK ANY PENDING CHANGES, * 02731200
027313*  AND ABEND THE PROGRAM.                                       * 02731300
027314***************************************************************** 02731400
027315 Z999-SQL-ABEND.                                                  02731500
027316                                                                  02731600
027317     MOVE SQLCODE            TO PV-SQLCODE.                       02731700
027318     MOVE PV-SQLCODE         TO PV-DISP-SQLCODE.                  02731800
027319     DISPLAY '*** DB2 ERROR '.                                    02731900
027320     DISPLAY '*** SQLCODE   = ' PV-DISP-SQLCODE.                  02732000
027321     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 02732100
027322     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               02732200
027323     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               02732300
027324     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       02732400
027325     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       02732500
027326     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       02732600
027327     DISPLAY '*** TABLE 1   = ' PV-ABEND-TABLE.                   02732700
027328                                                                  02732800
027329     COPY DPPD004.                                                02732900
027330                                                                  02733000
027331     MOVE +4013         TO PV-ABEND-CODE.                         02733100
027332     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         02733200
