000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT043.                                        00020000
000300 AUTHOR.         M WILKINSON.                                     00030000
000400*DATE-WRITTEN.   NOV 15, 1996.                                    00040000
000500*DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060002
000601*    COBOL 2                                                     *00060102
000602*                                                                *00060202
000603*    UPDATE RECEIVING KEYS FILE WITH MATCH LOCATION FROM         *00060308
000604*    INVOICE EXTRACT.                                            *00060408
000607*                                                                *00060702
000610*    THE PURPOSE OF THIS PROGRAM IS TO PREPARE THE RECEIVING     *00061002
000611*    KEYS FILE BASED ON THE INVOICE MATCH LOCATION SO THAT THE   *00061102
000612*    ASSOCIATED RECEIVERS AND NIR CAN BE UPDATED TO 'MATCHED'    *00061202
000613*    IN PROGRAM APKUP025.                                        *00061302
000620*                                                                *00062002
000630*    THIS PROGRAM WILL BE EXECUTED TWICE IN JOB APK025, ONCE     *00063002
000640*    WITH THE INVOICE FILE CONTAINING ONLY MATCH LEVELS P AND S, *00064002
000650*    AND THE KEYS FILE SORTED BY PO/SORT STORE.  THE SECOND RUN  *00065002
000660*    THE INVOICE FILE WILL CONTAIN ONLY MATCH LEVEL D, AND THE   *00066002
000670*    KEYS FILE WILL BE SORTED BY DC NUMBER.  IN BOTH CASES, THE  *00067002
000680*    INVOICE FILE WILL BE SORTED BY PO/MATCH LOCATION.           *00068002
000690*                                                                *00069002
001000*    WRITE RECEIVER AND NINREC KEYS WHEN MATCH LEVEL IS PO,      *00100002
001001*    REPLACING SORT STORE NUMBER WITH MATCH LOCATION.            *00100102
001030*                                                                *00103002
001100*    WRITE RECEIVER DETAIL AND NINREC KEYS WHEN MATCH LEVEL      *00110002
001200*    IS STORE.  ORIGINAL SORT STORE NUMBER IS KEPT.              *00120002
001201*                                                                *00120102
001202*    WRITE RECEIVER AND NINREC KEYS WHEN MATCH LEVEL IS DC,      *00120202
001203*    REPLACING SORT STORE NUMBER WITH MATCH LOCATION.            *00120302
001210*----------------------------------------------------------------*00121002
001400*                                                                *00140002
001500* INPUT                                                          *00150002
001600*   1. INVOICE FILE                      COPYBOOK APRD060        *00160002
001700*   2. RECEIVER KEYS EXTRACT FILE        COPYBOOK APRD024        *00170002
001800*                                                                *00180002
001900* OUTPUT                                                         *00190002
002000*   1. RECEIVER UPDATE KEYS FILE         COPYBOOK APRD024        *00200002
002100*                                                                *00210002
002110*----------------------------------------------------------------*00211002
002300* CHANGE LOG:                                                    *00230002
002400*                                                                *00240002
002500* 11/15/96  INITIAL VERSION.                                     *00250002
002600*                                                                *00260002
002700* 01/16/98  RECOMPILED DUE TO ADDITIONAL FIELD IN COPYBOOK       *00270002
002800*           APRD060.                                             *00280002
002900*           BY:  MARK BURNSIDE                   WR# 4164        *00290002
003000*                                                                *00300002
003100* DATE  03/11/2007                                               *00310002
003200*     CHANGE MADE: MATCH BY DC PROJECT                           *00320002
003300*     IN B200-, REPLACED THE CHECK OF AP060-STR-NBR VALUE WITH   *00330002
003400*     AP060-MTCH-LVL-CDE.  ADDED AN ADDL CHECK FOR DC MATCH      *00340002
003500*     LEVEL.  CREATED A NEW PARA C200- TO PROCESS THE DC MATCH   *00350002
003600*     LEVEL HITS.  IN C100-, ADDED MOVES OF AP060-MTCH-LOC-NBR   *00360002
003700*     TO AP024-SRT-STORE-NBR.  CREATED NEW PARA W150- TO         *00370002
003800*     KEEP TRACK OF DC MATCH LEVEL RECS WRITTEN OUT.             *00380002
003900*     MADE BY: MIKE BESKE               WR/IR #: WR21578         *00390002
004000*                                                                *00400002
004010* DATE  03/28/2007                                               *00401002
004020*     CHANGE MADE: MATCH BY DC PROJECT                           *00402002
004030*     CORRECTED  PARA C200- TO PROCESS THE DC MATCH              *00403002
004040*     LEVEL HIT NINREC CORRECTLY. ADDED CONDITIONS TO CHECK      *00404002
004050*     AP024-SRT-STORE-NBR AGAINST AP06-MTCH-LOC-NBR              *00405002
004060*     MADE BY: GREG WISIALOWSKI         WR/IR #: P001001258      *00406002
004070*                                                                *00407002
004071*DATE  03/10/2010                                                *00407109
004072*    CHANGE MADE: CORRECTED LOGIC IN THE DC MATCH PROCESSING TO  *00407209
004073*    COMPARE THE MATCH LOCATION ON THE INVOICE TO THE DC NUMBER  *00407309
004074*    ON THE RECEIVING FILES AND WRITE ALL RECEIV AND NINREC      *00407409
004075*    RECORDS WHERE THE PO/DC NUMBER MATCH.  THE SORT STORE NUMBER*00407509
004076*    IS REPLACED WITH THE MATCH LOCATION BEFORE WRITING THE      *00407609
004077*    RECORD.  RENUMBERED AND REORGANIZED PARAGRAPHS TO CORRESPOND*00407709
004078*    TO STANDARD AP PARAGRAPH NUMBERING AND FLOW.  ADDED 'READ   *00407809
004079*    UNTIL' LOGIC IN B200 TO ALLOW THE INPUT FILES TO PROCESS    *00407909
004080*    MORE QUICKLY WHEN BYPASSING RECORDS WHERE THE PO NUMBERS    *00408009
004081*    DON'T MATCH.  ADDED AND MODIFIED PROGRAM DOCUMENTATION WHERE*00408109
004082*    IT WAS INSUFFICIENT.  REMOVED UNACCESSED CODE.              *00408209
004083*    MADE BY: NANCY EILBES             WR/IR #: PKE000000003111  *00408309
004085*                                                                *00408509
004071*DATE  05/11/2021                                                *00408611
004082*    RECOMPILE FOR UPDATED APWS008 COPYBOOK                      *00408710
004083*    MADE BY: JEAN KURK                WR/IR #: CHG0256545       *00408810
004090*----------------------------------------------------------------*00409009
004100 ENVIRONMENT DIVISION.                                            00410000
004200                                                                  00420000
004300 INPUT-OUTPUT SECTION.                                            00430000
004400                                                                  00440000
004500 FILE-CONTROL.                                                    00450000
004600     SELECT INVOICES-FILE      ASSIGN    TO UT-S-INP01.           00460000
004700     SELECT RECEIV-FILE        ASSIGN    TO UT-S-INP02.           00470000
004800     SELECT RCVKEYS-FILE       ASSIGN    TO UT-S-OUT01.           00480000
004900 DATA DIVISION.                                                   00490000
005000                                                                  00500000
005100 FILE SECTION.                                                    00510000
005200 FD  INVOICES-FILE                                                00520000
005300         LABEL RECORDS  ARE STANDARD                              00530000
005400         RECORDING MODE IS  F                                     00540000
005500         DATA RECORD    IS  INVOICE-RECORD.                       00550000
005600                                                                  00560000
005700 01  INVOICE-RECORD                PIC X(175).                    00570000
005800                                                                  00580000
005900 FD  RECEIV-FILE                                                  00590000
006000         LABEL RECORDS  ARE STANDARD                              00600000
006100         RECORDING MODE IS  F                                     00610000
006200         DATA RECORD    IS  RECEIV-RECORD-IN.                     00620000
006300                                                                  00630000
006400 01  RECEIV-RECORD-IN              PIC X(100).                    00640000
006500                                                                  00650000
006600 FD  RCVKEYS-FILE                                                 00660000
006700         LABEL RECORDS  ARE STANDARD                              00670000
006800         RECORDING MODE IS  F                                     00680000
006900         DATA RECORD    IS  KEYS-RECORD.                          00690000
007000                                                                  00700000
007100 01  KEYS-RECORD                   PIC X(100).                    00710000
007200                                                                  00720000
007300/                                                                 00730000
007400 WORKING-STORAGE SECTION.                                         00740000
007500                                                                  00750000
007600 01  FILLER                        PIC X(25) VALUE                00760000
007700                             'WS FOR APKUT043 BEGINS==>'.         00770000
007800 01  ABEND-CODE                    PIC S9(4) COMP SYNC            00780000
007900                                             VALUE ZEROS.         00790000
008000                                                                  00800000
008100 01  PV-ABEND-FIELDS.                                             00810000
008200     05  PV-ABEND-PROGRAM             PIC X(8)  VALUE 'APKUT043'. 00820000
008300     05  PV-ABEND-SQLCODE             PIC X(4)  VALUE SPACES.     00830000
008400     05  PV-ABEND-PARAGRAPH           PIC X(50) VALUE SPACES.     00840000
008500     05  PV-ABEND-OPERATION           PIC X(50) VALUE SPACES.     00850000
008600     05  PV-ABEND-STRUCTURE-1         PIC X(8)  VALUE SPACES.     00860000
008700     05  PV-ABEND-STRUCTURE-2         PIC X(8)  VALUE SPACES.     00870000
008800     05  PV-ABEND-STRUCTURE-3         PIC X(8)  VALUE SPACES.     00880000
008900     05  PV-ABEND-STRUCTURE-4         PIC X(8)  VALUE SPACES.     00890000
009000     05  PV-ABEND-STATUS              PIC XX    VALUE SPACES.     00900000
009100                                                                  00910000
009200 01  PV-WORK-AREA.                                                00920000
009300     05  PV-PROGRAM-NAME         PIC X(08)     VALUE 'APKUT043'.  00930000
009400     05  PV-INVOICE-IN-REC-CNT   PIC 9(09)     VALUE 0.           00940000
009500     05  PV-RECEIV-IN-REC-CNT    PIC 9(09)     VALUE 0.           00950000
009600     05  PV-RECEIV-OUT-REC-CNT   PIC 9(09)     VALUE 0.           00960000
009700     05  PV-RECEIV-OUT-DC-REC-CNT  PIC 9(09)   VALUE 0.           00970000
009800     05  PV-RECEIV-OUT-STR-REC-CNT PIC 9(09)   VALUE 0.           00980000
009900*                                                                 00990000
010000 01  PV-SWITCHES.                                                 01000000
010100     05  END-OF-INVOICE-SW       PIC X(01) VALUE 'N'.             01010000
010200         88  END-OF-INVOICES               VALUE 'Y'.             01020000
010300         88  NOT-END-OF-INVOICES           VALUE 'N'.             01030000
010400     05  END-OF-RECEIV-SW        PIC X(01) VALUE 'N'.             01040000
010500         88  END-OF-RECEIV                 VALUE 'Y'.             01050000
010600         88  NOT-END-OF-RECEIV             VALUE 'N'.             01060000
010700                                                                  01070000
010911*----------------------------------------------------------------*01091102
010920*  INVOICE EXTRACT LAYOUT                                        *01092002
010921*----------------------------------------------------------------*01092102
011000     COPY APRD060.                                                01100000
011100                                                                  01110000
011101*----------------------------------------------------------------*01110102
011120*  RECEIVING KEYS EXTRACT LAYOUT                                 *01112002
011121*----------------------------------------------------------------*01112102
011400     COPY APRD024.                                                01140000
011800                                                                  01180000
012500 PROCEDURE DIVISION.                                              01250000
012600                                                                  01260000
012700 A100-MAINLINE.                                                   01270000
012800                                                                  01280000
012900     PERFORM B100-INITIALIZATION.                                 01290002
013000                                                                  01300000
013100     PERFORM B200-PROCESSING                                      01310002
013200        UNTIL END-OF-INVOICES                                     01320003
013300           OR END-OF-RECEIV.                                      01330003
013400                                                                  01340000
013500     PERFORM B300-END-OF-JOB.                                     01350002
013600                                                                  01360000
013700     GOBACK.                                                      01370000
013800        EJECT                                                     01380000
013830*----------------------------------------------------------------*01383002
013840*    OPEN FILES AND PERFORM PRIMING READ ON EACH INPUT FILE.     *01384002
013841*----------------------------------------------------------------*01384102
013842 B100-INITIALIZATION.                                             01384202
013843                                                                  01384302
013890     SET NOT-END-OF-INVOICES     TO TRUE.                         01389002
013891     SET NOT-END-OF-RECEIV       TO TRUE.                         01389102
013892                                                                  01389202
013893     OPEN INPUT   INVOICES-FILE                                   01389302
013894                  RECEIV-FILE                                     01389402
013895          OUTPUT  RCVKEYS-FILE.                                   01389502
013896                                                                  01389602
013897     PERFORM R100-READ-INVOICE.                                   01389702
013898     PERFORM R200-READ-AP024.                                     01389802
013899                                                                  01389902
013900                                                                  01390000
013910*----------------------------------------------------------------*01391002
013920* PROCESS THE INVOICE FILE AND MATCH UP TO THE APPROPRIATE KEYS  *01392002
013921* RECORDS BASED ON THE MATCH LEVEL CODE AND MATCH LOCATION FROM  *01392102
013922* THE INVOICE.                                                   *01392202
013930*----------------------------------------------------------------*01393002
014000 B200-PROCESSING.                                                 01400002
014220                                                                  01422004
014300     IF  AP060-PO-NBR = AP024-SRT-PURCHASE-ORDER                  01430002
014400         IF  AP060-MTCH-LVL-CDE = 'P'                             01440002
014500             PERFORM C100-PROCESS-BULK                            01450002
014600               UNTIL END-OF-RECEIV                                01460002
014700                  OR (AP060-PO-NBR NOT = AP024-SRT-PURCHASE-ORDER)01470002
014800         ELSE                                                     01480002
014900             IF  AP060-MTCH-LVL-CDE = 'D'                         01490002
015000                 PERFORM C200-PROCESS-DC                          01500002
015100                    UNTIL END-OF-INVOICES                         01510002
015200                       OR END-OF-RECEIV                           01520002
015300                       OR                                         01530002
015310                     (AP060-PO-NBR NOT = AP024-SRT-PURCHASE-ORDER)01531002
015400             ELSE                                                 01540002
015500*    PROCESS AP060-MTCH-LVL-CDE = 'S'                             01550002
015600                 PERFORM C300-PROCESS-BY-STORE                    01560002
015700                   UNTIL END-OF-INVOICES                          01570002
015800                      OR END-OF-RECEIV                            01580002
015900                      OR                                          01590002
015910                     (AP060-PO-NBR NOT = AP024-SRT-PURCHASE-ORDER)01591002
016000             END-IF                                               01600002
016100         END-IF                                                   01610002
016200         IF  END-OF-INVOICES                                      01620002
016300         OR  END-OF-RECEIV                                        01630002
016400             CONTINUE                                             01640002
016500         ELSE                                                     01650002
016600             IF  AP060-PO-NBR < AP024-SRT-PURCHASE-ORDER          01660002
016700                 PERFORM R100-READ-INVOICE                        01670002
016710                   UNTIL AP060-PO-NBR = AP024-SRT-PURCHASE-ORDER  01671005
016720                      OR AP060-PO-NBR > AP024-SRT-PURCHASE-ORDER  01672005
016730                      OR END-OF-INVOICES                          01673005
016731             ELSE                                                 01673105
016740                 PERFORM R200-READ-AP024                          01674005
016750                   UNTIL AP060-PO-NBR = AP024-SRT-PURCHASE-ORDER  01675005
016760                      OR AP060-PO-NBR < AP024-SRT-PURCHASE-ORDER  01676005
016770                      OR END-OF-RECEIV                            01677005
016800             END-IF                                               01680002
016900         END-IF                                                   01690002
017000     ELSE                                                         01700000
017100         IF  AP060-PO-NBR > AP024-SRT-PURCHASE-ORDER              01710002
017200             PERFORM R200-READ-AP024                              01720002
017210               UNTIL AP060-PO-NBR = AP024-SRT-PURCHASE-ORDER      01721005
017220                  OR AP060-PO-NBR < AP024-SRT-PURCHASE-ORDER      01722005
017230                  OR END-OF-RECEIV                                01723005
017300         ELSE                                                     01730002
017400             PERFORM R100-READ-INVOICE                            01740002
017420               UNTIL AP060-PO-NBR = AP024-SRT-PURCHASE-ORDER      01742005
017430                  OR AP060-PO-NBR > AP024-SRT-PURCHASE-ORDER      01743005
017440                  OR END-OF-INVOICES                              01744005
017500         END-IF                                                   01750002
017600     END-IF.                                                      01760000
017610                                                                  01761002
017620                                                                  01762002
017630*----------------------------------------------------------------*01763002
017640*  DISPLAY PROGRAM COUNTS, CLOSE FILES                           *01764002
017641*----------------------------------------------------------------*01764102
017651 B300-END-OF-JOB.                                                 01765102
017660                                                                  01766002
017690     DISPLAY '************************************************'.  01769002
017691     DISPLAY 'TOTAL INVOICE  RECORDS READ    = '                  01769102
017692              PV-INVOICE-IN-REC-CNT.                              01769202
017693     DISPLAY 'TOTAL AP024 RECORDS READ       = '                  01769302
017694              PV-RECEIV-IN-REC-CNT.                               01769402
017695     DISPLAY '************************************************'.  01769502
017696     DISPLAY 'TOTAL AP024 BULK RECORDS  OUT  = '                  01769602
017697              PV-RECEIV-OUT-REC-CNT.                              01769702
017698     DISPLAY 'TOTAL AP024 DC RECORDS    OUT  = '                  01769802
017699              PV-RECEIV-OUT-DC-REC-CNT.                           01769902
017700     DISPLAY 'TOTAL AP024 STORE RECORDS OUT  = '                  01770002
017701              PV-RECEIV-OUT-STR-REC-CNT.                          01770102
017702     DISPLAY '************************************************'.  01770202
017705                                                                  01770502
017706     CLOSE INVOICES-FILE                                          01770609
017707           RECEIV-FILE                                            01770709
017708           RCVKEYS-FILE.                                          01770809
017709                                                                  01770902
017710     DISPLAY ' PROGRAM APKUT043 ENDS NORMALLY '.                  01771002
017711                                                                  01771102
017712                                                                  01771202
017720*----------------------------------------------------------------*01772002
017800* FOR MATCH LEVEL = 'P', ONLY USE THE TRECEIV/TNINREC            *01780002
017900* RECORDS TO PASS TO THE UPDATE PROGRAM, AFTER REPLACING THE     *01790002
017901* SORT STORE NUMBER WITH THE MATCH LOCATION NUMBER.  THIS CHANGE *01790102
017902* IS NECESSARY BECAUSE SO THAT THE SORT STORE WILL AGREE WITH    *01790202
017903* THE STORE NUMBER ON THE TPOSTRR TABLE.                         *01790302
017910*----------------------------------------------------------------*01791002
018000 C100-PROCESS-BULK.                                               01800002
018100                                                                  01810000
018200     IF  AP024-TRECEIV-UPDATE                                     01820002
018300         MOVE AP060-MTCH-LOC-NBR TO AP024-SRT-STORE-NBR           01830002
018400         PERFORM W100-WRITE-BULK                                  01840002
018500     ELSE                                                         01850000
018600         IF  AP024-TNINREC-UPDATE                                 01860002
018700             MOVE AP060-MTCH-LOC-NBR TO AP024-SRT-STORE-NBR       01870002
018800             PERFORM W100-WRITE-BULK                              01880002
018900         END-IF                                                   01890002
019000     END-IF.                                                      01900000
019100                                                                  01910000
019200     PERFORM R200-READ-AP024.                                     01920000
019300                                                                  01930000
019310*----------------------------------------------------------------*01931002
019311* FOR MATCH LEVEL = 'D', ONLY USE THE TRECEIV/TNINREC            *01931102
019330* RECORDS TO PASS TO THE UPDATE PROGRAM, AFTER REPLACING THE     *01933002
019340* SORT STORE NUMBER WITH THE MATCH LOCATION NUMBER.  THIS CHANGE *01934002
019350* IS NECESSARY BECAUSE SO THAT THE SORT STORE WILL AGREE WITH    *01935002
019360* THE STORE NUMBER ON THE TPOSTRR TABLE.                         *01936002
019370*----------------------------------------------------------------*01937002
019600 C200-PROCESS-DC.                                                 01960002
019700                                                                  01970000
019800     IF  AP024-TRECEIV-UPDATE                                     01980002
019900         IF  AP060-MTCH-LOC-NBR = AP024-DC-NBR                    01990003
019910             MOVE AP060-MTCH-LOC-NBR TO AP024-SRT-STORE-NBR       01991007
020000             PERFORM W150-WRITE-DC                                02000002
020100             PERFORM R200-READ-AP024                              02010002
020200         ELSE                                                     02020002
020300             IF  AP060-MTCH-LOC-NBR < AP024-DC-NBR                02030003
020400                 PERFORM R100-READ-INVOICE                        02040002
020500             ELSE                                                 02050002
020600                 PERFORM R200-READ-AP024                          02060002
020700             END-IF                                               02070002
020800         END-IF                                                   02080002
020900     ELSE                                                         02090000
020910         IF  AP024-TNINREC-UPDATE                                 02091002
021100             IF  AP060-MTCH-LOC-NBR = AP024-DC-NBR                02110002
021110                 MOVE AP060-MTCH-LOC-NBR TO AP024-SRT-STORE-NBR   02111002
021200                 PERFORM W150-WRITE-DC                            02120002
021300                 PERFORM R200-READ-AP024                          02130002
021400             ELSE                                                 02140002
021500                 IF  AP060-MTCH-LOC-NBR < AP024-DC-NBR            02150002
021510                     PERFORM R100-READ-INVOICE                    02151002
021520                 ELSE                                             02152002
021530                     PERFORM R200-READ-AP024                      02153002
021540                 END-IF                                           02154002
021550             END-IF                                               02155002
021551         ELSE                                                     02155106
021552             PERFORM R200-READ-AP024                              02155206
021560         END-IF                                                   02156002
021570     END-IF.                                                      02157000
021580                                                                  02158000
021590                                                                  02159000
021591*----------------------------------------------------------------*02159102
021592* FOR MATCH LEVEL = 'S', ONLY USE THE TRECDIS/TNINREC            *02159202
021593* RECORDS TO PASS TO THE UPDATE PROGRAM.  THE SORT STORE NUMBER  *02159302
021594* DOES NOT NEED TO BE REPLACED, AS IT WILL ALREADY AGREE WITH    *02159402
021596* THE STORE NUMBER ON THE TPOSTRR TABLE.                         *02159602
021597*----------------------------------------------------------------*02159702
021800 C300-PROCESS-BY-STORE.                                           02180002
021900                                                                  02190000
022000     IF  AP024-TRECEIV-UPDATE                                     02200002
022100         PERFORM R200-READ-AP024                                  02210002
022200     ELSE                                                         02220000
022300         IF  AP060-MTCH-LOC-NBR = AP024-SRT-STORE-NBR             02230002
022400             PERFORM W200-WRITE-BY-STORE                          02240002
022500             PERFORM R200-READ-AP024                              02250002
022600         ELSE                                                     02260002
022700             IF  AP060-MTCH-LOC-NBR < AP024-SRT-STORE-NBR         02270002
022800                 PERFORM R100-READ-INVOICE                        02280002
022900             ELSE                                                 02290002
023000                 PERFORM R200-READ-AP024                          02300002
023100             END-IF                                               02310002
023200         END-IF                                                   02320002
023300     END-IF.                                                      02330000
023400                                                                  02340000
023500*----------------------------------------------------------------*02350002
025600*     READ THE SELECTED INVOICE FILE                              02560000
025610*----------------------------------------------------------------*02561002
025710 R100-READ-INVOICE.                                               02571002
025800                                                                  02580002
026100     IF NOT END-OF-INVOICES                                       02610000
026200        READ INVOICES-FILE INTO AP060-INVOICE-EXTRACT             02620000
026300          AT END  SET END-OF-INVOICES TO TRUE.                    02630000
026400                                                                  02640000
026500     IF NOT END-OF-INVOICES                                       02650000
026600        ADD 1 TO PV-INVOICE-IN-REC-CNT.                           02660000
026700                                                                  02670000
026910*----------------------------------------------------------------*02691002
027100*     READ THE RECEIVING KEYS FILE                                02710009
027110*----------------------------------------------------------------*02711002
027210 R200-READ-AP024.                                                 02721002
027300                                                                  02730002
027600     IF NOT END-OF-RECEIV                                         02760000
027700        READ RECEIV-FILE   INTO AP024-RECORD                      02770000
027800          AT END  SET END-OF-RECEIV TO TRUE.                      02780000
027900                                                                  02790000
028000     IF NOT END-OF-RECEIV                                         02800000
028100        ADD 1 TO PV-RECEIV-IN-REC-CNT.                            02810000
028200                                                                  02820002
028300*----------------------------------------------------------------*02830002
028600*  WRITE THE UPDATED RECEIVING KEYS RECORDS FOR PO MATCH LEVEL    02860009
028610*----------------------------------------------------------------*02861002
028720 W100-WRITE-BULK.                                                 02872002
029000                                                                  02900000
029100     WRITE KEYS-RECORD     FROM AP024-RECORD.                     02910000
029200                                                                  02920000
029300     ADD 1 TO PV-RECEIV-OUT-REC-CNT.                              02930000
029400                                                                  02940000
029610*----------------------------------------------------------------*02961002
029620*  WRITE THE UPDATED RECEIVING KEYS RECORDS FOR DC MATCH LEVEL    02962009
029810*----------------------------------------------------------------*02981002
029910 W150-WRITE-DC.                                                   02991002
030200                                                                  03020000
030300     WRITE KEYS-RECORD FROM AP024-RECORD.                         03030000
030400                                                                  03040000
030500     ADD 1 TO PV-RECEIV-OUT-DC-REC-CNT.                           03050000
030600                                                                  03060000
030810*----------------------------------------------------------------*03081002
030820*  WRITE THE RECEIVING KEYS RECORDS FOR STORE MATCH LEVEL         03082009
031010*----------------------------------------------------------------*03101002
031110 W200-WRITE-BY-STORE.                                             03111002
031400                                                                  03140000
031500     WRITE KEYS-RECORD FROM AP024-RECORD.                         03150000
031600                                                                  03160000
031700     ADD 1 TO PV-RECEIV-OUT-STR-REC-CNT.                          03170000
031800                                                                  03180000
