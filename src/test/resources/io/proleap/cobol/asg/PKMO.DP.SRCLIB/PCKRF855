000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - ENTER ADDITIONAL FAST NBRS FOR NEW SML'.    00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRF855.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN.           JANUARY 2001.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000 ENVIRONMENT DIVISION.                                            00100000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400******************************************************************00140000
001500*                                                                 00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-FR-STR-NBR                PIC  S9(04) COMP            00170000
001800                                           VALUE ZERO.            00180000
001900     05  DK-XFER-SEQ-NBR              PIC  S9(08) COMP            00190000
002000                                           VALUE ZERO.            00200000
002100     05  DK-TRN-NBR                   PIC  S9(08) COMP            00210000
002200                                           VALUE ZERO.            00220000
002300                                                                  00230000
002400 01  PC-PROGRAM-CONSTANTS.                                        00240000
002500     05  PC-TRANID                       PIC  X(04)  VALUE 'E855'.00250000
002600                                                                  00260000
002700     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)  VALUE 'PCKRF855'. 00270000
002800     05  PC-PRTR-VALIDATION-PGM          PIC X(08)                00280000
002900                                               VALUE 'DPKCS060'.  00290000
003000     05  PC-PCKCS721               PIC  X(08)  VALUE 'PCKCS721'.  00300000
003100                                                                  00310000
003200* ERROR MESSAGES                                                 *00320000
003300     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19) VALUE               00330000
003400                                           'DB2 ACCESS ERROR   '. 00340000
003500     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00350000
003600                                           'UNRECOGNIZED PF KEY'. 00360000
003700     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00370000
003800                                           'ENTER THROUGH MENU '. 00380000
003900     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00390000
004000                                           'TRANS NOT AVAILABLE'. 00400000
004100     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               00410000
004200                                           'PLEASE ENTER FIELD '. 00420000
004300     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00430000
004400                                           'MUST BE NUMERIC    '. 00440000
004500     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               00450000
004600                                           'MUST BE > ZERO     '. 00460000
004700     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               00470000
004800                                           'FIRST DIGIT NOT 0  '. 00480000
004900     05  PC-TOO-MANY-DIGITS         PIC X(19) VALUE               00490000
005000                                           'TOO MANY DIGITS    '. 00500000
005100     05  PC-CICS-ERR-MSG            PIC X(19) VALUE               00510000
005200                                           'CICS ACCESS ERROR  '. 00520000
005300     05  PC-WRONG-FACILITY          PIC X(19) VALUE               00530000
005400                                           'WRG FCLTY - F2 CONF'. 00540000
005500     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               00550000
005600                                           'MORE DIGITS REQUIRD'. 00560000
005700     05  PC-IGNORE-UPDATE-MSG       PIC X(19) VALUE               00570000
005800                                           'UPDATE NOT DONE    '. 00580000
005900                                                                  00590000
006000 01  PS-PROGRAM-SWITCHES.                                         00600000
006100     05  PS-ERROR-SW                  PIC  X(01)  VALUE 'N'.      00610000
006200         88  PS-ERRORS-YES                        VALUE 'Y'.      00620000
006300         88  PS-ERRORS-NO                         VALUE 'N'.      00630000
006400     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'N'.      00640000
006500         88  PS-VALID-INPUT                       VALUE 'Y'.      00650000
006600         88  PS-INVALID-INPUT                     VALUE 'N'.      00660000
006700     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00670000
006800         88  PS-XCTL-E852                         VALUE 'E852'.   00680000
006900         88  PS-XCTL-E855                         VALUE 'E855'.   00690000
007000         88  PS-XCTL-E857                         VALUE 'E857'.   00700000
007100         88  PS-XCTL-E858                         VALUE 'E858'.   00710000
007200     05  PS-TTFMSTR-SW                PIC  X(01)  VALUE 'N'.      00720000
007300         88  PS-TTFMSTR-YES                       VALUE 'Y'.      00730000
007400         88  PS-TTFMSTR-NO                        VALUE 'N'.      00740000
007500     05  PS-CART-UPC-SW               PIC X(01)   VALUE 'N'.      00750000
007600         88  PS-CART-UPC-YES                      VALUE 'Y'.      00760000
007700         88  PS-CART-UPC-NO                       VALUE 'N'.      00770000
007800     05  PS-FAST-ITEM-CSR-SW          PIC X(01)   VALUE 'N'.      00780000
007900         88  PS-END-FAST-ITEM-CSR                 VALUE 'Y'.      00790000
008000         88  PS-NOT-END-FAST-ITEM-CSR             VALUE 'N'.      00800000
008100     05  PS-CARTON-CSR-SW             PIC X(01)   VALUE 'N'.      00810000
008200         88  PS-END-CARTON-CSR-YES                VALUE 'Y'.      00820000
008300         88  PS-END-CARTON-CSR-NO                 VALUE 'N'.      00830000
008400                                                                  00840000
008500*----------------------------------------------------------------*00850000
008600*  PROGRAM VARIABLES                                             *00860000
008700*----------------------------------------------------------------*00870000
008800 01  PV-PROGRAM-VARIABLES.                                        00880000
008900     05  PV-TMST                      PIC X(26).                  00890000
009000     05  PV-SUB                       PIC S9(4) COMP              00900000
009100                                                VALUE ZERO.       00910000
009200     05  PV-BARCODE-18                PIC 9(18) VALUE ZERO.       00920000
009300     05  PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.     00930000
009400     05  PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.         00940000
009500         10 FILLER                    PIC  X(03).                 00950000
009600         10 PV-2-DIGIT-DC-ABBR        PIC  X(02).                 00960000
009700     05  PV-STORE-NUMBER.                                         00970019
009800         10  PV-STORE-NUMBER-N    PIC 9(04)   VALUE ZERO.         00980020
009900     05  PV-FAST-NBR.                                             00990020
010000         10  PV-FAST-STORE            PIC 9(05) VALUE ZERO.       01000020
010100         10  FILLER                   PIC X(01) VALUE '-'.        01010020
010200         10  PV-FAST-SEQ              PIC 9(06) VALUE ZERO.       01020020
010300         10  FILLER                   PIC X(01) VALUE '-'.        01030020
010400         10  PV-FAST-CHK-DIGIT        PIC 9(01) VALUE ZERO.       01040020
010500                                                                  01050020
010600                                                                  01060020
010700     05  PV-HOLD-CHECK-DIGIT.                                     01070020
010800         10  PV-HOLD-CHECK-DIGIT-N    PIC 9(01) VALUE ZERO.       01080020
010900     05  PV-FAST-13                   PIC X(13) VALUE ZEROES.     01090020
011000     05  PV-FAST-N REDEFINES PV-FAST-13                           01100020
011100                                      PIC 9(13).                  01110020
011200                                                                  01120020
011300     05  PV-FAST-CHECKER              PIC X(13).                  01130020
011400* VALID PATTERNS                                                  01140020
011500         88  PV-VALID-FAST            VALUES                      01150020
011600             '9999-999999-9'                                      01160020
011700             '999-999999-9B'                                      01170020
011800             '999999999999B'                                      01180020
011900             '99999999999BB'                                      01190020
012000             '9999999999BBB'                                      01200020
012100             'BBBBBBBBBBBBB'                                      01210020
012200             '0000000000000'.                                     01220020
012300         88  PV-FAST-DASH-CHECK-DIGIT VALUE                       01230020
012400             '9999-999999-9'.                                     01240020
012500         88  PV-FAST-DASH-CHECK-DIG12 VALUE                       01250020
012600             '999-999999-9B'.                                     01260020
012700         88  PV-FAST-DASH-2-SPACE-TRAIL                           01270020
012800                                      VALUE                       01280020
012900             '999999999999B'.                                     01290020
013000         88  PV-FAST-DASH-3-SPACE-TRAIL                           01300020
013100                                      VALUE                       01310020
013200             '99999999999BB'.                                     01320020
013300         88  PV-FAST-DASH-2-SPACE-TRL12                           01330020
013400                                      VALUE                       01340020
013500             '9999999999BBB'.                                     01350020
013600         88  PV-FAST-BLANK-ENTRY      VALUE                       01360020
013700             'BBBBBBBBBBBBB'.                                     01370020
013800         88  PV-FAST-ZERO-ENTRY       VALUE                       01380020
013900             '0000000000000'.                                     01390020
014000                                                                  01400020
014100                                                                  01410020
014200     05  PV-FAST-EDIT-MASK REDEFINES PV-FAST-CHECKER.             01420020
014300         10  PV-FAST-CHAR             PIC X(01) OCCURS 13 TIMES.  01430020
014400                                                                  01440020
014500     05  PV-EXPAND-TO-13-WDASH.                                   01450020
014600         10  PV-EXPAND-WDASH-2        PIC X(02)   VALUE SPACES.   01460020
014700         10  PV-EXPAND-WDASH-12       PIC X(11)   VALUE SPACES.   01470020
014800     05  PV-EXPAND-TO-13-WODASH.                                  01480020
014900         10  PV-EXPAND-WODASH-10      PIC X(11)   VALUE SPACES.   01490020
015000         10  PV-EXPAND-WODASH-4       PIC X(02)   VALUE SPACES.   01500020
015100                                                                  01510020
015200     05  PV-TRN-NBR-COMP              PIC S9(09) COMP.            01520020
015300     05  PV-TRN-NBR                   PIC 9(10) VALUE ZEROES.     01530020
015400     05  PV-TRN-NBR-N REDEFINES PV-TRN-NBR.                       01540018
015500         10  PV-TRN-STORE             PIC 9(04).                  01550018
015600         10  PV-TRN-SEQUENCE          PIC 9(06).                  01560018
015700                                                                  01570000
015800     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   01580000
015900                                                     COMP SYNC.   01590000
016000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01600000
016100                                                     COMP SYNC.   01610000
016200     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01620000
016300     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01630000
016400                                                     COMP SYNC.   01640000
016500     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01650000
016600                                                                  01660000
016700 01  PV-LOG-MSG.                                                  01670000
016800     05  FILLER                       PIC X(12) VALUE             01680000
016900         ' E857 ERROR '.                                          01690000
017000     05  FILLER                       PIC X(09) VALUE             01700000
017100         'SQLCODE= '.                                             01710000
017200     05  PV-SQLCODE                   PIC -9(03).                 01720000
017300     05  FILLER                       PIC X(06) VALUE             01730000
017400         ' ERR= '.                                                01740000
017500     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01750000
017600     05  FILLER                       PIC X(07) VALUE             01760000
017700         ' FAST= '.                                               01770000
017800     05  PV-DISPLAY-FAST              PIC X(14) VALUE ZEROES.     01780000
017900     05  FILLER                       PIC X(05) VALUE             01790000
018000         ' PO= '.                                                 01800000
018100     05  PV-DISPLAY-PO                PIC 9(09) VALUE ZEROES.     01810000
018200     05  FILLER                       PIC X(07) VALUE             01820000
018300         ' RCVR= '.                                               01830000
018400     05  PV-DISPLAY-RCVR              PIC 9(04) VALUE ZEROES.     01840000
018500     05  FILLER                       PIC X(07) VALUE             01850000
018600         ' LINE= '.                                               01860000
018700     05  PV-DISPLAY-PO-LNE-NBR        PIC 9(04) VALUE ZEROES.     01870000
018800     05  FILLER                       PIC X(06) VALUE             01880000
018900         ' STR= '.                                                01890000
019000     05  PV-DISPLAY-STORE             PIC 9(04) VALUE ZEROES.     01900000
019100                                                                  01910000
019200 01  PV-EDITING-FIELDS.                                           01920000
019300                                                                  01930000
019400     05  PV-PROGRAM-DATA.                                         01940000
019500** AS PART OF THE PO EXPANSION PROJECT, COMMENTED OUT THE NEXT    01950019
019600** 7 LINES BECAUSE THEY ARE NEVER REFERENCED IN THE PROGRAM.      01960019
019700*        10  PV-PO                       PIC  X(07)  VALUE SPACE. 01970019
019800*        10  PV-PO-N REDEFINES PV-PO     PIC  ZZZZZZ9.            01980019
019900*                                                                 01990000
020000*        10  PV-PO-RCVR.                                          02000019
020100*            15 PV-PO-OUT                PIC  9(07).              02010019
020200*            15 FILLER                   PIC  X(01)  VALUE '-'.   02020019
020300*            15 PV-RCVR-OUT              PIC 9(03).               02030019
020400*                                                                 02040000
020500                                                                  02050000
020600         10  PV-PO-LINE-N                  PIC 9(09).             02060000
020700         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 02070000
020800             15 FILLER                     PIC X(05).             02080000
020900             15 PV-PO-LINE-OUT             PIC X(04).             02090000
021000                                                                  02100000
021100         10  PV-PO-LINE-LBL.                                      02110000
021200             15  PV-LINE-LBL-1           PIC 9(01).               02120000
021300             15  PV-LINE-LBL-3           PIC 9(03).               02130000
021400                                                                  02140000
021500     05  PM-PROGRAM-MESSAGE-1.                                    02150000
021600         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       02160000
021700         10  FILLER               PIC  X(01)  VALUE '-'.          02170000
021800         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       02180000
021900         10  FILLER               PIC  X(48)  VALUE SPACES.       02190000
022000                                                                  02200000
022100/                                                                 02210000
022200* COMMAREA FOR PCRF85X SCREENS                                    02220000
022300 01  CA-COMMAREA.                                                 02230000
022400     COPY PCWS033.                                                02240000
022500     05  CA-ENTRY-PATH-IND            PIC X(08) VALUE SPACES.     02250000
022600         88  CA-852                             VALUE 'PCKRF852'. 02260000
022700         88  CA-854                             VALUE 'PCKRF854'. 02270000
022800         88  CA-856                             VALUE 'PCKRF856'. 02280000
022900     05  PV-STORE-X.                                              02290000
023000         10  PV-STORE                 PIC 9(04) VALUE ZERO.       02300000
023100     05  PV-LABEL-QTY-X.                                          02310000
023200         10  PV-LABEL-QTY             PIC 9(04) VALUE ZERO.       02320000
023300     05  PV-MULT-FLAG                 PIC X(01) VALUE SPACE.      02330000
023400     05  PV-PRTR-NBR                  PIC X(05) VALUE SPACE.      02340000
023500     05  PV-FAST-COUNTER              PIC S9(03) COMP-3.          02350000
023600     05  PV-FAST-COUNT                PIC S9(03) COMP-3.          02360000
023700     05  PV-LABEL-COUNT               PIC S9(03) COMP-3.          02370000
023800                                                                  02380000
023900*  CHECK DIGIT WORK AREA                                          02390000
024000     COPY PCWS037.                                                02400000
024100*  MAP LAYOUT                                                     02410000
024200     COPY PCKM855.                                                02420000
024300                                                                  02430000
024400* HELP SCREEN COMMAREA                                            02440000
024500     COPY PCWS192.                                                02450000
024600* HELP SCREEN WORK AREA                                           02460000
024700     COPY PCWS188.                                                02470000
024800/                                                                 02480000
024900* PRINTER VALIDATION AREA                                         02490000
025000     COPY DPWS072.                                                02500000
025100/                                                                 02510000
025200* BARCODE AREA                                                    02520000
025300     COPY PCWS160.                                                02530000
025400/                                                                 02540000
025500* MANIFEST NBR MODULE                                             02550000
025600     COPY PCWS187.                                                02560000
025700/                                                                 02570000
025800* CARTON LABELING SYSTEM COMMAREA                                 02580000
025900     COPY PCWS140.                                                02590000
026000/                                                                 02600000
026100     COPY DPWS010I.                                               02610000
026200*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02620000
026300     COPY DPWS015.                                                02630000
026400                                                                  02640000
026500*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02650000
026600     COPY DFHAID.                                                 02660000
026700                                                                  02670000
026800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02680000
026900     COPY DPWS013.                                                02690000
027000/                                                                 02700000
027100     EXEC SQL                                                     02710000
027200         INCLUDE TTFMSTR                                          02720000
027300     END-EXEC.                                                    02730000
027400                                                                  02740000
027500     EXEC SQL                                                     02750000
027600         INCLUDE TTFITEM                                          02760000
027700     END-EXEC.                                                    02770000
027800                                                                  02780000
027900     EXEC SQL                                                     02790000
028000         INCLUDE SUT00024                                         02800000
028100     END-EXEC.                                                    02810000
028200                                                                  02820000
028300     EXEC SQL                                                     02830000
028400         INCLUDE SUT00028                                         02840000
028500     END-EXEC.                                                    02850000
028600                                                                  02860000
028700*                                                                 02870011
028800* DCLGEN FOR THE LOGISTICS DOMAIN LOCATION MASTER TABLE           02880011
028900*                                                                 02890011
029000     EXEC SQL                                                     02900011
029100         INCLUDE XLT00010                                         02910011
029200     END-EXEC.                                                    02920011
029300                                                                  02930000
029400     EXEC SQL                                                     02940000
029500         INCLUDE TCOCNTL                                          02950000
029600     END-EXEC.                                                    02960000
029700                                                                  02970000
029800     EXEC SQL                                                     02980000
029900         DECLARE FAST-ITEM-CSR CURSOR FOR                         02990000
030000         SELECT                                                   03000000
030100             FITM.XFER_LNE_NBR                                    03010000
030200         ,   FITM.KOHLS_UPC_NBR                                   03020000
030300         ,   FITM.XFER_QTY                                        03030011
030400         FROM TTFITEM FITM                                        03040000
030500         WHERE                                                    03050000
030600             XFER_DKEY_ID = :PC033-XFER-DKEY-ID                   03060000
030700     END-EXEC.                                                    03070000
030800                                                                  03080000
030900     EXEC SQL                                                     03090000
031000         DECLARE LABEL-CSR CURSOR WITH HOLD FOR                   03100000
031100         SELECT DISTINCT                                          03110000
031200             SHIPT_UNT_ID                                         03120000
031300         FROM SUT_OTBND_UPC A                                     03130000
031400         WHERE TRN_NBR = :SUT00028-TRN-NBR                        03140000
031500         AND                                                      03150000
031600         SHIPT_UNT_ID NOT BETWEEN :PC033-FIRST-CARTON             03160000
031700                 AND :PC033-LAST-CARTON                           03170000
031800         ORDER BY SHIPT_UNT_ID                                    03180000
031900     END-EXEC                                                     03190000
032000                                                                  03200000
032100     EXEC SQL                                                     03210000
032200         INCLUDE SQLCA                                            03220000
032300     END-EXEC.                                                    03230000
032400                                                                  03240000
032500 LINKAGE SECTION.                                                 03250000
032600 01  DFHCOMMAREA.                                                 03260000
032700     05  FILLER                         OCCURS  1 TO 4072 TIMES   03270000
032800                                      DEPENDING ON EIBCALEN.      03280000
032900         10  FILLER                   PIC X.                      03290000
033000/                                                                 03300000
033100 PROCEDURE DIVISION.                                              03310000
033200 0000-PROGRAM-MAINLINE.                                           03320000
033300                                                                  03330000
033400                                                                  03340000
033500     INITIALIZE CA-COMMAREA                                       03350000
033600     MOVE DFHCOMMAREA                 TO CA-COMMAREA.             03360000
033700                                                                  03370000
033800     EVALUATE TRUE                                                03380000
033900         WHEN EIBCALEN = ZERO                                     03390000
034000             MOVE PC-ENTER-THROUGH-MENU-MSG                       03400000
034100                                      TO PV-MESSAGE-AREA          03410000
034200             PERFORM 8110-RETURN                                  03420000
034300                                                                  03430000
034400         WHEN EIBTRNID = 'Z278'                                   03440000
034500             MOVE DFHCOMMAREA         TO PC192-COMMAREA           03450000
034600             MOVE PC192-HOST-SAVE-AREA                            03460000
034700                                      TO CA-COMMAREA              03470000
034800             SET PC033-PROCESS-SCREEN TO TRUE                     03480000
034900             MOVE PC192-HOST-SAVE-MAP TO PC855AO                  03490000
035000             MOVE -1                  TO AFASTL                   03500000
035100             PERFORM 8000-SEND-MAP                                03510000
035200             PERFORM 8100-RETURN-TRANID                           03520000
035300                                                                  03530000
035400         WHEN PC033-INITIALIZE-SCREEN                             03540000
035500         WHEN EIBAID = DFHCLEAR                                   03550000
035600             PERFORM 1000-INITIALIZE                              03560000
035700             SET PC033-PROCESS-SCREEN TO TRUE                     03570000
035800             MOVE PC-CURRENT-PROGRAM-NAME                         03580000
035900                                      TO PC033-LAST-PROGRAM       03590000
036000             MOVE LOW-VALUES          TO PC855AI                  03600000
036100             MOVE -1                  TO AFASTL                   03610000
036200             PERFORM 8000-SEND-MAP                                03620000
036300             PERFORM 8100-RETURN-TRANID                           03630000
036400                                                                  03640000
036500                                                                  03650000
036600         WHEN EIBAID = DFHPF3                                     03660000
036700*    PRINT LABELS HERE BEFORE TRANSFERRING TO PCKRF853            03670000
036800             IF PC033-NEW-FAST-LABEL OR                           03680000
036900                      PC033-MOVE-FAST-TO-NEW-LABEL                03690000
037000                 PERFORM 4000-PRINT-LABELS                        03700000
037100             END-IF                                               03710000
037200             SET PC033-NEW-FAST-LABEL TO TRUE                     03720000
037300             MOVE 'PCKRF853'          TO PV-TRANSFER-PROGRAM      03730000
037400             PERFORM 8200-XCTL                                    03740000
037500                                                                  03750000
037600         WHEN EIBAID = DFHENTER                                   03760000
037700             PERFORM 8020-RECEIVE-MAP                             03770000
037800             PERFORM 2000-PROCESS                                 03780000
037900             IF PS-XCTL-E852                                      03790000
038000                 PERFORM 8210-XCTL-ERROR-SCREEN                   03800000
038100             ELSE                                                 03810000
038200                 IF AMSGLNO = SPACES                              03820000
038300                     MOVE ' FAST ADDED TO CTN '                   03830000
038400                                      TO AMSGLNO                  03840000
038500                 END-IF                                           03850000
038600                 PERFORM 8010-SEND-DATA-ONLY                      03860000
038700                 PERFORM 8100-RETURN-TRANID                       03870000
038800             END-IF                                               03880000
038900                                                                  03890000
039000         WHEN EIBAID = DFHPF1                                     03900000
039100             PERFORM 8020-RECEIVE-MAP                             03910000
039200             MOVE PC855AO             TO PC192-HOST-SAVE-MAP      03920000
039300             PERFORM 1200-HELP-SCREEN                             03930000
039400                                                                  03940000
039500         WHEN OTHER                                               03950000
039600             PERFORM 8020-RECEIVE-MAP                             03960000
039700             MOVE -1                  TO AFASTL                   03970000
039800             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      03980000
039900                                      TO AMSGLNO                  03990000
040000             PERFORM 8010-SEND-DATA-ONLY                          04000000
040100             PERFORM 8100-RETURN-TRANID                           04010000
040200     END-EVALUATE.                                                04020000
040300                                                                  04030000
040400     GOBACK.                                                      04040000
040500                                                                  04050000
040600 1000-INITIALIZE.                                                 04060000
040700                                                                  04070000
040800     MOVE ' 1000-INITIALIZE' TO PV-LOG-MSG                        04080000
040900     MOVE PC-TRANID                   TO PC033-TRAN-ID            04090000
041000*    PERFORM 9905-WRITEQ.                                         04100000
041100                                                                  04110000
041200     MOVE PC033-LAST-PROGRAM          TO CA-ENTRY-PATH-IND.       04120000
041300     MOVE SPACES                      TO AMSGLNO                  04130000
041400     PERFORM 1100-FORMAT-FAST-NBR.                                04140000
041500     MOVE PC033-FIRST-CARTON          TO PC033-CARTON             04150000
041600     MOVE 1                           TO PV-FAST-COUNTER          04160002
041700     PERFORM 2500-MOVE-COMMAREA-TO-MAP                            04170000
041800                                                                  04180000
041900     EXEC SQL                                                     04190000
042000         SET :PV-TMST = CURRENT TIMESTAMP                         04200000
042100     END-EXEC.                                                    04210000
042200                                                                  04220000
042300 1100-FORMAT-FAST-NBR.                                            04230000
042400                                                                  04240000
042500     MOVE ' 1100-FORMAT-FAST-NBR' TO PV-LOG-MSG                   04250000
042600*    PERFORM 9905-WRITEQ.                                         04260000
042700                                                                  04270000
042800     INITIALIZE PC037-CHECK-DIGIT-FIELDS.                         04280000
042900     IF PC033-FR-STR-NBR = ZERO                                   04290000
043000                AND PC033-XFER-SEQ-NBR = ZERO                     04300000
043100       MOVE 'UNKNOWN'                 TO AFASTO                   04310000
043200                                         PV-FAST-NBR              04320000
043300     ELSE                                                         04330000
043400         MOVE PC033-FR-STR-NBR        TO                          04340000
043500                                     PC037-XFER-FROM-STORE-NBR    04350000
043600         MOVE PC033-XFER-SEQ-NBR      TO PC037-XFER-SEQ-NBR       04360000
043700         PERFORM P0300-GET-CHK-DIGIT                              04370000
043800         STRING PC033-FR-STR-NBR       '-'                        04380016
043900                    PC037-XFER-SEQ-NBR '-'                        04390000
044000                    PC037-CHK-DIGIT                               04400000
044100                    DELIMITED BY SIZE                             04410000
044200                                      INTO AFASTO                 04420000
044300         MOVE AFASTO                  TO PV-FAST-NBR              04430000
044400     END-IF.                                                      04440000
044500                                                                  04450000
044600     IF PC033-STR-NBR > ZERO                                      04460000
044700         MOVE PC033-STR-NBR           TO PV-STORE                 04470000
044800                                         ASTOREO                  04480000
044900         MOVE DP015-ASK-NOR-MDT       TO ASTOREA                  04490000
045000     END-IF.                                                      04500000
045100                                                                  04510000
045200 1200-HELP-SCREEN.                                                04520000
045300                                                                  04530000
045400     MOVE ' 1200-HELP-SCREEN' TO PV-LOG-MSG                       04540000
045500*    PERFORM 9905-WRITEQ.                                         04550000
045600                                                                  04560000
045700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      04570000
045800     MOVE 'PCKRF855'                  TO PC192-PROGRAM-NAME       04580000
045900     COPY PCPD188.                                                04590000
046000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      04600000
046100     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     04610000
046200     PERFORM 8220-XCTL-TO-HELP.                                   04620000
046300                                                                  04630000
046400/                                                                 04640000
046500 2000-PROCESS.                                                    04650000
046600                                                                  04660000
046700     MOVE ' 2000-PROCESS' TO PV-LOG-MSG                           04670000
046800*    PERFORM 9905-WRITEQ.                                         04680000
046900                                                                  04690000
047000     PERFORM 2010-LOAD-MAP-TO-COMMAREA.                           04700000
047100     PERFORM 2020-EDIT-FIELDS.                                    04710000
047200     IF PS-ERRORS-NO                                              04720000
047300                                                                  04730000
047400         IF PS-CART-UPC-YES                                       04740000
047500                 PERFORM VARYING PC033-CARTON FROM                04750000
047600                             PC033-FIRST-CARTON BY 1 UNTIL        04760000
047700                             PC033-CARTON > PC033-LAST-CARTON     04770000
047800                 PERFORM 3000-ADD-FAST-TO-CARTON                  04780000
047900             END-PERFORM                                          04790000
048000             MOVE PC033-FIRST-CARTON  TO PC033-CARTON             04800000
048100                                                                  04810000
048200             IF PC033-MOVE-FAST-TO-NEW-LABEL                      04820000
048300*                CLEANUP AFTER MOVING TRANSFERS TO A NEW LABEL    04830000
048400                 PERFORM 3100-DELETE-FAST-FROM-CARTONS            04840000
048500             END-IF                                               04850000
048600                                                                  04860000
048700             PERFORM 1100-FORMAT-FAST-NBR                         04870000
048800             PERFORM 2500-MOVE-COMMAREA-TO-MAP                    04880000
048900         END-IF                                                   04890000
049000                                                                  04900000
049100     END-IF.                                                      04910000
049200                                                                  04920000
049300 2010-LOAD-MAP-TO-COMMAREA.                                       04930000
049400                                                                  04940000
049500     MOVE ' 2100-LOAD-MAP-TO-COMMAREA' TO PV-LOG-MSG              04950000
049600*    PERFORM 9905-WRITEQ.                                         04960000
049700                                                                  04970000
049800     IF  AFASTL > ZERO                                            04980000
049900         MOVE AFASTI TO PV-FAST-13                                04990014
050000     ELSE                                                         05000000
050100         IF AFASTA = DP015-ERASE-EOF                              05010000
050200             MOVE SPACES TO PV-FAST-13                            05020014
050300         END-IF                                                   05030000
050400     END-IF.                                                      05040000
050500                                                                  05050000
050600     MOVE PC033-STR-NBR               TO PV-STORE                 05060000
050700     MOVE DP015-ASK-NOR-MDT           TO ASTOREA.                 05070000
050800                                                                  05080000
050900 2020-EDIT-FIELDS.                                                05090000
051000                                                                  05100000
051100     MOVE ' 2020-EDIT-FIELDS' TO PV-LOG-MSG                       05110000
051200*    PERFORM 9905-WRITEQ.                                         05120000
051300                                                                  05130000
051400     MOVE SPACES                      TO AMSGLNO                  05140000
051500     MOVE PV-FAST-13                  TO PV-FAST-CHECKER          05150012
051600     SET PS-VALID-INPUT               TO TRUE                     05160000
051700* FAST NUMBER MUST INCLUDE A CHECK DIGIT NUMBER                   05170000
051800* KEYING THE DASHES IS OPTIONAL                                   05180000
051900                                                                  05190000
052000     PERFORM VARYING PV-SUB FROM 1 BY 1                           05200000
052100             UNTIL PV-SUB > 13                                    05210012
052200                                                                  05220000
052300         EVALUATE TRUE                                            05230000
052400         WHEN PV-FAST-CHAR (PV-SUB) = ZERO                        05240000
052500         WHEN PV-FAST-CHAR (PV-SUB) NUMERIC                       05250000
052600             MOVE '9'                 TO PV-FAST-CHAR             05260000
052700                                         (PV-SUB)                 05270000
052800         WHEN PV-FAST-CHAR (PV-SUB) = '-'                         05280000
052900             MOVE '-'                 TO PV-FAST-CHAR             05290000
053000                                         (PV-SUB)                 05300000
053100         WHEN PV-FAST-CHAR (PV-SUB) = SPACE OR LOW-VALUE          05310000
053200             MOVE 'B'                 TO PV-FAST-CHAR             05320000
053300                                         (PV-SUB)                 05330000
053400         WHEN OTHER                                               05340000
053500             MOVE 'X'                 TO PV-FAST-CHAR             05350000
053600                                         (PV-SUB)                 05360000
053700             MOVE PC-MUST-BE-NUM-MSG   TO AMSGLNO                 05370000
053800         END-EVALUATE                                             05380000
053900     END-PERFORM.                                                 05390000
054000                                                                  05400000
054100     INITIALIZE PC033-FR-STR-NBR                                  05410000
054200                PC033-XFER-SEQ-NBR                                05420000
054300                AMSGLNO                                           05430000
054400     MOVE DP015-UNP-ALP-NOR-MDT       TO AFASTA.                  05440000
054500                                                                  05450000
054600     IF PV-VALID-FAST                                             05460011
054700        EVALUATE TRUE                                             05470011
054800        WHEN PV-FAST-DASH-CHECK-DIG12                             05480011
054900            MOVE '00'                   TO PV-EXPAND-WDASH-2      05490011
055000            MOVE PV-FAST-13 (1:12)      TO PV-EXPAND-WDASH-12     05500012
055100            MOVE PV-EXPAND-TO-13-WDASH  TO PV-FAST-13             05510012
055200        WHEN PV-FAST-DASH-2-SPACE-TRL12                           05520011
055300            MOVE PV-FAST-13 (1:10)      TO PV-EXPAND-WODASH-10    05530012
055400            MOVE 'BBBB'                 TO PV-EXPAND-WODASH-4     05540011
055500            MOVE PV-EXPAND-TO-13-WODASH TO PV-FAST-13             05550012
055600         END-EVALUATE.                                            05560011
055700                                                                  05570000
055800     IF PV-VALID-FAST                                             05580000
055900         EVALUATE TRUE                                            05590000
056000         WHEN PV-FAST-DASH-CHECK-DIGIT                            05600000
056100             MOVE PV-FAST-13 (1:04)   TO PC037-XFER-FROM-STORE-NBR05610012
056200             MOVE PV-FAST-13 (6:06)   TO PC037-XFER-SEQ-NBR       05620012
056300             MOVE PV-FAST-13 (13:1)   TO PV-HOLD-CHECK-DIGIT      05630012
056400         WHEN PV-FAST-DASH-2-SPACE-TRAIL                          05640000
056500             MOVE PV-FAST-13 (1:04)   TO PC037-XFER-FROM-STORE-NBR05650012
056600             MOVE PV-FAST-13 (5:06)   TO PC037-XFER-SEQ-NBR       05660012
056700             MOVE PV-FAST-13 (11:1)   TO PV-HOLD-CHECK-DIGIT      05670012
056800                                                                  05680000
056900             STRING PC033-FR-STR-NBR   '-'                        05690015
057000                    PC037-XFER-SEQ-NBR '-'                        05700000
057100                    PV-HOLD-CHECK-DIGIT '-'                       05710000
057200                    DELIMITED BY SIZE                             05720000
057300                                      INTO AFASTO                 05730000
057400         WHEN PV-FAST-DASH-3-SPACE-TRAIL                          05740012
057500             MOVE PV-FAST-13 (1:04)   TO PC037-XFER-FROM-STORE-NBR05750012
057600             MOVE PV-FAST-13 (5:06)   TO PC037-XFER-SEQ-NBR       05760012
057700             MOVE PV-FAST-13 (11:1)   TO PV-HOLD-CHECK-DIGIT      05770012
057800                                                                  05780012
057900             STRING PC033-FR-STR-NBR   '-'                        05790015
058000                    PC037-XFER-SEQ-NBR '-'                        05800012
058100                    PV-HOLD-CHECK-DIGIT '-'                       05810012
058200                    DELIMITED BY SIZE                             05820012
058300                                      INTO AFASTO                 05830012
058400         WHEN PV-FAST-DASH-2-SPACE-TRL12                          05840012
058500             MOVE PV-FAST-13 (1:03)   TO PC037-XFER-FROM-STORE-NBR05850012
058600             MOVE PV-FAST-13 (4:06)   TO PC037-XFER-SEQ-NBR       05860012
058700             MOVE PV-FAST-13 (10:1)   TO PV-HOLD-CHECK-DIGIT      05870012
058800                                                                  05880012
058900             STRING PC033-FR-STR-NBR   '-'                        05890015
059000                    PC037-XFER-SEQ-NBR '-'                        05900012
059100                    PV-HOLD-CHECK-DIGIT '-'                       05910012
059200                    DELIMITED BY SIZE                             05920012
059300                                      INTO AFASTO                 05930012
059400         WHEN PV-FAST-BLANK-ENTRY                                 05940000
059500         WHEN PV-FAST-ZERO-ENTRY                                  05950012
059600             MOVE ZEROES              TO PC037-XFER-FROM-STORE-NBR05960000
059700                                         PC037-XFER-SEQ-NBR       05970000
059800         END-EVALUATE                                             05980000
059900                                                                  05990000
060000         MOVE PC037-XFER-FROM-STORE-NBR                           06000000
060100                                      TO PC033-FR-STR-NBR         06010000
060200         MOVE PC037-XFER-SEQ-NBR      TO PC033-XFER-SEQ-NBR       06020000
060300         PERFORM P0300-GET-CHK-DIGIT                              06030000
060400         PERFORM 2111-COMPARE-CHECK-DIGITS                        06040000
060500         IF PS-VALID-INPUT                                        06050000
060600             PERFORM 2200-CHECK-TABLES                            06060000
060700             IF PS-TTFMSTR-NO                                     06070000
060800                 SET PS-INVALID-INPUT TO TRUE                     06080000
060900                 MOVE DP015-UNP-ALP-NOR-MDT                       06090000
061000                                      TO AFASTA                   06100000
061100                 MOVE -1              TO AFASTL                   06110000
061200                 MOVE PV-FAST-13      TO AFASTO                   06120014
061300                 MOVE 'FAST NBR NOT FOUND  '                      06130000
061400                                      TO AMSGLNO                  06140000
061500             ELSE                                                 06150000
061600                 IF PC033-MOVE-FAST-TO-NEW-LABEL                  06160000
061700                     CONTINUE                                     06170000
061800                 ELSE                                             06180000
061900                 IF PS-CART-UPC-YES                               06190000
062000                     PERFORM 2115-COMPARE-STORES                  06200000
062100                 ELSE                                             06210000
062200                     SET PS-INVALID-INPUT         TO TRUE         06220000
062300                     MOVE DP015-UNP-ALP-NOR-MDT   TO AFASTA       06230000
062400                     MOVE -1                      TO AFASTL       06240000
062500                     MOVE PV-FAST-13              TO AFASTO       06250014
062600                     MOVE 'SML TRANSFER ERROR'    TO AMSGLNO      06260000
062700                 END-IF                                           06270000
062800                 END-IF                                           06280000
062900             END-IF                                               06290000
063000         END-IF                                                   06300000
063100     ELSE                                                         06310000
063200         SET PS-INVALID-INPUT         TO TRUE                     06320000
063300         MOVE DP015-UNP-ALP-NOR-MDT   TO AFASTA                   06330000
063400         MOVE -1                      TO AFASTL                   06340000
063500         MOVE PV-FAST-13              TO AFASTO                   06350014
063600         MOVE 'INVALID FAST NBR    '  TO AMSGLNO                  06360000
063700     END-IF.                                                      06370000
063800                                                                  06380000
063900 2111-COMPARE-CHECK-DIGITS.                                       06390000
064000     IF PV-HOLD-CHECK-DIGIT = PC037-FAST-CHECK-DIGIT              06400000
064100         CONTINUE                                                 06410000
064200     ELSE                                                         06420000
064300         SET PS-INVALID-INPUT         TO TRUE                     06430000
064400         MOVE DP015-UNP-ALP-NOR-MDT   TO AFASTA                   06440000
064500         MOVE -1                      TO AFASTL                   06450000
064600         MOVE PV-FAST-13              TO AFASTO                   06460014
064700         MOVE 'INVALID CHECK DIGIT '  TO AMSGLNO                  06470000
064800     END-IF.                                                      06480000
064900                                                                  06490000
065000 2115-COMPARE-STORES.                                             06500000
065100* WHEN ADDING A FAST TRANSFER TO AN EXISTING LABEL, BOTH          06510000
065200* MUST HAVE THE SAME DESTINATION.                                 06520000
065300                                                                  06530000
065400     IF PC033-STR-NBR = TFMSTR-TO-STR-NBR                         06540000
065500         CONTINUE                                                 06550000
065600     ELSE                                                         06560000
065700         SET PS-ERRORS-YES                                        06570000
065800             PS-XCTL-E852             TO TRUE                     06580000
065900         MOVE ZEROES                  TO PC033-FAST-NBR           06590000
066000         MOVE 6                       TO PC033-PGM-MSG-NBR        06600000
066100     END-IF.                                                      06610000
066200*  CHECK DIGIT ROUTINE FOR FAST NUMBERS                           06620000
066300     COPY PCPD037.                                                06630000
066400                                                                  06640000
066500 2160-CONVERT-FAST-TO-NUMERIC.                                    06650000
066600                                                                  06660000
066700     MOVE PC033-FAST-NBR              TO DP010I-UNEDITED-FIELD    06670000
066800     MOVE LENGTH OF PC033-FAST-NBR    TO DP010I-MAXIMUM-DIGITS    06680000
066900     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  06690000
067000     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     06700000
067110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06711021
067120                         USING DP010I-NUMERIC-EDIT-AREA           06712021
067200     IF  DP010I-ERROR-DETECTED                                    06720000
067300         SET PS-ERRORS-YES            TO TRUE                     06730000
067400     ELSE                                                         06740000
067500         MOVE DP010I-NUMERIC-FIELD    TO                          06750000
067600                                   SUT00028-TRN-NBR               06760000
067700     END-IF.                                                      06770000
067800                                                                  06780000
067900 2200-CHECK-TABLES.                                               06790000
068000                                                                  06800000
068100     MOVE ' 2200-CHECK-TABLES' TO PV-LOG-MSG                      06810000
068200*    PERFORM 9905-WRITEQ.                                         06820000
068300                                                                  06830000
068400     MOVE PC037-XFER-FROM-STORE-NBR   TO DK-FR-STR-NBR            06840000
068500     MOVE PC037-XFER-SEQ-NBR          TO DK-XFER-SEQ-NBR          06850000
068600                                                                  06860000
068700     IF DK-FR-STR-NBR = ZERO AND DK-XFER-SEQ-NBR = ZERO           06870000
068800         SET PS-TTFMSTR-YES           TO TRUE                     06880000
068900     ELSE                                                         06890000
069000         PERFORM 7000-SELECT-TTFMSTR                              06900000
069100     END-IF                                                       06910000
069200                                                                  06920000
069300     IF PS-TTFMSTR-YES                                            06930000
069400         IF PC033-MOVE-FAST-TO-NEW-LABEL                          06940000
069500             SET PS-CART-UPC-YES      TO TRUE                     06950000
069600         ELSE                                                     06960000
069700             PERFORM 7050-SELECT-CART-UPC                         06970000
069800         END-IF                                                   06980000
069900     END-IF.                                                      06990000
070000/                                                                 07000000
070100 2500-MOVE-COMMAREA-TO-MAP.                                       07010000
070200     MOVE PV-FAST-NBR                 TO AFASTO                   07020000
070300     MOVE PC033-STR-NBR               TO ASTOREO                  07030000
070400     IF PC033-NBR-LABELS-REQUESTED < 1                            07040000
070500         MOVE 1                       TO                          07050000
070600                              PC033-NBR-LABELS-REQUESTED          07060000
070700     END-IF.                                                      07070000
070800     MOVE PV-FAST-COUNTER             TO ACOUNTO.                 07080000
070900/                                                                 07090000
071000 3000-ADD-FAST-TO-CARTON.                                         07100000
071100                                                                  07110000
071200     MOVE ' 3000-ADD-FAST-TO-CARTON' TO PV-LOG-MSG                07120000
071300*    PERFORM 9905-WRITEQ.                                         07130000
071400                                                                  07140000
071500     IF DK-FR-STR-NBR = ZERO AND DK-XFER-SEQ-NBR = ZERO           07150000
071600         MOVE ZERO                    TO SUT00028-TRN-NBR         07160000
071700                                         TFITEM-XFER-LNE-NBR      07170000
071800                                         TFITEM-KOHLS-UPC-NBR     07180000
071900                                         SUT00028-SHPD-UNT-QTY    07190011
072000         PERFORM 7150-INSERT-CART-UPC                             07200000
072100         IF AMSGLNO = SPACES                                      07210004
072200             ADD 1                TO PV-FAST-COUNTER              07220004
072300         END-IF                                                   07230004
072400     ELSE                                                         07240000
072500         PERFORM 7100-OPEN-FAST-ITEM-CSR                          07250000
072600         PERFORM 7110-FETCH-FAST-ITEM-CSR                         07260000
072700                                                                  07270000
072800         PERFORM UNTIL PS-END-FAST-ITEM-CSR                       07280000
072900             MOVE  PC033-FR-STR-NBR   TO  PV-TRN-STORE            07290018
073000             MOVE  PC033-XFER-SEQ-NBR TO  PV-TRN-SEQUENCE         07300018
073100             MOVE  PV-TRN-NBR         TO  PV-TRN-NBR-COMP         07310018
073200             MOVE  PV-TRN-NBR-COMP    TO  SUT00028-TRN-NBR        07320018
073300             MOVE  TFITEM-XFER-QTY    TO  SUT00028-SHPD-UNT-QTY   07330018
073400             PERFORM 7150-INSERT-CART-UPC                         07340000
073500             PERFORM 7110-FETCH-FAST-ITEM-CSR                     07350000
073600         END-PERFORM                                              07360000
073700         PERFORM 7120-CLOSE-FAST-ITEM-CSR                         07370000
073800         IF AMSGLNO = SPACES                                      07380004
073900             ADD 1                TO PV-FAST-COUNTER              07390004
074000         END-IF                                                   07400004
074100     END-IF.                                                      07410000
074200/                                                                 07420000
074300 3100-DELETE-FAST-FROM-CARTONS.                                   07430000
074400                                                                  07440000
074500     PERFORM 2160-CONVERT-FAST-TO-NUMERIC                         07450000
074600     PERFORM 7400-OPEN-LABEL-CSR                                  07460000
074700     PERFORM 7410-FETCH-LABEL-CSR                                 07470000
074800                                                                  07480000
074900     PERFORM UNTIL PS-END-CARTON-CSR-YES OR PS-ERRORS-YES         07490000
075000         PERFORM 7550-CHECK-ONLY-FAST-IN-CARTON                   07500000
075100         IF PV-FAST-COUNT = ZERO                                  07510000
075200*            THERE ARE NO OTHER FAST TRANSFERS IN THIS CARTON     07520000
075300*            SO DELETE THE CARTON AND ALL ITEMS WITHIN IT         07530000
075400             PERFORM 7500-DELETE-OTBND-CART                       07540000
075500         ELSE                                                     07550000
075600*            THERE ARE OTHER FAST TRANSFERS IN THIS CARTON        07560000
075700*            SO DELETE ONLY THE SCANNED FAST ITEMS WITHIN IT      07570000
075800             PERFORM 7500-DELETE-CART-UPC                         07580000
075900         END-IF                                                   07590000
076000     PERFORM 7410-FETCH-LABEL-CSR                                 07600000
076100     END-PERFORM                                                  07610000
076200                                                                  07620000
076300     PERFORM 7420-CLOSE-LABEL-CSR.                                07630000
076400/                                                                 07640000
076500 4000-PRINT-LABELS.                                               07650000
076600                                                                  07660000
076700     MOVE ' 4000-PRINT-LABELS'        TO PV-LOG-MSG               07670000
076800*    PERFORM 9905-WRITEQ.                                         07680000
076900                                                                  07690000
077000     PERFORM 4010-VALIDATE-PRINTER.                               07700000
077100     SET PC140-COMMON-MFST-LBL-NBR    TO TRUE                     07710000
077200     MOVE DP072-PRTR-IP-ADDRESS       TO PC140-SML-IP-ADDRESS     07720000
077300     MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                          07730000
077400                                      TO PC140-SML-OS-RLSE-CDE    07740000
077500     MOVE DP072-PRTR-DATA-XFER-MODE-ID                            07750000
077600                                      TO PC140-SML-XFER-MODE-ID   07760000
077700     MOVE DP072-XMIT-INTFC-CDE                                    07770000
077800                                      TO PC140-XMIT-INTFC-CDE     07780000
077900     MOVE DP072-PRTR-TYP-CDE                                      07790000
078000                                      TO PC140-SML-PRTR-TYPE      07800000
078100                                                                  07810000
078200     MOVE DP072-PRTR-OPER-UNT-ID      TO XLT00010-LOC-NBR         07820011
078300                                         COCNTL-OPER-UNT-ID       07830000
078400     PERFORM 7200-GET-DC-LOCATION.                                07840000
078500     PERFORM 7300-CHECK-IF-DC.                                    07850000
078600                                                                  07860000
078700     MOVE PC033-STR-NBR               TO PC187-STR-NBR            07870000
078800                                                                  07880000
078900     MOVE PC033-NBR-LABELS-REQUESTED  TO PC187-NO-OF-LBLS         07890000
079000                                         PC140-SML-TOT-CART       07900000
079100     PERFORM 4200-DISASSEMBLE-CARTON-ID                           07910000
079200                                                                  07920000
079300     MOVE PC033-SML-PRTR-ID           TO PC140-SML-PRTR-ID        07930000
079400     MOVE 'FT-'                       TO PC140-SML-TYPE           07940000
079500     PERFORM 7250-GET-STORE-NAME                                  07950000
079600                                                                  07960000
079700     MOVE XLT00010-LOC-10-ABBR-NM     TO PC140-SML-STR-NAME       07970011
079800     MOVE PC187-START-MFST-NBR        TO PC140-SML-STRT-MFST-NBR  07980000
079900     MOVE PC033-OPER-UNT-ID           TO PC140-SML-ORIGIN-DC      07990000
080000     MOVE ZERO                        TO PC140-SML-DIVERT-PFX.    08000000
080100     MOVE COCNTL-SSCC-18-IND          TO PC140-CRA-DC-SSCC-18-IND 08010000
080200     MOVE PC033-STR-NBR               TO PC140-CRA-LOC-ID         08020000
080300                                                                  08030000
080400     INITIALIZE PC140-SML-ZNE-LINE-1                              08040000
080500                PC140-SML-ZNE-LINE-2                              08050000
080600                PC140-SML-ZNE-LINE-3.                             08060000
080700     MOVE '* FAST TRANSFER *'         TO PC140-SML-ZNE-LINE-1.    08070000
080800                                                                  08080000
080900     MOVE PC033-STR-NBR               TO PV-STORE-NUMBER-N        08090000
081000     MOVE PV-STORE-NUMBER             TO PC140-SML-STR-NBR        08100000
081100                                                                  08110000
081200     MOVE PC033-FR-STR-NBR            TO PC037-XFER-FROM-STORE-NBR08120000
081300                                         PV-FAST-STORE            08130000
081400     MOVE PC033-XFER-SEQ-NBR          TO PC037-XFER-SEQ-NBR       08140000
081500                                         PV-FAST-SEQ              08150000
081600     PERFORM P0300-GET-CHK-DIGIT                                  08160000
081700     MOVE PC037-FAST-CHECK-DIGIT      TO PV-FAST-CHK-DIGIT        08170000
081800     MOVE '    MULTIPLE    '          TO PC140-SML-ZNE-LINE-2.    08180000
081900                                                                  08190000
082000     PERFORM 6100-LINK-SOCKET-PRINT-ROUTINE.                      08200000
082100/                                                                 08210000
082200 4010-VALIDATE-PRINTER.                                           08220000
082300                                                                  08230000
082400     MOVE ' 4100-VALIDATE-PRINTER' TO PV-LOG-MSG                  08240000
082500*    PERFORM 9905-WRITEQ.                                         08250000
082600                                                                  08260000
082700     MOVE '01'                        TO DP072-RPT-PGM-TYP-ID.    08270000
082800     MOVE PC033-OPER-UNT-ID           TO DP072-ORIGIN-OPER-UNT-ID 08280000
082900                                        DP072-OPER-UNT-ID.        08290000
083000     MOVE 1                           TO DP072-ORIGIN-FCLTY-ID    08300000
083100                                         DP072-FCLTY-ID.          08310000
083200     MOVE 'PCKCS126'                  TO DP072-RPT-PGM-NME        08320000
083300     MOVE PC033-SML-PRTR-ID           TO DP072-PRINTER-ID         08330000
083400     SET DP072-VALIDATE               TO TRUE                     08340000
083500                                                                  08350000
083600     EXEC CICS                                                    08360000
083700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  08370000
083800               COMMAREA (DP072-COMM-AREA)                         08380000
083900               RESP     (PV-CICS-RESPONSE)                        08390000
084000     END-EXEC                                                     08400000
084100                                                                  08410000
084200     EVALUATE TRUE                                                08420000
084300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08430000
084400              CONTINUE                                            08440000
084500         WHEN OTHER                                               08450000
084600             SET PS-ERRORS-YES        TO TRUE                     08460000
084700             MOVE 'INVALID PRINTER ID'                            08470000
084800                                      TO AMSGLNO                  08480000
084900     END-EVALUATE.                                                08490000
085000                                                                  08500000
085100 4200-DISASSEMBLE-CARTON-ID.                                      08510000
085200                                                                  08520000
085300     MOVE ' 4200-DISASSEMBLE-CARTON-ID' TO PV-LOG-MSG             08530000
085400*    PERFORM 9905-WRITEQ.                                         08540000
085500                                                                  08550000
085600     MOVE PC033-CARTON                TO PV-BARCODE-18            08560000
085700     MOVE PV-BARCODE-18               TO                          08570000
085800                                PC160-20-DIGIT-BARCODE (3:18)     08580000
085900     MOVE PC160-20-SML-BC-MNFST-NBR                               08590000
086000                                      TO PC187-START-MFST-NBR     08600000
086100     MOVE PC160-20-SML-BC-DC-ORIGIN   TO PC033-OPER-UNT-ID        08610000
086200     MOVE PC160-20-SML-BC-DIVERT-CDE  TO PC033-STR-NBR.           08620000
086300/                                                                 08630000
086400 6000-LINK-PCKCS721.                                              08640000
086500                                                                  08650000
086600     MOVE ' 6000-LINK-PCKCS721' TO PV-LOG-MSG                     08660000
086700*    PERFORM 9905-WRITEQ.                                         08670000
086800                                                                  08680000
086900     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   08690000
087000                                                                  08700000
087100     EXEC CICS                                                    08710000
087200         LINK PROGRAM  (PC-PCKCS721)                              08720000
087300              COMMAREA (PC187-COMMAREA-REC)                       08730000
087400              LENGTH   (PV-COMMAREA-LENGTH)                       08740000
087500              RESP     (PV-CICS-RESPONSE)                         08750000
087600     END-EXEC.                                                    08760000
087700                                                                  08770000
087800     EVALUATE TRUE                                                08780000
087900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08790000
088000              IF  PC187-CRA-SUCCESSFUL                            08800000
088100                  CONTINUE                                        08810000
088200              ELSE                                                08820000
088300                  SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE         08830000
088400*                 MOVE SQLCODE              TO PV-SQL-CODE        08840000
088500*                 STRING ' PCKCS707 - '        DELIMITED BY SIZE  08850000
088600*                        '6000-LINK-PCKCS721 ' DELIMITED BY SIZE  08860000
088700*                        ' RETURN MESSAGE - '  DELIMITED BY SIZE  08870000
088800*                        PC187-CRA-RET-MSG     DELIMITED BY SIZE  08880000
088900*                        '  PARA-'             DELIMITED BY SIZE  08890000
089000*                        PC187-CRA-REQ-ID      DELIMITED BY SIZE  08900000
089100*                                         INTO PV-CICS-MSG-AREA   08910000
089200*                 MOVE LENGTH OF PV-CICS-MSG-AREA                 08920000
089300*                                           TO PV-COMMAREA-LENGTH 08930000
089400*                 PERFORM 9990-WRITE-CICS                         08940000
089500              END-IF                                              08950000
089600         WHEN OTHER                                               08960000
089700              SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE             08970000
089800*             MOVE SQLCODE              TO PV-SQL-CODE            08980000
089900*             STRING ' PCKCS707 (OTHER) -' DELIMITED BY SIZE      08990000
090000*                    '6000-LINK-PCKCS721 ' DELIMITED BY SIZE      09000000
090100*                    ' RETURN MESSAGE - '  DELIMITED BY SIZE      09010000
090200*                    PC187-CRA-RET-MSG     DELIMITED BY SIZE      09020000
090300*                    '  PARA-'             DELIMITED BY SIZE      09030000
090400*                    PC187-CRA-REQ-ID      DELIMITED BY SIZE      09040000
090500*                                     INTO PV-CICS-MSG-AREA       09050000
090600*             MOVE LENGTH OF PV-CICS-MSG-AREA                     09060000
090700*                                       TO PV-COMMAREA-LENGTH     09070000
090800*             PERFORM 9990-WRITE-CICS                             09080000
090900     END-EVALUATE.                                                09090000
091000/                                                                 09100000
091100 6100-LINK-SOCKET-PRINT-ROUTINE.                                  09110000
091200                                                                  09120000
091300     MOVE ' 6100-LINK-SOCKET-PRINT-ROUTINE' TO PV-LOG-MSG         09130000
091400*    PERFORM 9905-WRITEQ.                                         09140000
091500                                                                  09150000
091600     MOVE PC033-USER-ID               TO PC140-CRA-USERID.        09160000
091700     MOVE LENGTH OF PC140-LABELMST    TO PV-COMMAREA-LENGTH.      09170000
091800                                                                  09180000
091900     EXEC CICS                                                    09190000
092000          LINK PROGRAM  ('PCKCS707')                              09200000
092100               COMMAREA (PC140-LABELMST)                          09210000
092200               LENGTH   (PV-COMMAREA-LENGTH)                      09220000
092300               RESP     (PV-CICS-RESPONSE)                        09230000
092400     END-EXEC.                                                    09240000
092500                                                                  09250000
092600     EVALUATE TRUE                                                09260000
092700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09270000
092800              CONTINUE                                            09280000
092900         WHEN OTHER                                               09290000
093000             PERFORM DP014-0000-PROCESS-ABEND                     09300000
093100     END-EVALUATE.                                                09310000
093200                                                                  09320000
093300     EVALUATE TRUE                                                09330000
093400     WHEN PC140-CRA-SOCKET-COMM-ERROR                             09340000
093500         SET PS-ERRORS-YES            TO TRUE                     09350000
093600         MOVE '*** COMM ERROR *** '   TO AMSGLNO                  09360000
093700*LABEL REQUEST FAILED DUE TO COMMUNICATION ERROR - CALL HELP DESK 09370000
093800     WHEN PC140-CRA-INVALID-PRT-FMT                               09380000
093900         MOVE PC140-CRA-RET-CDE       TO PM-RET-CDE               09390000
094000         MOVE PC140-CRA-RET-MSG       TO PM-RET-MSG               09400000
094100         MOVE 'INVALID PRT FORMAT'    TO AMSGLNO                  09410000
094200     WHEN OTHER                                                   09420000
094300*       PRINT REQUEST HAS BEEN SUBMITTED                          09430000
094400         SET PC033-LABEL-PRINT-COMPLETED                          09440000
094500                                      TO TRUE                     09450000
094600     END-EVALUATE.                                                09460000
094700                                                                  09470000
094800 7000-SELECT-TTFMSTR.                                             09480000
094900     MOVE ' 7000-SELECT-TTFMSTR' TO PV-LOG-MSG                    09490000
095000*    PERFORM 9905-WRITEQ.                                         09500000
095100                                                                  09510000
095200     EXEC SQL                                                     09520000
095300         SELECT X.TO_STR_NBR                                      09530000
095400         ,      X.XFER_DKEY_ID                                    09540000
095500         INTO :TFMSTR-TO-STR-NBR                                  09550000
095600         ,    :TFMSTR-XFER-DKEY-ID                                09560000
095700         FROM TTFMSTR X                                           09570000
095800         WHERE X.FR_STR_NBR            = :DK-FR-STR-NBR           09580000
095900                 AND  X.XFER_SEQ_NBR   = :DK-XFER-SEQ-NBR         09590000
096000     END-EXEC.                                                    09600000
096100                                                                  09610000
096200     EVALUATE TRUE                                                09620000
096300         WHEN SQLCODE = ZERO                                      09630000
096400             SET PS-TTFMSTR-YES       TO TRUE                     09640000
096500             MOVE TFMSTR-XFER-DKEY-ID TO PC033-XFER-DKEY-ID       09650000
096600         WHEN SQLCODE = +100                                      09660000
096700             SET PS-TTFMSTR-NO                                    09670000
096800                 PS-ERRORS-YES        TO TRUE                     09680000
096900             INITIALIZE PC033-SKU-NBR                             09690000
097000                        PC033-XFER-DKEY-ID                        09700000
097100         WHEN SQLCODE = -904                                      09710000
097200         WHEN SQLCODE = -913                                      09720000
097300         WHEN SQLCODE = -911                                      09730000
097400             MOVE 1                   TO PV-ERROR-NBR             09740000
097500*            PERFORM 9903-WRITE-CICS-LOG                          09750000
097600             PERFORM 9000-SOFT-ABORT                              09760000
097700         WHEN SQLWARN0 NOT = SPACES                               09770000
097800         WHEN SQLCODE NOT EQUAL ZERO                              09780000
097900             MOVE 2                   TO PV-ERROR-NBR             09790000
098000                                         PC033-ERROR-NBR          09800000
098100             PERFORM 9903-WRITE-CICS-LOG                          09810000
098200             MOVE '7000-SELECT-TTFMSTR'                           09820000
098300                                      TO PC033-PARAGRAPH          09830000
098400             MOVE 'PCKRF855 - CHECK VALID CARTON'                 09840020
098500                                      TO PC033-MESSAGE-TEXT(1)    09850000
098600             MOVE SQLCA               TO PC033-SQLCA              09860000
098700             MOVE 'TTFMSTR'           TO PC033-DB2-TABLE-NAME(1)  09870000
098800             PERFORM DP014-0000-PROCESS-ABEND                     09880000
098900             SET PC033-ABEND          TO TRUE                     09890000
099000             MOVE 99                  TO PC033-PGM-MSG-NBR        09900000
099100             PERFORM 8210-XCTL-ERROR-SCREEN                       09910000
099200     END-EVALUATE.                                                09920000
099300/                                                                 09930000
099400 7050-SELECT-CART-UPC.                                            09940000
099500     MOVE ' 7050-SELECT-CART-UPC' TO PV-LOG-MSG                   09950000
099600*    PERFORM 9905-WRITEQ.                                         09960000
099700                                                                  09970000
099800     EXEC SQL                                                     09980000
099900         SELECT TRN_NBR                                           09990000
100000         INTO :SUT00028-TRN-NBR                                   10000000
100100         FROM SUT_OTBND_UPC                                       10010000
100200         WHERE SHIPT_UNT_ID           = :PC033-CARTON             10020000
100300           AND TRN_TYP_CDE            = 'FX'                      10030000
100400     END-EXEC.                                                    10040000
100500                                                                  10050000
100600     EVALUATE TRUE                                                10060000
100700         WHEN SQLCODE = ZERO                                      10070000
100800         WHEN SQLCODE = -811                                      10080000
100900             SET PS-CART-UPC-YES      TO TRUE                     10090000
101000         WHEN SQLCODE = +100                                      10100000
101100             SET PS-CART-UPC-NO       TO TRUE                     10110000
101200         WHEN SQLCODE = -904                                      10120000
101300         WHEN SQLCODE = -913                                      10130000
101400         WHEN SQLCODE = -911                                      10140000
101500             MOVE 3                   TO PV-ERROR-NBR             10150000
101600*            PERFORM 9903-WRITE-CICS-LOG                          10160000
101700             PERFORM 9000-SOFT-ABORT                              10170000
101800         WHEN SQLWARN0 NOT = SPACES                               10180000
101900         WHEN SQLCODE NOT EQUAL ZERO                              10190000
102000             MOVE 4                   TO PV-ERROR-NBR             10200000
102100                                         PC033-ERROR-NBR          10210000
102200             PERFORM 9903-WRITE-CICS-LOG                          10220000
102300             MOVE '7050-SELECT-SHUUPC'                            10230000
102400                                      TO PC033-PARAGRAPH          10240000
102500             MOVE 'PCKRF855 - CHECK FAST NBR UPC'                 10250000
102600                                      TO PC033-MESSAGE-TEXT(1)    10260000
102700             MOVE SQLCA               TO PC033-SQLCA              10270000
102800             MOVE 'SUT00028'          TO PC033-DB2-TABLE-NAME(1)  10280000
102900             SET PC033-ABEND          TO TRUE                     10290000
103000             MOVE 99                  TO PC033-PGM-MSG-NBR        10300000
103100             PERFORM 8210-XCTL-ERROR-SCREEN                       10310000
103200     END-EVALUATE.                                                10320000
103300/                                                                 10330000
103400 7100-OPEN-FAST-ITEM-CSR.                                         10340000
103500     MOVE ' 7100-OPEN-FAST-ITEM-CSR' TO  PV-LOG-MSG               10350000
103600*    PERFORM 9905-WRITEQ.                                         10360000
103700                                                                  10370000
103800     EXEC SQL                                                     10380000
103900         OPEN FAST-ITEM-CSR                                       10390000
104000     END-EXEC                                                     10400000
104100                                                                  10410000
104200     EVALUATE TRUE                                                10420000
104300         WHEN SQLCODE = ZERO                                      10430000
104400             SET PS-NOT-END-FAST-ITEM-CSR                         10440000
104500                                      TO TRUE                     10450000
104600         WHEN SQLCODE = -904                                      10460000
104700         WHEN SQLCODE = -913                                      10470000
104800         WHEN SQLCODE = -911                                      10480000
104900             MOVE 5                   TO PV-ERROR-NBR             10490000
105000*            PERFORM 9903-WRITE-CICS-LOG                          10500000
105100             PERFORM 9000-SOFT-ABORT                              10510000
105200         WHEN SQLWARN0 NOT = SPACES                               10520000
105300         WHEN SQLCODE NOT EQUAL ZERO                              10530000
105400             MOVE 6                   TO PV-ERROR-NBR             10540000
105500                                         PC033-ERROR-NBR          10550000
105600             PERFORM 9903-WRITE-CICS-LOG                          10560000
105700             MOVE '7100-OPEN-FAST-ITEM-CSR'                       10570000
105800                                      TO PC033-PARAGRAPH          10580000
105900             MOVE 'PCKRF855 - OPEN FAST ITEM CSR'                 10590000
106000                                      TO PC033-MESSAGE-TEXT(1)    10600000
106100             MOVE SQLCA               TO PC033-SQLCA              10610000
106200             MOVE 'TTFITEM'           TO PC033-DB2-TABLE-NAME(1)  10620000
106300             SET PC033-ABEND          TO TRUE                     10630000
106400             MOVE 99                  TO PC033-PGM-MSG-NBR        10640000
106500             PERFORM 8210-XCTL-ERROR-SCREEN                       10650000
106600     END-EVALUATE.                                                10660000
106700                                                                  10670000
106800 7110-FETCH-FAST-ITEM-CSR.                                        10680000
106900                                                                  10690000
107000     MOVE ' 7110-FETCH-FAST-ITEM-CSR' TO  PV-LOG-MSG              10700000
107100*    PERFORM 9905-WRITEQ.                                         10710000
107200                                                                  10720000
107300     EXEC SQL                                                     10730000
107400     FETCH FAST-ITEM-CSR                                          10740000
107500     INTO                                                         10750000
107600         :TFITEM-XFER-LNE-NBR                                     10760000
107700      ,  :TFITEM-KOHLS-UPC-NBR                                    10770000
107800      ,  :TFITEM-XFER-QTY                                         10780011
107900     END-EXEC.                                                    10790000
108000                                                                  10800000
108100     EVALUATE TRUE                                                10810000
108200         WHEN SQLCODE = ZERO                                      10820000
108300             CONTINUE                                             10830000
108400         WHEN SQLCODE = +100                                      10840000
108500             SET PS-END-FAST-ITEM-CSR TO TRUE                     10850000
108600         WHEN SQLCODE = -904                                      10860000
108700         WHEN SQLCODE = -913                                      10870000
108800         WHEN SQLCODE = -911                                      10880000
108900             MOVE 7                   TO PV-ERROR-NBR             10890000
109000*            PERFORM 9903-WRITE-CICS-LOG                          10900000
109100             PERFORM 9000-SOFT-ABORT                              10910000
109200         WHEN SQLWARN0 NOT = SPACES                               10920000
109300         WHEN SQLCODE NOT EQUAL ZERO                              10930000
109400             MOVE 8                   TO PV-ERROR-NBR             10940000
109500                                         PC033-ERROR-NBR          10950000
109600             PERFORM 9903-WRITE-CICS-LOG                          10960000
109700             MOVE '7110-FETCH-FAST-ITEM-CSR'                      10970000
109800                                      TO PC033-PARAGRAPH          10980000
109900             MOVE 'PCKRF855 - OPEN FAST ITEM CSR'                 10990000
110000                                      TO PC033-MESSAGE-TEXT(1)    11000000
110100*            MOVE DK-TRN-NBR          TO PC033-MESSAGE-TEXT(2)    11010000
110200             MOVE SQLCA               TO PC033-SQLCA              11020000
110300             MOVE 'TTFITEM'           TO PC033-DB2-TABLE-NAME(1)  11030000
110400             SET PC033-ABEND          TO TRUE                     11040000
110500             MOVE 99                  TO PC033-PGM-MSG-NBR        11050000
110600             PERFORM 8210-XCTL-ERROR-SCREEN                       11060000
110700     END-EVALUATE.                                                11070000
110800                                                                  11080000
110900 7120-CLOSE-FAST-ITEM-CSR.                                        11090000
111000                                                                  11100000
111100     MOVE ' 7120-CLOSE-FAST-ITEM-CSR' TO  PV-LOG-MSG              11110000
111200*    PERFORM 9905-WRITEQ.                                         11120000
111300                                                                  11130000
111400     EXEC SQL                                                     11140000
111500         CLOSE FAST-ITEM-CSR                                      11150000
111600     END-EXEC                                                     11160000
111700                                                                  11170000
111800     EVALUATE TRUE                                                11180000
111900         WHEN SQLCODE = ZERO                                      11190000
112000             CONTINUE                                             11200000
112100         WHEN SQLCODE = -904                                      11210000
112200         WHEN SQLCODE = -913                                      11220000
112300         WHEN SQLCODE = -911                                      11230000
112400             MOVE 9                   TO PV-ERROR-NBR             11240000
112500*            PERFORM 9903-WRITE-CICS-LOG                          11250000
112600             PERFORM 9000-SOFT-ABORT                              11260000
112700         WHEN SQLWARN0 NOT = SPACES                               11270000
112800         WHEN SQLCODE NOT EQUAL ZERO                              11280000
112900             MOVE 10                  TO PV-ERROR-NBR             11290000
113000                                         PC033-ERROR-NBR          11300000
113100             PERFORM 9903-WRITE-CICS-LOG                          11310000
113200             MOVE '7120-CLOSE-FAST-ITEM-CSR'                      11320000
113300                                      TO PC033-PARAGRAPH          11330000
113400             MOVE 'PCKRF855 - CLOSE FAST ITEM CSR'                11340000
113500                                      TO PC033-MESSAGE-TEXT(1)    11350000
113600             MOVE SQLCA               TO PC033-SQLCA              11360000
113700             MOVE 'TTFITEM'           TO PC033-DB2-TABLE-NAME(1)  11370000
113800             SET PC033-ABEND          TO TRUE                     11380000
113900             MOVE 99                  TO PC033-PGM-MSG-NBR        11390000
114000             PERFORM 8210-XCTL-ERROR-SCREEN                       11400000
114100     END-EVALUATE.                                                11410000
114200/                                                                 11420000
114300 7150-INSERT-CART-UPC.                                            11430000
114400                                                                  11440000
114500     MOVE ' 7150-INSERT-CART-UPC' TO PV-LOG-MSG                   11450000
114600*    PERFORM 9905-WRITEQ.                                         11460000
114700                                                                  11470000
114800     EXEC SQL                                                     11480000
114900         INSERT INTO SUT_OTBND_UPC                                11490000
115000             (                                                    11500000
115100                 SHIPT_UNT_ID                                     11510000
115200             ,   TRN_NBR                                          11520000
115300             ,   TRN_LNE_NBR                                      11530000
115400             ,   TRN_TYP_CDE                                      11540000
115500             ,   UPC_NBR                                          11550000
115600             ,   SHPD_UNT_QTY                                     11560000
115700             ,   RCVR_SEQ_NBR                                     11570000
115800             )                                                    11580000
115900             VALUES                                               11590000
116000             (                                                    11600000
116100                 :PC033-CARTON                                    11610000
116200             ,   :SUT00028-TRN-NBR                                11620000
116300             ,   :TFITEM-XFER-LNE-NBR                             11630000
116400             ,   'FX'                                             11640000
116500             ,   :TFITEM-KOHLS-UPC-NBR                            11650000
116600             ,   :SUT00028-SHPD-UNT-QTY                           11660011
116700             ,   0                                                11670000
116800             )                                                    11680000
116900         END-EXEC                                                 11690000
117000                                                                  11700000
117100                                                                  11710000
117200     EVALUATE TRUE                                                11720000
117300         WHEN SQLCODE = ZERO                                      11730000
117400             CONTINUE                                             11740003
117500         WHEN SQLCODE = -803                                      11750000
117600             SET PS-ERRORS-YES        TO TRUE                     11760000
117700             MOVE DP015-UNP-ALP-NOR-MDT                           11770000
117800                                      TO AFASTA                   11780000
117900             MOVE -1              TO AFASTL                       11790000
118000             MOVE 'DUP FAST NBR IN CTN '                          11800000
118100                                      TO AMSGLNO                  11810000
118200         WHEN SQLCODE = -904                                      11820000
118300         WHEN SQLCODE = -913                                      11830000
118400         WHEN SQLCODE = -911                                      11840000
118500             MOVE 11                  TO PV-ERROR-NBR             11850000
118600*            PERFORM 9903-WRITE-CICS-LOG                          11860000
118700             PERFORM 9000-SOFT-ABORT                              11870000
118800         WHEN SQLWARN0 NOT = SPACES                               11880000
118900         WHEN SQLCODE NOT EQUAL ZERO                              11890000
119000             MOVE 12                  TO PV-ERROR-NBR             11900000
119100                                         PC033-ERROR-NBR          11910000
119200             PERFORM 9903-WRITE-CICS-LOG                          11920000
119300             MOVE '7150-INSERT-CART-UPC'                          11930000
119400                                      TO PC033-PARAGRAPH          11940000
119500             MOVE 'PCKRF855 - INSERT SUT_OTBND_UPC'               11950000
119600                                      TO PC033-MESSAGE-TEXT(1)    11960000
119700             MOVE SQLCA               TO PC033-SQLCA              11970000
119800             MOVE 'SUT00028'          TO PC033-DB2-TABLE-NAME(1)  11980000
119900             SET PC033-ABEND          TO TRUE                     11990000
120000             MOVE 99                  TO PC033-PGM-MSG-NBR        12000000
120100             PERFORM 8210-XCTL-ERROR-SCREEN                       12010000
120200     END-EVALUATE.                                                12020000
120300/                                                                 12030000
120400 7200-GET-DC-LOCATION.                                            12040000
120500     EXEC SQL                                                     12050000
120600          SELECT LOC_5_ABBR_NM                                    12060011
120700          INTO  :PV-DC-5-CHAR-ABBR                                12070000
120800          FROM   XLT_LOC                                          12080011
120900          WHERE  LOC_TYP_CDE = 'DC'                               12090011
121000          AND    LOC_NBR   = :XLT00010-LOC-NBR                    12100011
121100     END-EXEC.                                                    12110000
121200                                                                  12120000
121300     EVALUATE TRUE                                                12130000
121400         WHEN SQLCODE = ZERO                                      12140000
121500              MOVE  PV-2-DIGIT-DC-ABBR                            12150000
121600                                      TO PC140-CRA-DC-ID          12160000
121700              MOVE  XLT00010-LOC-NBR  TO PC140-CRA-OPER-UNT-ID    12170011
121800                                                                  12180000
121900         WHEN SQLCODE = +100                                      12190000
122000              MOVE  '90'              TO PC140-CRA-DC-ID          12200000
122100                                         PC140-CRA-OPER-UNT-ID    12210000
122200                                                                  12220000
122300         WHEN SQLWARN0 NOT = SPACES                               12230000
122400         WHEN SQLCODE NOT EQUAL ZERO                              12240000
122500             MOVE '7200-GET-DC-LOCATION'                          12250000
122600                             TO PC033-PARAGRAPH                   12260000
122700             MOVE 'PCKRF858 - GET DC LOCATION CODE'               12270000
122800                             TO PC033-MESSAGE-TEXT(1)             12280000
122900             MOVE PC140-CRA-DC-ID                                 12290000
123000                             TO PC033-MESSAGE-TEXT(2)             12300000
123100             MOVE SQLCA      TO PC033-SQLCA                       12310000
123200             MOVE 'XLT_LOC'  TO PC033-DB2-TABLE-NAME(1)           12320011
123300             SET PC033-ABEND          TO TRUE                     12330000
123400             MOVE 99                  TO PC033-PGM-MSG-NBR        12340000
123500             PERFORM 8210-XCTL-ERROR-SCREEN                       12350000
123600     END-EVALUATE.                                                12360000
123700                                                                  12370000
123800 7250-GET-STORE-NAME.                                             12380000
123900     EXEC SQL                                                     12390000
124000             SELECT LOC_10_ABBR_NM                                12400011
124100             INTO  :XLT00010-LOC-10-ABBR-NM                       12410011
124200             FROM   XLT_LOC                                       12420011
124300             WHERE  LOC_NBR = :PC033-STR-NBR                      12430011
124400             AND    LOC_TYP_CDE IN ('DS', 'DC', 'CS', 'RV')       12440011
124500     END-EXEC                                                     12450000
124600                                                                  12460000
124700                                                                  12470000
124800         EVALUATE TRUE                                            12480000
124900             WHEN SQLCODE = ZERO                                  12490000
125000             WHEN SQLCODE = +100                                  12500000
125100             WHEN SQLCODE = -904                                  12510000
125200             WHEN SQLCODE = -913                                  12520000
125300                 CONTINUE                                         12530000
125400             WHEN SQLWARN0 NOT = SPACES                           12540000
125500             WHEN SQLCODE < ZERO                                  12550000
125600             WHEN SQLCODE > ZERO                                  12560000
125700                 MOVE '7250-GET-STORE-NAME'                       12570000
125800                                 TO PC033-PARAGRAPH               12580000
125900                 MOVE 'SELECT STORE NAME'                         12590000
126000                                 TO PC033-MESSAGE-TEXT (1)        12600000
126100                 MOVE SQLCA      TO PC033-SQLCA                   12610000
126200                 MOVE 'XLT_LOC'  TO PC033-DB2-TABLE-NAME (1)      12620011
126300                 SET PC033-ABEND      TO TRUE                     12630000
126400                 MOVE 99              TO PC033-PGM-MSG-NBR        12640000
126500                 PERFORM 8210-XCTL-ERROR-SCREEN                   12650000
126600     END-EVALUATE.                                                12660000
126700/                                                                 12670000
126800 7300-CHECK-IF-DC.                                                12680000
126900                                                                  12690000
127000     EXEC SQL                                                     12700000
127100          SELECT  SSCC_18_IND                                     12710000
127200            INTO :COCNTL-SSCC-18-IND                              12720000
127300            FROM  TCOCNTL                                         12730000
127400           WHERE  OPER_UNT_ID = :COCNTL-OPER-UNT-ID               12740000
127500     END-EXEC.                                                    12750000
127600                                                                  12760000
127700     EVALUATE TRUE                                                12770000
127800         WHEN SQLCODE = ZERO                                      12780000
127900              CONTINUE                                            12790000
128000         WHEN SQLCODE = +100                                      12800000
128100              SET PS-ERRORS-YES       TO TRUE                     12810000
128200*INVALID DISTRIBUTION CENTER                                      12820000
128300         WHEN SQLWARN0 NOT = SPACES                               12830000
128400         WHEN SQLCODE < +0                                        12840000
128500         WHEN SQLCODE > +0                                        12850000
128600              MOVE '7300-CHECK-IF-DC'                             12860000
128700                                      TO PC033-PARAGRAPH          12870000
128800              MOVE 'CHECK IF OPER UNIT IS FOR DC'                 12880000
128900                                      TO PC033-MESSAGE-TEXT (1)   12890000
129000              MOVE SQLCA              TO PC033-SQLCA              12900000
129100              MOVE 'TCOCNTL'          TO PC033-DB2-TABLE-NAME (1) 12910000
129200              SET PC033-ABEND         TO TRUE                     12920000
129300              MOVE 99                 TO PC033-PGM-MSG-NBR        12930000
129400              PERFORM 8210-XCTL-ERROR-SCREEN                      12940000
129500     END-EVALUATE.                                                12950000
129600/                                                                 12960000
129700 7400-OPEN-LABEL-CSR.                                             12970000
129800                                                                  12980000
129900     EXEC SQL                                                     12990000
130000         OPEN LABEL-CSR                                           13000000
130100     END-EXEC                                                     13010000
130200                                                                  13020000
130300     EVALUATE TRUE                                                13030000
130400         WHEN SQLCODE = ZERO                                      13040000
130500              CONTINUE                                            13050000
130600         WHEN SQLWARN0 NOT = SPACES                               13060000
130700         WHEN SQLCODE < +0                                        13070000
130800         WHEN SQLCODE > +0                                        13080000
130900              MOVE '7400-OPEN-LABEL-CSR'                          13090000
131000                                      TO PC033-PARAGRAPH          13100000
131100              MOVE 'OPEN LABEL-CSR FOR REPRINTING'                13110000
131200                                      TO PC033-MESSAGE-TEXT (1)   13120000
131300              MOVE SQLCA              TO PC033-SQLCA              13130000
131400              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 13140000
131500              SET PC033-ABEND         TO TRUE                     13150000
131600              MOVE 99                 TO PC033-PGM-MSG-NBR        13160000
131700              PERFORM 8210-XCTL-ERROR-SCREEN                      13170000
131800     END-EVALUATE.                                                13180000
131900                                                                  13190000
132000 7410-FETCH-LABEL-CSR.                                            13200000
132100                                                                  13210000
132200     EXEC SQL                                                     13220000
132300         FETCH LABEL-CSR                                          13230000
132400         INTO :SUT00028-SHIPT-UNT-ID                              13240000
132500     END-EXEC                                                     13250000
132600                                                                  13260000
132700     EVALUATE TRUE                                                13270000
132800         WHEN SQLCODE = ZERO                                      13280000
132900              CONTINUE                                            13290000
133000         WHEN SQLCODE = +100                                      13300000
133100             SET PS-END-CARTON-CSR-YES                            13310000
133200                                      TO TRUE                     13320000
133300         WHEN SQLWARN0 NOT = SPACES                               13330000
133400         WHEN SQLCODE < +0                                        13340000
133500         WHEN SQLCODE > +0                                        13350000
133600              MOVE '7410-FETCH-LABEL-CSR'                         13360000
133700                                      TO PC033-PARAGRAPH          13370000
133800              MOVE 'FETCH LABEL-CSR FOR REPRINTING'               13380000
133900                                      TO PC033-MESSAGE-TEXT (1)   13390000
134000              MOVE SQLCA              TO PC033-SQLCA              13400000
134100              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 13410000
134200              SET PC033-ABEND         TO TRUE                     13420000
134300              MOVE 99                 TO PC033-PGM-MSG-NBR        13430000
134400              PERFORM 8210-XCTL-ERROR-SCREEN                      13440000
134500     END-EVALUATE.                                                13450000
134600                                                                  13460000
134700 7420-CLOSE-LABEL-CSR.                                            13470000
134800                                                                  13480000
134900     EXEC SQL                                                     13490000
135000         CLOSE LABEL-CSR                                          13500000
135100     END-EXEC                                                     13510000
135200                                                                  13520000
135300     EVALUATE TRUE                                                13530000
135400         WHEN SQLCODE = ZERO                                      13540000
135500              CONTINUE                                            13550000
135600         WHEN SQLWARN0 NOT = SPACES                               13560000
135700         WHEN SQLCODE < +0                                        13570000
135800         WHEN SQLCODE > +0                                        13580000
135900              MOVE '7420-CLOSE-LABEL-CSR'                         13590000
136000                                      TO PC033-PARAGRAPH          13600000
136100              MOVE 'CLOSE LABEL-CSR FOR REPRINTING'               13610000
136200                                      TO PC033-MESSAGE-TEXT (1)   13620000
136300              MOVE SQLCA              TO PC033-SQLCA              13630000
136400              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 13640000
136500              SET PC033-ABEND         TO TRUE                     13650000
136600              MOVE 99                 TO PC033-PGM-MSG-NBR        13660000
136700              PERFORM 8210-XCTL-ERROR-SCREEN                      13670000
136800     END-EVALUATE.                                                13680000
136900                                                                  13690000
137000 7450-COUNT-FAST-NBRS.                                            13700000
137100     EXEC SQL                                                     13710000
137200     SELECT COUNT(DISTINCT SHIPT_UNT_ID)                          13720000
137300         INTO :PV-LABEL-COUNT                                     13730000
137400         FROM SUT_OTBND_UPC A                                     13740000
137500         WHERE TRN_NBR = :SUT00028-TRN-NBR                        13750000
137600     END-EXEC                                                     13760000
137700                                                                  13770000
137800     EVALUATE TRUE                                                13780000
137900         WHEN SQLCODE = ZERO                                      13790000
138000              CONTINUE                                            13800000
138100         WHEN SQLWARN0 NOT = SPACES                               13810000
138200         WHEN SQLCODE < +0                                        13820000
138300         WHEN SQLCODE > +0                                        13830000
138400              MOVE '7450-COUNT-FAST-NBRS'                         13840000
138500                                      TO PC033-PARAGRAPH          13850000
138600              MOVE 'COUNT CARTONS FOR A FAST NBR'                 13860000
138700                                      TO PC033-MESSAGE-TEXT (1)   13870000
138800              MOVE SQLCA              TO PC033-SQLCA              13880000
138900              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 13890000
139000              SET PC033-ABEND         TO TRUE                     13900000
139100              MOVE 99                 TO PC033-PGM-MSG-NBR        13910000
139200              PERFORM 8210-XCTL-ERROR-SCREEN                      13920000
139300     END-EVALUATE.                                                13930000
139400/                                                                 13940000
139500 7500-DELETE-CART-UPC.                                            13950000
139600                                                                  13960000
139700* DELETE ALL THE ITEMS BELONGING TO THIS FAST THAT ARE CONTAINED  13970000
139800* WITHIN THIS CARTON                                              13980000
139900     EXEC SQL                                                     13990000
140000         DELETE                                                   14000000
140100         FROM SUT_OTBND_UPC A                                     14010000
140200         WHERE                                                    14020000
140300             SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID                14030000
140400             AND                                                  14040000
140500              TRN_NBR   = :SUT00028-TRN-NBR                       14050000
140600     END-EXEC.                                                    14060000
140700                                                                  14070000
140800     EVALUATE TRUE                                                14080000
140900         WHEN SQLCODE = ZERO                                      14090000
141000         WHEN SQLCODE = +100                                      14100000
141100              CONTINUE                                            14110000
141200         WHEN SQLWARN0 NOT = SPACES                               14120000
141300         WHEN SQLCODE < +0                                        14130000
141400         WHEN SQLCODE > +0                                        14140000
141500              MOVE '7500-DELETE-CART-UPC'                         14150000
141600                                      TO PC033-PARAGRAPH          14160000
141700              MOVE 'DELETE FAST ITEMS FROM A CARTON'              14170000
141800                                      TO PC033-MESSAGE-TEXT (1)   14180000
141900              MOVE SQLCA              TO PC033-SQLCA              14190000
142000              MOVE 'SUT00028'         TO PC033-DB2-TABLE-NAME (1) 14200000
142100              SET PC033-ABEND         TO TRUE                     14210000
142200              MOVE 99                 TO PC033-PGM-MSG-NBR        14220000
142300              PERFORM 8210-XCTL-ERROR-SCREEN                      14230000
142400     END-EVALUATE.                                                14240000
142500                                                                  14250000
142600 7550-CHECK-ONLY-FAST-IN-CARTON.                                  14260000
142700*                                                                 14270000
142800* IS THIS THE ONLY FAST NUMBER IN THE CARTON?                     14280000
142900                                                                  14290000
143000     EXEC SQL                                                     14300000
143100         SELECT COUNT(*)                                          14310000
143200         INTO :PV-FAST-COUNT                                      14320000
143300         FROM SUT_OTBND_CART A                                    14330000
143400         WHERE                                                    14340000
143500         A.SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID                  14350000
143600           AND                                                    14360000
143700              EXISTS                                              14370000
143800         (SELECT *                                                14380000
143900          FROM SUT_OTBND_UPC B                                    14390000
144000          WHERE A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                   14400000
144100          AND   B.TRN_NBR     <> :SUT00028-TRN-NBR)               14410000
144200     END-EXEC                                                     14420000
144300                                                                  14430000
144400     EVALUATE TRUE                                                14440000
144500         WHEN SQLCODE = ZERO                                      14450000
144600              CONTINUE                                            14460000
144700         WHEN SQLWARN0 NOT = SPACES                               14470000
144800         WHEN SQLCODE < +0                                        14480000
144900         WHEN SQLCODE > +0                                        14490000
145000             MOVE '7550-CHECK-ONLY-FAST-IN-CARTON'                14500000
145100                                      TO PC033-PARAGRAPH          14510000
145200             MOVE 'CHECK IF OTHER FAST NBRS IN A CARTON'          14520000
145300                                      TO PC033-MESSAGE-TEXT (1)   14530000
145400             MOVE SQLCA               TO PC033-SQLCA              14540000
145500             MOVE 'SUT00028'          TO PC033-DB2-TABLE-NAME (1) 14550000
145600             SET PC033-ABEND          TO TRUE                     14560000
145700             MOVE 99                  TO PC033-PGM-MSG-NBR        14570000
145800             PERFORM 8210-XCTL-ERROR-SCREEN                       14580000
145900     END-EVALUATE.                                                14590000
146000                                                                  14600000
146100 7500-DELETE-OTBND-CART.                                          14610000
146200                                                                  14620000
146300     EXEC SQL                                                     14630000
146400         DELETE                                                   14640000
146500         FROM SUT_OTBND_CART A                                    14650000
146600         WHERE                                                    14660000
146700             SHIPT_UNT_ID  = :SUT00028-SHIPT-UNT-ID               14670000
146800     END-EXEC.                                                    14680000
146900                                                                  14690000
147000     EVALUATE TRUE                                                14700000
147100         WHEN SQLCODE = ZERO                                      14710000
147200         WHEN SQLCODE = +100                                      14720000
147300              CONTINUE                                            14730000
147400         WHEN SQLWARN0 NOT = SPACES                               14740000
147500         WHEN SQLCODE < +0                                        14750000
147600         WHEN SQLCODE > +0                                        14760000
147700              MOVE '7500-DELETE-OTBND-CART'                       14770000
147800                                      TO PC033-PARAGRAPH          14780000
147900              MOVE 'DELETE AN EMPTY CARTON'                       14790000
148000                                      TO PC033-MESSAGE-TEXT (1)   14800000
148100              MOVE SQLCA              TO PC033-SQLCA              14810000
148200              MOVE 'SUT00024'         TO PC033-DB2-TABLE-NAME (1) 14820000
148300             SET PC033-ABEND          TO TRUE                     14830000
148400             MOVE 99                  TO PC033-PGM-MSG-NBR        14840000
148500             PERFORM 8210-XCTL-ERROR-SCREEN                       14850000
148600     END-EVALUATE.                                                14860000
148700                                                                  14870000
148800/                                                                 14880000
148900 8000-SEND-MAP.                                                   14890000
149000                                                                  14900000
149100     IF PC033-ADD-FAST-TO-LABEL OR PC033-MOVE-FAST-TO-NEW-LABEL   14910000
149200         MOVE PC033-CARTON    TO ASMLO                            14920000
149300     END-IF                                                       14930000
149400     EXEC CICS                                                    14940000
149500         SEND MAP       ('PC855A')                                14950000
149600              MAPSET    ('PCKM855')                               14960000
149700              ERASE                                               14970000
149800              CURSOR                                              14980000
149900              RESP      (PV-CICS-RESPONSE)                        14990000
150000     END-EXEC.                                                    15000000
150100                                                                  15010000
150200     EVALUATE TRUE                                                15020000
150300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15030000
150400             CONTINUE                                             15040000
150500         WHEN OTHER                                               15050000
150600             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          15060000
150700             MOVE 'PCKRF855 - UNABLE TO SEND MAP'                 15070000
150800                                      TO DP013-MESSAGE-TEXT (1)   15080000
150900             SET DP013-CICS-ABEND                                 15090000
151000                 DP013-ROLLBACK       TO TRUE                     15100000
151100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15110000
151200     END-EVALUATE.                                                15120000
151300                                                                  15130000
151400 8010-SEND-DATA-ONLY.                                             15140000
151500                                                                  15150000
151600     IF PC033-ADD-FAST-TO-LABEL                                   15160000
151700         MOVE PC033-CARTON    TO ASMLO                            15170000
151800     END-IF                                                       15180000
151900                                                                  15190000
152000     MOVE -1                          TO AFASTL                   15200000
152100     EXEC CICS                                                    15210000
152200         SEND MAP       ('PC855A')                                15220000
152300              MAPSET    ('PCKM855')                               15230000
152400              CURSOR                                              15240000
152500              DATAONLY                                            15250000
152600              RESP      (PV-CICS-RESPONSE)                        15260000
152700     END-EXEC.                                                    15270000
152800                                                                  15280000
152900     EVALUATE TRUE                                                15290000
153000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15300000
153100             CONTINUE                                             15310000
153200         WHEN OTHER                                               15320000
153300             MOVE '8010-SEND-DATA-ONLY'                           15330000
153400                                      TO DP013-PARAGRAPH          15340000
153500             MOVE 'PCKRF855 - UNABLE TO SEND DATA'                15350000
153600                                      TO DP013-MESSAGE-TEXT (1)   15360000
153700             SET DP013-CICS-ABEND                                 15370000
153800                 DP013-ROLLBACK       TO TRUE                     15380000
153900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15390000
154000     END-EVALUATE.                                                15400000
154100                                                                  15410000
154200 8020-RECEIVE-MAP.                                                15420000
154300                                                                  15430000
154400     MOVE SPACES                      TO AFASTI                   15440000
154500     EXEC CICS                                                    15450000
154600         RECEIVE MAP    ('PC855A')                                15460000
154700                 MAPSET ('PCKM855')                               15470000
154800                 RESP   (PV-CICS-RESPONSE)                        15480000
154900     END-EXEC.                                                    15490000
155000                                                                  15500000
155100     EVALUATE TRUE                                                15510000
155200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15520000
155300             CONTINUE                                             15530000
155400         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                15540000
155500             CONTINUE                                             15550000
155600         WHEN OTHER                                               15560000
155700            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       15570000
155800            MOVE 'PCKRF855 - UNABLE TO RECEIVE MAP'               15580000
155900                                         TO DP013-MESSAGE-TEXT (1)15590000
156000            SET DP013-LOGIC-ABEND        TO TRUE                  15600000
156100            SET DP013-ROLLBACK           TO TRUE                  15610000
156200            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                15620000
156300     END-EVALUATE.                                                15630000
156400                                                                  15640000
156500 8100-RETURN-TRANID.                                              15650000
156600                                                                  15660000
156700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       15670000
156800     EXEC CICS                                                    15680000
156900         RETURN TRANSID  (PC-TRANID)                              15690000
157000                COMMAREA (CA-COMMAREA)                            15700000
157100                LENGTH   (PV-COMMAREA-LENGTH)                     15710000
157200                RESP     (PV-CICS-RESPONSE)                       15720000
157300     END-EXEC.                                                    15730000
157400                                                                  15740000
157500     EVALUATE TRUE                                                15750000
157600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15760000
157700             CONTINUE                                             15770000
157800         WHEN OTHER                                               15780000
157900             MOVE '8100-RETURN-TRANID'  TO DP013-PARAGRAPH        15790000
158000             MOVE 'PCKRF855 - UNABLE TO RETURN TO TRANID'         15800000
158100                 TO DP013-MESSAGE-TEXT (1)                        15810000
158200             SET DP013-CICS-ABEND       TO TRUE                   15820000
158300             SET DP013-ROLLBACK         TO TRUE                   15830000
158400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15840000
158500     END-EVALUATE.                                                15850000
158600                                                                  15860000
158700 8110-RETURN.                                                     15870000
158800                                                                  15880000
158900     EXEC CICS                                                    15890000
159000         SEND FROM (PV-MESSAGE-AREA)                              15900000
159100              LENGTH (19)                                         15910000
159200              ERASE                                               15920000
159300     END-EXEC.                                                    15930000
159400                                                                  15940000
159500     EXEC CICS                                                    15950000
159600         RETURN                                                   15960000
159700     END-EXEC.                                                    15970000
159800                                                                  15980000
159900 8200-XCTL.                                                       15990000
160000     SET PC033-INITIALIZE-SCREEN      TO TRUE.                    16000000
160100     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      16010000
160200     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       16020000
160300                                                                  16030000
160400     EXEC CICS                                                    16040000
160500         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16050000
160600               COMMAREA  (CA-COMMAREA)                            16060000
160700               LENGTH    (PV-COMMAREA-LENGTH)                     16070000
160800               RESP      (PV-CICS-RESPONSE)                       16080000
160900     END-EXEC.                                                    16090000
161000                                                                  16100000
161100     EVALUATE TRUE                                                16110000
161200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16120000
161300             CONTINUE                                             16130000
161400         WHEN OTHER                                               16140000
161500             MOVE '8200-XCTL'                                     16150000
161600                                      TO DP013-PARAGRAPH          16160000
161700             MOVE 'PCKRF855 - UNABLE TO XCTL TO PROGRAM: '        16170000
161800                                      TO DP013-MESSAGE-TEXT (1)   16180000
161900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16190000
162000             SET DP013-CICS-ABEND                                 16200000
162100                 DP013-ROLLBACK       TO TRUE                     16210000
162200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16220000
162300*            MOVE PC-TRANS-UNAVAILABLE-MSG                        16230000
162400*                                     TO AMSGLNO                  16240000
162500*            MOVE -1                  TO AFASTL                   16250000
162600             SET PC033-PROCESS-SCREEN TO TRUE                     16260000
162700             PERFORM 8000-SEND-MAP                                16270000
162800             PERFORM 8100-RETURN-TRANID                           16280000
162900     END-EVALUATE.                                                16290000
163000                                                                  16300000
163100 8210-XCTL-ERROR-SCREEN.                                          16310000
163200     IF NOT PC033-ABEND                                           16320000
163300         SET PC033-INITIALIZE-SCREEN  TO TRUE                     16330000
163400     END-IF                                                       16340000
163500     MOVE DFHEIBLK                    TO PC033-DFHEIBLK.          16350000
163600     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      16360000
163700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       16370000
163800     MOVE 'PCKRF852'                  TO PV-TRANSFER-PROGRAM      16380000
163900     IF PC033-PGM-MSG-NBR = ZERO                                  16390000
164000         MOVE 3                       TO PC033-PGM-MSG-NBR        16400000
164100     END-IF                                                       16410000
164200                                                                  16420000
164300     EXEC CICS                                                    16430000
164400         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16440000
164500               COMMAREA  (CA-COMMAREA)                            16450000
164600               LENGTH    (PV-COMMAREA-LENGTH)                     16460000
164700               RESP      (PV-CICS-RESPONSE)                       16470000
164800     END-EXEC.                                                    16480000
164900                                                                  16490000
165000     EVALUATE TRUE                                                16500000
165100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16510000
165200             CONTINUE                                             16520000
165300         WHEN OTHER                                               16530000
165400             MOVE '8200-XCTL'                                     16540000
165500                                      TO DP013-PARAGRAPH          16550000
165600             MOVE 'PCKRF855 - UNABLE TO XCTL TO PROGRAM: '        16560000
165700                                      TO DP013-MESSAGE-TEXT (1)   16570000
165800             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16580000
165900             SET DP013-CICS-ABEND                                 16590000
166000                 DP013-ROLLBACK       TO TRUE                     16600000
166100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16610000
166200*            MOVE PC-TRANS-UNAVAILABLE-MSG                        16620000
166300*                                     TO AMSGLNO                  16630000
166400             SET PC033-PROCESS-SCREEN TO TRUE                     16640000
166500             PERFORM 8000-SEND-MAP                                16650000
166600             PERFORM 8100-RETURN-TRANID                           16660000
166700     END-EVALUATE.                                                16670000
166800                                                                  16680000
166900*                                                                 16690000
167000 8220-XCTL-TO-HELP.                                               16700000
167100                                                                  16710000
167200     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       16720000
167300                                                                  16730000
167400     EXEC CICS                                                    16740000
167500         XCTL                                                     16750000
167600             PROGRAM   (PV-TRANSFER-PROGRAM)                      16760000
167700             COMMAREA  (PC192-COMMAREA)                           16770000
167800             LENGTH    (PV-COMMAREA-LENGTH)                       16780000
167900             RESP      (PV-CICS-RESPONSE)                         16790000
168000     END-EXEC.                                                    16800000
168100                                                                  16810000
168200     EVALUATE TRUE                                                16820000
168300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16830000
168400              CONTINUE                                            16840000
168500         WHEN OTHER                                               16850000
168600             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          16860000
168700             MOVE 'PCKRF855 - UNABLE TO XCTL TO PROGRAM: '        16870000
168800                                      TO DP013-MESSAGE-TEXT (1)   16880000
168900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   16890000
169000             SET DP013-CICS-ABEND                                 16900000
169100                 DP013-ROLLBACK       TO TRUE                     16910000
169200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16920000
169300             SET PC033-PROCESS-SCREEN TO TRUE                     16930000
169400             PERFORM 8000-SEND-MAP                                16940000
169500             PERFORM 8100-RETURN-TRANID                           16950000
169600     END-EVALUATE.                                                16960000
169700*                                                                 16970000
169800 8230-XCTL-TO-E855.                                               16980000
169900                                                                  16990000
170000     SET PC033-INITIALIZE-SCREEN      TO TRUE.                    17000000
170100     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      17010000
170200     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       17020000
170300     MOVE 'PCKRF855'                  TO PV-TRANSFER-PROGRAM      17030000
170400                                                                  17040000
170500     EXEC CICS                                                    17050000
170600         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    17060000
170700               COMMAREA  (CA-COMMAREA)                            17070000
170800               LENGTH    (PV-COMMAREA-LENGTH)                     17080000
170900               RESP      (PV-CICS-RESPONSE)                       17090000
171000     END-EXEC.                                                    17100000
171100                                                                  17110000
171200     EVALUATE TRUE                                                17120000
171300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17130000
171400             CONTINUE                                             17140000
171500         WHEN OTHER                                               17150000
171600             MOVE '8230-XCTL-TO-E855'                             17160000
171700                                      TO DP013-PARAGRAPH          17170000
171800             MOVE 'PCKRF855 - UNABLE TO XCTL TO PROGRAM: '        17180000
171900                                      TO DP013-MESSAGE-TEXT (1)   17190000
172000             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   17200000
172100             SET DP013-CICS-ABEND                                 17210000
172200                 DP013-ROLLBACK       TO TRUE                     17220000
172300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               17230000
172400             SET PC033-PROCESS-SCREEN TO TRUE                     17240000
172500             PERFORM 8000-SEND-MAP                                17250000
172600             PERFORM 8100-RETURN-TRANID                           17260000
172700     END-EVALUATE.                                                17270000
172800/                                                                 17280000
172900 9000-SOFT-ABORT.                                                 17290000
173000                                                                  17300000
173100     EXEC CICS                                                    17310000
173200         SYNCPOINT ROLLBACK                                       17320000
173300     END-EXEC                                                     17330000
173400                                                                  17340000
173500                                                                  17350000
173600     MOVE 4                           TO PC033-PGM-MSG-NBR        17360000
173700     MOVE SQLCODE                     TO PC033-SQLCODE            17370000
173800     PERFORM 8210-XCTL-ERROR-SCREEN.                              17380000
173900                                                                  17390000
174000 9903-WRITE-CICS-LOG.                                             17400000
174100                                                                  17410000
174200     MOVE SQLCODE                     TO PV-SQLCODE               17420000
174300     STRING PC033-FR-STR-NBR '-'                                  17430000
174400            PC033-XFER-SEQ-NBR '-'                                17440000
174500            PC037-FAST-CHECK-DIGIT DELIMITED BY SIZE              17450000
174600                                      INTO PV-DISPLAY-FAST        17460000
174700     MOVE PC033-PO-NBR                TO PV-DISPLAY-PO            17470000
174800     MOVE PC033-RCVR-SEQ-NBR          TO PV-DISPLAY-RCVR          17480000
174900     MOVE PC033-PO-LINE-NBR           TO PV-DISPLAY-PO-LNE-NBR    17490000
175000     MOVE PC033-STR-NBR               TO PV-DISPLAY-STORE         17500000
175100                                                                  17510000
175200     PERFORM 9905-WRITEQ.                                         17520000
175300                                                                  17530000
175400 9905-WRITEQ.                                                     17540000
175500     EXEC CICS                                                    17550000
175600         WRITEQ TD                                                17560000
175700             QUEUE  ('CSSL')                                      17570000
175800             FROM   (PV-LOG-MSG)                                  17580000
175900             RESP   (PV-CICS-RESPONSE)                            17590000
176000     END-EXEC.                                                    17600000
176100                                                                  17610000
176200 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  17620000
176300                                                                  17630000
176400     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           17640000
176500     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          17650000
176600     INITIALIZE DP013-SRC-TASK-NUMBER                             17660000
176700                DP013-STACK.                                      17670000
176800     SET DP013-LINK-RETURN            TO TRUE.                    17680000
176900                                                                  17690000
177000     EXEC CICS                                                    17700000
177100         LINK                                                     17710000
177200             PROGRAM   (DP013-NAME)                               17720000
177300             COMMAREA  (DP013-PARAMETERS)                         17730000
177400             LENGTH    (DP013-LENGTH)                             17740000
177500     END-EXEC.                                                    17750000
177600                                                                  17760000
177700*----------------------------------------------------------------*17770000
177800*    ABEND PROCESSOR MODULE                                      *17780000
177900*----------------------------------------------------------------*17790000
178000                                                                  17800000
178100     COPY DPPD014.                                                17810000
178200                                                                  17820000
