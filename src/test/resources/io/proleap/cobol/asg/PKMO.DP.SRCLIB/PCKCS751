000100*-----------------------*                                         00010068
000200 IDENTIFICATION DIVISION.                                         00020069
000300*-----------------------*                                         00030069
000400 PROGRAM-ID.    PCKCS751.                                         00040069
000500 AUTHOR.        DEANNA BRANTNER.                                  00050069
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060069
000700 DATE-WRITTEN.  NOVEMER, 2001.                                    00070069
000800 DATE-COMPILED.                                                   00080069
000900*---------------------------------------------------------------* 00090069
001000*    E751 - UNITS WORKED - UNITS BY PROCESS GROUP LIST SCREEN     00100069
001300*---------------------------------------------------------------* 00130002
001310* DATE  11/04/2021                                                00131072
001320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00132072
001330*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00133072
001340*              MAKING THE CALL DYNAMIC VS STATIC                * 00134072
001350*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00135073
001360*-----------------------------------------------------------------00136072
1122RM* DATE  11/07/2022                                              * 00137074
1122RM*            - ADD COPYBOOK DPWS930                             * 00138074
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00139074
1122RM*              DYNAMIC.                                         * 00139174
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00139274
1122RM*-----------------------------------------------------------------00139374
001400 ENVIRONMENT DIVISION.                                            00140002
001500 DATA DIVISION.                                                   00150002
001600                                                                  00160002
001700 WORKING-STORAGE SECTION.                                         00170002
001800 01  DK-DB2-KEYS.                                                 00180069
001900     05  DK-OPER-UNT-ID                PIC S9(04) COMP VALUE ZERO.00190069
002000     05  DK-OPER-DESC                  PIC X(05) VALUE SPACES.    00200069
002100     05  DK-PROCESS-GROUP              PIC X(06) VALUE SPACES.    00210069
002200     05  DK-FROM-DATE                  PIC X(10) VALUE SPACES.    00220069
002300     05  DK-FROM-DATE-X.                                          00230069
002400         10  DK-FROM-YY                PIC X(04) VALUE SPACES.    00240069
002500         10  FILLER                    PIC X(01) VALUE '-'.       00250069
002600         10  DK-FROM-MM                PIC X(02) VALUE SPACES.    00260069
002700         10  FILLER                    PIC X(01) VALUE '-'.       00270069
002800         10  DK-FROM-DD                PIC X(02) VALUE SPACES.    00280069
002900     05  DK-TO-DATE                    PIC X(10).                 00290069
003000     05  DK-TO-DATE-X.                                            00300069
003100         10  DK-TO-YY                  PIC X(04) VALUE SPACES.    00310069
003200         10  FILLER                    PIC X(01) VALUE '-'.       00320069
003300         10  DK-TO-MM                  PIC X(02) VALUE SPACES.    00330069
003400         10  FILLER                    PIC X(01) VALUE '-'.       00340069
003500         10  DK-TO-DD                  PIC X(02) VALUE SPACES.    00350069
003600     05  DK-FISCAL-WEEK.                                          00360069
003700         10  DK-FISCAL-YEAR            PIC X(04) VALUE SPACES.    00370069
003800         10  DK-FISCAL-WK              PIC X(02) VALUE SPACES.    00380069
003900     05  DK-FISCAL-MONTH.                                         00390069
004000         10  DK-FISCAL-YR              PIC X(04) VALUE SPACES.    00400069
004100         10  DK-FISCAL-MN              PIC X(02) VALUE SPACES.    00410069
004110     05  DK-NUMBER-FORMAT              PIC ZZZZZZ,ZZZ,ZZ9-.       00411069
004120     05  DK-PERCENT-FORMAT.                                       00412069
004130         10  DK-NUMBER                 PIC ZZ9.9 VALUE ZEROES.    00413069
004140         10  DK-PERCENT                PIC X(01) VALUE '%'.       00414069
004150                                                                  00415069
004160 01  PC-PROGRAM-CONSTANTS.                                        00416069
004170     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'PC751A  '.  00417069
004180     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'PCKM751'.   00418069
004190     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'PCKCS751'.  00419069
004200     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00420069
004300     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00430069
004400     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00440069
004500     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00450069
004600     05  PC-PROCESS-AREA-FORMAT    PIC  X(01)  VALUE '3'.         00460069
004700     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00470069
004800                                               COMP SYNC.         00480069
004900     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00490069
005000                                               COMP SYNC.         00500069
005100     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00510069
005200                                               COMP-3.            00520069
005300     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00530069
005400                                               COMP SYNC.         00540069
005500     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00550069
005600                                               COMP-3.            00560069
005700     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00570069
005800     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00580069
005900     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00590069
006000     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00600069
006100     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00610069
006200     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00620069
006300                                               COMP.              00630069
006400     05  PC-01                     PIC  X(02)  VALUE '01'.        00640069
006500     05  PC-1                      PIC  S9(4) COMP VALUE 1.       00650069
006600     05  PC-2                      PIC  S9(4) COMP VALUE 2.       00660069
006700     05  PC-3                      PIC  S9(4) COMP VALUE 3.       00670069
006800     05  PC-A                      PIC  X(01)  VALUE 'A'.         00680069
006900*                                                                 00690069
007000*----------------------------------------------------------------*00700069
007100*  SYSTEM MESSAGES                                               *00710069
007200*----------------------------------------------------------------*00720069
007300*   00005 = INVALID VALUE                                        *00730069
007400*   00008 = MUST BE NUMERIC                                      *00740069
007500*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00750069
007600*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00760069
007700*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00770069
007800*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00780069
007900*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00790069
008000*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00800069
008100*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00810069
008200*   00069 - TOP OF LIST                                          *00820069
008300*   00070 - BOTTOM OF LIST                                       *00830069
008400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00840069
008500*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00850069
008600*   00279 - MORE ITEMS TO DISPLAY                                *00860069
008700*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *00870069
008800*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00880069
008900*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00890069
009000*   02378 = YOU CANNOT USE A DATE RANGE FOR THIS SEARCH          *00900069
009100*   02873 = F-KEY NOT FUNCTIONAL-CAN ONLY VIEW PO LVL FOR SPFC DC*00910069
009200*   02874 = PO LEVEL DATA NOT AVAILABLE - DATA RETAINED ONLY THRO*00920069
009300*   99901 = INVALID COMMAND WAS ENTERED                          *00930069
009400*----------------------------------------------------------------*00940069
009500     05  PC-TSYMSG-NUMBERS.                                       00950069
009600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00960069
009700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00970069
009800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00980069
009900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00990069
010000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01000069
010100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01010069
010200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01020069
010300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01030069
010400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01040069
010500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01050069
010600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01060069
010700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01070069
010800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01080069
010900         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01090069
011000         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01100069
011100         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01110069
011200         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01120069
011300         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01130069
011400         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01140069
011500         10  PC-TSYMSG-02378            PIC  9(05)  VALUE 02378.  01150069
011600         10  PC-TSYMSG-02873            PIC  9(05)  VALUE 02873.  01160069
011700         10  PC-TSYMSG-02874            PIC  9(05)  VALUE 02874.  01170069
011800         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01180069
011900*                                                                 01190069
012000 01  PS-PROGRAM-SWITCHES.                                         01200069
012100     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01210069
012200         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01220069
012300         88  PS-BLOCK-ERROR                         VALUE 'N'.    01230069
012500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01250002
012600         88  PS-NO-ERROR                            VALUE 'Y'.    01260002
012700         88  PS-ERROR                               VALUE 'N'.    01270002
012800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01280002
012900         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01290002
013000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01300002
013100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01310002
013200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01320002
013300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01330002
013400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01340002
013500         88  PS-DONE                                VALUE 'Y'.    01350002
013600         88  PS-NOT-DONE                            VALUE 'N'.    01360002
013700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01370002
013800         88  PS-LIST-END                            VALUE  'Y'.   01380069
013900         88  PS-NO-LIST-END                         VALUE  'N'.   01390069
014000     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01400002
014100         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01410002
014200         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01420002
014210     05  PS-CURSOR-SW                   PIC  X(01)  VALUE  ' '.   01421012
014220         88  PS-PROCESS-GROUP-CSR                   VALUE  'A'.   01422012
014230         88  PS-UK-OPER-GROUP-CSR                   VALUE  'B'.   01423044
014240     05  PS-CURSOR-SW2                  PIC  X(01)  VALUE  ' '.   01424012
014250         88  PS-UNITS-BY-OPER-CSR                   VALUE  'C'.   01425044
014251         88  PS-UNT-BY-OPR-MSC-CSR                  VALUE  'D'.   01425145
014260         88  PS-UNITS-BY-GROUP-CSR                  VALUE  'E'.   01426045
014261         88  PS-UNT-BY-GRP-MSC-CSR                  VALUE  'F'.   01426145
014270     05  PS-VALID-POHIST-DATE-SW        PIC  X(01)  VALUE  ' '.   01427029
014280         88  PS-VALID-POHIST-DATE                   VALUE  'Y'.   01428029
014290         88  PS-INVALID-POHIST-DATE                 VALUE  'N'.   01429029
014300*                                                                 01430002
014400 01  PV-PROGRAM-VARIABLES.                                        01440002
014500     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01450002
014600                                                     COMP SYNC.   01460002
014700     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01470002
014800     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01480002
014900     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01490002
015000     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01500002
015100                                        COMP SYNC.                01510002
015200     05  PV-SUB                         PIC S9(04)  VALUE +0      01520002
015300                                                    COMP SYNC.    01530002
015400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01540002
015500                                                    COMP SYNC.    01550002
015600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01560002
015700                                                    COMP-3.       01570002
015800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01580002
015900                                                    COMP-3.       01590002
016000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01600002
016100                                                    COMP-3.       01610002
016200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01620002
016300                                                    COMP-3.       01630002
016400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01640002
016500                                                    COMP-3.       01650002
016600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01660002
016700                                                    COMP-3.       01670002
016800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01680002
016900                                                    COMP-3.       01690002
017000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01700002
017100                                                    COMP SYNC.    01710002
017200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01720002
017300                                                    COMP SYNC.    01730002
017400     05  PV-ITEM                        PIC S9(04)  VALUE +0      01740002
017500                                                    COMP SYNC.    01750002
017600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01760002
017700                                                    COMP SYNC.    01770002
017800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01780002
017900                                                    COMP SYNC.    01790002
018000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01800002
018100                                                    COMP SYNC.    01810002
018200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01820002
018300                                                    COMP SYNC.    01830002
018400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01840002
018500                                                    COMP SYNC.    01850002
018600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01860002
018700                                                    COMP SYNC.    01870002
018800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01880002
018900                                                    COMP SYNC.    01890002
019000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01900002
019100                                                    COMP SYNC.    01910002
019200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01920002
019300                                                    COMP SYNC.    01930002
019400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01940002
019500                                                    COMP SYNC.    01950002
019600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01960002
019700                                                    COMP SYNC.    01970002
019800     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01980002
019900                                                    COMP SYNC.    01990002
020000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02000002
020100                                                    COMP SYNC.    02010002
020200     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02020002
020300                                                    COMP.         02030002
020400     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02040002
020500                                                    COMP.         02050002
020600     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02060002
020700                                                    COMP.         02070002
020800     05  PV-SOFT-ABORT-MSG.                                       02080002
020900         10  FILLER            PIC X(12) VALUE ' PCKCS751 - '.    02090002
021000         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02100002
021100         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02110002
021200         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02120002
021300         10  PV-SOFT-PARAGRAPH PIC X(30).                         02130002
021400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02140002
021500                                                     COMP SYNC.   02150002
021600     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02160002
021700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02170002
021800     05  PV-CICS-MSG-HOLD.                                        02180002
021900         10  FILLER                      PIC  X(01)  VALUE SPACE. 02190002
022000         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02200002
022100     05  PV-CICS-MSG-HOLD2.                                       02210002
022200         10  FILLER                      PIC  X(01)  VALUE SPACE. 02220002
022300         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02230002
022400                                                                  02240002
022410     05  PV-POHIST-DATE          PIC X(10)   VALUE SPACES.        02241029
022420     05  PV-COMPARE-DATE.                                         02242029
022430         10   PV-CMPR-YY                PIC  X(04).               02243029
022440         10   FILLER                    PIC  X(01) VALUE '-'.     02244029
022450         10   PV-CMPR-MM                PIC  X(02).               02245029
022460         10   FILLER                    PIC  X(01) VALUE '-'.     02246029
022470         10   PV-CMPR-DD                PIC  X(02).               02247029
022500     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02250002
022600     05  PV-TMST-R REDEFINES  PV-TMST.                            02260002
022700         10   PV-TMST-CCYY              PIC X(04).                02270002
022800         10   FILLER                    PIC X(01).                02280002
022900         10   PV-TMST-MM                PIC X(02).                02290002
023000         10   FILLER                    PIC X(01).                02300002
023100         10   PV-TMST-DD                PIC X(02).                02310002
023200         10   FILLER                    PIC X(01).                02320002
023300         10   PV-TMST-HRS               PIC X(02).                02330002
023400         10   FILLER                    PIC X(01).                02340002
023500         10   PV-TMST-MIN               PIC X(02).                02350002
023600         10   FILLER                    PIC X(01).                02360002
023700         10   PV-TMST-SEC               PIC X(02).                02370002
023800         10   FILLER                    PIC X(07).                02380002
023900     05  PV-DISPLAY-DATE                PIC  X(45) VALUE SPACES.  02390002
024000     05  PV-SELECT-LIST-SEQ             PIC  X(01) VALUE SPACES.  02400002
024100     05  PV-NBR-ITEMS                   PIC  9(05) VALUE ZEROES.  02410002
024200     05  PV-SEL-TERM-ID                 PIC  X(04).               02420002
024300     05  PV-SEL-TASK-NUMBER             PIC  9(05).               02430002
024400     05  PV-SEL-SEQ                     PIC  9(01).               02440002
024500     05  PV-TOT-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02450002
024600     05  PV-3RD-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02460002
024700     05  PV-1ST-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02470002
024800     05  PV-2ND-UNITS              PIC S9(11) COMP-3 VALUE ZEROS. 02480002
024900     05  PV-3RD-PCT                     PIC S9(05)V9 VALUE ZEROS. 02490062
025000     05  PV-1ST-PCT                     PIC S9(05)V9 VALUE ZEROS. 02500062
025100     05  PV-2ND-PCT                     PIC S9(05)V9 VALUE ZEROS. 02510062
025200     05  PV-TOT-PCT                     PIC S9(05)V9 VALUE ZEROS. 02520062
025300     05  PV-DIVIDEND                    PIC S9(03)V9999.          02530032
025400                                                                  02540002
025500******************************************************************02550002
025600**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02560002
025700**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02570002
025800**  APPLICATION-SPECIFIC COMMAREA.                              **02580002
025900******************************************************************02590002
026000 01  LQW-LIST-QUEUE-WORK-AREA.                                    02600002
026100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02610002
026200     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           02620002
026300                                        INDEXED BY LQW-IDX.       02630002
026400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02640002
026500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02650002
026600         10  LQW-SELECTED-SW            PIC  X(01).               02660002
026700             88  LQW-SELECT                         VALUE 'S'.    02670002
026800             88  LQW-DESELECT                       VALUE ' '.    02680002
026900         10  LQW-ACTION                 PIC  X(03).               02690002
027000             88  LQW-DEL                            VALUE 'DEL'.  02700002
027100             88  LQW-INQ                            VALUE 'INQ'.  02710002
027200             88  LQW-UPD                            VALUE 'UPD'.  02720002
027300             88  LQW-ERR                            VALUE 'ERR'.  02730002
027400         10  LQW-GROUP                  PIC  X(06).               02740002
027500         10  LQW-3RD-UNITS              PIC  9(10) VALUE ZEROS.   02750002
027600         10  LQW-3RD-PCT                PIC  999.9 VALUE ZEROS.   02760002
027700         10  LQW-1ST-UNITS              PIC  9(10) VALUE ZEROS.   02770002
027800         10  LQW-1ST-PCT                PIC  999.9 VALUE ZEROS.   02780002
027900         10  LQW-2ND-UNITS              PIC  9(10) VALUE ZEROS.   02790002
028000         10  LQW-2ND-PCT                PIC  999.9 VALUE ZEROS.   02800002
028100         10  LQW-TOT-UNITS              PIC  9(11) VALUE ZEROS.   02810010
028200         10  LQW-TOT-PCT                PIC  999.9 VALUE ZEROS.   02820002
028300                                                                  02830002
028400*---------------------------------------------------------------* 02840002
028500* SELECTON QUEUE LAYOUT                                         * 02850002
028600*---------------------------------------------------------------* 02860002
028700     COPY PCWS215.                                                02870002
028800                                                                  02880002
028900*---------------------------------------------------------------* 02890002
029000*    MAP LAYOUT                                                 * 02900002
029100*---------------------------------------------------------------* 02910002
029200     COPY PCKM751.                                                02920002
029300*                                                                 02930002
029400 01  MR-OCCURS-LAYOUT                   REDEFINES  PC751AO.       02940002
029500     05  FILLER                         PIC X(244).               02950065
029600     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          02960002
029700         10  MR-SELECTL                 PIC S9(04) COMP.          02970002
029800         10  MR-SELECTA                 PIC  X(01).               02980002
029900         10  MR-SELECTC                 PIC  X(01).               02990002
030000         10  MR-SELECTH                 PIC  X(01).               03000002
030100         10  MR-SELECTI                 PIC  X(01).               03010002
030200                                                                  03020002
030300*        10  MR-ACTIONL                 PIC S9(04) COMP.          03030002
030400*        10  MR-ACTIONA                 PIC  X(01).               03040002
030500*        10  MR-ACTIONC                 PIC  X(01).               03050002
030600*        10  MR-ACTIONH                 PIC  X(01).               03060002
030700*        10  MR-ACTION                  PIC  X(03).               03070002
030800                                                                  03080002
030900         10  MR-GROUPL                  PIC S9(04) COMP.          03090002
031000         10  MR-GROUPA                  PIC  X(01).               03100002
031100         10  MR-GROUPC                  PIC  X(01).               03110002
031200         10  MR-GROUPH                  PIC  X(01).               03120002
031300         10  MR-GROUP                   PIC  X(06).               03130002
031400                                                                  03140002
031500         10  MR-3RD-UNITSL              PIC S9(04) COMP.          03150002
031600         10  MR-3RD-UNITSA              PIC  X(01).               03160002
031700         10  MR-3RD-UNITSC              PIC  X(01).               03170002
031800         10  MR-3RD-UNITSH              PIC  X(01).               03180002
031900         10  MR-3RD-UNITS               PIC  X(10).               03190002
032000         10  MR-3RD-UNIT-X REDEFINES MR-3RD-UNITS.                03200002
032100             15  MR-3RD-UNITS-N            PIC ZZ,ZZZ,ZZ9.        03210002
032110         10  MR-3RD-UNIT-Y REDEFINES MR-3RD-UNITS.                03211056
032120             15  MR-3RD-UNITS-O            PIC ZZZZZZ,ZZ9.        03212056
032130         10  MR-3RD-UNIT-Z REDEFINES MR-3RD-UNITS.                03213068
032140             15  MR-3RD-UNITS-P            PIC ZZZZZZZZ9-.        03214068
032200                                                                  03220002
032300         10  MR-3RD-PCTL                PIC S9(04) COMP.          03230002
032400         10  MR-3RD-PCTA                PIC  X(01).               03240002
032500         10  MR-3RD-PCTC                PIC  X(01).               03250002
032600         10  MR-3RD-PCTH                PIC  X(01).               03260002
032700         10  MR-3RD-PCT                 PIC  X(05).               03270002
032800         10  MR-3RD-PCT-X REDEFINES MR-3RD-PCT.                   03280002
032900             15  MR-3RD-PCT-N              PIC  ZZ9.9.            03290002
033000                                                                  03300002
033100         10  MR-1ST-UNITSL              PIC S9(04) COMP.          03310002
033200         10  MR-1ST-UNITSA              PIC  X(01).               03320002
033300         10  MR-1ST-UNITSC              PIC  X(01).               03330002
033400         10  MR-1ST-UNITSH              PIC  X(01).               03340002
033500         10  MR-1ST-UNITS               PIC  X(10).               03350002
033600         10  MR-1ST-UNIT-X REDEFINES MR-1ST-UNITS.                03360002
033700             15  MR-1ST-UNITS-N            PIC ZZ,ZZZ,ZZ9.        03370002
033710         10  MR-1ST-UNIT-Y REDEFINES MR-1ST-UNITS.                03371056
033720             15  MR-1ST-UNITS-O            PIC ZZZZZZ,ZZ9.        03372056
033730         10  MR-1ST-UNIT-Z REDEFINES MR-1ST-UNITS.                03373068
033740             15  MR-1ST-UNITS-P            PIC ZZZZZZZZ9-.        03374068
033800                                                                  03380002
033900         10  MR-1ST-PCTL                PIC S9(04) COMP.          03390002
034000         10  MR-1ST-PCTA                PIC  X(01).               03400002
034100         10  MR-1ST-PCTC                PIC  X(01).               03410002
034200         10  MR-1ST-PCTH                PIC  X(01).               03420002
034300         10  MR-1ST-PCT                 PIC  X(05).               03430002
034400         10  MR-1ST-PCT-X REDEFINES MR-1ST-PCT.                   03440002
034500             15  MR-1ST-PCT-N              PIC  ZZ9.9.            03450002
034600                                                                  03460002
034700         10  MR-2ND-UNITSL              PIC S9(04) COMP.          03470002
034800         10  MR-2ND-UNITSA              PIC  X(01).               03480002
034900         10  MR-2ND-UNITSC              PIC  X(01).               03490002
035000         10  MR-2ND-UNITSH              PIC  X(01).               03500002
035100         10  MR-2ND-UNITS               PIC  X(10).               03510002
035200         10  MR-2ND-UNIT-X REDEFINES MR-2ND-UNITS.                03520002
035300             15  MR-2ND-UNITS-N            PIC ZZ,ZZZ,ZZ9.        03530002
035310         10  MR-2ND-UNIT-Y REDEFINES MR-2ND-UNITS.                03531056
035320             15  MR-2ND-UNITS-O            PIC ZZZZZZ,ZZ9.        03532056
035330         10  MR-2ND-UNIT-Z REDEFINES MR-2ND-UNITS.                03533068
035340             15  MR-2ND-UNITS-P            PIC ZZZZZZZZ9-.        03534068
035400                                                                  03540002
035500         10  MR-2ND-PCTL                PIC S9(04) COMP.          03550002
035600         10  MR-2ND-PCTA                PIC  X(01).               03560002
035700         10  MR-2ND-PCTC                PIC  X(01).               03570002
035800         10  MR-2ND-PCTH                PIC  X(01).               03580002
035900         10  MR-2ND-PCT                 PIC  X(05).               03590002
036000         10  MR-2ND-PCT-X REDEFINES MR-2ND-PCT.                   03600002
036100             15  MR-2ND-PCT-N              PIC  ZZ9.9.            03610002
036200                                                                  03620002
036300         10  MR-TOT-UNITSL              PIC S9(04) COMP.          03630002
036400         10  MR-TOT-UNITSA              PIC  X(01).               03640002
036500         10  MR-TOT-UNITSC              PIC  X(01).               03650002
036600         10  MR-TOT-UNITSH              PIC  X(01).               03660002
036700         10  MR-TOT-UNITS               PIC  X(11).               03670010
036800         10  MR-TOT-UNIT-X REDEFINES MR-TOT-UNITS.                03680002
036900             15  MR-TOT-UNITS-N            PIC ZZZ,ZZZ,ZZ9.       03690010
036910         10  MR-TOT-UNIT-Y REDEFINES MR-TOT-UNITS.                03691057
036920             15  MR-TOT-UNITS-O            PIC ZZZZZZZ,ZZ9.       03692057
036930         10  MR-TOT-UNIT-Z REDEFINES MR-TOT-UNITS.                03693068
036940             15  MR-TOT-UNITS-P            PIC ZZZZZZZZZ9-.       03694068
037000                                                                  03700002
037100         10  MR-TOT-PCTL                PIC S9(04) COMP.          03710002
037200         10  MR-TOT-PCTA                PIC  X(01).               03720002
037300         10  MR-TOT-PCTC                PIC  X(01).               03730002
037400         10  MR-TOT-PCTH                PIC  X(01).               03740002
037500         10  MR-TOT-PCT                 PIC  X(05).               03750002
037600         10  MR-TOT-PCT-X REDEFINES MR-TOT-PCT.                   03760002
037700             15  MR-TOT-PCT-N              PIC  ZZ9.9.            03770002
037800                                                                  03780002
037900*---------------------------------------------------------------* 03790002
038000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03800002
038100*---------------------------------------------------------------* 03810002
038200     COPY DPWS015.                                                03820002
038300                                                                  03830002
038400*---------------------------------------------------------------* 03840002
038500*    FUNCTION KEYS COPYBOOK.                                    * 03850002
038600*---------------------------------------------------------------* 03860002
038700     COPY DPWS016.                                                03870002
038800                                                                  03880002
038900*---------------------------------------------------------------* 03890002
039000*    NUMERIC EDIT LAYOUT.                                       * 03900002
039100*---------------------------------------------------------------* 03910002
039200     COPY DPWS010I.                                               03920002
039300                                                                  03930002
039400*---------------------------------------------------------------* 03940002
039500*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 03950002
039600*---------------------------------------------------------------* 03960002
039700     COPY DPWS030.                                                03970002
1122RM     COPY DPWS930.                                                03971074
039800                                                                  03980002
039900*---------------------------------------------------------------* 03990002
040000*    STANDARD COMMAREA.                                         * 04000002
040100*---------------------------------------------------------------* 04010002
040200     COPY DPWS020.                                                04020002
040300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04030002
040400                                                                  04040002
040500*---------------------------------------------------------------* 04050002
040600* INTER-APPLICATION COMMAREA.                                   * 04060002
040700*   PCWS213 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04070002
040800*             SPEC SCREEN.                                      * 04080002
040900*   PCWS214 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04090002
041000*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04100002
041100*---------------------------------------------------------------* 04110002
041200                                                                  04120002
041300         10  INTER-APPL-COMM-AREA       PIC X(200).               04130002
041400     COPY PCWS213.                                                04140002
041500     COPY PCWS214.                                                04150002
041600*---------------------------------------------------------------* 04160002
041700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04170002
041800*---------------------------------------------------------------* 04180002
041900         10  ASC-SPECIFIC-COMMAREA.                               04190002
042000             15  ASC-OPER-NBR-X              PIC  X(04).          04200002
042100             15  ASC-OPER-NBR-N REDEFINES ASC-OPER-NBR-X.         04210002
042200                 20  ASC-OPER-NBR            PIC  9(04).          04220002
042300             15  ASC-OPER-DESC               PIC  X(25).          04230002
042400             15  ASC-DISPLAY-DATE            PIC  X(45).          04240002
042500             15  ASC-BUSN-DATE.                                   04250002
042600                 20  ASC-BUSN-YY             PIC  X(04).          04260002
042700                 20  ASC-BUSN-MM             PIC  X(02).          04270002
042800                 20  ASC-BUSN-DD             PIC  X(02).          04280002
042900             15  ASC-FROM-DATE.                                   04290002
043000                 20  ASC-FROM-MN             PIC  X(02).          04300002
043100                 20  ASC-FROM-DY             PIC  X(02).          04310002
043200                 20  ASC-FROM-YR             PIC  X(04).          04320002
043300             15  ASC-TO-DATE.                                     04330002
043400                 20  ASC-TO-MN               PIC  X(02).          04340002
043500                 20  ASC-TO-DY               PIC  X(02).          04350002
043600                 20  ASC-TO-YR               PIC  X(04).          04360002
043700             15  ASC-FISCAL-WEEK             PIC  X(06).          04370002
043800             15  ASC-FISCAL-MONTH            PIC  X(06).          04380002
043900             15  ASC-PRINTER-ID              PIC  X(08).          04390002
044000             15  ASC-PROCESS-GROUP           PIC  X(06).          04400002
044100             15  ASC-PROCESS-AREA            PIC  X(06).          04410002
044200             15  ASC-TOT-UNITS               PIC S9(15).          04420059
044300             15  ASC-3RD-UNITS               PIC S9(15).          04430059
044400             15  ASC-1ST-UNITS               PIC S9(15).          04440059
044500             15  ASC-2ND-UNITS               PIC S9(15).          04450059
044600             15  ASC-3RD-PCT                 PIC S9(05)V9.        04460059
044700             15  ASC-1ST-PCT                 PIC S9(05)V9.        04470059
044800             15  ASC-2ND-PCT                 PIC S9(05)V9.        04480059
044900             15  ASC-TOT-PCT                 PIC S9(05)V9.        04490059
045000             15  FILLER                      PIC  X(025).         04500002
045100*-----------------------------------------------------------------04510002
045200             15  ASC-BLK-SUB                  PIC S9(04) COMP     04520002
045300                                                         SYNC.    04530002
045400             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04540002
045500                                                         SYNC.    04550002
045600             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04560002
045700             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04570002
045800             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04580002
045900             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04590002
046000             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04600002
046100             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04610002
046200                                                         SYNC.    04620002
046300             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04630002
046400             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04640002
046500             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04650002
046600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04660002
046700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04670002
046800             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04680002
046900                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04690002
047000                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04700002
047100             15  ASC-LIST-QUEUE-NAME.                             04710002
047200                 20  ASC-LIST-TERM-ID         PIC  X(04).         04720002
047300                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04730002
047400                 20  ASC-LIST-SEQ             PIC  9(01).         04740002
047500                                                                  04750002
047600             15  ASC-START-ITEM-REQUEST.                          04760002
047700                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04770002
047800                                                                  04780002
047900             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04790002
048000             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04800002
048100             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04810002
048200                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04820002
048300             15  ASC-SEL-QUEUE-NAME.                              04830002
048400                 20  ASC-SEL-TERM-ID          PIC  X(04).         04840002
048500                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04850002
048600                 20  ASC-SEL-SEQ              PIC  9(01).         04860002
048700             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04870002
048800                                                                  04880002
048900*-----------------------------------------------------------------04890002
049000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04900002
049100                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04910002
049200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04920002
049300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04930002
049400                                                                  04940002
049500                 20  ASC-ITEM-ARRAY.                              04950002
049600                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        04960002
049700                         30  ASC-LIST-ITEM-NUMBER                 04970002
049800                                                     PIC S9(09)   04980002
049900                                                     COMP-3.      04990002
050000                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05000002
050100                             88  ASC-VALID-SELECT    VALUE ' '    05010002
050200                                                           'S'    05020002
050300                                                           'B'    05030002
050400                                                           'E'.   05040002
050500                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05050002
050600                             88  ASC-TEMP-SELECT     VALUE 'S'.   05060002
050700                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05070002
050800                             88  ASC-TEMP-END        VALUE 'E'.   05080002
050900                         30  ASC-SELECTED-SW         PIC  X(01).  05090002
051000                             88  ASC-NO-SELECT       VALUE ' '.   05100002
051100                             88  ASC-SELECT          VALUE 'S'.   05110002
051200                             88  ASC-BEGIN           VALUE 'B'.   05120002
051300                             88  ASC-END             VALUE 'E'.   05130002
051400                         30  ASC-ACTION             PIC  X(03).   05140002
051500                         30  ASC-GROUP              PIC  X(06).   05150002
051600                         30  ASC-3RDUNITS           PIC S9(10).   05160068
051700                         30  ASC-3RDPCT             PIC  999.9.   05170067
051800                         30  ASC-1STUNITS           PIC S9(10).   05180068
051900                         30  ASC-1STPCT             PIC  999.9.   05190067
052000                         30  ASC-2NDUNITS           PIC S9(10).   05200068
052100                         30  ASC-2NDPCT             PIC  999.9.   05210067
052200                         30  ASC-TOTUNITS           PIC S9(11).   05220068
052300                         30  ASC-TOTPCT             PIC  999.9.   05230067
052400                                                                  05240002
052500*---------------------------------------------------------------* 05250002
052600*    ABEND PROCESSING COPYBOOK.                                 * 05260002
052700*---------------------------------------------------------------* 05270002
052800     COPY DPWS013.                                                05280002
052900                                                                  05290002
053000*---------------------------------------------------------------* 05300002
053100*    PCT_PRC_AREA_ASSN - PROCESS AREA ASSOCIATION TABLE           05310002
053200*---------------------------------------------------------------* 05320002
053300     EXEC SQL                                                     05330002
053400          INCLUDE PCT00003                                        05340002
053500     END-EXEC.                                                    05350002
053600                                                                  05360002
053700*---------------------------------------------------------------* 05370002
053800*    PCT_SUM_WRKD - SUMMARY OF UNITS WORKED                       05380002
053900*---------------------------------------------------------------* 05390002
054000     EXEC SQL                                                     05400002
054100          INCLUDE PCT00005                                        05410002
054200     END-EXEC.                                                    05420002
054300                                                                  05430002
054400*---------------------------------------------------------------* 05440002
054500*    TDTATTR - DATE TABLE                                         05450002
054600*---------------------------------------------------------------* 05460002
054700     EXEC SQL                                                     05470002
054800          INCLUDE TDTATTR                                         05480002
054900     END-EXEC.                                                    05490002
055000                                                                  05500002
055100*---------------------------------------------------------------* 05510002
055200*    XLT_LOC - LOCATION TABLE                                     05520069
055300*---------------------------------------------------------------* 05530002
055400     EXEC SQL                                                     05540002
055500          INCLUDE XLT00010                                        05550069
055600     END-EXEC.                                                    05560002
055700                                                                  05570002
055710*-----------------------------------------------------------------05571029
055720*  PARM TABLE                                                     05572029
055730*-----------------------------------------------------------------05573029
055740     EXEC SQL                                                     05574029
055750          INCLUDE TKRPRPM                                         05575029
055760     END-EXEC.                                                    05576029
055770                                                                  05577029
055800*---------------------------------------------------------------* 05580002
055900*    PROCESS GROUP CURSOR                                         05590002
056000*---------------------------------------------------------------* 05600002
056100     EXEC SQL                                                     05610002
056200          DECLARE PROCESS-GROUP-CSR CURSOR FOR                    05620002
056300              SELECT  DISTINCT(PRC_AREA_GP_CDE)                   05630006
056400                FROM  PCT_PRC_AREA_ASSN                           05640002
056500               WHERE  OPER_UNT_ID   =  :DK-OPER-UNT-ID            05650002
056510          UNION                                                   05651044
056520              SELECT  'MISC  '                                    05652044
056530                FROM  PCT_PRC_AREA_ASSN                           05653044
056540               WHERE  OPER_UNT_ID   =  :DK-OPER-UNT-ID            05654044
056600     END-EXEC.                                                    05660002
056700                                                                  05670002
056710*---------------------------------------------------------------* 05671012
056720*    UNKNOWN OPER UNIT PROCESS GROUP CURSOR                       05672012
056730*---------------------------------------------------------------* 05673012
056740     EXEC SQL                                                     05674012
056750          DECLARE UK-OPER-GROUP-CSR CURSOR FOR                    05675012
056760              SELECT  DISTINCT(PRC_AREA_GP_CDE)                   05676012
056770                FROM  PCT_PRC_AREA_ASSN                           05677012
056772          UNION                                                   05677244
056773              SELECT  'MISC  '                                    05677344
056774                FROM  PCT_PRC_AREA_ASSN                           05677444
056780     END-EXEC.                                                    05678012
056790                                                                  05679012
056800*---------------------------------------------------------------* 05680002
056900*    UNITS BY OPER CURSOR                                         05690002
057000*---------------------------------------------------------------* 05700002
057100     EXEC SQL                                                     05710002
057200          DECLARE UNITS-BY-OPER-CSR CURSOR FOR                    05720002
057300              SELECT  SUM(A.UNT_WRKD_QTY)                         05730004
057400                     ,A.SHFT_NBR                                  05740004
057500                     ,B.PRC_AREA_GP_CDE                           05750004
057600                FROM  PCT_SUM_WRKD A                              05760004
057610                     ,PCT_PRC_AREA_ASSN B                         05761004
057700               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          05770004
057800                 AND  A.BUS_DTE        <=  :DK-TO-DATE            05780004
057900                 AND  A.OPER_UNT_ID     =  :DK-OPER-UNT-ID        05790004
058000                 AND  A.PRCG_AREA_CDE   =  B.PRCG_AREA_CDE        05800004
058001                 AND  A.OPER_UNT_ID     =  B.OPER_UNT_ID          05800107
058010                 AND  B.PRC_AREA_GP_CDE =  :DK-PROCESS-GROUP      05801005
058100                 GROUP BY SHFT_NBR, PRC_AREA_GP_CDE               05810004
058200     END-EXEC.                                                    05820002
058300                                                                  05830002
058301*---------------------------------------------------------------* 05830144
058302*    UNITS BY OPER CURSOR AND PROCESS GROUP = 'MISC  '            05830244
058303*---------------------------------------------------------------* 05830344
058304     EXEC SQL                                                     05830444
058305          DECLARE UNT-BY-OPR-MSC-CSR CURSOR FOR                   05830545
058306              SELECT  SUM(A.UNT_WRKD_QTY)                         05830644
058307                     ,A.SHFT_NBR                                  05830744
058308                     ,'MISC  '                                    05830844
058309                FROM  PCT_SUM_WRKD A                              05830944
058311               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          05831144
058312                 AND  A.BUS_DTE        <=  :DK-TO-DATE            05831244
058313                 AND  A.OPER_UNT_ID     =  :DK-OPER-UNT-ID        05831344
058314                 AND NOT EXISTS                                   05831444
058315                      (SELECT *                                   05831544
058316                FROM  PCT_PRC_AREA_ASSN B                         05831644
058317               WHERE  B.PRCG_AREA_CDE   =  A.PRCG_AREA_CDE        05831744
058318                 AND  B.OPER_UNT_ID     =  A.OPER_UNT_ID)         05831844
058320                 GROUP BY SHFT_NBR                                05832044
058321     END-EXEC.                                                    05832144
058322                                                                  05832244
058323*---------------------------------------------------------------* 05832344
058324*    UNITS BY GROUP CURSOR                                        05832444
058330*---------------------------------------------------------------* 05833012
058340     EXEC SQL                                                     05834012
058350          DECLARE UNITS-BY-GROUP-CSR CURSOR FOR                   05835012
058360              SELECT  SUM(A.UNT_WRKD_QTY)                         05836012
058370                     ,A.SHFT_NBR                                  05837012
058380                     ,B.PRC_AREA_GP_CDE                           05838012
058390                FROM  PCT_SUM_WRKD A                              05839012
058391                     ,PCT_PRC_AREA_ASSN B                         05839112
058392               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          05839212
058393                 AND  A.BUS_DTE        <=  :DK-TO-DATE            05839312
058395                 AND  A.PRCG_AREA_CDE   =  B.PRCG_AREA_CDE        05839512
058396                 AND  A.OPER_UNT_ID     =  B.OPER_UNT_ID          05839612
058397                 AND  B.PRC_AREA_GP_CDE =  :DK-PROCESS-GROUP      05839712
058398                 GROUP BY SHFT_NBR, PRC_AREA_GP_CDE               05839812
058399     END-EXEC.                                                    05839912
058400                                                                  05840012
058401*---------------------------------------------------------------* 05840144
058402*    UNITS BY PROCESS GROUP WHEN IT = 'MISC  '                    05840244
058403*---------------------------------------------------------------* 05840344
058404     EXEC SQL                                                     05840444
058405          DECLARE UNT-BY-GRP-MSC-CSR CURSOR FOR                   05840545
058406              SELECT  SUM(A.UNT_WRKD_QTY)                         05840644
058407                     ,A.SHFT_NBR                                  05840744
058408                     ,'MISC  '                                    05840844
058409                FROM  PCT_SUM_WRKD A                              05840944
058410               WHERE  A.BUS_DTE        >=  :DK-FROM-DATE          05841044
058411                 AND  A.BUS_DTE        <=  :DK-TO-DATE            05841144
058413                 AND NOT EXISTS                                   05841344
058414                      (SELECT *                                   05841444
058415                FROM  PCT_PRC_AREA_ASSN B                         05841544
058416               WHERE  B.PRCG_AREA_CDE   =  A.PRCG_AREA_CDE        05841644
058417                 AND  B.OPER_UNT_ID     =  A.OPER_UNT_ID)         05841744
058418                 GROUP BY SHFT_NBR                                05841844
058419     END-EXEC.                                                    05841944
058420                                                                  05842044
058430*---------------------------------------------------------------* 05843012
058500*    DB2 AREA FOR COMMUNICATIONS                                * 05850002
058600*---------------------------------------------------------------* 05860002
058700     EXEC SQL                                                     05870002
058800          INCLUDE SQLCA                                           05880002
058900     END-EXEC.                                                    05890002
059000                                                                  05900002
059100*-----------------------------------------------------------------05910002
059200 LINKAGE SECTION.                                                 05920002
059300                                                                  05930002
059400 01  DFHCOMMAREA.                                                 05940002
059500     05  FILLER                         OCCURS  1 TO 4072 TIMES   05950002
059600                                        DEPENDING ON EIBCALEN.    05960002
059700         10  FILLER                     PIC X.                    05970002
059800                                                                  05980002
059900                                                                  05990002
060000 PROCEDURE DIVISION.                                              06000002
060100******************************************************************06010002
060200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06020002
060300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06030002
060400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06040002
060500******************************************************************06050002
060600 0000-MAIN-MODULE.                                                06060002
060700     INITIALIZE DP030-CICS-API-FIELDS.                            06070002
060800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06080002
060900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06090002
061000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06100002
061100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06110002
061200     MOVE LENGTH OF PC751AI        TO DP030-MAP-LENGTH (1).       06120002
061300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06130002
061400     PERFORM 0001-CALL-CICS-ARCH-API.                             06140002
061500*                                                                 06150002
061600     PERFORM 1000-CONTROL-PROCESSING                              06160002
061700*                                                                 06170002
061800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06180002
061900     PERFORM 0001-CALL-CICS-ARCH-API.                             06190002
062000                                                                  06200002
062100******************************************************************06210002
062200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **06220002
062300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **06230002
062400******************************************************************06240002
062500 0001-CALL-CICS-ARCH-API.                                         06250002
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               06260074
1122RM     CALL DP930-CICS-ARCH-API                                     06261074
1122RM                     USING DFHEIBLK                               06262074
062700                           DFHCOMMAREA                            06270002
062800                           DP030-CICS-API-FIELDS                  06280002
062900                           DP020-STANDARD-COMMAREA                06290002
063000                           PC751AI.                               06300002
063100*                                                                 06310002
063200     IF  DP030-RC-CALL-SUCCESSFUL                                 06320002
063300         CONTINUE                                                 06330002
063400     ELSE                                                         06340002
063500         SET DP013-NO-ROLLBACK                                    06350002
063600             DP013-XCTL-DISPLAY-RESTART                           06360002
063700             DP013-CICS-ABEND      TO TRUE                        06370002
063800         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        06380002
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06390074
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06400074
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06401074
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06402074
064100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06410002
064200         PERFORM DP013-0000-PROCESS-ABEND                         06420002
064300     END-IF.                                                      06430002
064400                                                                  06440002
064500*----------------------------------------------------------------*06450002
064600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06460002
064700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *06470002
064800*                                                                *06480002
064900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *06490002
065000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *06500002
065100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *06510002
065200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *06520002
065300*----------------------------------------------------------------*06530002
065400 1000-CONTROL-PROCESSING.                                         06540002
065500                                                                  06550002
065600     EVALUATE TRUE                                                06560002
065700         WHEN DP020-NEXT-ACT-INITIAL                              06570002
065800             INITIALIZE ASC-SPECIFIC-COMMAREA                     06580002
065900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06590002
066000                                      ASC-SEL-TERM-ID             06600002
066100             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   06610002
066200                                           ASC-SEL-TASK-NUMBER    06620002
066300             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              06630002
066400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 06640002
066500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06650002
066600             PERFORM 4000-BUILD-INITIAL-PANEL                     06660002
066700                                                                  06670002
066800         WHEN DP020-NEXT-ACT-READ-MAP                             06680002
066900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         06690002
067000             PERFORM 2000-PROCESS-PANEL                           06700002
067100                                                                  06710002
067200         WHEN DP020-NEXT-ACT-RETURN                               06720002
067300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         06730002
067400             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               06740002
067410             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06741034
067500*            PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 06750034
067600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06760002
067700                                                                  06770002
067800         WHEN OTHER                                               06780002
067900             SET DP013-LOGIC-ABEND TO TRUE                        06790002
068000             SET DP013-NO-ROLLBACK TO TRUE                        06800002
068100             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    06810002
068200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06820002
068300                                   TO DP013-MESSAGE-TEXT(1)       06830002
068400             PERFORM DP013-0000-PROCESS-ABEND                     06840002
068500     END-EVALUATE.                                                06850002
068600                                                                  06860002
068700*----------------------------------------------------------------*06870002
068800* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06880002
068900* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06890002
069000*----------------------------------------------------------------*06900002
069100 1100-PROCESS-INTER-APPL-COMM.                                    06910002
069200                                                                  06920002
069300     SET PS-COMMAREA-VALID         TO TRUE.                       06930002
069400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     06940002
069500                                                                  06950002
069600     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          06960002
069700         MOVE PC213-OPER-UNT-ID       TO ASC-OPER-NBR             06970002
069800         MOVE PC213-CRNT-BUS-DTE      TO ASC-BUSN-DATE            06980002
069900         MOVE PC213-FROM-DATE         TO ASC-FROM-DATE            06990002
070000         MOVE PC213-TO-DATE           TO ASC-TO-DATE              07000002
070100         MOVE PC213-FISCAL-WEEK       TO ASC-FISCAL-WEEK          07010002
070200         MOVE PC213-FISCAL-MONTH      TO ASC-FISCAL-MONTH         07020002
070300         MOVE PC213-PRINTER-ID        TO ASC-PRINTER-ID           07030002
070400     ELSE                                                         07040002
070410         IF  DP020-INT-APPL-FORMAT-IND = PC-PROCESS-AREA-FORMAT   07041055
070420             MOVE PC214-OPER-UNT-ID        TO ASC-OPER-NBR        07042055
070430             MOVE PC214-BUSN-DATE          TO ASC-BUSN-DATE       07043055
070440             MOVE PC214-FROM-DATE          TO ASC-FROM-DATE       07044055
070450             MOVE PC214-TO-DATE            TO ASC-TO-DATE         07045055
070460             MOVE PC214-FISCAL-WEEK        TO ASC-FISCAL-WEEK     07046055
070470             MOVE PC214-FISCAL-MONTH       TO ASC-FISCAL-MONTH    07047055
070480             MOVE PC214-PROCESS-GROUP      TO ASC-PROCESS-GROUP   07048055
070490             MOVE PC214-PROCESS-AREA       TO ASC-PROCESS-AREA    07049055
070491             MOVE PC214-PRINTER-ID         TO ASC-PRINTER-ID      07049155
070492         ELSE                                                     07049255
070500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  07050055
070600             MOVE PC214-NUMBER-OF-SELECTED-ITEMS TO               07060055
070700                                      ASC-NUMBER-OF-SELECTED-ITEMS07070002
070800             MOVE PC214-NUMBER-OF-TS-ITEMS TO                     07080055
070810                                           ASC-NUMBER-OF-TS-ITEMS 07081055
070900             MOVE PC214-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME  07090055
071000             MOVE PC214-OPER-UNT-ID        TO ASC-OPER-NBR        07100055
071010             MOVE PC214-BUSN-DATE          TO ASC-BUSN-DATE       07101055
071100             MOVE PC214-FROM-DATE          TO ASC-FROM-DATE       07110055
071200             MOVE PC214-TO-DATE            TO ASC-TO-DATE         07120055
071300             MOVE PC214-FISCAL-WEEK        TO ASC-FISCAL-WEEK     07130055
071400             MOVE PC214-FISCAL-MONTH       TO ASC-FISCAL-MONTH    07140055
071500             MOVE PC214-PROCESS-GROUP      TO ASC-PROCESS-GROUP   07150055
071600             MOVE PC214-PROCESS-AREA       TO ASC-PROCESS-AREA    07160055
071700             MOVE PC214-PRINTER-ID         TO ASC-PRINTER-ID      07170055
071800             PERFORM 1120-PREPARE-LIST-ENTRY                      07180055
071900         END-IF                                                   07190055
071910     END-IF.                                                      07191055
072000                                                                  07200002
072100*-----------------------------------------------------------------07210002
072200*  PREPARE LIST ENTRY                                             07220002
072300*-----------------------------------------------------------------07230002
072400 1120-PREPARE-LIST-ENTRY.                                         07240002
072500                                                                  07250002
072600     MOVE PC215-MAX-ITEMS          TO ASC-SEL-SUB.                07260002
072700     MOVE ZERO                     TO ASC-SEL-ITEM.               07270002
072800     PERFORM 1130-GET-NEXT-RECORD.                                07280002
072900                                                                  07290002
073000*-----------------------------------------------------------------07300002
073100*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*07310002
073200*-----------------------------------------------------------------07320002
073300 1130-GET-NEXT-RECORD.                                            07330002
073400     ADD +1                       TO ASC-SEL-SUB.                 07340002
073500                                                                  07350002
073600     IF  ASC-SEL-SUB > PC215-MAX-ITEMS                            07360002
073700         ADD +1                   TO ASC-SEL-ITEM                 07370002
073800         MOVE +1                  TO ASC-SEL-SUB                  07380002
073900     END-IF.                                                      07390002
074000                                                                  07400002
074100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07410002
074200         PERFORM 9100-READ-SEL-QUEUE                              07420002
074300         IF  PC215-ITEM (ASC-SEL-SUB) > ZERO                      07430002
074400             MOVE PC215-OPER-DESC (ASC-SEL-SUB) TO ASC-OPER-DESC  07440023
074401             MOVE PC215-AREA (ASC-SEL-SUB)   TO ASC-PROCESS-AREA  07440123
074410             MOVE PC215-GROUP(ASC-SEL-SUB)   TO ASC-PROCESS-GROUP 07441023
074500             MOVE PC215-3RD-UNITS (ASC-SEL-SUB) TO ASC-3RD-UNITS  07450002
074600             MOVE PC215-3RD-PCT (ASC-SEL-SUB)   TO ASC-3RD-PCT    07460002
074700             MOVE PC215-1ST-UNITS (ASC-SEL-SUB) TO ASC-1ST-UNITS  07470002
074800             MOVE PC215-1ST-PCT (ASC-SEL-SUB)   TO ASC-1ST-PCT    07480002
074900             MOVE PC215-2ND-UNITS (ASC-SEL-SUB) TO ASC-2ND-UNITS  07490002
075000             MOVE PC215-2ND-PCT (ASC-SEL-SUB)   TO ASC-2ND-PCT    07500002
075100             MOVE PC215-TOT-UNITS (ASC-SEL-SUB) TO ASC-TOT-UNITS  07510002
075200             MOVE PC215-TOT-PCT (ASC-SEL-SUB)   TO ASC-TOT-PCT    07520002
075300             SET PC215-INQ (ASC-SEL-SUB) TO TRUE                  07530002
075400             PERFORM 9200-REWRITE-SEL-QUEUE                       07540002
075500         ELSE                                                     07550002
075600             SUBTRACT +1 FROM ASC-SEL-SUB                         07560002
075700             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             07570002
075800             SET DP020-MSG-INFORMATIONAL                          07580002
075900                 PS-LIST-END             TO TRUE                  07590002
076000         END-IF                                                   07600002
076100     ELSE                                                         07610002
076200         SUBTRACT +1 FROM ASC-SEL-ITEM                            07620002
076300         MOVE PC215-MAX-ITEMS     TO ASC-SEL-SUB                  07630002
076400         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             07640002
076500         SET DP020-MSG-INFORMATIONAL                              07650002
076600             PS-LIST-END             TO TRUE                      07660002
076700     END-IF.                                                      07670002
076800                                                                  07680002
076900*----------------------------------------------------------------*07690002
077000*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *07700002
077100*    PROCESSED.                                                  *07710002
077200*----------------------------------------------------------------*07720002
077300 1140-GET-PREV-RECORD.                                            07730002
077400     SUBTRACT +1 FROM ASC-SEL-SUB.                                07740002
077500                                                                  07750002
077600     IF  ASC-SEL-SUB < +1                                         07760002
077700         SUBTRACT +1 FROM ASC-SEL-ITEM                            07770002
077800         MOVE PC215-MAX-ITEMS     TO ASC-SEL-SUB                  07780002
077900     END-IF.                                                      07790002
078000                                                                  07800002
078100     IF  ASC-SEL-ITEM > ZERO                                      07810002
078200         PERFORM 9100-READ-SEL-QUEUE                              07820002
078210         MOVE PC215-OPER-DESC (ASC-SEL-SUB) TO ASC-OPER-DESC      07821023
078220         MOVE PC215-AREA (ASC-SEL-SUB)   TO ASC-PROCESS-AREA      07822023
078230         MOVE PC215-GROUP(ASC-SEL-SUB)   TO ASC-PROCESS-GROUP     07823023
078400         MOVE PC215-3RD-UNITS (ASC-SEL-SUB) TO ASC-3RD-UNITS      07840002
078500         MOVE PC215-3RD-PCT (ASC-SEL-SUB)   TO ASC-3RD-PCT        07850002
078600         MOVE PC215-1ST-UNITS (ASC-SEL-SUB) TO ASC-1ST-UNITS      07860002
078700         MOVE PC215-1ST-PCT (ASC-SEL-SUB)   TO ASC-1ST-PCT        07870002
078800         MOVE PC215-2ND-UNITS (ASC-SEL-SUB) TO ASC-2ND-UNITS      07880002
078900         MOVE PC215-2ND-PCT (ASC-SEL-SUB)   TO ASC-2ND-PCT        07890002
079000         MOVE PC215-TOT-UNITS (ASC-SEL-SUB) TO ASC-TOT-UNITS      07900002
079100         MOVE PC215-TOT-PCT (ASC-SEL-SUB)   TO ASC-TOT-PCT        07910002
079200         SET PC215-INQ (ASC-SEL-SUB) TO TRUE                      07920002
079300         PERFORM 9200-REWRITE-SEL-QUEUE                           07930002
079400     ELSE                                                         07940002
079500         MOVE +1                  TO ASC-SEL-ITEM                 07950002
079600                                     ASC-SEL-SUB                  07960002
079700         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             07970002
079800         SET DP020-MSG-INFORMATIONAL                              07980002
079900             PS-LIST-END             TO TRUE                      07990002
080000     END-IF.                                                      08000002
080100                                                                  08010002
080200*----------------------------------------------------------------*08020002
080300* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08030002
080400* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08040002
080500* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08050002
080600* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08060002
080700* FUNCTION KEYS CAN GET THIS FAR.                                *08070002
080800*----------------------------------------------------------------*08080002
080900 2000-PROCESS-PANEL.                                              08090002
081000     EVALUATE TRUE                                                08100002
081100         WHEN DP020-SRC-AID = DP016-CLEAR                         08110002
081200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08120002
081300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08130002
081400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08140002
081500                                                                  08150002
081600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08160002
081700             PERFORM 2050-DELETE-LIST-QUEUE                       08170002
081710             PERFORM 4000-BUILD-INITIAL-PANEL                     08171036
082000                                                                  08200002
082030         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    08203033
082040             PERFORM 2140-DESELECT-ALL-ITEMS                      08204033
082050             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08205033
082060                                                                  08206033
082070         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  08207033
082080             PERFORM 2150-SELECT-ALL-ITEMS                        08208033
082090             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08209033
082091                                                                  08209133
082100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08210002
082200             IF  ASC-USE-SELECTION-QUEUE                          08220002
082300                 PERFORM 1130-GET-NEXT-RECORD                     08230002
082400                 IF PS-LIST-END                                   08240002
082500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08250002
082600                     SET PS-NO-LIST-END TO TRUE                   08260002
082700                 ELSE                                             08270002
082800                     PERFORM 2050-DELETE-LIST-QUEUE               08280002
082900                     PERFORM 3200-RESET-ATTRIBUTES                08290002
082910                     MOVE ZEROS TO ASC-OPER-NBR                   08291014
083000                     PERFORM 4000-BUILD-INITIAL-PANEL             08300002
083100                 END-IF                                           08310002
083200              ELSE                                                08320002
083300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08330002
083400*                --- BOTTOM OF LIST ---                           08340002
083500                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         08350002
083600                 SET DP020-MSG-INFORMATIONAL TO TRUE              08360002
083700             END-IF                                               08370002
083800                                                                  08380002
083900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08390002
084000             IF  ASC-USE-SELECTION-QUEUE                          08400002
084100                 PERFORM 1140-GET-PREV-RECORD                     08410002
084200                 IF PS-LIST-END                                   08420002
084300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08430002
084400                     SET PS-NO-LIST-END TO TRUE                   08440002
084500                 ELSE                                             08450002
084600                     PERFORM 2050-DELETE-LIST-QUEUE               08460002
084700                     PERFORM 3200-RESET-ATTRIBUTES                08470002
084710                     MOVE ZEROS TO ASC-OPER-NBR                   08471014
084800                     PERFORM 4000-BUILD-INITIAL-PANEL             08480002
084900                 END-IF                                           08490002
085000             ELSE                                                 08500002
085100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08510002
085200                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         08520002
085300                 SET DP020-MSG-INFORMATIONAL TO TRUE              08530002
085400             END-IF                                               08540002
085500                                                                  08550002
085600         WHEN OTHER                                               08560002
085700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08570002
085800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08580002
085900                                                                  08590002
086000             IF  PS-NO-ERROR                                      08600002
086100                 SET DP030-CONTINUE-GO TO TRUE                    08610002
086200                 PERFORM 2100-CHECK-FUNCTION-KEY                  08620002
086300             ELSE                                                 08630002
086400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08640002
086500                 SET DP030-OVERRIDE-GO TO TRUE                    08650002
086600             END-IF                                               08660002
086700     END-EVALUATE.                                                08670002
086800                                                                  08680002
086900*----------------------------------------------------------------*08690002
087000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *08700002
087100*----------------------------------------------------------------*08710002
087200 2050-DELETE-LIST-QUEUE.                                          08720002
087300                                                                  08730002
087400     EXEC CICS                                                    08740002
087500         DELETEQ TS                                               08750002
087600             QUEUE (ASC-LIST-QUEUE-NAME)                          08760002
087700             RESP  (PV-CICS-RESP)                                 08770002
087800     END-EXEC.                                                    08780002
087900                                                                  08790002
088000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       08800002
088100        (PV-CICS-RESP = DFHRESP(QIDERR))                          08810002
088200         CONTINUE                                                 08820002
088300     ELSE                                                         08830002
088400         SET DP013-CICS-ABEND      TO TRUE                        08840002
088500         SET DP013-NO-ROLLBACK     TO TRUE                        08850002
088600                                                                  08860002
088700         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         08870002
088800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    08880002
088900                                   TO DP013-MESSAGE-TEXT (1)      08890002
089000         PERFORM DP013-0000-PROCESS-ABEND                         08900002
089100     END-IF.                                                      08910002
089200                                                                  08920002
089300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  08930002
089400                                                                  08940002
089500*----------------------------------------------------------------*08950002
089600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*08960002
089700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *08970002
089800* CICS ARCHITECTURE API.                                         *08980002
089900*----------------------------------------------------------------*08990002
090000 2100-CHECK-FUNCTION-KEY.                                         09000002
090100                                                                  09010002
090200     EVALUATE TRUE                                                09020002
090300*                                                                 09030002
090400* F17 - UNITS WORKED BY PO                                        09040002
090500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09050002
090510             IF ASC-OPER-NBR-X  = SPACES OR ZEROES                09051026
090520                 SET PS-ERROR                                     09052026
090530                     DP020-MSG-FATAL         TO TRUE              09053026
090540                 MOVE PC-TSYMSG-02873    TO DP020-MSG-NUMBER      09054026
090550                 MOVE -1                 TO MR-SELECTL (1)        09055026
090560                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09056026
090570                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09057026
090580                 SET DP030-OVERRIDE-GO TO TRUE                    09058026
090590             END-IF                                               09059026
090591             IF PS-NO-ERROR                                       09059126
090592                 IF ASC-BUSN-DATE = SPACES                        09059226
090593                     SET PS-ERROR                                 09059326
090594                         DP020-MSG-FATAL         TO TRUE          09059426
090595                     MOVE PC-TSYMSG-02378    TO DP020-MSG-NUMBER  09059526
090596                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09059626
090597                     MOVE -1                 TO MR-SELECTL (1)    09059726
090598                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09059826
090599                     SET DP030-OVERRIDE-GO TO TRUE                09059926
090600                 END-IF                                           09060026
090601             END-IF                                               09060126
090610             IF PS-NO-ERROR                                       09061002
090620                 PERFORM 2300-CHECK-PO-HISTORY-DATE               09062029
090630                 IF PS-VALID-POHIST-DATE                          09063029
090700                     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO      09070029
090800                         SET ASC-USE-SELECTION-QUEUE TO TRUE      09080029
090900                         INITIALIZE PC214-INTER-APPL-COMMAREA     09090029
091000                         MOVE ASC-NUMBER-OF-SELECTED-ITEMS        09100029
091100                                TO PC214-NUMBER-OF-SELECTED-ITEMS 09110029
091200                         MOVE ASC-NUMBER-OF-TS-ITEMS              09120029
091300                                      TO PC214-NUMBER-OF-TS-ITEMS 09130002
091400                         MOVE ASC-SEL-QUEUE-NAME                  09140029
091500                                           TO PC214-SEL-QUEUE-NAME09150002
091600                         MOVE ASC-OPER-NBR   TO PC214-OPER-UNT-ID 09160029
091700                         MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE 09170029
091800                         MOVE ASC-PROCESS-GROUP                   09180029
091900                                            TO PC214-PROCESS-GROUP09190029
092200                         MOVE ASC-PRINTER-ID TO PC214-PRINTER-ID  09220029
092300                         PERFORM 5000-PREPARE-SEL-QUEUE           09230029
092400                     ELSE                                         09240029
092410                         MOVE -1               TO MR-SELECTL (1)  09241041
092420                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      09242041
092500                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     09250029
092600                         SET DP030-OVERRIDE-GO TO TRUE            09260029
092700                         MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER 09270029
092800                         SET DP020-MSG-WARNING TO TRUE            09280029
092900                     END-IF                                       09290029
092901                 ELSE                                             09290129
092902                     SET PS-ERROR                                 09290229
092903                         DP020-MSG-FATAL         TO TRUE          09290329
092904                     MOVE PV-POHIST-DATE     TO DP020-MSG-TEXT    09290431
092905                     MOVE PC-TSYMSG-02874    TO DP020-MSG-NUMBER  09290531
092906                     MOVE -1                 TO MR-SELECTL (1)    09290631
092907                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09290731
092908                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09290831
092909                     SET DP030-OVERRIDE-GO TO TRUE                09290931
092910                 END-IF                                           09291029
093000             END-IF                                               09300002
093100                                                                  09310002
093110* F18 - UNITS WORKED BY PROCESS AREA                              09311002
093120         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09312016
093130             IF PS-NO-ERROR                                       09313002
093140                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          09314002
093150                     SET ASC-USE-SELECTION-QUEUE TO TRUE          09315002
093160                     INITIALIZE PC214-INTER-APPL-COMMAREA         09316002
093170                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            09317002
093180                                TO PC214-NUMBER-OF-SELECTED-ITEMS 09318002
093190                     MOVE ASC-NUMBER-OF-TS-ITEMS                  09319002
093191                                      TO PC214-NUMBER-OF-TS-ITEMS 09319102
093192                     MOVE ASC-SEL-QUEUE-NAME                      09319202
093193                                           TO PC214-SEL-QUEUE-NAME09319302
093194                     MOVE ASC-OPER-NBR     TO PC214-OPER-UNT-ID   09319402
093195                     MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE     09319502
093196                     MOVE ASC-FROM-DATE    TO PC214-FROM-DATE     09319602
093197                     MOVE ASC-TO-DATE      TO PC214-TO-DATE       09319702
093198                     MOVE ASC-FISCAL-WEEK  TO PC214-FISCAL-WEEK   09319802
093199                     MOVE ASC-FISCAL-MONTH TO PC214-FISCAL-MONTH  09319902
093200                     MOVE ASC-PRINTER-ID   TO PC214-PRINTER-ID    09320002
093201                     PERFORM 5000-PREPARE-SEL-QUEUE               09320102
093202                 ELSE                                             09320202
093203                     MOVE -1               TO MR-SELECTL (1)      09320341
093204                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09320441
093205                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09320502
093206                     SET DP030-OVERRIDE-GO TO TRUE                09320602
093207                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     09320702
093208                     SET DP020-MSG-WARNING TO TRUE                09320802
093209                 END-IF                                           09320902
093210             END-IF                                               09321002
093220                                                                  09322002
093300* F22 - COMPARE PREVIOUS YEAR TO CURRENT YEAR                     09330002
093400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09340002
093500             IF PS-NO-ERROR                                       09350002
093600                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          09360002
093700                     SET ASC-USE-SELECTION-QUEUE TO TRUE          09370002
093800                     INITIALIZE PC214-INTER-APPL-COMMAREA         09380002
093900                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            09390002
094000                                TO PC214-NUMBER-OF-SELECTED-ITEMS 09400002
094100                     MOVE ASC-NUMBER-OF-TS-ITEMS                  09410002
094200                                      TO PC214-NUMBER-OF-TS-ITEMS 09420002
094300                     MOVE ASC-SEL-QUEUE-NAME                      09430002
094400                                           TO PC214-SEL-QUEUE-NAME09440002
094500                     MOVE ASC-OPER-NBR     TO PC214-OPER-UNT-ID   09450002
094600                     MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE     09460002
094700                     MOVE ASC-FROM-DATE    TO PC214-FROM-DATE     09470002
094800                     MOVE ASC-TO-DATE      TO PC214-TO-DATE       09480002
094900                     MOVE ASC-FISCAL-WEEK  TO PC214-FISCAL-WEEK   09490002
095000                     MOVE ASC-FISCAL-MONTH TO PC214-FISCAL-MONTH  09500002
095100                     MOVE ASC-PRINTER-ID   TO PC214-PRINTER-ID    09510002
095200                     PERFORM 5000-PREPARE-SEL-QUEUE               09520002
095300                 ELSE                                             09530002
095310                     MOVE -1               TO MR-SELECTL (1)      09531041
095320                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09532041
095400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09540002
095500                     SET DP030-OVERRIDE-GO TO TRUE                09550002
095600                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     09560002
095700                     SET DP020-MSG-WARNING TO TRUE                09570002
095800                 END-IF                                           09580002
095900             END-IF                                               09590002
096000                                                                  09600002
098900* F24 - PRINT A REPORT                                            09890002
099000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              09900016
099100             IF PS-NO-ERROR                                       09910002
099300                 SET ASC-USE-SELECTION-QUEUE TO TRUE              09930039
099400                 INITIALIZE PC214-INTER-APPL-COMMAREA             09940039
099500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09950039
099600                                TO PC214-NUMBER-OF-SELECTED-ITEMS 09960002
099700                 MOVE ASC-NUMBER-OF-TS-ITEMS                      09970039
099800                                      TO PC214-NUMBER-OF-TS-ITEMS 09980002
099900                 MOVE ASC-SEL-QUEUE-NAME                          09990039
100000                                           TO PC214-SEL-QUEUE-NAME10000002
100100                 MOVE ASC-OPER-NBR     TO PC214-OPER-UNT-ID       10010039
100200                 MOVE ASC-BUSN-DATE    TO PC214-BUSN-DATE         10020039
100300                 MOVE ASC-FROM-DATE    TO PC214-FROM-DATE         10030039
100400                 MOVE ASC-TO-DATE      TO PC214-TO-DATE           10040039
100500                 MOVE ASC-FISCAL-WEEK  TO PC214-FISCAL-WEEK       10050039
100600                 MOVE ASC-FISCAL-MONTH TO PC214-FISCAL-MONTH      10060039
100700                 MOVE ASC-PRINTER-ID   TO PC214-PRINTER-ID        10070039
100800                 PERFORM 5000-PREPARE-SEL-QUEUE                   10080039
101400             END-IF                                               10140039
101600                                                                  10160002
101700*                                                                 10170002
101800* F6 - FIRST PAGE                                                 10180002
101900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10190002
102000             MOVE +1               TO PV-TOP-ITEM                 10200002
102100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10210002
102200*                                                                 10220002
102300* F7 - PREVIOUS PAGE                                              10230002
102400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10240002
102500             PERFORM 2110-BROWSE-BACKWARD                         10250002
102600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10260002
102700*                                                                 10270002
102800* F8 - NEXT PAGE                                                  10280002
102900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10290002
103000             PERFORM 2120-BROWSE-FORWARD                          10300002
103100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10310002
103200*                                                                 10320002
103300* ENTER KEY                                                       10330002
103400         WHEN DP020-SRC-AID = DP016-ENTER                         10340002
103500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10350002
103600             IF  PS-ERROR                                         10360002
103700                 CONTINUE                                         10370002
103800             ELSE                                                 10380002
103900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10390002
104000             END-IF                                               10400002
104100                                                                  10410002
104200         WHEN OTHER                                               10420002
104300             SET DP013-NO-ROLLBACK                                10430002
104400                 DP013-XCTL-DISPLAY-RESTART                       10440002
104500                 DP013-CICS-ABEND  TO TRUE                        10450002
104600             MOVE '2100-CHECK-FUNCTION-KEY'                       10460002
104700                                   TO DP013-PARAGRAPH             10470002
104800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10480002
104900                                   TO DP013-MESSAGE-TEXT (1)      10490002
105000             PERFORM DP013-0000-PROCESS-ABEND                     10500002
105100     END-EVALUATE.                                                10510002
105200*                                                                 10520002
105210*----------------------------------------------------------------*10521033
105220*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *10522033
105230*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *10523033
105240*----------------------------------------------------------------*10524033
105250 2140-DESELECT-ALL-ITEMS.                                         10525033
105260     MOVE +1                       TO ASC-BLK-SUB.                10526033
105270                                                                  10527033
105280     PERFORM 2141-CLEAR-SELECTED-INDS                             10528033
105290         VARYING ASC-ITEM-SUB                                     10529033
105291         FROM 1 BY 1                                              10529133
105292         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10529233
105293                                                                  10529333
105294     ADD +1                        TO ASC-BLK-SUB.                10529433
105295                                                                  10529533
105296     PERFORM 2141-CLEAR-SELECTED-INDS                             10529633
105297         VARYING ASC-ITEM-SUB                                     10529733
105298         FROM 1 BY 1                                              10529833
105299         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10529933
105300                                                                  10530033
105301     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               10530133
105302                                   TO PV-LIST-ITEM-NUMBER.        10530233
105303                                                                  10530333
105304     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            10530433
105305         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    10530533
105306                                                                  10530633
105307     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     10530733
105308        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      10530833
105309         MOVE +1                   TO ASC-BLK-SUB                 10530933
105310                                                                  10531033
105311         PERFORM 5100-WRITE-TEMP-STORAGE                          10531133
105312         MOVE +2                   TO ASC-BLK-SUB                 10531233
105313         PERFORM 5100-WRITE-TEMP-STORAGE                          10531333
105314         MOVE +1                   TO ASC-BLK-SUB                 10531433
105315                                                                  10531533
105316         MOVE +1                   TO PV-BLOCK-NUMBER             10531633
105317                                                                  10531733
105318         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10531833
105319             PV-FIRST-BLOCK-IN-ARRAY - 1                          10531933
105320                                                                  10532033
105321         PERFORM                                                  10532133
105322             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       10532233
105323                                                                  10532333
105324             PERFORM 4410-READ-TEMP-STORAGE                       10532433
105325                                                                  10532533
105326             PERFORM 2141-CLEAR-SELECTED-INDS                     10532633
105327                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 10532733
105328                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10532833
105329                                                                  10532933
105330             PERFORM 5100-WRITE-TEMP-STORAGE                      10533033
105331                                                                  10533133
105332             ADD +1                TO PV-BLOCK-NUMBER             10533233
105333                                                                  10533333
105334         END-PERFORM                                              10533433
105335                                                                  10533533
105336         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         10533633
105337             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     10533733
105338                                                                  10533833
105339         PERFORM                                                  10533933
105340             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       10534033
105341                   ASC-HIGHEST-BLOCK-WRITTEN                      10534133
105342                                                                  10534233
105343             MOVE PV-NEXT-BLOCK-IN-ARRAY                          10534333
105344                                   TO PV-BLOCK-NUMBER             10534433
105345                                                                  10534533
105346             PERFORM 4410-READ-TEMP-STORAGE                       10534633
105347                                                                  10534733
105348             PERFORM 2141-CLEAR-SELECTED-INDS                     10534833
105349                 VARYING ASC-ITEM-SUB                             10534933
105350                 FROM 1 BY 1                                      10535033
105351                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10535133
105352                                                                  10535233
105353             PERFORM 5100-WRITE-TEMP-STORAGE                      10535333
105354                                                                  10535433
105355             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      10535533
105356         END-PERFORM                                              10535633
105357                                                                  10535733
105358         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          10535833
105359         PERFORM 4410-READ-TEMP-STORAGE                           10535933
105360     END-IF.                                                      10536033
105361                                                                  10536133
105362                                                                  10536233
105363     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.10536333
105364     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 10536433
105365     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   10536533
105366                                                                  10536633
105367     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10536733
105368                                                                  10536833
105369*----------------------------------------------------------------*10536933
105370*    MARK EACH ITEM AS BEING NOT SELECTED.                       *10537033
105371*----------------------------------------------------------------*10537133
105372 2141-CLEAR-SELECTED-INDS.                                        10537233
105373                                                                  10537333
105374     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           10537433
105375             NOT EQUAL ZERO                                       10537533
105376         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          10537633
105377             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          10537733
105378                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    10537833
105379                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  10537933
105380                                   TO TRUE                        10538033
105381         END-IF                                                   10538133
105382     END-IF.                                                      10538233
105383                                                                  10538333
105384*----------------------------------------------------------------*10538433
105385*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *10538533
105386*  FOR ALL ITEMS.                                                *10538633
105387*----------------------------------------------------------------*10538733
105388 2150-SELECT-ALL-ITEMS.                                           10538833
105389                                                                  10538933
105390     MOVE +1                       TO ASC-BLK-SUB.                10539033
105391                                                                  10539133
105392     PERFORM 2151-SET-SELECTED-INDS                               10539233
105393         VARYING ASC-ITEM-SUB                                     10539333
105394         FROM 1 BY 1                                              10539433
105395         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10539533
105396                                                                  10539633
105397     ADD +1                        TO ASC-BLK-SUB.                10539733
105398                                                                  10539833
105399     PERFORM 2151-SET-SELECTED-INDS                               10539933
105400         VARYING ASC-ITEM-SUB                                     10540033
105401         FROM 1 BY 1                                              10540133
105402         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10540233
105403                                                                  10540333
105404     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       10540433
105405                                                                  10540533
105406     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            10540633
105407         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    10540733
105408                                                                  10540833
105409     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            10540933
105410         MOVE +1                   TO ASC-BLK-SUB                 10541033
105411                                                                  10541133
105412         PERFORM 5100-WRITE-TEMP-STORAGE                          10541233
105413         MOVE +2                   TO ASC-BLK-SUB                 10541333
105414         PERFORM 5100-WRITE-TEMP-STORAGE                          10541433
105415         MOVE +1                   TO ASC-BLK-SUB                 10541533
105416         MOVE +1                   TO PV-BLOCK-NUMBER             10541633
105417     END-IF.                                                      10541733
105418*                                                                 10541833
105419     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     10541933
105420        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    10542033
105421         MOVE +1                   TO ASC-BLK-SUB                 10542133
105422                                                                  10542233
105423         PERFORM 5100-WRITE-TEMP-STORAGE                          10542333
105424         MOVE +2                   TO ASC-BLK-SUB                 10542433
105425         PERFORM 5100-WRITE-TEMP-STORAGE                          10542533
105426         MOVE +1                   TO ASC-BLK-SUB                 10542633
105427         MOVE +1                   TO PV-BLOCK-NUMBER             10542733
105428                                                                  10542833
105429         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10542933
105430             PV-FIRST-BLOCK-IN-ARRAY - 1                          10543033
105431                                                                  10543133
105432         PERFORM                                                  10543233
105433             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       10543333
105434                                                                  10543433
105435             PERFORM 4410-READ-TEMP-STORAGE                       10543533
105436                                                                  10543633
105437             PERFORM 2151-SET-SELECTED-INDS                       10543733
105438                 VARYING ASC-ITEM-SUB                             10543833
105439                 FROM 1 BY 1                                      10543933
105440                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10544033
105441                                                                  10544133
105442             PERFORM 5100-WRITE-TEMP-STORAGE                      10544233
105443                                                                  10544333
105444             ADD +1                TO PV-BLOCK-NUMBER             10544433
105445                                                                  10544533
105446         END-PERFORM                                              10544633
105447                                                                  10544733
105448         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         10544833
105449             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     10544933
105450                                                                  10545033
105451         PERFORM                                                  10545133
105452             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       10545233
105453                   ASC-HIGHEST-BLOCK-WRITTEN                      10545333
105454                                                                  10545433
105455             MOVE PV-NEXT-BLOCK-IN-ARRAY                          10545533
105456                                   TO PV-BLOCK-NUMBER             10545633
105457                                                                  10545733
105458             PERFORM 4410-READ-TEMP-STORAGE                       10545833
105459                                                                  10545933
105460             PERFORM 2151-SET-SELECTED-INDS                       10546033
105461                 VARYING ASC-ITEM-SUB                             10546133
105462                 FROM 1 BY 1                                      10546233
105463                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10546333
105464                                                                  10546433
105465             PERFORM 5100-WRITE-TEMP-STORAGE                      10546533
105466                                                                  10546633
105467             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      10546733
105468                                                                  10546833
105469         END-PERFORM                                              10546933
105470                                                                  10547033
105471         MOVE PV-FIRST-BLOCK-IN-ARRAY                             10547133
105472                                   TO PV-BLOCK-NUMBER             10547233
105473                                                                  10547333
105474         PERFORM 4410-READ-TEMP-STORAGE                           10547433
105475     END-IF.                                                      10547533
105476                                                                  10547633
105477                                                                  10547733
105478     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             10547833
105479                       ASC-NUMBER-OF-SELECTED-ITEMS.              10547933
105480                                                                  10548033
105481     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10548133
105482                                                                  10548233
105483*----------------------------------------------------------------*10548333
105484*    MARK EACH ITEM AS BEING SELECTED.                           *10548433
105485*----------------------------------------------------------------*10548533
105486 2151-SET-SELECTED-INDS.                                          10548633
105487                                                                  10548733
105488     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           10548833
105489             NOT EQUAL ZERO                                       10548933
105490         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             10549033
105491             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             10549133
105492                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        10549233
105493                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  10549333
105494                               TO  TRUE                           10549433
105495         END-IF                                                   10549533
105496     END-IF.                                                      10549633
105497                                                                  10549733
105498*----------------------------------------------------------------*10549802
105499*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10549902
105500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10550002
105600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10560002
105700*    MESSAGE.                                                    *10570002
105800*----------------------------------------------------------------*10580002
105900 2110-BROWSE-BACKWARD.                                            10590002
106000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10600002
106100         GIVING PV-TOP-ITEM.                                      10610002
106200*                                                                 10620002
106300     IF  ((PV-TOP-ITEM < +1)                                      10630002
106400       OR (PV-TOP-ITEM = +1))                                     10640002
106500         MOVE +1                   TO PV-TOP-ITEM                 10650002
106600*        -- TOP OF LIST --                                        10660002
106700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10670002
106800         SET DP020-MSG-INFORMATIONAL TO TRUE                      10680002
106900     END-IF.                                                      10690002
107000                                                                  10700002
107100*----------------------------------------------------------------*10710002
107200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10720002
107300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *10730002
107400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *10740002
107500*----------------------------------------------------------------*10750002
107600 2120-BROWSE-FORWARD.                                             10760002
107700                                                                  10770002
107800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10780002
107900         GIVING PV-TOP-ITEM.                                      10790002
108000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   10800002
108100         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             10810002
108200*        -- BOTTOM OF LIST --                                     10820002
108300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10830002
108400         SET DP020-MSG-INFORMATIONAL  TO TRUE                     10840002
108500     ELSE                                                         10850002
108600         COMPUTE PV-BOTTOM-ITEM =                                 10860002
108700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 10870002
108800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            10880002
108900*            -- BOTTOM OF LIST --                                 10890002
109000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10900002
109100             SET DP020-MSG-INFORMATIONAL TO TRUE                  10910002
109200         END-IF                                                   10920002
109300     END-IF.                                                      10930002
109400                                                                  10940002
109500*----------------------------------------------------------------*10950002
109600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *10960002
109700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *10970002
109800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *10980002
109900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *10990002
110000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11000002
110100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11010002
110200*----------------------------------------------------------------*11020002
110300 2130-CHECK-FOR-JUMP-BROWSE.                                      11030002
110400     SET PS-NO-ERROR               TO TRUE.                       11040002
110500     IF (ASC-START-ITEM-REQUEST = SPACE)                          11050002
110600         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11060002
110700     ELSE                                                         11070002
110800         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     11080002
110900         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11090002
111000         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11100002
111100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11110002
111210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11121071
111220                         USING DP010I-NUMERIC-EDIT-AREA           11122071
111300                                                                  11130002
111400         IF  NOT DP010I-ERROR-DETECTED                            11140002
111500             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N11150002
111600             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11160002
111700                 IF  ASC-START-ITEM-REQUEST-N >                   11170002
111800                                          ASC-NUMBER-OF-ITEMS-READ11180002
111900                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11190002
112000                     COMPUTE PV-TOP-ITEM =                        11200002
112100                             ASC-NUMBER-OF-ITEMS-READ             11210002
112200                             - PC-ITEMS-PER-PANEL + 1             11220002
112300                     IF  PV-TOP-ITEM < +1                         11230002
112400                         MOVE +1   TO PV-TOP-ITEM                 11240002
112500                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 11250002
112600                         SET DP020-MSG-INFORMATIONAL TO TRUE      11260002
112700                     END-IF                                       11270002
112800                 ELSE                                             11280002
112900                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 11290002
113000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11300002
113100                     COMPUTE PV-BOTTOM-ITEM =                     11310002
113200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11320002
113300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11330002
113400*                        -- BOTTOM OF LIST --                     11340002
113500                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 11350002
113600                         SET DP020-MSG-INFORMATIONAL TO TRUE      11360002
113700                     END-IF                                       11370002
113800                 END-IF                                           11380002
113900             ELSE                                                 11390002
114000*                --- VALUE OUT OF RANGE ----                      11400002
114100                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        11410002
114200                 MOVE -1           TO ASTRTITL                    11420002
114300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11430002
114400                 MOVE DP015-REVERSE TO ASTRTITH                   11440002
114500                 MOVE DP015-RED    TO ASTRTITC                    11450002
114600                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           11460002
114700                 SET DP020-MSG-FATAL                              11470002
114800                     PS-ERROR        TO TRUE                      11480002
114900             END-IF                                               11490002
115000         ELSE                                                     11500002
115100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11510002
115200             MOVE -1               TO ASTRTITL                    11520002
115300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11530002
115400             MOVE DP015-REVERSE    TO ASTRTITH                    11540002
115500             MOVE DP015-RED        TO ASTRTITC                    11550002
115600             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               11560002
115700             SET DP020-MSG-FATAL   TO TRUE                        11570002
115800             SET PS-ERROR          TO TRUE                        11580002
115900         END-IF                                                   11590002
116000     END-IF.                                                      11600002
116100                                                                  11610002
116200******************************************************************11620002
116300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **11630002
116400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **11640002
116500******************************************************************11650002
116600 2200-MOVE-SCREEN-TO-COMMAREA.                                    11660002
116700                                                                  11670002
116800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             11680002
116900     MOVE +1                       TO PV-SUB.                     11690002
117000*                                                                 11700002
117100     PERFORM 3100-SET-SUBSCRIPTS.                                 11710002
117200     IF  ASTRTITL > ZERO                                          11720002
117300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          11730002
117400     ELSE                                                         11740002
117500         IF  ASTRTITF = DP015-ERASE-EOF                           11750002
117600             INITIALIZE ASC-START-ITEM-REQUEST                    11760002
117700         END-IF                                                   11770002
117800     END-IF.                                                      11780002
117900                                                                  11790002
118000     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          11800002
118100         VARYING PV-SUB                                           11810002
118200         FROM 1 BY 1                                              11820002
118300         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      11830002
118400******************************************************************11840002
118500** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**11850002
118600******************************************************************11860002
118700 2210-MOVE-LINES-TO-COMMAREA.                                     11870002
118800     IF  MR-SELECTL (PV-SUB) > ZERO                               11880022
118900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             11890022
119000         MOVE MR-SELECTI (PV-SUB)                                 11900022
119100                                   TO ASC-TEMP-SELECTED-SW        11910022
119200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      11920022
119300     ELSE                                                         11930022
119400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                11940022
119500                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     11950022
119600                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        11960022
119700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      11970022
119710         END-IF                                                   11971022
119720     END-IF.                                                      11972022
119730     ADD +1                        TO ASC-ITEM-SUB.               11973022
119740     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        11974022
119750         ADD +1                    TO ASC-BLK-SUB                 11975022
119760         MOVE +1                   TO ASC-ITEM-SUB                11976022
119770     END-IF.                                                      11977022
119780                                                                  11978029
119790******************************************************************11979029
119791** MAKE SURE THERE IS PO DATA FOR THE DATE REQUESTED              11979129
119792******************************************************************11979229
119793 2300-CHECK-PO-HISTORY-DATE.                                      11979329
119794     MOVE ASC-BUSN-YY  TO  PV-CMPR-YY.                            11979429
119795     MOVE ASC-BUSN-MM  TO  PV-CMPR-MM.                            11979529
119796     MOVE ASC-BUSN-DD  TO  PV-CMPR-DD.                            11979629
119797     EXEC SQL                                                     11979729
119798         SELECT CURRENT DATE - FUNC_QTY DAYS                      11979829
119799           INTO   :PV-POHIST-DATE                                 11979929
119800           FROM  TKRPRPM                                          11980029
119801          WHERE SYS_PRC_FUNC_CDE = 'POHIST'                       11980129
119802      END-EXEC.                                                   11980229
119803                                                                  11980329
119804       EVALUATE TRUE                                              11980429
119805          WHEN SQLCODE = +0                                       11980529
119806              IF PV-COMPARE-DATE >= PV-POHIST-DATE                11980629
119807                 SET PS-VALID-POHIST-DATE TO TRUE                 11980729
119808             ELSE                                                 11980829
119809                 SET PS-INVALID-POHIST-DATE TO TRUE               11980929
119810             END-IF                                               11981029
119811          WHEN OTHER                                              11981129
119812              MOVE '2300-CHECK-PO-HISTORY-DAT' TO DP013-PARAGRAPH 11981229
119813              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)11981329
119814              MOVE SQLCA   TO DP013-SQLCA                         11981429
119815              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         11981529
119816              SET DP013-DB2-ABEND                                 11981629
119817                  DP013-XCTL-DISPLAY-RESTART TO TRUE              11981729
119818              PERFORM DP013-0000-PROCESS-ABEND                    11981829
119819      END-EVALUATE.                                               11981929
119820                                                                  11982029
119830******************************************************************11983002
119900** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **11990002
120000** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **12000002
120100******************************************************************12010002
120200 3000-EDIT-DATA-IN-COMMAREA.                                      12020002
120300     SET PS-NO-ERROR               TO TRUE.                       12030002
120400     PERFORM 3200-RESET-ATTRIBUTES.                               12040002
120500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     12050002
120600                                                                  12060002
120700**                                                                12070002
120800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              12080002
120900* EDITTING IS DONE FROM THE BOTTOM UP.                            12090002
121000**                                                                12100002
121100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       12110002
121200         ASC-ITEMS-DISPLAYED - 1.                                 12120002
121300     PERFORM 3100-SET-SUBSCRIPTS.                                 12130002
121400*                                                                 12140002
121500     IF  PS-NO-ERROR                                              12150002
121600         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        12160002
121700     END-IF.                                                      12170002
121800                                                                  12180002
121900     IF  PS-NO-ERROR                                              12190002
122000         PERFORM 3400-CHECK-RANGE-SEQUENCE                        12200002
122100     END-IF.                                                      12210002
122200*                                                                 12220002
122300     IF  ((PS-NO-ERROR)                                           12230002
122400       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   12240002
122500       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    12250002
122600             PERFORM 3500-MARK-RANGE-AS-SELECTED                  12260002
122700     END-IF.                                                      12270002
122800                                                                  12280002
122900*----------------------------------------------------------------*12290002
123000*   3005-EDIT-COMMAREA-BLOCKS                                    *12300002
123100*----------------------------------------------------------------*12310002
123200 3005-EDIT-COMMAREA-BLOCKS.                                       12320002
123300     MOVE +1                       TO PV-BLOCK-NUMBER.            12330002
123400     MOVE +1                       TO ASC-BLK-SUB.                12340002
123500     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               12350002
123600                                                                  12360002
123700     COMPUTE PV-BLOCK-NUMBER  =                                   12370002
123800        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 12380002
123900            PC-ITEMS-PER-PANEL.                                   12390002
124000                                                                  12400002
124100     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          12410002
124200                                                                  12420002
124300     PERFORM                                                      12430002
124400       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          12440002
124500          OR PS-ERROR                                             12450002
124600          OR PS-BLOCK-ERROR                                       12460002
124700                                                                  12470002
124800             COMPUTE PV-ITEMS-HOLD  =                             12480002
124900                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        12490002
125000                     PC-ITEMS-PER-PANEL - 1                       12500002
125100                                                                  12510002
125200             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       12520002
125300                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               12530002
125400                     FROM  PV-ITEMS-HOLD                          12540002
125500                   GIVING  PV-ITEMS-DIFF                          12550002
125600                 SUBTRACT  PV-ITEMS-DIFF                          12560002
125700                     FROM  PC-ITEMS-PER-PANEL                     12570002
125800                   GIVING  PV-ITEMS-HOLD                          12580002
125900                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              12590002
126000                                              ASC-ITEM-SUB        12600002
126100                                              ASC-ITEMS-DISPLAYED 12610002
126200             ELSE                                                 12620002
126300                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              12630002
126400                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        12640002
126500             END-IF                                               12650002
126600                                                                  12660002
126700             PERFORM 3300-EDIT-SELECTIONS                         12670002
126800                     VARYING PV-SUB                               12680002
126900                        FROM PV-SUB BY -1                         12690002
127000                       UNTIL PV-SUB < +1                          12700002
127100                                                                  12710002
127200             MOVE +1               TO ASC-BLK-SUB                 12720002
127300                                                                  12730002
127400             PERFORM 5105-REWRITE-ASC-LISTQ                       12740002
127500                                                                  12750002
127600             MOVE +1                TO ASC-BLK-SUB                12760002
127700                                                                  12770002
127800             IF  PS-BLOCK-ERROR                                   12780002
127900                 SET  PS-ERROR     TO TRUE                        12790002
128000                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        12800002
128100                                   TO PV-TOP-ITEM                 12810002
128200             ELSE                                                 12820002
128300                 ADD  +1           TO PV-BLOCK-NUMBER             12830002
128400                 IF  PV-BLOCK-NUMBER >                            12840002
128500                     ASC-HIGHEST-BLOCK-WRITTEN                    12850002
128600                     MOVE +2       TO ASC-BLK-SUB                 12860002
128700                     PERFORM 4410-READ-TEMP-STORAGE               12870002
128800                     MOVE +1       TO ASC-BLK-SUB                 12880002
128900                 ELSE                                             12890002
129000                     PERFORM 4410-READ-TEMP-STORAGE               12900002
129100                     ADD  +1        TO PV-BLOCK-NUMBER            12910002
129200                     MOVE +2        TO ASC-BLK-SUB                12920002
129300                     PERFORM 4410-READ-TEMP-STORAGE               12930002
129400                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            12940002
129500                     MOVE +1        TO ASC-BLK-SUB                12950002
129600                 END-IF                                           12960002
129700             END-IF                                               12970002
129800     END-PERFORM.                                                 12980002
129900                                                                  12990002
130000     IF  PV-ORIGINAL-BLOCK  = +1    OR                            13000002
130100         PS-ERROR                   OR                            13010002
130200         PS-BLOCK-ERROR                                           13020002
130300         CONTINUE                                                 13030002
130400     ELSE                                                         13040002
130500         MOVE +1                 TO PV-BLOCK-NUMBER               13050002
130600         MOVE +1                 TO ASC-BLK-SUB                   13060002
130700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  13070002
130800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           13080002
130900         PERFORM 4410-READ-TEMP-STORAGE                           13090002
131000                                                                  13100002
131100         PERFORM                                                  13110002
131200           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              13120002
131300              OR PS-ERROR                                         13130002
131400              OR PS-BLOCK-ERROR                                   13140002
131500                                                                  13150002
131600                 COMPUTE PV-ITEMS-HOLD  =                         13160002
131700                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    13170002
131800                         PC-ITEMS-PER-PANEL - 1                   13180002
131900                                                                  13190002
132000                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     13200002
132100                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           13210002
132200                         FROM  PV-ITEMS-HOLD                      13220002
132300                       GIVING  PV-ITEMS-DIFF                      13230002
132400                     SUBTRACT  PV-ITEMS-DIFF                      13240002
132500                         FROM  PC-ITEMS-PER-PANEL                 13250002
132600                       GIVING  PV-ITEMS-HOLD                      13260002
132700                         MOVE  PV-ITEMS-HOLD TO PV-SUB            13270002
132800                                                ASC-ITEM-SUB      13280002
132900                                               ASC-ITEMS-DISPLAYED13290002
133000                 ELSE                                             13300002
133100                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          13310002
133200                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    13320002
133300                 END-IF                                           13330002
133400                                                                  13340002
133500                 PERFORM 3300-EDIT-SELECTIONS                     13350002
133600                         VARYING PV-SUB                           13360002
133700                            FROM PV-SUB BY -1                     13370002
133800                           UNTIL PV-SUB < +1                      13380002
133900                                                                  13390002
134000                 MOVE +1               TO ASC-BLK-SUB             13400002
134100                                                                  13410002
134200                 PERFORM 5105-REWRITE-ASC-LISTQ                   13420002
134300                                                                  13430002
134400                 MOVE +1                TO ASC-BLK-SUB            13440002
134500                                                                  13450002
134600                 IF  PS-BLOCK-ERROR                               13460002
134700                     SET  PS-ERROR     TO TRUE                    13470002
134800                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    13480002
134900                                       TO PV-TOP-ITEM             13490002
135000                 ELSE                                             13500002
135100                     ADD  +1            TO PV-BLOCK-NUMBER        13510002
135200                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      13520002
135300                         MOVE +2        TO ASC-BLK-SUB            13530002
135400                         PERFORM 4410-READ-TEMP-STORAGE           13540002
135500                         MOVE +1        TO ASC-BLK-SUB            13550002
135600                     ELSE                                         13560002
135700                         PERFORM 4410-READ-TEMP-STORAGE           13570002
135800                         ADD  +1        TO PV-BLOCK-NUMBER        13580002
135900                         MOVE +2        TO ASC-BLK-SUB            13590002
136000                         PERFORM 4410-READ-TEMP-STORAGE           13600002
136100                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        13610002
136200                         MOVE +1        TO ASC-BLK-SUB            13620002
136300                     END-IF                                       13630002
136400                 END-IF                                           13640002
136500     END-PERFORM.                                                 13650002
136600                                                                  13660002
136700*----------------------------------------------------------------*13670002
136800*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13680002
136900*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13690002
137000*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13700002
137100*                                                                *13710002
137200*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13720002
137300*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *13730002
137400*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *13740002
137500*    US IN THE 2ND BLOCK OF THE ARRAY.                           *13750002
137600*----------------------------------------------------------------*13760002
137700 3100-SET-SUBSCRIPTS.                                             13770002
137800                                                                  13780002
137900     COMPUTE ASC-ITEM-SUB =                                       13790002
138000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        13800002
138100                                                                  13810002
138200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13820002
138300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13830002
138400         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               13840002
138500     ELSE                                                         13850002
138600         MOVE +1                     TO ASC-BLK-SUB               13860002
138700     END-IF.                                                      13870002
138800******************************************************************13880002
138900** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **13890002
139000******************************************************************13900002
139100 3200-RESET-ATTRIBUTES.                                           13910002
139200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   13920002
139300     MOVE DP015-GREEN              TO ASTRTITC.                   13930002
139400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   13940002
139500                                                                  13950002
139600     PERFORM                                                      13960024
139700         VARYING PV-SUB                                           13970024
139800         FROM 1 BY 1                                              13980024
139900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        13990024
140000         MOVE DP015-UNP-ALP-NOR-OFF                               14000024
140100                                   TO MR-SELECTA (PV-SUB)         14010024
140200         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         14020024
140300         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         14030024
140400     END-PERFORM.                                                 14040024
140500******************************************************************14050002
140600** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **14060002
140700** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **14070002
140800** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **14080002
140900** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **14090002
141000******************************************************************14100002
141100 3300-EDIT-SELECTIONS.                                            14110002
141200     EVALUATE TRUE                                                14120002
141300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14130002
141400             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         14140002
141500                 CONTINUE                                         14150002
141600         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         14160002
141700             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14170002
141800                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   14180002
141900                 MOVE ASC-TEMP-SELECTED-SW                        14190002
142000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14200002
142100                                TO ASC-SELECTED-SW                14210002
142200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14220002
142300             END-IF                                               14230002
142400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14240002
142500                 = SPACE                                          14250002
142600             EVALUATE TRUE                                        14260002
142700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       14270002
142800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS14280002
142900                     MOVE SPACE TO ASC-SELECTED-SW                14290002
143000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14300002
143100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        14310002
143200                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    14320002
143300                     MOVE SPACE TO ASC-SELECTED-SW                14330002
143400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14340002
143500                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          14350002
143600                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      14360002
143700                     MOVE SPACE TO ASC-SELECTED-SW                14370002
143800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14380002
143900             END-EVALUATE                                         14390002
144000         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14400002
144100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14410002
144200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14420002
144300             END-IF                                               14430002
144400             PERFORM 3310-EDIT-RANGE                              14440002
144500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14450002
144600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14460002
144700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14470002
144800             END-IF                                               14480002
144900             PERFORM 3310-EDIT-RANGE                              14490002
145000         WHEN OTHER                                               14500002
145100             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14510002
145200             SET DP020-MSG-FATAL    TO TRUE                       14520002
145300             MOVE -1                TO MR-SELECTL (PV-SUB)        14530002
145400             SET DP030-SET-CURSOR-APPL-1                          14540002
145500                                    TO TRUE                       14550002
145600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        14560002
145700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        14570002
145800             SET PS-ERROR TO TRUE                                 14580002
145900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14590002
146000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14600002
146100                 MOVE SPACE         TO ASC-SELECTED-SW            14610002
146200                                        (ASC-BLK-SUB ASC-ITEM-SUB)14620002
146300             END-IF                                               14630002
146400     END-EVALUATE.                                                14640002
146500                                                                  14650002
146600     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14660002
146700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14670002
146800     IF  ASC-ITEM-SUB < 1                                         14680002
146900         SUBTRACT +1 FROM ASC-BLK-SUB                             14690002
147000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                14700002
147100     END-IF.                                                      14710002
147200                                                                  14720002
147300******************************************************************14730002
147400** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **14740002
147500** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **14750002
147600** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**14760002
147700** THE ENDING.                                                  **14770002
147800******************************************************************14780002
147900 3310-EDIT-RANGE.                                                 14790002
148000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                14800002
148100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   14810002
148200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)14820002
148300                                   TO ASC-SELECTED-SW             14830002
148400                                        (ASC-BLK-SUB ASC-ITEM-SUB)14840002
148500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 14850002
148600         ELSE                                                     14860002
148700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     14870002
148800                 CONTINUE                                         14880002
148900             ELSE                                                 14890002
149000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        14900002
149100                 MOVE PC-TSYMSG-00054                             14910002
149200                                       TO DP020-MSG-NUMBER        14920002
149300                 MOVE -1               TO ASTRTITL                14930002
149400                 SET DP020-MSG-FATAL                              14940002
149500                     DP030-SET-CURSOR-APPL-1                      14950002
149600                     PS-ERROR          TO TRUE                    14960002
149700             END-IF                                               14970002
149800         END-IF                                                   14980002
149900     ELSE                                                         14990002
150000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     15000002
150100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 15010002
150200                                   TO ASC-SELECTED-SW             15020002
150300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15030002
150400             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   15040002
150500         ELSE                                                     15050002
150600             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       15060002
150700                 CONTINUE                                         15070002
150800             ELSE                                                 15080002
150900*                -- ONLY ONE END-OF-RANGE ALLOWED --              15090002
151000                 MOVE PC-TSYMSG-00055                             15100002
151100                                        TO DP020-MSG-NUMBER       15110002
151200                 MOVE -1                TO ASTRTITL               15120002
151300                 SET DP020-MSG-FATAL                              15130002
151400                     DP030-SET-CURSOR-APPL-1                      15140002
151500                     PS-ERROR           TO TRUE                   15150002
151600             END-IF                                               15160002
151700         END-IF                                                   15170002
151800     END-IF.                                                      15180002
151900*                                                                 15190002
152000******************************************************************15200002
152100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **15210002
152200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **15220002
152300******************************************************************15230002
152400 3400-CHECK-RANGE-SEQUENCE.                                       15240002
152500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       15250002
152600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      15260002
152700       AND  ASC-START-OF-SELECTED-RANGE >                         15270002
152800                                         ASC-END-OF-SELECTED-RANGE15280002
152900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                15290002
153000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 15300002
153100         SET DP020-MSG-FATAL TO TRUE                              15310002
153200         SET PS-ERROR TO TRUE                                     15320002
153300         PERFORM 3410-POSITION-AT-ERROR                           15330002
153400     END-IF.                                                      15340002
153500******************************************************************15350002
153600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **15360002
153700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **15370002
153800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **15380002
153900******************************************************************15390002
154000 3410-POSITION-AT-ERROR.                                          15400002
154100     SET DP030-SET-CURSOR-APPL-1                                  15410002
154200                                   TO TRUE.                       15420002
154300     MOVE -1                       TO ASTRTITL                    15430002
154400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 15440002
154500                    - PV-TOP-ITEM + 1.                            15450002
154600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15460002
154700         CONTINUE                                                 15470002
154800     END-IF.                                                      15480002
154900*                                                                 15490002
155000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   15500002
155100                    - PV-TOP-ITEM + 1.                            15510002
155200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15520002
155300         CONTINUE                                                 15530002
155400     END-IF.                                                      15540002
155500                                                                  15550002
155600*----------------------------------------------------------------*15560002
155700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *15570002
155800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *15580002
155900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *15590002
156000*----------------------------------------------------------------*15600002
156100 3500-MARK-RANGE-AS-SELECTED.                                     15610002
156200     MOVE +1                       TO  ASC-BLK-SUB.               15620002
156300     PERFORM 3510-MARK-SELECTED-INDS                              15630002
156400         VARYING ASC-ITEM-SUB                                     15640002
156500         FROM 1 BY 1                                              15650002
156600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15660002
156700                                                                  15670002
156800     ADD +1                        TO ASC-BLK-SUB.                15680002
156900     PERFORM 3510-MARK-SELECTED-INDS                              15690002
157000         VARYING ASC-ITEM-SUB                                     15700002
157100         FROM 1 BY 1                                              15710002
157200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15720002
157300                                                                  15730002
157400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15740002
157500                                   TO  PV-LIST-ITEM-NUMBER.       15750002
157600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15760002
157700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         15770002
157800               PC-ITEMS-PER-PANEL).                               15780002
157900                                                                  15790002
158000     MOVE ASC-START-OF-SELECTED-RANGE                             15800002
158100                                   TO PV-START-OF-SELECTED-RANGE. 15810002
158200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            15820002
158300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  15830002
158400               PC-ITEMS-PER-PANEL).                               15840002
158500                                                                  15850002
158600     MOVE ASC-END-OF-SELECTED-RANGE                               15860002
158700                                   TO  PV-END-OF-SELECTED-RANGE.  15870002
158800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             15880002
158900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    15890002
159000               PC-ITEMS-PER-PANEL).                               15900002
159100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             15910002
159200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             15920002
159300                                                                  15930002
159400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    15940002
159500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        15950002
159600         MOVE +1                   TO ASC-BLK-SUB                 15960002
159700         PERFORM 5100-WRITE-TEMP-STORAGE                          15970002
159800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15980002
159900             PV-FIRST-BLOCK-IN-ARRAY - 1                          15990002
160000                                                                  16000002
160100         PERFORM                                                  16010002
160200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      16020002
160300                   PV-PREV-BLOCK-IN-ARRAY                         16030002
160400             MOVE PV-FIRST-BLOCK-IN-RANGE                         16040002
160500                                   TO PV-BLOCK-NUMBER             16050002
160600             PERFORM 4410-READ-TEMP-STORAGE                       16060002
160700             PERFORM 3510-MARK-SELECTED-INDS                      16070002
160800                 VARYING ASC-ITEM-SUB                             16080002
160900                 FROM 1 BY 1                                      16090002
161000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16100002
161100             PERFORM 5100-WRITE-TEMP-STORAGE                      16110002
161200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     16120002
161300         END-PERFORM                                              16130002
161400                                                                  16140002
161500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16150002
161600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16160002
161700         PERFORM                                                  16170002
161800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16180002
161900                   PV-LAST-BLOCK-IN-RANGE                         16190002
162000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16200002
162100                                   TO PV-BLOCK-NUMBER             16210002
162200             PERFORM 4410-READ-TEMP-STORAGE                       16220002
162300             PERFORM 3510-MARK-SELECTED-INDS                      16230002
162400                 VARYING ASC-ITEM-SUB                             16240002
162500                 FROM 1 BY 1                                      16250002
162600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16260002
162700             PERFORM 5100-WRITE-TEMP-STORAGE                      16270002
162800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16280002
162900         END-PERFORM                                              16290002
163000                                                                  16300002
163100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16310002
163200                                   TO PV-BLOCK-NUMBER             16320002
163300         PERFORM 4410-READ-TEMP-STORAGE                           16330002
163400     END-IF.                                                      16340002
163500                                                                  16350002
163600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16360002
163700                                      ASC-END-OF-SELECTED-RANGE.  16370002
163800                                                                  16380002
163900*----------------------------------------------------------------*16390002
164000* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16400002
164100*----------------------------------------------------------------*16410002
164200 3510-MARK-SELECTED-INDS.                                         16420002
164300                                                                  16430002
164400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16440002
164500                                ASC-ITEM-SUB) >                   16450002
164600         ASC-START-OF-SELECTED-RANGE)                             16460002
164700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16470002
164800                                ASC-ITEM-SUB) =                   16480002
164900         ASC-START-OF-SELECTED-RANGE)                             16490002
165000                                                                  16500002
165100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16510002
165200                                    ASC-ITEM-SUB) <               16520002
165300             ASC-END-OF-SELECTED-RANGE)                           16530002
165400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16540002
165500                                    ASC-ITEM-SUB) =               16550002
165600             ASC-END-OF-SELECTED-RANGE)                           16560002
165700                                                                  16570002
165800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16580002
165900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   16590002
166000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   16600002
166100                               TO TRUE                            16610002
166200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              16620002
166300                               TO TRUE                            16630002
166400                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    16640002
166500             END-IF                                               16650002
166600         END-IF                                                   16660002
166700     END-IF.                                                      16670002
166800                                                                  16680002
166900*----------------------------------------------------------------*16690002
167000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16700002
167100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16710002
167200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16720002
167300*    DISPLAY THE PANEL TO USER.                                  *16730002
167400*----------------------------------------------------------------*16740002
167500 4000-BUILD-INITIAL-PANEL.                                        16750002
167600                                                                  16760002
167700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            16770002
167800                                 ASC-BLOCK-ENTRIES (2).           16780002
167900     MOVE +1                 TO ASC-BLK-SUB.                      16790002
168000     SET ASC-ITEMS-LEFT-ON-DB                                     16800002
168100                             TO TRUE.                             16810002
168200                                                                  16820002
168300     MOVE +0                 TO ASC-ITEM-SUB                      16830002
168400                                ASC-NUMBER-OF-ITEMS-READ          16840002
168500                                ASC-NUMBER-OF-SELECTED-ITEMS      16850002
168600                                ASC-HIGHEST-BLOCK-WRITTEN         16860002
168700                                ASC-START-OF-SELECTED-RANGE       16870002
168800                                ASC-END-OF-SELECTED-RANGE         16880002
168900                                ASC-ITEM-AT-TOP-OF-PANEL.         16890002
169000                                                                  16900002
169100                                                                  16910002
169101     PERFORM 4004-FIND-DATE-INFO.                                 16910112
169110     IF ASC-OPER-NBR > ZEROES                                     16911008
169200         MOVE ASC-OPER-NBR TO DK-OPER-UNT-ID                      16920008
169300         EXEC SQL                                                 16930008
169400              SELECT  LOC_NM                                      16940070
169500                INTO  :XLT00010-LOC-NM                            16950069
169600                FROM  XLT_LOC                                     16960069
169700               WHERE  LOC_NBR   =  :DK-OPER-UNT-ID                16970069
169800         END-EXEC                                                 16980008
170000         EVALUATE TRUE                                            17000008
170100             WHEN SQLCODE = +0                                    17010008
170200                 MOVE XLT00010-LOC-NM    TO ASC-OPER-DESC         17020069
170400             WHEN OTHER                                           17040008
170500                 MOVE SPACES          TO ASC-OPER-DESC            17050008
170700         END-EVALUATE                                             17070008
170800         PERFORM 4005-CALC-TOTAL-AMTS-BY-OPER                     17080012
170810     ELSE                                                         17081008
170811         IF PC215-OPER-DESC (ASC-SEL-SUB) > SPACES                17081112
170820             MOVE PC215-OPER-DESC (ASC-SEL-SUB) TO DK-OPER-DESC   17082012
170830             EXEC SQL                                             17083012
170840                  SELECT  LOC_NBR                                 17084069
170841                         ,LOC_NM                                  17084170
170850                    INTO  :XLT00010-LOC-NBR                       17085069
170851                         ,:XLT00010-LOC-NM                        17085169
170860                    FROM  XLT_LOC                                 17086069
170870                   WHERE  LOC_5_ABBR_NM =  :DK-OPER-DESC          17087069
170880             END-EXEC                                             17088012
170891             EVALUATE TRUE                                        17089112
170892                 WHEN SQLCODE = +0                                17089212
170893                     MOVE XLT00010-LOC-NBR   TO ASC-OPER-NBR      17089369
170894                                                DK-OPER-UNT-ID    17089415
170895                     MOVE XLT00010-LOC-NM    TO ASC-OPER-DESC     17089569
170896                 WHEN OTHER                                       17089612
170897                     MOVE ZEROES          TO ASC-OPER-NBR         17089712
170898                                             DK-OPER-UNT-ID       17089812
170899                     MOVE SPACES          TO ASC-OPER-DESC        17089915
170900             END-EVALUATE                                         17090012
170901             PERFORM 4005-CALC-TOTAL-AMTS-BY-OPER                 17090112
170902         ELSE                                                     17090212
170903             PERFORM 4006-CALC-TOTAL-AMTS                         17090312
170904         END-IF                                                   17090412
170905     END-IF.                                                      17090512
171000     PERFORM 4100-PREPARE-CURSOR.                                 17100012
171010     PERFORM 4010-OPEN-CURSOR.                                    17101012
171100     PERFORM 4300-READ-ITEMS-FROM-DB.                             17110002
171200     PERFORM 4020-CLOSE-CURSOR.                                   17120002
171300                                                                  17130002
171400     MOVE +1                   TO  PV-TOP-ITEM.                   17140002
171500*    IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          17150002
171600*        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    17160002
171700*        SET DP020-MSG-FATAL   TO  TRUE                           17170002
171800*        MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               17180002
171900*    ELSE                                                         17190002
172000         MOVE -1      TO MR-SELECTL (1)                           17200020
172100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      17210002
172200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    17220002
172300*    END-IF.                                                      17230002
172400                                                                  17240002
172500*----------------------------------------------------------------*17250002
172600*    FIND DATE INFORMATION FOR SCREEN HEADER FIELDS.              17260012
172700*----------------------------------------------------------------*17270002
172800 4004-FIND-DATE-INFO.                                             17280012
172900                                                                  17290002
173000     IF ASC-FISCAL-WEEK > SPACES                                  17300002
173100         MOVE ASC-FISCAL-WEEK    TO DK-FISCAL-WEEK                17310002
173200         PERFORM 4007-GET-WEEK-INFO                               17320002
173210         MOVE DK-FROM-YY        TO ASC-FROM-YR                    17321043
173220         MOVE DK-FROM-MM        TO ASC-FROM-MN                    17322043
173230         MOVE DK-FROM-DD        TO ASC-FROM-DY                    17323043
173300         STRING 'WTD INCL ' DELIMITED BY SIZE                     17330002
173400                DK-TO-DATE  DELIMITED BY SIZE                     17340002
173500                    INTO PV-DISPLAY-DATE                          17350002
173600     ELSE                                                         17360002
173700         IF ASC-FISCAL-MONTH > SPACES                             17370002
173800             MOVE ASC-FISCAL-MONTH   TO DK-FISCAL-MONTH           17380002
173900             PERFORM 4008-GET-MONTH-INFO                          17390002
173910             MOVE DK-FROM-YY        TO ASC-FROM-YR                17391043
173920             MOVE DK-FROM-MM        TO ASC-FROM-MN                17392043
173930             MOVE DK-FROM-DD        TO ASC-FROM-DY                17393043
174000             STRING 'MTD INCL ' DELIMITED BY SIZE                 17400002
174100                    DK-TO-DATE  DELIMITED BY SIZE                 17410002
174200                        INTO PV-DISPLAY-DATE                      17420002
174300         ELSE                                                     17430002
174400             IF ASC-FROM-DATE > SPACES                            17440002
174500                 MOVE ASC-FROM-YR        TO DK-FROM-YY            17450002
174600                 MOVE ASC-FROM-MN        TO DK-FROM-MM            17460002
174700                 MOVE ASC-FROM-DY        TO DK-FROM-DD            17470002
174800                 MOVE DK-FROM-DATE-X     TO DK-FROM-DATE          17480002
174900                 MOVE ASC-TO-YR          TO DK-TO-YY              17490002
175000                 MOVE ASC-TO-MN          TO DK-TO-MM              17500002
175100                 MOVE ASC-TO-DY          TO DK-TO-DD              17510002
175200                 MOVE DK-TO-DATE-X       TO DK-TO-DATE            17520002
175300                 STRING 'BUSINESS DATE RANGE: ' DELIMITED BY SIZE 17530002
175400                        DK-FROM-DATE  DELIMITED BY SIZE           17540002
175500                        ' '           DELIMITED BY SIZE           17550002
175600                        'TO '         DELIMITED BY SIZE           17560002
175700                        DK-TO-DATE    DELIMITED BY SIZE           17570002
175800                            INTO PV-DISPLAY-DATE                  17580002
175900             ELSE                                                 17590002
176000                 MOVE ASC-BUSN-YY        TO DK-FROM-YY            17600002
176100                 MOVE ASC-BUSN-MM        TO DK-FROM-MM            17610002
176200                 MOVE ASC-BUSN-DD        TO DK-FROM-DD            17620002
176300                 MOVE DK-FROM-DATE-X     TO DK-FROM-DATE          17630002
176400                 MOVE DK-FROM-DATE       TO DK-TO-DATE            17640002
176500                     STRING 'BUSINESS DATE: ' DELIMITED BY SIZE   17650002
176600                             DK-TO-DATE       DELIMITED BY SIZE   17660002
176700                                INTO PV-DISPLAY-DATE              17670002
176800             END-IF                                               17680002
176900         END-IF                                                   17690002
177000     END-IF.                                                      17700002
177100     MOVE PV-DISPLAY-DATE TO ASC-DISPLAY-DATE.                    17710002
177101                                                                  17710112
177110*----------------------------------------------------------------*17711012
177120*    CALCULATE TOTALS BY OPER FOR SCREEN HEADER FIELDS.           17712012
177130*----------------------------------------------------------------*17713012
177140 4005-CALC-TOTAL-AMTS-BY-OPER.                                    17714012
177150                                                                  17715012
177200     EXEC SQL                                                     17720002
177300          SELECT  DECIMAL(SUM(UNT_WRKD_QTY),11,0)                 17730002
177400            INTO  :PV-TOT-UNITS                                   17740002
177500            FROM  PCT_SUM_WRKD                                    17750002
177600           WHERE  BUS_DTE        >=  :DK-FROM-DATE                17760002
177700             AND  BUS_DTE        <=  :DK-TO-DATE                  17770002
177800             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              17780002
177900     END-EXEC.                                                    17790002
178000                                                                  17800002
178100     EVALUATE TRUE                                                17810002
178200         WHEN SQLCODE = +0                                        17820002
178300             MOVE PV-TOT-UNITS  TO  ASC-TOT-UNITS                 17830002
178400         WHEN OTHER                                               17840002
178500             MOVE ZEROES        TO  ASC-TOT-UNITS                 17850002
178600     END-EVALUATE.                                                17860002
178700                                                                  17870002
178800     EXEC SQL                                                     17880002
178900          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       17890002
179000            INTO  :PV-1ST-UNITS                                   17900002
179100            FROM  PCT_SUM_WRKD                                    17910002
179200           WHERE  BUS_DTE        >=  :DK-FROM-DATE                17920002
179300             AND  BUS_DTE        <=  :DK-TO-DATE                  17930002
179400             AND  SHFT_NBR        =  :PC-1                        17940002
179500             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              17950002
179600     END-EXEC.                                                    17960002
179700                                                                  17970002
179800     EVALUATE TRUE                                                17980002
179900         WHEN SQLCODE = +0                                        17990002
180000             MOVE PV-1ST-UNITS  TO  ASC-1ST-UNITS                 18000002
180100         WHEN OTHER                                               18010002
180200             MOVE ZEROES        TO  ASC-1ST-UNITS                 18020002
180300     END-EVALUATE.                                                18030002
180400                                                                  18040002
180500     EXEC SQL                                                     18050002
180600          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18060002
180700            INTO  :PV-2ND-UNITS                                   18070002
180800            FROM  PCT_SUM_WRKD                                    18080002
180900           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18090002
181000             AND  BUS_DTE        <=  :DK-TO-DATE                  18100002
181100             AND  SHFT_NBR        =  :PC-2                        18110002
181200             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              18120002
181300     END-EXEC.                                                    18130002
181400                                                                  18140002
181500     EVALUATE TRUE                                                18150002
181600         WHEN SQLCODE = +0                                        18160002
181700             MOVE PV-2ND-UNITS  TO  ASC-2ND-UNITS                 18170002
181800         WHEN OTHER                                               18180002
181900             MOVE ZEROES        TO  ASC-2ND-UNITS                 18190002
182000     END-EVALUATE.                                                18200002
182100                                                                  18210002
182200     EXEC SQL                                                     18220002
182300          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18230002
182400            INTO  :PV-3RD-UNITS                                   18240002
182500            FROM  PCT_SUM_WRKD                                    18250002
182600           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18260002
182700             AND  BUS_DTE        <=  :DK-TO-DATE                  18270002
182800             AND  SHFT_NBR        =  :PC-3                        18280002
182900             AND  OPER_UNT_ID     =  :DK-OPER-UNT-ID              18290002
183000     END-EXEC.                                                    18300002
183100                                                                  18310002
183200     EVALUATE TRUE                                                18320002
183300         WHEN SQLCODE = +0                                        18330002
183400             MOVE PV-3RD-UNITS  TO  ASC-3RD-UNITS                 18340002
183500         WHEN OTHER                                               18350002
183600             MOVE ZEROES        TO  ASC-3RD-UNITS                 18360002
183700     END-EVALUATE.                                                18370002
183800                                                                  18380002
183900     INITIALIZE  PV-TOT-UNITS                                     18390002
184000                 PV-1ST-UNITS                                     18400002
184100                 PV-2ND-UNITS                                     18410002
184200                 PV-3RD-UNITS.                                    18420002
184300                                                                  18430002
184400     IF ASC-1ST-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18440058
184500         DIVIDE ASC-1ST-UNITS BY ASC-TOT-UNITS                    18450002
184600             GIVING PV-DIVIDEND ROUNDED                           18460042
184700         MULTIPLY PV-DIVIDEND BY 100                              18470002
184800             GIVING ASC-1ST-PCT                                   18480002
184900         IF ASC-1ST-PCT = ZERO                                    18490002
185000             MOVE .1    TO  ASC-1ST-PCT                           18500002
185100         END-IF                                                   18510002
185200     ELSE                                                         18520002
185300         MOVE ZEROS TO  ASC-1ST-PCT                               18530002
185400     END-IF.                                                      18540002
185500     IF ASC-2ND-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18550058
185600         DIVIDE ASC-2ND-UNITS BY ASC-TOT-UNITS                    18560002
185700             GIVING PV-DIVIDEND ROUNDED                           18570042
185800         MULTIPLY PV-DIVIDEND BY 100                              18580002
185900             GIVING ASC-2ND-PCT                                   18590002
186000         IF ASC-2ND-PCT = ZERO                                    18600002
186100             MOVE .1    TO  ASC-2ND-PCT                           18610002
186200         END-IF                                                   18620002
186300     ELSE                                                         18630002
186400         MOVE ZEROS TO  ASC-2ND-PCT                               18640002
186500     END-IF.                                                      18650002
186600     IF ASC-3RD-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18660058
186700         DIVIDE ASC-3RD-UNITS BY ASC-TOT-UNITS                    18670002
186800             GIVING PV-DIVIDEND ROUNDED                           18680042
186900         MULTIPLY PV-DIVIDEND BY 100                              18690002
187000             GIVING ASC-3RD-PCT                                   18700002
187100         IF ASC-3RD-PCT = ZERO                                    18710002
187200             MOVE .1 TO  ASC-3RD-PCT                              18720002
187300         END-IF                                                   18730002
187400     ELSE                                                         18740002
187500         MOVE ZEROS TO  ASC-3RD-PCT                               18750002
187600     END-IF.                                                      18760002
187700                                                                  18770002
187710*----------------------------------------------------------------*18771012
187720*    CALCULATE COMPANY TOTALS FOR SCREEN HEADER FIELDS.           18772012
187730*----------------------------------------------------------------*18773012
187740 4006-CALC-TOTAL-AMTS.                                            18774013
187750                                                                  18775012
187760     EXEC SQL                                                     18776012
187770          SELECT  DECIMAL(SUM(UNT_WRKD_QTY),11,0)                 18777012
187780            INTO  :PV-TOT-UNITS                                   18778012
187790            FROM  PCT_SUM_WRKD                                    18779012
187791           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18779112
187792             AND  BUS_DTE        <=  :DK-TO-DATE                  18779212
187794     END-EXEC.                                                    18779412
187795                                                                  18779512
187796     EVALUATE TRUE                                                18779612
187797         WHEN SQLCODE = +0                                        18779712
187798             MOVE PV-TOT-UNITS  TO  ASC-TOT-UNITS                 18779812
187799         WHEN OTHER                                               18779912
187800             MOVE ZEROES        TO  ASC-TOT-UNITS                 18780012
187801     END-EVALUATE.                                                18780112
187802                                                                  18780212
187803     EXEC SQL                                                     18780312
187804          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18780412
187805            INTO  :PV-1ST-UNITS                                   18780512
187806            FROM  PCT_SUM_WRKD                                    18780612
187807           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18780712
187808             AND  BUS_DTE        <=  :DK-TO-DATE                  18780812
187809             AND  SHFT_NBR        =  :PC-1                        18780912
187811     END-EXEC.                                                    18781112
187812                                                                  18781212
187813     EVALUATE TRUE                                                18781312
187814         WHEN SQLCODE = +0                                        18781412
187815             MOVE PV-1ST-UNITS  TO  ASC-1ST-UNITS                 18781512
187816         WHEN OTHER                                               18781612
187817             MOVE ZEROES        TO  ASC-1ST-UNITS                 18781712
187818     END-EVALUATE.                                                18781812
187819                                                                  18781912
187820     EXEC SQL                                                     18782012
187821          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18782112
187822            INTO  :PV-2ND-UNITS                                   18782212
187823            FROM  PCT_SUM_WRKD                                    18782312
187824           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18782412
187825             AND  BUS_DTE        <=  :DK-TO-DATE                  18782512
187826             AND  SHFT_NBR        =  :PC-2                        18782612
187828     END-EXEC.                                                    18782812
187829                                                                  18782912
187830     EVALUATE TRUE                                                18783012
187831         WHEN SQLCODE = +0                                        18783112
187832             MOVE PV-2ND-UNITS  TO  ASC-2ND-UNITS                 18783212
187833         WHEN OTHER                                               18783312
187834             MOVE ZEROES        TO  ASC-2ND-UNITS                 18783412
187835     END-EVALUATE.                                                18783512
187836                                                                  18783612
187837     EXEC SQL                                                     18783712
187838          SELECT  FLOAT (SUM(UNT_WRKD_QTY))                       18783812
187839            INTO  :PV-3RD-UNITS                                   18783912
187840            FROM  PCT_SUM_WRKD                                    18784012
187841           WHERE  BUS_DTE        >=  :DK-FROM-DATE                18784112
187842             AND  BUS_DTE        <=  :DK-TO-DATE                  18784212
187843             AND  SHFT_NBR        =  :PC-3                        18784312
187845     END-EXEC.                                                    18784512
187846                                                                  18784612
187847     EVALUATE TRUE                                                18784712
187848         WHEN SQLCODE = +0                                        18784812
187849             MOVE PV-3RD-UNITS  TO  ASC-3RD-UNITS                 18784912
187850         WHEN OTHER                                               18785012
187851             MOVE ZEROES        TO  ASC-3RD-UNITS                 18785112
187852     END-EVALUATE.                                                18785212
187853                                                                  18785312
187854     INITIALIZE  PV-TOT-UNITS                                     18785412
187855                 PV-1ST-UNITS                                     18785512
187856                 PV-2ND-UNITS                                     18785612
187857                 PV-3RD-UNITS.                                    18785712
187858                                                                  18785812
187859     IF ASC-1ST-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18785958
187860         DIVIDE ASC-1ST-UNITS BY ASC-TOT-UNITS                    18786012
187861             GIVING PV-DIVIDEND ROUNDED                           18786142
187862         MULTIPLY PV-DIVIDEND BY 100                              18786212
187863             GIVING ASC-1ST-PCT                                   18786312
187864         IF ASC-1ST-PCT = ZERO                                    18786412
187865             MOVE .1    TO  ASC-1ST-PCT                           18786512
187866         END-IF                                                   18786612
187867     ELSE                                                         18786712
187868         MOVE ZEROS TO  ASC-1ST-PCT                               18786812
187869     END-IF.                                                      18786912
187870     IF ASC-2ND-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18787058
187871         DIVIDE ASC-2ND-UNITS BY ASC-TOT-UNITS                    18787112
187872             GIVING PV-DIVIDEND ROUNDED                           18787242
187873         MULTIPLY PV-DIVIDEND BY 100                              18787312
187874             GIVING ASC-2ND-PCT                                   18787412
187875         IF ASC-2ND-PCT = ZERO                                    18787512
187876             MOVE .1    TO  ASC-2ND-PCT                           18787612
187877         END-IF                                                   18787712
187878     ELSE                                                         18787812
187879         MOVE ZEROS TO  ASC-2ND-PCT                               18787912
187880     END-IF.                                                      18788012
187881     IF ASC-3RD-UNITS > ZERO AND ASC-TOT-UNITS > ZERO             18788158
187882         DIVIDE ASC-3RD-UNITS BY ASC-TOT-UNITS                    18788212
187883             GIVING PV-DIVIDEND ROUNDED                           18788342
187884         MULTIPLY PV-DIVIDEND BY 100                              18788412
187885             GIVING ASC-3RD-PCT                                   18788512
187886         IF ASC-3RD-PCT = ZERO                                    18788612
187887             MOVE .1 TO  ASC-3RD-PCT                              18788712
187888         END-IF                                                   18788812
187889     ELSE                                                         18788912
187890         MOVE ZEROS TO  ASC-3RD-PCT                               18789012
187891     END-IF.                                                      18789112
187892                                                                  18789212
187893*----------------------------------------------------------------*18789312
187900*   GET WEEK INFORMATION FROM TDTATTR                             18790002
188000*----------------------------------------------------------------*18800002
188100 4007-GET-WEEK-INFO.                                              18810002
188200     EXEC SQL                                                     18820002
188300          SELECT DISTINCT (FSCL_WK_BEG_DTE)                       18830002
188400                 ,FSCL_WK_END_DTE                                 18840002
188500            INTO  :DTATTR-FSCL-WK-BEG-DTE                         18850002
188600                 ,:DTATTR-FSCL-WK-END-DTE                         18860002
188700            FROM  TDTATTR                                         18870002
188800           WHERE  FSCL_YR_NBR   =  :DK-FISCAL-YEAR                18880002
188900             AND  FSCL_WK_NBR   =  :DK-FISCAL-WK                  18890002
189000     END-EXEC.                                                    18900002
189100                                                                  18910002
189200     EVALUATE TRUE                                                18920002
189300         WHEN SQLCODE = +0                                        18930002
189400             MOVE DTATTR-FSCL-WK-BEG-DTE TO  DK-FROM-DATE         18940043
189600             MOVE DTATTR-FSCL-WK-END-DTE TO  DK-TO-DATE           18960043
189800         WHEN OTHER                                               18980002
189900             MOVE SPACES                 TO  ASC-FROM-DATE        18990002
190000                                             ASC-TO-DATE          19000002
190100                                             DK-FROM-DATE         19010002
190200                                             DK-TO-DATE           19020002
190300     END-EVALUATE.                                                19030002
190400                                                                  19040002
190500*----------------------------------------------------------------*19050002
190600*   GET MONTH INFORMATION FROM TDTATTR                            19060002
190700*----------------------------------------------------------------*19070002
190800 4008-GET-MONTH-INFO.                                             19080002
190900     EXEC SQL                                                     19090002
191000          SELECT DISTINCT (FSCL_MN_BEG_DTE)                       19100002
191100                 ,FSCL_MN_END_DTE                                 19110002
191200            INTO  :DTATTR-FSCL-MN-BEG-DTE                         19120002
191300                 ,:DTATTR-FSCL-MN-END-DTE                         19130002
191400            FROM  TDTATTR                                         19140002
191500           WHERE  FSCL_YR_NBR   =  :DK-FISCAL-YR                  19150002
191600             AND  FSCL_MN_NBR   =  :DK-FISCAL-MN                  19160002
191700     END-EXEC.                                                    19170002
191800                                                                  19180002
191900     EVALUATE TRUE                                                19190002
192000         WHEN SQLCODE = +0                                        19200002
192100             MOVE DTATTR-FSCL-MN-BEG-DTE TO  DK-FROM-DATE         19210043
192300             MOVE DTATTR-FSCL-MN-END-DTE TO  DK-TO-DATE           19230043
192500         WHEN OTHER                                               19250002
192600             MOVE SPACES                 TO  ASC-FROM-DATE        19260002
192700                                             ASC-TO-DATE          19270002
192800                                             DK-FROM-DATE         19280002
192900                                             DK-TO-DATE           19290002
193000     END-EVALUATE.                                                19300002
193100                                                                  19310002
193200*----------------------------------------------------------------*19320002
193300* OPEN THE CURSOR                                                 19330002
193400*----------------------------------------------------------------*19340002
193500 4010-OPEN-CURSOR.                                                19350002
193600     PERFORM                                                      19360002
193700         WITH TEST AFTER                                          19370002
193800         VARYING PV-RETRY-COUNTER                                 19380002
193900         FROM 1 BY 1                                              19390002
194000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19400002
194100                   OR (SQLCODE = ZERO))                           19410002
194200                                                                  19420002
194300         EVALUATE TRUE                                            19430012
194400             WHEN PS-PROCESS-GROUP-CSR                            19440012
194500                 EXEC SQL                                         19450012
194510                      OPEN PROCESS-GROUP-CSR                      19451012
194520                 END-EXEC                                         19452012
194530             WHEN PS-UK-OPER-GROUP-CSR                            19453012
194540                 EXEC SQL                                         19454012
194550                      OPEN UK-OPER-GROUP-CSR                      19455012
194560                 END-EXEC                                         19456012
194570         END-EVALUATE                                             19457012
194700                                                                  19470002
194800         EVALUATE TRUE                                            19480002
194900             WHEN SQLCODE = ZERO                                  19490002
195000             WHEN SQLCODE = -904                                  19500002
195100             WHEN SQLCODE = -913                                  19510002
195200                 CONTINUE                                         19520002
195300             WHEN SQLWARN0 NOT = SPACES                           19530002
195400             WHEN SQLCODE < ZERO                                  19540002
195500             WHEN SQLCODE > ZERO                                  19550002
195600                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       19560002
195700                 MOVE 'OPEN CURSOR PROBLEM    - '                 19570002
195800                                   TO DP013-MESSAGE-TEXT (1)      19580002
195900                 MOVE SQLCA        TO DP013-SQLCA                 19590002
196000                 MOVE 'PCT_PRC_AREA_ASSN' TO                      19600002
196100                                    DP013-DB2-TABLE-NAME (1)      19610002
196200                 SET DP013-DB2-ABEND                              19620002
196300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19630002
196400                 PERFORM DP013-0000-PROCESS-ABEND                 19640002
196500         END-EVALUATE                                             19650002
196600     END-PERFORM.                                                 19660002
196700*                                                                 19670002
196800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19680002
196900         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             19690002
197000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19700002
197100                                   TO DP013-MESSAGE-TEXT (1)      19710002
197200         MOVE SQLCA                TO DP013-SQLCA                 19720002
197300         MOVE 'PCT_PRC_AREA_ASSN'  TO DP013-DB2-TABLE-NAME (1)    19730002
197400         SET DP013-DB2-ABEND                                      19740002
197500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   19750002
197600         PERFORM DP013-0000-PROCESS-ABEND                         19760002
197700     END-IF.                                                      19770002
197800                                                                  19780002
197900*----------------------------------------------------------------*19790002
198000* CLOSE THE CURSOR.                                               19800002
198100*----------------------------------------------------------------*19810002
198200 4020-CLOSE-CURSOR.                                               19820002
198300                                                                  19830002
198400     EVALUATE TRUE                                                19840012
198500         WHEN PS-PROCESS-GROUP-CSR                                19850012
198600             EXEC SQL                                             19860012
198610                CLOSE PROCESS-GROUP-CSR                           19861012
198620             END-EXEC                                             19862012
198630         WHEN PS-UK-OPER-GROUP-CSR                                19863012
198640             EXEC SQL                                             19864012
198650                CLOSE UK-OPER-GROUP-CSR                           19865012
198660             END-EXEC                                             19866012
198670     END-EVALUATE                                                 19867012
198700                                                                  19870002
198800     EVALUATE TRUE                                                19880002
198900         WHEN SQLCODE = ZERO                                      19890002
199000         WHEN SQLCODE = +100                                      19900002
199100             CONTINUE                                             19910002
199200         WHEN SQLWARN0 NOT = SPACES                               19920002
199300         WHEN SQLCODE < ZERO                                      19930002
199400         WHEN SQLCODE > ZERO                                      19940002
199500             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          19950002
199600             MOVE 'CLOSE CURSOR PROBLEM   '                       19960002
199700                               TO DP013-MESSAGE-TEXT (1)          19970002
199800             MOVE SQLCA        TO DP013-SQLCA                     19980002
199900             MOVE 'PCT_PRC_AREA_ASSN' TO DP013-DB2-TABLE-NAME (1) 19990002
200000             SET DP013-DB2-ABEND                                  20000002
200100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20010002
200200             PERFORM DP013-0000-PROCESS-ABEND                     20020002
200300     END-EVALUATE.                                                20030002
200400                                                                  20040002
200410*----------------------------------------------------------------*20041012
200420*    PICK CORRECT CURSOR                                         *20042012
200430*----------------------------------------------------------------*20043012
200440 4100-PREPARE-CURSOR.                                             20044012
200450     MOVE SPACE TO PS-CURSOR-SW.                                  20045012
200460     IF ASC-OPER-NBR > ZERO                                       20046012
200470         MOVE ASC-OPER-NBR        TO DK-OPER-UNT-ID               20047037
200474         SET PS-PROCESS-GROUP-CSR TO TRUE                         20047444
200480     ELSE                                                         20048044
200490         SET PS-UK-OPER-GROUP-CSR TO TRUE                         20049044
200492     END-IF.                                                      20049244
200493                                                                  20049344
200500*----------------------------------------------------------------*20050002
200600* RETRIEVE REMAINING INFORMATION FROM PCT_SUM_WRKD                20060002
200700*----------------------------------------------------------------*20070002
200800 4200-GET-NEXT-CSR.                                               20080002
200900     INITIALIZE PV-1ST-UNITS                                      20090002
201000                PV-2ND-UNITS                                      20100002
201100                PV-3RD-UNITS                                      20110002
201200                PV-TOT-UNITS.                                     20120002
201300     PERFORM 4205-PREPARE-CURSOR.                                 20130012
201310     PERFORM 4210-OPEN-CURSOR.                                    20131012
201400     PERFORM 4220-READ-ITEMS-FROM-DB.                             20140002
201500     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            20150002
201600     PERFORM 4230-CLOSE-CURSOR.                                   20160002
201700                                                                  20170002
201710*----------------------------------------------------------------*20171012
201720*    SET UP THE CORRECT CURSOR.                                   20172012
201730*----------------------------------------------------------------*20173012
201740 4205-PREPARE-CURSOR.                                             20174012
201750     MOVE SPACE TO PS-CURSOR-SW2.                                 20175012
201760     IF ASC-OPER-NBR > ZERO                                       20176012
201771         IF DK-PROCESS-GROUP = 'MISC  '                           20177148
201772             SET PS-UNT-BY-OPR-MSC-CSR TO TRUE                    20177245
201780         ELSE                                                     20178044
201781             SET PS-UNITS-BY-OPER-CSR TO TRUE                     20178144
201782         END-IF                                                   20178244
201784     ELSE                                                         20178444
201785         IF DK-PROCESS-GROUP = 'MISC  '                           20178548
201790             SET PS-UNT-BY-GRP-MSC-CSR TO TRUE                    20179045
201791         ELSE                                                     20179144
201792             SET PS-UNITS-BY-GROUP-CSR TO TRUE                    20179244
201793         END-IF                                                   20179344
201794     END-IF.                                                      20179444
201795                                                                  20179544
201800*----------------------------------------------------------------*20180002
201900* OPEN THE CURSOR                                                 20190002
202000*   IN THIS PARTICULAR PARAGRAPH ONE CURSOR WILL BE               20200002
202100*   OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE             20210002
202200*   USER.                                                        *20220002
202300*----------------------------------------------------------------*20230002
202400 4210-OPEN-CURSOR.                                                20240002
202500     EVALUATE TRUE                                                20250012
202600         WHEN PS-UNITS-BY-OPER-CSR                                20260012
202700             EXEC SQL                                             20270012
202710                  OPEN UNITS-BY-OPER-CSR                          20271012
202720             END-EXEC                                             20272012
202730         WHEN PS-UNITS-BY-GROUP-CSR                               20273012
202740             EXEC SQL                                             20274012
202750                  OPEN UNITS-BY-GROUP-CSR                         20275012
202760             END-EXEC                                             20276012
202761         WHEN PS-UNT-BY-OPR-MSC-CSR                               20276145
202762             EXEC SQL                                             20276244
202763                  OPEN UNT-BY-OPR-MSC-CSR                         20276345
202764             END-EXEC                                             20276444
202765         WHEN PS-UNT-BY-GRP-MSC-CSR                               20276545
202766             EXEC SQL                                             20276644
202767                  OPEN UNT-BY-GRP-MSC-CSR                         20276745
202768             END-EXEC                                             20276844
202770     END-EVALUATE.                                                20277012
202800                                                                  20280002
202900     EVALUATE TRUE                                                20290002
203000         WHEN SQLCODE = ZERO                                      20300002
203100         WHEN SQLCODE = -904                                      20310002
203200         WHEN SQLCODE = -913                                      20320002
203300             CONTINUE                                             20330002
203400         WHEN SQLWARN0 NOT = SPACES                               20340002
203500         WHEN SQLCODE < ZERO                                      20350002
203600         WHEN SQLCODE > ZERO                                      20360002
203700             MOVE '4210-OPEN-CURSOR' TO DP013-PARAGRAPH           20370002
203800             MOVE 'OPEN CURSOR PROBLEM - '                        20380002
203900                               TO DP013-MESSAGE-TEXT (1)          20390002
204000             MOVE SQLCA        TO DP013-SQLCA                     20400002
204100             MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)      20410002
204200             SET DP013-DB2-ABEND                                  20420002
204300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20430002
204400             PERFORM DP013-0000-PROCESS-ABEND                     20440002
204500     END-EVALUATE.                                                20450002
204600*                                                                 20460002
204700*----------------------------------------------------------------*20470002
204800*    READ ITEMS FROM THE PCT_SUM_WRKD TABLE                       20480002
204900*----------------------------------------------------------------*20490002
205000 4220-READ-ITEMS-FROM-DB.                                         20500002
205100                                                                  20510002
205200     PERFORM                                                      20520002
205300         VARYING PV-READ-COUNT                                    20530002
205400         FROM 1 BY 1                                              20540002
205500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20550002
205600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20560002
205700                                                                  20570002
205800         PERFORM 4225-FETCH                                       20580002
205900                                                                  20590002
206000         IF  ASC-ITEMS-LEFT-ON-DB                                 20600002
206100             EVALUATE PCT00005-SHFT-NBR                           20610002
206200                 WHEN 1                                           20620002
206300                    MOVE PCT00005-UNT-WRKD-QTY TO PV-1ST-UNITS    20630002
206400                 WHEN 2                                           20640002
206500                    MOVE PCT00005-UNT-WRKD-QTY TO PV-2ND-UNITS    20650002
206600                 WHEN 3                                           20660002
206700                    MOVE PCT00005-UNT-WRKD-QTY TO PV-3RD-UNITS    20670002
206800             END-EVALUATE                                         20680002
206900             ADD  PCT00005-UNT-WRKD-QTY  TO  PV-TOT-UNITS         20690002
207000         END-IF                                                   20700002
207100     END-PERFORM.                                                 20710002
207200                                                                  20720002
207300*----------------------------------------------------------------*20730002
207400*    FETCH THE CURSOR                                             20740002
207500*----------------------------------------------------------------*20750002
207600 4225-FETCH.                                                      20760002
207610     EVALUATE TRUE                                                20761012
207620         WHEN PS-UNITS-BY-OPER-CSR                                20762012
207700             EXEC SQL                                             20770012
207800                 FETCH UNITS-BY-OPER-CSR                          20780012
207900                 INTO  :PCT00005-UNT-WRKD-QTY                     20790012
208000                      ,:PCT00005-SHFT-NBR                         20800012
208100                      ,:PCT00003-PRC-AREA-GP-CDE                  20810012
208200             END-EXEC                                             20820012
208210         WHEN PS-UNITS-BY-GROUP-CSR                               20821012
208211             EXEC SQL                                             20821112
208220                 FETCH UNITS-BY-GROUP-CSR                         20822012
208230                 INTO  :PCT00005-UNT-WRKD-QTY                     20823012
208240                      ,:PCT00005-SHFT-NBR                         20824012
208250                      ,:PCT00003-PRC-AREA-GP-CDE                  20825012
208260             END-EXEC                                             20826012
208261         WHEN PS-UNT-BY-OPR-MSC-CSR                               20826145
208262             EXEC SQL                                             20826244
208263                 FETCH UNT-BY-OPR-MSC-CSR                         20826345
208264                 INTO  :PCT00005-UNT-WRKD-QTY                     20826444
208265                      ,:PCT00005-SHFT-NBR                         20826544
208266                      ,:PCT00003-PRC-AREA-GP-CDE                  20826644
208267             END-EXEC                                             20826744
208268         WHEN PS-UNT-BY-GRP-MSC-CSR                               20826845
208269             EXEC SQL                                             20826944
208270                 FETCH UNT-BY-GRP-MSC-CSR                         20827045
208271                 INTO  :PCT00005-UNT-WRKD-QTY                     20827144
208272                      ,:PCT00005-SHFT-NBR                         20827244
208273                      ,:PCT00003-PRC-AREA-GP-CDE                  20827344
208274             END-EXEC                                             20827444
208280     END-EVALUATE.                                                20828044
208300                                                                  20830002
208400     EVALUATE TRUE                                                20840002
208500         WHEN SQLCODE = ZERO                                      20850002
208600         WHEN SQLCODE = +100                                      20860002
208700             CONTINUE                                             20870002
208800         WHEN SQLWARN0 NOT = SPACE                                20880002
208900         WHEN SQLCODE NOT = ZERO                                  20890002
209000              MOVE '4225-FETCH-CURSOR' TO DP013-PARAGRAPH         20900002
209100              MOVE 'FETCH CURSOR PROBLEM '                        20910002
209200                               TO DP013-MESSAGE-TEXT (1)          20920002
209300              MOVE SQLCA       TO DP013-SQLCA                     20930002
209400              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     20940002
209500              SET DP013-DB2-ABEND TO TRUE                         20950002
209600              PERFORM DP013-0000-PROCESS-ABEND                    20960002
209700     END-EVALUATE.                                                20970002
209800                                                                  20980002
209900     IF  SQLCODE EQUAL +100                                       20990002
210000         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      21000002
210100     END-IF.                                                      21010002
210200                                                                  21020002
210300*----------------------------------------------------------------*21030002
210400* CLOSE THE CURSOR.                                               21040002
210500*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *21050002
210600*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *21060002
210700*   USER.                                                        *21070002
210800*----------------------------------------------------------------*21080002
210900 4230-CLOSE-CURSOR.                                               21090002
211000     EVALUATE TRUE                                                21100012
211100         WHEN PS-UNITS-BY-OPER-CSR                                21110012
211200             EXEC SQL                                             21120012
211210                 CLOSE UNITS-BY-OPER-CSR                          21121012
211220             END-EXEC                                             21122012
211230         WHEN PS-UNITS-BY-GROUP-CSR                               21123012
211240             EXEC SQL                                             21124012
211250                 CLOSE UNITS-BY-GROUP-CSR                         21125012
211260             END-EXEC                                             21126012
211261         WHEN PS-UNT-BY-OPR-MSC-CSR                               21126145
211262             EXEC SQL                                             21126244
211263                 CLOSE UNT-BY-OPR-MSC-CSR                         21126345
211264             END-EXEC                                             21126444
211265         WHEN PS-UNT-BY-GRP-MSC-CSR                               21126547
211266             EXEC SQL                                             21126644
211267                 CLOSE UNT-BY-GRP-MSC-CSR                         21126747
211268             END-EXEC                                             21126844
211270     END-EVALUATE.                                                21127012
211300                                                                  21130002
211400     EVALUATE TRUE                                                21140002
211500         WHEN SQLCODE = ZERO                                      21150002
211600         WHEN SQLCODE = +100                                      21160002
211700             CONTINUE                                             21170002
211800         WHEN SQLWARN0 NOT = SPACES                               21180002
211900         WHEN SQLCODE < ZERO                                      21190002
212000         WHEN SQLCODE > ZERO                                      21200002
212100             MOVE '4230-CLOSE-CURSOR' TO DP013-PARAGRAPH          21210002
212200             MOVE 'CLOSE CURSOR PROBLEM   '                       21220002
212300                               TO DP013-MESSAGE-TEXT (1)          21230002
212400             MOVE SQLCA        TO DP013-SQLCA                     21240002
212500             MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)      21250002
212600             SET DP013-DB2-ABEND                                  21260002
212700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21270002
212800             PERFORM DP013-0000-PROCESS-ABEND                     21280002
212900     END-EVALUATE.                                                21290002
213000                                                                  21300002
213100*----------------------------------------------------------------*21310002
213200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21320002
213300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *21330002
213400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21340002
213500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21350002
213600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21360002
213700*                                                                *21370002
213800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21380002
213900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21390002
214000*    UPON INITIALIZATION.                                        *21400002
214100*----------------------------------------------------------------*21410002
214200 4300-READ-ITEMS-FROM-DB.                                         21420002
214300                                                                  21430002
214400     PERFORM                                                      21440002
214500         VARYING PV-READ-COUNT                                    21450002
214600         FROM 1 BY 1                                              21460002
214700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21470002
214800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21480002
214900                                                                  21490002
215000         PERFORM 4310-FETCH                                       21500002
215100                                                                  21510002
215200         IF  PV-TOT-UNITS NOT = ZEROS                             21520035
215300             IF  ASC-ITEMS-LEFT-ON-DB                             21530002
215400                 IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL            21540002
215500                     ADD +1            TO ASC-ITEM-SUB            21550002
215600                 ELSE                                             21560002
215700                     ADD +1            TO ASC-BLK-SUB             21570002
215800                     MOVE +1           TO ASC-ITEM-SUB            21580002
215900                                                                  21590002
216000                     IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY     21600002
216100                         MOVE +1       TO ASC-BLK-SUB             21610002
216200                         SET ASC-BLOCK-MODIFIED (1) TO TRUE       21620002
216300                         PERFORM 5100-WRITE-TEMP-STORAGE          21630002
216400                         MOVE ASC-BLOCK-ENTRIES                   21640002
216500                                         (PC-MAX-BLOCKS-IN-ARRAY) 21650002
216600                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21660002
216700                         ADD +1        TO ASC-BLK-SUB             21670002
216800                       INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB) 21680002
216900                         SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)  21690002
217000                                                          TO TRUE 21700002
217100                     END-IF                                       21710002
217200                 END-IF                                           21720002
217300                 ADD +1   TO ASC-NUMBER-OF-ITEMS-READ             21730002
217400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE      21740002
217500                 MOVE ASC-NUMBER-OF-ITEMS-READ                    21750002
217600                                   TO ASC-LIST-ITEM-NUMBER        21760002
217700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21770002
217800                 MOVE PCT00003-PRC-AREA-GP-CDE TO                 21780003
217900                             ASC-GROUP (ASC-BLK-SUB ASC-ITEM-SUB) 21790002
218000                 MOVE PV-1ST-UNITS                                21800002
218100                        TO ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)21810002
218200                 MOVE PV-2ND-UNITS                                21820002
218300                        TO ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)21830002
218400                 MOVE PV-3RD-UNITS                                21840002
218500                        TO ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)21850002
218600                 MOVE PV-TOT-UNITS                                21860002
218700                        TO ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)21870002
218800                 IF PV-1ST-UNITS > ZERO AND PV-TOT-UNITS > ZERO   21880058
218900                     DIVIDE PV-1ST-UNITS BY PV-TOT-UNITS          21890002
219000                         GIVING PV-DIVIDEND ROUNDED               21900042
219100                     MULTIPLY PV-DIVIDEND BY 100                  21910002
219200                         GIVING PV-1ST-PCT                        21920002
219300                     IF PV-1ST-PCT = ZERO                         21930002
219400                         MOVE .1     TO PV-1ST-PCT                21940002
219500                     END-IF                                       21950002
219600                 ELSE                                             21960002
219700                     MOVE ZEROES TO PV-1ST-UNITS                  21970002
219800                                    PV-1ST-PCT                    21980002
219900                 END-IF                                           21990002
220000                 IF PV-2ND-UNITS > ZERO AND PV-TOT-UNITS > ZERO   22000058
220100                     DIVIDE PV-2ND-UNITS BY PV-TOT-UNITS          22010002
220200                         GIVING PV-DIVIDEND ROUNDED               22020042
220300                     MULTIPLY PV-DIVIDEND BY 100                  22030002
220400                         GIVING PV-2ND-PCT                        22040002
220500                     IF PV-2ND-PCT = ZERO                         22050002
220600                         MOVE .1     TO PV-2ND-PCT                22060002
220700                     END-IF                                       22070002
220800                 ELSE                                             22080002
220900                     MOVE ZEROES TO PV-2ND-UNITS                  22090002
221000                                    PV-2ND-PCT                    22100002
221100                 END-IF                                           22110002
221200                 IF PV-3RD-UNITS > ZERO AND PV-TOT-UNITS > ZERO   22120058
221300                     DIVIDE PV-3RD-UNITS BY PV-TOT-UNITS          22130002
221400                         GIVING PV-DIVIDEND ROUNDED               22140042
221500                     MULTIPLY PV-DIVIDEND BY 100                  22150002
221600                         GIVING PV-3RD-PCT                        22160002
221700                     IF PV-3RD-PCT = ZERO                         22170002
221800                         MOVE .1     TO PV-3RD-PCT                22180002
221900                     END-IF                                       22190002
222000                 ELSE                                             22200002
222100                     MOVE ZEROES TO PV-3RD-UNITS                  22210002
222200                                    PV-3RD-PCT                    22220002
222300                 END-IF                                           22230002
222400                 IF PV-TOT-UNITS > ZERO AND ASC-TOT-UNITS > ZERO  22240058
222500                     DIVIDE PV-TOT-UNITS BY ASC-TOT-UNITS         22250002
222600                         GIVING PV-DIVIDEND ROUNDED               22260042
222700                     MULTIPLY PV-DIVIDEND BY 100                  22270002
222800                         GIVING PV-TOT-PCT                        22280002
222900                     IF PV-TOT-PCT = ZERO                         22290002
223000                         MOVE .1     TO PV-TOT-PCT                22300002
223100                     END-IF                                       22310002
223200                 ELSE                                             22320002
223300                     MOVE ZEROES TO PV-TOT-PCT                    22330002
223400                                    PV-TOT-UNITS                  22340002
223500                 END-IF                                           22350002
223600                 MOVE PV-1ST-PCT                                  22360002
223700                          TO ASC-1STPCT (ASC-BLK-SUB ASC-ITEM-SUB)22370002
223800                 MOVE PV-2ND-PCT                                  22380002
223900                          TO ASC-2NDPCT (ASC-BLK-SUB ASC-ITEM-SUB)22390002
224000                 MOVE PV-3RD-PCT                                  22400002
224100                          TO ASC-3RDPCT (ASC-BLK-SUB ASC-ITEM-SUB)22410002
224200                 MOVE PV-TOT-PCT                                  22420002
224300                          TO ASC-TOTPCT (ASC-BLK-SUB ASC-ITEM-SUB)22430002
224400             END-IF                                               22440002
224500         END-IF                                                   22450002
224600     END-PERFORM.                                                 22460002
224700                                                                  22470002
224800     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          22480002
224900         MOVE +1               TO ASC-BLK-SUB                     22490002
225000         PERFORM 5100-WRITE-TEMP-STORAGE                          22500002
225100         ADD +1                TO ASC-BLK-SUB                     22510002
225200         PERFORM 5100-WRITE-TEMP-STORAGE                          22520002
225300                                                                  22530002
225400         MOVE 1                TO ASC-BLK-SUB                     22540002
225500                                  PV-BLOCK-NUMBER                 22550002
225600         PERFORM 4410-READ-TEMP-STORAGE                           22560002
225700         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22570002
225800             MOVE 2            TO ASC-BLK-SUB                     22580002
225900                                  PV-BLOCK-NUMBER                 22590002
226000             PERFORM 4410-READ-TEMP-STORAGE                       22600002
226100         END-IF                                                   22610002
226200     END-IF.                                                      22620002
226300                                                                  22630002
226400*----------------------------------------------------------------*22640002
226500*    FETCH THE CURSOR                                             22650002
226600*----------------------------------------------------------------*22660002
226700 4310-FETCH.                                                      22670002
226800     EVALUATE TRUE                                                22680012
226900         WHEN PS-PROCESS-GROUP-CSR                                22690012
227000             EXEC SQL                                             22700012
227100                 FETCH PROCESS-GROUP-CSR                          22710012
227110                 INTO  :PCT00003-PRC-AREA-GP-CDE                  22711012
227120             END-EXEC                                             22712012
227130         WHEN PS-UK-OPER-GROUP-CSR                                22713012
227140             EXEC SQL                                             22714012
227150                 FETCH UK-OPER-GROUP-CSR                          22715012
227160                 INTO  :PCT00003-PRC-AREA-GP-CDE                  22716012
227170             END-EXEC                                             22717012
227180     END-EVALUATE.                                                22718012
227200                                                                  22720002
227300     EVALUATE TRUE                                                22730002
227400         WHEN SQLCODE = ZERO                                      22740002
227500              MOVE PCT00003-PRC-AREA-GP-CDE TO DK-PROCESS-GROUP   22750005
227600              PERFORM 4200-GET-NEXT-CSR                           22760002
227700         WHEN SQLCODE = +100                                      22770002
227800              CONTINUE                                            22780002
227900         WHEN SQLWARN0 NOT = SPACE                                22790002
228000         WHEN SQLCODE NOT = ZERO                                  22800002
228100              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         22810002
228200              MOVE 'FETCH CURSOR PROBLEM '                        22820002
228300                               TO DP013-MESSAGE-TEXT (1)          22830002
228400              MOVE SQLCA       TO DP013-SQLCA                     22840002
228500              MOVE 'PCT_PRC_AREA_ASSN' TO DP013-DB2-TABLE-NAME (1)22850002
228600              SET DP013-DB2-ABEND TO TRUE                         22860002
228700              PERFORM DP013-0000-PROCESS-ABEND                    22870002
228800     END-EVALUATE.                                                22880002
228900                                                                  22890002
229000     IF  SQLCODE EQUAL +100                                       22900002
229100         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      22910002
229200     END-IF.                                                      22920002
229300                                                                  22930002
229400*----------------------------------------------------------------*22940002
229500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *22950002
229600*----------------------------------------------------------------*22960002
229700 4400-MOVE-COMMAREA-TO-SCREEN.                                    22970002
229800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             22980002
229900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          22990002
230000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          23000002
230100             MOVE +1    TO ASC-BLK-SUB                            23010002
230200             PERFORM 5100-WRITE-TEMP-STORAGE                      23020002
230300             ADD +1     TO ASC-BLK-SUB                            23030002
230400             PERFORM 5100-WRITE-TEMP-STORAGE                      23040002
230500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23050002
230600                 GIVING PV-BLOCK-NUMBER                           23060002
230700                 REMAINDER PV-REMAINDER                           23070002
230800             IF  PV-REMAINDER > ZERO                              23080002
230900                 ADD +1 TO PV-BLOCK-NUMBER                        23090002
231000             END-IF                                               23100002
231100             MOVE +1    TO ASC-BLK-SUB                            23110002
231200             PERFORM 4410-READ-TEMP-STORAGE                       23120002
231300             ADD +1     TO ASC-BLK-SUB                            23130002
231400                           PV-BLOCK-NUMBER                        23140002
231500             PERFORM 4410-READ-TEMP-STORAGE                       23150002
231600     END-IF.                                                      23160002
231700     MOVE +1            TO ASC-BLK-SUB.                           23170002
231800     COMPUTE ASC-ITEM-SUB =                                       23180002
231900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23190002
232000         + PC-ITEMS-PER-PANEL).                                   23200002
232100*                                                                 23210002
232200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23220002
232300         ADD +1         TO ASC-BLK-SUB                            23230002
232400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23240002
232500     END-IF.                                                      23250002
232600*                                                                 23260002
232700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23270002
232800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23280002
232900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23290002
233000     PERFORM 4420-FORMAT-LIST-LINES                               23300002
233100         VARYING PV-SUB                                           23310002
233200         FROM PC-ITEMS-PER-PANEL BY -1                            23320002
233300         UNTIL PV-SUB < +1.                                       23330002
233400*                                                                 23340002
233500     COMPUTE ASC-ITEMS-DISPLAYED =                                23350002
233600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23360002
233700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23370002
233800                                      ASTRTITO.                   23380002
233900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23390002
234000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23400002
234100                                                                  23410002
235700     MOVE ASC-OPER-NBR         TO  AOPERO.                        23570002
235710     IF ASC-OPER-NBR = ZEROS                                      23571012
235720         MOVE 'CORPORATE SUMMARY'  TO  ADESCO                     23572012
235730     ELSE                                                         23573012
235740         MOVE ASC-OPER-DESC        TO  ADESCO                     23574012
235750     END-IF.                                                      23575012
235760     MOVE ASC-3RD-UNITS        TO  DK-NUMBER-FORMAT.              23576060
235770     MOVE DK-NUMBER-FORMAT     TO  A3TOTLO.                       23577060
235780     MOVE ASC-3RD-PCT          TO  DK-NUMBER.                     23578060
235790     MOVE DK-PERCENT-FORMAT    TO  A3PRCTO.                       23579060
235800     MOVE ASC-1ST-UNITS        TO  DK-NUMBER-FORMAT.              23580060
235900     MOVE DK-NUMBER-FORMAT     TO  A1TOTLO.                       23590060
236000     MOVE ASC-1ST-PCT          TO  DK-NUMBER.                     23600060
236100     MOVE DK-PERCENT-FORMAT    TO  A1PRCTO.                       23610060
236200     MOVE ASC-2ND-UNITS        TO  DK-NUMBER-FORMAT.              23620060
236300     MOVE DK-NUMBER-FORMAT     TO  A2TOTLO.                       23630060
236400     MOVE ASC-2ND-PCT          TO  DK-NUMBER.                     23640060
236500     MOVE DK-PERCENT-FORMAT    TO  A2PRCTO.                       23650060
236600     MOVE ASC-TOT-UNITS        TO  DK-NUMBER-FORMAT.              23660060
236700     MOVE DK-NUMBER-FORMAT     TO  ATTOTLO.                       23670060
236800     MOVE ASC-DISPLAY-DATE     TO  ADATEO.                        23680060
237000                                                                  23700002
237100     IF  DP020-MSG-NUMBER-X = SPACE                               23710002
237200         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23720002
237300*            --- MORE ITEMS TO DISPLAY ----                       23730002
237400             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23740002
237500             SET DP020-MSG-INFORMATIONAL TO TRUE                  23750002
237600         END-IF                                                   23760002
237700     END-IF.                                                      23770002
237800                                                                  23780002
237810     MOVE -1      TO MR-SELECTL (1).                              23781053
237820     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         23782053
237830     MOVE +1      TO ASTRTITL.                                    23783054
237900*----------------------------------------------------------------*23790002
238000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23800002
238100*----------------------------------------------------------------*23810002
238200 4410-READ-TEMP-STORAGE.                                          23820002
238300                                                                  23830002
238400     EXEC CICS                                                    23840002
238500         READQ TS                                                 23850002
238600             QUEUE (ASC-LIST-QUEUE-NAME)                          23860002
238700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23870002
238800             ITEM  (PV-BLOCK-NUMBER)                              23880002
238900             RESP  (PV-CICS-RESP)                                 23890002
239000     END-EXEC.                                                    23900002
239100                                                                  23910002
239200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23920002
239300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23930002
239400         CONTINUE                                                 23940002
239500     ELSE                                                         23950002
239600         SET DP013-CICS-ABEND     TO TRUE                         23960002
239700         SET DP013-NO-ROLLBACK    TO TRUE                         23970002
239800         MOVE '4410-READ-TEMP-STORAGE'                            23980002
239900                                  TO DP013-PARAGRAPH              23990002
240000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24000002
240100                                  TO DP013-MESSAGE-TEXT(1)        24010002
240200         PERFORM DP013-0000-PROCESS-ABEND                         24020002
240300     END-IF.                                                      24030002
240400                                                                  24040002
240500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24050002
240600*                                                                 24060002
240700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24070002
240800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24080002
240900     END-IF.                                                      24090002
241000                                                                  24100002
241100*----------------------------------------------------------------*24110002
241200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *24120002
241300*----------------------------------------------------------------*24130002
241400 4420-FORMAT-LIST-LINES.                                          24140002
241500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      24150002
241600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                24160002
241700         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           24170002
241800         MOVE DP015-HL-OFF       TO MR-SELECTH  (PV-SUB)          24180002
241900         MOVE SPACE              TO MR-SELECTI  (PV-SUB)          24190002
242000                                    MR-GROUP    (PV-SUB)          24200002
242100                                    MR-3RD-UNITS(PV-SUB)          24210002
242200                                    MR-3RD-PCT  (PV-SUB)          24220002
242300                                    MR-1ST-UNITS(PV-SUB)          24230002
242400                                    MR-1ST-PCT  (PV-SUB)          24240002
242500                                    MR-2ND-UNITS(PV-SUB)          24250002
242600                                    MR-2ND-PCT  (PV-SUB)          24260002
242700                                    MR-TOT-UNITS(PV-SUB)          24270002
242800                                    MR-TOT-PCT  (PV-SUB)          24280002
242900     ELSE                                                         24290002
243000         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24300002
243100                                                   > SPACE        24310002
243200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 24320002
243300                                 TO MR-SELECTI (PV-SUB)           24330002
243400         ELSE                                                     24340002
243500             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24350002
243600                                 TO MR-SELECTI (PV-SUB)           24360002
243700         END-IF                                                   24370002
243800         IF  DP030-SET-CURSOR-TRAILER                             24380002
243900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24390002
244000                 > SPACE)                                         24400002
244100               OR (PV-SUB = 1))                                   24410002
244200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24420002
244300                MOVE -1               TO ASTRTITL                 24430002
244400             END-IF                                               24440002
244500         END-IF                                                   24450002
244600*                                                                 24460002
244810         MOVE ASC-GROUP (ASC-BLK-SUB ASC-ITEM-SUB)                24481056
244820                                              TO MR-GROUP (PV-SUB)24482056
244900         IF ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           24490068
244910             MOVE ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         24491056
245000                                         TO MR-3RD-UNITS-P(PV-SUB)24500068
245001         ELSE                                                     24500156
245002            IF ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 99999999 24500268
245003                 MOVE ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24500368
245004                                         TO MR-3RD-UNITS-O(PV-SUB)24500468
245005            ELSE                                                  24500568
245010                 MOVE ASC-3RDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24501068
245020                                         TO MR-3RD-UNITS-N(PV-SUB)24502056
245030            END-IF                                                24503068
245040         END-IF                                                   24504068
245100         MOVE ASC-3RDPCT (ASC-BLK-SUB ASC-ITEM-SUB)               24510002
245200                                          TO MR-3RD-PCT-N (PV-SUB)24520002
245300         IF ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           24530068
245310             MOVE ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         24531056
245400                                         TO MR-1ST-UNITS-P(PV-SUB)24540068
245401         ELSE                                                     24540156
245402            IF ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 99999999 24540268
245403                 MOVE ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24540368
245404                                         TO MR-1ST-UNITS-O(PV-SUB)24540468
245405            ELSE                                                  24540568
245410                 MOVE ASC-1STUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24541068
245420                                         TO MR-1ST-UNITS-N(PV-SUB)24542056
245430            END-IF                                                24543068
245440         END-IF                                                   24544068
245500         MOVE ASC-1STPCT (ASC-BLK-SUB ASC-ITEM-SUB)               24550002
245600                                         TO MR-1ST-PCT-N  (PV-SUB)24560002
245700         IF ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           24570068
245710             MOVE ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         24571056
245800                                         TO MR-2ND-UNITS-P(PV-SUB)24580068
245802         ELSE                                                     24580256
245803            IF ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 99999999 24580368
245804                 MOVE ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24580468
245805                                         TO MR-2ND-UNITS-O(PV-SUB)24580568
245806            ELSE                                                  24580668
245810                 MOVE ASC-2NDUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24581068
245820                                         TO MR-2ND-UNITS-N(PV-SUB)24582056
245830            END-IF                                                24583068
245840         END-IF                                                   24584068
245900         MOVE ASC-2NDPCT (ASC-BLK-SUB ASC-ITEM-SUB)               24590002
246000                                         TO MR-2ND-PCT-N  (PV-SUB)24600002
246100         IF ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB) < 0           24610068
246110             MOVE ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)         24611057
246200                                         TO MR-TOT-UNITS-P(PV-SUB)24620068
246201         ELSE                                                     24620157
246202           IF ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 999999999 24620268
246203                 MOVE ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24620368
246204                                         TO MR-TOT-UNITS-O(PV-SUB)24620468
246205           ELSE                                                   24620568
246210                 MOVE ASC-TOTUNITS (ASC-BLK-SUB ASC-ITEM-SUB)     24621068
246220                                         TO MR-TOT-UNITS-N(PV-SUB)24622057
246230           END-IF                                                 24623068
246240         END-IF                                                   24624068
246300         MOVE ASC-TOTPCT (ASC-BLK-SUB ASC-ITEM-SUB)               24630002
246400                                         TO MR-TOT-PCT-N  (PV-SUB)24640002
246500     END-IF.                                                      24650057
246600     SUBTRACT +1 FROM ASC-ITEM-SUB                                24660002
246700     IF  ASC-ITEM-SUB < + 1                                       24670002
246800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24680002
246900         MOVE +1                 TO ASC-BLK-SUB                   24690002
247000     END-IF.                                                      24700002
247100                                                                  24710002
247200******************************************************************24720002
247300** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24730002
247400** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24740002
247500** ISSUE A WARNING.                                             **24750002
247600******************************************************************24760002
247700 4430-CHECK-FOR-BEGIN-AND-END.                                    24770002
247800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24780002
247900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24790002
248000*            -- NO END-OF-RANGE SPECFIED ---                      24800002
248100             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24810002
248200             SET DP020-MSG-WARNING TO TRUE                        24820002
248300             PERFORM 4431-POSITION-AT-WARNING                     24830002
248400         END-IF                                                   24840002
248500     ELSE                                                         24850002
248600         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24860002
248700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                24870002
248800             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            24880002
248900             SET DP020-MSG-WARNING TO TRUE                        24890002
249000             PERFORM 4431-POSITION-AT-WARNING                     24900002
249100         END-IF                                                   24910002
249200     END-IF.                                                      24920002
249300******************************************************************24930002
249400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **24940002
249500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **24950002
249600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **24960002
249700** POSITION THE CURSOR THERE.                                   **24970002
249800******************************************************************24980002
249900 4431-POSITION-AT-WARNING.                                        24990002
250000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25000002
250100                    - PV-TOP-ITEM + 1.                            25010002
250200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25020002
250300         CONTINUE                                                 25030002
250400     ELSE                                                         25040002
250500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25050002
250600         MOVE -1                    TO ASTRTITL                   25060002
250700     END-IF.                                                      25070002
250800*                                                                 25080002
250900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25090002
251000                    - PV-TOP-ITEM + 1.                            25100002
251100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25110002
251200         CONTINUE                                                 25120002
251300     ELSE                                                         25130002
251400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25140002
251500         MOVE -1                   TO ASTRTITL                    25150002
251600     END-IF.                                                      25160002
251700                                                                  25170002
251800*----------------------------------------------------------------*25180002
251900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *25190002
252000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *25200002
252100* FOR THE SELECTED ITEMS QUEUE.                                  *25210002
252200*                                                                *25220002
252300* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *25230002
252400* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *25240002
252500* THE ARRAY IS FULL.                                             *25250002
252600*----------------------------------------------------------------*25260002
252700 5000-PREPARE-SEL-QUEUE.                                          25270002
252800                                                                  25280002
252900     MOVE +1                   TO  ASC-BLK-SUB.                   25290002
253000     PERFORM 5100-WRITE-TEMP-STORAGE.                             25300002
253100     ADD +1                    TO  ASC-BLK-SUB.                   25310002
253200     PERFORM 5100-WRITE-TEMP-STORAGE.                             25320002
253300                                                                  25330002
253400     MOVE ASC-SEL-QUEUE-NAME   TO  PC214-SEL-QUEUE-NAME.          25340002
253500     PERFORM 6010-DELETE-SEL-QUEUE.                               25350002
253600                                                                  25360002
253700     SET ASC-UPDATE-TSQ        TO  TRUE.                          25370002
253800                                                                  25380002
253900     SET PC215-IDX             TO  1.                             25390002
254000     MOVE ZERO                 TO PC214-NUMBER-OF-TS-ITEMS.       25400002
254100     INITIALIZE PC215-SELECTED-ITEM-ARRAY.                        25410002
254200                                                                  25420002
254300     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25430002
254400             VARYING PV-ITEM                                      25440002
254500             FROM 1 BY 1                                          25450002
254600             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25460002
254700                                                                  25470002
254800     IF  PC215-IDX > 1                                            25480002
254900         PERFORM 5205-WRITE-SEL-QUEUE                             25490002
255000         ADD +1                TO PC214-NUMBER-OF-TS-ITEMS        25500002
255100     END-IF.                                                      25510002
255200*----------------------------------------------------------------*25520002
255300*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25530002
255400*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25540002
255500*----------------------------------------------------------------*25550002
255600 5100-WRITE-TEMP-STORAGE.                                         25560002
255700     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25570002
255800                                   TO PV-LIST-ITEM-NUMBER.        25580002
255900     COMPUTE PV-BLOCK-NUMBER =                                    25590002
256000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25600002
256100                                                                  25610002
256200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25620002
256300     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25630002
256400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25640002
256500             PERFORM 5105-REWRITE-ASC-LISTQ                       25650002
256600         END-IF                                                   25660002
256700     ELSE                                                         25670002
256800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25680002
256900         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25690002
257000         PERFORM 5110-WRITE-ASC-LISTQ                             25700002
257100         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25710002
257200     END-IF.                                                      25720002
257300                                                                  25730002
257400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25740002
257500                                                                  25750002
257600******************************************************************25760002
257700** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25770002
257800** SPECIFIC COMMAREA.                                           **25780002
257900******************************************************************25790002
258000 5105-REWRITE-ASC-LISTQ.                                          25800002
258100     EXEC CICS                                                    25810002
258200         WRITEQ TS                                                25820002
258300             QUEUE (ASC-LIST-QUEUE-NAME)                          25830002
258400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25840002
258500             ITEM  (PV-BLOCK-NUMBER)                              25850002
258600             REWRITE                                              25860002
258700             RESP  (PV-CICS-RESP)                                 25870002
258800     END-EXEC.                                                    25880002
258900                                                                  25890002
259000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           25900002
259100         CONTINUE                                                 25910002
259200     ELSE                                                         25920002
259300         SET DP013-CICS-ABEND            TO TRUE                  25930002
259400         SET DP013-NO-ROLLBACK           TO TRUE                  25940002
259500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       25950002
259600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     25960002
259700                                         TO DP013-MESSAGE-TEXT(1) 25970002
259800         PERFORM DP013-0000-PROCESS-ABEND                         25980002
259900     END-IF.                                                      25990002
260000                                                                  26000002
260100******************************************************************26010002
260200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26020002
260300** SPECIFIC COMMAREA.                                           **26030002
260400******************************************************************26040002
260500 5110-WRITE-ASC-LISTQ.                                            26050002
260600     EXEC CICS                                                    26060002
260700         WRITEQ TS                                                26070002
260800             QUEUE (ASC-LIST-QUEUE-NAME)                          26080002
260900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26090002
261000             ITEM  (PV-BLOCK-NUMBER)                              26100002
261100             RESP  (PV-CICS-RESP)                                 26110002
261200     END-EXEC.                                                    26120002
261300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26130002
261400         SET DP013-CICS-ABEND      TO TRUE                        26140002
261500         SET DP013-NO-ROLLBACK     TO TRUE                        26150002
261600         MOVE '5110-WRITE-ASC-LISTQ'                              26160002
261700                                   TO DP013-PARAGRAPH             26170002
261800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           26180002
261900                                   TO DP013-MESSAGE-TEXT(1)       26190002
262000         PERFORM DP013-0000-PROCESS-ABEND                         26200002
262100     END-IF.                                                      26210002
262200                                                                  26220002
262300*----------------------------------------------------------------*26230002
262400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *26240002
262500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26250002
262600*----------------------------------------------------------------*26260002
262700 5200-FILL-SEL-QUEUE-RECORD.                                      26270002
262800                                                                  26280002
262900     PERFORM 6112-READ-LIST-QUEUE.                                26290002
263000                                                                  26300002
263100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26310002
263200         PERFORM                                                  26320002
263300         VARYING LQW-IDX                                          26330002
263400         FROM 1 BY 1                                              26340002
263500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26350002
263600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26360002
263700                                                                  26370002
263800             IF  LQW-SELECT (LQW-IDX)                             26380002
263900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              26390002
264000                                   TO PC215-ITEM (PC215-IDX)      26400002
264100                 MOVE SPACE        TO PC215-ACTION-SW (PC215-IDX) 26410002
264200                                                                  26420002
264300                 MOVE LQW-GROUP (LQW-IDX)                         26430002
264400                                        TO PC215-GROUP (PC215-IDX)26440002
264500                 MOVE LQW-3RD-UNITS (LQW-IDX)                     26450002
264600                                   TO PC215-3RD-UNITS (PC215-IDX) 26460002
264700                 MOVE LQW-3RD-PCT (LQW-IDX)                       26470002
264800                                     TO PC215-3RD-PCT (PC215-IDX) 26480002
264900                 MOVE LQW-1ST-UNITS (LQW-IDX)                     26490002
265000                                   TO PC215-1ST-UNITS (PC215-IDX) 26500002
265100                 MOVE LQW-1ST-PCT (LQW-IDX)                       26510002
265200                                     TO PC215-1ST-PCT (PC215-IDX) 26520002
265300                 MOVE LQW-2ND-UNITS (LQW-IDX)                     26530002
265400                                   TO PC215-2ND-UNITS (PC215-IDX) 26540002
265500                 MOVE LQW-2ND-PCT (LQW-IDX)                       26550002
265600                                     TO PC215-2ND-PCT (PC215-IDX) 26560002
265700                 MOVE LQW-TOT-UNITS (LQW-IDX)                     26570002
265800                                   TO PC215-TOT-UNITS (PC215-IDX) 26580002
265900                 MOVE LQW-TOT-PCT (LQW-IDX)                       26590002
266000                                     TO PC215-TOT-PCT (PC215-IDX) 26600002
266100                 SET PC215-IDX UP BY 1                            26610002
266200                 IF  PC215-IDX > PC215-MAX-ITEMS                  26620002
266300                     PERFORM 5205-WRITE-SEL-QUEUE                 26630002
266400                     ADD +1        TO PC214-NUMBER-OF-TS-ITEMS    26640002
266500                     INITIALIZE PC215-SELECTED-ITEM-ARRAY         26650002
266600                     SET PC215-IDX TO  1                          26660002
266700                 END-IF                                           26670002
266800             END-IF                                               26680002
266900         END-PERFORM                                              26690002
267000     END-IF.                                                      26700002
267100                                                                  26710002
267200*----------------------------------------------------------------*26720002
267300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *26730002
267400*----------------------------------------------------------------*26740002
267500 5205-WRITE-SEL-QUEUE.                                            26750002
267600                                                                  26760002
267700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26770002
267800                                   TO PC215-SELECTED-ITEMS.       26780002
267900                                                                  26790002
268000     EXEC CICS                                                    26800002
268100          WRITEQ TS                                               26810002
268200              QUEUE (ASC-SEL-QUEUE-NAME)                          26820002
268300              FROM  (PC215-SELECT-RECORD)                         26830002
268400              ITEM  (PV-SEL-QUEUE-ITEM)                           26840002
268500              RESP  (PV-CICS-RESP)                                26850002
268600     END-EXEC.                                                    26860002
268700                                                                  26870002
268800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26880002
268900         CONTINUE                                                 26890002
269000     ELSE                                                         26900002
269100         SET DP013-CICS-ABEND      TO TRUE                        26910002
269200         SET DP013-NO-ROLLBACK     TO TRUE                        26920002
269300         MOVE '5205-WRITE-SEL-QUEUE'                              26930002
269400                                   TO DP013-PARAGRAPH             26940002
269500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          26950002
269600                                   TO DP013-MESSAGE-TEXT(1)       26960002
269700         PERFORM DP013-0000-PROCESS-ABEND                         26970002
269800     END-IF.                                                      26980002
269900******************************************************************26990002
270000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27000002
270100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27010002
270200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27020002
270300** THE USER.                                                    **27030002
270400******************************************************************27040002
270500 6000-REFRESH-PANEL-FROM-TEMP.                                    27050002
270600     IF  ASC-UPDATE-TSQ                                           27060002
270700         SET ASC-NO-TSQ-UPDATE TO TRUE                            27070002
270800         MOVE ZERO                 TO PV-SAVE-ITEM                27080002
270900                                      PV-SEL-QUEUE-ITEM           27090002
271000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27100002
271100                                   TO PV-HOLD-SELECTED-ITEMS      27110002
271200         MOVE +1                   TO PV-ITEMS-PROCESSED          27120002
271300         PERFORM 6100-UPDATE-TSQ                                  27130002
271400             UNTIL PV-ITEMS-PROCESSED >                           27140002
271500                                     PV-HOLD-SELECTED-ITEMS       27150002
271510         PERFORM 6010-DELETE-SEL-QUEUE                            27151011
271600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27160002
271700                    ASC-BLOCK-ENTRIES (2)                         27170002
271800     END-IF.                                                      27180002
271900                                                                  27190002
272000*----------------------------------------------------------------*27200002
272100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27210002
272200*----------------------------------------------------------------*27220002
272300 6010-DELETE-SEL-QUEUE.                                           27230002
272400                                                                  27240002
272500     EXEC CICS                                                    27250002
272600         DELETEQ TS                                               27260002
272700             QUEUE (ASC-SEL-QUEUE-NAME)                           27270002
272800             RESP  (PV-CICS-RESP)                                 27280002
272900     END-EXEC.                                                    27290002
273000*                                                                 27300002
273100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      27310002
273200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         27320002
273300         CONTINUE                                                 27330002
273400     ELSE                                                         27340002
273500         SET DP013-CICS-ABEND TO TRUE                             27350002
273600         SET DP013-NO-ROLLBACK TO TRUE                            27360002
273700         MOVE '6010-DELETE-SEL-QUEUE'                             27370002
273800                        TO DP013-PARAGRAPH                        27380002
273900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         27390002
274000                        TO DP013-MESSAGE-TEXT (1)                 27400002
274100         PERFORM DP013-0000-PROCESS-ABEND                         27410002
274200     END-IF.                                                      27420002
274300                                                                  27430002
274400*----------------------------------------------------------------*27440002
274500*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *27450002
274600*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *27460002
274700*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *27470002
274800*    THE TEMP QUEUE.                                             *27480002
274900*----------------------------------------------------------------*27490002
275000 6100-UPDATE-TSQ.                                                 27500002
275100                                                                  27510002
275200     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             27520002
275300     PERFORM 6150-READ-SEL-QUEUE.                                 27530002
275400     PERFORM                                                      27540002
275500         VARYING PC215-IDX                                        27550002
275600         FROM 1 BY 1                                              27560002
275700         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     27570002
275800         OR (PC215-IDX GREATER THAN PC215-MAX-ITEMS))             27580002
275900         IF  PC215-ACTION-SW (PC215-IDX) > SPACE                  27590002
276000             PERFORM 6110-PROCESS-ITEMS                           27600002
276100         END-IF                                                   27610002
276200         ADD +1                TO PV-ITEMS-PROCESSED              27620002
276300     END-PERFORM.                                                 27630002
276400     PERFORM 6111-WRITE-LIST-QUEUE.                               27640002
276500                                                                  27650002
276600*----------------------------------------------------------------*27660002
276700*    READ THE LIST QUEUE RECORD.                                 *27670002
276800*----------------------------------------------------------------*27680002
276900 6150-READ-SEL-QUEUE.                                             27690002
277000                                                                  27700002
277100     EXEC CICS                                                    27710002
277200          READQ TS                                                27720002
277300              QUEUE (ASC-SEL-QUEUE-NAME)                          27730002
277400              INTO  (PC215-SELECT-RECORD)                         27740002
277500              ITEM  (PV-SEL-QUEUE-ITEM)                           27750002
277600              RESP  (PV-CICS-RESP)                                27760002
277700     END-EXEC.                                                    27770002
277800*                                                                 27780002
277900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27790002
278000         CONTINUE                                                 27800002
278100     ELSE                                                         27810002
278200         SET DP013-CICS-ABEND      TO  TRUE                       27820002
278300         SET DP013-NO-ROLLBACK     TO  TRUE                       27830002
278400         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           27840002
278500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           27850002
278600                                   TO  DP013-MESSAGE-TEXT(1)      27860002
278700         PERFORM DP013-0000-PROCESS-ABEND                         27870002
278800     END-IF.                                                      27880002
278900                                                                  27890002
279000*----------------------------------------------------------------*27900002
279100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*27910002
279200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*27920002
279300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *27930002
279400*----------------------------------------------------------------*27940002
279500 6110-PROCESS-ITEMS.                                              27950002
279600                                                                  27960002
279700     COMPUTE PV-ITEM = 1 + ((PC215-ITEM (PC215-IDX) - 1)          27970002
279800                     / PC-ITEMS-PER-PANEL).                       27980002
279900                                                                  27990002
280000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28000002
280100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28010002
280200             PERFORM 6111-WRITE-LIST-QUEUE                        28020002
280300         END-IF                                                   28030002
280400         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28040002
280500                                                                  28050002
280600         PERFORM 6112-READ-LIST-QUEUE                             28060002
280700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28070002
280800             CONTINUE                                             28080002
280900         END-IF                                                   28090002
281000     END-IF.                                                      28100002
281100                                                                  28110002
281200     COMPUTE PV-SUB = (PC215-ITEM (PC215-IDX)                     28120002
281300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28130002
281400     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28140002
281500     MOVE LQW-SELECTED-SW (PV-SUB)                                28150002
281600                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28160002
281700                                                                  28170002
281800     EVALUATE TRUE                                                28180002
281900         WHEN PC215-INQ (PC215-IDX)                               28190002
282000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28200002
282100                                                                  28210002
282200         WHEN PC215-UPD (PC215-IDX)                               28220002
282300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28230002
282400                                                                  28240002
282500         WHEN PC215-DEL (PC215-IDX)                               28250002
282600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28260002
282700                                                                  28270002
282800         WHEN PC215-ERR (PC215-IDX)                               28280002
282900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28290002
283000     END-EVALUATE.                                                28300002
283100                                                                  28310002
283200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28320002
283300                                                                  28330002
283400*----------------------------------------------------------------*28340002
283500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28350002
283600*----------------------------------------------------------------*28360002
283700 6111-WRITE-LIST-QUEUE.                                           28370002
283800                                                                  28380002
283900     EXEC CICS                                                    28390002
284000         WRITEQ TS                                                28400002
284100             QUEUE (ASC-LIST-QUEUE-NAME)                          28410002
284200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     28420002
284300             ITEM  (PV-SAVE-ITEM)                                 28430002
284400             REWRITE                                              28440002
284500             RESP  (PV-CICS-RESP)                                 28450002
284600     END-EXEC.                                                    28460002
284700*                                                                 28470002
284800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28480002
284900         CONTINUE                                                 28490002
285000     ELSE                                                         28500002
285100         SET DP013-CICS-ABEND  TO  TRUE                           28510002
285200         SET DP013-NO-ROLLBACK TO  TRUE                           28520002
285300         MOVE '6111-WRITE-LIST-QUEUE'                             28530002
285400                               TO  DP013-PARAGRAPH                28540002
285500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  28550002
285600                               TO  DP013-MESSAGE-TEXT(1)          28560002
285700         PERFORM DP013-0000-PROCESS-ABEND                         28570002
285800     END-IF.                                                      28580002
285900                                                                  28590002
286000*----------------------------------------------------------------*28600002
286100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*28610002
286200*----------------------------------------------------------------*28620002
286300 6112-READ-LIST-QUEUE.                                            28630002
286400                                                                  28640002
286500     EXEC CICS                                                    28650002
286600         READQ TS                                                 28660002
286700             QUEUE (ASC-LIST-QUEUE-NAME)                          28670002
286800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     28680002
286900             ITEM  (PV-ITEM)                                      28690002
287000             RESP  (PV-CICS-RESP)                                 28700002
287100     END-EXEC.                                                    28710002
287200*                                                                 28720002
287300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28730002
287400         CONTINUE                                                 28740002
287500     ELSE                                                         28750002
287600         SET DP013-CICS-ABEND        TO TRUE                      28760002
287700         SET DP013-NO-ROLLBACK       TO TRUE                      28770002
287800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           28780002
287900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    28790002
288000                                     TO DP013-MESSAGE-TEXT(1)     28800002
288100         PERFORM DP013-0000-PROCESS-ABEND                         28810002
288200     END-IF.                                                      28820002
288300                                                                  28830002
288400*-----------------------------------------------------------------28840002
288500*  READ THE LIST QUEUE RECORD                                     28850002
288600*-----------------------------------------------------------------28860002
288700 9100-READ-SEL-QUEUE.                                             28870002
288800                                                                  28880002
288900     EXEC CICS                                                    28890002
289000         READQ TS                                                 28900002
289100             QUEUE (ASC-SEL-QUEUE-NAME)                           28910002
289200             INTO  (PC215-SELECT-RECORD)                          28920002
289300             ITEM  (ASC-SEL-ITEM)                                 28930002
289400             RESP  (PV-CICS-RESP)                                 28940002
289500     END-EXEC.                                                    28950002
289600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        28960002
289700         CONTINUE                                                 28970002
289800     ELSE                                                         28980002
289900         SET DP013-LOGIC-ABEND                                    28990002
290000             DP013-NO-ROLLBACK   TO   TRUE                        29000002
290100         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          29010002
290200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   29020002
290300                                 TO   DP013-MESSAGE-TEXT (1)      29030002
290400         PERFORM DP013-0000-PROCESS-ABEND                         29040002
290500     END-IF.                                                      29050002
290600                                                                  29060002
290700*-----------------------------------------------------------------29070002
290800* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *29080002
290900*-----------------------------------------------------------------29090002
291000 9200-REWRITE-SEL-QUEUE.                                          29100002
291100                                                                  29110002
291200     EXEC CICS                                                    29120002
291300          WRITEQ TS                                               29130002
291400              QUEUE  (ASC-SEL-QUEUE-NAME)                         29140002
291500              FROM   (PC215-SELECT-RECORD)                        29150002
291600              ITEM   (ASC-SEL-ITEM)                               29160002
291700              RESP   (PV-CICS-RESP)                               29170002
291800              REWRITE                                             29180002
291900     END-EXEC.                                                    29190002
292000                                                                  29200002
292100     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   29210002
292200         SET DP013-CICS-ABEND                                     29220002
292300             DP013-NO-ROLLBACK     TO TRUE                        29230002
292400         MOVE '9200-REWRITE-SEL-QUEUE'                            29240002
292500                                   TO DP013-PARAGRAPH             29250002
292600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   29260002
292700                                   TO DP013-MESSAGE-TEXT (1)      29270002
292800         PERFORM DP013-0000-PROCESS-ABEND                         29280002
292900     END-IF.                                                      29290002
293000                                                                  29300002
293100*----------------------------------------------------------------*29310002
293200*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *29320002
293300*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *29330002
293400*----------------------------------------------------------------*29340002
293500 9900-SOFT-ABORT.                                                 29350002
293600                                                                  29360002
293700     EXEC CICS SYNCPOINT                                          29370002
293800          ROLLBACK                                                29380002
293900     END-EXEC.                                                    29390002
294000                                                                  29400002
294100     SET  PS-ERROR                                                29410002
294200          PS-SOFT-ABORT-ERROR                                     29420002
294300          DP020-MSG-FATAL       TO  TRUE.                         29430002
294400                                                                  29440002
294500*----------------------------------------------------------------*29450002
294600*    ABEND PROCESSOR MODULE                                      *29460002
294700*----------------------------------------------------------------*29470002
294800                                                                  29480002
294900     COPY DPPD013.                                                29490002
