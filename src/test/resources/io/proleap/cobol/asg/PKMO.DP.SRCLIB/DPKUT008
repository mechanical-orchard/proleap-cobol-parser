000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      DPKUT008.                                       00040000
000500 AUTHOR.          D.MEDORA, CAP GEMINI AMERICA.                   00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    AUGUST 17, 1988.                                00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*             THIS PROGRAM USES COMBINES A LIST OF ALL JOBNAMES   00100000
001100*             TAKEN FROM PKMO.JOBLIB AND A FILE CONTAINING THE JOB00110000
001200*             DESCRIPTION TO CREATE THE JOB NAME CROSS REFERENCE  00120000
001300*             FILE THAT WILL BE USED TO LOAD THE DBII JOB TABLE.  00130000
001400*                                                                 00140000
001500* 10/10/90  IR#P1010005 ONE OF THE INPUT FILES HAD THE JOB NAME   00150000
001600*           AND DESC. SHIFTED.  THIS WAS CHANGED TO LOOK FOR THE  00160000
001700*           MATCHING JOB NAME IN THE PROPER COLUMN.  JAN NEWQUIST 00170000
001800                                                                  00180000
001900                                                                  00190000
002000*************************                                         00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200*************************                                         00220000
002300 CONFIGURATION SECTION.                                           00230000
002400 SOURCE-COMPUTER. IBM-3090.                                       00240000
002500 OBJECT-COMPUTER. IBM-3090.                                       00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800 FILE-CONTROL.                                                    00280000
002900     SELECT JOBNAME-INPUT-FILE         ASSIGN TO INP01.           00290000
003000     SELECT JOBNAME-DESC-FILE          ASSIGN TO INP02.           00300000
003100     SELECT JOBNAME-XREF-FILE          ASSIGN TO OUT01.           00310000
003200     EJECT                                                        00320000
003300***************                                                   00330000
003400 DATA DIVISION.                                                   00340000
003500***************                                                   00350000
003600 FILE SECTION.                                                    00360000
003700 FD  JOBNAME-INPUT-FILE                                           00370000
003800                         BLOCK CONTAINS 0 RECORDS                 00380000
003900                         RECORD CONTAINS 8 CHARACTERS             00390006
004000                         LABEL RECORDS ARE STANDARD               00400000
004100                         RECORDING MODE F                         00410000
004200                         DATA RECORD IS JOBNAME-INPUT-RECORD.     00420000
004300 01  JOBNAME-INPUT-RECORD        PIC X(8).                        00430000
004400                                                                  00440000
004500                                                                  00450000
004600 FD  JOBNAME-DESC-FILE                                            00460000
004700                         BLOCK CONTAINS 0 RECORDS                 00470000
004800                         RECORD CONTAINS 81 CHARACTERS            00480000
004900                         LABEL RECORDS ARE STANDARD               00490000
005000                         RECORDING MODE F                         00500000
005100                         DATA RECORD IS JOBNAME-DESC-RECORD.      00510000
005200 01  JOBNAME-DESC-RECORD         PIC X(81).                       00520000
005300                                                                  00530000
005400                                                                  00540000
005500 FD  JOBNAME-XREF-FILE                                            00550000
005600                         BLOCK CONTAINS 0 RECORDS                 00560000
005700                         RECORD CONTAINS 60 CHARACTERS            00570000
005800                         LABEL RECORDS ARE STANDARD               00580000
005900                         RECORDING MODE F                         00590000
006000                         DATA RECORD IS JOBNAME-XREF-RECORD.      00600000
006100 01  JOBNAME-XREF-RECORD         PIC X(60).                       00610000
006200     EJECT                                                        00620000
006300 WORKING-STORAGE SECTION.                                         00630000
006400                                                                  00640000
006500**   JOBNAME INPUT FILE LAYOUT (INPUT)    **                      00650000
006600                                                                  00660000
006700 01  JI-JOBNAME-INPUT-RECORD.                                     00670000
006800     05  JI-JOBNAME              PIC X(8)      VALUE SPACES.      00680000
007000                                                                  00700000
007100                                                                  00710000
007200**   JOBNAME DESCRIPTION FILE LAYOUT (INPUT)  **                  00720000
007300                                                                  00730000
007400 01  JD-JOBNAME-DESC-RECORD.                                      00740000
007500     05  FILLER                  PIC X(1)       VALUE SPACES.     00750000
007600     05  JD-JOBNAME              PIC X(8)       VALUE SPACES.     00760000
007700     05  FILLER                  PIC X(3)       VALUE SPACES.     00770007
007800     05  JD-DESCRIPTION          PIC X(50)      VALUE SPACES.     00780000
007900     05  FILLER                  PIC X(19)      VALUE SPACES.     00790007
008000                                                                  00800000
008100                                                                  00810000
008200**   JOBNAME CROSS REFERENCE FILE LAYOUT (OUTPUT)  **             00820000
008300                                                                  00830000
008400 01  JX-JOBNAME-XREF-RECORD.                                      00840000
008500     05  JX-JOBNAME              PIC X(8)       VALUE SPACES.     00850000
008600     05  JX-DESCRIPTION          PIC X(50)      VALUE SPACES.     00860000
008700     05  JX-TYPE-CODE            PIC X(1)       VALUE SPACES.     00870000
008710         88  JX-TC-BATCH                        VALUE 'B'.        00871000
008800     05  JX-FREQUENCY-CODE       PIC X(1)       VALUE SPACES.     00880000
008900                                                                  00890000
009000 01  PS-PROGRAM-SWITCHES.                                         00900000
009300     05  PS-EOF-JOBNAME-INPUT    PIC X(1)       VALUE 'N'.        00930000
009400         88  EOF-JOBNAME-INPUT                  VALUE 'Y'.        00940000
009500     05  PS-EOF-JOBNAME-DESC     PIC X(1)       VALUE 'N'.        00950000
009600         88  EOF-JOBNAME-DESC                   VALUE 'Y'.        00960000
009700                                                                  00970000
010400 01  PC-PROGRAM-CONSTANTS.                                        01040000
010410     05  PC-CURRENT-PROGRAM-NAME PIC X(8)       VALUE 'DPKUT008'. 01041000
010411                                                                  01041100
010412 01  PV-PROGRAM-VARIABLES.                                        01041200
010440     05  PV-DESCRIPTION.                                          01044000
010450         10  PV-DESCRIPTION-CHAR OCCURS 50 TIMES                  01045000
010460                                 INDEXED BY PV-DESC-INDEX         01046000
010470                                 PIC X(1).                        01047000
010500                                                                  01050000
010600 01  AT-ALPHABET-TABLE.                                           01060000
010700     05  AT-ALPHABET-FIELDS.                                      01070000
010800****>> THE FOLLOWING "LOWER CASE" FIELDS HAVE HEXADECIMAL VALUES  01080000
010900****>> THAT ARE ONLY SEEN IN TSO.                                 01090000
011000         10  AT-LOWER-CASE-A     PIC X(1)       VALUE 'a'.        01100000
011100         10  AT-UPPER-CASE-A     PIC X(1)       VALUE 'A'.        01110000
011200         10  AT-LOWER-CASE-B     PIC X(1)       VALUE 'b'.        01120000
011300         10  AT-UPPER-CASE-B     PIC X(1)       VALUE 'B'.        01130000
011400         10  AT-LOWER-CASE-C     PIC X(1)       VALUE 'c'.        01140000
011500         10  AT-UPPER-CASE-C     PIC X(1)       VALUE 'C'.        01150000
011600         10  AT-LOWER-CASE-D     PIC X(1)       VALUE 'd'.        01160000
011700         10  AT-UPPER-CASE-D     PIC X(1)       VALUE 'D'.        01170000
011800         10  AT-LOWER-CASE-E     PIC X(1)       VALUE 'e'.        01180000
011900         10  AT-UPPER-CASE-E     PIC X(1)       VALUE 'E'.        01190000
012000         10  AT-LOWER-CASE-F     PIC X(1)       VALUE 'f'.        01200000
012100         10  AT-UPPER-CASE-F     PIC X(1)       VALUE 'F'.        01210000
012200         10  AT-LOWER-CASE-G     PIC X(1)       VALUE 'g'.        01220000
012300         10  AT-UPPER-CASE-G     PIC X(1)       VALUE 'G'.        01230000
012400         10  AT-LOWER-CASE-H     PIC X(1)       VALUE 'h'.        01240000
012500         10  AT-UPPER-CASE-H     PIC X(1)       VALUE 'H'.        01250000
012600         10  AT-LOWER-CASE-I     PIC X(1)       VALUE 'i'.        01260000
012700         10  AT-UPPER-CASE-I     PIC X(1)       VALUE 'I'.        01270000
012800         10  AT-LOWER-CASE-J     PIC X(1)       VALUE 'j'.        01280000
012900         10  AT-UPPER-CASE-J     PIC X(1)       VALUE 'J'.        01290000
013000         10  AT-LOWER-CASE-K     PIC X(1)       VALUE 'k'.        01300000
013100         10  AT-UPPER-CASE-K     PIC X(1)       VALUE 'K'.        01310000
013200         10  AT-LOWER-CASE-L     PIC X(1)       VALUE 'l'.        01320000
013300         10  AT-UPPER-CASE-L     PIC X(1)       VALUE 'L'.        01330000
013400         10  AT-LOWER-CASE-M     PIC X(1)       VALUE 'm'.        01340000
013500         10  AT-UPPER-CASE-M     PIC X(1)       VALUE 'M'.        01350000
013600         10  AT-LOWER-CASE-N     PIC X(1)       VALUE 'n'.        01360000
013700         10  AT-UPPER-CASE-N     PIC X(1)       VALUE 'N'.        01370000
013800         10  AT-LOWER-CASE-O     PIC X(1)       VALUE 'o'.        01380000
013900         10  AT-UPPER-CASE-O     PIC X(1)       VALUE 'O'.        01390000
014000         10  AT-LOWER-CASE-P     PIC X(1)       VALUE 'p'.        01400000
014100         10  AT-UPPER-CASE-P     PIC X(1)       VALUE 'P'.        01410000
014200         10  AT-LOWER-CASE-Q     PIC X(1)       VALUE 'q'.        01420000
014300         10  AT-UPPER-CASE-Q     PIC X(1)       VALUE 'Q'.        01430000
014400         10  AT-LOWER-CASE-R     PIC X(1)       VALUE 'r'.        01440000
014500         10  AT-UPPER-CASE-R     PIC X(1)       VALUE 'R'.        01450000
014600         10  AT-LOWER-CASE-S     PIC X(1)       VALUE 's'.        01460000
014700         10  AT-UPPER-CASE-S     PIC X(1)       VALUE 'S'.        01470000
014800         10  AT-LOWER-CASE-T     PIC X(1)       VALUE 't'.        01480000
014900         10  AT-UPPER-CASE-T     PIC X(1)       VALUE 'T'.        01490000
015000         10  AT-LOWER-CASE-U     PIC X(1)       VALUE 'u'.        01500000
015100         10  AT-UPPER-CASE-U     PIC X(1)       VALUE 'U'.        01510000
015200         10  AT-LOWER-CASE-V     PIC X(1)       VALUE 'v'.        01520000
015300         10  AT-UPPER-CASE-V     PIC X(1)       VALUE 'V'.        01530000
015400         10  AT-LOWER-CASE-W     PIC X(1)       VALUE 'w'.        01540000
015500         10  AT-UPPER-CASE-W     PIC X(1)       VALUE 'W'.        01550000
015600         10  AT-LOWER-CASE-X     PIC X(1)       VALUE 'x'.        01560000
015700         10  AT-UPPER-CASE-X     PIC X(1)       VALUE 'X'.        01570000
015800         10  AT-LOWER-CASE-Y     PIC X(1)       VALUE 'y'.        01580000
015900         10  AT-UPPER-CASE-Y     PIC X(1)       VALUE 'Y'.        01590000
016000         10  AT-LOWER-CASE-Z     PIC X(1)       VALUE 'z'.        01600000
016100         10  AT-UPPER-CASE-Z     PIC X(1)       VALUE 'Z'.        01610000
016200     05  AT-ALPHABET-TBL  REDEFINES  AT-ALPHABET-FIELDS.          01620000
016300         10  AT-ALPHA-TBL-CHARS  OCCURS  26  TIMES                01630000
016400                                 ASCENDING KEY AT-LOWER-CASE-CHAR 01640000
016500                                 INDEXED BY AT-INDEX.             01650000
016600             15  AT-LOWER-CASE-CHAR                               01660000
016700                                 PIC X(1).                        01670000
016800             15  AT-UPPER-CASE-CHAR                               01680000
016900                                 PIC X(1).                        01690000
017000                                                                  01700000
017200********************                                              01720000
017300 PROCEDURE DIVISION.                                              01730000
017400********************                                              01740000
017500                                                                  01750000
017700     OPEN INPUT  JOBNAME-INPUT-FILE                               01770000
017800                 JOBNAME-DESC-FILE                                01780000
017900          OUTPUT JOBNAME-XREF-FILE.                               01790000
018000                                                                  01800000
018200     PERFORM 9100-READ-JOBNAME-INPUT-FILE.                        01820000
018500     PERFORM 9200-READ-JOBNAME-DESC-FILE.                         01850000
018700                                                                  01870000
018800     PERFORM 1000-MATCH-FILES                                     01880000
018900         UNTIL ((EOF-JOBNAME-INPUT)                               01890000
019000                 AND (EOF-JOBNAME-DESC)).                         01900000
019200                                                                  01920000
019300     CLOSE       JOBNAME-INPUT-FILE                               01930000
019400                 JOBNAME-DESC-FILE                                01940000
019500                 JOBNAME-XREF-FILE.                               01950000
019700                                                                  01970000
019900     GOBACK.                                                      01990000
020200                                                                  02020000
020300******************************************************************02030000
020900 1000-MATCH-FILES.                                                02090000
021500                                                                  02150000
021600     IF JI-JOBNAME = JD-JOBNAME                                   02160000
021700         MOVE JD-DESCRIPTION TO PV-DESCRIPTION                    02170000
021800         PERFORM 8000-CONVERT-LOWER-CASE                          02180000
021900             VARYING PV-DESC-INDEX FROM 1 BY 1                    02190000
022000             UNTIL PV-DESC-INDEX > LENGTH OF PV-DESCRIPTION       02200000
022100         MOVE JI-JOBNAME       TO JX-JOBNAME                      02210000
022200         MOVE PV-DESCRIPTION   TO JX-DESCRIPTION                  02220000
022300         SET JX-TC-BATCH       TO TRUE                            02230000
022400         MOVE SPACES           TO JX-FREQUENCY-CODE               02240000
022500         PERFORM 9300-WRITE-JOBNAME-XREF-FILE                     02250000
022600         PERFORM 9100-READ-JOBNAME-INPUT-FILE                     02260000
022700         PERFORM 9200-READ-JOBNAME-DESC-FILE                      02270000
022800     ELSE                                                         02280000
022900         IF JI-JOBNAME < JD-JOBNAME                               02290000
023000             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - JOB NAME '      02300000
023001                       'WITH NO DESCRIPTION RECORD - '            02300100
023002                       JI-JOBNAME                                 02300200
023100             MOVE JI-JOBNAME   TO JX-JOBNAME                      02310000
023200             MOVE SPACES       TO JX-DESCRIPTION                  02320000
023300             SET JX-TC-BATCH   TO TRUE                            02330000
023400             MOVE SPACES       TO JX-FREQUENCY-CODE               02340000
023500             PERFORM 9300-WRITE-JOBNAME-XREF-FILE                 02350000
023600             PERFORM 9100-READ-JOBNAME-INPUT-FILE                 02360000
023700         ELSE                                                     02370000
023710             IF JI-JOBNAME > JD-JOBNAME                           02371000
023810                  DISPLAY PC-CURRENT-PROGRAM-NAME  ' - DESCRIPT'  02381000
023900                           'ION WITH NO JOB NAME RECORD - '       02390000
024000                            JD-JOBNAME                            02400000
024100                  PERFORM 9200-READ-JOBNAME-DESC-FILE             02410000
024300             END-IF                                               02430000
024400         END-IF                                                   02440000
024500     END-IF.                                                      02450000
024600                                                                  02460000
024700*1000-EXIT.                                                       02470000
025000                                                                  02500000
025100******************************************************************02510000
025500 8000-CONVERT-LOWER-CASE.                                         02550000
025600                                                                  02560000
025700     IF ((PV-DESCRIPTION-CHAR (PV-DESC-INDEX) < AT-LOWER-CASE-A)  02570000
026000             OR (PV-DESCRIPTION-CHAR (PV-DESC-INDEX) >            02600000
026100                                          AT-LOWER-CASE-Z))       02610000
026200         NEXT SENTENCE                                            02620000
026300     ELSE                                                         02630000
026400         SEARCH ALL AT-ALPHA-TBL-CHARS                            02640000
026500             AT END                                               02650000
026600                 MOVE SPACES TO                                   02660000
026610                           PV-DESCRIPTION-CHAR (PV-DESC-INDEX)    02661000
026700             WHEN AT-LOWER-CASE-CHAR (AT-INDEX) =                 02670000
026800                              PV-DESCRIPTION-CHAR (PV-DESC-INDEX) 02680000
026900                 MOVE AT-UPPER-CASE-CHAR (AT-INDEX) TO            02690000
026910                           PV-DESCRIPTION-CHAR (PV-DESC-INDEX)    02691000
027100         END-SEARCH                                               02710000
027200     END-IF.                                                      02720000
027400*8000-EXIT.                                                       02740000
027600                                                                  02760000
027610******************************************************************02761000
027700 9100-READ-JOBNAME-INPUT-FILE.                                    02770000
027800                                                                  02780000
027900     READ JOBNAME-INPUT-FILE       INTO JI-JOBNAME-INPUT-RECORD   02790000
028000         AT END                                                   02800000
028100             MOVE HIGH-VALUES      TO JI-JOBNAME                  02810000
028200             SET EOF-JOBNAME-INPUT TO TRUE                        02820000
028300     END-READ.                                                    02830000
028700*9100-EXIT.                                                       02870000
029100                                                                  02910000
029110******************************************************************02911000
029200 9200-READ-JOBNAME-DESC-FILE.                                     02920000
029300                                                                  02930000
029400     READ JOBNAME-DESC-FILE       INTO JD-JOBNAME-DESC-RECORD     02940000
029500         AT END                                                   02950000
029600             MOVE HIGH-VALUES     TO JD-JOBNAME                   02960000
029700             SET EOF-JOBNAME-DESC TO TRUE                         02970000
029800     END-READ.                                                    02980000
030200*9200-EXIT.                                                       03020000
030600                                                                  03060000
030610******************************************************************03061000
030700 9300-WRITE-JOBNAME-XREF-FILE.                                    03070000
030800                                                                  03080000
030900     WRITE JOBNAME-XREF-RECORD  FROM  JX-JOBNAME-XREF-RECORD.     03090000
031100*9300-EXIT.                                                       03110000
