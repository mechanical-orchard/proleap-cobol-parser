000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS598.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JUNE, 2002.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S598 - OUTBOUND MANIFESTED CARTONS - PO LINE LIST          * 00100000
001100*---------------------------------------------------------------* 00110000
001110*                                                               * 00111000
001120* CHANGE HISTORY:                                               * 00112000
001130* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES         * 00113000
001140* ------- ---------- ----------- -------------------------------- 00114000
001150* WR38216 04-26-2010 C. TWIEHAUS  EFC1-2 TRANSFERS              * 00115000
001151*         10-26-2010 EKTA AGRAWAL IMPORT REPLENISHMENT 2010     * 00115100
001152          CHANGES ARE TAGGED AS TKMAV49                           00115200
001160*---------------------------------------------------------------* 00116000
001170* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00117024
001180* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00118025
001190* MAKING THE CALL DYNAMIC VS STATIC.                              00119025
001192*                                                                 00119224
001193* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00119324
001194* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00119424
001195*---------------------------------------------------------------* 00119523
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-LINE-NBR                    PIC S9(09)  VALUE ZERO    00170000
001800                                                    COMP.         00180000
001900     05  DK-PO-NBR                      PIC S9(09)  VALUE ZERO    00190000
002000                                                    COMP.         00200000
002100     05  DK-REC-SEQ-NBR                 PIC S9(09)  VALUE ZERO    00210000
002200                                                    COMP.         00220000
002300     05  DK-DEFAULT-BEGIN               PIC S9(09)  VALUE ZERO    00230000
002400                                                    COMP.         00240000
002500     05  DK-DEFAULT-END-LINE            PIC S9(09)  VALUE 9999999 00250000
002600                                                    COMP.         00260000
002700     05  DK-DEFAULT-END-STR             PIC S9(09)  VALUE 9999    00270000
002800                                                    COMP.         00280000
002900     05  DK-LINE-BEGIN                  PIC S9(09)  VALUE ZERO    00290000
003000                                                    COMP.         00300000
003100     05  DK-LINE-END                    PIC S9(09)  VALUE ZERO    00310000
003200                                                    COMP.         00320000
003300     05  DK-STR-BEGIN                   PIC S9(04)  VALUE ZERO    00330000
003400                                                    COMP.         00340000
003500     05  DK-STR-END                     PIC S9(04)  VALUE ZERO    00350000
003600                                                    COMP.         00360000
003601* JAK 09/2009 WR37075 START                                       00360100
003610     05  DK-CNSTK-REQ-PL-NBR            PIC S9(09)  VALUE ZERO    00361000
003620                                                    COMP.         00362000
003630* JAK 09/2009 WR37075 END                                         00363000
003640* DMH 11/23/11 - BEGIN                                            00364006
003650     05  DK-FAST-TRAN-NBR               PIC S9(10)  VALUE ZERO    00365006
003660                                                    COMP.         00366006
003670* DMH 11/23/11 - END                                              00367006
003700     05  DK-TRLR-SRL-NBR                PIC S9(09)  COMP.         00370000
003800     05  DK-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00380000
003900     05  DK-BARCODE                     PIC  X(22) VALUE SPACES.  00390000
004000     05  DK-BARCODE-R REDEFINES DK-BARCODE.                       00400000
004100         10  DK-BARCODE-1-2             PIC  9(02).               00410000
004200         10  DK-BARCODE-3-20            PIC  9(18).               00420000
004300         10  DK-BARCODE-21-22           PIC  X(02).               00430000
004400     05  DK-KOHLS-BARCODE.                                        00440000
004500         10   FILLER                    PIC X(02)  VALUE '00'.    00450000
004600         10   DK-KOHLS-18               PIC X(18)  VALUE SPACES.  00460000
004700         10   FILLER                    PIC X(02)  VALUE SPACES.  00470000
004800     05  DK-KOHLS-BRCDE REDEFINES DK-KOHLS-BARCODE                00480000
004900                                        PIC X(22).                00490000
005000     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00500000
005100                                                    COMP.         00510000
005200     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00520000
005300                                                    COMP.         00530000
005400     05  DK-PO-TRN-NBR                  PIC 9(09) VALUE ZEROES.   00540000
005500     05  DK-TRN-NBR-N REDEFINES DK-PO-TRN-NBR.                    00550000
005600         10  DK-TRN-NBR-X               PIC X(09).                00560000
005700     05  DK-TRN-NBR-9.                                            00570000
005800         10  FILLER                       PIC X(01) VALUE SPACES. 00580000
005900         10  DK-TRN-NBR-8                 PIC X(08) VALUE SPACES. 00590000
006000                                                                  00600000
006100     05  DK-PO-RCVR-NBR-N                 PIC 9(09) VALUE ZEROES. 00610000
006200     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00620000
006300         10  DK-RCVR-NBR-X                PIC X(09).              00630000
006400     05  DK-RCVR-NBR-9.                                           00640000
006500         10  FILLER                       PIC X(06) VALUE SPACES. 00650000
006600         10  DK-RCVR-NBR-3                PIC X(03) VALUE SPACES. 00660000
006700     05  DK-RCVR-NBR-4A.                                          00670000
006800         10  FILLER                       PIC X(05) VALUE ZEROES. 00680000
006900         10  DK-RCVR-NBR-40               PIC X(04) VALUE ZEROES. 00690000
007000                                                                  00700000
007100     05  DK-PO-RCVR.                                              00710000
007200         10  DK-TRN-NBR                   PIC X(08) VALUE SPACES. 00720000
007300         10  FILLER                       PIC X(01) VALUE '-'.    00730000
007400         10  DK-RCVR-NBR                  PIC X(03) VALUE SPACES. 00740000
007500                                                                  00750000
007600     05  DK-PO-RCVR-4.                                            00760000
007700         10  DK-TRN-NBR-4                 PIC X(08) VALUE SPACES. 00770000
007800         10  FILLER                       PIC X(01) VALUE '-'.    00780000
007900         10  DK-RCVR-NBR-4                PIC X(04) VALUE SPACES. 00790000
008000                                                                  00800000
008100     05  DK-TMST.                                                 00810000
008200         10  DK-YEAR                      PIC X(04) VALUE SPACES. 00820000
008300         10  FILLER                       PIC X(01) VALUE SPACES. 00830000
008400         10  DK-MONTH                     PIC X(02) VALUE SPACES. 00840000
008500         10  FILLER                       PIC X(01) VALUE SPACES. 00850000
008600         10  DK-DAY                       PIC X(02) VALUE SPACES. 00860000
008700         10  FILLER                       PIC X(01) VALUE SPACES. 00870000
008800         10  DK-HOUR                      PIC X(02) VALUE SPACES. 00880000
008900         10  FILLER                       PIC X(01) VALUE SPACES. 00890000
009000         10  DK-MINUTE                    PIC X(02) VALUE SPACES. 00900000
009100         10  FILLER                       PIC X(10) VALUE SPACES. 00910000
009200     05  DK-DISPLAY-DATE.                                         00920000
009300         10  DK-DIS-MM                    PIC X(02) VALUE SPACES. 00930000
009400         10  FILLER                       PIC X(01) VALUE '/'.    00940000
009500         10  DK-DIS-DD                    PIC X(02) VALUE SPACES. 00950000
009600         10  FILLER                       PIC X(01) VALUE '/'.    00960000
009700         10  DK-DIS-YY                    PIC X(04) VALUE SPACES. 00970000
009800     05  DK-DISPLAY-TIME.                                         00980000
009900         10  DK-DIS-HH                    PIC X(02) VALUE SPACES. 00990000
010000         10  FILLER                       PIC X(01) VALUE ':'.    01000000
010100         10  DK-DIS-MN                    PIC X(02) VALUE SPACES. 01010000
010200                                                                  01020000
010300 01  PC-PROGRAM-CONSTANTS.                                        01030000
010400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU598A  '.  01040000
010500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM598'.   01050000
010600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS598'.  01060000
010700     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           01070000
010800     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           01080000
010900                                                                  01090000
011000     05  PC-INTER-APPL-CODES.                                     01100000
011100         10  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.     01110000
011200         10  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.     01120000
011300                                                                  01130000
011400                                                                  01140000
011500     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +09          01150000
011600                                               COMP SYNC.         01160000
011700     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           01170000
011800                                               COMP SYNC.         01180000
011900     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     01190000
012000                                               COMP-3.            01200000
012100     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           01210000
012200                                               COMP SYNC.         01220000
012300     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            01230000
012400                                               COMP-3.            01240000
012500     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       01250000
012600     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       01260000
012700     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       01270000
012800     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       01280000
012900     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         01290000
013000     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       01300000
013100                                               COMP.              01310000
013200     05  PC-01                     PIC  X(02)  VALUE '01'.        01320000
013300     05  PC-A                      PIC  X(01)  VALUE 'A'.         01330000
013400     05  PC-INNER-PREPACK          PIC  X(06)  VALUE 'INPRPK'.    01340000
013500     05  PC-MULTI-SKU              PIC  X(06)  VALUE 'MLTSKU'.    01350000
013600     05  PC-SINGLE-SKU             PIC  X(06)  VALUE 'SGLSKU'.    01360000
013700     05  PC-CASEPACK               PIC  X(06)  VALUE 'CASEPK'.    01370000
013800     05  PC-BULK                   PIC  X(06)  VALUE 'BULK  '.    01380000
013900     05  PC-MANUAL                 PIC  X(07)  VALUE 'MANUAL '.   01390000
014000     05  PC-FCS-P2L                PIC  X(07)  VALUE 'FCS&P2L'.   01400000
014100     05  PC-P2L                    PIC  X(07)  VALUE 'P2L    '.   01410000
014200     05  PC-FCSE                   PIC  X(07)  VALUE 'FCSE   '.   01420000
014300*                                                                 01430000
014400*----------------------------------------------------------------*01440000
014500*  SYSTEM MESSAGES                                               *01450000
014600*----------------------------------------------------------------*01460000
014700*   00005 = INVALID VALUE                                        *01470000
014800*   00008 = MUST BE NUMERIC                                      *01480000
014900*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01490000
015000*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01500000
015100*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01510000
015200*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01520000
015300*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01530000
015400*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01540000
015500*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01550000
015600*   00069 - TOP OF LIST                                          *01560000
015700*   00070 - BOTTOM OF LIST                                       *01570000
015800*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01580000
015900*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01590000
016000*   00279 - MORE ITEMS TO DISPLAY                                *01600000
016100*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *01610000
016200*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01620000
016300*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01630000
016400*   03138 = AN ERROR OCCURRED DETERMINING F-KEY ELIGIBILITY - CONT01640000
016500*   99901 = INVALID COMMAND WAS ENTERED                          *01650000
016600*----------------------------------------------------------------*01660000
016700     05  PC-TSYMSG-NUMBERS.                                       01670000
016800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01680000
016900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01690000
017000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01700000
017100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01710000
017200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01720000
017300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01730000
017400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01740000
017500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01750000
017600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01760000
017700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01770000
017800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01780000
017900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01790000
018000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01800000
018100         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01810000
018200         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01820000
018300         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01830000
018400         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01840000
018500         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01850000
018600         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01860000
018700         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01870000
018800         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01880000
018900*                                                                 01890000
019000 01  PS-PROGRAM-SWITCHES.                                         01900000
019100     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01910000
019200         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01920000
019300         88  PS-BLOCK-ERROR                         VALUE 'N'.    01930000
019400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01940000
019500         88  PS-NO-ERROR                            VALUE 'Y'.    01950000
019600         88  PS-ERROR                               VALUE 'N'.    01960000
019700     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01970000
019800         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01980000
019900         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01990000
020000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02000000
020100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02010000
020200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02020000
020300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02030000
020400         88  PS-DONE                                VALUE 'Y'.    02040000
020500         88  PS-NOT-DONE                            VALUE 'N'.    02050000
020600     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   02060000
020700         88  PS-LIST-END                            VALUE  'Y'.   02070000
020800         88  PS-NO-LIST-END                         VALUE  'N'.   02080000
020900     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   02090000
021000         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   02100000
021100         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   02110000
021200     05  PS-TDISTHD-SW                  PIC  X      VALUE  'N'.   02120000
021300         88  PS-TDISTHD-FOUND                       VALUE  'Y'.   02130000
021400         88  PS-NO-TDISTHD-FOUND                    VALUE  'N'.   02140000
021500*                                                                 02150000
021600 01  PV-PROGRAM-VARIABLES.                                        02160000
021700     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02170000
021800                                                     COMP SYNC.   02180000
021900     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02190000
022000     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02200000
022100     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 02210000
022200     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02220000
022300                                        COMP SYNC.                02230000
022400     05  PV-SUB                         PIC S9(04)  VALUE +0      02240000
022500                                                    COMP SYNC.    02250000
022600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02260000
022700                                                    COMP SYNC.    02270000
022800     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02280000
022900                                                    COMP-3.       02290000
023000     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02300000
023100                                                    COMP-3.       02310000
023200     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02320000
023300                                                    COMP-3.       02330000
023301* JAK 09/2009 WR37075 START                                       02330100
023310     05  PV-ACTL-DISTRB-QTY             PIC S9(09)  VALUE +0      02331000
023320                                                    COMP-3.       02332000
023330     05  PV-REQ-ORD-QTY                 PIC S9(09)  VALUE +0      02333000
023340                                                    COMP-3.       02334000
023350* JAK 09/2009 WR37075 END                                         02335000
023400     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02340000
023500                                                    COMP-3.       02350000
023600     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02360000
023700                                                    COMP-3.       02370000
023800     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02380000
023900                                                    COMP-3.       02390000
024000     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02400000
024100                                                    COMP-3.       02410000
024200     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02420000
024300                                                    COMP SYNC.    02430000
024400     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02440000
024500                                                    COMP SYNC.    02450000
024600     05  PV-ITEM                        PIC S9(04)  VALUE +0      02460000
024700                                                    COMP SYNC.    02470000
024800     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02480000
024900                                                    COMP SYNC.    02490000
025000     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02500000
025100                                                    COMP SYNC.    02510000
025200     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02520000
025300                                                    COMP SYNC.    02530000
025400     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02540000
025500                                                    COMP SYNC.    02550000
025600     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02560000
025700                                                    COMP SYNC.    02570000
025800     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02580000
025900                                                    COMP SYNC.    02590000
026000     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02600000
026100                                                    COMP SYNC.    02610000
026200     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02620000
026300                                                    COMP SYNC.    02630000
026400     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02640000
026500                                                    COMP SYNC.    02650000
026600     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02660000
026700                                                    COMP SYNC.    02670000
026800     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02680000
026900                                                    COMP SYNC.    02690000
027000     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02700000
027100                                                    COMP SYNC.    02710000
027200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02720000
027300                                                    COMP SYNC.    02730000
027400     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02740000
027500                                                    COMP.         02750000
027600     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02760000
027700                                                    COMP.         02770000
027800     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02780000
027900                                                    COMP.         02790000
028000     05  PV-SOFT-ABORT-MSG.                                       02800000
028100         10  FILLER            PIC X(12) VALUE ' SUKCS598 - '.    02810000
028200         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02820000
028300         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02830000
028400         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02840000
028500         10  PV-SOFT-PARAGRAPH PIC X(30).                         02850000
028600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02860000
028700                                                     COMP SYNC.   02870000
028800     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02880000
028900     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02890000
029000     05  PV-CICS-MSG-HOLD.                                        02900000
029100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02910000
029200         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02920000
029300     05  PV-CICS-MSG-HOLD2.                                       02930000
029400         10  FILLER                      PIC  X(01)  VALUE SPACE. 02940000
029500         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02950000
029600                                                                  02960000
029700     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02970000
029800     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02980000
029900     05  PV-SEL-TERM-ID                  PIC  X(04).              02990000
030000     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03000000
030100     05  PV-SEL-SEQ                      PIC  9(01).              03010000
030200     05  PV-OUTBND-CRTN-CNT              PIC S9(9) COMP-3.        03020000
030300     05  PV-LINE-COUNT                   PIC S9(9) COMP-3.        03030000
030400     05  PV-LINE-DIVRT                   PIC S9(9) COMP-3.        03040000
030500     05  PV-LINE-SCAND                   PIC S9(9) COMP-3.        03050000
030600     05  PV-CARTON-COUNT                 PIC S9(9) COMP-3.        03060000
030700     05  PV-SHPD-QTY                     PIC S9(9) COMP-3.        03070000
030800     05  PV-SHPD-QTY-N                   PIC Z(05).               03080000
030900     05  PV-SHPD-QTY-X REDEFINES PV-SHPD-QTY-N                    03090000
031000                                         PIC X(05).               03100000
031100     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      03110000
031200     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             03120000
031300         10  PV-CURR-YY            PIC  9(04).                    03130000
031400         10  FILLER                PIC  X(01).                    03140000
031500         10  PV-CURR-MM            PIC  9(02).                    03150000
031600         10  FILLER                PIC  X(01).                    03160000
031700         10  PV-CURR-DD            PIC  9(02).                    03170000
031800     05  PV-DEFAULT-FROM-DATE      PIC  X(10)  VALUE SPACES.      03180000
031900     05  PV-DEFAULT-DATE-R REDEFINES PV-DEFAULT-FROM-DATE.        03190000
032000         10  PV-DFLT-YY            PIC  9(04).                    03200000
032100         10  FILLER                PIC  X(01).                    03210000
032200         10  PV-DFLT-MM            PIC  9(02).                    03220000
032300         10  FILLER                PIC  X(01).                    03230000
032400         10  PV-DFLT-DD            PIC  9(02).                    03240000
032500     05  PV-FROM-DATE-HOLD.                                       03250000
032600         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      03260000
032700         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      03270000
032800         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      03280000
032900     05  PV-TO-DATE-HOLD.                                         03290000
033000         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      03300000
033100         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      03310000
033200         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      03320000
033201* TKMAV49 - BEG                                                   03320100
033210     05  PV-OPER-UNT-ID            PIC  S9(4) COMP.               03321000
033220* TKMAV49 - END                                                   03322000
033300                                                                  03330000
033400******************************************************************03340000
033500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03350000
033600**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03360000
033700**  APPLICATION-SPECIFIC COMMAREA.                              **03370000
033800******************************************************************03380000
033900 01  LQW-LIST-QUEUE-WORK-AREA.                                    03390000
034000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03400000
034100     05  LQW-ITEM-ENTRIES               OCCURS 09 TIMES           03410000
034200                                        INDEXED BY LQW-IDX.       03420000
034300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03430000
034400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03440000
034500         10  LQW-SELECTED-SW            PIC  X(01).               03450000
034600             88  LQW-SELECT                         VALUE 'S'.    03460000
034700             88  LQW-DESELECT                       VALUE ' '.    03470000
034800         10  LQW-ACTION                 PIC  X(03).               03480000
034900             88  LQW-DEL                            VALUE 'DEL'.  03490000
035000             88  LQW-INQ                            VALUE 'INQ'.  03500000
035100             88  LQW-UPD                            VALUE 'UPD'.  03510000
035200             88  LQW-ERR                            VALUE 'ERR'.  03520000
035300         10  LQW-LINE-NBR               PIC  9(04).               03530000
035400         10  LQW-LINE-STAT              PIC  X(02).               03540000
035500         10  LQW-UNTS-VRFD              PIC  9(06).               03550000
035600         10  LQW-UNTS-MFSD              PIC  9(06).               03560000
035700         10  LQW-UNTS-VARI              PIC S9(06).               03570000
035800         10  LQW-TOT-CRTNS              PIC  9(06).               03580000
035900         10  LQW-TOT-SHIPD              PIC  9(06).               03590000
036000         10  LQW-TOT-DIVRT              PIC  9(06).               03600000
036100         10  LQW-TOT-MANUL              PIC  9(06).               03610000
036200         10  LQW-PROC-CODE              PIC  X(07).               03620000
036300                                                                  03630000
036400*---------------------------------------------------------------* 03640000
036500* SELECTON QUEUE LAYOUT                                         * 03650000
036600*---------------------------------------------------------------* 03660000
036700     COPY SUWS010.                                                03670000
036800     COPY SUWS039.                                                03680000
036900                                                                  03690000
037000*---------------------------------------------------------------* 03700000
037100*    MAP LAYOUT                                                 * 03710000
037200*---------------------------------------------------------------* 03720000
037300     COPY SUKM598.                                                03730000
037400*                                                                 03740000
037500 01  MR-OCCURS-LAYOUT                   REDEFINES  SU598AO.       03750000
037600*    05  FILLER                         PIC X(241).               03760000
037610     05  FILLER                         PIC X(268).               03761000
037700     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          03770000
037800         10  MR-SELECTL                 PIC S9(04) COMP.          03780000
037900         10  MR-SELECTA                 PIC  X(01).               03790000
038000         10  MR-SELECTC                 PIC  X(01).               03800000
038100         10  MR-SELECTH                 PIC  X(01).               03810000
038200         10  MR-SELECTI                 PIC  X(01).               03820000
038300                                                                  03830000
038400         10  MR-ACTIONL                 PIC S9(04) COMP.          03840000
038500         10  MR-ACTIONA                 PIC  X(01).               03850000
038600         10  MR-ACTIONC                 PIC  X(01).               03860000
038700         10  MR-ACTIONH                 PIC  X(01).               03870000
038800         10  MR-ACTION                  PIC  X(03).               03880000
038900                                                                  03890000
039000         10  MR-LINE-NBRL               PIC S9(04) COMP.          03900000
039100         10  MR-LINE-NBRA               PIC  X(01).               03910000
039200         10  MR-LINE-NBRC               PIC  X(01).               03920000
039300         10  MR-LINE-NBRH               PIC  X(01).               03930000
039400         10  MR-LINE-NBR                PIC  Z(04).               03940000
039500                                                                  03950000
039600         10  MR-LINE-STATL              PIC S9(04) COMP.          03960000
039700         10  MR-LINE-STATA              PIC  X(01).               03970000
039800         10  MR-LINE-STATC              PIC  X(01).               03980000
039900         10  MR-LINE-STATH              PIC  X(01).               03990000
040000         10  MR-LINE-STAT               PIC  X(02).               04000000
040100                                                                  04010000
040200         10  MR-UNIT-VRFDL              PIC S9(04) COMP.          04020000
040300         10  MR-UNIT-VRFDA              PIC  X(01).               04030000
040400         10  MR-UNIT-VRFDC              PIC  X(01).               04040000
040500         10  MR-UNIT-VRFDH              PIC  X(01).               04050000
040600         10  MR-UNIT-VRFD               PIC  Z(06).               04060000
040700                                                                  04070000
040800         10  MR-UNIT-MFSTL              PIC S9(04) COMP.          04080000
040900         10  MR-UNIT-MFSTA              PIC  X(01).               04090000
041000         10  MR-UNIT-MFSTC              PIC  X(01).               04100000
041100         10  MR-UNIT-MFSTH              PIC  X(01).               04110000
041200         10  MR-UNIT-MFST               PIC  Z(06).               04120000
041300                                                                  04130000
041400         10  MR-UNIT-VARIL              PIC S9(04) COMP.          04140000
041500         10  MR-UNIT-VARIA              PIC  X(01).               04150000
041600         10  MR-UNIT-VARIC              PIC  X(01).               04160000
041700         10  MR-UNIT-VARIH              PIC  X(01).               04170000
041800         10  MR-UNIT-VARI               PIC  Z(05)-.              04180000
041900                                                                  04190000
042000         10  MR-TOT-LINEL               PIC S9(04) COMP.          04200000
042100         10  MR-TOT-LINEA               PIC  X(01).               04210000
042200         10  MR-TOT-LINEC               PIC  X(01).               04220000
042300         10  MR-TOT-LINEH               PIC  X(01).               04230000
042400         10  MR-TOT-LINE                PIC  Z(06).               04240000
042500                                                                  04250000
042600         10  MR-TOT-SHIPDL              PIC S9(04) COMP.          04260000
042700         10  MR-TOT-SHIPDA              PIC  X(01).               04270000
042800         10  MR-TOT-SHIPDC              PIC  X(01).               04280000
042900         10  MR-TOT-SHIPDH              PIC  X(01).               04290000
043000         10  MR-TOT-SHIPD               PIC  Z(06).               04300000
043100                                                                  04310000
043200         10  MR-TOT-DIVERTL             PIC S9(04) COMP.          04320000
043300         10  MR-TOT-DIVERTA             PIC  X(01).               04330000
043400         10  MR-TOT-DIVERTC             PIC  X(01).               04340000
043500         10  MR-TOT-DIVERTH             PIC  X(01).               04350000
043600         10  MR-TOT-DIVERT              PIC  Z(06).               04360000
043700                                                                  04370000
043800         10  MR-TOT-LOADDL              PIC S9(04) COMP.          04380000
043900         10  MR-TOT-LOADDA              PIC  X(01).               04390000
044000         10  MR-TOT-LOADDC              PIC  X(01).               04400000
044100         10  MR-TOT-LOADDH              PIC  X(01).               04410000
044200         10  MR-TOT-LOADD               PIC  Z(06).               04420000
044300                                                                  04430000
044400         10  MR-PROC-CODEL              PIC S9(04) COMP.          04440000
044500         10  MR-PROC-CODEA              PIC  X(01).               04450000
044600         10  MR-PROC-CODEC              PIC  X(01).               04460000
044700         10  MR-PROC-CODEH              PIC  X(01).               04470000
044800         10  MR-PROC-CODE               PIC  X(07).               04480000
044900                                                                  04490000
045000*                                                                 04500000
045100***************************************************************** 04510000
045200*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04520000
045300*             LOCATION MODULE (XLKUT071)                        * 04530000
045400***************************************************************** 04540000
045500     COPY XLWS071.                                                04550000
045600                                                                  04560000
045700***************************************************************** 04570000
045800*   RCWS074 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04580000
045900*             UNIT AND CARTON COUNTS MODULE - RCKUT128          * 04590000
046000***************************************************************** 04600000
046100     COPY RCWS074.                                                04610000
046200                                                                  04620000
046300***************************************************************** 04630000
046400*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04640000
046500*             AUTOVERIFY (AUTOVE) MODULE (RCKUT127).            * 04650000
046600***************************************************************** 04660000
046700     COPY RCWS040.                                                04670000
046800                                                                  04680000
046900*---------------------------------------------------------------* 04690000
047000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04700000
047100*---------------------------------------------------------------* 04710000
047200     COPY DPWS015.                                                04720000
047300                                                                  04730000
047400*---------------------------------------------------------------* 04740000
047500*    FUNCTION KEYS COPYBOOK.                                    * 04750000
047600*---------------------------------------------------------------* 04760000
047700     COPY DPWS016.                                                04770000
047800                                                                  04780000
047900*---------------------------------------------------------------* 04790000
048000*    NUMERIC EDIT LAYOUT.                                       * 04800000
048100*---------------------------------------------------------------* 04810000
048200     COPY DPWS010I.                                               04820000
048300                                                                  04830000
048400*----------------------------------------------------------------*04840000
048500**  SECURITY SUBROUTINE PARAMETERS                                04850000
048600*----------------------------------------------------------------*04860000
048700     COPY DPWS008.                                                04870000
048800                                                                  04880000
048900*---------------------------------------------------------------* 04890000
049000*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04900024
049100*---------------------------------------------------------------* 04910000
049200     COPY DPWS030.                                                04920000
049210     COPY DPWS930.                                                04921024
049300                                                                  04930000
049400*---------------------------------------------------------------* 04940000
049500*    STANDARD COMMAREA.                                         * 04950000
049600*---------------------------------------------------------------* 04960000
049700     COPY DPWS020.                                                04970000
049800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04980000
049900                                                                  04990000
050000*---------------------------------------------------------------* 05000000
050100* INTER-APPLICATION COMMAREA.                                   * 05010000
050200*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05020000
050300*             SPEC SCREEN.                                      * 05030000
050400*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05040000
050500*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05050000
050600*   SUWS038 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05060000
050700*             THIS LIST PROGRAMMING FOR A LOCAL-02 FUNCTION.    * 05070000
050800*---------------------------------------------------------------* 05080000
050900         10  INTER-APPL-COMM-AREA       PIC X(200).               05090000
051000     COPY SUWS008.                                                05100000
051100     COPY SUWS009.                                                05110000
051200     COPY SUWS038.                                                05120000
051300                                                                  05130000
051400*---------------------------------------------------------------* 05140000
051500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05150000
051600*---------------------------------------------------------------* 05160000
051700         10  ASC-SPECIFIC-COMMAREA.                               05170000
051800             15  ASC-FUNC02-RETURN-FLAG       PIC  X(1).          05180000
051900                 88  ASC-FUNC02-RETURN-NO          VALUE 'N'.     05190000
052000                 88  ASC-FUNC02-RETURN-YES         VALUE 'Y'.     05200000
052100             15  ASC-AUTO-VE-SW                  PIC X(01).       05210000
052200                 88  ASC-AUTO-VE-YES                VALUE 'Y'.    05220000
052300                 88  ASC-AUTO-VE-NO                 VALUE 'N'.    05230000
052400                                                                  05240000
052500             15  ASC-UNTS-VRFD               PIC  9(06).          05250000
052600             15  ASC-UNTS-MFST               PIC  9(06).          05260000
052700             15  ASC-UNTS-VARI               PIC S9(06).          05270000
052800             15  ASC-SHPD-QTY                PIC  S9(9) COMP-3.   05280000
052900             15  ASC-OUTBND-CRTNS            PIC  S9(9) COMP.     05290000
053000             15  ASC-PO-NBR                  PIC  S9(9) COMP.     05300000
053100             15  ASC-RCVR-NBR                PIC  S9(9) COMP.     05310000
053200             15  ASC-PO-RCVR                 PIC  X(12).          05320000
053300             15  ASC-LINE-NUMBER             PIC  S9(9) COMP.     05330000
053400             15  ASC-TRIP-ID                 PIC  S9(9) COMP.     05340000
053500             15  ASC-CREATE-ID               PIC  X(3).           05350000
053600             15  ASC-STATUS-CDE              PIC  XX.             05360000
053700             15  ASC-TMST                    PIC  X(26).          05370000
053800             15  ASC-PACK-BY-ST-IND          PIC  X.              05380000
053900             15  ASC-EXPTED-CART-CNT         PIC  S9(9) COMP.     05390000
054000             15  ASC-ACTL-CART-CNT           PIC  S9(9) COMP.     05400000
054100             15  ASC-CURR-OPER-UNT-ID        PIC  S9(4) COMP.     05410000
054101* TKMAV49 - BEG                                                   05410100
054110             15  ASC-CS-OPER-UNT-ID          PIC  S9(4) COMP.     05411000
054111             15  ASC-CNSTK                   PIC  X(13).          05411100
054120* TKMAV49 - END                                                   05412000
054200             15  ASC-LINE-COUNT              PIC  S9(9) COMP.     05420000
054300             15  ASC-LINE-DIVRT              PIC  S9(9) COMP.     05430000
054400             15  ASC-LINE-SCAND              PIC  S9(9) COMP.     05440000
054500             15  ASC-VRFD-USR-ID             PIC  X(8).           05450000
054600             15  ASC-PKGNG-CDE               PIC  X.              05460000
054700             15  ASC-OPER-UNT-NAME           PIC  X(24).          05470000
054800             15  ASC-STR-NBR-X               PIC  X(04).          05480000
054900             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           05490000
055000                 20  ASC-STR-NBR             PIC  Z(04).          05500000
055100             15  ASC-STORE-NAME              PIC  X(25).          05510000
055200             15  ASC-VENDOR-NAME             PIC  X(25).          05520000
055300             15  ASC-STATUS-DATE             PIC  X(10).          05530000
055400             15  ASC-STATUS-TIME             PIC  X(05).          05540000
055500             15  ASC-USER-ID                 PIC  X(08).          05550000
055600             15  ASC-SML-NBR                 PIC  9(18).          05560000
055700             15  ASC-STATUS                  PIC  X(07).          05570000
055800             15  ASC-PACKAGE                 PIC  X(07).          05580000
055900             15  ASC-DSPLY-PKGNG-CD          PIC  X(01).          05590000
056000                 88  ASC-DSP-INNER-PREPK                VALUE 'I'.05600000
056100                 88  ASC-DSP-MULTI-SKU-PREPK            VALUE 'M'.05610000
056200                 88  ASC-DSP-SINGLE-SKU-PREPK           VALUE 'S'.05620000
056300                 88  ASC-DSP-CASEPACK                   VALUE 'C'.05630000
056400                 88  ASC-DSP-BULK-PACK                  VALUE 'B'.05640000
056500*-----------------------------------------------------------------05650000
056600             15  ASC-BLK-SUB                  PIC S9(04) COMP     05660000
056700                                                         SYNC.    05670000
056800             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05680000
056900                                                         SYNC.    05690000
057000             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05700000
057100             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05710000
057200             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05720000
057300             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05730000
057400             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05740000
057500             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05750000
057600                                                         SYNC.    05760000
057700             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05770000
057800             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05780000
057900             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05790000
058000                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05800000
058100                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05810000
058200             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05820000
058300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05830000
058400                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05840000
058401* JAK 09/2009 WR37075 START                                       05840100
058402             15  ASC-CS-PULL-SW               PIC  X(01).         05840200
058403                 88  ASC-CS-PULL-TRAN              VALUE 'Y'.     05840300
058404                 88  ASC-NOT-CS-PULL-TRAN          VALUE ' '.     05840400
058405             15  ASC-PULL-NBR-N               PIC  Z(08).         05840500
058406             15  ASC-PULL-NBR-CHAR REDEFINES ASC-PULL-NBR-N.      05840600
058407                 20  ASC-PULL-NBR-X          PIC  X(08).          05840700
058408             15  ASC-PULL-NBR.                                    05840800
058410                 20  ASC-PULL                PIC  X(08).          05841000
058411                 20  ASC-TRAN                PIC  X(03).          05841100
058420* JAK 09/2009 WR37075 END                                         05842000
058430* DMH 11/16/11 - BEGIN                                            05843002
058440             15  ASC-FX-FAST-TRANSFER-SW      PIC  X(01).         05844002
058450                 88  ASC-FX-FAST-TRANSFER          VALUE 'Y'.     05845002
058460                 88  ASC-NOT-FX-FAST-TRANSFER      VALUE ' '.     05846002
058470             15  ASC-FAST-TRAN-N             PIC  Z(10).          05847002
058480             15  ASC-FAST-TRAN-CHAR REDEFINES ASC-FAST-TRAN-N.    05848005
058490                 20  ASC-FAST-TRAN-X         PIC  X(10).          05849002
058491             15  ASC-FAST-TRAN.                                   05849102
058492                 20  ASC-FX-STORE            PIC  9(04).          05849215
058493                 20  ASC-FX-TRAN-NBR         PIC  9(06).          05849315
058494             15  ASC-FAST-EDIT.                                   05849406
058495                 20  ASC-FX-STORE-EDIT       PIC  9(04).          05849513
058496                 20  ASC-FX-DASH             PIC  X(01).          05849607
058497                 20  ASC-FX-TRAN-NBR-EDIT    PIC  9(06).          05849713
058498* DMH 11/16/11 - END                                              05849806
058500             15  ASC-LIST-QUEUE-NAME.                             05850000
058600                 20  ASC-LIST-TERM-ID         PIC  X(04).         05860000
058700                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05870000
058800                 20  ASC-LIST-SEQ             PIC  9(01).         05880000
058900                                                                  05890000
059000             15  ASC-START-ITEM-REQUEST.                          05900000
059100                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05910000
059200                                                                  05920000
059300             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05930000
059400             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05940000
059500             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05950000
059600                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05960000
059700             15  ASC-SEL-QUEUE-NAME-IN        PIC X(08).          05970000
059800             15  ASC-SEL-QUEUE-NAME.                              05980000
059900                 20  ASC-SEL-TERM-ID          PIC  X(04).         05990000
060000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  06000000
060100                 20  ASC-SEL-SEQ              PIC  9(01).         06010000
060200             15  ASC-SEL-QUEUE-NAME-2.                            06020000
060300                 20  ASC-SEL-TERM-ID-2        PIC  X(04).         06030000
060400                 20  ASC-SEL-TASK-NUMBER-2    PIC S9(05) COMP-3.  06040000
060500                 20  ASC-SEL-SEQ-2            PIC  9(01).         06050000
060600             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06060000
060700                                                                  06070000
060800*-----------------------------------------------------------------06080000
060900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06090000
061000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06100000
061100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06110000
061200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06120000
061300                                                                  06130000
061400                 20  ASC-ITEM-ARRAY.                              06140000
061500                     25  ASC-ITEM-ENTRIES OCCURS 09 TIMES.        06150000
061600                         30  ASC-LIST-ITEM-NUMBER                 06160000
061700                                                     PIC S9(09)   06170000
061800                                                     COMP-3.      06180000
061900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06190000
062000                             88  ASC-VALID-SELECT    VALUE ' '    06200000
062100                                                           'S'    06210000
062200                                                           'B'    06220000
062300                                                           'E'.   06230000
062400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06240000
062500                             88  ASC-TEMP-SELECT     VALUE 'S'.   06250000
062600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06260000
062700                             88  ASC-TEMP-END        VALUE 'E'.   06270000
062800                         30  ASC-SELECTED-SW         PIC  X(01).  06280000
062900                             88  ASC-NO-SELECT       VALUE ' '.   06290000
063000                             88  ASC-SELECT          VALUE 'S'.   06300000
063100                             88  ASC-BEGIN           VALUE 'B'.   06310000
063200                             88  ASC-END             VALUE 'E'.   06320000
063300                         30  ASC-ACTION              PIC  X(03).  06330000
063400                         30  ASC-LINE-NBR            PIC  9(04).  06340000
063500                         30  ASC-LINE-STAT           PIC  X(02).  06350000
063600                         30  ASC-UNIT-VRFD           PIC  9(06).  06360000
063700                         30  ASC-UNIT-MFST           PIC  9(06).  06370000
063800                         30  ASC-UNIT-VARI           PIC S9(06).  06380000
063900                         30  ASC-TOT-LINE            PIC  9(06).  06390000
064000                         30  ASC-TOT-SHIPD           PIC  9(06).  06400000
064100                         30  ASC-TOT-DIVERT          PIC  9(06).  06410000
064200                         30  ASC-TOT-LOADD           PIC  9(06).  06420000
064300                         30  ASC-PROC-CODE           PIC  X(07).  06430000
064400                                                                  06440000
064500*---------------------------------------------------------------* 06450000
064600*    ABEND PROCESSING COPYBOOK.                                 * 06460000
064700*---------------------------------------------------------------* 06470000
064800     COPY DPWS013.                                                06480000
064900                                                                  06490000
065000                                                                  06500000
065100*---------------------------------------------------------------* 06510000
065200*    THE DIVERT TABLE                                             06520000
065300*---------------------------------------------------------------* 06530000
065400     EXEC SQL                                                     06540000
065500          INCLUDE TSUCRDV                                         06550000
065600     END-EXEC.                                                    06560000
065700                                                                  06570000
065800*---------------------------------------------------------------* 06580000
065900*    THE SUT_OTBND_LOC TABLE                                      06590000
066000*---------------------------------------------------------------* 06600000
066100     EXEC SQL                                                     06610000
066200          INCLUDE SUT00027                                        06620000
066300     END-EXEC.                                                    06630000
066400                                                                  06640000
066500*---------------------------------------------------------------* 06650000
066600*    THE SUT_OTBND_CART TABLE                                     06660000
066700*---------------------------------------------------------------* 06670000
066800     EXEC SQL                                                     06680000
066900          INCLUDE SUT00024                                        06690000
067000     END-EXEC.                                                    06700000
067100                                                                  06710000
067200*---------------------------------------------------------------* 06720000
067300*    TRECEIV TABLE                                                06730000
067400*---------------------------------------------------------------* 06740000
067500     EXEC SQL                                                     06750000
067600          INCLUDE TRECEIV                                         06760000
067700     END-EXEC.                                                    06770000
067800                                                                  06780000
067900*---------------------------------------------------------------* 06790000
068000*    TDISTHD TABLE                                                06800000
068100*---------------------------------------------------------------* 06810000
068200     EXEC SQL                                                     06820000
068300          INCLUDE TDISTHD                                         06830000
068400     END-EXEC.                                                    06840000
068500                                                                  06850000
068600*---------------------------------------------------------------* 06860000
068700*    TRECITM TABLE                                                06870000
068800*---------------------------------------------------------------* 06880000
068900     EXEC SQL                                                     06890000
069000          INCLUDE TRECITM                                         06900000
069100     END-EXEC.                                                    06910000
069200                                                                  06920000
069300*---------------------------------------------------------------* 06930000
069400*    TRECDIS TABLE                                                06940000
069500*---------------------------------------------------------------* 06950000
069600     EXEC SQL                                                     06960000
069700          INCLUDE TRECDIS                                         06970000
069800     END-EXEC.                                                    06980000
069900                                                                  06990000
070000*---------------------------------------------------------------* 07000000
070100*    TSHPUNT - SHIP UNIT TABLE                                    07010000
070200*---------------------------------------------------------------* 07020000
070300     EXEC SQL                                                     07030000
070400          INCLUDE TSHPUNT                                         07040000
070500     END-EXEC.                                                    07050000
070600                                                                  07060000
070700*---------------------------------------------------------------* 07070000
070800*    SUT_OTBND_UPC - SHIP UNIT & UPC TABLE                        07080000
070900*---------------------------------------------------------------* 07090000
071000     EXEC SQL                                                     07100000
071100          INCLUDE SUT00028                                        07110000
071200     END-EXEC.                                                    07120000
071300                                                                  07130000
071400*---------------------------------------------------------------* 07140000
071500*    SUT_OTBND_VND                                                07150000
071600*---------------------------------------------------------------* 07160000
071700     EXEC SQL                                                     07170000
071800          INCLUDE SUT00026                                        07180000
071900     END-EXEC.                                                    07190000
072000                                                                  07200000
072100*---------------------------------------------------------------* 07210000
072200*    TPKSLIP                                                      07220000
072300*---------------------------------------------------------------* 07230000
072400     EXEC SQL                                                     07240000
072500          INCLUDE TPKSLIP                                         07250000
072600     END-EXEC.                                                    07260000
072700                                                                  07270000
072800*---------------------------------------------------------------* 07280000
072900*    TPURCHS                                                      07290000
073000*---------------------------------------------------------------* 07300000
073100     EXEC SQL                                                     07310000
073200          INCLUDE TPURCHS                                         07320000
073300     END-EXEC.                                                    07330000
073400                                                                  07340000
073500*---------------------------------------------------------------* 07350000
073600*    TENTNME                                                      07360000
073700*---------------------------------------------------------------* 07370000
073800     EXEC SQL                                                     07380000
073900          INCLUDE TENTNME                                         07390000
074000     END-EXEC.                                                    07400000
074100                                                                  07410000
074101* JAK 09/2009 WR37075 START                                       07410100
074110*---------------------------------------------------------------* 07411000
074120*    TCEPLIT                                                      07412000
074130*---------------------------------------------------------------* 07413000
074140     EXEC SQL                                                     07414000
074150          INCLUDE TCEPLIT                                         07415000
074160     END-EXEC.                                                    07416000
074170                                                                  07417000
074171*---------------------------------------------------------------* 07417100
074172*    TCEPLRQ                                                      07417200
074173*---------------------------------------------------------------* 07417300
074174     EXEC SQL                                                     07417400
074175          INCLUDE TCEPLRQ                                         07417500
074176     END-EXEC.                                                    07417600
074177                                                                  07417700
074178*---------------------------------------------------------------* 07417800
074179*    TCEPLST                                                      07417900
074180*---------------------------------------------------------------* 07418000
074181     EXEC SQL                                                     07418100
074182          INCLUDE TCEPLST                                         07418200
074183     END-EXEC.                                                    07418300
074184                                                                  07418400
074185*---------------------------------------------------------------* 07418500
074190*    TCEPLDS                                                      07419000
074191*---------------------------------------------------------------* 07419100
074192     EXEC SQL                                                     07419200
074193          INCLUDE TCEPLDS                                         07419300
074194     END-EXEC.                                                    07419400
074195                                                                  07419500
074196*---------------------------------------------------------------* 07419600
074197*    TCEPLMF                                                      07419700
074198*---------------------------------------------------------------* 07419800
074199     EXEC SQL                                                     07419900
074200          INCLUDE TCEPLMF                                         07420000
074201     END-EXEC.                                                    07420100
074202* JAK 09/2009 WR37075 END                                         07420200
074203                                                                  07420300
074210*---------------------------------------------------------------* 07421000
074300*    TOTAL OUTBOUND CARTON COUNT CURSOR                           07430000
074400*---------------------------------------------------------------* 07440000
074500     EXEC SQL                                                     07450000
074600          DECLARE OUTBND-CTN-CNT-CSR CURSOR FOR                   07460000
074700              SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)             07470000
074800                FROM  SUT_OTBND_UPC A                             07480000
074900                     ,SUT_OTBND_CART B                            07490000
075000              WHERE  A.TRN_NBR           =  :DK-PO-NBR            07500000
075100                AND  A.RCVR_SEQ_NBR      =  :DK-REC-SEQ-NBR       07510000
075200                AND  A.SHIPT_UNT_ID      =  B.SHIPT_UNT_ID        07520000
075300                AND  B.DEST_LOC_NBR      >= :DK-STR-BEGIN         07530000
075400                AND  B.DEST_LOC_NBR      <= :DK-STR-END           07540000
075500                AND  B.ACTV_IND          =  'Y'                   07550000
075600       UNION ALL                                                  07560000
075700              SELECT  COUNT (A.SHIPT_UNT_ID)                      07570000
075800                FROM  SUT_OTBND_VND A                             07580000
075900                     ,TPKSLIP  B                                  07590000
076000                     ,SUT_OTBND_CART C                            07600000
076100              WHERE  A.PO_NBR             = :DK-PO-NBR            07610000
076200                AND  A.PO_NBR             = B.PO_NBR              07620000
076300                AND  A.PKSL_SEQ_NBR       = B.SEQ_NBR             07630000
076400                AND  B.REC_SEQ_NBR        = :DK-REC-SEQ-NBR       07640000
076500                AND  B.VER_STAT_CDE       = 'A'                   07650000
076600                AND  A.SHIPT_UNT_ID       = C.SHIPT_UNT_ID        07660000
076700                AND  C.DEST_LOC_NBR      >= :DK-STR-BEGIN         07670000
076800                AND  C.DEST_LOC_NBR      <= :DK-STR-END           07680000
076900                AND  C.ACTV_IND           = 'Y'                   07690000
077000                AND  C.CART_TYP_CDE NOT LIKE 'P'                  07700000
077100     END-EXEC.                                                    07710000
077200                                                                  07720000
077313                                                                  07731300
077320*---------------------------------------------------------------* 07732000
077400*  CURSOR TO SUM VERIFIED UNITS FOR PO/RCVR                       07740000
077500*---------------------------------------------------------------* 07750000
077600     EXEC SQL                                                     07760000
077700          DECLARE VRFD-UNTS-CSR CURSOR FOR                        07770000
077800      SELECT  SUM(B.VERIFY_ITM_QTY)                               07780000
077900             ,SUM(B.AP_VERIFY_ITM_QTY)                            07790000
078000             ,A.ORD_LNE_NBR                                       07800000
078100             ,A.STATUS_CDE                                        07810000
078200             ,A.VRFD_USR_ID                                       07820000
078300        FROM  TRECITM  A                                          07830000
078400             ,TRECDIS  B                                          07840000
078500       WHERE  A.ORD_NBR           = :DK-PO-NBR                    07850000
078600         AND  A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR               07860000
078700         AND  A.ORD_LNE_NBR      >= :DK-LINE-BEGIN                07870000
078800         AND  A.ORD_LNE_NBR      <= :DK-LINE-END                  07880000
078900         AND  A.VER_STATUS_CDE    = 'A'                           07890000
079000         AND  B.STR_NBR          >= :DK-STR-BEGIN                 07900000
079100         AND  B.STR_NBR          <= :DK-STR-END                   07910000
079200         AND  A.ORD_NBR           = B.ORD_NBR                     07920000
079300         AND  A.REC_SEQ_NBR       = B.REC_SEQ_NBR                 07930000
079400         AND  A.ORD_LNE_NBR       = B.ORD_LNE_NBR                 07940000
079500         AND  A.OPER_UNT_ID       = B.OPER_UNT_ID                 07950000
079700       GROUP BY A.ORD_LNE_NBR, A.STATUS_CDE, A.VRFD_USR_ID        07970000
079800     END-EXEC.                                                    07980000
079900                                                                  07990000
080000*---------------------------------------------------------------* 08000000
080100*  CURSOR TO COUNT CARTONS BY PO, RECEIVER                        08010000
080200*---------------------------------------------------------------* 08020000
080300     EXEC SQL                                                     08030000
080400          DECLARE CARTON-COUNT-CSR CURSOR FOR                     08040000
080500        SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                   08050000
080600          FROM  SUT_OTBND_UPC A                                   08060000
080700               ,SUT_OTBND_CART B                                  08070000
080800         WHERE  A.TRN_NBR           = :DK-PO-NBR                  08080000
080900           AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR             08090000
081000           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              08100000
081100           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                08110000
081200           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              08120000
081300           AND  B.DEST_LOC_NBR >= :DK-STR-BEGIN                   08130000
081400           AND  B.DEST_LOC_NBR <= :DK-STR-END                     08140000
081500           AND  B.ACTV_IND          = 'Y'                         08150000
081600             GROUP BY A.TRN_LNE_NBR                               08160000
081700       UNION ALL                                                  08170000
081800          SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                 08180000
081900            FROM  SUT_OTBND_UPC A                                 08190000
082000                 ,SUT_OTBND_CART B                                08200000
082100                 ,SUT_OTBND_VND C                                 08210000
082200                 ,TPKSLIP  D                                      08220000
082300         WHERE  A.TRN_NBR           = :DK-PO-NBR                  08230000
082400           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              08240000
082500           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                08250000
082600           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              08260000
082700           AND  B.ACTV_IND          = 'Y'                         08270000
082800           AND  B.CART_TYP_CDE NOT LIKE 'P'                       08280000
082900           AND  B.DEST_LOC_NBR >= :DK-STR-BEGIN                   08290000
083000           AND  B.DEST_LOC_NBR <= :DK-STR-END                     08300000
083100           AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              08310000
083200           AND  A.TRN_NBR           = C.PO_NBR                    08320000
083300           AND  C.PO_NBR            = D.PO_NBR                    08330000
083400           AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR                   08340000
083500           AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR             08350000
083600           AND  D.VER_STAT_CDE      = 'A'                         08360000
083700             GROUP BY A.TRN_LNE_NBR                               08370000
083710       UNION ALL                                                  08371016
083720          SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                 08372016
083730            FROM  SUT_OTBND_UPC A                                 08373016
083740                 ,SUT_OTBND_CART B                                08374016
083750           WHERE  A.TRN_NBR           = :DK-PO-NBR                08375019
083760             AND  A.RCVR_SEQ_NBR      = 0                         08376016
083770             AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN            08377020
083780             AND  A.TRN_LNE_NBR      <= :DK-LINE-END              08378020
083790             AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID            08379016
083791             AND  B.CART_SRC_CDE      = 'FXR'                     08379116
083792             AND  B.ACTV_IND          = 'Y'                       08379216
083793               GROUP BY A.TRN_LNE_NBR                             08379316
083800     END-EXEC.                                                    08380000
083900                                                                  08390000
084000*---------------------------------------------------------------* 08400000
084100*  CURSOR TO COUNT MANIFESTED UNITS BY PO/RCVR                    08410000
084200*---------------------------------------------------------------* 08420000
084300     EXEC SQL                                                     08430000
084400          DECLARE MANFSTD-UNITS-CSR CURSOR FOR                    08440000
084500          SELECT  SUM(A.SHPD_UNT_QTY)                             08450000
084600            FROM  SUT_OTBND_UPC A                                 08460000
084700                 ,SUT_OTBND_CART B                                08470000
084800           WHERE  A.TRN_NBR           = :DK-PO-NBR                08480000
084900             AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN            08490000
085000             AND  A.TRN_LNE_NBR      <= :DK-LINE-END              08500000
085100             AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR           08510000
085200             AND  A.TRN_TYP_CDE       = 'PO'                      08520000
085300             AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID            08530000
085400             AND  B.ACTV_IND          = 'Y'                       08540000
085500             AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN             08550000
085600             AND  B.DEST_LOC_NBR     <= :DK-STR-END               08560000
085700     UNION ALL                                                    08570000
085800          SELECT  SUM(A.SHPD_UNT_QTY)                             08580000
085900            FROM  SUT_OTBND_UPC A                                 08590000
086000                 ,SUT_OTBND_CART B                                08600000
086100                 ,SUT_OTBND_VND C                                 08610000
086200                 ,TPKSLIP  D                                      08620000
086300           WHERE  A.TRN_NBR           = :DK-PO-NBR                08630000
086400             AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN            08640000
086500             AND  A.TRN_LNE_NBR      <= :DK-LINE-END              08650000
086600             AND  A.TRN_TYP_CDE       = 'PO'                      08660000
086700             AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID            08670000
086800             AND  B.ACTV_IND          = 'Y'                       08680000
086900             AND  B.CART_TYP_CDE NOT LIKE 'P'                     08690000
087000             AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN             08700000
087100             AND  B.DEST_LOC_NBR     <= :DK-STR-END               08710000
087200             AND  A.TRN_NBR           = C.PO_NBR                  08720000
087300             AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID            08730000
087400             AND  C.PO_NBR            = D.PO_NBR                  08740000
087500             AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR                 08750000
087600             AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR           08760000
087700             AND  D.VER_STAT_CDE      = 'A'                       08770000
087800          END-EXEC                                                08780000
087900                                                                  08790000
088000*---------------------------------------------------------------* 08800000
088100*  CURSOR TO COUNT DIVERTED CARTONS BY PO/RCVR                    08810000
088200*---------------------------------------------------------------* 08820000
088300     EXEC SQL                                                     08830000
088400          DECLARE DIVERT-CART-CSR CURSOR FOR                      08840000
088500        SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                   08850000
088600          FROM  SUT_OTBND_UPC A                                   08860000
088700               ,SUT_OTBND_CART B                                  08870000
088800               ,TSUCRDV  C                                        08880000
088900         WHERE  A.TRN_NBR           = :DK-PO-NBR                  08890000
089000           AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR             08900000
089100           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              08910000
089200           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                08920000
089300           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              08930000
089400           AND  B.ACTV_IND          = 'Y'                         08940000
089500           AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN               08950000
089600           AND  B.DEST_LOC_NBR     <= :DK-STR-END                 08960000
089700           AND  B.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              08970000
089800           AND  B.DEST_LOC_NBR      = C.DEST_OPER_UNT_ID          08980000
089900           AND  C.ACTV_CDE          = 'A'                         08990000
090000             GROUP BY A.TRN_LNE_NBR                               09000000
090100       UNION ALL                                                  09010000
090200          SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                 09020000
090300            FROM  SUT_OTBND_UPC A                                 09030000
090400                 ,SUT_OTBND_CART B                                09040000
090500                 ,SUT_OTBND_VND C                                 09050000
090600                 ,TPKSLIP  D                                      09060000
090700                 ,TSUCRDV  E                                      09070000
090800         WHERE  A.TRN_NBR           = :DK-PO-NBR                  09080000
090900           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              09090000
091000           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                09100000
091100           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              09110000
091200           AND  B.ACTV_IND          = 'Y'                         09120000
091300           AND  B.CART_TYP_CDE NOT LIKE 'P'                       09130000
091400           AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN               09140000
091500           AND  B.DEST_LOC_NBR     <= :DK-STR-END                 09150000
091600           AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              09160000
091700           AND  A.TRN_NBR           = C.PO_NBR                    09170000
091800           AND  C.PO_NBR            = D.PO_NBR                    09180000
091900           AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR                   09190000
092000           AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR             09200000
092100           AND  D.VER_STAT_CDE      = 'A'                         09210000
092200           AND  B.SHIPT_UNT_ID      = E.SHIPT_UNT_ID              09220000
092300           AND  B.DEST_LOC_NBR      = E.DEST_OPER_UNT_ID          09230000
092400           AND  E.ACTV_CDE          = 'A'                         09240000
092500             GROUP BY A.TRN_LNE_NBR                               09250000
092501       UNION ALL                                                  09250117
092510        SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                   09251017
092520          FROM  SUT_OTBND_UPC A                                   09252017
092530               ,SUT_OTBND_CART B                                  09253017
092540               ,TSUCRDV  C                                        09254017
092550         WHERE  A.TRN_NBR           = :DK-PO-NBR                  09255017
092560           AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR             09256017
092570           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              09257017
092580           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                09258017
092590           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              09259017
092591           AND  B.ACTV_IND          = 'Y'                         09259117
092592           AND  B.CART_SRC_CDE      = 'FXR'                       09259217
092594           AND  B.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              09259417
092596           AND  C.ACTV_CDE          = 'A'                         09259617
092597             GROUP BY A.TRN_LNE_NBR                               09259717
092600     END-EXEC.                                                    09260000
092700                                                                  09270000
092800*---------------------------------------------------------------* 09280000
092900*  CURSOR TO COUNT SCANNED ON CARTONS BY PO/RCVR                  09290000
093000*---------------------------------------------------------------* 09300000
093100     EXEC SQL                                                     09310000
093200          DECLARE SCANNED-ON-CSR CURSOR FOR                       09320000
093300        SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                   09330000
093400          FROM  SUT_OTBND_UPC A                                   09340000
093500               ,SUT_OTBND_CART B                                  09350000
093600               ,SUT_OTBND_LOC C                                   09360000
093700         WHERE  A.TRN_NBR           = :DK-PO-NBR                  09370000
093800           AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR             09380000
093900           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              09390000
094000           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                09400000
094100           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              09410000
094200           AND  B.ACTV_IND          = 'Y'                         09420000
094300           AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN               09430000
094400           AND  B.DEST_LOC_NBR     <= :DK-STR-END                 09440000
094500           AND  B.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              09450000
094600           AND  C.ACTV_CDE          = 'A'                         09460000
094700           AND  C.SCN_CDE           = 'SHON'                      09470000
094800             GROUP BY A.TRN_LNE_NBR                               09480000
094900       UNION ALL                                                  09490000
095000          SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                 09500000
095100            FROM  SUT_OTBND_UPC A                                 09510000
095200                 ,SUT_OTBND_CART B                                09520000
095300                 ,SUT_OTBND_VND C                                 09530000
095400                 ,TPKSLIP  D                                      09540000
095500                 ,SUT_OTBND_LOC E                                 09550000
095600         WHERE  A.TRN_NBR           = :DK-PO-NBR                  09560000
095700           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              09570000
095800           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                09580000
095900           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              09590000
096000           AND  B.ACTV_IND          = 'Y'                         09600000
096100           AND  B.CART_TYP_CDE NOT LIKE 'P'                       09610000
096200           AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN               09620000
096300           AND  B.DEST_LOC_NBR     <= :DK-STR-END                 09630000
096400           AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              09640000
096500           AND  A.TRN_NBR           = C.PO_NBR                    09650000
096600           AND  C.PO_NBR            = D.PO_NBR                    09660000
096700           AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR                   09670000
096800           AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR             09680000
096900           AND  D.VER_STAT_CDE      = 'A'                         09690000
097000           AND  B.SHIPT_UNT_ID      = E.SHIPT_UNT_ID              09700000
097100           AND  E.ACTV_CDE          = 'A'                         09710000
097200           AND  E.SCN_CDE           = 'SHON'                      09720000
097300             GROUP BY A.TRN_LNE_NBR                               09730000
097301       UNION ALL                                                  09730118
097310        SELECT  COUNT (DISTINCT A.SHIPT_UNT_ID)                   09731018
097320          FROM  SUT_OTBND_UPC A                                   09732018
097330               ,SUT_OTBND_CART B                                  09733018
097340               ,SUT_OTBND_LOC C                                   09734018
097350         WHERE  A.TRN_NBR           = :DK-PO-NBR                  09735018
097360           AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR             09736018
097370           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              09737018
097380           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                09738018
097390           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              09739018
097391           AND  B.ACTV_IND          = 'Y'                         09739118
097392           AND  B.CART_SRC_CDE      = 'FXR'                       09739218
097394           AND  B.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              09739418
097395           AND  C.ACTV_CDE          = 'A'                         09739518
097396           AND  C.SCN_CDE           = 'SHON'                      09739618
097397             GROUP BY A.TRN_LNE_NBR                               09739718
097400     END-EXEC.                                                    09740000
097500                                                                  09750000
097501* JAK 09/2009 WR37075 START                                       09750100
097510*---------------------------------------------------------------* 09751000
097520*  CURSOR TO GET LINE INFORMATION FOR CS PULL TRANSACTIONS        09752000
097530*---------------------------------------------------------------* 09753000
097540     EXEC SQL                                                     09754000
097550          DECLARE CS-PULL-CSR CURSOR FOR                          09755000
097560      SELECT  B.PL_LNE_NBR                                        09756000
097561             ,B.STAT_CDE                                          09756100
097562             ,SUM (C.ACTL_DISTRB_QTY)                             09756200
097563             ,SUM (D.MFST_UNT_QTY)                                09756300
097567        FROM  TCEPLIT  B                                          09756700
097568             ,TCEPLDS  C                                          09756800
097569             ,TCEPLMF  D                                          09756900
097570       WHERE  B.CNSTK_REQ_PL_NBR  =  :DK-CNSTK-REQ-PL-NBR         09757000
097571         AND  B.CNSTK_REQ_PL_NBR  =  C.CNSTK_REQ_PL_NBR           09757100
097572         AND  B.CNSTK_REQ_PL_NBR  =  D.CNSTK_REQ_PL_NBR           09757200
097573         AND  B.PL_LNE_NBR        =  C.PL_LNE_NBR                 09757300
097574         AND  B.PL_LNE_NBR        =  D.PL_LNE_NBR                 09757400
097575         AND  C.STR_NBR           =  D.STR_NBR                    09757500
097576         AND  B.PL_LNE_NBR        >= :DK-LINE-BEGIN               09757600
097577         AND  B.PL_LNE_NBR        <= :DK-LINE-END                 09757700
097578         AND  C.STR_NBR           >= :DK-STR-BEGIN                09757800
097579         AND  C.STR_NBR           <= :DK-STR-END                  09757900
097580       GROUP BY B.PL_LNE_NBR, B.STAT_CDE                          09758000
097607     END-EXEC.                                                    09760700
097608* JAK 09/2009 WR37075 END                                         09760800
097621                                                                  09762100
097622* DMH 11/16/11 - BEGIN                                            09762203
097623*---------------------------------------------------------------* 09762303
097624*  CURSOR TO GET INFORMATION FOR FAST TRANSFERS                   09762403
097625*---------------------------------------------------------------* 09762503
097626     EXEC SQL                                                     09762603
097627          DECLARE FX-FAST-TRANSFER-CSR CURSOR FOR                 09762703
097628           SELECT                                                 09762808
097629                   B.TRN_LNE_NBR                                  09762908
097630                 , SUM(B.SHPD_UNT_QTY)                            09763008
097631             FROM  SUT_OTBND_CART A                               09763108
097632                 , SUT_OTBND_UPC B                                09763208
097633            WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID               09763308
097634              AND A.CART_SRC_CDE  =  'FXR'                        09763408
097635              AND B.TRN_NBR       =  1214002572                   09763508
097636            GROUP BY B.TRN_LNE_NBR                                09763608
097660     END-EXEC.                                                    09766003
097661* DMH 11/16/11 - END                                              09766103
097662                                                                  09766203
097670*---------------------------------------------------------------* 09767000
097700*---------------------------------------------------------------* 09770000
097800     EXEC SQL                                                     09780000
097900          INCLUDE SQLCA                                           09790000
098000     END-EXEC.                                                    09800000
098100                                                                  09810000
098200*-----------------------------------------------------------------09820000
098300 LINKAGE SECTION.                                                 09830000
098400                                                                  09840000
098500 01  DFHCOMMAREA.                                                 09850000
098600     05  FILLER                         OCCURS  1 TO 4072 TIMES   09860000
098700                                        DEPENDING ON EIBCALEN.    09870000
098800         10  FILLER                     PIC X.                    09880000
098900                                                                  09890000
099000                                                                  09900000
099100 PROCEDURE DIVISION.                                              09910000
099200******************************************************************09920000
099300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09930000
099400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09940000
099500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09950000
099600******************************************************************09960000
099700 0000-MAIN-MODULE.                                                09970000
099800     INITIALIZE DP030-CICS-API-FIELDS.                            09980000
099900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09990000
100000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          10000000
100100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         10010000
100200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       10020000
100300     MOVE LENGTH OF SU598AI        TO DP030-MAP-LENGTH (1).       10030000
100400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10040000
100500     PERFORM 0001-CALL-CICS-ARCH-API.                             10050000
100600                                                                  10060000
100700     PERFORM 1000-CONTROL-PROCESSING                              10070000
100800*                                                                 10080000
100900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10090000
101000     PERFORM 0001-CALL-CICS-ARCH-API.                             10100000
101100                                                                  10110000
101200******************************************************************10120000
101300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **10130000
101400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10140000
101500******************************************************************10150000
101600 0001-CALL-CICS-ARCH-API.                                         10160000
101700*    CALL 'DPKCS030' USING DFHEIBLK                               10170024
101710     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10171024
101800                           DFHCOMMAREA                            10180000
101900                           DP030-CICS-API-FIELDS                  10190000
102000                           DP020-STANDARD-COMMAREA                10200000
102100                           SU598AI.                               10210000
102200*                                                                 10220000
102300     IF  DP030-RC-CALL-SUCCESSFUL                                 10230000
102400         CONTINUE                                                 10240000
102500     ELSE                                                         10250000
102600         SET DP013-NO-ROLLBACK                                    10260000
102700             DP013-XCTL-DISPLAY-RESTART                           10270000
102800             DP013-CICS-ABEND      TO TRUE                        10280000
102900         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        10290000
103000*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX10300024
103100*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      10310024
103110         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10311024
103120-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10312024
103200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10320000
103300         PERFORM DP013-0000-PROCESS-ABEND                         10330000
103400     END-IF.                                                      10340000
103500                                                                  10350000
103600*----------------------------------------------------------------*10360000
103700* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10370000
103800* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10380000
103900*                                                                *10390000
104000* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10400000
104100*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10410000
104200*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10420000
104300*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10430000
104400*----------------------------------------------------------------*10440000
104500 1000-CONTROL-PROCESSING.                                         10450000
104600                                                                  10460000
104700     EVALUATE TRUE                                                10470000
104800         WHEN DP020-NEXT-ACT-INITIAL                              10480000
104900                 INITIALIZE ASC-SPECIFIC-COMMAREA                 10490000
105000                 MOVE EIBTRMID         TO ASC-LIST-TERM-ID        10500000
105100                                          ASC-SEL-TERM-ID         10510000
105200                                          ASC-SEL-TERM-ID-2       10520000
105300               MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER 10530000
105400                                             ASC-SEL-TASK-NUMBER  10540000
105500                                             ASC-SEL-TASK-NUMBER-210550000
105600                 MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ          10560000
105700                 MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ             10570000
105800                                          ASC-SEL-SEQ-2           10580000
105900                 PERFORM 1100-PROCESS-INTER-APPL-COMM             10590000
106000                 PERFORM 4000-BUILD-INITIAL-PANEL                 10600000
106100                                                                  10610000
106200         WHEN DP020-NEXT-ACT-READ-MAP                             10620000
106300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         10630000
106400             PERFORM 2000-PROCESS-PANEL                           10640000
106500                                                                  10650000
106600         WHEN DP020-NEXT-ACT-RETURN                               10660000
106700             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         10670000
106800             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               10680000
106900                                                                  10690000
107000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 10700000
107100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10710000
107200                                                                  10720000
107300         WHEN OTHER                                               10730000
107400             SET DP013-LOGIC-ABEND TO TRUE                        10740000
107500             SET DP013-NO-ROLLBACK TO TRUE                        10750000
107600             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    10760000
107700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10770000
107800                                   TO DP013-MESSAGE-TEXT(1)       10780000
107900             PERFORM DP013-0000-PROCESS-ABEND                     10790000
108000     END-EVALUATE.                                                10800000
108100                                                                  10810000
108200*----------------------------------------------------------------*10820000
108300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10830000
108400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10840000
108500*----------------------------------------------------------------*10850000
108600 1100-PROCESS-INTER-APPL-COMM.                                    10860000
108700                                                                  10870000
108800     SET PS-COMMAREA-VALID         TO TRUE.                       10880000
108900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10890000
109000                                                                  10900000
109100     IF   DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT         10910000
109200          MOVE SU008-PO-NBR           TO ASC-PO-NBR               10920000
109300          MOVE SU008-RCVR-NBR         TO ASC-RCVR-NBR             10930000
109400          MOVE SU008-LINE-NBR         TO ASC-LINE-NUMBER          10940000
109500          MOVE SU008-DEST-STR-NBR     TO ASC-STR-NBR              10950000
109510* TKMAV49 - BEG                                                   10951000
109520          MOVE SU008-OPER-UNT-ID      TO PV-OPER-UNT-ID           10952000
109530* TKMAV49 - END                                                   10953000
109540                                                                  10954003
109541* DMH - 11/16/11 BEGIN                                            10954104
109542          SET  ASC-NOT-CS-PULL-TRAN                               10954203
109543               ASC-NOT-FX-FAST-TRANSFER  TO TRUE                  10954303
109560          IF  SU008-CS-PULL-TRAN                                  10956003
109561              SET  ASC-CS-PULL-TRAN      TO TRUE                  10956103
109562          END-IF                                                  10956203
109563          IF  SU008-FX-FAST-TRANSFER                              10956303
109564              SET  ASC-FX-FAST-TRANSFER  TO  TRUE                 10956403
109565          END-IF                                                  10956503
109570* DMH - 11/16/11 END                                              10957003
109580                                                                  10958003
109600     ELSE                                                         10960000
109700          SET ASC-USE-SELECTION-QUEUE TO TRUE                     10970000
109800          MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                  10980000
109900                                      ASC-NUMBER-OF-SELECTED-ITEMS10990000
110000          MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS 11000000
110100          MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN  11010000
110200          MOVE SU009-OPER-UNT-ID        TO ASC-CURR-OPER-UNT-ID   11020000
110300          MOVE SU009-PO-RCVR            TO DK-PO-RCVR             11030000
110400          MOVE DK-TRN-NBR               TO ASC-PO-NBR             11040000
110500          MOVE DK-RCVR-NBR              TO ASC-RCVR-NBR           11050000
110600          MOVE SU009-LINE-NBR           TO ASC-LINE-NUMBER        11060000
110700          MOVE SU009-DEST-STR-NBR       TO ASC-STR-NBR            11070000
110800          PERFORM 1120-PREPARE-LIST-ENTRY                         11080000
110900     END-IF.                                                      11090000
111000                                                                  11100000
111100*-----------------------------------------------------------------11110000
111200*  PREPARE LIST ENTRY                                             11120000
111300*-----------------------------------------------------------------11130000
111400 1120-PREPARE-LIST-ENTRY.                                         11140000
111500                                                                  11150000
111600     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                11160000
111700     MOVE ZERO                     TO ASC-SEL-ITEM.               11170000
111800     PERFORM 1130-GET-NEXT-RECORD.                                11180000
111900                                                                  11190000
112000*-----------------------------------------------------------------11200000
112100*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*11210000
112200*-----------------------------------------------------------------11220000
112300 1130-GET-NEXT-RECORD.                                            11230000
112400     ADD +1                       TO ASC-SEL-SUB.                 11240000
112500                                                                  11250000
112600     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            11260000
112700         ADD +1                   TO ASC-SEL-ITEM                 11270000
112800         MOVE +1                  TO ASC-SEL-SUB                  11280000
112900     END-IF.                                                      11290000
113000                                                                  11300000
113100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                11310000
113200         PERFORM 9100-READ-SEL-QUEUE                              11320000
113300         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      11330000
113400             MOVE SU010-PO-RCVR (ASC-SEL-SUB)   TO ASC-PO-RCVR    11340000
113500             MOVE ASC-PO-RCVR                   TO DK-PO-RCVR     11350000
113600             MOVE DK-TRN-NBR                    TO ASC-PO-NBR     11360000
113700             MOVE DK-RCVR-NBR                   TO ASC-RCVR-NBR   11370000
113800             MOVE SU010-LINE-NBR (ASC-SEL-SUB)  TO ASC-LINE-NUMBER11380000
113900             MOVE SU010-LINE-STAT (ASC-SEL-SUB) TO ASC-STATUS-CDE 11390000
114000             MOVE SU010-UNTS-VRFD (ASC-SEL-SUB) TO ASC-UNTS-VRFD  11400000
114100             MOVE SU010-UNTS-MFSD(ASC-SEL-SUB)  TO ASC-UNTS-MFST  11410000
114200             MOVE SU010-UNTS-VARI (ASC-SEL-SUB) TO ASC-UNTS-VARI  11420000
114300             MOVE SU010-TOT-CRTNS (ASC-SEL-SUB) TO ASC-LINE-COUNT 11430000
114400             MOVE SU010-TRIP-ID (ASC-SEL-SUB)   TO ASC-TRIP-ID    11440000
114500             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  11450000
114600             PERFORM 9200-REWRITE-SEL-QUEUE                       11460000
114700         ELSE                                                     11470000
114800             SUBTRACT +1 FROM ASC-SEL-SUB                         11480000
114900             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             11490000
115000             SET DP020-MSG-INFORMATIONAL                          11500000
115100                 PS-LIST-END             TO TRUE                  11510000
115200         END-IF                                                   11520000
115300     ELSE                                                         11530000
115400         SUBTRACT +1 FROM ASC-SEL-ITEM                            11540000
115500         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  11550000
115600         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             11560000
115700         SET DP020-MSG-INFORMATIONAL                              11570000
115800             PS-LIST-END             TO TRUE                      11580000
115900     END-IF.                                                      11590000
116000                                                                  11600000
116100*----------------------------------------------------------------*11610000
116200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *11620000
116300*    PROCESSED.                                                  *11630000
116400*----------------------------------------------------------------*11640000
116500 1140-GET-PREV-RECORD.                                            11650000
116600     SUBTRACT +1 FROM ASC-SEL-SUB.                                11660000
116700                                                                  11670000
116800     IF  ASC-SEL-SUB < +1                                         11680000
116900         SUBTRACT +1 FROM ASC-SEL-ITEM                            11690000
117000         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  11700000
117100     END-IF.                                                      11710000
117200                                                                  11720000
117300     IF  ASC-SEL-ITEM > ZERO                                      11730000
117400         PERFORM 9100-READ-SEL-QUEUE                              11740000
117500         MOVE SU010-PO-RCVR (ASC-SEL-SUB)   TO ASC-PO-RCVR        11750000
117600         MOVE ASC-PO-RCVR                   TO DK-PO-RCVR         11760000
117700         MOVE DK-TRN-NBR                    TO ASC-PO-NBR         11770000
117800         MOVE DK-RCVR-NBR                   TO ASC-RCVR-NBR       11780000
117900         MOVE SU010-LINE-NBR (ASC-SEL-SUB)  TO ASC-LINE-NUMBER    11790000
118000         MOVE SU010-LINE-STAT (ASC-SEL-SUB) TO ASC-STATUS-CDE     11800000
118100         MOVE SU010-UNTS-VRFD (ASC-SEL-SUB) TO ASC-UNTS-VRFD      11810000
118200         MOVE SU010-UNTS-MFSD(ASC-SEL-SUB)  TO ASC-UNTS-MFST      11820000
118300         MOVE SU010-UNTS-VARI (ASC-SEL-SUB) TO ASC-UNTS-VARI      11830000
118400         MOVE SU010-TOT-CRTNS (ASC-SEL-SUB) TO ASC-LINE-COUNT     11840000
118500         MOVE SU010-TRIP-ID (ASC-SEL-SUB)   TO ASC-TRIP-ID        11850000
118600         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      11860000
118700         PERFORM 9200-REWRITE-SEL-QUEUE                           11870000
118800     ELSE                                                         11880000
118900         MOVE +1                  TO ASC-SEL-ITEM                 11890000
119000                                     ASC-SEL-SUB                  11900000
119100         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11910000
119200         SET DP020-MSG-INFORMATIONAL                              11920000
119300             PS-LIST-END             TO TRUE                      11930000
119400     END-IF.                                                      11940000
119500                                                                  11950000
119600*----------------------------------------------------------------*11960000
119700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11970000
119800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11980000
119900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11990000
120000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12000000
120100* FUNCTION KEYS CAN GET THIS FAR.                                *12010000
120200*----------------------------------------------------------------*12020000
120300 2000-PROCESS-PANEL.                                              12030000
120400     EVALUATE TRUE                                                12040000
120500         WHEN DP020-SRC-AID = DP016-CLEAR                         12050000
120600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12060000
120700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12070000
120800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12080000
120900                                                                  12090000
121000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12100000
121100             PERFORM 2050-DELETE-LIST-QUEUE                       12110000
121200             PERFORM 4000-BUILD-INITIAL-PANEL                     12120000
121300                                                                  12130000
121400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12140000
121500             PERFORM 2140-DESELECT-ALL-ITEMS                      12150000
121600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12160000
121700                                                                  12170000
121800*F21                                                              12180000
121900         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  12190000
122000             PERFORM 2150-SELECT-ALL-ITEMS                        12200000
122100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12210000
122200                                                                  12220000
122300*F20                                                              12230000
122400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12240000
122500             IF  ASC-USE-SELECTION-QUEUE                          12250000
122600                 PERFORM 1130-GET-NEXT-RECORD                     12260000
122700                 IF PS-LIST-END                                   12270000
122800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12280000
122900                     SET PS-NO-LIST-END TO TRUE                   12290000
123000                 ELSE                                             12300000
123100                     PERFORM 2050-DELETE-LIST-QUEUE               12310000
123200                     PERFORM 3200-RESET-ATTRIBUTES                12320000
123300                     PERFORM 4000-BUILD-INITIAL-PANEL             12330000
123400                 END-IF                                           12340000
123500              ELSE                                                12350000
123600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12360000
123700*                --- BOTTOM OF LIST ---                           12370000
123800                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         12380000
123900                 SET DP020-MSG-INFORMATIONAL TO TRUE              12390000
124000             END-IF                                               12400000
124100                                                                  12410000
124200*F19                                                              12420000
124300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12430000
124400             IF  ASC-USE-SELECTION-QUEUE                          12440000
124500                 PERFORM 1140-GET-PREV-RECORD                     12450000
124600                 IF PS-LIST-END                                   12460000
124700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12470000
124800                     SET PS-NO-LIST-END TO TRUE                   12480000
124900                 ELSE                                             12490000
125000                     PERFORM 2050-DELETE-LIST-QUEUE               12500000
125100                     PERFORM 3200-RESET-ATTRIBUTES                12510000
125200                     PERFORM 4000-BUILD-INITIAL-PANEL             12520000
125300                 END-IF                                           12530000
125400             ELSE                                                 12540000
125500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12550000
125600                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         12560000
125700                 SET DP020-MSG-INFORMATIONAL TO TRUE              12570000
125800             END-IF                                               12580000
125900                                                                  12590000
126000         WHEN OTHER                                               12600000
126100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12610000
126200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12620000
126300                                                                  12630000
126400             IF  PS-NO-ERROR                                      12640000
126500                 SET DP030-CONTINUE-GO TO TRUE                    12650000
126600                 PERFORM 2100-CHECK-FUNCTION-KEY                  12660000
126700             ELSE                                                 12670000
126800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12680000
126900                 SET DP030-OVERRIDE-GO TO TRUE                    12690000
127000             END-IF                                               12700000
127100     END-EVALUATE.                                                12710000
127200                                                                  12720000
127300*----------------------------------------------------------------*12730000
127400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12740000
127500*----------------------------------------------------------------*12750000
127600 2050-DELETE-LIST-QUEUE.                                          12760000
127700                                                                  12770000
127800     EXEC CICS                                                    12780000
127900         DELETEQ TS                                               12790000
128000             QUEUE (ASC-LIST-QUEUE-NAME)                          12800000
128100             RESP  (PV-CICS-RESP)                                 12810000
128200     END-EXEC.                                                    12820000
128300                                                                  12830000
128400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12840000
128500        (PV-CICS-RESP = DFHRESP(QIDERR))                          12850000
128600         CONTINUE                                                 12860000
128700     ELSE                                                         12870000
128800         SET DP013-CICS-ABEND      TO TRUE                        12880000
128900         SET DP013-NO-ROLLBACK     TO TRUE                        12890000
129000                                                                  12900000
129100         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         12910000
129200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12920000
129300                                   TO DP013-MESSAGE-TEXT (1)      12930000
129400         PERFORM DP013-0000-PROCESS-ABEND                         12940000
129500     END-IF.                                                      12950000
129600                                                                  12960000
129700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12970000
129800                                                                  12980000
129900*----------------------------------------------------------------*12990000
130000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13000000
130100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13010000
130200* CICS ARCHITECTURE API.                                         *13020000
130300*----------------------------------------------------------------*13030000
130400 2100-CHECK-FUNCTION-KEY.                                         13040000
130500                                                                  13050000
130600                                                                  13060000
130700     EVALUATE TRUE                                                13070000
130800                                                                  13080000
130900*F23 = OUTBOUND PO/RCVR CARTON LIST                               13090000
131000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13100000
131100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13110000
131200                 INITIALIZE SU009-INTER-APPL-COMMAREA             13120000
131300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13130000
131400                           TO SU009-NUMBER-OF-SELECTED-ITEMS      13140000
131500                 MOVE ASC-CURR-OPER-UNT-ID                        13150000
131600                                  TO SU009-OPER-UNT-ID            13160000
131700                 MOVE ASC-PO-RCVR      TO SU009-PO-RCVR           13170000
131800                 MOVE ASC-LINE-NUMBER  TO SU009-LINE-NBR          13180000
131900                 MOVE ASC-STR-NBR      TO SU009-DEST-STR-NBR      13190000
132000                 MOVE ASC-OUTBND-CRTNS TO SU009-TOT-CRTNS         13200000
132100                 MOVE ASC-PACKAGE      TO SU009-PACKAGE           13210000
132110                 IF  ASC-CS-PULL-TRAN                             13211021
132120                     SET  SU009-CS-PULL-TRAN  TO  TRUE            13212021
132130                 END-IF                                           13213021
132140                 IF  ASC-FX-FAST-TRANSFER                         13214021
132150                     SET  SU009-FX-FAST-TRANSFER  TO TRUE         13215021
132160                 END-IF                                           13216021
132200                 PERFORM 5000-PREPARE-SEL-QUEUE                   13220000
132300             ELSE                                                 13230000
132400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13240000
132500                 SET DP030-OVERRIDE-GO TO TRUE                    13250000
132600                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         13260000
132700                 SET DP020-MSG-WARNING TO TRUE                    13270000
132800             END-IF                                               13280000
132900                                                                  13290000
133000*F24 = STORE UNIT ADJUSTMENT ACTIVITY LIST                        13300000
133100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13310000
133200             SET ASC-FUNC02-RETURN-YES TO TRUE                    13320000
133300             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13330000
133400                 INITIALIZE SU038-INTER-APPL-COMMAREA             13340000
133500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13350000
133600                           TO SU038-NUMBER-OF-SELECTED-ITEMS      13360000
133700                 MOVE ASC-CURR-OPER-UNT-ID                        13370000
133800                                  TO SU038-OPER-UNT-ID            13380000
133900                 MOVE ASC-PO-NBR       TO DK-PO-TRN-NBR           13390000
134000                 MOVE DK-TRN-NBR-X     TO DK-TRN-NBR-9            13400000
134100                 MOVE DK-TRN-NBR-8     TO DK-TRN-NBR-4            13410000
134200                 MOVE ASC-RCVR-NBR     TO DK-PO-RCVR-NBR-N        13420000
134300                 MOVE DK-RCVR-NBR-X    TO DK-RCVR-NBR-4A          13430000
134400                 MOVE DK-RCVR-NBR-40   TO DK-RCVR-NBR-4           13440000
134500                 MOVE DK-PO-RCVR-4     TO SU038-PO-RCVR           13450000
134600                 MOVE 'A'              TO SU038-UNT-ADJ-TYP       13460000
134700                                          SU038-FAIL-SUCCSS       13470000
134800                 EXEC SQL                                         13480000
134900                     SET :PV-CURRENT-DATE  = CURRENT DATE         13490000
135000                 END-EXEC                                         13500000
135100                 EXEC SQL                                         13510000
135200                     SET :PV-DEFAULT-FROM-DATE =                  13520000
135300                                            CURRENT DATE - 14 DAYS13530000
135400                 END-EXEC                                         13540000
135500                 MOVE PV-CURR-YY TO PV-TO-YY                      13550000
135600                 MOVE PV-CURR-MM TO PV-TO-MM                      13560000
135700                 MOVE PV-CURR-DD TO PV-TO-DD                      13570000
135800                 MOVE PV-TO-DATE-HOLD TO SU038-TO-DATE            13580000
135900                 MOVE PV-DFLT-YY TO PV-FROM-YY                    13590000
136000                 MOVE PV-DFLT-MM TO PV-FROM-MM                    13600000
136100                 MOVE PV-DFLT-DD TO PV-FROM-DD                    13610000
136200                 MOVE PV-FROM-DATE-HOLD TO SU038-FROM-DATE        13620000
136300                 PERFORM 5000A-PREPARE-SEL-QUEUE                  13630000
136400             ELSE                                                 13640000
136500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13650000
136600                 SET DP030-OVERRIDE-GO TO TRUE                    13660000
136700                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         13670000
136800                 SET DP020-MSG-WARNING TO TRUE                    13680000
136900             END-IF                                               13690000
137000                                                                  13700000
137100*                                                                 13710000
137200* F6 - FIRST PAGE                                                 13720000
137300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13730000
137400             MOVE +1               TO PV-TOP-ITEM                 13740000
137500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13750000
137600*                                                                 13760000
137700* F7 - PREVIOUS PAGE                                              13770000
137800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13780000
137900             PERFORM 2110-BROWSE-BACKWARD                         13790000
138000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13800000
138100*                                                                 13810000
138200* F8 - NEXT PAGE                                                  13820000
138300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13830000
138400             PERFORM 2120-BROWSE-FORWARD                          13840000
138500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13850000
138600*                                                                 13860000
138700* ENTER KEY                                                       13870000
138800         WHEN DP020-SRC-AID = DP016-ENTER                         13880000
138900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13890000
139000             IF  PS-ERROR                                         13900000
139100                 CONTINUE                                         13910000
139200             ELSE                                                 13920000
139300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13930000
139400             END-IF                                               13940000
139500                                                                  13950000
139600         WHEN OTHER                                               13960000
139700             SET DP013-NO-ROLLBACK                                13970000
139800                 DP013-XCTL-DISPLAY-RESTART                       13980000
139900                 DP013-CICS-ABEND  TO TRUE                        13990000
140000             MOVE '2100-CHECK-FUNCTION-KEY'                       14000000
140100                                   TO DP013-PARAGRAPH             14010000
140200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14020000
140300                                   TO DP013-MESSAGE-TEXT (1)      14030000
140400             PERFORM DP013-0000-PROCESS-ABEND                     14040000
140500     END-EVALUATE.                                                14050000
140600*                                                                 14060000
140700*----------------------------------------------------------------*14070000
140800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14080000
140900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14090000
141000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14100000
141100*    MESSAGE.                                                    *14110000
141200*----------------------------------------------------------------*14120000
141300 2110-BROWSE-BACKWARD.                                            14130000
141400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14140000
141500         GIVING PV-TOP-ITEM.                                      14150000
141600*                                                                 14160000
141700     IF  ((PV-TOP-ITEM < +1)                                      14170000
141800       OR (PV-TOP-ITEM = +1))                                     14180000
141900         MOVE +1                   TO PV-TOP-ITEM                 14190000
142000*        -- TOP OF LIST --                                        14200000
142100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14210000
142200         SET DP020-MSG-INFORMATIONAL TO TRUE                      14220000
142300     END-IF.                                                      14230000
142400                                                                  14240000
142500*----------------------------------------------------------------*14250000
142600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14260000
142700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14270000
142800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14280000
142900*----------------------------------------------------------------*14290000
143000 2120-BROWSE-FORWARD.                                             14300000
143100                                                                  14310000
143200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14320000
143300         GIVING PV-TOP-ITEM.                                      14330000
143400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   14340000
143500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             14350000
143600*        -- BOTTOM OF LIST --                                     14360000
143700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14370000
143800         SET DP020-MSG-INFORMATIONAL  TO TRUE                     14380000
143900     ELSE                                                         14390000
144000         COMPUTE PV-BOTTOM-ITEM =                                 14400000
144100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14410000
144200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14420000
144300*            -- BOTTOM OF LIST --                                 14430000
144400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14440000
144500             SET DP020-MSG-INFORMATIONAL TO TRUE                  14450000
144600         END-IF                                                   14460000
144700     END-IF.                                                      14470000
144800                                                                  14480000
144900*----------------------------------------------------------------*14490000
145000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14500000
145100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14510000
145200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14520000
145300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14530000
145400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14540000
145500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14550000
145600*----------------------------------------------------------------*14560000
145700 2130-CHECK-FOR-JUMP-BROWSE.                                      14570000
145800     SET PS-NO-ERROR               TO TRUE.                       14580000
145900     IF (ASC-START-ITEM-REQUEST = SPACE)                          14590000
146000         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             14600000
146100     ELSE                                                         14610000
146200         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     14620000
146300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       14630000
146400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     14640000
146500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14650000
146610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14661023
146620              USING DP010I-NUMERIC-EDIT-AREA                      14662023
146700                                                                  14670000
146800         IF  NOT DP010I-ERROR-DETECTED                            14680000
146900             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N14690000
147000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14700000
147100                 IF  ASC-START-ITEM-REQUEST-N >                   14710000
147200                                          ASC-NUMBER-OF-ITEMS-READ14720000
147300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14730000
147400                     COMPUTE PV-TOP-ITEM =                        14740000
147500                             ASC-NUMBER-OF-ITEMS-READ             14750000
147600                             - PC-ITEMS-PER-PANEL + 1             14760000
147700                     IF  PV-TOP-ITEM < +1                         14770000
147800                         MOVE +1   TO PV-TOP-ITEM                 14780000
147900                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 14790000
148000                         SET DP020-MSG-INFORMATIONAL TO TRUE      14800000
148100                     END-IF                                       14810000
148200                 ELSE                                             14820000
148300                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 14830000
148400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14840000
148500                     COMPUTE PV-BOTTOM-ITEM =                     14850000
148600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     14860000
148700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ14870000
148800*                        -- BOTTOM OF LIST --                     14880000
148900                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 14890000
149000                         SET DP020-MSG-INFORMATIONAL TO TRUE      14900000
149100                     END-IF                                       14910000
149200                 END-IF                                           14920000
149300             ELSE                                                 14930000
149400*                --- VALUE OUT OF RANGE ----                      14940000
149500                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        14950000
149600                 MOVE -1           TO ASTRTITL                    14960000
149700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14970000
149800                 MOVE DP015-REVERSE TO ASTRTITH                   14980000
149900                 MOVE DP015-RED    TO ASTRTITC                    14990000
150000                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           15000000
150100                 SET DP020-MSG-FATAL                              15010000
150200                     PS-ERROR        TO TRUE                      15020000
150300             END-IF                                               15030000
150400         ELSE                                                     15040000
150500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15050000
150600             MOVE -1               TO ASTRTITL                    15060000
150700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15070000
150800             MOVE DP015-REVERSE    TO ASTRTITH                    15080000
150900             MOVE DP015-RED        TO ASTRTITC                    15090000
151000             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               15100000
151100             SET DP020-MSG-FATAL   TO TRUE                        15110000
151200             SET PS-ERROR          TO TRUE                        15120000
151300         END-IF                                                   15130000
151400     END-IF.                                                      15140000
151500                                                                  15150000
151600*----------------------------------------------------------------*15160000
151700*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *15170000
151800*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *15180000
151900*----------------------------------------------------------------*15190000
152000 2140-DESELECT-ALL-ITEMS.                                         15200000
152100     MOVE +1                       TO ASC-BLK-SUB.                15210000
152200                                                                  15220000
152300     PERFORM 2141-CLEAR-SELECTED-INDS                             15230000
152400         VARYING ASC-ITEM-SUB                                     15240000
152500         FROM 1 BY 1                                              15250000
152600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15260000
152700                                                                  15270000
152800     ADD +1                        TO ASC-BLK-SUB.                15280000
152900                                                                  15290000
153000     PERFORM 2141-CLEAR-SELECTED-INDS                             15300000
153100         VARYING ASC-ITEM-SUB                                     15310000
153200         FROM 1 BY 1                                              15320000
153300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15330000
153400                                                                  15340000
153500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15350000
153600                                   TO PV-LIST-ITEM-NUMBER.        15360000
153700                                                                  15370000
153800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15380000
153900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15390000
154000                                                                  15400000
154100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15410000
154200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      15420000
154300         MOVE +1                   TO ASC-BLK-SUB                 15430000
154400                                                                  15440000
154500         PERFORM 5100-WRITE-TEMP-STORAGE                          15450000
154600                                                                  15460000
154700         MOVE +1                   TO PV-BLOCK-NUMBER             15470000
154800                                                                  15480000
154900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15490000
155000             PV-FIRST-BLOCK-IN-ARRAY - 1                          15500000
155100                                                                  15510000
155200         PERFORM                                                  15520000
155300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15530000
155400                                                                  15540000
155500             PERFORM 4410-READ-TEMP-STORAGE                       15550000
155600                                                                  15560000
155700             PERFORM 2141-CLEAR-SELECTED-INDS                     15570000
155800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 15580000
155900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15590000
156000                                                                  15600000
156100             PERFORM 5100-WRITE-TEMP-STORAGE                      15610000
156200                                                                  15620000
156300             ADD +1                TO PV-BLOCK-NUMBER             15630000
156400                                                                  15640000
156500         END-PERFORM                                              15650000
156600                                                                  15660000
156700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15670000
156800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15680000
156900                                                                  15690000
157000         PERFORM                                                  15700000
157100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15710000
157200                   ASC-HIGHEST-BLOCK-WRITTEN                      15720000
157300                                                                  15730000
157400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15740000
157500                                   TO PV-BLOCK-NUMBER             15750000
157600                                                                  15760000
157700             PERFORM 4410-READ-TEMP-STORAGE                       15770000
157800                                                                  15780000
157900             PERFORM 2141-CLEAR-SELECTED-INDS                     15790000
158000                 VARYING ASC-ITEM-SUB                             15800000
158100                 FROM 1 BY 1                                      15810000
158200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15820000
158300                                                                  15830000
158400             PERFORM 5100-WRITE-TEMP-STORAGE                      15840000
158500                                                                  15850000
158600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15860000
158700                                                                  15870000
158800         END-PERFORM                                              15880000
158900                                                                  15890000
159000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15900000
159100                                   TO PV-BLOCK-NUMBER             15910000
159200                                                                  15920000
159300         PERFORM 4410-READ-TEMP-STORAGE                           15930000
159400     END-IF.                                                      15940000
159500                                                                  15950000
159600                                                                  15960000
159700     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 15970000
159800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15980000
159900     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15990000
160000                                                                  16000000
160100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16010000
160200                                                                  16020000
160300 EJECT                                                            16030000
160400*----------------------------------------------------------------*16040000
160500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *16050000
160600*----------------------------------------------------------------*16060000
160700                                                                  16070000
160800 2141-CLEAR-SELECTED-INDS.                                        16080000
160900                                                                  16090000
161000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16100000
161100             NOT EQUAL ZERO                                       16110000
161200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16120000
161300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16130000
161400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    16140000
161500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16150000
161600                                   TO TRUE                        16160000
161700         END-IF                                                   16170000
161800     END-IF.                                                      16180000
161900                                                                  16190000
162000 EJECT                                                            16200000
162100*----------------------------------------------------------------*16210000
162200*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *16220000
162300*  FOR ALL ITEMS.                                                *16230000
162400*----------------------------------------------------------------*16240000
162500                                                                  16250000
162600 2150-SELECT-ALL-ITEMS.                                           16260000
162700                                                                  16270000
162800     MOVE +1                       TO ASC-BLK-SUB.                16280000
162900                                                                  16290000
163000     PERFORM 2151-SET-SELECTED-INDS                               16300000
163100         VARYING ASC-ITEM-SUB                                     16310000
163200         FROM 1 BY 1                                              16320000
163300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16330000
163400                                                                  16340000
163500     ADD +1                        TO ASC-BLK-SUB.                16350000
163600                                                                  16360000
163700     PERFORM 2151-SET-SELECTED-INDS                               16370000
163800         VARYING ASC-ITEM-SUB                                     16380000
163900         FROM 1 BY 1                                              16390000
164000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16400000
164100                                                                  16410000
164200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16420000
164300                                   TO PV-LIST-ITEM-NUMBER.        16430000
164400                                                                  16440000
164500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16450000
164600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16460000
164700                                                                  16470000
164800                                                                  16480000
164900     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            16490000
165000         MOVE +1                   TO ASC-BLK-SUB                 16500000
165100                                                                  16510000
165200         PERFORM 5100-WRITE-TEMP-STORAGE                          16520000
165300         MOVE +2                   TO ASC-BLK-SUB                 16530000
165400         PERFORM 5100-WRITE-TEMP-STORAGE                          16540000
165500         MOVE +1                   TO ASC-BLK-SUB                 16550000
165600         MOVE +1                   TO PV-BLOCK-NUMBER             16560000
165700     END-IF.                                                      16570000
165800                                                                  16580000
165900                                                                  16590000
166000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16600000
166100        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    16610000
166200         MOVE +1                   TO ASC-BLK-SUB                 16620000
166300                                                                  16630000
166400         PERFORM 5100-WRITE-TEMP-STORAGE                          16640000
166500                                                                  16650000
166600         MOVE +1                   TO PV-BLOCK-NUMBER             16660000
166700                                                                  16670000
166800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16680000
166900             PV-FIRST-BLOCK-IN-ARRAY - 1                          16690000
167000                                                                  16700000
167100         PERFORM                                                  16710000
167200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16720000
167300                                                                  16730000
167400             PERFORM 4410-READ-TEMP-STORAGE                       16740000
167500                                                                  16750000
167600             PERFORM 2151-SET-SELECTED-INDS                       16760000
167700                 VARYING ASC-ITEM-SUB                             16770000
167800                 FROM 1 BY 1                                      16780000
167900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16790000
168000                                                                  16800000
168100             PERFORM 5100-WRITE-TEMP-STORAGE                      16810000
168200                                                                  16820000
168300             ADD +1                TO PV-BLOCK-NUMBER             16830000
168400                                                                  16840000
168500         END-PERFORM                                              16850000
168600                                                                  16860000
168700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16870000
168800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16880000
168900                                                                  16890000
169000         PERFORM                                                  16900000
169100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16910000
169200                   ASC-HIGHEST-BLOCK-WRITTEN                      16920000
169300                                                                  16930000
169400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16940000
169500                                   TO PV-BLOCK-NUMBER             16950000
169600                                                                  16960000
169700             PERFORM 4410-READ-TEMP-STORAGE                       16970000
169800                                                                  16980000
169900             PERFORM 2151-SET-SELECTED-INDS                       16990000
170000                 VARYING ASC-ITEM-SUB                             17000000
170100                 FROM 1 BY 1                                      17010000
170200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17020000
170300                                                                  17030000
170400             PERFORM 5100-WRITE-TEMP-STORAGE                      17040000
170500                                                                  17050000
170600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17060000
170700                                                                  17070000
170800         END-PERFORM                                              17080000
170900                                                                  17090000
171000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17100000
171100                                   TO PV-BLOCK-NUMBER             17110000
171200                                                                  17120000
171300         PERFORM 4410-READ-TEMP-STORAGE                           17130000
171400     END-IF.                                                      17140000
171500                                                                  17150000
171600                                                                  17160000
171700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             17170000
171800                       ASC-NUMBER-OF-SELECTED-ITEMS.              17180000
171900                                                                  17190000
172000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17200000
172100                                                                  17210000
172200 EJECT                                                            17220000
172300*----------------------------------------------------------------*17230000
172400*    MARK EACH ITEM AS BEING SELECTED.                           *17240000
172500*----------------------------------------------------------------*17250000
172600                                                                  17260000
172700 2151-SET-SELECTED-INDS.                                          17270000
172800                                                                  17280000
172900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17290000
173000             NOT EQUAL ZERO                                       17300000
173100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17310000
173200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17320000
173300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        17330000
173400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17340000
173500                               TO  TRUE                           17350000
173600         END-IF                                                   17360000
173700     END-IF.                                                      17370000
173800******************************************************************17380000
173900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **17390000
174000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **17400000
174100******************************************************************17410000
174200 2200-MOVE-SCREEN-TO-COMMAREA.                                    17420000
174300                                                                  17430000
174400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             17440000
174500     MOVE +1                       TO PV-SUB.                     17450000
174600*                                                                 17460000
174700     PERFORM 3100-SET-SUBSCRIPTS.                                 17470000
174800     IF  ASTRTITL > ZERO                                          17480000
174900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          17490000
175000     ELSE                                                         17500000
175100         IF  ASTRTITF = DP015-ERASE-EOF                           17510000
175200             INITIALIZE ASC-START-ITEM-REQUEST                    17520000
175300         END-IF                                                   17530000
175400     END-IF.                                                      17540000
175500                                                                  17550000
175600     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17560000
175700         VARYING PV-SUB                                           17570000
175800         FROM 1 BY 1                                              17580000
175900         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      17590000
176000******************************************************************17600000
176100** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**17610000
176200******************************************************************17620000
176300 2210-MOVE-LINES-TO-COMMAREA.                                     17630000
176400     IF  MR-SELECTL (PV-SUB) > ZERO                               17640000
176500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17650000
176600         MOVE MR-SELECTI (PV-SUB)                                 17660000
176700                                   TO ASC-TEMP-SELECTED-SW        17670000
176800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17680000
176900     ELSE                                                         17690000
177000         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                17700000
177100                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     17710000
177200                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        17720000
177300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17730000
177400         END-IF                                                   17740000
177500     END-IF.                                                      17750000
177600                                                                  17760000
177700     ADD +1                        TO ASC-ITEM-SUB.               17770000
177800                                                                  17780000
177900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17790000
178000         ADD +1                    TO ASC-BLK-SUB                 17800000
178100         MOVE +1                   TO ASC-ITEM-SUB                17810000
178200     END-IF.                                                      17820000
178300******************************************************************17830000
178400** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **17840000
178500** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **17850000
178600******************************************************************17860000
178700 3000-EDIT-DATA-IN-COMMAREA.                                      17870000
178800     SET PS-NO-ERROR               TO TRUE.                       17880000
178900     PERFORM 3200-RESET-ATTRIBUTES.                               17890000
179000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17900000
179100                                                                  17910000
179200**                                                                17920000
179300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17930000
179400* EDITTING IS DONE FROM THE BOTTOM UP.                            17940000
179500**                                                                17950000
179600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17960000
179700         ASC-ITEMS-DISPLAYED - 1.                                 17970000
179800     PERFORM 3100-SET-SUBSCRIPTS.                                 17980000
179900*                                                                 17990000
180000     IF  PS-NO-ERROR                                              18000000
180100         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        18010000
180200     END-IF.                                                      18020000
180300                                                                  18030000
180400     IF  PS-NO-ERROR                                              18040000
180500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18050000
180600     END-IF.                                                      18060000
180700*                                                                 18070000
180800     IF  ((PS-NO-ERROR)                                           18080000
180900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18090000
181000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18100000
181100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18110000
181200     END-IF.                                                      18120000
181300                                                                  18130000
181400*----------------------------------------------------------------*18140000
181500*   3005-EDIT-COMMAREA-BLOCKS                                    *18150000
181600*----------------------------------------------------------------*18160000
181700 3005-EDIT-COMMAREA-BLOCKS.                                       18170000
181800     MOVE +1                       TO PV-BLOCK-NUMBER.            18180000
181900     MOVE +1                       TO ASC-BLK-SUB.                18190000
182000     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               18200000
182100                                                                  18210000
182200     COMPUTE PV-BLOCK-NUMBER  =                                   18220000
182300        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 18230000
182400            PC-ITEMS-PER-PANEL.                                   18240000
182500                                                                  18250000
182600     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          18260000
182700                                                                  18270000
182800     PERFORM                                                      18280000
182900       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          18290000
183000          OR PS-ERROR                                             18300000
183100          OR PS-BLOCK-ERROR                                       18310000
183200                                                                  18320000
183300             COMPUTE PV-ITEMS-HOLD  =                             18330000
183400                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        18340000
183500                     PC-ITEMS-PER-PANEL - 1                       18350000
183600                                                                  18360000
183700             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       18370000
183800                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               18380000
183900                     FROM  PV-ITEMS-HOLD                          18390000
184000                   GIVING  PV-ITEMS-DIFF                          18400000
184100                 SUBTRACT  PV-ITEMS-DIFF                          18410000
184200                     FROM  PC-ITEMS-PER-PANEL                     18420000
184300                   GIVING  PV-ITEMS-HOLD                          18430000
184400                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              18440000
184500                                              ASC-ITEM-SUB        18450000
184600                                              ASC-ITEMS-DISPLAYED 18460000
184700             ELSE                                                 18470000
184800                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              18480000
184900                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        18490000
185000             END-IF                                               18500000
185100                                                                  18510000
185200                                                                  18520000
185300             PERFORM 3300-EDIT-SELECTIONS                         18530000
185400                     VARYING PV-SUB                               18540000
185500                        FROM PV-SUB BY -1                         18550000
185600                       UNTIL PV-SUB < +1                          18560000
185700                                                                  18570000
185800             MOVE +1               TO ASC-BLK-SUB                 18580000
185900                                                                  18590000
186000             PERFORM 5105-REWRITE-ASC-LISTQ                       18600000
186100                                                                  18610000
186200             MOVE +1                TO ASC-BLK-SUB                18620000
186300                                                                  18630000
186400             IF  PS-BLOCK-ERROR                                   18640000
186500                 SET  PS-ERROR     TO TRUE                        18650000
186600                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        18660000
186700                                   TO PV-TOP-ITEM                 18670000
186800             ELSE                                                 18680000
186900                 ADD  +1           TO PV-BLOCK-NUMBER             18690000
187000                 IF  PV-BLOCK-NUMBER >                            18700000
187100                     ASC-HIGHEST-BLOCK-WRITTEN                    18710000
187200                     MOVE +2       TO ASC-BLK-SUB                 18720000
187300                     PERFORM 4410-READ-TEMP-STORAGE               18730000
187400                     MOVE +1       TO ASC-BLK-SUB                 18740000
187500                 ELSE                                             18750000
187600                     PERFORM 4410-READ-TEMP-STORAGE               18760000
187700                     ADD  +1        TO PV-BLOCK-NUMBER            18770000
187800                     MOVE +2        TO ASC-BLK-SUB                18780000
187900                     PERFORM 4410-READ-TEMP-STORAGE               18790000
188000                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            18800000
188100                     MOVE +1        TO ASC-BLK-SUB                18810000
188200                 END-IF                                           18820000
188300             END-IF                                               18830000
188400     END-PERFORM.                                                 18840000
188500                                                                  18850000
188600     IF  PV-ORIGINAL-BLOCK  = +1    OR                            18860000
188700         PS-ERROR                   OR                            18870000
188800         PS-BLOCK-ERROR                                           18880000
188900         CONTINUE                                                 18890000
189000     ELSE                                                         18900000
189100         MOVE +1                 TO PV-BLOCK-NUMBER               18910000
189200         MOVE +1                 TO ASC-BLK-SUB                   18920000
189300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  18930000
189400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           18940000
189500         PERFORM 4410-READ-TEMP-STORAGE                           18950000
189600                                                                  18960000
189700         PERFORM                                                  18970000
189800           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              18980000
189900              OR PS-ERROR                                         18990000
190000              OR PS-BLOCK-ERROR                                   19000000
190100                                                                  19010000
190200                 COMPUTE PV-ITEMS-HOLD  =                         19020000
190300                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    19030000
190400                         PC-ITEMS-PER-PANEL - 1                   19040000
190500                                                                  19050000
190600                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     19060000
190700                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           19070000
190800                         FROM  PV-ITEMS-HOLD                      19080000
190900                       GIVING  PV-ITEMS-DIFF                      19090000
191000                     SUBTRACT  PV-ITEMS-DIFF                      19100000
191100                         FROM  PC-ITEMS-PER-PANEL                 19110000
191200                       GIVING  PV-ITEMS-HOLD                      19120000
191300                         MOVE  PV-ITEMS-HOLD TO PV-SUB            19130000
191400                                                ASC-ITEM-SUB      19140000
191500                                               ASC-ITEMS-DISPLAYED19150000
191600                 ELSE                                             19160000
191700                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          19170000
191800                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    19180000
191900                 END-IF                                           19190000
192000                                                                  19200000
192100                 PERFORM 3300-EDIT-SELECTIONS                     19210000
192200                         VARYING PV-SUB                           19220000
192300                            FROM PV-SUB BY -1                     19230000
192400                           UNTIL PV-SUB < +1                      19240000
192500                                                                  19250000
192600                 MOVE +1               TO ASC-BLK-SUB             19260000
192700                                                                  19270000
192800                 PERFORM 5105-REWRITE-ASC-LISTQ                   19280000
192900                                                                  19290000
193000                 MOVE +1                TO ASC-BLK-SUB            19300000
193100                                                                  19310000
193200                 IF  PS-BLOCK-ERROR                               19320000
193300                     SET  PS-ERROR     TO TRUE                    19330000
193400                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    19340000
193500                                       TO PV-TOP-ITEM             19350000
193600                 ELSE                                             19360000
193700                     ADD  +1            TO PV-BLOCK-NUMBER        19370000
193800                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      19380000
193900                         MOVE +2        TO ASC-BLK-SUB            19390000
194000                         PERFORM 4410-READ-TEMP-STORAGE           19400000
194100                         MOVE +1        TO ASC-BLK-SUB            19410000
194200                     ELSE                                         19420000
194300                         PERFORM 4410-READ-TEMP-STORAGE           19430000
194400                         ADD  +1        TO PV-BLOCK-NUMBER        19440000
194500                         MOVE +2        TO ASC-BLK-SUB            19450000
194600                         PERFORM 4410-READ-TEMP-STORAGE           19460000
194700                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        19470000
194800                         MOVE +1        TO ASC-BLK-SUB            19480000
194900                     END-IF                                       19490000
195000                 END-IF                                           19500000
195100     END-PERFORM.                                                 19510000
195200                                                                  19520000
195300*----------------------------------------------------------------*19530000
195400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *19540000
195500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*19550000
195600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *19560000
195700*                                                                *19570000
195800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *19580000
195900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *19590000
196000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *19600000
196100*    US IN THE 2ND BLOCK OF THE ARRAY.                           *19610000
196200*----------------------------------------------------------------*19620000
196300 3100-SET-SUBSCRIPTS.                                             19630000
196400                                                                  19640000
196500     COMPUTE ASC-ITEM-SUB =                                       19650000
196600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        19660000
196700                                                                  19670000
196800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19680000
196900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19690000
197000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               19700000
197100     ELSE                                                         19710000
197200         MOVE +1                     TO ASC-BLK-SUB               19720000
197300     END-IF.                                                      19730000
197400******************************************************************19740000
197500** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **19750000
197600******************************************************************19760000
197700 3200-RESET-ATTRIBUTES.                                           19770000
197800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   19780000
197900     MOVE DP015-GREEN              TO ASTRTITC.                   19790000
198000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   19800000
198100                                                                  19810000
198200     PERFORM                                                      19820000
198300         VARYING PV-SUB                                           19830000
198400         FROM 1 BY 1                                              19840000
198500         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        19850000
198600         MOVE DP015-UNP-ALP-NOR-OFF                               19860000
198700                                   TO MR-SELECTA (PV-SUB)         19870000
198800         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         19880000
198900         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         19890000
199000     END-PERFORM.                                                 19900000
199100******************************************************************19910000
199200** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **19920000
199300** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **19930000
199400** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **19940000
199500** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **19950000
199600******************************************************************19960000
199700 3300-EDIT-SELECTIONS.                                            19970000
199800     EVALUATE TRUE                                                19980000
199900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19990000
200000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         20000000
200100                 CONTINUE                                         20010000
200200         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         20020000
200300             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        20030000
200400                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   20040000
200500                 MOVE ASC-TEMP-SELECTED-SW                        20050000
200600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20060000
200700                                TO ASC-SELECTED-SW                20070000
200800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20080000
200900             END-IF                                               20090000
201000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20100000
201100                 = SPACE                                          20110000
201200             EVALUATE TRUE                                        20120000
201300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       20130000
201400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS20140000
201500                     MOVE SPACE TO ASC-SELECTED-SW                20150000
201600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20160000
201700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        20170000
201800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    20180000
201900                     MOVE SPACE TO ASC-SELECTED-SW                20190000
202000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20200000
202100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          20210000
202200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      20220000
202300                     MOVE SPACE TO ASC-SELECTED-SW                20230000
202400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20240000
202500             END-EVALUATE                                         20250000
202600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           20260000
202700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20270000
202800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20280000
202900             END-IF                                               20290000
203000             PERFORM 3310-EDIT-RANGE                              20300000
203100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             20310000
203200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20320000
203300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20330000
203400             END-IF                                               20340000
203500             PERFORM 3310-EDIT-RANGE                              20350000
203600         WHEN OTHER                                               20360000
203700             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           20370000
203800             SET DP020-MSG-FATAL    TO TRUE                       20380000
203900             MOVE -1                TO MR-SELECTL (PV-SUB)        20390000
204000             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 20400000
204100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        20410000
204200             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        20420000
204300             SET PS-ERROR TO TRUE                                 20430000
204400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20440000
204500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     20450000
204600                 MOVE SPACE         TO ASC-SELECTED-SW            20460000
204700                                        (ASC-BLK-SUB ASC-ITEM-SUB)20470000
204800             END-IF                                               20480000
204900     END-EVALUATE.                                                20490000
205000                                                                  20500000
205100     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 20510000
205200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               20520000
205300     IF  ASC-ITEM-SUB < 1                                         20530000
205400         SUBTRACT +1 FROM ASC-BLK-SUB                             20540000
205500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                20550000
205600     END-IF.                                                      20560000
205700                                                                  20570000
205800******************************************************************20580000
205900** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20590000
206000** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20600000
206100** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20610000
206200** THE ENDING.                                                  **20620000
206300******************************************************************20630000
206400 3310-EDIT-RANGE.                                                 20640000
206500     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20650000
206600         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20660000
206700             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20670000
206800                                   TO ASC-SELECTED-SW             20680000
206900                                        (ASC-BLK-SUB ASC-ITEM-SUB)20690000
207000             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20700000
207100         ELSE                                                     20710000
207200             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20720000
207300                 CONTINUE                                         20730000
207400             ELSE                                                 20740000
207500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20750000
207600                 MOVE PC-TSYMSG-00054                             20760000
207700                                       TO DP020-MSG-NUMBER        20770000
207800                 MOVE -1               TO ASTRTITL                20780000
207900                 SET DP020-MSG-FATAL                              20790000
208000                     DP030-SET-CURSOR-APPL-1                      20800000
208100                     PS-ERROR          TO TRUE                    20810000
208200             END-IF                                               20820000
208300         END-IF                                                   20830000
208400     ELSE                                                         20840000
208500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20850000
208600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20860000
208700                                   TO ASC-SELECTED-SW             20870000
208800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20880000
208900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20890000
209000         ELSE                                                     20900000
209100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20910000
209200                 CONTINUE                                         20920000
209300             ELSE                                                 20930000
209400*                -- ONLY ONE END-OF-RANGE ALLOWED --              20940000
209500                 MOVE PC-TSYMSG-00055                             20950000
209600                                        TO DP020-MSG-NUMBER       20960000
209700                 MOVE -1                TO ASTRTITL               20970000
209800                 SET DP020-MSG-FATAL                              20980000
209900                     DP030-SET-CURSOR-APPL-1                      20990000
210000                     PS-ERROR           TO TRUE                   21000000
210100             END-IF                                               21010000
210200         END-IF                                                   21020000
210300     END-IF.                                                      21030000
210400*                                                                 21040000
210500******************************************************************21050000
210600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **21060000
210700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **21070000
210800******************************************************************21080000
210900 3400-CHECK-RANGE-SEQUENCE.                                       21090000
211000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       21100000
211100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      21110000
211200       AND  ASC-START-OF-SELECTED-RANGE >                         21120000
211300                                         ASC-END-OF-SELECTED-RANGE21130000
211400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                21140000
211500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 21150000
211600         SET DP020-MSG-FATAL TO TRUE                              21160000
211700         SET PS-ERROR TO TRUE                                     21170000
211800         PERFORM 3410-POSITION-AT-ERROR                           21180000
211900     END-IF.                                                      21190000
212000******************************************************************21200000
212100** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **21210000
212200** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **21220000
212300** SHOULD BE POSITIONED ON A RANGE ERROR.                       **21230000
212400******************************************************************21240000
212500 3410-POSITION-AT-ERROR.                                          21250000
212600     SET DP030-SET-CURSOR-APPL-1                                  21260000
212700                                   TO TRUE.                       21270000
212800     MOVE -1                       TO ASTRTITL                    21280000
212900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 21290000
213000                    - PV-TOP-ITEM + 1.                            21300000
213100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21310000
213200         CONTINUE                                                 21320000
213300     END-IF.                                                      21330000
213400*                                                                 21340000
213500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   21350000
213600                    - PV-TOP-ITEM + 1.                            21360000
213700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21370000
213800         CONTINUE                                                 21380000
213900     END-IF.                                                      21390000
214000                                                                  21400000
214100*----------------------------------------------------------------*21410000
214200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21420000
214300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21430000
214400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21440000
214500*----------------------------------------------------------------*21450000
214600 3500-MARK-RANGE-AS-SELECTED.                                     21460000
214700     MOVE +1                       TO  ASC-BLK-SUB.               21470000
214800     PERFORM 3510-MARK-SELECTED-INDS                              21480000
214900         VARYING ASC-ITEM-SUB                                     21490000
215000         FROM 1 BY 1                                              21500000
215100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21510000
215200                                                                  21520000
215300     ADD +1                        TO ASC-BLK-SUB.                21530000
215400     PERFORM 3510-MARK-SELECTED-INDS                              21540000
215500         VARYING ASC-ITEM-SUB                                     21550000
215600         FROM 1 BY 1                                              21560000
215700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21570000
215800                                                                  21580000
215900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21590000
216000                                   TO  PV-LIST-ITEM-NUMBER.       21600000
216100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21610000
216200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21620000
216300               PC-ITEMS-PER-PANEL).                               21630000
216400                                                                  21640000
216500     MOVE ASC-START-OF-SELECTED-RANGE                             21650000
216600                                   TO PV-START-OF-SELECTED-RANGE. 21660000
216700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21670000
216800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21680000
216900               PC-ITEMS-PER-PANEL).                               21690000
217000                                                                  21700000
217100     MOVE ASC-END-OF-SELECTED-RANGE                               21710000
217200                                   TO  PV-END-OF-SELECTED-RANGE.  21720000
217300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21730000
217400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21740000
217500               PC-ITEMS-PER-PANEL).                               21750000
217600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21760000
217700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21770000
217800                                                                  21780000
217900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21790000
218000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21800000
218100         MOVE +1                   TO ASC-BLK-SUB                 21810000
218200         PERFORM 5100-WRITE-TEMP-STORAGE                          21820000
218300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21830000
218400             PV-FIRST-BLOCK-IN-ARRAY - 1                          21840000
218500                                                                  21850000
218600         PERFORM                                                  21860000
218700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21870000
218800                   PV-PREV-BLOCK-IN-ARRAY                         21880000
218900             MOVE PV-FIRST-BLOCK-IN-RANGE                         21890000
219000                                   TO PV-BLOCK-NUMBER             21900000
219100             PERFORM 4410-READ-TEMP-STORAGE                       21910000
219200             PERFORM 3510-MARK-SELECTED-INDS                      21920000
219300                 VARYING ASC-ITEM-SUB                             21930000
219400                 FROM 1 BY 1                                      21940000
219500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21950000
219600             PERFORM 5100-WRITE-TEMP-STORAGE                      21960000
219700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21970000
219800         END-PERFORM                                              21980000
219900                                                                  21990000
220000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         22000000
220100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     22010000
220200         PERFORM                                                  22020000
220300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       22030000
220400                   PV-LAST-BLOCK-IN-RANGE                         22040000
220500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          22050000
220600                                   TO PV-BLOCK-NUMBER             22060000
220700             PERFORM 4410-READ-TEMP-STORAGE                       22070000
220800             PERFORM 3510-MARK-SELECTED-INDS                      22080000
220900                 VARYING ASC-ITEM-SUB                             22090000
221000                 FROM 1 BY 1                                      22100000
221100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22110000
221200             PERFORM 5100-WRITE-TEMP-STORAGE                      22120000
221300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      22130000
221400         END-PERFORM                                              22140000
221500                                                                  22150000
221600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22160000
221700                                   TO PV-BLOCK-NUMBER             22170000
221800         PERFORM 4410-READ-TEMP-STORAGE                           22180000
221900     END-IF.                                                      22190000
222000                                                                  22200000
222100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 22210000
222200                                      ASC-END-OF-SELECTED-RANGE.  22220000
222300                                                                  22230000
222400*----------------------------------------------------------------*22240000
222500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *22250000
222600*----------------------------------------------------------------*22260000
222700 3510-MARK-SELECTED-INDS.                                         22270000
222800                                                                  22280000
222900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22290000
223000                                ASC-ITEM-SUB) >                   22300000
223100         ASC-START-OF-SELECTED-RANGE)                             22310000
223200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22320000
223300                                ASC-ITEM-SUB) =                   22330000
223400         ASC-START-OF-SELECTED-RANGE)                             22340000
223500                                                                  22350000
223600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22360000
223700                                    ASC-ITEM-SUB) <               22370000
223800             ASC-END-OF-SELECTED-RANGE)                           22380000
223900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22390000
224000                                    ASC-ITEM-SUB) =               22400000
224100             ASC-END-OF-SELECTED-RANGE)                           22410000
224200                                                                  22420000
224300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22430000
224400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   22440000
224500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   22450000
224600                               TO TRUE                            22460000
224700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22470000
224800                               TO TRUE                            22480000
224900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    22490000
225000             END-IF                                               22500000
225100         END-IF                                                   22510000
225200     END-IF.                                                      22520000
225300                                                                  22530000
225400*----------------------------------------------------------------*22540000
225500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22550000
225600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22560000
225700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22570000
225800*    DISPLAY THE PANEL TO USER.                                  *22580000
225900*----------------------------------------------------------------*22590000
226000 4000-BUILD-INITIAL-PANEL.                                        22600000
226100                                                                  22610000
226200     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            22620000
226300                                 ASC-BLOCK-ENTRIES (2).           22630000
226400     MOVE +1                 TO ASC-BLK-SUB.                      22640000
226500     SET ASC-ITEMS-LEFT-ON-DB                                     22650000
226600                             TO TRUE.                             22660000
226700                                                                  22670000
226800     MOVE +0                 TO ASC-ITEM-SUB                      22680000
226900                                ASC-NUMBER-OF-ITEMS-READ          22690000
227000                                ASC-NUMBER-OF-SELECTED-ITEMS      22700000
227100                                ASC-HIGHEST-BLOCK-WRITTEN         22710000
227200                                ASC-START-OF-SELECTED-RANGE       22720000
227300                                ASC-END-OF-SELECTED-RANGE         22730000
227400                                ASC-ITEM-AT-TOP-OF-PANEL.         22740000
227500                                                                  22750000
227600                                                                  22760000
227610* JAK 09/2009 WR37075 START                                       22761000
227700*    PERFORM 4100-PREPARE-CURSOR.                                 22770000
227800*    PERFORM 7000-CHECK-AUTOVE.                                   22780000
227900*    PERFORM 4010-OPEN-CURSOR.                                    22790000
228000*    PERFORM 4300-READ-ITEMS-FROM-DB.                             22800000
228100*    PERFORM 4020-CLOSE-CURSOR.                                   22810000
228200                                                                  22820000
228210* IF THE TRANSACTION IS FOR A CS PULL, THE RECEIVER NUMBER WILL   22821000
228211* CONTAIN ZERO.  IT WILL USE A DIFFERENT CURSOR TO GET THE        22821100
228212* DETAIL INFORMATION.                                             22821200
228213                                                                  22821300
228214     IF ASC-RCVR-NBR = 0   AND                                    22821404
228215         ASC-CS-PULL-TRAN                                         22821504
228216***      SET ASC-CS-PULL-TRAN      TO TRUE                        22821604
228217         PERFORM 8000-PREPARE-CS-CURSOR                           22821704
228218         PERFORM 8110-OPEN-CS-CURSOR                              22821800
228219         PERFORM 8120-READ-CS-ITEMS-FROM-DB                       22821900
228220         PERFORM 8130-CLOSE-CS-CURSOR                             22822000
228221     ELSE                                                         22822100
228222                                                                  22822204
228223     IF ASC-RCVR-NBR = 0   AND                                    22822304
228224         ASC-FX-FAST-TRANSFER                                     22822404
228225         PERFORM 8200-PREPARE-FX-CURSOR                           22822504
228226         PERFORM 8210-OPEN-FX-CURSOR                              22822604
228227         PERFORM 8220-READ-FX-ITEMS-FROM-DB                       22822704
228228         PERFORM 8230-CLOSE-FX-CURSOR                             22822804
228229     ELSE                                                         22822904
228230                                                                  22823004
228231         PERFORM 4100-PREPARE-CURSOR                              22823100
228232         PERFORM 7000-CHECK-AUTOVE                                22823200
228233         PERFORM 4010-OPEN-CURSOR                                 22823300
228234         PERFORM 4300-READ-ITEMS-FROM-DB                          22823400
228235         PERFORM 4020-CLOSE-CURSOR                                22823500
228236     END-IF.                                                      22823600
228237* JAK 09/2009 WR37075 END                                         22823700
228240                                                                  22824000
228300     MOVE +1                   TO  PV-TOP-ITEM.                   22830000
228400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          22840000
228500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    22850000
228600         SET DP020-MSG-FATAL   TO  TRUE                           22860000
228700         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               22870000
228800     ELSE                                                         22880000
228900         MOVE -1               TO MR-SELECTL (1)                  22890000
229000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      22900000
229100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22910000
229200     END-IF.                                                      22920000
229300                                                                  22930000
229400*----------------------------------------------------------------*22940000
229500* OPEN THE CURSOR                                                 22950000
229600*----------------------------------------------------------------*22960000
229700 4010-OPEN-CURSOR.                                                22970000
229800     MOVE ASC-PO-NBR       TO  DK-PO-NBR.                         22980000
229900     MOVE ASC-RCVR-NBR     TO  DK-REC-SEQ-NBR.                    22990000
230000     IF ASC-LINE-NUMBER > ZERO                                    23000000
230100         MOVE ASC-LINE-NUMBER  TO  DK-LINE-BEGIN                  23010000
230200                                   DK-LINE-END                    23020000
230300     ELSE                                                         23030000
230400         MOVE DK-DEFAULT-BEGIN     TO  DK-LINE-BEGIN              23040000
230500         MOVE DK-DEFAULT-END-LINE  TO  DK-LINE-END                23050000
230600     END-IF.                                                      23060000
230700     IF ASC-STR-NBR NOT = SPACES AND ZEROES                       23070000
230800         MOVE ASC-STR-NBR      TO  DK-STR-BEGIN                   23080000
230900                                   DK-STR-END                     23090000
231000     ELSE                                                         23100000
231100         MOVE DK-DEFAULT-BEGIN    TO  DK-STR-BEGIN                23110000
231200         MOVE DK-DEFAULT-END-STR  TO  DK-STR-END                  23120000
231300     END-IF.                                                      23130000
231400                                                                  23140000
231500     PERFORM                                                      23150000
231600         WITH TEST AFTER                                          23160000
231700         VARYING PV-RETRY-COUNTER                                 23170000
231800         FROM 1 BY 1                                              23180000
231900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23190000
232000                   OR (SQLCODE = ZERO))                           23200000
232100                                                                  23210000
232200         EXEC SQL                                                 23220000
232300              OPEN VRFD-UNTS-CSR                                  23230000
232400         END-EXEC                                                 23240000
232500                                                                  23250000
232600         EVALUATE TRUE                                            23260000
232700             WHEN SQLCODE = ZERO                                  23270000
232800             WHEN SQLCODE = -904                                  23280000
232900             WHEN SQLCODE = -913                                  23290000
233000                 CONTINUE                                         23300000
233100             WHEN SQLWARN0 NOT = SPACES                           23310000
233200             WHEN SQLCODE < ZERO                                  23320000
233300             WHEN SQLCODE > ZERO                                  23330000
233400                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       23340000
233500                 MOVE 'OPEN CURSOR PROBLEM    - '                 23350000
233600                                   TO DP013-MESSAGE-TEXT (1)      23360000
233700                 MOVE SQLCA        TO DP013-SQLCA                 23370000
233800                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    23380000
233900                 SET DP013-DB2-ABEND                              23390000
234000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23400000
234100                 PERFORM DP013-0000-PROCESS-ABEND                 23410000
234200         END-EVALUATE                                             23420000
234300     END-PERFORM.                                                 23430000
234400*                                                                 23440000
234500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23450000
234600         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             23460000
234700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   23470000
234800                                   TO DP013-MESSAGE-TEXT (1)      23480000
234900         MOVE SQLCA                TO DP013-SQLCA                 23490000
235000         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    23500000
235100         SET DP013-DB2-ABEND                                      23510000
235200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   23520000
235300         PERFORM DP013-0000-PROCESS-ABEND                         23530000
235400     END-IF.                                                      23540000
235500                                                                  23550000
235600*----------------------------------------------------------------*23560000
235700* CLOSE THE CURSOR.                                               23570000
235800*----------------------------------------------------------------*23580000
235900 4020-CLOSE-CURSOR.                                               23590000
236000                                                                  23600000
236100     EXEC SQL                                                     23610000
236200          CLOSE VRFD-UNTS-CSR                                     23620000
236300     END-EXEC.                                                    23630000
236400                                                                  23640000
236500     EVALUATE TRUE                                                23650000
236600         WHEN SQLCODE = ZERO                                      23660000
236700         WHEN SQLCODE = +100                                      23670000
236800             CONTINUE                                             23680000
236900         WHEN SQLWARN0 NOT = SPACES                               23690000
237000         WHEN SQLCODE < ZERO                                      23700000
237100         WHEN SQLCODE > ZERO                                      23710000
237200             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          23720000
237300             MOVE 'CLOSE CURSOR PROBLEM   '                       23730000
237400                               TO DP013-MESSAGE-TEXT (1)          23740000
237500             MOVE SQLCA        TO DP013-SQLCA                     23750000
237600             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        23760000
237700             SET DP013-DB2-ABEND                                  23770000
237800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23780000
237900             PERFORM DP013-0000-PROCESS-ABEND                     23790000
238000     END-EVALUATE.                                                23800000
238100                                                                  23810000
238200*----------------------------------------------------------------*23820000
238300*    FILL IN TOP PART OF SCREEN                                   23830000
238400*----------------------------------------------------------------*23840000
238500 4100-PREPARE-CURSOR.                                             23850000
238600     PERFORM 4110-GET-TRECEIV-INFO.                               23860000
238700     PERFORM 4115-GET-VENDOR-NAME.                                23870000
238800     MOVE ASC-CURR-OPER-UNT-ID  TO DK-OPER-UNT-ID.                23880000
238900     PERFORM 4120-GET-OPER-NAME.                                  23890000
239000     MOVE XL071-LOC-NM           TO ASC-OPER-UNT-NAME.            23900000
239100     IF ASC-STR-NBR   = ZEROES OR SPACES                          23910000
239200         MOVE DK-DEFAULT-BEGIN     TO  DK-STR-BEGIN               23920000
239300         MOVE DK-DEFAULT-END-STR   TO  DK-STR-END                 23930000
239400     ELSE                                                         23940000
239500         MOVE ASC-STR-NBR          TO  DK-STR-BEGIN               23950000
239600                                       DK-STR-END                 23960000
239700         MOVE ASC-STR-NBR          TO  DK-OPER-UNT-ID             23970000
239800         PERFORM 4120-GET-OPER-NAME                               23980000
239900         MOVE XL071-LOC-NM         TO ASC-STORE-NAME              23990000
240000     END-IF.                                                      24000000
240100     MOVE ZEROES TO ASC-OUTBND-CRTNS.                             24010000
240200     PERFORM 4210-OPEN-CURSOR.                                    24020000
240300     PERFORM 4220-FETCH-CURSOR UNTIL SQLCODE NOT = ZERO.          24030000
240400     PERFORM 4230-CLOSE-CURSOR.                                   24040000
240500                                                                  24050000
240600*----------------------------------------------------------------*24060000
240700* RETRIEVE INFO FROM TRECEIV                                      24070000
240800*----------------------------------------------------------------*24080000
240900 4110-GET-TRECEIV-INFO.                                           24090000
241000                                                                  24100000
241100     MOVE ASC-PO-NBR    TO DK-PO-NBR.                             24110000
241200     MOVE ASC-RCVR-NBR  TO DK-REC-SEQ-NBR.                        24120000
241300     EXEC SQL                                                     24130000
241400          SELECT A.STATUS_CDE                                     24140000
241500                ,A.PACK_BY_ST_IND                                 24150000
241600                ,A.EXPTED_CART_CNT                                24160000
241700                ,A.ACTL_CART_CNT                                  24170000
241800                ,A.CURR_OPER_UNT_ID                               24180000
241900                ,A.VERFYD_TMST                                    24190000
242000                ,A.VRFD_USR_ID                                    24200000
242100                ,A.PKGNG_CDE                                      24210000
242200          INTO  :RECEIV-STATUS-CDE                                24220000
242300               ,:RECEIV-PACK-BY-ST-IND                            24230000
242400               ,:RECEIV-EXPTED-CART-CNT                           24240000
242500               ,:RECEIV-ACTL-CART-CNT                             24250000
242600               ,:RECEIV-CURR-OPER-UNT-ID                          24260000
242700               ,:RECEIV-VERFYD-TMST                               24270000
242800               ,:RECEIV-VRFD-USR-ID                               24280000
242900               ,:RECEIV-PKGNG-CDE                                 24290000
243000           FROM  TRECEIV A                                        24300000
243100          WHERE  A.ORD_NBR        =  :DK-PO-NBR                   24310000
243200            AND  A.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR              24320000
243300            AND  A.VER_STATUS_CDE =  'A'                          24330000
243400     END-EXEC.                                                    24340000
243500     EVALUATE TRUE                                                24350000
243600         WHEN SQLCODE = ZERO                                      24360000
243700             MOVE RECEIV-STATUS-CDE       TO ASC-STATUS-CDE       24370000
243800             MOVE RECEIV-PACK-BY-ST-IND   TO ASC-PACK-BY-ST-IND   24380000
243900             MOVE RECEIV-EXPTED-CART-CNT  TO ASC-EXPTED-CART-CNT  24390000
244000             MOVE RECEIV-ACTL-CART-CNT    TO ASC-ACTL-CART-CNT    24400000
244100             MOVE RECEIV-CURR-OPER-UNT-ID TO ASC-CURR-OPER-UNT-ID 24410000
244200             MOVE RECEIV-VERFYD-TMST      TO DK-TMST              24420000
244300                                             ASC-TMST             24430000
244400             MOVE RECEIV-VRFD-USR-ID      TO ASC-VRFD-USR-ID      24440000
244500             MOVE RECEIV-PKGNG-CDE        TO ASC-DSPLY-PKGNG-CD   24450000
244600         WHEN SQLCODE = +100                                      24460000
244700             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                24470000
244800             SET DP020-MSG-FATAL   TO  TRUE                       24480000
244900             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           24490000
245000         WHEN SQLWARN0 NOT = SPACE                                24500000
245100         WHEN SQLCODE NOT = ZERO                                  24510000
245200              MOVE '4110-GET-TRECEIV-INFO ' TO DP013-PARAGRAPH    24520000
245300              MOVE 'GET TRECEIV INFO '                            24530000
245400                               TO DP013-MESSAGE-TEXT (1)          24540000
245500              MOVE SQLCA       TO DP013-SQLCA                     24550000
245600              MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)       24560000
245700              SET DP013-DB2-ABEND TO TRUE                         24570000
245800              PERFORM DP013-0000-PROCESS-ABEND                    24580000
245900     END-EVALUATE.                                                24590000
246000                                                                  24600000
246100*----------------------------------------------------------------*24610000
246200*  RETRIEVE THE PRIMARY VENDOR NAME                               24620000
246300*----------------------------------------------------------------*24630000
246400 4115-GET-VENDOR-NAME.                                            24640000
246500                                                                  24650000
246600     EXEC SQL                                                     24660000
246700          SELECT B.ENT_NAME_DESC                                  24670000
246800            INTO :ENTNME-ENT-NAME-DESC                            24680000
246900            FROM TPURCHS A                                        24690000
247000                ,TENTNME B                                        24700000
247100           WHERE A.PO_NBR         = :DK-PO-NBR                    24710000
247200             AND A.VER_STATUS_CDE = 'A'                           24720000
247300             AND B.TYPE_CDE       = '01'                          24730000
247400             AND A.ENT_ID         = B.ENT_ID                      24740000
247500     END-EXEC.                                                    24750000
247600                                                                  24760000
247700     EVALUATE TRUE                                                24770000
247800         WHEN SQLCODE = +0                                        24780000
247900             MOVE ENTNME-ENT-NAME-DESC TO ASC-VENDOR-NAME         24790000
248000         WHEN OTHER                                               24800000
248100             MOVE SPACES               TO ASC-VENDOR-NAME         24810000
248200     END-EVALUATE.                                                24820000
248300                                                                  24830000
248400*----------------------------------------------------------------*24840000
248500* RETRIEVE NAME                                                   24850000
248600* LOCATION HIERARCHY DOMAIN TABLE XLT00010                        24860000
248700*----------------------------------------------------------------*24870000
248800 4120-GET-OPER-NAME.                                              24880000
248900                                                                  24890000
249000     INITIALIZE XL071-COMMAREA-REC.                               24900000
249100     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               24910000
249200                                                                  24920000
249300     CALL XL071-LOCATION-MODULE  USING                            24930000
249400                                    DFHEIBLK                      24940000
249500                                    XL071-COMMAREA                24950000
249600                                    XL071-COMMAREA-REC.           24960000
249700                                                                  24970000
249800     EVALUATE TRUE                                                24980000
249900         WHEN XL071-NO-ERRORS                                     24990000
250000              CONTINUE                                            25000000
250100         WHEN XL071-LOC-NOT-FOUND                                 25010000
250200                 MOVE 'STORE NAME NOT FOUND' TO                   25020000
250300                                  XL071-LOC-NM                    25030000
250400         WHEN OTHER                                               25040000
250500              INITIALIZE PV-CICS-MSG-AREA                         25050000
250600              STRING ' SUKCS598 - CALL XLKUT071 -'                25060000
250700                     ' SQLCODE=' XL071-SQLCODE                    25070000
250800                     ' TABLE='   XL071-DB2-TABLE                  25080000
250900                                              DELIMITED BY SIZE   25090000
251000                                         INTO PV-CICS-MSG-AREA    25100000
251100              PERFORM 9900-WRITE-CICS-LOG                         25110000
251200                                                                  25120000
251300              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              25130000
251400              PERFORM 9900A-SOFT-ABORT                            25140000
251500     END-EVALUATE.                                                25150000
251600                                                                  25160000
251700*                                                                 25170000
251800*----------------------------------------------------------------*25180000
251900* OPEN THE CURSOR                                                 25190000
252000*----------------------------------------------------------------*25200000
252100 4210-OPEN-CURSOR.                                                25210000
252200                                                                  25220000
252300     MOVE  ASC-PO-NBR       TO  DK-PO-NBR.                        25230000
252400     MOVE  ASC-RCVR-NBR     TO  DK-REC-SEQ-NBR.                   25240000
252500                                                                  25250000
252600     EXEC SQL                                                     25260000
252700          OPEN OUTBND-CTN-CNT-CSR                                 25270000
252800     END-EXEC.                                                    25280000
252900                                                                  25290000
253000     EVALUATE TRUE                                                25300000
253100         WHEN SQLCODE = ZERO                                      25310000
253200         WHEN SQLCODE = -904                                      25320000
253300         WHEN SQLCODE = -913                                      25330000
253400             CONTINUE                                             25340000
253500         WHEN SQLWARN0 NOT = SPACES                               25350000
253600         WHEN SQLCODE < ZERO                                      25360000
253700         WHEN SQLCODE > ZERO                                      25370000
253800             MOVE '4210-OPEN-CURSOR' TO DP013-PARAGRAPH           25380000
253900             MOVE 'OPEN CURSOR PROBLEM    - '                     25390000
254000                                   TO DP013-MESSAGE-TEXT (1)      25400000
254100             MOVE SQLCA        TO DP013-SQLCA                     25410000
254200             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)        25420000
254300             SET DP013-DB2-ABEND                                  25430000
254400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25440000
254500             PERFORM DP013-0000-PROCESS-ABEND                     25450000
254600     END-EVALUATE.                                                25460000
254700                                                                  25470000
254800*----------------------------------------------------------------*25480000
254900*    FETCH THE CURSOR                                             25490000
255000*----------------------------------------------------------------*25500000
255100 4220-FETCH-CURSOR.                                               25510000
255200     EXEC SQL                                                     25520000
255300          FETCH OUTBND-CTN-CNT-CSR                                25530000
255400          INTO  :PV-OUTBND-CRTN-CNT                               25540000
255500     END-EXEC.                                                    25550000
255600                                                                  25560000
255700     EVALUATE TRUE                                                25570000
255800         WHEN SQLCODE = ZERO                                      25580000
255900             ADD PV-OUTBND-CRTN-CNT TO ASC-OUTBND-CRTNS           25590000
256000         WHEN SQLCODE = +100                                      25600000
256100              CONTINUE                                            25610000
256200         WHEN SQLCODE = -305                                      25620000
256300             ADD ZEROES             TO ASC-OUTBND-CRTNS           25630000
256400         WHEN SQLWARN0 NOT = SPACE                                25640000
256500         WHEN SQLCODE NOT = ZERO                                  25650000
256600              MOVE '4220-FETCH-CURSOR' TO DP013-PARAGRAPH         25660000
256700              MOVE 'FETCH CURSOR PROBLEM '                        25670000
256800                               TO DP013-MESSAGE-TEXT (1)          25680000
256900              MOVE SQLCA       TO DP013-SQLCA                     25690000
257000              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)       25700000
257100              SET DP013-DB2-ABEND TO TRUE                         25710000
257200              PERFORM DP013-0000-PROCESS-ABEND                    25720000
257300     END-EVALUATE.                                                25730000
257400                                                                  25740000
257500*----------------------------------------------------------------*25750000
257600* CLOSE THE CURSOR.                                               25760000
257700*-----------------------------------------------------------------25770000
257800 4230-CLOSE-CURSOR.                                               25780000
257900                                                                  25790000
258000     EXEC SQL                                                     25800000
258100          CLOSE OUTBND-CTN-CNT-CSR                                25810000
258200     END-EXEC.                                                    25820000
258300                                                                  25830000
258400     EVALUATE TRUE                                                25840000
258500         WHEN SQLCODE = ZERO                                      25850000
258600         WHEN SQLCODE = +100                                      25860000
258700             CONTINUE                                             25870000
258800         WHEN SQLWARN0 NOT = SPACES                               25880000
258900         WHEN SQLCODE < ZERO                                      25890000
259000         WHEN SQLCODE > ZERO                                      25900000
259100             MOVE '4230-CLOSE-CURSOR' TO DP013-PARAGRAPH          25910000
259200             MOVE 'CLOSE CURSOR PROBLEM '                         25920000
259300                               TO DP013-MESSAGE-TEXT (1)          25930000
259400             MOVE SQLCA        TO DP013-SQLCA                     25940000
259500             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)        25950000
259600             SET DP013-DB2-ABEND                                  25960000
259700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25970000
259800             PERFORM DP013-0000-PROCESS-ABEND                     25980000
259900     END-EVALUATE.                                                25990000
260000                                                                  26000000
260100*----------------------------------------------------------------*26010000
260200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *26020000
260300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *26030000
260400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *26040000
260500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *26050000
260600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *26060000
260700*                                                                *26070000
260800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *26080000
260900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *26090000
261000*    UPON INITIALIZATION.                                        *26100000
261100*----------------------------------------------------------------*26110000
261200 4300-READ-ITEMS-FROM-DB.                                         26120000
261300                                                                  26130000
261400     PERFORM                                                      26140000
261500         VARYING PV-READ-COUNT                                    26150000
261600         FROM 1 BY 1                                              26160000
261700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26170000
261800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         26180000
261900                                                                  26190000
262000         PERFORM 4310-FETCH                                       26200000
262100                                                                  26210000
262200         IF  ASC-ITEMS-LEFT-ON-DB                                 26220000
262300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26230000
262400                 ADD +1            TO ASC-ITEM-SUB                26240000
262500             ELSE                                                 26250000
262600                 ADD +1            TO ASC-BLK-SUB                 26260000
262700                 MOVE +1           TO ASC-ITEM-SUB                26270000
262800                                                                  26280000
262900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26290000
263000                     MOVE +1       TO ASC-BLK-SUB                 26300000
263100                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           26310000
263200                     PERFORM 5100-WRITE-TEMP-STORAGE              26320000
263300                     MOVE ASC-BLOCK-ENTRIES                       26330000
263400                                   (PC-MAX-BLOCKS-IN-ARRAY)       26340000
263500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26350000
263600                     ADD +1        TO ASC-BLK-SUB                 26360000
263700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26370000
263800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26380000
263900                                                          TO TRUE 26390000
264000                 END-IF                                           26400000
264100             END-IF                                               26410000
264200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26420000
264300             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          26430000
264400             MOVE ASC-NUMBER-OF-ITEMS-READ                        26440000
264500                                   TO ASC-LIST-ITEM-NUMBER        26450000
264600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26460000
264700             MOVE SPACES TO ASC-ACTION                            26470000
264800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26480000
264900             MOVE RECITM-ORD-LNE-NBR TO                           26490000
265000                           ASC-LINE-NBR(ASC-BLK-SUB ASC-ITEM-SUB) 26500000
265100                           DK-LINE-BEGIN                          26510000
265200                           DK-LINE-END                            26520000
265300             MOVE RECITM-STATUS-CDE   TO                          26530000
265400                          ASC-LINE-STAT(ASC-BLK-SUB ASC-ITEM-SUB) 26540000
265500*DMB 7/2004                                                       26550000
265600             IF ASC-AUTO-VE-YES                                   26560000
265700                 INITIALIZE RC074-FIELDS                          26570000
265800                 MOVE RECITM-ORD-LNE-NBR  TO RC074-LINE-NBR       26580000
265900                 PERFORM 7100-CALL-RCKUT128                       26590000
266000                 IF RECITM-STATUS-CDE NOT EQUAL 'VE'              26600000
266100                     MOVE RC074-TOTAL-ACTL-ITM-QTY                26610000
266200                        TO ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB)26620000
266300                 ELSE                                             26630000
266400                     MOVE RC074-VERIFY-ITM-QTY                    26640000
266500                        TO ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB)26650000
266600                 END-IF                                           26660000
266700             ELSE                                                 26670000
266800                 IF RECITM-STATUS-CDE = 'VE'                      26680000
266900                     MOVE RECDIS-AP-VERIFY-ITM-QTY TO             26690000
267000                          ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB) 26700000
267100                 ELSE                                             26710000
267200                     MOVE RECDIS-VERIFY-ITM-QTY TO                26720000
267300                           ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB)26730000
267400                 END-IF                                           26740000
267500             END-IF                                               26750000
267600             MOVE ZEROES TO PV-SHPD-QTY ASC-SHPD-QTY              26760000
267700             PERFORM 4350-GET-SHPD-QTY                            26770000
267800             MOVE ASC-SHPD-QTY TO                                 26780000
267900                          ASC-UNIT-MFST(ASC-BLK-SUB ASC-ITEM-SUB) 26790000
268000             COMPUTE  ASC-UNIT-VARI(ASC-BLK-SUB ASC-ITEM-SUB)     26800000
268100                 =  ASC-UNIT-MFST(ASC-BLK-SUB ASC-ITEM-SUB) -     26810000
268200                          ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB) 26820000
268300             MOVE ZEROES TO PV-LINE-COUNT ASC-LINE-COUNT          26830000
268400             PERFORM 4360-GET-TOT-CARTONS                         26840000
268500             MOVE ASC-LINE-COUNT TO                               26850000
268600                          ASC-TOT-LINE (ASC-BLK-SUB ASC-ITEM-SUB) 26860000
268700             MOVE ZEROES TO PV-LINE-DIVRT ASC-LINE-DIVRT          26870000
268800             PERFORM 4370-GET-TOT-DIVERT                          26880000
268900             MOVE ASC-LINE-DIVRT TO                               26890000
269000                        ASC-TOT-DIVERT (ASC-BLK-SUB ASC-ITEM-SUB) 26900000
269100             MOVE ZEROES TO PV-LINE-SCAND ASC-LINE-SCAND          26910000
269200             PERFORM 4380-GET-TOT-SCANND                          26920000
269300             MOVE ASC-LINE-SCAND TO                               26930000
269400                          ASC-TOT-LOADD(ASC-BLK-SUB ASC-ITEM-SUB) 26940000
269500             COMPUTE   ASC-TOT-SHIPD(ASC-BLK-SUB ASC-ITEM-SUB)    26950000
269600                 =  ASC-TOT-DIVERT(ASC-BLK-SUB ASC-ITEM-SUB) +    26960000
269700                          ASC-TOT-LOADD(ASC-BLK-SUB ASC-ITEM-SUB) 26970000
269800             IF ASC-PACK-BY-ST-IND = 'Y'                          26980000
269900                 MOVE 'PBS   '  TO                                26990000
270000                         ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB) 27000000
270100             ELSE                                                 27010000
270200                 PERFORM 4390-DETERMINE-PROC-CODE                 27020000
270300             END-IF                                               27030000
270400         END-IF                                                   27040000
270500     END-PERFORM.                                                 27050000
270600                                                                  27060000
270700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          27070000
270800         MOVE +1               TO ASC-BLK-SUB                     27080000
270900         PERFORM 5100-WRITE-TEMP-STORAGE                          27090000
271000         ADD +1                TO ASC-BLK-SUB                     27100000
271100         PERFORM 5100-WRITE-TEMP-STORAGE                          27110000
271200                                                                  27120000
271300         MOVE 1                TO ASC-BLK-SUB                     27130000
271400                                  PV-BLOCK-NUMBER                 27140000
271500         PERFORM 4410-READ-TEMP-STORAGE                           27150000
271600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27160000
271700             MOVE 2            TO ASC-BLK-SUB                     27170000
271800                                  PV-BLOCK-NUMBER                 27180000
271900             PERFORM 4410-READ-TEMP-STORAGE                       27190000
272000         END-IF                                                   27200000
272100     END-IF.                                                      27210000
272200                                                                  27220000
272300                                                                  27230000
272400*----------------------------------------------------------------*27240000
272500*    FETCH THE CURSOR                                             27250000
272600*----------------------------------------------------------------*27260000
272700 4310-FETCH.                                                      27270000
272800                                                                  27280000
272900      EXEC SQL                                                    27290000
273000          FETCH VRFD-UNTS-CSR                                     27300000
273100          INTO  :RECDIS-VERIFY-ITM-QTY                            27310000
273200               ,:RECDIS-AP-VERIFY-ITM-QTY                         27320000
273300               ,:RECITM-ORD-LNE-NBR                               27330000
273400               ,:RECITM-STATUS-CDE                                27340000
273500               ,:RECITM-VRFD-USR-ID                               27350000
273600      END-EXEC.                                                   27360000
273700                                                                  27370000
273800     EVALUATE TRUE                                                27380000
273900         WHEN SQLCODE = ZERO                                      27390000
274000         WHEN SQLCODE = +100                                      27400000
274100              CONTINUE                                            27410000
274200         WHEN SQLWARN0 NOT = SPACE                                27420000
274300         WHEN SQLCODE NOT = ZERO                                  27430000
274400              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         27440000
274500              MOVE 'FETCH CURSOR PROBLEM '                        27450000
274600                               TO DP013-MESSAGE-TEXT (1)          27460000
274700              MOVE SQLCA       TO DP013-SQLCA                     27470000
274800              MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)       27480000
274900              SET DP013-DB2-ABEND TO TRUE                         27490000
275000              PERFORM DP013-0000-PROCESS-ABEND                    27500000
275100     END-EVALUATE.                                                27510000
275200                                                                  27520000
275300     IF  SQLCODE EQUAL +100                                       27530000
275400         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      27540000
275500     END-IF.                                                      27550000
275600                                                                  27560000
275700*----------------------------------------------------------------*27570000
275800* GET TOTAL CARTON QUANTITY FROM SUT_OTBND_UPC                    27580000
275900*----------------------------------------------------------------*27590000
276000 4350-GET-SHPD-QTY.                                               27600000
276100     EXEC SQL                                                     27610000
276200          OPEN MANFSTD-UNITS-CSR                                  27620000
276300     END-EXEC                                                     27630000
276400                                                                  27640000
276500     EVALUATE TRUE                                                27650000
276600         WHEN SQLCODE = ZERO                                      27660000
276700         WHEN SQLCODE = +100                                      27670000
276800             CONTINUE                                             27680000
276900         WHEN SQLWARN0 NOT = SPACES                               27690000
277000         WHEN SQLCODE < ZERO                                      27700000
277100         WHEN SQLCODE > ZERO                                      27710000
277200             MOVE '4350-GET-SHPD-QTY' TO DP013-PARAGRAPH          27720000
277300             MOVE 'OPEN CURSOR PROBLEM   '                        27730000
277400                               TO DP013-MESSAGE-TEXT (1)          27740000
277500             MOVE SQLCA        TO DP013-SQLCA                     27750000
277600             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        27760000
277700             SET DP013-DB2-ABEND                                  27770000
277800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27780000
277900             PERFORM DP013-0000-PROCESS-ABEND                     27790000
278000     END-EVALUATE.                                                27800000
278100                                                                  27810000
278200     PERFORM 4357-FETCH-MNFST-CSR UNTIL SQLCODE = +100.           27820000
278300     MOVE ZEROS TO SQLCODE.                                       27830000
278400     PERFORM 4355-CLOSE-MNFST-CSR.                                27840000
278500                                                                  27850000
278600* --------------------------------------------------------------  27860000
278700* CLOSE LINE CURSOR.                                              27870000
278800* --------------------------------------------------------------  27880000
278900  4355-CLOSE-MNFST-CSR.                                           27890000
279000     EXEC SQL                                                     27900000
279100         CLOSE MANFSTD-UNITS-CSR                                  27910000
279200     END-EXEC.                                                    27920000
279300                                                                  27930000
279400     EVALUATE TRUE                                                27940000
279500         WHEN SQLCODE = ZERO                                      27950000
279600         WHEN SQLCODE = +100                                      27960000
279700             CONTINUE                                             27970000
279800         WHEN SQLWARN0 NOT = SPACE                                27980000
279900         WHEN SQLCODE NOT = ZERO                                  27990000
280000             MOVE '4355-CLOSE-MNFST-CSR' TO DP013-PARAGRAPH       28000000
280100             MOVE 'CLOSE CURSOR PROBLEM   '                       28010000
280200                               TO DP013-MESSAGE-TEXT (1)          28020000
280300             MOVE SQLCA        TO DP013-SQLCA                     28030000
280400             MOVE 'SUT00028'  TO DP013-DB2-TABLE-NAME (1)         28040000
280500             SET DP013-DB2-ABEND                                  28050000
280600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28060000
280700             PERFORM DP013-0000-PROCESS-ABEND                     28070000
280800     END-EVALUATE.                                                28080000
280900                                                                  28090000
281000*----------------------------------------------------------------*28100000
281100*    FETCH THE MANIFESTED CURSOR                                  28110000
281200*----------------------------------------------------------------*28120000
281300 4357-FETCH-MNFST-CSR.                                            28130000
281400     EXEC SQL                                                     28140000
281500         FETCH MANFSTD-UNITS-CSR                                  28150000
281600          INTO  :PV-SHPD-QTY                                      28160000
281700     END-EXEC                                                     28170000
281800                                                                  28180000
281900     EVALUATE TRUE                                                28190000
282000         WHEN SQLCODE = ZERO                                      28200000
282100              ADD PV-SHPD-QTY    TO ASC-SHPD-QTY                  28210000
282200         WHEN SQLCODE = +100                                      28220000
282300              CONTINUE                                            28230000
282400         WHEN SQLCODE = -305                                      28240000
282500              ADD ZEROES         TO ASC-SHPD-QTY                  28250000
282600         WHEN SQLWARN0 NOT = SPACE                                28260000
282700         WHEN SQLCODE NOT = ZERO                                  28270000
282800              MOVE '4357-FETCH-MNFST-CSR' TO DP013-PARAGRAPH      28280000
282900              MOVE 'FETCH CURSOR PROBLEM '                        28290000
283000                               TO DP013-MESSAGE-TEXT (1)          28300000
283100              MOVE SQLCA       TO DP013-SQLCA                     28310000
283200              MOVE 'SUT00028'  TO DP013-DB2-TABLE-NAME (1)        28320000
283300              SET DP013-DB2-ABEND TO TRUE                         28330000
283400              PERFORM DP013-0000-PROCESS-ABEND                    28340000
283500     END-EVALUATE.                                                28350000
283600                                                                  28360000
283700* --------------------------------------------------------------  28370000
283800* GET TOTAL NUMBER OF CARTONS BY LINE.                            28380000
283900* --------------------------------------------------------------  28390000
284000  4360-GET-TOT-CARTONS.                                           28400000
284100     EXEC SQL                                                     28410000
284200          OPEN CARTON-COUNT-CSR                                   28420000
284300     END-EXEC.                                                    28430000
284400                                                                  28440000
284500     EVALUATE TRUE                                                28450000
284600         WHEN SQLCODE = ZERO                                      28460000
284700         WHEN SQLCODE = +100                                      28470000
284800             CONTINUE                                             28480000
284900         WHEN SQLWARN0 NOT = SPACES                               28490000
285000         WHEN SQLCODE < ZERO                                      28500000
285100         WHEN SQLCODE > ZERO                                      28510000
285200             MOVE '4360-GET-TOT-CRTNS' TO DP013-PARAGRAPH         28520000
285300             MOVE 'OPEN CURSOR PROBLEM   '                        28530000
285400                               TO DP013-MESSAGE-TEXT (1)          28540000
285500             MOVE SQLCA        TO DP013-SQLCA                     28550000
285600             MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)        28560000
285700             SET DP013-DB2-ABEND                                  28570000
285800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28580000
285900             PERFORM DP013-0000-PROCESS-ABEND                     28590000
286000     END-EVALUATE.                                                28600000
286100                                                                  28610000
286200     PERFORM 4367-FETCH-LINE-CSR UNTIL SQLCODE = +100.            28620000
286300     MOVE ZEROS TO SQLCODE.                                       28630000
286400     PERFORM 4365-CLOSE-LINE-CSR.                                 28640000
286500                                                                  28650000
286600* --------------------------------------------------------------  28660000
286700* CLOSE LINE CURSOR.                                              28670000
286800* --------------------------------------------------------------  28680000
286900  4365-CLOSE-LINE-CSR.                                            28690000
287000     EXEC SQL                                                     28700000
287100         CLOSE CARTON-COUNT-CSR                                   28710000
287200     END-EXEC.                                                    28720000
287300                                                                  28730000
287400     EVALUATE TRUE                                                28740000
287500         WHEN SQLCODE = ZERO                                      28750000
287600         WHEN SQLCODE = +100                                      28760000
287700             CONTINUE                                             28770000
287800         WHEN SQLWARN0 NOT = SPACE                                28780000
287900         WHEN SQLCODE NOT = ZERO                                  28790000
288000             MOVE '4365-CLOSE-CRTN-CSR' TO DP013-PARAGRAPH        28800000
288100             MOVE 'CLOSE CURSOR PROBLEM   '                       28810000
288200                               TO DP013-MESSAGE-TEXT (1)          28820000
288300             MOVE SQLCA        TO DP013-SQLCA                     28830000
288400             MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)        28840000
288500             SET DP013-DB2-ABEND                                  28850000
288600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28860000
288700             PERFORM DP013-0000-PROCESS-ABEND                     28870000
288800     END-EVALUATE.                                                28880000
288900                                                                  28890000
289000*----------------------------------------------------------------*28900000
289100*    FETCH THE CARTON CURSOR                                      28910000
289200*----------------------------------------------------------------*28920000
289300 4367-FETCH-LINE-CSR.                                             28930000
289400     EXEC SQL                                                     28940000
289500         FETCH CARTON-COUNT-CSR                                   28950000
289600          INTO  :PV-LINE-COUNT                                    28960000
289700     END-EXEC.                                                    28970000
289800                                                                  28980000
289900     EVALUATE TRUE                                                28990000
290000         WHEN SQLCODE = ZERO                                      29000000
290100              ADD PV-LINE-COUNT  TO ASC-LINE-COUNT                29010000
290200         WHEN SQLCODE = +100                                      29020000
290300              CONTINUE                                            29030000
290400         WHEN SQLCODE = -305                                      29040000
290500              ADD ZEROES         TO ASC-LINE-COUNT                29050000
290600         WHEN SQLWARN0 NOT = SPACE                                29060000
290700         WHEN SQLCODE NOT = ZERO                                  29070000
290800              MOVE '4367-FETCH-CRTN-CSR' TO DP013-PARAGRAPH       29080000
290900              MOVE 'FETCH CURSOR PROBLEM '                        29090000
291000                               TO DP013-MESSAGE-TEXT (1)          29100000
291100              MOVE SQLCA       TO DP013-SQLCA                     29110000
291200              MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)       29120000
291300              SET DP013-DB2-ABEND TO TRUE                         29130000
291400              PERFORM DP013-0000-PROCESS-ABEND                    29140000
291500     END-EVALUATE.                                                29150000
291600                                                                  29160000
291700* --------------------------------------------------------------  29170000
291800* GET TOTAL NUMBER OF CARTONS THAT HAVE BEEN DIVERTED             29180000
291900* --------------------------------------------------------------  29190000
292000  4370-GET-TOT-DIVERT.                                            29200000
292100     EXEC SQL                                                     29210000
292200          OPEN DIVERT-CART-CSR                                    29220000
292300     END-EXEC.                                                    29230000
292400                                                                  29240000
292500     EVALUATE TRUE                                                29250000
292600         WHEN SQLCODE = ZERO                                      29260000
292700         WHEN SQLCODE = +100                                      29270000
292800             CONTINUE                                             29280000
292900         WHEN SQLWARN0 NOT = SPACES                               29290000
293000         WHEN SQLCODE < ZERO                                      29300000
293100         WHEN SQLCODE > ZERO                                      29310000
293200             MOVE '4370-GET-TOT-DIVERT' TO DP013-PARAGRAPH        29320000
293300             MOVE 'OPEN CURSOR PROBLEM   '                        29330000
293400                               TO DP013-MESSAGE-TEXT (1)          29340000
293500             MOVE SQLCA        TO DP013-SQLCA                     29350000
293600             MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)        29360000
293700             SET DP013-DB2-ABEND                                  29370000
293800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29380000
293900             PERFORM DP013-0000-PROCESS-ABEND                     29390000
294000     END-EVALUATE.                                                29400000
294100                                                                  29410000
294200     PERFORM 4377-FETCH-DVRT-CSR UNTIL SQLCODE = +100.            29420000
294300     MOVE ZEROS TO SQLCODE.                                       29430000
294400     PERFORM 4375-CLOSE-DVRT-CSR.                                 29440000
294500                                                                  29450000
294600* --------------------------------------------------------------  29460000
294700* CLOSE DIVERT CURSOR.                                            29470000
294800* --------------------------------------------------------------  29480000
294900  4375-CLOSE-DVRT-CSR.                                            29490000
295000     EXEC SQL                                                     29500000
295100         CLOSE DIVERT-CART-CSR                                    29510000
295200     END-EXEC.                                                    29520000
295300                                                                  29530000
295400     EVALUATE TRUE                                                29540000
295500         WHEN SQLCODE = ZERO                                      29550000
295600         WHEN SQLCODE = +100                                      29560000
295700             CONTINUE                                             29570000
295800         WHEN SQLWARN0 NOT = SPACE                                29580000
295900         WHEN SQLCODE NOT = ZERO                                  29590000
296000             MOVE '4375-CLOSE-DVRT-CSR' TO DP013-PARAGRAPH        29600000
296100             MOVE 'CLOSE CURSOR PROBLEM   '                       29610000
296200                               TO DP013-MESSAGE-TEXT (1)          29620000
296300             MOVE SQLCA        TO DP013-SQLCA                     29630000
296400             MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)        29640000
296500             SET DP013-DB2-ABEND                                  29650000
296600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29660000
296700             PERFORM DP013-0000-PROCESS-ABEND                     29670000
296800     END-EVALUATE.                                                29680000
296900                                                                  29690000
297000*----------------------------------------------------------------*29700000
297100*    FETCH THE DIVERT CURSOR                                      29710000
297200*----------------------------------------------------------------*29720000
297300 4377-FETCH-DVRT-CSR.                                             29730000
297400     EXEC SQL                                                     29740000
297500         FETCH DIVERT-CART-CSR                                    29750000
297600          INTO  :PV-LINE-DIVRT                                    29760000
297700     END-EXEC.                                                    29770000
297800                                                                  29780000
297900     EVALUATE TRUE                                                29790000
298000         WHEN SQLCODE = ZERO                                      29800000
298100              ADD PV-LINE-DIVRT  TO ASC-LINE-DIVRT                29810000
298200         WHEN SQLCODE = +100                                      29820000
298300              CONTINUE                                            29830000
298400         WHEN SQLCODE = -305                                      29840000
298500              ADD ZEROES         TO ASC-LINE-DIVRT                29850000
298600         WHEN SQLWARN0 NOT = SPACE                                29860000
298700         WHEN SQLCODE NOT = ZERO                                  29870000
298800              MOVE '4377-FETCH-DVRT-CSR' TO DP013-PARAGRAPH       29880000
298900              MOVE 'FETCH CURSOR PROBLEM '                        29890000
299000                               TO DP013-MESSAGE-TEXT (1)          29900000
299100              MOVE SQLCA       TO DP013-SQLCA                     29910000
299200              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)       29920000
299300              SET DP013-DB2-ABEND TO TRUE                         29930000
299400              PERFORM DP013-0000-PROCESS-ABEND                    29940000
299500     END-EVALUATE.                                                29950000
299600                                                                  29960000
299700* --------------------------------------------------------------  29970000
299800* GET TOTAL NUMBER OF CARTONS THAT HAVE BEEN SCANNED ON           29980000
299900* --------------------------------------------------------------  29990000
300000  4380-GET-TOT-SCANND.                                            30000000
300100     EXEC SQL                                                     30010000
300200          OPEN SCANNED-ON-CSR                                     30020000
300300     END-EXEC.                                                    30030000
300400                                                                  30040000
300500     EVALUATE TRUE                                                30050000
300600         WHEN SQLCODE = ZERO                                      30060000
300700         WHEN SQLCODE = +100                                      30070000
300800             CONTINUE                                             30080000
300900         WHEN SQLWARN0 NOT = SPACES                               30090000
301000         WHEN SQLCODE < ZERO                                      30100000
301100         WHEN SQLCODE > ZERO                                      30110000
301200             MOVE '4380-GET-TOT-SCANND' TO DP013-PARAGRAPH        30120000
301300             MOVE 'OPEN CURSOR PROBLEM   '                        30130000
301400                               TO DP013-MESSAGE-TEXT (1)          30140000
301500             MOVE SQLCA        TO DP013-SQLCA                     30150000
301600             MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)        30160000
301700             SET DP013-DB2-ABEND                                  30170000
301800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30180000
301900             PERFORM DP013-0000-PROCESS-ABEND                     30190000
302000     END-EVALUATE.                                                30200000
302100                                                                  30210000
302200     PERFORM 4387-FETCH-SCND-CSR UNTIL SQLCODE = +100.            30220000
302300     MOVE ZEROS TO SQLCODE.                                       30230000
302400     PERFORM 4385-CLOSE-SCND-CSR.                                 30240000
302500                                                                  30250000
302600* --------------------------------------------------------------  30260000
302700* CLOSE SCAN ON CURSOR.                                           30270000
302800* --------------------------------------------------------------  30280000
302900  4385-CLOSE-SCND-CSR.                                            30290000
303000     EXEC SQL                                                     30300000
303100         CLOSE SCANNED-ON-CSR                                     30310000
303200     END-EXEC.                                                    30320000
303300                                                                  30330000
303400     EVALUATE TRUE                                                30340000
303500         WHEN SQLCODE = ZERO                                      30350000
303600         WHEN SQLCODE = +100                                      30360000
303700             CONTINUE                                             30370000
303800         WHEN SQLWARN0 NOT = SPACE                                30380000
303900         WHEN SQLCODE NOT = ZERO                                  30390000
304000             MOVE '4385-CLOSE-SCND-CSR' TO DP013-PARAGRAPH        30400000
304100             MOVE 'CLOSE CURSOR PROBLEM   '                       30410000
304200                               TO DP013-MESSAGE-TEXT (1)          30420000
304300             MOVE SQLCA        TO DP013-SQLCA                     30430000
304400             MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)        30440000
304500             SET DP013-DB2-ABEND                                  30450000
304600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30460000
304700             PERFORM DP013-0000-PROCESS-ABEND                     30470000
304800     END-EVALUATE.                                                30480000
304900                                                                  30490000
305000*----------------------------------------------------------------*30500000
305100*    FETCH THE SCAN ON CURSOR                                     30510000
305200*----------------------------------------------------------------*30520000
305300 4387-FETCH-SCND-CSR.                                             30530000
305400     EXEC SQL                                                     30540000
305500         FETCH SCANNED-ON-CSR                                     30550000
305600          INTO  :PV-LINE-SCAND                                    30560000
305700     END-EXEC.                                                    30570000
305800                                                                  30580000
305900     EVALUATE TRUE                                                30590000
306000         WHEN SQLCODE = ZERO                                      30600000
306100              ADD PV-LINE-SCAND  TO ASC-LINE-SCAND                30610000
306200         WHEN SQLCODE = +100                                      30620000
306300              CONTINUE                                            30630000
306400         WHEN SQLCODE = -305                                      30640000
306500              ADD ZEROES         TO ASC-LINE-SCAND                30650000
306600         WHEN SQLWARN0 NOT = SPACE                                30660000
306700         WHEN SQLCODE NOT = ZERO                                  30670000
306800              MOVE '4387-FETCH-SCND-CSR' TO DP013-PARAGRAPH       30680000
306900              MOVE 'FETCH CURSOR PROBLEM '                        30690000
307000                               TO DP013-MESSAGE-TEXT (1)          30700000
307100              MOVE SQLCA       TO DP013-SQLCA                     30710000
307200              MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)       30720000
307300              SET DP013-DB2-ABEND TO TRUE                         30730000
307400              PERFORM DP013-0000-PROCESS-ABEND                    30740000
307500     END-EVALUATE.                                                30750000
307600                                                                  30760000
307700*----------------------------------------------------------------*30770000
307800* DETERMINE PROCESS CODE                                          30780000
307900*----------------------------------------------------------------*30790000
308000 4390-DETERMINE-PROC-CODE.                                        30800000
308100     PERFORM 4395-SELECT-TDISTHD.                                 30810000
308200     IF (DISTHD-P2L-CART-CNT = 0                                  30820000
308300        AND (DISTHD-FCSE-CART-CNT > 0                             30830000
308400        OR DISTHD-INPK-CART-CNT > 0))                             30840000
308500          MOVE PC-FCSE TO ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)30850000
308600     ELSE                                                         30860000
308700         IF (DISTHD-P2L-CART-CNT > 0                              30870000
308800           AND (DISTHD-FCSE-CART-CNT > 0                          30880000
308900             OR DISTHD-INPK-CART-CNT > 0))                        30890000
309000               MOVE PC-FCS-P2L TO                                 30900000
309100                          ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)30910000
309200         ELSE                                                     30920000
309300             IF (DISTHD-P2L-CART-CNT > 0                          30930000
309400                AND (DISTHD-FCSE-CART-CNT = 0                     30940000
309500                AND DISTHD-INPK-CART-CNT = 0))                    30950000
309600                MOVE PC-P2L TO                                    30960000
309700                          ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)30970000
309800             ELSE                                                 30980000
309900                 IF PS-NO-TDISTHD-FOUND                           30990000
310000                     IF RECITM-STATUS-CDE = 'VE'                  31000000
310100                        IF RECITM-VRFD-USR-ID (1:2) = 'TK' OR     31010000
310110                           RECITM-VRFD-USR-ID (1:2) = 'TC' OR     31011000
310120                           RECITM-VRFD-USR-ID (1:2) = 'TV'        31012000
310200                          MOVE PC-MANUAL TO                       31020000
310300                          ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)31030000
310400                        ELSE                                      31040000
310500                          MOVE RECITM-VRFD-USR-ID TO              31050000
310600                          ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)31060000
310700                        END-IF                                    31070000
310800                    ELSE                                          31080000
310900                        MOVE SPACES TO                            31090000
311000                          ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)31100000
311100                    END-IF                                        31110000
311200                 ELSE                                             31120000
311300                     IF DISTHD-TOT-CART-CNT = 0                   31130000
311400                         IF RECITM-STATUS-CDE = 'VE'              31140000
311500                            IF RECITM-VRFD-USR-ID (1:2) = 'TK' OR 31150000
311510                               RECITM-VRFD-USR-ID (1:2) = 'TC' OR 31151000
311520                               RECITM-VRFD-USR-ID (1:2) = 'TV'    31152000
311600                               MOVE PC-MANUAL TO ASC-PROC-CODE    31160000
311700                                        (ASC-BLK-SUB ASC-ITEM-SUB)31170000
311800                            ELSE                                  31180000
311900                               MOVE RECITM-VRFD-USR-ID TO         31190000
312000                               ASC-PROC-CODE                      31200000
312100                                        (ASC-BLK-SUB ASC-ITEM-SUB)31210000
312200                            END-IF                                31220000
312300                         ELSE                                     31230000
312400                             MOVE SPACES TO ASC-PROC-CODE         31240000
312500                                        (ASC-BLK-SUB ASC-ITEM-SUB)31250000
312600                         END-IF                                   31260000
312700                     ELSE                                         31270000
312800                         MOVE PC-MANUAL TO                        31280000
312900                          ASC-PROC-CODE (ASC-BLK-SUB ASC-ITEM-SUB)31290000
313000                     END-IF                                       31300000
313100                 END-IF                                           31310000
313200             END-IF                                               31320000
313300         END-IF                                                   31330000
313400     END-IF.                                                      31340000
313500                                                                  31350000
313600*----------------------------------------------------------------*31360000
313700* SELECT TDISTHD                                                  31370000
313800*----------------------------------------------------------------*31380000
313900 4395-SELECT-TDISTHD.                                             31390000
314000                                                                  31400000
314100     EXEC SQL                                                     31410000
314200         SELECT TOT_CART_CNT                                      31420000
314300               ,FCSE_CART_CNT                                     31430000
314400               ,P2L_CART_CNT                                      31440000
314500               ,INPK_CART_CNT                                     31450000
314600          INTO  :DISTHD-TOT-CART-CNT                              31460000
314700               ,:DISTHD-FCSE-CART-CNT                             31470000
314800               ,:DISTHD-P2L-CART-CNT                              31480000
314900               ,:DISTHD-INPK-CART-CNT                             31490000
315000          FROM  TDISTHD                                           31500000
315100          WHERE ORD_NBR          =  :DK-PO-NBR                    31510000
315200          AND   ORD_LNE_NBR     >=  :DK-LINE-BEGIN                31520000
315300          AND   ORD_LNE_NBR     <=  :DK-LINE-END                  31530000
315400          AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               31540000
315500     END-EXEC.                                                    31550000
315600                                                                  31560000
315700     EVALUATE TRUE                                                31570000
315800         WHEN SQLCODE = ZERO                                      31580000
315900              SET PS-TDISTHD-FOUND TO TRUE                        31590000
316000         WHEN SQLCODE = +100                                      31600000
316100              SET PS-NO-TDISTHD-FOUND TO TRUE                     31610000
316200              MOVE 0 TO DISTHD-TOT-CART-CNT                       31620000
316300                        DISTHD-FCSE-CART-CNT                      31630000
316400                        DISTHD-P2L-CART-CNT                       31640000
316500                        DISTHD-INPK-CART-CNT                      31650000
316600         WHEN SQLWARN0 NOT = SPACE                                31660000
316700         WHEN SQLCODE NOT = ZERO                                  31670000
316800              MOVE '5460-SELECT-TDISTHD' TO DP013-PARAGRAPH       31680000
316900              MOVE 'GET TDISTHD ROW'                              31690000
317000                                   TO DP013-MESSAGE-TEXT (1)      31700000
317100              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        31710000
317200              MOVE SQLCA       TO DP013-SQLCA                     31720000
317300              SET DP013-DB2-ABEND TO TRUE                         31730000
317400              PERFORM DP013-0000-PROCESS-ABEND                    31740000
317500     END-EVALUATE.                                                31750000
317600*----------------------------------------------------------------*31760000
317700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31770000
317800*----------------------------------------------------------------*31780000
317900 4400-MOVE-COMMAREA-TO-SCREEN.                                    31790000
318000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             31800000
318100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          31810000
318200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          31820000
318300             MOVE +1    TO ASC-BLK-SUB                            31830000
318400             PERFORM 5100-WRITE-TEMP-STORAGE                      31840000
318500             ADD +1     TO ASC-BLK-SUB                            31850000
318600             PERFORM 5100-WRITE-TEMP-STORAGE                      31860000
318700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             31870000
318800                 GIVING PV-BLOCK-NUMBER                           31880000
318900                 REMAINDER PV-REMAINDER                           31890000
319000             IF  PV-REMAINDER > ZERO                              31900000
319100                 ADD +1 TO PV-BLOCK-NUMBER                        31910000
319200             END-IF                                               31920000
319300             MOVE +1    TO ASC-BLK-SUB                            31930000
319400             PERFORM 4410-READ-TEMP-STORAGE                       31940000
319500             ADD +1     TO ASC-BLK-SUB                            31950000
319600                           PV-BLOCK-NUMBER                        31960000
319700             PERFORM 4410-READ-TEMP-STORAGE                       31970000
319800     END-IF.                                                      31980000
319900     MOVE +1            TO ASC-BLK-SUB.                           31990000
320000     COMPUTE ASC-ITEM-SUB =                                       32000000
320100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              32010000
320200         + PC-ITEMS-PER-PANEL).                                   32020000
320300*                                                                 32030000
320400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32040000
320500         ADD +1         TO ASC-BLK-SUB                            32050000
320600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32060000
320700     END-IF.                                                      32070000
320800*                                                                 32080000
320900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32090000
321000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32100000
321100     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        32110000
321200     PERFORM 4420-FORMAT-LIST-LINES                               32120000
321300         VARYING PV-SUB                                           32130000
321400         FROM PC-ITEMS-PER-PANEL BY -1                            32140000
321500         UNTIL PV-SUB < +1.                                       32150000
321600*                                                                 32160000
321700     COMPUTE ASC-ITEMS-DISPLAYED =                                32170000
321800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          32180000
321900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    32190000
322000                                      ASTRTITO.                   32200000
322100     MOVE ASC-ITEM-AT-BOT-OF-PANEL     TO AENDITO.                32210000
322200     MOVE ASC-NUMBER-OF-ITEMS-READ     TO ATOTITO.                32220000
322300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ASELITO.                32230000
322400                                                                  32240000
322500     MOVE ASC-PO-NBR           TO DK-PO-TRN-NBR.                  32250000
322600     MOVE DK-TRN-NBR-X         TO DK-TRN-NBR-9.                   32260000
322700     MOVE DK-TRN-NBR-8         TO DK-TRN-NBR.                     32270000
322800     MOVE ASC-RCVR-NBR         TO DK-PO-RCVR-NBR-N.               32280000
322900     MOVE DK-RCVR-NBR-X        TO DK-RCVR-NBR-9.                  32290000
323000     MOVE DK-RCVR-NBR-3        TO DK-RCVR-NBR.                    32300000
323100     MOVE DK-PO-RCVR           TO ASC-PO-RCVR                     32310000
323200                                  APORCVRO.                       32320000
323202* JAK 09/2009 WR37075 START                                       32320200
323210     IF ASC-CS-PULL-TRAN                                          32321000
323211         MOVE ASC-PULL-NBR     TO ASC-PO-RCVR                     32321100
323220                                  APORCVRO                        32322000
323222     END-IF.                                                      32322200
323223* JAK 09/2009 WR37075 END                                         32322300
323230                                                                  32323000
323240* DMH 11/23/11 - BEGIN                                            32324010
323250     IF  ASC-FX-FAST-TRANSFER                                     32325010
323260         MOVE ASC-FAST-EDIT    TO ASC-PO-RCVR                     32326010
323270                                  APORCVRO                        32327010
323280     END-IF.                                                      32328010
323290* DMH 11/23/11 - END                                              32329010
323291                                                                  32329110
323300     MOVE ASC-STATUS-CDE       TO ARCVRSTO.                       32330000
323400     IF ASC-STATUS-CDE =  'VE'                                    32340000
323500         MOVE ASC-TMST        TO DK-TMST                          32350000
323600         MOVE DK-YEAR         TO DK-DIS-YY                        32360000
323700         MOVE DK-MONTH        TO DK-DIS-MM                        32370000
323800         MOVE DK-DAY          TO DK-DIS-DD                        32380000
323900         MOVE DK-HOUR         TO DK-DIS-HH                        32390000
324000         MOVE DK-MINUTE       TO DK-DIS-MN                        32400000
324100     ELSE                                                         32410000
324200         MOVE SPACES          TO DK-DISPLAY-DATE                  32420000
324300                                 DK-DISPLAY-TIME                  32430000
324400                                 ASC-VRFD-USR-ID                  32440000
324500     END-IF.                                                      32450000
324600     MOVE DK-DISPLAY-DATE      TO ADATEO                          32460000
324700     MOVE DK-DISPLAY-TIME      TO ATIMEO                          32470000
324800     MOVE ASC-VRFD-USR-ID      TO AUSRIDO                         32480000
324900     MOVE ASC-CURR-OPER-UNT-ID TO AOPERO.                         32490000
325000     MOVE ASC-OPER-UNT-NAME    TO ANAMEO.                         32500000
325001* TKMAV49 - BEG                                                   32500100
325002     IF ASC-TRAN = '-CS'                                          32500200
325003        MOVE ASC-CNSTK            TO ACNSTKO                      32500300
325005        MOVE ASC-CS-OPER-UNT-ID   TO ACSOPERO                     32500500
325006     END-IF                                                       32500600
325007* TKMAV49 - END                                                   32500700
325100     IF ASC-PACK-BY-ST-IND = 'Y'                                  32510000
325200         MOVE  'PBS   '         TO ASC-PACKAGE                    32520000
325300     ELSE                                                         32530000
325400         IF ASC-DSP-INNER-PREPK                                   32540000
325500             MOVE  PC-INNER-PREPACK TO ASC-PACKAGE                32550000
325600         ELSE                                                     32560000
325700             IF ASC-DSP-MULTI-SKU-PREPK                           32570000
325800                 MOVE  PC-MULTI-SKU     TO ASC-PACKAGE            32580000
325900             ELSE                                                 32590000
326000                 IF ASC-DSP-SINGLE-SKU-PREPK                      32600000
326100                     MOVE  PC-SINGLE-SKU    TO ASC-PACKAGE        32610000
326200                 ELSE                                             32620000
326300                     IF ASC-DSP-CASEPACK                          32630000
326400                         MOVE  PC-CASEPACK  TO ASC-PACKAGE        32640000
326500                     ELSE                                         32650000
326600                         IF ASC-DSP-BULK-PACK                     32660000
326700                             MOVE  PC-BULK  TO ASC-PACKAGE        32670000
326800                         END-IF                                   32680000
326900                     END-IF                                       32690000
327000                 END-IF                                           32700000
327100             END-IF                                               32710000
327200         END-IF                                                   32720000
327300     END-IF                                                       32730000
327400     MOVE ASC-PACKAGE          TO APCKGO.                         32740000
327500     IF ASC-STATUS-CDE =  'VE'                                    32750000
327600         MOVE ASC-ACTL-CART-CNT   TO AINBCTNO                     32760000
327700     ELSE                                                         32770000
327800         IF ASC-STATUS-CDE NOT =  'VE' AND                        32780000
327900            ASC-ACTL-CART-CNT  = ZERO                             32790000
328000             MOVE ASC-EXPTED-CART-CNT TO AINBCTNO                 32800000
328100         ELSE                                                     32810000
328200             MOVE ASC-ACTL-CART-CNT   TO AINBCTNO                 32820000
328300         END-IF                                                   32830000
328400     END-IF.                                                      32840000
328500     IF ASC-STR-NBR   = ZEROES OR SPACES                          32850000
328600         MOVE 'ALL '                  TO ASTOREO                  32860000
328700         MOVE SPACES                  TO ASTNAMEO                 32870000
328800     ELSE                                                         32880000
328900         MOVE ASC-STR-NBR             TO ASTOREO                  32890000
329000         MOVE ASC-STORE-NAME          TO ASTNAMEO                 32900000
329100     END-IF.                                                      32910000
329200     MOVE ASC-VENDOR-NAME             TO AVNDRNMO.                32920000
329300     MOVE ASC-OUTBND-CRTNS            TO AOTBCTNO.                32930000
329400                                                                  32940000
329500     IF  DP020-MSG-NUMBER-X = SPACE                               32950000
329600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32960000
329700*            --- MORE ITEMS TO DISPLAY ----                       32970000
329800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            32980000
329900             SET DP020-MSG-INFORMATIONAL TO TRUE                  32990000
330000         END-IF                                                   33000000
330100     END-IF.                                                      33010000
330200                                                                  33020000
330300*----------------------------------------------------------------*33030000
330400*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *33040000
330500*----------------------------------------------------------------*33050000
330600 4410-READ-TEMP-STORAGE.                                          33060000
330700                                                                  33070000
330800     EXEC CICS                                                    33080000
330900         READQ TS                                                 33090000
331000             QUEUE (ASC-LIST-QUEUE-NAME)                          33100000
331100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33110000
331200             ITEM  (PV-BLOCK-NUMBER)                              33120000
331300             RESP  (PV-CICS-RESP)                                 33130000
331400     END-EXEC.                                                    33140000
331500                                                                  33150000
331600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       33160000
331700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     33170000
331800         CONTINUE                                                 33180000
331900     ELSE                                                         33190000
332000         SET DP013-CICS-ABEND     TO TRUE                         33200000
332100         SET DP013-NO-ROLLBACK    TO TRUE                         33210000
332200         MOVE '4410-READ-TEMP-STORAGE'                            33220000
332300                                  TO DP013-PARAGRAPH              33230000
332400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33240000
332500                                  TO DP013-MESSAGE-TEXT(1)        33250000
332600         PERFORM DP013-0000-PROCESS-ABEND                         33260000
332700     END-IF.                                                      33270000
332800                                                                  33280000
332900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33290000
333000*                                                                 33300000
333100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33310000
333200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33320000
333300     END-IF.                                                      33330000
333400                                                                  33340000
333500*----------------------------------------------------------------*33350000
333600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33360000
333700*----------------------------------------------------------------*33370000
333800 4420-FORMAT-LIST-LINES.                                          33380000
333900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33390000
334000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33400000
334100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           33410000
334200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           33420000
334300         MOVE SPACE              TO MR-SELECTI    (PV-SUB)        33430000
334400                                    MR-ACTION     (PV-SUB)        33440000
334500                                    MR-LINE-STAT  (PV-SUB)        33450000
334600                                    MR-PROC-CODE  (PV-SUB)        33460000
334700          MOVE ZEROES            TO MR-UNIT-VRFD  (PV-SUB)        33470000
334800                                    MR-LINE-NBR   (PV-SUB)        33480000
334900                                    MR-UNIT-MFST  (PV-SUB)        33490000
335000                                    MR-UNIT-VARI  (PV-SUB)        33500000
335100                                    MR-TOT-LINE   (PV-SUB)        33510000
335200                                    MR-TOT-SHIPD  (PV-SUB)        33520000
335300                                    MR-TOT-DIVERT (PV-SUB)        33530000
335400                                    MR-TOT-LOADD  (PV-SUB)        33540000
335500     ELSE                                                         33550000
335600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33560000
335700                                                   > SPACE        33570000
335800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33580000
335900                                 TO MR-SELECTI (PV-SUB)           33590000
336000         ELSE                                                     33600000
336100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33610000
336200                                 TO MR-SELECTI (PV-SUB)           33620000
336300         END-IF                                                   33630000
336400         IF  DP030-SET-CURSOR-TRAILER                             33640000
336500             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33650000
336600                 > SPACE)                                         33660000
336700               OR (PV-SUB = 1))                                   33670000
336800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33680000
336900                MOVE -1               TO MR-SELECTL (PV-SUB)      33690000
337000             END-IF                                               33700000
337100         END-IF                                                   33710000
337200*                                                                 33720000
337300         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               33730000
337400                                            TO MR-ACTION (PV-SUB) 33740000
337500         MOVE ASC-LINE-NBR(ASC-BLK-SUB ASC-ITEM-SUB)              33750000
337600                                          TO MR-LINE-NBR (PV-SUB) 33760000
337700         MOVE ASC-LINE-STAT(ASC-BLK-SUB ASC-ITEM-SUB)             33770000
337800                                         TO MR-LINE-STAT (PV-SUB) 33780000
337900         MOVE ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB)             33790000
338000                                         TO MR-UNIT-VRFD (PV-SUB) 33800000
338100         MOVE ASC-UNIT-MFST(ASC-BLK-SUB ASC-ITEM-SUB)             33810000
338200                                         TO MR-UNIT-MFST (PV-SUB) 33820000
338300         MOVE ASC-UNIT-VARI(ASC-BLK-SUB ASC-ITEM-SUB)             33830000
338400                                         TO MR-UNIT-VARI (PV-SUB) 33840000
338500         MOVE ASC-TOT-LINE (ASC-BLK-SUB ASC-ITEM-SUB)             33850000
338600                                          TO MR-TOT-LINE (PV-SUB) 33860000
338700         MOVE ASC-TOT-SHIPD(ASC-BLK-SUB ASC-ITEM-SUB)             33870000
338800                                         TO MR-TOT-SHIPD (PV-SUB) 33880000
338900         MOVE ASC-TOT-DIVERT(ASC-BLK-SUB ASC-ITEM-SUB)            33890000
339000                                        TO MR-TOT-DIVERT (PV-SUB) 33900000
339100         MOVE ASC-TOT-LOADD(ASC-BLK-SUB ASC-ITEM-SUB)             33910000
339200                                         TO MR-TOT-LOADD (PV-SUB) 33920000
339300         MOVE ASC-PROC-CODE(ASC-BLK-SUB ASC-ITEM-SUB)             33930000
339400                                         TO MR-PROC-CODE (PV-SUB) 33940000
339500         IF ASC-TOT-LINE (ASC-BLK-SUB ASC-ITEM-SUB) NOT =         33950000
339600            ASC-TOT-SHIPD(ASC-BLK-SUB ASC-ITEM-SUB)               33960000
339700                MOVE DP015-YELLOW TO MR-TOT-SHIPDC (PV-SUB)       33970000
339800         ELSE                                                     33980000
339900                MOVE DP015-BLUE   TO MR-TOT-SHIPDC (PV-SUB)       33990000
340000         END-IF                                                   34000000
340100     END-IF.                                                      34010000
340200     SUBTRACT +1 FROM ASC-ITEM-SUB                                34020000
340300     IF  ASC-ITEM-SUB < + 1                                       34030000
340400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  34040000
340500         MOVE +1                 TO ASC-BLK-SUB                   34050000
340600     END-IF.                                                      34060000
340700                                                                  34070000
340800******************************************************************34080000
340900** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **34090000
341000** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **34100000
341100** ISSUE A WARNING.                                             **34110000
341200******************************************************************34120000
341300 4430-CHECK-FOR-BEGIN-AND-END.                                    34130000
341400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34140000
341500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34150000
341600*            -- NO END-OF-RANGE SPECFIED ---                      34160000
341700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34170000
341800             SET DP020-MSG-WARNING TO TRUE                        34180000
341900             PERFORM 4431-POSITION-AT-WARNING                     34190000
342000         END-IF                                                   34200000
342100     ELSE                                                         34210000
342200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34220000
342300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34230000
342400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34240000
342500             SET DP020-MSG-WARNING TO TRUE                        34250000
342600             PERFORM 4431-POSITION-AT-WARNING                     34260000
342700         END-IF                                                   34270000
342800     END-IF.                                                      34280000
342900******************************************************************34290000
343000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **34300000
343100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **34310000
343200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **34320000
343300** POSITION THE CURSOR THERE.                                   **34330000
343400******************************************************************34340000
343500 4431-POSITION-AT-WARNING.                                        34350000
343600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34360000
343700                    - PV-TOP-ITEM + 1.                            34370000
343800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34380000
343900         CONTINUE                                                 34390000
344000     ELSE                                                         34400000
344100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34410000
344200         MOVE -1                    TO ASTRTITL                   34420000
344300     END-IF.                                                      34430000
344400*                                                                 34440000
344500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34450000
344600                    - PV-TOP-ITEM + 1.                            34460000
344700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34470000
344800         CONTINUE                                                 34480000
344900     ELSE                                                         34490000
345000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34500000
345100         MOVE -1                   TO ASTRTITL                    34510000
345200     END-IF.                                                      34520000
345300                                                                  34530000
345400*----------------------------------------------------------------*34540000
345500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34550000
345600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34560000
345700* FOR THE SELECTED ITEMS QUEUE.                                  *34570000
345800*                                                                *34580000
345900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *34590000
346000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *34600000
346100* THE ARRAY IS FULL.                                             *34610000
346200*----------------------------------------------------------------*34620000
346300 5000-PREPARE-SEL-QUEUE.                                          34630000
346400                                                                  34640000
346500     MOVE +1                   TO  ASC-BLK-SUB.                   34650000
346600     PERFORM 5100-WRITE-TEMP-STORAGE.                             34660000
346700     ADD +1                    TO  ASC-BLK-SUB.                   34670000
346800     PERFORM 5100-WRITE-TEMP-STORAGE.                             34680000
346900                                                                  34690000
347000     MOVE ASC-SEL-QUEUE-NAME-2 TO  SU009-SEL-QUEUE-NAME.          34700000
347100     PERFORM 6010-DELETE-SEL-QUEUE.                               34710000
347200                                                                  34720000
347300     SET ASC-UPDATE-TSQ        TO  TRUE.                          34730000
347400                                                                  34740000
347500     SET SU010-IDX             TO  1.                             34750000
347600     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       34760000
347700     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        34770000
347800                                                                  34780000
347900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           34790000
348000             VARYING PV-ITEM                                      34800000
348100             FROM 1 BY 1                                          34810000
348200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     34820000
348300                                                                  34830000
348400     IF  SU010-IDX > 1                                            34840000
348500         PERFORM 5205-WRITE-SEL-QUEUE                             34850000
348600         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        34860000
348700     END-IF.                                                      34870000
348800                                                                  34880000
348900*----------------------------------------------------------------*34890000
349000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34900000
349100* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34910000
349200* FOR THE SELECTED ITEMS QUEUE.                                  *34920000
349300*                                                                *34930000
349400* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *34940000
349500* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *34950000
349600* THE ARRAY IS FULL.                                             *34960000
349700*----------------------------------------------------------------*34970000
349800 5000A-PREPARE-SEL-QUEUE.                                         34980000
349900                                                                  34990000
350000     MOVE +1                   TO  ASC-BLK-SUB.                   35000000
350100     PERFORM 5100-WRITE-TEMP-STORAGE.                             35010000
350200     ADD +1                    TO  ASC-BLK-SUB.                   35020000
350300     PERFORM 5100-WRITE-TEMP-STORAGE.                             35030000
350400                                                                  35040000
350500     MOVE ASC-SEL-QUEUE-NAME   TO  SU038-SEL-QUEUE-NAME.          35050000
350600     PERFORM 6010-DELETE-SEL-QUEUE.                               35060000
350700                                                                  35070000
350800     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      35080000
350900         SET ASC-UPDATE-TSQ        TO TRUE                        35090000
351000     END-IF.                                                      35100000
351100                                                                  35110000
351200     SET SU039-IDX             TO  1.                             35120000
351300     MOVE ZERO                 TO SU038-NUMBER-OF-TS-ITEMS.       35130000
351400     INITIALIZE SU039-SELECTED-ITEM-ARRAY.                        35140000
351500                                                                  35150000
351600     PERFORM 5200A-FILL-SEL-QUEUE-RECORD                          35160000
351700             VARYING PV-ITEM                                      35170000
351800             FROM 1 BY 1                                          35180000
351900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     35190000
352000                                                                  35200000
352100     IF  SU039-IDX > 1                                            35210000
352200         PERFORM 5205A-WRITE-SEL-QUEUE                            35220000
352300         ADD +1                TO SU038-NUMBER-OF-TS-ITEMS        35230000
352400     END-IF.                                                      35240000
352500                                                                  35250000
352600*----------------------------------------------------------------*35260000
352700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *35270000
352800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *35280000
352900*----------------------------------------------------------------*35290000
353000 5100-WRITE-TEMP-STORAGE.                                         35300000
353100     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35310000
353200                                   TO PV-LIST-ITEM-NUMBER.        35320000
353300     COMPUTE PV-BLOCK-NUMBER =                                    35330000
353400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35340000
353500                                                                  35350000
353600     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35360000
353700     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35370000
353800         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35380000
353900             PERFORM 5105-REWRITE-ASC-LISTQ                       35390000
354000         END-IF                                                   35400000
354100     ELSE                                                         35410000
354200         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35420000
354300         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35430000
354400         PERFORM 5110-WRITE-ASC-LISTQ                             35440000
354500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35450000
354600     END-IF.                                                      35460000
354700                                                                  35470000
354800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35480000
354900                                                                  35490000
355000******************************************************************35500000
355100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **35510000
355200** SPECIFIC COMMAREA.                                           **35520000
355300******************************************************************35530000
355400 5105-REWRITE-ASC-LISTQ.                                          35540000
355500     EXEC CICS                                                    35550000
355600         WRITEQ TS                                                35560000
355700             QUEUE (ASC-LIST-QUEUE-NAME)                          35570000
355800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35580000
355900             ITEM  (PV-BLOCK-NUMBER)                              35590000
356000             REWRITE                                              35600000
356100             RESP  (PV-CICS-RESP)                                 35610000
356200     END-EXEC.                                                    35620000
356300                                                                  35630000
356400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35640000
356500         CONTINUE                                                 35650000
356600     ELSE                                                         35660000
356700         SET DP013-CICS-ABEND            TO TRUE                  35670000
356800         SET DP013-NO-ROLLBACK           TO TRUE                  35680000
356900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       35690000
357000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35700000
357100                                         TO DP013-MESSAGE-TEXT(1) 35710000
357200         PERFORM DP013-0000-PROCESS-ABEND                         35720000
357300     END-IF.                                                      35730000
357400                                                                  35740000
357500******************************************************************35750000
357600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **35760000
357700** SPECIFIC COMMAREA.                                           **35770000
357800******************************************************************35780000
357900 5110-WRITE-ASC-LISTQ.                                            35790000
358000     EXEC CICS                                                    35800000
358100         WRITEQ TS                                                35810000
358200             QUEUE (ASC-LIST-QUEUE-NAME)                          35820000
358300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35830000
358400             ITEM  (PV-BLOCK-NUMBER)                              35840000
358500             RESP  (PV-CICS-RESP)                                 35850000
358600     END-EXEC.                                                    35860000
358700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      35870000
358800         SET DP013-CICS-ABEND      TO TRUE                        35880000
358900         SET DP013-NO-ROLLBACK     TO TRUE                        35890000
359000         MOVE '5110-WRITE-ASC-LISTQ'                              35900000
359100                                   TO DP013-PARAGRAPH             35910000
359200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           35920000
359300                                   TO DP013-MESSAGE-TEXT(1)       35930000
359400         PERFORM DP013-0000-PROCESS-ABEND                         35940000
359500     END-IF.                                                      35950000
359600                                                                  35960000
359700*----------------------------------------------------------------*35970000
359800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *35980000
359900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *35990000
360000*----------------------------------------------------------------*36000000
360100 5200-FILL-SEL-QUEUE-RECORD.                                      36010000
360200                                                                  36020000
360300     PERFORM 6112-READ-LIST-QUEUE.                                36030000
360400                                                                  36040000
360500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36050000
360600         PERFORM                                                  36060000
360700         VARYING LQW-IDX                                          36070000
360800         FROM 1 BY 1                                              36080000
360900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36090000
361000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          36100000
361100                                                                  36110000
361200             IF  LQW-SELECT (LQW-IDX)                             36120000
361300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              36130000
361400                                   TO SU010-ITEM (SU010-IDX)      36140000
361500                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 36150000
361600                                                                  36160000
361700                 MOVE LQW-LINE-NBR(LQW-IDX)                       36170000
361800                                     TO SU010-LINE-NBR(SU010-IDX) 36180000
361900                 MOVE LQW-LINE-STAT(LQW-IDX)                      36190000
362000                                    TO SU010-LINE-STAT(SU010-IDX) 36200000
362100                 MOVE LQW-UNTS-VRFD(LQW-IDX)                      36210000
362200                                    TO SU010-UNTS-VRFD(SU010-IDX) 36220000
362300                 MOVE LQW-UNTS-MFSD(LQW-IDX)                      36230000
362400                                    TO SU010-UNTS-MFSD(SU010-IDX) 36240000
362500                 MOVE LQW-UNTS-VARI(LQW-IDX)                      36250000
362600                                    TO SU010-UNTS-VARI(SU010-IDX) 36260000
362700                 MOVE LQW-TOT-CRTNS(LQW-IDX)                      36270000
362800                                    TO SU010-TOT-CRTNS(SU010-IDX) 36280000
362900                                                                  36290000
363000                 SET SU010-IDX UP BY 1                            36300000
363100                 IF  SU010-IDX > SU010-MAX-ITEMS                  36310000
363200                     PERFORM 5205-WRITE-SEL-QUEUE                 36320000
363300                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    36330000
363400                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         36340000
363500                     SET SU010-IDX TO  1                          36350000
363600                 END-IF                                           36360000
363700             END-IF                                               36370000
363800         END-PERFORM                                              36380000
363900     END-IF.                                                      36390000
364000                                                                  36400000
364100*----------------------------------------------------------------*36410000
364200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *36420000
364300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *36430000
364400*----------------------------------------------------------------*36440000
364500 5200A-FILL-SEL-QUEUE-RECORD.                                     36450000
364600                                                                  36460000
364700     PERFORM 6112-READ-LIST-QUEUE.                                36470000
364800                                                                  36480000
364900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36490000
365000         PERFORM                                                  36500000
365100         VARYING LQW-IDX                                          36510000
365200         FROM 1 BY 1                                              36520000
365300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36530000
365400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          36540000
365500                                                                  36550000
365600             IF  LQW-SELECT (LQW-IDX)                             36560000
365700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              36570000
365800                                   TO SU039-ITEM (SU039-IDX)      36580000
365900                 MOVE SPACE        TO SU039-ACTION-SW (SU039-IDX) 36590000
366000                                                                  36600000
366100                 MOVE LQW-LINE-NBR(LQW-IDX)                       36610000
366200                                     TO SU039-LINE(SU039-IDX)     36620000
366300                                                                  36630000
366400                 SET SU039-IDX UP BY 1                            36640000
366500                 IF  SU039-IDX > SU039-MAX-ITEMS                  36650000
366600                     PERFORM 5205A-WRITE-SEL-QUEUE                36660000
366700                     ADD +1        TO SU038-NUMBER-OF-TS-ITEMS    36670000
366800                     INITIALIZE SU039-SELECTED-ITEM-ARRAY         36680000
366900                     SET SU039-IDX TO  1                          36690000
367000                 END-IF                                           36700000
367100             END-IF                                               36710000
367200         END-PERFORM                                              36720000
367300     END-IF.                                                      36730000
367400                                                                  36740000
367500*----------------------------------------------------------------*36750000
367600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *36760000
367700*----------------------------------------------------------------*36770000
367800 5205-WRITE-SEL-QUEUE.                                            36780000
367900                                                                  36790000
368000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36800000
368100                                   TO SU010-SELECTED-ITEMS.       36810000
368200                                                                  36820000
368300     EXEC CICS                                                    36830000
368400          WRITEQ TS                                               36840000
368500              QUEUE (ASC-SEL-QUEUE-NAME-2)                        36850000
368600              FROM  (SU010-SELECT-RECORD)                         36860000
368700              ITEM  (PV-SEL-QUEUE-ITEM)                           36870000
368800              RESP  (PV-CICS-RESP)                                36880000
368900     END-EXEC.                                                    36890000
369000                                                                  36900000
369100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36910000
369200         CONTINUE                                                 36920000
369300     ELSE                                                         36930000
369400         SET DP013-CICS-ABEND      TO TRUE                        36940000
369500         SET DP013-NO-ROLLBACK     TO TRUE                        36950000
369600         MOVE '5205-WRITE-SEL-QUEUE'                              36960000
369700                                   TO DP013-PARAGRAPH             36970000
369800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36980000
369900                                   TO DP013-MESSAGE-TEXT(1)       36990000
370000         PERFORM DP013-0000-PROCESS-ABEND                         37000000
370100     END-IF.                                                      37010000
370200                                                                  37020000
370300*----------------------------------------------------------------*37030000
370400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *37040000
370500*----------------------------------------------------------------*37050000
370600 5205A-WRITE-SEL-QUEUE.                                           37060000
370700                                                                  37070000
370800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37080000
370900                                   TO SU039-SELECTED-ITEMS.       37090000
371000                                                                  37100000
371100     EXEC CICS                                                    37110000
371200          WRITEQ TS                                               37120000
371300              QUEUE (ASC-SEL-QUEUE-NAME)                          37130000
371400              FROM  (SU039-SELECT-RECORD)                         37140000
371500              ITEM  (PV-SEL-QUEUE-ITEM)                           37150000
371600              RESP  (PV-CICS-RESP)                                37160000
371700     END-EXEC.                                                    37170000
371800                                                                  37180000
371900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37190000
372000         CONTINUE                                                 37200000
372100     ELSE                                                         37210000
372200         SET DP013-CICS-ABEND      TO TRUE                        37220000
372300         SET DP013-NO-ROLLBACK     TO TRUE                        37230000
372400         MOVE '5205A-WRITE-SEL-QUEUE'                             37240000
372500                                   TO DP013-PARAGRAPH             37250000
372600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          37260000
372700                                   TO DP013-MESSAGE-TEXT(1)       37270000
372800         PERFORM DP013-0000-PROCESS-ABEND                         37280000
372900     END-IF.                                                      37290000
373000                                                                  37300000
373100******************************************************************37310000
373200** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **37320000
373300** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **37330000
373400** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **37340000
373500** THE USER.                                                    **37350000
373600***************                                                   37360000
373700 6000-REFRESH-PANEL-FROM-TEMP.                                    37370000
373800                                                                  37380000
373900     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      37390000
374000         SET ASC-NO-TSQ-UPDATE TO TRUE                            37400000
374100         MOVE ZERO                 TO PV-SAVE-ITEM                37410000
374200                                      PV-SEL-QUEUE-ITEM           37420000
374300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        37430000
374400                                   TO PV-HOLD-SELECTED-ITEMS      37440000
374500         MOVE +1                   TO PV-ITEMS-PROCESSED          37450000
374600         EVALUATE TRUE                                            37460000
374700            WHEN ASC-FUNC02-RETURN-YES                            37470000
374800               PERFORM 6100A-UPDATE-TSQ                           37480000
374900                   UNTIL PV-ITEMS-PROCESSED >                     37490000
375000                                        PV-HOLD-SELECTED-ITEMS    37500000
375100            WHEN OTHER                                            37510000
375200               PERFORM 6100-UPDATE-TSQ                            37520000
375300                   UNTIL PV-ITEMS-PROCESSED >                     37530000
375400                                        PV-HOLD-SELECTED-ITEMS    37540000
375500         END-EVALUATE                                             37550000
375600                                                                  37560000
375700*        EVALUATE TRUE                                            37570000
375800*           WHEN ASC-FUNC02-RETURN-YES                            37580000
375900*              PERFORM 6010A-DELETE-SEL-QUEUE                     37590000
376000*           WHEN OTHER                                            37600000
376100*              PERFORM 6010-DELETE-SEL-QUEUE                      37610000
376200*        END-EVALUATE                                             37620000
376300                                                                  37630000
376400         SET ASC-FUNC02-RETURN-NO TO TRUE                         37640000
376500                                                                  37650000
376600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         37660000
376700                    ASC-BLOCK-ENTRIES (2)                         37670000
376800     END-IF.                                                      37680000
376900                                                                  37690000
377000*----------------------------------------------------------------*37700000
377100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *37710000
377200*----------------------------------------------------------------*37720000
377300 6010-DELETE-SEL-QUEUE.                                           37730000
377400                                                                  37740000
377500     EXEC CICS                                                    37750000
377600         DELETEQ TS                                               37760000
377700             QUEUE (ASC-SEL-QUEUE-NAME-2)                         37770000
377800             RESP  (PV-CICS-RESP)                                 37780000
377900     END-EXEC.                                                    37790000
378000*                                                                 37800000
378100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      37810000
378200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         37820000
378300         CONTINUE                                                 37830000
378400     ELSE                                                         37840000
378500         SET DP013-CICS-ABEND TO TRUE                             37850000
378600         SET DP013-NO-ROLLBACK TO TRUE                            37860000
378700         MOVE '6010-DELETE-SEL-QUEUE'                             37870000
378800                        TO DP013-PARAGRAPH                        37880000
378900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         37890000
379000                        TO DP013-MESSAGE-TEXT (1)                 37900000
379100         PERFORM DP013-0000-PROCESS-ABEND                         37910000
379200     END-IF.                                                      37920000
379300                                                                  37930000
379400*----------------------------------------------------------------*37940000
379500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *37950000
379600*----------------------------------------------------------------*37960000
379700 6010A-DELETE-SEL-QUEUE.                                          37970000
379800                                                                  37980000
379900     EXEC CICS                                                    37990000
380000         DELETEQ TS                                               38000000
380100             QUEUE (ASC-SEL-QUEUE-NAME)                           38010000
380200             RESP  (PV-CICS-RESP)                                 38020000
380300     END-EXEC.                                                    38030000
380400*                                                                 38040000
380500     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      38050000
380600        (PV-CICS-RESP = DFHRESP(QIDERR)))                         38060000
380700         CONTINUE                                                 38070000
380800     ELSE                                                         38080000
380900         SET DP013-CICS-ABEND TO TRUE                             38090000
381000         SET DP013-NO-ROLLBACK TO TRUE                            38100000
381100         MOVE '6010-DELETE-SEL-QUEUE'                             38110000
381200                        TO DP013-PARAGRAPH                        38120000
381300         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         38130000
381400                        TO DP013-MESSAGE-TEXT (1)                 38140000
381500         PERFORM DP013-0000-PROCESS-ABEND                         38150000
381600     END-IF.                                                      38160000
381700                                                                  38170000
381800*----------------------------------------------------------------*38180000
381900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *38190000
382000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *38200000
382100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *38210000
382200*    THE TEMP QUEUE.                                             *38220000
382300*----------------------------------------------------------------*38230000
382400 6100-UPDATE-TSQ.                                                 38240000
382500                                                                  38250000
382600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             38260000
382700     PERFORM 6105-READ-SEL-QUEUE.                                 38270000
382800                                                                  38280000
382900     PERFORM                                                      38290000
383000         VARYING SU010-IDX                                        38300000
383100         FROM 1 BY 1                                              38310000
383200         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     38320000
383300         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             38330000
383400         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  38340000
383500             PERFORM 6110-PROCESS-ITEMS                           38350000
383600         END-IF                                                   38360000
383700         ADD +1                TO PV-ITEMS-PROCESSED              38370000
383800     END-PERFORM.                                                 38380000
383900     PERFORM 6111-WRITE-LIST-QUEUE.                               38390000
384000                                                                  38400000
384100*----------------------------------------------------------------*38410000
384200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *38420000
384300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *38430000
384400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *38440000
384500*    THE TEMP QUEUE.                                             *38450000
384600*----------------------------------------------------------------*38460000
384700 6100A-UPDATE-TSQ.                                                38470000
384800                                                                  38480000
384900     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             38490000
385000     PERFORM 6105A-READ-SEL-QUEUE.                                38500000
385100     PERFORM                                                      38510000
385200         VARYING SU039-IDX                                        38520000
385300         FROM 1 BY 1                                              38530000
385400         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     38540000
385500         OR (SU039-IDX GREATER THAN SU039-MAX-ITEMS))             38550000
385600         IF  SU039-ACTION-SW (SU039-IDX) > SPACE                  38560000
385700             PERFORM 6110A-PROCESS-ITEMS                          38570000
385800         END-IF                                                   38580000
385900         ADD +1                TO PV-ITEMS-PROCESSED              38590000
386000     END-PERFORM.                                                 38600000
386100     PERFORM 6111-WRITE-LIST-QUEUE.                               38610000
386200                                                                  38620000
386300*----------------------------------------------------------------*38630000
386400*    READ THE LIST QUEUE RECORD.                                 *38640000
386500*----------------------------------------------------------------*38650000
386600 6105-READ-SEL-QUEUE.                                             38660000
386700                                                                  38670000
386800     EXEC CICS                                                    38680000
386900          READQ TS                                                38690000
387000              QUEUE (ASC-SEL-QUEUE-NAME-2)                        38700000
387100              INTO  (SU010-SELECT-RECORD)                         38710000
387200              ITEM  (PV-SEL-QUEUE-ITEM)                           38720000
387300              RESP  (PV-CICS-RESP)                                38730000
387400     END-EXEC.                                                    38740000
387500*                                                                 38750000
387600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38760000
387700         CONTINUE                                                 38770000
387800     ELSE                                                         38780000
387900         SET DP013-CICS-ABEND      TO  TRUE                       38790000
388000         SET DP013-NO-ROLLBACK     TO  TRUE                       38800000
388100         MOVE '6105-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           38810000
388200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           38820000
388300                                   TO  DP013-MESSAGE-TEXT(1)      38830000
388400         PERFORM DP013-0000-PROCESS-ABEND                         38840000
388500     END-IF.                                                      38850000
388600                                                                  38860000
388700*----------------------------------------------------------------*38870000
388800*    READ THE LIST QUEUE RECORD.                                 *38880000
388900*----------------------------------------------------------------*38890000
389000 6105A-READ-SEL-QUEUE.                                            38900000
389100                                                                  38910000
389200     EXEC CICS                                                    38920000
389300          READQ TS                                                38930000
389400              QUEUE (ASC-SEL-QUEUE-NAME)                          38940000
389500              INTO  (SU039-SELECT-RECORD)                         38950000
389600              ITEM  (PV-SEL-QUEUE-ITEM)                           38960000
389700              RESP  (PV-CICS-RESP)                                38970000
389800     END-EXEC.                                                    38980000
389900*                                                                 38990000
390000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39000000
390100         CONTINUE                                                 39010000
390200     ELSE                                                         39020000
390300         SET DP013-CICS-ABEND      TO  TRUE                       39030000
390400         SET DP013-NO-ROLLBACK     TO  TRUE                       39040000
390500         MOVE '6105A-READ-SEL-QUEUE' TO  DP013-PARAGRAPH          39050000
390600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           39060000
390700                                   TO  DP013-MESSAGE-TEXT(1)      39070000
390800         PERFORM DP013-0000-PROCESS-ABEND                         39080000
390900     END-IF.                                                      39090000
391000                                                                  39100000
391100*----------------------------------------------------------------*39110000
391200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*39120000
391300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*39130000
391400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *39140000
391500*----------------------------------------------------------------*39150000
391600 6110-PROCESS-ITEMS.                                              39160000
391700                                                                  39170000
391800     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          39180000
391900                     / PC-ITEMS-PER-PANEL).                       39190000
392000                                                                  39200000
392100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           39210000
392200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          39220000
392300             PERFORM 6111-WRITE-LIST-QUEUE                        39230000
392400         END-IF                                                   39240000
392500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    39250000
392600                                                                  39260000
392700         PERFORM 6112-READ-LIST-QUEUE                             39270000
392800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               39280000
392900             CONTINUE                                             39290000
393000         END-IF                                                   39300000
393100     END-IF.                                                      39310000
393200                                                                  39320000
393300     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     39330000
393400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              39340000
393500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         39350000
393600     MOVE LQW-SELECTED-SW (PV-SUB)                                39360000
393700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  39370000
393800                                                                  39380000
393900     EVALUATE TRUE                                                39390000
394000         WHEN SU010-INQ (SU010-IDX)                               39400000
394100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             39410000
394200                                                                  39420000
394300         WHEN SU010-UPD (SU010-IDX)                               39430000
394400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             39440000
394500                                                                  39450000
394600         WHEN SU010-DEL (SU010-IDX)                               39460000
394700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             39470000
394800                                                                  39480000
394900         WHEN SU010-ERR (SU010-IDX)                               39490000
395000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             39500000
395100     END-EVALUATE.                                                39510000
395200                                                                  39520000
395300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                39530000
395400                                                                  39540000
395500*----------------------------------------------------------------*39550000
395600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*39560000
395700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*39570000
395800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *39580000
395900*----------------------------------------------------------------*39590000
396000 6110A-PROCESS-ITEMS.                                             39600000
396100                                                                  39610000
396200     COMPUTE PV-ITEM = 1 + ((SU039-ITEM (SU039-IDX) - 1)          39620000
396300                     / PC-ITEMS-PER-PANEL).                       39630000
396400                                                                  39640000
396500     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           39650000
396600         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          39660000
396700             PERFORM 6111-WRITE-LIST-QUEUE                        39670000
396800         END-IF                                                   39680000
396900         MOVE PV-ITEM          TO PV-SAVE-ITEM                    39690000
397000                                                                  39700000
397100         PERFORM 6112-READ-LIST-QUEUE                             39710000
397200         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               39720000
397300             CONTINUE                                             39730000
397400         END-IF                                                   39740000
397500     END-IF.                                                      39750000
397600                                                                  39760000
397700     COMPUTE PV-SUB = (SU039-ITEM (SU039-IDX)                     39770000
397800                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              39780000
397900     SET LQW-DESELECT (PV-SUB) TO    TRUE                         39790000
398000     MOVE LQW-SELECTED-SW (PV-SUB)                                39800000
398100                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  39810000
398200                                                                  39820000
398300     EVALUATE TRUE                                                39830000
398400         WHEN SU039-INQ (SU039-IDX)                               39840000
398500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             39850000
398600                                                                  39860000
398700         WHEN SU039-UPD (SU039-IDX)                               39870000
398800              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             39880000
398900                                                                  39890000
399000         WHEN SU039-DEL (SU039-IDX)                               39900000
399100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             39910000
399200                                                                  39920000
399300         WHEN SU039-ERR (SU039-IDX)                               39930000
399400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             39940000
399500     END-EVALUATE.                                                39950000
399600                                                                  39960000
399700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                39970000
399800                                                                  39980000
399900*----------------------------------------------------------------*39990000
400000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *40000000
400100*----------------------------------------------------------------*40010000
400200 6111-WRITE-LIST-QUEUE.                                           40020000
400300                                                                  40030000
400400     EXEC CICS                                                    40040000
400500         WRITEQ TS                                                40050000
400600             QUEUE (ASC-LIST-QUEUE-NAME)                          40060000
400700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     40070000
400800             ITEM  (PV-SAVE-ITEM)                                 40080000
400900             REWRITE                                              40090000
401000             RESP  (PV-CICS-RESP)                                 40100000
401100     END-EXEC.                                                    40110000
401200*                                                                 40120000
401300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40130000
401400         CONTINUE                                                 40140000
401500     ELSE                                                         40150000
401600         SET DP013-CICS-ABEND  TO  TRUE                           40160000
401700         SET DP013-NO-ROLLBACK TO  TRUE                           40170000
401800         MOVE '6111-WRITE-LIST-QUEUE'                             40180000
401900                               TO  DP013-PARAGRAPH                40190000
402000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  40200000
402100                               TO  DP013-MESSAGE-TEXT(1)          40210000
402200         PERFORM DP013-0000-PROCESS-ABEND                         40220000
402300     END-IF.                                                      40230000
402400                                                                  40240000
402500*----------------------------------------------------------------*40250000
402600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*40260000
402700*----------------------------------------------------------------*40270000
402800 6112-READ-LIST-QUEUE.                                            40280000
402900                                                                  40290000
403000     EXEC CICS                                                    40300000
403100         READQ TS                                                 40310000
403200             QUEUE (ASC-LIST-QUEUE-NAME)                          40320000
403300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     40330000
403400             ITEM  (PV-ITEM)                                      40340000
403500             RESP  (PV-CICS-RESP)                                 40350000
403600     END-EXEC.                                                    40360000
403700*                                                                 40370000
403800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40380000
403900         CONTINUE                                                 40390000
404000     ELSE                                                         40400000
404100         SET DP013-CICS-ABEND        TO TRUE                      40410000
404200         SET DP013-NO-ROLLBACK       TO TRUE                      40420000
404300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           40430000
404400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    40440000
404500                                     TO DP013-MESSAGE-TEXT(1)     40450000
404600         PERFORM DP013-0000-PROCESS-ABEND                         40460000
404700     END-IF.                                                      40470000
404800                                                                  40480000
404900*----------------------------------------------------------------*40490000
405000*    CALL (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)             40500000
405100*    TO SEE IF THIS IS AN AUTOVE PO                               40510000
405200*----------------------------------------------------------------*40520000
405300 7000-CHECK-AUTOVE.                                               40530000
405400                                                                  40540000
405500     INITIALIZE RC040-FIELDS.                                     40550000
405600     MOVE ASC-CURR-OPER-UNT-ID TO RC040-SIGNON-LOCATION.          40560000
405700     MOVE ASC-PO-NBR           TO RC040-PO-NBR.                   40570000
405800     MOVE ASC-RCVR-NBR         TO RC040-PO-RCVR.                  40580000
405900     SET  RC040-RCVR-EXISTS    TO TRUE.                           40590000
406000     MOVE DP020-USERID         TO RC040-USER-ID.                  40600000
406100     MOVE 'SUKCS598'           TO RC040-CALLING-PROGRAM.          40610000
406200                                                                  40620000
406300     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  40630000
406400                                        RC040-COMMAREA            40640000
406500                                        RC040-FIELDS.             40650000
406600     EVALUATE TRUE                                                40660000
406700         WHEN RC040-SUCCESSFUL                                    40670000
406800              MOVE RC040-AUTO-VE-SW     TO ASC-AUTO-VE-SW         40680000
406900         WHEN RC040-DATABASE-BUSY OR                              40690000
407000              RC040-INVALID-SQL                                   40700000
407100                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       40710000
407200                  SET DP020-MSG-WARNING TO TRUE                   40720000
407300                  SET DP030-OVERRIDE-GO TO TRUE                   40730000
407400                  SET PS-ERROR          TO TRUE                   40740000
407500         WHEN RC040-NOT-SUCCESSFUL                                40750000
407600                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       40760000
407700                  SET DP020-MSG-WARNING TO TRUE                   40770000
407800                  SET DP030-OVERRIDE-GO TO TRUE                   40780000
407900                  SET PS-ERROR          TO TRUE                   40790000
408000         WHEN OTHER                                               40800000
408100             MOVE '7000-CHECK-AUTOVE ' TO DP013-PARAGRAPH         40810000
408200             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              40820000
408300                                         TO DP013-MESSAGE-TEXT (1)40830000
408400             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)40840000
408500             MOVE RC040-SQLCA            TO DP013-SQLCA           40850000
408600             SET DP013-DB2-ABEND                                  40860000
408700                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              40870000
408800             SET PS-ERROR                    TO TRUE              40880000
408900             PERFORM DP013-0000-PROCESS-ABEND                     40890000
409000     END-EVALUATE.                                                40900000
409100                                                                  40910000
409200*----------------------------------------------------------------*40920000
409300*    CALL THE UNITS AND CARTON COUNT MODULE (RCKUT128)            40930000
409400*----------------------------------------------------------------*40940000
409500 7100-CALL-RCKUT128.                                              40950000
409600     MOVE ASC-CURR-OPER-UNT-ID TO RC074-OPER-UNT-ID.              40960000
409700     MOVE 1                    TO RC074-FCLTY-ID.                 40970000
409800     MOVE ASC-PO-NBR           TO RC074-PO-NBR.                   40980000
409900     MOVE ASC-RCVR-NBR         TO RC074-RCVR-SEQ-NBR.             40990000
410000     MOVE ASC-AUTO-VE-SW       TO RC074-AUTO-VE-SW.               41000000
410100     SET RC074-UNIT-QTY-YES    TO TRUE.                           41010000
410200                                                                  41020000
410300     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 41030000
410400                                         RC074-COMMAREA           41040000
410500                                         RC074-FIELDS.            41050000
410600                                                                  41060000
410700     EVALUATE TRUE                                                41070000
410800         WHEN RC074-SUCCESSFUL                                    41080000
410900             CONTINUE                                             41090000
411000         WHEN OTHER                                               41100000
411100             MOVE '7100-CALL-RCKUT128'   TO DP013-PARAGRAPH       41110000
411200             STRING                                               41120000
411300                  'UNSUCCESSFUL CALL TO RCKUT128 '                41130000
411400                  'SUCCESS-IND = '                                41140000
411500                  RC074-SUCCESS-IND                               41150000
411600                               DELIMITED BY SIZE                  41160000
411700                               INTO DP013-MESSAGE-TEXT (1)        41170000
411800             MOVE RC074-CRA-RET-MSG   TO DP013-MESSAGE-TEXT (2)   41180000
411900             MOVE RC074-SQLCA         TO DP013-SQLCA              41190000
412000             SET DP013-DB2-ABEND                                  41200000
412100                 DP013-XCTL-DISPLAY-RESTART   TO TRUE             41210000
412200             PERFORM DP013-0000-PROCESS-ABEND                     41220000
412300     END-EVALUATE.                                                41230000
412400                                                                  41240000
412401                                                                  41240100
412402* JAK 09/2009 WR37075 START                                       41240200
412410*----------------------------------------------------------------*41241000
412420*    FILL IN TOP PART OF SCREEN FOR CS PULL TRANSACTION           41242000
412430*----------------------------------------------------------------*41243000
412440 8000-PREPARE-CS-CURSOR.                                          41244000
412441                                                                  41244100
412442     MOVE ASC-PO-NBR               TO DK-CNSTK-REQ-PL-NBR.        41244200
412443     MOVE ASC-PO-NBR               TO DK-PO-NBR.                  41244300
412444     MOVE ZEROES                   TO DK-REC-SEQ-NBR.             41244400
412450     MOVE ASC-PO-NBR               TO ASC-PULL-NBR-N.             41245000
412451     MOVE ASC-PULL-NBR-X           TO ASC-PULL.                   41245100
412452     MOVE '-CS'                    TO ASC-TRAN.                   41245200
412453     MOVE 'CENTRAL STOCK PULL'     TO ASC-VENDOR-NAME.            41245300
412463*    IF ASC-STR-NBR NOT = SPACES AND ZEROES                       41246322
412464*        MOVE ASC-STR-NBR          TO DK-STR-BEGIN                41246422
412465*                                     DK-STR-END                  41246522
412466*        MOVE ASC-STR-NBR          TO DK-OPER-UNT-ID              41246622
412467*        PERFORM 4120-GET-OPER-NAME                               41246722
412468*        MOVE XL071-LOC-NM         TO ASC-STORE-NAME              41246822
412469*    ELSE                                                         41246922
412470         MOVE DK-DEFAULT-BEGIN     TO DK-STR-BEGIN                41247000
412471         MOVE DK-DEFAULT-END-STR   TO DK-STR-END                  41247100
412472*    END-IF.                                                      41247222
412473     IF ASC-LINE-NUMBER > ZERO                                    41247300
412474         MOVE ASC-LINE-NUMBER      TO DK-LINE-BEGIN               41247400
412475                                      DK-LINE-END                 41247500
412476     ELSE                                                         41247600
412477         MOVE DK-DEFAULT-BEGIN     TO DK-LINE-BEGIN               41247700
412478         MOVE DK-DEFAULT-END-LINE  TO DK-LINE-END                 41247800
412479     END-IF.                                                      41247900
412480     MOVE ZEROES                   TO DK-REC-SEQ-NBR.             41248000
412481     PERFORM 8160-GET-TCEPLRQ-INFO.                               41248100
412482     EVALUATE TRUE                                                41248200
412483         WHEN CEPLRQ-SRC-TYP-CDE = 'MA'                           41248300
412484             MOVE 'ADAM'           TO ASC-PACKAGE                 41248400
412485         WHEN CEPLRQ-SRC-TYP-CDE = 'MR'                           41248500
412486             MOVE 'INFORM'         TO ASC-PACKAGE                 41248600
412487         WHEN CEPLRQ-SRC-TYP-CDE = 'UC'                           41248700
412488             MOVE 'MANUAL'         TO ASC-PACKAGE                 41248800
412489* 04/26/2010 CT START ADDED 'XF'                                  41248900
412490         WHEN CEPLRQ-SRC-TYP-CDE = 'XF'                           41249000
412491             MOVE 'WMXFR'          TO ASC-PACKAGE                 41249100
412492* 04/26/2010 CT END                                               41249200
412493         WHEN OTHER                                               41249300
412494             MOVE 'UNKNWN'         TO ASC-PACKAGE                 41249400
412495     END-EVALUATE.                                                41249500
412500     MOVE CEPLRQ-STAT-CDE          TO ASC-STATUS-CDE.             41250000
412502     PERFORM 8150-GET-TCEPLST-INFO.                               41250200
412503     MOVE ZEROES                   TO ASC-ACTL-CART-CNT.          41250300
412504     MOVE ZEROES                   TO ASC-EXPTED-CART-CNT.        41250400
412508     MOVE CEPLRQ-CNSTK-LOC-ID      TO ASC-CURR-OPER-UNT-ID.       41250800
412512* TKMAV49 - BEG                                                   41251200
412514     IF ASC-TRAN = '-CS'                                          41251400
412515        MOVE 'CSTK OPER ID:'       TO ASC-CNSTK                   41251500
412516        MOVE  PV-OPER-UNT-ID       TO ASC-CURR-OPER-UNT-ID        41251600
412517        MOVE  CEPLRQ-CNSTK-LOC-ID  TO ASC-CS-OPER-UNT-ID          41251700
412519        MOVE  ASC-CURR-OPER-UNT-ID TO DK-OPER-UNT-ID              41251900
412520     END-IF.                                                      41252000
412521* TKMAV49 - END                                                   41252100
412522     PERFORM 4120-GET-OPER-NAME.                                  41252200
412523     MOVE XL071-LOC-NM             TO ASC-OPER-UNT-NAME.          41252300
412524                                                                  41252400
412525     MOVE ZEROES TO ASC-OUTBND-CRTNS.                             41252500
412526     PERFORM 4210-OPEN-CURSOR.                                    41252600
412527     PERFORM 4220-FETCH-CURSOR UNTIL SQLCODE NOT = ZERO.          41252700
412528     PERFORM 4230-CLOSE-CURSOR.                                   41252800
412529                                                                  41252900
412530*----------------------------------------------------------------*41253000
412531* OPEN THE CS CURSOR                                              41253100
412532*----------------------------------------------------------------*41253200
412533 8110-OPEN-CS-CURSOR.                                             41253300
412534                                                                  41253400
412535     PERFORM                                                      41253500
412536         WITH TEST AFTER                                          41253600
412537         VARYING PV-RETRY-COUNTER                                 41253700
412538         FROM 1 BY 1                                              41253800
412539         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41253900
412540                   OR (SQLCODE = ZERO))                           41254000
412541                                                                  41254100
412542         EXEC SQL                                                 41254200
412543              OPEN CS-PULL-CSR                                    41254300
412544         END-EXEC                                                 41254400
412545                                                                  41254500
412546         EVALUATE TRUE                                            41254600
412547             WHEN SQLCODE = ZERO                                  41254700
412548             WHEN SQLCODE = -904                                  41254800
412549             WHEN SQLCODE = -913                                  41254900
412550                 CONTINUE                                         41255000
412551             WHEN SQLWARN0 NOT = SPACES                           41255100
412552             WHEN SQLCODE < ZERO                                  41255200
412553             WHEN SQLCODE > ZERO                                  41255300
412554                 MOVE '8110-OPEN-CS-CURSOR' TO DP013-PARAGRAPH    41255400
412555                 MOVE 'OPEN CS CURSOR PROBLEM    - '              41255500
412556                                   TO DP013-MESSAGE-TEXT (1)      41255600
412557                 MOVE SQLCA        TO DP013-SQLCA                 41255700
412558                 MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)    41255800
412559                 MOVE 'TCEPLDS '   TO DP013-DB2-TABLE-NAME (2)    41255900
412560                 SET DP013-DB2-ABEND                              41256000
412561                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41256100
412562                 PERFORM DP013-0000-PROCESS-ABEND                 41256200
412563         END-EVALUATE                                             41256300
412564     END-PERFORM.                                                 41256400
412565*                                                                 41256500
412566     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41256600
412567         MOVE '8110-OPEN-CS-CURSOR'   TO DP013-PARAGRAPH          41256700
412568         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CS CSR'    41256800
412569                                   TO DP013-MESSAGE-TEXT (1)      41256900
412570         MOVE SQLCA                TO DP013-SQLCA                 41257000
412571         MOVE 'TCEPLIT '           TO DP013-DB2-TABLE-NAME (1)    41257100
412572         MOVE 'TCEPLDS '           TO DP013-DB2-TABLE-NAME (1)    41257200
412573         SET DP013-DB2-ABEND                                      41257300
412574             DP013-XCTL-DISPLAY-RESTART TO TRUE                   41257400
412575         PERFORM DP013-0000-PROCESS-ABEND                         41257500
412576     END-IF.                                                      41257600
412577                                                                  41257700
412578*----------------------------------------------------------------*41257800
412579*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *41257900
412580*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *41258000
412581*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *41258100
412582*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *41258200
412583*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *41258300
412584*                                                                *41258400
412585*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *41258500
412586*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *41258600
412587*    UPON INITIALIZATION.                                        *41258700
412588*----------------------------------------------------------------*41258800
412589 8120-READ-CS-ITEMS-FROM-DB.                                      41258900
412590                                                                  41259000
412591     PERFORM                                                      41259100
412592         VARYING PV-READ-COUNT                                    41259200
412593         FROM 1 BY 1                                              41259300
412594         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    41259400
412595            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         41259500
412596                                                                  41259600
412597         PERFORM 8140-FETCH-CS-CURSOR                             41259700
412598                                                                  41259800
412599         IF  ASC-ITEMS-LEFT-ON-DB                                 41259900
412600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                41260000
412601                 ADD +1            TO ASC-ITEM-SUB                41260100
412602             ELSE                                                 41260200
412603                 ADD +1            TO ASC-BLK-SUB                 41260300
412604                 MOVE +1           TO ASC-ITEM-SUB                41260400
412605                                                                  41260500
412606                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         41260600
412607                     MOVE +1       TO ASC-BLK-SUB                 41260700
412608                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           41260800
412609                     PERFORM 5100-WRITE-TEMP-STORAGE              41260900
412610                     MOVE ASC-BLOCK-ENTRIES                       41261000
412611                                   (PC-MAX-BLOCKS-IN-ARRAY)       41261100
412612                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 41261200
412613                     ADD +1        TO ASC-BLK-SUB                 41261300
412614                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   41261400
412615                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      41261500
412616                                                          TO TRUE 41261600
412617                 END-IF                                           41261700
412618             END-IF                                               41261800
412619             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    41261900
412620             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          41262000
412621             MOVE ASC-NUMBER-OF-ITEMS-READ                        41262100
412622                                   TO ASC-LIST-ITEM-NUMBER        41262200
412623                                      (ASC-BLK-SUB ASC-ITEM-SUB)  41262300
412624             MOVE SPACES TO ASC-ACTION                            41262400
412625                                      (ASC-BLK-SUB ASC-ITEM-SUB)  41262500
412626             MOVE CEPLIT-PL-LNE-NBR TO                            41262600
412627                           ASC-LINE-NBR(ASC-BLK-SUB ASC-ITEM-SUB) 41262700
412628             MOVE CEPLIT-STAT-CDE   TO                            41262800
412629                          ASC-LINE-STAT(ASC-BLK-SUB ASC-ITEM-SUB) 41262900
412636             MOVE PV-ACTL-DISTRB-QTY                              41263600
412637                        TO ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB)41263700
412650             MOVE PV-REQ-ORD-QTY    TO                            41265000
412651                          ASC-UNIT-MFST(ASC-BLK-SUB ASC-ITEM-SUB) 41265100
412652             COMPUTE  ASC-UNIT-VARI(ASC-BLK-SUB ASC-ITEM-SUB)     41265200
412653                 =  ASC-UNIT-MFST(ASC-BLK-SUB ASC-ITEM-SUB) -     41265300
412654                          ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB) 41265400
412655             MOVE ZEROES TO PV-LINE-COUNT ASC-LINE-COUNT          41265500
412656             MOVE CEPLIT-PL-LNE-NBR TO                            41265600
412658                           DK-LINE-BEGIN                          41265800
412659                           DK-LINE-END                            41265900
412660             PERFORM 4360-GET-TOT-CARTONS                         41266000
412661             MOVE ASC-LINE-COUNT TO                               41266100
412662                          ASC-TOT-LINE (ASC-BLK-SUB ASC-ITEM-SUB) 41266200
412663             MOVE ZEROES TO PV-LINE-DIVRT ASC-LINE-DIVRT          41266300
412664             PERFORM 4370-GET-TOT-DIVERT                          41266400
412665             MOVE ASC-LINE-DIVRT TO                               41266500
412666                        ASC-TOT-DIVERT (ASC-BLK-SUB ASC-ITEM-SUB) 41266600
412670             MOVE ZEROES TO PV-LINE-SCAND ASC-LINE-SCAND          41267000
412671             PERFORM 4380-GET-TOT-SCANND                          41267100
412672             MOVE ASC-LINE-SCAND TO                               41267200
412673                          ASC-TOT-LOADD(ASC-BLK-SUB ASC-ITEM-SUB) 41267300
412674             COMPUTE   ASC-TOT-SHIPD(ASC-BLK-SUB ASC-ITEM-SUB)    41267400
412675                   =  ASC-TOT-DIVERT(ASC-BLK-SUB ASC-ITEM-SUB) +  41267500
412676                        ASC-TOT-LOADD(ASC-BLK-SUB ASC-ITEM-SUB)   41267600
412677             MOVE SPACES         TO                               41267700
412678                          ASC-PROC-CODE(ASC-BLK-SUB ASC-ITEM-SUB) 41267800
412679         END-IF                                                   41267900
412680     END-PERFORM.                                                 41268000
412681                                                                  41268100
412682     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          41268200
412683         MOVE +1               TO ASC-BLK-SUB                     41268300
412684         PERFORM 5100-WRITE-TEMP-STORAGE                          41268400
412685         ADD +1                TO ASC-BLK-SUB                     41268500
412686         PERFORM 5100-WRITE-TEMP-STORAGE                          41268600
412687                                                                  41268700
412688         MOVE 1                TO ASC-BLK-SUB                     41268800
412689                                  PV-BLOCK-NUMBER                 41268900
412690         PERFORM 4410-READ-TEMP-STORAGE                           41269000
412691         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             41269100
412692             MOVE 2            TO ASC-BLK-SUB                     41269200
412693                                  PV-BLOCK-NUMBER                 41269300
412694             PERFORM 4410-READ-TEMP-STORAGE                       41269400
412695         END-IF                                                   41269500
412696     END-IF.                                                      41269600
412697                                                                  41269700
412698                                                                  41269800
412699*----------------------------------------------------------------*41269900
412700* CLOSE THE CS CURSOR.                                            41270000
412701*----------------------------------------------------------------*41270100
412702 8130-CLOSE-CS-CURSOR.                                            41270200
412703                                                                  41270300
412704     EXEC SQL                                                     41270400
412705          CLOSE CS-PULL-CSR                                       41270500
412706     END-EXEC.                                                    41270600
412707                                                                  41270700
412708     EVALUATE TRUE                                                41270800
412709         WHEN SQLCODE = ZERO                                      41270900
412710         WHEN SQLCODE = +100                                      41271000
412711             CONTINUE                                             41271100
412712         WHEN SQLWARN0 NOT = SPACES                               41271200
412713         WHEN SQLCODE < ZERO                                      41271300
412714         WHEN SQLCODE > ZERO                                      41271400
412715             MOVE '8130-CLOSE-CS-CURSOR' TO DP013-PARAGRAPH       41271500
412716             MOVE 'CLOSE CS CURSOR PROBLEM   '                    41271600
412717                               TO DP013-MESSAGE-TEXT (1)          41271700
412718             MOVE SQLCA        TO DP013-SQLCA                     41271800
412719             MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)        41271900
412720             MOVE 'TCEPLDS '   TO DP013-DB2-TABLE-NAME (2)        41272000
412721             SET DP013-DB2-ABEND                                  41272100
412722                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41272200
412723             PERFORM DP013-0000-PROCESS-ABEND                     41272300
412724     END-EVALUATE.                                                41272400
412725                                                                  41272500
412726                                                                  41272600
412727*----------------------------------------------------------------*41272700
412728*    FETCH THE CS CURSOR                                          41272800
412729*----------------------------------------------------------------*41272900
412730 8140-FETCH-CS-CURSOR.                                            41273000
412731                                                                  41273100
412732      EXEC SQL                                                    41273200
412733          FETCH CS-PULL-CSR                                       41273300
412734          INTO  :CEPLIT-PL-LNE-NBR                                41273400
412735               ,:CEPLIT-STAT-CDE                                  41273500
412736               ,:PV-ACTL-DISTRB-QTY  :PV-NULL-IND-1               41273600
412737               ,:PV-REQ-ORD-QTY      :PV-NULL-IND-2               41273700
412739      END-EXEC.                                                   41273900
412740                                                                  41274000
412741     EVALUATE TRUE                                                41274100
412742         WHEN SQLCODE = ZERO                                      41274200
412743         WHEN SQLCODE = +100                                      41274300
412744              CONTINUE                                            41274400
412745         WHEN SQLWARN0 NOT = SPACE                                41274500
412746         WHEN SQLCODE NOT = ZERO                                  41274600
412747              MOVE '8140-FETCH-CS-CURSOR' TO DP013-PARAGRAPH      41274700
412748              MOVE 'FETCH CS CURSOR PROBLEM '                     41274800
412749                               TO DP013-MESSAGE-TEXT (1)          41274900
412750              MOVE SQLCA       TO DP013-SQLCA                     41275000
412751              MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)       41275100
412752              MOVE 'TCEPLDS '   TO DP013-DB2-TABLE-NAME (1)       41275200
412753              SET DP013-DB2-ABEND TO TRUE                         41275300
412754              PERFORM DP013-0000-PROCESS-ABEND                    41275400
412755     END-EVALUATE.                                                41275500
412756                                                                  41275600
412757     IF  SQLCODE EQUAL +100                                       41275700
412758         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      41275800
412759     END-IF.                                                      41275900
412760                                                                  41276000
412761*----------------------------------------------------------------*41276100
412770* RETRIEVE INFO FROM TCEPLST FOR PULL                             41277000
412780*----------------------------------------------------------------*41278000
412790 8150-GET-TCEPLST-INFO.                                           41279000
412800                                                                  41280000
412812     EXEC SQL                                                     41281200
412813          SELECT A.CRE_TMST                                       41281300
412814                ,A.CRE_BY_USR_ID                                  41281400
412821          INTO  :CEPLST-CRE-TMST                                  41282100
412822               ,:CEPLST-CRE-BY-USR-ID                             41282200
412829           FROM  TCEPLST A                                        41282900
412830          WHERE  A.CNSTK_REQ_PL_NBR  = :DK-CNSTK-REQ-PL-NBR       41283000
412831            AND  A.PL_LNE_NBR        =  0                         41283100
412832            AND  A.CRE_TMST =                                     41283200
412833                   (SELECT MAX (B.CRE_TMST)                       41283300
412834                      FROM TCEPLST B                              41283400
412835                      WHERE B.CNSTK_REQ_PL_NBR =                  41283500
412836                                        A.CNSTK_REQ_PL_NBR        41283600
412837                        AND B.PL_LNE_NBR = A.PL_LNE_NBR)          41283700
412838     END-EXEC.                                                    41283800
412839     EVALUATE TRUE                                                41283900
412840         WHEN SQLCODE = ZERO                                      41284000
412846             MOVE CEPLST-CRE-TMST         TO DK-TMST              41284600
412847                                             ASC-TMST             41284700
412848             MOVE CEPLST-CRE-BY-USR-ID    TO ASC-VRFD-USR-ID      41284800
412850         WHEN SQLCODE = +100                                      41285000
412851             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                41285100
412852             SET DP020-MSG-FATAL   TO  TRUE                       41285200
412853             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           41285300
412854         WHEN SQLWARN0 NOT = SPACE                                41285400
412855         WHEN SQLCODE NOT = ZERO                                  41285500
412856              MOVE '8150-GET-TCEPLST-INFO ' TO DP013-PARAGRAPH    41285600
412857              MOVE 'GET TCEPLST INFO '                            41285700
412858                                TO DP013-MESSAGE-TEXT (1)         41285800
412859              MOVE SQLCA        TO DP013-SQLCA                    41285900
412860              MOVE 'TCEPLST '   TO DP013-DB2-TABLE-NAME (1)       41286000
412861              SET DP013-DB2-ABEND TO TRUE                         41286100
412862              PERFORM DP013-0000-PROCESS-ABEND                    41286200
412863     END-EVALUATE.                                                41286300
412864                                                                  41286400
412865*----------------------------------------------------------------*41286500
412866* RETRIEVE INFO FROM TCEPLRQ FOR PULL                             41286600
412867*----------------------------------------------------------------*41286700
412868 8160-GET-TCEPLRQ-INFO.                                           41286800
412872                                                                  41287200
412873     EXEC SQL                                                     41287300
412874          SELECT SRC_TYP_CDE                                      41287400
412875                ,STAT_CDE                                         41287500
412876                ,CNSTK_LOC_ID                                     41287600
412877          INTO  :CEPLRQ-SRC-TYP-CDE                               41287700
412878               ,:CEPLRQ-STAT-CDE                                  41287800
412879               ,:CEPLRQ-CNSTK-LOC-ID                              41287900
412880           FROM  TCEPLRQ A                                        41288000
412881          WHERE  CNSTK_REQ_PL_NBR  = :DK-CNSTK-REQ-PL-NBR         41288100
412889     END-EXEC.                                                    41288900
412890                                                                  41289000
412891     EVALUATE TRUE                                                41289100
412892         WHEN SQLCODE = ZERO                                      41289200
412893             CONTINUE                                             41289300
412896         WHEN SQLCODE = +100                                      41289600
412897             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                41289700
412898             SET DP020-MSG-FATAL   TO  TRUE                       41289800
412899             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           41289900
412900         WHEN SQLWARN0 NOT = SPACE                                41290000
412901         WHEN SQLCODE NOT = ZERO                                  41290100
412902              MOVE '8160-GET-TCEPLRQ-INFO ' TO DP013-PARAGRAPH    41290200
412903              MOVE 'GET TCEPLST INFO '                            41290300
412904                                TO DP013-MESSAGE-TEXT (1)         41290400
412905              MOVE SQLCA        TO DP013-SQLCA                    41290500
412906              MOVE 'TCEPLRQ '   TO DP013-DB2-TABLE-NAME (1)       41290600
412907              SET DP013-DB2-ABEND TO TRUE                         41290700
412908              PERFORM DP013-0000-PROCESS-ABEND                    41290800
412909     END-EVALUATE.                                                41290900
412910                                                                  41291000
413004* JAK 09/2009 WR37075 END                                         41300400
413005                                                                  41300504
413006                                                                  41300604
413007* DMH - 11-16-11 - BEGIN                                          41300704
413008*----------------------------------------------------------------*41300804
413009*    FILL IN TOP PART OF SCREEN FOR FAST TRANSFER                 41300904
413010*----------------------------------------------------------------*41301004
413011 8200-PREPARE-FX-CURSOR.                                          41301104
413012                                                                  41301204
413013     MOVE ASC-PO-NBR               TO DK-CNSTK-REQ-PL-NBR.        41301304
413014     MOVE ASC-PO-NBR               TO DK-PO-NBR.                  41301404
413015     MOVE ZEROES                   TO DK-REC-SEQ-NBR.             41301504
413016     MOVE ASC-PO-NBR               TO ASC-FX-TRAN-NBR.            41301606
413017     MOVE ASC-PO-NBR               TO ASC-FX-TRAN-NBR-EDIT.       41301706
413018     MOVE ASC-STR-NBR              TO ASC-FX-STORE.               41301806
413019     MOVE ASC-STR-NBR              TO ASC-FX-STORE-EDIT.          41301906
413020     MOVE '-'                      TO ASC-FX-DASH.                41302006
413021     MOVE 'FAST TRANSFER     '     TO ASC-VENDOR-NAME.            41302106
413022     IF ASC-STR-NBR NOT = SPACES AND ZEROES                       41302206
413023         MOVE ASC-STR-NBR          TO DK-STR-BEGIN                41302306
413024                                      DK-STR-END                  41302406
413025         MOVE ASC-STR-NBR          TO DK-OPER-UNT-ID              41302506
413026         PERFORM 4120-GET-OPER-NAME                               41302606
413027         MOVE XL071-LOC-NM         TO ASC-STORE-NAME              41302706
413028     ELSE                                                         41302806
413029         MOVE DK-DEFAULT-BEGIN     TO DK-STR-BEGIN                41302906
413030         MOVE DK-DEFAULT-END-STR   TO DK-STR-END                  41303006
413031     END-IF.                                                      41303106
413032     IF ASC-LINE-NUMBER > ZERO                                    41303206
413033         MOVE ASC-LINE-NUMBER      TO DK-LINE-BEGIN               41303306
413034                                      DK-LINE-END                 41303406
413035     ELSE                                                         41303506
413036         MOVE DK-DEFAULT-BEGIN     TO DK-LINE-BEGIN               41303606
413037         MOVE DK-DEFAULT-END-LINE  TO DK-LINE-END                 41303706
413038     END-IF.                                                      41303806
413039     MOVE ZEROES                   TO DK-REC-SEQ-NBR.             41303906
413057     MOVE ZEROES                   TO ASC-ACTL-CART-CNT.          41305706
413058     MOVE ZEROES                   TO ASC-EXPTED-CART-CNT.        41305806
413059     MOVE ASC-OPER-UNT-NAME        TO DK-OPER-UNT-ID.             41305913
413068     PERFORM 4120-GET-OPER-NAME.                                  41306806
413069     MOVE XL071-LOC-NM             TO ASC-OPER-UNT-NAME.          41306906
413070                                                                  41307006
413071     MOVE ZEROES TO ASC-OUTBND-CRTNS.                             41307106
413072     PERFORM 4210-OPEN-CURSOR.                                    41307206
413073     PERFORM 4220-FETCH-CURSOR UNTIL SQLCODE NOT = ZERO.          41307306
413074     PERFORM 4230-CLOSE-CURSOR.                                   41307406
413078                                                                  41307806
413079*----------------------------------------------------------------*41307906
413080* OPEN THE FAST TRANSFER CURSOR                                   41308006
413081*----------------------------------------------------------------*41308106
413082 8210-OPEN-FX-CURSOR.                                             41308206
413083                                                                  41308306
413084     PERFORM                                                      41308406
413085         WITH TEST AFTER                                          41308506
413086         VARYING PV-RETRY-COUNTER                                 41308606
413087         FROM 1 BY 1                                              41308706
413088         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41308806
413089                   OR (SQLCODE = ZERO))                           41308906
413090                                                                  41309006
413091         EXEC SQL                                                 41309106
413092              OPEN FX-FAST-TRANSFER-CSR                           41309208
413093         END-EXEC                                                 41309306
413094                                                                  41309406
413095         EVALUATE TRUE                                            41309506
413096             WHEN SQLCODE = ZERO                                  41309606
413097             WHEN SQLCODE = -904                                  41309706
413098             WHEN SQLCODE = -913                                  41309806
413099                 CONTINUE                                         41309906
413100             WHEN SQLWARN0 NOT = SPACES                           41310006
413101             WHEN SQLCODE < ZERO                                  41310106
413102             WHEN SQLCODE > ZERO                                  41310206
413103                 MOVE '8110-OPEN-CS-CURSOR' TO DP013-PARAGRAPH    41310306
413104                 MOVE 'OPEN CS CURSOR PROBLEM    - '              41310406
413105                                   TO DP013-MESSAGE-TEXT (1)      41310506
413106                 MOVE SQLCA        TO DP013-SQLCA                 41310606
413107                 MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)    41310708
413108                 MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (2)    41310808
413109                 SET DP013-DB2-ABEND                              41310906
413110                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41311006
413111                 PERFORM DP013-0000-PROCESS-ABEND                 41311106
413112         END-EVALUATE                                             41311206
413113     END-PERFORM.                                                 41311306
413114*                                                                 41311406
413115     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41311506
413116         MOVE '8210-OPEN-FX-CURSOR'   TO DP013-PARAGRAPH          41311608
413117         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN FX CSR'    41311708
413118                                   TO DP013-MESSAGE-TEXT (1)      41311806
413119         MOVE SQLCA                TO DP013-SQLCA                 41311906
413120         MOVE 'SUT00024'           TO DP013-DB2-TABLE-NAME (1)    41312008
413121         MOVE 'SUT00028'           TO DP013-DB2-TABLE-NAME (1)    41312108
413122         SET DP013-DB2-ABEND                                      41312206
413123             DP013-XCTL-DISPLAY-RESTART TO TRUE                   41312306
413124         PERFORM DP013-0000-PROCESS-ABEND                         41312406
413125     END-IF.                                                      41312506
413126                                                                  41312606
413127*----------------------------------------------------------------*41312706
413128*                                                                *41312806
413132*----------------------------------------------------------------*41313204
413133 8220-READ-FX-ITEMS-FROM-DB.                                      41313304
413134                                                                  41313404
413135     PERFORM                                                      41313504
413136         VARYING PV-READ-COUNT                                    41313604
413137         FROM 1 BY 1                                              41313704
413138         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    41313804
413139            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         41313904
413140                                                                  41314004
413141         PERFORM 8240-FETCH-FX-CURSOR                             41314104
413142                                                                  41314204
413143         IF  ASC-ITEMS-LEFT-ON-DB                                 41314304
413144             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                41314404
413145                 ADD +1            TO ASC-ITEM-SUB                41314504
413146             ELSE                                                 41314604
413147                 ADD +1            TO ASC-BLK-SUB                 41314704
413148                 MOVE +1           TO ASC-ITEM-SUB                41314804
413149                                                                  41314904
413150                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         41315004
413151                     MOVE +1       TO ASC-BLK-SUB                 41315104
413152                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           41315204
413153                     PERFORM 5100-WRITE-TEMP-STORAGE              41315304
413154                     MOVE ASC-BLOCK-ENTRIES                       41315404
413155                                   (PC-MAX-BLOCKS-IN-ARRAY)       41315504
413156                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 41315604
413157                     ADD +1        TO ASC-BLK-SUB                 41315704
413158                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   41315804
413159                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      41315904
413160                                                          TO TRUE 41316004
413161                 END-IF                                           41316104
413162             END-IF                                               41316204
413163             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    41316304
413164             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          41316404
413165             MOVE ASC-NUMBER-OF-ITEMS-READ                        41316504
413166                                   TO ASC-LIST-ITEM-NUMBER        41316604
413167                                      (ASC-BLK-SUB ASC-ITEM-SUB)  41316704
413168             MOVE SPACES TO ASC-ACTION                            41316804
413169                                      (ASC-BLK-SUB ASC-ITEM-SUB)  41316904
413170             MOVE SUT00028-TRN-LNE-NBR                            41317008
413171                        TO ASC-LINE-NBR(ASC-BLK-SUB ASC-ITEM-SUB) 41317109
413172             MOVE SPACES TO                                       41317208
413173                          ASC-LINE-STAT(ASC-BLK-SUB ASC-ITEM-SUB) 41317304
413174             MOVE ZEROES                                          41317412
413175                        TO ASC-UNIT-VRFD(ASC-BLK-SUB ASC-ITEM-SUB)41317504
413176             MOVE SUT00028-SHPD-UNT-QTY                           41317610
413178                       TO ASC-UNIT-MFST(ASC-BLK-SUB ASC-ITEM-SUB) 41317812
413179             MOVE ZEROES                                          41317908
413180                        TO ASC-UNIT-VARI(ASC-BLK-SUB ASC-ITEM-SUB)41318008
413181             MOVE ZEROES TO PV-LINE-COUNT ASC-LINE-COUNT          41318104
413182             MOVE SUT00028-TRN-LNE-NBR TO                         41318208
413183                           DK-LINE-BEGIN                          41318304
413184                           DK-LINE-END                            41318404
413185             MOVE  ASC-FAST-TRAN      TO  ASC-FAST-TRAN-X         41318514
413186             MOVE  ASC-FAST-TRAN-N    TO  DK-FAST-TRAN-NBR        41318614
413187             MOVE  DK-FAST-TRAN-NBR   TO  DK-PO-NBR               41318711
413188             PERFORM 4360-GET-TOT-CARTONS                         41318804
413189             MOVE ASC-LINE-COUNT TO                               41318904
413190                          ASC-TOT-LINE (ASC-BLK-SUB ASC-ITEM-SUB) 41319004
413191             MOVE ZEROES TO PV-LINE-DIVRT ASC-LINE-DIVRT          41319104
413192             PERFORM 4370-GET-TOT-DIVERT                          41319204
413193             MOVE ASC-LINE-DIVRT TO                               41319304
413194                        ASC-TOT-DIVERT (ASC-BLK-SUB ASC-ITEM-SUB) 41319404
413195             MOVE ZEROES TO PV-LINE-SCAND ASC-LINE-SCAND          41319504
413196             PERFORM 4380-GET-TOT-SCANND                          41319604
413197             MOVE ASC-LINE-SCAND TO                               41319704
413198                          ASC-TOT-LOADD(ASC-BLK-SUB ASC-ITEM-SUB) 41319804
413199             COMPUTE   ASC-TOT-SHIPD(ASC-BLK-SUB ASC-ITEM-SUB)    41319904
413200                   =  ASC-TOT-DIVERT(ASC-BLK-SUB ASC-ITEM-SUB) +  41320004
413201                        ASC-TOT-LOADD(ASC-BLK-SUB ASC-ITEM-SUB)   41320104
413202             MOVE SPACES         TO                               41320204
413203                          ASC-PROC-CODE(ASC-BLK-SUB ASC-ITEM-SUB) 41320304
413204         END-IF                                                   41320404
413205     END-PERFORM.                                                 41320504
413206                                                                  41320604
413207     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          41320704
413208         MOVE +1               TO ASC-BLK-SUB                     41320804
413209         PERFORM 5100-WRITE-TEMP-STORAGE                          41320904
413210         ADD +1                TO ASC-BLK-SUB                     41321004
413211         PERFORM 5100-WRITE-TEMP-STORAGE                          41321104
413212                                                                  41321204
413213         MOVE 1                TO ASC-BLK-SUB                     41321304
413214                                  PV-BLOCK-NUMBER                 41321404
413215         PERFORM 4410-READ-TEMP-STORAGE                           41321504
413216         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             41321604
413217             MOVE 2            TO ASC-BLK-SUB                     41321704
413218                                  PV-BLOCK-NUMBER                 41321804
413219             PERFORM 4410-READ-TEMP-STORAGE                       41321904
413220         END-IF                                                   41322004
413221     END-IF.                                                      41322104
413222                                                                  41322204
413223                                                                  41322304
413224*----------------------------------------------------------------*41322404
413225* CLOSE THE FAST TRANSFER CURSOR                                  41322504
413226*----------------------------------------------------------------*41322604
413227 8230-CLOSE-FX-CURSOR.                                            41322704
413228                                                                  41322804
413229     EXEC SQL                                                     41322904
413230          CLOSE FX-FAST-TRANSFER-CSR                              41323008
413231     END-EXEC.                                                    41323104
413232                                                                  41323204
413233     EVALUATE TRUE                                                41323304
413234         WHEN SQLCODE = ZERO                                      41323404
413235         WHEN SQLCODE = +100                                      41323504
413236             CONTINUE                                             41323604
413237         WHEN SQLWARN0 NOT = SPACES                               41323704
413238         WHEN SQLCODE < ZERO                                      41323804
413239         WHEN SQLCODE > ZERO                                      41323904
413240             MOVE '8230-CLOSE-FX-CURSOR' TO DP013-PARAGRAPH       41324008
413241             MOVE 'CLOSE FX CURSOR PROBLEM   '                    41324108
413242                               TO DP013-MESSAGE-TEXT (1)          41324204
413243             MOVE SQLCA        TO DP013-SQLCA                     41324304
413244             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)        41324408
413245             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (2)        41324508
413246             SET DP013-DB2-ABEND                                  41324604
413247                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41324704
413248             PERFORM DP013-0000-PROCESS-ABEND                     41324804
413249     END-EVALUATE.                                                41324904
413250                                                                  41325004
413251                                                                  41325104
413252*----------------------------------------------------------------*41325204
413253*    FETCH THE FAST TRANSFER CURSOR                               41325304
413254*----------------------------------------------------------------*41325404
413255 8240-FETCH-FX-CURSOR.                                            41325504
413256                                                                  41325604
413257      EXEC SQL                                                    41325704
413258          FETCH FX-FAST-TRANSFER-CSR                              41325808
413259          INTO  :SUT00028-TRN-LNE-NBR                             41325908
413260               ,:SUT00028-SHPD-UNT-QTY :PV-NULL-IND-1             41326008
413261      END-EXEC.                                                   41326104
413262                                                                  41326204
413263     EVALUATE TRUE                                                41326304
413264         WHEN SQLCODE = ZERO                                      41326404
413265         WHEN SQLCODE = +100                                      41326504
413266              CONTINUE                                            41326604
413267         WHEN SQLWARN0 NOT = SPACE                                41326704
413268         WHEN SQLCODE NOT = ZERO                                  41326804
413269              MOVE '8240-FETCH-FX-CURSOR' TO DP013-PARAGRAPH      41326908
413270              MOVE 'FETCH FX CURSOR PROBLEM '                     41327008
413271                               TO DP013-MESSAGE-TEXT (1)          41327104
413272              MOVE SQLCA       TO DP013-SQLCA                     41327204
413273              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)       41327308
413274              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)       41327408
413275              SET DP013-DB2-ABEND TO TRUE                         41327504
413276              PERFORM DP013-0000-PROCESS-ABEND                    41327604
413277     END-EVALUATE.                                                41327704
413278                                                                  41327804
413279     IF  SQLCODE EQUAL +100                                       41327904
413280         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      41328004
413281     END-IF.                                                      41328104
413282                                                                  41328204
413283* DMH 11/16/11 - END                                              41328304
413284                                                                  41328404
413285                                                                  41328504
413286*-----------------------------------------------------------------41328604
413287*  READ THE LIST QUEUE RECORD                                     41328704
413288*-----------------------------------------------------------------41328804
413289 9100-READ-SEL-QUEUE.                                             41328904
413290                                                                  41329004
413291     EXEC CICS                                                    41329104
413292         READQ TS                                                 41329204
413293             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        41329304
413300             INTO  (SU010-SELECT-RECORD)                          41330000
413400             ITEM  (ASC-SEL-ITEM)                                 41340000
413500             RESP  (PV-CICS-RESP)                                 41350000
413600     END-EXEC.                                                    41360000
413700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        41370000
413800         CONTINUE                                                 41380000
413900     ELSE                                                         41390000
414000         SET DP013-LOGIC-ABEND                                    41400000
414100             DP013-NO-ROLLBACK   TO   TRUE                        41410000
414200         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          41420000
414300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   41430000
414400                                 TO   DP013-MESSAGE-TEXT (1)      41440000
414500         PERFORM DP013-0000-PROCESS-ABEND                         41450000
414600     END-IF.                                                      41460000
414700                                                                  41470000
414800*-----------------------------------------------------------------41480000
414900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *41490000
415000*-----------------------------------------------------------------41500000
415100 9200-REWRITE-SEL-QUEUE.                                          41510000
415200                                                                  41520000
415300     EXEC CICS                                                    41530000
415400          WRITEQ TS                                               41540000
415500              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      41550000
415600              FROM   (SU010-SELECT-RECORD)                        41560000
415700              ITEM   (ASC-SEL-ITEM)                               41570000
415800              RESP   (PV-CICS-RESP)                               41580000
415900              REWRITE                                             41590000
416000     END-EXEC.                                                    41600000
416100                                                                  41610000
416200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   41620000
416300         SET DP013-CICS-ABEND                                     41630000
416400             DP013-NO-ROLLBACK     TO TRUE                        41640000
416500         MOVE '9200-REWRITE-SEL-QUEUE'                            41650000
416600                                   TO DP013-PARAGRAPH             41660000
416700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   41670000
416800                                   TO DP013-MESSAGE-TEXT (1)      41680000
416900         PERFORM DP013-0000-PROCESS-ABEND                         41690000
417000     END-IF.                                                      41700000
417100                                                                  41710000
417200*                                                                 41720000
417300 9900-WRITE-CICS-LOG.                                             41730000
417400                                                                  41740000
417500     MOVE LENGTH OF PV-CICS-MSG-AREA                              41750000
417600          TO PV-COMMAREA-LENGTH                                   41760000
417700                                                                  41770000
417800     EXEC CICS                                                    41780000
417900         WRITEQ TD                                                41790000
418000             QUEUE  ('CSSL')                                      41800000
418100             FROM   (PV-CICS-MSG-AREA)                            41810000
418200             LENGTH (PV-COMMAREA-LENGTH)                          41820000
418300             RESP   (PV-CICS-RESP)                                41830000
418400     END-EXEC.                                                    41840000
418500                                                                  41850000
418600     MOVE SPACES TO PV-CICS-MSG-AREA.                             41860000
418700*                                                                 41870000
418800*----------------------------------------------------------------*41880000
418900*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *41890000
419000*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *41900000
419100*----------------------------------------------------------------*41910000
419200 9900A-SOFT-ABORT.                                                41920000
419300                                                                  41930000
419400     EXEC CICS SYNCPOINT                                          41940000
419500          ROLLBACK                                                41950000
419600     END-EXEC.                                                    41960000
419700                                                                  41970000
419800     SET  PS-ERROR                                                41980000
419900          PS-SOFT-ABORT-ERROR                                     41990000
420000          DP020-MSG-FATAL       TO  TRUE.                         42000000
420100                                                                  42010000
420200******************************************************************42020000
420300 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  42030000
420400                                                                  42040000
420500     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           42050000
420600     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          42060000
420700     INITIALIZE DP013-SRC-TASK-NUMBER                             42070000
420800                DP013-STACK.                                      42080000
420900     SET DP013-LINK-RETURN            TO TRUE.                    42090000
421000                                                                  42100000
421100     EXEC CICS                                                    42110000
421200         LINK                                                     42120000
421300             PROGRAM   (DP013-NAME)                               42130000
421400             COMMAREA  (DP013-PARAMETERS)                         42140000
421500             LENGTH    (DP013-LENGTH)                             42150000
421600     END-EXEC.                                                    42160000
421700/                                                                 42170000
421800*----------------------------------------------------------------*42180000
421900*    ABEND PROCESSOR MODULE                                      *42190000
422000*----------------------------------------------------------------*42200000
422100                                                                  42210000
422200     COPY DPPD013.                                                42220000
