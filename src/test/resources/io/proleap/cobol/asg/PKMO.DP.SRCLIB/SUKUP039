000100 IDENTIFICATION DIVISION.                                                 
000200                                                                          
000210*****************************************************************         
000300* THIS PROGRAM WILL PROCESS A FLAT FILE WITH TRIPS THAT HAVE    *         
000400* NEED BE BE COMPLETED.  BASED ON THE TRIP TYPE & STATUS UPDATES*         
000500* WILL BE PERFORMED.                                            *         
000510*                                                               *         
000512* DC - DC CLOSED STATUS                                         *         
000513*    - INSERT DR - DC RELEASED                                  *         
000514*    - DELETE - SUT_MAJ_CL_SUM                                  *         
000515*    - DELETE - SUT_DEPT_SUM                                    *         
000516*    - DELETE - SUT_BRND_MDSE_SUM                               *         
000517*    - DELETE - SUT_BUS_AREA_SUM                                *         
000518*    - SUT_TRIP_DTL_SUM                                         *         
000519*    - UPDATE - SUT_TRIP_SUM VALUE 0'S                          *         
000520*                                                               *         
000521* DS - DC SHIPPED                                               *         
000522*      - INSERT SO - STORE OPEN                                 *         
000523*      - INSERT SU - STORE UNLOADED                             *         
000524*      - DELETE - SUT_MAJ_CL_SUM                                *         
000525*      - DELETE - SUT_DEPT_SUM                                  *         
000526*      - DELETE - SUT_BRND_MDSE_SUM                             *         
000527*      - DELETE - SUT_BUS_AREA_SUM                              *         
000528*      - DELETE SUT_TRIP_DTL_SUM                                *         
000529*      - UPDATE - SUT_TRIP_SUM VALUE 0'S                        *         
000530*                                                               *         
000531* OLD STORAGE TRAILER                                           *         
000532*     - DELETE SCAN ON ROWS - SUT_OTBND_LOC                     *         
000533*     - INSERT DC - DC CLOSED                                   *         
000534*     - INSERT DR - DC RELEASED                                 *         
000535*                                                               *         
000550* INPUT FILE WAS CREATED BY SUKUT208                            *         
000551*****************************************************************         
000560                                                                          
000700 PROGRAM-ID.             SUKUP039.                                        
000800 AUTHOR.                 DENISE HAHN.                                     
000900 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
001000 DATE-WRITTEN            AUGUST, 2022.                                    
001100 DATE-COMPILED.                                                           
001200                                                                          
001300 ENVIRONMENT DIVISION.                                                    
001400 CONFIGURATION SECTION.                                                   
001500 SOURCE-COMPUTER.        IBM-3090.                                        
001600 OBJECT-COMPUTER.        IBM-3090.                                        
001700 INPUT-OUTPUT SECTION.                                                    
001800 FILE-CONTROL.                                                            
001900                                                                          
002000     SELECT INPUT-EXTRACT-FILE                                            
002100         ASSIGN TO INP01.                                                 
002200                                                                          
002300 DATA DIVISION.                                                           
002400 FILE SECTION.                                                            
002500                                                                          
002600 FD  INPUT-EXTRACT-FILE                                                   
002700     RECORDING MODE IS F                                                  
002800     LABEL RECORDS ARE STANDARD                                           
002900     RECORD CONTAINS 200 CHARACTERS                                       
003000     BLOCK CONTAINS 0  RECORDS.                                           
003100 01  INPUT-EXTRACT-REC                PIC X(200).                         
003200                                                                          
003300 WORKING-STORAGE SECTION.                                                 
003400 01  PS-SWITCHES.                                                         
003500     05  PS-EOF-EXTRACT-SW            PIC X(01) VALUE 'N'.                
003600         88  PS-EOF-EXTRACT-YES                 VALUE 'Y'.                
003610     05  PS-SUMMARY-ROWS-SW           PIC X(01) VALUE 'N'.                
003620         88  PS-SUMMARY-ROWS                    VALUE 'Y'.                
003630         88  PS-NO-SUMMARY-ROWS                 VALUE 'N'.                
003640     05  PS-TRIP-STATUS-MATCH-SW      PIC X(01) VALUE 'N'.                
003650         88  PS-TRIP-STATUS-MATCH               VALUE 'Y'.                
003660         88  PS-TRIP-STATUS-MATCH-NO            VALUE 'N'.                
003700                                                                          
003710                                                                          
003720 01  DK-DB2-KEYS.                                                         
003721     05  DK-TRIP-OCRNC-ID             PIC  S9(9) COMP.                    
003730                                                                          
003740 01  PC-PROGRAM-CONSTANTS.                                                
003750     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'SUKUP039'.        
003751     05  PC-MAX-RETRIES               PIC S9(03) COMP-3                   
003752                                                 VALUE 3.                 
003760                                                                          
003800 01  PV-PROGRAM-VARIABLES.                                                
003900     05  PV-ABEND-CODE                PIC S9(04) VALUE ZERO               
004000                                                 COMP SYNC.               
004100         88  ABEND-4013-DB2-ERROR                VALUE +4013.             
004200     05  PV-DISP-NBR                  PIC ZZZ,ZZZ,ZZZ.                    
004210     05  PV-TRIP-STAT-CDE-MATCH       PIC  X(02) VALUE SPACES.            
004220     05  PV-TRIP-STAT-TMST-MATCH      PIC  X(26) VALUE SPACES.            
004230     05  PV-PREV-ASSUM-CNT            PIC S9(09)  COMP.                   
004300     05  PV-EXTRACT-COUNT             PIC S9(05) COMP-3                   
004400                                          VALUE ZERO.                     
004500     05  PV-INSERT-COUNT              PIC S9(05) COMP-3                   
004600                                          VALUE ZERO.                     
004700     05  PV-ROWS-DELETED              PIC S9(05) COMP-3                   
004800                                          VALUE ZERO.                     
004810     05  PV-ROWS-UPDATED              PIC S9(05) COMP-3                   
004820                                          VALUE ZERO.                     
004900     05  PV-RETRY-COUNTER             PIC S9(03) COMP-3                   
005000                                        VALUE 3.                          
005300     05  PV-ABEND-PARAGRAPH           PIC X(35) VALUE SPACES.             
005301                                                                          
005310     05  PV-DISP-OTBND-TRIP-ID        PIC 9(09) VALUE ZEROES.             
005320     05  PV-DISP-ORIG-OPER            PIC 9(04) VALUE ZEROES.             
005330     05  PV-DISP-DEST-OPER            PIC 9(04) VALUE ZEROES.             
005340     05  PV-DISP-TRLR-SRL             PIC 9(09) VALUE ZEROES.             
005350     05  PV-DISP-TRIP-OCRNC-ID        PIC 9(09) VALUE ZEROES.             
005360     05  PV-DISP-COUNT                PIC ZZZ,ZZZ,ZZ9.                    
005400                                                                          
005500 01  PV-DISP-KEY-MSG.                                                     
006200     05  FILLER                      PIC X(08) VALUE                      
006300         '; TRIP= '.                                                      
006400     05  PV-KEY-TRIP-ID              PIC 9(09) VALUE ZEROES.              
007400                                                                          
007500                                                                          
007600     COPY SURD174.                                                        
007700                                                                          
007710*---------------------------------------------------------------*         
007720* SUT_MAJ_CL_SUM                                                *         
007730*---------------------------------------------------------------*         
007800     EXEC SQL                                                             
007900         INCLUDE SUT00010                                                 
008000     END-EXEC.                                                            
008100                                                                          
008110*---------------------------------------------------------------*         
008120* SUT_DEPT_SUM                                                  *         
008130*---------------------------------------------------------------*         
008140     EXEC SQL                                                             
008150         INCLUDE SUT00009                                                 
008160     END-EXEC.                                                            
008170                                                                          
008180*---------------------------------------------------------------*         
008190* SUT_BRND_MDSE_SUM                                             *         
008191*---------------------------------------------------------------*         
008192     EXEC SQL                                                             
008193         INCLUDE SUT00066                                                 
008194     END-EXEC.                                                            
008195                                                                          
008196*---------------------------------------------------------------*         
008197* SUT_BUS_AREA_SUM                                              *         
008198*---------------------------------------------------------------*         
008199     EXEC SQL                                                             
008200         INCLUDE SUT00008                                                 
008201     END-EXEC.                                                            
008202                                                                          
008203*---------------------------------------------------------------*         
008204* SUT_TRIP_DTL_SUM                                              *         
008205*---------------------------------------------------------------*         
008206     EXEC SQL                                                             
008207         INCLUDE SUT00095                                                 
008208     END-EXEC.                                                            
008209                                                                          
008210*---------------------------------------------------------------*         
008211* SUT_TRIP_SUM                                                  *         
008212*---------------------------------------------------------------*         
008213     EXEC SQL                                                             
008214         INCLUDE SUT00007                                                 
008215     END-EXEC.                                                            
008216                                                                          
008217*---------------------------------------------------------------*         
008218* TSUOBTS                                                       *         
008219*---------------------------------------------------------------*         
008220     EXEC SQL                                                             
008221         INCLUDE TSUOBTS                                                  
008222     END-EXEC.                                                            
008223                                                                          
008224*---------------------------------------------------------------*         
008225* SUT_OTBND_LOC                                                 *         
008226*---------------------------------------------------------------*         
008227     EXEC SQL                                                             
008228         INCLUDE SUT00027                                                 
008229     END-EXEC.                                                            
008230                                                                          
008231*---------------------------------------------------------------*         
008232*                                                               *         
008233*---------------------------------------------------------------*         
008240     EXEC SQL                                                             
008300         INCLUDE SQLCA                                                    
008400     END-EXEC.                                                            
008500                                                                          
008600     COPY SQLCA2.                                                         
008700     COPY DPWS004.                                                        
008800 EJECT                                                                    
008900                                                                          
008910*---------------------------------------------------------------*         
008920*                                                               *         
008930*---------------------------------------------------------------*         
009000 PROCEDURE DIVISION.                                                      
009100     PERFORM 1000-INITIALIZE.                                             
009200     PERFORM 2000-PROCESS                                                 
009300             UNTIL PS-EOF-EXTRACT-YES                                     
009400     PERFORM 9000-EOJ.                                                    
009500                                                                          
009600     GOBACK.                                                              
009700                                                                          
009710*---------------------------------------------------------------*         
009720*                                                               *         
009730*---------------------------------------------------------------*         
009800 1000-INITIALIZE.                                                         
009900                                                                          
009910     DISPLAY ' '.                                                         
009920     DISPLAY ' SUKUP039 - START               '.                          
009930     DISPLAY ' '.                                                         
009940                                                                          
010000     OPEN INPUT INPUT-EXTRACT-FILE                                        
010100                                                                          
010200     PERFORM 8000-READ-EXTRACT-FILE                                       
010300     IF PS-EOF-EXTRACT-YES                                                
010400         DISPLAY ' SUKUP039 - INPUT FILE IS EMPTY '                       
010500     END-IF.                                                              
010600                                                                          
010610*---------------------------------------------------------------*         
010620*                                                               *         
010630*---------------------------------------------------------------*         
010700 2000-PROCESS.                                                            
010800                                                                          
010801     MOVE  SU174-OTBND-TRIP-ID  TO  PV-DISP-OTBND-TRIP-ID.                
010802     MOVE  SU174-ORIG-OPER      TO  PV-DISP-ORIG-OPER.                    
010803     MOVE  SU174-DEST-OPER      TO  PV-DISP-DEST-OPER.                    
010804     MOVE  SU174-TRLR-SRL-NBR   TO  PV-DISP-TRLR-SRL.                     
010805     DISPLAY ' '.                                                         
010806     DISPLAY 'TRIP: '    PV-DISP-OTBND-TRIP-ID                            
010807             ' DC: '     PV-DISP-ORIG-OPER                                
010808             ' DEST: '   PV-DISP-DEST-OPER                                
010809             ' SRL: '    PV-DISP-TRLR-SRL                                 
010810             ' TYPE: '   SU174-DOOR-TYPE                                  
010811             ' STATUS: ' SU174-TRIP-STATUS                                
010812             ' - '       SU174-STATUS-TMST.                               
010813                                                                          
010814     SET  PS-TRIP-STATUS-MATCH-NO  TO  TRUE.                              
010815     PERFORM 2005-CHECK-TRIP-STATUS.                                      
010816                                                                          
010817     SET  PS-NO-SUMMARY-ROWS TO  TRUE                                     
010818                                                                          
010819     IF  PS-TRIP-STATUS-MATCH                                             
010820         IF  SU174-DC-CLOSE                                               
010821             PERFORM 2010-GET-TRIP-OCCURANCE                              
010822             IF  PS-SUMMARY-ROWS                                          
010823                 PERFORM 3000-DELETE-SUT00010                             
010824                 PERFORM 3010-DELETE-SUT00009                             
010825                 PERFORM 3020-DELETE-SUT00066                             
010826                 PERFORM 3030-DELETE-SUT00008                             
010827                 PERFORM 3040-DELETE-SUT00095                             
010828                 PERFORM 3050-UPDATE-SUT00007                             
010829             END-IF                                                       
010830             PERFORM 3060-INSERT-DR-STATUS                                
010831         ELSE                                                             
010832         IF  SU174-DC-SHIPPED                                             
010833             PERFORM 2010-GET-TRIP-OCCURANCE                              
010834             IF  PS-SUMMARY-ROWS                                          
010835                 PERFORM 3000-DELETE-SUT00010                             
010836                 PERFORM 3010-DELETE-SUT00009                             
010837                 PERFORM 3020-DELETE-SUT00066                             
010838                 PERFORM 3030-DELETE-SUT00008                             
010839                 PERFORM 3040-DELETE-SUT00095                             
010840                 PERFORM 3050-UPDATE-SUT00007                             
010841             END-IF                                                       
010842             PERFORM 3070-INSERT-SO-STATUS                                
010843             PERFORM 3080-INSERT-SU-STATUS                                
010844         ELSE                                                             
010845         IF  SU174-STORAGE-DOOR                                           
010846             PERFORM 3090-DELETE-SHON                                     
010847             IF  SU174-DC-OPEN                                            
010848                 PERFORM 4000-INSERT-DC-STATUS                            
010849             END-IF                                                       
010850             PERFORM 3060-INSERT-DR-STATUS                                
010851         END-IF                                                           
010852         END-IF                                                           
010853         END-IF                                                           
010860     END-IF.                                                              
011300                                                                          
011400     PERFORM 8000-READ-EXTRACT-FILE.                                      
011401                                                                          
011402                                                                          
011403*---------------------------------------------------------------*         
011404* CHECK IF THE TRIP STATUS STILL MATCHES EXTRACT                *         
011405*---------------------------------------------------------------*         
011406 2005-CHECK-TRIP-STATUS.                                                  
011407                                                                          
011409     SET  PS-TRIP-STATUS-MATCH-NO  TO  TRUE.                              
011410                                                                          
011411     EXEC SQL                                                             
011412          SELECT  A.TRIP_STAT_CDE                                         
011413               ,  A.OTBND_STAT_TMST                                       
011414            INTO :PV-TRIP-STAT-CDE-MATCH                                  
011415               , :PV-TRIP-STAT-TMST-MATCH                                 
011416            FROM  TSUOBTS A                                               
011417            WHERE A.OTBND_TRIP_ID  = :SU174-OTBND-TRIP-ID                 
011418              AND A.OTBND_STAT_TMST IN                                    
011419                  (SELECT MAX(B.OTBND_STAT_TMST)                          
011420                     FROM TSUOBTS  B                                      
011421                    WHERE A.OTBND_TRIP_ID  =  B.OTBND_TRIP_ID)            
011422             WITH UR                                                      
011423     END-EXEC.                                                            
011424                                                                          
011425     EVALUATE TRUE                                                        
011426         WHEN SQLCODE = ZERO                                              
011427              IF  SU174-STATUS-TMST = PV-TRIP-STAT-TMST-MATCH AND         
011428                  SU174-TRIP-STATUS = PV-TRIP-STAT-CDE-MATCH              
011429                  SET  PS-TRIP-STATUS-MATCH  TO  TRUE                     
011430              ELSE                                                        
011431                  SET  PS-TRIP-STATUS-MATCH-NO  TO  TRUE                  
011433                  DISPLAY '     '                                         
011434                          'TRIP STATUS: ' PV-TRIP-STAT-CDE-MATCH          
011435                          '  STAT TMST: ' PV-TRIP-STAT-TMST-MATCH         
011436                  DISPLAY '     '                                         
011437                          'TRIP STATUS HAS BEEN UPDATED SINCE '           
011438                          'THE EXTRACT WAS RUN'                           
011439                  DISPLAY '     '                                         
011440                          'NO UPDATES WILL BE PERFORMED '                 
011441                          'FOR THIS TRIP'                                 
011442                  DISPLAY ' '                                             
011443              END-IF                                                      
011444                                                                          
011445         WHEN SQLCODE = +100                                              
011446              SET  PS-TRIP-STATUS-MATCH-NO  TO  TRUE                      
011447              DISPLAY '     '                                             
011448                      '+100 SELECT TSUOBTS'                               
011449              DISPLAY '     '                                             
011450                      'NO UPDATES WILL BE PERFORMED '                     
011451                      'FOR THIS TRIP'                                     
011452              DISPLAY ' '                                                 
011457                                                                          
011458         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011459             DISPLAY '**************************************'             
011460             DISPLAY 'WARNING ISSUED '                                    
011461             DISPLAY '2005-CHECK-TRIP-STATUS                '             
011462             DISPLAY '**************************************'             
011463             PERFORM 9800-SQL-WARNING                                     
011464                                                                          
011465         WHEN SQLCODE < ZERO                                              
011466             DISPLAY '**************************************'             
011467             DISPLAY 'ERROR ISSUED ON                       '             
011468             DISPLAY '2005-CHECK-TRIP-STATUS                '             
011469             DISPLAY '**************************************'             
011470             PERFORM 9900-SQL-ERROR                                       
011471     END-EVALUATE.                                                        
011472                                                                          
011473                                                                          
011474*---------------------------------------------------------------*         
011475* GET TRIP OCCURANCE ID                                         *         
011476*---------------------------------------------------------------*         
011477 2010-GET-TRIP-OCCURANCE.                                                 
011478                                                                          
011479     MOVE SU174-OTBND-TRIP-ID  TO  SUT00007-OTBND-TRIP-ID                 
011480                                                                          
011481     EXEC SQL                                                             
011482          SELECT  A.TRIP_OCRNC_ID                                         
011483            INTO :DK-TRIP-OCRNC-ID                                        
011484            FROM  SUT_TRIP_SUM A                                          
011485            WHERE A.OTBND_TRIP_ID  = :SUT00007-OTBND-TRIP-ID              
011486              AND A.CRE_TMST IN                                           
011487                  (SELECT MAX(B.CRE_TMST)                                 
011488                     FROM SUT_TRIP_SUM B                                  
011489                    WHERE A.OTBND_TRIP_ID  =  B.OTBND_TRIP_ID)            
011490             WITH UR                                                      
011491     END-EXEC.                                                            
011492                                                                          
011493     EVALUATE TRUE                                                        
011494         WHEN SQLCODE = ZERO                                              
011495              MOVE  DK-TRIP-OCRNC-ID  TO  PV-DISP-TRIP-OCRNC-ID           
011496              DISPLAY 'TRIP-OCRNC-ID: '   PV-DISP-OTBND-TRIP-ID           
011497              SET  PS-SUMMARY-ROWS    TO  TRUE                            
011498                                                                          
011499         WHEN SQLCODE = +100                                              
011500              SET  PS-NO-SUMMARY-ROWS TO  TRUE                            
011501              DISPLAY 'NO SUMMARY ROWS'                                   
011502                                                                          
011503         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011504             DISPLAY '**************************************'             
011505             DISPLAY 'WARNING ISSUED '                                    
011506             DISPLAY 'SELECT SUT_TRIP_SUM                   '             
011507             DISPLAY '**************************************'             
011508             PERFORM 9800-SQL-WARNING                                     
011509                                                                          
011510         WHEN SQLCODE < ZERO                                              
011511             DISPLAY '**************************************'             
011512             DISPLAY 'ERROR ISSUED ON                       '             
011513             DISPLAY 'SELECT SUT_TRIP_SUM                   '             
011514             DISPLAY '**************************************'             
011515             PERFORM 9900-SQL-ERROR                                       
011516     END-EVALUATE.                                                        
011517                                                                          
011518                                                                          
011519*---------------------------------------------------------------*         
011520* DELETE SUT_MAJ_CL_SUM ROWS                                    *         
011521*---------------------------------------------------------------*         
011522 3000-DELETE-SUT00010.                                                    
011523                                                                          
011524     EXEC SQL                                                             
011525         DELETE                                                           
011526             FROM SUT_MAJ_CL_SUM                                          
011527         WHERE TRIP_OCRNC_ID  =  :DK-TRIP-OCRNC-ID                        
011528     END-EXEC.                                                            
011529                                                                          
011530     EVALUATE TRUE                                                        
011531         WHEN SQLCODE = ZERO                                              
011532             ADD SQLERRD(3)  TO PV-ROWS-DELETED                           
011533             MOVE SQLERRD(3) TO PV-DISP-COUNT                             
011534             DISPLAY '   SUT_MAJ_CL_SUM ROWS:   '                         
011535                      PV-DISP-COUNT                                       
011536             PERFORM 7100-COMMIT                                          
011537         WHEN SQLCODE = +100                                              
011538             DISPLAY '   NO SUT_MAJ_CL_SUM ROWS  '                        
011539                                                                          
011540         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011541             DISPLAY '**************************************'             
011542             DISPLAY 'WARNING ISSUED '                                    
011543             DISPLAY 'DELETE SUT_MAJ_CL_SUM ROWS            '             
011544             DISPLAY '**************************************'             
011545             PERFORM 9800-SQL-WARNING                                     
011546                                                                          
011547         WHEN SQLCODE < ZERO                                              
011548             DISPLAY '**************************************'             
011549             DISPLAY 'ERROR ISSUED ON                       '             
011550             DISPLAY 'DELETE SUT_MAJ_CL_SUM ROWS            '             
011551             DISPLAY '**************************************'             
011552             PERFORM 9900-SQL-ERROR                                       
011553     END-EVALUATE.                                                        
011554                                                                          
011555                                                                          
011556*---------------------------------------------------------------*         
011557* DELETE SUT_DEPT_SUM ROWS                                      *         
011558*---------------------------------------------------------------*         
011559 3010-DELETE-SUT00009.                                                    
011560                                                                          
011561     EXEC SQL                                                             
011562         DELETE                                                           
011563             FROM SUT_DEPT_SUM                                            
011564         WHERE TRIP_OCRNC_ID  =  :DK-TRIP-OCRNC-ID                        
011565     END-EXEC.                                                            
011566                                                                          
011567     EVALUATE TRUE                                                        
011568         WHEN SQLCODE = ZERO                                              
011569             ADD SQLERRD(3)  TO PV-ROWS-DELETED                           
011570             MOVE SQLERRD(3) TO PV-DISP-COUNT                             
011571             DISPLAY '   SUT_DEPT_SUM ROWS:     '                         
011572                      PV-DISP-COUNT                                       
011573             PERFORM 7100-COMMIT                                          
011574         WHEN SQLCODE = +100                                              
011575             DISPLAY '   NO SUT_DEPT_SUM ROWS    '                        
011576                                                                          
011577         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011578             DISPLAY '**************************************'             
011579             DISPLAY 'WARNING ISSUED '                                    
011580             DISPLAY 'DELETE SUT_DEPT-SUM ROWS              '             
011581             DISPLAY '**************************************'             
011582             PERFORM 9800-SQL-WARNING                                     
011583                                                                          
011584         WHEN SQLCODE < ZERO                                              
011585             DISPLAY '**************************************'             
011586             DISPLAY 'ERROR ISSUED ON                       '             
011587             DISPLAY 'DELETE SUT_DEPT_SUM ROWS              '             
011588             DISPLAY '**************************************'             
011589             PERFORM 9900-SQL-ERROR                                       
011590     END-EVALUATE.                                                        
011591                                                                          
011592                                                                          
011593*---------------------------------------------------------------*         
011594* DELETE SUT_BRND_MDSE_SUM ROWS                                *          
011595*---------------------------------------------------------------*         
011596 3020-DELETE-SUT00066.                                                    
011597                                                                          
011598     EXEC SQL                                                             
011599         DELETE                                                           
011600             FROM SUT_BRND_MDSE_SUM                                       
011601         WHERE TRIP_OCRNC_ID  =  :DK-TRIP-OCRNC-ID                        
011602     END-EXEC.                                                            
011603                                                                          
011604     EVALUATE TRUE                                                        
011605         WHEN SQLCODE = ZERO                                              
011606             ADD SQLERRD(3)  TO PV-ROWS-DELETED                           
011607             MOVE SQLERRD(3) TO PV-DISP-COUNT                             
011608             DISPLAY '   SUT_BRND_MDSE_SUM ROWS:'                         
011609                      PV-DISP-COUNT                                       
011610             PERFORM 7100-COMMIT                                          
011611         WHEN SQLCODE = +100                                              
011612             DISPLAY '   NO SUT_BRND_MDSE_SUM ROWS'                       
011613                                                                          
011614         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011615             DISPLAY '**************************************'             
011616             DISPLAY 'WARNING ISSUED '                                    
011617             DISPLAY 'DELETE SUT_BRND_MDSE_SUM ROWS         '             
011618             DISPLAY '**************************************'             
011619             PERFORM 9800-SQL-WARNING                                     
011620                                                                          
011621         WHEN SQLCODE < ZERO                                              
011622             DISPLAY '**************************************'             
011623             DISPLAY 'ERROR ISSUED ON                       '             
011624             DISPLAY 'DELETE SUT_BRND_MDSE_SUM ROWS         '             
011625             DISPLAY '**************************************'             
011626             PERFORM 9900-SQL-ERROR                                       
011627     END-EVALUATE.                                                        
011628                                                                          
011629                                                                          
011630*---------------------------------------------------------------*         
011631* DELETE SUT_BUS_AREA_SUM ROWS                                 *          
011632*---------------------------------------------------------------*         
011633 3030-DELETE-SUT00008.                                                    
011634                                                                          
011635     EXEC SQL                                                             
011636         DELETE                                                           
011637             FROM SUT_BUS_AREA_SUM                                        
011638         WHERE TRIP_OCRNC_ID  =  :DK-TRIP-OCRNC-ID                        
011639     END-EXEC.                                                            
011640                                                                          
011641     EVALUATE TRUE                                                        
011642         WHEN SQLCODE = ZERO                                              
011643             ADD SQLERRD(3)  TO PV-ROWS-DELETED                           
011644             MOVE SQLERRD(3) TO PV-DISP-COUNT                             
011645             DISPLAY '   SUT_BUS_AREA_SUM ROWS: '                         
011646                      PV-DISP-COUNT                                       
011647             PERFORM 7100-COMMIT                                          
011648         WHEN SQLCODE = +100                                              
011649             DISPLAY '   NO SUT_BUS_AREA_SUM ROWS '                       
011650                                                                          
011651         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011652             DISPLAY '**************************************'             
011653             DISPLAY 'WARNING ISSUED '                                    
011654             DISPLAY 'DELETE SUT_BUS_AREA_SUM ROWS          '             
011655             DISPLAY '**************************************'             
011656             PERFORM 9800-SQL-WARNING                                     
011657                                                                          
011658         WHEN SQLCODE < ZERO                                              
011659             DISPLAY '**************************************'             
011660             DISPLAY 'ERROR ISSUED ON                       '             
011661             DISPLAY 'DELETE SUT_BUS_AREA_SUM ROWS          '             
011662             DISPLAY '**************************************'             
011663             PERFORM 9900-SQL-ERROR                                       
011664     END-EVALUATE.                                                        
011665                                                                          
011666                                                                          
011667*---------------------------------------------------------------*         
011668* DELETE SUT_TRIP_DTL_SUM ROWS                                 *          
011669*---------------------------------------------------------------*         
011670 3040-DELETE-SUT00095.                                                    
011671                                                                          
011672     EXEC SQL                                                             
011673         DELETE                                                           
011674             FROM SUT_TRIP_DTL_SUM                                        
011675         WHERE TRIP_OCRNC_ID  =  :DK-TRIP-OCRNC-ID                        
011676     END-EXEC.                                                            
011677                                                                          
011678     EVALUATE TRUE                                                        
011679         WHEN SQLCODE = ZERO                                              
011680             ADD SQLERRD(3)  TO PV-ROWS-DELETED                           
011681             MOVE SQLERRD(3) TO PV-DISP-COUNT                             
011682             DISPLAY '   SUT_TRIP_DTL_SUM ROWS: '                         
011683                      PV-DISP-COUNT                                       
011684             PERFORM 7100-COMMIT                                          
011685         WHEN SQLCODE = +100                                              
011686             DISPLAY '   NO SUT_TRIP_DTL_SUM ROWS '                       
011687                                                                          
011688         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011689             DISPLAY '**************************************'             
011690             DISPLAY 'WARNING ISSUED '                                    
011691             DISPLAY 'DELETE SUT_TRIP_DTL_SUM ROWS          '             
011692             DISPLAY '**************************************'             
011693             PERFORM 9800-SQL-WARNING                                     
011694                                                                          
011695         WHEN SQLCODE < ZERO                                              
011696             DISPLAY '**************************************'             
011697             DISPLAY 'ERROR ISSUED ON                       '             
011698             DISPLAY 'DELETE SUT_TRIP_DTL_SUM ROWS          '             
011699             DISPLAY '**************************************'             
011700             PERFORM 9900-SQL-ERROR                                       
011701     END-EVALUATE.                                                        
011702                                                                          
011703                                                                          
011704*---------------------------------------------------------------*         
011705* UPDATE SUT_TRIP_SUM QTYS TO ZERO                             *          
011706*---------------------------------------------------------------*         
011707 3050-UPDATE-SUT00007.                                                    
011708                                                                          
011709     EXEC SQL                                                             
011710          UPDATE SUT_TRIP_SUM                                             
011711             SET  UNT_QTY          = 0                                    
011712                , SKU_QTY          = 0                                    
011713                , CART_QTY         = 0                                    
011714                , RTL_DOL_AMT      = 0                                    
011715                , COST_DOL_AMT     = 0                                    
011716         WHERE TRIP_OCRNC_ID  =  :DK-TRIP-OCRNC-ID                        
011717     END-EXEC.                                                            
011718                                                                          
011719     EVALUATE TRUE                                                        
011720         WHEN SQLCODE = ZERO                                              
011721             ADD SQLERRD(3)  TO PV-ROWS-UPDATED                           
011722             MOVE SQLERRD(3) TO PV-DISP-COUNT                             
011723             DISPLAY '   SUT_TRIP_SUM UPDATE:   '                         
011724                      PV-DISP-COUNT                                       
011725             PERFORM 7100-COMMIT                                          
011726         WHEN SQLCODE = +100                                              
011727             DISPLAY '   NO SUT_TRIP_SUM ROWS     '                       
011728                                                                          
011729         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011730             DISPLAY '**************************************'             
011731             DISPLAY 'WARNING ISSUED '                                    
011732             DISPLAY 'UPDATE SUT_TRIP_SUM ROW               '             
011733             DISPLAY '**************************************'             
011734             PERFORM 9800-SQL-WARNING                                     
011735                                                                          
011736         WHEN SQLCODE < ZERO                                              
011737             DISPLAY '**************************************'             
011738             DISPLAY 'ERROR ISSUED ON                       '             
011739             DISPLAY 'UPDATE SUT_TRIP_SUM ROW               '             
011740             DISPLAY '**************************************'             
011741             PERFORM 9900-SQL-ERROR                                       
011742     END-EVALUATE.                                                        
011743                                                                          
011744                                                                          
011745*---------------------------------------------------------------*         
011746* INSERT DR - DC RELEASED STATUS                               *          
011747*---------------------------------------------------------------*         
011748 3060-INSERT-DR-STATUS.                                                   
011749                                                                          
011750     MOVE SU174-OTBND-TRIP-ID     TO  SUOBTS-OTBND-TRIP-ID.               
011751     MOVE SU174-ORIG-OPER         TO  SUOBTS-STAT-OPER-UNT-ID.            
011752     MOVE SU174-DOOR-ID           TO  SUOBTS-DOOR-ID.                     
011753     MOVE PC-PROGRAM-NAME         TO  SUOBTS-OTBND-STAT-USR-ID.           
011754     MOVE SU174-STATUS-TMST-2DAYS TO  SUOBTS-OTBND-STAT-TMST.             
011755                                                                          
011756     EXEC SQL                                                             
011757          INSERT INTO TSUOBTS                                             
011758                ( OTBND_TRIP_ID                                           
011759                 ,OTBND_STAT_TMST                                         
011760                 ,TRIP_STAT_CDE                                           
011761                 ,STAT_OPER_UNT_ID                                        
011762                 ,OTBND_STAT_USR_ID                                       
011763                 ,DOOR_ID                                                 
011764                 ,TRLR_SEAL_ID                                            
011765                 ,SHIP_SCAC_CDE                                           
011766                 ,SHIP_DRV_LAST_NM                                        
011767                 ,SHIP_DRV_FRST_NM                                        
011768                 ,SHIP_DRV_ID                                             
011769                 ,TRLR_PRKG_LOC_DESC                                      
011770                 ,TRLR_PRKG_SLOT_NBR                                      
011771                 ,FINCL_POST_TMST                                         
011772                 ,CPCTY_PCT                                               
011773                 ,UNUSD_PLLT_QTY                                          
011774                 ,LOD_BR_QTY                                              
011775                 ,RPT_GEND_IND                                            
011776                )                                                         
011777          VALUES                                                          
011778                (:SUOBTS-OTBND-TRIP-ID                                    
011779                ,:SUOBTS-OTBND-STAT-TMST                                  
011780                ,'DR'                                                     
011781                ,:SUOBTS-STAT-OPER-UNT-ID                                 
011782                ,:SUOBTS-OTBND-STAT-USR-ID                                
011783                ,:SUOBTS-DOOR-ID                                          
011784                ,' '                                                      
011785                ,' '                                                      
011786                ,' '                                                      
011787                ,' '                                                      
011788                ,' '                                                      
011789                ,' '                                                      
011790                ,' '                                                      
011791                ,'9999-09-09-09.09.09.999999'                             
011792                , 0                                                       
011793                , 0                                                       
011794                , 0                                                       
011795                ,'N'                                                      
011796               )                                                          
011797     END-EXEC.                                                            
011798                                                                          
011799     EVALUATE TRUE                                                        
011800         WHEN SQLCODE = ZERO                                              
011801             ADD 1                    TO PV-INSERT-COUNT                  
011802             DISPLAY '   INSERT TSUOBTS:  DR    '                         
011803                      SU174-STATUS-TMST-2DAYS                             
011804                                                                          
011805         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011806             DISPLAY '**************************************'             
011807             DISPLAY 'WARNING ISSUED '                                    
011808             DISPLAY 'INSERT TSUOBTS - DR                   '             
011809             DISPLAY '**************************************'             
011810             PERFORM 9800-SQL-WARNING                                     
011811                                                                          
011812         WHEN SQLCODE < ZERO                                              
011813             DISPLAY '**************************************'             
011814             DISPLAY 'ERROR ISSUED ON                       '             
011815             DISPLAY 'INSERT TSUOBTS - DR                   '             
011816             DISPLAY '**************************************'             
011817             PERFORM 9900-SQL-ERROR                                       
011818     END-EVALUATE.                                                        
011819                                                                          
011820                                                                          
011821*---------------------------------------------------------------*         
011822* INSERT SO - STORE OPENED STATUS                              *          
011823*---------------------------------------------------------------*         
011824 3070-INSERT-SO-STATUS.                                                   
011825                                                                          
011826     MOVE SU174-OTBND-TRIP-ID     TO  SUOBTS-OTBND-TRIP-ID.               
011827     MOVE SU174-DEST-OPER         TO  SUOBTS-STAT-OPER-UNT-ID.            
011828     MOVE SU174-DOOR-ID           TO  SUOBTS-DOOR-ID.                     
011829     MOVE PC-PROGRAM-NAME         TO  SUOBTS-OTBND-STAT-USR-ID.           
011830     MOVE SU174-STATUS-TMST-1DAYS TO  SUOBTS-OTBND-STAT-TMST.             
011831                                                                          
011832     EXEC SQL                                                             
011833          INSERT INTO TSUOBTS                                             
011834                ( OTBND_TRIP_ID                                           
011835                 ,OTBND_STAT_TMST                                         
011836                 ,TRIP_STAT_CDE                                           
011837                 ,STAT_OPER_UNT_ID                                        
011838                 ,OTBND_STAT_USR_ID                                       
011839                 ,DOOR_ID                                                 
011840                 ,TRLR_SEAL_ID                                            
011841                 ,SHIP_SCAC_CDE                                           
011842                 ,SHIP_DRV_LAST_NM                                        
011843                 ,SHIP_DRV_FRST_NM                                        
011844                 ,SHIP_DRV_ID                                             
011845                 ,TRLR_PRKG_LOC_DESC                                      
011846                 ,TRLR_PRKG_SLOT_NBR                                      
011847                 ,FINCL_POST_TMST                                         
011848                 ,CPCTY_PCT                                               
011849                 ,UNUSD_PLLT_QTY                                          
011850                 ,LOD_BR_QTY                                              
011851                 ,RPT_GEND_IND                                            
011852                )                                                         
011853          VALUES                                                          
011854                (:SUOBTS-OTBND-TRIP-ID                                    
011855                ,:SUOBTS-OTBND-STAT-TMST                                  
011856                ,'SO'                                                     
011857                ,:SUOBTS-STAT-OPER-UNT-ID                                 
011858                ,:SUOBTS-OTBND-STAT-USR-ID                                
011859                ,:SUOBTS-DOOR-ID                                          
011860                ,' '                                                      
011861                ,' '                                                      
011862                ,' '                                                      
011863                ,' '                                                      
011864                ,' '                                                      
011865                ,' '                                                      
011866                ,' '                                                      
011867                ,'9999-09-09-09.09.09.999999'                             
011868                , 0                                                       
011869                , 0                                                       
011870                , 0                                                       
011871                ,'N'                                                      
011872               )                                                          
011873     END-EXEC.                                                            
011874                                                                          
011875     EVALUATE TRUE                                                        
011876         WHEN SQLCODE = ZERO                                              
011877             ADD 1                    TO PV-INSERT-COUNT                  
011878             DISPLAY '   INSERT TSUOBTS:  SO    '                         
011879                      SU174-STATUS-TMST-1DAYS                             
011880                                                                          
011881         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011882             DISPLAY '**************************************'             
011883             DISPLAY 'WARNING ISSUED '                                    
011884             DISPLAY 'INSERT TSUOBTS - SO                   '             
011885             DISPLAY '**************************************'             
011886             PERFORM 9800-SQL-WARNING                                     
011887                                                                          
011888         WHEN SQLCODE < ZERO                                              
011889             DISPLAY '**************************************'             
011890             DISPLAY 'ERROR ISSUED ON                       '             
011891             DISPLAY 'INSERT TSUOBTS - SO                   '             
011892             DISPLAY '**************************************'             
011893             PERFORM 9900-SQL-ERROR                                       
011894     END-EVALUATE.                                                        
011895                                                                          
011896                                                                          
011897*---------------------------------------------------------------*         
011898* INSERT SU - STORE UNLOADED STATUS                            *          
011899*---------------------------------------------------------------*         
011900 3080-INSERT-SU-STATUS.                                                   
011901                                                                          
011902     MOVE SU174-OTBND-TRIP-ID     TO  SUOBTS-OTBND-TRIP-ID.               
011903     MOVE SU174-DEST-OPER         TO  SUOBTS-STAT-OPER-UNT-ID.            
011904     MOVE SU174-STATUS-TMST-2DAYS TO  SUOBTS-OTBND-STAT-TMST.             
011905     MOVE SU174-DOOR-ID           TO  SUOBTS-DOOR-ID.                     
011906     MOVE PC-PROGRAM-NAME         TO  SUOBTS-OTBND-STAT-USR-ID.           
011907                                                                          
011908     EXEC SQL                                                             
011909          INSERT INTO TSUOBTS                                             
011910                ( OTBND_TRIP_ID                                           
011911                 ,OTBND_STAT_TMST                                         
011912                 ,TRIP_STAT_CDE                                           
011913                 ,STAT_OPER_UNT_ID                                        
011914                 ,OTBND_STAT_USR_ID                                       
011915                 ,DOOR_ID                                                 
011916                 ,TRLR_SEAL_ID                                            
011917                 ,SHIP_SCAC_CDE                                           
011918                 ,SHIP_DRV_LAST_NM                                        
011919                 ,SHIP_DRV_FRST_NM                                        
011920                 ,SHIP_DRV_ID                                             
011921                 ,TRLR_PRKG_LOC_DESC                                      
011922                 ,TRLR_PRKG_SLOT_NBR                                      
011923                 ,FINCL_POST_TMST                                         
011924                 ,CPCTY_PCT                                               
011925                 ,UNUSD_PLLT_QTY                                          
011926                 ,LOD_BR_QTY                                              
011927                 ,RPT_GEND_IND                                            
011928                )                                                         
011929          VALUES                                                          
011930                (:SUOBTS-OTBND-TRIP-ID                                    
011931                ,:SUOBTS-OTBND-STAT-TMST                                  
011932                ,'SU'                                                     
011933                ,:SUOBTS-STAT-OPER-UNT-ID                                 
011934                ,:SUOBTS-OTBND-STAT-USR-ID                                
011935                ,:SUOBTS-DOOR-ID                                          
011936                ,' '                                                      
011937                ,' '                                                      
011938                ,' '                                                      
011939                ,' '                                                      
011940                ,' '                                                      
011941                ,' '                                                      
011942                ,' '                                                      
011943                ,'9999-09-09-09.09.09.999999'                             
011944                , 0                                                       
011945                , 0                                                       
011946                , 0                                                       
011947                ,'N'                                                      
011948               )                                                          
011949     END-EXEC.                                                            
011950                                                                          
011951     EVALUATE TRUE                                                        
011952         WHEN SQLCODE = ZERO                                              
011953             ADD 1                    TO PV-INSERT-COUNT                  
011954             DISPLAY '   INSERT TSUOBTS:  SU    '                         
011955                      SU174-STATUS-TMST-2DAYS                             
011956                                                                          
011957         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011958             DISPLAY '**************************************'             
011959             DISPLAY 'WARNING ISSUED '                                    
011960             DISPLAY 'INSERT TSUOBTS - SO                   '             
011961             DISPLAY '**************************************'             
011962             PERFORM 9800-SQL-WARNING                                     
011963                                                                          
011964         WHEN SQLCODE < ZERO                                              
011965             DISPLAY '**************************************'             
011966             DISPLAY 'ERROR ISSUED ON                       '             
011967             DISPLAY 'INSERT TSUOBTS - SO                   '             
011968             DISPLAY '**************************************'             
011969             PERFORM 9900-SQL-ERROR                                       
011970     END-EVALUATE.                                                        
011971                                                                          
011972                                                                          
011973*---------------------------------------------------------------*         
011974* DELETE SCAN ON RECORDS                                       *          
011975*---------------------------------------------------------------*         
011976 3090-DELETE-SHON.                                                        
011977                                                                          
011978     MOVE SU174-OTBND-TRIP-ID     TO  SUT00027-OTBND-TRIP-ID.             
011979                                                                          
011980     EXEC SQL                                                             
011981         DELETE                                                           
011982             FROM SUT_OTBND_LOC                                           
011983         WHERE OTBND_TRIP_ID  =  :SUT00027-OTBND-TRIP-ID                  
011984           AND SCN_CDE        = 'SHON'                                    
011985     END-EXEC.                                                            
011986                                                                          
011987     EVALUATE TRUE                                                        
011988         WHEN SQLCODE = ZERO                                              
011989             ADD SQLERRD(3)  TO PV-ROWS-DELETED                           
011990             MOVE SQLERRD(3) TO PV-DISP-COUNT                             
011991             DISPLAY '   SUT_OTBND_LOC SHON ROW:'                         
011992                      PV-DISP-COUNT                                       
011993             PERFORM 7100-COMMIT                                          
011994         WHEN SQLCODE = +100                                              
011995             DISPLAY '   NO SUT_OTBND_LOC SHON ROWS'                      
011996                                                                          
011997         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
011998             DISPLAY '**************************************'             
011999             DISPLAY 'WARNING ISSUED '                                    
012000             DISPLAY 'DELETE SUT_OTBND_LOC SHON ROWS        '             
012001             DISPLAY '**************************************'             
012002             PERFORM 9800-SQL-WARNING                                     
012003                                                                          
012004         WHEN SQLCODE < ZERO                                              
012005             DISPLAY '**************************************'             
012006             DISPLAY 'ERROR ISSUED ON                       '             
012007             DISPLAY 'DELETE SUT_OTBND_LOC SHON ROWS        '             
012008             DISPLAY '**************************************'             
012009             PERFORM 9900-SQL-ERROR                                       
012010     END-EVALUATE.                                                        
012011                                                                          
012012                                                                          
012013*---------------------------------------------------------------*         
012014* INSERT DC CLOSED STATUS                                      *          
012015*---------------------------------------------------------------*         
012016 4000-INSERT-DC-STATUS.                                                   
012017                                                                          
012018     MOVE SU174-OTBND-TRIP-ID     TO  SUOBTS-OTBND-TRIP-ID.               
012019     MOVE SU174-ORIG-OPER         TO  SUOBTS-STAT-OPER-UNT-ID.            
012020     MOVE SU174-STATUS-TMST-1DAYS TO  SUOBTS-OTBND-STAT-TMST.             
012021     MOVE SU174-DOOR-ID           TO  SUOBTS-DOOR-ID.                     
012022     MOVE PC-PROGRAM-NAME         TO  SUOBTS-OTBND-STAT-USR-ID.           
012023                                                                          
012024     EXEC SQL                                                             
012025          INSERT INTO TSUOBTS                                             
012026                ( OTBND_TRIP_ID                                           
012027                 ,OTBND_STAT_TMST                                         
012028                 ,TRIP_STAT_CDE                                           
012029                 ,STAT_OPER_UNT_ID                                        
012030                 ,OTBND_STAT_USR_ID                                       
012031                 ,DOOR_ID                                                 
012032                 ,TRLR_SEAL_ID                                            
012033                 ,SHIP_SCAC_CDE                                           
012034                 ,SHIP_DRV_LAST_NM                                        
012035                 ,SHIP_DRV_FRST_NM                                        
012036                 ,SHIP_DRV_ID                                             
012037                 ,TRLR_PRKG_LOC_DESC                                      
012038                 ,TRLR_PRKG_SLOT_NBR                                      
012039                 ,FINCL_POST_TMST                                         
012040                 ,CPCTY_PCT                                               
012041                 ,UNUSD_PLLT_QTY                                          
012042                 ,LOD_BR_QTY                                              
012043                 ,RPT_GEND_IND                                            
012044                )                                                         
012045          VALUES                                                          
012046                (:SUOBTS-OTBND-TRIP-ID                                    
012047                ,:SUOBTS-OTBND-STAT-TMST                                  
012048                ,'DC'                                                     
012049                ,:SUOBTS-STAT-OPER-UNT-ID                                 
012050                ,:SUOBTS-OTBND-STAT-USR-ID                                
012051                ,:SUOBTS-DOOR-ID                                          
012052                ,' '                                                      
012053                ,' '                                                      
012054                ,' '                                                      
012055                ,' '                                                      
012056                ,' '                                                      
012057                ,' '                                                      
012058                ,' '                                                      
012059                ,'9999-09-09-09.09.09.999999'                             
012060                , 0                                                       
012061                , 0                                                       
012062                , 0                                                       
012063                ,'N'                                                      
012064               )                                                          
012065     END-EXEC.                                                            
012066                                                                          
012067     EVALUATE TRUE                                                        
012068         WHEN SQLCODE = ZERO                                              
012069             ADD 1                    TO PV-INSERT-COUNT                  
012070             DISPLAY '   INSERT TSUOBTS:  DC    '                         
012071                      SU174-STATUS-TMST-1DAYS                             
012072                                                                          
012073         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                          
012074             DISPLAY '**************************************'             
012075             DISPLAY 'WARNING ISSUED '                                    
012076             DISPLAY 'INSERT TSUOBTS - DC                   '             
012077             DISPLAY '**************************************'             
012078             PERFORM 9800-SQL-WARNING                                     
012079                                                                          
012080         WHEN SQLCODE < ZERO                                              
012081             DISPLAY '**************************************'             
012082             DISPLAY 'ERROR ISSUED ON                       '             
012083             DISPLAY 'INSERT TSUOBTS - DC                   '             
012084             DISPLAY '**************************************'             
012085             PERFORM 9900-SQL-ERROR                                       
012086     END-EVALUATE.                                                        
012087                                                                          
012088                                                                          
012089*---------------------------------------------------------------*         
012090* DB2 COOMMIT                                                   *         
012091*---------------------------------------------------------------*         
012092 7100-COMMIT.                                                             
012093                                                                          
012094     EXEC SQL                                                             
012095         COMMIT                                                           
012096     END-EXEC.                                                            
012097                                                                          
012100                                                                          
012200*---------------------------------------------------------------*         
012300*                                                               *         
012400*---------------------------------------------------------------*         
028600 8000-READ-EXTRACT-FILE.                                                  
028700                                                                          
028800     READ INPUT-EXTRACT-FILE                                              
028900         INTO SU174-TRIP-RECORD                                           
029000     AT END                                                               
029100         SET PS-EOF-EXTRACT-YES       TO TRUE                             
029200     NOT AT END                                                           
029300         ADD 1                        TO PV-EXTRACT-COUNT                 
029400     END-READ.                                                            
029500                                                                          
029510*---------------------------------------------------------------*         
029520*                                                               *         
029530*---------------------------------------------------------------*         
029600 9000-EOJ.                                                                
029700     CLOSE      INPUT-EXTRACT-FILE                                        
029800                                                                          
029900     DISPLAY SPACES.                                                      
030000     DISPLAY ' SUKUP039 -  END'.                                          
030010                                                                          
030100     DISPLAY SPACES.                                                      
030200     MOVE PV-EXTRACT-COUNT  TO PV-DISP-NBR                                
030300     DISPLAY 'INPUT COUNT:  '  PV-DISP-NBR.                               
030310                                                                          
030400     DISPLAY SPACES.                                                      
030600     MOVE PV-INSERT-COUNT   TO PV-DISP-NBR                                
030700     DISPLAY 'INSERT COUNT: '  PV-DISP-NBR.                               
030701                                                                          
030702     DISPLAY SPACES.                                                      
030710     MOVE PV-ROWS-UPDATED   TO PV-DISP-NBR                                
030720     DISPLAY 'UPDATE COUNT: '  PV-DISP-NBR.                               
030721                                                                          
030722     DISPLAY SPACES.                                                      
030730     MOVE PV-ROWS-DELETED   TO PV-DISP-NBR                                
030740     DISPLAY 'DELETE COUNT: '  PV-DISP-NBR.                               
030800                                                                          
030810*---------------------------------------------------------------*         
030820*                                                               *         
030830*---------------------------------------------------------------*         
030900 9800-SQL-WARNING.                                                        
031000                                                                          
031100     MOVE SQLCODE               TO SQLCODE2.                              
031200     MOVE SQLERRD(3)            TO SQLERRD3.                              
031300     DISPLAY '** ABEND **       ** = SQLWARNING'.                         
031400     DISPLAY '** PROGRAM        ** = SUKUP039'.                           
031500     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.                
031600     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                          
031700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                          
031800                                                                          
031900     COPY DPPD004.                                                        
032000     SET ABEND-4013-DB2-ERROR   TO TRUE                                   
032100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
032200                                                                          
032210*---------------------------------------------------------------*         
032220*                                                               *         
032230*---------------------------------------------------------------*         
032300 9900-SQL-ERROR.                                                          
032400                                                                          
032500     MOVE SQLCODE               TO SQLCODE2.                              
032600     MOVE SQLERRD(3)            TO SQLERRD3.                              
032700     DISPLAY '** ABEND **       ** = SQLERROR'.                           
032800     DISPLAY '** PROGRAM        ** = SUKUP039'.                           
032900     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.                
033000                                                                          
033100     COPY DPPD004.                                                        
033200     SET ABEND-4013-DB2-ERROR   TO TRUE                                   
033300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
