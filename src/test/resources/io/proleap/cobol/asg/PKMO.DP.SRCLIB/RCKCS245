000100 IDENTIFICATION DIVISION.                                         00010093
000200 PROGRAM-ID.    RCKCS245.                                         00020093
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030093
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040093
000500 DATE-WRITTEN.  04-03-94                                          00050093
000600 DATE-COMPILED.                                                   00060093
000700******************************************************************00070093
000800*    E245 - MATCH PURCHASE ORDER LINE LIST                        00080093
000900*           ORDERED BY STYLE, COLOR, SIZE                         00090093
001000*                OR BY STYLE, SIZE, COLOR                         00100093
001100*                OR BY COLOR                                      00110093
001200*                OR BY SKU                                        00120093
001300*                OR BY COST                                       00130093
001400*                OR BY DESCRIPTION                                00140093
001500*                                                                 00150093
001600*    DISPLAYS ALL PURCHASE ORDER LINES FOR A PURCHASE ORDER.      00160093
001700*    THE USER CAN SELECT LINES TO ADD TO THE PACK SLIP            00170093
001800*                                                                 00180093
001900*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00190093
002000*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00200093
002100*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00210093
002200*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00220093
002300*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00230093
002400*                                                                 00240093
002500* 06/27/2014  CHERI PARMLEY                                       00250097
002600*    ADDING CHECK WITHIN THE PROCESSING OF THE PO'S TO CHECK FOR  00260098
002700*    THE PACKAGING CODE, PREPK-ID AND THE CANCEL STATUS, IF IT    00270098
002800*    MEETS CRITERIA THE ITEM ROW WILL NOT BE DISPLAYED ON THE     00280098
002900*    SCREEN.  MAIN CHANGE BEGINS IN 4040-GET-PO-ITEMS             00290098
003000*        SEE CHANGES TAGGED WITH CLP 06/27/14                     00300093
003100******************************************************************00310093
003110*---------------------------------------------------------------* 00311097
003120* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00312097
003130* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00313097
003140* MAKING THE CALL DYNAMIC VS STATIC.                              00314097
003150*---------------------------------------------------------------* 00315097
003200 ENVIRONMENT DIVISION.                                            00320093
003300 DATA DIVISION.                                                   00330093
003400 WORKING-STORAGE SECTION.                                         00340093
003500                                                                  00350093
003600 01  PC-PROGRAM-CONSTANTS.                                        00360093
003700     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC245A  '. 00370093
003800     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM245 '. 00380093
003900     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS245'. 00390093
004000     05  PC-RCKUP006                  PIC X(08) VALUE 'RCKUP006'. 00400093
004100     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00410093
004200     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00420093
004300     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +6          00430093
004400                                                COMP SYNC.        00440093
004500     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00450093
004600                                                COMP SYNC.        00460093
004700     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00470093
004800                                                COMP SYNC.        00480093
004900     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00490093
005000                                                COMP SYNC.        00500093
005100     05  PC-01                        PIC X(02) VALUE '01'.       00510093
005200     05  PC-AC                        PIC X(02) VALUE 'AC'.       00520093
005300     05  PC-AP                        PIC X(02) VALUE 'AP'.       00530093
005400     05  PC-CA                        PIC X(02) VALUE 'CA'.       00540093
005500     05  PC-CB                        PIC X(02) VALUE 'CB'.       00550093
005600     05  PC-CM                        PIC X(02) VALUE 'CM'.       00560093
005700     05  PC-RV                        PIC X(02) VALUE 'RV'.       00570093
005800     05  PC-IN                        PIC X(02) VALUE 'IN'.       00580093
005900     05  PC-IP                        PIC X(02) VALUE 'IP'.       00590093
006000     05  PC-VE                        PIC X(02) VALUE 'VE'.       00600093
006100     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00610093
006200     05  PC-A                         PIC X(01) VALUE 'A'.        00620093
006300*CLP 06/25/14 - START                                             00630093
006400     05  PC-I                         PIC X(01) VALUE 'I'.        00640093
006500     05  PC-M                         PIC X(01) VALUE 'M'.        00650093
006600*CLP 06/25/14 - END                                               00660093
006700     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00670093
006800     05  PC-STYL-CLR-SIZE             PIC X(01) VALUE '1'.        00680093
006900     05  PC-STYL-SIZE-CLR             PIC X(01) VALUE '2'.        00690093
007000     05  PC-COLOR                     PIC X(01) VALUE '3'.        00700093
007100     05  PC-SIZE                      PIC X(01) VALUE '4'.        00710093
007200     05  PC-SKU                       PIC X(01) VALUE '5'.        00720093
007300     05  PC-COST                      PIC X(01) VALUE '6'.        00730093
007400     05  PC-DESC                      PIC X(01) VALUE '7'.        00740093
007500     05  PC-SKU-ZEROS             PIC S9(8)   VALUE 00000000.     00750093
007600     05  PC-SKU-NINES             PIC S9(8)   VALUE 99999999.     00760093
007700     05  PC-HDR-STYLE                 PIC X(06) VALUE 'STYLE:'.   00770093
007800     05  PC-HDR-COLOR                 PIC X(06) VALUE 'COLOR:'.   00780093
007900     05  PC-HDR-SIZE                  PIC X(06) VALUE 'SIZE: '.   00790093
008000     05  PC-HDR-SKU                   PIC X(06) VALUE 'SKU:  '.   00800093
008100     05  PC-HDR-COST                  PIC X(06) VALUE 'COST: '.   00810093
008200     05  PC-HDR-DESC                  PIC X(06) VALUE 'DESC: '.   00820093
008300     05  PC-N                         PIC X(01) VALUE 'N'.        00830093
008400     05  PC-STAT-1                    PIC X(02) VALUE SPACE.      00840093
008500     05  PC-STAT-2                    PIC X(02) VALUE SPACE.      00850093
008600     05  PC-STAT-3                    PIC X(02) VALUE SPACE.      00860093
008700     05  PC-STAT-4                    PIC X(02) VALUE SPACE.      00870093
008800     05  PC-STAT-5                    PIC X(02) VALUE SPACE.      00880093
008900     05  PC-STAT-6                    PIC X(02) VALUE SPACE.      00890093
009000                                                                  00900093
009100     05  PC-TSYMSG-NUMBERS.                                       00910093
009200         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00920093
009300*            INVALID VALUE                                        00930093
009400         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00940093
009500*            MUST BE NUMERIC                                      00950093
009600         10  PC-TSYMSG-00034          PIC 9(5)  VALUE 00034.      00960093
009700*            ADD(S) SUCCESSFUL                                    00970093
009800         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00980093
009900*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00990093
010000         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      01000093
010100*            NO END OF RANGE HAS BEEN SPECIFIED                   01010093
010200         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      01020093
010300*            END OF RANGE PRECEDES START OF RANGE                 01030093
010400         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      01040093
010500*            NO START OF RANGE HAS BEEN SPECIFIED                 01050093
010600         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      01060093
010700*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   01070093
010800         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      01080093
010900*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     01090093
011000         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      01100093
011100*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       01110093
011200         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      01120093
011300*            TOP OF LIST                                          01130093
011400         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      01140093
011500*            BOTTOM OF LIST                                       01150093
011600         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      01160093
011700*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      01170093
011800         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     01180093
011900*            CANNOT ADD - RECORD ALREADY EXISTS                   01190093
012000         10  PC-TSYMSG-00148          PIC 9(5)  VALUE 00148.      01200093
012100*            DATA DOES NOT EXIST                                  01210093
012200         10  PC-TSYMSG-00168          PIC 9(5)  VALUE 00168.      01220093
012300*            INVALID PURCHASE ORDER STATUS FOR THIS FUNCTION      01230093
012400         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01240093
012500*            MORE ITEMS TO DISPLAY                                01250093
012600         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      01260093
012700*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL01270093
012800         10  PC-TSYMSG-00726          PIC 9(5)  VALUE 00726.      01280093
012900*            PURCHASE ORDER NOT FOUND                             01290093
013000                                                                  01300093
013100 01  PS-PROGRAM-SWITCHES.                                         01310093
013200     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01320093
013300         88  PS-NO-ERROR                        VALUE 'N'.        01330093
013400         88  PS-ERROR                           VALUE 'Y'.        01340093
013500     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X    VALUE 'N'.        01350093
013600         88  PS-ORIG-ASN-PKSLIP-YES             VALUE 'Y'.        01360093
013700         88  PS-ORIG-ASN-PKSLIP-NO              VALUE 'N'.        01370093
013800     05  PS-PREPACK-SW                PIC X(1)  VALUE 'N'.        01380093
013900         88  PREPACK-PO                         VALUE 'Y'.        01390093
014000         88  NOT-PREPACK-PO                     VALUE 'N'.        01400093
014100     05  PS-SEARCH-STYLE-SW           PIC  X    VALUE 'N'.        01410093
014200         88  PS-INVALID-SEARCH-STYLE            VALUE 'N'.        01420093
014300         88  PS-VALID-SEARCH-STYLE              VALUE 'Y'.        01430093
014400     05  PS-SEARCH-COLOR-SW           PIC  X    VALUE 'N'.        01440093
014500         88  PS-INVALID-SEARCH-COLOR            VALUE 'N'.        01450093
014600         88  PS-VALID-SEARCH-COLOR              VALUE 'Y'.        01460093
014700     05  PS-SEARCH-SIZE-SW            PIC  X    VALUE 'N'.        01470093
014800         88  PS-INVALID-SEARCH-SIZE             VALUE 'N'.        01480093
014900         88  PS-VALID-SEARCH-SIZE               VALUE 'Y'.        01490093
015000     05  PS-SEARCH-SKU-SW             PIC  X    VALUE 'N'.        01500093
015100         88  PS-INVALID-SEARCH-SKU              VALUE 'N'.        01510093
015200         88  PS-VALID-SEARCH-SKU                VALUE 'Y'.        01520093
015300     05  PS-SEARCH-COST-SW            PIC  X    VALUE 'N'.        01530093
015400         88  PS-INVALID-SEARCH-COST             VALUE 'N'.        01540093
015500         88  PS-VALID-SEARCH-COST               VALUE 'Y'.        01550093
015600     05  PS-SEARCH-DESC-SW            PIC  X    VALUE 'N'.        01560093
015700         88  PS-INVALID-SEARCH-DESC             VALUE 'N'.        01570093
015800         88  PS-VALID-SEARCH-DESC               VALUE 'Y'.        01580093
015900     05  PS-PKITEM-SW                 PIC  X    VALUE 'N'.        01590093
016000         88  PS-PKITEM-NOT-FOUND                VALUE 'N'.        01600093
016100         88  PS-PKITEM-FOUND                    VALUE 'Y'.        01610093
016200     05  PS-PLAN-FOUND-SW             PIC  X    VALUE 'N'.        01620093
016300         88  PS-PLAN-NOT-FOUND                  VALUE 'N'.        01630093
016400         88  PS-PLAN-FOUND                      VALUE 'Y'.        01640093
016500     05  PS-PROCESS-PO-SW             PIC  X    VALUE 'Y'.        01650093
016600         88  PS-PROCESS-PO                      VALUE 'Y'.        01660093
016700         88  PS-DONT-PROCESS-PO                 VALUE 'N'.        01670093
016800     05  PS-ERROR-IN-QTY-SW           PIC  X    VALUE 'Y'.        01680093
016900         88  PS-ERROR-IN-QTY                    VALUE 'Y'.        01690093
017000         88  PS-NO-ERROR-IN-QTY                 VALUE 'N'.        01700093
017100                                                                  01710093
017200 01  DK-DB2-KEYS.                                                 01720093
017300     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01730093
017400     05  DK-STR-NBR-B                 PIC S9(4) COMP VALUE +0.    01740093
017500     05  DK-STR-NBR-E                 PIC S9(4) COMP VALUE +9999. 01750093
017600     05  DK-ITM-NBR                   PIC S9(15)V  VALUE ZEROES   01760093
017700                                                COMP-3.           01770093
017800                                                                  01780093
017900 01  PV-PROGRAM-VARIABLES.                                        01790093
018000     05  PV-SUB                       PIC S9(4) VALUE ZERO        01800093
018100                                                COMP SYNC.        01810093
018200     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01820093
018300                                                COMP SYNC.        01830093
018400     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01840093
018500                                                COMP-3.           01850093
018600     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01860093
018700                                                COMP-3.           01870093
018800     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01880093
018900                                                COMP-3.           01890093
019000     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01900093
019100                                                COMP-3.           01910093
019200     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01920093
019300                                                COMP-3.           01930093
019400     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01940093
019500                                                COMP-3.           01950093
019600     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        01960093
019700                                                COMP-3.           01970093
019800     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01980093
019900                                                COMP SYNC.        01990093
020000     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        02000093
020100                                                COMP SYNC.        02010093
020200     05  PV-COUNTER                   PIC S9(04) VALUE +0         02020093
020300                                                 COMP SYNC.       02030093
020400     05  PV-NULL-IND                  PIC S9(04) VALUE +0         02040093
020500                                                 COMP SYNC.       02050093
020600     05  PV-ITEM                      PIC S9(4) VALUE ZERO        02060093
020700                                                COMP SYNC.        02070093
020800     05  PV-ORIG-PKSL-ITM-QTY         PIC S9(9) VALUE +0 COMP.    02080093
020900     05  PV-SKU-NBR                   PIC S9(8) VALUE ZERO        02090093
021000                                                COMP-3.           02100093
021100     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        02110093
021200                                                COMP SYNC.        02120093
021300     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        02130093
021400                                                COMP SYNC.        02140093
021500     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        02150093
021600                                                COMP SYNC.        02160093
021700     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        02170093
021800                                                COMP SYNC.        02180093
021900     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        02190093
022000                                                COMP SYNC.        02200093
022100     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        02210093
022200                                                COMP SYNC.        02220093
022300     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        02230093
022400                                                COMP SYNC.        02240093
022500     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        02250093
022600                                                COMP SYNC.        02260093
022700     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        02270093
022800                                                COMP SYNC.        02280093
022900     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        02290093
023000                                                COMP SYNC.        02300093
023100     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        02310093
023200                                                COMP SYNC.        02320093
023300     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        02330093
023400                                                COMP SYNC.        02340093
023500     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        02350093
023600                                                COMP SYNC.        02360093
023700     05  PV-REC-IND                   PIC S9(4) VALUE ZERO        02370093
023800                                                COMP SYNC.        02380093
023900     05  PV-DISTRO-IND                PIC S9(4) VALUE ZERO        02390093
024000                                                COMP SYNC.        02400093
024100     05  PV-EXPTED-IND                PIC S9(4) VALUE ZERO        02410093
024200                                                COMP SYNC.        02420093
024300     05  PV-VERIFIED-IND              PIC S9(4) VALUE ZERO        02430093
024400                                                COMP SYNC.        02440093
024500     05  PV-REC-ITEMS                 PIC S9(9) VALUE ZERO        02450093
024600                                                COMP SYNC.        02460093
024700     05  PV-SUM-EXPTED-QTY            PIC S9(9) VALUE ZERO        02470093
024800                                                COMP SYNC.        02480093
024900     05  PV-SUM-VERIFIED-QTY          PIC S9(9) VALUE ZERO        02490093
025000                                                COMP SYNC.        02500093
025100     05  PV-SUM-DISTRO-QTY            PIC S9(9) VALUE ZERO        02510093
025200                                                COMP SYNC.        02520093
025300     05  PV-SUM-STR-DISTRO-QTY        PIC S9(9) VALUE ZERO        02530093
025400                                                COMP SYNC.        02540093
025500     05  PV-OPEN-TO-REC               PIC S9(7) COMP-3            02550093
025600                                                VALUE ZERO.       02560093
025700     05  PV-OPEN-TO-REC-X             PIC X(5).                   02570093
025800     05  WS-PUBLISH-MESSAGE.                                      02580093
025900         10  FILLER                   PIC X(9)  VALUE 'RCKCS245 '.02590093
026000         10  WS-PUBLISH-PO            PIC 9(8)  VALUE 0.          02600093
026100         10  FILLER                   PIC X(14) VALUE             02610093
026200             'PSLPCK        '.                                    02620093
026300         10  FILLER                   PIC X(20) VALUE             02630093
026400             'PACKSLIP PACK RECPT '.                              02640093
026500         10  WS-PUBLISH-SKU           PIC 9(8)  VALUE 0.          02650093
026600     05  PV-STATUS-CDE                PIC X(02) VALUE SPACES.     02660093
026700         88  PV-VALID-STATUS-CDE                VALUES 'AP', 'AC'.02670093
026800     05  PV-PKGNG-CDE                 PIC X(01) VALUE SPACES.     02680093
026900     05  PV-SKU.                                                  02690093
027000         10  PV-CLASS-NBR             PIC X(02) VALUE SPACES.     02700093
027100         10  PV-SKU-SEQ-NBR           PIC X(08) VALUE SPACES.     02710093
027200     05  PV-NUMBER-OF-RV-ITEMS        PIC S9(2) VALUE ZERO.       02720093
027300                                                                  02730093
027400 01  LQW-LIST-QUEUE-WORK-AREA.                                    02740093
027500     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02750093
027600     05  LQW-ITEM-ENTRIES             OCCURS 6 TIMES              02760093
027700                                      INDEXED BY LQW-IDX.         02770093
027800         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02780093
027900         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02790093
028000         10  LQW-SELECTED-SW          PIC X(01).                  02800093
028100             88  LQW-SELECT                      VALUE 'S'.       02810093
028200             88  LQW-DESELECT                    VALUE ' '.       02820093
028300         10  LQW-PKSL-ITM-QTY         PIC 9(06).                  02830093
028400         10  LQW-PKSL-LNE-NBR         PIC 9(04).                  02840093
028500         10  LQW-VEND-STYL-NAME       PIC X(20).                  02850093
028600         10  LQW-COLOR-DESC           PIC X(25).                  02860093
028700         10  LQW-OPEN-TO-REC          PIC X(06).                  02870093
028800         10  LQW-OTR-QTY              PIC 9(6).                   02880093
028900         10  LQW-UNT-COST-AMT         PIC 9(4)V9(3).              02890093
029000         10  LQW-VEND-DESC            PIC X(20).                  02900093
029100         10  LQW-SIZE-DESC            PIC X(25).                  02910093
029200         10  LQW-CL-NBR               PIC X(02).                  02920093
029300         10  LQW-SKU-SEQ-NBR          PIC S9(8)V COMP-3.          02930093
029400         10  LQW-STATUS               PIC X(2).                   02940093
029500         10  LQW-PURITM-VER-NBR       PIC S9(9)  COMP.            02950093
029600         10  LQW-PO-LNE-NBR           PIC 9(04).                  02960093
029700                                                                  02970093
029800******************************************************************02980093
029900*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02990093
030000******************************************************************03000093
030100     COPY RCWS013.                                                03010093
030200                                                                  03020093
030300******************************************************************03030093
030400*    LOGISTICS DOMAIN ITEM ACCESS MODULE LAYOUT                   03040093
030500******************************************************************03050093
030600     COPY XLWS001.                                                03060093
030700                                                                  03070093
030800******************************************************************03080093
030900*    BMS MAP                                                      03090093
031000******************************************************************03100093
031100     COPY RCKM245.                                                03110093
031200                                                                  03120093
031300 01  MR-OCCURS-LAYOUT                 REDEFINES RC245AO.          03130093
031400** CHG0094517  CHANGED FILLER LENGTH FROM 164 TO 165              03140096
031500     05  FILLER                       PIC X(165).                 03150096
031600     05  MR-SCROLL-AREA               OCCURS 6 TIMES.             03160093
031700         10  MR-SELECTL               PIC S9(4) COMP.             03170093
031800         10  MR-SELECTA               PIC X.                      03180093
031900         10  MR-SELECTC               PIC X.                      03190093
032000         10  MR-SELECTH               PIC X.                      03200093
032100         10  MR-SELECTI               PIC X.                      03210093
032200                                                                  03220093
032300         10  MR-PKSL-ITM-QTY-L        PIC S9(4) COMP.             03230093
032400         10  MR-PKSL-ITM-QTY-A        PIC X.                      03240093
032500         10  MR-PKSL-ITM-QTY-C        PIC X.                      03250093
032600         10  MR-PKSL-ITM-QTY-H        PIC X.                      03260093
032700         10  MR-PKSL-ITM-QTY.                                     03270093
032800             15  MR-PKSL-ITM-QTY-EDITED                           03280093
032900                                      PIC ZZZZZZ.                 03290093
033000                                                                  03300093
033100         10  MR-LINE-L                PIC S9(4) COMP.             03310093
033200         10  MR-LINE-A                PIC X.                      03320093
033300         10  MR-LINE-C                PIC X.                      03330093
033400         10  MR-LINE-H                PIC X.                      03340093
033500         10  MR-LINE                  PIC X(04).                  03350093
033600                                                                  03360093
033700         10  MR-VEND-STYL-NAME-L      PIC S9(4) COMP.             03370093
033800         10  MR-VEND-STYL-NAME-A      PIC X.                      03380093
033900         10  MR-VEND-STYL-NAME-C      PIC X.                      03390093
034000         10  MR-VEND-STYL-NAME-H      PIC X.                      03400093
034100         10  MR-VEND-STYL-NAME        PIC X(20).                  03410093
034200                                                                  03420093
034300         10  MR-COLOR-DESC-L          PIC S9(4) COMP.             03430093
034400         10  MR-COLOR-DESC-A          PIC X.                      03440093
034500         10  MR-COLOR-DESC-C          PIC X.                      03450093
034600         10  MR-COLOR-DESC-H          PIC X.                      03460093
034700         10  MR-COLOR-DESC            PIC X(25).                  03470093
034800                                                                  03480093
034900         10  MR-OTR-L                 PIC S9(4) COMP.             03490093
035000         10  MR-OTR-A                 PIC X.                      03500093
035100         10  MR-OTR-C                 PIC X.                      03510093
035200         10  MR-OTR-H                 PIC X.                      03520093
035300         10  MR-OTR                   PIC X(6).                   03530093
035400                                                                  03540093
035500         10  MR-UNT-COST-AMT-L        PIC S9(4) COMP.             03550093
035600         10  MR-UNT-COST-AMT-A        PIC X.                      03560093
035700         10  MR-UNT-COST-AMT-C        PIC X.                      03570093
035800         10  MR-UNT-COST-AMT-H        PIC X.                      03580093
035900         10  MR-UNT-COST-AMT.                                     03590093
036000             15  MR-UNT-COST-AMT-EDITED                           03600093
036100                                      PIC ZZ,ZZZ.999.             03610093
036200                                                                  03620093
036300         10  MR-VEND-DESC-L           PIC S9(4) COMP.             03630093
036400         10  MR-VEND-DESC-A           PIC X.                      03640093
036500         10  MR-VEND-DESC-C           PIC X.                      03650093
036600         10  MR-VEND-DESC-H           PIC X.                      03660093
036700         10  MR-VEND-DESC             PIC X(20).                  03670093
036800                                                                  03680093
036900         10  MR-SIZE-DESC-L           PIC S9(4) COMP.             03690093
037000         10  MR-SIZE-DESC-A           PIC X.                      03700093
037100         10  MR-SIZE-DESC-C           PIC X.                      03710093
037200         10  MR-SIZE-DESC-H           PIC X.                      03720093
037300         10  MR-SIZE-DESC             PIC X(25).                  03730093
037400                                                                  03740093
037500         10  MR-CL-NBR-L              PIC S9(4) COMP.             03750093
037600         10  MR-CL-NBR-A              PIC X.                      03760093
037700         10  MR-CL-NBR-C              PIC X.                      03770093
037800         10  MR-CL-NBR-H              PIC X.                      03780093
037900         10  MR-CL-NBR                PIC X(02).                  03790093
038000                                                                  03800093
038100         10  MR-SKU-SEQ-NBR-L         PIC S9(4) COMP.             03810093
038200         10  MR-SKU-SEQ-NBR-A         PIC X.                      03820093
038300         10  MR-SKU-SEQ-NBR-C         PIC X.                      03830093
038400         10  MR-SKU-SEQ-NBR-H         PIC X.                      03840093
038500         10  MR-SKU-SEQ-NBR.                                      03850093
038600             15  MR-SKU-SEQ-NBR-EDITED                            03860093
038700                                      PIC 9(8).                   03870093
038800                                                                  03880093
038900         10  MR-STATUS-L              PIC S9(4) COMP.             03890093
039000         10  MR-STATUS-A              PIC X.                      03900093
039100         10  MR-STATUS-C              PIC X.                      03910093
039200         10  MR-STATUS-H              PIC X.                      03920093
039300         10  MR-STATUS                PIC X(2).                   03930093
039400                                                                  03940093
039500******************************************************************03950093
039600*    BMS ATTRIBUTES                                               03960093
039700******************************************************************03970093
039800     COPY DPWS015.                                                03980093
039900                                                                  03990093
040000******************************************************************04000093
040100*    FUNCTION KEYS                                                04010093
040200******************************************************************04020093
040300     COPY DPWS016.                                                04030093
040400                                                                  04040093
040500******************************************************************04050093
040600*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   04060093
040700******************************************************************04070093
040800     COPY DPWS010I.                                               04080093
040900                                                                  04090093
041000******************************************************************04100093
041100*    PARAMETER LIST FOR CICS API                                  04110093
041200******************************************************************04120093
041300     COPY DPWS030.                                                04130093
041310     COPY DPWS930.                                                04131098
041400                                                                  04140093
041500******************************************************************04150093
041600*    GLOBAL COMMUNICATION AREA                                    04160093
041700******************************************************************04170093
041800     COPY DPWS020.                                                04180093
041900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04190093
042000                                                                  04200093
042100******************************************************************04210093
042200*    INTER-APPLICATION COMMUNICATION AREA                         04220093
042300*    RCWS015 = INPUT FROM PACK SLIP HEADER MAINTENANCE PROGRAM    04230093
042400******************************************************************04240093
042500         10  INTER-APPL-COMM-AREA       PIC X(200).               04250093
042600     COPY RCWS015.                                                04260093
042700                                                                  04270093
042800******************************************************************04280093
042900*    APPLICATION SPECIFIC COMMUNICATION AREA                      04290093
043000******************************************************************04300093
043100         10  ASC-SPECIFIC-COMMAREA.                               04310093
043200             15  ASC-LIST-HEADER-INFO.                            04320093
043300                 20  ASC-KEY-SEARCH-STYLE       PIC X(20).        04330093
043400                 20  ASC-KEY-SEARCH-SIZE        PIC X(20).        04340093
043500                 20  ASC-KEY-SEARCH-COLOR       PIC X(20).        04350093
043600                 20  ASC-KEY-SEARCH-SKU         PIC X(10).        04360093
043700                 20  ASC-KEY-SEARCH-COST.                         04370093
043800                     25  ASC-KEY-SEARCH-COST-N  PIC 9(4)V999.     04380093
043900                 20  ASC-KEY-SEARCH-DESC        PIC X(20).        04390093
044000** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  04400095
044100                 20  ASC-KEY-PO-NBR.                              04410095
044200                     25  ASC-KEY-PO-NBR-N       PIC 9(08).        04420095
044300                 20  ASC-KEY-PKSL-NBR           PIC X(10).        04430093
044400                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        04440093
044500                 20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   04450093
044600                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   04460093
044700                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   04470093
044800                 20  ASC-KEY-STR-NBR            PIC S9(4) COMP.   04480093
044900                 20  ASC-KEY-REC-SEQ-NBR        PIC S9(9) COMP.   04490093
045000             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               04500093
045100                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       04510093
045200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04520093
045300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04530093
045400                                                                  04540093
045500                 20  ASC-ITEM-ARRAY.                              04550093
045600                     25  ASC-ITEM-ENTRIES  OCCURS 6 TIMES.        04560093
045700                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    04570093
045800                                                     COMP-3.      04580093
045900                         30  ASC-TEMP-SELECTED-SW    PIC X.       04590093
046000                             88  ASC-VALID-SELECT    VALUE ' '    04600093
046100                                                           'S'    04610093
046200                                                           'B'    04620093
046300                                                           'E'.   04630093
046400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04640093
046500                             88  ASC-TEMP-SELECT     VALUE 'S'.   04650093
046600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04660093
046700                             88  ASC-TEMP-END        VALUE 'E'.   04670093
046800                         30  ASC-SELECTED-SW         PIC  X.      04680093
046900                             88  ASC-NO-SELECT       VALUE ' '.   04690093
047000                             88  ASC-SELECT          VALUE 'S'.   04700093
047100                             88  ASC-BEGIN           VALUE 'B'.   04710093
047200                             88  ASC-END             VALUE 'E'.   04720093
047300                         30  ASC-PKSL-ITM-QTY.                    04730093
047400                             35  ASC-PKSL-ITM-QTY-N  PIC 9(06).   04740093
047500                         30  ASC-PKSL-LNE-NBR.                    04750093
047600                             35  ASC-PKSL-LNE-NBR-N  PIC 9(04).   04760093
047700                         30  ASC-VEND-STYL-NAME      PIC X(20).   04770093
047800                         30  ASC-COLOR-DESC          PIC X(25).   04780093
047900                         30  ASC-OPEN-TO-REC         PIC X(6).    04790093
048000                         30  ASC-OTR-QTY             PIC 9(6).    04800093
048100                         30  ASC-UNT-COST-AMT.                    04810093
048200                             35  ASC-UNT-COST-AMT-N PIC 9(4)V9(3).04820093
048300                         30  ASC-VEND-DESC           PIC X(20).   04830093
048400                         30  ASC-SIZE-DESC           PIC X(25).   04840093
048500                         30  ASC-CL-NBR              PIC X(02).   04850093
048600                         30  ASC-SKU-SEQ-NBR.                     04860093
048700                             35  ASC-SKU-SEQ-NBR-N   PIC S9(8)V   04870093
048800                                                     COMP-3.      04880093
048900                         30  ASC-PURITM-STATUS       PIC X(02).   04890093
049000                         30  ASC-PURITM-VER-NBR      PIC S9(9)    04900093
049100                                                     COMP.        04910093
049200                         30  ASC-PO-LNE-NBR.                      04920093
049300                             35  ASC-PO-LNE-NBR-N    PIC 9(04).   04930093
049400                                                                  04940093
049500             15  ASC-BLK-SUB                         PIC S9(4)    04950093
049600                                                     COMP SYNC.   04960093
049700             15  ASC-ITEM-SUB                        PIC S9(4)    04970093
049800                                                     COMP SYNC.   04980093
049900             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    04990093
050000                                                     COMP-3.      05000093
050100             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    05010093
050200                                                     COMP-3.      05020093
050300             15  ASC-ITEMS-DISPLAYED                 PIC S999     05030093
050400                                                     COMP-3.      05040093
050500             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    05050093
050600                                                     COMP-3.      05060093
050700             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    05070093
050800                                                     COMP-3.      05080093
050900             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    05090093
051000                                                     COMP SYNC.   05100093
051100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    05110093
051200                                                     COMP-3.      05120093
051300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    05130093
051400                                                     COMP-3.      05140093
051500             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       05150093
051600                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05160093
051700                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05170093
051800             15  ASC-LIST-QUEUE-NAME.                             05180093
051900                 20  ASC-LIST-TERM-ID                PIC X(4).    05190093
052000                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    05200093
052100                                                     COMP-3.      05210093
052200                 20  ASC-LIST-SEQ                    PIC 9.       05220093
052300             15  ASC-SEL-QUEUE-NAME.                              05230093
052400                 20  ASC-SEL-TERM-ID                 PIC X(4).    05240093
052500                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    05250093
052600                                                     COMP-3.      05260093
052700                 20  ASC-SEL-SEQ                     PIC 9.       05270093
052800             15  ASC-START-ITEM-REQUEST.                          05280093
052900                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    05290093
053000             15  ASC-PO-ITEMS-SW                     PIC X.       05300093
053100                 88  ASC-MORE-PO-ITEMS               VALUE 'Y'.   05310093
053200                 88  ASC-NO-MORE-PO-ITEMS            VALUE 'N'.   05320093
053300             15  ASC-HOLD-INTER-APPL                 PIC X(200).  05330093
053400                                                                  05340093
053500******************************************************************05350093
053600*    ABEND PROCESSING                                             05360093
053700******************************************************************05370093
053800     COPY DPWS013.                                                05380093
053900                                                                  05390093
054000******************************************************************05400093
054100*    DB2 SQL COMMUNICATION AREA                                   05410093
054200******************************************************************05420093
054300     EXEC SQL                                                     05430093
054400          INCLUDE SQLCA                                           05440093
054500     END-EXEC.                                                    05450093
054600                                                                  05460093
054700******************************************************************05470093
054800*    DB2 DCLGEN FOR PACK SLIP TABLE                               05480093
054900******************************************************************05490093
055000     EXEC SQL                                                     05500093
055100          INCLUDE TPKSLIP                                         05510093
055200     END-EXEC.                                                    05520093
055300                                                                  05530093
055400******************************************************************05540093
055500*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          05550093
055600******************************************************************05560093
055700     EXEC SQL                                                     05570093
055800          INCLUDE TPKITEM                                         05580093
055900     END-EXEC.                                                    05590093
056000                                                                  05600093
056100******************************************************************05610093
056200*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          05620093
056300******************************************************************05630093
056400     EXEC SQL                                                     05640093
056500          INCLUDE TPURCHS                                         05650093
056600     END-EXEC.                                                    05660093
056700                                                                  05670093
056800******************************************************************05680093
056900*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     05690093
057000******************************************************************05700093
057100     EXEC SQL                                                     05710093
057200          INCLUDE TPURITM                                         05720093
057300     END-EXEC.                                                    05730093
057400                                                                  05740093
057500******************************************************************05750093
057600*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  05760093
057700******************************************************************05770093
057800     EXEC SQL                                                     05780093
057900          INCLUDE TENTNME                                         05790093
058000     END-EXEC.                                                    05800093
058100                                                                  05810093
058200******************************************************************05820093
058300*    DB2 DCLGEN WFT_LOD_CNTL                                      05830093
058400******************************************************************05840093
058500     EXEC SQL                                                     05850093
058600          INCLUDE WFT00001                                        05860093
058700     END-EXEC.                                                    05870093
058800                                                                  05880093
058900******************************************************************05890093
059000*    DB2 DCLGEN WFT_LOD_XFER                                      05900093
059100******************************************************************05910093
059200     EXEC SQL                                                     05920093
059300          INCLUDE WFT00002                                        05930093
059400     END-EXEC.                                                    05940093
059500                                                                  05950093
059600******************************************************************05960093
059700*    DB2 DCLGEN TPOPRPK                                           05970093
059800******************************************************************05980093
059900     EXEC SQL                                                     05990093
060000          INCLUDE TPOPRPK                                         06000093
060100     END-EXEC.                                                    06010093
060200                                                                  06020093
060300******************************************************************06030093
060400*    DB2 DCLGEN XLV00000 (XLT_SKU)                                06040093
060500******************************************************************06050093
060600     EXEC SQL                                                     06060093
060700          INCLUDE XLV00000                                        06070093
060800     END-EXEC.                                                    06080093
060900                                                                  06090093
061000******************************************************************06100093
061100*    DB2 DCLGEN XLV00001 (XLT_VND_STYL)                           06110093
061200******************************************************************06120093
061300     EXEC SQL                                                     06130093
061400          INCLUDE XLV00001                                        06140093
061500     END-EXEC.                                                    06150093
061600                                                                  06160093
061700******************************************************************06170093
061800*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  06180093
061900*    IN VEND-STYLE, COLOR, SIZE ORDER                             06190093
062000******************************************************************06200093
062100     EXEC SQL                                                     06210093
062200          DECLARE STYL-CLR-SIZ-CSR CURSOR FOR                     06220093
062300           SELECT PO_NBR,                                         06230093
062400                  VER_NBR,                                        06240093
062500                  PO_LNE_NBR,                                     06250093
062600                  SKU_SEQ_NBR,                                    06260093
062700                  VEND_STYL_NAME,                                 06270093
062800                  COLOR_DESC,                                     06280093
062900                  SIZE_DESC,                                      06290093
063000                  UNT_QTY,                                        06300093
063100                  UNT_COST_AMT,                                   06310093
063200                  ITM_NBR,                                        06320093
063300                  SKU_DESC,                                       06330093
063400                  APP_PO_LNE_NBR,                                 06340093
063500                  STATUS_CDE,                                     06350093
063600*CLP 06/27/14 - START                                             06360093
063700                  PO_PREPK_ID                                     06370094
063800*CLP 06/27/14 - END                                               06380093
063900             FROM TPURITM                                         06390093
064000            WHERE PO_NBR         = :DK-PO-NBR                     06400093
064100              AND VER_STATUS_CDE = :PC-ACTIVE                     06410093
064200              AND STATUS_CDE IN (:PC-STAT-1 ,                     06420093
064300                                 :PC-STAT-2 ,                     06430093
064400                                 :PC-STAT-3 ,                     06440093
064500                                 :PC-STAT-4 ,                     06450093
064600                                 :PC-STAT-5 ,                     06460093
064700                                 :PC-STAT-6 )                     06470093
064800         ORDER BY VEND_STYL_NAME,                                 06480093
064900                  COLOR_DESC,                                     06490093
065000                  SIZE_DESC                                       06500093
065100     END-EXEC.                                                    06510093
065200                                                                  06520093
065300******************************************************************06530093
065400*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  06540093
065500*    IN VEND-STYLE, SIZE, COLOR ORDER                             06550093
065600******************************************************************06560093
065700     EXEC SQL                                                     06570093
065800          DECLARE STYL-SIZ-CLR-CSR CURSOR FOR                     06580093
065900           SELECT PO_NBR,                                         06590093
066000                  VER_NBR,                                        06600093
066100                  PO_LNE_NBR,                                     06610093
066200                  SKU_SEQ_NBR,                                    06620093
066300                  VEND_STYL_NAME,                                 06630093
066400                  COLOR_DESC,                                     06640093
066500                  SIZE_DESC,                                      06650093
066600                  UNT_QTY,                                        06660093
066700                  UNT_COST_AMT,                                   06670093
066800                  ITM_NBR,                                        06680093
066900                  SKU_DESC,                                       06690093
067000                  APP_PO_LNE_NBR,                                 06700093
067100                 STATUS_CDE                                       06710093
067200*CLP 06/27/14 - START                                             06720093
067300              ,   PO_PREPK_ID                                     06730094
067400*CLP 06/27/14 - END                                               06740093
067500             FROM TPURITM                                         06750093
067600            WHERE PO_NBR         = :DK-PO-NBR                     06760093
067700              AND VER_STATUS_CDE = :PC-ACTIVE                     06770093
067800              AND STATUS_CDE IN (:PC-STAT-1 ,                     06780093
067900                                 :PC-STAT-2 ,                     06790093
068000                                 :PC-STAT-3 ,                     06800093
068100                                 :PC-STAT-4 ,                     06810093
068200                                 :PC-STAT-5 ,                     06820093
068300                                 :PC-STAT-6 )                     06830093
068400         ORDER BY VEND_STYL_NAME,                                 06840093
068500                  SIZE_DESC,                                      06850093
068600                  COLOR_DESC                                      06860093
068700     END-EXEC.                                                    06870093
068800******************************************************************06880093
068900*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  06890093
069000*    IN ORDER BY COLOR_DESC, SIZE_DESC                            06900093
069100******************************************************************06910093
069200     EXEC SQL                                                     06920093
069300          DECLARE COLOR-SIZE-CSR CURSOR FOR                       06930093
069400           SELECT PO_NBR,                                         06940093
069500                  VER_NBR,                                        06950093
069600                  PO_LNE_NBR,                                     06960093
069700                  SKU_SEQ_NBR,                                    06970093
069800                  VEND_STYL_NAME,                                 06980093
069900                  COLOR_DESC,                                     06990093
070000                  SIZE_DESC,                                      07000093
070100                  UNT_QTY,                                        07010093
070200                  UNT_COST_AMT,                                   07020093
070300                  ITM_NBR,                                        07030093
070400                  SKU_DESC,                                       07040093
070500                  APP_PO_LNE_NBR,                                 07050093
070600                 STATUS_CDE                                       07060093
070700*CLP 06/27/14 - START                                             07070093
070800              ,   PO_PREPK_ID                                     07080094
070900*CLP 06/27/14 - END                                               07090093
071000             FROM TPURITM                                         07100093
071100            WHERE PO_NBR         = :DK-PO-NBR                     07110093
071200              AND VER_STATUS_CDE = :PC-ACTIVE                     07120093
071300              AND STATUS_CDE IN (:PC-STAT-1 ,                     07130093
071400                                 :PC-STAT-2 ,                     07140093
071500                                 :PC-STAT-3 ,                     07150093
071600                                 :PC-STAT-4 ,                     07160093
071700                                 :PC-STAT-5 ,                     07170093
071800                                 :PC-STAT-6 )                     07180093
071900         ORDER BY COLOR_DESC,                                     07190093
072000                  SIZE_DESC                                       07200093
072100     END-EXEC.                                                    07210093
072200******************************************************************07220093
072300*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  07230093
072400*    ORDERED BY SIZE_DESC, COLOR_DESC                             07240093
072500******************************************************************07250093
072600     EXEC SQL                                                     07260093
072700          DECLARE SIZE-COLOR-CSR CURSOR FOR                       07270093
072800           SELECT PO_NBR,                                         07280093
072900                  VER_NBR,                                        07290093
073000                  PO_LNE_NBR,                                     07300093
073100                  SKU_SEQ_NBR,                                    07310093
073200                  VEND_STYL_NAME,                                 07320093
073300                  COLOR_DESC,                                     07330093
073400                  SIZE_DESC,                                      07340093
073500                  UNT_QTY,                                        07350093
073600                  UNT_COST_AMT,                                   07360093
073700                  ITM_NBR,                                        07370093
073800                  SKU_DESC,                                       07380093
073900                  APP_PO_LNE_NBR,                                 07390093
074000                 STATUS_CDE                                       07400093
074100*CLP 06/27/14 - START                                             07410093
074200              ,   PO_PREPK_ID                                     07420094
074300*CLP 06/27/14 - END                                               07430093
074400             FROM TPURITM                                         07440093
074500            WHERE PO_NBR         = :DK-PO-NBR                     07450093
074600              AND VER_STATUS_CDE = :PC-ACTIVE                     07460093
074700              AND STATUS_CDE IN (:PC-STAT-1 ,                     07470093
074800                                 :PC-STAT-2 ,                     07480093
074900                                 :PC-STAT-3 ,                     07490093
075000                                 :PC-STAT-4 ,                     07500093
075100                                 :PC-STAT-5 ,                     07510093
075200                                 :PC-STAT-6 )                     07520093
075300         ORDER BY SIZE_DESC,                                      07530093
075400                  COLOR_DESC                                      07540093
075500     END-EXEC.                                                    07550093
075600******************************************************************07560093
075700*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  07570093
075800*    ORDERED BY CL_NBR, SKU_NBR, COLOR_DESC                       07580093
075900******************************************************************07590093
076000     EXEC SQL                                                     07600093
076100          DECLARE SKU-COLOR-CSR CURSOR FOR                        07610093
076200           SELECT PO_NBR,                                         07620093
076300                  VER_NBR,                                        07630093
076400                  PO_LNE_NBR,                                     07640093
076500                  SKU_SEQ_NBR,                                    07650093
076600                  VEND_STYL_NAME,                                 07660093
076700                  COLOR_DESC,                                     07670093
076800                  A.SIZE_DESC,                                    07680093
076900                  UNT_QTY,                                        07690093
077000                  UNT_COST_AMT,                                   07700093
077100                  A.ITM_NBR,                                      07710093
077200                  A.SKU_DESC,                                     07720093
077300                  APP_PO_LNE_NBR,                                 07730093
077400                  STATUS_CDE,                                     07740093
077500                  SUB_CL_NBR,                                     07750093
077600*CLP 06/27/14 - START                                             07760093
077700                  PO_PREPK_ID                                     07770094
077800*CLP 06/27/14 - END                                               07780093
077900             FROM TPURITM A,                                      07790093
078000                  XLV_SKU B,                                      07800093
078100                  XLV_VND_STYL C                                  07810093
078200            WHERE PO_NBR         = :DK-PO-NBR                     07820093
078300              AND VER_STATUS_CDE = :PC-ACTIVE                     07830093
078400              AND STATUS_CDE IN (:PC-STAT-1 ,                     07840093
078500                                 :PC-STAT-2 ,                     07850093
078600                                 :PC-STAT-3 ,                     07860093
078700                                 :PC-STAT-4 ,                     07870093
078800                                 :PC-STAT-5 ,                     07880093
078900                                 :PC-STAT-6 )                     07890093
079000              AND A.ITM_NBR = B.ITM_NBR                           07900093
079100              AND B.STYL_ID = C.STYL_ID                           07910093
079200         ORDER BY SUB_CL_NBR,                                     07920093
079300                  SKU_SEQ_NBR,                                    07930093
079400                  COLOR_DESC                                      07940093
079500     END-EXEC.                                                    07950093
079600******************************************************************07960093
079700*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  07970093
079800*    ORDERED BY UNT_COST_AMT, SKU_DESC                            07980093
079900******************************************************************07990093
080000     EXEC SQL                                                     08000093
080100          DECLARE COST-DESC-CSR CURSOR FOR                        08010093
080200           SELECT PO_NBR,                                         08020093
080300                  VER_NBR,                                        08030093
080400                  PO_LNE_NBR,                                     08040093
080500                  SKU_SEQ_NBR,                                    08050093
080600                  VEND_STYL_NAME,                                 08060093
080700                  COLOR_DESC,                                     08070093
080800                  SIZE_DESC,                                      08080093
080900                  UNT_QTY,                                        08090093
081000                  UNT_COST_AMT,                                   08100093
081100                  ITM_NBR,                                        08110093
081200                  SKU_DESC,                                       08120093
081300                  APP_PO_LNE_NBR,                                 08130093
081400                 STATUS_CDE                                       08140093
081500*CLP 06/27/14 - START                                             08150093
081600              ,   PO_PREPK_ID                                     08160094
081700*CLP 06/27/14 - END                                               08170093
081800             FROM TPURITM                                         08180093
081900            WHERE PO_NBR         = :DK-PO-NBR                     08190093
082000              AND VER_STATUS_CDE = :PC-ACTIVE                     08200093
082100              AND STATUS_CDE IN (:PC-STAT-1 ,                     08210093
082200                                 :PC-STAT-2 ,                     08220093
082300                                 :PC-STAT-3 ,                     08230093
082400                                 :PC-STAT-4 ,                     08240093
082500                                 :PC-STAT-5 ,                     08250093
082600                                 :PC-STAT-6 )                     08260093
082700         ORDER BY UNT_COST_AMT,                                   08270093
082800                  SKU_DESC,                                       08280093
082900                  APP_PO_LNE_NBR                                  08290093
083000     END-EXEC.                                                    08300093
083100******************************************************************08310093
083200*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  08320093
083300*    ORDER BY DESC                                                08330093
083400******************************************************************08340093
083500     EXEC SQL                                                     08350093
083600          DECLARE PURITM-CURSOR CURSOR FOR                        08360093
083700           SELECT PO_NBR,                                         08370093
083800                  VER_NBR,                                        08380093
083900                  PO_LNE_NBR,                                     08390093
084000                  SKU_SEQ_NBR,                                    08400093
084100                  VEND_STYL_NAME,                                 08410093
084200                  COLOR_DESC,                                     08420093
084300                  SIZE_DESC,                                      08430093
084400                  UNT_QTY,                                        08440093
084500                  UNT_COST_AMT,                                   08450093
084600                  ITM_NBR,                                        08460093
084700                  SKU_DESC,                                       08470093
084800                  APP_PO_LNE_NBR,                                 08480093
084900                 STATUS_CDE                                       08490093
085000*CLP 06/27/14 - START                                             08500093
085100              ,   PO_PREPK_ID                                     08510094
085200*CLP 06/27/14 - END                                               08520093
085300             FROM TPURITM                                         08530093
085400            WHERE PO_NBR         = :DK-PO-NBR                     08540093
085500              AND VER_STATUS_CDE = :PC-ACTIVE                     08550093
085600              AND STATUS_CDE IN (:PC-STAT-1 ,                     08560093
085700                                 :PC-STAT-2 ,                     08570093
085800                                 :PC-STAT-3 ,                     08580093
085900                                 :PC-STAT-4 ,                     08590093
086000                                 :PC-STAT-5 ,                     08600093
086100                                 :PC-STAT-6 )                     08610093
086200         ORDER BY SKU_DESC, SIZE_DESC, COLOR_DESC                 08620093
086300     END-EXEC.                                                    08630093
086400                                                                  08640093
086500/                                                                 08650093
086600     COPY DPWS276.                                                08660093
086700                                                                  08670093
086800                                                                  08680093
086900 LINKAGE SECTION.                                                 08690093
087000                                                                  08700093
087100 01  DFHCOMMAREA.                                                 08710093
087200     05  FILLER                       OCCURS 1 TO 4072 TIMES      08720093
087300                                      DEPENDING ON EIBCALEN.      08730093
087400         10  FILLER                   PIC X.                      08740093
087500                                                                  08750093
087600                                                                  08760093
087700 PROCEDURE DIVISION.                                              08770093
087800                                                                  08780093
087900 0000-MAIN-MODULE.                                                08790093
088000                                                                  08800093
088100     INITIALIZE DP030-CICS-API-FIELDS.                            08810093
088200                                                                  08820093
088300     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         08830093
088400     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            08840093
088500     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           08850093
088600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         08860093
088700     MOVE LENGTH OF RC245AI      TO DP030-MAP-LENGTH (1).         08870093
088800     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       08880093
088900     SET DP030-OVERRIDE-APPL-ERROR                                08890093
089000                                 TO TRUE.                         08900093
089100                                                                  08910093
089200     PERFORM 0001-CALL-CICS-ARCH-API.                             08920093
089300                                                                  08930093
089400     PERFORM 1000-CONTROL-PROCESSING.                             08940093
089500                                                                  08950093
089600     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       08960093
089700                                                                  08970093
089800     PERFORM 0001-CALL-CICS-ARCH-API.                             08980093
089900                                                                  08990093
090000 0001-CALL-CICS-ARCH-API.                                         09000093
090100                                                                  09010093
090210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09021098
090300                                    DFHCOMMAREA                   09030098
090400                                    DP030-CICS-API-FIELDS         09040098
090500                                    DP020-STANDARD-COMMAREA       09050098
090600                                    RC245AI.                      09060098
090700                                                                  09070093
090800     IF DP030-RC-CALL-SUCCESSFUL OR                               09080093
090900        DP030-RC-APPL-ERROR                                       09090093
091000         CONTINUE                                                 09100093
091100     ELSE                                                         09110093
091200         SET DP013-CICS-ABEND                                     09120093
091300             DP013-NO-ROLLBACK                                    09130093
091400             DP013-XCTL-DISPLAY-RESTART                           09140093
091500                                 TO TRUE                          09150093
091600         MOVE '0001-CALL-CICS-ARCH-API'                           09160093
091700                                 TO DP013-PARAGRAPH               09170093
091720         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O09172098
091730-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09173098
092000         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        09200093
092100                                                                  09210093
092200         PERFORM DP013-0000-PROCESS-ABEND.                        09220093
092300                                                                  09230093
092400 1000-CONTROL-PROCESSING.                                         09240093
092500                                                                  09250093
092600     EVALUATE TRUE                                                09260093
092700                                                                  09270093
092800         WHEN DP030-RC-APPL-ERROR                                 09280093
092900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       09290093
093000                                 TO PV-TOP-ITEM                   09300093
093100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      09310093
093200                                                                  09320093
093300              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                09330093
093400                                                                  09340093
093500              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  09350093
093600                                                                  09360093
093700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09370093
093800                                                                  09380093
093900                                                                  09390093
094000         WHEN DP020-NEXT-ACT-INITIAL                              09400093
094100              INITIALIZE ASC-SPECIFIC-COMMAREA                    09410093
094200              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              09420093
094300                                    ASC-SEL-TERM-ID               09430093
094400              MOVE DP020-SRC-TASK-NUMBER                          09440093
094500                                 TO ASC-LIST-TASK-NUMBER          09450093
094600                                    ASC-SEL-TASK-NUMBER           09460093
094700              MOVE PC-LIST-QUEUE-SEQ                              09470093
094800                                 TO ASC-LIST-SEQ                  09480093
094900              MOVE PC-SEL-QUEUE-SEQ                               09490093
095000                                 TO ASC-SEL-SEQ                   09500093
095100              SET PS-NO-ERROR    TO TRUE                          09510093
095200                                                                  09520093
095300              PERFORM 1100-PROCESS-INTER-APPL-COMM                09530093
095400                                                                  09540093
095500              IF PS-NO-ERROR                                      09550093
095600                  MOVE INTER-APPL-COMM-AREA                       09560093
095700                                 TO ASC-HOLD-INTER-APPL           09570093
095800                  PERFORM 4000-BUILD-INITIAL-PANEL                09580093
095900              END-IF                                              09590093
096000                                                                  09600093
096100                                                                  09610093
096200         WHEN DP020-NEXT-ACT-READ-MAP                             09620093
096300              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       09630093
096400                                 TO PV-TOP-ITEM                   09640093
096500                                                                  09650093
096600              PERFORM 2000-PROCESS-PANEL                          09660093
096700                                                                  09670093
096800                                                                  09680093
096900         WHEN DP020-NEXT-ACT-RETURN                               09690093
097000              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       09700093
097100                                 TO PV-TOP-ITEM                   09710093
097200              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      09720093
097300              MOVE ASC-HOLD-INTER-APPL                            09730093
097400                                 TO INTER-APPL-COMM-AREA          09740093
097500                                                                  09750093
097600              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                09760093
097700                                                                  09770093
097800              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  09780093
097900                                                                  09790093
098000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09800093
098100                                                                  09810093
098200                                                                  09820093
098300         WHEN OTHER                                               09830093
098400              SET DP013-LOGIC-ABEND                               09840093
098500                  DP013-NO-ROLLBACK                               09850093
098600                                 TO TRUE                          09860093
098700              MOVE '1000-CONTROL-PROCESSING'                      09870093
098800                                 TO DP013-PARAGRAPH               09880093
098900              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   09890093
099000                                 TO DP013-MESSAGE-TEXT(1)         09900093
099100                                                                  09910093
099200              PERFORM DP013-0000-PROCESS-ABEND                    09920093
099300                                                                  09930093
099400     END-EVALUATE.                                                09940093
099500                                                                  09950093
099600 1100-PROCESS-INTER-APPL-COMM.                                    09960093
099700                                                                  09970093
099800     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       09980093
099900     MOVE RC015-PO-NBR           TO ASC-KEY-PO-NBR-N.             09990093
100000     MOVE RC015-PKSL-NBR         TO ASC-KEY-PKSL-NBR.             10000093
100100     MOVE RC015-SEQ-NBR          TO ASC-KEY-SEQ-NBR.              10010093
100200     MOVE RC015-OPER-UNT-ID      TO ASC-KEY-OPER-UNT-ID.          10020093
100300     MOVE RC015-FCLTY-ID         TO ASC-KEY-FCLTY-ID.             10030093
100400     MOVE RC015-STR-NBR          TO ASC-KEY-STR-NBR.              10040093
100500     MOVE RC015-REC-SEQ-NBR      TO ASC-KEY-REC-SEQ-NBR.          10050093
100600                                                                  10060093
100700 2000-PROCESS-PANEL.                                              10070093
100800                                                                  10080093
100900     EVALUATE TRUE                                                10090093
101000                                                                  10100093
101100         WHEN DP020-SRC-AID = DP016-CLEAR                         10110093
101200              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      10120093
101300                                                                  10130093
101400              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  10140093
101500                                                                  10150093
101600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10160093
101700                                                                  10170093
101800                                                                  10180093
101900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10190093
102000                                                                  10200093
102100              PERFORM 2050-DELETE-LIST-QUEUE                      10210093
102200                                                                  10220093
102300              PERFORM 4000-BUILD-INITIAL-PANEL                    10230093
102400                                                                  10240093
102500                                                                  10250093
102600         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   10260093
102700                                                                  10270093
102800              PERFORM 2140-DESELECT-ALL-ITEMS                     10280093
102900                                                                  10290093
103000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10300093
103100                                                                  10310093
103200                                                                  10320093
103300         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 10330093
103400                                                                  10340093
103500              PERFORM 2150-SELECT-ALL-ITEMS                       10350093
103600                                                                  10360093
103700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10370093
103800                                                                  10380093
103900                                                                  10390093
104000         WHEN OTHER                                               10400093
104100                                                                  10410093
104200              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                10420093
104300                                                                  10430093
104400              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  10440093
104500                                                                  10450093
104600              IF PS-NO-ERROR                                      10460093
104700                  SET DP030-CONTINUE-GO                           10470093
104800                                 TO TRUE                          10480093
104900                                                                  10490093
105000                  PERFORM 2100-CHECK-FUNCTION-KEY                 10500093
105100                                                                  10510093
105200              ELSE                                                10520093
105300                  SET DP030-OVERRIDE-GO                           10530093
105400                                 TO TRUE                          10540093
105500              END-IF                                              10550093
105600                                                                  10560093
105700     END-EVALUATE.                                                10570093
105800                                                                  10580093
105900 2050-DELETE-LIST-QUEUE.                                          10590093
106000                                                                  10600093
106100     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             10610093
106200                          RESP  (PV-CICS-RESP)                    10620093
106300                          END-EXEC.                               10630093
106400                                                                  10640093
106500     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      10650093
106600        (PV-CICS-RESP = DFHRESP (QIDERR))                         10660093
106700         CONTINUE                                                 10670093
106800     ELSE                                                         10680093
106900         SET DP013-CICS-ABEND                                     10690093
107000             DP013-NO-ROLLBACK   TO TRUE                          10700093
107100         MOVE '2050-DELETE-LIST-QUEUE'                            10710093
107200                                 TO DP013-PARAGRAPH               10720093
107300         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 10730093
107400                                 TO DP013-MESSAGE-TEXT (1)        10740093
107500                                                                  10750093
107600         PERFORM DP013-0000-PROCESS-ABEND                         10760093
107700     END-IF.                                                      10770093
107800                                                                  10780093
107900     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    10790093
108000                                                                  10800093
108100 2100-CHECK-FUNCTION-KEY.                                         10810093
108200                                                                  10820093
108300     EVALUATE TRUE                                                10830093
108400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 10840093
108500              IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10850093
108600                  INITIALIZE RC015-INTER-APPL-COMMAREA            10860093
108700                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               10870093
108800                                 TO RC015-NUMBER-OF-SELECTED-ITEMS10880093
108900                  MOVE ASC-KEY-PO-NBR-N                           10890093
109000                                 TO RC015-PO-NBR                  10900093
109100                  PERFORM 5000-PREPARE-SEL-QUEUE                  10910093
109200              ELSE                                                10920093
109300                  SET ASC-NO-TSQ-UPDATE                           10930093
109400                                 TO TRUE                          10940093
109500                  SET DP030-OVERRIDE-GO                           10950093
109600                      DP020-MSG-WARNING                           10960093
109700                                 TO TRUE                          10970093
109800                  MOVE PC-TSYMSG-00057                            10980093
109900                                 TO DP020-MSG-NUMBER              10990093
110000              END-IF                                              11000093
110100                                                                  11010093
110200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11020093
110300              IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11030093
110400                  INITIALIZE RC015-INTER-APPL-COMMAREA            11040093
110500                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               11050093
110600                                 TO RC015-NUMBER-OF-SELECTED-ITEMS11060093
110700                  MOVE ASC-KEY-PO-NBR-N                           11070093
110800                                 TO RC015-PO-NBR                  11080093
110900                  MOVE ASC-KEY-PKSL-NBR                           11090093
111000                                 TO RC015-PKSL-NBR                11100093
111100                  PERFORM 5000-PREPARE-SEL-QUEUE                  11110093
111200              ELSE                                                11120093
111300                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          11130093
111400                      SET ASC-NO-TSQ-UPDATE                       11140093
111500                                 TO TRUE                          11150093
111600                      SET DP030-OVERRIDE-GO                       11160093
111700                          DP020-MSG-WARNING                       11170093
111800                                 TO TRUE                          11180093
111900                      MOVE PC-TSYMSG-00057                        11190093
112000                                 TO DP020-MSG-NUMBER              11200093
112100                  END-IF                                          11210093
112200              END-IF                                              11220093
112300                                                                  11230093
112400         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 11240093
112500             MOVE +1             TO PV-TOP-ITEM                   11250093
112600                                                                  11260093
112700             PERFORM 3200-RESET-ATTRIBUTES                        11270093
112800                                                                  11280093
112900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11290093
113000                                                                  11300093
113100                                                                  11310093
113200         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  11320093
113300                                                                  11330093
113400             PERFORM 2110-BROWSE-BACKWARD                         11340093
113500                                                                  11350093
113600             PERFORM 3200-RESET-ATTRIBUTES                        11360093
113700                                                                  11370093
113800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11380093
113900                                                                  11390093
114000                                                                  11400093
114100         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  11410093
114200                                                                  11420093
114300             PERFORM 2120-BROWSE-FORWARD                          11430093
114400                                                                  11440093
114500             PERFORM 3200-RESET-ATTRIBUTES                        11450093
114600                                                                  11460093
114700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11470093
114800                                                                  11480093
114900                                                                  11490093
115000         WHEN DP020-SRC-AID = DP016-ENTER                         11500093
115100                                                                  11510093
115200             PERFORM 2450-CHECK-FOR-JUMP-BROWSE                   11520093
115300                                                                  11530093
115400             IF PS-NO-ERROR                                       11540093
115500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11550093
115600             END-IF                                               11560093
115700                                                                  11570093
115800                                                                  11580093
115900         WHEN OTHER                                               11590093
116000             SET DP013-CICS-ABEND                                 11600093
116100                 DP013-NO-ROLLBACK                                11610093
116200                 DP013-XCTL-DISPLAY-RESTART                       11620093
116300                                 TO TRUE                          11630093
116400             MOVE '2100-CHECK-FUNCTION-KEY'                       11640093
116500                                 TO DP013-PARAGRAPH               11650093
116600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11660093
116700                                 TO DP013-MESSAGE-TEXT (1)        11670093
116800                                                                  11680093
116900             PERFORM DP013-0000-PROCESS-ABEND                     11690093
117000     END-EVALUATE.                                                11700093
117100                                                                  11710093
117200 2110-BROWSE-BACKWARD.                                            11720093
117300                                                                  11730093
117400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11740093
117500         GIVING PV-TOP-ITEM.                                      11750093
117600                                                                  11760093
117700     IF PV-TOP-ITEM NOT > +1                                      11770093
117800         MOVE +1                 TO PV-TOP-ITEM                   11780093
117900         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              11790093
118000         SET DP020-MSG-INFORMATIONAL                              11800093
118100                                 TO TRUE.                         11810093
118200                                                                  11820093
118300 2120-BROWSE-FORWARD.                                             11830093
118400                                                                  11840093
118500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11850093
118600         GIVING PV-TOP-ITEM.                                      11860093
118700                                                                  11870093
118800     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    11880093
118900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11890093
119000                                 TO PV-TOP-ITEM                   11900093
119100         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              11910093
119200         SET DP020-MSG-INFORMATIONAL                              11920093
119300                                 TO TRUE                          11930093
119400     ELSE                                                         11940093
119500         COMPUTE PV-BOTTOM-ITEM =                                 11950093
119600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11960093
119700         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             11970093
119800             MOVE PC-TSYMSG-00070                                 11980093
119900                                 TO DP020-MSG-NUMBER              11990093
120000             SET DP020-MSG-INFORMATIONAL                          12000093
120100                                 TO TRUE.                         12010093
120200                                                                  12020093
120300 2450-CHECK-FOR-JUMP-BROWSE.                                      12030093
120400                                                                  12040093
120500     SET PS-NO-ERROR             TO TRUE.                         12050093
120600                                                                  12060093
120700     IF ASC-KEY-SEARCH-STYLE > SPACES                             12070093
120800         PERFORM 2300-CHECK-FOR-SEARCH-STYLE                      12080093
120900     END-IF.                                                      12090093
121000                                                                  12100093
121100     IF ASC-KEY-SEARCH-COLOR > SPACES                             12110093
121200         PERFORM 2300-CHECK-FOR-SEARCH-COLOR                      12120093
121300     END-IF.                                                      12130093
121400                                                                  12140093
121500     IF ASC-KEY-SEARCH-SIZE > SPACES                              12150093
121600         PERFORM 2300-CHECK-FOR-SEARCH-SIZE                       12160093
121700     END-IF.                                                      12170093
121800                                                                  12180093
121900     IF ASC-KEY-SEARCH-SKU > SPACES                               12190093
122000         PERFORM 2300-CHECK-FOR-SEARCH-SKU                        12200093
122100     END-IF.                                                      12210093
122200                                                                  12220093
122300     IF ASC-KEY-SEARCH-COST > ZERO                                12230093
122400         PERFORM 2300-CHECK-FOR-SEARCH-COST                       12240093
122500     END-IF.                                                      12250093
122600                                                                  12260093
122700     IF ASC-KEY-SEARCH-DESC > SPACES                              12270093
122800         PERFORM 2300-CHECK-FOR-SEARCH-DESC                       12280093
122900     END-IF.                                                      12290093
123000                                                                  12300093
123100     IF ASC-START-ITEM-REQUEST = SPACE                            12310093
123200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12320093
123300                                 TO PV-TOP-ITEM                   12330093
123400     ELSE                                                         12340093
123500         MOVE ASC-START-ITEM-REQUEST                              12350093
123600                                 TO DP010I-UNEDITED-FIELD         12360093
123700         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         12370093
123800         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       12380093
123900         SET DP010I-NEGATIVE-NOT-ALLOWED                          12390093
124000                                 TO TRUE                          12400093
124100                                                                  12410093
124210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12421097
124220              USING DP010I-NUMERIC-EDIT-AREA                      12422097
124300                                                                  12430093
124400         IF NOT DP010I-ERROR-DETECTED                             12440093
124500             MOVE DP010I-NUMERIC-FIELD                            12450093
124600                                 TO ASC-START-ITEM-REQUEST-N      12460093
124700             IF ASC-START-ITEM-REQUEST-N > ZERO                   12470093
124800                IF ASC-START-ITEM-REQUEST-N >                     12480093
124900                                          ASC-NUMBER-OF-ITEMS-READ12490093
125000                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        12500093
125100                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ12510093
125200                                          - PC-ITEMS-PER-PANEL + 112520093
125300                    IF PV-TOP-ITEM < +1                           12530093
125400                        MOVE +1  TO PV-TOP-ITEM                   12540093
125500                        MOVE PC-TSYMSG-00070                      12550093
125600                                 TO DP020-MSG-NUMBER              12560093
125700                        SET DP020-MSG-INFORMATIONAL               12570093
125800                                 TO TRUE                          12580093
125900                    END-IF                                        12590093
126000                ELSE                                              12600093
126100                    MOVE ASC-START-ITEM-REQUEST-N                 12610093
126200                                 TO PV-TOP-ITEM                   12620093
126300                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        12630093
126400                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        12640093
126500                                            PC-ITEMS-PER-PANEL - 112650093
126600                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  12660093
126700                         MOVE PC-TSYMSG-00070                     12670093
126800                                 TO DP020-MSG-NUMBER              12680093
126900                         SET DP020-MSG-INFORMATIONAL              12690093
127000                                 TO TRUE                          12700093
127100                    END-IF                                        12710093
127200                END-IF                                            12720093
127300             ELSE                                                 12730093
127400                 MOVE PC-TSYMSG-00101                             12740093
127500                                 TO DP020-MSG-NUMBER              12750093
127600                 SET DP030-SET-CURSOR-APPL-1                      12760093
127700                                 TO TRUE                          12770093
127800                 MOVE -1         TO ASTRTITL                      12780093
127900                 MOVE DP015-UNP-NUM-BRT-MDT                       12790093
128000                                 TO ASTRTITA                      12800093
128100                 MOVE DP015-RED  TO ASTRTITC                      12810093
128200                 MOVE DP015-REVERSE                               12820093
128300                                 TO ASTRTITH                      12830093
128400                 SET PS-ERROR                                     12840093
128500                     DP020-MSG-FATAL                              12850093
128600                                 TO TRUE                          12860093
128700             END-IF                                               12870093
128800         ELSE                                                     12880093
128900             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             12890093
129000             SET DP030-SET-CURSOR-APPL-1                          12900093
129100                                 TO TRUE                          12910093
129200             MOVE -1             TO ASTRTITL                      12920093
129300             MOVE DP015-UNP-NUM-BRT-MDT                           12930093
129400                                 TO ASTRTITA                      12940093
129500             MOVE DP015-RED      TO ASTRTITC                      12950093
129600             MOVE DP015-REVERSE  TO ASTRTITH                      12960093
129700             SET PS-ERROR                                         12970093
129800                 DP020-MSG-FATAL TO TRUE                          12980093
129900         END-IF                                                   12990093
130000     END-IF.                                                      13000093
130100                                                                  13010093
130200 2140-DESELECT-ALL-ITEMS.                                         13020093
130300                                                                  13030093
130400     MOVE +1                     TO ASC-BLK-SUB.                  13040093
130500                                                                  13050093
130600     PERFORM 2141-CLEAR-SELECTED-INDS                             13060093
130700             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    13070093
130800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13080093
130900                                                                  13090093
131000     ADD +1                      TO ASC-BLK-SUB.                  13100093
131100                                                                  13110093
131200     PERFORM 2141-CLEAR-SELECTED-INDS                             13120093
131300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    13130093
131400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13140093
131500                                                                  13150093
131600     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              13160093
131700                                 TO PV-LIST-ITEM-NUMBER.          13170093
131800                                                                  13180093
131900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13190093
132000             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).13200093
132100                                                                  13210093
132200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13220093
132300              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)13230093
132400         MOVE +1                 TO ASC-BLK-SUB                   13240093
132500                                                                  13250093
132600         PERFORM 5100-WRITE-TEMP-STORAGE                          13260093
132700                                                                  13270093
132800         MOVE +1                 TO PV-BLOCK-NUMBER               13280093
132900                                                                  13290093
133000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13300093
133100                                       PV-FIRST-BLOCK-IN-ARRAY - 113310093
133200                                                                  13320093
133300         PERFORM                                                  13330093
133400           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         13340093
133500                                                                  13350093
133600                 PERFORM 4410-READ-TEMP-STORAGE                   13360093
133700                                                                  13370093
133800                 PERFORM 2141-CLEAR-SELECTED-INDS                 13380093
133900                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13390093
134000                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13400093
134100                                                                  13410093
134200                 PERFORM 5100-WRITE-TEMP-STORAGE                  13420093
134300                                                                  13430093
134400                 ADD +1          TO PV-BLOCK-NUMBER               13440093
134500                                                                  13450093
134600         END-PERFORM                                              13460093
134700                                                                  13470093
134800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13480093
134900                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY13490093
135000                                                                  13500093
135100         PERFORM                                                  13510093
135200           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         13520093
135300                                         ASC-HIGHEST-BLOCK-WRITTEN13530093
135400                                                                  13540093
135500                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      13550093
135600                                 TO PV-BLOCK-NUMBER               13560093
135700                                                                  13570093
135800                 PERFORM 4410-READ-TEMP-STORAGE                   13580093
135900                                                                  13590093
136000                 PERFORM 2141-CLEAR-SELECTED-INDS                 13600093
136100                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13610093
136200                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13620093
136300                                                                  13630093
136400                 PERFORM 5100-WRITE-TEMP-STORAGE                  13640093
136500                                                                  13650093
136600                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        13660093
136700                                                                  13670093
136800         END-PERFORM                                              13680093
136900                                                                  13690093
137000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13700093
137100                                 TO PV-BLOCK-NUMBER               13710093
137200                                                                  13720093
137300         PERFORM 4410-READ-TEMP-STORAGE                           13730093
137400                                                                  13740093
137500     END-IF.                                                      13750093
137600                                                                  13760093
137700     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  13770093
137800                                    ASC-START-OF-SELECTED-RANGE   13780093
137900                                    ASC-END-OF-SELECTED-RANGE.    13790093
138000                                                                  13800093
138100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13810093
138200                                                                  13820093
138300 2141-CLEAR-SELECTED-INDS.                                        13830093
138400                                                                  13840093
138500     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO13850093
138600        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           13860093
138700            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          13870093
138800                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     13880093
138900                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  13890093
139000                                 TO TRUE.                         13900093
139100                                                                  13910093
139200 2150-SELECT-ALL-ITEMS.                                           13920093
139300                                                                  13930093
139400     MOVE +1                     TO ASC-BLK-SUB.                  13940093
139500                                                                  13950093
139600     PERFORM 2151-SET-SELECTED-INDS                               13960093
139700             VARYING ASC-ITEM-SUB FROM 1 BY 1                     13970093
139800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13980093
139900                                                                  13990093
140000     ADD +1                      TO ASC-BLK-SUB.                  14000093
140100                                                                  14010093
140200     PERFORM 2151-SET-SELECTED-INDS                               14020093
140300             VARYING ASC-ITEM-SUB FROM 1 BY 1                     14030093
140400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14040093
140500                                                                  14050093
140600     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              14060093
140700                                 TO PV-LIST-ITEM-NUMBER.          14070093
140800                                                                  14080093
140900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14090093
141000             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).14100093
141100                                                                  14110093
141200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14120093
141300              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)14130093
141400         MOVE +1                 TO ASC-BLK-SUB                   14140093
141500                                                                  14150093
141600         PERFORM 5100-WRITE-TEMP-STORAGE                          14160093
141700                                                                  14170093
141800         MOVE +1                 TO PV-BLOCK-NUMBER               14180093
141900                                                                  14190093
142000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14200093
142100                                       PV-FIRST-BLOCK-IN-ARRAY - 114210093
142200                                                                  14220093
142300         PERFORM                                                  14230093
142400           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         14240093
142500                                                                  14250093
142600                 PERFORM 4410-READ-TEMP-STORAGE                   14260093
142700                                                                  14270093
142800                 PERFORM 2151-SET-SELECTED-INDS                   14280093
142900                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14290093
143000                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14300093
143100                                                                  14310093
143200                 PERFORM 5100-WRITE-TEMP-STORAGE                  14320093
143300                                                                  14330093
143400                 ADD +1          TO PV-BLOCK-NUMBER               14340093
143500                                                                  14350093
143600         END-PERFORM                                              14360093
143700                                                                  14370093
143800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14380093
143900                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY14390093
144000                                                                  14400093
144100         PERFORM                                                  14410093
144200           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         14420093
144300                                         ASC-HIGHEST-BLOCK-WRITTEN14430093
144400                                                                  14440093
144500                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      14450093
144600                                 TO PV-BLOCK-NUMBER               14460093
144700                                                                  14470093
144800                 PERFORM 4410-READ-TEMP-STORAGE                   14480093
144900                                                                  14490093
145000                 PERFORM 2151-SET-SELECTED-INDS                   14500093
145100                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14510093
145200                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14520093
145300                                                                  14530093
145400                 PERFORM 5100-WRITE-TEMP-STORAGE                  14540093
145500                                                                  14550093
145600                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        14560093
145700                                                                  14570093
145800         END-PERFORM                                              14580093
145900                                                                  14590093
146000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14600093
146100                                 TO PV-BLOCK-NUMBER               14610093
146200                                                                  14620093
146300         PERFORM 4410-READ-TEMP-STORAGE                           14630093
146400     END-IF.                                                      14640093
146500                                                                  14650093
146600     COMPUTE ASC-NUMBER-OF-SELECTED-ITEMS =                       14660093
146700             ASC-NUMBER-OF-ITEMS-READ - PV-NUMBER-OF-RV-ITEMS.    14670093
146800                                                                  14680093
146900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14690093
147000                                                                  14700093
147100 2151-SET-SELECTED-INDS.                                          14710093
147200                                                                  14720093
147300     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO14730093
147400        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              14740093
147500           IF ASC-PURITM-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)        14750093
147600                                                       NOT = PC-RV14760093
147700              SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           14770093
147800                  ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      14780093
147900                  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                14790093
148000                                   TO TRUE                        14800093
148100           ELSE                                                   14810093
148200              ADD 1 TO PV-NUMBER-OF-RV-ITEMS                      14820093
148300           END-IF                                                 14830093
148400        END-IF                                                    14840093
148500     END-IF.                                                      14850093
148600                                                                  14860093
148700 2200-MOVE-SCREEN-TO-COMMAREA.                                    14870093
148800                                                                  14880093
148900     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               14890093
149000     MOVE +1                     TO PV-SUB.                       14900093
149100                                                                  14910093
149200     PERFORM 3100-SET-SUBSCRIPTS.                                 14920093
149300                                                                  14930093
149400******** MOVE SEARCH TEXT FROM SCREEN TO KEY FIELDS ***********   14940093
149500                                                                  14950093
149600** STYLE CLR SIZE **                                              14960093
149700     IF DP020-INT-APPL-FORMAT-IND = PC-STYL-CLR-SIZE              14970093
149800         AND ASRTXTL > ZERO                                       14980093
149900             MOVE ASRTXTI        TO ASC-KEY-SEARCH-STYLE          14990093
150000     ELSE                                                         15000093
150100       IF DP020-INT-APPL-FORMAT-IND = PC-STYL-CLR-SIZE            15010093
150200           AND ASRTXTF = DP015-ERASE-EOF                          15020093
150300               MOVE SPACES     TO ASC-KEY-SEARCH-STYLE            15030093
150400       END-IF                                                     15040093
150500     END-IF.                                                      15050093
150600                                                                  15060093
150700** STYLE SIZE CLR **                                              15070093
150800     IF DP020-INT-APPL-FORMAT-IND = PC-STYL-SIZE-CLR              15080093
150900         AND ASRTXTL > ZERO                                       15090093
151000               MOVE ASRTXTI      TO ASC-KEY-SEARCH-STYLE          15100093
151100     ELSE                                                         15110093
151200       IF DP020-INT-APPL-FORMAT-IND = PC-STYL-SIZE-CLR            15120093
151300           AND ASRTXTF = DP015-ERASE-EOF                          15130093
151400                 MOVE SPACES     TO ASC-KEY-SEARCH-STYLE          15140093
151500       END-IF                                                     15150093
151600     END-IF.                                                      15160093
151700                                                                  15170093
151800** SIZE **                                                        15180093
151900     IF DP020-INT-APPL-FORMAT-IND = PC-SIZE                       15190093
152000         AND ASRTXTL > ZERO                                       15200093
152100               MOVE ASRTXTI  TO ASC-KEY-SEARCH-SIZE               15210093
152200     ELSE                                                         15220093
152300       IF DP020-INT-APPL-FORMAT-IND = PC-SIZE                     15230093
152400           AND ASRTXTF = DP015-ERASE-EOF                          15240093
152500                 MOVE SPACES     TO ASC-KEY-SEARCH-SIZE           15250093
152600       END-IF                                                     15260093
152700     END-IF.                                                      15270093
152800                                                                  15280093
152900** SKU **                                                         15290093
153000     IF DP020-INT-APPL-FORMAT-IND = PC-SKU                        15300093
153100         AND ASRTXTL > ZERO                                       15310093
153200               MOVE ASRTXTI TO ASC-KEY-SEARCH-SKU                 15320093
153300     ELSE                                                         15330093
153400       IF DP020-INT-APPL-FORMAT-IND = PC-SKU                      15340093
153500           AND ASRTXTF = DP015-ERASE-EOF                          15350093
153600                MOVE SPACES     TO ASC-KEY-SEARCH-SKU             15360093
153700       END-IF                                                     15370093
153800     END-IF.                                                      15380093
153900                                                                  15390093
154000** COST **                                                        15400093
154100     IF DP020-INT-APPL-FORMAT-IND = PC-COST                       15410093
154200         AND ASRTXTL > ZERO                                       15420093
154300               MOVE ASRTXTI TO ASC-KEY-SEARCH-COST                15430093
154400     ELSE                                                         15440093
154500       IF DP020-INT-APPL-FORMAT-IND = PC-COST                     15450093
154600           AND ASRTXTF = DP015-ERASE-EOF                          15460093
154700                MOVE SPACES     TO ASC-KEY-SEARCH-COST            15470093
154800       END-IF                                                     15480093
154900     END-IF.                                                      15490093
155000                                                                  15500093
155100** COLOR **                                                       15510093
155200     IF DP020-INT-APPL-FORMAT-IND = PC-COLOR                      15520093
155300         AND ASRTXTL > ZERO                                       15530093
155400               MOVE ASRTXTI TO ASC-KEY-SEARCH-COLOR               15540093
155500     ELSE                                                         15550093
155600       IF DP020-INT-APPL-FORMAT-IND = PC-COLOR                    15560093
155700           AND ASRTXTF = DP015-ERASE-EOF                          15570093
155800                MOVE SPACES     TO ASC-KEY-SEARCH-COLOR           15580093
155900       END-IF                                                     15590093
156000     END-IF.                                                      15600093
156100                                                                  15610093
156200** DESC **                                                        15620093
156300     IF DP020-INT-APPL-FORMAT-IND = PC-DESC                       15630093
156400         AND ASRTXTL > ZERO                                       15640093
156500              MOVE ASRTXTI TO ASC-KEY-SEARCH-DESC                 15650093
156600     ELSE                                                         15660093
156700       IF DP020-INT-APPL-FORMAT-IND = PC-DESC                     15670093
156800           AND ASRTXTF = DP015-ERASE-EOF                          15680093
156900                MOVE SPACES     TO ASC-KEY-SEARCH-DESC            15690093
157000       END-IF                                                     15700093
157100     END-IF.                                                      15710093
157200                                                                  15720093
157300************************************************************      15730093
157400                                                                  15740093
157500                                                                  15750093
157600     IF ASTRTITL > ZERO                                           15760093
157700         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        15770093
157800     ELSE                                                         15780093
157900         IF ASTRTITF = DP015-ERASE-EOF                            15790093
158000             INITIALIZE ASC-START-ITEM-REQUEST                    15800093
158100         END-IF                                                   15810093
158200     END-IF.                                                      15820093
158300                                                                  15830093
158400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15840093
158500             VARYING PV-SUB  FROM 1 BY 1                          15850093
158600             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                15860093
158700                                                                  15870093
158800 2210-MOVE-LINES-TO-COMMAREA.                                     15880093
158900                                                                  15890093
159000     IF MR-SELECTL (PV-SUB) > ZERO                                15900093
159100         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  15910093
159200                                 TO TRUE                          15920093
159300         MOVE MR-SELECTI (PV-SUB)                                 15930093
159400                                 TO ASC-TEMP-SELECTED-SW          15940093
159500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     15950093
159600     ELSE                                                         15960093
159700         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 15970093
159800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 15980093
159900                                 TO TRUE                          15990093
160000             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          16000093
160100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16010093
160200         END-IF                                                   16020093
160300     END-IF.                                                      16030093
160400                                                                  16040093
160500     IF MR-PKSL-ITM-QTY-L (PV-SUB) > ZERO                         16050093
160600         MOVE MR-PKSL-ITM-QTY (PV-SUB)                            16060093
160700                                 TO ASC-PKSL-ITM-QTY              16070093
160800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16080093
160900     ELSE                                                         16090093
161000         IF MR-PKSL-ITM-QTY-A (PV-SUB) = DP015-ERASE-EOF          16100093
161100             MOVE ZEROS          TO ASC-PKSL-ITM-QTY-N            16110093
161200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16120093
161300         END-IF                                                   16130093
161400     END-IF.                                                      16140093
161500                                                                  16150093
161600     ADD +1                      TO ASC-ITEM-SUB.                 16160093
161700                                                                  16170093
161800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16180093
161900         ADD  +1                 TO ASC-BLK-SUB                   16190093
162000         MOVE +1                 TO ASC-ITEM-SUB                  16200093
162100     END-IF.                                                      16210093
162200                                                                  16220093
162300******************************************************************16230093
162400* THE USER CAN CHANGE THE SEARCH FOR VENDOR STYLE FIELD TO       *16240093
162500* REPOSITION THE LIST TO THE NEXT VENDOR STYLE THAT IS EQUAL OR  *16250093
162600* GREATER THAN THE SEARCH FOR VENDOR STYLE ENTERED.              *16260093
162700******************************************************************16270093
162800 2300-CHECK-FOR-SEARCH-STYLE.                                     16280093
162900                                                                  16290093
163000     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   16300093
163100                                                                  16310093
163200     PERFORM 2400-SEARCH-LISTQ-STYLE                              16320093
163300         VARYING PV-ITEM                                          16330093
163400         FROM 1 BY 1                                              16340093
163500         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                16350093
163600         OR ASC-KEY-SEARCH-STYLE < LQW-VEND-STYL-NAME (LQW-IDX)   16360093
163700         OR ASC-KEY-SEARCH-STYLE = LQW-VEND-STYL-NAME (LQW-IDX).  16370093
163800                                                                  16380093
163900     IF PS-INVALID-SEARCH-STYLE                                   16390093
164000         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            16400093
164100         MOVE -1                   TO ASRTXTL                     16410093
164200         SET DP030-SET-CURSOR-APPL-1                              16420093
164300                                   TO TRUE                        16430093
164400         MOVE DP015-REVERSE        TO ASRTXTH                     16440093
164500         MOVE DP015-YELLOW         TO ASRTXTC                     16450093
164600         MOVE DP015-UNP-ALP-BRT-MDT                               16460093
164700                                   TO ASRTXTA                     16470093
164800         SET DP020-MSG-WARNING     TO TRUE                        16480093
164900         SET PS-ERROR              TO TRUE                        16490093
165000     END-IF.                                                      16500093
165100                                                                  16510093
165200******************************************************************16520093
165300* THE USER CAN CHANGE THE SEARCH FOR VENDOR COLOR FIELD TO       *16530093
165400* REPOSITION THE LIST TO THE NEXT VENDOR COLOR THAT IS EQUAL OR  *16540093
165500* GREATER THAN THE SEARCH FOR VENDOR COLOR ENTERED.              *16550093
165600******************************************************************16560093
165700 2300-CHECK-FOR-SEARCH-COLOR.                                     16570093
165800                                                                  16580093
165900     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   16590093
166000                                                                  16600093
166100     PERFORM 2400-SEARCH-LISTQ-COLOR                              16610093
166200         VARYING PV-ITEM                                          16620093
166300         FROM 1 BY 1                                              16630093
166400         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                16640093
166500         OR ASC-KEY-SEARCH-COLOR < LQW-COLOR-DESC (LQW-IDX)       16650093
166600         OR ASC-KEY-SEARCH-COLOR = LQW-COLOR-DESC (LQW-IDX).      16660093
166700                                                                  16670093
166800     IF PS-INVALID-SEARCH-COLOR                                   16680093
166900         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            16690093
167000         MOVE -1                   TO ASRTXTL                     16700093
167100         SET DP030-SET-CURSOR-APPL-1                              16710093
167200                                   TO TRUE                        16720093
167300         MOVE DP015-REVERSE        TO ASRTXTH                     16730093
167400         MOVE DP015-YELLOW         TO ASRTXTC                     16740093
167500         MOVE DP015-UNP-ALP-BRT-MDT                               16750093
167600                                   TO ASRTXTA                     16760093
167700         SET DP020-MSG-WARNING     TO TRUE                        16770093
167800         SET PS-ERROR              TO TRUE                        16780093
167900     END-IF.                                                      16790093
168000                                                                  16800093
168100******************************************************************16810093
168200* THE USER CAN CHANGE THE SEARCH FOR VENDOR SIZE FIELD TO        *16820093
168300* REPOSITION THE LIST TO THE NEXT VENDOR SIZE THAT IS EQUAL OR   *16830093
168400* GREATER THAN THE SEARCH FOR VENDOR SIZE ENTERED.               *16840093
168500******************************************************************16850093
168600 2300-CHECK-FOR-SEARCH-SIZE.                                      16860093
168700                                                                  16870093
168800     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   16880093
168900                                                                  16890093
169000     PERFORM 2400-SEARCH-LISTQ-SIZE                               16900093
169100         VARYING PV-ITEM                                          16910093
169200         FROM 1 BY 1                                              16920093
169300         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                16930093
169400         OR ASC-KEY-SEARCH-SIZE < LQW-SIZE-DESC (LQW-IDX)         16940093
169500         OR ASC-KEY-SEARCH-SIZE = LQW-SIZE-DESC (LQW-IDX).        16950093
169600                                                                  16960093
169700     IF PS-INVALID-SEARCH-SIZE                                    16970093
169800         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            16980093
169900         MOVE -1                   TO ASRTXTL                     16990093
170000         SET DP030-SET-CURSOR-APPL-1                              17000093
170100                                   TO TRUE                        17010093
170200         MOVE DP015-REVERSE        TO ASRTXTH                     17020093
170300         MOVE DP015-YELLOW         TO ASRTXTC                     17030093
170400         MOVE DP015-UNP-ALP-BRT-MDT                               17040093
170500                                   TO ASRTXTA                     17050093
170600         SET DP020-MSG-WARNING     TO TRUE                        17060093
170700         SET PS-ERROR              TO TRUE                        17070093
170800     END-IF.                                                      17080093
170900                                                                  17090093
171000******************************************************************17100093
171100* THE USER CAN CHANGE THE SEARCH FOR SKU FIELD TO REPOSITION     *17110093
171200* THE LIST TO THE NEXT SKU THAT IS EQUAL OR GREATER THAN THE     *17120093
171300* SEARCH FOR SKU ENTERED.                                        *17130093
171400******************************************************************17140093
171500 2300-CHECK-FOR-SEARCH-SKU.                                       17150093
171600                                                                  17160093
171700     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   17170093
171800                                                                  17180093
171900     PERFORM 2400-SEARCH-LISTQ-SKU                                17190093
172000         VARYING PV-ITEM                                          17200093
172100         FROM 1 BY 1                                              17210093
172200         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                17220093
172300         OR ASC-KEY-SEARCH-SKU < PV-SKU                           17230093
172400         OR ASC-KEY-SEARCH-SKU = PV-SKU.                          17240093
172500                                                                  17250093
172600     IF PS-INVALID-SEARCH-SKU                                     17260093
172700         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            17270093
172800         MOVE -1                   TO ASRTXTL                     17280093
172900         SET DP030-SET-CURSOR-APPL-1                              17290093
173000                                   TO TRUE                        17300093
173100         MOVE DP015-REVERSE        TO ASRTXTH                     17310093
173200         MOVE DP015-YELLOW         TO ASRTXTC                     17320093
173300         MOVE DP015-UNP-ALP-BRT-MDT                               17330093
173400                                   TO ASRTXTA                     17340093
173500         SET DP020-MSG-WARNING     TO TRUE                        17350093
173600         SET PS-ERROR              TO TRUE                        17360093
173700     END-IF.                                                      17370093
173800                                                                  17380093
173900******************************************************************17390093
174000* THE USER CAN CHANGE THE SEARCH FOR COST FIELD TO REPOSITION    *17400093
174100* THE LIST TO THE NEXT COST THAT IS EQUAL OR GREATER THAN THE    *17410093
174200* SEARCH FOR COST ENTERED.                                       *17420093
174300******************************************************************17430093
174400 2300-CHECK-FOR-SEARCH-COST.                                      17440093
174500                                                                  17450093
174600     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   17460093
174700                                                                  17470093
174800     IF ASC-KEY-SEARCH-COST > SPACES                              17480093
174900         MOVE ASC-KEY-SEARCH-COST  TO DP010I-UNEDITED-FIELD       17490093
175000         MOVE LENGTH OF ASC-KEY-SEARCH-COST                       17500093
175100                                   TO DP010I-MAXIMUM-DIGITS       17510093
175200         MOVE 3                    TO DP010I-MAXIMUM-DECIMALS     17520093
175300         SET DP010I-NEGATIVE-NOT-ALLOWED                          17530093
175400                                   TO TRUE                        17540093
175510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17551097
175520              USING DP010I-NUMERIC-EDIT-AREA                      17552097
175600                                                                  17560093
175700         IF  DP010I-ERROR-DETECTED                                17570093
175800             CONTINUE                                             17580093
175900         ELSE                                                     17590093
176000             MOVE DP010I-NUMERIC-FIELD                            17600093
176100                                   TO ASC-KEY-SEARCH-COST-N       17610093
176200         END-IF                                                   17620093
176300     ELSE                                                         17630093
176400         MOVE ZEROS                TO ASC-KEY-SEARCH-COST-N       17640093
176500     END-IF.                                                      17650093
176600                                                                  17660093
176700     PERFORM 2400-SEARCH-LISTQ-COST                               17670093
176800         VARYING PV-ITEM                                          17680093
176900         FROM 1 BY 1                                              17690093
177000         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                17700093
177100         OR ASC-KEY-SEARCH-COST-N < LQW-UNT-COST-AMT (LQW-IDX)    17710093
177200         OR ASC-KEY-SEARCH-COST-N = LQW-UNT-COST-AMT (LQW-IDX).   17720093
177300                                                                  17730093
177400     IF PS-INVALID-SEARCH-COST                                    17740093
177500         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            17750093
177600         MOVE -1                   TO ASRTXTL                     17760093
177700         SET DP030-SET-CURSOR-APPL-1                              17770093
177800                                   TO TRUE                        17780093
177900         MOVE DP015-REVERSE        TO ASRTXTH                     17790093
178000         MOVE DP015-YELLOW         TO ASRTXTC                     17800093
178100         MOVE DP015-UNP-ALP-BRT-MDT                               17810093
178200                                   TO ASRTXTA                     17820093
178300         SET DP020-MSG-WARNING     TO TRUE                        17830093
178400         SET PS-ERROR              TO TRUE                        17840093
178500     END-IF.                                                      17850093
178600                                                                  17860093
178700******************************************************************17870093
178800* THE USER CAN CHANGE THE SEARCH FOR SKU DESC FIELD TO           *17880093
178900* REPOSITION THE LIST TO THE NEXT SKU DESC THAT IS EQUAL OR      *17890093
179000* GREATER THAN THE SEARCH FOR SKU DESC ENTERED.                  *17900093
179100******************************************************************17910093
179200 2300-CHECK-FOR-SEARCH-DESC.                                      17920093
179300                                                                  17930093
179400     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   17940093
179500                                                                  17950093
179600     PERFORM 2400-SEARCH-LISTQ-DESC                               17960093
179700         VARYING PV-ITEM                                          17970093
179800         FROM 1 BY 1                                              17980093
179900         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                17990093
180000         OR ASC-KEY-SEARCH-DESC < LQW-VEND-DESC (LQW-IDX)         18000093
180100         OR ASC-KEY-SEARCH-DESC = LQW-VEND-DESC (LQW-IDX).        18010093
180200                                                                  18020093
180300     IF PS-INVALID-SEARCH-DESC                                    18030093
180400         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            18040093
180500         MOVE -1                   TO ASRTXTL                     18050093
180600         SET DP030-SET-CURSOR-APPL-1                              18060093
180700                                   TO TRUE                        18070093
180800         MOVE DP015-REVERSE        TO ASRTXTH                     18080093
180900         MOVE DP015-YELLOW         TO ASRTXTC                     18090093
181000         MOVE DP015-UNP-ALP-BRT-MDT                               18100093
181100                                   TO ASRTXTA                     18110093
181200         SET DP020-MSG-WARNING     TO TRUE                        18120093
181300         SET PS-ERROR              TO TRUE                        18130093
181400     END-IF.                                                      18140093
181500                                                                  18150093
181600******************************************************************18160093
181700*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *18170093
181800*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *18180093
181900******************************************************************18190093
182000 2400-SEARCH-LISTQ-STYLE.                                         18200093
182100                                                                  18210093
182200     PERFORM 6112-READ-LIST-QUEUE.                                18220093
182300                                                                  18230093
182400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           18240093
182500         PERFORM                                                  18250093
182600             VARYING LQW-IDX                                      18260093
182700             FROM 1 BY 1                                          18270093
182800             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   18280093
182900             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             18290093
183000                 IF ASC-KEY-SEARCH-STYLE =                        18300093
183100                    LQW-VEND-STYL-NAME (LQW-IDX)  OR              18310093
183200                    ASC-KEY-SEARCH-STYLE <                        18320093
183300                    LQW-VEND-STYL-NAME (LQW-IDX)                  18330093
183400                     SET PS-VALID-SEARCH-STYLE                    18340093
183500                                 TO TRUE                          18350093
183600                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          18360093
183700                                 TO ASC-START-ITEM-REQUEST-N      18370093
183800                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            18380093
183900                     ADD ASC-HIGHEST-BLOCK-WRITTEN                18390093
184000                                 TO PV-ITEM                       18400093
184100                 END-IF                                           18410093
184200         END-PERFORM                                              18420093
184300     END-IF.                                                      18430093
184400                                                                  18440093
184500******************************************************************18450093
184600*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *18460093
184700*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *18470093
184800******************************************************************18480093
184900 2400-SEARCH-LISTQ-COLOR.                                         18490093
185000                                                                  18500093
185100     PERFORM 6112-READ-LIST-QUEUE.                                18510093
185200                                                                  18520093
185300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           18530093
185400         PERFORM                                                  18540093
185500             VARYING LQW-IDX                                      18550093
185600             FROM 1 BY 1                                          18560093
185700             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   18570093
185800             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             18580093
185900                 IF ASC-KEY-SEARCH-COLOR =                        18590093
186000                    LQW-COLOR-DESC (LQW-IDX)  OR                  18600093
186100                    ASC-KEY-SEARCH-COLOR <                        18610093
186200                    LQW-COLOR-DESC (LQW-IDX)                      18620093
186300                     SET PS-VALID-SEARCH-COLOR                    18630093
186400                                 TO TRUE                          18640093
186500                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          18650093
186600                                 TO ASC-START-ITEM-REQUEST-N      18660093
186700                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            18670093
186800                     ADD ASC-HIGHEST-BLOCK-WRITTEN                18680093
186900                                 TO PV-ITEM                       18690093
187000                 END-IF                                           18700093
187100         END-PERFORM                                              18710093
187200     END-IF.                                                      18720093
187300******************************************************************18730093
187400*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *18740093
187500*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *18750093
187600******************************************************************18760093
187700 2400-SEARCH-LISTQ-SIZE.                                          18770093
187800                                                                  18780093
187900     PERFORM 6112-READ-LIST-QUEUE.                                18790093
188000                                                                  18800093
188100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           18810093
188200         PERFORM                                                  18820093
188300             VARYING LQW-IDX                                      18830093
188400             FROM 1 BY 1                                          18840093
188500             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   18850093
188600             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             18860093
188700                 IF ASC-KEY-SEARCH-SIZE =                         18870093
188800                    LQW-SIZE-DESC (LQW-IDX)  OR                   18880093
188900                    ASC-KEY-SEARCH-SIZE <                         18890093
189000                    LQW-SIZE-DESC (LQW-IDX)                       18900093
189100                     SET PS-VALID-SEARCH-SIZE                     18910093
189200                                 TO TRUE                          18920093
189300                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          18930093
189400                                 TO ASC-START-ITEM-REQUEST-N      18940093
189500                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            18950093
189600                     ADD ASC-HIGHEST-BLOCK-WRITTEN                18960093
189700                                 TO PV-ITEM                       18970093
189800                 END-IF                                           18980093
189900         END-PERFORM                                              18990093
190000     END-IF.                                                      19000093
190100******************************************************************19010093
190200*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *19020093
190300*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *19030093
190400******************************************************************19040093
190500 2400-SEARCH-LISTQ-SKU.                                           19050093
190600                                                                  19060093
190700     PERFORM 6112-READ-LIST-QUEUE.                                19070093
190800                                                                  19080093
190900     IF PV-CICS-RESP = DFHRESP (NORMAL)                           19090093
191000         PERFORM                                                  19100093
191100             VARYING LQW-IDX                                      19110093
191200             FROM 1 BY 1                                          19120093
191300             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   19130093
191400             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             19140093
191500                 MOVE LQW-CL-NBR (LQW-IDX)                        19150093
191600                                 TO PV-CLASS-NBR                  19160093
191700                 MOVE LQW-SKU-SEQ-NBR (LQW-IDX)                   19170093
191800                                 TO PV-SKU-SEQ-NBR                19180093
191900                 IF ASC-KEY-SEARCH-SKU = PV-SKU  OR               19190093
192000                    ASC-KEY-SEARCH-SKU < PV-SKU                   19200093
192100                     SET PS-VALID-SEARCH-SKU                      19210093
192200                                 TO TRUE                          19220093
192300                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          19230093
192400                                 TO ASC-START-ITEM-REQUEST-N      19240093
192500                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            19250093
192600                     ADD ASC-HIGHEST-BLOCK-WRITTEN                19260093
192700                                 TO PV-ITEM                       19270093
192800                 END-IF                                           19280093
192900         END-PERFORM                                              19290093
193000     END-IF.                                                      19300093
193100******************************************************************19310093
193200*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *19320093
193300*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *19330093
193400******************************************************************19340093
193500 2400-SEARCH-LISTQ-COST.                                          19350093
193600                                                                  19360093
193700     PERFORM 6112-READ-LIST-QUEUE.                                19370093
193800                                                                  19380093
193900     IF PV-CICS-RESP = DFHRESP (NORMAL)                           19390093
194000         PERFORM                                                  19400093
194100             VARYING LQW-IDX                                      19410093
194200             FROM 1 BY 1                                          19420093
194300             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   19430093
194400             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             19440093
194500                 IF ASC-KEY-SEARCH-COST-N =                       19450093
194600                    LQW-UNT-COST-AMT (LQW-IDX)  OR                19460093
194700                    ASC-KEY-SEARCH-COST-N <                       19470093
194800                    LQW-UNT-COST-AMT (LQW-IDX)                    19480093
194900                     SET PS-VALID-SEARCH-COST                     19490093
195000                                 TO TRUE                          19500093
195100                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          19510093
195200                                 TO ASC-START-ITEM-REQUEST-N      19520093
195300                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            19530093
195400                     ADD ASC-HIGHEST-BLOCK-WRITTEN                19540093
195500                                 TO PV-ITEM                       19550093
195600                 END-IF                                           19560093
195700         END-PERFORM                                              19570093
195800     END-IF.                                                      19580093
195900******************************************************************19590093
196000*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *19600093
196100*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *19610093
196200******************************************************************19620093
196300 2400-SEARCH-LISTQ-DESC.                                          19630093
196400                                                                  19640093
196500     PERFORM 6112-READ-LIST-QUEUE.                                19650093
196600                                                                  19660093
196700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           19670093
196800         PERFORM                                                  19680093
196900             VARYING LQW-IDX                                      19690093
197000             FROM 1 BY 1                                          19700093
197100             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   19710093
197200             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             19720093
197300                 IF ASC-KEY-SEARCH-DESC =                         19730093
197400                    LQW-VEND-DESC (LQW-IDX)  OR                   19740093
197500                    ASC-KEY-SEARCH-DESC <                         19750093
197600                    LQW-VEND-DESC (LQW-IDX)                       19760093
197700                     SET PS-VALID-SEARCH-DESC                     19770093
197800                                 TO TRUE                          19780093
197900                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          19790093
198000                                 TO ASC-START-ITEM-REQUEST-N      19800093
198100                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            19810093
198200                     ADD ASC-HIGHEST-BLOCK-WRITTEN                19820093
198300                                 TO PV-ITEM                       19830093
198400                 END-IF                                           19840093
198500         END-PERFORM                                              19850093
198600     END-IF.                                                      19860093
198700******************************************************************19870093
198800                                                                  19880093
198900                                                                  19890093
199000 3000-EDIT-DATA-IN-COMMAREA.                                      19900093
199100                                                                  19910093
199200     SET PS-NO-ERROR             TO TRUE.                         19920093
199300                                                                  19930093
199400     PERFORM 3200-RESET-ATTRIBUTES.                               19940093
199500                                                                  19950093
199600     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       19960093
199700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19970093
199800                                          ASC-ITEMS-DISPLAYED - 1.19980093
199900     PERFORM 3100-SET-SUBSCRIPTS.                                 19990093
200000                                                                  20000093
200100     PERFORM 3300-EDIT-SELECTIONS                                 20010093
200200             VARYING PV-SUB  FROM PV-SUB BY -1                    20020093
200300             UNTIL   PV-SUB < +1.                                 20030093
200400                                                                  20040093
200500     IF PS-NO-ERROR                                               20050093
200600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20060093
200700     END-IF.                                                      20070093
200800                                                                  20080093
200900     IF PS-NO-ERROR AND                                           20090093
201000        ASC-START-OF-SELECTED-RANGE > ZERO AND                    20100093
201100        ASC-END-OF-SELECTED-RANGE > ZERO                          20110093
201200                                                                  20120093
201300         PERFORM 3500-MARK-RANGE-AS-SELECTED                      20130093
201400     END-IF.                                                      20140093
201500                                                                  20150093
201600                                                                  20160093
201700 3100-SET-SUBSCRIPTS.                                             20170093
201800                                                                  20180093
201900     COMPUTE ASC-ITEM-SUB =                                       20190093
202000                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.20200093
202100                                                                  20210093
202200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         20220093
202300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20230093
202400         MOVE PC-MAX-BLOCKS-IN-ARRAY                              20240093
202500                                 TO ASC-BLK-SUB                   20250093
202600     ELSE                                                         20260093
202700         MOVE +1                 TO ASC-BLK-SUB                   20270093
202800     END-IF.                                                      20280093
202900                                                                  20290093
203000 3200-RESET-ATTRIBUTES.                                           20300093
203100                                                                  20310093
203200     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA                      20320093
203300                                    ASRTXTA.                      20330093
203400     MOVE DP015-GREEN            TO ASTRTITC                      20340093
203500                                    ASRTXTC.                      20350093
203600     MOVE DP015-UNDERLINE        TO ASTRTITH                      20360093
203700                                    ASRTXTH.                      20370093
203800                                                                  20380093
203900     IF DP020-NEXT-ACT-RETURN OR                                  20390093
204000        DP020-NEXT-ACT-READ-MAP                                   20400093
204100         PERFORM VARYING PV-SUB  FROM 1 BY 1                      20410093
204200                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             20420093
204300                 MOVE DP015-UNP-ALP-NOR-OFF                       20430093
204400                                 TO MR-SELECTA (PV-SUB)           20440093
204500                 MOVE DP015-UNP-NUM-NOR-OFF                       20450093
204600                                 TO MR-PKSL-ITM-QTY-A (PV-SUB)    20460093
204700                 MOVE DP015-GREEN                                 20470093
204800                                 TO MR-SELECTC (PV-SUB)           20480093
204900                                    MR-PKSL-ITM-QTY-C (PV-SUB)    20490093
205000                 MOVE DP015-UNDERLINE                             20500093
205100                                 TO MR-SELECTH (PV-SUB)           20510093
205200                                    MR-PKSL-ITM-QTY-H (PV-SUB)    20520093
205300         END-PERFORM                                              20530093
205400     ELSE                                                         20540093
205500         PERFORM VARYING PV-SUB  FROM 1 BY 1                      20550093
205600                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              20560093
205700                 MOVE DP015-UNP-ALP-NOR-OFF                       20570093
205800                                 TO MR-SELECTA (PV-SUB)           20580093
205900                 MOVE DP015-UNP-NUM-NOR-OFF                       20590093
206000                                 TO MR-PKSL-ITM-QTY-A (PV-SUB)    20600093
206100                 MOVE DP015-GREEN                                 20610093
206200                                 TO MR-SELECTC (PV-SUB)           20620093
206300                                    MR-PKSL-ITM-QTY-C (PV-SUB)    20630093
206400                 MOVE DP015-UNDERLINE                             20640093
206500                                 TO MR-SELECTH (PV-SUB)           20650093
206600                                    MR-PKSL-ITM-QTY-H (PV-SUB)    20660093
206700         END-PERFORM                                              20670093
206800     END-IF.                                                      20680093
206900                                                                  20690093
207000 3300-EDIT-SELECTIONS.                                            20700093
207100                                                                  20710093
207200     EVALUATE TRUE                                                20720093
207300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   20730093
207400                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20740093
207500              CONTINUE                                            20750093
207600                                                                  20760093
207700         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        20770093
207800              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        20780093
207900                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  20790093
208000                  MOVE ASC-TEMP-SELECTED-SW                       20800093
208100                                        (ASC-BLK-SUB ASC-ITEM-SUB)20810093
208200                                 TO ASC-SELECTED-SW               20820093
208300                                        (ASC-BLK-SUB ASC-ITEM-SUB)20830093
208400              END-IF                                              20840093
208500                                                                  20850093
208600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   20860093
208700                                                             SPACE20870093
208800              EVALUATE TRUE                                       20880093
208900                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     20890093
209000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS20900093
209100                     MOVE SPACE  TO ASC-SELECTED-SW               20910093
209200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20920093
209300                                                                  20930093
209400                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     20940093
209500                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   20950093
209600                       MOVE SPACE                                 20960093
209700                                 TO ASC-SELECTED-SW               20970093
209800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20980093
209900                                                                  20990093
210000                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     21000093
210100                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     21010093
210200                       MOVE SPACE                                 21020093
210300                                 TO ASC-SELECTED-SW               21030093
210400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21040093
210500             END-EVALUATE                                         21050093
210600                                                                  21060093
210700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           21070093
210800              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           21080093
210900                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   21090093
211000              END-IF                                              21100093
211100                                                                  21110093
211200              PERFORM 3310-EDIT-RANGE                             21120093
211300                                                                  21130093
211400         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            21140093
211500              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21150093
211600                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   21160093
211700              END-IF                                              21170093
211800                                                                  21180093
211900              PERFORM 3310-EDIT-RANGE                             21190093
212000                                                                  21200093
212100         WHEN OTHER                                               21210093
212200              MOVE PC-TSYMSG-00005                                21220093
212300                                 TO DP020-MSG-NUMBER              21230093
212400              SET PS-ERROR                                        21240093
212500                  DP020-MSG-FATAL                                 21250093
212600                  DP030-SET-CURSOR-APPL-1                         21260093
212700                                 TO TRUE                          21270093
212800              MOVE -1            TO MR-SELECTL (PV-SUB)           21280093
212900              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           21290093
213000              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           21300093
213100              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21310093
213200                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    21320093
213300                  MOVE SPACE     TO ASC-SELECTED-SW               21330093
213400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21340093
213500              END-IF                                              21350093
213600     END-EVALUATE.                                                21360093
213700                                                                  21370093
213800     SET PS-NO-ERROR-IN-QTY TO TRUE.                              21380093
213900     IF ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES      21390093
214000         MOVE ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         21400093
214100                               TO DP010I-UNEDITED-FIELD           21410093
214200         MOVE LENGTH OF ASC-PKSL-ITM-QTY                          21420093
214300                               (ASC-BLK-SUB ASC-ITEM-SUB)         21430093
214400                               TO DP010I-MAXIMUM-DIGITS           21440093
214500         MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS         21450093
214600         SET DP010I-NEGATIVE-NOT-ALLOWED                          21460093
214700                               TO TRUE                            21470093
214810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21481097
214820              USING DP010I-NUMERIC-EDIT-AREA                      21482097
214900                                                                  21490093
215000         IF  DP010I-ERROR-DETECTED                                21500093
215100             SET PS-ERROR                                         21510093
215200                 DP020-MSG-FATAL                                  21520093
215300                 DP030-SET-CURSOR-APPL-1                          21530093
215400                               TO TRUE                            21540093
215500             MOVE PC-TSYMSG-00005                                 21550093
215600                               TO DP020-MSG-NUMBER                21560093
215700             MOVE DP015-UNP-NUM-BRT-OFF                           21570093
215800                               TO MR-PKSL-ITM-QTY-A (PV-SUB)      21580093
215900             MOVE -1           TO MR-PKSL-ITM-QTY-L (PV-SUB)      21590093
216000             MOVE DP015-RED    TO MR-PKSL-ITM-QTY-C (PV-SUB)      21600093
216100             MOVE DP015-REVERSE                                   21610093
216200                               TO MR-PKSL-ITM-QTY-H (PV-SUB)      21620093
216300             SET DP030-SET-CURSOR-APPL-1                          21630093
216400                               TO TRUE                            21640093
216500             IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             21650093
216600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     21660093
216700                 SET PS-ERROR-IN-QTY TO TRUE                      21670093
216800             END-IF                                               21680093
216900         ELSE                                                     21690093
217000             MOVE DP010I-NUMERIC-FIELD                            21700093
217100                               TO ASC-PKSL-ITM-QTY-N              21710093
217200                                 (ASC-BLK-SUB ASC-ITEM-SUB)       21720093
217300             MOVE ASC-PKSL-ITM-QTY-N                              21730093
217400                                 (ASC-BLK-SUB ASC-ITEM-SUB)       21740093
217500                               TO MR-PKSL-ITM-QTY-EDITED          21750093
217600                                                    (PV-SUB)      21760093
217700         END-IF                                                   21770093
217800     END-IF.                                                      21780093
217900                                                                  21790093
218000     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND                 21800093
218100         PS-NO-ERROR-IN-QTY                                       21810093
218200         IF ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  21820093
218300             MOVE ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB)     21830093
218400                                   TO DP010I-UNEDITED-FIELD       21840093
218500             MOVE LENGTH OF ASC-PKSL-ITM-QTY                      21850093
218600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21860093
218700                                   TO DP010I-MAXIMUM-DIGITS       21870093
218800             MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS     21880093
218900             SET DP010I-NEGATIVE-NOT-ALLOWED                      21890093
219000                                   TO TRUE                        21900093
219110             CALL DP010I-NUMERIC-EDIT-ROUTINE                     21911097
219120                  USING DP010I-NUMERIC-EDIT-AREA                  21912097
219200                                                                  21920093
219300             IF  DP010I-ERROR-DETECTED                            21930093
219400                 SET PS-ERROR                                     21940093
219500                     DP020-MSG-FATAL                              21950093
219600                     DP030-SET-CURSOR-APPL-1                      21960093
219700                                   TO TRUE                        21970093
219800                 MOVE PC-TSYMSG-00005                             21980093
219900                                   TO DP020-MSG-NUMBER            21990093
220000                 MOVE DP015-UNP-NUM-BRT-OFF                       22000093
220100                                   TO MR-PKSL-ITM-QTY-A (PV-SUB)  22010093
220200                 MOVE -1           TO MR-PKSL-ITM-QTY-L (PV-SUB)  22020093
220300                 MOVE DP015-RED    TO MR-PKSL-ITM-QTY-C (PV-SUB)  22030093
220400                 MOVE DP015-REVERSE                               22040093
220500                                   TO MR-PKSL-ITM-QTY-H (PV-SUB)  22050093
220600                 SET DP030-SET-CURSOR-APPL-1                      22060093
220700                                   TO TRUE                        22070093
220800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22080093
220900             ELSE                                                 22090093
221000                 MOVE DP010I-NUMERIC-FIELD                        22100093
221100                                   TO ASC-PKSL-ITM-QTY-N          22110093
221200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22120093
221300                 IF ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB) 22130093
221400                                   = ZERO                         22140093
221500                     MOVE ASC-OTR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  22150093
221600                                   TO ASC-PKSL-ITM-QTY-N          22160093
221700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22170093
221800                                      MR-PKSL-ITM-QTY-EDITED      22180093
221900                                                        (PV-SUB)  22190093
222000                     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)         22200093
222100                                   TO TRUE                        22210093
222200                 ELSE                                             22220093
222300                     MOVE ASC-PKSL-ITM-QTY-N                      22230093
222400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22240093
222500                                   TO MR-PKSL-ITM-QTY-EDITED      22250093
222600                                                        (PV-SUB)  22260093
222700                 END-IF                                           22270093
222800             END-IF                                               22280093
222900         ELSE                                                     22290093
223000             MOVE ASC-OTR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          22300093
223100                                   TO ASC-PKSL-ITM-QTY-N          22310093
223200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22320093
223300                                      MR-PKSL-ITM-QTY-EDITED      22330093
223400                                                        (PV-SUB)  22340093
223500         END-IF                                                   22350093
223600     END-IF.                                                      22360093
223700                                                                  22370093
223800     IF ASC-PURITM-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) = PC-RV      22380093
223900         MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)            22390093
224000                                   MR-PKSL-ITM-QTY-A (PV-SUB)     22400093
224100     END-IF.                                                      22410093
224200                                                                  22420093
224300     SUBTRACT +1 FROM PV-ITEM-IN-USE                              22430093
224400                      ASC-ITEM-SUB.                               22440093
224500                                                                  22450093
224600     IF ASC-ITEM-SUB < 1                                          22460093
224700         SUBTRACT +1 FROM ASC-BLK-SUB                             22470093
224800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  22480093
224900     END-IF.                                                      22490093
225000                                                                  22500093
225100 3310-EDIT-RANGE.                                                 22510093
225200                                                                  22520093
225300     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 22530093
225400        IF ASC-START-OF-SELECTED-RANGE = ZERO                     22540093
225500            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  22550093
225600                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  22560093
225700            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   22570093
225800        ELSE                                                      22580093
225900            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       22590093
226000                CONTINUE                                          22600093
226100            ELSE                                                  22610093
226200                MOVE PC-TSYMSG-00054                              22620093
226300                                 TO DP020-MSG-NUMBER              22630093
226400                SET DP020-MSG-FATAL                               22640093
226500                    PS-ERROR                                      22650093
226600                    DP030-SET-CURSOR-APPL-1                       22660093
226700                                 TO TRUE                          22670093
226800                MOVE -1          TO MR-SELECTL (PV-SUB)           22680093
226900                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           22690093
227000                MOVE DP015-UNDERLINE                              22700093
227100                                 TO MR-SELECTH (PV-SUB)           22710093
227200            END-IF                                                22720093
227300        END-IF                                                    22730093
227400     ELSE                                                         22740093
227500         IF ASC-END-OF-SELECTED-RANGE = ZERO                      22750093
227600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22760093
227700                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22770093
227800             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     22780093
227900         ELSE                                                     22790093
228000             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        22800093
228100                 CONTINUE                                         22810093
228200             ELSE                                                 22820093
228300                MOVE PC-TSYMSG-00055                              22830093
228400                                 TO DP020-MSG-NUMBER              22840093
228500                SET DP020-MSG-FATAL                               22850093
228600                    PS-ERROR                                      22860093
228700                    DP030-SET-CURSOR-APPL-1                       22870093
228800                                 TO TRUE                          22880093
228900                MOVE -1          TO MR-SELECTL (PV-SUB)           22890093
229000             END-IF                                               22900093
229100         END-IF                                                   22910093
229200     END-IF.                                                      22920093
229300                                                                  22930093
229400 3400-CHECK-RANGE-SEQUENCE.                                       22940093
229500                                                                  22950093
229600     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    22960093
229700        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    22970093
229800        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   22980093
229900         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              22990093
230000         SET PS-ERROR                                             23000093
230100             DP020-MSG-FATAL     TO TRUE                          23010093
230200                                                                  23020093
230300         PERFORM 3410-POSITION-AT-ERROR                           23030093
230400     END-IF.                                                      23040093
230500                                                                  23050093
230600 3410-POSITION-AT-ERROR.                                          23060093
230700                                                                  23070093
230800     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         23080093
230900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               23090093
231000                                                  PV-TOP-ITEM + 1.23100093
231100     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       23110093
231200         CONTINUE                                                 23120093
231300     ELSE                                                         23130093
231400         MOVE -1                 TO MR-SELECTL (PV-SUB)           23140093
231500         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           23150093
231600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           23160093
231700     END-IF.                                                      23170093
231800                                                                  23180093
231900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.23190093
232000     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       23200093
232100         CONTINUE                                                 23210093
232200     ELSE                                                         23220093
232300         MOVE -1                 TO MR-SELECTL (PV-SUB)           23230093
232400         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           23240093
232500         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           23250093
232600     END-IF.                                                      23260093
232700                                                                  23270093
232800 3500-MARK-RANGE-AS-SELECTED.                                     23280093
232900                                                                  23290093
233000     MOVE +1                     TO ASC-BLK-SUB.                  23300093
233100                                                                  23310093
233200     PERFORM 3510-MARK-SELECTED-INDS                              23320093
233300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    23330093
233400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           23340093
233500                                                                  23350093
233600     ADD +1                      TO ASC-BLK-SUB.                  23360093
233700                                                                  23370093
233800     PERFORM 3510-MARK-SELECTED-INDS                              23380093
233900             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    23390093
234000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           23400093
234100                                                                  23410093
234200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              23420093
234300                                 TO PV-LIST-ITEM-NUMBER.          23430093
234400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        23440093
234500                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).23450093
234600     MOVE ASC-START-OF-SELECTED-RANGE                             23460093
234700                                 TO PV-START-OF-SELECTED-RANGE.   23470093
234800     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        23480093
234900             ((PV-START-OF-SELECTED-RANGE - 1) /                  23490093
235000                                              PC-ITEMS-PER-PANEL).23500093
235100     MOVE ASC-END-OF-SELECTED-RANGE                               23510093
235200                                 TO PV-END-OF-SELECTED-RANGE.     23520093
235300     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         23530093
235400             ((PV-END-OF-SELECTED-RANGE - 1) /                    23540093
235500                                              PC-ITEMS-PER-PANEL).23550093
235600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.23560093
235700                                                                  23570093
235800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    23580093
235900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        23590093
236000         MOVE +1                 TO ASC-BLK-SUB                   23600093
236100                                                                  23610093
236200         PERFORM 5100-WRITE-TEMP-STORAGE                          23620093
236300                                                                  23630093
236400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23640093
236500                                       PV-FIRST-BLOCK-IN-ARRAY - 123650093
236600                                                                  23660093
236700         PERFORM                                                  23670093
236800           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 23680093
236900                 MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER  23690093
237000                                                                  23700093
237100                 PERFORM 4410-READ-TEMP-STORAGE                   23710093
237200                                                                  23720093
237300                 PERFORM 3510-MARK-SELECTED-INDS                  23730093
237400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        23740093
237500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL23750093
237600                                                                  23760093
237700                 PERFORM 5100-WRITE-TEMP-STORAGE                  23770093
237800                                                                  23780093
237900                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       23790093
238000         END-PERFORM                                              23800093
238100                                                                  23810093
238200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23820093
238300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY23830093
238400         PERFORM                                                  23840093
238500           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  23850093
238600                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      23860093
238700                                 TO PV-BLOCK-NUMBER               23870093
238800                                                                  23880093
238900                 PERFORM 4410-READ-TEMP-STORAGE                   23890093
239000                                                                  23900093
239100                 PERFORM 3510-MARK-SELECTED-INDS                  23910093
239200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        23920093
239300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL23930093
239400                                                                  23940093
239500                 PERFORM 5100-WRITE-TEMP-STORAGE                  23950093
239600                                                                  23960093
239700                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        23970093
239800         END-PERFORM                                              23980093
239900                                                                  23990093
240000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24000093
240100                                 TO PV-BLOCK-NUMBER               24010093
240200                                                                  24020093
240300         PERFORM 4410-READ-TEMP-STORAGE                           24030093
240400                                                                  24040093
240500     END-IF.                                                      24050093
240600                                                                  24060093
240700     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   24070093
240800                                    ASC-END-OF-SELECTED-RANGE.    24080093
240900                                                                  24090093
241000 3510-MARK-SELECTED-INDS.                                         24100093
241100                                                                  24110093
241200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     24120093
241300                                       ASC-START-OF-SELECTED-RANGE24130093
241400        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  24140093
241500                                         ASC-END-OF-SELECTED-RANGE24150093
241600           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           24160093
241700               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          24170093
241800                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               24180093
241900                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     24190093
242000                                 TO TRUE                          24200093
242100               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  24210093
242200           END-IF                                                 24220093
242300        END-IF                                                    24230093
242400     END-IF.                                                      24240093
242500                                                                  24250093
242600 4000-BUILD-INITIAL-PANEL.                                        24260093
242700                                                                  24270093
242800     INITIALIZE ASC-BLOCK-ENTRIES (1)                             24280093
242900                ASC-BLOCK-ENTRIES (2).                            24290093
243000                                                                  24300093
243100     MOVE +1                     TO ASC-BLK-SUB.                  24310093
243200     SET ASC-MORE-PO-ITEMS       TO TRUE.                         24320093
243300                                                                  24330093
243400     MOVE ZERO                   TO ASC-ITEM-SUB                  24340093
243500                                    ASC-NUMBER-OF-ITEMS-READ      24350093
243600                                    ASC-NUMBER-OF-SELECTED-ITEMS  24360093
243700                                    ASC-HIGHEST-BLOCK-WRITTEN     24370093
243800                                    ASC-START-OF-SELECTED-RANGE   24380093
243900                                    ASC-END-OF-SELECTED-RANGE     24390093
244000                                    ASC-KEY-SEARCH-COST-N         24400093
244100                                    ASC-ITEM-AT-TOP-OF-PANEL.     24410093
244200     MOVE SPACES                 TO ASC-KEY-SEARCH-STYLE          24420093
244300                                    ASC-KEY-SEARCH-COLOR          24430093
244400                                    ASC-KEY-SEARCH-SIZE           24440093
244500                                    ASC-KEY-SEARCH-SKU.           24450093
244600                                                                  24460093
244700     PERFORM 4010-FORMAT-KEYS.                                    24470093
244800                                                                  24480093
244900     PERFORM 4060-CHECK-PO-STATUS.                                24490093
245000                                                                  24500093
245100     IF PS-NO-ERROR                                               24510093
245200         PERFORM 4020-GET-VENDOR-NAME                             24520093
245300         PERFORM 4200-CALC-OPEN-TO-REC                            24530093
245400         PERFORM 4030-OPEN-CURSOR                                 24540093
245500         PERFORM 4040-GET-PO-ITEMS                                24550093
245600         PERFORM 4050-CLOSE-CURSOR                                24560093
245700         MOVE +1                 TO PV-TOP-ITEM                   24570093
245800     END-IF                                                       24580093
245900                                                                  24590093
246000     IF PS-NO-ERROR                                               24600093
246100         IF ASC-NUMBER-OF-ITEMS-READ = ZERO                       24610093
246200             SET DP020-MSG-FATAL                                  24620093
246300                 DP020-NEXT-ACT-APPL-ERROR                        24630093
246400                                 TO TRUE                          24640093
246500             MOVE PC-TSYMSG-00050                                 24650093
246600                                 TO DP020-MSG-NUMBER              24660093
246700         ELSE                                                     24670093
246800             MOVE -1             TO MR-SELECTL (1)                24680093
246900             SET DP030-SET-CURSOR-APPL-1                          24690093
247000                                 TO TRUE                          24700093
247100                                                                  24710093
247200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24720093
247300         END-IF                                                   24730093
247400     END-IF.                                                      24740093
247500                                                                  24750093
247600 4010-FORMAT-KEYS.                                                24760093
247700                                                                  24770093
247800     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    24780093
247900     IF ASC-KEY-STR-NBR > ZERO                                    24790093
248000         MOVE ASC-KEY-STR-NBR    TO DK-STR-NBR-B                  24800093
248100                                    DK-STR-NBR-E                  24810093
248200     END-IF.                                                      24820093
248300                                                                  24830093
248400     IF RC015-DISPLAY-Z-OTR = PC-N                                24840093
248500         MOVE PC-AC              TO PC-STAT-1                     24850093
248600                                    PC-STAT-3                     24860093
248700                                    PC-STAT-4                     24870093
248800                                    PC-STAT-5                     24880093
248900         MOVE PC-AP              TO PC-STAT-2                     24890093
249000         MOVE PC-RV              TO PC-STAT-6                     24900093
249100     ELSE                                                         24910093
249200         MOVE PC-AC              TO PC-STAT-1                     24920093
249300         MOVE PC-AP              TO PC-STAT-2                     24930093
249400         MOVE PC-CA              TO PC-STAT-3                     24940093
249500         MOVE PC-CB              TO PC-STAT-4                     24950093
249600         MOVE PC-CM              TO PC-STAT-5                     24960093
249700         MOVE PC-RV              TO PC-STAT-6                     24970093
249800     END-IF.                                                      24980093
249900                                                                  24990093
250000 4020-GET-VENDOR-NAME.                                            25000093
250100                                                                  25010093
250200     PERFORM WITH TEST AFTER                                      25020093
250300         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    25030093
250400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             25040093
250500                 SQLCODE = ZERO OR                                25050093
250600                 SQLCODE = +100                                   25060093
250700                                                                  25070093
250800         EXEC SQL                                                 25080093
250900              SELECT B.ENT_NAME_DESC                              25090093
251000                INTO :ENTNME-ENT-NAME-DESC                        25100093
251100                FROM TPURCHS A,                                   25110093
251200                     TENTNME B                                    25120093
251300               WHERE A.VER_STATUS_CDE = :PC-ACTIVE                25130093
251400                 AND A.PO_NBR         = :DK-PO-NBR                25140093
251500                 AND A.ENT_ID         = B.ENT_ID                  25150093
251600                 AND B.TYPE_CDE       = :PC-01                    25160093
251700         END-EXEC                                                 25170093
251800                                                                  25180093
251900         EVALUATE TRUE                                            25190093
252000             WHEN SQLCODE = ZERO                                  25200093
252100             WHEN SQLCODE = +100                                  25210093
252200             WHEN SQLCODE = -904                                  25220093
252300             WHEN SQLCODE = -913                                  25230093
252400                  CONTINUE                                        25240093
252500                                                                  25250093
252600             WHEN SQLWARN0 NOT = SPACES                           25260093
252700             WHEN SQLCODE  NOT = ZERO                             25270093
252800                  MOVE '4020-GET-VENDOR-NAME'                     25280093
252900                                 TO DP013-PARAGRAPH               25290093
253000                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       25300093
253100                                 TO DP013-MESSAGE-TEXT (1)        25310093
253200                  MOVE SQLCA     TO DP013-SQLCA                   25320093
253300                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      25330093
253400                  SET DP013-DB2-ABEND                             25340093
253500                      DP013-XCTL-DISPLAY-RESTART                  25350093
253600                                 TO TRUE                          25360093
253700                                                                  25370093
253800                  PERFORM DP013-0000-PROCESS-ABEND                25380093
253900         END-EVALUATE                                             25390093
254000     END-PERFORM.                                                 25400093
254100                                                                  25410093
254200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO  25420093
254300         MOVE '4020-GET-VENDOR-NAME'                              25430093
254400                                 TO DP013-PARAGRAPH               25440093
254500         MOVE 'MAX RETRIES EXCEEDED ON SELECT VENDOR NAME'        25450093
254600                                 TO DP013-MESSAGE-TEXT (1)        25460093
254700         MOVE SQLCA              TO DP013-SQLCA                   25470093
254800         MOVE 'TENTNME '         TO DP013-DB2-TABLE-NAME (1)      25480093
254900         SET DP013-XCTL-DISPLAY-RESTART                           25490093
255000             DP013-DB2-ABEND     TO TRUE                          25500093
255100                                                                  25510093
255200         PERFORM DP013-0000-PROCESS-ABEND                         25520093
255300     END-IF.                                                      25530093
255400                                                                  25540093
255500     IF SQLCODE = ZERO                                            25550093
255600         MOVE ENTNME-ENT-NAME-DESC                                25560093
255700                                 TO ASC-KEY-VENDOR-NAME           25570093
255800     ELSE                                                         25580093
255900         IF SQLCODE = +100                                        25590093
256000             MOVE 'VENDOR NOT FOUND'                              25600093
256100                                 TO ASC-KEY-VENDOR-NAME           25610093
256200         END-IF                                                   25620093
256300     END-IF.                                                      25630093
256400                                                                  25640093
256500 4030-OPEN-CURSOR.                                                25650093
256600                                                                  25660093
256700     PERFORM WITH TEST AFTER                                      25670093
256800         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    25680093
256900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             25690093
257000                 SQLCODE = ZERO                                   25700093
257100                                                                  25710093
257200         IF DP020-INT-APPL-FORMAT-IND = PC-STYL-CLR-SIZE          25720093
257300             EXEC SQL                                             25730093
257400                  OPEN STYL-CLR-SIZ-CSR                           25740093
257500             END-EXEC                                             25750093
257600         ELSE                                                     25760093
257700           IF DP020-INT-APPL-FORMAT-IND = PC-STYL-SIZE-CLR        25770093
257800               EXEC SQL                                           25780093
257900                   OPEN STYL-SIZ-CLR-CSR                          25790093
258000               END-EXEC                                           25800093
258100           ELSE                                                   25810093
258200             IF DP020-INT-APPL-FORMAT-IND = PC-COLOR              25820093
258300                 EXEC SQL                                         25830093
258400                     OPEN COLOR-SIZE-CSR                          25840093
258500                 END-EXEC                                         25850093
258600             ELSE                                                 25860093
258700               IF DP020-INT-APPL-FORMAT-IND = PC-SIZE             25870093
258800                   EXEC SQL                                       25880093
258900                       OPEN SIZE-COLOR-CSR                        25890093
259000                   END-EXEC                                       25900093
259100               ELSE                                               25910093
259200                 IF DP020-INT-APPL-FORMAT-IND = PC-SKU            25920093
259300                     EXEC SQL                                     25930093
259400                         OPEN SKU-COLOR-CSR                       25940093
259500                     END-EXEC                                     25950093
259600                 ELSE                                             25960093
259700                   IF DP020-INT-APPL-FORMAT-IND = PC-COST         25970093
259800                       EXEC SQL                                   25980093
259900                           OPEN COST-DESC-CSR                     25990093
260000                       END-EXEC                                   26000093
260100                   ELSE                                           26010093
260200                     IF DP020-INT-APPL-FORMAT-IND = PC-DESC       26020093
260300                         EXEC SQL                                 26030093
260400                             OPEN PURITM-CURSOR                   26040093
260500                         END-EXEC                                 26050093
260600                     END-IF                                       26060093
260700                   END-IF                                         26070093
260800                 END-IF                                           26080093
260900               END-IF                                             26090093
261000             END-IF                                               26100093
261100           END-IF                                                 26110093
261200         END-IF                                                   26120093
261300                                                                  26130093
261400         EVALUATE TRUE                                            26140093
261500             WHEN SQLCODE = ZERO                                  26150093
261600             WHEN SQLCODE = -904                                  26160093
261700             WHEN SQLCODE = -913                                  26170093
261800                  CONTINUE                                        26180093
261900                                                                  26190093
262000             WHEN SQLWARN0 NOT = SPACES                           26200093
262100             WHEN SQLCODE  NOT = ZERO                             26210093
262200                  MOVE '4030-OPEN-CURSOR'                         26220093
262300                                 TO DP013-PARAGRAPH               26230093
262400                  MOVE 'UNSUCCESSFUL PO ITEM CURSOR OPEN'         26240093
262500                                 TO DP013-MESSAGE-TEXT (1)        26250093
262600                  MOVE SQLCA TO DP013-SQLCA                       26260093
262700                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)      26270093
262800                  MOVE 'XLV_SKU' TO DP013-DB2-TABLE-NAME (2)      26280093
262900                  SET DP013-XCTL-DISPLAY-RESTART                  26290093
263000                      DP013-DB2-ABEND                             26300093
263100                                 TO TRUE                          26310093
263200                                                                  26320093
263300                  PERFORM DP013-0000-PROCESS-ABEND                26330093
263400         END-EVALUATE                                             26340093
263500     END-PERFORM.                                                 26350093
263600                                                                  26360093
263700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO  26370093
263800         MOVE '4030-OPEN-CURSOR' TO DP013-PARAGRAPH               26380093
263900         MOVE 'MAX RETRIES EXCEEDED ON PURITM CURSOR OPEN'        26390093
264000                                 TO DP013-MESSAGE-TEXT (1)        26400093
264100         MOVE SQLCA              TO DP013-SQLCA                   26410093
264200         MOVE 'TPURITM '         TO DP013-DB2-TABLE-NAME (1)      26420093
264300         MOVE 'XLV_SKU '         TO DP013-DB2-TABLE-NAME (2)      26430093
264400         SET DP013-XCTL-DISPLAY-RESTART                           26440093
264500             DP013-DB2-ABEND     TO TRUE                          26450093
264600                                                                  26460093
264700         PERFORM DP013-0000-PROCESS-ABEND                         26470093
264800     END-IF.                                                      26480093
264900                                                                  26490093
265000 4040-GET-PO-ITEMS.                                               26500093
265100                                                                  26510093
265200     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   26520093
265300         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    26530093
265400               ASC-NO-MORE-PO-ITEMS                               26540093
265500                                                                  26550093
265600         PERFORM 4042-FETCH-PO-ITEMS                              26560093
265700                                                                  26570093
265800         IF ASC-MORE-PO-ITEMS                                     26580093
265900             SET PS-PROCESS-PO       TO TRUE                      26590093
266000             MOVE PURITM-APP-PO-LNE-NBR                           26600093
266100                                    TO DP276-SEARCH-NBR           26610093
266200             PERFORM 4210-SEARCH-OTR                              26620093
266300             MOVE DP276-OTR-OUT   TO PV-OPEN-TO-REC               26630093
266400             MOVE DP276-OTR-OUT-X TO PV-OPEN-TO-REC-X             26640093
266500                                                                  26650093
266600             IF RC015-DISPLAY-Z-OTR = PC-N                        26660093
266700                 IF ASC-KEY-STR-NBR > ZEROS                       26670093
266800                     IF DP276-OTR-OUT NOT > ZERO                  26680093
266900                         SET PS-DONT-PROCESS-PO TO TRUE           26690093
267000                     END-IF                                       26700093
267100                 END-IF                                           26710093
267200             END-IF                                               26720093
267300         END-IF                                                   26730093
267400                                                                  26740093
267500*CLP 06/27/14 - START                                             26750093
267600         IF ASC-MORE-PO-ITEMS                                     26760093
267700            AND PS-PROCESS-PO                                     26770093
267800            AND PV-PKGNG-CDE > SPACE                              26780093
267900            PERFORM 4300-CHECK-CA-LINES                           26790093
268000         END-IF                                                   26800093
268100*CLP 06/27/14 - END                                               26810093
268200                                                                  26820093
268300         IF ASC-MORE-PO-ITEMS                                     26830093
268400            AND PS-PROCESS-PO                                     26840093
268500             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 26850093
268600                 ADD +1          TO ASC-ITEM-SUB                  26860093
268700             ELSE                                                 26870093
268800                 ADD +1          TO ASC-BLK-SUB                   26880093
268900                 MOVE +1         TO ASC-ITEM-SUB                  26890093
269000                                                                  26900093
269100                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          26910093
269200                     MOVE +1     TO ASC-BLK-SUB                   26920093
269300                     SET ASC-BLOCK-MODIFIED (1)                   26930093
269400                                 TO TRUE                          26940093
269500                                                                  26950093
269600                     PERFORM 5100-WRITE-TEMP-STORAGE              26960093
269700                                                                  26970093
269800                     MOVE ASC-BLOCK-ENTRIES                       26980093
269900                                          (PC-MAX-BLOCKS-IN-ARRAY)26990093
270000                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)27000093
270100                     ADD +1      TO ASC-BLK-SUB                   27010093
270200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   27020093
270300                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     27030093
270400                                 TO TRUE                          27040093
270500                 END-IF                                           27050093
270600             END-IF                                               27060093
270700             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      27070093
270800             MOVE ASC-NUMBER-OF-ITEMS-READ                        27080093
270900                                 TO ASC-LIST-ITEM-NUMBER          27090093
271000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27100093
271100             MOVE PURITM-APP-PO-LNE-NBR                           27110093
271200                                 TO ASC-PKSL-LNE-NBR-N            27120093
271300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27130093
271400             MOVE PURITM-VEND-STYL-NAME                           27140093
271500                                 TO ASC-VEND-STYL-NAME            27150093
271600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27160093
271700             MOVE PURITM-COLOR-DESC                               27170093
271800                                 TO ASC-COLOR-DESC                27180093
271900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27190093
272000             INSPECT ASC-COLOR-DESC (ASC-BLK-SUB ASC-ITEM-SUB)    27200093
272100                 REPLACING ALL LOW-VALUES BY SPACES               27210093
272200             MOVE PV-OPEN-TO-REC TO ASC-OTR-QTY                   27220093
272300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27230093
272400             MOVE PV-OPEN-TO-REC-X TO ASC-OPEN-TO-REC             27240093
272500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27250093
272600             MOVE PURITM-UNT-COST-AMT                             27260093
272700                                 TO ASC-UNT-COST-AMT-N            27270093
272800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27280093
272900             MOVE PURITM-SKU-DESC                                 27290093
273000                                 TO ASC-VEND-DESC                 27300093
273100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27310093
273200             MOVE PURITM-SIZE-DESC                                27320093
273300                                 TO ASC-SIZE-DESC                 27330093
273400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27340093
273500             MOVE PV-CLASS-NBR   TO ASC-CL-NBR                    27350093
273600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27360093
273700             MOVE PV-SKU-NBR                                      27370093
273800                                 TO ASC-SKU-SEQ-NBR               27380093
273900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27390093
274000             MOVE PURITM-VER-NBR TO ASC-PURITM-VER-NBR            27400093
274100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27410093
274200             MOVE PURITM-PO-LNE-NBR                               27420093
274300                                 TO ASC-PO-LNE-NBR-N              27430093
274400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27440093
274500             MOVE PURITM-STATUS-CDE                               27450093
274600                                 TO ASC-PURITM-STATUS             27460093
274700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27470093
274800         END-IF                                                   27480093
274900     END-PERFORM.                                                 27490093
275000                                                                  27500093
275100     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           27510093
275200         MOVE +1                 TO ASC-BLK-SUB                   27520093
275300                                                                  27530093
275400         PERFORM 5100-WRITE-TEMP-STORAGE                          27540093
275500                                                                  27550093
275600         ADD +1                  TO ASC-BLK-SUB                   27560093
275700                                                                  27570093
275800         PERFORM 5100-WRITE-TEMP-STORAGE                          27580093
275900                                                                  27590093
276000         MOVE +1                 TO ASC-BLK-SUB                   27600093
276100                                    PV-BLOCK-NUMBER               27610093
276200                                                                  27620093
276300         PERFORM 4410-READ-TEMP-STORAGE                           27630093
276400                                                                  27640093
276500         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         27650093
276600             MOVE +2             TO ASC-BLK-SUB                   27660093
276700                                    PV-BLOCK-NUMBER               27670093
276800                                                                  27680093
276900             PERFORM 4410-READ-TEMP-STORAGE                       27690093
277000         END-IF                                                   27700093
277100     END-IF.                                                      27710093
277200                                                                  27720093
277300 4042-FETCH-PO-ITEMS.                                             27730093
277400                                                                  27740093
277500     IF DP020-INT-APPL-FORMAT-IND = PC-STYL-CLR-SIZE              27750093
277600         EXEC SQL                                                 27760093
277700              FETCH  STYL-CLR-SIZ-CSR                             27770093
277800               INTO :PURITM-PO-NBR,                               27780093
277900                    :PURITM-VER-NBR,                              27790093
278000                    :PURITM-PO-LNE-NBR,                           27800093
278100                    :PURITM-SKU-SEQ-NBR,                          27810093
278200                    :PURITM-VEND-STYL-NAME,                       27820093
278300                    :PURITM-COLOR-DESC,                           27830093
278400                    :PURITM-SIZE-DESC,                            27840093
278500                    :PURITM-UNT-QTY,                              27850093
278600                    :PURITM-UNT-COST-AMT,                         27860093
278700                    :PURITM-ITM-NBR,                              27870093
278800                    :PURITM-SKU-DESC,                             27880093
278900                    :PURITM-APP-PO-LNE-NBR,                       27890093
279000                    :PURITM-STATUS-CDE,                           27900093
279100*CLP 06/27/14 - START                                             27910093
279200                    :PURITM-PO-PREPK-ID                           27920093
279300*CLP 06/27/14 - END                                               27930093
279400         END-EXEC                                                 27940093
279500     END-IF.                                                      27950093
279600     IF DP020-INT-APPL-FORMAT-IND = PC-STYL-SIZE-CLR              27960093
279700         EXEC SQL                                                 27970093
279800              FETCH  STYL-SIZ-CLR-CSR                             27980093
279900               INTO :PURITM-PO-NBR,                               27990093
280000                    :PURITM-VER-NBR,                              28000093
280100                    :PURITM-PO-LNE-NBR,                           28010093
280200                    :PURITM-SKU-SEQ-NBR,                          28020093
280300                    :PURITM-VEND-STYL-NAME,                       28030093
280400                    :PURITM-COLOR-DESC,                           28040093
280500                    :PURITM-SIZE-DESC,                            28050093
280600                    :PURITM-UNT-QTY,                              28060093
280700                    :PURITM-UNT-COST-AMT,                         28070093
280800                    :PURITM-ITM-NBR,                              28080093
280900                    :PURITM-SKU-DESC,                             28090093
281000                    :PURITM-APP-PO-LNE-NBR,                       28100093
281100                    :PURITM-STATUS-CDE,                           28110093
281200*CLP 06/27/14 - START                                             28120093
281300                    :PURITM-PO-PREPK-ID                           28130093
281400*CLP 06/27/14 - END                                               28140093
281500         END-EXEC                                                 28150093
281600     END-IF.                                                      28160093
281700     IF DP020-INT-APPL-FORMAT-IND = PC-COLOR                      28170093
281800         EXEC SQL                                                 28180093
281900              FETCH  COLOR-SIZE-CSR                               28190093
282000               INTO :PURITM-PO-NBR,                               28200093
282100                    :PURITM-VER-NBR,                              28210093
282200                    :PURITM-PO-LNE-NBR,                           28220093
282300                    :PURITM-SKU-SEQ-NBR,                          28230093
282400                    :PURITM-VEND-STYL-NAME,                       28240093
282500                    :PURITM-COLOR-DESC,                           28250093
282600                    :PURITM-SIZE-DESC,                            28260093
282700                    :PURITM-UNT-QTY,                              28270093
282800                    :PURITM-UNT-COST-AMT,                         28280093
282900                    :PURITM-ITM-NBR,                              28290093
283000                    :PURITM-SKU-DESC,                             28300093
283100                    :PURITM-APP-PO-LNE-NBR,                       28310093
283200                    :PURITM-STATUS-CDE,                           28320093
283300*CLP 06/27/14 - START                                             28330093
283400                    :PURITM-PO-PREPK-ID                           28340093
283500*CLP 06/27/14 - END                                               28350093
283600         END-EXEC                                                 28360093
283700     END-IF.                                                      28370093
283800     IF DP020-INT-APPL-FORMAT-IND = PC-SIZE                       28380093
283900         EXEC SQL                                                 28390093
284000              FETCH  SIZE-COLOR-CSR                               28400093
284100               INTO :PURITM-PO-NBR,                               28410093
284200                    :PURITM-VER-NBR,                              28420093
284300                    :PURITM-PO-LNE-NBR,                           28430093
284400                    :PURITM-SKU-SEQ-NBR,                          28440093
284500                    :PURITM-VEND-STYL-NAME,                       28450093
284600                    :PURITM-COLOR-DESC,                           28460093
284700                    :PURITM-SIZE-DESC,                            28470093
284800                    :PURITM-UNT-QTY,                              28480093
284900                    :PURITM-UNT-COST-AMT,                         28490093
285000                    :PURITM-ITM-NBR,                              28500093
285100                    :PURITM-SKU-DESC,                             28510093
285200                    :PURITM-APP-PO-LNE-NBR,                       28520093
285300                    :PURITM-STATUS-CDE,                           28530093
285400*CLP 06/27/14 - START                                             28540093
285500                    :PURITM-PO-PREPK-ID                           28550093
285600*CLP 06/27/14 - END                                               28560093
285700         END-EXEC                                                 28570093
285800     END-IF.                                                      28580093
285900     IF DP020-INT-APPL-FORMAT-IND = PC-SKU                        28590093
286000         EXEC SQL                                                 28600093
286100              FETCH  SKU-COLOR-CSR                                28610093
286200               INTO :PURITM-PO-NBR,                               28620093
286300                    :PURITM-VER-NBR,                              28630093
286400                    :PURITM-PO-LNE-NBR,                           28640093
286500                    :PURITM-SKU-SEQ-NBR,                          28650093
286600                    :PURITM-VEND-STYL-NAME,                       28660093
286700                    :PURITM-COLOR-DESC,                           28670093
286800                    :PURITM-SIZE-DESC,                            28680093
286900                    :PURITM-UNT-QTY,                              28690093
287000                    :PURITM-UNT-COST-AMT,                         28700093
287100                    :PURITM-ITM-NBR,                              28710093
287200                    :PURITM-SKU-DESC,                             28720093
287300                    :PURITM-APP-PO-LNE-NBR,                       28730093
287400                    :PURITM-STATUS-CDE,                           28740093
287500                    :XLV00001-SUB-CL-NBR,                         28750093
287600*CLP 06/27/14 - START                                             28760093
287700                    :PURITM-PO-PREPK-ID                           28770093
287800*CLP 06/27/14 - END                                               28780093
287900         END-EXEC                                                 28790093
288000     END-IF.                                                      28800093
288100     IF DP020-INT-APPL-FORMAT-IND = PC-COST                       28810093
288200         EXEC SQL                                                 28820093
288300              FETCH  COST-DESC-CSR                                28830093
288400               INTO :PURITM-PO-NBR,                               28840093
288500                    :PURITM-VER-NBR,                              28850093
288600                    :PURITM-PO-LNE-NBR,                           28860093
288700                    :PURITM-SKU-SEQ-NBR,                          28870093
288800                    :PURITM-VEND-STYL-NAME,                       28880093
288900                    :PURITM-COLOR-DESC,                           28890093
289000                    :PURITM-SIZE-DESC,                            28900093
289100                    :PURITM-UNT-QTY,                              28910093
289200                    :PURITM-UNT-COST-AMT,                         28920093
289300                    :PURITM-ITM-NBR,                              28930093
289400                    :PURITM-SKU-DESC,                             28940093
289500                    :PURITM-APP-PO-LNE-NBR,                       28950093
289600                    :PURITM-STATUS-CDE,                           28960093
289700*CLP 06/27/14 - START                                             28970093
289800                    :PURITM-PO-PREPK-ID                           28980093
289900*CLP 06/27/14 - END                                               28990093
290000         END-EXEC                                                 29000093
290100     END-IF.                                                      29010093
290200     IF DP020-INT-APPL-FORMAT-IND = PC-DESC                       29020093
290300         EXEC SQL                                                 29030093
290400              FETCH  PURITM-CURSOR                                29040093
290500               INTO :PURITM-PO-NBR,                               29050093
290600                    :PURITM-VER-NBR,                              29060093
290700                    :PURITM-PO-LNE-NBR,                           29070093
290800                    :PURITM-SKU-SEQ-NBR,                          29080093
290900                    :PURITM-VEND-STYL-NAME,                       29090093
291000                    :PURITM-COLOR-DESC,                           29100093
291100                    :PURITM-SIZE-DESC,                            29110093
291200                    :PURITM-UNT-QTY,                              29120093
291300                    :PURITM-UNT-COST-AMT,                         29130093
291400                    :PURITM-ITM-NBR,                              29140093
291500                    :PURITM-SKU-DESC,                             29150093
291600                    :PURITM-APP-PO-LNE-NBR,                       29160093
291700                    :PURITM-STATUS-CDE,                           29170093
291800*CLP 06/27/14 - START                                             29180093
291900                    :PURITM-PO-PREPK-ID                           29190093
292000*CLP 06/27/14 - END                                               29200093
292100         END-EXEC                                                 29210093
292200     END-IF.                                                      29220093
292300                                                                  29230093
292400     EVALUATE TRUE                                                29240093
292500         WHEN SQLCODE = ZERO                                      29250093
292600             IF DP020-INT-APPL-FORMAT-IND = PC-SKU                29260093
292700                MOVE XLV00001-SUB-CL-NBR                          29270093
292800                                       TO PV-CLASS-NBR            29280093
292900             END-IF                                               29290093
293000             IF PURITM-SKU-SEQ-NBR = '000'                        29300093
293100                 MOVE PC-SKU-ZEROS     TO PV-SKU-NBR              29310093
293200             ELSE                                                 29320093
293300                 IF PURITM-SKU-SEQ-NBR = '999'                    29330093
293400                     MOVE PC-SKU-NINES TO PV-SKU-NBR              29340093
293500                 ELSE                                             29350093
293600                     MOVE PURITM-ITM-NBR TO DK-ITM-NBR            29360093
293700                     PERFORM 4500-NEW-SKU-CHECK                   29370093
293800                 END-IF                                           29380093
293900             END-IF                                               29390093
294000         WHEN SQLCODE = +100                                      29400093
294100              CONTINUE                                            29410093
294200                                                                  29420093
294300         WHEN SQLWARN0 NOT = SPACES                               29430093
294400         WHEN SQLCODE  NOT = ZERO                                 29440093
294500              MOVE '4042-FETCH-PO-ITEMS'                          29450093
294600                                 TO DP013-PARAGRAPH               29460093
294700              MOVE 'UNSUCCESSFUL FETCH OF PO ITEM CURSOR'         29470093
294800                                 TO DP013-MESSAGE-TEXT (1)        29480093
294900              MOVE SQLCA         TO DP013-SQLCA                   29490093
295000              MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (1)      29500093
295100              SET DP013-DB2-ABEND                                 29510093
295200                  DP013-XCTL-DISPLAY-RESTART                      29520093
295300                                 TO TRUE                          29530093
295400                                                                  29540093
295500              PERFORM DP013-0000-PROCESS-ABEND                    29550093
295600     END-EVALUATE.                                                29560093
295700                                                                  29570093
295800     IF SQLCODE = +100                                            29580093
295900         SET ASC-NO-MORE-PO-ITEMS                                 29590093
296000                                 TO TRUE                          29600093
296100     END-IF.                                                      29610093
296200                                                                  29620093
296300 4050-CLOSE-CURSOR.                                               29630093
296400                                                                  29640093
296500     IF DP020-INT-APPL-FORMAT-IND = PC-STYL-CLR-SIZE              29650093
296600         EXEC SQL                                                 29660093
296700              CLOSE STYL-CLR-SIZ-CSR                              29670093
296800         END-EXEC                                                 29680093
296900     ELSE                                                         29690093
297000       IF DP020-INT-APPL-FORMAT-IND = PC-STYL-SIZE-CLR            29700093
297100           EXEC SQL                                               29710093
297200                CLOSE STYL-SIZ-CLR-CSR                            29720093
297300           END-EXEC                                               29730093
297400       ELSE                                                       29740093
297500         IF DP020-INT-APPL-FORMAT-IND = PC-COLOR                  29750093
297600             EXEC SQL                                             29760093
297700                  CLOSE COLOR-SIZE-CSR                            29770093
297800             END-EXEC                                             29780093
297900         ELSE                                                     29790093
298000           IF DP020-INT-APPL-FORMAT-IND = PC-SIZE                 29800093
298100               EXEC SQL                                           29810093
298200                    CLOSE SIZE-COLOR-CSR                          29820093
298300               END-EXEC                                           29830093
298400           ELSE                                                   29840093
298500             IF DP020-INT-APPL-FORMAT-IND = PC-SKU                29850093
298600                 EXEC SQL                                         29860093
298700                      CLOSE SKU-COLOR-CSR                         29870093
298800                 END-EXEC                                         29880093
298900             ELSE                                                 29890093
299000               IF DP020-INT-APPL-FORMAT-IND = PC-COST             29900093
299100                   EXEC SQL                                       29910093
299200                        CLOSE COST-DESC-CSR                       29920093
299300                   END-EXEC                                       29930093
299400               ELSE                                               29940093
299500                 IF DP020-INT-APPL-FORMAT-IND = PC-DESC           29950093
299600                     EXEC SQL                                     29960093
299700                          CLOSE PURITM-CURSOR                     29970093
299800                     END-EXEC                                     29980093
299900                 END-IF                                           29990093
300000               END-IF                                             30000093
300100             END-IF                                               30010093
300200           END-IF                                                 30020093
300300         END-IF                                                   30030093
300400       END-IF                                                     30040093
300500     END-IF.                                                      30050093
300600                                                                  30060093
300700     EVALUATE TRUE                                                30070093
300800         WHEN SQLCODE = ZERO                                      30080093
300900              CONTINUE                                            30090093
301000                                                                  30100093
301100         WHEN SQLWARN0 NOT = SPACES                               30110093
301200         WHEN SQLCODE  NOT = ZERO                                 30120093
301300              MOVE '4050-CLOSE-CURSOR'                            30130093
301400                                 TO DP013-PARAGRAPH               30140093
301500              MOVE 'UNSUCCESSFUL PO ITEM CURSOR CLOSE'            30150093
301600                                 TO DP013-MESSAGE-TEXT (1)        30160093
301700              MOVE SQLCA TO DP013-SQLCA                           30170093
301800              MOVE 'TPURITM '    TO DP013-DB2-TABLE-NAME (1)      30180093
301900              SET DP013-DB2-ABEND                                 30190093
302000                  DP013-XCTL-DISPLAY-RESTART                      30200093
302100                                 TO TRUE                          30210093
302200                                                                  30220093
302300              PERFORM DP013-0000-PROCESS-ABEND                    30230093
302400     END-EVALUATE.                                                30240093
302500                                                                  30250093
302600 4060-CHECK-PO-STATUS.                                            30260093
302700                                                                  30270093
302800     PERFORM WITH TEST AFTER                                      30280093
302900         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    30290093
303000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             30300093
303100                 SQLCODE = ZERO OR                                30310093
303200                 SQLCODE = +100                                   30320093
303300                                                                  30330093
303400*CLP 06/27/14 - ADD PACKAGING CODE                                30340093
303500         EXEC SQL                                                 30350093
303600              SELECT STATUS_CDE                                   30360093
303700                    ,PKGNG_CDE                                    30370094
303800                INTO :PV-STATUS-CDE                               30380093
303900                    ,:PV-PKGNG-CDE                                30390093
304000                FROM TPURCHS                                      30400093
304100               WHERE VER_STATUS_CDE = :PC-ACTIVE                  30410093
304200                 AND PO_NBR         = :DK-PO-NBR                  30420093
304300         END-EXEC                                                 30430093
304400                                                                  30440093
304500         EVALUATE TRUE                                            30450093
304600             WHEN SQLCODE = ZERO                                  30460093
304700             WHEN SQLCODE = +100                                  30470093
304800             WHEN SQLCODE = -904                                  30480093
304900             WHEN SQLCODE = -913                                  30490093
305000                  CONTINUE                                        30500093
305100                                                                  30510093
305200             WHEN SQLWARN0 NOT = SPACES                           30520093
305300             WHEN SQLCODE  NOT = ZERO                             30530093
305400                  MOVE '4060-CHECK-PO-STATUS'                     30540093
305500                                 TO DP013-PARAGRAPH               30550093
305600                  MOVE 'UNSUCCESSFUL SELECT OF PO STATUS'         30560093
305700                                 TO DP013-MESSAGE-TEXT (1)        30570093
305800                  MOVE SQLCA     TO DP013-SQLCA                   30580093
305900                  MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)      30590093
306000                  SET DP013-DB2-ABEND                             30600093
306100                      DP013-XCTL-DISPLAY-RESTART                  30610093
306200                                 TO TRUE                          30620093
306300                                                                  30630093
306400                  PERFORM DP013-0000-PROCESS-ABEND                30640093
306500         END-EVALUATE                                             30650093
306600     END-PERFORM.                                                 30660093
306700                                                                  30670093
306800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO  30680093
306900         MOVE '4060-CHECK-PO-STATUS'                              30690093
307000                                 TO DP013-PARAGRAPH               30700093
307100         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO STATUS'          30710093
307200                                 TO DP013-MESSAGE-TEXT (1)        30720093
307300         MOVE SQLCA              TO DP013-SQLCA                   30730093
307400         MOVE 'TPURCHS '         TO DP013-DB2-TABLE-NAME (1)      30740093
307500         SET DP013-XCTL-DISPLAY-RESTART                           30750093
307600             DP013-DB2-ABEND     TO TRUE                          30760093
307700                                                                  30770093
307800         PERFORM DP013-0000-PROCESS-ABEND                         30780093
307900     END-IF.                                                      30790093
308000                                                                  30800093
308100     IF SQLCODE = ZERO                                            30810093
308200         IF PV-VALID-STATUS-CDE                                   30820093
308300             CONTINUE                                             30830093
308400         ELSE                                                     30840093
308500             SET DP020-NEXT-ACT-APPL-ERROR                        30850093
308600                 PS-ERROR                                         30860093
308700                 DP020-MSG-FATAL TO TRUE                          30870093
308800             MOVE PC-TSYMSG-00168                                 30880093
308900                                 TO DP020-MSG-NUMBER              30890093
309000         END-IF                                                   30900093
309100     ELSE                                                         30910093
309200         IF SQLCODE = +100                                        30920093
309300             SET DP020-NEXT-ACT-APPL-ERROR                        30930093
309400                 PS-ERROR                                         30940093
309500                 DP020-MSG-FATAL TO TRUE                          30950093
309600             MOVE PC-TSYMSG-00726                                 30960093
309700                                 TO DP020-MSG-NUMBER              30970093
309800         END-IF                                                   30980093
309900     END-IF.                                                      30990093
310000/                                                                 31000093
310100 4200-CALC-OPEN-TO-REC.                                           31010093
310200                                                                  31020093
310300     SET DP276-LINE-LEVEL-OTR                                     31030093
310400         DP276-PO-OTR            TO TRUE                          31040093
310500                                                                  31050093
310600     INITIALIZE DP276-KEYS                                        31060093
310700     MOVE DK-PO-NBR              TO DP276-PO-NBR                  31070093
310800     MOVE PURITM-PO-LNE-NBR      TO DP276-PO-LNE-NBR              31080093
310900     MOVE ASC-KEY-REC-SEQ-NBR    TO DP276-REC-SEQ-NBR             31090093
311000     MOVE ASC-KEY-OPER-UNT-ID    TO DP276-OPER-UNT-ID             31100093
311100     MOVE ASC-KEY-FCLTY-ID       TO DP276-FCLTY-ID                31110093
311200     MOVE ASC-KEY-STR-NBR        TO DP276-STR-NBR.                31120093
311300     COPY DPPD276.                                                31130093
311400/                                                                 31140093
311500*CLP 06/27/14 - START                                             31150093
311600******************************************************************31160093
311700*  CHECK THE PKGNG CODE, PREPK-ID AND CANCEL STATUS TO DETERMINE  31170093
311800*  IF ROW SHOULD NOT BE DISPLAYED ON SCREEN                       31180093
311900*                                                                 31190093
312000*    IF 'I' OR 'M' PKGNG-CDE THEN BYPASS THIS ROW IF PREPK-ID = 0 31200093
312100*          AND 'CA' STATUS                                        31210093
312200*       OR IF PKGNG NOT 'I' OR 'M' THEN BYPASS IF PREPK-ID > 0    31220093
312300*          AND 'CA' STATUS                                        31230093
312400******************************************************************31240093
312500 4300-CHECK-CA-LINES.                                             31250093
312600                                                                  31260093
312700     IF PV-PKGNG-CDE = PC-I OR PC-M                               31270093
312800         IF PURITM-PO-PREPK-ID = 0                                31280093
312900             IF PURITM-STATUS-CDE = PC-CA                         31290093
313000                SET PS-DONT-PROCESS-PO TO TRUE                    31300093
313100             END-IF                                               31310093
313200         END-IF                                                   31320093
313300     ELSE                                                         31330093
313400         IF PURITM-PO-PREPK-ID > 0                                31340093
313500            AND PURITM-STATUS-CDE = PC-CA                         31350093
313600                SET PS-DONT-PROCESS-PO TO TRUE                    31360093
313700         END-IF                                                   31370093
313800     END-IF.                                                      31380093
313900                                                                  31390093
314000*CLP 06/25/14 - END                                               31400093
314100 4400-MOVE-COMMAREA-TO-SCREEN.                                    31410093
314200                                                                  31420093
314300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         31430093
314400           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         31440093
314500           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            31450093
314600             MOVE +1             TO ASC-BLK-SUB                   31460093
314700                                                                  31470093
314800             PERFORM 5100-WRITE-TEMP-STORAGE                      31480093
314900                                                                  31490093
315000             ADD +1              TO ASC-BLK-SUB                   31500093
315100                                                                  31510093
315200             PERFORM 5100-WRITE-TEMP-STORAGE                      31520093
315300                                                                  31530093
315400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             31540093
315500                 GIVING PV-BLOCK-NUMBER                           31550093
315600                 REMAINDER PV-REMAINDER                           31560093
315700             IF PV-REMAINDER > ZERO                               31570093
315800                 ADD +1          TO PV-BLOCK-NUMBER               31580093
315900             END-IF                                               31590093
316000             MOVE +1             TO ASC-BLK-SUB                   31600093
316100                                                                  31610093
316200             PERFORM 4410-READ-TEMP-STORAGE                       31620093
316300                                                                  31630093
316400             ADD +1              TO ASC-BLK-SUB                   31640093
316500                                    PV-BLOCK-NUMBER               31650093
316600                                                                  31660093
316700             PERFORM 4410-READ-TEMP-STORAGE                       31670093
316800                                                                  31680093
316900     END-IF.                                                      31690093
317000                                                                  31700093
317100     MOVE +1                     TO ASC-BLK-SUB.                  31710093
317200     COMPUTE ASC-ITEM-SUB =                                       31720093
317300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              31730093
317400                       + PC-ITEMS-PER-PANEL).                     31740093
317500                                                                  31750093
317600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         31760093
317700         ADD +1                  TO ASC-BLK-SUB                   31770093
317800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            31780093
317900     END-IF.                                                      31790093
318000                                                                  31800093
318100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           31810093
318200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                31820093
318300                                                                  31830093
318400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        31840093
318500                                                                  31850093
318600     IF DP020-INT-APPL-FORMAT-IND = PC-STYL-CLR-SIZE              31860093
318700         MOVE PC-HDR-STYLE TO ATYPEO                              31870093
318800     ELSE                                                         31880093
318900       IF DP020-INT-APPL-FORMAT-IND = PC-STYL-SIZE-CLR            31890093
319000           MOVE PC-HDR-STYLE TO ATYPEO                            31900093
319100       ELSE                                                       31910093
319200         IF DP020-INT-APPL-FORMAT-IND = PC-COLOR                  31920093
319300             MOVE PC-HDR-COLOR TO ATYPEO                          31930093
319400         ELSE                                                     31940093
319500           IF DP020-INT-APPL-FORMAT-IND = PC-SIZE                 31950093
319600               MOVE PC-HDR-SIZE TO ATYPEO                         31960093
319700           ELSE                                                   31970093
319800             IF DP020-INT-APPL-FORMAT-IND = PC-SKU                31980093
319900                 MOVE PC-HDR-SKU TO ATYPEO                        31990093
320000             ELSE                                                 32000093
320100               IF DP020-INT-APPL-FORMAT-IND = PC-COST             32010093
320200                   MOVE PC-HDR-COST TO ATYPEO                     32020093
320300               ELSE                                               32030093
320400                 IF DP020-INT-APPL-FORMAT-IND = PC-DESC           32040093
320500                     MOVE PC-HDR-DESC TO ATYPEO                   32050093
320600                 END-IF                                           32060093
320700               END-IF                                             32070093
320800             END-IF                                               32080093
320900           END-IF                                                 32090093
321000         END-IF                                                   32100093
321100       END-IF                                                     32110093
321200     END-IF.                                                      32120093
321300     PERFORM 4420-FORMAT-LIST-LINES                               32130093
321400         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            32140093
321500         UNTIL   PV-SUB < +1.                                     32150093
321600                                                                  32160093
321700     COMPUTE ASC-ITEMS-DISPLAYED =                                32170093
321800                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).32180093
321900     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      32190093
322000                                    ASTRTITO.                     32200093
322100     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                32210093
322200                                 TO AENDITO.                      32220093
322300     MOVE ASC-NUMBER-OF-ITEMS-READ                                32230093
322400                                 TO ATOTITO.                      32240093
322500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32250093
322600                                 TO ASELITO.                      32260093
322700                                                                  32270093
322800     MOVE ASC-KEY-PO-NBR-N       TO APOO.                         32280093
322900     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       32290093
323000     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      32300093
323100     MOVE ASC-KEY-PKSL-NBR       TO APKSLIPO.                     32310093
323200     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       32320093
323300     MOVE ASC-KEY-STR-NBR        TO ASTRO.                        32330093
323400                                                                  32340093
323500     IF DP020-MSG-NUMBER-X = SPACE                                32350093
323600        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    32360093
323700            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              32370093
323800            SET DP020-MSG-INFORMATIONAL                           32380093
323900                                 TO TRUE                          32390093
324000        END-IF                                                    32400093
324100     END-IF.                                                      32410093
324200                                                                  32420093
324300 4410-READ-TEMP-STORAGE.                                          32430093
324400                                                                  32440093
324500     EXEC CICS READQ TS                                           32450093
324600               QUEUE (ASC-LIST-QUEUE-NAME)                        32460093
324700               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            32470093
324800               ITEM  (PV-BLOCK-NUMBER)                            32480093
324900               RESP  (PV-CICS-RESP)                               32490093
325000     END-EXEC.                                                    32500093
325100                                                                  32510093
325200     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     32520093
325300         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      32530093
325400         CONTINUE                                                 32540093
325500     ELSE                                                         32550093
325600         SET DP013-CICS-ABEND                                     32560093
325700             DP013-NO-ROLLBACK   TO TRUE                          32570093
325800         MOVE '4410-READ-TEMP-STORAGE'                            32580093
325900                                 TO DP013-PARAGRAPH               32590093
326000         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   32600093
326100                                 TO DP013-MESSAGE-TEXT (1)        32610093
326200                                                                  32620093
326300         PERFORM DP013-0000-PROCESS-ABEND                         32630093
326400     END-IF.                                                      32640093
326500                                                                  32650093
326600     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     32660093
326700                                 TO TRUE.                         32670093
326800                                                                  32680093
326900     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          32690093
327000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               32700093
327100     END-IF.                                                      32710093
327200                                                                  32720093
327300 4420-FORMAT-LIST-LINES.                                          32730093
327400                                                                  32740093
327500     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       32750093
327600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                32760093
327700         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     32770093
327800                                    MR-PKSL-ITM-QTY-A(PV-SUB)     32780093
327900         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     32790093
328000                                    MR-PKSL-ITM-QTY  (PV-SUB)     32800093
328100                                    MR-LINE          (PV-SUB)     32810093
328200                                    MR-VEND-STYL-NAME(PV-SUB)     32820093
328300                                    MR-COLOR-DESC    (PV-SUB)     32830093
328400                                    MR-OTR           (PV-SUB)     32840093
328500                                    MR-UNT-COST-AMT  (PV-SUB)     32850093
328600                                    MR-VEND-DESC     (PV-SUB)     32860093
328700                                    MR-SIZE-DESC     (PV-SUB)     32870093
328800                                    MR-CL-NBR        (PV-SUB)     32880093
328900                                    MR-SKU-SEQ-NBR   (PV-SUB)     32890093
329000                                    MR-STATUS        (PV-SUB)     32900093
329100     ELSE                                                         32910093
329200         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     32920093
329300                                                             SPACE32930093
329400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32940093
329500                                 TO MR-SELECTI (PV-SUB)           32950093
329600         ELSE                                                     32960093
329700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32970093
329800                                 TO MR-SELECTI (PV-SUB)           32980093
329900         END-IF                                                   32990093
330000                                                                  33000093
330100         IF DP030-SET-CURSOR-TRAILER                              33010093
330200            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  33020093
330300                                                             SPACE33030093
330400               OR PV-SUB = 1                                      33040093
330500                SET DP030-SET-CURSOR-APPL-1                       33050093
330600                                 TO TRUE                          33060093
330700                MOVE -1          TO MR-SELECTL (PV-SUB)           33070093
330800            END-IF                                                33080093
330900         END-IF                                                   33090093
331000                                                                  33100093
331100         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            33110093
331200             MOVE ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)   33120093
331300                                 TO MR-PKSL-ITM-QTY-EDITED        33130093
331400                                                       (PV-SUB)   33140093
331500             MOVE ASC-PKSL-LNE-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)   33150093
331600                                 TO MR-LINE            (PV-SUB)   33160093
331700             MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB)   33170093
331800                                 TO MR-VEND-STYL-NAME  (PV-SUB)   33180093
331900             MOVE ASC-COLOR-DESC     (ASC-BLK-SUB ASC-ITEM-SUB)   33190093
332000                                 TO MR-COLOR-DESC      (PV-SUB)   33200093
332100             MOVE ASC-OPEN-TO-REC    (ASC-BLK-SUB ASC-ITEM-SUB)   33210093
332200                                 TO MR-OTR             (PV-SUB)   33220093
332300             MOVE ASC-UNT-COST-AMT-N (ASC-BLK-SUB ASC-ITEM-SUB)   33230093
332400                                 TO MR-UNT-COST-AMT-EDITED        33240093
332500                                                       (PV-SUB)   33250093
332600             MOVE ASC-VEND-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   33260093
332700                                 TO MR-VEND-DESC       (PV-SUB)   33270093
332800             MOVE ASC-SIZE-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   33280093
332900                                 TO MR-SIZE-DESC       (PV-SUB)   33290093
333000             MOVE ASC-CL-NBR         (ASC-BLK-SUB ASC-ITEM-SUB)   33300093
333100                                 TO MR-CL-NBR          (PV-SUB)   33310093
333200             MOVE ASC-SKU-SEQ-NBR-N  (ASC-BLK-SUB ASC-ITEM-SUB)   33320093
333300                                 TO MR-SKU-SEQ-NBR-EDITED         33330093
333400                                                       (PV-SUB)   33340093
333500             MOVE ASC-PURITM-STATUS  (ASC-BLK-SUB ASC-ITEM-SUB)   33350093
333600                                 TO MR-STATUS          (PV-SUB)   33360093
333700         END-IF                                                   33370093
333800                                                                  33380093
333900         IF ASC-PURITM-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) = PC-RV  33390093
334000             MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)        33400093
334100                                     MR-PKSL-ITM-QTY-A (PV-SUB)   33410093
334200         ELSE                                                     33420093
334300             MOVE DP015-UNP-ALP-NOR-OFF                           33430093
334400                                    TO MR-SELECTA (PV-SUB)        33440093
334500             MOVE DP015-UNP-NUM-NOR-OFF                           33450093
334600                                    TO MR-PKSL-ITM-QTY-A (PV-SUB) 33460093
334700             MOVE DP015-GREEN                                     33470093
334800                                    TO MR-SELECTC (PV-SUB)        33480093
334900                                       MR-PKSL-ITM-QTY-C (PV-SUB) 33490093
335000             MOVE DP015-UNDERLINE                                 33500093
335100                                   TO MR-SELECTH (PV-SUB)         33510093
335200                                      MR-PKSL-ITM-QTY-H (PV-SUB)  33520093
335300         END-IF                                                   33530093
335400     END-IF.                                                      33540093
335500                                                                  33550093
335600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               33560093
335700                                                                  33570093
335800     IF ASC-ITEM-SUB < +1                                         33580093
335900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  33590093
336000         MOVE +1                 TO ASC-BLK-SUB.                  33600093
336100                                                                  33610093
336200 4430-CHECK-FOR-BEGIN-AND-END.                                    33620093
336300                                                                  33630093
336400     IF ASC-START-OF-SELECTED-RANGE > ZERO                        33640093
336500        IF ASC-END-OF-SELECTED-RANGE = ZERO                       33650093
336600            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              33660093
336700            SET DP020-MSG-WARNING                                 33670093
336800                                 TO TRUE                          33680093
336900                                                                  33690093
337000            PERFORM 4431-POSITION-AT-WARNING                      33700093
337100                                                                  33710093
337200         END-IF                                                   33720093
337300     ELSE                                                         33730093
337400         IF ASC-END-OF-SELECTED-RANGE > ZERO                      33740093
337500             MOVE PC-TSYMSG-00053                                 33750093
337600                                 TO DP020-MSG-NUMBER              33760093
337700             SET DP020-MSG-WARNING                                33770093
337800                                 TO TRUE                          33780093
337900                                                                  33790093
338000             PERFORM 4431-POSITION-AT-WARNING                     33800093
338100                                                                  33810093
338200         END-IF                                                   33820093
338300     END-IF.                                                      33830093
338400                                                                  33840093
338500 4431-POSITION-AT-WARNING.                                        33850093
338600                                                                  33860093
338700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               33870093
338800                                                  PV-TOP-ITEM + 1.33880093
338900     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       33890093
339000         CONTINUE                                                 33900093
339100     ELSE                                                         33910093
339200         SET DP030-SET-CURSOR-APPL-1                              33920093
339300                                 TO TRUE                          33930093
339400         MOVE -1                 TO MR-SELECTL (PV-SUB)           33940093
339500         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           33950093
339600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           33960093
339700     END-IF.                                                      33970093
339800                                                                  33980093
339900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.33990093
340000                                                                  34000093
340100     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       34010093
340200         CONTINUE                                                 34020093
340300     ELSE                                                         34030093
340400         SET DP030-SET-CURSOR-APPL-1                              34040093
340500                                 TO TRUE                          34050093
340600         MOVE -1                 TO MR-SELECTL (PV-SUB)           34060093
340700         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           34070093
340800         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           34080093
340900     END-IF.                                                      34090093
341000                                                                  34100093
341100 4500-NEW-SKU-CHECK.                                              34110093
341200                                                                  34120093
341300     INITIALIZE XL001-COMMAREA.                                   34130093
341400     SET XL001-BY-ITEM                                            34140093
341500         XL001-SELECT-VND-STYL                                    34150093
341600         XL001-SELECT-SKU    TO TRUE                              34160093
341700                                                                  34170093
341800     MOVE DK-ITM-NBR TO XL001-KEY-ITM-NBR.                        34180093
341900     CALL XL001-VSM-PGM USING DFHEIBLK                            34190093
342000                              XL001-COMMAREA                      34200093
342100                              XL001-ITEM-COMMAREA                 34210093
342200                                                                  34220093
342300     EVALUATE TRUE                                                34230093
342400       WHEN XL001-SUCCESSFUL                                      34240093
342500         MOVE XL001-SKU-NBR    TO PV-SKU-NBR                      34250093
342600         MOVE XL001-SUB-CL-NBR-2CH                                34260093
342700                               TO PV-CLASS-NBR                    34270093
342800                                                                  34280093
342900       WHEN XL001-INVALID-ACCESS                                  34290093
343000           MOVE '4500-NEW-SKU-CHECK'  TO DP013-PARAGRAPH          34300093
343100           MOVE 'UNSUCCESSFUL GET OF XLKUT001 MODULE'             34310093
343200                               TO DP013-MESSAGE-TEXT (1)          34320093
343300           MOVE XL001-ACCESS-METHOD                               34330093
343400                               TO DP013-VARIABLE-FUNCTION-INFO    34340093
343500           SET DP013-DB2-ABEND                                    34350093
343600               DP013-XCTL-DISPLAY-RESTART                         34360093
343700                               TO TRUE                            34370093
343800           PERFORM DP013-0000-PROCESS-ABEND                       34380093
343900                                                                  34390093
344000       WHEN XL001-SQL-ERROR                                       34400093
344100           IF XL001-SKU-SQLCODE = +100                            34410093
344200               MOVE ZERO       TO PV-SKU-NBR                      34420093
344300               CONTINUE                                           34430093
344400           END-IF                                                 34440093
344500                                                                  34450093
344600       WHEN XL001-SQL-ERROR                                       34460093
344700           IF XL001-SKU-SQLCODE > ZERO                            34470093
344800               MOVE '4500-NEW-SKU-CHECK'                          34480093
344900                               TO DP013-PARAGRAPH                 34490093
345000               MOVE XL001-SKU-SQLCODE TO SQLCODE                  34500093
345100               MOVE SQLCA      TO DP013-SQLCA                     34510093
345200               MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)        34520093
345300               SET DP013-DB2-ABEND                                34530093
345400                   DP013-XCTL-DISPLAY-RESTART                     34540093
345500                               TO TRUE                            34550093
345600               PERFORM DP013-0000-PROCESS-ABEND                   34560093
345700           END-IF                                                 34570093
345800     END-EVALUATE.                                                34580093
345900                                                                  34590093
346000 5000-PREPARE-SEL-QUEUE.                                          34600093
346100                                                                  34610093
346200     MOVE +1                     TO ASC-BLK-SUB.                  34620093
346300                                                                  34630093
346400     PERFORM 5100-WRITE-TEMP-STORAGE.                             34640093
346500                                                                  34650093
346600     ADD +1                      TO ASC-BLK-SUB.                  34660093
346700                                                                  34670093
346800     PERFORM 5100-WRITE-TEMP-STORAGE.                             34680093
346900                                                                  34690093
347000     MOVE ASC-SEL-QUEUE-NAME     TO RC015-SEL-QUEUE-NAME.         34700093
347100                                                                  34710093
347200     PERFORM 6010-DELETE-SEL-QUEUE.                               34720093
347300                                                                  34730093
347400     SET ASC-UPDATE-TSQ          TO TRUE.                         34740093
347500     SET RC013-IDX               TO 1.                            34750093
347600     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     34760093
347700     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        34770093
347800                                                                  34780093
347900     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    34790093
348000         MOVE ASC-KEY-PO-NBR-N   TO DK-PO-NBR                     34800093
348100         MOVE ASC-KEY-PO-NBR-N   TO PKITEM-PO-NBR                 34810093
348200         MOVE ASC-KEY-SEQ-NBR    TO PKITEM-SEQ-NBR                34820093
348300         PERFORM 5300-SEARCH-FOR-SELECTION                        34830093
348400             VARYING PV-ITEM  FROM 1 BY 1                         34840093
348500             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          34850093
348600             IF PS-ERROR                                          34860093
348700                 MOVE PC-TSYMSG-00117                             34870093
348800                                 TO DP020-MSG-NUMBER              34880093
348900             ELSE                                                 34890093
349000                 MOVE PC-TSYMSG-00034                             34900093
349100                                 TO DP020-MSG-NUMBER              34910093
349200             END-IF                                               34920093
349300     ELSE                                                         34930093
349400         PERFORM 5200-FILL-SEL-QUEUE-RECORD                       34940093
349500             VARYING PV-ITEM  FROM 1 BY 1                         34950093
349600             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          34960093
349700     END-IF.                                                      34970093
349800                                                                  34980093
349900     IF RC013-IDX > 1                                             34990093
350000         PERFORM 5205-WRITE-SEL-QUEUE                             35000093
350100         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      35010093
350200     END-IF.                                                      35020093
350300                                                                  35030093
350400 5100-WRITE-TEMP-STORAGE.                                         35040093
350500                                                                  35050093
350600     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    35060093
350700                                 TO PV-LIST-ITEM-NUMBER.          35070093
350800     COMPUTE PV-BLOCK-NUMBER = 1 +                                35080093
350900                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).35090093
351000                                                                  35100093
351100     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           35110093
351200        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       35120093
351300                                                                  35130093
351400            PERFORM 5105-REWRITE-ASC-LISTQ                        35140093
351500                                                                  35150093
351600        END-IF                                                    35160093
351700     ELSE                                                         35170093
351800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35180093
351900                                     ASC-HIGHEST-BLOCK-WRITTEN + 135190093
352000         PERFORM 5110-WRITE-ASC-LISTQ                             35200093
352100                                                                  35210093
352200         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     35220093
352300     END-IF.                                                      35230093
352400                                                                  35240093
352500     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     35250093
352600                                 TO TRUE.                         35260093
352700                                                                  35270093
352800 5105-REWRITE-ASC-LISTQ.                                          35280093
352900                                                                  35290093
353000     EXEC CICS WRITEQ TS                                          35300093
353100               QUEUE   (ASC-LIST-QUEUE-NAME)                      35310093
353200               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           35320093
353300               ITEM    (PV-BLOCK-NUMBER)                          35330093
353400               REWRITE                                            35340093
353500               RESP    (PV-CICS-RESP)                             35350093
353600     END-EXEC.                                                    35360093
353700                                                                  35370093
353800     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       35380093
353900        SET DP013-CICS-ABEND                                      35390093
354000            DP013-NO-ROLLBACK   TO TRUE                           35400093
354100        MOVE '5105-REWRITE-ASC-LISTQ'                             35410093
354200                                TO DP013-PARAGRAPH                35420093
354300        MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE' 35430093
354400                                TO DP013-MESSAGE-TEXT (1)         35440093
354500        PERFORM DP013-0000-PROCESS-ABEND                          35450093
354600     END-IF.                                                      35460093
354700                                                                  35470093
354800 5110-WRITE-ASC-LISTQ.                                            35480093
354900                                                                  35490093
355000     EXEC CICS WRITEQ TS                                          35500093
355100               QUEUE (ASC-LIST-QUEUE-NAME)                        35510093
355200               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            35520093
355300               ITEM  (PV-BLOCK-NUMBER)                            35530093
355400               RESP  (PV-CICS-RESP)                               35540093
355500     END-EXEC.                                                    35550093
355600                                                                  35560093
355700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      35570093
355800         SET DP013-CICS-ABEND                                     35580093
355900             DP013-NO-ROLLBACK   TO TRUE                          35590093
356000         MOVE '5110-WRITE-ASC-LISTQ'                              35600093
356100                                 TO DP013-PARAGRAPH               35610093
356200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  35620093
356300                                 TO DP013-MESSAGE-TEXT (1)        35630093
356400         PERFORM DP013-0000-PROCESS-ABEND                         35640093
356500     END-IF.                                                      35650093
356600                                                                  35660093
356700 5200-FILL-SEL-QUEUE-RECORD.                                      35670093
356800                                                                  35680093
356900     PERFORM 6112-READ-LIST-QUEUE.                                35690093
357000                                                                  35700093
357100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           35710093
357200         PERFORM                                                  35720093
357300         VARYING LQW-IDX  FROM 1 BY 1                             35730093
357400         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  35740093
357500                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            35750093
357600                                                                  35760093
357700             IF LQW-SELECT (LQW-IDX)                              35770093
357800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              35780093
357900                                 TO RC013-ITEM         (RC013-IDX)35790093
358000                 MOVE LQW-PO-LNE-NBR (LQW-IDX)                    35800093
358100                                 TO RC013-PKSL-LNE-NBR-N          35810093
358200                                                       (RC013-IDX)35820093
358300                 MOVE SPACE      TO RC013-ACTION-SW    (RC013-IDX)35830093
358400                 SET RC013-IDX UP BY 1                            35840093
358500                 IF RC013-IDX > RC013-MAX-ITEMS                   35850093
358600                                                                  35860093
358700                     PERFORM 5205-WRITE-SEL-QUEUE                 35870093
358800                                                                  35880093
358900                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      35890093
359000                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         35900093
359100                     SET RC013-IDX                                35910093
359200                                 TO 1                             35920093
359300                 END-IF                                           35930093
359400             END-IF                                               35940093
359500         END-PERFORM                                              35950093
359600     END-IF.                                                      35960093
359700                                                                  35970093
359800 5205-WRITE-SEL-QUEUE.                                            35980093
359900                                                                  35990093
360000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36000093
360100                                 TO RC013-SELECTED-ITEMS.         36010093
360200                                                                  36020093
360300     EXEC CICS WRITEQ TS                                          36030093
360400               QUEUE (ASC-SEL-QUEUE-NAME)                         36040093
360500               FROM  (RC013-DC-SELECT-RECORD)                     36050093
360600               ITEM  (PV-SEL-QUEUE-ITEM)                          36060093
360700               RESP  (PV-CICS-RESP)                               36070093
360800     END-EXEC.                                                    36080093
360900                                                                  36090093
361000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       36100093
361100         SET DP013-CICS-ABEND                                     36110093
361200             DP013-NO-ROLLBACK   TO TRUE                          36120093
361300         MOVE '5205-WRITE-SEL-QUEUE'                              36130093
361400                                 TO DP013-PARAGRAPH               36140093
361500         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   36150093
361600                                 TO DP013-MESSAGE-TEXT (1)        36160093
361700         PERFORM DP013-0000-PROCESS-ABEND                         36170093
361800     END-IF.                                                      36180093
361900                                                                  36190093
362000 5300-SEARCH-FOR-SELECTION.                                       36200093
362100                                                                  36210093
362200     PERFORM 6112-READ-LIST-QUEUE.                                36220093
362300                                                                  36230093
362400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           36240093
362500         PERFORM                                                  36250093
362600         VARYING LQW-IDX  FROM 1 BY 1                             36260093
362700         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  36270093
362800                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            36280093
362900                                                                  36290093
363000             IF LQW-SELECT (LQW-IDX)                              36300093
363100                 PERFORM 5400-SELECT-TPKITEM                      36310093
363200                 IF PS-PKITEM-FOUND                               36320093
363300                     SET PS-ERROR                                 36330093
363400                                 TO TRUE                          36340093
363500                 ELSE                                             36350093
363600                     IF LQW-PKSL-ITM-QTY (LQW-IDX) = ZERO AND     36360093
363700                        LQW-OTR-QTY (LQW-IDX) = ZERO              36370093
363800                         CONTINUE                                 36380093
363900                     ELSE                                         36390093
364000                         PERFORM 5500-INSERT-TPKITEM              36400093
364100                         ADD +1      TO RC015-NUMBER-OF-TS-ITEMS  36410093
364200                     END-IF                                       36420093
364300                 END-IF                                           36430093
364400             END-IF                                               36440093
364500         END-PERFORM                                              36450093
364600     END-IF.                                                      36460093
364700                                                                  36470093
364800/                                                                 36480093
364900*----------------------------------------------------------------*36490093
365000*    CHECK IF THE PO LINE NUMBER ALREADY EXISTS ON THE PACK SLIP *36500093
365100*----------------------------------------------------------------*36510093
365200                                                                  36520093
365300 5400-SELECT-TPKITEM.                                             36530093
365400                                                                  36540093
365500     MOVE LQW-PKSL-LNE-NBR  (LQW-IDX)                             36550093
365600                                 TO PKITEM-PKSL-LNE-NBR.          36560093
365700                                                                  36570093
365800     PERFORM                                                      36580093
365900         WITH TEST AFTER                                          36590093
366000         VARYING PV-RETRY-COUNTER                                 36600093
366100         FROM 1 BY 1                                              36610093
366200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36620093
366300             OR (SQLCODE = +0)                                    36630093
366400             OR (SQLCODE = +100))                                 36640093
366500                                                                  36650093
366600         EXEC SQL                                                 36660093
366700              SELECT PO_NBR                                       36670093
366800                INTO :PKITEM-PO-NBR                               36680093
366900                FROM TPKITEM                                      36690093
367000               WHERE PO_NBR       = :PKITEM-PO-NBR                36700093
367100                 AND SEQ_NBR      = :PKITEM-SEQ-NBR               36710093
367200                 AND PKSL_LNE_NBR = :PKITEM-PKSL-LNE-NBR          36720093
367300                 AND VER_STAT_CDE = :PC-ACTIVE                    36730093
367400         END-EXEC                                                 36740093
367500                                                                  36750093
367600         EVALUATE TRUE                                            36760093
367700             WHEN SQLCODE = +0                                    36770093
367800                  SET PS-PKITEM-FOUND                             36780093
367900                                   TO TRUE                        36790093
368000             WHEN SQLCODE = +100                                  36800093
368100                  SET PS-PKITEM-NOT-FOUND                         36810093
368200                                   TO TRUE                        36820093
368300             WHEN SQLCODE = -904                                  36830093
368400             WHEN SQLCODE = -913                                  36840093
368500                  CONTINUE                                        36850093
368600                                                                  36860093
368700             WHEN SQLWARN0 NOT = SPACES                           36870093
368800             WHEN SQLCODE < +0                                    36880093
368900             WHEN SQLCODE > +0                                    36890093
369000                  MOVE '5400-SELECT-TPKITEM'                      36900093
369100                                   TO DP013-PARAGRAPH             36910093
369200                  MOVE 'UNSUCCESSFUL SELECT OF TPKITEM'           36920093
369300                                   TO DP013-MESSAGE-TEXT (1)      36930093
369400                  MOVE SQLCA       TO DP013-SQLCA                 36940093
369500                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    36950093
369600                  SET DP013-DB2-ABEND                             36960093
369700                      DP013-XCTL-DISPLAY-RESTART                  36970093
369800                                   TO TRUE                        36980093
369900                  PERFORM DP013-0000-PROCESS-ABEND                36990093
370000         END-EVALUATE                                             37000093
370100     END-PERFORM.                                                 37010093
370200                                                                  37020093
370300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO 37030093
370400         MOVE '5400-SELECT-TPKITEM'                               37040093
370500                                   TO DP013-PARAGRAPH             37050093
370600         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TPKITEM'        37060093
370700                                   TO DP013-MESSAGE-TEXT (1)      37070093
370800         MOVE SQLCA                TO DP013-SQLCA                 37080093
370900         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    37090093
371000         SET DP013-XCTL-DISPLAY-RESTART                           37100093
371100             DP013-DB2-ABEND       TO TRUE                        37110093
371200         PERFORM DP013-0000-PROCESS-ABEND                         37120093
371300     END-IF.                                                      37130093
371400                                                                  37140093
371500/                                                                 37150093
371600*----------------------------------------------------------------*37160093
371700*    INSERT A PACK SLIP ITEM ROW                                 *37170093
371800*----------------------------------------------------------------*37180093
371900                                                                  37190093
372000 5500-INSERT-TPKITEM.                                             37200093
372100                                                                  37210093
372200     IF LQW-PKSL-ITM-QTY (LQW-IDX) = ZERO                         37220093
372300         MOVE LQW-OTR-QTY (LQW-IDX)                               37230093
372400                                 TO PKITEM-PKSL-ITM-QTY           37240093
372500     ELSE                                                         37250093
372600         MOVE LQW-PKSL-ITM-QTY (LQW-IDX)                          37260093
372700                                 TO PKITEM-PKSL-ITM-QTY           37270093
372800     END-IF.                                                      37280093
372900                                                                  37290093
373000     MOVE LQW-PKSL-LNE-NBR  (LQW-IDX)                             37300093
373100                                 TO PKITEM-PKSL-LNE-NBR.          37310093
373200     MOVE LQW-PURITM-VER-NBR(LQW-IDX)                             37320093
373300                                 TO PKITEM-PURITM-VER-NBR.        37330093
373400                                                                  37340093
373500                                                                  37350093
373600*TCR  AUTOVE                                                      37360093
373700     SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE.                         37370093
373800     PERFORM 5525-CHECK-ASN.                                      37380093
373900     MOVE 0 TO PV-ORIG-PKSL-ITM-QTY.                              37390093
374000     IF PS-ORIG-ASN-PKSLIP-YES                                    37400093
374100        MOVE PKITEM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY          37410093
374200     END-IF.                                                      37420093
374300*TCR  AUTOVE                                                      37430093
374400                                                                  37440093
374500     PERFORM                                                      37450093
374600         WITH TEST AFTER                                          37460093
374700         VARYING PV-RETRY-COUNTER                                 37470093
374800         FROM 1 BY 1                                              37480093
374900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37490093
375000             OR (SQLCODE = +0))                                   37500093
375100                                                                  37510093
375200         EXEC SQL                                                 37520093
375300              INSERT INTO TPKITEM                                 37530093
375400                     (PO_NBR,                                     37540093
375500                      SEQ_NBR,                                    37550093
375600                      PKSL_LNE_NBR,                               37560093
375700                      CRE_TMST,                                   37570093
375800                      VER_STAT_CDE,                               37580093
375900                      PKSL_ITM_QTY,                               37590093
376000                      CRE_UID,                                    37600093
376100                      PURITM_VER_NBR,                             37610093
376200                      ORIG_PKSL_ITM_QTY)                          37620093
376300              VALUES (:PKITEM-PO-NBR,                             37630093
376400                      :PKITEM-SEQ-NBR,                            37640093
376500                      :PKITEM-PKSL-LNE-NBR,                       37650093
376600                       CURRENT TIMESTAMP,                         37660093
376700                      :PC-ACTIVE,                                 37670093
376800                      :PKITEM-PKSL-ITM-QTY,                       37680093
376900                      :DP020-USERID,                              37690093
377000                      :PKITEM-PURITM-VER-NBR,                     37700093
377100                      :PV-ORIG-PKSL-ITM-QTY)                      37710093
377200         END-EXEC                                                 37720093
377300                                                                  37730093
377400         EVALUATE TRUE                                            37740093
377500             WHEN SQLCODE = +0                                    37750093
377600                PERFORM 5900-CHECK-PREPACK                        37760093
377700                IF PREPACK-PO                                     37770093
377800                   PERFORM 5600-GET-PACK-SKU                      37780093
377900                ELSE                                              37790093
378000                    MOVE 0    TO POPRPK-PK-SKU-NBR                37800093
378100                    PERFORM 5800-INSERT-WFT-LOD-XFER              37810093
378200                    PERFORM 5700-INSERT-WFT-LOD-CNTL              37820093
378300                END-IF                                            37830093
378400             WHEN SQLCODE = -904                                  37840093
378500             WHEN SQLCODE = -913                                  37850093
378600                  CONTINUE                                        37860093
378700                                                                  37870093
378800             WHEN SQLWARN0 NOT = SPACES                           37880093
378900             WHEN SQLCODE < +0                                    37890093
379000             WHEN SQLCODE > +0                                    37900093
379100                  MOVE '5500-INSERT-TPKITEM'                      37910093
379200                                   TO DP013-PARAGRAPH             37920093
379300                  MOVE 'UNSUCCESSFUL INSERT FOR TPKITEM'          37930093
379400                                   TO DP013-MESSAGE-TEXT (1)      37940093
379500                  MOVE SQLCA       TO DP013-SQLCA                 37950093
379600                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    37960093
379700                  SET DP013-DB2-ABEND                             37970093
379800                      DP013-XCTL-DISPLAY-RESTART                  37980093
379900                                   TO TRUE                        37990093
380000                  PERFORM DP013-0000-PROCESS-ABEND                38000093
380100         END-EVALUATE                                             38010093
380200     END-PERFORM.                                                 38020093
380300                                                                  38030093
380400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO 38040093
380500         MOVE '5500-INSERT-TPKITEM'                               38050093
380600                                   TO DP013-PARAGRAPH             38060093
380700         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TPKITEM'        38070093
380800                                   TO DP013-MESSAGE-TEXT (1)      38080093
380900         MOVE SQLCA                TO DP013-SQLCA                 38090093
381000         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    38100093
381100         SET DP013-XCTL-DISPLAY-RESTART                           38110093
381200             DP013-DB2-ABEND       TO TRUE                        38120093
381300         PERFORM DP013-0000-PROCESS-ABEND                         38130093
381400     END-IF.                                                      38140093
381500                                                                  38150093
381600******************************************************************38160093
381700**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **38170093
381800******************************************************************38180093
381900 5525-CHECK-ASN.                                                  38190093
382000                                                                  38200093
382100         EXEC SQL                                                 38210093
382200           SELECT COUNT(CRE_UID)                                  38220093
382300           INTO  :PV-COUNTER:PV-NULL-IND                          38230093
382400           FROM   TPKSLIP                                         38240093
382500           WHERE  PO_NBR       = :DK-PO-NBR                       38250093
382600             AND  SEQ_NBR      = :ASC-KEY-SEQ-NBR                 38260093
382700             AND  CRE_UID      = 'RCKUP006'                       38270093
382800         END-EXEC.                                                38280093
382900                                                                  38290093
383000         EVALUATE TRUE                                            38300093
383100             WHEN SQLCODE = ZERO                                  38310093
383200                  IF PV-COUNTER > 0                               38320093
383300                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          38330093
383400                  END-IF                                          38340093
383500             WHEN SQLCODE = +100                                  38350093
383600                  CONTINUE                                        38360093
383700             WHEN SQLCODE = -904                                  38370093
383800             WHEN SQLCODE = -911                                  38380093
383900             WHEN SQLCODE = -913                                  38390093
384000                  CONTINUE                                        38400093
384100                                                                  38410093
384200             WHEN SQLWARN0 NOT = SPACES                           38420093
384300             WHEN SQLCODE  NOT = ZERO                             38430093
384400                  MOVE '5525-CHECK-ASN'                           38440093
384500                                   TO DP013-PARAGRAPH             38450093
384600                  MOVE 'UNSUCCESSFUL SELECT FOR TPKSLIP'          38460093
384700                                   TO DP013-MESSAGE-TEXT (1)      38470093
384800                  MOVE SQLCA       TO DP013-SQLCA                 38480093
384900                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    38490093
385000                  SET DP013-DB2-ABEND                             38500093
385100                      DP013-XCTL-DISPLAY-RESTART                  38510093
385200                                   TO TRUE                        38520093
385300                  PERFORM DP013-0000-PROCESS-ABEND                38530093
385400         END-EVALUATE.                                            38540093
385500                                                                  38550093
385600***************************************************************** 38560093
385700*     CHECK PACK UPC                                              38570093
385800***************************************************************** 38580093
385900 5600-GET-PACK-SKU.                                               38590093
386000                                                                  38600093
386100     MOVE PKITEM-PO-NBR TO PURITM-PO-NBR.                         38610093
386200     MOVE PKITEM-PKSL-LNE-NBR TO PURITM-PO-LNE-NBR.               38620093
386300     EXEC SQL                                                     38630093
386400        SELECT  B.PO_NBR, B.PK_SKU_NBR                            38640093
386500          INTO :POPRPK-PO-NBR,                                    38650093
386600               :POPRPK-PK-SKU-NBR                                 38660093
386700          FROM TPURITM A,                                         38670093
386800               TPOPRPK B                                          38680093
386900          WHERE A.PO_NBR      = :PURITM-PO-NBR       AND          38690093
387000                A.APP_PO_LNE_NBR = :PURITM-PO-LNE-NBR   AND       38700093
387100                A.PO_PREPK_ID = B.PO_PREPK_ID        AND          38710093
387200                A.PO_NBR      = B.PO_NBR             AND          38720093
387300                A.VER_STATUS_CDE = 'A'                            38730093
387400     END-EXEC.                                                    38740093
387500     EVALUATE TRUE                                                38750093
387600        WHEN SQLCODE = +0                                         38760093
387700           PERFORM 5800-INSERT-WFT-LOD-XFER                       38770093
387800           PERFORM 5700-INSERT-WFT-LOD-CNTL                       38780093
387900        WHEN SQLCODE = +100                                       38790093
388000           MOVE 0 TO SQLCODE                                      38800093
388100        WHEN SQLWARN0 NOT = SPACES                                38810093
388200        WHEN SQLCODE < +0                                         38820093
388300        WHEN SQLCODE > +0                                         38830093
388400             MOVE '5400-GET-PACK-SKU'                             38840093
388500                              TO DP013-PARAGRAPH                  38850093
388600             MOVE 'UNSUCCESSFUL SELECT PACK SKU'                  38860093
388700                              TO DP013-MESSAGE-TEXT (1)           38870093
388800             MOVE SQLCA       TO DP013-SQLCA                      38880093
388900             MOVE 'TPOPRPK '  TO DP013-DB2-TABLE-NAME (1)         38890093
389000             SET DP013-DB2-ABEND                                  38900093
389100                 DP013-XCTL-DISPLAY-RESTART                       38910093
389200                              TO TRUE                             38920093
389300             PERFORM DP013-0000-PROCESS-ABEND                     38930093
389400     END-EVALUATE.                                                38940093
389500 5700-INSERT-WFT-LOD-CNTL.                                        38950093
389600                                                                  38960093
389700                                                                  38970093
389800     EXEC SQL                                                     38980093
389900         INSERT INTO WFT_LOD_CNTL                                 38990093
390000             ( PRC_CNTL_TMST                                      39000093
390100              ,TRN_TYP_CDE                                        39010093
390200              ,STAT_CDE                                           39020093
390300              ,INIT_PRCG_BEG_TMST                                 39030093
390400              ,END_TMST                                           39040093
390500              ,ARCH_DAT_IND                                       39050093
390600              ,DAT_LOD_VER_NBR                                    39060093
390700              ,STR_NBR                                            39070093
390800             )                                                    39080093
390900         VALUES                                                   39090093
391000             (:WFT00002-PRC-CNTL-TMST                             39100093
391100             ,'PSLPCK'                                            39110093
391200             ,'READY'                                             39120093
391300             ,'0001-01-01-00.00.00.000000'                        39130093
391400             ,'0001-01-01-00.00.00.000000'                        39140093
391500             ,'N'                                                 39150093
391600             ,10.01                                               39160093
391700             ,0900                                                39170093
391800             )                                                    39180093
391900     END-EXEC.                                                    39190093
392000                                                                  39200093
392100     EVALUATE TRUE                                                39210093
392200        WHEN SQLCODE = +0                                         39220093
392300        WHEN SQLCODE = +100                                       39230093
392400        WHEN SQLCODE = -904                                       39240093
392500        WHEN SQLCODE = -913                                       39250093
392600             CONTINUE                                             39260093
392700        WHEN SQLWARN0 NOT = SPACES                                39270093
392800        WHEN SQLCODE < +0                                         39280093
392900        WHEN SQLCODE > +0                                         39290093
393000             MOVE '5700-INSERT-WFT-LOD-CNTL'                      39300093
393100                              TO DP013-PARAGRAPH                  39310093
393200             MOVE 'UNSUCCESSFUL INSERT WFT-LOD-CNTL'              39320093
393300                              TO DP013-MESSAGE-TEXT (1)           39330093
393400             MOVE SQLCA       TO DP013-SQLCA                      39340093
393500             MOVE 'WFT_LOD-CNTL'  TO DP013-DB2-TABLE-NAME (1)     39350093
393600             SET DP013-DB2-ABEND                                  39360093
393700                 DP013-XCTL-DISPLAY-RESTART                       39370093
393800                              TO TRUE                             39380093
393900             PERFORM DP013-0000-PROCESS-ABEND                     39390093
394000     END-EVALUATE.                                                39400093
394100                                                                  39410093
394200 5800-INSERT-WFT-LOD-XFER.                                        39420093
394300                                                                  39430093
394400     INITIALIZE WFT00002-LOD-DAT-TXT.                             39440093
394500                                                                  39450093
394600     EXEC SQL                                                     39460093
394700         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          39470093
394800     END-EXEC.                                                    39480093
394900                                                                  39490093
395000     MOVE POPRPK-PO-NBR TO WS-PUBLISH-PO.                         39500093
395100     MOVE POPRPK-PK-SKU-NBR TO WS-PUBLISH-SKU.                    39510093
395200     MOVE LENGTH OF WS-PUBLISH-MESSAGE TO                         39520093
395300        WFT00002-LOD-DAT-TXT-LEN.                                 39530093
395400                                                                  39540093
395500     MOVE WS-PUBLISH-MESSAGE TO                                   39550093
395600        WFT00002-LOD-DAT-TXT-TEXT.                                39560093
395700                                                                  39570093
395800                                                                  39580093
395900     EXEC SQL                                                     39590093
396000         INSERT INTO WFT_LOD_XFER                                 39600093
396100             ( PRC_CNTL_TMST                                      39610093
396200              ,TRN_TYP_CDE                                        39620093
396300              ,BTCH_LOD_SEQ_ID                                    39630093
396400              ,LOD_DAT_TXT                                        39640093
396500             )                                                    39650093
396600         VALUES                                                   39660093
396700             (:WFT00002-PRC-CNTL-TMST                             39670093
396800             ,'PSLPCK'                                            39680093
396900             ,1                                                   39690093
397000             ,:WFT00002-LOD-DAT-TXT                               39700093
397100             )                                                    39710093
397200     END-EXEC.                                                    39720093
397300                                                                  39730093
397400     EVALUATE TRUE                                                39740093
397500        WHEN SQLCODE = +0                                         39750093
397600        WHEN SQLCODE = +100                                       39760093
397700        WHEN SQLCODE = -904                                       39770093
397800        WHEN SQLCODE = -913                                       39780093
397900             CONTINUE                                             39790093
398000        WHEN SQLWARN0 NOT = SPACES                                39800093
398100        WHEN SQLCODE < +0                                         39810093
398200        WHEN SQLCODE > +0                                         39820093
398300             MOVE '5800-INSERT-WFT-LOD-XFER'                      39830093
398400                              TO DP013-PARAGRAPH                  39840093
398500             MOVE 'UNSUCCESSFUL INSERT WFT-LOD-XFER'              39850093
398600                              TO DP013-MESSAGE-TEXT (1)           39860093
398700             MOVE SQLCA       TO DP013-SQLCA                      39870093
398800             MOVE 'WFT_LOD-XFER'  TO DP013-DB2-TABLE-NAME (1)     39880093
398900             SET DP013-DB2-ABEND                                  39890093
399000                 DP013-XCTL-DISPLAY-RESTART                       39900093
399100                              TO TRUE                             39910093
399200             PERFORM DP013-0000-PROCESS-ABEND                     39920093
399300     END-EVALUATE.                                                39930093
399400***************************************************************** 39940093
399500*     CHECK PREPACK                                               39950093
399600*                                                                 39960093
399700***************************************************************** 39970093
399800 5900-CHECK-PREPACK.                                              39980093
399900     MOVE PKITEM-PO-NBR TO POPRPK-PO-NBR.                         39990093
400000     EXEC SQL                                                     40000093
400100        SELECT A.PO_PREPK_ID                                      40010093
400200          INTO :POPRPK-PO-PREPK-ID                                40020093
400300          FROM TPOPRPK A                                          40030093
400400          WHERE A.PO_NBR = :POPRPK-PO-NBR                         40040093
400500     END-EXEC.                                                    40050093
400600                                                                  40060093
400700     EVALUATE TRUE                                                40070093
400800        WHEN SQLCODE = +0                                         40080093
400900        WHEN SQLCODE = -811                                       40090093
401000           SET PREPACK-PO TO TRUE                                 40100093
401100        WHEN SQLCODE = +100                                       40110093
401200           SET NOT-PREPACK-PO TO TRUE                             40120093
401300        WHEN SQLCODE = -904                                       40130093
401400        WHEN SQLCODE = -913                                       40140093
401500             CONTINUE                                             40150093
401600        WHEN SQLWARN0 NOT = SPACES                                40160093
401700        WHEN SQLCODE < +0                                         40170093
401800        WHEN SQLCODE > +0                                         40180093
401900             MOVE '5900-CHECK-PREPACK'                            40190093
402000                              TO DP013-PARAGRAPH                  40200093
402100             MOVE 'UNSUCCESSFUL SELECT TPOPRPK'                   40210093
402200                              TO DP013-MESSAGE-TEXT (1)           40220093
402300             MOVE SQLCA       TO DP013-SQLCA                      40230093
402400             MOVE 'TPOPRPK'  TO DP013-DB2-TABLE-NAME (1)          40240093
402500             SET DP013-DB2-ABEND                                  40250093
402600                 DP013-XCTL-DISPLAY-RESTART                       40260093
402700                              TO TRUE                             40270093
402800             PERFORM DP013-0000-PROCESS-ABEND                     40280093
402900     END-EVALUATE.                                                40290093
403000     MOVE 0 TO SQLCODE.                                           40300093
403100 6000-REFRESH-PANEL-FROM-TEMP.                                    40310093
403200                                                                  40320093
403300     IF ASC-UPDATE-TSQ                                            40330093
403400         SET ASC-NO-TSQ-UPDATE   TO TRUE                          40340093
403500         MOVE ZERO               TO PV-SAVE-ITEM                  40350093
403600                                    PV-SEL-QUEUE-ITEM             40360093
403700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        40370093
403800                                 TO PV-HOLD-SELECTED-ITEMS        40380093
403900         PERFORM 6100-UPDATE-TSQ                                  40390093
404000           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS40400093
404100                                                                  40410093
404200         PERFORM 6010-DELETE-SEL-QUEUE                            40420093
404300                                                                  40430093
404400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         40440093
404500                    ASC-BLOCK-ENTRIES (2)                         40450093
404600                                                                  40460093
404700         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 40470093
404800                GIVING    PV-BLOCK-NUMBER                         40480093
404900                REMAINDER PV-REMAINDER                            40490093
405000                                                                  40500093
405100         IF PV-REMAINDER > ZERO                                   40510093
405200             ADD +1              TO PV-BLOCK-NUMBER               40520093
405300         END-IF                                                   40530093
405400                                                                  40540093
405500         MOVE +1                 TO ASC-BLK-SUB                   40550093
405600                                                                  40560093
405700         PERFORM 4410-READ-TEMP-STORAGE                           40570093
405800                                                                  40580093
405900         ADD +1                  TO ASC-BLK-SUB                   40590093
406000                            PV-BLOCK-NUMBER                       40600093
406100         PERFORM 4410-READ-TEMP-STORAGE                           40610093
406200                                                                  40620093
406300     END-IF.                                                      40630093
406400                                                                  40640093
406500 6010-DELETE-SEL-QUEUE.                                           40650093
406600                                                                  40660093
406700     EXEC CICS DELETEQ TS                                         40670093
406800               QUEUE (ASC-SEL-QUEUE-NAME)                         40680093
406900               RESP  (PV-CICS-RESP)                               40690093
407000     END-EXEC.                                                    40700093
407100                                                                  40710093
407200     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     40720093
407300         (PV-CICS-RESP = DFHRESP (QIDERR)))                       40730093
407400         CONTINUE                                                 40740093
407500     ELSE                                                         40750093
407600         SET DP013-CICS-ABEND                                     40760093
407700             DP013-NO-ROLLBACK   TO TRUE                          40770093
407800         MOVE '6010-DELETE-SEL-QUEUE'                             40780093
407900                                 TO DP013-PARAGRAPH               40790093
408000         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  40800093
408100                                 TO DP013-MESSAGE-TEXT (1)        40810093
408200         PERFORM DP013-0000-PROCESS-ABEND                         40820093
408300     END-IF.                                                      40830093
408400                                                                  40840093
408500 6100-UPDATE-TSQ.                                                 40850093
408600                                                                  40860093
408700     ADD 1                       TO PV-SEL-QUEUE-ITEM.            40870093
408800                                                                  40880093
408900     PERFORM 6105-READ-SEL-QUEUE.                                 40890093
409000                                                                  40900093
409100     PERFORM                                                      40910093
409200     VARYING RC013-IDX  FROM 1 BY 1                               40920093
409300     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       40930093
409400             RC013-IDX > RC013-MAX-ITEMS                          40940093
409500                                                                  40950093
409600         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   40960093
409700            PERFORM 6110-PROCESS-ITEMS                            40970093
409800         END-IF                                                   40980093
409900                                                                  40990093
410000         ADD +1                  TO PV-ITEMS-PROCESSED            41000093
410100     END-PERFORM.                                                 41010093
410200                                                                  41020093
410300     PERFORM 6111-WRITE-LIST-QUEUE.                               41030093
410400                                                                  41040093
410500                                                                  41050093
410600 6105-READ-SEL-QUEUE.                                             41060093
410700                                                                  41070093
410800     EXEC CICS READQ TS                                           41080093
410900               QUEUE (ASC-SEL-QUEUE-NAME)                         41090093
411000               INTO  (RC013-DC-SELECT-RECORD)                     41100093
411100               ITEM  (PV-SEL-QUEUE-ITEM)                          41110093
411200               RESP  (PV-CICS-RESP)                               41120093
411300     END-EXEC.                                                    41130093
411400                                                                  41140093
411500     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       41150093
411600         SET DP013-CICS-ABEND                                     41160093
411700             DP013-NO-ROLLBACK   TO TRUE                          41170093
411800         MOVE '6105-READ-SEL-QUEUE'                               41180093
411900                                 TO DP013-PARAGRAPH               41190093
412000         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    41200093
412100                                 TO DP013-MESSAGE-TEXT (1)        41210093
412200         PERFORM DP013-0000-PROCESS-ABEND                         41220093
412300     END-IF.                                                      41230093
412400                                                                  41240093
412500 6110-PROCESS-ITEMS.                                              41250093
412600                                                                  41260093
412700     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          41270093
412800                                            / PC-ITEMS-PER-PANEL).41280093
412900                                                                  41290093
413000     IF PV-ITEM NOT = PV-SAVE-ITEM                                41300093
413100        IF PV-SAVE-ITEM NOT = ZERO                                41310093
413200                                                                  41320093
413300            PERFORM 6111-WRITE-LIST-QUEUE                         41330093
413400                                                                  41340093
413500        END-IF                                                    41350093
413600        MOVE PV-ITEM             TO PV-SAVE-ITEM                  41360093
413700                                                                  41370093
413800        PERFORM 6112-READ-LIST-QUEUE                              41380093
413900                                                                  41390093
414000     END-IF.                                                      41400093
414100                                                                  41410093
414200     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   41420093
414300                                    LQW-LIST-ITEM-NUMBER (1)) + 1.41430093
414400     SET LQW-DESELECT (PV-SUB)   TO TRUE                          41440093
414500     MOVE LQW-SELECTED-SW (PV-SUB)                                41450093
414600                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).41460093
414700                                                                  41470093
414800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                41480093
414900                                                                  41490093
415000 6111-WRITE-LIST-QUEUE.                                           41500093
415100                                                                  41510093
415200     EXEC CICS WRITEQ TS                                          41520093
415300               QUEUE (ASC-LIST-QUEUE-NAME)                        41530093
415400               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   41540093
415500               ITEM  (PV-SAVE-ITEM)                               41550093
415600               REWRITE                                            41560093
415700               RESP  (PV-CICS-RESP)                               41570093
415800     END-EXEC.                                                    41580093
415900                                                                  41590093
416000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       41600093
416100         SET DP013-CICS-ABEND                                     41610093
416200             DP013-NO-ROLLBACK   TO TRUE                          41620093
416300         MOVE '6111-WRITE-LIST-QUEUE'                             41630093
416400                                 TO DP013-PARAGRAPH               41640093
416500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'41650093
416600                                 TO DP013-MESSAGE-TEXT(1)         41660093
416700         PERFORM DP013-0000-PROCESS-ABEND                         41670093
416800     END-IF.                                                      41680093
416900                                                                  41690093
417000 6112-READ-LIST-QUEUE.                                            41700093
417100                                                                  41710093
417200     EXEC CICS READQ TS                                           41720093
417300               QUEUE (ASC-LIST-QUEUE-NAME)                        41730093
417400               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   41740093
417500               ITEM  (PV-ITEM)                                    41750093
417600               RESP  (PV-CICS-RESP)                               41760093
417700     END-EXEC.                                                    41770093
417800                                                                  41780093
417900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       41790093
418000         SET DP013-CICS-ABEND                                     41800093
418100             DP013-NO-ROLLBACK   TO TRUE                          41810093
418200         MOVE '6112-READ-LIST-QUEUE'                              41820093
418300                                 TO DP013-PARAGRAPH               41830093
418400         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   41840093
418500                                 TO DP013-MESSAGE-TEXT(1)         41850093
418600         PERFORM DP013-0000-PROCESS-ABEND                         41860093
418700     END-IF.                                                      41870093
418800/                                                                 41880093
418900******************************************************************41890093
419000*    ABEND PROCESSING                                             41900093
419100******************************************************************41910093
419200     COPY DPPD013.                                                41920093
