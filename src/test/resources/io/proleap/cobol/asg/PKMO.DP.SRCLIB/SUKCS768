000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000210*-----------------------*                                         00021001
000220 PROGRAM-ID.    SUKCS768.                                         00022001
000230 AUTHOR.        OMAN.                                             00023001
000240 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00024001
000250 DATE-WRITTEN.  OCTOBER 2008.                                     00025001
000260 DATE-COMPILED.                                                   00026001
000270                                                                  00027001
000280*---------------------------------------------------------------* 00028001
000290*    S768 - DIRECTIVE RELEASE RECEIVER LIST SCREEN              * 00029089
000291*                                                               * 00029195
000292*    CAN BE ACCESSED BY:                                        * 00029289
000293*                                                               * 00029389
000294*    F17 - SUSDRRSL - SUKCS768                                  * 00029489
000295*          DIRECTIVE RELEASE CRIT SPEC                          * 00029589
000296*                                                               * 00029689
000297*    ACCESSES THE FOLLOWING SCREENS:                            * 00029789
000298*                                                               * 00029889
000299*    F23 - SULDRLNE - SUKCS799                                  * 00029989
000300*          DIRECTIVE RELEASE LINE/PACK LIST SCREEN              * 00030089
000301*                                                               * 00030189
000302*    F24 - SULDIRCN - SUKCS765                                  * 00030289
000303*          DIRECTIVE RELEASE CARTON LIST SCREEN                 * 00030389
000304*                                                               * 00030489
000305*                                                               * 00030589
000306*                                                               * 00030689
000307*                                                               * 00030789
000310*---------------------------------------------------------------* 00031089
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00033099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00034099
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00035099
001130*                                                                 00035199
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00035299
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00035399
263968*---------------------------------------------------------------* 00036099
000400 ENVIRONMENT DIVISION.                                            00040001
000500 DATA DIVISION.                                                   00050001
000600                                                                  00060001
000700 WORKING-STORAGE SECTION.                                         00070001
000800                                                                  00080001
000900 01  DK-DB2-KEYS.                                                 00090001
001000     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00100001
001010     05  DK-PO-NBR                 PIC S9(09) COMP VALUE +0.      00101019
001020     05  DK-TRIP-ID                PIC S9(09) COMP VALUE +0.      00102033
001030     05  DK-REC-SEQ-NBR            PIC S9(09) COMP VALUE +0.      00103033
001040     05  DK-STATUS-DTE             PIC  X(10)      VALUE SPACES.  00104037
001050     05  DK-STATUS-TME             PIC  X(08)      VALUE SPACES.  00105037
001080                                                                  00108001
001082 01  DN-DB2-NULL-INDICATORS.                                      00108235
001083     05  DN-VEH-NBR                PIC S9(04) COMP VALUE +0.      00108335
001084                                                                  00108434
001090 01  PC-PROGRAM-CONSTANTS.                                        00109001
001100     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SUK768  '.  00110001
001200     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM768 '.  00120001
001300     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS768'.  00130001
001400     05  PC-APPL-MAP               PIC S9(04)  VALUE  +1          00140001
001500                                                     COMP.        00150001
001600     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00160001
001700     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00170001
001800     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00180001
001900     05  PC-DETAIL-SCREEN          PIC  X(01)  VALUE '2'.         00190001
002000     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +08          00200010
002100                                               COMP SYNC.         00210001
002200     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00220001
002300                                               COMP SYNC.         00230001
002400     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00240001
002500                                               COMP-3.            00250001
002600     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00260001
002700                                               COMP SYNC.         00270001
002800     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00280001
002900                                               COMP-3.            00290001
003000     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00300001
003100     05  PC-ADD                    PIC  X(03)  VALUE 'ADD'.       00310001
003200     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00320001
003300     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00330001
003400     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00340001
003500     05  PC-DOOR                   PIC  X(04)  VALUE 'DOOR'.      00350001
003600     05  PC-STORE                  PIC  X(05)  VALUE 'STORE'.     00360001
003700     05  PC-01                     PIC  X(02)  VALUE '01'.        00370001
003800     05  PC-A                      PIC  X(01)  VALUE 'A'.         00380001
003900     05  PC-D                      PIC  X(01)  VALUE 'D'.         00390001
004000     05  PC-S                      PIC  X(01)  VALUE 'S'.         00400001
004100     05  PC-U                      PIC  X(01)  VALUE 'U'.         00410001
004110     05  PC-Y                      PIC  X(01)  VALUE 'Y'.         00411033
004200     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     00420001
004201     05  PC-DEFAULT-TIMESTAMP     PIC  X(26)                      00420101
004202                          VALUE  '9999-09-09-09.09.09.999999'.    00420201
004203                                                                  00420301
004204*----------------------------------------------------------------*00420401
004205*  SYSTEM MESSAGES                                               *00420501
004206*----------------------------------------------------------------*00420601
004207*   00005 = INVALID VALUE                                        *00420701
004208*   00008 = MUST BE NUMERIC                                      *00420801
004209*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00420901
004210*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00421001
004220*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00422001
004230*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00423001
004240*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00424001
004250*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00425001
004260*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00426001
004270*   00069 - TOP OF LIST                                          *00427001
004280*   00070 - BOTTOM OF LIST                                       *00428001
004290*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00429001
004300*   00279 - MORE ITEMS TO DISPLAY                                *00430001
004400*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00440001
004500*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI00450001
004600*----------------------------------------------------------------*00460001
004700     05  PC-TSYMSG-NUMBERS.                                       00470001
004800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00480001
004900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00490001
005000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00500001
005100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00510001
005200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00520001
005300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00530001
005400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00540001
005500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00550001
005600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00560001
005700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00570001
005800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00580001
005900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00590001
006000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00600001
006100         10  PC-TSYMSG-02571            PIC  9(05)  VALUE 02571.  00610001
006200         10  PC-TSYMSG-02575            PIC  9(05)  VALUE 02575.  00620001
006300*                                                                 00630001
006400 01  PS-PROGRAM-SWITCHES.                                         00640001
006500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00650001
006600         88  PS-NO-ERROR                            VALUE 'Y'.    00660001
006700         88  PS-ERROR                               VALUE 'N'.    00670001
006710     05  PS-TVHTRIP-TRIP-FOUND-SW       PIC  X(01)  VALUE 'Y'.    00671042
006720         88  PS-TVHTRIP-TRIP-FOUND                  VALUE 'Y'.    00672042
006730         88  PS-TVHTRIP-TRIP-NOT-FOUND              VALUE 'N'.    00673042
006740     05  PS-MAX-STATUS-SW               PIC  X(01)  VALUE 'Y'.    00674041
006750         88  PS-MAX-STATUS-FOUND                    VALUE 'Y'.    00675041
006760         88  PS-MAX-STATUS-NOT-FOUND                VALUE 'N'.    00676041
006800     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    00680001
006900         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    00690001
007000         88  PS-BLOCK-ERROR                         VALUE 'N'.    00700001
007100     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   00710001
007200         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   00720001
007300         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   00730001
007400     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    00740001
007500         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    00750001
007600         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    00760001
007700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00770001
007800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00780001
007900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00790001
008000     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    00800001
008100         88  PS-LIST-END                            VALUE 'Y'.    00810001
008200         88  PS-NO-LIST-END                         VALUE 'N'.    00820001
008300*                                                                 00830001
008400 01  PV-PROGRAM-VARIABLES.                                        00840001
008500     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  00850001
008600                                        COMP SYNC.                00860001
008700     05  PV-SUB                         PIC S9(04)  VALUE +0      00870001
008800                                                    COMP SYNC.    00880001
008900     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00890001
009000                                                    COMP SYNC.    00900001
009100     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00910001
009200                                                    COMP-3.       00920001
009300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00930001
009400                                                    COMP-3.       00940001
009500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00950001
009600                                                    COMP-3.       00960001
009700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00970001
009800                                                    COMP-3.       00980001
009900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      00990001
010000                                                    COMP-3.       01000001
010100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01010001
010200                                                    COMP-3.       01020001
010300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01030001
010400                                                    COMP-3.       01040001
010500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01050001
010600                                                    COMP SYNC.    01060001
010700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01070001
010800                                                    COMP SYNC.    01080001
010900     05  PV-ITEM                        PIC S9(04)  VALUE +0      01090001
011000                                                    COMP SYNC.    01100001
011100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01110001
011200                                                    COMP SYNC.    01120001
011300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01130001
011400                                                    COMP SYNC.    01140001
011500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01150001
011600                                                    COMP SYNC.    01160001
011700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01170001
011800                                                    COMP SYNC.    01180001
011900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01190001
012000                                                    COMP SYNC.    01200001
012100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01210001
012200                                                    COMP SYNC.    01220001
012300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01230001
012400                                                    COMP SYNC.    01240001
012500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01250001
012600                                                    COMP SYNC.    01260001
012700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01270001
012800                                                    COMP SYNC.    01280001
012900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01290001
013000                                                    COMP SYNC.    01300001
013100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01310001
013200                                                    COMP SYNC.    01320001
013300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01330001
013400                                                    COMP SYNC.    01340001
013500     05  PV-SOFT-ABORT-MSG.                                       01350001
013600         10  FILLER            PIC X(12) VALUE ' SUKCS768 - '.    01360001
013700         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01370001
013800         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    01380001
013900         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01390001
014000         10  PV-SOFT-PARAGRAPH PIC X(30).                         01400001
014100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01410001
014200                                                     COMP SYNC.   01420001
014300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 01430001
014400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01440001
014500     05  PV-CICS-MSG-HOLD.                                        01450001
014600         10  FILLER                      PIC  X(01)  VALUE SPACE. 01460001
014700         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 01470001
014800     05  PV-CICS-MSG-HOLD2.                                       01480001
014900         10  FILLER                      PIC  X(01)  VALUE SPACE. 01490001
015000         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 01500001
015100                                                                  01510001
015200     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01520001
015300                                                     COMP SYNC.   01530001
015400     05  PV-COUNT-EXPECTED        PIC S9(04)  VALUE 0 COMP.       01540078
015500     05  PV-COUNT-RELEASED        PIC S9(04)  VALUE 0 COMP.       01550071
015510     05  PV-COUNT-DIRECTIVES      PIC S9(04)  VALUE 0 COMP.       01551082
015600     05  PV-ASSIGN-TMST           PIC  X(26)  VALUE SPACES.       01560001
015610     05  PV-MINIMUM-TMST          PIC  X(26)  VALUE SPACES.       01561057
015700     05  PV-ITEMS-HOLD            PIC S9(03)  COMP-3.             01570001
015800     05  PV-ITEMS-DIFF            PIC S9(03)  COMP-3.             01580001
015900                                                                  01590001
016000******************************************************************01600001
016100**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01610001
016200**  THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          **01620001
016300**  APPLICATION-SPECIFIC COMMAREA.                              **01630001
016400******************************************************************01640001
016500 01  LQW-LIST-QUEUE-WORK-AREA.                                    01650001
016600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01660001
016700     05  LQW-ITEM-ENTRIES               OCCURS 08 TIMES           01670010
016800                                        INDEXED BY LQW-IDX.       01680001
016900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01690001
017000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01700001
017100         10  LQW-SELECTED-SW            PIC  X(01).               01710001
017200             88  LQW-SELECT                         VALUE 'S'.    01720001
017300             88  LQW-DESELECT                       VALUE ' '.    01730001
017400         10  LQW-ACTION                 PIC  X(03).               01740001
017500             88  LQW-ADD                            VALUE 'ADD'.  01750001
017600             88  LQW-INQ                            VALUE 'INQ'.  01760001
017700             88  LQW-UPD                            VALUE 'UPD'.  01770001
017800             88  LQW-ERR                            VALUE 'ERR'.  01780001
017900         10  LQW-RCVR                   PIC  9(04).               01790024
018000         10  LQW-PKG                    PIC  X(01).               01800002
018100         10  LQW-SCAC                   PIC  X(04).               01810002
018110         10  LQW-TRAILER                PIC  X(10).               01811002
018120         10  LQW-TRAILER-STAT           PIC  X(02).               01812002
018130         10  LQW-TRIP-ID                PIC  9(09).               01813006
018140         10  LQW-EXP-CARTONS            PIC  9(04).               01814025
018150         10  LQW-DIRTV-CARTONS          PIC  9(04).               01815025
018160         10  LQW-RLSD-CARTONS           PIC  9(04).               01816025
018200         10  LQW-DIRECTIVE-TMST         PIC  X(26).               01820002
018300                                                                  01830001
018400*---------------------------------------------------------------* 01840001
018500* SELECTION QUEUE LAYOUT                                        * 01850001
018600*---------------------------------------------------------------* 01860001
018700     COPY SUWS099.                                                01870002
018800                                                                  01880001
018900*---------------------------------------------------------------* 01890001
019000*    MAP LAYOUT                                                 * 01900001
019100*---------------------------------------------------------------* 01910001
019200     COPY SUKM768.                                                01920001
019300*                                                                 01930001
019400 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK768O.       01940001
019500     05  FILLER                         PIC X(65).                01950010
019600     05  MR-SCROLL-AREA                 OCCURS 08 TIMES.          01960010
019700         10  MR-SELECTL                 PIC S9(04) COMP.          01970001
019800         10  MR-SELECTA                 PIC  X(01).               01980001
019900         10  MR-SELECTC                 PIC  X(01).               01990001
020000         10  MR-SELECTH                 PIC  X(01).               02000001
020100         10  MR-SELECTI                 PIC  X(01).               02010001
020200                                                                  02020001
020300         10  MR-ACTIONL                 PIC S9(04) COMP.          02030001
020400         10  MR-ACTIONA                 PIC  X(01).               02040001
020500         10  MR-ACTIONC                 PIC  X(01).               02050001
020600         10  MR-ACTIONH                 PIC  X(01).               02060001
020700         10  MR-ACTION                  PIC  X(03).               02070001
020800                                                                  02080001
020900         10  MR-RECEIVERL              PIC S9(04) COMP.           02090026
021000         10  MR-RECEIVERA              PIC  X(01).                02100026
021100         10  MR-RECEIVERC              PIC  X(01).                02110026
021200         10  MR-RECEIVERH              PIC  X(01).                02120026
021300         10  MR-RECEIVER               PIC  Z(04).                02130026
021301                                                                  02130102
021302         10  MR-PKGL                   PIC S9(04) COMP.           02130202
021303         10  MR-PKGA                   PIC  X(01).                02130302
021304         10  MR-PKGC                   PIC  X(01).                02130402
021305         10  MR-PKGH                   PIC  X(01).                02130502
021306         10  MR-PKG                    PIC  X(01).                02130629
021307                                                                  02130702
021308         10  MR-SCACL                  PIC S9(04) COMP.           02130802
021309         10  MR-SCACA                  PIC  X(01).                02130902
021310         10  MR-SCACC                  PIC  X(01).                02131002
021311         10  MR-SCACH                  PIC  X(01).                02131102
021312         10  MR-SCAC                   PIC  X(04).                02131202
021313                                                                  02131302
021314         10  MR-TRAILERL               PIC S9(04) COMP.           02131402
021315         10  MR-TRAILERA               PIC  X(01).                02131502
021316         10  MR-TRAILERC               PIC  X(01).                02131602
021317         10  MR-TRAILERH               PIC  X(01).                02131702
021318         10  MR-TRAILER                PIC  X(10).                02131829
021319                                                                  02131902
021320         10  MR-TRAILER-STATL          PIC S9(04) COMP.           02132006
021321         10  MR-TRAILER-STATA          PIC  X(01).                02132106
021322         10  MR-TRAILER-STATC          PIC  X(01).                02132206
021323         10  MR-TRAILER-STATH          PIC  X(01).                02132306
021324         10  MR-TRAILER-STAT           PIC  X(02).                02132429
021370                                                                  02137001
021380         10  MR-TRIP-IDL               PIC S9(04) COMP.           02138002
021390         10  MR-TRIP-IDA               PIC  X(01).                02139002
021400         10  MR-TRIP-IDC               PIC  X(01).                02140002
021500         10  MR-TRIP-IDH               PIC  X(01).                02150002
021600         10  MR-TRIP-ID                PIC  Z(09).                02160029
021610                                                                  02161002
021620         10  MR-EXP-CRTN-CTL           PIC S9(04) COMP.           02162002
021630         10  MR-EXP-CRTN-CTA           PIC  X(01).                02163002
021640         10  MR-EXP-CRTN-CTC           PIC  X(01).                02164002
021650         10  MR-EXP-CRTN-CTH           PIC  X(01).                02165002
021660         10  MR-EXP-CRTN-CT            PIC  Z(04).                02166077
021700                                                                  02170001
021800         10  MR-DIRTV-CRTN-CTL         PIC S9(04) COMP.           02180027
021900         10  MR-DIRTV-CRTN-CTA         PIC  X(01).                02190027
022000         10  MR-DIRTV-CRTN-CTC         PIC  X(01).                02200027
022100         10  MR-DIRTV-CRTN-CTH         PIC  X(01).                02210027
022200         10  MR-DIRTV-CRTN-CT          PIC  Z(04).                02220077
022300                                                                  02230001
022400         10  MR-RLSD-CRTN-CTL          PIC S9(04) COMP.           02240001
022500         10  MR-RLSD-CRTN-CTA          PIC  X(01).                02250001
022510         10  MR-RLSD-CRTN-CTC          PIC  X(01).                02251001
022520         10  MR-RLSD-CRTN-CTH          PIC  X(01).                02252001
022530         10  MR-RLSD-CRTN-CT           PIC  Z(04).                02253077
022597                                                                  02259701
022598         10  MR-DIRTV-DATEL            PIC S9(04) COMP.           02259862
022599         10  MR-DIRTV-DATEA            PIC  X(01).                02259962
022600         10  MR-DIRTV-DATEC            PIC  X(01).                02260062
022700         10  MR-DIRTV-DATEH            PIC  X(01).                02270062
022800         10  MR-DIRTV-DATE             PIC  X(08).                02280062
022900                                                                  02290001
023000         10  MR-DIRTV-TIMEL            PIC S9(04) COMP.           02300062
023100         10  MR-DIRTV-TIMEA            PIC  X(01).                02310062
023200         10  MR-DIRTV-TIMEC            PIC  X(01).                02320062
023300         10  MR-DIRTV-TIMEH            PIC  X(01).                02330062
023400         10  MR-DIRTV-TIME             PIC  X(08).                02340062
023500                                                                  02350001
023600     05  FILLER                         PIC  X(12).               02360001
023700                                                                  02370001
023800*----------------------------------------------------------------*02380001
023900*  SENDING/RECEIVING AREA FOR THE                                 02390001
024000*  PRINTER VALIDATION ROUTING (DPKCS060)                          02400001
024100*----------------------------------------------------------------*02410001
024200     COPY DPWS072.                                                02420001
024300                                                                  02430001
024400*---------------------------------------------------------------* 02440001
024500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02450001
024600*---------------------------------------------------------------* 02460001
024700     COPY DPWS015.                                                02470001
024710                                                                  02471001
024720*---------------------------------------------------------------* 02472001
024730*    FUNCTION KEYS COPYBOOK.                                    * 02473001
024740*---------------------------------------------------------------* 02474001
024750     COPY DPWS016.                                                02475001
024760                                                                  02476001
024770*---------------------------------------------------------------* 02477001
024780*    NUMERIC EDIT LAYOUT.                                       * 02478001
024790*---------------------------------------------------------------* 02479001
024800     COPY DPWS010I.                                               02480001
024900                                                                  02490001
025000*---------------------------------------------------------------* 02500001
025100*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 02510099
025200*---------------------------------------------------------------* 02520001
025300     COPY DPWS030.                                                02530001
025300     COPY DPWS930.                                                02531099
025400                                                                  02540001
025500*---------------------------------------------------------------* 02550001
025600*    STANDARD COMMAREA.                                         * 02560001
025700*---------------------------------------------------------------* 02570001
025800     COPY DPWS020.                                                02580001
025900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02590001
026000                                                                  02600001
026100*---------------------------------------------------------------* 02610001
026200* INTER-APPLICATION COMMAREA.                                   * 02620001
026300*   SUWS097 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02630003
026400*             SPEC SCREEN.                                      * 02640001
026500*   SUWS098 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02650003
026600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02660001
026700*---------------------------------------------------------------* 02670001
026800         10  INTER-APPL-COMM-AREA       PIC X(200).               02680001
027000     COPY SUWS097.                                                02700073
027010     COPY SUWS098.                                                02701073
027100                                                                  02710001
027200*---------------------------------------------------------------* 02720001
027300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02730001
027400*---------------------------------------------------------------* 02740001
027500         10  ASC-SPECIFIC-COMMAREA.                               02750001
027600             15  ASC-FUNCTION                 PIC  X(01).         02760001
027700             15  ASC-OPER-UNT-ID              PIC  9(04).         02770001
027800             15  ASC-FCLTY-NAME               PIC  X(25).         02780001
027801             15  ASC-PO-NBR                   PIC  9(08).         02780115
027802             15  ASC-RCVR                     PIC  9(04).         02780215
027803             15  ASC-PO-LNE-NBR               PIC  9(04).         02780315
027804             15  ASC-PREPACK-ID               PIC  9(04).         02780415
027805             15  ASC-PACK-TYPE                PIC  X(14).         02780515
027809             15  ASC-ARRIVAL-DATE             PIC  X(08).         02780915
027811             15  ASC-RCVR-EXP-CRTN-CNT        PIC  9(04).         02781115
027812             15  ASC-ORIG-DIRTV-CRTN-CNT      PIC  9(04).         02781215
027813             15  ASC-BRCDE-NBR                PIC  X(22).         02781315
027900             15  ASC-BLK-SUB                  PIC S9(04) COMP     02790001
028000                                                         SYNC.    02800001
028100             15  ASC-ITEM-SUB                 PIC S9(04) COMP     02810001
028200                                                         SYNC.    02820001
028300             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  02830001
028400             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  02840001
028500             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  02850001
028600             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  02860001
028700             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  02870001
028800             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     02880001
028900                                                         SYNC.    02890001
029000             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  02900001
029100             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  02910001
029200             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         02920001
029300                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     02930001
029400                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     02940001
029500             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         02950001
029600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     02960001
029700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     02970001
029800             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         02980001
029900                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     02990001
030000                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03000001
030100             15  ASC-LIST-QUEUE-NAME.                             03010001
030200                 20  ASC-LIST-TERM-ID         PIC  X(04).         03020001
030300                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  03030001
030400                 20  ASC-LIST-SEQ             PIC  9(01).         03040001
030500                                                                  03050001
030600             15  ASC-START-ITEM-REQUEST.                          03060001
030700                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         03070001
030800                                                                  03080001
030900             15  ASC-SEL-SUB                  PIC S9(4) COMP.     03090001
031000             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     03100001
031100             15  ASC-CURSOR-SW                PIC  X(02).         03110001
031200                 88  ASC-NO-CURSOR                   VALUE 'Z '.  03120001
031300                 88  ASC-DOOR-TYPE-CSR               VALUE 'A '.  03130001
031400                                                                  03140001
031500             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          03150001
031600                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03160001
031700             15  ASC-SEL-QUEUE-NAME.                              03170001
031800                 20  ASC-SEL-TERM-ID          PIC  X(04).         03180001
031900                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  03190001
032000                 20  ASC-SEL-SEQ              PIC  9(01).         03200001
032100                                                                  03210001
032200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  03220001
032300                                                                  03230001
032400*-----------------------------------------------------------------03240001
032500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03250001
032600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03260001
032700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03270001
032800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03280001
032900                                                                  03290001
033000                 20  ASC-ITEM-ARRAY.                              03300001
033100                     25  ASC-ITEM-ENTRIES OCCURS 08 TIMES.        03310010
033200                         30  ASC-LIST-ITEM-NUMBER                 03320001
033300                                                     PIC S9(09)   03330001
033400                                                     COMP-3.      03340001
033500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03350001
033600                             88  ASC-VALID-SELECT    VALUE ' '    03360001
033700                                                           'S'    03370001
033800                                                           'B'    03380001
033900                                                           'E'.   03390001
034000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03400001
034100                             88  ASC-TEMP-SELECT     VALUE 'S'.   03410001
034200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03420001
034300                             88  ASC-TEMP-END        VALUE 'E'.   03430001
034400                         30  ASC-SELECTED-SW         PIC  X(01).  03440001
034500                             88  ASC-NO-SELECT       VALUE ' '.   03450001
034600                             88  ASC-SELECT          VALUE 'S'.   03460001
034700                             88  ASC-BEGIN           VALUE 'B'.   03470001
034800                             88  ASC-END             VALUE 'E'.   03480001
034900                         30  ASC-ACTION              PIC  X(03).  03490001
034910                         30  ASC-RECEIVER            PIC  9(04).  03491021
034920                         30  ASC-PKG                 PIC  X(01).  03492002
034930                         30  ASC-SCAC                PIC  X(04).  03493002
034940                         30  ASC-TRAILER             PIC  X(10).  03494002
034950                         30  ASC-TRAILER-STAT        PIC  X(02).  03495002
034960                         30  ASC-TRIP-ID             PIC  9(09).  03496026
034970                         30  ASC-EXP-CARTONS         PIC  9(04).  03497025
034980                         30  ASC-DIRTV-CARTONS       PIC  9(04).  03498025
034990                         30  ASC-RLSD-CARTONS        PIC  9(04).  03499025
034991                         30  ASC-DIRTV-TMST          PIC  X(26).  03499161
035020                                                                  03502001
035030*---------------------------------------------------------------* 03503001
035040*    ABEND PROCESSING COPYBOOK.                                 * 03504001
035050*---------------------------------------------------------------* 03505001
035060     COPY DPWS013.                                                03506001
035070                                                                  03507001
035080*----------------------------------------------------------------*03508001
035090*    DB2 TABLE FOR CARTON DIRECTIVE TRACKING                      03509079
035100*----------------------------------------------------------------*03510001
035200     EXEC SQL                                                     03520001
035300          INCLUDE SUT00102                                        03530019
035400     END-EXEC.                                                    03540001
035401                                                                  03540130
035410*----------------------------------------------------------------*03541030
035420*    INBOUND EDI PACKLIST/VENDOR SHIPMENT UNIT ASSOCIATION        03542079
035430*----------------------------------------------------------------*03543030
035500                                                                  03550001
035510     EXEC SQL                                                     03551030
035520          INCLUDE TINPKSU                                         03552033
035530     END-EXEC.                                                    03553030
035531                                                                  03553132
035532*----------------------------------------------------------------*03553232
035533*    DB2 TABLE FOR PACK SLIP                                      03553379
035534*----------------------------------------------------------------*03553432
035535                                                                  03553532
035536     EXEC SQL                                                     03553632
035537          INCLUDE TPKSLIP                                         03553732
035538     END-EXEC.                                                    03553832
035539                                                                  03553932
035540*----------------------------------------------------------------*03554032
035541*    DB2 TABLE FOR RECEIVER                                       03554179
035543*----------------------------------------------------------------*03554379
035544                                                                  03554479
035545     EXEC SQL                                                     03554579
035546          INCLUDE TRECEIV                                         03554679
035547     END-EXEC.                                                    03554779
035548                                                                  03554879
035549*----------------------------------------------------------------*03554979
035550*    DB2 TABLE FOR SHIPMENT                                       03555079
035551*----------------------------------------------------------------*03555179
035552                                                                  03555279
035553     EXEC SQL                                                     03555379
035554          INCLUDE TSHIPMT                                         03555479
035555     END-EXEC.                                                    03555579
035556                                                                  03555679
035557*----------------------------------------------------------------*03555779
035558*    DB2 TABLE FOR SHIPMENT - PO ASSOCIATION                      03555879
035559*----------------------------------------------------------------*03555979
035560                                                                  03556079
035561     EXEC SQL                                                     03556179
035562          INCLUDE TSHPTPO                                         03556279
035563     END-EXEC.                                                    03556379
035564                                                                  03556479
035565*----------------------------------------------------------------*03556579
035566*    DB2 TABLE FOR SHIPMENT UNIT                                  03556679
035567*----------------------------------------------------------------*03556779
035568                                                                  03556879
035569     EXEC SQL                                                     03556979
035570          INCLUDE TSHPUNT                                         03557079
035571     END-EXEC.                                                    03557179
035572                                                                  03557279
035573*----------------------------------------------------------------*03557379
035574*    DB2 TABLE FOR TRIP STATUS                                    03557479
035575*----------------------------------------------------------------*03557579
035576                                                                  03557679
035577     EXEC SQL                                                     03557779
035578          INCLUDE TTRIPST                                         03557879
035579     END-EXEC.                                                    03557979
035580                                                                  03558079
035581*----------------------------------------------------------------*03558179
035582*    DB2 TABLE FOR TRIP                                           03558279
035583*----------------------------------------------------------------*03558379
035584                                                                  03558479
035585     EXEC SQL                                                     03558579
035586          INCLUDE TVHTRIP                                         03558679
035587     END-EXEC.                                                    03558779
035588                                                                  03558879
035590*----------------------------------------------------------------*03559032
035591*    DB2 TABLE FOR ????                                           03559132
035592*----------------------------------------------------------------*03559232
035593     EXEC SQL                                                     03559332
035594          INCLUDE WST00008                                        03559432
035595     END-EXEC.                                                    03559532
035596                                                                  03559632
035597*----------------------------------------------------------------*03559732
035598*    DB2 TABLE FOR ????                                           03559832
035599*----------------------------------------------------------------*03559932
035600     EXEC SQL                                                     03560032
035601          INCLUDE WST00009                                        03560132
035602     END-EXEC.                                                    03560232
035603                                                                  03560332
035604*----------------------------------------------------------------*03560432
035605*    DB2 TABLE FOR ????                                           03560532
035606*----------------------------------------------------------------*03560632
035607     EXEC SQL                                                     03560732
035608          INCLUDE WST00010                                        03560832
035609     END-EXEC.                                                    03560932
035610                                                                  03561032
035700*---------------------------------------------------------------* 03570001
035800*    DB2 AREA FOR COMMUNICATIONS                                * 03580001
035900*---------------------------------------------------------------* 03590001
036000     EXEC SQL                                                     03600001
036100          INCLUDE SQLCA                                           03610001
036200     END-EXEC.                                                    03620001
036201                                                                  03620118
036202                                                                  03620218
036203*---------------------------------------------------------------* 03620318
036204*                                                               * 03620418
036205*---------------------------------------------------------------* 03620518
036206                                                                  03620618
036207     EXEC SQL                                                     03620764
036208        DECLARE PO-RCVR-CSR   CURSOR FOR                          03620864
036211           SELECT  DISTINCT                                       03621194
036212                   PO_NBR                                         03621294
036213                  ,RCVR_SEQ_NBR                                   03621394
036214             FROM  SUT_CART_DIRV_TRKG          A                  03621494
036215            WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID             03621594
036216              AND  A.PO_NBR         = :DK-PO-NBR                  03621694
036217              AND  A.DIRV_RSN_CDE   <>    'AUQ'                   03621796
036218              AND  A.CRE_TMST       =                             03621894
036219                     ( SELECT MAX (CRE_TMST)                      03621994
036220                       FROM SUT_CART_DIRV_TRKG B                  03622094
036221                       WHERE B.BRCDE_NBR  =  A.BRCDE_NBR          03622194
036222                       )                                          03622294
036223              AND  A.LGCL_LOC_NM  IN                              03622394
036224         (                                                        03622494
036225             SELECT DISTINCT(E.ATTR_ELEM_TXT)                     03622594
036226             FROM WST_INTGRTN_TYP A                               03622694
036227                , WST_ATTR_DEFN           B                       03622794
036228                , WST_ATTR_ELEM           C                       03622894
036229                , WST_ATTR_ELEM           D                       03622994
036230                , WST_ATTR_ELEM           E                       03623094
036231                , WST_ATTR_ELEM           F                       03623194
036232                , WST_ATTR_ELEM           G                       03623294
036233                , WST_ATTR_ELEM           H                       03623394
036234                , WST_ATTR_ELEM           I                       03623494
036235                , WST_ATTR_ELEM           J                       03623594
036236                , WST_ATTR_ELEM           K                       03623694
036237             WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'            03623794
036238               AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE      03623894
036239               AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE      03623994
036240               AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE      03624094
036241               AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE      03624194
036242               AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE      03624294
036243               AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE      03624394
036244               AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE      03624494
036245               AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE      03624594
036246               AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE      03624694
036247               AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE      03624794
036248               AND B.ATTR_DEFN_SEQ_NBR  =  1                      03624894
036249               AND C.ATTR_DEFN_SEQ_NBR  =  1                      03624994
036250               AND D.ATTR_DEFN_SEQ_NBR  =  2                      03625094
036251               AND E.ATTR_DEFN_SEQ_NBR  =  3                      03625194
036252               AND F.ATTR_DEFN_SEQ_NBR  =  4                      03625294
036253               AND G.ATTR_DEFN_SEQ_NBR  =  5                      03625394
036254               AND H.ATTR_DEFN_SEQ_NBR  =  6                      03625494
036255               AND I.ATTR_DEFN_SEQ_NBR  =  7                      03625594
036256               AND J.ATTR_DEFN_SEQ_NBR  =  8                      03625694
036257               AND K.ATTR_DEFN_SEQ_NBR  =  9                      03625794
036258               AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR    03625894
036259               AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR    03625994
036260               AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR    03626094
036261               AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR    03626194
036262               AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR    03626294
036263               AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR    03626394
036264               AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR    03626494
036265               AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR    03626594
036266               AND F.ATTR_ELEM_TXT      =  'Y'                    03626694
036267               AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP      03626794
036268               AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP      03626894
036269               AND C.ATTR_ELEM_NBR      =  :DK-OPER-UNT-ID        03626994
036270               AND K.ATTR_ELEM_TXT      =  'Y'                    03627094
036271                                              )                   03627194
036272               WITH UR                                            03627294
036273     END-EXEC.                                                    03627394
036340                                                                  03634018
036400***************************************************************** 03640001
036500 LINKAGE SECTION.                                                 03650001
036600                                                                  03660001
036700 01  DFHCOMMAREA.                                                 03670001
036800     05  FILLER                         OCCURS  1 TO 4072 TIMES   03680001
036900                                        DEPENDING ON EIBCALEN.    03690001
037000         10  FILLER                     PIC X.                    03700001
037100                                                                  03710001
037200                                                                  03720001
037300 PROCEDURE DIVISION.                                              03730001
037400******************************************************************03740001
037500**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **03750001
037600**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **03760001
037700**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **03770001
037800******************************************************************03780001
037900 0000-MAIN-MODULE.                                                03790001
038000     INITIALIZE DP030-CICS-API-FIELDS.                            03800001
038100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03810001
038200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03820001
038300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03830001
038400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03840001
038500     MOVE LENGTH OF SUK768I        TO DP030-MAP-LENGTH (1).       03850001
038600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03860001
038700     PERFORM 0001-CALL-CICS-ARCH-API.                             03870001
038800*                                                                 03880001
038900     PERFORM 1000-CONTROL-PROCESSING                              03890001
039000*                                                                 03900001
039100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03910001
039200     PERFORM 0001-CALL-CICS-ARCH-API.                             03920001
039300                                                                  03930001
039400******************************************************************03940001
039500**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **03950001
039600**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **03960001
039700******************************************************************03970001
039800 0001-CALL-CICS-ARCH-API.                                         03980001
039900*    CALL 'DPKCS030' USING DFHEIBLK                               03990099
039900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03991099
040000                           DFHCOMMAREA                            04000001
040100                           DP030-CICS-API-FIELDS                  04010001
040200                           DP020-STANDARD-COMMAREA                04020001
040300                           SUK768I.                               04030001
040400*                                                                 04040001
040500     IF  DP030-RC-CALL-SUCCESSFUL                                 04050001
040600         CONTINUE                                                 04060001
040700     ELSE                                                         04070001
040800         SET DP013-NO-ROLLBACK                                    04080001
040900             DP013-XCTL-DISPLAY-RESTART                           04090001
041000             DP013-CICS-ABEND      TO TRUE                        04100001
041100         MOVE '0001-CALL-CICS-ARCH-API'                           04110001
041200                                   TO DP013-PARAGRAPH             04120001
041300*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04130099
041400*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04140099
041300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04141099
041400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04142099
041500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04150001
041600         PERFORM DP013-0000-PROCESS-ABEND                         04160001
041700     END-IF.                                                      04170001
041800                                                                  04180001
041900*----------------------------------------------------------------*04190001
042000* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04200001
042100* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04210001
042200*                                                                *04220001
042300* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04230001
042400*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *04240001
042500*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *04250001
042600*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *04260001
042700*----------------------------------------------------------------*04270001
042800 1000-CONTROL-PROCESSING.                                         04280001
042900     EVALUATE TRUE                                                04290001
043000         WHEN DP020-NEXT-ACT-INITIAL                              04300001
043100             INITIALIZE ASC-SPECIFIC-COMMAREA                     04310001
043200             MOVE EIBTRMID    TO ASC-LIST-TERM-ID                 04320001
043300                                 ASC-SEL-TERM-ID                  04330001
043400             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   04340001
043500                                           ASC-SEL-TASK-NUMBER    04350001
043600             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               04360001
043700             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                04370001
043800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04380001
044100             PERFORM 4000-BUILD-INITIAL-PANEL                     04410001
044200                                                                  04420001
044300         WHEN DP020-NEXT-ACT-READ-MAP                             04430001
044400             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         04440001
044500             PERFORM 2000-PROCESS-PANEL                           04450001
044600                                                                  04460001
044700         WHEN DP020-NEXT-ACT-RETURN                               04470001
044800             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         04480001
044900             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               04490001
045100             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 04510001
045200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04520001
045300                                                                  04530001
045400         WHEN OTHER                                               04540001
045500             SET DP013-LOGIC-ABEND TO TRUE                        04550001
045600             SET DP013-NO-ROLLBACK TO TRUE                        04560001
045700             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    04570001
045800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    04580001
045900                                   TO DP013-MESSAGE-TEXT(1)       04590001
046000             PERFORM DP013-0000-PROCESS-ABEND                     04600001
046100     END-EVALUATE.                                                04610001
046200                                                                  04620001
046300*----------------------------------------------------------------*04630001
046400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *04640001
046500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *04650001
046600*----------------------------------------------------------------*04660001
046700 1100-PROCESS-INTER-APPL-COMM.                                    04670001
046800                                                                  04680001
046900     SET PS-COMMAREA-VALID         TO TRUE.                       04690001
047000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     04700001
047100                                                                  04710001
047200     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          04720001
047300         MOVE SU097-OPER-UNT-ID        TO ASC-OPER-UNT-ID         04730003
047400         MOVE SU097-FCLTY-NME          TO ASC-FCLTY-NAME          04740003
047410         MOVE SU097-PO-NBR             TO ASC-PO-NBR              04741014
047450         MOVE SU097-PACK-TYPE          TO ASC-PACK-TYPE           04745090
047500     ELSE                                                         04750001
047600         MOVE SU097-OPER-UNT-ID        TO ASC-OPER-UNT-ID         04760003
047700     END-IF.                                                      04770001
047800                                                                  04780001
047900*----------------------------------------------------------------*04790001
048000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *04800001
048100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *04810001
048200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *04820001
048300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *04830001
048400* FUNCTION KEYS CAN GET THIS FAR.                                *04840001
048500*----------------------------------------------------------------*04850001
048600 2000-PROCESS-PANEL.                                              04860001
048700     EVALUATE TRUE                                                04870001
048800         WHEN DP020-SRC-AID = DP016-CLEAR                         04880001
048900             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                04890001
049000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04900001
049100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04910001
049200                                                                  04920001
049300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    04930001
049400             PERFORM 2050-DELETE-LIST-QUEUE                       04940001
050000             PERFORM 4000-BUILD-INITIAL-PANEL                     05000001
050100                                                                  05010001
050200         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   05020001
050300             PERFORM 2140-DESELECT-ALL-ITEMS                      05030001
050400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05040001
050500                                                                  05050001
050600         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  05060001
050700             PERFORM 2150-SELECT-ALL-ITEMS                        05070001
050800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05080001
050900                                                                  05090001
051000         WHEN OTHER                                               05100001
051100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05110001
051200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05120001
051300             IF  PS-NO-ERROR                                      05130001
051400                 SET DP030-CONTINUE-GO TO TRUE                    05140001
051500                 PERFORM 2100-CHECK-FUNCTION-KEY                  05150001
051600             ELSE                                                 05160001
051700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05170001
051800                 SET DP030-OVERRIDE-GO TO TRUE                    05180001
051900             END-IF                                               05190001
052000     END-EVALUATE.                                                05200001
052100                                                                  05210001
052200*----------------------------------------------------------------*05220001
052300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *05230001
052400*----------------------------------------------------------------*05240001
052500 2050-DELETE-LIST-QUEUE.                                          05250001
052600                                                                  05260001
052700     EXEC CICS                                                    05270001
052800         DELETEQ TS                                               05280001
052900             QUEUE (ASC-LIST-QUEUE-NAME)                          05290001
053000             RESP  (PV-CICS-RESP)                                 05300001
053100     END-EXEC.                                                    05310001
053200                                                                  05320001
053300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       05330001
053400        (PV-CICS-RESP = DFHRESP(QIDERR))                          05340001
053500         CONTINUE                                                 05350001
053600     ELSE                                                         05360001
053700         SET DP013-CICS-ABEND      TO TRUE                        05370001
053800         SET DP013-NO-ROLLBACK     TO TRUE                        05380001
053900                                                                  05390001
054000         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         05400001
054100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    05410001
054200                                   TO DP013-MESSAGE-TEXT (1)      05420001
054300         PERFORM DP013-0000-PROCESS-ABEND                         05430001
054400     END-IF.                                                      05440001
054500                                                                  05450001
054600     MOVE +0  TO ASC-HIGHEST-BLOCK-WRITTEN.                       05460001
054700                                                                  05470001
054800*----------------------------------------------------------------*05480001
054900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*05490001
055000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *05500001
055100* CICS ARCHITECTURE API.                                         *05510001
055200*----------------------------------------------------------------*05520001
055300 2100-CHECK-FUNCTION-KEY.                                         05530001
055400                                                                  05540001
055500     EVALUATE TRUE                                                05550001
055700* F23 -  LNERLLST (LOCAL-FUNC-01) SULDRLNE                        05570086
055800*                SUKCS799 - DIRECTIVE RELEASE BY RECEIVER         05580086
055900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05590001
056000             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            05600001
056100             IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                  05610001
056200                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              05620001
056300                     SET ASC-USE-SELECTION-QUEUE TO TRUE          05630001
056400                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            05640001
056500                                TO SU098-NUMBER-OF-SELECTED-ITEMS 05650003
056600                     MOVE ASC-NUMBER-OF-TS-ITEMS                  05660001
056700                                      TO SU098-NUMBER-OF-TS-ITEMS 05670003
056800                     MOVE ASC-SEL-QUEUE-NAME                      05680001
056900                                         TO  SU098-SEL-QUEUE-NAME 05690003
057000                     MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID    05700001
057100                     MOVE ASC-OPER-UNT-ID  TO SU098-OPER-UNT-ID   05710003
057200                     MOVE ASC-FCLTY-NAME   TO SU098-FCLTY-NME     05720003
057210                     MOVE ASC-PO-NBR       TO SU098-PO-NBR        05721084
057300                     MOVE 1                TO SU098-FCLTY-ID      05730003
057400                     PERFORM 5000-PREPARE-SEL-QUEUE               05740001
057500                 ELSE                                             05750001
057600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         05760001
057700                     SET DP030-OVERRIDE-GO TO TRUE                05770001
057800                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    05780001
057900                     SET DP020-MSG-FATAL   TO TRUE                05790001
058000                 END-IF                                           05800001
058100             ELSE                                                 05810001
058200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05820001
058300                 SET DP030-OVERRIDE-GO TO TRUE                    05830001
058400                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        05840001
058500                 SET PS-ERROR                                     05850001
058600                     DP020-MSG-FATAL   TO TRUE                    05860001
058700             END-IF                                               05870001
058710                                                                  05871086
058720* F24 -  CTNRLIST (LOCAL-FUNC-02) SULDIRCN                        05872086
058730*                SUKCS765 - DIRECTIVE RELEASE BY CARTON           05873086
058740         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              05874087
058750             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            05875086
058760             IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                  05876086
058770                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              05877086
058780                     SET ASC-USE-SELECTION-QUEUE TO TRUE          05878086
058790                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            05879086
058791                                TO SU098-NUMBER-OF-SELECTED-ITEMS 05879186
058792                     MOVE ASC-NUMBER-OF-TS-ITEMS                  05879286
058793                                      TO SU098-NUMBER-OF-TS-ITEMS 05879386
058794                     MOVE ASC-SEL-QUEUE-NAME                      05879486
058795                                         TO  SU098-SEL-QUEUE-NAME 05879586
058796                     MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID    05879686
058797                     MOVE ASC-OPER-UNT-ID  TO SU098-OPER-UNT-ID   05879786
058798                     MOVE ASC-FCLTY-NAME   TO SU098-FCLTY-NME     05879886
058799                     MOVE ASC-PO-NBR       TO SU098-PO-NBR        05879986
058800                     MOVE 1                TO SU098-FCLTY-ID      05880086
058801                     PERFORM 5000-PREPARE-SEL-QUEUE               05880186
058802                 ELSE                                             05880286
058803                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         05880386
058804                     SET DP030-OVERRIDE-GO TO TRUE                05880486
058805                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    05880586
058806                     SET DP020-MSG-FATAL   TO TRUE                05880686
058807                 END-IF                                           05880786
058808             ELSE                                                 05880886
058809                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05880986
058810                 SET DP030-OVERRIDE-GO TO TRUE                    05881086
058811                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        05881186
058812                 SET PS-ERROR                                     05881286
058813                     DP020-MSG-FATAL   TO TRUE                    05881386
058814             END-IF                                               05881486
059800                                                                  05980001
059900* F6 - FIRST PAGE                                                 05990001
060000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06000001
060100             MOVE +1               TO PV-TOP-ITEM                 06010001
060200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06020001
060300                                                                  06030001
060400* F7 - PREVIOUS PAGE                                              06040001
060500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06050001
060600             PERFORM 2110-BROWSE-BACKWARD                         06060001
060700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06070001
060800                                                                  06080001
060900* F8 - NEXT PAGE                                                  06090001
061000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06100001
061100             PERFORM 2120-BROWSE-FORWARD                          06110001
061200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06120001
061300                                                                  06130001
061400* ENTER KEY                                                       06140001
061500         WHEN DP020-SRC-AID = DP016-ENTER                         06150001
061600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06160001
061700             IF  PS-ERROR                                         06170001
061800                 CONTINUE                                         06180001
061900             ELSE                                                 06190001
062000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06200001
062100             END-IF                                               06210001
062200                                                                  06220001
062300         WHEN OTHER                                               06230001
062400             SET DP013-NO-ROLLBACK                                06240001
062500                 DP013-XCTL-DISPLAY-RESTART                       06250001
062600                 DP013-CICS-ABEND  TO TRUE                        06260001
062700             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    06270001
062800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06280001
062900                                   TO DP013-MESSAGE-TEXT (1)      06290001
063000             PERFORM DP013-0000-PROCESS-ABEND                     06300001
063100     END-EVALUATE.                                                06310001
063200                                                                  06320001
063300******************************************************************06330001
063400** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06340001
063500** INTER-APPLICATION COMMAREA.                                  **06350001
063600******************************************************************06360001
063700 2110-PREPARE-INTER-APPL-COMM.                                    06370001
063800                                                                  06380001
063900     INITIALIZE SU098-INTER-APPL-COMMAREA.                        06390073
064000                                                                  06400001
064100     MOVE DP020-LOCATION-NBR       TO DK-OPER-UNT-ID.             06410001
064200     MOVE ASC-OPER-UNT-ID          TO SU098-OPER-UNT-ID.          06420073
064300     MOVE ASC-FCLTY-NAME           TO SU098-FCLTY-NME.            06430073
064310     MOVE ASC-PO-NBR               TO SU098-PO-NBR.               06431073
064320     MOVE ASC-PACK-TYPE            TO SU098-PACK-TYPE.            06432090
064400                                                                  06440001
064500*----------------------------------------------------------------*06450001
064600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06460001
064700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06470001
064800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06480001
064900*    MESSAGE.                                                    *06490001
065000*----------------------------------------------------------------*06500001
065100 2110-BROWSE-BACKWARD.                                            06510001
065200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    06520001
065300         GIVING PV-TOP-ITEM.                                      06530001
065400*                                                                 06540001
065500     IF  ((PV-TOP-ITEM < +1)                                      06550001
065600       OR (PV-TOP-ITEM = +1))                                     06560001
065700         MOVE +1                   TO PV-TOP-ITEM                 06570001
065800*        -- TOP OF LIST --                                        06580001
065900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            06590001
066000         SET DP020-MSG-INFORMATIONAL TO TRUE                      06600001
066100     END-IF.                                                      06610001
066200                                                                  06620001
066300*----------------------------------------------------------------*06630001
066400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *06640001
066500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *06650001
066600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *06660001
066700*----------------------------------------------------------------*06670001
066800 2120-BROWSE-FORWARD.                                             06680001
066900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              06690001
067000         GIVING PV-TOP-ITEM.                                      06700001
067100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   06710001
067200         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             06720001
067300*        -- BOTTOM OF LIST --                                     06730001
067400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            06740001
067500         SET DP020-MSG-INFORMATIONAL TO TRUE                      06750001
067600     ELSE                                                         06760001
067700         COMPUTE PV-BOTTOM-ITEM =                                 06770001
067800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 06780001
067900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            06790001
068000*            -- BOTTOM OF LIST --                                 06800001
068100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            06810001
068200             SET DP020-MSG-INFORMATIONAL TO TRUE                  06820001
068300         END-IF                                                   06830001
068400     END-IF.                                                      06840001
068500                                                                  06850001
068600*----------------------------------------------------------------*06860001
068700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *06870001
068800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *06880001
068900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *06890001
069000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *06900001
069100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *06910001
069200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *06920001
069300*----------------------------------------------------------------*06930001
069400 2130-CHECK-FOR-JUMP-BROWSE.                                      06940001
069500     SET PS-NO-ERROR               TO TRUE.                       06950001
069600     IF (ASC-START-ITEM-REQUEST = SPACE)                          06960001
069700         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             06970001
069800     ELSE                                                         06980001
069900         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     06990001
070000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07000001
070100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07010001
070200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07020001
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07031099
263968              USING DP010I-NUMERIC-EDIT-AREA                      07032099
070400                                                                  07040001
070500         IF  NOT DP010I-ERROR-DETECTED                            07050001
070600             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N07060001
070700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07070001
070800                 IF  ASC-START-ITEM-REQUEST-N >                   07080001
070900                                          ASC-NUMBER-OF-ITEMS-READ07090001
071000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07100001
071100                     COMPUTE PV-TOP-ITEM =                        07110001
071200                             ASC-NUMBER-OF-ITEMS-READ             07120001
071300                             - PC-ITEMS-PER-PANEL + 1             07130001
071400                     IF  PV-TOP-ITEM < +1                         07140001
071500                         MOVE +1   TO PV-TOP-ITEM                 07150001
071600                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07160001
071700                         SET DP020-MSG-INFORMATIONAL TO TRUE      07170001
071800                     END-IF                                       07180001
071900                 ELSE                                             07190001
072000                     MOVE ASC-START-ITEM-REQUEST-N                07200001
072100                                   TO PV-TOP-ITEM                 07210001
072200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07220001
072300                     COMPUTE PV-BOTTOM-ITEM =                     07230001
072400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07240001
072500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07250001
072600*                        -- BOTTOM OF LIST --                     07260001
072700                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07270001
072800                         SET DP020-MSG-INFORMATIONAL TO TRUE      07280001
072900                     END-IF                                       07290001
073000                 END-IF                                           07300001
073100             ELSE                                                 07310001
073200*                --- VALUE OUT OF RANGE ----                      07320001
073300                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         07330001
073400                 MOVE -1              TO ASTRTITL                 07340001
073500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07350001
073600                 MOVE DP015-REVERSE   TO ASTRTITH                 07360001
073700                 MOVE DP015-RED       TO ASTRTITC                 07370001
073800                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           07380001
073900                 SET DP020-MSG-FATAL  TO TRUE                     07390001
074000                 SET PS-ERROR         TO TRUE                     07400001
074100             END-IF                                               07410001
074200         ELSE                                                     07420001
074300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07430001
074400             MOVE -1               TO ASTRTITL                    07440001
074500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07450001
074600             MOVE DP015-REVERSE    TO ASTRTITH                    07460001
074700             MOVE DP015-RED        TO ASTRTITC                    07470001
074800             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               07480001
074900             SET DP020-MSG-FATAL   TO TRUE                        07490001
075000             SET PS-ERROR          TO TRUE                        07500001
075100         END-IF                                                   07510001
075200     END-IF.                                                      07520001
075300                                                                  07530001
075400*----------------------------------------------------------------*07540001
075500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *07550001
075600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *07560001
075700*----------------------------------------------------------------*07570001
075800 2140-DESELECT-ALL-ITEMS.                                         07580001
075900     MOVE +1                       TO ASC-BLK-SUB.                07590001
076000                                                                  07600001
076100     PERFORM 2141-CLEAR-SELECTED-INDS                             07610001
076200         VARYING ASC-ITEM-SUB                                     07620001
076300         FROM 1 BY 1                                              07630001
076400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 07640001
076500                                                                  07650001
076600     ADD +1                        TO ASC-BLK-SUB.                07660001
076700                                                                  07670001
076800     PERFORM 2141-CLEAR-SELECTED-INDS                             07680001
076900         VARYING ASC-ITEM-SUB                                     07690001
077000         FROM 1 BY 1                                              07700001
077100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 07710001
077200                                                                  07720001
077300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               07730001
077400                                   TO PV-LIST-ITEM-NUMBER.        07740001
077500                                                                  07750001
077600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            07760001
077700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    07770001
077800                                                                  07780001
077900     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            07790001
078000         MOVE +1                   TO ASC-BLK-SUB                 07800001
078100                                                                  07810001
078200         PERFORM 5100-WRITE-TEMP-STORAGE                          07820001
078300         MOVE +2                   TO ASC-BLK-SUB                 07830001
078400         PERFORM 5100-WRITE-TEMP-STORAGE                          07840001
078500         MOVE +1                   TO ASC-BLK-SUB                 07850001
078600         MOVE +1                   TO PV-BLOCK-NUMBER             07860001
078700     END-IF.                                                      07870001
078800                                                                  07880001
078900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     07890001
079000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      07900001
079100         MOVE +1                   TO ASC-BLK-SUB                 07910001
079200                                                                  07920001
079300         PERFORM 5100-WRITE-TEMP-STORAGE                          07930001
079400         MOVE +2  TO ASC-BLK-SUB                                  07940001
079500         PERFORM 5100-WRITE-TEMP-STORAGE                          07950001
079600         MOVE +1  TO ASC-BLK-SUB                                  07960001
079700         MOVE +1  TO PV-BLOCK-NUMBER                              07970001
079800                                                                  07980001
079900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         07990001
080000             PV-FIRST-BLOCK-IN-ARRAY - 1                          08000001
080100                                                                  08010001
080200         PERFORM                                                  08020001
080300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       08030001
080400                                                                  08040001
080500             PERFORM 4410-READ-TEMP-STORAGE                       08050001
080600                                                                  08060001
080700             PERFORM 2141-CLEAR-SELECTED-INDS                     08070001
080800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 08080001
080900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08090001
081000                                                                  08100001
081100             PERFORM 5100-WRITE-TEMP-STORAGE                      08110001
081200                                                                  08120001
081300             ADD +1                TO PV-BLOCK-NUMBER             08130001
081400                                                                  08140001
081500         END-PERFORM                                              08150001
081600                                                                  08160001
081700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         08170001
081800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     08180001
081900                                                                  08190001
082000         PERFORM                                                  08200001
082100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       08210001
082200                   ASC-HIGHEST-BLOCK-WRITTEN                      08220001
082300                                                                  08230001
082400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          08240001
082500                                   TO PV-BLOCK-NUMBER             08250001
082600                                                                  08260001
082700             PERFORM 4410-READ-TEMP-STORAGE                       08270001
082800                                                                  08280001
082900             PERFORM 2141-CLEAR-SELECTED-INDS                     08290001
083000                 VARYING ASC-ITEM-SUB                             08300001
083100                 FROM 1 BY 1                                      08310001
083200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08320001
083300                                                                  08330001
083400             PERFORM 5100-WRITE-TEMP-STORAGE                      08340001
083500                                                                  08350001
083600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      08360001
083700                                                                  08370001
083800         END-PERFORM                                              08380001
083900                                                                  08390001
084000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             08400001
084100                                   TO PV-BLOCK-NUMBER             08410001
084200                                                                  08420001
084300         PERFORM 4410-READ-TEMP-STORAGE                           08430001
084400     END-IF.                                                      08440001
084500                                                                  08450001
084600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 08460001
084700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.08470001
084800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  08480001
084900                                                                  08490001
085000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        08500001
085100                                                                  08510001
085200*----------------------------------------------------------------*08520001
085300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *08530001
085400*----------------------------------------------------------------*08540001
085500 2141-CLEAR-SELECTED-INDS.                                        08550001
085600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           08560001
085700             NOT EQUAL ZERO                                       08570001
085800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          08580001
085900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          08590001
086000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    08600001
086100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          08610001
086200         END-IF                                                   08620001
086300     END-IF.                                                      08630001
086400                                                                  08640001
086500*----------------------------------------------------------------*08650001
086600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *08660001
086700*  FOR ALL ITEMS.                                                *08670001
086800*----------------------------------------------------------------*08680001
086900 2150-SELECT-ALL-ITEMS.                                           08690001
087000     MOVE +1                       TO ASC-BLK-SUB.                08700001
087100                                                                  08710001
087200     PERFORM 2151-SET-SELECTED-INDS                               08720001
087300         VARYING ASC-ITEM-SUB                                     08730001
087400         FROM 1 BY 1                                              08740001
087500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 08750001
087600                                                                  08760001
087700     ADD +1                        TO ASC-BLK-SUB.                08770001
087800                                                                  08780001
087900     PERFORM 2151-SET-SELECTED-INDS                               08790001
088000         VARYING ASC-ITEM-SUB                                     08800001
088100         FROM 1 BY 1                                              08810001
088200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 08820001
088300                                                                  08830001
088400     MOVE ASC-LIST-ITEM-NUMBER(1 1)  TO PV-LIST-ITEM-NUMBER.      08840001
088500                                                                  08850001
088600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            08860001
088700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    08870001
088800                                                                  08880001
088900     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            08890001
089000         MOVE +1                   TO ASC-BLK-SUB                 08900001
089100                                                                  08910001
089200         PERFORM 5100-WRITE-TEMP-STORAGE                          08920001
089300         MOVE +2                   TO ASC-BLK-SUB                 08930001
089400         PERFORM 5100-WRITE-TEMP-STORAGE                          08940001
089500         MOVE +1                   TO ASC-BLK-SUB                 08950001
089600         MOVE +1                   TO PV-BLOCK-NUMBER             08960001
089700     END-IF.                                                      08970001
089800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     08980001
089900        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    08990001
090000         MOVE +1                   TO ASC-BLK-SUB                 09000001
090100                                                                  09010001
090200         PERFORM 5100-WRITE-TEMP-STORAGE                          09020001
090300                                                                  09030001
090400         MOVE +1                   TO PV-BLOCK-NUMBER             09040001
090500                                                                  09050001
090600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09060001
090700             PV-FIRST-BLOCK-IN-ARRAY - 1                          09070001
090800                                                                  09080001
090900         PERFORM                                                  09090001
091000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       09100001
091100                                                                  09110001
091200             PERFORM 4410-READ-TEMP-STORAGE                       09120001
091300                                                                  09130001
091400             PERFORM 2151-SET-SELECTED-INDS                       09140001
091500                 VARYING ASC-ITEM-SUB                             09150001
091600                 FROM 1 BY 1                                      09160001
091700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09170001
091800                                                                  09180001
091900             PERFORM 5100-WRITE-TEMP-STORAGE                      09190001
092000                                                                  09200001
092100             ADD +1                TO PV-BLOCK-NUMBER             09210001
092200                                                                  09220001
092300         END-PERFORM                                              09230001
092400                                                                  09240001
092500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         09250001
092600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     09260001
092700                                                                  09270001
092800         PERFORM                                                  09280001
092900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       09290001
093000                   ASC-HIGHEST-BLOCK-WRITTEN                      09300001
093100                                                                  09310001
093200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          09320001
093300                                   TO PV-BLOCK-NUMBER             09330001
093400                                                                  09340001
093500             PERFORM 4410-READ-TEMP-STORAGE                       09350001
093600                                                                  09360001
093700             PERFORM 2151-SET-SELECTED-INDS                       09370001
093800                 VARYING ASC-ITEM-SUB                             09380001
093900                 FROM 1 BY 1                                      09390001
094000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09400001
094100                                                                  09410001
094200             PERFORM 5100-WRITE-TEMP-STORAGE                      09420001
094300                                                                  09430001
094400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      09440001
094500                                                                  09450001
094600         END-PERFORM                                              09460001
094700                                                                  09470001
094800         MOVE PV-FIRST-BLOCK-IN-ARRAY  TO PV-BLOCK-NUMBER         09480001
094900                                                                  09490001
095000         PERFORM 4410-READ-TEMP-STORAGE                           09500001
095100     END-IF.                                                      09510001
095200                                                                  09520001
095300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             09530001
095400                       ASC-NUMBER-OF-SELECTED-ITEMS.              09540001
095500                                                                  09550001
095600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        09560001
095700                                                                  09570001
095800*----------------------------------------------------------------*09580001
095900*    MARK EACH ITEM AS BEING SELECTED.                           *09590001
096000*----------------------------------------------------------------*09600001
096100 2151-SET-SELECTED-INDS.                                          09610001
096200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           09620001
096300             NOT EQUAL ZERO                                       09630001
096400         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             09640001
096500             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             09650001
096600                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        09660001
096700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  09670001
096800                               TO  TRUE                           09680001
096900         END-IF                                                   09690001
097000     END-IF.                                                      09700001
097100                                                                  09710001
097200******************************************************************09720001
097300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **09730001
097400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **09740001
097500******************************************************************09750001
097600 2200-MOVE-SCREEN-TO-COMMAREA.                                    09760001
097700                                                                  09770001
097800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             09780001
097900     MOVE +1                       TO PV-SUB.                     09790001
098000*                                                                 09800001
098100     PERFORM 3100-SET-SUBSCRIPTS.                                 09810001
098200                                                                  09820001
098300     IF  ASTRTITL > ZERO                                          09830001
098400         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          09840001
098500     ELSE                                                         09850001
098600         IF  ASTRTITF = DP015-ERASE-EOF                           09860001
098700             INITIALIZE ASC-START-ITEM-REQUEST                    09870001
098800         END-IF                                                   09880001
098900     END-IF.                                                      09890001
099000                                                                  09900001
099100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          09910001
099200         VARYING PV-SUB FROM 1 BY 1                               09920001
099300         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      09930001
099400                                                                  09940001
099500******************************************************************09950001
099600** MOVE THE ENTERABLE FIELDS OF EACH LIST LINE INTO THE COMMAREA**09960001
099700******************************************************************09970001
099800 2210-MOVE-LINES-TO-COMMAREA.                                     09980001
099900     IF  MR-SELECTL (PV-SUB) > ZERO                               09990001
100000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             10000001
100100         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        10010001
100200                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10020001
100300     ELSE                                                         10030001
100400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                10040001
100500                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     10050001
100600                 MOVE SPACE  TO ASC-TEMP-SELECTED-SW              10060001
100700                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10070001
100800         END-IF                                                   10080001
100900     END-IF.                                                      10090001
101000                                                                  10100001
101100     ADD +1                        TO ASC-ITEM-SUB.               10110001
101200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        10120001
101300         ADD +1                    TO ASC-BLK-SUB                 10130001
101400         MOVE +1                   TO ASC-ITEM-SUB                10140001
101500     END-IF.                                                      10150001
101600                                                                  10160001
101700******************************************************************10170001
101800** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **10180001
101900** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **10190001
102000******************************************************************10200001
102100 3000-EDIT-DATA-IN-COMMAREA.                                      10210001
102200     PERFORM 3200-RESET-ATTRIBUTES.                               10220001
102300     SET PS-NO-ERROR               TO TRUE.                       10230001
102400     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     10240001
102500                                                                  10250001
102600* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              10260001
102700* EDITTING IS DONE FROM THE BOTTOM UP.                            10270001
102800**                                                                10280001
102900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       10290001
103000         ASC-ITEMS-DISPLAYED - 1.                                 10300001
103100     PERFORM 3100-SET-SUBSCRIPTS.                                 10310001
103200                                                                  10320001
103300      IF  PS-NO-ERROR                                             10330001
103400          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       10340001
103500      END-IF.                                                     10350001
103600                                                                  10360001
103700     IF  PS-NO-ERROR                                              10370001
103800         PERFORM 3400-CHECK-RANGE-SEQUENCE                        10380001
103900     END-IF.                                                      10390001
104000                                                                  10400001
104100     IF  ((PS-NO-ERROR)                                           10410001
104200       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   10420001
104300       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    10430001
104400             PERFORM 3500-MARK-RANGE-AS-SELECTED                  10440001
104500     END-IF.                                                      10450001
104600                                                                  10460001
104700*----------------------------------------------------------------*10470001
104800* 3005-EDIT-COMMAREA-BLOCKS                                      *10480001
104900*----------------------------------------------------------------*10490001
105000 3005-EDIT-COMMAREA-BLOCKS.                                       10500001
105100     MOVE +1                       TO PV-BLOCK-NUMBER.            10510001
105200     MOVE +1                       TO ASC-BLK-SUB.                10520001
105300     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               10530001
105400                                                                  10540001
105500     COMPUTE PV-BLOCK-NUMBER  =                                   10550001
105600             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            10560001
105700             PC-ITEMS-PER-PANEL.                                  10570001
105800                                                                  10580001
105900     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          10590001
106000                                                                  10600001
106100     PERFORM                                                      10610001
106200        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         10620001
106300           OR PS-ERROR                                            10630001
106400           OR PS-BLOCK-ERROR                                      10640001
106500                                                                  10650001
106600              COMPUTE PV-ITEMS-HOLD  =                            10660001
106700                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       10670001
106800                      PC-ITEMS-PER-PANEL - 1                      10680001
106900                                                                  10690001
107000               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     10700001
107100                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             10710001
107200                       FROM  PV-ITEMS-HOLD                        10720001
107300                     GIVING  PV-ITEMS-DIFF                        10730001
107400                   SUBTRACT  PV-ITEMS-DIFF                        10740001
107500                       FROM  PC-ITEMS-PER-PANEL                   10750001
107600                     GIVING  PV-ITEMS-HOLD                        10760001
107700                       MOVE  PV-ITEMS-HOLD TO PV-SUB              10770001
107800                                              ASC-ITEM-SUB        10780001
107900                                              ASC-ITEMS-DISPLAYED 10790001
108000               ELSE                                               10800001
108100                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            10810001
108200                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      10820001
108300               END-IF                                             10830001
108400                                                                  10840001
108500               PERFORM 3300-EDIT-SELECTIONS                       10850001
108600                       VARYING PV-SUB                             10860001
108700                          FROM PV-SUB BY -1                       10870001
108800                          UNTIL PV-SUB < +1                       10880001
108900                                                                  10890001
109000               MOVE +1               TO ASC-BLK-SUB               10900001
109100                                                                  10910001
109200               PERFORM 5105-REWRITE-ASC-LISTQ                     10920001
109300                                                                  10930001
109400               MOVE +1                TO ASC-BLK-SUB              10940001
109500                                                                  10950001
109600               IF  PS-BLOCK-ERROR                                 10960001
109700                   SET  PS-ERROR     TO TRUE                      10970001
109800                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      10980001
109900                                     TO PV-TOP-ITEM               10990001
110000               ELSE                                               11000001
110100                   ADD  +1           TO PV-BLOCK-NUMBER           11010001
110200                   IF  PV-BLOCK-NUMBER >                          11020001
110300                       ASC-HIGHEST-BLOCK-WRITTEN                  11030001
110400                       MOVE +2       TO ASC-BLK-SUB               11040001
110500                       PERFORM 4410-READ-TEMP-STORAGE             11050001
110600                       MOVE +1       TO ASC-BLK-SUB               11060001
110700                   ELSE                                           11070001
110800                       PERFORM 4410-READ-TEMP-STORAGE             11080001
110900                       ADD  +1        TO PV-BLOCK-NUMBER          11090001
111000                       MOVE +2        TO ASC-BLK-SUB              11100001
111100                       PERFORM 4410-READ-TEMP-STORAGE             11110001
111200                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          11120001
111300                       MOVE +1        TO ASC-BLK-SUB              11130001
111400               END-IF                                             11140001
111500           END-IF                                                 11150001
111600     END-PERFORM.                                                 11160001
111700                                                                  11170001
111800     IF  (PV-ORIGINAL-BLOCK  = +1   AND                           11180001
111900          ASC-LIST-ITEM-NUMBER (1 1) = 1)  OR                     11190001
112000         PS-ERROR                   OR                            11200001
112100         PS-BLOCK-ERROR                                           11210001
112200             CONTINUE                                             11220001
112300     ELSE                                                         11230001
112400         MOVE +1                 TO PV-BLOCK-NUMBER               11240001
112500         MOVE +1                 TO ASC-BLK-SUB                   11250001
112600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  11260001
112700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           11270001
112800         PERFORM 4410-READ-TEMP-STORAGE                           11280001
112900                                                                  11290001
113000         PERFORM                                                  11300001
113100            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             11310001
113200               OR PS-ERROR                                        11320001
113300               OR PS-BLOCK-ERROR                                  11330001
113400                                                                  11340001
113500                  COMPUTE PV-ITEMS-HOLD  =                        11350001
113600                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   11360001
113700                          PC-ITEMS-PER-PANEL - 1                  11370001
113800                                                                  11380001
113900                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    11390001
114000                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          11400001
114100                          FROM  PV-ITEMS-HOLD                     11410001
114200                        GIVING  PV-ITEMS-DIFF                     11420001
114300                      SUBTRACT  PV-ITEMS-DIFF                     11430001
114400                          FROM  PC-ITEMS-PER-PANEL                11440001
114500                        GIVING  PV-ITEMS-HOLD                     11450001
114600                          MOVE  PV-ITEMS-HOLD TO PV-SUB           11460001
114700                                                 ASC-ITEM-SUB     11470001
114800                                              ASC-ITEMS-DISPLAYED 11480001
114900                  ELSE                                            11490001
115000                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         11500001
115100                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   11510001
115200                  END-IF                                          11520001
115300                                                                  11530001
115400                  PERFORM 3300-EDIT-SELECTIONS                    11540001
115500                          VARYING PV-SUB                          11550001
115600                             FROM PV-SUB BY -1                    11560001
115700                            UNTIL PV-SUB < +1                     11570001
115800                                                                  11580001
115900                  MOVE +1               TO ASC-BLK-SUB            11590001
116000                                                                  11600001
116100                  PERFORM 5105-REWRITE-ASC-LISTQ                  11610001
116200                                                                  11620001
116300                  MOVE +1                TO ASC-BLK-SUB           11630001
116400                                                                  11640001
116500                  IF  PS-BLOCK-ERROR                              11650001
116600                      SET  PS-ERROR     TO TRUE                   11660001
116700                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   11670001
116800                                        TO PV-TOP-ITEM            11680001
116900                  ELSE                                            11690001
117000                      ADD  +1            TO PV-BLOCK-NUMBER       11700001
117100                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     11710001
117200                          MOVE +2        TO ASC-BLK-SUB           11720001
117300                          PERFORM 4410-READ-TEMP-STORAGE          11730001
117400                          MOVE +1        TO ASC-BLK-SUB           11740001
117500                      ELSE                                        11750001
117600                          PERFORM 4410-READ-TEMP-STORAGE          11760001
117700                          ADD  +1        TO PV-BLOCK-NUMBER       11770001
117800                          MOVE +2        TO ASC-BLK-SUB           11780001
117900                          PERFORM 4410-READ-TEMP-STORAGE          11790001
118000                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       11800001
118100                          MOVE +1        TO ASC-BLK-SUB           11810001
118200                      END-IF                                      11820001
118300                  END-IF                                          11830001
118400     END-PERFORM.                                                 11840001
118500     MOVE +0 TO PV-ITEMS-HOLD.                                    11850001
118600                                                                  11860001
118700*----------------------------------------------------------------*11870001
118800*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *11880001
118900*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*11890001
119000*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *11900001
119100*                                                                *11910001
119200*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *11920001
119300*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *11930001
119400*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *11940001
119500*    US IN THE 2ND BLOCK OF THE ARRAY.                           *11950001
119600*----------------------------------------------------------------*11960001
119700 3100-SET-SUBSCRIPTS.                                             11970001
119800     COMPUTE ASC-ITEM-SUB =                                       11980001
119900         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        11990001
120000                                                                  12000001
120100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         12010001
120200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            12020001
120300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               12030001
120400     ELSE                                                         12040001
120500         MOVE +1                     TO ASC-BLK-SUB               12050001
120600     END-IF.                                                      12060001
120700                                                                  12070001
120800******************************************************************12080001
120900** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **12090001
121000******************************************************************12100001
121100 3200-RESET-ATTRIBUTES.                                           12110001
121200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   12120001
121300     MOVE DP015-GREEN              TO ASTRTITC.                   12130001
121400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   12140001
121500                                                                  12150001
121600     PERFORM                                                      12160001
121700         VARYING PV-SUB                                           12170001
121800         FROM 1 BY 1                                              12180001
121900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        12190001
122000                                                                  12200001
122100         MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)        12210001
122200         MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)        12220001
122300         MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)        12230001
122400                                                                  12240001
122500     END-PERFORM.                                                 12250001
122600                                                                  12260001
122700******************************************************************12270001
122800** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **12280001
122900** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **12290001
123000** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **12300001
123100** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **12310001
123200******************************************************************12320001
123300 3300-EDIT-SELECTIONS.                                            12330001
123400     EVALUATE TRUE                                                12340001
123500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12350001
123600             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         12360001
123700                 CONTINUE                                         12370001
123800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         12380001
123900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        12390001
124000                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   12400001
124100                 MOVE ASC-TEMP-SELECTED-SW                        12410001
124200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12420001
124300                                TO ASC-SELECTED-SW                12430001
124400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12440001
124500             END-IF                                               12450001
124600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12460001
124700                 = SPACE                                          12470001
124800             EVALUATE TRUE                                        12480001
124900                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       12490001
125000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS12500001
125100                     MOVE SPACE TO ASC-SELECTED-SW                12510001
125200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12520001
125300                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        12530001
125400                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    12540001
125500                     MOVE SPACE TO ASC-SELECTED-SW                12550001
125600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12560001
125700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          12570001
125800                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      12580001
125900                     MOVE SPACE TO ASC-SELECTED-SW                12590001
126000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12600001
126100             END-EVALUATE                                         12610001
126200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           12620001
126300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            12630001
126400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    12640001
126500             END-IF                                               12650001
126600             PERFORM 3310-EDIT-RANGE                              12660001
126700         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             12670001
126800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            12680001
126900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    12690001
127000             END-IF                                               12700001
127100             PERFORM 3310-EDIT-RANGE                              12710001
127200         WHEN OTHER                                               12720001
127300             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           12730001
127400             SET DP020-MSG-FATAL    TO TRUE                       12740001
127500             MOVE -1                TO ASTRTITL                   12750001
127600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12760001
127700*            MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        12770001
127800*            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        12780001
127900             SET PS-ERROR TO TRUE                                 12790001
128000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            12800001
128100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     12810001
128200                 MOVE SPACE         TO ASC-SELECTED-SW            12820001
128300                                        (ASC-BLK-SUB ASC-ITEM-SUB)12830001
128400             END-IF                                               12840001
128500     END-EVALUATE.                                                12850001
128600                                                                  12860001
128700     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 12870001
128800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               12880001
128900     IF  ASC-ITEM-SUB < 1                                         12890001
129000         SUBTRACT +1 FROM ASC-BLK-SUB                             12900001
129100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                12910001
129200     END-IF.                                                      12920001
129300                                                                  12930001
129400******************************************************************12940001
129500** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **12950001
129600** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **12960001
129700** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**12970001
129800** THE ENDING.                                                  **12980001
129900******************************************************************12990001
130000 3310-EDIT-RANGE.                                                 13000001
130100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                13010001
130200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   13020001
130300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)13030001
130400                                   TO ASC-SELECTED-SW             13040001
130500                                        (ASC-BLK-SUB ASC-ITEM-SUB)13050001
130600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 13060001
130700         ELSE                                                     13070001
130800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     13080001
130900                 CONTINUE                                         13090001
131000             ELSE                                                 13100001
131100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        13110001
131200                 MOVE PC-TSYMSG-00054                             13120001
131300                                   TO DP020-MSG-NUMBER            13130001
131400                 SET DP020-MSG-FATAL                              13140001
131500                                   TO TRUE                        13150001
131600                 MOVE -1           TO ASTRTITL                    13160001
131700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13170001
131800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         13180001
131900                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      13190001
132000                 SET PS-ERROR      TO TRUE                        13200001
132100             END-IF                                               13210001
132200         END-IF                                                   13220001
132300     ELSE                                                         13230001
132400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     13240001
132500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 13250001
132600                                   TO ASC-SELECTED-SW             13260001
132700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   13270001
132800             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   13280001
132900         ELSE                                                     13290001
133000             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       13300001
133100                 CONTINUE                                         13310001
133200             ELSE                                                 13320001
133300*                -- ONLY ONE END-OF-RANGE ALLOWED --              13330001
133400                 MOVE PC-TSYMSG-00055                             13340001
133500                                   TO DP020-MSG-NUMBER            13350001
133600                 SET DP020-MSG-FATAL                              13360001
133700                                   TO TRUE                        13370001
133800                 MOVE -1           TO ASTRTITL                    13380001
133900                 SET DP030-SET-CURSOR-APPL-1                      13390001
134000                                   TO TRUE                        13400001
134100                 SET PS-ERROR      TO TRUE                        13410001
134200             END-IF                                               13420001
134300         END-IF                                                   13430001
134400     END-IF.                                                      13440001
134500*                                                                 13450001
134600******************************************************************13460001
134700** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **13470001
134800** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **13480001
134900******************************************************************13490001
135000 3400-CHECK-RANGE-SEQUENCE.                                       13500001
135100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       13510001
135200       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      13520001
135300       AND  ASC-START-OF-SELECTED-RANGE >                         13530001
135400                                         ASC-END-OF-SELECTED-RANGE13540001
135500*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                13550001
135600         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 13560001
135700         SET DP020-MSG-FATAL TO TRUE                              13570001
135800         SET PS-ERROR TO TRUE                                     13580001
135900         PERFORM 3410-POSITION-AT-ERROR                           13590001
136000     END-IF.                                                      13600001
136100                                                                  13610001
136200******************************************************************13620001
136300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **13630001
136400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **13640001
136500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **13650001
136600******************************************************************13660001
136700 3410-POSITION-AT-ERROR.                                          13670001
136800     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       13680001
136900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 13690001
137000                    - PV-TOP-ITEM + 1.                            13700001
137100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      13710001
137200         CONTINUE                                                 13720001
137300     ELSE                                                         13730001
137400         MOVE -1                   TO MR-SELECTL (PV-SUB)         13740001
137500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         13750001
137600         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         13760001
137700     END-IF.                                                      13770001
137800                                                                  13780001
137900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   13790001
138000                    - PV-TOP-ITEM + 1.                            13800001
138100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      13810001
138200         CONTINUE                                                 13820001
138300     ELSE                                                         13830001
138400         MOVE -1                   TO MR-SELECTL (PV-SUB)         13840001
138500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         13850001
138600         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         13860001
138700     END-IF.                                                      13870001
138800                                                                  13880001
138900*----------------------------------------------------------------*13890001
139000*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *13900001
139100*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *13910001
139200*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *13920001
139300*----------------------------------------------------------------*13930001
139400 3500-MARK-RANGE-AS-SELECTED.                                     13940001
139500     MOVE +1                       TO  ASC-BLK-SUB.               13950001
139600     PERFORM 3510-MARK-SELECTED-INDS                              13960001
139700         VARYING ASC-ITEM-SUB                                     13970001
139800         FROM 1 BY 1                                              13980001
139900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13990001
140000                                                                  14000001
140100     ADD +1                        TO ASC-BLK-SUB.                14010001
140200     PERFORM 3510-MARK-SELECTED-INDS                              14020001
140300         VARYING ASC-ITEM-SUB                                     14030001
140400         FROM 1 BY 1                                              14040001
140500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14050001
140600                                                                  14060001
140700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14070001
140800                                   TO  PV-LIST-ITEM-NUMBER.       14080001
140900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14090001
141000         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         14100001
141100               PC-ITEMS-PER-PANEL).                               14110001
141200                                                                  14120001
141300     MOVE ASC-START-OF-SELECTED-RANGE                             14130001
141400                                   TO PV-START-OF-SELECTED-RANGE. 14140001
141500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            14150001
141600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  14160001
141700               PC-ITEMS-PER-PANEL).                               14170001
141800                                                                  14180001
141900     MOVE ASC-END-OF-SELECTED-RANGE                               14190001
142000                                   TO  PV-END-OF-SELECTED-RANGE.  14200001
142100     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             14210001
142200         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    14220001
142300               PC-ITEMS-PER-PANEL).                               14230001
142400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             14240001
142500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             14250001
142600                                                                  14260001
142700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    14270001
142800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        14280001
142900         MOVE +1                   TO ASC-BLK-SUB                 14290001
143000         PERFORM 5100-WRITE-TEMP-STORAGE                          14300001
143100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14310001
143200             PV-FIRST-BLOCK-IN-ARRAY - 1                          14320001
143300                                                                  14330001
143400         PERFORM                                                  14340001
143500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      14350001
143600                   PV-PREV-BLOCK-IN-ARRAY                         14360001
143700             MOVE PV-FIRST-BLOCK-IN-RANGE                         14370001
143800                                   TO PV-BLOCK-NUMBER             14380001
143900             PERFORM 4410-READ-TEMP-STORAGE                       14390001
144000             PERFORM 3510-MARK-SELECTED-INDS                      14400001
144100                 VARYING ASC-ITEM-SUB                             14410001
144200                 FROM 1 BY 1                                      14420001
144300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14430001
144400             PERFORM 5100-WRITE-TEMP-STORAGE                      14440001
144500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     14450001
144600         END-PERFORM                                              14460001
144700                                                                  14470001
144800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14480001
144900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14490001
145000         PERFORM                                                  14500001
145100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14510001
145200                   PV-LAST-BLOCK-IN-RANGE                         14520001
145300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14530001
145400                                   TO PV-BLOCK-NUMBER             14540001
145500             PERFORM 4410-READ-TEMP-STORAGE                       14550001
145600             PERFORM 3510-MARK-SELECTED-INDS                      14560001
145700                 VARYING ASC-ITEM-SUB                             14570001
145800                 FROM 1 BY 1                                      14580001
145900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14590001
146000             PERFORM 5100-WRITE-TEMP-STORAGE                      14600001
146100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14610001
146200         END-PERFORM                                              14620001
146300                                                                  14630001
146400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14640001
146500                                   TO PV-BLOCK-NUMBER             14650001
146600         PERFORM 4410-READ-TEMP-STORAGE                           14660001
146700     END-IF.                                                      14670001
146800                                                                  14680001
146900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 14690001
147000                                      ASC-END-OF-SELECTED-RANGE.  14700001
147100                                                                  14710001
147200*----------------------------------------------------------------*14720001
147300* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *14730001
147400*----------------------------------------------------------------*14740001
147500 3510-MARK-SELECTED-INDS.                                         14750001
147600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         14760001
147700                                ASC-ITEM-SUB) >                   14770001
147800         ASC-START-OF-SELECTED-RANGE)                             14780001
147900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         14790001
148000                                ASC-ITEM-SUB) =                   14800001
148100         ASC-START-OF-SELECTED-RANGE)                             14810001
148200                                                                  14820001
148300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     14830001
148400                                    ASC-ITEM-SUB) <               14840001
148500             ASC-END-OF-SELECTED-RANGE)                           14850001
148600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     14860001
148700                                    ASC-ITEM-SUB) =               14870001
148800             ASC-END-OF-SELECTED-RANGE)                           14880001
148900                                                                  14890001
149000             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14900001
149100                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   14910001
149200                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   14920001
149300                               TO TRUE                            14930001
149400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              14940001
149500                               TO TRUE                            14950001
149600                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    14960001
149700             END-IF                                               14970001
149800         END-IF                                                   14980001
149900     END-IF.                                                      14990001
150000                                                                  15000001
150100*----------------------------------------------------------------*15010001
150200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *15020001
150300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *15030001
150400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *15040001
150500*    DISPLAY THE PANEL TO USER.                                  *15050001
150600*----------------------------------------------------------------*15060001
150700 4000-BUILD-INITIAL-PANEL.                                        15070001
150800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            15080001
150900                                 ASC-BLOCK-ENTRIES (2).           15090001
151000     MOVE +1                   TO ASC-BLK-SUB.                    15100001
151100     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           15110001
151200                                                                  15120001
151300     MOVE +0                 TO ASC-ITEM-SUB                      15130001
151400                                ASC-NUMBER-OF-ITEMS-READ          15140001
151500                                ASC-NUMBER-OF-SELECTED-ITEMS      15150001
151600                                ASC-HIGHEST-BLOCK-WRITTEN         15160001
151700                                ASC-START-OF-SELECTED-RANGE       15170001
151800                                ASC-END-OF-SELECTED-RANGE         15180001
151900                                ASC-ITEM-AT-TOP-OF-PANEL.         15190001
152000                                                                  15200001
152100     PERFORM 4100-PREPARE-CURSOR.                                 15210001
152200     PERFORM 4120-OPEN-CURSOR.                                    15220001
152300     PERFORM 4300-READ-ITEMS-FROM-DB.                             15230001
152400     PERFORM 4140-CLOSE-CURSOR.                                   15240001
152500                                                                  15250001
152600     MOVE +1                   TO  PV-TOP-ITEM.                   15260001
152700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          15270001
152800         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    15280022
152900         SET DP020-MSG-FATAL   TO  TRUE                           15290022
153000         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               15300022
153100     ELSE                                                         15310001
153200         MOVE -1               TO MR-SELECTL (1)                  15320001
153300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15330001
153400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     15340001
153500     END-IF.                                                      15350001
153600                                                                  15360001
153700*----------------------------------------------------------------*15370001
153800* OPEN THE CURSOR.                                               *15380001
153900*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *15390001
154000*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *15400001
154100*   ASSOCIATE.                                                   *15410001
154200*----------------------------------------------------------------*15420001
154300 4120-OPEN-CURSOR.                                                15430001
154400     PERFORM                                                      15440001
154500         WITH TEST AFTER                                          15450001
154600         VARYING PV-RETRY-COUNTER                                 15460001
154700         FROM 1 BY 1                                              15470001
154800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15480001
154900                   OR (SQLCODE = ZERO))                           15490001
155000                                                                  15500001
155100         MOVE 'CURSOR:  DOOR-CAPABLE-CSR '                        15510001
155200                               TO DP013-MESSAGE-TEXT (2)          15520001
155300                                                                  15530018
155400         EXEC SQL                                                 15540018
155500              OPEN PO-RCVR-CSR                                    15550070
155600         END-EXEC                                                 15560018
155700                                                                  15570001
155800         EVALUATE TRUE                                            15580001
155900             WHEN SQLCODE = ZERO                                  15590001
156000             WHEN SQLCODE = -904                                  15600001
156100             WHEN SQLCODE = -913                                  15610001
156200                 CONTINUE                                         15620001
156300             WHEN SQLWARN0 NOT = SPACES                           15630001
156400             WHEN SQLCODE < ZERO                                  15640001
156500             WHEN SQLCODE > ZERO                                  15650001
156600                 MOVE '4120-OPEN-CURSOR' TO DP013-PARAGRAPH       15660001
156700                 MOVE 'UNABLE TO OPEN PO-RCVR-CSR CURSOR'         15670089
156800                                   TO DP013-MESSAGE-TEXT (1)      15680001
156900                 MOVE SQLCA        TO DP013-SQLCA                 15690001
157000                 MOVE 'SUT-CART-DIRV-TRKG'  TO                    15700089
157010                                      DP013-DB2-TABLE-NAME (1)    15701089
157100                 SET DP013-DB2-ABEND                              15710001
157200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15720001
157300                 PERFORM DP013-0000-PROCESS-ABEND                 15730001
157400         END-EVALUATE                                             15740001
157500     END-PERFORM.                                                 15750001
157600                                                                  15760001
157700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15770001
157800         MOVE '4120-OPEN-CURSOR'   TO DP013-PARAGRAPH             15780001
157900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   15790001
158000                                   TO DP013-MESSAGE-TEXT (1)      15800001
158100         MOVE SQLCA                TO DP013-SQLCA                 15810001
158110         MOVE 'SUT-CART-DIRV-TRKG'  TO                            15811089
158120                                      DP013-DB2-TABLE-NAME (1)    15812089
158300         SET DP013-DB2-ABEND                                      15830001
158400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   15840001
158500         PERFORM DP013-0000-PROCESS-ABEND                         15850001
158600     END-IF.                                                      15860001
158700                                                                  15870001
158800*----------------------------------------------------------------*15880001
158900* CLOSE THE CURSOR                                               *15890001
159000*----------------------------------------------------------------*15900001
159100 4140-CLOSE-CURSOR.                                               15910001
159210                                                                  15921018
159220     EXEC SQL                                                     15922018
159230         CLOSE PO-RCVR-CSR                                        15923070
159240     END-EXEC.                                                    15924018
159700                                                                  15970001
159800     EVALUATE TRUE                                                15980001
159900         WHEN SQLCODE = ZERO                                      15990001
160000             CONTINUE                                             16000001
160100         WHEN SQLWARN0 NOT = SPACES                               16010001
160200         WHEN SQLCODE < ZERO                                      16020001
160300         WHEN SQLCODE > ZERO                                      16030001
160400             MOVE '4140-CLOSE-CURSOR' TO DP013-PARAGRAPH          16040001
160500             MOVE 'UNABLE TO CLOSE PO-RCVR-CSR CURSOR'            16050089
160600                               TO DP013-MESSAGE-TEXT (1)          16060001
160700             MOVE SQLCA        TO DP013-SQLCA                     16070001
160710             MOVE 'SUT-CART-DIRV-TRKG'  TO                        16071089
160720                                      DP013-DB2-TABLE-NAME (1)    16072089
161000             SET DP013-DB2-ABEND                                  16100089
161100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16110001
161200             PERFORM DP013-0000-PROCESS-ABEND                     16120001
161300     END-EVALUATE.                                                16130001
161400                                                                  16140001
161500*----------------------------------------------------------------*16150001
161600*    SET UP THE HOST VARIABLES.                                  *16160001
161700*----------------------------------------------------------------*16170001
161800 4100-PREPARE-CURSOR.                                             16180001
161900                                                                  16190001
162000     MOVE ASC-OPER-UNT-ID      TO  DK-OPER-UNT-ID.                16200001
162010     MOVE ASC-PO-NBR           TO  DK-PO-NBR.                     16201018
162100                                                                  16210001
162300                                                                  16230001
162400*----------------------------------------------------------------*16240001
162500*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *16250001
162600*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *16260001
162700*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *16270001
162800*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *16280001
162900*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *16290001
163000*                                                                *16300001
163100*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *16310001
163200*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *16320001
163300*    UPON INITIALIZATION.                                        *16330001
163400*----------------------------------------------------------------*16340001
163500 4300-READ-ITEMS-FROM-DB.                                         16350001
163600     PERFORM                                                      16360001
163700         VARYING PV-READ-COUNT                                    16370001
163800         FROM 1 BY 1                                              16380001
163900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    16390001
164000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         16400001
164100                                                                  16410001
164200         PERFORM 4310-FETCH                                       16420001
164300                                                                  16430001
164400         IF  ASC-ITEMS-LEFT-ON-DB                                 16440001
164500             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                16450001
164600                 ADD +1            TO ASC-ITEM-SUB                16460001
164700             ELSE                                                 16470001
164800                 ADD +1            TO ASC-BLK-SUB                 16480001
164900                 MOVE +1           TO ASC-ITEM-SUB                16490001
165000                                                                  16500001
165100                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         16510001
165200                     MOVE +1       TO ASC-BLK-SUB                 16520001
165300                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           16530001
165400                     PERFORM 5100-WRITE-TEMP-STORAGE              16540001
165500                     MOVE ASC-BLOCK-ENTRIES                       16550001
165600                               (PC-MAX-BLOCKS-IN-ARRAY)           16560001
165700                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 16570001
165800                     ADD +1        TO ASC-BLK-SUB                 16580001
165900                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   16590001
166000                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      16600001
166100                                   TO TRUE                        16610001
166200                 END-IF                                           16620001
166300             END-IF                                               16630001
166400             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    16640001
166500             MOVE ASC-NUMBER-OF-ITEMS-READ                        16650001
166600                                   TO ASC-LIST-ITEM-NUMBER        16660001
166700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 16670001
166710             PERFORM 4390-FORMAT-LINE                             16671039
167200                                                                  16720001
167300         END-IF                                                   16730001
167400     END-PERFORM.                                                 16740001
167500                                                                  16750001
167600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          16760001
167700         MOVE +1               TO ASC-BLK-SUB                     16770001
167800         PERFORM 5100-WRITE-TEMP-STORAGE                          16780001
167900         ADD +1                TO ASC-BLK-SUB                     16790001
168000         PERFORM 5100-WRITE-TEMP-STORAGE                          16800001
168100                                                                  16810001
168200         MOVE 1                TO ASC-BLK-SUB                     16820001
168300                                  PV-BLOCK-NUMBER                 16830001
168400         PERFORM 4410-READ-TEMP-STORAGE                           16840001
168500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             16850001
168600             MOVE 2            TO ASC-BLK-SUB                     16860001
168700                                  PV-BLOCK-NUMBER                 16870001
168800             PERFORM 4410-READ-TEMP-STORAGE                       16880001
168900         END-IF                                                   16890001
169000     END-IF.                                                      16900001
169100                                                                  16910001
169200*----------------------------------------------------------------*16920001
169300*    FETCH THE CURSOR                                             16930001
169400*----------------------------------------------------------------*16940001
169500 4310-FETCH.                                                      16950001
169600                                                                  16960001
169800     EXEC SQL                                                     16980018
169900         FETCH PO-RCVR-CSR                                        16990070
170000          INTO :SUT00102-PO-NBR                                   17000018
170100              ,:SUT00102-RCVR-SEQ-NBR                             17010018
170300     END-EXEC.                                                    17030018
170400                                                                  17040001
170500     EVALUATE TRUE                                                17050001
170600         WHEN SQLCODE = ZERO                                      17060001
170800              PERFORM 4320-GET-OTHER-INFORMATION                  17080038
170900         WHEN SQLCODE = +100                                      17090001
171000              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 17100001
171100         WHEN SQLWARN0 NOT = SPACE                                17110001
171200         WHEN SQLCODE NOT = ZERO                                  17120001
171300              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         17130001
171400              MOVE 'COULD NOT FETCH PO-RCVR-CSR'                  17140089
171600                               TO DP013-MESSAGE-TEXT (1)          17160089
171610              MOVE 'SUT-CART-DIRV-TRKG'  TO                       17161089
171620                                      DP013-DB2-TABLE-NAME (1)    17162089
171700              MOVE SQLCA       TO DP013-SQLCA                     17170001
171800              SET DP013-DB2-ABEND TO TRUE                         17180001
171900              PERFORM DP013-0000-PROCESS-ABEND                    17190001
172000     END-EVALUATE.                                                17200001
172100                                                                  17210001
172101                                                                  17210130
172102*----------------------------------------------------------------*17210230
172103*                                                                 17210330
172104*----------------------------------------------------------------*17210430
172105 4320-GET-OTHER-INFORMATION.                                      17210538
172110                                                                  17211038
172113     PERFORM 4330-FIND-SCAC-TRAILER.                              17211338
172114                                                                  17211438
172115     IF PS-TVHTRIP-TRIP-FOUND                                     17211550
172116        MOVE VHTRIP-TRIP-ID  TO DK-TRIP-ID                        17211650
172117        PERFORM 4340-FIND-EXPECTED-CARTONS                        17211750
172118                                                                  17211838
172119        PERFORM 4350-FIND-MAX-STATUS                              17211950
172120     ELSE                                                         17212050
172121        MOVE 0  TO PV-COUNT-EXPECTED                              17212178
172123        SET PS-MAX-STATUS-NOT-FOUND   TO TRUE                     17212350
172124     END-IF.                                                      17212450
172125                                                                  17212554
172126     PERFORM 4360-FIND-PACKAGING-CODE.                            17212654
172127                                                                  17212754
172128     PERFORM 4370-FIND-MINIMUM-TMST.                              17212858
172129                                                                  17212971
172130     PERFORM 4375-COUNT-DIRECTIVES.                               17213081
172131                                                                  17213181
172132     PERFORM 4380-COUNT-RELEASED.                                 17213281
172133                                                                  17213381
172134*----------------------------------------------------------------*17213481
172135*                                                                 17213581
172136*----------------------------------------------------------------*17213681
172137 4330-FIND-SCAC-TRAILER.                                          17213781
172138                                                                  17213881
172139     MOVE SUT00102-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                17213981
172140                                                                  17214081
172141     EXEC SQL                                                     17214181
172142         SELECT                                                   17214281
172143                A.OWNER_SCAC_ID                                   17214381
172144               ,A.VEH_NBR                                         17214481
172145               ,A.TRIP_ID                                         17214581
172146          INTO                                                    17214681
172147                :VHTRIP-OWNER-SCAC-ID                             17214781
172148               ,:VHTRIP-VEH-NBR       :DN-VEH-NBR                 17214881
172149               ,:VHTRIP-TRIP-ID                                   17214981
172150         FROM  TVHTRIP   A                                        17215081
172151              ,TSHIPMT   B                                        17215181
172152              ,TSHPTPO   C                                        17215281
172153        WHERE  A.TRIP_ID     = B.TRIP_ID                          17215381
172154          AND  C.SHIPT_ID    = B.SHIPT_ID                         17215481
172155          AND  C.PO_NBR      = :DK-PO-NBR                         17215581
172156          AND  C.REC_SEQ_NBR = :DK-REC-SEQ-NBR                    17215681
172157     END-EXEC.                                                    17215781
172158                                                                  17215881
172159     EVALUATE TRUE                                                17215981
172160         WHEN SQLCODE = +0                                        17216081
172161         WHEN SQLCODE = -811                                      17216181
172162              SET PS-TVHTRIP-TRIP-FOUND      TO TRUE              17216281
172163         WHEN SQLCODE = +100                                      17216381
172164              SET PS-TVHTRIP-TRIP-NOT-FOUND  TO TRUE              17216481
172165              MOVE SPACES TO  VHTRIP-OWNER-SCAC-ID                17216581
172166              MOVE SPACES TO  VHTRIP-VEH-NBR                      17216681
172167              MOVE ZEROS  TO  VHTRIP-TRIP-ID                      17216781
172170         WHEN SQLWARN0 NOT = SPACES                               17217031
172180         WHEN SQLCODE < +0                                        17218031
172190         WHEN SQLCODE > +0                                        17219031
172192             MOVE '4330-FIND-SCAC-TRAILER      '                  17219244
172193                                       TO DP013-PARAGRAPH         17219331
172194             MOVE 'SCAC/TRAILER SELECT ISSUE      '               17219495
172195                                 TO DP013-MESSAGE-TEXT (1)        17219531
172196             MOVE SQLCA      TO DP013-SQLCA                       17219631
172200             MOVE 'TVHTRIP     '  TO                              17220081
172201                                DP013-DB2-TABLE-NAME (1)          17220131
172202             MOVE 'TSHIPMT     '  TO                              17220281
172203                                DP013-DB2-TABLE-NAME (2)          17220381
172204             MOVE 'TSHPTPO     '  TO                              17220481
172205                                DP013-DB2-TABLE-NAME (3)          17220581
172206             SET DP013-DB2-ABEND                                  17220681
172207                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17220781
172208             PERFORM DP013-0000-PROCESS-ABEND                     17220881
172209     END-EVALUATE.                                                17220981
172210                                                                  17221081
172211                                                                  17221181
172212*----------------------------------------------------------------*17221281
172213*                                                                 17221381
172214*----------------------------------------------------------------*17221481
172215 4340-FIND-EXPECTED-CARTONS.                                      17221581
172216                                                                  17221681
172217     MOVE SUT00102-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                17221781
172218                                                                  17221881
172220     EXEC SQL                                                     17222032
172221        SELECT  COUNT(*)                                          17222132
172222          INTO  :PV-COUNT-EXPECTED                                17222278
172223                                                                  17222332
172224          FROM   TSHIPMT    A                                     17222432
172225                ,TSHPTPO    B                                     17222532
172226                ,TPKSLIP    C                                     17222632
172227                ,TINPKSU    D                                     17222732
172228                ,TSHPUNT    E                                     17222832
172229          WHERE  A.TRIP_ID        = :DK-TRIP-ID                   17222932
172230            AND  B.PO_NBR         = :DK-PO-NBR                    17223032
172231            AND  B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               17223132
172232            AND  B.PO_NBR         =  C.PO_NBR                     17223232
172233            AND  B.REC_SEQ_NBR    =  C.REC_SEQ_NBR                17223332
172234            AND  B.PRIM_SHIPT_IND = :PC-Y                         17223432
172235            AND  C.VER_STAT_CDE   = :PC-A                         17223532
172236            AND  B.PO_NBR         =  D.PO_NBR                     17223632
172237            AND  D.SEQ_NBR        =  C.SEQ_NBR                    17223732
172238            AND  A.SHIPT_ID       =  B.SHIPT_ID                   17223832
172239            AND  D.SHIPT_UNT_ID   =  E.SHIPT_UNT_ID               17223932
172240            AND  E.ACTV_IND       = :PC-A                         17224032
172241           WITH  UR                                               17224132
172242     END-EXEC.                                                    17224232
172244                                                                  17224432
172245     EVALUATE TRUE                                                17224532
172246         WHEN SQLCODE = +0                                        17224632
172247              CONTINUE                                            17224732
172248         WHEN SQLCODE = +100                                      17224832
172249              CONTINUE                                            17224932
172250         WHEN SQLWARN0 NOT = SPACES                               17225032
172251         WHEN SQLCODE < +0                                        17225132
172252         WHEN SQLCODE > +0                                        17225232
172254             MOVE '4340-FIND-EXPECTED-CARTONS  '                  17225444
172255                                       TO DP013-PARAGRAPH         17225532
172256             MOVE 'EXPECTED COUNT SELECT ISSUE    '               17225695
172257                                 TO DP013-MESSAGE-TEXT (1)        17225732
172258             MOVE SQLCA      TO DP013-SQLCA                       17225832
172264             MOVE 'TSHIPMT     '  TO                              17226481
172265                                DP013-DB2-TABLE-NAME (1)          17226532
172266             MOVE 'TSHPTPO     '  TO                              17226681
172267                                DP013-DB2-TABLE-NAME (2)          17226781
172268             MOVE 'TPKSLIP     '  TO                              17226881
172269                                DP013-DB2-TABLE-NAME (3)          17226981
172270             MOVE 'TINPKSU     '  TO                              17227081
172271                                DP013-DB2-TABLE-NAME (4)          17227181
172272             MOVE 'TSHPUNT     '  TO                              17227281
172273                                DP013-DB2-TABLE-NAME (5)          17227381
172274             SET DP013-DB2-ABEND                                  17227481
172275                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17227581
172276             PERFORM DP013-0000-PROCESS-ABEND                     17227681
172277     END-EVALUATE.                                                17227781
172278                                                                  17227881
172279*----------------------------------------------------------------*17227981
172280*                                                                 17228081
172281*----------------------------------------------------------------*17228181
172282 4350-FIND-MAX-STATUS.                                            17228281
172283                                                                  17228381
172284     EXEC SQL                                                     17228481
172290          SELECT MAX(STATUS_DTE)                                  17229040
172291                ,MAX(STATUS_TME)                                  17229139
172292                ,TRIP_STATUS_CDE                                  17229239
172293          INTO  :DK-STATUS-DTE                                    17229339
172294               ,:DK-STATUS-TME                                    17229439
172295               ,:TRIPST-TRIP-STATUS-CDE                           17229539
172296          FROM   TVHTRIP A                                        17229639
172297                ,TTRIPST B                                        17229739
172298          WHERE A.TRIP_ID = :DK-TRIP-ID                           17229839
172299            AND A.TRIP_ID =  B.TRIP_ID                            17229943
172300            AND B.STATUS_DTE =                                    17230039
172301                 (SELECT MAX(D.STATUS_DTE)                        17230139
172302                    FROM TTRIPST D                                17230239
172303                  WHERE D.TRIP_ID = A.TRIP_ID)                    17230339
172304        GROUP BY TRIP_STATUS_CDE                                  17230443
172305     END-EXEC.                                                    17230539
172306                                                                  17230639
172307     EVALUATE TRUE                                                17230739
172308         WHEN SQLCODE = +0                                        17230839
172309         WHEN SQLCODE = -811                                      17230953
172310              SET PS-MAX-STATUS-FOUND      TO TRUE                17231053
172311         WHEN SQLCODE = +100                                      17231153
172312              SET PS-MAX-STATUS-NOT-FOUND  TO TRUE                17231253
172313         WHEN SQLWARN0 NOT = SPACES                               17231353
172314         WHEN SQLCODE < +0                                        17231453
172315         WHEN SQLCODE > +0                                        17231553
172316             MOVE '4350-FIND-MAX-STATUS        '                  17231653
172317                                       TO DP013-PARAGRAPH         17231732
172318             MOVE 'TRIP STATUS SELECT ISSUE       '               17231895
172319                                 TO DP013-MESSAGE-TEXT (1)        17231932
172320             MOVE SQLCA      TO DP013-SQLCA                       17232032
172323             MOVE 'TVHTRIP     '  TO                              17232381
172324                                DP013-DB2-TABLE-NAME (1)          17232432
172325             MOVE 'TTRIPST     '  TO                              17232581
172326                                DP013-DB2-TABLE-NAME (2)          17232681
172327             SET DP013-DB2-ABEND                                  17232781
172328                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17232881
172329             PERFORM DP013-0000-PROCESS-ABEND                     17232981
172330     END-EVALUATE.                                                17233081
172331                                                                  17233181
172332*----------------------------------------------------------------*17233281
172333*                                                                 17233381
172334*----------------------------------------------------------------*17233481
172335 4360-FIND-PACKAGING-CODE.                                        17233581
172336                                                                  17233681
172337     MOVE SUT00102-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                17233781
172338                                                                  17233881
172339     EXEC SQL                                                     17233981
172340         SELECT  PACK_BY_ST_IND                                   17234081
172341                ,PKGNG_CDE                                        17234181
172342           INTO  :RECEIV-PACK-BY-ST-IND                           17234281
172343                ,:RECEIV-PKGNG-CDE                                17234381
172344           FROM  TRECEIV                                          17234481
172345          WHERE  ORD_NBR       =  :DK-PO-NBR                      17234581
172346            AND  REC_SEQ_NBR   =  :DK-REC-SEQ-NBR                 17234681
172347     END-EXEC.                                                    17234781
172350                                                                  17235054
172351     EVALUATE TRUE                                                17235154
172352         WHEN SQLCODE = +0                                        17235254
172353         WHEN SQLCODE = -811                                      17235354
172354              CONTINUE                                            17235455
172355         WHEN SQLCODE = +100                                      17235554
172357              MOVE SPACES TO  RECEIV-PKGNG-CDE                    17235755
172359         WHEN SQLWARN0 NOT = SPACES                               17235954
172360         WHEN SQLCODE < +0                                        17236054
172361         WHEN SQLCODE > +0                                        17236154
172362             MOVE '4360-FIND-PACKAGING-CODE    '                  17236256
172363                                       TO DP013-PARAGRAPH         17236354
172364             MOVE 'PACKAGING CODE SELECT ISSUE    '               17236495
172365                                 TO DP013-MESSAGE-TEXT (1)        17236554
172366             MOVE SQLCA      TO DP013-SQLCA                       17236654
172367             MOVE 'TRECEIV     '  TO                              17236781
172368                                DP013-DB2-TABLE-NAME (1)          17236854
172369             SET DP013-DB2-ABEND                                  17236954
172370                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17237054
172371             PERFORM DP013-0000-PROCESS-ABEND                     17237154
172372     END-EVALUATE.                                                17237254
172373                                                                  17237357
172374*----------------------------------------------------------------*17237457
172375*                                                                 17237557
172376*----------------------------------------------------------------*17237657
172377 4370-FIND-MINIMUM-TMST.                                          17237757
172378                                                                  17237857
172379     MOVE SUT00102-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                17237957
172380                                                                  17238057
172381     EXEC SQL                                                     17238157
172382        SELECT                                                    17238257
172383                S102.PO_NBR                                       17238357
172384               ,S102.RCVR_SEQ_NBR                                 17238457
172385               ,MIN(CRE_TMST)                                     17238557
172386          INTO                                                    17238657
172387                :SUT00102-PO-NBR                                  17238757
172388               ,:SUT00102-RCVR-SEQ-NBR                            17238857
172389               ,:PV-MINIMUM-TMST                                  17238957
172390          FROM  SUT_CART_DIRV_TRKG    S102                        17239059
172391         WHERE  S102.PO_NBR        = :DK-PO-NBR                   17239157
172392           AND  S102.RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR              17239260
172393      GROUP BY  S102.PO_NBR                                       17239357
172394               ,S102.RCVR_SEQ_NBR                                 17239457
172395                                                                  17239557
172396     END-EXEC.                                                    17239657
172397                                                                  17239757
172398     EVALUATE TRUE                                                17239857
172399         WHEN SQLCODE = +0                                        17239957
172401              CONTINUE                                            17240157
172402         WHEN SQLCODE = +100                                      17240257
172404              MOVE SPACES TO  PV-MINIMUM-TMST                     17240457
172405         WHEN SQLWARN0 NOT = SPACES                               17240557
172406         WHEN SQLCODE < +0                                        17240657
172407         WHEN SQLCODE > +0                                        17240757
172408             MOVE '4370-FIND-MINIMUM-TMST      '                  17240857
172409                                       TO DP013-PARAGRAPH         17240957
172410             MOVE 'MINIMUM TMST SELECT ISSUE      '               17241095
172411                                 TO DP013-MESSAGE-TEXT (1)        17241157
172412             MOVE SQLCA      TO DP013-SQLCA                       17241257
172413             MOVE 'SUT_CART_DIRV_TRKG'  TO                        17241381
172414                                DP013-DB2-TABLE-NAME (1)          17241457
172415             SET DP013-DB2-ABEND                                  17241557
172416                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17241657
172417             PERFORM DP013-0000-PROCESS-ABEND                     17241757
172418     END-EVALUATE.                                                17241857
172419/                                                                 17241997
172420*----------------------------------------------------------------*17242071
172421*                                                                 17242171
172422*----------------------------------------------------------------*17242271
172423 4375-COUNT-DIRECTIVES.                                           17242381
172426                                                                  17242671
172432     EXEC SQL                                                     17243297
172433         SELECT  COUNT(*)                                         17243397
172434                                                                  17243497
172435           INTO  :PV-COUNT-DIRECTIVES                             17243597
172436                                                                  17243697
172437           FROM  SUT_CART_DIRV_TRKG   A                           17243797
172438          WHERE  A.OPER_UNT_ID       = :DK-OPER-UNT-ID            17243897
172439            AND  A.PO_NBR            = :DK-PO-NBR                 17243997
172440            AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR            17244097
172441            AND  A.DIRV_RSN_CDE   <>    'AUQ'                     17244198
172442            AND  A.CRE_TMST          =                            17244297
172443                        (SELECT MAX(B.CRE_TMST)                   17244397
172444                           FROM SUT_CART_DIRV_TRKG  B             17244497
172445                          WHERE B.BRCDE_NBR = A.BRCDE_NBR)        17244597
172446                  AND  A.LGCL_LOC_NM       IN                     17244697
172447                   (                                              17244797
172448                      SELECT DISTINCT(E.ATTR_ELEM_TXT)            17244897
172449                      FROM WST_INTGRTN_TYP A                      17244997
172450                         , WST_ATTR_DEFN           B              17245097
172451                         , WST_ATTR_ELEM           C              17245197
172452                         , WST_ATTR_ELEM           D              17245297
172453                         , WST_ATTR_ELEM           E              17245397
172454                         , WST_ATTR_ELEM           F              17245497
172455                         , WST_ATTR_ELEM           G              17245597
172456                         , WST_ATTR_ELEM           H              17245697
172457                         , WST_ATTR_ELEM           I              17245797
172458                         , WST_ATTR_ELEM           J              17245897
172459                         , WST_ATTR_ELEM           K              17245997
172460                 WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'        17246097
172461                   AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE  17246197
172462                   AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE  17246297
172463                   AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE  17246397
172464                   AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE  17246497
172465                   AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE  17246597
172466                   AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE  17246697
172467                   AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE  17246797
172468                   AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE  17246897
172469                   AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE  17246997
172470                   AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE  17247097
172471                   AND B.ATTR_DEFN_SEQ_NBR  =  1                  17247197
172472                   AND C.ATTR_DEFN_SEQ_NBR  =  1                  17247297
172473                   AND D.ATTR_DEFN_SEQ_NBR  =  2                  17247397
172474                   AND E.ATTR_DEFN_SEQ_NBR  =  3                  17247497
172475                   AND F.ATTR_DEFN_SEQ_NBR  =  4                  17247597
172476                   AND G.ATTR_DEFN_SEQ_NBR  =  5                  17247697
172477                   AND H.ATTR_DEFN_SEQ_NBR  =  6                  17247797
172478                   AND I.ATTR_DEFN_SEQ_NBR  =  7                  17247897
172479                   AND J.ATTR_DEFN_SEQ_NBR  =  8                  17247997
172480                   AND K.ATTR_DEFN_SEQ_NBR  =  9                  17248097
172481                   AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR17248197
172482                   AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR17248297
172483                   AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR17248397
172484                   AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR17248497
172485                   AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR17248597
172486                   AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR17248697
172487                   AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR17248797
172488                   AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR17248897
172489                   AND F.ATTR_ELEM_TXT      =  'Y'                17248997
172490                   AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP  17249097
172491                   AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP  17249197
172492                   AND C.ATTR_ELEM_NBR      = :DK-OPER-UNT-ID     17249297
172493                   AND K.ATTR_ELEM_TXT      =  'Y'                17249397
172494                                                  )               17249497
172495     END-EXEC.                                                    17249597
172496                                                                  17249697
172512     EVALUATE TRUE                                                17251271
172513         WHEN SQLCODE = +0                                        17251371
172514              CONTINUE                                            17251471
172515         WHEN SQLCODE = +100                                      17251571
172516              MOVE ZEROES TO  PV-COUNT-DIRECTIVES                 17251681
172517         WHEN SQLWARN0 NOT = SPACES                               17251771
172518         WHEN SQLCODE < +0                                        17251871
172519         WHEN SQLCODE > +0                                        17251971
172520             MOVE '4375-COUNT-DIRECTIVES       '                  17252081
172521                                       TO DP013-PARAGRAPH         17252171
172522             MOVE 'CAN"T COUNT DIRECTIVES         '               17252281
172523                                 TO DP013-MESSAGE-TEXT (1)        17252371
172524             MOVE SQLCA      TO DP013-SQLCA                       17252471
172525             MOVE 'SUT_CART_DIRV_TRKG'  TO                        17252581
172526                                DP013-DB2-TABLE-NAME (1)          17252671
172527             SET DP013-DB2-ABEND                                  17252771
172528                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17252871
172529             PERFORM DP013-0000-PROCESS-ABEND                     17252971
172530     END-EVALUATE.                                                17253071
172531/                                                                 17253197
172532*----------------------------------------------------------------*17253281
172533*                                                                 17253381
172534*----------------------------------------------------------------*17253481
172535 4380-COUNT-RELEASED.                                             17253581
172536                                                                  17253681
172537     EXEC SQL                                                     17253781
172538        SELECT  COUNT(*)                                          17253881
172539          INTO  :PV-COUNT-RELEASED                                17253981
172540                                                                  17254081
172541          FROM  SUT_CART_DIRV_TRKG    S102                        17254181
172542         WHERE  S102.PO_NBR        = :DK-PO-NBR                   17254281
172543           AND  S102.DIRV_RSN_CDE IN ('RLC','RLR','RLO')          17254381
172544                                                                  17254481
172545     END-EXEC.                                                    17254581
172546                                                                  17254681
172547     EVALUATE TRUE                                                17254781
172548         WHEN SQLCODE = +0                                        17254881
172549              CONTINUE                                            17254981
172550         WHEN SQLCODE = +100                                      17255081
172551              MOVE ZEROES TO  PV-COUNT-RELEASED                   17255181
172552         WHEN SQLWARN0 NOT = SPACES                               17255281
172553         WHEN SQLCODE < +0                                        17255381
172554         WHEN SQLCODE > +0                                        17255481
172555             MOVE '4380-COUNT-RELEASED         '                  17255581
172556                                       TO DP013-PARAGRAPH         17255681
172557             MOVE 'RELEASED COUNT SELECT ISSUE    '               17255795
172558                                 TO DP013-MESSAGE-TEXT (1)        17255881
172559             MOVE SQLCA      TO DP013-SQLCA                       17255981
172560             MOVE 'SUT_CART_DIRV_TRKG'   TO                       17256081
172561                                DP013-DB2-TABLE-NAME (1)          17256181
172562             SET DP013-DB2-ABEND                                  17256281
172563                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17256381
172564             PERFORM DP013-0000-PROCESS-ABEND                     17256481
172565     END-EVALUATE.                                                17256581
172566                                                                  17256681
172567                                                                  17256781
172568*----------------------------------------------------------------*17256881
172569*                                                                 17256981
172570*----------------------------------------------------------------*17257081
172571 4390-FORMAT-LINE.                                                17257181
172572                                                                  17257281
172573     MOVE SUT00102-RCVR-SEQ-NBR     TO  ASC-RECEIVER              17257381
172574                               (ASC-BLK-SUB ASC-ITEM-SUB).        17257481
172575     MOVE RECEIV-PKGNG-CDE          TO  ASC-PKG                   17257581
172576                               (ASC-BLK-SUB ASC-ITEM-SUB).        17257681
172577     MOVE VHTRIP-TRIP-ID            TO  ASC-TRIP-ID               17257781
172578                               (ASC-BLK-SUB ASC-ITEM-SUB).        17257881
172579     IF PS-TVHTRIP-TRIP-FOUND                                     17257981
172580        MOVE VHTRIP-OWNER-SCAC-ID      TO  ASC-SCAC               17258081
172581                               (ASC-BLK-SUB ASC-ITEM-SUB)         17258181
172582        IF DN-VEH-NBR = 0                                         17258281
172583           MOVE VHTRIP-VEH-NBR            TO  ASC-TRAILER         17258381
172584                               (ASC-BLK-SUB ASC-ITEM-SUB)         17258481
172585        ELSE                                                      17258581
172586           MOVE SPACES                    TO  ASC-TRAILER         17258681
172587                               (ASC-BLK-SUB ASC-ITEM-SUB)         17258781
172588        END-IF                                                    17258881
172589     ELSE                                                         17258981
172590        MOVE SPACES                    TO  ASC-SCAC               17259081
172591                               (ASC-BLK-SUB ASC-ITEM-SUB)         17259181
172592        MOVE SPACES                    TO  ASC-TRAILER            17259281
172593                               (ASC-BLK-SUB ASC-ITEM-SUB)         17259381
172594     END-IF.                                                      17259481
172595                                                                  17259581
172596     IF PS-MAX-STATUS-FOUND                                       17259681
172597        MOVE TRIPST-TRIP-STATUS-CDE  TO ASC-TRAILER-STAT          17259781
172598                               (ASC-BLK-SUB ASC-ITEM-SUB)         17259881
172599     ELSE                                                         17259981
172600        MOVE SPACES                  TO ASC-TRAILER-STAT          17260081
172601                               (ASC-BLK-SUB ASC-ITEM-SUB)         17260181
172602     END-IF.                                                      17260281
172603                                                                  17260381
172604     MOVE PV-COUNT-EXPECTED     TO ASC-EXP-CARTONS                17260481
172605                               (ASC-BLK-SUB ASC-ITEM-SUB).        17260581
172606                                                                  17260681
172607     MOVE PV-COUNT-DIRECTIVES   TO ASC-DIRTV-CARTONS              17260782
172608                               (ASC-BLK-SUB ASC-ITEM-SUB).        17260881
172609                                                                  17260981
172610     MOVE PV-COUNT-RELEASED     TO ASC-RLSD-CARTONS               17261081
172611                               (ASC-BLK-SUB ASC-ITEM-SUB).        17261181
172612                                                                  17261281
172613     IF PV-MINIMUM-TMST = SPACE                                   17261381
172614        MOVE SPACES             TO ASC-DIRTV-TMST                 17261481
172615                               (ASC-BLK-SUB ASC-ITEM-SUB)         17261581
172616     ELSE                                                         17261681
172617        MOVE PV-MINIMUM-TMST        TO ASC-DIRTV-TMST             17261781
172618                               (ASC-BLK-SUB ASC-ITEM-SUB)         17261881
172619     END-IF.                                                      17261981
172620                                                                  17262081
172621*----------------------------------------------------------------*17262181
172630* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *17263001
172700*----------------------------------------------------------------*17270001
172800 4400-MOVE-COMMAREA-TO-SCREEN.                                    17280001
172900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             17290001
173000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          17300001
173100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          17310001
173200             MOVE +1    TO ASC-BLK-SUB                            17320001
173300             PERFORM 5100-WRITE-TEMP-STORAGE                      17330001
173400             ADD +1     TO ASC-BLK-SUB                            17340001
173500             PERFORM 5100-WRITE-TEMP-STORAGE                      17350001
173600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             17360001
173700                 GIVING PV-BLOCK-NUMBER                           17370001
173800                 REMAINDER PV-REMAINDER                           17380001
173900             IF  PV-REMAINDER > ZERO                              17390001
174000                 ADD +1 TO PV-BLOCK-NUMBER                        17400001
174100             END-IF                                               17410001
174200             MOVE +1    TO ASC-BLK-SUB                            17420001
174300             PERFORM 4410-READ-TEMP-STORAGE                       17430001
174400             ADD +1     TO ASC-BLK-SUB                            17440001
174500                           PV-BLOCK-NUMBER                        17450001
174600             PERFORM 4410-READ-TEMP-STORAGE                       17460001
174700     END-IF.                                                      17470001
174800     MOVE +1            TO ASC-BLK-SUB.                           17480001
174900     COMPUTE ASC-ITEM-SUB =                                       17490001
175000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              17500001
175100         + PC-ITEMS-PER-PANEL).                                   17510001
175200*                                                                 17520001
175300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17530001
175400         ADD +1         TO ASC-BLK-SUB                            17540001
175500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17550001
175600     END-IF.                                                      17560001
175700*                                                                 17570001
175800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           17580001
175900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                17590001
176000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        17600001
176100     PERFORM 4420-FORMAT-LIST-LINES                               17610001
176200         VARYING PV-SUB                                           17620001
176300         FROM PC-ITEMS-PER-PANEL BY -1                            17630001
176400         UNTIL PV-SUB < +1.                                       17640001
176500*                                                                 17650001
176600     COMPUTE ASC-ITEMS-DISPLAYED =                                17660001
176700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          17670001
176800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    17680001
176900                                      ASTRTITO.                   17690001
177000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    17700001
177100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    17710001
177200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            17720001
177300                                   TO ASELITO.                    17730001
177400     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   17740001
177410     MOVE ASC-PO-NBR               TO APONBRO.                    17741023
177600                                                                  17760001
177700     IF  DP020-MSG-NUMBER-X = SPACE                               17770001
177800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  17780001
177900*            --- MORE ITEMS TO DISPLAY ----                       17790001
178000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            17800001
178100             SET DP020-MSG-INFORMATIONAL TO TRUE                  17810001
178200         END-IF                                                   17820001
178300     END-IF.                                                      17830001
178400                                                                  17840001
178500*----------------------------------------------------------------*17850001
178600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *17860001
178700*----------------------------------------------------------------*17870001
178800 4410-READ-TEMP-STORAGE.                                          17880001
178900     EXEC CICS                                                    17890001
179000         READQ TS                                                 17900001
179100             QUEUE (ASC-LIST-QUEUE-NAME)                          17910001
179200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               17920001
179300             ITEM  (PV-BLOCK-NUMBER)                              17930001
179400             RESP  (PV-CICS-RESP)                                 17940001
179500     END-EXEC.                                                    17950001
179600                                                                  17960001
179700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       17970001
179800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     17980001
179900         CONTINUE                                                 17990001
180000     ELSE                                                         18000001
180100         SET DP013-CICS-ABEND     TO TRUE                         18010001
180200         SET DP013-NO-ROLLBACK    TO TRUE                         18020001
180300         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         18030001
180400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      18040001
180500                                  TO DP013-MESSAGE-TEXT(1)        18050001
180600         PERFORM DP013-0000-PROCESS-ABEND                         18060001
180700     END-IF.                                                      18070001
180800                                                                  18080001
180900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             18090001
181000*                                                                 18100001
181100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         18110001
181200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               18120001
181300     END-IF.                                                      18130001
181400                                                                  18140001
181500*----------------------------------------------------------------*18150001
181600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *18160001
181700*----------------------------------------------------------------*18170001
181800 4420-FORMAT-LIST-LINES.                                          18180001
181900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      18190001
182000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                18200001
182100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           18210001
182200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           18220001
182300         MOVE SPACES             TO MR-SELECTI      (PV-SUB)      18230001
182400                                    MR-ACTION       (PV-SUB)      18240005
182420                                    MR-PKG          (PV-SUB)      18242005
182430                                    MR-SCAC         (PV-SUB)      18243005
182440                                    MR-TRAILER      (PV-SUB)      18244005
182450                                    MR-TRAILER-STAT (PV-SUB)      18245005
182500                                    MR-DIRTV-DATE (PV-SUB)        18250062
182600                                    MR-DIRTV-TIME (PV-SUB)        18260062
182700         MOVE 0                  TO MR-EXP-CRTN-CT  (PV-SUB)      18270004
182900                                    MR-DIRTV-CRTN-CT (PV-SUB)     18290028
182910                                    MR-RLSD-CRTN-CT (PV-SUB)      18291004
182920                                    MR-TRIP-ID      (PV-SUB)      18292005
182930                                    MR-RECEIVER     (PV-SUB)      18293026
183000     ELSE                                                         18300001
183100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      18310001
183200                                                   > SPACE        18320001
183300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18330001
183400                                          TO MR-SELECTI (PV-SUB)  18340001
183500         ELSE                                                     18350001
183600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      18360001
183700                                           TO MR-SELECTI (PV-SUB) 18370001
183800         END-IF                                                   18380001
183900                                                                  18390001
184000         IF  DP030-SET-CURSOR-TRAILER                             18400001
184100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)18410001
184200                 > SPACE)                                         18420001
184300               OR (PV-SUB = 1))                                   18430001
184400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               18440001
184500                MOVE -1          TO MR-SELECTL (PV-SUB)           18450001
184600             END-IF                                               18460001
184700         END-IF                                                   18470001
184800*>>>>>>>>                                                         18480001
184900         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               18490001
185000                                            TO MR-ACTION (PV-SUB) 18500001
185100         MOVE ASC-RECEIVER     (ASC-BLK-SUB ASC-ITEM-SUB)         18510025
185200                                          TO MR-RECEIVER (PV-SUB) 18520025
185300         MOVE ASC-PKG          (ASC-BLK-SUB ASC-ITEM-SUB)         18530025
185400                                          TO MR-PKG      (PV-SUB) 18540025
185410         MOVE ASC-SCAC         (ASC-BLK-SUB ASC-ITEM-SUB)         18541025
185420                                          TO MR-SCAC     (PV-SUB) 18542025
185430         MOVE ASC-TRAILER      (ASC-BLK-SUB ASC-ITEM-SUB)         18543025
185440                                          TO MR-TRAILER  (PV-SUB) 18544025
185450         MOVE ASC-TRAILER-STAT (ASC-BLK-SUB ASC-ITEM-SUB)         18545025
185460                                      TO MR-TRAILER-STAT (PV-SUB) 18546025
185470         MOVE ASC-TRIP-ID      (ASC-BLK-SUB ASC-ITEM-SUB)         18547026
185480                                          TO MR-TRIP-ID  (PV-SUB) 18548026
185490         MOVE ASC-EXP-CARTONS  (ASC-BLK-SUB ASC-ITEM-SUB)         18549025
185491                                TO MR-EXP-CRTN-CT (PV-SUB)        18549126
185492         MOVE ASC-DIRTV-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB)        18549225
185493                                TO MR-DIRTV-CRTN-CT (PV-SUB)      18549326
185495         MOVE ASC-RLSD-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB)         18549562
185496                                TO MR-RLSD-CRTN-CT (PV-SUB)       18549662
185497                                                                  18549762
185498         STRING ASC-DIRTV-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (6:6)   18549863
185499                ASC-DIRTV-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (3:2)   18549963
185500                DELIMITED BY SIZE                                 18550062
185501                INTO                MR-DIRTV-DATE (PV-SUB)        18550162
185503         MOVE ASC-DIRTV-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (12:8)    18550363
185504                                    TO MR-DIRTV-TIME (PV-SUB)     18550462
185510     END-IF.                                                      18551001
185600     SUBTRACT +1 FROM ASC-ITEM-SUB                                18560001
185700     IF  ASC-ITEM-SUB < + 1                                       18570001
185800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  18580001
185900         MOVE +1                 TO ASC-BLK-SUB                   18590001
186000     END-IF.                                                      18600001
186100                                                                  18610001
186200******************************************************************18620001
186300** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **18630001
186400** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **18640001
186500** ISSUE A WARNING.                                             **18650001
186600******************************************************************18660001
186700 4430-CHECK-FOR-BEGIN-AND-END.                                    18670001
186800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       18680001
186900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     18690001
187000*            -- NO END-OF-RANGE SPECFIED ---                      18700001
187100             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            18710001
187200             SET DP020-MSG-WARNING TO TRUE                        18720001
187300             PERFORM 4431-POSITION-AT-WARNING                     18730001
187400         END-IF                                                   18740001
187500     ELSE                                                         18750001
187600         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     18760001
187700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                18770001
187800             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            18780001
187900             SET DP020-MSG-WARNING TO TRUE                        18790001
188000             PERFORM 4431-POSITION-AT-WARNING                     18800001
188100         END-IF                                                   18810001
188200     END-IF.                                                      18820001
188300                                                                  18830001
188400******************************************************************18840001
188500** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **18850001
188600** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **18860001
188700** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **18870001
188800** POSITION THE CURSOR THERE.                                   **18880001
188900******************************************************************18890001
189000 4431-POSITION-AT-WARNING.                                        18900001
189100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 18910001
189200                    - PV-TOP-ITEM + 1.                            18920001
189300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18930001
189400         CONTINUE                                                 18940001
189500     ELSE                                                         18950001
189600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      18960001
189700         MOVE -1                     TO MR-SELECTL (PV-SUB)       18970001
189800         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       18980001
189900         MOVE DP015-YELLOW           TO MR-SELECTC (PV-SUB)       18990001
190000     END-IF.                                                      19000001
190100                                                                  19010001
190200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   19020001
190300                    - PV-TOP-ITEM + 1.                            19030001
190400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19040001
190500         CONTINUE                                                 19050001
190600     ELSE                                                         19060001
190700         SET DP030-SET-CURSOR-APPL-1                              19070001
190800                                   TO TRUE                        19080001
190900         MOVE -1                   TO MR-SELECTL (PV-SUB)         19090001
191000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19100001
191100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         19110001
191200     END-IF.                                                      19120001
191300                                                                  19130001
191400*----------------------------------------------------------------*19140001
191500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *19150001
191600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *19160001
191700* FOR THE SELECTED ITEMS QUEUE.                                  *19170001
191800*                                                                *19180001
191900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *19190001
192000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *19200001
192100* THE ARRAY IS FULL.                                             *19210001
192200*----------------------------------------------------------------*19220001
192300 5000-PREPARE-SEL-QUEUE.                                          19230001
192400     MOVE +1                   TO  ASC-BLK-SUB.                   19240001
192500     PERFORM 5100-WRITE-TEMP-STORAGE.                             19250001
192600     ADD +1                    TO  ASC-BLK-SUB.                   19260001
192700     PERFORM 5100-WRITE-TEMP-STORAGE.                             19270001
192800                                                                  19280001
192900     MOVE ASC-SEL-QUEUE-NAME   TO  SU098-SEL-QUEUE-NAME.          19290003
193000     PERFORM 6010-DELETE-SEL-QUEUE.                               19300001
193100                                                                  19310001
193200     SET ASC-UPDATE-TSQ        TO  TRUE.                          19320001
193300                                                                  19330001
193400     SET SU099-IDX             TO  1.                             19340003
193500     MOVE ZERO                 TO SU098-NUMBER-OF-TS-ITEMS.       19350003
193600     INITIALIZE SU099-SELECTED-ITEM-ARRAY.                        19360003
193700                                                                  19370001
193800     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           19380001
193900             VARYING PV-ITEM                                      19390001
194000             FROM 1 BY 1                                          19400001
194100             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     19410001
194200                                                                  19420001
194300     IF  SU099-IDX > 1                                            19430003
194400         PERFORM 5205-WRITE-SEL-QUEUE                             19440001
194500         ADD +1                TO SU098-NUMBER-OF-TS-ITEMS        19450003
194600     END-IF.                                                      19460001
194700                                                                  19470001
194800*----------------------------------------------------------------*19480001
194900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *19490001
195000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *19500001
195100*----------------------------------------------------------------*19510001
195200 5100-WRITE-TEMP-STORAGE.                                         19520001
195300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     19530001
195400                                   TO PV-LIST-ITEM-NUMBER.        19540001
195500     COMPUTE PV-BLOCK-NUMBER =                                    19550001
195600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19560001
195700                                                                  19570001
195800     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             19580001
195900     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             19590001
196000         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      19600001
196100             PERFORM 5105-REWRITE-ASC-LISTQ                       19610001
196200         END-IF                                                   19620001
196300     ELSE                                                         19630001
196400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       19640001
196500         ASC-HIGHEST-BLOCK-WRITTEN + 1                            19650001
196600         PERFORM 5110-WRITE-ASC-LISTQ                             19660001
196700         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   19670001
196800     END-IF.                                                      19680001
196900                                                                  19690001
197000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             19700001
197100                                                                  19710001
197200******************************************************************19720001
197300** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **19730001
197400** SPECIFIC COMMAREA.                                           **19740001
197500******************************************************************19750001
197600 5105-REWRITE-ASC-LISTQ.                                          19760001
197700     EXEC CICS                                                    19770001
197800         WRITEQ TS                                                19780001
197900             QUEUE (ASC-LIST-QUEUE-NAME)                          19790001
198000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               19800001
198100             ITEM  (PV-BLOCK-NUMBER)                              19810001
198200             REWRITE                                              19820001
198300             RESP  (PV-CICS-RESP)                                 19830001
198400     END-EXEC.                                                    19840001
198500                                                                  19850001
198600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           19860001
198700         CONTINUE                                                 19870001
198800     ELSE                                                         19880001
198900         SET DP013-CICS-ABEND            TO TRUE                  19890001
199000         SET DP013-NO-ROLLBACK           TO TRUE                  19900001
199100         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       19910001
199200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     19920001
199300                                         TO DP013-MESSAGE-TEXT(1) 19930001
199400         PERFORM DP013-0000-PROCESS-ABEND                         19940001
199500     END-IF.                                                      19950001
199600                                                                  19960001
199700******************************************************************19970001
199800** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **19980001
199900** SPECIFIC COMMAREA.                                           **19990001
200000******************************************************************20000001
200100 5110-WRITE-ASC-LISTQ.                                            20010001
200200     EXEC CICS                                                    20020001
200300         WRITEQ TS                                                20030001
200400             QUEUE (ASC-LIST-QUEUE-NAME)                          20040001
200500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               20050001
200600             ITEM  (PV-BLOCK-NUMBER)                              20060001
200700             RESP  (PV-CICS-RESP)                                 20070001
200800     END-EXEC.                                                    20080001
200900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      20090001
201000         SET DP013-CICS-ABEND      TO TRUE                        20100001
201100         SET DP013-NO-ROLLBACK     TO TRUE                        20110001
201200         MOVE '5110-WRITE-ASC-LISTQ'                              20120001
201300                                   TO DP013-PARAGRAPH             20130001
201400         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           20140001
201500                                   TO DP013-MESSAGE-TEXT(1)       20150001
201600         PERFORM DP013-0000-PROCESS-ABEND                         20160001
201700     END-IF.                                                      20170001
201800                                                                  20180001
201900*----------------------------------------------------------------*20190001
202000* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *20200001
202100* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *20210001
202200*----------------------------------------------------------------*20220001
202300 5200-FILL-SEL-QUEUE-RECORD.                                      20230001
202400     PERFORM 6112-READ-LIST-QUEUE.                                20240001
202500                                                                  20250001
202600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       20260001
202700         PERFORM VARYING LQW-IDX                                  20270001
202800         FROM 1 BY 1                                              20280001
202900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            20290001
203000           OR  LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZERO               20300001
203100                                                                  20310001
203200           IF LQW-SELECT (LQW-IDX)                                20320001
203300                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX) TO            20330001
203400                                            SU099-ITEM (SU099-IDX)20340003
203510                 MOVE LQW-ACTION (LQW-IDX)                        20351005
203600                                   TO SU099-ACTION-SW (SU099-IDX) 20360003
204010                 MOVE LQW-RCVR       (LQW-IDX)                    20401013
204011                            TO SU099-RCVR             (SU099-IDX) 20401107
204020                 MOVE LQW-PKG        (LQW-IDX)                    20402005
204021                            TO SU099-PKG              (SU099-IDX) 20402106
204100                                                                  20410001
204200                 SET SU099-IDX UP BY 1                            20420003
204300                 IF  SU099-IDX > SU099-MAX-ITEMS                  20430003
204400                     PERFORM 5205-WRITE-SEL-QUEUE                 20440001
204500                     ADD +1        TO SU098-NUMBER-OF-TS-ITEMS    20450003
204600                     INITIALIZE SU099-SELECTED-ITEM-ARRAY         20460003
204700                     SET SU099-IDX TO  1                          20470003
204800                 END-IF                                           20480001
204900           END-IF                                                 20490001
205000         END-PERFORM                                              20500001
205100     END-IF.                                                      20510001
205200                                                                  20520001
205300*----------------------------------------------------------------*20530001
205400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *20540001
205500*----------------------------------------------------------------*20550001
205600 5205-WRITE-SEL-QUEUE.                                            20560001
205700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU099-SELECTED-ITEMS.   20570003
205800                                                                  20580001
205900     EXEC CICS                                                    20590001
206000          WRITEQ TS                                               20600001
206100              QUEUE (ASC-SEL-QUEUE-NAME)                          20610001
206200              FROM  (SU099-SELECT-RECORD)                         20620003
206300              ITEM  (PV-SEL-QUEUE-ITEM)                           20630001
206400              RESP  (PV-CICS-RESP)                                20640001
206500     END-EXEC.                                                    20650001
206600                                                                  20660001
206700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          20670001
206800         CONTINUE                                                 20680001
206900     ELSE                                                         20690001
207000         SET DP013-CICS-ABEND      TO TRUE                        20700001
207100         SET DP013-NO-ROLLBACK     TO TRUE                        20710001
207200         MOVE '5205-WRITE-SEL-QUEUE'                              20720001
207300                                   TO DP013-PARAGRAPH             20730001
207400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          20740001
207500                                   TO DP013-MESSAGE-TEXT(1)       20750001
207600         PERFORM DP013-0000-PROCESS-ABEND                         20760001
207700     END-IF.                                                      20770001
207800                                                                  20780001
207900******************************************************************20790001
208000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **20800001
208100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **20810001
208200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **20820001
208300** THE USER.                                                    **20830001
208400******************************************************************20840001
208500 6000-REFRESH-PANEL-FROM-TEMP.                                    20850001
208600     IF  ASC-UPDATE-TSQ                                           20860001
208700         SET ASC-NO-TSQ-UPDATE TO TRUE                            20870001
208800         MOVE ZERO                 TO PV-SAVE-ITEM                20880001
208900                                      PV-SEL-QUEUE-ITEM           20890001
209000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        20900001
209100                                   TO PV-HOLD-SELECTED-ITEMS      20910001
209200         MOVE +1                   TO PV-ITEMS-PROCESSED          20920001
209300         PERFORM 6100-UPDATE-TSQ                                  20930001
209400             UNTIL PV-ITEMS-PROCESSED >                           20940001
209500                                     PV-HOLD-SELECTED-ITEMS       20950001
209600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         20960001
209700                    ASC-BLOCK-ENTRIES (2)                         20970001
209800     END-IF.                                                      20980001
209900                                                                  20990001
210000*----------------------------------------------------------------*21000001
210100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *21010001
210200*----------------------------------------------------------------*21020001
210300 6010-DELETE-SEL-QUEUE.                                           21030001
210400                                                                  21040001
210500     EXEC CICS                                                    21050001
210600         DELETEQ TS                                               21060001
210700             QUEUE (ASC-SEL-QUEUE-NAME)                           21070001
210800             RESP  (PV-CICS-RESP)                                 21080001
210900     END-EXEC.                                                    21090001
211000*                                                                 21100001
211100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      21110001
211200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         21120001
211300         CONTINUE                                                 21130001
211400     ELSE                                                         21140001
211500         SET DP013-CICS-ABEND TO TRUE                             21150001
211600         SET DP013-NO-ROLLBACK TO TRUE                            21160001
211700         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          21170001
211800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         21180001
211900                                        TO DP013-MESSAGE-TEXT (1) 21190001
212000         PERFORM DP013-0000-PROCESS-ABEND                         21200001
212100     END-IF.                                                      21210001
212200                                                                  21220001
212300*----------------------------------------------------------------*21230001
212400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *21240001
212500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *21250001
212600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *21260001
212700*    THE TEMP QUEUE.                                             *21270001
212800*----------------------------------------------------------------*21280001
212900 6100-UPDATE-TSQ.                                                 21290001
213000                                                                  21300001
213100     ADD 1    TO  PV-SEL-QUEUE-ITEM.                              21310001
213200     PERFORM 6105-READ-SEL-QUEUE.                                 21320001
213300     PERFORM                                                      21330001
213400         VARYING SU099-IDX FROM 1 BY 1                            21340003
213500         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     21350001
213600         OR (SU099-IDX GREATER THAN SU099-MAX-ITEMS))             21360003
213700         IF  SU099-ACTION-SW (SU099-IDX) > SPACE                  21370003
213800             PERFORM 6110-PROCESS-ITEMS                           21380001
213900         END-IF                                                   21390001
214000         ADD +1                TO PV-ITEMS-PROCESSED              21400001
214100     END-PERFORM.                                                 21410001
214200     PERFORM 6111-WRITE-LIST-QUEUE.                               21420001
214300                                                                  21430001
214400*----------------------------------------------------------------*21440001
214500*    READ THE LIST QUEUE RECORD.                                 *21450001
214600*----------------------------------------------------------------*21460001
214700 6105-READ-SEL-QUEUE.                                             21470001
214800                                                                  21480001
214900     EXEC CICS                                                    21490001
215000          READQ TS                                                21500001
215100              QUEUE (ASC-SEL-QUEUE-NAME)                          21510001
215200              INTO  (SU099-SELECT-RECORD)                         21520003
215300              ITEM  (PV-SEL-QUEUE-ITEM)                           21530001
215400              RESP  (PV-CICS-RESP)                                21540001
215500     END-EXEC.                                                    21550001
215600*                                                                 21560001
215700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          21570001
215800         CONTINUE                                                 21580001
215900     ELSE                                                         21590001
216000         SET DP013-CICS-ABEND      TO  TRUE                       21600001
216100         SET DP013-NO-ROLLBACK     TO  TRUE                       21610001
216200         MOVE '6105-READ-SEL-QUEUE'                               21620001
216300                                   TO  DP013-PARAGRAPH            21630001
216400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           21640001
216500                                   TO  DP013-MESSAGE-TEXT(1)      21650001
216600         PERFORM DP013-0000-PROCESS-ABEND                         21660001
216700     END-IF.                                                      21670001
216800                                                                  21680001
216900*----------------------------------------------------------------*21690001
217000*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*21700001
217100*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*21710001
217200*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *21720001
217300*----------------------------------------------------------------*21730001
217400 6110-PROCESS-ITEMS.                                              21740001
217500                                                                  21750001
217600     COMPUTE PV-ITEM = 1 + ((SU099-ITEM (SU099-IDX) - 1)          21760003
217700                     / PC-ITEMS-PER-PANEL).                       21770001
217800                                                                  21780001
217900     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           21790001
218000         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          21800001
218100             PERFORM 6111-WRITE-LIST-QUEUE                        21810001
218200         END-IF                                                   21820001
218300         MOVE PV-ITEM          TO PV-SAVE-ITEM                    21830001
218400                                                                  21840001
218500         PERFORM 6112-READ-LIST-QUEUE                             21850001
218600         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               21860001
218700             CONTINUE                                             21870001
218800         END-IF                                                   21880001
218900     END-IF.                                                      21890001
219000                                                                  21900001
219100     COMPUTE PV-SUB = (SU099-ITEM (SU099-IDX)                     21910003
219200                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              21920001
219300     SET LQW-DESELECT (PV-SUB) TO    TRUE                         21930001
219400     MOVE LQW-SELECTED-SW (PV-SUB)                                21940001
219500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  21950001
219600     EVALUATE TRUE                                                21960001
219700         WHEN SU099-INQ (SU099-IDX)                               21970003
219800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             21980001
219900                                                                  21990001
220000         WHEN SU099-UPD (SU099-IDX)                               22000003
220100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             22010001
220400                                                                  22040001
220500         WHEN SU099-DEL (SU099-IDX)                               22050003
220600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             22060001
220700                                                                  22070001
220800         WHEN SU099-ERR (SU099-IDX)                               22080003
220900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             22090001
221000                                                                  22100001
221100         WHEN OTHER                                               22110001
221200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             22120001
221300                                                                  22130001
221400     END-EVALUATE.                                                22140001
221500                                                                  22150001
221600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                22160001
221700                                                                  22170001
221800*----------------------------------------------------------------*22180001
221900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *22190001
222000*----------------------------------------------------------------*22200001
222100 6111-WRITE-LIST-QUEUE.                                           22210001
222200                                                                  22220001
222300     EXEC CICS                                                    22230001
222400         WRITEQ TS                                                22240001
222500             QUEUE (ASC-LIST-QUEUE-NAME)                          22250001
222600             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     22260001
222700             ITEM  (PV-SAVE-ITEM)                                 22270001
222800             REWRITE                                              22280001
222900             RESP  (PV-CICS-RESP)                                 22290001
223000     END-EXEC.                                                    22300001
223100*                                                                 22310001
223200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          22320001
223300         CONTINUE                                                 22330001
223400     ELSE                                                         22340001
223500         SET DP013-CICS-ABEND  TO  TRUE                           22350001
223600         SET DP013-NO-ROLLBACK TO  TRUE                           22360001
223700         MOVE '6111-WRITE-LIST-QUEUE' TO  DP013-PARAGRAPH         22370001
223800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  22380001
223900                               TO  DP013-MESSAGE-TEXT(1)          22390001
224000         PERFORM DP013-0000-PROCESS-ABEND                         22400001
224100     END-IF.                                                      22410001
224200                                                                  22420001
224300*----------------------------------------------------------------*22430001
224400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*22440001
224500*----------------------------------------------------------------*22450001
224600 6112-READ-LIST-QUEUE.                                            22460001
224700     EXEC CICS                                                    22470001
224800         READQ TS                                                 22480001
224900             QUEUE (ASC-LIST-QUEUE-NAME)                          22490001
225000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     22500001
225100             ITEM  (PV-ITEM)                                      22510001
225200             RESP  (PV-CICS-RESP)                                 22520001
225300     END-EXEC.                                                    22530001
225400*                                                                 22540001
225500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          22550001
225600         CONTINUE                                                 22560001
225700     ELSE                                                         22570001
225800         SET DP013-CICS-ABEND        TO TRUE                      22580001
225900         SET DP013-NO-ROLLBACK       TO TRUE                      22590001
226000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           22600001
226100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    22610001
226200                                     TO DP013-MESSAGE-TEXT(1)     22620001
226300         PERFORM DP013-0000-PROCESS-ABEND                         22630001
226400     END-IF.                                                      22640001
226500                                                                  22650001
226600*----------------------------------------------------------------*22660001
226700*    ABEND PROCESSOR MODULE                                      *22670001
226800*----------------------------------------------------------------*22680001
226900     COPY DPPD013.                                                22690001
