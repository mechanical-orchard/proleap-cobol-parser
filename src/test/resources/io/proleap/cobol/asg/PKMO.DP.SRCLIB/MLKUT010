000010 IDENTIFICATION DIVISION.                                                 
000020                                                                          
000030 PROGRAM-ID.    MLKUT010.                                                 
000040 AUTHOR.        TESS BESTE.                                               
000050 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000060 DATE-WRITTEN.  11-17-93.                                                 
000070 DATE-COMPILED.                                                           
000080                                                                          
000090******************************************************************        
000100* SUM TRANSACTIONS IN KDM2809 FORMAT.                                     
000120******************************************************************        
000130                                                                          
000140 ENVIRONMENT DIVISION.                                                    
000150                                                                          
000160 CONFIGURATION SECTION.                                                   
000170                                                                          
000180 SOURCE-COMPUTER.    IBM-3090.                                            
000190 OBJECT-COMPUTER.    IBM-3090.                                            
000200                                                                          
000210                                                                          
000220 INPUT-OUTPUT SECTION.                                                    
000230                                                                          
000240 FILE-CONTROL.                                                            
000250     SELECT INPUT-FILE                                                    
000260         ASSIGN TO INP01.                                                 
000270                                                                          
000280                                                                          
000290 DATA DIVISION.                                                           
000300                                                                          
000310 FILE SECTION.                                                            
000320                                                                          
000330 FD  INPUT-FILE                                                           
000340     LABEL RECORDS ARE STANDARD                                           
000350     BLOCK CONTAINS 0 RECORDS                                             
000360     RECORDING  MODE IS F.                                                
000370 01  INPUT-RECORD                PIC X(125).                              
000380                                                                          
000390 WORKING-STORAGE SECTION.                                                 
000400                                                                          
000410******************************************************************        
000420* INPUT RECORD LAYOUT                                                     
000430******************************************************************        
000440                                                                          
000450     COPY MLWS050.                                                        
000460                                                                          
000470 01  PS-PROGRAM-SWITCHES.                                                 
000480     05  PS-END-OF-INPUT-FILE-SW      PIC X         VALUE 'N'.            
000490         88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.            
000500         88  PS-NOT-END-OF-INPUT-FILE               VALUE 'N'.            
000510                                                                          
000520 01  PV-PROGRAM-VARIABLES.                                                
000530     05  PV-DISPLAY-AMT               PIC Z,ZZZ,ZZZ,ZZZ,ZZZ.99-.          
000540     05  PV-RETAIL-AMT                PIC S9(13)V99 VALUE +0              
000550                                                           COMP-3.        
000540     05  PV-ACCUM-PURCH-RETAIL        PIC S9(13)V99 VALUE +0              
000550                                                           COMP-3.        
000560     05  PV-ACCUM-PURCH-NET-COST      PIC S9(13)V99 VALUE +0              
000570                                                           COMP-3.        
000580     05  PV-ACCUM-PURCH-GRO-COST      PIC S9(13)V99 VALUE +0              
000590                                                           COMP-3.        
000600     05  PV-ACCUM-PURCH-FRGT          PIC S9(13)V99 VALUE +0              
000610                                                           COMP-3.        
000620     05  PV-ACCUM-PURCH-DISC          PIC S9(13)V99 VALUE +0              
000630                                                           COMP-3.        
000620     05  PV-ACCUM-SLS-RTL-AMT         PIC S9(13)V99 VALUE +0              
000630                                                           COMP-3.        
000620     05  PV-ACCUM-MKDN-RTL-AMT        PIC S9(13)V99 VALUE +0              
000630                                                           COMP-3.        
000620     05  PV-ACCUM-MKON-RTL-AMT        PIC S9(13)V99 VALUE +0              
000630                                                           COMP-3.        
000620     05  PV-ACCUM-XFER-FROM-RTL-AMT   PIC S9(13)V99 VALUE +0              
000630                                                           COMP-3.        
000620     05  PV-ACCUM-XFER-TO-RTL-AMT     PIC S9(13)V99 VALUE +0              
000630                                                           COMP-3.        
000620     05  PV-ACCUM-ADJ-RTL-AMT         PIC S9(13)V99 VALUE +0              
000630                                                           COMP-3.        
000680                                                                          
000690 PROCEDURE DIVISION.                                                      
000700                                                                          
000710 A100-PROGRAM-MAINLINE.                                                   
000720                                                                          
000730     OPEN INPUT INPUT-FILE.                                               
000740     READ INPUT-FILE INTO D115-PURCH-JOURNAL-REC                          
000750         AT END SET PS-END-OF-INPUT-FILE TO TRUE.                         
000760                                                                          
000770     PERFORM UNTIL PS-END-OF-INPUT-FILE                                   
000771         EVALUATE D115-CODE-10                                            
                   WHEN 10                                                      
000780                 IF D115-TRANS-CD = '01' OR '07'                          
000781                     ADD D115-MERCH-AMT                                   
000781                                      TO PV-ACCUM-PURCH-GRO-COST          
000783                     ADD D115-FRGHT-AMT                                   
000783                                      TO PV-ACCUM-PURCH-FRGT              
000785                     ADD D115-DISCT-AMT                                   
000785                                      TO PV-ACCUM-PURCH-DISC              
000790                     ADD D115-NET-COST                                    
000790                                      TO PV-ACCUM-PURCH-NET-COST          
000805                     ADD D115-RETAIL-AMT                                  
000805                                      TO PV-ACCUM-PURCH-RETAIL            
000810                 ELSE                                                     
000811                     SUBTRACT D115-MERCH-AMT                              
000812                                      FROM PV-ACCUM-PURCH-GRO-COST        
000813                     SUBTRACT D115-FRGHT-AMT                              
000814                                      FROM PV-ACCUM-PURCH-FRGT            
000815                     SUBTRACT D115-DISCT-AMT                              
000816                                      FROM PV-ACCUM-PURCH-DISC            
000820                     SUBTRACT D115-NET-COST                               
000830                                      FROM PV-ACCUM-PURCH-NET-COST        
000835                     SUBTRACT D115-RETAIL-AMT                             
000836                                      FROM PV-ACCUM-PURCH-RETAIL          
000840                 END-IF                                                   
                   WHEN 20                                                      
000740                 MOVE D115-PURCH-JOURNAL-REC                              
00068                                         TO D115-SALES-REC         KDM2809 
00719                  ADD D115-SALE-AMT TO PV-ACCUM-SLS-RTL-AMT        MLKUP002
                   WHEN 30                                                      
000740                 MOVE D115-PURCH-JOURNAL-REC                              
000740                                        TO D115-TRANSFER-FROM-REC         
00740                  COMPUTE PV-RETAIL-AMT = D115-TRANS-UNITS *       MLKUP002
00741                                          D115-RETAIL-PER-UN       MLKUP002
000620                 ADD PV-RETAIL-AMT TO PV-ACCUM-XFER-FROM-RTL-AMT          
                   WHEN 31                                                      
000740                 MOVE D115-PURCH-JOURNAL-REC                              
000740                                        TO D115-TRANSFER-TO-REC           
00795                  COMPUTE PV-RETAIL-AMT = D115-UNITS-TRANSFER *    MLKUP002
00796                                          D115-RETAIL-PER          MLKUP002
000620                 ADD PV-RETAIL-AMT TO PV-ACCUM-XFER-TO-RTL-AMT            
                   WHEN 40                                                      
000740                 MOVE D115-PURCH-JOURNAL-REC TO D115-MKDWN-REC            
00850                  COMPUTE PV-RETAIL-AMT = D115-MKDWN-QTY *         MLKUP002
00851                         (D115-MKDWN-OPRICE - D115-MKDWN-NPRICE)   MLKUP002
000620                 ADD PV-RETAIL-AMT TO PV-ACCUM-MKDN-RTL-AMT               
000940             WHEN 50                                                 CL**2
000740                 MOVE D115-PURCH-JOURNAL-REC TO D115-MARKON-REC           
00905                  COMPUTE PV-RETAIL-AMT = D115-MARKON-QTY *        MLKUP002
00906                         (D115-MARKON-NPRICE - D115-MARKON-OPRICE) MLKUP002
000620                 ADD PV-RETAIL-AMT TO PV-ACCUM-MKON-RTL-AMT               
000940             WHEN 80                                                 CL**2
000740                 MOVE D115-PURCH-JOURNAL-REC TO D115-ADJ-REC              
01001                  ADD D115-AT-RETAIL TO PV-ACCUM-ADJ-RTL-AMT       MLKUP002
000990         END-EVALUATE                                                CL**2
000980                                                                          
000990         READ INPUT-FILE INTO D115-PURCH-JOURNAL-REC                      
001000             AT END SET PS-END-OF-INPUT-FILE TO TRUE                      
001010         END-READ                                                         
001020     END-PERFORM.                                                         
001030                                                                          
001080     MOVE PV-ACCUM-PURCH-GRO-COST    TO PV-DISPLAY-AMT.                   
001090     DISPLAY 'PURCH GRO COST: '         PV-DISPLAY-AMT.                   
001100     MOVE PV-ACCUM-PURCH-FRGT        TO PV-DISPLAY-AMT.                   
001110     DISPLAY 'PURCH FRGT:     '         PV-DISPLAY-AMT.                   
001120     MOVE PV-ACCUM-PURCH-DISC        TO PV-DISPLAY-AMT.                   
001130     DISPLAY 'PURCH DISC:     '         PV-DISPLAY-AMT.                   
001131     MOVE PV-ACCUM-PURCH-NET-COST    TO PV-DISPLAY-AMT.                   
001132     DISPLAY 'PURCH NET COST: '         PV-DISPLAY-AMT.                   
001133     MOVE PV-ACCUM-PURCH-RETAIL      TO PV-DISPLAY-AMT.                   
001134     DISPLAY 'PURCH RETAIL:   '         PV-DISPLAY-AMT.                   
001133     MOVE PV-ACCUM-SLS-RTL-AMT       TO PV-DISPLAY-AMT.                   
001134     DISPLAY 'SALES RETAIL:   '         PV-DISPLAY-AMT.                   
001133     MOVE PV-ACCUM-MKDN-RTL-AMT      TO PV-DISPLAY-AMT.                   
001134     DISPLAY 'MKDN RETAIL:    '         PV-DISPLAY-AMT.                   
001133     MOVE PV-ACCUM-MKON-RTL-AMT      TO PV-DISPLAY-AMT.                   
001134     DISPLAY 'MKON RETAIL:    '         PV-DISPLAY-AMT.                   
001133     MOVE PV-ACCUM-XFER-FROM-RTL-AMT TO PV-DISPLAY-AMT.                   
001134     DISPLAY 'TRANSFERS OUT:  '         PV-DISPLAY-AMT.                   
001133     MOVE PV-ACCUM-XFER-TO-RTL-AMT   TO PV-DISPLAY-AMT.                   
001134     DISPLAY 'TRANSFERS IN:   '         PV-DISPLAY-AMT.                   
001133     MOVE PV-ACCUM-ADJ-RTL-AMT       TO PV-DISPLAY-AMT.                   
001134     DISPLAY 'ADJ RETAIL:     '         PV-DISPLAY-AMT.                   
001180     CLOSE INPUT-FILE.                                                    
001190                                                                          
001200     STOP RUN.                                                            
