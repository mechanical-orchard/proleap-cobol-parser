000100 IDENTIFICATION DIVISION.                                                 
000200 PROGRAM-ID.    MLKRP226.                                                 
000300 AUTHOR.        PATRICK BURKE.                                            
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000500 DATE-WRITTEN.  OCTOBER 2006.                                             
000600 DATE-COMPILED.                                                           
000700******************************************************************        
000900* MLKRP226 - DATA INTEGRITY REPORT FOR DETAIL LEDGER BASED TABLES         
001100* THIS PROGRAM WILL READ A DATA INTEGRITY REPORT FILE AND CREATE          
001200* A DATA INTEGRITY REPORT. COPIED FROM MLKRP213                           
001080*CHANGE HISTORY:                                                          
001090* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES                   
001100* ------- ---------- ----------- --------------------------------         
007600* BG28582 04-02-2007 BRUCE GRAHAM BRAND VENDOR CHANGES EIC2               
007600*                                             ORIGINAL CODE.              
001300******************************************************************        
006500 ENVIRONMENT DIVISION.                                                    
006600*                                                                         
006700 CONFIGURATION SECTION.                                                   
006800*                                                                         
006900 SOURCE-COMPUTER.        IBM-3090.                                        
007000 OBJECT-COMPUTER.        IBM-3090.                                        
007100*                                                                         
007200 INPUT-OUTPUT SECTION.                                                    
007300 FILE-CONTROL.                                                            
007400                                                                          
007500     SELECT COMPARE-TABLES-CTL-FILE                                       
007600         ASSIGN TO INP01.                                                 
007700                                                                          
007800     SELECT DATA-INTEGRITY-CTL-FILE                                       
007900         ASSIGN TO INP02.                                                 
008000                                                                          
008100     SELECT DATA-INTEGRITY-DIFF-FILE                                      
008200         ASSIGN TO INP03.                                                 
008300                                                                          
008400     SELECT DATA-INTEGRITY-REPORT                                         
008500         ASSIGN TO RPT01.                                                 
008600                                                                          
008700******************************************************************        
008800 DATA DIVISION.                                                           
008900******************************************************************        
009000                                                                          
009100 FILE SECTION.                                                            
009200                                                                          
009300 FD  COMPARE-TABLES-CTL-FILE                                              
009400     LABEL RECORDS ARE STANDARD                                           
009500     RECORDING MODE IS F                                                  
009600     BLOCK CONTAINS 0 RECORDS.                                            
009700 01  COMPARE-TABLES-CTL-REC      PIC X(80).                               
009800                                                                          
009900 FD  DATA-INTEGRITY-CTL-FILE                                              
010000     LABEL RECORDS ARE STANDARD                                           
010100     RECORDING MODE IS F                                                  
010200     BLOCK CONTAINS 0 RECORDS.                                            
010300 01  DATA-INTEGRITY-CTL-REC      PIC X(80).                               
010400                                                                          
010500 FD  DATA-INTEGRITY-DIFF-FILE                                             
010600     RECORDING MODE IS F                                                  
010700     LABEL RECORDS ARE STANDARD                                           
010800     BLOCK CONTAINS 0 RECORDS.                                            
010900                                                                          
011100 01  DATA-INTEGRITY-DIFF-REC     PIC X(80).                               
011200                                                                          
011300 FD  DATA-INTEGRITY-REPORT                                                
011400     LABEL RECORDS ARE OMITTED                                            
011500     RECORDING MODE IS F                                                  
011600     BLOCK CONTAINS 0 RECORDS.                                            
011800 01  DATA-INTEGRITY-REC          PIC X(150).                              
011900                                                                          
012000*                                                                         
012100******************************************************************        
012200 WORKING-STORAGE SECTION.                                                 
012300******************************************************************        
012400                                                                          
012500 01  PS-PROGRAM-SWITCHES.                                                 
012600     05  PS-MORE-DIFF-RECS-SW                                             
012700                                 PIC X       VALUE 'Y'.                   
012800         88  PS-MORE-DIFF-RECS               VALUE 'Y'.                   
012900         88  PS-NO-MORE-DIFF-RECS            VALUE 'N'.                   
013000                                                                          
013100 01  PA-PROGRAM-ACCUMULATORS                 COMP-3.                      
013200     05  PA-DIFF-RECORDS-READ    PIC S9(13)  VALUE ZERO.                  
013300     05  PA-REPORT-LINES-WRITTEN PIC S9(13)  VALUE ZERO.                  
013400                                                                          
013500 01  CD-COUNTER-DISPLAY.                                                  
013600     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.                   
013700                                                                          
013800 01  PC-PROGRAM-CONSTANTS.                                                
013900     05  PC-MAX-LINE-COUNT       PIC S9(3) COMP-3 VALUE +55.              
014000     05  PC-ERR-IDX-MAX          PIC S9(3) COMP-3 VALUE +19.              
014100     05  PC-LOW-TABLE-TWKPOSS    PIC X(09) VALUE 'TWKPOSS'.               
014200     05  PC-LOW-TABLE-TWKDPTS    PIC X(09) VALUE 'TWKDPTS'.               
014300     05  PC-LOW-TABLE-TWKDPTC    PIC X(09) VALUE 'TWKDPTC'.               
014400     05  PC-LOW-TABLE-TWKMCLC    PIC X(09) VALUE 'TWKMCLC'.               
014500     05  PC-LOW-TABLE-TMNDPTC    PIC X(09) VALUE 'TMNDPTC'.               
014600     05  PC-LOW-TABLE-TMNMCLC    PIC X(09) VALUE 'TMNMCLC'.               
014700     05  PC-LOW-TABLE-WKLYSUM    PIC X(09) VALUE 'WKLYSUM'.               
014800     05  PC-LOW-TABLE-MNLYSUM    PIC X(09) VALUE 'MNLYSUM'.               
014900                                                                          
015000 01  PV-PROGRAM-VARIABLES.                                                
015100     05  PV-LINE-COUNT           PIC S9(3) COMP-3.                        
015200     05  PV-PAGE-COUNT           PIC S9(7) COMP-3.                        
015300                                                                          
015400     05  PV-DATE-YYMMDD.                                                  
015500         10  PV-DATE-YYMMDD-YY   PIC XX.                                  
015600         10  PV-DATE-YYMMDD-MM   PIC XX.                                  
015700         10  PV-DATE-YYMMDD-DD   PIC XX.                                  
015800     05  PV-TIME-HHMMSS.                                                  
015900         10  PV-TIME-HHMMSS-HH   PIC XX.                                  
016000         10  PV-TIME-HHMMSS-MM   PIC XX.                                  
016100         10  PV-TIME-HHMMSS-SS   PIC XX.                                  
016200                                                                          
015800     05  PV-DKEY.                                                         
015900         10  PV-DKEY-NBR         PIC X(09).                               
016000         10  FILLER              PIC X(06).                               
016200                                                                          
016300     05  PV-SPLIT-DATE.                                                   
016400         10  PV-SPLIT-DATE-CCYY  PIC X(4).                                
016500         10  PV-HYPHEN-1         PIC X.                                   
016600         10  PV-SPLIT-DATE-MM    PIC X(2).                                
016700         10  PV-HYPHEN-2         PIC X.                                   
016800         10  PV-SPLIT-DATE-DD    PIC X(2).                                
016900     05  PV-FRMT-DATE.                                                    
017000         10  PV-FRMT-DATE-MM     PIC X(2).                                
017100         10  PV-HYPHEN-1ST       PIC X.                                   
017200         10  PV-FRMT-DATE-DD     PIC X(2).                                
017300         10  PV-HYPHEN-2ND       PIC X.                                   
017400         10  PV-FRMT-DATE-CCYY   PIC X(4).                                
017500                                                                          
017600     05  PV-DIFFERENCE           PIC S9(9)V99 COMP-3.                     
017700                                                                          
017800 01  TABLE-ERROR-DESC.                                                    
017900     05  FILLER                  PIC 9(02)   VALUE 1.                     
018000     05  FILLER                  PIC X(32)   VALUE                        
018100     'CORRESPONDING DATA NOT FOUND ON '.                                  
018200     05  TBL-ERROR-01-TBL        PIC X(07).                               
018300     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
018400     05  FILLER                  PIC 9(02)   VALUE 2.                     
018500     05  FILLER                  PIC X(32)   VALUE                        
018600     'CORRESPONDING DATA NOT FOUND ON '.                                  
018700     05  TBL-ERROR-02-TBL        PIC X(07).                               
018800     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
018900     05  FILLER                  PIC 9(02)   VALUE 3.                     
019000     05  FILLER                  PIC X(39)   VALUE                        
019100     'SLS-RTL-AMT DOES NOT MATCH.            '.                           
019200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
019300     05  FILLER                  PIC 9(02)   VALUE 4.                     
019400     05  FILLER                  PIC X(39)   VALUE                        
019500     'MKDN-RTL-AMT DOES NOT MATCH.           '.                           
019600     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
019700     05  FILLER                  PIC 9(02)   VALUE 5.                     
019800     05  FILLER                  PIC X(39)   VALUE                        
019900     'MKUP-RTL-AMT DOES NOT MATCH.           '.                           
020000     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
020100     05  FILLER                  PIC 9(02)   VALUE 6.                     
020200     05  FILLER                  PIC X(39)   VALUE                        
020300     'XFER-IN-RTL-AMT DOES NOT MATCH.        '.                           
020400     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
020500     05  FILLER                  PIC 9(02)   VALUE 7.                     
020600     05  FILLER                  PIC X(39)   VALUE                        
020700     'XFER-OUT-RTL-AMT DOES NOT MATCH.       '.                           
020800     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
020900     05  FILLER                  PIC 9(02)   VALUE 8.                     
021000     05  FILLER                  PIC X(39)   VALUE                        
021100     'RCPT-RTL-AMT DOES NOT MATCH.           '.                           
021200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
021300     05  FILLER                  PIC 9(02)   VALUE 9.                     
021400     05  FILLER                  PIC X(39)   VALUE                        
021500     'RCPT-NET-COST-AMT DOES NOT MATCH.      '.                           
021600     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
021700     05  FILLER                  PIC 9(02)   VALUE 10.                    
021800     05  FILLER                  PIC X(39)   VALUE                        
021900     'PADJ-RTL-AMT DOES NOT MATCH.           '.                           
022000     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
022100     05  FILLER                  PIC 9(02)   VALUE 11.                    
022200     05  FILLER                  PIC X(39)   VALUE                        
022300     'PADJ-NET-COST-AMT DOES NOT MATCH.      '.                           
022400     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
022500     05  FILLER                  PIC 9(02)   VALUE 12.                    
022600     05  FILLER                  PIC X(39)   VALUE                        
022700     'INV-ADJ-RTL-AMT DOES NOT MATCH.        '.                           
022800     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
022900     05  FILLER                  PIC 9(02)   VALUE 13.                    
023000     05  FILLER                  PIC X(39)   VALUE                        
023100     'SHNK-RTL-AMT DOES NOT MATCH.           '.                           
023200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
023300     05  FILLER                  PIC 9(02)   VALUE 14.                    
023400     05  FILLER                  PIC X(39)   VALUE                        
023500     'END-INV-RTL-AMT DOES NOT MATCH.        '.                           
023600     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
023300     05  FILLER                  PIC 9(02)   VALUE 15.                    
023400     05  FILLER                  PIC X(39)   VALUE                        
023100     'END-INV-COST2-AMT DOES NOT MATCH.      '.                           
023200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
023300     05  FILLER                  PIC 9(02)   VALUE 16.                    
023400     05  FILLER                  PIC X(39)   VALUE                        
023100     'ADJ-GRO-MRGN-AMT DOES NOT MATCH.       '.                           
023200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
023300     05  FILLER                  PIC 9(02)   VALUE 17.                    
023400     05  FILLER                  PIC X(39)   VALUE                        
023100     'REC WITH ZERO D-KEY(WKLYSUM OR MNLYSUM)'.                           
023200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
023300     05  FILLER                  PIC 9(02)   VALUE 18.                    
023400     05  FILLER                  PIC X(39)   VALUE                        
023100     'REC WITH ZERO D-KEY(BRND-VND)          '.                           
023200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
023300     05  FILLER                  PIC 9(02)   VALUE 19.                    
023400     05  FILLER                  PIC X(39)   VALUE                        
023100     'REC WITH ZERO D-KEY (BOTH TABLES)      '.                           
023200     05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
023700 01  TABLE-FOR-ERROR-TEXT.                                                
023800     05  TABLE-ERROR-ENTRIES     OCCURS 19 TIMES                          
023900                                 INDEXED BY ERR-IDX.                      
024000         10  TBL-ERR-NBR         PIC 9(02).                               
024100         10  TBL-ERR-MSG         PIC X(39).                               
024200         10  TBL-ERR-TOTAL       PIC S9(13)  COMP-3.                      
024300                                                                          
024400 EJECT                                                                    
024500                                                                          
024600 01 ABEND-AREAS.                                                          
024700     05 ABEND-CODE               PIC S9(04)  VALUE ZERO                   
024800                                             COMP SYNC.                   
024900         88  AC-BAD-DATA                     VALUE +4003.                 
025000         88  AC-DB2-ERROR                    VALUE +4013.                 
025100     05  AA-ABEND-LIT            PIC X(40)   VALUE                        
025200           '*****       ABEND'.                                           
025300     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                        
025400             '*****   PROGRAM: MLKRP226'.                                 
025500     05  AA-PARAGRAPH-LIT.                                                
025600         10  FILLER              PIC X(17)   VALUE                        
025700             '***** PARAGRAPH: '.                                         
025800         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.                
025900     05  AA-MESSAGE-LINE.                                                 
026000         10  FILLER              PIC X(06)   VALUE '*****'.               
026100         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.                
026200     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                        
026300             '*****    DB2 ERROR'.                                        
026400     05  AA-DB2-OPERATION-LIT.                                            
026500         10  FILLER              PIC X(17)   VALUE                        
026600             '***** OPERATION: '.                                         
026700         10  AA-DB2-OPERATION.                                            
026800             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.                
026900             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.                
027000     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.                
027100     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.                
027200     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.                
027300     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.                
027400                                                                          
027500 EJECT                                                                    
027600                                                                          
027700*** DATA INTEGRITY COMPARE TABLES CONTROL CARD                            
027800 01  CC-CONTROL-CARD-REC.                                                 
027900     05  CC-LOW-TABLE            PIC X(7).                                
028000     05  FILLER                  PIC X.                                   
028100     05  CC-HIGH-TABLE           PIC X(7).                                
028200     05  FILLER                  PIC X(65).                               
028300                                                                          
028400*** DATA INTEGRITY CONTROL CARD                                           
028500     COPY MLRD110.                                                        
028600                                                                          
028700*** DATA INTEGRITY DIFFERENCE REPORT FILE                                 
028800     COPY MLRD212.                                                        
028900                                                                          
029000 EJECT                                                                    
029100                                                                          
029200******************************************************************        
029300***  STANDARD REPORT HEADING (150 BYTES)                                  
029400******************************************************************        
029700     COPY DPWS150O.                                                       
029800                                                                          
029900******************************************************************        
030000***  REPORT TITLE LINES                                                   
030100******************************************************************        
030200 01  HD-REPORT-TITLE-2.                                                   
030300     05  FILLER                  PIC X       VALUE SPACE.                 
030400     05  FILLER                  PIC X(43)   VALUE SPACES.                
030500     05  FILLER                  PIC X(15)                                
030600                                 VALUE 'DATA INTEGRITY '.                 
030700     05  HD-T2-LOW-TBL           PIC X(07).                               
030800     05  FILLER                  PIC X(03)   VALUE ' / '.                 
030900     05  HD-T2-HIGH-TBL          PIC X(07).                               
031000     05  FILLER                  PIC X(13)                                
031100                                 VALUE ' ERROR REPORT'.                   
031200     05  FILLER                  PIC X(43)   VALUE SPACES.                
031300                                                                          
031400 01  HD-REPORT-TITLE-3.                                                   
031500     05  FILLER                  PIC X       VALUE SPACE.                 
031600     05  FILLER                  PIC X(49)   VALUE SPACES.                
031700     05  FILLER                  PIC X(04)   VALUE 'FOR '.                
031800     05  HD-T3-FROM-MM-DD-CCYY   PIC X(10).                               
031900     05  FILLER                  PIC X(09)                                
032000                                 VALUE ' THROUGH '.                       
032100     05  HD-T3-THRU-MM-DD-CCYY   PIC X(10).                               
032200     05  FILLER                  PIC X(49)   VALUE SPACES.                
032300                                                                          
032400******************************************************************        
032500***  REPORT COLUMN HEADING LINES                                          
032600******************************************************************        
032700 01  HD-COLUMN-HEADING-1.                                                 
032800     05  FILLER                  PIC X       VALUE SPACE.                 
032900     05  FILLER                  PIC X(12)   VALUE 'FSCL MN     '.        
033000     05  FILLER                  PIC X(05)   VALUE 'FSCL '.               
033100     05  FILLER                  PIC X(06)   VALUE 'DEPT  '.              
033200     05  FILLER                  PIC X(05)   VALUE 'MCL  '.               
033300     05  FILLER                  PIC X(05)   VALUE 'SCL  '.               
033400     05  FILLER                  PIC X(07)   VALUE 'LOC    '.             
033510     05  FILLER                  PIC X(06)   VALUE 'DKEY  '.              
033520     05  FILLER                  PIC X(07)   VALUE SPACES.                
033600     05  HD-C1-LOW-TBL           PIC X(07).                               
033700     05  FILLER                  PIC X(06)   VALUE ' AMT  '.              
033800*    05  FILLER                  PIC X(03)   VALUE SPACES.                
033900     05  FILLER                  PIC X(06)   VALUE SPACES.                
034000     05  HD-C1-HIGH-TBL          PIC X(07).                               
034100     05  FILLER                  PIC X(07)   VALUE ' AMT   '.             
034200*    05  FILLER                  PIC X(02)   VALUE SPACES.                
034300     05  FILLER                  PIC X(05)   VALUE SPACES.                
034400     05  FILLER                  PIC X(15)                                
034500                                 VALUE '   DIFFERENCE  '.                 
034600*    05  FILLER                  PIC X(02)   VALUE SPACES.                
034700     05  FILLER                  PIC X(05)   VALUE SPACES.                
034800     05  FILLER                  PIC X(38)                                
034900                                 VALUE '      ERROR MESSAGE'.             
035000     05  FILLER                  PIC X(09)   VALUE SPACES.                
035100                                                                          
035200 01  HD-COLUMN-HEADING-2.                                                 
035300     05  FILLER                  PIC X       VALUE SPACE.                 
035400     05  FILLER                  PIC X(10)   VALUE 'END DATE  '.          
035500     05  FILLER                  PIC X(02)   VALUE SPACES.                
035600     05  FILLER                  PIC X(03)   VALUE 'MTH'.                 
035610     05  FILLER                  PIC X(25)   VALUE SPACES.                
035620     05  FILLER                  PIC X(03)   VALUE 'NBR'.                 
035700     05  FILLER                  PIC X(86)   VALUE SPACES.                
035800     05  FILLER                  PIC X(18)   VALUE SPACES.                
035900                                                                          
036000 01  HD-COLUMN-HEADING-3.                                                 
036100     05  FILLER                  PIC X       VALUE SPACE.                 
036200     05  FILLER                  PIC X(10)   VALUE SPACES.                
036300     05  FILLER                  PIC X(39)   VALUE                        
036400                                 'ERROR DESCRIPTION'.                     
036500     05  FILLER                  PIC X(10)   VALUE SPACES.                
036600     05  FILLER                  PIC X(17)   VALUE SPACES.                
036700     05  FILLER                  PIC X(05)   VALUE 'COUNT'.               
036800     05  FILLER                  PIC X(50)   VALUE SPACES.                
036900     05  FILLER                  PIC X(18)   VALUE SPACES.                
037000                                                                          
037100******************************************************************        
037200***  REPORT DETAIL LINES                                                  
037300******************************************************************        
037400 01  DL-LINE-1.                                                           
037500     05  FILLER                  PIC X       VALUE SPACE.                 
037600     05  DL-FSCL-MN-END-DTE      PIC X(10).                               
037700     05  FILLER                  PIC X(03)   VALUE SPACE.                 
037800     05  DL-FSCL-MN-NBR          PIC X(02).                               
037900     05  FILLER                  PIC X(03)   VALUE SPACE.                 
038000     05  DL-DEPT                 PIC X(03).                               
038100     05  FILLER                  PIC X(03)   VALUE SPACE.                 
038200     05  DL-MCL                  PIC Z(02).                               
038300     05  FILLER                  PIC X(03)   VALUE SPACE.                 
038400     05  DL-SCL                  PIC Z(02).                               
038500**   05  FILLER                  PIC X(02)   VALUE SPACE.                 
038600**   05  DL-STORE                PIC Z(03).                               
038500     05  FILLER                  PIC X(01)   VALUE SPACE.                 
038600     05  DL-STORE                PIC Z(04).                               
038700     05  FILLER                  PIC X(01)   VALUE SPACE.                 
038710     05  DL-DKEY                 PIC ZZZZZZZZ9.                           
038720     05  FILLER                  PIC X(02)   VALUE SPACE.                 
038800*    05  DL-LOW-TBL-AMT          PIC ZZZ,ZZZ,ZZZ.99-                      
038900     05  DL-LOW-TBL-AMT          PIC ZZ,ZZZ,ZZZ,ZZZ.99-                   
039000                                 BLANK WHEN ZERO.                         
039100     05  FILLER                  PIC X(01)   VALUE SPACE.                 
039200*    05  DL-HIGH-TBL-AMT         PIC ZZZ,ZZZ,ZZZ.99-                      
039300     05  DL-HIGH-TBL-AMT         PIC ZZ,ZZZ,ZZZ,ZZZ.99-                   
039400                                 BLANK WHEN ZERO.                         
039500     05  FILLER                  PIC X(03)   VALUE SPACE.                 
039600*    05  DL-DIFFERENCE-AMT       PIC ZZZ,ZZZ,ZZZ.99-                      
039700     05  DL-DIFFERENCE-AMT       PIC ZZ,ZZZ,ZZZ,ZZZ.99-                   
039800                                 BLANK WHEN ZERO.                         
039900     05  FILLER                  PIC X(02)   VALUE SPACES.                
040000     05  DL-ERROR-MESSAGE        PIC X(39).                               
040100     05  FILLER                  PIC X(09)   VALUE SPACE.                 
040200                                                                          
040300 01  DL-LINE-2.                                                           
040400     05  FILLER                  PIC X       VALUE SPACE.                 
040500     05  FILLER                  PIC X(10)   VALUE SPACE.                 
040600     05  DL-ERR-DESC             PIC X(39).                               
040700     05  FILLER                  PIC X(10)   VALUE SPACES.                
040800     05  FILLER                  PIC X(05)   VALUE SPACE.                 
040900     05  DL-ERR-COUNT            PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.                   
041000     05  FILLER                  PIC X(50)   VALUE SPACE.                 
041100     05  FILLER                  PIC X(18)   VALUE SPACE.                 
041200                                                                          
041300******************************************************************        
041400***  REPORT END OF REPORT LINE                                            
041500******************************************************************        
041600 01  ER-END-OF-REPORT-LINE.                                               
041700     05  FILLER                  PIC X(21)   VALUE                        
041800                                    '*** END OF REPORT ***'.              
041900                                                                          
042000 EJECT                                                                    
042100                                                                          
042200******************************************************************        
042300 PROCEDURE DIVISION.                                                      
042400******************************************************************        
042500                                                                          
042600******************************************************************        
042700 0000-MAINLINE-MLKRP226.                                                  
042800******************************************************************        
042900*                                                                         
043000     PERFORM 1000-INITIALIZATION.                                         
043100                                                                          
043200     PERFORM 2000-MAIN-PROCESS.                                           
043300                                                                          
043400     PERFORM 8000-EOJ.                                                    
043500                                                                          
043600     IF PA-DIFF-RECORDS-READ > ZERO                                       
043700        MOVE 4095 TO RETURN-CODE                                          
043800     ELSE                                                                 
043900        MOVE 0    TO RETURN-CODE                                          
044000     END-IF.                                                              
044100                                                                          
044200     STOP RUN.                                                            
044300                                                                          
044400 EJECT                                                                    
044500                                                                          
044600******************************************************************        
044700 1000-INITIALIZATION.                                                     
044800******************************************************************        
044900*                                                                         
045000     OPEN INPUT  COMPARE-TABLES-CTL-FILE                                  
045100                 DATA-INTEGRITY-CTL-FILE                                  
045200                 DATA-INTEGRITY-DIFF-FILE.                                
045300     OPEN OUTPUT DATA-INTEGRITY-REPORT.                                   
045400                                                                          
045500     PERFORM 4000-READ-COMPARE-TABLES-CTL.                                
045600                                                                          
045700     DISPLAY ' '.                                                         
045800     DISPLAY '*** MLKRP226 COMPARE TABLES CTL VALUES ***'                 
045900     DISPLAY CC-CONTROL-CARD-REC.                                         
046000                                                                          
046100     PERFORM 4100-READ-DATA-INTEGRITY-CTL.                                
046200                                                                          
046300     DISPLAY ' '.                                                         
046400     DISPLAY '*** MLKRP226 DATA INTEGRITY CTL VALUES ***'                 
046500     DISPLAY ML110-DATA-INTEGRITY-CC-REC.                                 
046600                                                                          
046700     INITIALIZE PV-PROGRAM-VARIABLES.                                     
046800                                                                          
046900     ACCEPT PV-DATE-YYMMDD FROM DATE.                                     
047000     MOVE PV-DATE-YYMMDD-YY      TO DP150O-RUN-YEAR.                      
047100     MOVE PV-DATE-YYMMDD-MM      TO DP150O-RUN-MONTH.                     
047200     MOVE PV-DATE-YYMMDD-DD      TO DP150O-RUN-DAY.                       
047300     ACCEPT PV-TIME-HHMMSS FROM TIME.                                     
047400     MOVE PV-TIME-HHMMSS-HH      TO DP150O-RUN-HOUR.                      
047500     MOVE PV-TIME-HHMMSS-MM      TO DP150O-RUN-MINUTE.                    
047600     MOVE 'MLKRP226'             TO DP150O-PROGRAM-NAME.                  
047700     EVALUATE TRUE                                                        
047800         WHEN CC-LOW-TABLE = 'TWKSCLS'                                    
047900             MOVE 1              TO DP150O-REPORT-NUMBER                  
048000         WHEN CC-LOW-TABLE = 'TMNSCLS'                                    
048100             MOVE 2              TO DP150O-REPORT-NUMBER                  
048200         WHEN CC-LOW-TABLE = 'TMNSCL'                                     
048300             MOVE 3              TO DP150O-REPORT-NUMBER                  
048400         WHEN CC-LOW-TABLE = 'TMNMCL'                                     
048500             MOVE 4              TO DP150O-REPORT-NUMBER                  
048600         WHEN CC-LOW-TABLE = 'TVAMCL'                                     
048700             MOVE 5              TO DP150O-REPORT-NUMBER                  
048800         WHEN CC-LOW-TABLE = 'TWKSHNK' AND                                
048900              CC-HIGH-TABLE = 'TWKSCLS'                                   
049000             MOVE 6              TO DP150O-REPORT-NUMBER                  
049100         WHEN CC-LOW-TABLE = 'TWKSHNK' AND                                
049200              CC-HIGH-TABLE = 'TMNSCLS'                                   
049300             MOVE 7              TO DP150O-REPORT-NUMBER                  
049400         WHEN CC-LOW-TABLE = 'TVADPT'                                     
049500             MOVE 8              TO DP150O-REPORT-NUMBER                  
049600         WHEN CC-LOW-TABLE = 'TWKDPT'                                     
049700             MOVE 9              TO DP150O-REPORT-NUMBER                  
049800         WHEN CC-LOW-TABLE = 'TMNDPTS'                                    
049900             MOVE 0              TO DP150O-REPORT-NUMBER                  
050000         WHEN CC-LOW-TABLE = 'TMNMCLS'                                    
050100             MOVE 'A'            TO DP150O-REPORT-NUMBER-CHAR             
050200         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS                         
050300             MOVE 'B'            TO DP150O-REPORT-NUMBER-CHAR             
050400         WHEN CC-LOW-TABLE = 'TWKMCL'                                     
050500             MOVE 'C'            TO DP150O-REPORT-NUMBER-CHAR             
050600         WHEN CC-LOW-TABLE = 'TWKMCLS'                                    
050700             MOVE 'D'            TO DP150O-REPORT-NUMBER-CHAR             
050800         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTS                         
050900             MOVE 'E'            TO DP150O-REPORT-NUMBER-CHAR             
051000         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTC                         
051100             MOVE 'F'            TO DP150O-REPORT-NUMBER-CHAR             
051200         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKMCLC                         
051300             MOVE 'G'            TO DP150O-REPORT-NUMBER-CHAR             
051400         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNDPTC                         
051500             MOVE 'H'            TO DP150O-REPORT-NUMBER-CHAR             
051600         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNMCLC                         
051700             MOVE 'I'            TO DP150O-REPORT-NUMBER-CHAR             
051800         WHEN CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM                         
051900             MOVE 'J'            TO DP150O-REPORT-NUMBER-CHAR             
052000         WHEN CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM                         
052100             MOVE 'K'            TO DP150O-REPORT-NUMBER-CHAR             
052200     END-EVALUATE.                                                        
052300                                                                          
052400     MOVE CC-LOW-TABLE           TO HD-T2-LOW-TBL.                        
052500     MOVE CC-HIGH-TABLE          TO HD-T2-HIGH-TBL.                       
052600                                                                          
052700     MOVE ML110-STRT-DTE         TO PV-SPLIT-DATE.                        
052800     MOVE PV-SPLIT-DATE-CCYY     TO PV-FRMT-DATE-CCYY.                    
052900     MOVE PV-SPLIT-DATE-MM       TO PV-FRMT-DATE-MM.                      
053000     MOVE PV-SPLIT-DATE-DD       TO PV-FRMT-DATE-DD.                      
053100     MOVE '-'                    TO PV-HYPHEN-1ST                         
053200                                    PV-HYPHEN-2ND.                        
053300     MOVE PV-FRMT-DATE           TO HD-T3-FROM-MM-DD-CCYY.                
053400     MOVE ML110-END-DTE          TO PV-SPLIT-DATE.                        
053500     MOVE PV-SPLIT-DATE-CCYY     TO PV-FRMT-DATE-CCYY.                    
053600     MOVE PV-SPLIT-DATE-MM       TO PV-FRMT-DATE-MM.                      
053700     MOVE PV-SPLIT-DATE-DD       TO PV-FRMT-DATE-DD.                      
053800     MOVE PV-FRMT-DATE           TO HD-T3-THRU-MM-DD-CCYY.                
053900                                                                          
054000     MOVE CC-LOW-TABLE           TO HD-C1-LOW-TBL.                        
054100     MOVE CC-HIGH-TABLE          TO HD-C1-HIGH-TBL.                       
054200                                                                          
054300     PERFORM 6000-WRITE-REPORT-TITLE.                                     
054400                                                                          
054500     MOVE CC-HIGH-TABLE          TO TBL-ERROR-01-TBL.                     
054600     MOVE CC-LOW-TABLE           TO TBL-ERROR-02-TBL.                     
054700                                                                          
054800     MOVE TABLE-ERROR-DESC       TO TABLE-FOR-ERROR-TEXT.                 
054900                                                                          
055000 EJECT                                                                    
055100                                                                          
055200******************************************************************        
055300 2000-MAIN-PROCESS.                                                       
055400******************************************************************        
055500*                                                                         
055600     PERFORM 4200-READ-DIFF-REPORT-FILE.                                  
055700                                                                          
055800     PERFORM                                                              
055900       UNTIL PS-NO-MORE-DIFF-RECS                                         
056000         PERFORM 6100-CREATE-REPORT                                       
056100         PERFORM 4200-READ-DIFF-REPORT-FILE                               
056200     END-PERFORM.                                                         
056300                                                                          
056400 EJECT                                                                    
056500                                                                          
056600******************************************************************        
056700 4000-READ-COMPARE-TABLES-CTL.                                            
056800******************************************************************        
056900*                                                                         
057000     READ COMPARE-TABLES-CTL-FILE                                         
057100       INTO CC-CONTROL-CARD-REC                                           
057200         AT END                                                           
057300             MOVE '4000-READ-COMPARE-TABLES-CTL'                          
057400                                 TO AA-PARAGRAPH-NAME                     
057500             MOVE 'COMPARE TABLES CONTROL CARD IS MISSING'                
057600                                 TO AA-MESSAGE                            
057700             MOVE +4001          TO ABEND-CODE                            
057800             PERFORM 9900-COMMON-ABEND-ROUTINE                            
057900     END-READ.                                                            
058000                                                                          
058100 EJECT                                                                    
058200                                                                          
058300******************************************************************        
058400 4100-READ-DATA-INTEGRITY-CTL.                                            
058500******************************************************************        
058600*                                                                         
058700     READ DATA-INTEGRITY-CTL-FILE                                         
058800       INTO ML110-DATA-INTEGRITY-CC-REC                                   
058900         AT END                                                           
059000             MOVE '4100-READ-DATA-INTEGRITY-CTL'                          
059100                                 TO AA-PARAGRAPH-NAME                     
059200             MOVE 'DATA INTEGRITY CONTROL CARD IS MISSING'                
059300                                 TO AA-MESSAGE                            
059400             MOVE +4002          TO ABEND-CODE                            
059500             PERFORM 9900-COMMON-ABEND-ROUTINE                            
059600     END-READ.                                                            
059700                                                                          
059800 EJECT                                                                    
059900                                                                          
060000******************************************************************        
060100 4200-READ-DIFF-REPORT-FILE.                                              
060200******************************************************************        
060300*                                                                         
060400     READ DATA-INTEGRITY-DIFF-FILE                                        
060500       INTO ML212-DATA-INTEGRITY-DIFF-REC                                 
060600         AT END                                                           
060700             SET PS-NO-MORE-DIFF-RECS                                     
060800                                 TO TRUE                                  
060900     END-READ.                                                            
061000                                                                          
061100     IF PS-MORE-DIFF-RECS                                                 
061200         ADD 1                   TO PA-DIFF-RECORDS-READ                  
061300     END-IF.                                                              
061400                                                                          
061500 EJECT                                                                    
061600                                                                          
061700******************************************************************        
061800 6000-WRITE-REPORT-TITLE.                                                 
061900******************************************************************        
062000*                                                                         
062100     ADD 1                       TO PV-PAGE-COUNT.                        
062200     MOVE PV-PAGE-COUNT          TO DP150O-PAGE-NUMBER.                   
062300                                                                          
062400     WRITE DATA-INTEGRITY-REC FROM DP150O-STANDRD-HEADER-150-COLS         
062500         AFTER ADVANCING PAGE.                                            
062600                                                                          
062700     WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-2                      
062800         AFTER ADVANCING 1 LINE.                                          
062900                                                                          
063000     WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-3                      
063100         AFTER ADVANCING 1 LINE.                                          
063200                                                                          
063300     WRITE DATA-INTEGRITY-REC FROM HD-COLUMN-HEADING-1                    
063400         AFTER ADVANCING 2 LINES.                                         
063500                                                                          
063600     WRITE DATA-INTEGRITY-REC FROM HD-COLUMN-HEADING-2                    
063700         AFTER ADVANCING 1 LINE.                                          
063800                                                                          
063900     MOVE SPACES                 TO DATA-INTEGRITY-REC.                   
064000     WRITE DATA-INTEGRITY-REC                                             
064100         AFTER ADVANCING 1 LINE.                                          
064200                                                                          
064300     MOVE +7                     TO PV-LINE-COUNT.                        
064400                                                                          
064500 EJECT                                                                    
064600                                                                          
064700******************************************************************        
064800 6100-CREATE-REPORT.                                                      
064900******************************************************************        
065000*                                                                         
065100     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                                 
065200         PERFORM 6000-WRITE-REPORT-TITLE.                                 
065300                                                                          
065400     MOVE ML212-FSCL-MN-END-DTE  TO DL-FSCL-MN-END-DTE.                   
065500     MOVE ML212-FSCL-MN-NBR      TO DL-FSCL-MN-NBR.                       
065600     MOVE ML212-DEPT-NBR         TO DL-DEPT.                              
065700     MOVE ML212-MAJ-CL-NBR       TO DL-MCL.                               
065800     MOVE ML212-SUB-CL-NBR       TO DL-SCL.                               
065900     MOVE ML212-STR-NBR          TO DL-STORE.                             
065910     MOVE ML212-DKEY-NBR         TO DL-DKEY.                              
066000     MOVE ML212-LOW-TBL-AMT      TO DL-LOW-TBL-AMT.                       
066100     MOVE ML212-HIGH-TBL-AMT     TO DL-HIGH-TBL-AMT.                      
066200     COMPUTE PV-DIFFERENCE =                                              
066300         ML212-LOW-TBL-AMT - ML212-HIGH-TBL-AMT.                          
066400     MOVE PV-DIFFERENCE          TO DL-DIFFERENCE-AMT.                    
066500                                                                          
066600     SET ERR-IDX                 TO 1.                                    
066700     SEARCH TABLE-ERROR-ENTRIES                                           
066800         AT END                                                           
066900             MOVE 'NO ERROR MESSAGE'                                      
067000                                 TO DL-ERROR-MESSAGE                      
067100         WHEN TBL-ERR-NBR (ERR-IDX) = ML212-ERR-MSG-NBR                   
067200             MOVE TBL-ERR-MSG (ERR-IDX)                                   
067300                                 TO DL-ERROR-MESSAGE                      
067400             ADD +1              TO TBL-ERR-TOTAL (ERR-IDX)               
067500     END-SEARCH.                                                          
067600                                                                          
067700                                                                          
067800     WRITE DATA-INTEGRITY-REC FROM DL-LINE-1                              
067900         AFTER ADVANCING 1 LINE.                                          
068000     ADD 1                       TO PV-LINE-COUNT.                        
068100     ADD 1                       TO PA-REPORT-LINES-WRITTEN.              
068200                                                                          
068300 EJECT                                                                    
068400                                                                          
068500******************************************************************        
068600 8000-EOJ.                                                                
068700******************************************************************        
068800*                                                                         
068900     PERFORM 8100-WRITE-RPT-ERR-SUMMARY.                                  
069000*                                                                         
069100     WRITE DATA-INTEGRITY-REC FROM ER-END-OF-REPORT-LINE                  
069200         AFTER ADVANCING 3 LINES.                                         
069300*                                                                         
069400     PERFORM 8200-DISPLAY-RPT-ERR-SUMMARY.                                
069500                                                                          
069600     CLOSE COMPARE-TABLES-CTL-FILE.                                       
069700     CLOSE DATA-INTEGRITY-CTL-FILE.                                       
069800     CLOSE DATA-INTEGRITY-DIFF-FILE.                                      
069900     CLOSE DATA-INTEGRITY-REPORT.                                         
070000                                                                          
070100 EJECT                                                                    
070200                                                                          
070300******************************************************************        
070400 8100-WRITE-RPT-ERR-SUMMARY.                                              
070500******************************************************************        
070600*                                                                         
070700     ADD 1                       TO PV-PAGE-COUNT.                        
070800     MOVE PV-PAGE-COUNT          TO DP150O-PAGE-NUMBER.                   
070900                                                                          
071000     WRITE DATA-INTEGRITY-REC FROM DP150O-STANDRD-HEADER-150-COLS         
071100         AFTER ADVANCING PAGE.                                            
071200                                                                          
071300     WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-2                      
071400         AFTER ADVANCING 1 LINE.                                          
071500                                                                          
071600     WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-3                      
071700         AFTER ADVANCING 1 LINE.                                          
071800                                                                          
071900     WRITE DATA-INTEGRITY-REC FROM HD-COLUMN-HEADING-3                    
072000         AFTER ADVANCING 2 LINES.                                         
072100                                                                          
072200     MOVE SPACES                 TO DATA-INTEGRITY-REC.                   
072300     WRITE DATA-INTEGRITY-REC                                             
072400         AFTER ADVANCING 1 LINE.                                          
072500                                                                          
072600     PERFORM 8110-WRITE-ERR-COUNTS                                        
072700         VARYING ERR-IDX FROM 1 BY 1                                      
072800         UNTIL ERR-IDX GREATER THAN PC-ERR-IDX-MAX.                       
072900                                                                          
073000 EJECT                                                                    
073100                                                                          
073200******************************************************************        
073300 8110-WRITE-ERR-COUNTS.                                                   
073400******************************************************************        
073500*                                                                         
073600     MOVE TBL-ERR-MSG (ERR-IDX)  TO DL-ERR-DESC.                          
073700     MOVE TBL-ERR-TOTAL (ERR-IDX)                                         
073800                                 TO DL-ERR-COUNT.                         
073900                                                                          
074000     WRITE DATA-INTEGRITY-REC FROM DL-LINE-2                              
074100         AFTER ADVANCING 2 LINE.                                          
074200                                                                          
074300 EJECT                                                                    
074400                                                                          
074500******************************************************************        
074600 8200-DISPLAY-RPT-ERR-SUMMARY.                                            
074700******************************************************************        
074800*                                                                         
074900     DISPLAY ' '.                                                         
075000     DISPLAY '  PROGRAM MLKRP226 PROCESSING SUMMARY'.                     
075100     DISPLAY '  -----------------------------------'.                     
075200     DISPLAY ' '.                                                         
075300*                                                                         
075400     MOVE PA-DIFF-RECORDS-READ TO CD-COUNT-HOLD1.                         
075500     DISPLAY 'DIFFERENCE RECORDS READ = ' CD-COUNT-HOLD1.                 
075600*                                                                         
075700     MOVE PA-REPORT-LINES-WRITTEN TO CD-COUNT-HOLD1.                      
075800     DISPLAY 'REPORT RECORDS WRITTEN =  ' CD-COUNT-HOLD1.                 
075900*                                                                         
076000     DISPLAY ' '.                                                         
076100                                                                          
076200 EJECT                                                                    
076300                                                                          
076400******************************************************************        
076500 9900-COMMON-ABEND-ROUTINE.                                               
076600******************************************************************        
076700*                                                                         
076800     DISPLAY AA-ABEND-LIT.                                                
076900     DISPLAY AA-PROGRAM-LIT.                                              
077000     DISPLAY AA-PARAGRAPH-LIT.                                            
077100     DISPLAY AA-MESSAGE-LINE.                                             
077200     DISPLAY ABEND-CODE.                                                  
077300                                                                          
077400     CALL 'ILBOABN0' USING ABEND-CODE.                                    
077500                                                                          
