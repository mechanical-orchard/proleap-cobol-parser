      ******************************************************************        
      * CHECK IF ENTRY FOR THE DEPARTMENT IS IN LEGACY                 *        
      ******************************************************************        
       PO056-CHECK-ROLLOUT-CONTROL.                                             
                                                                                
            SET PO056-ENTRY-NOT-IN-LEGACY TO TRUE.                              
            MOVE 'PO056-CHECK-ROLLOUT-CONTROL' TO PO056-PARAGRAPH.              
                                                                                
            PERFORM WITH TEST AFTER                                             
             VARYING PO056-RETRY-COUNTER FROM 1 BY 1                            
               UNTIL PO056-RETRY-COUNTER > PO056-MAX-RETRIES                    
               OR    SQLCODE = ZERO                                             
               OR    SQLCODE = +100                                             
                                                                                
             EXEC SQL                                                           
                 SELECT PO_ENTR_IN_RMS_DTE                                      
                       ,CURRENT DATE                                            
                 INTO  :POT00006-PO-ENTR-IN-RMS-DTE                             
                      ,:PO056-CURRENT-DATE                                      
                 FROM  POT_RMS_RLOUT_CTL                                        
                 WHERE DEPT_NBR             = :PO056-DEPT-NBR                   
             END-EXEC                                                           
                                                                                
             EVALUATE TRUE                                                      
               WHEN SQLCODE = ZERO                                              
                 SET PO056-NO-ERRORS TO TRUE                                    
                 IF POT00006-PO-ENTR-IN-RMS-DTE > PO056-CURRENT-DATE            
                    SET PO056-ENTRY-IN-LEGACY TO TRUE                           
                 END-IF                                                         
               WHEN SQLCODE = -904                                              
               WHEN SQLCODE = -913                                              
                 CONTINUE                                                       
               WHEN SQLCODE = +100                                              
                 SET PO056-ERRORS-FOUND TO TRUE                                 
                 MOVE SQLCODE            TO PO056-SQLCODE                       
                 MOVE 'POT_RMS_RLOUT_CTL ' TO PO056-DB2-TABLE-NAME              
                 MOVE 'DEPARTMENT NOT FOUND ON ROLLOUT CONTROL TABLE'           
                   TO PO056-MESSAGE-TEXT                                        
               WHEN SQLWARN0 NOT = SPACE                                        
               WHEN SQLCODE NOT = ZERO                                          
                 SET  PO056-ERRORS-FOUND TO TRUE                                
                 MOVE SQLCODE            TO PO056-SQLCODE                       
                 MOVE 'UNSUCCESSFUL EXISTS POT_RMS_RLOUT_CTL'                   
                                        TO PO056-MESSAGE-TEXT                   
             END-EVALUATE                                                       
           END-PERFORM.                                                         
                                                                                
           IF PO056-RETRY-COUNTER > PO056-MAX-RETRIES                           
             SET  PO056-ERRORS-FOUND TO TRUE                                    
             MOVE SQLCODE         TO PO056-SQLCODE                              
             MOVE 'MAX RETRIES EXCEEDED EXISTS POT_RMS_RLOUT_CTL'               
                                    TO PO056-MESSAGE-TEXT                       
             MOVE 'POT_RMS_RLOUT_CTL ' TO PO056-DB2-TABLE-NAME                  
           END-IF.                                                              
