000100******************************************************************00010025
000200 IDENTIFICATION DIVISION.                                         00020025
000300******************************************************************00030025
000400                                                                  00040025
000500 PROGRAM-ID.                APKCS335.                             00050025
000600 AUTHOR.                    KOHLS.                                00060025
000700 INSTALLATION.              KOHLS DEPARTMENT STORES.              00070025
000800 DATE-WRITTEN.              05-16-93.                             00080025
000900 DATE-COMPILED.                                                   00090025
001000                                                                  00100025
001100******************************************************************00110025
001200*  CICS PROGRAM - APKCS335 - A335                                *00120025
001300*                                                                *00130025
001400*  ACCOUNTS PAYABLE SYSTEM - AP CONTROL UPDATE                   *00140025
001500*                                                                *00150025
001600*  THIS PROGRAM IS USED TO ENTER UPDATES TO VARIOUS AP CONTROL   R00160032
001700*  COLUMNS ON THE TAPCNTL TABLE.                                 *00170025
001800*                                                                *00180025
001900*      REQUEST                      ACTION                       *00190025
002000*      -------  -----------------------------------------------  *00200025
002100*      CHANGE   THE AP CONTROL TABLE IS UPDATED AND LOGGED       *00210025
002200*               IN THE VSAM MAINTENANCE LOG FILE ?               *00220025
002300*               UPDATES WILL BE LOGGED WITH BEFORE AND AFTER     *00230025
002400*               IMAGES OF CHANGED COLUMNS.                       *00240025
002500*                                                                *00250025
002600*  AFTER THE UPDATE IS COMPLETED, SUCCESSFULLY OR NOT,           *00260025
002700*  CONTROL IS RETURNED TO THE PROGRAM THAT CALLED THIS PROGRAM.  *00270025
002800*                                                                *00280025
002900*  IF ANY SYSTEM OR DB2 ERRORS ARE DETECTED THAT THE             *00290025
003000*  PROGRAM CAN'T RESOLVE, THE MERCHANDISING SYSTEM WILL BE       *00300025
003100*  TERMINATED.  THE CURRENT ACTION WILL BE ABORTED, AN ERROR     *00310025
003200*  MESSAGE WILL BE FORMATTED AND DISPLAYED ON THE SCREEN, AND    *00320025
003300*  PROGRAM CONTROL WILL BE RETURNED TO NATIVE CICS.              *00330025
003400*                                                                *00340025
003500*  DIRECT ENTRY INTO THIS TRANSACTION IS PROHIBITED.             *00350025
003600******************************************************************00360025
003700* CHANGE LOG:                                                    *00370025
003800*                                                                *00380025
003900* 08/08/95   ADDED PROCESSING FOR NEW FIELD ON TAPCNTL,          *00390025
004000* MKK        COST_CNTL_PCT.                                      *00400025
004100*                                                                *00410025
004200* 11/15/95   CHANGED TO CALL DPKCS030 STATICALLY RATHER THAN     *00420025
004300* MKK        DYNAMICALLY.  (CHANGED CALL TO USE A LITERAL        *00430025
004400*            STEAD OF A VARIABLE.)                               *00440025
004500*                                                                *00450025
004600* 06/10/96   ADDED PROCESSING FOR NEW FIELDS ON TAPCNTL,         *00460025
004700* DSW        EXC_FLT_DAY_QTY AND RCVG_VARN_DAY_QTY               *00470025
004800*                                                                *00480025
004900* 01/28/97                                                        00490025
005000*        ADDED NEW FIELD, 'WRITE OFF DAYS FOR UN-JOURNALIZED      00500025
005100*        CHANGED HEADINGS TO 'DOLLAR LIMIT FOR MATCHED            00510025
005200*        REPORTING'                                               00520025
005300*       -DELETED CM-CHANGE-MESSAGE-LOG-AREA - WAS FOR OLD LOG     00530025
005400*       -DELETED TAPCNTL CURSOR SINCE THERE IS ONLY 1 ROW         00540025
005500*       -CHG LOGIC 1200-SELECT-AP-CNTL-INFO                       00550025
005600*       -EDIT NEW FIELDS IN 2200-MOVE-SCREEN-TO-COMMAREA          00560025
005700*       -INCL NEW FIELDS IN 3200-RESET-ATTRIBUTES                 00570025
005800*       -ADD MOVE OF NEW FIELDS IN 4010-MOVE-COMMAREA-TO-SCREEN   00580025
005900*       -CHG LOGIC IN 5100-PERFROM-AP-CNTL-UDPATE                 00590025
006000*        MADE BY: MARILYN WILKINSON       WR/IR #: WR3803         00600025
006100*                                                                *00610025
006200*  8/25/97                                                        00620025
006300*       -REARRANGED MAP TO ALLOW FOR NEW FIELDS.                  00630025
006400*        CHANGED HEADINGS TO BETTER DESCRIBE DATA.                00640025
006500*        ADDED 2 NEW FIELDS FOR IMPORT PO PROCESS                 00650025
006600*       -ADDED WORKING STORAGE FIELDS IN CA-PROGRAM-COMMAREA      00660025
006700*        AND CA-APCNTL-BEFORE.                                    00670025
006800*       -MODIFIED MULTIPLE PARAGRAPHS WITH NEW FIELD LOGIC.       00680025
006900* MADE BY: CHRIS KUNSTMANN         WR/IR #: WR4164                00690025
007000*  3/11/07                                                        00700027
007100*       -MBDC PROJECT                                             00710027
007200*       -MODIFIED MULTIPLE PARAGRAPHS WITH NEW FIELD LOGIC.       00720027
007300* MADE BY: GREG WISIALOWSKI        WR/IR #: WR21578               00730027
007400*                                                                 00740042
007500* DATE  03/19/2008                                                00750042
007600*     CHANGE MADE: PRIVATE LABEL LOAD GIVEBACK PROJECT            00760042
007700*     ADDED 4 NEW SCREEN FIELDS RELATED TO THE GIVEBACK PROJECT.  00770042
007800*     THE ONLINE MAP WAS SIGNIFICANTLY RESTRUCTURED TO MAKE ROOM  00780042
007900*     FOR THE NEW FIELDS: PRVT_LBL_GBCK_AMT, PRVT_LBL_GBCK_PCT,   00790042
008000*     LI_FUNG_GBCK_AMT, LI_FUNG_GBCK_PCT FROM TAPCNTL.            00800042
008100*     MADE BY: MIKE BESKE              WR/IR #: WR34309           00810042
008200*                                                                 00820042
008210* DATE  09/01/2021                                                00821043
008220*            - CHANGE CALL OF DPKUT100 TO                       * 00822044
008230*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00823043
008240*              MAKING THE CALL DYNAMIC VS STATIC                * 00824043
008250*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        00825045
008251*                                                                 00825147
008252* DATE  10/24/2022                                              * 00825248
008253*     ADD COPYBOOK DPWS930                                      * 00825348
008254*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API  * 00825448
008255*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864      * 00825548
008300******************************************************************00830042
008400                                                                  00840042
008500******************************************************************00850042
008600 ENVIRONMENT DIVISION.                                            00860042
008700******************************************************************00870042
008800                                                                  00880042
008900******************************************************************00890042
009000 DATA DIVISION.                                                   00900042
009100******************************************************************00910042
009200                                                                  00920042
009300 WORKING-STORAGE SECTION.                                         00930042
009400                                                                  00940042
009500 01  PC-TSYMSG-AREA.                                              00950042
009600     05  PC-TSYMSG-00005          PIC 9(5) VALUE 00005.           00960042
009700     05  PC-TSYMSG-00008          PIC 9(5) VALUE 00008.           00970042
009800     05  PC-TSYMSG-00046          PIC 9(5) VALUE 00046.           00980042
009900     05  PC-TSYMSG-00059          PIC 9(5) VALUE 00059.           00990042
010000     05  PC-TSYMSG-00148          PIC 9(5) VALUE 00148.           01000042
010100     05  PC-TSYMSG-03612          PIC 9(5) VALUE 03612.           01010042
010200     05  PC-TSYMSG-03613          PIC 9(5) VALUE 03613.           01020042
010300     05  PC-TSYMSG-03614          PIC 9(5) VALUE 03614.           01030042
010400     05  PC-TSYMSG-03615          PIC 9(5) VALUE 03615.           01040042
010500*                                                                 01050042
010600*  STANDARD ATTENTION IDENTIFIER LIST                             01060042
010700*                                                                 01070042
010800     COPY DFHAID.                                                 01080042
010900                                                                  01090042
011000*                                                                 01100042
011100*  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          01110042
011200*                                                                 01120042
011300     COPY DFHBMSCA.                                               01130042
011400                                                                  01140042
011500*                                                                 01150042
011600*  DSECT FOR THE APKM335 MAPSET                                   01160042
011700*                                                                 01170042
011800     COPY APKM335.                                                01180042
011900*                                                                 01190042
012000                                                                  01200042
012100 01  PS-PROGRAM-SWITCHES.                                         01210042
012200     05  PS-EDIT-ERROR-SW            PIC X(1)      VALUE 'N'.     01220042
012300         88  PS-NO-EDIT-ERROR                      VALUE 'N'.     01230042
012400         88  PS-EDIT-ERROR                         VALUE 'Y'.     01240042
012500                                                                  01250042
012600     05  PS-CHANGES-IND              PIC X(1)      VALUE 'N'.     01260042
012700         88  PS-CHANGE-MADE                        VALUE 'Y'.     01270042
012800         88  PS-NO-CHANGES-MADE                    VALUE 'N'.     01280042
012900                                                                  01290042
013000 01  PC-PROGRAM-CONSTANTS.                                        01300042
013100     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'APKCS335'.   01310042
013200     05  PC-CURRENT-TRANSID      PIC X(8)     VALUE 'A335'.       01320042
013300     05  PC-CURRENT-MAPSET-NAME  PIC X(08)    VALUE 'APKM335'.    01330042
013400     05  PC-CURRENT-MAP-NAME     PIC X(08)    VALUE 'AP335A'.     01340042
013500     05  PC-DPKCS030             PIC X(8)     VALUE 'DPKCS030'.   01350042
013600     05  PC-APPL-MAP             PIC S9(04)   VALUE +1            01360042
013700                                              COMP.               01370042
013800     05  PC-MAXIMUM-RETRY-COUNT  PIC S9(4)    VALUE +2            01380042
013900                                 COMP SYNC.                       01390042
014000                                                                  01400042
014100 01  PV-PROGRAM-VARIABLES.                                        01410042
014200     05  PV-CICS-RESPONSE        PIC S9(9)    VALUE ZERO          01420042
014300                                 COMP SYNC.                       01430042
014400     05  PV-RETRY-COUNT          PIC S9(4)    VALUE ZERO          01440042
014500                                 COMP SYNC.                       01450042
014600     05  PV-CURRENT-DATE         PIC 9(6)     VALUE ZERO.         01460042
014700     05  FILLER REDEFINES PV-CURRENT-DATE.                        01470042
014800         10  PV-CURRENT-YEAR     PIC 9(2).                        01480042
014900         10  PV-CURRENT-MONTH    PIC 9(2).                        01490042
015000         10  PV-CURRENT-DAY      PIC 9(2).                        01500042
015100     05  PV-CURRENT-TIME         PIC 9(6)     VALUE ZERO.         01510042
015200     05  PV-RBA                  PIC S9(9)    VALUE ZERO          01520042
015300                                 COMP SYNC.                       01530042
015400                                                                  01540042
015500 01  RF-ROLLBACK-FAILURE-MESSAGE.                                 01550042
015600     05  FILLER                  PIC X(5)     VALUE SPACES.       01560042
015700     05  FILLER                  PIC X(61)    VALUE               01570042
015800         '**  THE ATTEMPTED ROLLBACK FAILED  **'.                 01580042
015900     05  FILLER                  PIC X(10)    VALUE 'EIBRESP = '. 01590042
016000     05  RF-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         01600042
016100                                                                  01610042
016200 01  ST-SYSTEM-TIME-AREA.                                         01620042
016300     05  ST-ABSTIME              PIC S9(18)   VALUE ZERO          01630042
016400                                 COMP SYNC.                       01640042
016500     05  ST-TIME-EDIT.                                            01650042
016600         10  ST-TIME-HHMM        PIC X(5)     VALUE SPACES.       01660042
016700         10  FILLER              PIC X(3)     VALUE SPACES.       01670042
016800                                                                  01680042
016900**--------------------------------------------------------------**01690042
017000** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01700042
017100** SUB-ROUTINE (DPKUT100).                                      **01710043
017200**--------------------------------------------------------------**01720042
017300     COPY DPWS010I.                                               01730042
017400                                                                  01740042
017500**--------------------------------------------------------------**01750042
017600**   COMMON ABEND MODULE WORKING STORAGE FIELDS                   01760042
017700**--------------------------------------------------------------**01770042
017800                                                                  01780042
017900     COPY DPWS013.                                                01790042
018000                                                                  01800042
018100**--------------------------------------------------------------**01810042
018200**   CICS (BMS) STANDARD ATTRIBUTES                               01820042
018300**--------------------------------------------------------------**01830042
018400                                                                  01840042
018500     COPY DPWS015.                                                01850042
018600                                                                  01860042
018700**--------------------------------------------------------------**01870042
018800**   CICS STANDARD PF-KEYS                                        01880042
018900**--------------------------------------------------------------**01890042
019000                                                                  01900042
019100     COPY DPWS016.                                                01910042
019200                                                                  01920042
019300**--------------------------------------------------------------**01930042
019400**   CALLING PARMS USED TO COMMUNCATE TO THE CICS ARCHITCTURE     01940042
019500**--------------------------------------------------------------**01950042
019600                                                                  01960042
019700     COPY DPWS030.                                                01970042
019710     COPY DPWS930.                                                01971048
019800                                                                  01980042
019900**--------------------------------------**                        01990042
020000**   KOHL'S STANDARD COMMAREA           **                        02000042
020100**--------------------------------------**                        02010042
020200                                                                  02020042
020300     COPY DPWS020.                                                02030042
020400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02040042
020500                                                                  02050042
020600**--------------------------------------**                        02060042
020700**   INTER-APPLICATION COMMAREA         **                        02070042
020800**--------------------------------------**                        02080042
020900         10  INTER-APPL-COMM-AREA PIC X(200).                     02090042
021000     COPY APWS300.                                                02100042
021100                                                                  02110042
021200**--------------------------------------**                        02120042
021300**   SPECIFIC COMMAREA FOR APKCS335     **                        02130042
021400**--------------------------------------**                        02140042
021500                                                                  02150042
021600         10  CA-PROGRAM-COMMAREA.                                 02160042
021700             15  CA-BTCH-PRC-DTE PIC X(26).                       02170042
021800             15  CA-PCT-OF-DOLLAR-VARIANCE                        02180042
021900                                 PIC X(6).                        02190042
022000             15  CA-PCT-OF-DOLLAR-VARIANCE-N                      02200042
022100                                 PIC 9(3)V99.                     02210042
022200             15  CA-DOLLAR-LIMIT-VARIANCE                         02220042
022300                                 PIC X(07).                       02230042
022400             15  CA-DOLLAR-LIMIT-VARIANCE-N                       02240042
022500                                 PIC 9(4)V99.                     02250042
022600             15  CA-RECON-CUTOFF-DAYS                             02260042
022700                                 PIC X(4).                        02270042
022800             15  CA-RECON-CUTOFF-DAYS-N                           02280042
022900                                 PIC 9(4).                        02290042
023000             15  CA-PMT-FLOAT-DAYS                                02300042
023100                                 PIC X(4).                        02310042
023200             15  CA-PMT-FLOAT-DAYS-N                              02320042
023300                                 PIC 9(4).                        02330042
023400             15  CA-EXC-FLT-DAY-QTY                               02340042
023500                                 PIC X(4).                        02350042
023600             15  CA-EXC-FLT-DAY-QTY-N                             02360042
023700                                 PIC 9(4).                        02370042
023800             15  CA-RCVG-VARN-DAY-QTY                             02380042
023900                                 PIC X(4).                        02390042
024000             15  CA-RCVG-VARN-DAY-QTY-N                           02400042
024100                                 PIC 9(4).                        02410042
024200             15  CA-FIRST-RCPT-DAY-QTY                            02420042
024300                                 PIC X(4).                        02430042
024400             15  CA-FIRST-RCPT-DAY-QTY-N                          02440042
024500                                 PIC 9(4).                        02450042
024600             15  CA-FIRST-PAID-DAY-QTY                            02460042
024700                                 PIC X(4).                        02470042
024800             15  CA-FIRST-PAID-DAY-QTY-N                          02480042
024900                                 PIC 9(4).                        02490042
025000             15  CA-UNJRNL-WO-DAY-QTY                             02500042
025100                                 PIC X(4).                        02510042
025200             15  CA-UNJRNL-WO-DAY-QTY-N                           02520042
025300                                 PIC 9(4).                        02530042
025400             15  CA-VENDOR-CHG-LIMIT                              02540042
025500                                 PIC X(4).                        02550042
025600             15  CA-VENDOR-CHG-LIMIT-N                            02560042
025700                                 PIC 9(4).                        02570042
025800             15  CA-COST-CNTL-PCT                                 02580042
025900                                 PIC X(6).                        02590042
026000             15  CA-COST-CNTL-PCT-N                               02600042
026100                                 PIC 9(3)V99.                     02610042
026200             15  CA-PRVT-LBL-GBCK-AMT                             02620042
026300                                 PIC X(14).                       02630042
026400             15  CA-PRVT-LBL-GBCK-AMT-N                           02640042
026500                                 PIC S9(10)V99.                   02650042
026600             15  CA-PRVT-LBL-GBCK-PCT                             02660042
026700                                 PIC X(6).                        02670042
026800             15  CA-PRVT-LBL-GBCK-PCT-N                           02680042
026900                                 PIC 9(3)V99.                     02690042
027000             15  CA-LI-FUNG-GBCK-AMT                              02700042
027100                                 PIC X(14).                       02710042
027200             15  CA-LI-FUNG-GBCK-AMT-N                            02720042
027300                                 PIC S9(10)V99.                   02730042
027400             15  CA-LI-FUNG-GBCK-PCT                              02740042
027500                                 PIC X(6).                        02750042
027600             15  CA-LI-FUNG-GBCK-PCT-N                            02760042
027700                                 PIC 9(3)V99.                     02770042
027800                                                                  02780042
027900                                                                  02790042
028000**   FOR UPDATES THIS REPRESENTS THE 'BEFORE' SNAPSHOT OF THE     02800042
028100**   A/P CONTROL TABLE.                                           02810042
028200                                                                  02820042
028300*        10  CA-APCNTL-BEFORE.                                    02830042
028400             15  CA-APB-PCT-OF-DOLLAR-VARIANCE                    02840042
028500                                 PIC S9(3)V99  COMP-3.            02850042
028600             15  CA-APB-DOLLAR-LIMIT-VARIANCE                     02860042
028700                                 PIC S9(4)V99  COMP-3.            02870042
028800             15  CA-APB-RECON-CUTOFF-DAYS                         02880042
028900                                 PIC S9(4)     COMP.              02890042
029000             15  CA-APB-PMT-FLOAT-DAYS                            02900042
029100                                 PIC S9(4)     COMP.              02910042
029200             15  CA-APB-EXC-FLT-DAY-QTY                           02920042
029300                                 PIC S9(4)     COMP.              02930042
029400             15  CA-APB-RCVG-VARN-DAY-QTY                         02940042
029500                                 PIC S9(4)     COMP.              02950042
029600             15  CA-APB-FIRST-RCPT-DAY-QTY                        02960042
029700                                 PIC S9(4)     COMP.              02970042
029800             15  CA-APB-FIRST-PAID-DAY-QTY                        02980042
029900                                 PIC S9(4)     COMP.              02990042
030000             15  CA-APB-UNJRNL-WO-DAY-QTY                         03000042
030100                                 PIC S9(4)     COMP.              03010042
030200             15  CA-APB-VENDOR-CHG-LIMIT                          03020042
030300                                 PIC S9(4)     COMP.              03030042
030400             15  CA-APB-COST-CNTL-PCT                             03040042
030500                                 PIC S9(3)V99  COMP-3.            03050042
030600             15  CA-APB-PRVT-LBL-GBCK-AMT                         03060042
030700                                 PIC S9(10)V99 COMP-3.            03070042
030800             15  CA-APB-PRVT-LBL-GBCK-PCT                         03080042
030900                                 PIC S9(3)V99  COMP-3.            03090042
031000             15  CA-APB-LI-FUNG-GBCK-AMT                          03100042
031100                                 PIC S9(10)V99 COMP-3.            03110042
031200             15  CA-APB-LI-FUNG-GBCK-PCT                          03120042
031300                                 PIC S9(3)V99  COMP-3.            03130042
031400                                                                  03140042
031500******************************************************************03150042
031600*  SQL AND COBOL DECLARATIONS FOR THE A/P CONTROL TABLE (TAPCNTL) 03160042
031700******************************************************************03170042
031800     EXEC SQL                                                     03180042
031900          INCLUDE TAPCNTL                                         03190042
032000     END-EXEC.                                                    03200042
032100                                                                  03210042
032200******************************************************************03220042
032300*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                03230042
032400******************************************************************03240042
032500     EXEC SQL                                                     03250042
032600          INCLUDE SQLCA                                           03260042
032700     END-EXEC.                                                    03270042
032800                                                                  03280042
032900******************************************************************03290042
033000 LINKAGE SECTION.                                                 03300042
033100******************************************************************03310042
033200                                                                  03320042
033300 01  DFHCOMMAREA.                                                 03330042
033400     05  FILLER                         OCCURS  1 TO 4072 TIMES   03340042
033500                                        DEPENDING ON EIBCALEN.    03350042
033600         10  FILLER                     PIC X.                    03360042
033700                                                                  03370042
033800******************************************************************03380042
033900 PROCEDURE DIVISION.                                              03390042
034000******************************************************************03400042
034100*                                                                 03410042
034200 0000-MAINLINE.                                                   03420042
034300     MOVE '*0000-MAINLINE.                  *' TO DP013-PARAGRAPH.03430042
034400*                                                                 03440042
034500     INITIALIZE DP030-CICS-API-FIELDS.                            03450042
034600     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        03460042
034700     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           03470042
034800     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          03480042
034900     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        03490042
035000     MOVE LENGTH OF AP335AI       TO DP030-MAP-LENGTH (1).        03500042
035100     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      03510042
035200     PERFORM 0001-CALL-CICS-ARCH-API.                             03520042
035300*                                                                 03530042
035400     PERFORM 1000-CONTROL-PROCESSING.                             03540042
035500*                                                                 03550042
035600     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      03560042
035700     PERFORM 0001-CALL-CICS-ARCH-API.                             03570042
035800*                                                                 03580042
035900     GOBACK.                                                      03590042
036000*                                                                 03600042
036100     EJECT                                                        03610042
036200*----------------------------------------------------------------*03620042
036300*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *03630042
036400*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *03640042
036500*----------------------------------------------------------------*03650042
036600*                                                                 03660042
036700 0001-CALL-CICS-ARCH-API.                                         03670042
036800*                                                                 03680042
036900     MOVE '*0001-CALL-CICS-ARCH-API.        *' TO DP013-PARAGRAPH.03690042
037000*                                                                 03700042
037100     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     03710047
037200                                     DFHCOMMAREA                  03720047
037300                                     DP030-CICS-API-FIELDS        03730047
037400                                     DP020-STANDARD-COMMAREA      03740047
037500                                     AP335AI.                     03750047
037600*                                                                 03760042
037700     IF  DP030-RC-CALL-SUCCESSFUL                                 03770042
037800         CONTINUE                                                 03780042
037900     ELSE                                                         03790042
038000         SET DP013-NO-ROLLBACK                                    03800042
038100             DP013-XCTL-DISPLAY-RESTART                           03810042
038200             DP013-CICS-ABEND TO TRUE                             03820042
038300         MOVE 'BEFORE 0000-MAIN-MODULE'                           03830042
038400                                   TO DP013-PARAGRAPH             03840042
038500         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03850048
038600-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03860048
038700         MOVE DP030-RETURN-CODE                                   03870048
038800                               TO DP013-MESSAGE-TEXT (3)          03880042
038900         PERFORM DP013-0000-PROCESS-ABEND                         03890042
039000     END-IF.                                                      03900042
039100                                                                  03910042
039200*----------------------------------------------------------------*03920042
039300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03930042
039400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03940042
039500*----------------------------------------------------------------*03950042
039600                                                                  03960042
039700 1000-CONTROL-PROCESSING.                                         03970042
039800     MOVE '*1000-CONTROL-PROCESSING.        *' TO DP013-PARAGRAPH.03980042
039900                                                                  03990042
040000     EVALUATE TRUE                                                04000042
040100         WHEN DP020-NEXT-ACT-INITIAL                              04010042
040200             SET DP030-SET-CURSOR-APPL-1  TO  TRUE                04020042
040300             PERFORM 1100-INITIALIZATIONS                         04030042
040400              IF  PS-EDIT-ERROR                                   04040042
040500                  CONTINUE                                        04050042
040600              ELSE                                                04060042
040700                  PERFORM 4000-BUILD-INITIAL-SCREEN               04070042
040800              END-IF                                              04080042
040900                                                                  04090042
041000         WHEN DP020-NEXT-ACT-READ-MAP                             04100042
041100             PERFORM 2000-PROCESS-MAP                             04110042
041200                                                                  04120042
041300         WHEN DP020-NEXT-ACT-RETURN                               04130042
041400             CONTINUE                                             04140042
041500                                                                  04150042
041600         WHEN OTHER                                               04160042
041700             SET DP013-LOGIC-ABEND                                04170042
041800                 DP013-NO-ROLLBACK TO TRUE                        04180042
041900             MOVE '1000-CONTROL-PROCESSING'                       04190042
042000                                   TO  DP013-PARAGRAPH            04200042
042100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04210042
042200                                   TO  DP013-MESSAGE-TEXT(1)      04220042
042300             MOVE DP020-NEXT-APPL-ACTIVITY                        04230042
042400                                   TO DP013-MESSAGE-TEXT(2)       04240042
042500             PERFORM DP013-0000-PROCESS-ABEND                     04250042
042600     END-EVALUATE.                                                04260042
042700     EJECT                                                        04270042
042800******************************************************************04280042
042900*    INITIALIZE THE PROGRAM SPECIFIC COMMAREA, THE INPUT MAP,    *04290042
043000*    AND RETRIEVE THE A/P CONTROL TABLE FIELDS.                  *04300042
043100******************************************************************04310042
043200                                                                  04320042
043300 1100-INITIALIZATIONS.                                            04330042
043400     MOVE '*1100-INITIALIZATIONS.           *' TO DP013-PARAGRAPH.04340042
043500                                                                  04350042
043600     INITIALIZE CA-PROGRAM-COMMAREA.                              04360042
043700                                                                  04370042
043800     MOVE LOW-VALUES TO AP335AI.                                  04380042
043900                                                                  04390042
044000     MOVE SPACES        TO DP020-NAV-KEY-DATA.                    04400042
044100                                                                  04410042
044200     PERFORM 6000-GET-DATE.                                       04420042
044300                                                                  04430042
044400     SET PS-NO-EDIT-ERROR TO TRUE.                                04440042
044500                                                                  04450042
044600*****************************************************             04460042
044700*** THE A/P CONTROL TABLE WILL BE CALLED TO FILL   **             04470042
044800*** IN THE FOLLOWING COMMAREA FILEDS:              **             04480042
044900***    CA-PCT-OF-DOLLAR-VARIANCE,                  **             04490042
045000***    CA-DOLLAR-LIMIT-VARIANCE,                   **             04500042
045100***    CA-RECON-CUTOFF-DAYS,                       **             04510042
045200***    CA-PMT-FLOAT-DAYS,                          **             04520042
045300***    CA-FIRST-RCPT-DAY-QTY-N                     **             04530042
045400***    CA-FIRST-PAID-DAY-QTY-N                     **             04540042
045500***    CA-UNJRNL-WO-DAY-QTY,                       **             04550042
045600***    CA-VENDOR-CHG-LIMIT AND                     **             04560042
045700***    CA-COST-CNTL-PCT.                           **             04570042
045800*****************************************************             04580042
045900     PERFORM 7000-READ-AP-CNTL-TABLE.                             04590042
046000                                                                  04600042
046100     PERFORM 3200-RESET-ATTRIBUTES.                               04610042
046200                                                                  04620042
046300     EJECT                                                        04630042
046400*****************************************************             04640042
046500***  THIS CONTROL MODULE WILL HANDLE THE MAP       **             04650042
046600***  PROCESSING FOR THIS PROGRAM.                  **             04660042
046700*****************************************************             04670042
046800                                                                  04680042
046900 2000-PROCESS-MAP.                                                04690042
047000     MOVE '*2000-PROCESS-MAP.               *' TO DP013-PARAGRAPH.04700042
047100                                                                  04710042
047200     SET PS-NO-EDIT-ERROR TO TRUE.                                04720042
047300                                                                  04730042
047400     EVALUATE TRUE                                                04740042
047500                                                                  04750042
047600         WHEN DP020-SRC-AID = DP016-CLEAR                         04760042
047700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04770042
047800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04780042
047900                                                                  04790042
048000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04800042
048100             SET DP030-DONT-ERASE                                 04810042
048200                 DP030-SEND-DATAONLY (PC-APPL-MAP)                04820042
048300                                   TO TRUE                        04830042
048400             PERFORM 1100-INITIALIZATIONS                         04840042
048500             PERFORM 4000-BUILD-INITIAL-SCREEN                    04850042
048600             PERFORM 3200-RESET-ATTRIBUTES                        04860042
048700                                                                  04870042
048800         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 04880042
048900             CONTINUE                                             04890042
049000                                                                  04900042
049100         WHEN OTHER                                               04910042
049200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04920042
049300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04930042
049400             IF  PS-NO-EDIT-ERROR                                 04940042
049500                 SET DP030-CONTINUE-GO                            04950042
049600                                   TO TRUE                        04960042
049700                 PERFORM 2100-CHECK-FUNCTION-KEY                  04970042
049800             ELSE                                                 04980042
049900                 SET DP030-OVERRIDE-GO                            04990042
050000                                   TO TRUE                        05000042
050100             END-IF                                               05010042
050200     END-EVALUATE.                                                05020042
050300                                                                  05030042
050400     IF PS-EDIT-ERROR                                             05040042
050500         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     05050042
050600         SET DP020-MSG-FATAL          TO TRUE                     05060042
050700     ELSE                                                         05070042
050800         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     05080042
050900*        MOVE -1                      TO APCTVRL                  05090042
051000         MOVE -1                      TO APLAMTL                  05100042
051100     END-IF.                                                      05110042
051200                                                                  05120042
051300     EJECT                                                        05130042
051400*----------------------------------------------------------------*05140042
051500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *05150042
051600* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *05160042
051700* FROM THE CICS ARCHITECTURE API.                                *05170042
051800*----------------------------------------------------------------*05180042
051900                                                                  05190042
052000 2100-CHECK-FUNCTION-KEY.                                         05200042
052100     MOVE '*2100-CHECK-FUNCTION-KEY.        *' TO DP013-PARAGRAPH.05210042
052200                                                                  05220042
052300     EVALUATE TRUE                                                05230042
052400         WHEN DP020-SRC-AID = DP016-ENTER                         05240042
052500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05250042
052600                                                                  05260042
052700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05270042
052800             SET DP030-CONTINUE-GO TO TRUE                        05280042
052900             PERFORM 5000-PROCESS-APCNTL-UPDATE                   05290042
053000                                                                  05300042
053100         WHEN OTHER                                               05310042
053200             SET DP013-NO-ROLLBACK                                05320042
053300                 DP013-XCTL-DISPLAY-RESTART                       05330042
053400                 DP013-CICS-ABEND  TO TRUE                        05340042
053500             MOVE '2000-PROCESS-MAP  '                            05350042
053600                                   TO DP013-PARAGRAPH             05360042
053700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      05370042
053800                                   TO DP013-MESSAGE-TEXT (1)      05380042
053900             PERFORM DP013-0000-PROCESS-ABEND                     05390042
054000     END-EVALUATE.                                                05400042
054100                                                                  05410042
054200******************************************************************05420042
054300*  RECEIVE SCREEN FIELDS, AND MOVE THEM TO THE COMMON AREA.      *05430042
054400*  A FIELD LENGTH GREATER THAN ZERO INDICATES INFORMATION WAS    *05440042
054500*  ENTERED, AND A FIELD ATTRIBUTE OF HEX '80' INDICATES THAT     *05450042
054600*  EOF WAS KEYED, AND THE DEFAULT VALUE HAS TO BE MOVED TO THE   *05460042
054700*  COMMON AREA.                                                  *05470042
054800******************************************************************05480042
054900                                                                  05490042
055000 2200-MOVE-SCREEN-TO-COMMAREA.                                    05500042
055100     MOVE '*2200-MOVE-SCREEN-TO-COMMAREA.   *' TO DP013-PARAGRAPH.05510042
055200                                                                  05520042
055300     IF  APCTVRL > ZERO                                           05530042
055400         MOVE APCTVRI           TO CA-PCT-OF-DOLLAR-VARIANCE      05540042
055500     ELSE                                                         05550042
055600         IF  APCTVRA = DP015-ERASE-EOF                            05560042
055700             MOVE SPACES        TO CA-PCT-OF-DOLLAR-VARIANCE      05570042
055800             MOVE ZEROS         TO CA-PCT-OF-DOLLAR-VARIANCE-N    05580042
055900         END-IF                                                   05590042
056000     END-IF.                                                      05600042
056100***                                                               05610042
056200     IF  ADLRVRL > ZERO                                           05620042
056300         MOVE ADLRVRI                TO CA-DOLLAR-LIMIT-VARIANCE  05630042
056400     ELSE                                                         05640042
056500         IF  ADLRVRA = DP015-ERASE-EOF                            05650042
056600             MOVE SPACES             TO CA-DOLLAR-LIMIT-VARIANCE  05660042
056700             MOVE ZEROS              TO CA-DOLLAR-LIMIT-VARIANCE-N05670042
056800         END-IF                                                   05680042
056900     END-IF.                                                      05690042
057000***                                                               05700042
057100     IF  ARECUTL >  ZERO                                          05710042
057200         MOVE ARECUTI                TO CA-RECON-CUTOFF-DAYS      05720042
057300     ELSE                                                         05730042
057400         IF  ARECUTA =  DP015-ERASE-EOF                           05740042
057500             MOVE SPACES             TO CA-RECON-CUTOFF-DAYS      05750042
057600             MOVE ZEROS              TO CA-RECON-CUTOFF-DAYS-N    05760042
057700         END-IF                                                   05770042
057800     END-IF.                                                      05780042
057900***                                                               05790042
058000     IF  APAYFLL > ZERO                                           05800042
058100         MOVE APAYFLI                TO CA-PMT-FLOAT-DAYS         05810042
058200     ELSE                                                         05820042
058300         IF  APAYFLA = DP015-ERASE-EOF                            05830042
058400             MOVE SPACES             TO CA-PMT-FLOAT-DAYS         05840042
058500             MOVE ZEROS              TO CA-PMT-FLOAT-DAYS-N       05850042
058600         END-IF                                                   05860042
058700     END-IF.                                                      05870042
058800***                                                               05880042
058900     IF  AEXCFLL >  ZERO                                          05890042
059000         MOVE AEXCFLI                TO CA-EXC-FLT-DAY-QTY        05900042
059100     ELSE                                                         05910042
059200         IF  AEXCFLA =  DP015-ERASE-EOF                           05920042
059300             MOVE SPACES             TO CA-EXC-FLT-DAY-QTY        05930042
059400             MOVE ZEROS              TO CA-EXC-FLT-DAY-QTY-N      05940042
059500         END-IF                                                   05950042
059600     END-IF.                                                      05960042
059700***                                                               05970042
059800     IF  ARCVARL > ZERO                                           05980042
059900         MOVE ARCVARI                TO CA-RCVG-VARN-DAY-QTY      05990042
060000     ELSE                                                         06000042
060100         IF  ARCVARA = DP015-ERASE-EOF                            06010042
060200             MOVE SPACES             TO CA-RCVG-VARN-DAY-QTY      06020042
060300             MOVE ZEROS              TO CA-RCVG-VARN-DAY-QTY-N    06030042
060400         END-IF                                                   06040042
060500     END-IF.                                                      06050042
060600***                                                               06060042
060700     IF  AIRCVDL >  ZERO                                          06070042
060800         MOVE AIRCVDI                TO CA-FIRST-RCPT-DAY-QTY     06080042
060900     ELSE                                                         06090042
061000         IF  AIRCVDA =  DP015-ERASE-EOF                           06100042
061100             MOVE SPACES             TO CA-FIRST-RCPT-DAY-QTY     06110042
061200             MOVE ZEROS              TO CA-FIRST-RCPT-DAY-QTY-N   06120042
061300         END-IF                                                   06130042
061400     END-IF.                                                      06140042
061500***                                                               06150042
061600     IF  AIALCDL >  ZERO                                          06160042
061700         MOVE AIALCDI                TO CA-FIRST-PAID-DAY-QTY     06170042
061800     ELSE                                                         06180042
061900         IF  AIALCDA =  DP015-ERASE-EOF                           06190042
062000             MOVE SPACES             TO CA-FIRST-PAID-DAY-QTY     06200042
062100             MOVE ZEROS              TO CA-FIRST-PAID-DAY-QTY-N   06210042
062200         END-IF                                                   06220042
062300     END-IF.                                                      06230042
062400***                                                               06240042
062500     IF  AUJWODL > ZERO                                           06250042
062600         MOVE AUJWODI                TO CA-UNJRNL-WO-DAY-QTY      06260042
062700     ELSE                                                         06270042
062800         IF  AUJWODA = DP015-ERASE-EOF                            06280042
062900             MOVE SPACES             TO CA-UNJRNL-WO-DAY-QTY      06290042
063000             MOVE ZEROS              TO CA-UNJRNL-WO-DAY-QTY-N    06300042
063100         END-IF                                                   06310042
063200     END-IF.                                                      06320042
063300***                                                               06330042
063400     IF  AVENCLL > ZERO                                           06340042
063500         MOVE AVENCLI                TO CA-VENDOR-CHG-LIMIT       06350042
063600     ELSE                                                         06360042
063700         IF  AVENCLA = DP015-ERASE-EOF                            06370042
063800             MOVE SPACES             TO CA-VENDOR-CHG-LIMIT       06380042
063900             MOVE ZEROS              TO CA-VENDOR-CHG-LIMIT-N     06390042
064000         END-IF                                                   06400042
064100     END-IF.                                                      06410042
064200***                                                               06420042
064300     IF  ACSTCPL > ZERO                                           06430042
064400         MOVE ACSTCPI           TO CA-COST-CNTL-PCT               06440042
064500     ELSE                                                         06450042
064600         IF  ACSTCPA = DP015-ERASE-EOF                            06460042
064700             MOVE SPACES        TO CA-COST-CNTL-PCT               06470042
064800             MOVE ZEROS         TO CA-COST-CNTL-PCT-N             06480042
064900         END-IF                                                   06490042
065000     END-IF.                                                      06500042
065100***                                                               06510042
065200     IF  APLAMTL > ZERO                                           06520042
065300         MOVE APLAMTI           TO CA-PRVT-LBL-GBCK-AMT           06530042
065400     ELSE                                                         06540042
065500         IF  APLAMTA = DP015-ERASE-EOF                            06550042
065600             MOVE SPACES        TO CA-PRVT-LBL-GBCK-AMT           06560042
065700             MOVE ZEROS         TO CA-PRVT-LBL-GBCK-AMT-N         06570042
065800         END-IF                                                   06580042
065900     END-IF.                                                      06590042
066000***                                                               06600042
066100     IF  APLPCTL > ZERO                                           06610042
066200         MOVE APLPCTI           TO CA-PRVT-LBL-GBCK-PCT           06620042
066300     ELSE                                                         06630042
066400         IF  APLPCTA = DP015-ERASE-EOF                            06640042
066500             MOVE SPACES        TO CA-PRVT-LBL-GBCK-PCT           06650042
066600             MOVE ZEROS         TO CA-PRVT-LBL-GBCK-PCT-N         06660042
066700         END-IF                                                   06670042
066800     END-IF.                                                      06680042
066900***                                                               06690042
067000     IF  ALFAMTL > ZERO                                           06700042
067100         MOVE ALFAMTI           TO CA-LI-FUNG-GBCK-AMT            06710042
067200     ELSE                                                         06720042
067300         IF  ALFAMTA = DP015-ERASE-EOF                            06730042
067400             MOVE SPACES        TO CA-LI-FUNG-GBCK-AMT            06740042
067500             MOVE ZEROS         TO CA-LI-FUNG-GBCK-AMT-N          06750042
067600         END-IF                                                   06760042
067700     END-IF.                                                      06770042
067800***                                                               06780042
067900     IF  ALFPCTL > ZERO                                           06790042
068000         MOVE ALFPCTI           TO CA-LI-FUNG-GBCK-PCT            06800042
068100     ELSE                                                         06810042
068200         IF  ALFPCTA = DP015-ERASE-EOF                            06820042
068300             MOVE SPACES        TO CA-LI-FUNG-GBCK-PCT            06830042
068400             MOVE ZEROS         TO CA-LI-FUNG-GBCK-PCT-N          06840042
068500         END-IF                                                   06850042
068600     END-IF.                                                      06860042
068700***                                                               06870042
068800*                                                                 06880042
068900******************************************************************06890042
069000*  PROCESS INFORMATION ENTERED ON THE SCREEN, BY RECEIVING THE   *06900042
069100*  CURRENT MAP, RESETTING THE ATTRIBUTES OF ALL ENTERABLE SCREEN *06910042
069200*  FIELDS TO THEIR DEFAULTS, VALIDATING THE PF KEY PRESSED,      *06920042
069300*  EDITING THE INFORMATION RECEIVED, AND EITHER DISPLAYING       *06930042
069400*  ERRORS, OR COMPLETING THE CHANGE REQUEST.                     *06940042
069500******************************************************************06950042
069600 3000-EDIT-DATA-IN-COMMAREA.                                      06960042
069700     MOVE '*3000-EDIT-DATA-IN-COMMAREA      *' TO DP013-PARAGRAPH.06970042
069800                                                                  06980042
069900     INITIALIZE DP020-MESSAGE-AREA.                               06990042
070000     SET PS-NO-EDIT-ERROR   TO TRUE.                              07000042
070100                                                                  07010042
070200     PERFORM 3200-RESET-ATTRIBUTES.                               07020042
070300                                                                  07030042
070400***                                                               07040042
070500***  PRIVATE LABEL AMOUNT                                         07050042
070600***                                                               07060042
070700     IF CA-PRVT-LBL-GBCK-AMT > SPACES                             07070042
070800         MOVE CA-PRVT-LBL-GBCK-AMT TO DP010I-UNEDITED-FIELD       07080042
070900         MOVE 10                   TO DP010I-MAXIMUM-DIGITS       07090042
071000         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     07100042
071100         SET DP010I-NEGATIVE-ALLOWED                              07110042
071200                                   TO TRUE                        07120042
071320         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07132043
071330                         USING DP010I-NUMERIC-EDIT-AREA           07133043
071400         IF DP010I-ERROR-DETECTED                                 07140042
071500             SET PS-EDIT-ERROR     TO TRUE                        07150042
071600             SET DP020-MSG-FATAL   TO TRUE                        07160042
071700*        -- MUST BE NUMERIC --                                    07170042
071800             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            07180042
071900             MOVE DP015-UNP-ALP-BRT-OFF                           07190042
072000                                   TO APLAMTA                     07200042
072100             MOVE DP015-RED        TO APLAMTC                     07210042
072200             MOVE DP015-REVERSE    TO APLAMTH                     07220042
072300             MOVE -1               TO APLAMTL                     07230042
072400             SET DP030-SET-CURSOR-APPL-1                          07240042
072500                                   TO TRUE                        07250042
072600         ELSE                                                     07260042
072700             MOVE DP010I-NUMERIC-FIELD TO CA-PRVT-LBL-GBCK-AMT-N  07270042
072800         END-IF                                                   07280042
072900     END-IF.                                                      07290042
073000***                                                               07300042
073100***  PRIVATE LABEL GIVEBACK PERCENT                               07310042
073200***                                                               07320042
073300     IF CA-PRVT-LBL-GBCK-PCT > SPACES                             07330042
073400         MOVE CA-PRVT-LBL-GBCK-PCT TO DP010I-UNEDITED-FIELD       07340042
073500         MOVE 3                    TO DP010I-MAXIMUM-DIGITS       07350042
073600         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     07360042
073700         SET DP010I-NEGATIVE-NOT-ALLOWED                          07370042
073800                                   TO TRUE                        07380042
073920         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07392043
073930                         USING DP010I-NUMERIC-EDIT-AREA           07393043
074000         IF DP010I-ERROR-DETECTED                                 07400042
074100             SET PS-EDIT-ERROR     TO TRUE                        07410042
074200             SET DP020-MSG-FATAL   TO TRUE                        07420042
074300*        -- MUST BE NUMERIC --                                    07430042
074400             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            07440042
074500             MOVE DP015-UNP-ALP-BRT-OFF                           07450042
074600                                   TO APLPCTA                     07460042
074700             MOVE DP015-RED        TO APLPCTC                     07470042
074800             MOVE DP015-REVERSE    TO APLPCTH                     07480042
074900             MOVE -1               TO APLPCTL                     07490042
075000             SET DP030-SET-CURSOR-APPL-1                          07500042
075100                                   TO TRUE                        07510042
075200         ELSE                                                     07520042
075300             MOVE DP010I-NUMERIC-FIELD                            07530042
075400                                   TO CA-PRVT-LBL-GBCK-PCT-N      07540042
075500*          ----  PERCENT CANNOT BE GREATER THAN 100%  ---         07550042
075600             IF CA-PRVT-LBL-GBCK-PCT-N > 100                      07560042
075700                MOVE PC-TSYMSG-03612                              07570042
075800                                    TO DP020-MSG-NUMBER           07580042
075900                MOVE DP015-UNP-ALP-BRT-OFF                        07590042
076000                                    TO APLPCTA                    07600042
076100                SET PS-EDIT-ERROR   TO TRUE                       07610042
076200                SET DP020-MSG-FATAL TO TRUE                       07620042
076300                MOVE DP015-RED      TO APLPCTC                    07630042
076400                MOVE DP015-REVERSE  TO APLPCTH                    07640042
076500                MOVE -1             TO APLPCTL                    07650042
076600                SET DP030-SET-CURSOR-APPL-1                       07660042
076700                                    TO TRUE                       07670042
076800             END-IF                                               07680042
076900         END-IF                                                   07690042
077000     END-IF.                                                      07700042
077100***                                                               07710042
077200***  PRIVATE LABEL GIVEBACK AMOUNT AND PERCENT COMPARES           07720042
077300***                                                               07730042
077400     IF (CA-PRVT-LBL-GBCK-AMT-N NOT = ZEROS) AND                  07740042
077500        (CA-PRVT-LBL-GBCK-PCT-N > ZEROS)                          07750042
077600* -- PRIVATE LABEL PERCENT MUST = ZERO WHEN AMOUNT IS NOT = ZERO  07760042
077700        MOVE PC-TSYMSG-03614                                      07770042
077800                            TO DP020-MSG-NUMBER                   07780042
077900        MOVE DP015-UNP-ALP-BRT-OFF                                07790042
078000                            TO APLAMTA                            07800042
078100                               APLPCTA                            07810042
078200        SET PS-EDIT-ERROR   TO TRUE                               07820042
078300        SET DP020-MSG-FATAL TO TRUE                               07830042
078400        MOVE DP015-RED      TO APLAMTC                            07840042
078500                               APLPCTC                            07850042
078600        MOVE DP015-REVERSE  TO APLAMTH                            07860042
078700                               APLPCTH                            07870042
078800        MOVE -1             TO APLAMTL                            07880042
078900        SET DP030-SET-CURSOR-APPL-1                               07890042
079000                            TO TRUE                               07900042
079100     END-IF.                                                      07910042
079200***                                                               07920042
079300***  LI & FUNG GIVEBACK AMOUNT                                    07930042
079400***                                                               07940042
079500     IF CA-LI-FUNG-GBCK-AMT > SPACES                              07950042
079600         MOVE CA-LI-FUNG-GBCK-AMT  TO DP010I-UNEDITED-FIELD       07960042
079700         MOVE 10                   TO DP010I-MAXIMUM-DIGITS       07970042
079800         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     07980042
079900         SET DP010I-NEGATIVE-ALLOWED                              07990042
080000                                   TO TRUE                        08000042
080120         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08012043
080130                         USING DP010I-NUMERIC-EDIT-AREA           08013043
080200         IF DP010I-ERROR-DETECTED                                 08020042
080300             SET PS-EDIT-ERROR     TO TRUE                        08030042
080400             SET DP020-MSG-FATAL   TO TRUE                        08040042
080500*        -- MUST BE NUMERIC --                                    08050042
080600             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            08060042
080700             MOVE DP015-UNP-ALP-BRT-OFF                           08070042
080800                                   TO ALFAMTA                     08080042
080900             MOVE DP015-RED        TO ALFAMTC                     08090042
081000             MOVE DP015-REVERSE    TO ALFAMTH                     08100042
081100             MOVE -1               TO ALFAMTL                     08110042
081200             SET DP030-SET-CURSOR-APPL-1                          08120042
081300                                   TO TRUE                        08130042
081400         ELSE                                                     08140042
081500             MOVE DP010I-NUMERIC-FIELD TO CA-LI-FUNG-GBCK-AMT-N   08150042
081600         END-IF                                                   08160042
081700     END-IF.                                                      08170042
081800***                                                               08180042
081900***  LI & FUNG GIVEBACK PERCENT                                   08190042
082000***                                                               08200042
082100     IF CA-LI-FUNG-GBCK-PCT > SPACES                              08210042
082200         MOVE CA-LI-FUNG-GBCK-PCT  TO DP010I-UNEDITED-FIELD       08220042
082300         MOVE 3                    TO DP010I-MAXIMUM-DIGITS       08230042
082400         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     08240042
082500         SET DP010I-NEGATIVE-NOT-ALLOWED                          08250042
082600                                   TO TRUE                        08260042
082720         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08272043
082730                         USING DP010I-NUMERIC-EDIT-AREA           08273043
082800         IF DP010I-ERROR-DETECTED                                 08280042
082900             SET PS-EDIT-ERROR     TO TRUE                        08290042
083000             SET DP020-MSG-FATAL   TO TRUE                        08300042
083100*        -- MUST BE NUMERIC --                                    08310042
083200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            08320042
083300             MOVE DP015-UNP-ALP-BRT-OFF                           08330042
083400                                   TO ALFPCTA                     08340042
083500             MOVE DP015-RED        TO ALFPCTC                     08350042
083600             MOVE DP015-REVERSE    TO ALFPCTH                     08360042
083700             MOVE -1               TO ALFPCTL                     08370042
083800             SET DP030-SET-CURSOR-APPL-1                          08380042
083900                                   TO TRUE                        08390042
084000         ELSE                                                     08400042
084100             MOVE DP010I-NUMERIC-FIELD                            08410042
084200                                   TO CA-LI-FUNG-GBCK-PCT-N       08420042
084300*          ----  PERCENT CANNOT BE GREATER THAN 100%  ---         08430042
084400             IF CA-LI-FUNG-GBCK-PCT-N > 100                       08440042
084500                MOVE PC-TSYMSG-03612                              08450042
084600                                    TO DP020-MSG-NUMBER           08460042
084700                MOVE DP015-UNP-ALP-BRT-OFF                        08470042
084800                                    TO ALFPCTA                    08480042
084900                SET PS-EDIT-ERROR   TO TRUE                       08490042
085000                SET DP020-MSG-FATAL TO TRUE                       08500042
085100                MOVE DP015-RED      TO ALFPCTC                    08510042
085200                MOVE DP015-REVERSE  TO ALFPCTH                    08520042
085300                MOVE -1             TO ALFPCTL                    08530042
085400                SET DP030-SET-CURSOR-APPL-1                       08540042
085500                                    TO TRUE                       08550042
085600             END-IF                                               08560042
085700         END-IF                                                   08570042
085800     END-IF.                                                      08580042
085900***                                                               08590042
086000***  LI & FUNG GIVEBACK AMOUNT AND PERCENT COMPARES               08600042
086100***                                                               08610042
086200     IF (CA-LI-FUNG-GBCK-AMT-N NOT = ZEROS) AND                   08620042
086300        (CA-LI-FUNG-GBCK-PCT-N > ZEROS)                           08630042
086400* -- LI & FUNG PERCENT MUST = ZERO WHEN AMOUNT IS NOT = ZERO      08640042
086500        MOVE PC-TSYMSG-03615                                      08650042
086600                            TO DP020-MSG-NUMBER                   08660042
086700        MOVE DP015-UNP-ALP-BRT-OFF                                08670042
086800                            TO ALFAMTA                            08680042
086900                               ALFPCTA                            08690042
087000        SET PS-EDIT-ERROR   TO TRUE                               08700042
087100        SET DP020-MSG-FATAL TO TRUE                               08710042
087200        MOVE DP015-RED      TO ALFAMTC                            08720042
087300                               ALFPCTC                            08730042
087400        MOVE DP015-REVERSE  TO ALFAMTH                            08740042
087500                               ALFPCTH                            08750042
087600        MOVE -1             TO ALFAMTL                            08760042
087700        SET DP030-SET-CURSOR-APPL-1                               08770042
087800                            TO TRUE                               08780042
087900     END-IF.                                                      08790042
088000***                                                               08800042
088100***  PERCENT OF VARIANCE ALLOWED                                  08810042
088200***                                                               08820042
088300     IF CA-PCT-OF-DOLLAR-VARIANCE > SPACES                        08830042
088400         MOVE CA-PCT-OF-DOLLAR-VARIANCE                           08840042
088500                                   TO DP010I-UNEDITED-FIELD       08850042
088600         MOVE 3                    TO DP010I-MAXIMUM-DIGITS       08860042
088700         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     08870042
088800         SET DP010I-NEGATIVE-NOT-ALLOWED                          08880042
088900                                   TO TRUE                        08890042
089020         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08902043
089030                         USING DP010I-NUMERIC-EDIT-AREA           08903043
089100         IF DP010I-ERROR-DETECTED                                 08910042
089200             SET PS-EDIT-ERROR     TO TRUE                        08920042
089300             SET DP020-MSG-FATAL   TO TRUE                        08930042
089400*        -- MUST BE NUMERIC --                                    08940042
089500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            08950042
089600             MOVE DP015-UNP-ALP-BRT-OFF                           08960042
089700                                   TO APCTVRA                     08970042
089800             MOVE DP015-RED        TO APCTVRC                     08980042
089900             MOVE DP015-REVERSE    TO APCTVRH                     08990042
090000             MOVE -1               TO APCTVRL                     09000042
090100             SET DP030-SET-CURSOR-APPL-1                          09010042
090200                                   TO TRUE                        09020042
090300         ELSE                                                     09030042
090400             MOVE DP010I-NUMERIC-FIELD                            09040042
090500                                   TO CA-PCT-OF-DOLLAR-VARIANCE-N 09050042
090600*          ----  PERCENT CANNOT BE GREATER THAN 100%  ---         09060042
090700             IF CA-PCT-OF-DOLLAR-VARIANCE-N > 100                 09070042
090800                MOVE PC-TSYMSG-03612                              09080042
090900                                    TO DP020-MSG-NUMBER           09090042
091000                MOVE DP015-UNP-ALP-BRT-OFF                        09100042
091100                                    TO APCTVRA                    09110042
091200                SET PS-EDIT-ERROR   TO TRUE                       09120042
091300                SET DP020-MSG-FATAL TO TRUE                       09130042
091400                MOVE DP015-RED      TO APCTVRC                    09140042
091500                MOVE DP015-REVERSE  TO APCTVRH                    09150042
091600                MOVE -1             TO APCTVRL                    09160042
091700                SET DP030-SET-CURSOR-APPL-1                       09170042
091800                                    TO TRUE                       09180042
091900             END-IF                                               09190042
092000         END-IF                                                   09200042
092100     END-IF.                                                      09210042
092200                                                                  09220042
092300***                                                               09230042
092400***  MAXIMUM DOLLAR VARIANCE                                      09240042
092500***                                                               09250042
092600     IF CA-DOLLAR-LIMIT-VARIANCE > SPACES                         09260042
092700         MOVE CA-DOLLAR-LIMIT-VARIANCE                            09270042
092800                                   TO DP010I-UNEDITED-FIELD       09280042
092900         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       09290042
093000         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     09300042
093100         SET DP010I-NEGATIVE-NOT-ALLOWED                          09310042
093200                                   TO TRUE                        09320042
093320         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09332043
093330                         USING DP010I-NUMERIC-EDIT-AREA           09333043
093400         IF DP010I-ERROR-DETECTED                                 09340042
093500             SET PS-EDIT-ERROR     TO TRUE                        09350042
093600             SET DP020-MSG-FATAL   TO TRUE                        09360042
093700*        -- MUST BE NUMERIC --                                    09370042
093800             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            09380042
093900             MOVE DP015-UNP-ALP-BRT-OFF                           09390042
094000                                   TO ADLRVRA                     09400042
094100             MOVE DP015-RED        TO ADLRVRC                     09410042
094200             MOVE DP015-REVERSE    TO ADLRVRH                     09420042
094300             MOVE -1               TO ADLRVRL                     09430042
094400             SET DP030-SET-CURSOR-APPL-1                          09440042
094500                                   TO TRUE                        09450042
094600         ELSE                                                     09460042
094700             MOVE DP010I-NUMERIC-FIELD                            09470042
094800                                   TO CA-DOLLAR-LIMIT-VARIANCE-N  09480042
094900         END-IF                                                   09490042
095000     END-IF.                                                      09500042
095100***                                                               09510042
095200***  UNJOURNALIZED WRITE OFF DAYS                                 09520042
095300***                                                               09530042
095400     IF CA-UNJRNL-WO-DAY-QTY > SPACES                             09540042
095500         MOVE CA-UNJRNL-WO-DAY-QTY                                09550042
095600                                   TO DP010I-UNEDITED-FIELD       09560042
095700         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       09570042
095800         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     09580042
095900         SET DP010I-NEGATIVE-NOT-ALLOWED                          09590042
096000                                   TO TRUE                        09600042
096120         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09612043
096130                         USING DP010I-NUMERIC-EDIT-AREA           09613043
096200         IF DP010I-ERROR-DETECTED                                 09620042
096300             SET PS-EDIT-ERROR     TO TRUE                        09630042
096400             SET DP020-MSG-FATAL   TO TRUE                        09640042
096500*        -- MUST BE NUMERIC --                                    09650042
096600             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            09660042
096700             MOVE DP015-UNP-ALP-BRT-OFF                           09670042
096800                                   TO AUJWODA                     09680042
096900             MOVE DP015-RED        TO AUJWODC                     09690042
097000             MOVE DP015-REVERSE    TO AUJWODH                     09700042
097100             MOVE -1               TO AUJWODL                     09710042
097200             SET DP030-SET-CURSOR-APPL-1                          09720042
097300                                   TO TRUE                        09730042
097400         ELSE                                                     09740042
097500             MOVE DP010I-NUMERIC-FIELD                            09750042
097600                                   TO CA-UNJRNL-WO-DAY-QTY-N      09760042
097700         END-IF                                                   09770042
097800     END-IF.                                                      09780042
097900***                                                               09790042
098000***  RECONCILIATION CUTOFF DAYS                                   09800042
098100***                                                               09810042
098200     IF CA-RECON-CUTOFF-DAYS > SPACES                             09820042
098300         MOVE CA-RECON-CUTOFF-DAYS                                09830042
098400                                   TO DP010I-UNEDITED-FIELD       09840042
098500         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       09850042
098600         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     09860042
098700         SET DP010I-NEGATIVE-NOT-ALLOWED                          09870042
098800                                   TO TRUE                        09880042
098920         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09892043
098930                         USING DP010I-NUMERIC-EDIT-AREA           09893043
099000         IF DP010I-ERROR-DETECTED                                 09900042
099100             SET PS-EDIT-ERROR     TO TRUE                        09910042
099200             SET DP020-MSG-FATAL   TO TRUE                        09920042
099300*        -- MUST BE NUMERIC --                                    09930042
099400             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            09940042
099500             MOVE DP015-UNP-ALP-BRT-OFF                           09950042
099600                                   TO ARECUTA                     09960042
099700             MOVE DP015-RED        TO ARECUTC                     09970042
099800             MOVE DP015-REVERSE    TO ARECUTH                     09980042
099900             MOVE -1               TO ARECUTL                     09990042
100000             SET DP030-SET-CURSOR-APPL-1                          10000042
100100                                   TO TRUE                        10010042
100200         ELSE                                                     10020042
100300             MOVE DP010I-NUMERIC-FIELD                            10030042
100400                                   TO CA-RECON-CUTOFF-DAYS-N      10040042
100500         END-IF                                                   10050042
100600     END-IF.                                                      10060042
100700***                                                               10070042
100800***  PAYMENT FLOAT DAYS                                           10080042
100900***                                                               10090042
101000     IF CA-PMT-FLOAT-DAYS > SPACES                                10100042
101100         MOVE CA-PMT-FLOAT-DAYS                                   10110042
101200                                   TO DP010I-UNEDITED-FIELD       10120042
101300         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       10130042
101400         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     10140042
101500         SET DP010I-NEGATIVE-NOT-ALLOWED                          10150042
101600                                   TO TRUE                        10160042
101720         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10172043
101730                         USING DP010I-NUMERIC-EDIT-AREA           10173043
101800         IF DP010I-ERROR-DETECTED                                 10180042
101900             SET PS-EDIT-ERROR     TO TRUE                        10190042
102000             SET DP020-MSG-FATAL   TO TRUE                        10200042
102100*        -- MUST BE NUMERIC --                                    10210042
102200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            10220042
102300             MOVE DP015-UNP-ALP-BRT-OFF                           10230042
102400                                   TO APAYFLA                     10240042
102500             MOVE DP015-RED        TO APAYFLC                     10250042
102600             MOVE DP015-REVERSE    TO APAYFLH                     10260042
102700             MOVE -1               TO APAYFLL                     10270042
102800             SET DP030-SET-CURSOR-APPL-1                          10280042
102900                                   TO TRUE                        10290042
103000         ELSE                                                     10300042
103100             MOVE DP010I-NUMERIC-FIELD                            10310042
103200                                   TO CA-PMT-FLOAT-DAYS-N         10320042
103300         END-IF                                                   10330042
103400     END-IF.                                                      10340042
103500***                                                               10350042
103600***  EXCEPTION FLOAT DAYS                                         10360042
103700***                                                               10370042
103800     IF CA-EXC-FLT-DAY-QTY > SPACES                               10380042
103900         MOVE CA-EXC-FLT-DAY-QTY                                  10390042
104000                                   TO DP010I-UNEDITED-FIELD       10400042
104100         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       10410042
104200         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     10420042
104300         SET DP010I-NEGATIVE-NOT-ALLOWED                          10430042
104400                                   TO TRUE                        10440042
104520         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10452043
104530                         USING DP010I-NUMERIC-EDIT-AREA           10453043
104600         IF DP010I-ERROR-DETECTED                                 10460042
104700             SET PS-EDIT-ERROR     TO TRUE                        10470042
104800             SET DP020-MSG-FATAL   TO TRUE                        10480042
104900*        -- MUST BE NUMERIC --                                    10490042
105000             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            10500042
105100             MOVE DP015-UNP-ALP-BRT-OFF                           10510042
105200                                   TO AEXCFLA                     10520042
105300             MOVE DP015-RED        TO AEXCFLC                     10530042
105400             MOVE DP015-REVERSE    TO AEXCFLH                     10540042
105500             MOVE -1               TO AEXCFLL                     10550042
105600             SET DP030-SET-CURSOR-APPL-1                          10560042
105700                                   TO TRUE                        10570042
105800         ELSE                                                     10580042
105900             MOVE DP010I-NUMERIC-FIELD                            10590042
106000                                   TO CA-EXC-FLT-DAY-QTY-N        10600042
106100         END-IF                                                   10610042
106200     END-IF.                                                      10620042
106300***                                                               10630042
106400***  RECEIVING VARIANCE DAYS                                      10640042
106500***                                                               10650042
106600     IF CA-RCVG-VARN-DAY-QTY > SPACES                             10660042
106700         MOVE CA-RCVG-VARN-DAY-QTY                                10670042
106800                                   TO DP010I-UNEDITED-FIELD       10680042
106900         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       10690042
107000         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     10700042
107100         SET DP010I-NEGATIVE-NOT-ALLOWED                          10710042
107200                                   TO TRUE                        10720042
107320         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10732043
107330                         USING DP010I-NUMERIC-EDIT-AREA           10733043
107400         IF DP010I-ERROR-DETECTED                                 10740042
107500             SET PS-EDIT-ERROR     TO TRUE                        10750042
107600             SET DP020-MSG-FATAL   TO TRUE                        10760042
107700*        -- MUST BE NUMERIC --                                    10770042
107800             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            10780042
107900             MOVE DP015-UNP-ALP-BRT-OFF                           10790042
108000                                   TO ARCVARA                     10800042
108100             MOVE DP015-RED        TO ARCVARC                     10810042
108200             MOVE DP015-REVERSE    TO ARCVARH                     10820042
108300             MOVE -1               TO ARCVARL                     10830042
108400             SET DP030-SET-CURSOR-APPL-1                          10840042
108500                                   TO TRUE                        10850042
108600         ELSE                                                     10860042
108700             MOVE DP010I-NUMERIC-FIELD                            10870042
108800                                   TO CA-RCVG-VARN-DAY-QTY-N      10880042
108900         END-IF                                                   10890042
109000     END-IF.                                                      10900042
109100***                                                               10910042
109200***  REPORT PO WHEN DAYS SINCE 1ST RECEIPT                        10920042
109300***                                                               10930042
109400     IF CA-FIRST-RCPT-DAY-QTY > SPACES                            10940042
109500         MOVE CA-FIRST-RCPT-DAY-QTY                               10950042
109600                                   TO DP010I-UNEDITED-FIELD       10960042
109700         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       10970042
109800         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     10980042
109900         SET DP010I-NEGATIVE-NOT-ALLOWED                          10990042
110000                                   TO TRUE                        11000042
110120         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11012043
110130                         USING DP010I-NUMERIC-EDIT-AREA           11013043
110200         IF DP010I-ERROR-DETECTED                                 11020042
110300             SET PS-EDIT-ERROR     TO TRUE                        11030042
110400             SET DP020-MSG-FATAL   TO TRUE                        11040042
110500*        -- MUST BE NUMERIC --                                    11050042
110600             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11060042
110700             MOVE DP015-UNP-ALP-BRT-OFF                           11070042
110800                                   TO AIRCVDA                     11080042
110900             MOVE DP015-RED        TO AIRCVDC                     11090042
111000             MOVE DP015-REVERSE    TO AIRCVDH                     11100042
111100             MOVE -1               TO AIRCVDL                     11110042
111200             SET DP030-SET-CURSOR-APPL-1                          11120042
111300                                   TO TRUE                        11130042
111400         ELSE                                                     11140042
111500             MOVE DP010I-NUMERIC-FIELD                            11150042
111600                                   TO CA-FIRST-RCPT-DAY-QTY-N     11160042
111700         END-IF                                                   11170042
111800     END-IF.                                                      11180042
111900***                                                               11190042
112000***  REPORT PO WHEN DAYS SINCE 1ST PAID                           11200042
112100***                                                               11210042
112200     IF CA-FIRST-PAID-DAY-QTY > SPACES                            11220042
112300         MOVE CA-FIRST-PAID-DAY-QTY                               11230042
112400                                   TO DP010I-UNEDITED-FIELD       11240042
112500         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       11250042
112600         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     11260042
112700         SET DP010I-NEGATIVE-NOT-ALLOWED                          11270042
112800                                   TO TRUE                        11280042
112920         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11292043
112930                         USING DP010I-NUMERIC-EDIT-AREA           11293043
113000         IF DP010I-ERROR-DETECTED                                 11300042
113100             SET PS-EDIT-ERROR     TO TRUE                        11310042
113200             SET DP020-MSG-FATAL   TO TRUE                        11320042
113300*        -- MUST BE NUMERIC --                                    11330042
113400             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11340042
113500             MOVE DP015-UNP-ALP-BRT-OFF                           11350042
113600                                   TO AIALCDA                     11360042
113700             MOVE DP015-RED        TO AIALCDC                     11370042
113800             MOVE DP015-REVERSE    TO AIALCDH                     11380042
113900             MOVE -1               TO AIALCDL                     11390042
114000             SET DP030-SET-CURSOR-APPL-1                          11400042
114100                                   TO TRUE                        11410042
114200         ELSE                                                     11420042
114300             MOVE DP010I-NUMERIC-FIELD                            11430042
114400                                   TO CA-FIRST-PAID-DAY-QTY-N     11440042
114500         END-IF                                                   11450042
114600     END-IF.                                                      11460042
114700***                                                               11470042
114800***  VENDOR CHARGE LIMIT                                          11480042
114900***                                                               11490042
115000     IF CA-VENDOR-CHG-LIMIT > SPACES                              11500042
115100         MOVE CA-VENDOR-CHG-LIMIT                                 11510042
115200                                   TO DP010I-UNEDITED-FIELD       11520042
115300         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       11530042
115400         MOVE 0                    TO DP010I-MAXIMUM-DECIMALS     11540042
115500         SET DP010I-NEGATIVE-NOT-ALLOWED                          11550042
115600                                   TO TRUE                        11560042
115720         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11572043
115730                         USING DP010I-NUMERIC-EDIT-AREA           11573043
115800         IF DP010I-ERROR-DETECTED                                 11580042
115900             SET PS-EDIT-ERROR     TO TRUE                        11590042
116000             SET DP020-MSG-FATAL   TO TRUE                        11600042
116100*        -- MUST BE NUMERIC --                                    11610042
116200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11620042
116300             MOVE DP015-UNP-ALP-BRT-OFF                           11630042
116400                                   TO AVENCLA                     11640042
116500             MOVE DP015-RED        TO AVENCLC                     11650042
116600             MOVE DP015-REVERSE    TO AVENCLH                     11660042
116700             MOVE -1               TO AVENCLL                     11670042
116800             SET DP030-SET-CURSOR-APPL-1                          11680042
116900                                   TO TRUE                        11690042
117000         ELSE                                                     11700042
117100             MOVE DP010I-NUMERIC-FIELD                            11710042
117200                                   TO CA-VENDOR-CHG-LIMIT-N       11720042
117300         END-IF                                                   11730042
117400     END-IF.                                                      11740042
117500***                                                               11750042
117600***  COST CONTROL PERCENT                                         11760042
117700***                                                               11770042
117800     IF CA-COST-CNTL-PCT > SPACES                                 11780042
117900         MOVE CA-COST-CNTL-PCT                                    11790042
118000                                   TO DP010I-UNEDITED-FIELD       11800042
118100         MOVE 3                    TO DP010I-MAXIMUM-DIGITS       11810042
118200         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     11820042
118300         SET DP010I-NEGATIVE-NOT-ALLOWED                          11830042
118400                                   TO TRUE                        11840042
118520         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11852043
118530                         USING DP010I-NUMERIC-EDIT-AREA           11853043
118600         IF DP010I-ERROR-DETECTED                                 11860042
118700             SET PS-EDIT-ERROR     TO TRUE                        11870042
118800             SET DP020-MSG-FATAL   TO TRUE                        11880042
118900*        -- MUST BE NUMERIC --                                    11890042
119000             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11900042
119100             MOVE DP015-UNP-ALP-BRT-OFF                           11910042
119200                                   TO ACSTCPA                     11920042
119300             MOVE DP015-RED        TO ACSTCPC                     11930042
119400             MOVE DP015-REVERSE    TO ACSTCPH                     11940042
119500             MOVE -1               TO ACSTCPL                     11950042
119600             SET DP030-SET-CURSOR-APPL-1                          11960042
119700                                   TO TRUE                        11970042
119800         ELSE                                                     11980042
119900             MOVE DP010I-NUMERIC-FIELD                            11990042
120000                                   TO CA-COST-CNTL-PCT-N          12000042
120100*          ----  PERCENT CANNOT BE GREATER THAN 100%  ---         12010042
120200             IF CA-COST-CNTL-PCT-N > 100                          12020042
120300                MOVE PC-TSYMSG-03612                              12030042
120400                                    TO DP020-MSG-NUMBER           12040042
120500                MOVE DP015-UNP-ALP-BRT-OFF                        12050042
120600                                    TO ACSTCPA                    12060042
120700                SET PS-EDIT-ERROR   TO TRUE                       12070042
120800                SET DP020-MSG-FATAL TO TRUE                       12080042
120900                MOVE DP015-RED      TO ACSTCPC                    12090042
121000                MOVE DP015-REVERSE  TO ACSTCPH                    12100042
121100                MOVE -1             TO ACSTCPL                    12110042
121200                SET DP030-SET-CURSOR-APPL-1                       12120042
121300                                    TO TRUE                       12130042
121400             END-IF                                               12140042
121500         END-IF                                                   12150042
121600     END-IF.                                                      12160042
121700***                                                               12170042
121800                                                                  12180042
121900     EJECT                                                        12190042
122000                                                                  12200042
122100******************************************************************12210042
122200*  SET ALL SCREEN ATTRIBUTES TO DEFAULT VALUES.                  *12220042
122300******************************************************************12230042
122400 3200-RESET-ATTRIBUTES.                                           12240042
122500     MOVE '*3200-RESET-ATTRIBUTES.          *' TO DP013-PARAGRAPH.12250042
122600                                                                  12260042
122700     MOVE DP015-UNDERLINE        TO APCTVRH                       12270042
122800                                    ADLRVRH                       12280042
122900                                    ARECUTH                       12290042
123000                                    APAYFLH                       12300042
123100                                    AEXCFLH                       12310042
123200                                    ARCVARH                       12320042
123300                                    AIRCVDH                       12330042
123400                                    AIALCDH                       12340042
123500                                    AUJWODH                       12350042
123600                                    AVENCLH                       12360042
123700                                    ACSTCPH                       12370042
123800                                    APLAMTH                       12380042
123900                                    APLPCTH                       12390042
124000                                    ALFAMTH                       12400042
124100                                    ALFPCTH.                      12410042
124200*                                                                 12420042
124300     MOVE DP015-GREEN            TO APCTVRC                       12430042
124400                                    ADLRVRC                       12440042
124500                                    ARECUTC                       12450042
124600                                    APAYFLC                       12460042
124700                                    AEXCFLC                       12470042
124800                                    ARCVARC                       12480042
124900                                    AIRCVDC                       12490042
125000                                    AIALCDC                       12500042
125100                                    AUJWODC                       12510042
125200                                    AVENCLC                       12520042
125300                                    ACSTCPC                       12530042
125400                                    APLAMTC                       12540042
125500                                    APLPCTC                       12550042
125600                                    ALFAMTC                       12560042
125700                                    ALFPCTC.                      12570042
125800*                                                                 12580042
125900*************************************************                 12590042
126000***  THIS MODULE BUILDS THE INITIAL SCREEN    ***                 12600042
126100*************************************************                 12610042
126200*                                                                 12620042
126300 4000-BUILD-INITIAL-SCREEN.                                       12630042
126400      MOVE '*4000-BUILD-INITIAL-SCREEN.     *' TO DP013-PARAGRAPH.12640042
126500*                                                                 12650042
126600      SET DP030-SET-CURSOR-APPL-1  TO TRUE.                       12660042
126700*     MOVE -1                      TO APCTVRL.                    12670042
126800      MOVE -1                      TO APLAMTL.                    12680042
126900      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                       12690042
127000                                                                  12700042
127100*                                                                 12710042
127200******************************************************            12720042
127300***  THIS MODULE MOVES THE COMMAREA TO THE SCREEN  ***            12730042
127400******************************************************            12740042
127500*                                                                 12750042
127600 4400-MOVE-COMMAREA-TO-SCREEN.                                    12760042
127700     MOVE '*4400-MOVE-COMMAREA-TO-SCREEN.   *' TO DP013-PARAGRAPH.12770042
127800*                                                                 12780042
127900     MOVE CA-PCT-OF-DOLLAR-VARIANCE-N  TO  APCTVRO.               12790042
128000     MOVE CA-DOLLAR-LIMIT-VARIANCE-N   TO  ADLRVRO.               12800042
128100     MOVE CA-RECON-CUTOFF-DAYS-N       TO  ARECUTO.               12810042
128200     MOVE CA-PMT-FLOAT-DAYS-N          TO  APAYFLO.               12820042
128300     MOVE CA-EXC-FLT-DAY-QTY-N         TO  AEXCFLO.               12830042
128400     MOVE CA-RCVG-VARN-DAY-QTY-N       TO  ARCVARO.               12840042
128500     MOVE CA-FIRST-RCPT-DAY-QTY-N      TO  AIRCVDO.               12850042
128600     MOVE CA-FIRST-PAID-DAY-QTY-N      TO  AIALCDO.               12860042
128700     MOVE CA-UNJRNL-WO-DAY-QTY-N       TO  AUJWODO.               12870042
128800     MOVE CA-VENDOR-CHG-LIMIT-N        TO  AVENCLO.               12880042
128900     MOVE CA-COST-CNTL-PCT-N           TO  ACSTCPO.               12890042
129000     MOVE CA-PRVT-LBL-GBCK-AMT-N       TO  APLAMTO.               12900042
129100     MOVE CA-PRVT-LBL-GBCK-PCT-N       TO  APLPCTO.               12910042
129200     MOVE CA-LI-FUNG-GBCK-AMT-N        TO  ALFAMTO.               12920042
129300     MOVE CA-LI-FUNG-GBCK-PCT-N        TO  ALFPCTO.               12930042
129400*                                                                 12940042
129500*                                                                 12950042
129600******************************************************************12960042
129700*  IF THERE WERE CHANGES TO THE FIELDS CONTINUE WITH THE A/P     *12970042
129800*  UPDATE PROCESS (5100-PERFORM-AP-CNTL-UPDATE). OTHERWISE, SEND *12980042
129900*  A WARNING MESSAGE TO THE SCREEN.                              *12990042
130000******************************************************************13000042
130100 5000-PROCESS-APCNTL-UPDATE.                                      13010042
130200     MOVE '*5000-PROCESS-APCNTL-UPDATE      *' TO DP013-PARAGRAPH.13020042
130300                                                                  13030042
130400     SET PS-NO-CHANGES-MADE     TO  TRUE.                         13040042
130500                                                                  13050042
130600     IF CA-APB-PCT-OF-DOLLAR-VARIANCE NOT =                       13060042
130700        CA-PCT-OF-DOLLAR-VARIANCE-N                               13070042
130800        SET PS-CHANGE-MADE      TO  TRUE.                         13080042
130900***                                                               13090042
131000     IF PS-NO-CHANGES-MADE                                        13100042
131100        IF CA-APB-DOLLAR-LIMIT-VARIANCE  NOT =                    13110042
131200           CA-DOLLAR-LIMIT-VARIANCE-N                             13120042
131300           SET PS-CHANGE-MADE   TO  TRUE.                         13130042
131400***                                                               13140042
131500     IF PS-NO-CHANGES-MADE                                        13150042
131600        IF CA-APB-RECON-CUTOFF-DAYS  NOT =  CA-RECON-CUTOFF-DAYS-N13160042
131700           SET PS-CHANGE-MADE   TO  TRUE.                         13170042
131800***                                                               13180042
131900     IF PS-NO-CHANGES-MADE                                        13190042
132000        IF CA-APB-PMT-FLOAT-DAYS  NOT =  CA-PMT-FLOAT-DAYS-N      13200042
132100           SET PS-CHANGE-MADE   TO  TRUE.                         13210042
132200***                                                               13220042
132300     IF PS-NO-CHANGES-MADE                                        13230042
132400        IF CA-APB-EXC-FLT-DAY-QTY NOT =  CA-EXC-FLT-DAY-QTY-N     13240042
132500           SET PS-CHANGE-MADE   TO  TRUE.                         13250042
132600***                                                               13260042
132700     IF PS-NO-CHANGES-MADE                                        13270042
132800        IF CA-APB-RCVG-VARN-DAY-QTY NOT = CA-RCVG-VARN-DAY-QTY-N  13280042
132900           SET PS-CHANGE-MADE   TO  TRUE.                         13290042
133000***                                                               13300042
133100     IF PS-NO-CHANGES-MADE                                        13310042
133200        IF CA-APB-FIRST-RCPT-DAY-QTY NOT =                        13320042
133300                                CA-FIRST-RCPT-DAY-QTY-N           13330042
133400           SET PS-CHANGE-MADE   TO  TRUE.                         13340042
133500***                                                               13350042
133600     IF PS-NO-CHANGES-MADE                                        13360042
133700        IF CA-APB-FIRST-PAID-DAY-QTY NOT =                        13370042
133800                                CA-FIRST-PAID-DAY-QTY-N           13380042
133900           SET PS-CHANGE-MADE   TO  TRUE.                         13390042
134000***                                                               13400042
134100     IF PS-NO-CHANGES-MADE                                        13410042
134200        IF CA-APB-UNJRNL-WO-DAY-QTY NOT = CA-UNJRNL-WO-DAY-QTY-N  13420042
134300           SET PS-CHANGE-MADE   TO  TRUE.                         13430042
134400***                                                               13440042
134500     IF PS-NO-CHANGES-MADE                                        13450042
134600        IF CA-APB-VENDOR-CHG-LIMIT NOT =  CA-VENDOR-CHG-LIMIT-N   13460042
134700           SET PS-CHANGE-MADE   TO  TRUE.                         13470042
134800***                                                               13480042
134900     IF PS-NO-CHANGES-MADE                                        13490042
135000        IF CA-APB-COST-CNTL-PCT    NOT =  CA-COST-CNTL-PCT-N      13500042
135100           SET PS-CHANGE-MADE   TO  TRUE.                         13510042
135200***                                                               13520042
135300     IF PS-NO-CHANGES-MADE                                        13530042
135400        IF CA-APB-PRVT-LBL-GBCK-AMT NOT =  CA-PRVT-LBL-GBCK-AMT-N 13540042
135500           SET PS-CHANGE-MADE   TO  TRUE.                         13550042
135600***                                                               13560042
135700     IF PS-NO-CHANGES-MADE                                        13570042
135800        IF CA-APB-PRVT-LBL-GBCK-PCT NOT =  CA-PRVT-LBL-GBCK-PCT-N 13580042
135900           SET PS-CHANGE-MADE   TO  TRUE.                         13590042
136000***                                                               13600042
136100     IF PS-NO-CHANGES-MADE                                        13610042
136200        IF CA-APB-LI-FUNG-GBCK-AMT  NOT =  CA-LI-FUNG-GBCK-AMT-N  13620042
136300           SET PS-CHANGE-MADE   TO  TRUE.                         13630042
136400***                                                               13640042
136500     IF PS-NO-CHANGES-MADE                                        13650042
136600        IF CA-APB-LI-FUNG-GBCK-PCT  NOT =  CA-LI-FUNG-GBCK-PCT-N  13660042
136700           SET PS-CHANGE-MADE   TO  TRUE.                         13670042
136800***                                                               13680042
136900***  IF NO FIELDS WERE CHANGED = SEND A MESSAGE, NO A/P TBL UPDATE13690042
137000                                                                  13700042
137100     IF PS-NO-CHANGES-MADE                                        13710042
137200        MOVE PC-TSYMSG-00046        TO  DP020-MSG-NUMBER          13720042
137300        SET DP020-MSG-WARNING       TO  TRUE                      13730042
137400        SET PS-EDIT-ERROR           TO  TRUE                      13740042
137500*       MOVE -1                     TO APCTVRL                    13750042
137600        MOVE -1                     TO APLAMTL                    13760042
137700        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                      13770042
137800     ELSE                                                         13780042
137900        PERFORM 5100-PERFORM-AP-CNTL-UPDATE                       13790042
138000        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                     13800042
138100*                                                                 13810042
138200*                                                                 13820042
138300******************************************************************13830042
138400*  UPDATE THE AP CONTROL TABLE.                                  *13840042
138500******************************************************************13850042
138600 5100-PERFORM-AP-CNTL-UPDATE.                                     13860042
138700     MOVE '*5100-PERFORM-AP-CNTL UPDATE.    *' TO DP013-PARAGRAPH.13870042
138800                                                                  13880042
138900     MOVE CA-PCT-OF-DOLLAR-VARIANCE-N                             13890042
139000                                  TO APCNTL-INVC-RCV-VAR-PCT.     13900042
139100     MOVE CA-DOLLAR-LIMIT-VARIANCE-N                              13910042
139200                                  TO APCNTL-INVC-RCV-VAR-AMT.     13920042
139300     MOVE CA-RECON-CUTOFF-DAYS-N  TO APCNTL-RECN-CTOFF-DAY-QTY.   13930042
139400     MOVE CA-PMT-FLOAT-DAYS-N     TO APCNTL-PAYT-FLOAT-DAY-QTY.   13940042
139500     MOVE CA-EXC-FLT-DAY-QTY-N    TO APCNTL-EXC-FLT-DAY-QTY.      13950042
139600     MOVE CA-RCVG-VARN-DAY-QTY-N  TO APCNTL-RCVG-VARN-DAY-QTY.    13960042
139700     MOVE CA-FIRST-RCPT-DAY-QTY-N TO APCNTL-IMPRT-RCV-DAY-QTY.    13970042
139800     MOVE CA-FIRST-PAID-DAY-QTY-N TO APCNTL-IMPRT-ALC-DAY-QTY.    13980042
139900     MOVE CA-UNJRNL-WO-DAY-QTY-N  TO APCNTL-UJ-W-O-DAY-QTY.       13990042
140000     MOVE CA-VENDOR-CHG-LIMIT-N   TO APCNTL-CHRG-LIMIT-AMT.       14000042
140100     MOVE CA-COST-CNTL-PCT-N      TO APCNTL-COST-CNTL-PCT.        14010042
140200     MOVE CA-PRVT-LBL-GBCK-AMT-N  TO APCNTL-PRVT-LBL-GBCK-AMT.    14020042
140300     MOVE CA-PRVT-LBL-GBCK-PCT-N  TO APCNTL-PRVT-LBL-GBCK-PCT.    14030042
140400     MOVE CA-LI-FUNG-GBCK-AMT-N   TO APCNTL-LI-FUNG-GBCK-AMT.     14040042
140500     MOVE CA-LI-FUNG-GBCK-PCT-N   TO APCNTL-LI-FUNG-GBCK-PCT.     14050042
140600                                                                  14060042
140700* ****  UPDATE THE A/P CONTROL (TAPCNTL) TABLE ****               14070042
140800                                                                  14080042
140900     MOVE CA-BTCH-PRC-DTE        TO APCNTL-BTCH-PRC-DTE.          14090042
141000     PERFORM 7600-UPDATE-AP-CNTL-TABLE.                           14100042
141100*            --- UPDATES SUCCESSFUL ---                           14110042
141200     IF PS-NO-EDIT-ERROR                                          14120042
141300        MOVE PC-TSYMSG-00059         TO DP020-MSG-NUMBER          14130042
141400        SET DP030-SET-CURSOR-APPL-1  TO TRUE                      14140042
141500*       MOVE -1                      TO APCTVRL                   14150042
141600        MOVE -1                      TO APLAMTL                   14160042
141700        SET DP020-MSG-INFORMATIONAL  TO TRUE.                     14170042
141800*                                                                 14180042
141900*                                                                 14190042
142000******************************************************************14200042
142100*  FILL IN THE SCREEN HEADER WITH THE DATE, TIME, PROGRAM NAME,  *14210042
142200*  AND TERMINAL NUMBER.  INDICATE THE CURRENT PROCESSING MODE.   *14220042
142300******************************************************************14230042
142400 6000-GET-DATE.                                                   14240042
142500     MOVE '*6000-GET-DATE.                  *' TO DP013-PARAGRAPH.14250042
142600                                                                  14260042
142700     EXEC CICS ASKTIME                                            14270042
142800               ABSTIME(ST-ABSTIME)                                14280042
142900     END-EXEC.                                                    14290042
143000                                                                  14300042
143100     EXEC CICS FORMATTIME                                         14310042
143200               ABSTIME(ST-ABSTIME)                                14320042
143300               YYMMDD (PV-CURRENT-DATE)                           14330042
143400               TIME   (PV-CURRENT-TIME)                           14340042
143500     END-EXEC.                                                    14350042
143600*                                                                 14360042
143700*                                                                 14370042
143800******************************************************************14380042
143900*  SELECT MAINTAINABLE INFORMATION FROM THE A/P CONTROL TABLE.   *14390042
144000*  IF THE RESOURCE IS NOT AVAILABLE, OR A DEADLOCK               *14400042
144100*  OCCURS, THE SELECT WILL BE RETRIED.  IF ANY OTHER ERRORS ARE  *14410042
144200*  DETECTED, THE RESOURCES WILL BE ROLLED BACK, AN ERROR MESSAGE *14420042
144300*  WILL BE FORMATTED AND SENT TO THE SCREEN, AND CONTROL WILL BE *14430042
144400*  RETURNED TO NATIVE CICS.                                      *14440042
144500******************************************************************14450042
144600 7000-READ-AP-CNTL-TABLE.                                         14460042
144700     MOVE '*7000-READ-AP-CNTL-TABLE.        *' TO DP013-PARAGRAPH.14470042
144800                                                                  14480042
144900       EXEC SQL                                                   14490042
145000          SELECT BTCH_PRC_DTE                                     14500042
145100               , INVC_RCV_VAR_PCT                                 14510042
145200               , INVC_RCV_VAR_AMT                                 14520042
145300               , RECN_CTOFF_DAY_QTY                               14530042
145400               , PAYT_FLOAT_DAY_QTY                               14540042
145500               , EXC_FLT_DAY_QTY                                  14550042
145600               , RCVG_VARN_DAY_QTY                                14560042
145700               , IMPRT_RCV_DAY_QTY                                14570042
145800               , IMPRT_ALC_DAY_QTY                                14580042
145900               , CHRG_LIMIT_AMT                                   14590042
146000               , COST_CNTL_PCT                                    14600042
146100               , UJ_W_O_DAY_QTY                                   14610042
146200               , PRVT_LBL_GBCK_AMT                                14620042
146300               , PRVT_LBL_GBCK_PCT                                14630042
146400               , LI_FUNG_GBCK_AMT                                 14640042
146500               , LI_FUNG_GBCK_PCT                                 14650042
146600            INTO :APCNTL-BTCH-PRC-DTE                             14660042
146700               , :APCNTL-INVC-RCV-VAR-PCT                         14670042
146800               , :APCNTL-INVC-RCV-VAR-AMT                         14680042
146900               , :APCNTL-RECN-CTOFF-DAY-QTY                       14690042
147000               , :APCNTL-PAYT-FLOAT-DAY-QTY                       14700042
147100               , :APCNTL-EXC-FLT-DAY-QTY                          14710042
147200               , :APCNTL-RCVG-VARN-DAY-QTY                        14720042
147300               , :APCNTL-IMPRT-RCV-DAY-QTY                        14730042
147400               , :APCNTL-IMPRT-ALC-DAY-QTY                        14740042
147500               , :APCNTL-CHRG-LIMIT-AMT                           14750042
147600               , :APCNTL-COST-CNTL-PCT                            14760042
147700               , :APCNTL-UJ-W-O-DAY-QTY                           14770042
147800               , :APCNTL-PRVT-LBL-GBCK-AMT                        14780042
147900               , :APCNTL-PRVT-LBL-GBCK-PCT                        14790042
148000               , :APCNTL-LI-FUNG-GBCK-AMT                         14800042
148100               , :APCNTL-LI-FUNG-GBCK-PCT                         14810042
148200            FROM TAPCNTL                                          14820042
148300       END-EXEC.                                                  14830042
148400                                                                  14840042
148500     EVALUATE TRUE                                                14850042
148600         WHEN SQLCODE = +100                                      14860042
148700             MOVE PC-TSYMSG-00148          TO DP020-MSG-NUMBER    14870042
148800             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                14880042
148900             SET DP020-MSG-FATAL           TO TRUE                14890042
149000                                                                  14900042
149100         WHEN SQLCODE = +0                                        14910042
149200             MOVE APCNTL-BTCH-PRC-DTE TO CA-BTCH-PRC-DTE          14920042
149300             MOVE APCNTL-INVC-RCV-VAR-PCT                         14930042
149400                         TO CA-PCT-OF-DOLLAR-VARIANCE-N           14940042
149500                            CA-APB-PCT-OF-DOLLAR-VARIANCE         14950042
149600             MOVE APCNTL-INVC-RCV-VAR-AMT                         14960042
149700                         TO CA-DOLLAR-LIMIT-VARIANCE-N            14970042
149800                            CA-APB-DOLLAR-LIMIT-VARIANCE          14980042
149900             MOVE APCNTL-RECN-CTOFF-DAY-QTY                       14990042
150000                         TO CA-RECON-CUTOFF-DAYS-N                15000042
150100                            CA-APB-RECON-CUTOFF-DAYS              15010042
150200             MOVE APCNTL-PAYT-FLOAT-DAY-QTY                       15020042
150300                         TO CA-PMT-FLOAT-DAYS-N                   15030042
150400                            CA-APB-PMT-FLOAT-DAYS                 15040042
150500             MOVE APCNTL-EXC-FLT-DAY-QTY                          15050042
150600                         TO CA-EXC-FLT-DAY-QTY-N                  15060042
150700                            CA-APB-EXC-FLT-DAY-QTY                15070042
150800             MOVE APCNTL-RCVG-VARN-DAY-QTY                        15080042
150900                         TO CA-RCVG-VARN-DAY-QTY-N                15090042
151000                            CA-APB-RCVG-VARN-DAY-QTY              15100042
151100             MOVE APCNTL-IMPRT-RCV-DAY-QTY                        15110042
151200                         TO CA-FIRST-RCPT-DAY-QTY-N               15120042
151300                            CA-APB-FIRST-RCPT-DAY-QTY             15130042
151400             MOVE APCNTL-IMPRT-ALC-DAY-QTY                        15140042
151500                         TO CA-FIRST-PAID-DAY-QTY-N               15150042
151600                            CA-APB-FIRST-PAID-DAY-QTY             15160042
151700             MOVE APCNTL-CHRG-LIMIT-AMT                           15170042
151800                         TO CA-VENDOR-CHG-LIMIT-N                 15180042
151900                            CA-APB-VENDOR-CHG-LIMIT               15190042
152000             MOVE APCNTL-UJ-W-O-DAY-QTY                           15200042
152100                         TO CA-UNJRNL-WO-DAY-QTY-N                15210042
152200                            CA-APB-UNJRNL-WO-DAY-QTY              15220042
152300             MOVE APCNTL-COST-CNTL-PCT                            15230042
152400                         TO CA-COST-CNTL-PCT-N                    15240042
152500                            CA-APB-COST-CNTL-PCT                  15250042
152600             MOVE APCNTL-PRVT-LBL-GBCK-AMT                        15260042
152700                         TO CA-PRVT-LBL-GBCK-AMT-N                15270042
152800                            CA-APB-PRVT-LBL-GBCK-AMT              15280042
152900             MOVE APCNTL-PRVT-LBL-GBCK-PCT                        15290042
153000                         TO CA-PRVT-LBL-GBCK-PCT-N                15300042
153100                            CA-APB-PRVT-LBL-GBCK-PCT              15310042
153200             MOVE APCNTL-LI-FUNG-GBCK-AMT                         15320042
153300                         TO CA-LI-FUNG-GBCK-AMT-N                 15330042
153400                            CA-APB-LI-FUNG-GBCK-AMT               15340042
153500             MOVE APCNTL-LI-FUNG-GBCK-PCT                         15350042
153600                         TO CA-LI-FUNG-GBCK-PCT-N                 15360042
153700                            CA-APB-LI-FUNG-GBCK-PCT               15370042
153800         WHEN SQLWARN0 NOT = SPACES                               15380042
153900         WHEN SQLCODE < ZERO                                      15390042
154000         WHEN SQLCODE > ZERO                                      15400042
154100             MOVE 'SELECT AN A/P ROW FROM THE A/P CONTROL TABLE'  15410042
154200                                     TO DP013-MESSAGE-TEXT(1)     15420042
154300             PERFORM 9900-DB2-ERROR                               15430042
154400     END-EVALUATE.                                                15440042
154500*                                                                 15450042
154600*                                                                 15460042
154700******************************************************************15470042
154800*  UPDATE THE A/P CONTROL TABLE (TAPCNTL).                       *15480042
154900*  AN ERROR MESSAGE WILL BE FORMATTED AND SENT TO THE SCREEN,    *15490042
155000*  AND CONTROL WILL BE RETURNED TO NATIVE CICS.                  *15500042
155100******************************************************************15510042
155200 7600-UPDATE-AP-CNTL-TABLE.                                       15520042
155300     MOVE '*7600-UPDATE-AP-CNTL-TABLE.      *' TO DP013-PARAGRAPH.15530042
155400                                                                  15540042
155500     EXEC SQL                                                     15550042
155600          UPDATE TAPCNTL                                          15560042
155700             SET INVC_RCV_VAR_PCT   = :APCNTL-INVC-RCV-VAR-PCT    15570042
155800               , INVC_RCV_VAR_AMT   = :APCNTL-INVC-RCV-VAR-AMT    15580042
155900               , RECN_CTOFF_DAY_QTY = :APCNTL-RECN-CTOFF-DAY-QTY  15590042
156000               , PAYT_FLOAT_DAY_QTY = :APCNTL-PAYT-FLOAT-DAY-QTY  15600042
156100               , EXC_FLT_DAY_QTY    = :APCNTL-EXC-FLT-DAY-QTY     15610042
156200               , RCVG_VARN_DAY_QTY  = :APCNTL-RCVG-VARN-DAY-QTY   15620042
156300               , IMPRT_RCV_DAY_QTY  = :APCNTL-IMPRT-RCV-DAY-QTY   15630042
156400               , IMPRT_ALC_DAY_QTY  = :APCNTL-IMPRT-ALC-DAY-QTY   15640042
156500               , CHRG_LIMIT_AMT     = :APCNTL-CHRG-LIMIT-AMT      15650042
156600               , COST_CNTL_PCT      = :APCNTL-COST-CNTL-PCT       15660042
156700               , UJ_W_O_DAY_QTY     = :APCNTL-UJ-W-O-DAY-QTY      15670042
156800               , PRVT_LBL_GBCK_AMT  = :APCNTL-PRVT-LBL-GBCK-AMT   15680042
156900               , PRVT_LBL_GBCK_PCT  = :APCNTL-PRVT-LBL-GBCK-PCT   15690042
157000               , LI_FUNG_GBCK_AMT   = :APCNTL-LI-FUNG-GBCK-AMT    15700042
157100               , LI_FUNG_GBCK_PCT   = :APCNTL-LI-FUNG-GBCK-PCT    15710042
157200          WHERE                                                   15720042
157300              BTCH_PRC_DTE          = :APCNTL-BTCH-PRC-DTE        15730042
157400     END-EXEC.                                                    15740042
157500                                                                  15750042
157600     EVALUATE TRUE                                                15760042
157700         WHEN SQLCODE = ZERO                                      15770042
157800             CONTINUE                                             15780042
157900         WHEN SQLCODE = +100                                      15790042
158000              EXEC CICS SYNCPOINT                                 15800042
158100                        ROLLBACK                                  15810042
158200                        RESP(PV-CICS-RESPONSE)                    15820042
158300              END-EXEC                                            15830042
158400              IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)          15840042
158500                  MOVE 'ROLLBACK AFTER A/P BEING UPDATED WAS NOT F15850042
158600-                      'OUND ON AN UPDATE'                        15860042
158700                                     TO DP013-MESSAGE-TEXT(1)     15870042
158800                 PERFORM 9920-CICS-ERROR                          15880042
158900             END-IF                                               15890042
159000     END-EVALUATE.                                                15900042
159100*                                                                 15910042
159200******************************************************************15920042
159300*  ROLL BACK ALL RESOURCES, FOLLOWING A DB2 ERROR.  FORMAT       *15930042
159400*  INFORMATION RELATIVE TO THE ERROR.                            *15940042
159500******************************************************************15950042
159600 9900-DB2-ERROR.                                                  15960042
159700                                                                  15970042
159800     EXEC CICS                                                    15980042
159900         SYNCPOINT                                                15990042
160000             ROLLBACK                                             16000042
160100             RESP(PV-CICS-RESPONSE)                               16010042
160200     END-EXEC.                                                    16020042
160300                                                                  16030042
160400     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    16040042
160500         MOVE PV-CICS-RESPONSE     TO RF-CICS-RESPONSE            16050042
160600         MOVE RF-ROLLBACK-FAILURE-MESSAGE                         16060042
160700                                   TO DP013-MESSAGE-TEXT(2)       16070042
160800     END-IF.                                                      16080042
160900                                                                  16090042
161000     MOVE SQLCA                TO DP013-SQLCA                     16100042
161100                                                                  16110042
161200     SET DP013-NO-ROLLBACK                                        16120042
161300         DP013-XCTL-DISPLAY-RESTART                               16130042
161400         DP013-DB2-ABEND       TO TRUE                            16140042
161500                                                                  16150042
161600     PERFORM DP013-0000-PROCESS-ABEND.                            16160042
161700                                                                  16170042
161800******************************************************************16180042
161900*  ROLL BACK ALL RESOURCES, FOLLOWING A DB2 ERROR.  FORMAT       *16190042
162000*  INFORMATION RELATIVE TO THE ERROR.                            *16200042
162100******************************************************************16210042
162200 9920-CICS-ERROR.                                                 16220042
162300                                                                  16230042
162400     SET DP013-ROLLBACK                                           16240042
162500         DP013-XCTL-DISPLAY-RESTART                               16250042
162600         DP013-CICS-ABEND      TO TRUE                            16260042
162700                                                                  16270042
162800     PERFORM DP013-0000-PROCESS-ABEND.                            16280042
162900                                                                  16290042
163000*----------------------------------------------------------------*16300042
163100*    ABEND PROCESSOR MODULE                                      *16310042
163200*----------------------------------------------------------------*16320042
163300                                                                  16330042
163400     COPY DPPD013.                                                16340042
