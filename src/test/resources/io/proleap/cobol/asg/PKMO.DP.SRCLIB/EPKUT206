000100*----------------------------------------------------------       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.           EPKUT206.                                  00040003
000500 AUTHOR.               MEDHA CHOUDHURY.                           00050000
000510 INSTALLATION.         KOHLS DEPARTMENT STORES.                   00051000
000600 DATE-WRITTEN.         DECEMBER 12, 2007.                         00060000
000700                                                                  00070000
000800*-------------------------------------------------------------*   00080000
000900*    FULL FILE HEADER FORMATTER                               *   00090000
001000*-------------------------------------------------------------*   00100000
001100* THIS PROGRAM WILL READ THE OFFER FILES AND CREATE FORMATTED *   00110000
001200* OFFERS FILE WITH APPROPRIATE HEADERS                        *   00120000
001300*                                                             *   00130000
001401* EACH INPUT OFFER FILE IS MAPPED TO THE POS STORE SERVER     *   00140100
001402* DATABASE, WHICH IS DESCRIBED BELOW. ALSO INPUT TO THE       *   00140200
001403* PROGRAM IS THE STORE LIST FILE, WHICH WILL HELP TO FORMAT   *   00140300
001404* ONE SET OF HEADERS PER UNIQUE STORE NUMBER.                 *   00140400
001410*-------------------------------------------------------------*   00141000
001420*  INPUT FILES:                       DESCRIPTION             *   00142000
001421*  --------------                   ---------------           *   00142100
001422*   INP01                      FILE MAPPED TO XST_OFR         *   00142200
001423*   INP02                      FILE MAPPED TO XST_OFR_SECT    *   00142300
001424*   INP03                      FILE MAPPED TO XST_OFR_BWP     *   00142400
001425*   INP04                      FILE MAPPED TO XST_OFR_MDSE_SET*   00142500
001431*   INP05                      STORE LIST FILE                *   00143100
001432*                                                             *   00143200
001433*  ALL THE ABOVE INPUT FILES ARE CREATED IN PROGRAM EPKUT202  *   00143300
001434*-------------------------------------------------------------*   00143400
001435*                                                             *   00143500
001436*  INPUT:                                                     *   00143600
001437*        OFFERS-DATA-FILE                 EPRD201             *   00143700
001438*        OFFERS-SECTION-FILE              EPRD202             *   00143800
001439*        OFFERS-BWP-FILE                  EPRD203             *   00143900
001440*        OFFERS-MDSE-FILE                 EPRD204             *   00144000
001441*        STORE-LIST-FILE                  EPRD206             *   00144100
001442*                                                             *   00144200
001443*  OUTPUT:                                                    *   00144300
001444*        FORMATTED-OFFERS-FILE            EPRD200             *   00144400
001445*                                (FOR HEADER FORMAT)          *   00144500
001450*-------------------------------------------------------------*   00145000
001500* HISTORY LOG:                                                *   00150000
001600*                                                             *   00160000
001700*-------------------------------------------------------------*   00170000
001800* DATE:                                                       *   00180000
001900* WR/IR#:                                                     *   00190000
002000* PROGRAMMER:                                                 *   00200000
002100* DESCRIPTION:                                                *   00210000
002200*                                                             *   00220000
002300*-------------------------------------------------------------*   00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500*-------------------------------------------------------------*   00250000
002600 CONFIGURATION SECTION.                                           00260000
002700 SOURCE-COMPUTER. IBM-3090.                                       00270000
002800 OBJECT-COMPUTER. IBM-3090.                                       00280000
002900                                                                  00290000
003000 INPUT-OUTPUT SECTION.                                            00300000
003100                                                                  00310000
003200 FILE-CONTROL.                                                    00320000
003300                                                                  00330000
003310*  INPUT:                                                     *   00331000
003320           SELECT OFFERS-DATA-FILE                                00332000
003330             ASSIGN TO INP01.                                     00333000
003340                                                                  00334000
003350           SELECT OFFERS-SECTION-FILE                             00335000
003360             ASSIGN TO INP02.                                     00336000
003370                                                                  00337000
003380           SELECT OFFERS-BWP-FILE                                 00338000
003390             ASSIGN TO INP03.                                     00339000
003400                                                                  00340000
003500           SELECT OFFERS-MDSE-FILE                                00350000
003600             ASSIGN TO INP04.                                     00360000
003610                                                                  00361000
003650           SELECT STORE-LIST-FILE                                 00365000
003651             ASSIGN TO INP05.                                     00365100
003652                                                                  00365200
003653*  OUTPUT:                                                    *   00365300
003654           SELECT FORMATTED-OFFERS-FILE                           00365400
003655             ASSIGN TO OUT01.                                     00365500
003660                                                                  00366000
003700*-------------------------------------------------------------*   00370000
003800 DATA DIVISION.                                                   00380000
003900*----------------------------------------------------------       00390000
004000 FILE SECTION.                                                    00400000
004100                                                                  00410000
004210 FD  OFFERS-DATA-FILE                                             00421000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     RECORD CONTAINS 160 CHARACTERS                               00450000
004510     BLOCK CONTAINS 0 RECORDS                                     00451000
004600     DATA RECORD IS OFFERS-DATA-RECORD.                           00460000
004700                                                                  00470000
004800 01  OFFERS-DATA-RECORD           PIC X(160).                     00480000
004801                                                                  00480100
004810 FD  OFFERS-SECTION-FILE                                          00481000
004820     RECORDING MODE IS F                                          00482000
004830     LABEL RECORDS ARE STANDARD                                   00483000
004840     RECORD CONTAINS 120 CHARACTERS                               00484000
004841     BLOCK CONTAINS 0 RECORDS                                     00484100
004850     DATA RECORD IS OFFERS-SECTION-RECORD.                        00485000
004860                                                                  00486000
004870 01  OFFERS-SECTION-RECORD             PIC X(120).                00487000
004930                                                                  00493000
004931 FD  OFFERS-BWP-FILE                                              00493100
004932     RECORDING MODE IS F                                          00493200
004933     LABEL RECORDS ARE STANDARD                                   00493300
004934     RECORD CONTAINS 110 CHARACTERS                               00493400
004935     BLOCK CONTAINS 0 RECORDS                                     00493500
004936     DATA RECORD IS OFFERS-BWP-RECORD.                            00493600
004937                                                                  00493700
004938 01  OFFERS-BWP-RECORD                 PIC X(110).                00493800
004939                                                                  00493900
004940 FD  OFFERS-MDSE-FILE                                             00494000
004941     RECORDING MODE IS F                                          00494100
004942     LABEL RECORDS ARE STANDARD                                   00494200
004943     RECORD CONTAINS 90 CHARACTERS                                00494300
004944     BLOCK CONTAINS 0 RECORDS                                     00494400
004945     DATA RECORD IS OFFERS-MDSE-RECORD.                           00494500
004946                                                                  00494600
004947 01  OFFERS-MDSE-RECORD                PIC X(90).                 00494700
004948                                                                  00494800
004949 FD  STORE-LIST-FILE                                              00494900
004950     RECORDING MODE IS F                                          00495000
004951     LABEL RECORDS ARE STANDARD                                   00495100
004952     RECORD CONTAINS 50 CHARACTERS                                00495200
004953     BLOCK CONTAINS 0 RECORDS                                     00495300
004954     DATA RECORD IS STORE-LIST-RECORD.                            00495400
004955                                                                  00495500
004956 01  STORE-LIST-RECORD                 PIC X(50).                 00495600
004957                                                                  00495700
004958 FD  FORMATTED-OFFERS-FILE                                        00495800
004959     RECORDING MODE IS V                                          00495900
004960     RECORD IS VARYING IN SIZE                                    00496000
004961     FROM 1 TO 200 CHARACTERS                                     00496100
004962     DEPENDING ON PV-BYTE-COUNT                                   00496200
004963     LABEL RECORDS ARE STANDARD                                   00496300
004964     DATA RECORD IS FORMATTED-OFFERS-RECORD.                      00496400
004965                                                                  00496500
004966 01  FORMATTED-OFFERS-RECORD.                                     00496600
004967     05  FORM-OFR-FLD                  PIC X(01)                  00496700
004968         OCCURS 200 TIMES                                         00496800
004969              INDEXED BY                                          00496900
004970              FORM-OFR-LEN.                                       00497000
004980                                                                  00498000
005000*----------------------------------------------------------       00500000
005100 WORKING-STORAGE SECTION.                                         00510000
005200                                                                  00520000
005300 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      00530000
005400                                                  COMP SYNC.      00540000
005500     88  AC-INPUT-CONTROL-CARD-ERROR              VALUE +4003.    00550000
005700     88  AC-DB2-ERROR                             VALUE +4013.    00570000
005800     88  AC-INPUT-FILE-EMPTY                      VALUE +4008.    00580001
005900     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00590000
006000                                                                  00600000
006100*----------------------------------------------------------       00610000
006200* PC- PROGRAM CONSTANTS                                           00620000
006300*----------------------------------------------------------       00630000
006400 01  PC-PROGRAM-CONSTANTS.                                        00640000
006500     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'EPKUT206'. 00650000
006600     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00660000
006610     05  PC-FIELD-LENGTH              PIC S9(03) VALUE +10 COMP-3.00661000
006620     05  PC-CSV-DELIMITER             PIC X(01) VALUE '|'.        00662000
006621     05  PC-NULL-VALUE                PIC X(01) VALUE '~'.        00662100
006622     05  PC-UNDER-SCORE               PIC X(01) VALUE '_'.        00662200
006623     05  PC-DASH                      PIC X(01) VALUE '-'.        00662300
006624     05  PC-ONE-SPACE                 PIC X(01) VALUE ' '.        00662400
006625     05  PC-ONE-ZERO                  PIC X(01) VALUE '0'.        00662500
006630     05  PC-TIME-START                PIC X(08) VALUE '00:00:01'. 00663000
006640     05  PC-TIME-END                  PIC X(08) VALUE '23:59:59'. 00664000
006641     05  PC-STORE-SPECIFIC-GRP        PIC X(05) VALUE '05000'.    00664100
006642     05  PC-FIVE-ZERO                 PIC X(05) VALUE '00000'.    00664200
006643     05  PC-HDR-IND                   PIC X(03) VALUE 'HDR'.      00664300
006644     05  PC-OFR-IND                   PIC X(03) VALUE 'OFR'.      00664400
006650                                                                  00665000
006800*----------------------------------------------------------       00680000
006900* PV- PROGRAM VARIABLES                                           00690000
007000*----------------------------------------------------------       00700000
007100 01  PV-PROGRAM-STATUS.                                           00710000
007200     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     00720000
007300     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACES.     00730000
007400     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACES.     00740000
007500     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      00750000
007600     05  PV-SQL-SUB                   PIC S9(4) VALUE +0 COMP.    00760000
008351*                                                                 00835100
008364 01  PV-PROGRAM-VARIABLES.                                        00836400
008365     05  PV-TALLY                     PIC S9(03) COMP-3 VALUE +0. 00836500
008366     05  PV-BYTE-COUNT                PIC  9(04) VALUE ZERO.      00836600
008367     05  PV-BYTE-COUNT-OFFER          PIC  9(04) VALUE ZERO.      00836700
008368     05  PV-SQL-SUB                   PIC  9(01) VALUE ZERO.      00836800
008369     05  PV-SPACE                     PIC  X(01).                 00836900
008370     05  PV-DISPLAY-INDEX             PIC S9(04) COMP.            00837000
008400                                                                  00840000
008401     05  PV-VARIABLE-OUTPUT-FIELD.                                00840100
008402         10  PV-BIT-VARIABLE          PIC X(01)                   00840200
008403                                          VALUE SPACES            00840300
008404                                          OCCURS 50 TIMES         00840400
008405                                          INDEXED BY              00840500
008406                                          PV-BIT-IDX              00840600
008407                                          PV-STR-IDX              00840700
008408                                          PV-EOF-IDX.             00840800
008409                                                                  00840900
008410     05  PV-VARIABLE-OUTPUT-CODE.                                 00841000
008411         10  PV-BIT-CODE              PIC X(01)                   00841100
008412                                          VALUE SPACES            00841200
008413                                          OCCURS 3 TIMES          00841300
008414                                          INDEXED BY              00841400
008415                                          PV-CDE-BIT-IDX          00841500
008416                                          PV-CDE-STR-IDX          00841600
008417                                          PV-CDE-EOF-IDX.         00841700
008418                                                                  00841800
008419     05  PV-VARIABLE-ID.                                          00841900
008420         10 PV-EFBM-VAR               PIC X(01)                   00842000
008421                                          VALUE SPACES            00842100
008422                                          OCCURS 10 TIMES         00842200
008423                                          INDEXED BY              00842300
008424                                          PV-EFBM-BIT-IDX         00842400
008425                                          PV-EFBM-IDX.            00842500
008426                                                                  00842600
008427     05  PV-SAVE-PREV-TIMESTAMP       PIC X(26) VALUE SPACES.     00842700
008428     05  PV-TIMESTAMP                 PIC X(26) VALUE SPACES.     00842800
008429     05  PV-CURRENT-TMST REDEFINES    PV-TIMESTAMP.               00842900
008430         10  PV-CURR-YYYY             PIC 9(04).                  00843000
008431         10  FILLER                   PIC X(01).                  00843100
008432         10  PV-CURR-MO               PIC 9(02).                  00843200
008433         10  FILLER                   PIC X(01).                  00843300
008434         10  PV-CURR-DD               PIC 9(02).                  00843400
008435         10  FILLER                   PIC X(01).                  00843500
008436         10  PV-CURR-HH               PIC 9(02).                  00843600
008437         10  FILLER                   PIC X(01).                  00843700
008438         10  PV-CURR-MM               PIC 9(02).                  00843800
008439         10  FILLER                   PIC X(01).                  00843900
008440         10  PV-CURR-SS               PIC 9(02).                  00844000
008441         10  FILLER                   PIC X(01).                  00844100
008442         10  PV-CURR-SSSSSS           PIC 9(06).                  00844200
008443                                                                  00844300
008444     05  PV-HEADER-TMST.                                          00844400
008445         10  PV-HEADER-YYYY           PIC 9(04)  VALUE ZERO.      00844500
008446         10  PV-HEADER-MO             PIC 9(02)  VALUE ZERO.      00844600
008447         10  PV-HEADER-DD             PIC 9(02)  VALUE ZERO.      00844700
008448         10  PV-HEADER-HH             PIC 9(02)  VALUE ZERO.      00844800
008449         10  PV-HEADER-MM             PIC 9(02)  VALUE ZERO.      00844900
008450         10  PV-HEADER-SS             PIC 9(02)  VALUE ZERO.      00845000
008451                                                                  00845100
008452     05  PV-FORMAT-HDR-DIST-DTE.                                  00845200
008453         10  PV-FORMAT-YYYY           PIC X(04).                  00845300
008454         10  PV-FORMAT-MM             PIC X(02).                  00845400
008455         10  PV-FORMAT-DD             PIC X(02).                  00845500
008456                                                                  00845600
008457     05  PV-FORMAT-EVNT-OFFR.                                     00845700
008458         10  PV-FORMAT-EVENT-ID       PIC 9(10).                  00845800
008459         10  PV-FORMAT-OFFER-ID       PIC 9(10).                  00845900
008460                                                                  00846000
008461     05  PV-EFF-WORK-DTE.                                         00846100
008462         10  PV-EFF-WORK-YYYY         PIC X(04).                  00846200
008463         10  PV-EFF-WORK-MM           PIC X(02).                  00846300
008464         10  PV-EFF-WORK-DD           PIC X(02).                  00846400
008465                                                                  00846500
008466     05  PV-FORMAT-EFFECTIVE-DTE.                                 00846600
008467         10  PV-EFFECT-YYYY           PIC X(04).                  00846700
008468         10  PV-EFFECT-DASH-1         PIC X(01) VALUE '-'.        00846800
008469         10  PV-EFFECT-MM             PIC X(02).                  00846900
008470         10  PV-EFFECT-DASH-2         PIC X(01) VALUE '-'.        00847000
008471         10  PV-EFFECT-DD             PIC X(02).                  00847100
008472         10  PV-EFFECT-SPCE-1         PIC X(01) VALUE ' '.        00847200
008473         10  PV-EFFECT-TIME           PIC X(08).                  00847300
008474                                                                  00847400
008475     05  PV-QUOTIENT                  PIC 9(04)  VALUE ZERO.      00847500
008476     05  PV-RMDR-4                    PIC 9(04)  VALUE ZERO.      00847600
008477     05  PV-RMDR-100                  PIC 9(04)  VALUE ZERO.      00847700
008478                                                                  00847800
008479                                                                  00847900
008480                                                                  00848000
008481*----------------------------------------------------------       00848100
008482* PV- PROGRAM COUNT VARIABLES                                     00848200
008483*----------------------------------------------------------       00848300
008484 01  PV-PROGRAM-COUNTERS.                                         00848400
008485     05  PV-OFFER-WRITEN              PIC 9(09) VALUE 0.          00848500
008486     05  PV-OFFER-SECTION             PIC 9(09) VALUE 0.          00848600
008487     05  PV-OFFER-BWP                 PIC 9(09) VALUE 0.          00848700
008488     05  PV-OFFER-MDSE                PIC 9(09) VALUE 0.          00848800
008489     05  PV-OFFER-STORE               PIC 9(09) VALUE 0.          00848900
008490     05  PV-TOTAL-RECORDS-OUT         PIC 9(09) VALUE 0.          00849000
008491     05  PV-PIPE-COUNT                PIC 9(04) VALUE 0.          00849100
008492                                                                  00849200
008500*----------------------------------------------------------------*00850000
008501* PV- PROGRAM VARIABLES OFFER RANGE FOR A STORE                  *00850100
008502*----------------------------------------------------------------*00850200
008503 01  PV-OFFER-RANGE.                                              00850300
008504     05  PV-BEGIN-OFR-ID              PIC 9(10).                  00850400
008505     05  PV-END-OFR-ID                PIC 9(10).                  00850500
008506     05  PV-STORE-NBR-RANGE           PIC 9(05).                  00850600
008507     05  PV-CURRENT-FILE-STORE        PIC 9(05).                  00850700
008508                                                                  00850800
008542*----------------------------------------------------------------*00854200
008543* PV- PREVIOUS STORE LIST RECORD                                 *00854300
008544*----------------------------------------------------------------*00854400
008545 01  PV-PREVIOUS-STRL-DATA.                                       00854500
008546     05  PV-STRL-EVNT-ID              PIC 9(10).                  00854600
008547     05  PV-STRL-OFR-ID               PIC 9(10).                  00854700
008548     05  PV-STRL-SECT-TYP-CDE         PIC X(01).                  00854800
008549     05  PV-STRL-GRP-ID               PIC 9(05).                  00854900
008550     05  PV-STRL-GRP-TYP-CDE          PIC 9(05).                  00855000
008551     05  PV-STRL-IE-IND               PIC X(01).                  00855100
008552     05  PV-STRL-STR-NBR              PIC 9(05).                  00855200
008553                                                                  00855300
008554*----------------------------------------------------------------*00855400
008555* PS- PROGRAM SWITCHES                                           *00855500
008556*----------------------------------------------------------------*00855600
008557 01  PS-PROGRAM-SWITCHES.                                         00855700
008558     05  PS-END-OF-OFR-SW             PIC  X(01) VALUE 'N'.       00855800
008559         88  PS-END-OFR-FILE                     VALUE 'Y'.       00855900
008560         88  PS-NOT-END-OFR-FILE                 VALUE 'N'.       00856000
008561     05  PS-END-OF-SEC-SW             PIC  X(01) VALUE 'N'.       00856100
008562         88  PS-END-SEC-FILE                     VALUE 'Y'.       00856200
008563         88  PS-NOT-END-SEC-FILE                 VALUE 'N'.       00856300
008564     05  PS-END-OF-BWP-SW             PIC  X(01) VALUE 'N'.       00856400
008565         88  PS-END-BWP-FILE                     VALUE 'Y'.       00856500
008566         88  PS-NOT-END-BWP-FILE                 VALUE 'N'.       00856600
008567     05  PS-END-OF-MDSE-SW            PIC  X(01) VALUE 'N'.       00856700
008568         88  PS-END-OF-MDSE-FILE                 VALUE 'Y'.       00856800
008569         88  PS-NOT-END-OF-MDSE-FILE             VALUE 'N'.       00856900
008570     05  PS-END-OF-STORE-SW           PIC  X(01) VALUE 'N'.       00857000
008571         88  PS-END-OF-STORE-FILE                VALUE 'Y'.       00857100
008572         88  PS-NOT-END-OF-STORE-FILE            VALUE 'N'.       00857200
008573     05  PS-END-OF-PROCES-SW          PIC  X(01) VALUE 'N'.       00857300
008574         88  PS-END-OF-PROCESSING                VALUE 'Y'.       00857400
008575         88  PS-NOT-END-OF-PROCESSING            VALUE 'N'.       00857500
008576     05  PS-READY-TRACE-SW            PIC  X(01) VALUE 'N'.       00857600
008577         88 PS-READY-TRACE                       VALUE 'Y'.       00857700
008578         88 PS-RESET-TRACE                       VALUE 'N'.       00857800
008579                                                                  00857900
008580* THESE SWITCHES ARE USED TO WRITE THE HEADER RECORDS             00858000
008581                                                                  00858100
008582     05  PS-OFFER-HDR-WRITEN-SW       PIC  X(01) VALUE 'N'.       00858200
008583         88 PS-OFFER-HDR-WRITEN                  VALUE 'Y'.       00858300
008584         88 PS-OFFER-HDR-NOT-WRITEN              VALUE 'N'.       00858400
008585     05  PS-SECTN-HDR-WRITEN-SW       PIC  X(01) VALUE 'N'.       00858500
008586         88 PS-SECTN-HDR-WRITEN                  VALUE 'Y'.       00858600
008587         88 PS-SECTN-HDR-NOT-WRITEN              VALUE 'N'.       00858700
008588     05  PS-BWP-HDR-WRITEN-SW         PIC  X(01) VALUE 'N'.       00858800
008589         88 PS-BWP-HDR-WRITEN                    VALUE 'Y'.       00858900
008590         88 PS-BWP-HDR-NOT-WRITEN                VALUE 'N'.       00859000
008591     05  PS-MDSE-HDR-WRITEN-SW        PIC  X(01) VALUE 'N'.       00859100
008592         88 PS-MDSE-HDR-WRITEN                   VALUE 'Y'.       00859200
008593         88 PS-MDSE-HDR-NOT-WRITEN               VALUE 'N'.       00859300
008594                                                                  00859400
008595* THESE SWITCHES ARE USED TO DETERMINE IF OFFER IS IN RANGE.      00859500
008596                                                                  00859600
008597     05  PS-EP201-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00859700
008598         88 PS-EP201-OFR-INRANGE                 VALUE 'Y'.       00859800
008599         88 PS-EP201-OFR-NOT-INRANGE             VALUE 'N'.       00859900
008600     05  PS-EP202-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00860000
008601         88 PS-EP202-OFR-INRANGE                 VALUE 'Y'.       00860100
008602         88 PS-EP202-OFR-NOT-INRANGE             VALUE 'N'.       00860200
008603     05  PS-EP203-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00860300
008604         88 PS-EP203-OFR-INRANGE                 VALUE 'Y'.       00860400
008605         88 PS-EP203-OFR-NOT-INRANGE             VALUE 'N'.       00860500
008606     05  PS-EP204-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00860600
008607         88 PS-EP204-OFR-INRANGE                 VALUE 'Y'.       00860700
008608         88 PS-EP204-OFR-NOT-INRANGE             VALUE 'N'.       00860800
008609                                                                  00860900
008610*----------------------------------------------------------       00861000
008620* CONTROL CARD EPCC252 LAYOUT                                     00862000
008700*----------------------------------------------------------       00870000
008800     COPY EPRD252.                                                00880000
008900                                                                  00890000
008910*----------------------------------------------------------       00891000
008920* COPYBOOK  EPRD201 LAYOUT                                        00892000
008930*----------------------------------------------------------       00893000
008940     COPY EPRD201.                                                00894000
008950                                                                  00895000
008951*----------------------------------------------------------       00895100
008952* COPYBOOK  EPRD202 LAYOUT                                        00895200
008953*----------------------------------------------------------       00895300
008954     COPY EPRD202.                                                00895400
008955                                                                  00895500
008956*----------------------------------------------------------       00895600
008957* COPYBOOK  EPRD203 LAYOUT                                        00895700
008958*----------------------------------------------------------       00895800
008959     COPY EPRD203.                                                00895900
008960                                                                  00896000
008961*----------------------------------------------------------       00896100
008962* COPYBOOK  EPRD204 LAYOUT                                        00896200
008963*----------------------------------------------------------       00896300
008964     COPY EPRD204.                                                00896400
008965                                                                  00896500
008966*----------------------------------------------------------       00896600
008967* COPYBOOK  EPRD200 LAYOUT     (FOR HEADER RECORD)                00896700
008968*----------------------------------------------------------       00896800
008969     COPY EPRD200.                                                00896900
008970                                                                  00897000
008971*----------------------------------------------------------       00897100
008972* COPYBOOK  EPRD206 LAYOUT                                        00897200
008990*----------------------------------------------------------       00899000
009010     COPY EPRD206.                                                00901000
009100                                                                  00910000
009200*------------------------------------------------------------     00920000
009300* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         00930000
009400*------------------------------------------------------------     00940000
009500     COPY DPWS004.                                                00950000
009600                                                                  00960000
009610*-----------------------------------------------------------      00961000
009620* DB2 MESSAGE AREA                                                00962000
009630*-----------------------------------------------------------      00963000
009640     COPY SQLCA2.                                                 00964000
009650                                                                  00965000
009700*-----------------------------------------------------------      00970000
009800* DB2 COMMUNICATIONS AREA                                         00980000
009900*-----------------------------------------------------------      00990000
010000     EXEC SQL                                                     01000000
010100          INCLUDE SQLCA                                           01010000
010200     END-EXEC.                                                    01020000
010300                                                                  01030000
010693                                                                  01069300
010700*----------------------------------------------------------       01070000
010800 PROCEDURE DIVISION.                                              01080000
010900*----------------------------------------------------------       01090000
011000 0000-MAINLINE.                                                   01100000
011100                                                                  01110000
011200     PERFORM 1000-INITIALIZATION.                                 01120000
011300                                                                  01130000
011400     PERFORM 2000-PROCESS-OFFERS                                  01140000
011410             UNTIL PS-END-OF-PROCESSING.                          01141000
011510                                                                  01151000
011600     PERFORM 9200-WRAPUP.                                         01160000
011800                                                                  01180000
011900     GOBACK.                                                      01190000
012000                                                                  01200000
012100*0000-EXIT.                                                       01210000
012200 EJECT.                                                           01220000
012300                                                                  01230000
012400*----------------------------------------------------------       01240000
012500* 1000-INITIALIZATION.                                            01250000
012600*     INITIALIZES VARIABLES, OPENS ANY FILES, AND READS           01260000
012700*     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT      01270000
012800*     FILES.                                                      01280000
012900*----------------------------------------------------------       01290000
013000 1000-INITIALIZATION.                                             01300000
013100                                                                  01310000
013110     DISPLAY '****************************************'.          01311004
013120     DISPLAY '**          EPKUT206 STARTED          **'.          01312004
013130     DISPLAY '****************************************'.          01313004
013140                                                                  01314004
013200     INITIALIZE PV-PROGRAM-VARIABLES.                             01320000
013300                                                                  01330000
013310     INITIALIZE PV-OFFER-RANGE.                                   01331000
013320                                                                  01332000
013330     INITIALIZE PV-PREVIOUS-STRL-DATA.                            01333000
013380                                                                  01338000
013390     SET PS-NOT-END-OFR-FILE      TO TRUE.                        01339006
013391     SET PS-NOT-END-SEC-FILE      TO TRUE.                        01339106
013392     SET PS-NOT-END-BWP-FILE      TO TRUE.                        01339206
013393     SET PS-NOT-END-OF-MDSE-FILE  TO TRUE.                        01339306
013394     SET PS-NOT-END-OF-STORE-FILE TO TRUE.                        01339406
013395                                                                  01339506
013397     PERFORM 1100-OPEN-FILES.                                     01339700
013398                                                                  01339800
013400     PERFORM 1200-GET-DB2-TIMESTAMP.                              01340000
013500                                                                  01350000
013501     PERFORM 6000-READ-STORE-LIST-FILE.                           01350101
013502                                                                  01350201
013503     IF PS-END-OF-STORE-FILE                                      01350301
013504        DISPLAY '****     STORE LIST FILE IS EMPTY    ***'        01350401
013505     ELSE                                                         01350505
013506        PERFORM 3200-MOVE-STORE-LIST-VALUES                       01350605
013507        PERFORM 3100-GET-OFFER-RANGE                              01350705
013508     END-IF.                                                      01350801
013540                                                                  01354000
013800     PERFORM 6100-READ-OFFER-DATA.                                01380000
013801                                                                  01380101
013802     IF PS-END-OFR-FILE                                           01380201
013803        DISPLAY '***    OFFERS FILE IS EMPTY    ****'             01380301
013804     ELSE                                                         01380401
013810        PERFORM 5100-DETERMINE-OFFER-INRANGE                      01381001
013820     END-IF.                                                      01382001
013900                                                                  01390000
014000     PERFORM 6200-READ-SECTN-DATA.                                01400000
014001                                                                  01400101
014002     IF PS-END-SEC-FILE                                           01400201
014003        DISPLAY '***    SECTION FILE IS EMPTY    ****'            01400301
014004     ELSE                                                         01400401
014010        PERFORM 5200-DETERMINE-SECTN-INRANGE                      01401001
014020     END-IF.                                                      01402001
014100                                                                  01410000
014200     PERFORM 6300-READ-BWP-DATA.                                  01420000
014201                                                                  01420101
014202     IF PS-END-BWP-FILE                                           01420201
014203        DISPLAY '***    BWP   FILE IS EMPTY    ****'              01420301
014204     ELSE                                                         01420401
014210        PERFORM 5300-DETERMINE-BWP-INRANGE                        01421001
014220     END-IF.                                                      01422001
014300                                                                  01430000
014400     PERFORM 6400-READ-MDSE-DATA.                                 01440000
014401                                                                  01440101
014402     IF PS-END-OF-MDSE-FILE                                       01440201
014403        DISPLAY '***    MDSE  FILE IS EMPTY    ****'              01440301
014404     ELSE                                                         01440401
014410        PERFORM 5400-DETERMINE-MDSE-INRANGE                       01441001
014420     END-IF.                                                      01442001
014430                                                                  01443001
014500     PERFORM 1300-DETERMINE-PROCESS.                              01450001
014600                                                                  01460001
015000*1000-EXIT.                                                       01500000
015100 EJECT.                                                           01510000
015200                                                                  01520000
015201*----------------------------------------------------------       01520100
015202* 1100-OPEN-FILES.                                                01520200
015203*     THIS PARAGRAPH OPENS ALL THE FILES IN MODE REQUIRED         01520300
015204*----------------------------------------------------------       01520400
015205 1100-OPEN-FILES.                                                 01520500
015206                                                                  01520600
015207     OPEN INPUT OFFERS-DATA-FILE                                  01520700
015208                OFFERS-SECTION-FILE                               01520800
015209                OFFERS-BWP-FILE                                   01520900
015210                OFFERS-MDSE-FILE.                                 01521000
015211                                                                  01521100
015212     OPEN INPUT STORE-LIST-FILE.                                  01521200
015213                                                                  01521300
015214     OPEN OUTPUT FORMATTED-OFFERS-FILE.                           01521400
015215                                                                  01521500
015216*1100-EXIT.                                                       01521600
015220 EJECT.                                                           01522000
015230                                                                  01523000
015300*----------------------------------------------------------       01530000
015400* 1200-GET-DB2-TIMESTAMP.                                         01540000
015500*     THIS PARAGRAPH GETS THE DB2 TIMESTAMP WHICH WILL BE         01550000
015510*     USED TO UPDATE THE FILE-DIST-DATE AND THE CRT-TIMESTAMP     01551000
015520*     ON THE HEADER RECORD (EPRD200).                             01552000
015600*----------------------------------------------------------       01560000
015700 1200-GET-DB2-TIMESTAMP.                                          01570000
015900                                                                  01590000
016000     EXEC SQL                                                     01600000
016100          SELECT CURRENT TIMESTAMP                                01610000
016200          INTO  :PV-TIMESTAMP                                     01620000
016210          FROM   SYSIBM.SYSDUMMY1                                 01621000
016211     END-EXEC.                                                    01621100
016212                                                                  01621200
016213     IF SQLCODE NOT EQUAL ZERO                                    01621300
016214        MOVE '1200-GET-DB2-TIMESTAMP' TO PV-PARAGRAPH-NAME        01621400
016215        MOVE 'CANNOT GET CURRENT TIMESTAMP'                       01621500
016216                                    TO PV-DB2-OPERATION           01621600
016217        PERFORM 9800-SQL-ABEND                                    01621700
016218     END-IF.                                                      01621800
016220                                                                  01622000
016230*** SET UP TIMESTAMP    INFORMATION FOR HEADER                    01623000
016240                                                                  01624000
016250     MOVE PV-CURR-YYYY         TO PV-HEADER-YYYY.                 01625000
016270                                                                  01627000
016280     MOVE PV-CURR-MO           TO PV-HEADER-MO.                   01628000
016291                                                                  01629100
016292     MOVE PV-CURR-DD           TO PV-HEADER-DD.                   01629200
016294                                                                  01629400
016295     MOVE PV-CURR-HH           TO PV-HEADER-HH.                   01629500
016296                                                                  01629600
016298     MOVE PV-CURR-MM           TO PV-HEADER-MM.                   01629800
016299                                                                  01629900
016301     MOVE PV-CURR-SS           TO PV-HEADER-SS.                   01630100
016302                                                                  01630200
016303*** SET UP FILE DISTRIBUTION DATE FOR HEADER RECORD               01630300
016304                                                                  01630400
016305     MOVE PV-CURR-YYYY         TO PV-FORMAT-YYYY.                 01630500
016306                                                                  01630600
016307     MOVE PV-CURR-MO           TO PV-FORMAT-MM.                   01630700
016308                                                                  01630800
016309     MOVE PV-CURR-DD           TO PV-FORMAT-DD.                   01630900
016311                                                                  01631100
016320*1200-EXIT.                                                       01632000
016400 EJECT.                                                           01640000
016410*----------------------------------------------------------       01641001
016420* 1300-DETERMINE-PROCESS                                          01642001
016430*     THIS PARAGRAPH BASED ON THE READ FLAGS DETERMINES           01643001
016431*     PROCESSING                                                  01643101
016432*     - IF ALL THE INPUT FILES ARE EMPTY, DISPLAY AND END THE     01643201
016433*       PROGRAM SUCCESSFULY                                       01643301
016434*     - IF ALL THE INPUT FILES ARE NOT EMPTY, PROCESS FURTHER     01643401
016435*     - IF STR LIST FILE IS EMPTY, BUT THE OTHER FOUR ARE NOT     01643508
016436*       EMPTY PROCEED FURTHER, THIS CONDITION WILL ARISE WHEN     01643608
016437*       THE FULL FILE IS BEING FORMATTED FOR A SINGLE STORE, TO   01643708
016438*       GET THE OFR RANGE COMPLETE STORE LIST FILE IS BEING READ. 01643808
016439*     - IF ONE OF THE INPUT FILES IS EPMTY, BUT THE OTHERS NOT    01643908
016440*       THEN ABEND.                                               01644008
016441*----------------------------------------------------------       01644101
016450 1300-DETERMINE-PROCESS.                                          01645001
016460                                                                  01646001
016470     EVALUATE TRUE                                                01647001
016480         WHEN   PS-END-OFR-FILE                                   01648001
016500          AND   PS-END-SEC-FILE                                   01650001
016501          AND   PS-END-BWP-FILE                                   01650101
016502          AND   PS-END-OF-MDSE-FILE                               01650201
016503          AND   PS-END-OF-STORE-FILE                              01650301
016504                                                                  01650401
016505               SET PS-END-OF-PROCESSING TO TRUE                   01650501
016507                                                                  01650701
016508         WHEN   PS-NOT-END-OFR-FILE                               01650801
016509          AND   PS-NOT-END-SEC-FILE                               01650901
016510          AND   PS-NOT-END-BWP-FILE                               01651001
016511          AND   PS-NOT-END-OF-MDSE-FILE                           01651101
016512          AND   PS-NOT-END-OF-STORE-FILE                          01651201
016513                                                                  01651301
016514               SET PS-NOT-END-OF-PROCESSING TO TRUE               01651401
016515                                                                  01651505
016516         WHEN   PS-NOT-END-OFR-FILE                               01651607
016517          AND   PS-NOT-END-SEC-FILE                               01651707
016518          AND   PS-NOT-END-BWP-FILE                               01651807
016519          AND   PS-NOT-END-OF-MDSE-FILE                           01651907
016520          AND   PS-END-OF-STORE-FILE                              01652007
016521                                                                  01652107
016522               CONTINUE                                           01652207
016523                                                                  01652307
016524         WHEN OTHER                                               01652407
016525                                                                  01652507
016526             DISPLAY '  '                                         01652607
016527             DISPLAY ' ERROR IN INPUT FILES SOME HAVE DATA OTHER' 01652707
016528             DISPLAY ' IS EMPTY ,PROGRAM CANNOT PROCEED'          01652807
016529             MOVE '1300-DETERMINE-PROCESS  ' TO PV-PARAGRAPH-NAME 01652907
016530             SET AC-INPUT-FILE-EMPTY  TO TRUE                     01653007
016531             PERFORM 9910-ABEND                                   01653107
016532                                                                  01653207
016535     END-EVALUATE.                                                01653501
016536                                                                  01653601
016537*1300-EXIT.                                                       01653701
016538 EJECT.                                                           01653801
016540                                                                  01654001
016541                                                                  01654100
016600*----------------------------------------------------------       01660000
016700* 2000-PROCESS-OFFERS.                                            01670000
016710* ----------------------------                                    01671000
016800* WHEN THE PROCESSING REACHES THIS PARAGRAPH FOR THE FIRST TIME   01680000
016801* IT ALREADY HAS THE OFFER RANGE FOR THE FIRST STORE, START       01680100
016802* FORMATTING THE HEADERS FOR THE OFFERS IN FOLLOWING ORDER        01680200
016803*                                                                 01680300
016810* (1) FORMAT THE OFR_DT_FUL HEADER AND THEN WRITE ALL THE OFFERS  01681000
016820*     DATA FOLLOWING IT FOR THE OFFER_ID RANGE.                   01682000
016821*     (THIS WOULD ALSO INVOLVE READING THE OFFERS DATA FILE INP01)01682100
016822*                                                                 01682200
023641* (2) FORMAT THE OFR_RA_FUL HEADER AND THEN WRITE ALL THE OFFERS  02364100
023642*     SECTION DATA FOLLOWING IT FOR THE OFFER_ID RANGE.           02364200
023643*     (THIS WOULD ALSO INVOLVE READING THE OFFERS SECT FILE INP02)02364300
023644*                                                                 02364400
023645* (3) FORMAT THE OFR_BT_FUL HEADER AND THEN WRITE ALL THE OFFERS  02364500
023646*     BWP DATA FOLLOWING IT FOR THE OFFER_ID RANGE.               02364600
023647*     (THIS WOULD ALSO INVOLVE READING THE OFFERS BWP  FILE INP03)02364700
023648*                                                                 02364800
023649* (4) FORMAT THE OFR_MD_FUL HEADER AND THEN WRITE ALL THE OFFERS  02364900
023650*     MDSE DATA FOLLOWING IT FOR THE OFFER_ID RANGE.              02365000
023651*     (THIS WOULD ALSO INVOLVE READING THE OFFERS MDSE FILE INP04)02365100
023652*                                                                 02365200
023653* (5) READ THE STORE LIST FILE TO GET THE RANGE OF OFFERS         02365300
023654*     FOR THE NEXT STORE.                                         02365400
023655*     (THIS WOULD ALSO INVOLVE READING THE STORE LIST  FILE INP05)02365500
023656*                                                                 02365600
023657*----------------------------------------------------------       02365700
023658 2000-PROCESS-OFFERS.                                             02365800
023659                                                                  02365900
023660     MOVE ZERO            TO  PV-OFFER-WRITEN.                    02366000
023661                                                                  02366100
023662     MOVE ZERO            TO  PV-OFFER-SECTION.                   02366200
023663                                                                  02366300
023664     MOVE ZERO            TO  PV-OFFER-BWP.                       02366400
023665                                                                  02366500
023666     MOVE ZERO            TO  PV-OFFER-MDSE.                      02366600
023669                                                                  02366900
023671     PERFORM 3300-FORMAT-WRITE-OFFER-DATA UNTIL                   02367100
023672          PS-EP201-OFR-NOT-INRANGE OR                             02367200
023673          PS-END-OFR-FILE.                                        02367300
023674                                                                  02367400
023676     PERFORM 3400-FORMAT-WRITE-SECTN-DATA UNTIL                   02367600
023677          PS-EP202-OFR-NOT-INRANGE OR                             02367700
023678          PS-END-SEC-FILE.                                        02367800
023679                                                                  02367900
023681     PERFORM 3500-FORMAT-WRITE-BWP-DATA UNTIL                     02368100
023682          PS-EP203-OFR-NOT-INRANGE OR                             02368200
023683          PS-END-BWP-FILE.                                        02368300
023684                                                                  02368400
023686     PERFORM 3600-FORMAT-WRITE-MDSE-DATA UNTIL                    02368600
023687          PS-EP204-OFR-NOT-INRANGE OR                             02368700
023688          PS-END-OF-MDSE-FILE.                                    02368800
023697                                                                  02369700
023698     PERFORM 9920-DISPLAY-TOTALS.                                 02369800
023699                                                                  02369900
023701     IF PS-END-OFR-FILE     AND                                   02370100
023702        PS-END-SEC-FILE     AND                                   02370200
023703        PS-END-BWP-FILE     AND                                   02370300
023704        PS-END-OF-MDSE-FILE AND                                   02370400
023705        PS-END-OF-STORE-FILE                                      02370500
023706        SET PS-END-OF-PROCESSING TO TRUE                          02370600
023707     ELSE                                                         02370700
023709        PERFORM 3100-GET-OFFER-RANGE                              02370900
023710        PERFORM 5100-DETERMINE-OFFER-INRANGE                      02371000
023711        PERFORM 5200-DETERMINE-SECTN-INRANGE                      02371100
023712        PERFORM 5300-DETERMINE-BWP-INRANGE                        02371200
023713        PERFORM 5400-DETERMINE-MDSE-INRANGE                       02371301
023714     END-IF.                                                      02371400
023715                                                                  02371500
023717*2000-EXIT.                                                       02371700
023718 EJECT.                                                           02371800
023719                                                                  02371900
023752*-----------------------------------------------------------------02375200
023753* 3100-GET-OFFER-RANGE.                                           02375300
023754*  THIS PARAGRAPH WILL GET THE OFFER RANGE FOR A PARTICULAR STORE 02375400
023755*  LATER THE PROGRAM USES THIS RANGE TO FORMAT THE HEADER AND '   02375500
023756*  DETAIL RECORDS.                                                02375600
023757*----------------------------------------------------------------*02375700
023758 3100-GET-OFFER-RANGE.                                            02375800
023759                                                                  02375900
023760     MOVE EP206-OFFER-ID          TO PV-BEGIN-OFR-ID.             02376000
023761     MOVE EP206-STORE-NUMBER      TO PV-STORE-NBR-RANGE.          02376100
023762                                                                  02376200
023763     DISPLAY '** BEGING OFFER RANGE  ***' PV-BEGIN-OFR-ID.        02376300
023764     SET PS-OFFER-HDR-NOT-WRITEN                                  02376400
023765         PS-SECTN-HDR-NOT-WRITEN                                  02376500
023766         PS-BWP-HDR-NOT-WRITEN                                    02376600
023767         PS-MDSE-HDR-NOT-WRITEN TO TRUE.                          02376700
023768                                                                  02376800
023769                                                                  02376900
023770     PERFORM UNTIL (PS-END-OF-STORE-FILE)                         02377000
023771      OR (EP206-STORE-NUMBER NOT EQUAL PV-STORE-NBR-RANGE)        02377100
023772                                                                  02377200
023778         PERFORM 6000-READ-STORE-LIST-FILE                        02377801
023784                                                                  02378400
023785         IF ((EP206-STORE-NUMBER = PV-STORE-NBR-RANGE)            02378500
023786             AND PS-NOT-END-OF-STORE-FILE)                        02378600
023787                                                                  02378700
023788             PERFORM 3200-MOVE-STORE-LIST-VALUES                  02378800
023790                                                                  02379000
023791         ELSE                                                     02379100
023792           IF ((EP206-STORE-NUMBER NOT =                          02379200
023793                                        PV-STORE-NBR-RANGE)       02379300
023794               AND PS-NOT-END-OF-STORE-FILE)                      02379400
023795                                                                  02379500
023796               MOVE PV-STRL-OFR-ID          TO PV-END-OFR-ID      02379600
023798           ELSE                                                   02379800
023799             IF ((EP206-STORE-NUMBER NOT =                        02379900
023800                                           PV-STORE-NBR-RANGE)    02380000
023801                 AND PS-END-OF-STORE-FILE)                        02380100
023802                                                                  02380200
023803                   MOVE PV-STRL-OFR-ID          TO PV-END-OFR-ID  02380300
023805             ELSE                                                 02380500
023806               IF ((EP206-STORE-NUMBER  = PV-STORE-NBR-RANGE)     02380600
023807                  AND  PS-END-OF-STORE-FILE)                      02380700
023808                                                                  02380800
023809                   MOVE PV-STRL-OFR-ID          TO PV-END-OFR-ID  02380900
023811               END-IF                                             02381100
023812             END-IF                                               02381200
023813           END-IF                                                 02381300
023814         END-IF                                                   02381400
023815     END-PERFORM.                                                 02381500
023816                                                                  02381600
023817     DISPLAY '** END    OFFER RANGE  ***' PV-END-OFR-ID.          02381700
023818     PERFORM 3200-MOVE-STORE-LIST-VALUES.                         02381800
023819                                                                  02381900
023820*3100-EXIT.                                                       02382000
023821 EJECT.                                                           02382100
023822*-----------------------------------------------------------------02382200
023823* 3200-MOVE-STORE-LIST-VALUES                                     02382300
023824*  THIS PARAGRAPH WILL MOVE THE VALUES READ FROM THE STORE LIST   02382400
023825*  FILE TO PROGRAM VARIABLES.                                     02382500
023826*----------------------------------------------------------------*02382600
023827 3200-MOVE-STORE-LIST-VALUES.                                     02382700
023828                                                                  02382800
023829      MOVE EP206-EVENT-ID          TO PV-STRL-EVNT-ID.            02382900
023830      MOVE EP206-OFFER-ID          TO PV-STRL-OFR-ID.             02383000
023831      MOVE EP206-OFR-SECT-TYP-CDE  TO PV-STRL-SECT-TYP-CDE.       02383100
023832      MOVE EP206-STR-GRP-TYP-CDE   TO PV-STRL-GRP-TYP-CDE.        02383200
023833      MOVE EP206-STR-GRP-ID        TO PV-STRL-GRP-ID.             02383300
023834      MOVE EP206-IE-IND            TO PV-STRL-IE-IND.             02383400
023835      MOVE EP206-STORE-NUMBER      TO PV-STRL-STR-NBR.            02383500
023836                                                                  02383600
023837*3200-EXIT.                                                       02383700
023838 EJECT.                                                           02383800
023839                                                                  02383900
023840*-----------------------------------------------------------------02384000
023841* 3300-FORMAT-WRITE-OFFER-DATA                                    02384100
023842*  THIS PARAGRAPH WILL DO THE FOLLOWING                           02384200
023843*  (1) WRITE FORMATTED HEADER RECORDS (OFR_DT_FUL)                02384300
023844*  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02384400
023845*  (3) READ THE OFFERS DATA FILE FOR NEXT RECORD                  02384500
023846*----------------------------------------------------------------*02384600
023847 3300-FORMAT-WRITE-OFFER-DATA.                                    02384700
023850                                                                  02385000
023851     IF PS-OFFER-HDR-NOT-WRITEN                                   02385100
023852        SET EP200-XST-OFFER TO TRUE                               02385200
023853        PERFORM 4100-FORMAT-AND-WRITE-HDR                         02385300
023854        SET PS-OFFER-HDR-WRITEN TO TRUE                           02385400
023855     END-IF.                                                      02385500
023856                                                                  02385600
023858     SET FORM-OFR-LEN                                             02385800
023859       TO +1.                                                     02385901
023860     MOVE 0 TO  PV-BYTE-COUNT.                                    02386000
023863     INITIALIZE FORMATTED-OFFERS-RECORD.                          02386300
023864                                                                  02386400
023865     PERFORM 6900-MOVE-DELIMITER.                                 02386500
023866     PERFORM 4250-MOVE-TRIGGER-TYPE.                              02386600
023867                                                                  02386700
023868     MOVE EP201-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02386800
023869     MOVE EP201-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02386900
023870                                                                  02387000
023871     PERFORM 4300-MOVE-EVENT-OFR-ID.                              02387100
023872     PERFORM 4350-MOVE-REST-OFFER-DATA.                           02387200
023873     PERFORM 4200-WRITE-DATA-RECORD.                              02387300
023874                                                                  02387400
023875     ADD 1 TO PV-OFFER-WRITEN.                                    02387500
023876                                                                  02387601
023877     PERFORM 6100-READ-OFFER-DATA.                                02387700
023878                                                                  02387801
023879     IF PS-NOT-END-OFR-FILE                                       02387901
023880        PERFORM 5100-DETERMINE-OFFER-INRANGE                      02388001
023881     END-IF.                                                      02388101
023882                                                                  02388200
023883*3300-EXIT.                                                       02388300
023884 EJECT.                                                           02388400
023885                                                                  02388500
023886*-----------------------------------------------------------------02388600
023887* 3400-FORMAT-WRITE-SECTN-DATA                                    02388700
023888*  THIS PARAGRAPH WILL DO THE FOLLOWING                           02388800
023889*  (1) WRITE FORMATTED HEADER RECORD (OFR_RA_FUL)                 02388900
023890*  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02389000
023891*  (3) READ THE OFFERS SECTION FILE FOR NEXT RECORD               02389100
023892*----------------------------------------------------------------*02389200
023893 3400-FORMAT-WRITE-SECTN-DATA.                                    02389300
023894                                                                  02389400
023895     IF PS-SECTN-HDR-NOT-WRITEN                                   02389500
023896        SET EP200-XST-OFR-SECT TO TRUE                            02389600
023897        PERFORM 4100-FORMAT-AND-WRITE-HDR                         02389700
023898        SET PS-SECTN-HDR-WRITEN TO TRUE                           02389800
023899     END-IF.                                                      02389900
023900                                                                  02390000
023901     SET FORM-OFR-LEN                                             02390100
023902       TO +1.                                                     02390201
023903     MOVE 0 TO  PV-BYTE-COUNT.                                    02390300
023904     INITIALIZE FORMATTED-OFFERS-RECORD.                          02390400
023905                                                                  02390500
023906     PERFORM 6900-MOVE-DELIMITER.                                 02390600
023907     PERFORM 4250-MOVE-TRIGGER-TYPE.                              02390700
023908                                                                  02390800
023909     MOVE EP202-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02390900
023910     MOVE EP202-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02391000
023911                                                                  02391100
023912     PERFORM 4300-MOVE-EVENT-OFR-ID.                              02391200
023913     PERFORM 4400-MOVE-REST-SECTION-DATA.                         02391300
023915                                                                  02391500
023916     PERFORM 4200-WRITE-DATA-RECORD.                              02391600
023917                                                                  02391700
023918     ADD 1 TO PV-OFFER-SECTION.                                   02391800
023919                                                                  02391900
023920     PERFORM 6200-READ-SECTN-DATA.                                02392000
023921                                                                  02392101
023922     IF PS-NOT-END-SEC-FILE                                       02392201
023923        PERFORM 5200-DETERMINE-SECTN-INRANGE                      02392301
023924     END-IF.                                                      02392401
023925                                                                  02392500
023926*3400-EXIT.                                                       02392600
023927 EJECT.                                                           02392700
023928                                                                  02392800
023929*-----------------------------------------------------------------02392900
023930* 3500-FORMAT-WRITE-BWP-DATA                                      02393000
023931*  THIS PARAGRAPH WILL DO THE FOLLOWING                           02393100
023932*  (1) WRITE FORMATTED HEADER RECORD (OFR_BT_FUL)                 02393200
023933*  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02393300
023934*  (3) READ THE OFFERS BWP FILE FOR NEXT RECORD                   02393400
023935*----------------------------------------------------------------*02393500
023936 3500-FORMAT-WRITE-BWP-DATA.                                      02393600
023937                                                                  02393700
023938     IF PS-BWP-HDR-NOT-WRITEN                                     02393800
023939        SET EP200-XST-OFR-BWP TO TRUE                             02393900
023940        PERFORM 4100-FORMAT-AND-WRITE-HDR                         02394000
023941        SET PS-BWP-HDR-WRITEN TO TRUE                             02394100
023942     END-IF.                                                      02394200
023943                                                                  02394300
023944     SET FORM-OFR-LEN                                             02394400
023945       TO +1.                                                     02394501
023946     MOVE 0 TO  PV-BYTE-COUNT.                                    02394600
023948     INITIALIZE FORMATTED-OFFERS-RECORD.                          02394800
023949                                                                  02394900
023950     PERFORM 6900-MOVE-DELIMITER.                                 02395000
023951     PERFORM 4250-MOVE-TRIGGER-TYPE.                              02395100
023952                                                                  02395200
023953     MOVE EP203-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02395300
023954     MOVE EP203-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02395400
023955                                                                  02395500
023956     PERFORM 4300-MOVE-EVENT-OFR-ID.                              02395600
023957     PERFORM 4450-MOVE-REST-BWP-DATA.                             02395700
023958                                                                  02395800
023959     PERFORM 4200-WRITE-DATA-RECORD.                              02395900
023960                                                                  02396000
023961     ADD 1 TO PV-OFFER-BWP.                                       02396100
023962                                                                  02396200
023963     PERFORM 6300-READ-BWP-DATA.                                  02396300
023964                                                                  02396401
023965     IF  PS-NOT-END-BWP-FILE                                      02396501
023966        PERFORM 5300-DETERMINE-BWP-INRANGE                        02396601
023967     END-IF.                                                      02396701
023968                                                                  02396801
023969*3500-EXIT.                                                       02396901
023970 EJECT.                                                           02397001
023971                                                                  02397101
023972*-----------------------------------------------------------------02397201
023973* 3600-FORMAT-WRITE-MDSE-DATA                                     02397301
023974*  THIS PARAGRAPH WILL DO THE FOLLOWING                           02397401
023975*  (1) WRITE FORMATTED HEADER RECORD (OFR_MD_FUL)                 02397501
023976*  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02397601
023977*  (3) READ THE OFFERS MDSE FILE FOR NEXT RECORD                  02397701
023978*----------------------------------------------------------------*02397801
023979 3600-FORMAT-WRITE-MDSE-DATA.                                     02397901
023980                                                                  02398001
023981     IF PS-MDSE-HDR-NOT-WRITEN                                    02398101
023982        SET EP200-XST-OFR-MDSE-SET TO TRUE                        02398201
023983        PERFORM 4100-FORMAT-AND-WRITE-HDR                         02398301
023984        SET PS-MDSE-HDR-WRITEN TO TRUE                            02398401
023985     END-IF.                                                      02398501
023986                                                                  02398601
023987     SET FORM-OFR-LEN                                             02398701
023988       TO 1.                                                      02398801
023989     MOVE 0 TO  PV-BYTE-COUNT.                                    02398901
023990     INITIALIZE FORMATTED-OFFERS-RECORD.                          02399000
023991                                                                  02399100
023992     PERFORM 6900-MOVE-DELIMITER.                                 02399200
023993     PERFORM 4250-MOVE-TRIGGER-TYPE.                              02399300
023994                                                                  02399400
023995     MOVE EP204-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02399500
023996     MOVE EP204-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02399600
023997                                                                  02399700
023998     PERFORM 4300-MOVE-EVENT-OFR-ID.                              02399800
023999     PERFORM 4500-MOVE-REST-MDSE-DATA.                            02399900
024000                                                                  02400000
024001     PERFORM 4200-WRITE-DATA-RECORD.                              02400100
024002                                                                  02400200
024003     ADD 1 TO PV-OFFER-MDSE.                                      02400300
024004                                                                  02400400
024005     PERFORM 6400-READ-MDSE-DATA.                                 02400500
024006                                                                  02400601
024007     IF PS-NOT-END-OF-MDSE-FILE                                   02400701
024008        PERFORM 5400-DETERMINE-MDSE-INRANGE                       02400801
024009     END-IF.                                                      02400901
024010                                                                  02401001
024011*3600-EXIT.                                                       02401101
024012 EJECT.                                                           02401201
024013                                                                  02401301
024014*-----------------------------------------------------------------02401401
024015* 4100-FORMAT-AND-WRITE-HDR                                       02401501
024016*  THIS PARAGRAPH MOVES APPROPRIATE VALUES TO THE EPRD200 COPYBOOK02401601
024017*  LAYOUT (BEFORE WRITING OUT THE HEADER RECORD)                  02401701
024018*----------------------------------------------------------------*02401801
024019 4100-FORMAT-AND-WRITE-HDR.                                       02401901
024020                                                                  02402001
024021     MOVE PC-HDR-IND             TO EP200-HDR-INDICATOR.          02402101
024022     MOVE PC-STORE-SPECIFIC-GRP  TO EP200-STR-GRP-TYP.            02402200
024023     MOVE PC-FIVE-ZERO           TO EP200-STR-GRP-EXCP-IND.       02402300
024024     MOVE PV-STORE-NBR-RANGE     TO EP200-STR-GRP-ID-STR-LOC.     02402400
024026     MOVE PC-FIVE-ZERO           TO EP200-EXCO-STR-NBR.           02402600
024027     MOVE PV-FORMAT-HDR-DIST-DTE TO EP200-FILE-DIST-DATE.         02402700
024028     MOVE PC-OFR-IND             TO EP200-FILE-NAME-OFFER.        02402800
024029     MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-1.           02402900
024030     MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-2.           02403000
024031     MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-3.           02403100
024032     MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-4.           02403200
024033     MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-5.           02403300
024035     SET EP200-FILE-NAME-FUL TO TRUE.                             02403500
024036     MOVE PV-STORE-NBR-RANGE     TO EP200-STORE-NBR.              02403600
024037     MOVE PV-HEADER-TMST         TO EP200-CRT-TIMESTAMP.          02403700
024038     MOVE 'C'                    TO EP200-FILE-TYPE-APPLY.        02403800
024039                                                                  02403900
024040     PERFORM 4150-WRITE-HDR-RECORD.                               02404000
024041                                                                  02404100
024042*4100-EXIT.                                                       02404200
024043 EJECT.                                                           02404300
024044                                                                  02404400
024045*-----------------------------------------------------------------02404500
024046* 4150-WRITE-HDR-RECORD                                           02404600
024047*  THIS PARAGRAPH WILL WRITE THE HEADER RECORD TO THE O/P FILE    02404700
024048*-----------------------------------------------------------------02404800
024049 4150-WRITE-HDR-RECORD.                                           02404900
024050                                                                  02405000
024051     PERFORM 5000-INCR-HEADER-TIMESTAMP.                          02405100
024052                                                                  02405200
024053     MOVE 64                                                      02405300
024054       TO PV-BYTE-COUNT.                                          02405400
024055     WRITE FORMATTED-OFFERS-RECORD                                02405500
024056       FROM EP200-OFFER-HEADER-RECORD.                            02405600
024057                                                                  02405700
024058*4150-EXIT.                                                       02405800
024059 EJECT.                                                           02405900
024060                                                                  02406000
024061*-----------------------------------------------------------------02406100
024062* 4200-WRITE-DATA-RECORD                                          02406200
024063*  THIS PARAGRAPH WILL WRITE THE DATA RECORD TO THE O/P FILE      02406300
024064*-----------------------------------------------------------------02406400
024065 4200-WRITE-DATA-RECORD.                                          02406500
024066                                                                  02406600
024067     WRITE FORMATTED-OFFERS-RECORD.                               02406700
024068                                                                  02406800
024069*4200-EXIT.                                                       02406900
024070 EJECT.                                                           02407000
024071                                                                  02407100
024072*-----------------------------------------------------------------02407200
024073* 4250-MOVE-TRIGGER-TYPE                                          02407300
024074*  THIS PARAGRAPH WILL MOVE 'A' TO THE OUTPUT FILE VARIABLE       02407400
024075*----------------------------------------------------------------*02407500
024076 4250-MOVE-TRIGGER-TYPE.                                          02407600
024077                                                                  02407700
024078     MOVE EP201-TRIGGER-TYPE                                      02407800
024079       TO FORM-OFR-FLD(FORM-OFR-LEN).                             02407900
024080     SET FORM-OFR-LEN                                             02408000
024081       UP BY +1.                                                  02408101
024082     ADD 1                                                        02408200
024083       TO PV-BYTE-COUNT.                                          02408300
024084     PERFORM 6900-MOVE-DELIMITER.                                 02408400
024085                                                                  02408500
024086*4250-EXIT.                                                       02408600
024087 EJECT.                                                           02408700
024088                                                                  02408800
024089*----------------------------------------------------------       02408900
024090* 4300-MOVE-EVENT-OFR-ID.                                         02409000
024091*     THIS PARAGRAPH MOVES THE EVENT ID AND THE OFR ID TO         02409100
024092*     THE OUTPUT FIELD VARIABLE                                   02409200
024093*----------------------------------------------------------       02409300
024094 4300-MOVE-EVENT-OFR-ID.                                          02409400
024095                                                                  02409500
024096* FORMATTING EVNT_ID                                              02409600
024097     INITIALIZE PV-VARIABLE-ID                                    02409700
024098                PV-TALLY.                                         02409800
024099                                                                  02409900
024100     INSPECT PV-FORMAT-EVENT-ID TALLYING PV-TALLY                 02410000
024101         FOR LEADING ZEROES.                                      02410100
024102     SET PV-EFBM-IDX TO PV-TALLY.                                 02410200
024103     SET PV-EFBM-IDX UP BY +1.                                    02410301
024104     MOVE PV-FORMAT-EVENT-ID TO  PV-VARIABLE-ID.                  02410400
024105                                                                  02410500
024106     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02410600
024107        FROM PV-EFBM-IDX BY 1                                     02410700
024108       UNTIL PV-EFBM-BIT-IDX > 10.                                02410800
024109                                                                  02410900
024110     PERFORM 6900-MOVE-DELIMITER.                                 02411000
024111                                                                  02411100
024112                                                                  02411200
024113* FORMATTING OFR_ID                                               02411300
024114     INITIALIZE PV-VARIABLE-ID                                    02411400
024115                PV-TALLY.                                         02411500
024116                                                                  02411600
024117     INSPECT PV-FORMAT-OFFER-ID TALLYING PV-TALLY                 02411700
024118         FOR LEADING ZEROES.                                      02411800
024119     SET PV-EFBM-IDX TO PV-TALLY.                                 02411900
024120     SET PV-EFBM-IDX UP BY +1.                                    02412001
024121     MOVE PV-FORMAT-OFFER-ID TO  PV-VARIABLE-ID.                  02412100
024122                                                                  02412200
024123     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02412300
024124        FROM PV-EFBM-IDX BY 1                                     02412400
024125       UNTIL PV-EFBM-BIT-IDX > 10.                                02412500
024126                                                                  02412600
024128     PERFORM 6900-MOVE-DELIMITER.                                 02412800
024129                                                                  02412900
024130*4300-EXIT.                                                       02413000
024131 EJECT.                                                           02413100
024132                                                                  02413200
024133*----------------------------------------------------------       02413300
024134* 4350-MOVE-REST-OFFER-DATA.                                      02413400
024135*      THIS PARAGRAPH FORMATS AND MOVES THE DATA FIELDS FROM      02413500
024136*      EPRD201 COPYBOOK TO THE VARIABLE OUTPUT RECORD             02413600
024137*----------------------------------------------------------       02413700
024138 4350-MOVE-REST-OFFER-DATA.                                       02413800
024139                                                                  02413900
024140*-------  MOVE PROMO-SCHM-CDE --------(NOT NULL)-----*******      02414000
024141                                                                  02414100
024142     INITIALIZE PV-VARIABLE-ID                                    02414200
024143                PV-TALLY.                                         02414300
024144                                                                  02414400
024145     MOVE EP201-PROMO-SCHM-CDE  TO PV-VARIABLE-ID.                02414500
024146                                                                  02414600
024147     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02414700
024148        FROM 1 BY 1                                               02414800
024149       UNTIL PV-EFBM-BIT-IDX > 4.                                 02414900
024150                                                                  02415000
024151     PERFORM 6900-MOVE-DELIMITER.                                 02415100
024152*-------  MOVE EVENT-TYP-CDE --------(NOT NULL)-----*******       02415200
024153                                                                  02415300
024155     INITIALIZE PV-VARIABLE-ID                                    02415500
024156                PV-TALLY.                                         02415600
024157                                                                  02415700
024158     MOVE EP201-EVENT-TYP-CODE  TO PV-VARIABLE-ID.                02415800
024159                                                                  02415900
024160     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02416000
024161        FROM 1 BY 1                                               02416100
024162       UNTIL PV-EFBM-BIT-IDX > 2.                                 02416200
024163                                                                  02416300
024164     PERFORM 6900-MOVE-DELIMITER.                                 02416400
024165*-------  MOVE EVENT-NAME    --------(NOT NULL)-----*******       02416500
024166                                                                  02416600
024167     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02416700
024168                PV-TALLY.                                         02416800
024169                                                                  02416900
024170     IF EP201-EVENT-NAME = SPACES                                 02417000
024171        PERFORM 6800-MOVE-SPACE                                   02417100
024172     ELSE                                                         02417200
024173        MOVE EP201-EVENT-NAME      TO PV-VARIABLE-OUTPUT-FIELD    02417300
024174        PERFORM 6600-FIND-DATA-END                                02417400
024175          VARYING PV-EOF-IDX                                      02417500
024176             FROM 50 BY -1                                        02417600
024177             UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        02417700
024178        PERFORM 6650-FIELD-MOVER                                  02417800
024179          VARYING PV-BIT-IDX                                      02417900
024180             FROM 1 BY 1                                          02418000
024181             UNTIL PV-BIT-IDX > PV-EOF-IDX                        02418100
024182                                                                  02418200
024183        PERFORM 6900-MOVE-DELIMITER                               02418300
024184     END-IF.                                                      02418400
024185                                                                  02418500
024186*-------  MOVE OFFER-NAME    --------(NOT NULL)-----*******       02418600
024187                                                                  02418700
024188     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02418800
024189                PV-TALLY.                                         02418900
024190                                                                  02419000
024191     IF EP201-OFFER-NAME = SPACES                                 02419100
024192        PERFORM 6800-MOVE-SPACE                                   02419200
024193     ELSE                                                         02419300
024194        MOVE EP201-OFFER-NAME      TO PV-VARIABLE-OUTPUT-FIELD    02419400
024195        PERFORM 6600-FIND-DATA-END                                02419500
024196          VARYING PV-EOF-IDX                                      02419600
024197             FROM 50 BY -1                                        02419700
024198             UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        02419800
024199        PERFORM 6650-FIELD-MOVER                                  02419900
024200          VARYING PV-BIT-IDX                                      02420000
024201             FROM 1 BY 1                                          02420100
024202             UNTIL PV-BIT-IDX > PV-EOF-IDX                        02420200
024203                                                                  02420300
024204        PERFORM 6900-MOVE-DELIMITER                               02420400
024205     END-IF.                                                      02420500
024206                                                                  02420600
024207*-------  MOVE DISC-LEVEL-CODE-------(NOT NULL)-----*******       02420700
024208                                                                  02420800
024209     INITIALIZE PV-VARIABLE-ID                                    02420900
024210                PV-TALLY.                                         02421000
024211                                                                  02421100
024212     MOVE EP201-DISC-LEVEL-CODE  TO PV-VARIABLE-ID.               02421200
024213                                                                  02421300
024214     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02421400
024215        FROM 1 BY 1                                               02421500
024216       UNTIL PV-EFBM-BIT-IDX > 3.                                 02421600
024217                                                                  02421700
024218     PERFORM 6900-MOVE-DELIMITER.                                 02421800
024219                                                                  02421900
024220*-------  MOVE OFFER-USAGE-TYPE-CODE -(NOT NULL)-----*******      02422000
024221                                                                  02422100
024222     INITIALIZE PV-VARIABLE-ID                                    02422200
024223                PV-TALLY.                                         02422300
024224                                                                  02422400
024225     MOVE EP201-OFFER-USAGE-TYPE-CODE TO PV-VARIABLE-ID.          02422500
024226                                                                  02422600
024227     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02422700
024228        FROM 1 BY 1                                               02422800
024229       UNTIL PV-EFBM-BIT-IDX > 3.                                 02422900
024230                                                                  02423000
024231     PERFORM 6900-MOVE-DELIMITER.                                 02423100
024232                                                                  02423200
024233*-------  MOVE BARCODE-TYPE-CODE------(NOT NULL)-----*******      02423300
024234                                                                  02423400
024235     INITIALIZE PV-VARIABLE-ID                                    02423500
024236                PV-TALLY.                                         02423600
024237                                                                  02423700
024238     MOVE EP201-BARCODE-TYPE-CODE     TO PV-VARIABLE-ID.          02423800
024239                                                                  02423900
024240     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02424000
024241        FROM 1 BY 1                                               02424100
024242       UNTIL PV-EFBM-BIT-IDX > 1.                                 02424200
024243                                                                  02424300
024244     PERFORM 6900-MOVE-DELIMITER.                                 02424400
024245                                                                  02424500
024246*-------  MOVE UNEARN-IND ------------(NOT NULL)-----*******      02424600
024247                                                                  02424700
024248     INITIALIZE PV-VARIABLE-ID                                    02424800
024249                PV-TALLY.                                         02424900
024250                                                                  02425000
024251     MOVE EP201-UNEARN-IND            TO PV-VARIABLE-ID.          02425100
024252                                                                  02425200
024253     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02425300
024254        FROM 1 BY 1                                               02425400
024255       UNTIL PV-EFBM-BIT-IDX > 1.                                 02425500
024256                                                                  02425600
024257     PERFORM 6900-MOVE-DELIMITER.                                 02425700
024258                                                                  02425800
024259*-------  MOVE OFR-TRGR-TYP-CDE-------(NOT NULL)-----*******      02425900
024260                                                                  02426000
024261     INITIALIZE PV-VARIABLE-ID                                    02426100
024262                PV-TALLY.                                         02426200
024263                                                                  02426300
024264     MOVE EP201-OFR-TRGR-TYP-CDE      TO PV-VARIABLE-ID.          02426400
024265                                                                  02426500
024266     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02426600
024267        FROM 1 BY 1                                               02426700
024268       UNTIL PV-EFBM-BIT-IDX > 3.                                 02426800
024269                                                                  02426900
024270     PERFORM 6900-MOVE-DELIMITER.                                 02427000
024271                                                                  02427100
024272*-------  MOVE BWP-ITM-APPL-CDE-----------(NULL)-----*******      02427200
024273                                                                  02427300
024274     INITIALIZE PV-VARIABLE-ID                                    02427400
024275                PV-TALLY.                                         02427500
024276                                                                  02427600
024277     EVALUATE TRUE                                                02427700
024278         WHEN EP201-BWP-ITM-APPL-CDE = '~'                        02427800
024279              PERFORM 6850-MOVE-NULL-VALUE                        02427900
024280         WHEN EP201-BWP-ITM-APPL-CDE = SPACES                     02428000
024281              PERFORM 6800-MOVE-SPACE                             02428100
024282         WHEN OTHER                                               02428200
024283              MOVE EP201-BWP-ITM-APPL-CDE      TO PV-VARIABLE-ID  02428300
024284                                                                  02428400
024285              PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   02428500
024286                 FROM 1 BY 1                                      02428600
024287                 UNTIL PV-EFBM-BIT-IDX > 2                        02428700
024288                                                                  02428800
024289              PERFORM 6900-MOVE-DELIMITER                         02428900
024290     END-EVALUATE.                                                02429000
024291                                                                  02429100
024292*4350-EXIT.                                                       02429200
024293 EJECT.                                                           02429300
024294                                                                  02429400
024295*----------------------------------------------------------       02429500
024296* 4400-MOVE-REST-SECTION-DATA.                                    02429600
024297*     THIS PARAGRAPH FORMATS AND MOVES THE DATA FILEDS FROM       02429700
024298*     EPRD202 COPYBOOK TO THE VARIABLE OUTPUT RECORD              02429800
024299*----------------------------------------------------------       02429900
024300 4400-MOVE-REST-SECTION-DATA.                                     02430000
024301                                                                  02430100
024302*-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      02430200
024303                                                                  02430300
024304     INITIALIZE PV-VARIABLE-ID                                    02430400
024305                PV-TALLY.                                         02430500
024306                                                                  02430600
024307     MOVE EP202-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          02430700
024308                                                                  02430800
024309     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02430900
024310        FROM 1 BY 1                                               02431000
024311       UNTIL PV-EFBM-BIT-IDX > 1.                                 02431100
024312                                                                  02431200
024313     PERFORM 6900-MOVE-DELIMITER.                                 02431300
024314                                                                  02431400
024315*-------  MOVE EFF-BEG-DATE-----------(NOT NULL)-----*******      02431500
024316                                                                  02431600
024317     INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           02431700
024318                PV-EFF-WORK-DTE.                                  02431800
024319                                                                  02431900
024320     MOVE EP202-EFF-BEG-DTE           TO PV-EFF-WORK-DTE.         02432000
024321                                                                  02432100
024322     MOVE PV-EFF-WORK-YYYY            TO PV-EFFECT-YYYY.          02432200
024323     MOVE PV-EFF-WORK-MM              TO PV-EFFECT-MM.            02432300
024324     MOVE PV-EFF-WORK-DD              TO PV-EFFECT-DD.            02432400
024325     MOVE PC-TIME-START               TO PV-EFFECT-TIME.          02432500
024326     MOVE PC-DASH                     TO PV-EFFECT-DASH-1.        02432600
024327     MOVE PC-DASH                     TO PV-EFFECT-DASH-2.        02432700
024328                                                                  02432800
024329     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         02432900
024330     MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   02433000
024331                                                                  02433100
024332     PERFORM 6600-FIND-DATA-END                                   02433200
024333       VARYING PV-EOF-IDX                                         02433300
024334         FROM 50 BY -1                                            02433400
024335           UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         02433500
024336     PERFORM 6650-FIELD-MOVER                                     02433600
024337       VARYING PV-BIT-IDX                                         02433700
024338         FROM 1 BY 1                                              02433800
024339           UNTIL PV-BIT-IDX > PV-EOF-IDX.                         02433900
024340                                                                  02434000
024341     PERFORM 6900-MOVE-DELIMITER.                                 02434100
024342                                                                  02434200
024343*-------  MOVE EFF-END-DATE-----------(NOT NULL)-----*******      02434300
024344                                                                  02434400
024345     INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           02434500
024346                PV-EFF-WORK-DTE.                                  02434600
024347                                                                  02434700
024348     MOVE EP202-EFF-END-DTE           TO PV-EFF-WORK-DTE.         02434800
024349                                                                  02434900
024350     MOVE PV-EFF-WORK-YYYY            TO PV-EFFECT-YYYY.          02435000
024351     MOVE PV-EFF-WORK-MM              TO PV-EFFECT-MM.            02435100
024352     MOVE PV-EFF-WORK-DD              TO PV-EFFECT-DD.            02435200
024353     MOVE PC-TIME-END                 TO PV-EFFECT-TIME.          02435300
024354     MOVE PC-DASH                     TO PV-EFFECT-DASH-1.        02435400
024355     MOVE PC-DASH                     TO PV-EFFECT-DASH-2.        02435500
024356                                                                  02435600
024357     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         02435700
024358     MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   02435800
024359                                                                  02435900
024360     PERFORM 6600-FIND-DATA-END                                   02436000
024361       VARYING PV-EOF-IDX                                         02436100
024362         FROM 50 BY -1                                            02436200
024363           UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         02436300
024364     PERFORM 6650-FIELD-MOVER                                     02436400
024365       VARYING PV-BIT-IDX                                         02436500
024366         FROM 1 BY 1                                              02436600
024367           UNTIL PV-BIT-IDX > PV-EOF-IDX.                         02436700
024368                                                                  02436800
024369     PERFORM 6900-MOVE-DELIMITER.                                 02436900
024370                                                                  02437000
024371*-------  MOVE REDMN-SUPVR-OVERRID-DTE (NOT NULL)-----*******     02437100
024372                                                                  02437200
024373     INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           02437300
024374                PV-EFF-WORK-DTE.                                  02437400
024375                                                                  02437500
024376     MOVE EP202-REDMN-SUPVR-OVRRID-DTE TO PV-EFF-WORK-DTE.        02437600
024377                                                                  02437700
024378     MOVE PV-EFF-WORK-YYYY             TO PV-EFFECT-YYYY.         02437800
024379     MOVE PV-EFF-WORK-MM               TO PV-EFFECT-MM.           02437900
024380     MOVE PV-EFF-WORK-DD               TO PV-EFFECT-DD.           02438000
024381     MOVE PC-TIME-END                  TO PV-EFFECT-TIME.         02438100
024382     MOVE PC-DASH                      TO PV-EFFECT-DASH-1.       02438200
024383     MOVE PC-DASH                      TO PV-EFFECT-DASH-2.       02438300
024384                                                                  02438400
024385     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         02438500
024386     MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   02438600
024387                                                                  02438700
024388     PERFORM 6600-FIND-DATA-END                                   02438800
024389       VARYING PV-EOF-IDX                                         02438900
024390         FROM 50 BY -1                                            02439000
024391           UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         02439100
024392     PERFORM 6650-FIELD-MOVER                                     02439200
024393       VARYING PV-BIT-IDX                                         02439300
024394         FROM 1 BY 1                                              02439400
024395           UNTIL PV-BIT-IDX > PV-EOF-IDX.                         02439500
024396                                                                  02439600
024397     PERFORM 6900-MOVE-DELIMITER.                                 02439700
024398                                                                  02439800
024399*-------  MOVE BWP-GET-CNCTR-CDE------(NOT NULL)-----*******      02439900
024400                                                                  02440000
024401     INITIALIZE PV-VARIABLE-ID                                    02440100
024402                PV-TALLY.                                         02440200
024403                                                                  02440300
024404     MOVE EP202-BWP-GET-CNCTR-CDE    TO PV-VARIABLE-ID.           02440400
024405                                                                  02440500
024406     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02440600
024407        FROM 1 BY 1                                               02440700
024408       UNTIL PV-EFBM-BIT-IDX > 3 OR                               02440800
024409           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    02440900
024410                                                                  02441000
024411     PERFORM 6900-MOVE-DELIMITER.                                 02441100
024412                                                                  02441200
024413*-------  MOVE BWP-BUY-CNCTR-CDE------(NOT NULL)-----*******      02441300
024414                                                                  02441400
024415     INITIALIZE PV-VARIABLE-ID                                    02441500
024416                PV-TALLY.                                         02441600
024417                                                                  02441700
024418     MOVE EP202-BWP-BUY-CNCTR-CDE         TO PV-VARIABLE-ID.      02441800
024419                                                                  02441900
024420     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02442000
024421        FROM 1 BY 1                                               02442100
024422       UNTIL PV-EFBM-BIT-IDX > 3 OR                               02442200
024423           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    02442300
024424                                                                  02442400
024425     PERFORM 6900-MOVE-DELIMITER.                                 02442500
024426                                                                  02442600
024427*-------  MOVE CUSTFACG-SHRT-DESC----(NOT NULL)-----*******       02442700
024428                                                                  02442800
024429     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02442900
024430                PV-TALLY.                                         02443000
024431                                                                  02443100
024432     IF EP202-CUSTFACG-SHRT-DESC = SPACES                         02443200
024433        PERFORM 6800-MOVE-SPACE                                   02443300
024434     ELSE                                                         02443400
024435        MOVE EP202-CUSTFACG-SHRT-DESC  TO PV-VARIABLE-OUTPUT-FIELD02443500
024436        PERFORM 6600-FIND-DATA-END                                02443600
024437          VARYING PV-EOF-IDX                                      02443700
024438             FROM 50 BY -1                                        02443800
024439             UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        02443900
024440        PERFORM 6650-FIELD-MOVER                                  02444000
024441          VARYING PV-BIT-IDX                                      02444100
024442             FROM 1 BY 1                                          02444200
024443             UNTIL PV-BIT-IDX > PV-EOF-IDX                        02444300
024444                                                                  02444400
024445        PERFORM 6900-MOVE-DELIMITER                               02444500
024446     END-IF.                                                      02444600
024447                                                                  02444700
024448*-------  MOVE POS-BTN-TXT --------------(NULL)-----*******       02444800
024449                                                                  02444900
024450     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02445000
024451                PV-TALLY.                                         02445100
024452     EVALUATE TRUE                                                02445200
024453         WHEN EP202-POS-BTN-TXT = '~'                             02445300
024454            PERFORM 6850-MOVE-NULL-VALUE                          02445400
024455         WHEN EP202-POS-BTN-TXT = SPACES                          02445500
024456            PERFORM 6800-MOVE-SPACE                               02445600
024457         WHEN OTHER                                               02445700
024458            MOVE EP202-POS-BTN-TXT    TO PV-VARIABLE-OUTPUT-FIELD 02445800
024459            PERFORM 6600-FIND-DATA-END                            02445900
024460               VARYING PV-EOF-IDX                                 02446000
024461                 FROM 50 BY -1                                    02446100
024462                 UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE    02446200
024463            PERFORM 6650-FIELD-MOVER                              02446300
024464               VARYING PV-BIT-IDX                                 02446400
024465               FROM 1 BY 1                                        02446500
024466               UNTIL PV-BIT-IDX > PV-EOF-IDX                      02446600
024467                                                                  02446700
024468            PERFORM 6900-MOVE-DELIMITER                           02446800
024469     END-EVALUATE.                                                02446900
024470                                                                  02447000
024471*-------  MOVE VLD-POS-TNDR-CMP-TYP-CDE (NOT NULL)-----*******    02447100
024472                                                                  02447200
024473     INITIALIZE PV-VARIABLE-ID                                    02447300
024474                PV-TALLY.                                         02447400
024475                                                                  02447500
024476     MOVE EP202-VLD-POS-TNDR-CMP-TYP-CDE TO PV-VARIABLE-ID.       02447600
024477                                                                  02447700
024478     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02447800
024479        FROM 1 BY 1                                               02447900
024480       UNTIL PV-EFBM-BIT-IDX > 3 OR                               02448000
024481           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    02448100
024482                                                                  02448200
024483     PERFORM 6900-MOVE-DELIMITER.                                 02448300
024484                                                                  02448400
024485*-------  MOVE POS-BTN-RLTV-SEQ-NBR --------(NULL)-----*******    02448500
024486                                                                  02448600
024487     INITIALIZE PV-VARIABLE-ID                                    02448700
024488                PV-TALLY.                                         02448800
024489                                                                  02448900
024490     EVALUATE TRUE                                                02449000
024491         WHEN EP202-POS-BTN-RLTV-SEQ-NBR-X = '~'                  02449100
024492              PERFORM 6850-MOVE-NULL-VALUE                        02449200
024493         WHEN EP202-POS-BTN-RLTV-SEQ-NBR = ZEROES                 02449300
024494              PERFORM 6700-MOVE-ZERO                              02449400
024495         WHEN OTHER                                               02449500
024496                                                                  02449600
024497              INSPECT EP202-POS-BTN-RLTV-SEQ-NBR TALLYING PV-TALLY02449700
024498                  FOR LEADING ZEROES                              02449800
024499              SET PV-EFBM-IDX TO PV-TALLY                         02449900
024500              SET PV-EFBM-IDX UP BY +1                            02450001
024501              MOVE EP202-POS-BTN-RLTV-SEQ-NBR TO PV-VARIABLE-ID   02450100
024502                                                                  02450200
024503              PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   02450300
024504                 FROM PV-EFBM-IDX BY 1                            02450400
024505                 UNTIL PV-EFBM-BIT-IDX > 10  OR                   02450500
024506                 PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '               02450600
024507                                                                  02450700
024508              PERFORM 6900-MOVE-DELIMITER                         02450800
024509     END-EVALUATE.                                                02450900
024510                                                                  02451000
024511*-------  MOVE LMT-PER-TRN-QTY -------------(NULL)-----*******    02451100
024512                                                                  02451200
024513     INITIALIZE PV-VARIABLE-ID                                    02451300
024514                PV-TALLY.                                         02451400
024515                                                                  02451500
024516     EVALUATE TRUE                                                02451600
024517         WHEN EP202-LMT-PER-TRN-QTY-X = '~'                       02451700
024518              PERFORM 6850-MOVE-NULL-VALUE                        02451800
024519         WHEN EP202-LMT-PER-TRN-QTY = ZEROES                      02451900
024520              PERFORM 6700-MOVE-ZERO                              02452000
024521         WHEN OTHER                                               02452100
024522              INSPECT EP202-LMT-PER-TRN-QTY TALLYING PV-TALLY     02452200
024523                  FOR LEADING ZEROES                              02452300
024524              SET PV-EFBM-IDX TO PV-TALLY                         02452400
024525              SET PV-EFBM-IDX UP BY +1                            02452501
024526                                                                  02452600
024527              MOVE EP202-LMT-PER-TRN-QTY TO PV-VARIABLE-ID        02452700
024528                                                                  02452800
024529              PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   02452900
024530                 FROM PV-EFBM-IDX BY 1                            02453000
024531                 UNTIL PV-EFBM-BIT-IDX > 10 OR                    02453100
024532                     PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '           02453200
024533                                                                  02453300
024534              PERFORM 6900-MOVE-DELIMITER                         02453400
024535     END-EVALUATE.                                                02453500
024536                                                                  02453600
024537*4400-EXIT.                                                       02453700
024538 EJECT.                                                           02453800
024539                                                                  02453900
024540*----------------------------------------------------------       02454000
024541* 4450-MOVE-REST-BWP-DATA.                                        02454100
024542*     THIS PARAGRAPH FORMATS AND MOVES THE DATA FIELDS FROM       02454200
024543*     EPRD203 COPYBOOK TO THE VARIABLE OUTPUT RECORD              02454300
024544*----------------------------------------------------------       02454400
024545 4450-MOVE-REST-BWP-DATA.                                         02454500
024546                                                                  02454600
024547*-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      02454700
024548                                                                  02454800
024549     INITIALIZE PV-VARIABLE-ID                                    02454900
024550                PV-TALLY.                                         02455000
024551                                                                  02455100
024553     MOVE EP203-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          02455300
024554                                                                  02455400
024555     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02455500
024556        FROM 1 BY 1                                               02455600
024557       UNTIL PV-EFBM-BIT-IDX > 1.                                 02455700
024558                                                                  02455800
024559     PERFORM 6900-MOVE-DELIMITER.                                 02455900
024560                                                                  02456000
024561*-------  MOVE OFR-SECT-BWP-ID -------(NOT NULL)-----*******      02456100
024562                                                                  02456200
024563     INITIALIZE PV-VARIABLE-ID                                    02456300
024564                PV-TALLY.                                         02456400
024565                                                                  02456500
024566     INSPECT EP203-OFR-SECT-BWP-ID TALLYING PV-TALLY              02456600
024567         FOR LEADING ZEROES.                                      02456700
024568     SET PV-EFBM-IDX TO PV-TALLY.                                 02456800
024569     SET PV-EFBM-IDX UP BY +1.                                    02456901
024570     MOVE EP203-OFR-SECT-BWP-ID TO PV-VARIABLE-ID.                02457000
024571                                                                  02457100
024572     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02457200
024573        FROM PV-EFBM-IDX BY 1                                     02457300
024574       UNTIL PV-EFBM-BIT-IDX > 10.                                02457400
024575                                                                  02457500
024576     PERFORM 6900-MOVE-DELIMITER.                                 02457600
024577                                                                  02457700
024578*-------  MOVE TIER-LVL-NBR    -------(NOT NULL)-----*******      02457800
024579                                                                  02457900
024580     INITIALIZE PV-VARIABLE-ID                                    02458000
024581                PV-TALLY.                                         02458100
024582     IF EP203-TIER-LVL-NBR = ZEROES                               02458200
024583        PERFORM 6700-MOVE-ZERO                                    02458300
024584     ELSE                                                         02458400
024585        INSPECT EP203-TIER-LVL-NBR TALLYING PV-TALLY              02458500
024586            FOR LEADING ZEROES                                    02458600
024587        SET PV-EFBM-IDX TO PV-TALLY                               02458700
024588        SET PV-EFBM-IDX UP BY +1                                  02458801
024589        MOVE EP203-TIER-LVL-NBR    TO PV-VARIABLE-ID              02458900
024590                                                                  02459000
024591        PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX         02459100
024592           FROM PV-EFBM-IDX BY 1                                  02459200
024593           UNTIL PV-EFBM-BIT-IDX > 10 OR                          02459300
024594           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '                     02459400
024595                                                                  02459500
024596        PERFORM 6900-MOVE-DELIMITER                               02459600
024597     END-IF.                                                      02459700
024598                                                                  02459800
024599*-------  MOVE BWP-SELN-TYP-CDE-------(NOT NULL)-----*******      02459900
024600                                                                  02460000
024601     INITIALIZE PV-VARIABLE-ID                                    02460100
024602                PV-TALLY.                                         02460200
024603                                                                  02460300
024604     MOVE EP203-BWP-SELN-TYP-CDE      TO PV-VARIABLE-ID.          02460400
024605                                                                  02460500
024606     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02460600
024607        FROM 1 BY 1                                               02460700
024608       UNTIL PV-EFBM-BIT-IDX > 3 OR                               02460800
024609       PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                        02460900
024610                                                                  02461000
024611     PERFORM 6900-MOVE-DELIMITER.                                 02461100
024612                                                                  02461200
024613*-------  MOVE BWP-BUY-QTY ---------------(NULL)-----*******      02461300
024614                                                                  02461400
024615     INITIALIZE PV-VARIABLE-ID                                    02461500
024616                PV-TALLY.                                         02461600
024617     EVALUATE TRUE                                                02461700
024618         WHEN EP203-BWP-BUY-QTY-X = '~'                           02461800
024619             PERFORM 6850-MOVE-NULL-VALUE                         02461900
024620         WHEN EP203-BWP-BUY-QTY = ZEROES                          02462000
024621             PERFORM 6700-MOVE-ZERO                               02462100
024622         WHEN OTHER                                               02462200
024623             INSPECT EP203-BWP-BUY-QTY  TALLYING PV-TALLY         02462300
024624                 FOR LEADING ZEROES                               02462400
024625             SET PV-EFBM-IDX TO PV-TALLY                          02462500
024626             SET PV-EFBM-IDX UP BY +1                             02462601
024627             MOVE EP203-BWP-BUY-QTY     TO PV-VARIABLE-ID         02462700
024628                                                                  02462800
024629             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02462900
024630                FROM PV-EFBM-IDX BY 1                             02463000
024631                UNTIL PV-EFBM-BIT-IDX > 10 OR                     02463100
024632                PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '                02463200
024633                                                                  02463300
024634             PERFORM 6900-MOVE-DELIMITER                          02463400
024635     END-EVALUATE.                                                02463500
024636                                                                  02463600
024637*-------  MOVE BWP-BUY-AMT ---------------(NULL)-----*******      02463700
024638                                                                  02463800
024639     INITIALIZE PV-VARIABLE-ID                                    02463900
024640                PV-TALLY.                                         02464000
024641     EVALUATE TRUE                                                02464100
024642         WHEN EP203-BWP-BUY-AMT-X = '~'                           02464200
024643             PERFORM 6850-MOVE-NULL-VALUE                         02464300
024644         WHEN EP203-BWP-BUY-AMT = ZEROES                          02464400
024645             MOVE '.00'                 TO PV-VARIABLE-ID         02464500
024646                                                                  02464600
024647             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02464700
024648                FROM 1 BY 1                                       02464800
024649                UNTIL PV-EFBM-BIT-IDX > 3                         02464900
024650                                                                  02465000
024651             PERFORM 6900-MOVE-DELIMITER                          02465100
024652         WHEN OTHER                                               02465200
024653             INSPECT EP203-BWP-BUY-AMT  TALLYING PV-TALLY         02465300
024654                 FOR LEADING ZEROES                               02465400
024655             SET PV-EFBM-IDX TO PV-TALLY                          02465500
024657                                                                  02465709
024658             EVALUATE TRUE                                        02465809
024659                                                                  02465909
024660                WHEN PV-EFBM-IDX < 7                              02466009
024661                   SET PV-EFBM-IDX UP BY +1                       02466109
024662                WHEN PV-EFBM-IDX = 8                              02466209
024663                   SET PV-EFBM-IDX DOWN BY +1                     02466309
024664                                                                  02466409
024665             END-EVALUATE                                         02466509
024666                                                                  02466609
024667             MOVE EP203-BWP-BUY-AMT     TO PV-VARIABLE-ID         02466700
024668                                                                  02466800
024669             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02466900
024670                FROM PV-EFBM-IDX BY 1                             02467000
024671                UNTIL PV-EFBM-BIT-IDX > 10 OR                     02467100
024672                  PV-EFBM-VAR(PV-EFBM-BIT-IDX)  = ' '             02467200
024673                                                                  02467300
024674             PERFORM 6900-MOVE-DELIMITER                          02467400
024675     END-EVALUATE.                                                02467500
024676                                                                  02467600
024677*-------  MOVE BWP-BUY-TOL-AMT -----------(NULL)-----*******      02467700
024678                                                                  02467800
024679     INITIALIZE PV-VARIABLE-ID                                    02467900
024680                PV-TALLY.                                         02468000
024681     EVALUATE TRUE                                                02468100
024682         WHEN EP203-BWP-BUY-TOL-AMT-X = '~'                       02468200
024683             PERFORM 6850-MOVE-NULL-VALUE                         02468300
024684         WHEN EP203-BWP-BUY-TOL-AMT = ZEROES                      02468400
024685             MOVE '.00'                 TO PV-VARIABLE-ID         02468500
024686                                                                  02468600
024687             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02468700
024688                FROM 1 BY 1                                       02468800
024689                UNTIL PV-EFBM-BIT-IDX > 3                         02468900
024690             PERFORM 6900-MOVE-DELIMITER                          02469000
024691                                                                  02469100
024692         WHEN OTHER                                               02469200
024693             INSPECT EP203-BWP-BUY-TOL-AMT  TALLYING PV-TALLY     02469300
024694                 FOR LEADING ZEROES                               02469400
024695             SET PV-EFBM-IDX TO PV-TALLY                          02469500
024696                                                                  02469609
024697             EVALUATE TRUE                                        02469709
024698                                                                  02469809
024699                WHEN PV-EFBM-IDX < 7                              02469909
024700                   SET PV-EFBM-IDX UP BY +1                       02470009
024701                WHEN PV-EFBM-IDX = 8                              02470109
024702                   SET PV-EFBM-IDX DOWN BY +1                     02470209
024703                                                                  02470309
024704             END-EVALUATE                                         02470409
024705                                                                  02470509
024706             MOVE EP203-BWP-BUY-TOL-AMT     TO PV-VARIABLE-ID     02470600
024707                                                                  02470700
024708             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02470800
024709                FROM PV-EFBM-IDX BY 1                             02470900
024710                UNTIL PV-EFBM-BIT-IDX > 10  OR                    02471000
024711                   PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '             02471100
024712                                                                  02471200
024713             PERFORM 6900-MOVE-DELIMITER                          02471300
024714     END-EVALUATE.                                                02471400
024715                                                                  02471500
024716*-------  MOVE BWP-GET-QTY ---------------(NULL)-----*******      02471600
024717                                                                  02471700
024718     INITIALIZE PV-VARIABLE-ID                                    02471800
024719                PV-TALLY.                                         02471900
024720     EVALUATE TRUE                                                02472000
024721         WHEN EP203-BWP-GET-QTY-X = '~'                           02472100
024722             PERFORM 6850-MOVE-NULL-VALUE                         02472200
024723         WHEN EP203-BWP-GET-QTY = ZEROES                          02472300
024724             PERFORM 6700-MOVE-ZERO                               02472400
024725         WHEN OTHER                                               02472500
024726             INSPECT EP203-BWP-GET-QTY  TALLYING PV-TALLY         02472600
024727                 FOR LEADING ZEROES                               02472700
024728             SET PV-EFBM-IDX TO PV-TALLY                          02472800
024729             SET PV-EFBM-IDX UP BY +1                             02472901
024730             MOVE EP203-BWP-GET-QTY     TO PV-VARIABLE-ID         02473000
024731                                                                  02473100
024732             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02473200
024733                FROM PV-EFBM-IDX BY 1                             02473300
024734                UNTIL PV-EFBM-BIT-IDX > 10 OR                     02473400
024735                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02473500
024736                                                                  02473600
024737             PERFORM 6900-MOVE-DELIMITER                          02473700
024738     END-EVALUATE.                                                02473800
024739                                                                  02473900
024740*-------  MOVE GET-PCT-OFF-PCT------------(NULL)-----*******      02474000
024741                                                                  02474100
024742     INITIALIZE PV-VARIABLE-ID                                    02474200
024743                PV-TALLY.                                         02474300
024744     EVALUATE TRUE                                                02474400
024745         WHEN EP203-BWP-GET-PCT-OFF-PCT-X = '~'                   02474500
024746             PERFORM 6850-MOVE-NULL-VALUE                         02474600
024747         WHEN EP203-BWP-GET-PCT-OFF-PCT = ZEROES                  02474700
024748             PERFORM 6700-MOVE-ZERO                               02474800
024749         WHEN OTHER                                               02474900
024750             INSPECT EP203-BWP-GET-PCT-OFF-PCT  TALLYING PV-TALLY 02475000
024751                 FOR LEADING ZEROES                               02475100
024752             SET PV-EFBM-IDX TO PV-TALLY                          02475200
024753             SET PV-EFBM-IDX UP BY +1                             02475301
024754             MOVE EP203-BWP-GET-PCT-OFF-PCT TO PV-VARIABLE-ID     02475400
024755                                                                  02475500
024756             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02475600
024757                FROM PV-EFBM-IDX BY 1                             02475700
024758                UNTIL PV-EFBM-BIT-IDX > 10 OR                     02475800
024759                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02475900
024760                                                                  02476000
024761             PERFORM 6900-MOVE-DELIMITER                          02476100
024762     END-EVALUATE.                                                02476200
024763                                                                  02476300
024764*-------  MOVE GET-DOL-OFF-AMT------------(NULL)-----*******      02476400
024765                                                                  02476500
024766     INITIALIZE PV-VARIABLE-ID                                    02476600
024767                PV-TALLY.                                         02476700
024768     EVALUATE TRUE                                                02476800
024769         WHEN EP203-BWP-GET-DOL-OFF-AMT-X = '~'                   02476900
024770             PERFORM 6850-MOVE-NULL-VALUE                         02477000
024771         WHEN EP203-BWP-GET-DOL-OFF-AMT = ZEROES                  02477100
024772             PERFORM 6700-MOVE-ZERO                               02477200
024773         WHEN OTHER                                               02477300
024774             INSPECT EP203-BWP-GET-DOL-OFF-AMT  TALLYING PV-TALLY 02477400
024775                 FOR LEADING ZEROES                               02477500
024776             SET PV-EFBM-IDX TO PV-TALLY                          02477600
024777                                                                  02477709
024778             EVALUATE TRUE                                        02477809
024779                                                                  02477909
024780                WHEN PV-EFBM-IDX < 7                              02478009
024781                   SET PV-EFBM-IDX UP BY +1                       02478109
024782                WHEN PV-EFBM-IDX = 8                              02478209
024783                   SET PV-EFBM-IDX DOWN BY +1                     02478309
024784                                                                  02478409
024785             END-EVALUATE                                         02478509
024786                                                                  02478609
024787             MOVE EP203-BWP-GET-DOL-OFF-AMT TO PV-VARIABLE-ID     02478700
024788                                                                  02478800
024789             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02478900
024790                FROM PV-EFBM-IDX BY 1                             02479000
024791                UNTIL PV-EFBM-BIT-IDX > 10  OR                    02479100
024792                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02479200
024793                                                                  02479300
024794             PERFORM 6900-MOVE-DELIMITER                          02479400
024795     END-EVALUATE.                                                02479500
024796                                                                  02479600
024797*-------  MOVE GET-PRPT-AMT --------------(NULL)-----*******      02479700
024798                                                                  02479800
024799     INITIALIZE PV-VARIABLE-ID                                    02479900
024800                PV-TALLY.                                         02480000
024801     EVALUATE TRUE                                                02480100
024802         WHEN EP203-BWP-GET-PRPT-AMT-X = '~'                      02480200
024803             PERFORM 6850-MOVE-NULL-VALUE                         02480300
024804         WHEN EP203-BWP-GET-PRPT-AMT = ZEROES                     02480400
024805             PERFORM 6700-MOVE-ZERO                               02480500
024806         WHEN OTHER                                               02480600
024807             INSPECT EP203-BWP-GET-PRPT-AMT  TALLYING PV-TALLY    02480700
024808                 FOR LEADING ZEROES                               02480800
024809             SET PV-EFBM-IDX TO PV-TALLY                          02480900
024810                                                                  02481009
024811             EVALUATE TRUE                                        02481109
024812                                                                  02481209
024813                WHEN PV-EFBM-IDX < 7                              02481309
024814                   SET PV-EFBM-IDX UP BY +1                       02481409
024815                WHEN PV-EFBM-IDX = 8                              02481509
024816                   SET PV-EFBM-IDX DOWN BY +1                     02481609
024817                                                                  02481709
024818             END-EVALUATE                                         02481809
024819                                                                  02481909
024820             MOVE EP203-BWP-GET-PRPT-AMT TO PV-VARIABLE-ID        02482000
024821                                                                  02482100
024822             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02482200
024823                FROM PV-EFBM-IDX BY 1                             02482300
024824                UNTIL PV-EFBM-BIT-IDX > 10 OR                     02482400
024825                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02482500
024826                                                                  02482600
024827             PERFORM 6900-MOVE-DELIMITER                          02482700
024828     END-EVALUATE.                                                02482800
024829                                                                  02482900
024830                                                                  02483000
024831*4450-EXIT.                                                       02483100
024832 EJECT.                                                           02483200
024833                                                                  02483300
024834*----------------------------------------------------------       02483400
024835* 4500-MOVE-REST-MDSE-DATA.                                       02483500
024836*     THIS PARAGRAPH FORMATS AND MOVES THE DATA FIELDS FROM       02483600
024837*     EPRD204 COPYBOOK TO THE VARIABLE OUTPUT RECORD              02483700
024838*----------------------------------------------------------       02483800
024839 4500-MOVE-REST-MDSE-DATA.                                        02483900
024840                                                                  02484000
024841*-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      02484100
024842                                                                  02484200
024843     INITIALIZE PV-VARIABLE-ID                                    02484300
024844                PV-TALLY.                                         02484400
024845                                                                  02484500
024846     MOVE EP202-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          02484600
024847                                                                  02484700
024848     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02484800
024849        FROM 1 BY 1                                               02484900
024850       UNTIL PV-EFBM-BIT-IDX > 1.                                 02485000
024851                                                                  02485100
024852     PERFORM 6900-MOVE-DELIMITER.                                 02485200
024853                                                                  02485300
024854*-------  MOVE OFR-SECT-BWP-ID -------(NOT NULL)-----*******      02485400
024855                                                                  02485500
024856     INITIALIZE PV-VARIABLE-ID                                    02485600
024857                PV-TALLY.                                         02485700
024858                                                                  02485800
024859     INSPECT EP204-OFR-SECT-BWP-ID TALLYING PV-TALLY              02485900
024860         FOR LEADING ZEROES.                                      02486000
024861     SET PV-EFBM-IDX TO PV-TALLY.                                 02486100
024862     SET PV-EFBM-IDX UP BY +1.                                    02486201
024863     MOVE EP204-OFR-SECT-BWP-ID TO PV-VARIABLE-ID.                02486300
024864                                                                  02486400
024865     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02486500
024866        FROM PV-EFBM-IDX BY 1                                     02486600
024867       UNTIL PV-EFBM-BIT-IDX > 10.                                02486700
024868                                                                  02486800
024869     PERFORM 6900-MOVE-DELIMITER.                                 02486900
024870                                                                  02487000
024871*-------  MOVE OFR-SECT-MDSE-SET-ID --(NOT NULL)-----*******      02487100
024872                                                                  02487200
024873     INITIALIZE PV-VARIABLE-ID                                    02487300
024874                PV-TALLY.                                         02487400
024875                                                                  02487500
024876     INSPECT EP204-MDSE-SET-ID TALLYING PV-TALLY                  02487600
024877         FOR LEADING ZEROES.                                      02487700
024878     SET PV-EFBM-IDX TO PV-TALLY.                                 02487800
024879     SET PV-EFBM-IDX UP BY +1.                                    02487901
024880     MOVE EP204-MDSE-SET-ID TO PV-VARIABLE-ID.                    02488000
024881                                                                  02488100
024882     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02488200
024883        FROM PV-EFBM-IDX BY 1                                     02488300
024884       UNTIL PV-EFBM-BIT-IDX > 10.                                02488400
024885                                                                  02488500
024886     PERFORM 6900-MOVE-DELIMITER.                                 02488600
024890                                                                  02489000
024900*-------  MOVE MDSE-HIER-CDE ---------(NOT NULL)-----*******      02490000
025000                                                                  02500000
025100     INITIALIZE PV-VARIABLE-ID                                    02510000
025200                PV-TALLY.                                         02520000
025300                                                                  02530000
025800     MOVE EP204-MDSE-HIER-CDE TO PV-VARIABLE-ID.                  02580000
025900                                                                  02590000
026000     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02600000
026100        FROM 1 BY 1                                               02610000
026200       UNTIL PV-EFBM-BIT-IDX > 3 OR                               02620000
026300             PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE.                02630000
026310                                                                  02631000
026400     PERFORM 6900-MOVE-DELIMITER.                                 02640000
026401                                                                  02640100
026410*-------  MOVE DEPT-NBR ------------------(NULL)-----*******      02641000
026420                                                                  02642000
026430     INITIALIZE PV-VARIABLE-ID                                    02643000
026440                PV-TALLY.                                         02644000
026450     EVALUATE TRUE                                                02645000
026460         WHEN EP204-DEPT-NBR-X = '~'                              02646000
026470             PERFORM 6850-MOVE-NULL-VALUE                         02647000
026480         WHEN EP204-DEPT-NBR   = ZEROES                           02648000
026490             PERFORM 6700-MOVE-ZERO                               02649000
026491         WHEN OTHER                                               02649100
026492             INSPECT EP204-DEPT-NBR  TALLYING PV-TALLY            02649200
026493                 FOR LEADING ZEROES                               02649300
026494             SET PV-EFBM-IDX TO PV-TALLY                          02649400
026495             SET PV-EFBM-IDX UP BY +1                             02649501
026496             MOVE EP204-DEPT-NBR TO PV-VARIABLE-ID                02649600
026497                                                                  02649700
026498             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02649800
026499                FROM PV-EFBM-IDX BY 1                             02649900
026500                UNTIL PV-EFBM-BIT-IDX > 4 OR                      02650000
026501                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02650100
026510                                                                  02651000
026520             PERFORM 6900-MOVE-DELIMITER                          02652000
026530     END-EVALUATE.                                                02653000
026531                                                                  02653100
026532*-------  MOVE MAJ-CL-NBR ----------------(NULL)-----*******      02653200
026533                                                                  02653300
026534     INITIALIZE PV-VARIABLE-ID                                    02653400
026535                PV-TALLY.                                         02653500
026536     EVALUATE TRUE                                                02653600
026537         WHEN EP204-MAJ-CL-NBR-X = '~'                            02653700
026538             PERFORM 6850-MOVE-NULL-VALUE                         02653800
026539         WHEN EP204-MAJ-CL-NBR = ZEROES                           02653900
026540             PERFORM 6700-MOVE-ZERO                               02654000
026541         WHEN OTHER                                               02654100
026542             INSPECT EP204-MAJ-CL-NBR  TALLYING PV-TALLY          02654200
026543                 FOR LEADING ZEROES                               02654300
026544             SET PV-EFBM-IDX TO PV-TALLY                          02654400
026545             SET PV-EFBM-IDX UP BY +1                             02654501
026547             MOVE EP204-MAJ-CL-NBR TO PV-VARIABLE-ID              02654700
026548                                                                  02654800
026549             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02654900
026550                FROM PV-EFBM-IDX BY 1                             02655000
026551                UNTIL PV-EFBM-BIT-IDX > 4 OR                      02655100
026552                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02655200
026553                                                                  02655300
026554             PERFORM 6900-MOVE-DELIMITER                          02655400
026555     END-EVALUATE.                                                02655500
026556                                                                  02655600
026557*-------  MOVE SUB-CL-NBR ----------------(NULL)-----*******      02655700
026558                                                                  02655800
026559     INITIALIZE PV-VARIABLE-ID                                    02655900
026560                PV-TALLY.                                         02656000
026561     EVALUATE TRUE                                                02656100
026562         WHEN EP204-SUB-CL-NBR-X = '~'                            02656200
026563             PERFORM 6850-MOVE-NULL-VALUE                         02656300
026564         WHEN EP204-SUB-CL-NBR = ZEROES                           02656400
026565             PERFORM 6700-MOVE-ZERO                               02656500
026566         WHEN OTHER                                               02656600
026567             INSPECT EP204-SUB-CL-NBR  TALLYING PV-TALLY          02656700
026568                 FOR LEADING ZEROES                               02656800
026569             SET PV-EFBM-IDX TO PV-TALLY                          02656900
026570             SET PV-EFBM-IDX UP BY +1                             02657001
026571             MOVE EP204-SUB-CL-NBR TO PV-VARIABLE-ID              02657100
026572                                                                  02657200
026573             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02657300
026574                FROM PV-EFBM-IDX BY 1                             02657400
026575                UNTIL PV-EFBM-BIT-IDX > 4 OR                      02657500
026576                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02657600
026577                                                                  02657700
026578             PERFORM 6900-MOVE-DELIMITER                          02657800
026579     END-EVALUATE.                                                02657900
026580                                                                  02658000
026581*-------  MOVE STYL-ID -- ----------------(NULL)-----*******      02658100
026582                                                                  02658200
026583     INITIALIZE PV-VARIABLE-ID                                    02658300
026584                PV-TALLY.                                         02658400
026585     EVALUATE TRUE                                                02658500
026586         WHEN EP204-STYL-ID-X = '~'                               02658600
026587             PERFORM 6850-MOVE-NULL-VALUE                         02658700
026588         WHEN EP204-STYL-ID = ZEROES                              02658800
026589             PERFORM 6700-MOVE-ZERO                               02658900
026590         WHEN OTHER                                               02659000
026591             INSPECT EP204-STYL-ID     TALLYING PV-TALLY          02659100
026592                 FOR LEADING ZEROES                               02659200
026593             SET PV-EFBM-IDX TO PV-TALLY                          02659300
026594             SET PV-EFBM-IDX UP BY +1                             02659401
026595             MOVE EP204-STYL-ID    TO PV-VARIABLE-ID              02659500
026596                                                                  02659600
026597             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02659700
026598                FROM PV-EFBM-IDX BY 1                             02659800
026599                UNTIL PV-EFBM-BIT-IDX > 8 OR                      02659900
026600                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02660000
026601                                                                  02660100
026602             PERFORM 6900-MOVE-DELIMITER                          02660200
026603     END-EVALUATE.                                                02660300
026604                                                                  02660400
026605*-------  MOVE SKU-NBR -------------------(NULL)-----*******      02660500
026606                                                                  02660600
026607     INITIALIZE PV-VARIABLE-ID                                    02660700
026608                PV-TALLY.                                         02660800
026609     EVALUATE TRUE                                                02660900
026610         WHEN EP204-SKU-NBR-X = '~'                               02661000
026611             PERFORM 6850-MOVE-NULL-VALUE                         02661100
026612         WHEN EP204-SKU-NBR = ZEROES                              02661200
026613             PERFORM 6700-MOVE-ZERO                               02661300
026614         WHEN OTHER                                               02661400
026615             INSPECT EP204-SKU-NBR     TALLYING PV-TALLY          02661500
026616                 FOR LEADING ZEROES                               02661600
026617             SET PV-EFBM-IDX TO PV-TALLY                          02661700
026618             SET PV-EFBM-IDX UP BY +1                             02661801
026619             MOVE EP204-SKU-NBR    TO PV-VARIABLE-ID              02661900
026620                                                                  02662000
026621             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02662100
026622                FROM PV-EFBM-IDX BY 1                             02662200
026623                UNTIL PV-EFBM-BIT-IDX > 8 OR                      02662300
026624                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02662400
026625                                                                  02662500
026626             PERFORM 6900-MOVE-DELIMITER                          02662600
026627     END-EVALUATE.                                                02662700
026628                                                                  02662800
026629*-------  MOVE IE-IND  ---------------(NOT NULL)-----*******      02662900
026630                                                                  02663000
026631     INITIALIZE PV-VARIABLE-ID                                    02663100
026632                PV-TALLY.                                         02663200
026633     EVALUATE TRUE                                                02663300
026636         WHEN EP204-IE-IND = SPACES                               02663600
026637             PERFORM 6800-MOVE-SPACE                              02663700
026638         WHEN OTHER                                               02663800
026643             MOVE EP204-IE-IND     TO PV-VARIABLE-ID              02664300
026644                                                                  02664400
026645             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02664500
026646                FROM 1 BY 1                                       02664600
026647                UNTIL PV-EFBM-BIT-IDX > 1                         02664700
026649                                                                  02664900
026650             PERFORM 6900-MOVE-DELIMITER                          02665000
026651     END-EVALUATE.                                                02665100
026652                                                                  02665200
026653*-------  MOVE EMP-DISC-CDE --------------(NULL)-----*******      02665300
026654                                                                  02665400
026655     INITIALIZE PV-VARIABLE-ID                                    02665500
026656                PV-TALLY.                                         02665600
026657     EVALUATE TRUE                                                02665700
026658         WHEN EP204-EMP-DISC-CDE = '~'                            02665800
026659             PERFORM 6850-MOVE-NULL-VALUE                         02665900
026660         WHEN EP204-EMP-DISC-CDE = SPACES                         02666000
026661             PERFORM 6800-MOVE-SPACE                              02666100
026662         WHEN OTHER                                               02666200
026663             MOVE EP204-EMP-DISC-CDE     TO PV-VARIABLE-ID        02666300
026664                                                                  02666400
026665             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02666500
026666                FROM 1 BY 1                                       02666600
026667                UNTIL PV-EFBM-BIT-IDX > 1                         02666700
026668                                                                  02666800
026669             PERFORM 6900-MOVE-DELIMITER                          02666900
026670     END-EVALUATE.                                                02667000
026680                                                                  02668000
026690*-------  MOVE DISC-ELIG-IND--------------(NULL)-----*******      02669000
026691                                                                  02669100
026692     INITIALIZE PV-VARIABLE-ID                                    02669200
026693                PV-TALLY.                                         02669300
026694     EVALUATE TRUE                                                02669400
026695         WHEN EP204-DISC-ELIG-IND = '~'                           02669500
026696             PERFORM 6850-MOVE-NULL-VALUE                         02669600
026697         WHEN EP204-DISC-ELIG-IND = SPACES                        02669700
026698             PERFORM 6800-MOVE-SPACE                              02669800
026699         WHEN OTHER                                               02669900
026700             MOVE EP204-DISC-ELIG-IND    TO PV-VARIABLE-ID        02670000
026710                                                                  02671000
026720             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02672000
026730                FROM 1 BY 1                                       02673000
026740                UNTIL PV-EFBM-BIT-IDX > 1                         02674000
026750                                                                  02675000
026760             PERFORM 6900-MOVE-DELIMITER                          02676000
026770     END-EVALUATE.                                                02677000
026780                                                                  02678000
026790*-------  MOVE TKT-CLOR-CDE --------------(NULL)-----*******      02679000
026791                                                                  02679100
026792     INITIALIZE PV-VARIABLE-ID                                    02679200
026793                PV-TALLY.                                         02679300
026794     EVALUATE TRUE                                                02679400
026795         WHEN EP204-TKT-CLOR-CDE  = '~'                           02679500
026796             PERFORM 6850-MOVE-NULL-VALUE                         02679600
026797         WHEN EP204-TKT-CLOR-CDE  = SPACES                        02679700
026798             PERFORM 6800-MOVE-SPACE                              02679800
026799         WHEN OTHER                                               02679900
026800             MOVE EP204-TKT-CLOR-CDE     TO PV-VARIABLE-ID        02680000
026810                                                                  02681000
026820             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02682000
026830                FROM 1 BY 1                                       02683000
026840                UNTIL PV-EFBM-BIT-IDX > 1                         02684000
026850                                                                  02685000
026860             PERFORM 6900-MOVE-DELIMITER                          02686000
026870     END-EVALUATE.                                                02687000
026880                                                                  02688000
032892                                                                  03289200
032893*4500-EXIT.                                                       03289300
032894 EJECT.                                                           03289400
032895                                                                  03289500
032896*-------------------------------------------------------------    03289600
032897* 5000-INCR-HEADER-TIMESTAMP.                                     03289700
032898*     THIS PARAGRAPH WILL INCREMENT THE TIMESTAMP BY 1 SECOND     03289800
032899*     THIS WOULD ENSURE THE HEADER RECORDS TO BE 1 SECOND APART   03289900
032900*     WHICH IS MID-TIER REQUIREMENT.                              03290000
032901*-------------------------------------------------------------    03290100
032902 5000-INCR-HEADER-TIMESTAMP.                                      03290200
032903                                                                  03290300
032904     ADD 1                                                        03290400
032905       TO PV-HEADER-SS.                                           03290500
032906     IF PV-HEADER-SS GREATER 59                                   03290600
032907         MOVE ZERO                                                03290700
032908           TO PV-HEADER-SS                                        03290800
032909         ADD 1                                                    03290900
032910           TO PV-HEADER-MM                                        03291000
032911     END-IF.                                                      03291100
032912                                                                  03291200
032913     IF PV-HEADER-MM GREATER 59                                   03291300
032914         MOVE ZERO                                                03291400
032915           TO PV-HEADER-MM                                        03291500
032916         ADD 1                                                    03291600
032917           TO PV-HEADER-HH                                        03291700
032918     END-IF.                                                      03291800
032919                                                                  03291900
032920     IF PV-HEADER-HH GREATER 23                                   03292000
032921         MOVE ZERO                                                03292100
032922           TO PV-HEADER-HH                                        03292200
032923         ADD 1                                                    03292300
032924           TO PV-HEADER-DD                                        03292400
032925     END-IF.                                                      03292500
032926                                                                  03292600
032927     IF PV-HEADER-MO = 01                                         03292700
032928       OR PV-HEADER-MO = 03                                       03292800
032929         OR PV-HEADER-MO = 05                                     03292900
032930           OR PV-HEADER-MO = 07                                   03293000
032931             OR PV-HEADER-MO = 08                                 03293100
032932               OR PV-HEADER-MO = 10                               03293200
032933                 OR PV-HEADER-MO = 12                             03293300
032934         IF PV-HEADER-DD GREATER 31                               03293400
032935             MOVE 1                                               03293500
032936               TO PV-HEADER-DD                                    03293600
032937             ADD 1                                                03293700
032938               TO PV-HEADER-MO                                    03293800
032939         END-IF                                                   03293900
032940     ELSE                                                         03294000
032941         IF PV-HEADER-MO = 04                                     03294100
032942           OR PV-HEADER-MO = 06                                   03294200
032943             OR PV-HEADER-MO = 09                                 03294300
032944               OR PV-HEADER-MO = 11                               03294400
032945             IF PV-HEADER-DD GREATER 30                           03294500
032946                 MOVE 1                                           03294600
032947                   TO PV-HEADER-DD                                03294700
032948                 ADD 1                                            03294800
032949                   TO PV-HEADER-MO                                03294900
032950             END-IF                                               03295000
032951         ELSE                                                     03295100
032952             IF PV-HEADER-MO = 02                                 03295200
032953                 DIVIDE PV-HEADER-YYYY BY 100                     03295300
032954                   GIVING PV-QUOTIENT                             03295400
032955                     REMAINDER PV-RMDR-100                        03295500
032956                 DIVIDE PV-HEADER-YYYY BY 4                       03295600
032957                   GIVING PV-QUOTIENT                             03295700
032958                     REMAINDER PV-RMDR-4                          03295800
032959                 IF PV-RMDR-100 = 0                               03295900
032960                     IF PV-HEADER-DD GREATER 28                   03296000
032961                         MOVE 1                                   03296100
032962                           TO PV-HEADER-DD                        03296200
032963                         ADD 1                                    03296300
032964                           TO PV-HEADER-MO                        03296400
032965                     END-IF                                       03296500
032966                 ELSE                                             03296600
032967                     IF PV-RMDR-4 = 0                             03296700
032968                         IF PV-HEADER-DD GREATER 29               03296800
032969                             MOVE 1                               03296900
032970                               TO PV-HEADER-DD                    03297000
032971                             ADD 1                                03297100
032972                               TO PV-HEADER-MO                    03297200
032973                         END-IF                                   03297300
032974                     ELSE                                         03297400
032975                         IF PV-HEADER-DD GREATER 28               03297500
032976                             MOVE 1                               03297600
032977                               TO PV-HEADER-DD                    03297700
032978                             ADD 1                                03297800
032979                               TO PV-HEADER-MO                    03297900
032980                         END-IF                                   03298000
032981                     END-IF                                       03298100
032982                 END-IF                                           03298200
032983             END-IF                                               03298300
032984         END-IF                                                   03298400
032985     END-IF.                                                      03298500
032986                                                                  03298600
032987     IF PV-HEADER-MO GREATER 12                                   03298700
032988         MOVE 1                                                   03298800
032989           TO PV-HEADER-MO                                        03298900
032990         ADD 1                                                    03299000
032991           TO PV-HEADER-YYYY                                      03299100
032992     END-IF.                                                      03299200
032993                                                                  03299300
032994*5000-EXIT.                                                       03299400
032995 EJECT.                                                           03299500
032996                                                                  03299600
032997*-----------------------------------------------------------------03299700
032998* 5100-DETERMINE-OFFER-INRANGE.                                   03299800
032999*  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03299900
033000*  OFFER RECORD READ.                                             03300000
033001*----------------------------------------------------------------*03300100
033002 5100-DETERMINE-OFFER-INRANGE.                                    03300200
033003                                                                  03300300
033004     IF EP201-OFFER-ID >= PV-BEGIN-OFR-ID AND                     03300400
033005        EP201-OFFER-ID <= PV-END-OFR-ID  AND                      03300500
033006        EP201-STR-NBR = PV-STORE-NBR-RANGE                        03300600
033007        SET PS-EP201-OFR-INRANGE TO TRUE                          03300700
033008     ELSE                                                         03300800
033009        SET PS-EP201-OFR-NOT-INRANGE TO TRUE                      03300900
033010     END-IF.                                                      03301000
033020                                                                  03302000
033030*5100-EXIT.                                                       03303000
033031 EJECT.                                                           03303100
033032                                                                  03303200
033033*-----------------------------------------------------------------03303300
033034* 5200-DETERMINE-SECTN-INRANGE.                                   03303400
033035*  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03303500
033036*  SECTN RECORD READ (EP202)                                      03303600
033037*----------------------------------------------------------------*03303700
033038 5200-DETERMINE-SECTN-INRANGE.                                    03303800
033039                                                                  03303900
033040     IF EP202-OFFER-ID >= PV-BEGIN-OFR-ID AND                     03304000
033041        EP202-OFFER-ID <= PV-END-OFR-ID AND                       03304100
033042        EP202-STR-NBR = PV-STORE-NBR-RANGE                        03304200
033043        SET PS-EP202-OFR-INRANGE TO TRUE                          03304300
033044     ELSE                                                         03304400
033045        SET PS-EP202-OFR-NOT-INRANGE TO TRUE                      03304500
033046     END-IF.                                                      03304600
033047                                                                  03304700
033061*5200-EXIT.                                                       03306100
033062 EJECT.                                                           03306200
033063                                                                  03306300
033064                                                                  03306400
033065*-----------------------------------------------------------------03306500
033066* 5300-DETERMINE-BWP-INRANGE.                                     03306600
033067*  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03306700
033068*  BWP   RECORD READ (EP203)                                      03306800
033069*----------------------------------------------------------------*03306900
033070 5300-DETERMINE-BWP-INRANGE.                                      03307000
033071                                                                  03307100
033072     IF EP203-OFFER-ID >= PV-BEGIN-OFR-ID AND                     03307200
033073        EP203-OFFER-ID <= PV-END-OFR-ID AND                       03307300
033074        EP203-STR-NBR = PV-STORE-NBR-RANGE                        03307400
033075        SET PS-EP203-OFR-INRANGE TO TRUE                          03307500
033076     ELSE                                                         03307600
033077        SET PS-EP203-OFR-NOT-INRANGE TO TRUE                      03307700
033078     END-IF.                                                      03307800
033079                                                                  03307900
033086*5300-EXIT.                                                       03308600
033087 EJECT.                                                           03308700
033088                                                                  03308800
033089*-----------------------------------------------------------------03308900
033090* 5400-DETERMINE-MDSE-INRANGE.                                    03309000
033091*  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03309100
033092*  MDSE  RECORD READ (EP204)                                      03309200
033093*----------------------------------------------------------------*03309300
033094 5400-DETERMINE-MDSE-INRANGE.                                     03309401
033095                                                                  03309500
033096     IF EP204-OFFER-ID >= PV-BEGIN-OFR-ID AND                     03309600
033097        EP204-OFFER-ID <= PV-END-OFR-ID AND                       03309700
033098        EP204-STR-NBR = PV-STORE-NBR-RANGE                        03309800
033099        SET PS-EP204-OFR-INRANGE TO TRUE                          03309900
033100     ELSE                                                         03310000
033101        SET PS-EP204-OFR-NOT-INRANGE TO TRUE                      03310100
033102     END-IF.                                                      03310200
033103                                                                  03310300
033104*5400-EXIT.                                                       03310400
033105 EJECT.                                                           03310500
033106                                                                  03310600
033107*----------------------------------------------------------       03310701
033108* 6000-READ-STORE-LIST-FILE                                       03310801
033109*     THIS PARAGRAPH READS DATA FROM OFFERS-DATA-FILE INTO        03310901
033110*     COPYBOOK EPRD201  (INP01)                                   03311001
033111*----------------------------------------------------------       03311101
033112 6000-READ-STORE-LIST-FILE.                                       03311201
033113                                                                  03311301
033114     READ STORE-LIST-FILE                                         03311401
033115         INTO EP206-STORE-LIST-RCD                                03311501
033116     AT END                                                       03311601
033117         SET PS-END-OF-STORE-FILE TO TRUE                         03311701
033118     END-READ.                                                    03311801
033119                                                                  03311901
033120*6000-EXIT.                                                       03312001
033121 EJECT.                                                           03312101
033122                                                                  03312201
033125*----------------------------------------------------------       03312500
033126* 6100-READ-OFFER-DATA                                            03312600
033127*     THIS PARAGRAPH READS DATA FROM OFFERS-DATA-FILE INTO        03312700
033128*     COPYBOOK EPRD201  (INP01)                                   03312800
033129*----------------------------------------------------------       03312900
033130 6100-READ-OFFER-DATA.                                            03313000
033131                                                                  03313100
033132     READ OFFERS-DATA-FILE INTO                                   03313200
033133         EP201-OFFER-XST-OFR-RECORD                               03313300
033134     AT END                                                       03313400
033135         SET PS-END-OFR-FILE TO TRUE                              03313500
033136     END-READ.                                                    03313600
033137                                                                  03313700
033138     IF PS-NOT-END-OFR-FILE                                       03313800
033139        MOVE 0 TO PV-PIPE-COUNT                                   03313900
033140        PERFORM 8100-CHECK-INP01-FOR-PIPES                        03314000
033141     END-IF.                                                      03314100
033142                                                                  03314200
033143*6100-EXIT.                                                       03314300
033144 EJECT.                                                           03314400
033145                                                                  03314500
033150*----------------------------------------------------------       03315000
033151* 6200-READ-SECTN-DATA                                            03315100
033152*     THIS PARAGRAPH READS DATA FROM OFFERS-SECTION-FILE INTO     03315200
033153*     COPYBOOK EPRD202  (INP02)                                   03315300
033154*----------------------------------------------------------       03315400
033155 6200-READ-SECTN-DATA.                                            03315500
033156                                                                  03315600
033157     READ OFFERS-SECTION-FILE INTO                                03315700
033158         EP202-OFFER-XST-OFR-SECT-RCD                             03315800
033159     AT END                                                       03315900
033160         SET PS-END-SEC-FILE TO TRUE                              03316000
033161     END-READ.                                                    03316100
033162                                                                  03316200
033163     IF PS-NOT-END-SEC-FILE                                       03316300
033164        MOVE 0 TO PV-PIPE-COUNT                                   03316400
033165        PERFORM 8200-CHECK-INP02-FOR-PIPES                        03316500
033166     END-IF.                                                      03316600
033167                                                                  03316700
033168*6200-EXIT.                                                       03316800
033169 EJECT.                                                           03316900
033170                                                                  03317000
033192*----------------------------------------------------------       03319200
033193* 6300-READ-BWP-DATA                                              03319300
033194*     THIS PARAGRAPH READS DATA FROM OFFERS-BWP-FILE INTO         03319400
033195*     COPYBOOK EPRD203  (INP03)                                   03319500
033196*----------------------------------------------------------       03319600
033197 6300-READ-BWP-DATA.                                              03319700
033198                                                                  03319800
033199     READ OFFERS-BWP-FILE INTO                                    03319900
033200         EP203-OFFER-XST-BWP-RECORD                               03320000
033201     AT END                                                       03320100
033202         SET PS-END-BWP-FILE TO TRUE                              03320200
033203     END-READ.                                                    03320300
033204                                                                  03320400
033205     IF PS-NOT-END-BWP-FILE                                       03320500
033206        MOVE 0 TO PV-PIPE-COUNT                                   03320600
033207        PERFORM 8300-CHECK-INP03-FOR-PIPES                        03320700
033208     END-IF.                                                      03320800
033209                                                                  03320900
033210*6300-EXIT.                                                       03321000
033211 EJECT.                                                           03321100
033212                                                                  03321200
033234*----------------------------------------------------------       03323400
033235* 6400-READ-MDSE-DATA                                             03323500
033236*     THIS PARAGRAPH READS DATA FROM OFFERS-MDSE-FILE INTO        03323600
033237*     COPYBOOK EPRD204  (INP04)                                   03323700
033238*----------------------------------------------------------       03323800
033239 6400-READ-MDSE-DATA.                                             03323900
033240                                                                  03324000
033241     READ OFFERS-MDSE-FILE INTO                                   03324100
033242         EP204-OFFER-XST-OFR-MDSE-SET                             03324200
033243     AT END                                                       03324300
033244         SET PS-END-OF-MDSE-FILE TO TRUE                          03324400
033245     END-READ.                                                    03324500
033246                                                                  03324600
033247     IF PS-NOT-END-OF-MDSE-FILE                                   03324700
033248        MOVE 0 TO PV-PIPE-COUNT                                   03324800
033249        PERFORM 8400-CHECK-INP04-FOR-PIPES                        03324900
033250     END-IF.                                                      03325000
033251                                                                  03325100
033252*6400-EXIT.                                                       03325200
033253 EJECT.                                                           03325300
033254                                                                  03325400
033276*----------------------------------------------------------       03327600
033277* 6500-MOVE-ID-DATA                                               03327700
033278*     THIS PARAGRAPH MOVES ONE BIT OF DATA TO THE OUTPUT FILE REC 03327800
033279*----------------------------------------------------------       03327900
033280 6500-MOVE-ID-DATA.                                               03328000
033281                                                                  03328100
033282     MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                            03328200
033283       TO FORM-OFR-FLD(FORM-OFR-LEN).                             03328300
033284     SET FORM-OFR-LEN                                             03328400
033285       UP BY +1.                                                  03328501
033286     ADD 1                                                        03328600
033287       TO PV-BYTE-COUNT.                                          03328700
033288                                                                  03328800
033289*6500-EXIT.                                                       03328900
033290 EJECT.                                                           03329000
033291                                                                  03329100
033292*----------------------------------------------------------       03329200
033293* 6550-MOVE-AMT-ID-DATA                                           03329300
033294*     THIS PARAGRAPH IS USED TO MOVE A BIT VALUE FROM INPUT       03329400
033295*     TO THE OUTPUT RECORD, WHERE THE INPUT FIELD IS              03329500
033296*     DECIMAL AMOUNT, DECIMAL POINT IS SPECIFICALLY MOVED         03329600
033297*     TO FORMAT THE AMOUNT FIELD CORRECTLY.                       03329700
033298*----------------------------------------------------------       03329800
033299 6550-MOVE-AMT-ID-DATA.                                           03329900
033300                                                                  03330000
033301     IF PV-EFBM-BIT-IDX = 7                                       03330100
033302        MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                         03330200
033303          TO FORM-OFR-FLD(FORM-OFR-LEN)                           03330300
033304                                                                  03330400
033305        SET FORM-OFR-LEN UP BY +1                                 03330501
033306        ADD 1 TO PV-BYTE-COUNT                                    03330600
033307                                                                  03330700
033308        MOVE '.' TO FORM-OFR-FLD(FORM-OFR-LEN)                    03330800
033309                                                                  03330900
033310     ELSE                                                         03331000
033311        MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                         03331100
033312          TO FORM-OFR-FLD(FORM-OFR-LEN)                           03331200
033313     END-IF.                                                      03331300
033314                                                                  03331400
033315     SET FORM-OFR-LEN                                             03331500
033316       UP BY +1.                                                  03331601
033317     ADD 1                                                        03331700
033318       TO PV-BYTE-COUNT.                                          03331800
033319                                                                  03331900
033320*6550-EXIT.                                                       03332000
033321 EJECT.                                                           03332100
033322                                                                  03332200
033323                                                                  03332300
033324*-------------------------------------------------------------    03332400
033325* 6600-FIND-DATA-END.                                             03332500
033326*  THIS PARAGRAPH IS USED IN A LOOP TO DETERMINE THE LENGTH OF    03332600
033327*  THE STRING.                                                    03332700
033328*-------------------------------------------------------------    03332800
033329 6600-FIND-DATA-END.                                              03332900
033330                                                                  03333000
033331     MOVE ' '                                                     03333100
033332       TO PV-SPACE.                                               03333200
033333                                                                  03333300
033334*6600-EXIT.                                                       03333400
033335 EJECT.                                                           03333500
033336                                                                  03333600
033337*----------------------------------------------------------       03333700
033338* 6650-FIELD-MOVER                                                03333800
033339*     THIS PARAGRAPH MOVES A BIT OF DATA TO THE OUTPUT FILE RECORD03333900
033340*----------------------------------------------------------       03334000
033341 6650-FIELD-MOVER.                                                03334100
033342                                                                  03334200
033343     MOVE PV-BIT-VARIABLE(PV-BIT-IDX)                             03334300
033344       TO FORM-OFR-FLD(FORM-OFR-LEN).                             03334400
033345     SET FORM-OFR-LEN                                             03334500
033346       UP BY +1.                                                  03334601
033347     ADD 1                                                        03334700
033348       TO PV-BYTE-COUNT.                                          03334800
033349                                                                  03334900
033350*6650-EXIT.                                                       03335000
033351 EJECT.                                                           03335100
033352                                                                  03335200
033353                                                                  03335300
033354*-----------------------------------------------------------------03335400
033355* 6700-MOVE-ZERO                                                  03335500
033356*  THIS PARAGRAPH WILL MOVE '0' TO THE OUTPUT FILE VARIABLE       03335600
033357*----------------------------------------------------------------*03335700
033358 6700-MOVE-ZERO.                                                  03335800
033359                                                                  03335900
033360     MOVE PC-ONE-ZERO                                             03336000
033361       TO FORM-OFR-FLD(FORM-OFR-LEN).                             03336100
033362     SET FORM-OFR-LEN                                             03336200
033363       UP BY +1.                                                  03336301
033364     ADD 1                                                        03336400
033365       TO PV-BYTE-COUNT.                                          03336500
033366                                                                  03336600
033367     PERFORM 6900-MOVE-DELIMITER.                                 03336700
033368                                                                  03336800
033369*6700-EXIT.                                                       03336900
033370 EJECT.                                                           03337000
033371*-----------------------------------------------------------------03337100
033372* 6800-MOVE-SPACE                                                 03337200
033373*  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE       03337300
033374*----------------------------------------------------------------*03337400
033375 6800-MOVE-SPACE.                                                 03337500
033376                                                                  03337600
033377     MOVE PC-ONE-SPACE                                            03337700
033378       TO FORM-OFR-FLD(FORM-OFR-LEN).                             03337800
033379     SET FORM-OFR-LEN                                             03337900
033380       UP BY +1.                                                  03338001
033381     ADD 1                                                        03338100
033382       TO PV-BYTE-COUNT.                                          03338200
033383                                                                  03338300
033384     PERFORM 6900-MOVE-DELIMITER.                                 03338400
033385                                                                  03338500
033386                                                                  03338600
033387*6800-EXIT.                                                       03338700
033388 EJECT.                                                           03338800
033389                                                                  03338900
033390                                                                  03339000
033391*-----------------------------------------------------------------03339100
033392* 6850-MOVE-NULL-VALUE                                            03339200
033393*  THIS PARAGRAPH WILL MOVE '~' TO THE OUTPUT FILE VARIABLE       03339300
033394*----------------------------------------------------------------*03339400
033395 6850-MOVE-NULL-VALUE.                                            03339500
033396                                                                  03339600
033397     MOVE PC-NULL-VALUE                                           03339700
033398       TO FORM-OFR-FLD(FORM-OFR-LEN).                             03339800
033399     SET FORM-OFR-LEN                                             03339900
033400       UP BY +1.                                                  03340001
033401     ADD 1                                                        03340100
033402       TO PV-BYTE-COUNT.                                          03340200
033403                                                                  03340300
033404     PERFORM 6900-MOVE-DELIMITER.                                 03340400
033405                                                                  03340500
033406*6800-EXIT.                                                       03340600
033407 EJECT.                                                           03340700
033408                                                                  03340800
033409                                                                  03340900
033410*-----------------------------------------------------------------03341000
033411* 6900-MOVE-DELIMITER.                                            03341100
033412*  THIS PARAGRAPH WILL MOVE '|' TO THE OUTPUT FILE VARIABLE       03341200
033413*----------------------------------------------------------------*03341300
033414 6900-MOVE-DELIMITER.                                             03341400
033415                                                                  03341500
033416     MOVE PC-CSV-DELIMITER                                        03341600
033417       TO FORM-OFR-FLD(FORM-OFR-LEN).                             03341700
033418     SET FORM-OFR-LEN                                             03341800
033419       UP BY +1.                                                  03341901
033420     ADD 1                                                        03342000
033421       TO PV-BYTE-COUNT.                                          03342100
033422                                                                  03342200
033423*6900-EXIT.                                                       03342300
033424 EJECT.                                                           03342400
033425                                                                  03342500
033426*----------------------------------------------------------       03342600
033427* 8100-CHECK-INP01-FOR-PIPES                                      03342700
033428*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03342800
033429*     REPLACES PIPES WITH SPACE.                                  03342900
033430*----------------------------------------------------------       03343000
033431 8100-CHECK-INP01-FOR-PIPES.                                      03343100
033432                                                                  03343200
033433     INSPECT EP201-OFFER-XST-OFR-RECORD                           03343300
033434          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03343400
033435                                                                  03343500
033436     IF PV-PIPE-COUNT > 0                                         03343600
033437        INSPECT EP201-OFFER-XST-OFR-RECORD                        03343700
033438            REPLACING ALL '|'  BY  ' '                            03343800
033439        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'  03343900
033440                ' | WITH A SPACE '                                03344000
033441        DISPLAY EP201-OFFER-XST-OFR-RECORD                        03344100
033442     END-IF.                                                      03344200
033443                                                                  03344300
033444*8100-EXIT.                                                       03344400
033445 EJECT.                                                           03344500
033446                                                                  03344600
033447*----------------------------------------------------------       03344700
033448* 8200-CHECK-INP02-FOR-PIPES                                      03344800
033449*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03344900
033450*     REPLACES PIPES WITH SPACE.                                  03345000
033451*----------------------------------------------------------       03345100
033452 8200-CHECK-INP02-FOR-PIPES.                                      03345200
033453                                                                  03345300
033454     INSPECT EP202-OFFER-XST-OFR-SECT-RCD                         03345400
033455          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03345500
033456                                                                  03345600
033457     IF PV-PIPE-COUNT > 0                                         03345700
033458        INSPECT EP202-OFFER-XST-OFR-SECT-RCD                      03345800
033459            REPLACING ALL '|'  BY  ' '                            03345900
033460        DISPLAY ' INPUT SECTN RECORD HAD PIPES IN IT, REPLACING ' 03346000
033461                ' | WITH A SPACE '                                03346100
033462        DISPLAY EP202-OFFER-XST-OFR-SECT-RCD                      03346200
033463     END-IF.                                                      03346300
033464                                                                  03346400
033465*8200-EXIT.                                                       03346500
033466 EJECT.                                                           03346600
033467                                                                  03346700
033468*----------------------------------------------------------       03346800
033469* 8300-CHECK-INP03-FOR-PIPES                                      03346900
033470*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03347000
033471*     REPLACES PIPES WITH SPACE.                                  03347100
033472*----------------------------------------------------------       03347200
033473 8300-CHECK-INP03-FOR-PIPES.                                      03347300
033474                                                                  03347400
033475     INSPECT EP203-OFFER-XST-BWP-RECORD                           03347500
033476          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03347600
033477                                                                  03347700
033478     IF PV-PIPE-COUNT > 0                                         03347800
033479        INSPECT EP203-OFFER-XST-BWP-RECORD                        03347900
033480            REPLACING ALL '|'  BY  ' '                            03348000
033481        DISPLAY ' INPUT  BWP  RECORD HAD PIPES IN IT, REPLACING ' 03348100
033482                ' | WITH A SPACE '                                03348200
033483        DISPLAY EP203-OFFER-XST-BWP-RECORD                        03348300
033484     END-IF.                                                      03348400
033485                                                                  03348500
033486*8300-EXIT.                                                       03348600
033487 EJECT.                                                           03348700
033488                                                                  03348800
033489*----------------------------------------------------------       03348900
033490* 8400-CHECK-INP04-FOR-PIPES                                      03349000
033491*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03349100
033492*     REPLACES PIPES WITH SPACE.                                  03349200
033493*----------------------------------------------------------       03349300
033494 8400-CHECK-INP04-FOR-PIPES.                                      03349400
033495                                                                  03349500
033496     INSPECT EP204-OFFER-XST-OFR-MDSE-SET                         03349600
033497          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03349700
033498                                                                  03349800
033499     IF PV-PIPE-COUNT > 0                                         03349900
033500        INSPECT EP204-OFFER-XST-OFR-MDSE-SET                      03350000
033501            REPLACING ALL '|'  BY  ' '                            03350100
033502        DISPLAY ' INPUT MDSE  RECORD HAD PIPES IN IT, REPLACING ' 03350200
033503                ' | WITH A SPACE '                                03350300
033504        DISPLAY EP204-OFFER-XST-OFR-MDSE-SET                      03350400
033505     END-IF.                                                      03350500
033506                                                                  03350600
033507*8400-EXIT.                                                       03350700
033508 EJECT.                                                           03350800
033509                                                                  03350900
033510******************************************************************03351000
033511*     CLOSES ALL FILES AND DISPLAYS ANY NEEDED INFORMATION.      *03351100
033512******************************************************************03351200
033513 9200-WRAPUP.                                                     03351300
033514     MOVE '9200-WRAPUP                     ' TO PV-PARAGRAPH-NAME.03351400
033515                                                                  03351500
033516     PERFORM 9920-DISPLAY-TOTALS.                                 03351600
033517                                                                  03351700
033518     DISPLAY '****************************************'.          03351800
033519     DISPLAY '**          EPKUT206 END              **'.          03351900
033520     DISPLAY '****************************************'.          03352000
033521                                                                  03352100
033522     CLOSE OFFERS-DATA-FILE.                                      03352200
033523     CLOSE OFFERS-SECTION-FILE.                                   03352300
033524     CLOSE OFFERS-BWP-FILE.                                       03352400
033525     CLOSE OFFERS-MDSE-FILE.                                      03352500
033526     CLOSE STORE-LIST-FILE.                                       03352600
033527                                                                  03352700
033528     CLOSE FORMATTED-OFFERS-FILE.                                 03352800
033529                                                                  03352900
033530*9200-EXIT.  EXIT.                                                03353000
033531*---------------------------------------------------------        03353100
033532* 9800-SQL-ABEND.                                                 03353200
033533*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.03353300
033534*---------------------------------------------------------        03353400
033535 9800-SQL-ABEND.                                                  03353500
033536                                                                  03353600
033537     SET AC-DB2-ERROR TO TRUE.                                    03353700
033538                                                                  03353800
033539     DISPLAY '** ABEND     **'.                                   03353900
033540     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                03354000
033541     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              03354100
033542     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               03354200
033543                                                                  03354300
033544     COPY DPPD004.                                                03354400
033545     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         03354500
033546                                                                  03354600
033547*9800-EXIT.                                                       03354700
033548 EJECT.                                                           03354800
033549                                                                  03354900
033550******************************************************************03355000
033551*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.              *   03355100
033552******************************************************************03355200
033553 9910-ABEND.                                                      03355300
033554                                                                  03355400
033555     PERFORM 9920-DISPLAY-TOTALS.                                 03355500
033556                                                                  03355600
033557     DISPLAY '** ABEND           **'.                             03355700
033558     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03355800
033559     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03355900
033560     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       03356000
033561     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       03356100
033562                                                                  03356200
033563     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         03356300
033564                                                                  03356400
033565*9910-EXIT.  EXIT.                                                03356500
033566******************************************************************03356600
033567*     DISPLAY END OF JOB TOTALS                                  *03356700
033568******************************************************************03356800
033569 9920-DISPLAY-TOTALS.                                             03356900
033570                                                                  03357000
033571     DISPLAY '****************************************'.          03357100
033572     DISPLAY '**     STATISTICS  FOR  STORE ' PV-STORE-NBR-RANGE  03357200
033573             ' **'.                                               03357300
033574     DISPLAY '****************************************'.          03357400
033575                                                                  03357500
033576     DISPLAY '** OFFER RECS  WRITEN ====> '                       03357600
033577             PV-OFFER-WRITEN                                      03357700
033578             ' **'.                                               03357800
033579     DISPLAY '** OFR_SECT WRITEN    ====> '                       03357900
033580             PV-OFFER-SECTION                                     03358000
033581             ' **'.                                               03358100
033582     DISPLAY '** OFR_BWP WRITEN     ====> '                       03358200
033583             PV-OFFER-BWP                                         03358300
033584             ' **'.                                               03358400
033585     DISPLAY '** OFR_MDSE WRITEN    ====> '                       03358500
033586             PV-OFFER-MDSE                                        03358600
033587             ' **'.                                               03358700
033588     DISPLAY '****************************************'.          03358800
033589                                                                  03358900
033590*9920-EXIT.  EXIT.                                                03359000
033600                                                                  03360000
