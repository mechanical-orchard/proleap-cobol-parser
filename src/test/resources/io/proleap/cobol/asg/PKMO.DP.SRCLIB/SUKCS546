000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.                SUKCS546.                             00040001
000500 AUTHOR.                    PATRICK BURKE.                        00050001
000600 INSTALLATION.              KOHLS DEPARTMENT STORES.              00060000
000700 DATE-WRITTEN.              3/29/2006.                            00070001
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*  CICS PROGRAM - SUKCS546 - TRANID = S546                       *00100001
001200*                                                                *00120000
001200*  CHANGES:                                                      *00121025
001200*  03/2021  JEAN KURK  REMOVE SUT_PGM_MDSE_SUM & XLT_MDSE_PGM    *00122025
001200*                                                                *00123025
001300******************************************************************00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500******************************************************************00150000
001600 DATA DIVISION.                                                   00160000
001700******************************************************************00170000
001800     EJECT                                                        00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000 01  FILLER                          PIC X(27) VALUE              00200000
002100     'WORKING STORAGE STARTS HERE'.                               00210000
002200                                                                  00220000
002300*                                                                 00230000
002400*  STANDARD ATTENTION IDENTIFIER LIST                             00240000
002500*                                                                 00250000
002600     COPY DFHAID.                                                 00260000
002700     EJECT                                                        00270000
002800                                                                  00280000
002900* COPIES FOR THE PROGRAM DRS1INTC WORK FIELDS.                    00290000
003000     COPY DRRD001O.                                               00300000
003100     COPY DRRD002O.                                               00310000
003200                                                                  00320000
003300                                                                  00330000
003400*  COPY BOOK CONTAINING THE WORKING STORAGE VALUES REQUIRED FOR   00340000
003500*  CALLING THE PRINTER VALIDATION ROUTINE DPKCS060                00350000
003600*                                                                 00360000
003700     COPY DPWS072.                                                00370000
003800                                                                  00380000
003900*  COPY BOOK CONTAINING COMMON PRINTER LINE COMMANDS              00390000
004000*                                                                 00400000
004100     COPY DSWS004.                                                00410000
004200                                                                  00420000
004700*  RECORD LAYOUT FOR THE REPORT                                   00470012
004800*                                                                 00480000
004900     COPY DPWS132.                                                00490012
005000                                                                  00500000
005010***************************************************************** 00501012
005020*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 00502011
005030***************************************************************** 00503012
005050     COPY SUWS083.                                                00505012
005060                                                                  00506011
005061***************************************************************** 00506112
005070/                                                                 00507011
005100 01  DK-DB2-KEYS.                                                 00510000
005110     05  DK-TRIP-OCRNC-ID             PIC S9(9) COMP VALUE ZERO.  00511009
005130     05  DK-BUS-AREA-ID               PIC S9(2)V COMP-3.          00513018
006900                                                                  00690000
007000 01  IE-DRS-ERROR-MSG.                                            00700000
007100     05  FILLER                       PIC X(41)  VALUE            00710000
007200     'A DRS ERROR HAS OCCURRED  - CONTACT DP - '.                 00720000
007300     05  FILLER                       PIC X(44)  VALUE            00730000
007400     'PROGRAM SUKCS546'.                                          00740001
007500     05  FILLER                       PIC X(11)  VALUE            00750000
007600     'FUNCTION = '.                                               00760000
007700     05  IE-DRS-FUNC                  PIC X(4)   VALUE SPACE.     00770000
007800     05  FILLER                       PIC X(14)  VALUE            00780000
007900     'RETURN CODE = '.                                            00790000
008000     05  IE-DRS-RC                    PIC X(4)   VALUE SPACES.    00800000
008100                                                                  00810000
008200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00820000
008300*                                                                 00830000
008310     05  PV-DRS-ABEND-DISPLAY-LINE1.                              00831014
008320         10  FILLER                      PIC  X(14)  VALUE        00832014
008330             'DRRB ID = DRRB'.                                    00833014
008340         10  FILLER                      PIC  X(02)  VALUE SPACE. 00834014
008350         10  FILLER                      PIC  X(12)  VALUE        00835014
008360             'DRRB FUNC = '.                                      00836014
008370         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 00837014
008380         10  FILLER                      PIC  X(02)  VALUE SPACE. 00838014
008390         10  FILLER                      PIC  X(11)  VALUE        00839014
008391             'DRRB RID = '.                                       00839114
008392         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 00839214
008393         10  FILLER                      PIC  X(02)  VALUE SPACE. 00839314
008394         10  FILLER                      PIC  X(15)  VALUE        00839414
008395             'DRRB OPTIONS = '.                                   00839514
008396         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 00839614
008397     05  PV-DRS-ABEND-DISPLAY-LINE2.                              00839714
008398         10  FILLER                      PIC  X(10)  VALUE        00839814
008399             'DRRB RC = '.                                        00839914
008400         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 00840014
008401         10  FILLER                      PIC  X(02)  VALUE SPACE. 00840114
008402         10  FILLER                      PIC  X(18)  VALUE        00840214
008403             'DRRB ATTR-ERROR = '.                                00840314
008404         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 00840414
008405         10  FILLER                      PIC  X(02)  VALUE SPACE. 00840514
008406         10  FILLER                      PIC  X(12)  VALUE        00840614
008407             'DRRB DRDC = '.                                      00840714
008408         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 00840814
008409         10  FILLER                      PIC  X(02)  VALUE SPACE. 00840914
008410         10  FILLER                      PIC  X(13)  VALUE        00841014
008411             'DRRB LINES = '.                                     00841114
008412         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 00841214
008413 01  PV-CICS-MSG-AREA.                                            00841314
008414     05  FILLER                          PIC X(20) VALUE          00841414
008415                 '** SUKCS546 ** TASK='.                          00841514
008416     05  PV-TASK-NUMBER                  PIC Z(08).               00841614
008417     05  FILLER                          PIC X(07) VALUE          00841714
008418                 ' TIME= '.                                       00841814
008419     05  PV-TIME                         PIC X(08).               00841914
008420     05  FILLER                          PIC X(09) VALUE          00842014
008421         ' QUEUE = '.                                             00842114
008422     05  PV-QUEUE-NAME.                                           00842214
008423         10  PV-ADDRESS                  PIC X(4)  VALUE SPACES.  00842314
008424         10  PV-TASK                     PIC 9(5)  VALUE ZERO.    00842414
008425         10  PV-LAST-NUMBER              PIC X(1)  VALUE SPACES.  00842514
008426     05  FILLER                          PIC X(1)  VALUE SPACES.  00842614
008427     05  PV-CICS-MESSAGE                 PIC X(55) VALUE SPACES.  00842714
008428                                                                  00842814
008429     COPY DFHAID.                                                 00842914
008430     COPY DPWS013.                                                00843000
008500     COPY DPWS020.                                                00850000
008600                                                                  00860000
008700 01  HL1-HEADING-LINE.                                            00870013
008800     05  FILLER                      PIC X(26)  VALUE SPACES.     00880016
008900     05  FILLER                      PIC X(30)  VALUE             00890016
009000     'TRAILER BUSINESS AREA SUMMARY '.                            00900016
009300     05  FILLER                      PIC X(24)  VALUE SPACES.     00930016
009400                                                                  00940000
009500 01  HL2-HEADING-LINE.                                            00950013
009600     05  FILLER                      PIC X(01)  VALUE SPACES.     00960000
009700     05  FILLER                      PIC X(17)                    00970001
009710                                       VALUE 'STORE NUMBER....:'. 00971001
009720     05  FILLER                      PIC X(01)  VALUE SPACES.     00972001
009800     05  HL2-STORE-NBR               PIC ZZZZ.                    00980020
009900     05  FILLER                      PIC X(01)  VALUE SPACES.     00990001
010000     05  HL2-STORE-NAME              PIC X(25)  VALUE SPACES.     01000013
011100                                                                  01110000
011200 01  HL3-HEADING-LINE.                                            01120013
011210     05  FILLER                      PIC X(01)  VALUE SPACES.     01121001
011220     05  FILLER                      PIC X(17)                    01122001
011230                                       VALUE 'TRAILER SERIAL #:'. 01123001
011240     05  FILLER                      PIC X(01)  VALUE SPACES.     01124001
011250     05  HL3-TRAILER-SERIAL          PIC X(09)  VALUE SPACES.     01125013
011260     05  FILLER                      PIC X(13)  VALUE SPACES.     01126001
011261     05  FILLER                      PIC X(15)                    01126101
011262                                       VALUE 'CURRENT STATUS:'.   01126201
011263     05  FILLER                      PIC X(01)  VALUE SPACES.     01126301
011270     05  HL3-CURRENT-STATUS          PIC X(20)  VALUE SPACES.     01127013
011280                                                                  01128001
011290 01  HL4-HEADING-LINE.                                            01129013
011300     05  FILLER                      PIC X(01)  VALUE SPACES.     01130001
011400     05  FILLER                      PIC X(17)                    01140001
011500                                       VALUE 'SCAC/TRAILER ID.:'. 01150001
011600     05  FILLER                      PIC X(01)  VALUE SPACES.     01160001
011700     05  HL4-SCAC                    PIC X(04)  VALUE SPACES.     01170013
011800     05  FILLER                      PIC X(03)  VALUE ' - '.      01180001
011810     05  HL4-TRAILER-ID              PIC X(12)  VALUE SPACES.     01181013
011820     05  FILLER                      PIC X(03)  VALUE SPACES.     01182001
011900     05  FILLER                      PIC X(15)                    01190001
012000                                       VALUE 'SERVICING DC..:'.   01200001
012100     05  FILLER                      PIC X(01)  VALUE SPACES.     01210001
012200     05  HL4-SERVICING-DC            PIC X(20)  VALUE SPACES.     01220014
012210     05  FILLER                      PIC X(01)  VALUE SPACES.     01221001
012300                                                                  01230001
012400 01  HL5-HEADING-LINE.                                            01240013
012500     05  FILLER                      PIC X(01)  VALUE SPACES.     01250001
012600     05  FILLER                      PIC X(17)                    01260001
012700                                       VALUE 'TOTAL CARTONS...:'. 01270001
012800     05  FILLER                      PIC X(01)  VALUE SPACES.     01280001
012900     05  HL5-TOTAL-CARTONS           PIC Z,ZZZ,ZZZ.               01290020
013000     05  FILLER                      PIC X(13)  VALUE SPACES.     01300020
013100     05  FILLER                      PIC X(15)                    01310001
013200                                       VALUE 'SUMMARY AS OF.:'.   01320001
013210     05  FILLER                      PIC X(01)  VALUE SPACES.     01321001
013220     05  HL5-SUMMARY-DATE            PIC X(10)  VALUE SPACES.     01322013
013221     05  FILLER                      PIC X(01)  VALUE SPACES.     01322120
013222     05  HL5-SUMMARY-TIME            PIC X(10)  VALUE SPACES.     01322213
013230                                                                  01323001
013240 01  HL6-HEADING-LINE.                                            01324013
013250     05  FILLER                      PIC X(01)  VALUE SPACES.     01325001
013260     05  FILLER                      PIC X(17)                    01326001
013270                                       VALUE 'TOTAL UNITS.....:'. 01327001
013280     05  FILLER                      PIC X(01)  VALUE SPACES.     01328001
013290     05  HL6-TOTAL-UNITS             PIC  Z,ZZZ,ZZZ.              01329020
013291     05  FILLER                      PIC X(15)  VALUE SPACES.     01329101
013300                                                                  01330000
013310 01  HL7-HEADING-LINE.                                            01331013
013320     05  FILLER                      PIC X(01)  VALUE SPACES.     01332001
013360     05  HL7-SEQUENCE-DESC           PIC X(20)  VALUE SPACES.     01336014
013370     05  FILLER                      PIC X(01)  VALUE SPACES.     01337001
013380                                                                  01338001
015400                                                                  01540000
015500 01  HL8-HEADING-LINE.                                            01550013
015600     05  FILLER                       PIC X(09)  VALUE SPACES.    01560001
015700     05  FILLER                       PIC X(04)  VALUE 'AREA'.    01570001
015800     05  FILLER                       PIC X(03)  VALUE SPACES.    01580001
015900     05  FILLER                       PIC X(16)                   01590010
015910                                        VALUE 'AREA DESCRIPTION'. 01591001
016000     05  FILLER                       PIC X(12)  VALUE SPACES.    01600020
016100     05  FILLER                       PIC X(07)  VALUE 'CARTONS'. 01610001
016200     05  FILLER                       PIC X(05)  VALUE SPACES.    01620020
016300     05  FILLER                       PIC X(05)  VALUE 'UNITS'.   01630001
016400     05  FILLER                       PIC X(04)  VALUE SPACES.    01640021
016500     05  FILLER                       PIC X(07)  VALUE 'SKU CNT'. 01650001
016600     05  FILLER                       PIC X(02)  VALUE SPACES.    01660001
016610     05  FILLER                       PIC X(02)  VALUE 'AD'.      01661001
016620                                                                  01662003
024600 01  DL1-DETAIL-LINE.                                             02460013
024700     05  FILLER                       PIC X(10)  VALUE SPACES.    02470020
024800     05  DL1-AREA-NBR                 PIC X(04)  VALUE SPACES.    02480013
025100     05  FILLER                       PIC X(02)  VALUE SPACE.     02510001
025110     05  DL1-AREA-DESC                PIC X(23)  VALUE SPACES.    02511013
025120     05  FILLER                       PIC X(02)  VALUE SPACE.     02512001
025200     05  DL1-CARTONS                  PIC Z,ZZZ,ZZZ.              02520020
025300     05  FILLER                       PIC X(02)  VALUE SPACES.    02530000
025310     05  DL1-UNITS                    PIC Z,ZZZ,ZZZ.              02531020
025320     05  FILLER                       PIC X(02)  VALUE SPACES.    02532001
025330     05  DL1-SKU-CNT                  PIC Z,ZZZ,ZZZ.              02533020
025340     05  FILLER                       PIC X(02)  VALUE SPACES.    02534001
025400     05  DL1-AD                       PIC X(01)  VALUE SPACES.    02540013
026800                                                                  02680000
033600 01  DL-DASH-LINE                     PIC X(108) VALUE ALL '_'.   03360000
033700                                                                  03370000
033800 01  PC-CARRIAGE-CONTROL.                                         03380011
033900     05  PC-TOP-OF-PAGE               PIC  X(01) VALUE '1'.       03390011
034000     05  PC-SINGLE-SPACE              PIC  X(01) VALUE SPACE.     03400011
034100     05  PC-DOUBLE-SPACE              PIC  X(01) VALUE ZERO.      03410011
034200     05  PC-TRIPLE-SPACE              PIC  X(01) VALUE '-'.       03420011
034300     05  PC-PUT                       PIC  X(03) VALUE 'PUT'.     03430011
034400     05  PC-INIT                      PIC  X(04) VALUE 'INIT'.    03440011
034500     05  PC-TERM                     PIC  X(04)  VALUE 'TERM'.    03450011
034600*                                                                 03460011
044600 01  PS-PROGRAM-SWITCHES.                                         04460000
044900     05  PS-END-OF-CSR-SW             PIC X(1)   VALUE 'N'.       04490014
045000         88  PS-END-OF-CSR-NO                    VALUE 'N'.       04500014
045100         88  PS-END-OF-CSR                       VALUE 'Y'.       04510014
046300     05  PS-TOP-OF-PAGE-SET-SW        PIC X(01)  VALUE 'N'.       04630000
046400         88  PS-TOP-OF-PAGE-SET                  VALUE 'Y'.       04640000
046500         88  PS-TOP-OF-PAGE-NOT-SET              VALUE 'N'.       04650000
046600     05  PRINT-DETAIL-CHECK-SW        PIC X(01)  VALUE 'N'.       04660000
046700         88  PRINT-DETAIL-CHECK                  VALUE 'Y'.       04670000
046800         88  NO-PRINT-DETAIL-CHECK               VALUE 'N'.       04680000
046900     05  PRINT-DOUBLE-HEADING-SW      PIC X(01)  VALUE 'N'.       04690000
047000         88  PRINT-DOUBLE-HEADING                VALUE 'Y'.       04700000
047100         88  PRINT-SINGLE-HEADING                VALUE 'N'.       04710000
047200                                                                  04720000
047300 01  PS-PROGRAM-SUBSCRIPTS.                                       04730000
047400     05  PS-DIST-SUB                     PIC S9(04)  VALUE +0     04740000
047500                                                     COMP SYNC.   04750000
047600     05  INST-SUB                        PIC S9(04)  VALUE +0     04760000
047700                                                     COMP SYNC.   04770000
047800     05  STR-SUB                         PIC S9(04)  VALUE +0     04780000
047900                                                     COMP SYNC.   04790014
053300                                                                  05330000
053400 01  PA-PROGRAM-ACCUMS.                                           05340000
053500     05  PA-RPT1-PAGE-NO              PIC S9(5)      VALUE ZERO.  05350000
053600     05  PA-RPT2-PAGE-NO              PIC S9(5)      VALUE ZERO.  05360000
053700     05  PA-AMOUNT-RECEIVED           PIC S9(7)      COMP-3       05370000
053800                                                     VALUE ZERO.  05380000
053900     05  PA-LINE-COUNT                PIC S9(2)      VALUE ZERO.  05390000
054000     05  PA-SELECT-COUNTER            PIC S9(08)     VALUE +0     05400000
054100                                                     COMP SYNC.   05410000
054200     05  PA-VENDOR-REQ-CERT           PIC S9(08)     VALUE +0     05420000
054300                                                     COMP SYNC.   05430000
054400     05  PA-VENDOR-UPC                PIC S9(08)     VALUE +0     05440000
054500                                                     COMP SYNC.   05450000
054600                                                                  05460000
054700 01  SA-SAVE-AREAS.                                               05470000
054800     05  SA-REPORT-ID                 PIC X(8).                   05480000
054900     05  SA-PO-NBR                    PIC X(8).                   05490000
055000     05  SA-KEY-REC-NUM               PIC 9(8)       VALUE ZEROS. 05500000
055100     05  SA-KEY-REC  REDEFINES  SA-KEY-REC-NUM.                   05510000
055200         10  SA-KEY1                  PIC X(7).                   05520000
055300         10  SA-KEY-SUB REDEFINES SA-KEY1.                        05530000
055400             15  FILLER               PIC X(3).                   05540000
055500             15  SA-KEY-LAST4         PIC X(4).                   05550000
055600         10  SA-KEY2                  PIC X.                      05560000
055700     05  SA-TOTAL-QUANTITY            PIC S9(9)  VALUE ZERO.      05570000
055800     05  SA-KEY-FEED-BACK             PIC X(10)  VALUE SPACES.    05580000
055900     05  SA-RQTY                      PIC S9(6)  VALUE ZERO.      05590000
056000*    05  SA-LINE                      PIC X(03)  VALUE SPACES.    05600000
056100*    05  SA-STORE-NUM                 PIC X(03)  VALUE SPACES.    05610000
056200     05  SA-INSTRUCTIONS OCCURS 9 TIMES                           05620000
056300                                      PIC X(25)  VALUE SPACES.    05630000
056400     05  SA-FREIGHT-INSTR             PIC X(25)  VALUE SPACES.    05640000
056500     05  SA-DATE-RECEIVED             PIC X(08)  VALUE SPACES.    05650000
056600     05  SA-STYLE.                                                05660000
056700         10  SA-VENDOR-STYLE          PIC X(15).                  05670000
056800         10  FILLER                   PIC X(10).                  05680000
056900     05  SA-CLASS.                                                05690000
057000         10  SA-CLASS2                PIC X(2).                   05700000
057100         10  FILLER                   PIC X.                      05710000
057200     05  SA-DATE-N                    PIC 9(6).                   05720000
057300     05  SA-DATE REDEFINES SA-DATE-N.                             05730000
057400         10  SA-MONTH                 PIC X(2).                   05740000
057500         10  SA-DAY                   PIC X(2).                   05750000
057600         10  SA-YEAR.                                             05760000
057700             15  SA-FIRST-DIGIT-OF-YEAR                           05770000
057800                                      PIC X.                      05780000
057900             15  SA-SECOND-DIGIT-OF-YEAR                          05790000
058000                                      PIC X.                      05800000
058100     05  SA-SEASON.                                               05810000
058200         10  SA-SEASON-CODE           PIC X.                      05820000
058300         10  SA-SEASON-YR.                                        05830000
058400             15  SA-SEASON-SECOND-DIGIT-OF-YEAR                   05840000
058500                                      PIC X.                      05850000
058600         10  SA-SEASON-MONTH.                                     05860000
058700             15  SA-SEASON-SECOND-DIGIT-OF-MNTH                   05870000
058800                                      PIC X.                      05880000
058900                                                                  05890000
061300 01  PC-PROGRAM-CONSTANTS.                                        06130000
061400     05  PC-M                         PIC X(01) VALUE 'M'.        06140000
061500     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'SUKCS546'. 06150003
061600     05  PC-DPKCS060                  PIC X(8)  VALUE 'DPKCS060'. 06160000
063600     05  PC-LINE-MAX                  PIC S9(2)  VALUE +22.       06360000
063700     05  PC-PAGE                      PIC X      VALUE '1'.       06370000
063800     05  PC-SPACE1                    PIC X      VALUE ' '.       06380000
063900     05  PC-SPACE2                    PIC X      VALUE '0'.       06390000
064000     05  PC-SPACE3                    PIC X      VALUE '-'.       06400000
064100     05  PC-SIX                       PIC 9      VALUE 6.         06410000
064200     05  PC-SEVEN                     PIC 9      VALUE 7.         06420000
064300     05  PC-ONE                       PIC 9      VALUE 1.         06430000
064400     05  PC-01                        PIC XX     VALUE '01'.      06440000
065700     05  PC-MAX-RETRIES               PIC S9(04) VALUE +2         06570000
065800                                      COMP SYNC.                  06580000
065900     05  PC-DEFAULT-DATE              PIC X(26) VALUE             06590000
066000         '9999-09-09-09.09.09.999999'.                            06600000
066400                                                                  06640000
066500 01  PV-PROGRAM-VARIABLES.                                        06650000
066600     05  PV-CICS-MSG-AREA             PIC  X(80)  VALUE SPACE.    06660000
066700     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    06670000
066800     05  PV-CICS-MSG-HOLD.                                        06680000
066900         10  FILLER                   PIC  X(01)  VALUE SPACE.    06690000
067000         10  PV-CICS-MSG-DATA         PIC  X(79)  VALUE SPACE.    06700000
067100     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        06710000
067200                                                  COMP SYNC.      06720000
067300     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     06730011
067400     05  PV-RUN-TIME                  PIC X(08) VALUE SPACES.     06740011
067500     05  PV-CREATE-DATE               PIC X(10) VALUE SPACES.     06750011
067600     05  PV-CREATE-TIME               PIC X(08) VALUE SPACES.     06760011
067700     05  PV-PAGE-COUNT                PIC 9(05) VALUE ZERO.       06770013
067800     05  PV-LINE-COUNT                PIC 9(05) VALUE ZERO.       06780014
068000     05  PV-DB2-COUNT                 PIC S9(9) VALUE +0          06800000
068100                                                COMP-3.           06810000
068800     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        06880000
068900                                                COMP SYNC.        06890000
069200     05  PV-COMMON-LENGTH             PIC S9(04) VALUE +0         06920000
069300                                                 COMP.            06930000
070900     05  PV-AD-EVNT-DTE               PIC S9(4) VALUE ZERO        07090000
071000                                                 COMP.            07100014
071100     05  PV-SEQ-DESC                  PIC X(20) VALUE SPACES.     07110014
071200                                                                  07120014
074400 01  CA-COMMON-AREA.                                              07440000
074500         10  CA-TRIP-OCRNC-ID         PIC 9(09).                  07450005
074600         10  CA-STORE-NBR             PIC 9(04).                  07460005
074700         10  CA-STORE-NAME            PIC X(25).                  07470005
074800         10  CA-TRAILER-SERIAL-NBR    PIC 9(09).                  07480005
074900         10  CA-CURRENT-STATUS        PIC X(20).                  07490005
075100         10  CA-SCAC                  PIC X(4).                   07510005
075200         10  CA-TRAILER-ID            PIC X(1).                   07520005
075300         10  CA-SERVICING-DC          PIC X(20).                  07530005
075310         10  CA-TOTAL-CARTONS         PIC 9(06).                  07531005
075311         10  CA-SUMMARY-AS-OF-DATE    PIC X(10).                  07531105
075312         10  CA-SUMMARY-AS-OF-TIME    PIC X(08).                  07531205
075320         10  CA-TOTAL-UNITS           PIC 9(06).                  07532005
075330         10  CA-DISPLAY-SEQUENCE      PIC X(20).                  07533005
075400         10  CA-PRINTER               PIC X(8).                   07540005
076200*                                                                 07620000
076300         10  CA-DRIB-AREA             PIC X(264).                 07630000
076500                                                                  07650000
077100*    DOMAIN BUSINESS AREA                                         07710004
077200     EXEC SQL                                                     07720004
077300          INCLUDE XLT00000                                        07730004
077400     END-EXEC.                                                    07740004
077500                                                                  07750004
077600*    DOMAIN BUSINESS GROUP                                        07760004
077700     EXEC SQL                                                     07770004
077800          INCLUDE XLT00001                                        07780004
077900     END-EXEC.                                                    07790004
077901                                                                  07790109
077902*    DOMAIN DEPARTMENT                                            07790209
077903     EXEC SQL                                                     07790309
077904          INCLUDE XLT00002                                        07790409
077905     END-EXEC.                                                    07790509
077906                                                                  07790609
084200*    DOMAIN LOCATION TABLE                                        08420004
084900     EXEC SQL                                                     08490000
085000         INCLUDE XLT00010                                         08500000
085100     END-EXEC.                                                    08510000
085200                                                                  08520009
085210*    XLT MDSE PGM                                                 08521009
085220*    EXEC SQL                                                     08522025
085230*         INCLUDE XLT00040                                        08523025
085240*    END-EXEC.                                                    08524025
085250                                                                  08525009
085300*    BUSINESS GROUP SUMMARY                                       08530009
085400     EXEC SQL                                                     08540009
085500          INCLUDE SUT00008                                        08550009
085600     END-EXEC.                                                    08560009
085610                                                                  08561009
085700*    DEPT SUMMARY                                                 08570009
085800     EXEC SQL                                                     08580009
085900          INCLUDE SUT00009                                        08590009
086000     END-EXEC.                                                    08600009
086001                                                                  08600109
086010*    MAJOR CLASS AD DATE                                          08601009
086020     EXEC SQL                                                     08602009
086030          INCLUDE SUT00011                                        08603009
086040     END-EXEC.                                                    08604009
086050/                                                                 08605009
086100                                                                  08610009
086200*    SUT PGM MDSE SUM                                             08620009
086300*    EXEC SQL                                                     08630025
086400*         INCLUDE SUT00096                                        08640025
086500*    END-EXEC.                                                    08650025
086600                                                                  08660009
087020     EXEC SQL                                                     08702009
087030          INCLUDE TSUOBTR                                         08703009
087040     END-EXEC.                                                    08704009
087050                                                                  08705009
087100                                                                  08710009
088400*                                                                 08840000
088500*  COMMUNICATION AREAS FOR DB2                                    08850000
088600*                                                                 08860000
088700     EXEC SQL                                                     08870000
088800         INCLUDE SQLCA                                            08880000
088900     END-EXEC.                                                    08890000
089000                                                                  08900000
089578******************************************************************08957807
089579* BUSAREA AREA CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08957907
089580* SELECTED ON BUSAREA SCREEN IN AREA SEQUENCE                     08958007
089581******************************************************************08958107
089582     EXEC SQL                                                     08958219
089583         DECLARE AREA-CSR CURSOR FOR                              08958319
089584            SELECT                                                08958419
089585                 GSUM.BUS_AREA_ID                                 08958519
089586               , GSUM.UNT_QTY                                     08958619
089587               , GSUM.SKU_QTY                                     08958719
089588               , GSUM.CART_QTY                                    08958819
089589               , AREA.BUS_AREA_DESC                               08958919
089590         FROM SUT_BUS_AREA_SUM GSUM                               08959019
089591               , XLT_BUS_AREA AREA                                08959119
089592         WHERE                                                    08959219
089593              GSUM.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID              08959319
089594          AND GSUM.BUS_AREA_ID   = AREA.BUS_AREA_ID               08959419
089595         ORDER BY                                                 08959519
089596              AREA.BUS_AREA_DESC                                  08959619
089597            , GSUM.BUS_AREA_ID                                    08959719
089598     END-EXEC.                                                    08959819
089599                                                                  08959919
089600******************************************************************08960020
089601* BUSAREA UNIT CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA08960120
089602* SELECTED ON BUSAREA SCREEN IN UNIT SEQUENCE                     08960220
089603******************************************************************08960320
089604     EXEC SQL                                                     08960419
089605         DECLARE UNIT-CSR CURSOR FOR                              08960519
089606            SELECT                                                08960619
089607                 GSUM.BUS_AREA_ID                                 08960719
089608               , GSUM.UNT_QTY                                     08960819
089609               , GSUM.SKU_QTY                                     08960919
089610               , GSUM.CART_QTY                                    08961019
089611               , AREA.BUS_AREA_DESC                               08961119
089612         FROM SUT_BUS_AREA_SUM GSUM                               08961219
089613               , XLT_BUS_AREA AREA                                08961319
089614         WHERE                                                    08961419
089615              GSUM.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID              08961519
089616          AND GSUM.BUS_AREA_ID   = AREA.BUS_AREA_ID               08961619
089617         ORDER BY                                                 08961719
089618              GSUM.UNT_QTY DESC                                   08961819
089619            , AREA.BUS_AREA_DESC                                  08961919
089620     END-EXEC.                                                    08962019
089621                                                                  08962119
089622******************************************************************08962219
089800******************************************************************08980007
105300     COPY DPWS276.                                                10530000
105400                                                                  10540004
105600   EJECT                                                          10560000
105700******************************************************************10570000
105800 LINKAGE SECTION.                                                 10580000
105900******************************************************************10590000
106000                                                                  10600000
106100 01  DFHCOMMAREA                      PIC X(400).                 10610000
106200     EJECT                                                        10620000
106210                                                                  10621006
106300******************************************************************10630000
106400 PROCEDURE DIVISION.                                              10640000
106500******************************************************************10650000
106510                                                                  10651011
106600     PERFORM 1000-INITIALIZE.                                     10660011
106610                                                                  10661011
106611     PERFORM 2000-PROCESS                                         10661111
106612             UNTIL PS-END-OF-CSR.                                 10661214
106641                                                                  10664111
106645     PERFORM 4020-CLOSE-CURSOR.                                   10664514
106647                                                                  10664714
106648*    CLOSE PRINTER                                                10664811
106649     MOVE PC-TERM                     TO DRS01-DRRB-FUNC          10664911
106650     PERFORM 8000-LINK-TO-DRS.                                    10665011
106651                                                                  10665111
106652 0000-GOBACK.                                                     10665214
106653                                                                  10665314
106656     GOBACK.                                                      10665614
106657/                                                                 10665714
106658******************************************************************10665811
106700 1000-INITIALIZE.                                                 10670011
106800     MOVE LENGTH OF SU083-COMM-AREA                               10680014
106810                                         TO PV-COMMAREA-LENGTH    10681011
107100                                                                  10710011
107200     EXEC CICS                                                    10720011
107300         RETRIEVE                                                 10730011
107400             INTO (SU083-COMM-AREA)                               10740014
107500             LENGTH (PV-COMMAREA-LENGTH)                          10750011
107600     END-EXEC                                                     10760011
107700                                                                  10770011
107800     EVALUATE TRUE                                                10780011
107900         WHEN PV-CICS-RESP     = DFHRESP (NORMAL)                 10790013
108000             CONTINUE                                             10800011
108100         WHEN OTHER                                               10810011
108200             MOVE '1000-INITIALIZE' TO DP013-PARAGRAPH            10820013
108300             MOVE 'UNABLE TO RETRIEVE DATA'                       10830011
108400                                      TO DP013-MESSAGE-TEXT (1)   10840011
108500             SET DP013-CICS-ABEND                                 10850011
108600                 DP013-NO-ROLLBACK    TO TRUE                     10860011
108800     END-EVALUATE.                                                10880011
108900                                                                  10890011
108910     EXEC SQL                                                     10891011
108920         SELECT                                                   10892011
108930         CHAR ( DATE (CURRENT TIMESTAMP),USA)                     10893011
108940     ,   CHAR ( TIME (CURRENT TIMESTAMP),JIS)                     10894011
108950     INTO                                                         10895011
108960         :PV-RUN-DATE                                             10896011
108970     ,   :PV-RUN-TIME                                             10897011
108980         FROM SYSIBM.SYSDUMMY1                                    10898011
108990     END-EXEC                                                     10899011
108991                                                                  10899111
108992     MOVE PV-RUN-DATE                 TO DP132-RUN-DATE           10899211
108993     MOVE PV-RUN-TIME                 TO DP132-RUN-TIME           10899311
108994                                                                  10899411
108995     MOVE 'SUKCS546'                  TO DP132-PROGRAM-NAME.      10899512
108996     MOVE 1                           TO DP132-REPORT-NUMBER.     10899611
108997                                                                  10899711
108998*    OPEN PRINTER                                                 10899811
108999     MOVE 'A'                         TO DRS02-DRIB-CLASS         10899911
109000     MOVE 'N'                         TO DRS02-DRIB-HOLD          10900011
109010     MOVE SU083-PRINTER-ID            TO DRS02-DRIB-DEST          10901013
109020     MOVE PC-INIT                     TO DRS01-DRRB-FUNC.         10902011
109030     MOVE DRS02-DRIB-HEADER           TO DRS01-COMM-DRIB-HDR.     10903011
109040     MOVE DRS02-DRIB-ATTRIB           TO DRS01-COMM-DRIB-AT1.     10904011
109050     PERFORM 8000-LINK-TO-DRS.                                    10905011
109060                                                                  10906011
109070     MOVE 1                           TO PV-PAGE-COUNT            10907011
109071     PERFORM 1101-SCREEN-SEQUENCE.                                10907114
109080     PERFORM 2200-BUILD-HEADINGS.                                 10908013
109090                                                                  10909011
109091     PERFORM 8100-PRINT-HEADINGS.                                 10909111
109092                                                                  10909211
109093*    OPEN  CURSOR                                                 10909311
109094                                                                  10909411
109095     MOVE SU083-TRIP-OCRNC-ID      TO DK-TRIP-OCRNC-ID            10909514
109097     PERFORM 4010-OPEN-CURSOR.                                    10909711
112800                                                                  11280011
117630*    PERFORM 2000-PROCESS.                                        11763020
117640                                                                  11764006
117641     IF PS-END-OF-CSR                                             11764111
117650        PERFORM 4020-CLOSE-CURSOR                                 11765011
117651     END-IF.                                                      11765111
117658/                                                                 11765811
117659******************************************************************11765914
117660 1101-SCREEN-SEQUENCE.                                            11766014
117661     EVALUATE TRUE                                                11766114
117670         WHEN SU083-AREA-SEQ                                      11767014
117680             MOVE 'AREA SEQUENCE'       TO PV-SEQ-DESC            11768014
117690                                                                  11769014
117700         WHEN SU083-UNIT-SEQ                                      11770014
117800             MOVE 'UNIT SEQUENCE'       TO PV-SEQ-DESC            11780014
117900     END-EVALUATE.                                                11790014
118000                                                                  11800014
140500******************************************************************14050000
140600*  2000-PROCESS - THIS IS THE MAIN PARAGRAPH FOR PRINTING         14060006
140800******************************************************************14080000
140900 2000-PROCESS.                                                    14090006
145600*                                                                 14560000
145700     IF PV-LINE-COUNT > 60                                        14570011
145800         ADD 1                        TO PV-PAGE-COUNT            14580011
145801         PERFORM 8100-PRINT-HEADINGS                              14580111
145802     END-IF.                                                      14580214
145803                                                                  14580311
145804     PERFORM 4310-FETCH.                                          14580420
145805                                                                  14580524
145806     IF PS-END-OF-CSR-NO                                          14580624
145807        PERFORM 2100-BUILD-DETAIL                                 14580724
145808        PERFORM 4000-PRINT-DETAIL-LINE                            14580824
145809     END-IF.                                                      14580924
145814                                                                  14581411
160801******************************************************************16080111
160802 2100-BUILD-DETAIL.                                               16080211
160803                                                                  16080311
160810     MOVE SUT00008-BUS-AREA-ID     TO DL1-AREA-NBR.               16081020
160840     MOVE SUT00008-CART-QTY        TO DL1-CARTONS.                16084020
160841     MOVE SUT00008-SKU-QTY         TO DL1-SKU-CNT.                16084120
160850     MOVE SUT00008-UNT-QTY         TO DL1-UNITS.                  16085020
160880     MOVE XLT00000-BUS-AREA-DESC   TO DL1-AREA-DESC.              16088020
160900                                                                  16090004
161000*    PERFORM 4300C-AD-DATES.                                      16100020
161100     IF PV-DB2-COUNT > ZERO                                       16110019
161200           MOVE 'Y'                TO DL1-AD                      16120019
161300     END-IF.                                                      16130019
161420/                                                                 16142004
161421******************************************************************16142113
161422 2200-BUILD-HEADINGS.                                             16142213
161427                                                                  16142713
161428     MOVE SU083-STR-NBR            TO HL2-STORE-NBR.              16142814
161429     MOVE SU083-STR-NAME           TO HL2-STORE-NAME.             16142914
161430     MOVE SU083-TRLR-SRL-NBR       TO HL3-TRAILER-SERIAL.         16143014
161431     MOVE SU083-TRLR-STATUS        TO HL3-CURRENT-STATUS.         16143114
161432     MOVE SU083-SCAC               TO HL4-SCAC.                   16143214
161434     MOVE SU083-TRLR-ID            TO HL4-TRAILER-ID.             16143414
161435     MOVE SU083-SERVICING-DC       TO HL4-SERVICING-DC.           16143514
161436     MOVE SU083-TOTAL-CTNS         TO HL5-TOTAL-CARTONS.          16143615
161439     MOVE SU083-SUMMARY-DATE       TO HL5-SUMMARY-DATE.           16143914
161440     MOVE SU083-SUMMARY-TIME       TO HL5-SUMMARY-TIME.           16144020
161441     MOVE SU083-TOTAL-UNITS        TO HL6-TOTAL-UNITS.            16144114
161443     MOVE PV-SEQ-DESC              TO HL7-SEQUENCE-DESC.          16144314
161444/                                                                 16144414
161452******************************************************************16145211
161453*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        16145311
161454******************************************************************16145411
161455 4000-PRINT-DETAIL-LINE.                                          16145511
161456                                                                  16145611
161457     IF PV-LINE-COUNT > 60                                        16145711
161458         ADD 1                        TO PV-PAGE-COUNT            16145811
161459         PERFORM 8100-PRINT-HEADINGS                              16145911
161460     END-IF                                                       16146011
161461                                                                  16146111
161462     MOVE PC-SINGLE-SPACE             TO  DRS01-COMM-CTL          16146220
161464     MOVE DL1-DETAIL-LINE             TO  DRS01-COMM-DATA.        16146420
161465     PERFORM 8000-LINK-TO-DRS.                                    16146520
161466     ADD 1                            TO PV-LINE-COUNT.           16146620
161467                                                                  16146720
161468******************************************************************16146820
161469 4010-OPEN-CURSOR.                                                16146920
161470                                                                  16147020
161471     EVALUATE TRUE                                                16147120
161472          WHEN SU083-AREA-SEQ                                     16147220
161473              MOVE 'CURSOR:   AREA CSR'                           16147320
161474                                   TO DP013-MESSAGE-TEXT (2)      16147420
161475              EXEC SQL                                            16147520
161476                  OPEN AREA-CSR                                   16147620
161477              END-EXEC                                            16147720
161478                                                                  16147820
161479          WHEN SU083-UNIT-SEQ                                     16147920
161480              MOVE 'CURSOR:  UNIT-CSR'                            16148020
161481                                  TO DP013-MESSAGE-TEXT (2)       16148120
161482              EXEC SQL                                            16148220
161483                  OPEN UNIT-CSR                                   16148320
161484              END-EXEC                                            16148420
161485                                                                  16148520
161490     END-EVALUATE                                                 16149008
161502                                                                  16150204
161503     EVALUATE TRUE                                                16150304
161504         WHEN SQLCODE = ZERO                                      16150404
161505             CONTINUE                                             16150504
161510         WHEN SQLWARN0 NOT = SPACES                               16151004
161511         WHEN SQLCODE < ZERO                                      16151104
161512         WHEN SQLCODE > ZERO                                      16151204
161513             MOVE '4010-OPEN-CURSOR'                              16151304
161514                                   TO DP013-PARAGRAPH             16151404
161515             MOVE 'OPEN AREA CURSOR - '                           16151519
161516                                   TO DP013-MESSAGE-TEXT (1)      16151604
161517             MOVE SQLCA        TO DP013-SQLCA                     16151704
161518             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        16151804
161519             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        16151904
161520             SET DP013-DB2-ABEND                                  16152004
161521                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16152104
161522             PERFORM DP013-0000-PROCESS-ABEND                     16152204
161523     END-EVALUATE.                                                16152304
161524/                                                                 16152404
161525 4020-CLOSE-CURSOR.                                               16152504
161526     EVALUATE TRUE                                                16152604
161527         WHEN SU083-AREA-SEQ                                      16152715
161528             EXEC SQL                                             16152804
161529                 CLOSE AREA-CSR                                   16152919
161530             END-EXEC                                             16153004
161531         WHEN SU083-UNIT-SEQ                                      16153114
161532             EXEC SQL                                             16153204
161533                 CLOSE UNIT-CSR                                   16153319
161534             END-EXEC                                             16153404
161535     END-EVALUATE.                                                16153504
161536*                                                                 16153604
161537     EVALUATE TRUE                                                16153704
161538         WHEN SQLCODE = ZERO                                      16153804
161539             CONTINUE                                             16153904
161544         WHEN SQLWARN0 NOT = SPACES                               16154404
161545         WHEN SQLCODE < ZERO                                      16154504
161546         WHEN SQLCODE > ZERO                                      16154604
161547             MOVE '4020-CLOSE-CURSOR'                             16154704
161548                               TO DP013-PARAGRAPH                 16154804
161549             MOVE 'CLOSE CURSOR '                                 16154904
161550                               TO DP013-MESSAGE-TEXT (1)          16155004
161551             MOVE SQLCA        TO DP013-SQLCA                     16155104
161552             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        16155204
161553             SET DP013-DB2-ABEND                                  16155304
161554                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16155404
161555             PERFORM DP013-0000-PROCESS-ABEND                     16155504
161556     END-EVALUATE.                                                16155604
161557                                                                  16155704
161558 EJECT                                                            16155804
161579*----------------------------------------------------------------*16157911
161580*    FETCH THE CURSOR.                                           *16158019
161581*----------------------------------------------------------------*16158111
161582 4310-FETCH.                                                      16158211
161583                                                                  16158311
161590     EVALUATE TRUE                                                16159007
161622             WHEN SU083-AREA-SEQ                                  16162214
161623                 EXEC SQL                                         16162307
161624                 FETCH AREA-CSR                                   16162419
161627                 INTO                                             16162719
161628                    :SUT00008-BUS-AREA-ID                         16162819
161629                  , :SUT00008-UNT-QTY                             16162919
161630                  , :SUT00008-SKU-QTY                             16163019
161631                  , :SUT00008-CART-QTY                            16163119
161632                  , :XLT00000-BUS-AREA-DESC                       16163219
161633                 END-EXEC                                         16163319
161639                                                                  16163907
161640             WHEN SU083-UNIT-SEQ                                  16164014
161641              EXEC SQL                                            16164107
161642                 FETCH UNIT-CSR                                   16164220
161643                   INTO                                           16164319
161645                 :SUT00008-BUS-AREA-ID                            16164519
161646               , :SUT00008-UNT-QTY                                16164619
161647               , :SUT00008-SKU-QTY                                16164719
161648               , :SUT00008-CART-QTY                               16164819
161649               , :XLT00000-BUS-AREA-DESC                          16164919
161656              END-EXEC                                            16165607
161657                                                                  16165707
161659     END-EVALUATE                                                 16165907
161660*                                                                 16166007
161661     EVALUATE TRUE                                                16166107
161662         WHEN SQLCODE = ZERO                                      16166207
161663         WHEN SQLCODE = +100                                      16166307
161664              CONTINUE                                            16166407
161669         WHEN SQLWARN0 NOT = SPACE                                16166907
161670         WHEN SQLCODE NOT = ZERO                                  16167007
161671              MOVE '4310-FETCH-CURSOR'                            16167107
161672                               TO DP013-PARAGRAPH                 16167207
161673              MOVE 'FETCH MESSAGE CURSOR'                         16167307
161674                               TO DP013-MESSAGE-TEXT (1)          16167407
161675              MOVE SQLCA       TO DP013-SQLCA                     16167507
161676              SET DP013-DB2-ABEND                                 16167607
161677                               TO TRUE                            16167707
161678              PERFORM DP013-0000-PROCESS-ABEND                    16167807
161679     END-EVALUATE.                                                16167907
161680                                                                  16168007
161681     IF  SQLCODE EQUAL +100                                       16168107
161682         SET PS-END-OF-CSR       TO TRUE                          16168214
161684     END-IF.                                                      16168407
161685                                                                  16168507
161686 EJECT                                                            16168607
161687******************************************************************16168706
161688 4300C-AD-DATES.                                                  16168804
161690                                                                  16169004
161700     MOVE SUT00008-BUS-AREA-ID        TO DK-BUS-AREA-ID.          16170019
161800                                                                  16180004
161900     EXEC SQL                                                     16190004
162000         SELECT COUNT (*)                                         16200004
162100         INTO                                                     16210004
162200           :PV-DB2-COUNT                                          16220004
162300         FROM                                                     16230004
162400           SUT_MAJ_CL_AD_DTE A                                    16240004
162500         WHERE                                                    16250004
162600           A.TRIP_OCRNC_ID       = :DK-TRIP-OCRNC-ID              16260004
162700         AND                                                      16270004
162800           A.BUS_AREA_ID         = :DK-BUS-AREA-ID                16280004
162900         AND                                                      16290004
163000           (DATE(A.AD_EVNT_DTE) >= (CURRENT DATE - 5 DAYS))       16300004
163100           AND                                                    16310004
163200           (DATE(A.AD_EVNT_DTE) <= (CURRENT DATE + 5 DAYS))       16320004
163300     END-EXEC.                                                    16330004
163400                                                                  16340004
163500     EVALUATE TRUE                                                16350004
163600         WHEN SQLCODE = ZERO                                      16360004
163700         WHEN SQLCODE = +100                                      16370004
163800              CONTINUE                                            16380004
164300         WHEN SQLWARN0 NOT = SPACE                                16430004
164400         WHEN SQLCODE NOT = ZERO                                  16440004
164500              MOVE '4300C-AD-DATES'                               16450004
164600                               TO DP013-PARAGRAPH                 16460004
164700              MOVE 'SELECT '                                      16470004
164800                               TO DP013-MESSAGE-TEXT (1)          16480004
164900              MOVE SQLCA       TO DP013-SQLCA                     16490004
165000              SET DP013-DB2-ABEND                                 16500004
165100                               TO TRUE                            16510004
165200              PERFORM DP013-0000-PROCESS-ABEND                    16520004
165300     END-EVALUATE.                                                16530004
165400                                                                  16540004
165500******************************************************************16550006
165600 8000-LINK-TO-DRS.                                                16560011
165700* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     16570011
165800                                                                  16580011
165900*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        16590011
166000*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          16600011
166100*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              16610011
166200     EXEC CICS                                                    16620011
166300         LINK                                                     16630011
166400             PROGRAM   ('DRS1INTC')                               16640011
166500             COMMAREA  (DRS01-COMMAREA)                           16650011
166600     END-EXEC.                                                    16660011
166700                                                                  16670011
166800     EVALUATE TRUE                                                16680011
166900         WHEN DRS01-DRRB-RC = ZERO                                16690011
167000             CONTINUE                                             16700011
167100         WHEN OTHER                                               16710011
167200             MOVE '8000-LINK-TO-DRS'    TO DP013-PARAGRAPH        16720011
167300             SET DP013-OTHER-ABEND      TO TRUE                   16730011
167400             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       16740011
167500             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        16750011
167600             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    16760011
167700             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         16770011
167800             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      16780011
167900             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       16790011
168000             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      16800011
168100             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      16810011
168200                 TO DP013-MESSAGE-TEXT (1)                        16820011
168300             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      16830011
168400                 TO DP013-MESSAGE-TEXT (2)                        16840011
168500             SET DP013-LINK-RETURN      TO TRUE                   16850011
168600             PERFORM DP013-0000-PROCESS-ABEND                     16860011
168700             GO TO 0000-GOBACK                                    16870011
168800     END-EVALUATE.                                                16880011
168900/                                                                 16890011
169000 8100-PRINT-HEADINGS.                                             16900011
169100     MOVE PC-PUT                      TO DRS01-DRRB-FUNC          16910011
169200     MOVE PV-PAGE-COUNT               TO DP132-PAGE-NUMBER        16920011
169300                                                                  16930011
169400     MOVE DP132-STANDRD-HEADER-132-COLS                           16940011
169500                                      TO DRS01-COMM-DATA.         16950011
169600     MOVE PC-TOP-OF-PAGE              TO DRS01-COMM-CTL.          16960011
169700     PERFORM 8000-LINK-TO-DRS.                                    16970011
169800                                                                  16980011
169900     MOVE HL1-HEADING-LINE            TO DRS01-COMM-DATA.         16990011
170000     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          17000023
170100     PERFORM 8000-LINK-TO-DRS.                                    17010011
170200                                                                  17020011
170300     MOVE HL2-HEADING-LINE            TO DRS01-COMM-DATA          17030011
170400     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          17040023
170500     PERFORM 8000-LINK-TO-DRS.                                    17050011
170600                                                                  17060011
170700     MOVE HL3-HEADING-LINE            TO DRS01-COMM-DATA          17070011
170800     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17080011
170900     PERFORM 8000-LINK-TO-DRS.                                    17090011
171000                                                                  17100011
171100     MOVE HL4-HEADING-LINE            TO DRS01-COMM-DATA          17110011
171200     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17120011
171300     PERFORM 8000-LINK-TO-DRS.                                    17130011
171400                                                                  17140011
171410     MOVE HL5-HEADING-LINE            TO DRS01-COMM-DATA          17141013
171420     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17142013
171430     PERFORM 8000-LINK-TO-DRS.                                    17143013
171440                                                                  17144013
171450     MOVE HL6-HEADING-LINE            TO DRS01-COMM-DATA          17145013
171460     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17146013
171470     PERFORM 8000-LINK-TO-DRS.                                    17147013
171480                                                                  17148013
171490     MOVE HL7-HEADING-LINE            TO DRS01-COMM-DATA          17149013
171491     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          17149113
171492     PERFORM 8000-LINK-TO-DRS.                                    17149213
171493                                                                  17149313
171494     MOVE HL8-HEADING-LINE            TO DRS01-COMM-DATA          17149413
171495     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          17149523
171496     PERFORM 8000-LINK-TO-DRS.                                    17149613
171497                                                                  17149713
171800     MOVE 10                          TO PV-LINE-COUNT.           17180023
171900/                                                                 17190011
292300******************************************************************29230006
292400 9999-ABEND.                                                      29240000
292500     MOVE 'SUKCS546'               TO DP013-PROGRAM.              29250006
292600     SET DP013-LINK-RETURN         TO TRUE.                       29260000
292700     SET DP013-NO-ROLLBACK         TO TRUE.                       29270000
292800     INITIALIZE                       DP013-SRC-TASK-NUMBER       29280000
292900                                      DP013-STACK.                29290000
293000     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             29300000
293100                                                                  29310000
293200     EXEC CICS                                                    29320000
293300         LINK                                                     29330000
293400             PROGRAM  (DP013-NAME)                                29340000
293500             COMMAREA (DP013-PARAMETERS)                          29350000
293600             LENGTH   (DP013-LENGTH)                              29360000
293700     END-EXEC.                                                    29370000
293800                                                                  29380000
293900     EXEC CICS                                                    29390000
294000          RETURN                                                  29400000
294100     END-EXEC.                                                    29410000
294200/                                                                 29420000
294300******************************************************************29430000
294400*    ABEND PROCESSING                                             29440000
294500******************************************************************29450000
294600     COPY DPPD013.                                                29460000
