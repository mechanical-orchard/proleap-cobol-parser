000100 IDENTIFICATION DIVISION.                                         00010026
000200 PROGRAM-ID.     APKUT042.                                        00020027
000300 AUTHOR.         M WILKINSON.                                     00030027
000400*DATE-WRITTEN.   NOV 15, 1996.                                    00040027
000500*DATE-COMPILED.                                                   00050027
000600******************************************************************00060029
000700*    COBOL 2                                                     *00070029
000800*                                                                *00080029
000900*    SUM COST AMOUNTS ON RECEIVING DETAIL                        *00090029
001000*                                                                *00100029
001100******************************************************************00110029
001200*                                                                *00120029
001300* INPUT                                                          *00130029
001400* 1) RECEIV-FILE                           (APRD021)             *00140029
001500*                                                                *00150029
001600* OUTPUT                                                         *00160029
001700* 1) SUMMED-BY-RCVR-SEQ         (APRD021 W/ PREFIX SEQSUM-)      *00170029
001800* 2) SUMMED-BY-PO-STORE                    (APRD020)             *00180029
001900*                                                                *00190029
002000******************************************************************00200029
002100* CHANGE LOG:                                                    *00210029
002200*                                                                *00220029
002300* 11/15/96  INITIAL VERSION.                                     *00230029
002400*                                                                *00240029
002500* 02/03/98   ROBIN BERNOSKI                WR/IR #: WR5703       *00250029
002600*            - MODIFIED THE MANNER IN WHICH THE STANDARD         *00260029
002700*              DATE ROUTINE, DPKUT500, IS TO BE CALLED           *00270029
002800*              WITHIN APROGRAM SO THAT THE CALL IS DYNAMIC.      *00280029
002900*                                                                *00290029
003000* 02/06/2003                                                     *00300029
003100*    CHANGE MADE: ARKPO PHASE3 PROJECT.                          *00310029
003200*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.          *00320029
003300*    UPDATED PGM COMMENT BLOCK WITH THE FILENAMES. RECOMPILE     *00330029
003400*    TO PICK UP MODIFIED APRD020.                                *00340029
003500* MADE BY:  MIKE BESKE                          WR#: 23500       *00350029
003600*                                                                *00360029
003610* DATE  02/16/2005                                               *00361029
003620*     CHANGE MADE: CHANGED LOGIC TO ACCUMULATE RECEIVER LEVEL    *00362029
003630*     COSTS USING A WORK FIELD WITH 3 DIGITS AFTER THE DECIMAL   *00363029
003640*     POINT INSTEAD OF DIRECTLY INTO AP020-RECV-TOT-COST-AMT.    *00364029
003650*     THIS REDUCES THE ROUNDING IMPACT SIGNIFICANTLY.            *00365029
003660*     MADE BY: NANCY EILBES            WR/IR #: WR28327          *00366029
003670*                                                                *00367029
003610* DATE  03/11/2007                                               *00368030
003620*     CHANGE MADE: MBDC PROJECT. RECOMPILE                       *00369030
003660*     MADE BY: GREG WISIALOWSKI        WR/IR #: WR21578          *00369430
003670*                                                                *00369530
003700******************************************************************00370029
003800                                                                  00380027
003900 ENVIRONMENT DIVISION.                                            00390027
004000                                                                  00400027
004100 INPUT-OUTPUT SECTION.                                            00410027
004200                                                                  00420027
004300 FILE-CONTROL.                                                    00430027
004400     SELECT RECEIV-FILE        ASSIGN    TO UT-S-INP01.           00440027
004500     SELECT SUMMED-BY-RCVR-SEQ ASSIGN    TO UT-S-OUT01.           00450027
004600     SELECT SUMMED-BY-PO-STORE ASSIGN    TO UT-S-OUT02.           00460027
004700 DATA DIVISION.                                                   00470027
004800                                                                  00480027
004900 FILE SECTION.                                                    00490027
005000 FD  RECEIV-FILE                                                  00500027
005100         LABEL RECORDS  ARE STANDARD                              00510027
005200         RECORDING MODE IS  F                                     00520027
005300         DATA RECORD    IS  RECEIV-RECORD-IN.                     00530027
005400                                                                  00540027
005500 01  RECEIV-RECORD-IN              PIC X(090).                    00550027
005600                                                                  00560027
005700 FD  SUMMED-BY-RCVR-SEQ                                           00570027
005800         LABEL RECORDS  ARE STANDARD                              00580027
005900         RECORDING MODE IS  F                                     00590027
006000         DATA RECORD    IS  SUM-BY-RCVR-SEQ-REC.                  00600027
006100                                                                  00610027
006200 01  SUM-BY-RCVR-SEQ-REC           PIC X(090).                    00620027
006300                                                                  00630027
006400 FD  SUMMED-BY-PO-STORE                                           00640027
006500         LABEL RECORDS  ARE STANDARD                              00650027
006600         RECORDING MODE IS  F                                     00660027
006700         DATA RECORD    IS  SUM-BY-PO-STR-REC.                    00670027
006800                                                                  00680027
006900 01  SUM-BY-PO-STR-REC             PIC X(035).                    00690027
007000                                                                  00700027
007100/                                                                 00710027
007200 WORKING-STORAGE SECTION.                                         00720027
007300                                                                  00730027
007400 01  FILLER                        PIC X(25) VALUE                00740027
007500                             'WS FOR APKUT042 BEGINS==>'.         00750027
007600 01  ABEND-CODE                    PIC S9(4) COMP SYNC.           00760027
007700                                                                  00770027
008900 01  PV-WORK-AREA.                                                00890027
009000     05  PV-PROGRAM-NAME           PIC X(08)     VALUE 'APKUT042'.00900027
009100     05  PV-RECEIV-IN-REC-CNT      PIC 9(09)     VALUE 0.         00910027
009200     05  PV-RECEIV-OUT-STR-REC-CNT PIC 9(09)     VALUE 0.         00920027
009300     05  PV-RECEIV-PO-STR-REC-CNT  PIC 9(09)     VALUE 0.         00930027
009310     05  POSTR-REC-TOT-COST-AMT    PIC S9(10)V999 COMP-3          00931027
009400                                                 VALUE ZEROES.    00940027
011400*                                                                 01140027
011500 01  PV-SWITCHES.                                                 01150027
011600     05  END-OF-RECEIV-SW        PIC X(01) VALUE 'N'.             01160027
011700         88  END-OF-RECEIV                 VALUE 'Y'.             01170027
011800         88  NOT-END-OF-RECEIV             VALUE 'N'.             01180027
011900                                                                  01190027
012000 01  FILLER                      PIC X(35)  VALUE                 01200027
012100     'BEGINNING OF AP021 INPUT FILE    **'.                       01210027
012200     COPY APRD021.                                                01220027
012300                                                                  01230027
012310 01  FILLER                      PIC X(36)  VALUE                 01231028
012320     'BEGINNING OF AP021 OUTPUT FILE    **'.                      01232027
012330     COPY APRD021 REPLACING 'AP021-' BY 'SEQSUM-'.                01233027
012340                                                                  01234027
012400 01  FILLER                      PIC X(35)  VALUE                 01240027
012500     'BEGINNING OF AP020 OUTPUT FILE   **'.                       01250027
012600     COPY APRD020.                                                01260027
012700                                                                  01270027
012800 01  FILLER                      PIC X(35)  VALUE                 01280027
012900     'END OF AP WORK RECORD AREA       **'.                       01290027
013000                                                                  01300027
013100 01  FILLER                        PIC X(25) VALUE                01310027
013200          '<====PV FOR APKUT042 ENDS'.                            01320027
013300                                                                  01330027
013400*LINKAGE SECTION.                                                 01340027
013500                                                                  01350027
013600                                                                  01360027
013700 PROCEDURE DIVISION.                                              01370027
013800                                                                  01380027
013900 A100-MAINLINE.                                                   01390027
014000                                                                  01400027
014100     PERFORM B100-INITIALIZATION.                                 01410027
014200                                                                  01420027
014300     PERFORM B200-PROCESSING                                      01430027
014400        UNTIL END-OF-RECEIV.                                      01440027
014500                                                                  01450027
014600     PERFORM Z900-END-OF-JOB.                                     01460027
014700                                                                  01470027
014800     GOBACK.                                                      01480027
014900        EJECT                                                     01490027
014910 B100-INITIALIZATION.                                             01491027
014980                                                                  01498027
014990     MOVE SPACES              TO AP020-RECORD.                    01499027
014991     INITIALIZE                  AP020-RECORD.                    01499127
014992     MOVE SPACES              TO AP021-RECORD.                    01499227
014993     INITIALIZE                  AP021-RECORD.                    01499327
014994                                                                  01499427
014995     SET NOT-END-OF-RECEIV    TO TRUE.                            01499527
014996     MOVE SPACES              TO SEQSUM-RECORD.                   01499627
014997     INITIALIZE                  SEQSUM-RECORD.                   01499727
014998                                                                  01499827
014999     OPEN INPUT   RECEIV-FILE                                     01499927
015000          OUTPUT  SUMMED-BY-RCVR-SEQ                              01500027
015001                  SUMMED-BY-PO-STORE.                             01500127
015002                                                                  01500227
015003     PERFORM R100-READ-AP021.                                     01500327
015004                                                                  01500427
015005     IF NOT END-OF-RECEIV                                         01500527
015006        MOVE AP021-RECORD           TO SEQSUM-RECORD              01500627
015007        MOVE SEQSUM-PO-NBR          TO AP020-PO-NBR               01500727
015008        MOVE SEQSUM-STR-NBR         TO AP020-STR-NBR              01500827
015009        MOVE AP021-REC-TOT-COST-AMT TO POSTR-REC-TOT-COST-AMT     01500927
015011        PERFORM R100-READ-AP021                                   01501127
015012     END-IF.                                                      01501227
015020                                                                  01502027
015100 B200-PROCESSING.                                                 01510027
015300                                                                  01530027
015400     IF  AP021-PO-NBR = SEQSUM-PO-NBR                             01540027
015500         IF  AP021-STR-NBR = SEQSUM-STR-NBR                       01550027
015600             IF  AP021-REC-SEQ-NBR = SEQSUM-REC-SEQ-NBR           01560027
015700                 IF  AP021-REC-TYPE-CODE = SEQSUM-REC-TYPE-CODE   01570027
015800                     COMPUTE SEQSUM-REC-TOT-COST-AMT              01580027
015900                        =    SEQSUM-REC-TOT-COST-AMT              01590027
016000                        +    AP021-REC-TOT-COST-AMT               01600027
016200                     COMPUTE POSTR-REC-TOT-COST-AMT               01620027
016300                        =    POSTR-REC-TOT-COST-AMT               01630027
016400                        +    AP021-REC-TOT-COST-AMT               01640027
016600                     COMPUTE SEQSUM-REC-TOT-QTY                   01660027
016700                        =    SEQSUM-REC-TOT-QTY                   01670027
016800                        +    AP021-REC-TOT-QTY                    01680027
016900                 ELSE                                             01690027
017000                     PERFORM W100-WRITE-SUM-BY-RCVSEQ             01700027
017100                     MOVE AP021-RECORD     TO SEQSUM-RECORD       01710027
017200                     MOVE SEQSUM-PO-NBR    TO AP020-PO-NBR        01720027
017300                     MOVE SEQSUM-STR-NBR TO AP020-STR-NBR         01730027
017400                     COMPUTE POSTR-REC-TOT-COST-AMT               01740027
017500                        =    POSTR-REC-TOT-COST-AMT               01750027
017600                        +    AP021-REC-TOT-COST-AMT               01760027
017800                 END-IF                                           01780027
017900             ELSE                                                 01790027
018000                 PERFORM W100-WRITE-SUM-BY-RCVSEQ                 01800027
018100                 MOVE AP021-RECORD     TO SEQSUM-RECORD           01810027
018200                 MOVE SEQSUM-PO-NBR    TO AP020-PO-NBR            01820027
018300                 MOVE SEQSUM-STR-NBR   TO AP020-STR-NBR           01830027
018400                 COMPUTE POSTR-REC-TOT-COST-AMT                   01840027
018500                    =    POSTR-REC-TOT-COST-AMT                   01850027
018600                    +    AP021-REC-TOT-COST-AMT                   01860027
018800             END-IF                                               01880027
018900         ELSE                                                     01890027
019000             PERFORM W100-WRITE-SUM-BY-RCVSEQ                     01900027
019100             IF POSTR-REC-TOT-COST-AMT  > 0                       01910027
019101                COMPUTE AP020-RECV-TOT-COST-AMT =                 01910127
019110                        POSTR-REC-TOT-COST-AMT + .005             01911027
019200                PERFORM W200-WRITE-SUM-BY-PO-STR-REC              01920027
019300             END-IF                                               01930027
019400             MOVE AP021-RECORD           TO SEQSUM-RECORD         01940027
019500             MOVE SEQSUM-PO-NBR          TO AP020-PO-NBR          01950027
019600             MOVE SEQSUM-STR-NBR         TO AP020-STR-NBR         01960027
019700             MOVE AP021-REC-TOT-COST-AMT TO POSTR-REC-TOT-COST-AMT01970027
019900         END-IF                                                   01990027
020000     ELSE                                                         02000027
020100         PERFORM W100-WRITE-SUM-BY-RCVSEQ                         02010027
020110         IF POSTR-REC-TOT-COST-AMT  > 0                           02011027
020111            COMPUTE AP020-RECV-TOT-COST-AMT =                     02011127
020112                    POSTR-REC-TOT-COST-AMT + .005                 02011227
020140            PERFORM W200-WRITE-SUM-BY-PO-STR-REC                  02014027
020150         END-IF                                                   02015027
020500         MOVE AP021-RECORD           TO SEQSUM-RECORD             02050027
020600         MOVE SEQSUM-PO-NBR          TO AP020-PO-NBR              02060027
020700         MOVE SEQSUM-STR-NBR         TO AP020-STR-NBR             02070027
020800         MOVE AP021-REC-TOT-COST-AMT TO POSTR-REC-TOT-COST-AMT    02080027
021000     END-IF.                                                      02100027
021100                                                                  02110027
021200     PERFORM R100-READ-AP021.                                     02120027
021300                                                                  02130027
024500 R100-READ-AP021.                                                 02450027
025200                                                                  02520027
025300     READ RECEIV-FILE   INTO AP021-RECORD                         02530027
025400       AT END  SET END-OF-RECEIV TO TRUE.                         02540027
025500                                                                  02550027
025600     IF NOT END-OF-RECEIV                                         02560027
025700        ADD 1 TO PV-RECEIV-IN-REC-CNT.                            02570027
025800                                                                  02580027
025900 W100-WRITE-SUM-BY-RCVSEQ.                                        02590027
026600                                                                  02660027
026700     WRITE SUM-BY-RCVR-SEQ-REC FROM SEQSUM-RECORD.                02670027
026800                                                                  02680027
026900     ADD 1 TO PV-RECEIV-OUT-STR-REC-CNT.                          02690027
027000                                                                  02700027
027100 W200-WRITE-SUM-BY-PO-STR-REC.                                    02710027
027800                                                                  02780027
027900     WRITE SUM-BY-PO-STR-REC FROM AP020-RECORD.                   02790027
028000                                                                  02800027
028100     ADD 1 TO PV-RECEIV-PO-STR-REC-CNT.                           02810027
028200                                                                  02820027
028300 Z900-END-OF-JOB.                                                 02830027
029000                                                                  02900027
029100     PERFORM W100-WRITE-SUM-BY-RCVSEQ.                            02910027
029110     COMPUTE AP020-RECV-TOT-COST-AMT =                            02911027
029120             POSTR-REC-TOT-COST-AMT + .005.                       02912027
029200     PERFORM W200-WRITE-SUM-BY-PO-STR-REC.                        02920027
029300                                                                  02930027
029400     DISPLAY '************************************************'.  02940027
029500     DISPLAY 'TOTAL AP021 RECORDS READ  = '                       02950027
029600              PV-RECEIV-IN-REC-CNT.                               02960027
029800     DISPLAY 'TOTAL AP021 SUMMED REC OUT= '                       02980027
029900              PV-RECEIV-OUT-STR-REC-CNT.                          02990027
030000     DISPLAY 'TOTAL AP020 PO STR SUM RECORDS = '                  03000027
030100              PV-RECEIV-PO-STR-REC-CNT.                           03010027
030200     DISPLAY '************************************************'.  03020027
030300                                                                  03030027
030400     DISPLAY ' PROGRAM APKUT042 ENDS NORMALLY '.                  03040027
030500                                                                  03050027
