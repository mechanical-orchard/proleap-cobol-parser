000100******************************************************************00010023
000200 IDENTIFICATION DIVISION.                                         00020023
000300******************************************************************00030023
000400                                                                  00040023
000500 PROGRAM-ID.    RVKRP011.                                         00050023
000600 AUTHOR.        BOB JOHNSON, ADTEK.                               00060023
000700 INSTALLATION.  KOHLS.                                            00070023
000800 DATE-WRITTEN   APRIL, 1996.                                      00080023
000900 DATE-COMPILED.                                                   00090023
001000                                                                  00100023
001100******************************************************************00110023
001200*  THIS PROGRAM CREATES A DAILY LISTING OF RECEIPTS/ADJUSTMENTS   00120023
001300*  FOR THE RETURN TO VENDOR AREA.                                 00130023
001400******************************************************************00140023
001500 ENVIRONMENT DIVISION.                                            00150023
001600 CONFIGURATION SECTION.                                           00160023
001700 SOURCE-COMPUTER.        IBM-3090.                                00170023
001800 OBJECT-COMPUTER.        IBM-3090.                                00180023
001900                                                                  00190023
002000 INPUT-OUTPUT SECTION.                                            00200023
002100 FILE-CONTROL.                                                    00210023
002200     SELECT ADJUSTMENT-EXTRACT   ASSIGN TO INP01.                 00220023
002300     SELECT STORE-SUMMARY-REPORT ASSIGN TO RPT01.                 00230023
002400                                                                  00240023
002500******************************************************************00250023
002600 DATA DIVISION.                                                   00260023
002700******************************************************************00270023
002800                                                                  00280023
002900 FILE SECTION.                                                    00290023
003000     SKIP1                                                        00300023
003100 FD  ADJUSTMENT-EXTRACT                                           00310023
003200     RECORDING MODE IS F                                          00320023
003300     LABEL RECORDS ARE STANDARD                                   00330023
003400     BLOCK CONTAINS 0 RECORDS.                                    00340023
003500                                                                  00350023
003600 01  ADJUSTMENT-EXTRACT-RECORD       PIC  X(300).                 00360023
003700     SKIP1                                                        00370023
003800 FD  STORE-SUMMARY-REPORT                                         00380023
003900     RECORDING MODE IS F                                          00390023
004000     LABEL RECORDS ARE STANDARD                                   00400023
004100     BLOCK CONTAINS 0 RECORDS.                                    00410023
004200                                                                  00420023
004300 01  STORE-SUMMARY-REPORT-RECORD     PIC  X(132).                 00430023
004400     EJECT                                                        00440023
004500******************************************************************00450023
004600 WORKING-STORAGE SECTION.                                         00460023
004700******************************************************************00470023
004800     SKIP1                                                        00480023
004900 01  ABEND-CODE                          PIC S9(04)  VALUE ZEROES 00490023
005000                                                     COMP SYNC.   00500023
005100******************************************************************00510023
005200*  STYLE SUMMARY REPORT EXTRACT RECORD LAYOUT                     00520023
005300******************************************************************00530023
005400     COPY STOREEXT.                                               00540026
005500     EJECT                                                        00550023
005600 01  WS-PURCHASE-ORDER-TABLE.                                     00560023
005700     05  POT-ENTRY                   OCCURS 1000 TIMES.           00570023
005800         10  POT-SRC-KEY                 PIC  X(27).              00580023
005900         10  POT-PRINT-LINE.                                      00590023
006000             15  FILLER                  PIC  X(01).              00600023
006100             15  POT-PO-RCV              PIC  X(12).              00610023
006200             15  FILLER                  PIC  X(01).              00620023
006300             15  POT-VENDOR-NAME-DUNN    PIC  X(25).              00630023
006400             15  FILLER                  PIC  X(01).              00640023
006500             15  POT-PO-LINE-NBR         PIC    ZZ9.              00650023
006600             15  FILLER                  PIC  X(02).              00660023
006700             15  POT-DEPT                PIC  X(03).              00670023
006600             15  FILLER                  PIC  X(01).              00660023
006700             15  POT-CLASS               PIC  X(02).              00670023
006600             15  FILLER                  PIC  X(01).              00660023
006700             15  POT-SKU                 PIC  X(08).              00670023
006800             15  FILLER                  PIC  X(01).              00680023
006900             15  POT-VER-ADJ-DATE        PIC  X(10).              00690023
007000             15  FILLER                  PIC  X(02).              00700023
007100             15  POT-QUANTITY            PIC  ZZZZZ9-.            00710023
007200             15  FILLER                  PIC  X(01).              00720023
007300             15  POT-UNIT-RTL-AMT        PIC  Z,ZZZ,ZZZ.99-.      00730023
007400             15  FILLER                  PIC  X(01).              00740023
007500             15  POT-EXTD-RTL-AMT        PIC  Z,ZZZ,ZZZ.99-.      00750023
007600             15  FILLER                  PIC  X(01).              00760023
007700             15  POT-PROCESS-AREA        PIC  X(06).              00770023
007800             15  FILLER                  PIC  X(01).              00780023
007900             15  POT-TRAN-TYPE           PIC  X(05).              00790023
008000         10  POT-DET-QUANTITY            PIC S9(05) COMP-3.       00800023
008100         10  POT-DET-UNIT-RTL-AMT        PIC S9(05)V99 COMP-3.    00810023
008200         10  POT-DET-EXTD-RTL-AMT        PIC S9(07)V99 COMP-3.    00820024
008300    EJECT                                                         00830023
008400*----------------------------------------------------------------*00840023
008500*    STANDARD REPORT HEADER FOR 132 COLUMN REPORT                *00850023
008600*----------------------------------------------------------------*00860023
008700     COPY DPWS132O.                                               00870026
008800     EJECT                                                        00880023
008900 01  HL1-HEADING-LINE-1.                                          00890023
009000     05  FILLER                      PIC  X(34)      VALUE SPACE. 00900023
009100     05  HL1-WEEKLY-DAILY            PIC  X(13)      VALUE SPACES.00910023
009200     05  FILLER                      PIC  X(30)      VALUE        00920023
009300         ' OF RECEIPTS/ADJUSTMENTS INTO '.                        00930023
009400     05  FILLER                      PIC  X(22)      VALUE        00940023
009500         'RETURN-TO-VENDOR AREAS'.                                00950023
009600     05  FILLER                      PIC  X(33)      VALUE SPACE. 00960023
009700     SKIP1                                                        00970023
009800 01  HL1-HEADING-LINE-2.                                          00980023
009900     05  FILLER                      PIC  X(54)      VALUE SPACE. 00990023
010000     05  FILLER                      PIC  X(14)      VALUE        01000023
010100         'WEEK ENDING - '.                                        01010023
010200     05  HL1-HL2-WK-END              PIC  X(10)      VALUE        01020023
010300         'XX/XX/XXXX'.                                            01030023
010400     05  FILLER                      PIC  X(54)      VALUE SPACE. 01040023
010500     SKIP1                                                        01050023
010600 01  DH1-DETAIL-HEADING-LINE-1.                                   01060023
010700     05  FILLER                      PIC  X(22)      VALUE        01070023
010800         ' RECEIVING LOCATION - '.                                01080023
010900     05  DH1-DC-NAME                 PIC  X(25)      VALUE SPACES.01090023
011000     05  FILLER                      PIC  X(85)      VALUE SPACES.01100023
011100     SKIP1                                                        01110023
011200 01  DH1-DETAIL-HEADING-LINE-2.                                   01120023
011300     05  FILLER                      PIC  X(22)      VALUE        01130023
011400         '     STORE LOCATION - '.                                01140023
011500     05  DH1-STORE-NUMBER            PIC  9(04)      VALUE ZEROS. 01150026
011600     05  FILLER                      PIC  X(01)      VALUE '('.   01160023
011700     05  DH1-STORE-CHAR10            PIC  X(10)      VALUE SPACES.01170023
011800     05  FILLER                      PIC  X(01)      VALUE ')'.   01180023
011900     05  FILLER                      PIC  X(94)      VALUE SPACES.01190026
012000                                                                  01200023
012100 01  DH2-DETAIL-HEADING-LINE-2.                                   01210023
1022RM     05  FILLER                      PIC  X(05) VALUE SPACES.     01220023
012200     05  FILLER                      PIC  X(04) VALUE             01220023
012300         ' PO/'.                                                  01230023
012400     05  FILLER                      PIC  X(36) VALUE SPACES.     01240023
012500     05  FILLER                      PIC  X(04) VALUE             01250023
012600         'LINE'.                                                  01260023
012700     05  FILLER                      PIC  X(10) VALUE SPACES.     01270023
012700     05  FILLER                      PIC  X(03) VALUE             01270023
012700         'SKU'.                                                   01270023
012700     05  FILLER                      PIC  X(04) VALUE SPACES.     01270023
012800     05  FILLER                      PIC  X(10) VALUE             01280023
012900         'VERIFY/ADJ'.                                            01290023
013000     05  FILLER                      PIC  X(18) VALUE SPACES.     01300023
013100     05  FILLER                      PIC  X(04) VALUE             01310023
013200         'UNIT'.                                                  01320023
013300     05  FILLER                      PIC  X(06) VALUE SPACES.     01330023
013400     05  FILLER                      PIC  X(08) VALUE             01340023
013500         'EXTENTED'.                                              01350023
013600     05  FILLER                      PIC  X(02) VALUE SPACES.     01360023
013700     05  FILLER                      PIC  X(07) VALUE             01370023
013800         'PROCESS'.                                               01380023
013900     05  FILLER                      PIC  X(14) VALUE SPACES.     01390023
014000                                                                  01400023
014100 01  DH3-DETAIL-HEADING-LINE-3.                                   01410023
1022RM     05  FILLER                      PIC  X(05) VALUE             01420023
1022RM         ' DC  '.                                                 01430023
014200     05  FILLER                      PIC  X(09) VALUE             01420023
014300         ' RECEIVER'.                                             01430023
014400     05  FILLER                      PIC  X(05) VALUE SPACES.     01440023
014500     05  FILLER                      PIC  X(11) VALUE             01450023
014600         'VENDOR NAME'.                                           01460023
014700     05  FILLER                      PIC  X(16) VALUE SPACES.     01470023
014800     05  FILLER                      PIC  X(02) VALUE             01480023
014900         'NO'.                                                    01490023
015000     05  FILLER                      PIC  X(01) VALUE SPACES.     01500023
015000     05  FILLER                      PIC  X(04) VALUE             01500023
015000         'DEPT'.                                                  01500023
015000     05  FILLER                      PIC  X(01) VALUE SPACES.     01500023
015000     05  FILLER                      PIC  X(02) VALUE             01500023
015000         'CL'.                                                    01500023
015000     05  FILLER                      PIC  X(03) VALUE SPACES.     01500023
015100     05  FILLER                      PIC  X(06) VALUE             01510023
015200         'NUMBER'.                                                01520023
015300     05  FILLER                      PIC  X(04) VALUE SPACES.     01530023
015400     05  FILLER                      PIC  X(04) VALUE             01540023
015500         'DATE'.                                                  01550023
015600     05  FILLER                      PIC  X(04) VALUE SPACES.     01560023
015700     05  FILLER                      PIC  X(08) VALUE             01570023
015800         'QUANTITY'.                                              01580023
015900     05  FILLER                      PIC  X(07) VALUE SPACES.     01590023
016000     05  FILLER                      PIC  X(06) VALUE             01600023
016100         'RETAIL'.                                                01610023
016200     05  FILLER                      PIC  X(07) VALUE SPACES.     01620023
016300     05  FILLER                      PIC  X(06) VALUE             01630023
016400         'RETAIL'.                                                01640023
016500     05  FILLER                      PIC  X(04) VALUE SPACES.     01650023
016600     05  FILLER                      PIC  X(04) VALUE             01660023
016700         'AREA'.                                                  01670023
016800     05  FILLER                      PIC  X(16) VALUE SPACES.     01680023
016900     SKIP1                                                        01690023
017000 01  DL-DETAIL-LINE.                                              01700023
1022RM     05  DL-DC-LOC               PIC  X(04)          VALUE SPACES.        
1022RM     05  FILLER                  PIC  X(01)          VALUE SPACE. 01710023
017200     05  DL-PO-NBR               PIC  X(08)          VALUE SPACES.01720023
017300     05  DL-PO-DASH-1            PIC  X(01)          VALUE '-'.   01730023
017400     05  DL-RECEIVER-NBR         PIC  X(03)          VALUE SPACES.01740023
017500     05  FILLER                  PIC  X(01)          VALUE SPACES.01750023
017600     05  DL-VENDOR-NAME-DUNN     PIC  X(25)          VALUE SPACES.01760023
017700     05  FILLER                  PIC  X(01)          VALUE SPACES.01770023
017800     05  DL-PO-LINE-NBR          PIC    ZZ9          VALUE ZEROES.01780023
017900     05  FILLER                  PIC  X(02)          VALUE SPACES.01790025
018100     05  DL-SKU-DEPT             PIC  X(03)          VALUE SPACES.01810025
018200     05  FILLER                  PIC  X(01)          VALUE SPACES.01820025
018300     05  DL-SKU-CLASS            PIC  X(02)          VALUE SPACES.01830025
018400     05  FILLER                  PIC  X(01)          VALUE SPACES.01840025
018000     05  DL-SKU                  PIC  X(08)          VALUE SPACES.01800025
018600     05  FILLER                  PIC  X(01)          VALUE SPACES.01860025
018700     05  DL-VER-ADJ-DATE.                                         01870023
018800         10  DL-VA-MM            PIC  X(02)          VALUE SPACES.01880023
018900         10  DL-VA-SLASH-1       PIC  X(01)          VALUE '/'.   01890023
019000         10  DL-VA-DD            PIC  X(02)          VALUE SPACES.01900023
019100         10  DL-VA-SLASH-2       PIC  X(01)          VALUE '/'.   01910023
019200         10  DL-VA-CCYY.                                          01920023
019300             15 DL-VA-CC         PIC  X(02)          VALUE SPACES.01930023
019400             15 DL-VA-YY         PIC  X(02)          VALUE SPACES.01940023
019500     05  FILLER                  PIC  X(02)          VALUE SPACES.01950023
019600     05  DL-QUANTITY             PIC  ZZZZZ9-        VALUE ZEROES.01960023
019700     05  FILLER                  PIC  X(01)          VALUE SPACES.01970023
019800     05  DL-UNIT-RTL-AMT         PIC  Z,ZZZ,ZZZ.99-  VALUE ZEROES.01980023
019900     05  FILLER                  PIC  X(01)          VALUE SPACES.01990023
020000     05  DL-EXTD-RTL-AMT         PIC  Z,ZZZ,ZZZ.99-  VALUE ZEROES.02000023
020100     05  FILLER                  PIC  X(01)          VALUE SPACES.02010023
020200     05  DL-PROCESS-AREA         PIC  X(06)          VALUE SPACES.02020023
020300     05  FILLER                  PIC  X(01)          VALUE SPACES.02030023
020400     05  DL-TRAN-TYPE            PIC  X(05)          VALUE SPACES.02040023
020500*                                                                 02050023
020600 01  DL-TOTAL-LINE-1.                                             02060023
020700     05  FILLER                      PIC  X(47)    VALUE SPACES.  02070023
020800     05  FILLER                      PIC  X(18)    VALUE          02080023
020900         'TOTAL FOR DC '.                                         02090023
021000     05  DL-TOTAL-QUANTITY    PIC  ZZ,ZZZ,ZZZ,ZZ9-                02100023
021100                                                   VALUE ZEROES.  02110023
021200     05  FILLER                      PIC  X(13)    VALUE SPACES.  02120023
021300     05  DL-TOTAL-EXT-RETAIL  PIC  ZZZ,ZZZ,ZZZ.99-                02130023
021400                                                   VALUE ZEROES.  02140023
021500     05  FILLER                      PIC  X(15)    VALUE SPACES.  02150023
021600*                                                                 02160023
021700 01  DL-TOTAL-LINE-2.                                             02170023
021800     05  FILLER                      PIC  X(44)    VALUE SPACES.  02180023
021900     05  FILLER                      PIC  X(20)    VALUE          02190023
022000         'FINAL COMPANY TOTALS'.                                  02200023
022100     05  TL2-TOTAL-QUANTITY   PIC  ZZZ,ZZZ,ZZZ,ZZ9-               02210023
022200                                                   VALUE ZEROES.  02220023
022300     05  FILLER                      PIC  X(11)    VALUE SPACES.  02230023
022400     05  TL2-TOTAL-EXT-RETAIL PIC  Z,ZZZ,ZZZ,ZZZ.99-              02240023
022500                                                   VALUE ZEROES.  02250023
022600     05  FILLER                      PIC  X(15)    VALUE SPACES.  02260023
022700*                                                                 02270023
022800 01  DL-TOTAL-LINE-3.                                             02280023
022900     05  FILLER                      PIC  X(47)    VALUE SPACES.  02290023
023000     05  FILLER                      PIC  X(18)    VALUE          02300023
023100         'TOTAL FOR STORE '.                                      02310023
023200     05  TL3-TOTAL-QUANTITY   PIC  ZZ,ZZZ,ZZZ,ZZ9-                02320023
023300                                                   VALUE ZEROES.  02330023
023400     05  FILLER                      PIC  X(13)    VALUE SPACES.  02340023
023500     05  TL3-TOTAL-EXT-RETAIL PIC  ZZZ,ZZZ,ZZZ.99-                02350023
023600                                                   VALUE ZEROES.  02360023
023700     05  FILLER                      PIC  X(15)    VALUE SPACES.  02370023
023800*                                                                 02380023
023900 01  DL-BLANK-LINE.                                               02390023
024000     05  FILLER                      PIC  X(132)   VALUE SPACES.  02400023
024100*                                                                 02410023
024200 01  DL-BLANK-PAGE.                                               02420023
024300     05  FILLER                      PIC  X(33)    VALUE SPACES.  02430023
024400     05  FILLER                      PIC  X(34)    VALUE          02440023
024500         'THIS PAGE INTENTIONALLY LEFT BLANK'.                    02450023
024600     05  FILLER                      PIC  X(33)    VALUE SPACES.  02460023
024700*                                                                 02470023
024800 01  ER-END-OF-REPORT-LINE.                                       02480023
024900     05  FILLER                      PIC  X(53)      VALUE SPACE. 02490023
025000     05  FILLER                      PIC  X(25)      VALUE        02500023
025100         '***** END OF REPORT *****'.                             02510023
025200     05  FILLER                      PIC  X(54)      VALUE SPACE. 02520023
025300*                                                                 02530023
025400 01  ER-NO-INPUT-LINE.                                            02540023
025500     05  FILLER                      PIC  X(52)      VALUE SPACE. 02550023
025600     05  FILLER                      PIC  X(29)      VALUE        02560023
025700         '***** EMPTY REPORT FILE *****'.                         02570023
025800     05  FILLER                      PIC  X(52)      VALUE SPACE. 02580023
025900     EJECT                                                        02590023
026000     COPY DPWS500.                                                02600026
026100     EJECT                                                        02610023
026200 01  PS-PROGRAM-SWITCHES.                                         02620023
026300     05  PS-SKU-TABLE-EOF-SW         PIC  X(01)    VALUE 'N'.     02630023
026400         88  PS-MORE-SKUS                          VALUE 'N'.     02640023
026500         88  PS-NO-MORE-SKUS                       VALUE 'Y'.     02650023
026600     05  PS-PRINT-BLANK-LINE-SW      PIC  X(01)    VALUE SPACE.   02660023
026700         88  PS-PRINT-BLANK-LINE                   VALUE 'Y'.     02670023
026800         88  PS-DONT-PRINT-BLANK-LINE              VALUE 'N'.     02680023
026900     05  PS-TABLE-SEARCH-SW          PIC  X(01)    VALUE 'N'.     02690023
027000         88  PS-TABLE-SEARCH                       VALUE 'N'.     02700023
027100         88  PS-TABLE-DONE                         VALUE 'Y'.     02710023
027200     05  PS-LOCATION-CSR-SW          PIC X(01)        VALUE 'N'.  02720026
027300         88  PS-EOF-LOCATION-CSR                      VALUE 'Y'.  02730026
027400     05  PS-RTV-RECORD-SW            PIC X(01)        VALUE 'N'.  02740023
027500         88  PS-IS-A-RTV-RECORD                       VALUE 'Y'.  02750023
027600         88  PS-IS-NOT-A-RTV-RECORD                   VALUE 'N'.  02760023
027700     SKIP1                                                        02770023
027800 01  PC-PROGRAM-CONSTANTS.                                        02780023
027900     05  PC-MAX-PAGE-SIZE            PIC S9(04)    VALUE +055     02790023
028000                                                   COMP SYNC.     02800023
028100     05  PC-HEADING-SIZE             PIC S9(04)    VALUE +009     02810023
028200                                                   COMP SYNC.     02820023
028300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          02830023
028400         'RVKRP011'.                                              02840023
028500     05  PC-NOT-FOUND-MESSAGE        PIC  X(10)    VALUE          02850023
028600         'NOT FOUND'.                                             02860023
028700     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     02870023
028800     05  PC-DASH                     PIC  X(01)    VALUE '-'.     02880023
028900     SKIP1                                                        02890023
029000 01  PV-PROGRAM-VARIABLES.                                        02900023
029100     05  PV-DAILY-LISTING            PIC  X(13)      VALUE        02910023
029200         'DAILY LISTING'.                                         02920023
029300     05  PV-WEEKLY-RECAP             PIC  X(13)      VALUE        02930023
029400         ' WEEKLY RECAP'.                                         02940023
029500     05  PV-JOB-TYPE                 PIC  X(01)    VALUE SPACES.  02950023
029600     05  PV-READ-CNT                 PIC S9(04)    VALUE ZEROES   02960023
029700                                                   COMP SYNC.     02970023
029800     05  PV-LINES-CNT                PIC S9(04)    VALUE +84      02980023
029900                                                   COMP SYNC.     02990023
030000     05  PV-LINES-NEEDED             PIC S9(04)    VALUE ZERO     03000023
030100                                                   COMP SYNC.     03010023
030200     05  PV-LINES-USED               PIC S9(04)    VALUE ZERO     03020023
030300                                                   COMP SYNC.     03030023
030400     05  POT-IDX                     PIC S9(04)    VALUE ZERO     03040023
030500                                                   COMP SYNC.     03050023
030600     05  PRINT-IDX                   PIC S9(04)    VALUE ZERO     03060023
030700                                                   COMP SYNC.     03070023
030800     05  PV-BLANK-LINE               PIC X(133)    VALUE SPACES.  03080023
030900     SKIP1                                                        03090023
031000     05  PV-SPACE-CNTL               PIC  X(01)    VALUE SPACES.  03100023
031100     05  PV-PAGE-COUNT               PIC  9(05)    VALUE ZERO.    03110023
031200     05  PV-CURRENT-KEY.                                          03120023
031300         10  PV-CURR-PO-SEQ.                                      03130023
031400             15 PV-CURR-DC              PIC X(02).                03140023
031500             15 PV-CURR-OPER-UNT-ID     PIC 9(04).                03150023
031600             15 PV-CURR-STORE           PIC 9(04).                03160026
031700             15 PV-CURR-PO              PIC 9(08).                03170023
031800             15 PV-CURR-RECV-SEQ        PIC 9(09).                03180023
031900         10  PV-CURR-LINE-NM            PIC X(03).                03190023
032000         10  PV-CURR-SRC-CDE            PIC X(01).                03200023
032100     SKIP1                                                        03210023
032200     05  PV-PREVIOUS-KEY.                                         03220023
032300         10  PV-PREV-PO-SEQ.                                      03230023
032400             15 PV-PREV-DC              PIC X(02).                03240023
032500             15 PV-PREV-OPER-UNT-ID     PIC 9(04).                03250023
032600             15 PV-PREV-STORE           PIC 9(04).                03260026
032700             15 PV-PREV-PO              PIC 9(08).                03270023
032800             15 PV-PREV-RECV-SEQ        PIC 9(09).                03280023
032900         10  PV-PREV-LINE-NM            PIC X(03).                03290023
033000         10  PV-PREV-SRC-CDE            PIC X(01).                03300023
033100     SKIP1                                                        03310023
033200     05  PV-PRINT-CONTROLS.                                       03320023
033300         10  PV-CURR-PRINT-STORE-NUM    PIC 9(04).                03330026
033400         10  PV-CURR-PRINT-STORE-DSC    PIC X(10).                03340023
033500         10  PV-CURR-PRINT-DC           PIC X(02).                03350023
033600         10  PV-PREV-PRINT-STORE-NUM    PIC 9(04).                03360026
033700         10  PV-PREV-PRINT-STORE-DSC    PIC X(10).                03370023
033800         10  PV-PREV-PRINT-DC           PIC X(02).                03380023
033900     SKIP1                                                        03390023
034000     05  PV-REFORMAT-DTE.                                         03400023
034100         10  PV-RF-MM            PIC  X(02)          VALUE SPACES.03410023
034200         10  PV-RF-SLASH-1       PIC  X(01)          VALUE '/'.   03420023
034300         10  PV-RF-DD            PIC  X(02)          VALUE SPACES.03430023
034400         10  PV-RF-SLASH-2       PIC  X(01)          VALUE '/'.   03440023
034500         10  PV-RF-CCYY.                                          03450023
034600             15 PV-RF-CC         PIC  X(02)          VALUE SPACES.03460023
034700             15 PV-RF-YY         PIC  X(02)          VALUE SPACES.03470023
034800     SKIP1                                                        03480023
034900     05  PV-DC-COUNTERS.                                          03490023
035000         10  PV-DC-QUANTITY             PIC S9(11) COMP-3         03500023
035100                                                   VALUE ZEROES.  03510023
035200         10  PV-DC-EXTD-RTL-AMT         PIC S9(09)V99 COMP-3      03520023
035300                                                   VALUE ZEROES.  03530023
035400     05  PV-STORE-COUNTERS.                                       03540023
035500         10  PV-STORE-QUANTITY          PIC S9(11) COMP-3         03550023
035600                                                   VALUE ZEROES.  03560023
035700         10  PV-STORE-EXTD-RTL-AMT      PIC S9(09)V99 COMP-3      03570023
035800                                                   VALUE ZEROES.  03580023
035900     05  PV-CO-COUNTERS.                                          03590023
036000         10  PV-CO-QUANTITY             PIC S9(13) COMP-3         03600023
036100                                                   VALUE ZEROES.  03610023
036200         10  PV-CO-EXTD-RTL-AMT         PIC S9(11)V99 COMP-3      03620023
036300                                                   VALUE ZEROES.  03630023
036400     SKIP1                                                        03640023
036500 01  RTV-TABLE-STRUCTURE.                                         03650023
036600     05  RTV-TABLE                   OCCURS 50 TIMES              03660023
036700                                     INDEXED BY RTV-IDX.          03670023
036800         10  RTV-NMBR                PIC S9(04) COMP.             03680026
036900         10  RTV-DESC-CHAR10         PIC X(10).                   03690023
037000     SKIP1                                                        03700023
037100 01  SD-SYSTEM-DATE.                                              03710023
037200     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  03720023
037300     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  03730023
037400     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  03740023
037500     SKIP1                                                        03750023
037600 01  ST-SYSTEM-TIME.                                              03760023
037700     05  ST-SYSTEM-HOUR              PIC  9(02)      VALUE ZERO.  03770023
037800     05  ST-SYSTEM-MINUTE            PIC  9(02)      VALUE ZERO.  03780023
037900     05  FILLER                      PIC  9(04)      VALUE ZERO.  03790023
038000 01  WS-PARAGRAPH-NAME               PIC  X(30)      VALUE SPACE. 03800023
038100 01  WS-DB2-OPERATION-ATTEMPTED      PIC  X(30)      VALUE SPACE. 03810023
038200     EJECT                                                        03820023
038300     COPY XLWS071.                                                03821026
038400/                                                                         
038500*                                                                 03830023
038600*  DCLGEN FOR THE DB2 XLT_LOC TABLE                               03840023
038700*                                                                 03850023
038800     EXEC SQL                                                     03860023
038900         INCLUDE XLT00010                                         03870026
039000     END-EXEC.                                                    03880023
039100*                                                                 03960023
039200*  COMMUNICATION AREAS FOR DB2                                    03970023
039300*                                                                 03980023
039400     EXEC SQL                                                     03990023
039500         INCLUDE SQLCA                                            04000023
039600     END-EXEC.                                                    04010023
039700******************************************************************04020023
039800*  LOCATION CURSOR                                                04030026
039900******************************************************************04040023
040000     EXEC SQL                                                     04050023
040100          DECLARE LOCATION-CSR CURSOR FOR                         04060026
040200           SELECT LOC_NBR                                         04070026
040300               ,  LOC_10_ABBR_NM                                  04080026
040400           FROM   XLT_LOC                                         04090026
040500          WHERE LOC_TYP_CDE IN ('DC', 'RV')                       04100026
040600     END-EXEC.                                                    04110023
040700*                                                                 04120023
040800*  DB2 COMMUNICATION AREA 2                                       04130023
040900*                                                                 04140023
041000     COPY SQLCA2.                                                 04150026
041100                                                                  04160023
041200*                                                                 04170023
041300*  DB2 SQL ERROR ROUTINE                                          04180023
041400*                                                                 04190023
041500     COPY DPWS004.                                                04200026
041600                                                                  04210023
041700 PROCEDURE DIVISION.                                              04220023
041800 0000-PROGRAM-MAINLINE.                                           04230023
041900******************************************************************04240023
042000* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     04250023
042100*      PROGRAM.                                                   04260023
042200******************************************************************04270023
042300     PERFORM 1000-INITIALIZE.                                     04280023
042400     PERFORM 2000-PRINT-THE-TABLE                                 04290023
042500       UNTIL PS-NO-MORE-SKUS.                                     04300023
042600     IF POT-SRC-KEY(1) = SPACES                                   04310023
042700         NEXT SENTENCE                                            04320023
042800     ELSE                                                         04330023
042900        PERFORM 3300-PRINT-DETAIL-LINE                            04340023
043000        PERFORM 3150-PRINT-STORE-BREAK                            04350023
043100        PERFORM 3100-PRINT-DC-BREAK                               04360023
043200     END-IF.                                                      04370023
043300     PERFORM 9000-EOJ-ROUTINE.                                    04380023
043400     STOP RUN.                                                    04390023
043500     EJECT                                                        04400023
043600 1000-INITIALIZE.                                                 04410023
043700******************************************************************04420023
043800*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    04430023
043900*    -- ACCEPT, DISPLAY AND VALIDATE CONTROL CARD                 04440023
044000*    -- OPEN FILES                                                04450023
044100*    -- SET UP AND PRINT REPORT HEADINGS                          04460023
044200*    -- READ THE FIRST EXTRACT RECORD                             04470023
044300******************************************************************04480023
044400     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04490023
044500     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04500023
044600     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04510023
044700     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04520023
044800     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04530023
044900     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04540023
045000     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04550023
045100     MOVE PC-CURRENT-PROGRAM-NAME                                 04560023
045200                                 TO DP132O-PROGRAM-NAME.          04570023
045300     MOVE 1                      TO DP132O-REPORT-NUMBER.         04580023
045400     SKIP1                                                        04590023
045500     ACCEPT PV-JOB-TYPE FROM SYSIN.                               04600023
045600     IF PV-JOB-TYPE = 'D'                                         04610023
045700         MOVE PV-DAILY-LISTING   TO HL1-WEEKLY-DAILY              04620023
045800     ELSE                                                         04630023
045900         MOVE PV-WEEKLY-RECAP    TO HL1-WEEKLY-DAILY              04640023
046000     END-IF.                                                      04650023
046100     MOVE LOW-VALUES             TO PV-CURRENT-KEY.               04660023
046200     INITIALIZE  WS-PURCHASE-ORDER-TABLE.                         04670023
046300     OPEN  INPUT ADJUSTMENT-EXTRACT                               04680023
046400          OUTPUT STORE-SUMMARY-REPORT.                            04690023
046500     SKIP1                                                        04700023
046600     PERFORM 1100-CREATE-RTV-TABLE.                               04710023
046700     SKIP1                                                        04720023
046800     PERFORM 7000-GET-ADJUSTMENT-RECORD.                          04730023
046900     IF  PS-MORE-SKUS                                             04740023
047000         PERFORM 6000-GET-WEEK-END-DATE                           04750023
047100         MOVE PV-CURRENT-KEY       TO PV-PREVIOUS-KEY             04760023
047200         MOVE PV-CURR-PRINT-STORE-NUM                             04770023
047300                                   TO PV-PREV-PRINT-STORE-NUM     04780023
047400         MOVE PV-CURR-PRINT-STORE-DSC                             04790023
047500                                   TO PV-PREV-PRINT-STORE-DSC     04800023
047600         MOVE PV-CURR-PRINT-DC     TO PV-PREV-PRINT-DC            04810023
047700         SET PS-TABLE-SEARCH       TO TRUE                        04820023
047800         PERFORM 2500-FILL-PO-TABLE                               04830023
047900             UNTIL PV-CURR-PO-SEQ > PV-PREV-PO-SEQ OR             04840023
048000               PS-NO-MORE-SKUS                                    04850023
048100     ELSE                                                         04860023
048200         PERFORM 8200-NO-INPUT-ROUTINE                            04870023
048300     END-IF.                                                      04880023
048400     EJECT                                                        04890023
048500 1100-CREATE-RTV-TABLE.                                           04900023
048600     PERFORM 1110-OPEN-LOCATION-CSR.                              04910026
048700                                                                  04920023
048800     PERFORM 1120-FETCH-LOCATION-CSR.                             04930026
048900     SET RTV-IDX TO +1.                                           04940023
049000                                                                  04950023
049100     PERFORM 1130-PROCESS-RTV-TABLE                               04960023
049200         UNTIL PS-EOF-LOCATION-CSR                                04970026
049300         OR    RTV-IDX > 50.                                      04980023
049400                                                                  04990023
049500     PERFORM 1140-CLOSE-LOCATION-CSR.                             05000026
049600     EJECT                                                        05010023
049700 1110-OPEN-LOCATION-CSR.                                          05020026
049800     EXEC SQL                                                     05030023
049900         OPEN LOCATION-CSR                                        05040026
050000     END-EXEC.                                                    05050023
050100                                                                  05060023
050200     EVALUATE TRUE                                                05070023
050300         WHEN SQLCODE = +0                                        05080023
050400              CONTINUE                                            05090023
050500         WHEN SQLWARN0 NOT = SPACE                                05100023
050600         WHEN SQLCODE  NOT = +0                                   05110023
050700              MOVE '1110-OPEN-LOCATION-CURSOR'                    05120026
050800                     TO WS-PARAGRAPH-NAME                         05130023
050900              MOVE 'OPEN LOCATION CURSOR'                         05140026
051000                     TO WS-DB2-OPERATION-ATTEMPTED                05150023
051100              PERFORM 9800-SQL-ABEND                              05160023
051200     END-EVALUATE.                                                05170023
051300     EJECT                                                        05180023
051400 1120-FETCH-LOCATION-CSR.                                         05190026
051500     EXEC SQL                                                     05200023
051600          FETCH LOCATION-CSR                                      05210026
051700           INTO   :XLT00010-LOC-NBR,                              05220026
051800                  :XLT00010-LOC-10-ABBR-NM                        05230026
051900     END-EXEC.                                                    05240023
052000                                                                  05250023
052100     EVALUATE TRUE                                                05260023
052200         WHEN SQLCODE = +0                                        05270023
052300              CONTINUE                                            05280023
052400         WHEN SQLCODE = +100                                      05290023
052500              SET  PS-EOF-LOCATION-CSR TO TRUE                    05300026
052600         WHEN SQLWARN0 NOT = SPACE                                05310023
052700         WHEN SQLCODE  NOT = +0                                   05320023
052800              MOVE '1120-FETCH-LOCATION-CSR'                      05330026
052900                     TO WS-PARAGRAPH-NAME                         05340023
053000              MOVE 'FETCH LOCATION CURSOR'                        05350026
053100                     TO WS-DB2-OPERATION-ATTEMPTED                05360023
053200              PERFORM 9800-SQL-ABEND                              05370023
053300     END-EVALUATE.                                                05380023
053400     EJECT                                                        05390023
053500 1130-PROCESS-RTV-TABLE.                                          05400023
053600     MOVE XLT00010-LOC-NBR TO RTV-NMBR (RTV-IDX).                 05410026
053700     MOVE XLT00010-LOC-10-ABBR-NM                                 05420026
053800                             TO RTV-DESC-CHAR10 (RTV-IDX).        05430023
053900                                                                  05440023
054000     PERFORM 1120-FETCH-LOCATION-CSR.                             05450026
054100                                                                  05460023
054200     SET RTV-IDX UP BY +1.                                        05470023
054300     EJECT                                                        05480023
054400 1140-CLOSE-LOCATION-CSR.                                         05490026
054500     EXEC SQL                                                     05500023
054600         CLOSE LOCATION-CSR                                       05510026
054700     END-EXEC.                                                    05520023
054800                                                                  05530023
054900     EVALUATE TRUE                                                05540023
055000         WHEN SQLCODE = 0                                         05550023
055100             CONTINUE                                             05560023
055200         WHEN SQLCODE = -911                                      05570023
055300         WHEN SQLCODE = -904                                      05580023
055400             CONTINUE                                             05590023
055500         WHEN SQLCODE  NOT = +0                                   05600023
055600              MOVE '1140-CLOSE-LOCATION-CSR'                      05610026
055700                     TO WS-PARAGRAPH-NAME                         05620023
055800              MOVE 'CLOSE LOCATION CURSOR'                        05630026
055900                     TO WS-DB2-OPERATION-ATTEMPTED                05640023
056000              PERFORM 9800-SQL-ABEND                              05650023
056100     END-EVALUATE.                                                05660023
056200     EJECT                                                        05670023
056300 2000-PRINT-THE-TABLE.                                            05680023
056400     EVALUATE TRUE                                                05690023
056500                                                                  05700023
056600         WHEN PV-CURR-DC  NOT EQUAL PV-PREV-DC                    05710023
056700             PERFORM 3300-PRINT-DETAIL-LINE                       05720023
056800             PERFORM 3150-PRINT-STORE-BREAK                       05730023
056900             PERFORM 3100-PRINT-DC-BREAK                          05740023
057000             INITIALIZE WS-PURCHASE-ORDER-TABLE                   05750023
057100             MOVE PV-CURR-PRINT-STORE-NUM                         05760023
057200                                   TO PV-PREV-PRINT-STORE-NUM     05770023
057300             MOVE PV-CURR-PRINT-STORE-DSC                         05780023
057400                                   TO PV-PREV-PRINT-STORE-DSC     05790023
057500             MOVE PV-CURR-PRINT-DC TO PV-PREV-PRINT-DC            05800023
057600                                                                  05810023
057700         WHEN PV-CURR-OPER-UNT-ID  NOT EQUAL PV-PREV-OPER-UNT-ID  05820023
057800             PERFORM 3300-PRINT-DETAIL-LINE                       05830023
057900             PERFORM 3150-PRINT-STORE-BREAK                       05840023
058000             PERFORM 3100-PRINT-DC-BREAK                          05850023
058100             INITIALIZE WS-PURCHASE-ORDER-TABLE                   05860023
058200             MOVE PV-CURR-PRINT-STORE-NUM                         05870023
058300                                   TO PV-PREV-PRINT-STORE-NUM     05880023
058400             MOVE PV-CURR-PRINT-STORE-DSC                         05890023
058500                                   TO PV-PREV-PRINT-STORE-DSC     05900023
058600             MOVE PV-CURR-PRINT-DC TO PV-PREV-PRINT-DC            05910023
058700                                                                  05920023
058800         WHEN PV-CURR-STORE NOT EQUAL PV-PREV-STORE               05930023
058900             PERFORM 3300-PRINT-DETAIL-LINE                       05940023
059000             PERFORM 3150-PRINT-STORE-BREAK                       05950023
059100             INITIALIZE WS-PURCHASE-ORDER-TABLE                   05960023
059200             MOVE PV-CURR-PRINT-STORE-NUM                         05970023
059300                                   TO PV-PREV-PRINT-STORE-NUM     05980023
059400             MOVE PV-CURR-PRINT-STORE-DSC                         05990023
059500                                   TO PV-PREV-PRINT-STORE-DSC     06000023
059600                                                                  06010023
059700         WHEN OTHER                                               06020023
059800             PERFORM 3300-PRINT-DETAIL-LINE                       06030023
059900             INITIALIZE WS-PURCHASE-ORDER-TABLE                   06040023
060000     END-EVALUATE.                                                06050023
060100     SKIP1                                                        06060023
060200     SET PS-TABLE-SEARCH           TO TRUE.                       06070023
060300     MOVE PV-CURRENT-KEY           TO PV-PREVIOUS-KEY.            06080023
060400     PERFORM 2500-FILL-PO-TABLE                                   06090023
060500         UNTIL PV-CURR-PO-SEQ > PV-PREV-PO-SEQ OR                 06100023
060600               PS-NO-MORE-SKUS.                                   06110023
060700     EJECT                                                        06120023
060800 2500-FILL-PO-TABLE.                                              06130023
060900     PERFORM VARYING POT-IDX FROM 1 BY 1                          06140023
061000             UNTIL POT-IDX > 1000  OR                             06150023
061100             PS-TABLE-DONE                                        06160023
061200        EVALUATE TRUE                                             06170023
061300          WHEN POT-SRC-KEY (POT-IDX) = PV-CURRENT-KEY             06180023
061400               PERFORM 3200-ADD-TO-CONTROL                        06190023
061500               SET PS-TABLE-DONE TO TRUE                          06200023
061600          WHEN POT-SRC-KEY (POT-IDX) = SPACES                     06210023
061700               PERFORM 3200-ADD-TO-CONTROL                        06220023
061800               PERFORM 3000-LOAD-FULL-PRT-LINE                    06230023
061900               MOVE DL-DETAIL-LINE TO POT-PRINT-LINE (POT-IDX)    06240023
062000               MOVE PV-CURRENT-KEY TO POT-SRC-KEY (POT-IDX)       06250023
062100               SET PS-TABLE-DONE TO TRUE                          06260023
062200        END-EVALUATE                                              06270023
062300     END-PERFORM.                                                 06280023
062400     SET PS-TABLE-SEARCH         TO TRUE.                         06290023
062500     PERFORM 7000-GET-ADJUSTMENT-RECORD.                          06300023
062600     EJECT                                                        06310023
062700 3000-LOAD-FULL-PRT-LINE.                                         06320023
062800     MOVE SPACES                   TO DL-DETAIL-LINE.             06330023
1022RM     MOVE PV-PREV-PRINT-STORE-NUM  TO DL-DC-LOC.                  08580023
062900     MOVE SE-PO                    TO DL-PO-NBR.                  06340023
063000     MOVE SE-REC-SEQ-NBR(7:3)      TO DL-RECEIVER-NBR.            06350023
063100     MOVE PC-DASH                  TO DL-PO-DASH-1.               06360023
063200     MOVE SE-VENDOR-NAME-DUNNS     TO DL-VENDOR-NAME-DUNN.        06370023
063300     MOVE SE-POLINENO              TO DL-PO-LINE-NBR.             06380023
063400     MOVE SE-SKU-NBR               TO DL-SKU.                     06390025
063500     MOVE SE-DEPT                  TO DL-SKU-DEPT.                06391025
063600     MOVE SE-CLASS                 TO DL-SKU-CLASS.               06400025
064000     MOVE SE-DV-MM                 TO DL-VA-MM.                   06440023
064100     MOVE SE-DV-DD                 TO DL-VA-DD.                   06450023
064200     IF  SE-DV-YY > 90                                            06460023
064300         MOVE '19'                 TO DL-VA-CC                    06470023
064400     ELSE                                                         06480023
064500         MOVE '20'                 TO DL-VA-CC                    06490023
064600     END-IF.                                                      06500023
064700     MOVE SE-DV-YY                 TO DL-VA-YY.                   06510023
064800     MOVE PC-SLASH                 TO DL-VA-SLASH-1               06520023
064900                                      DL-VA-SLASH-2.              06530023
065000     MOVE SE-PROCESSING-AREA6     TO  DL-PROCESS-AREA.            06540023
065100     EVALUATE SE-REC-SRC-CDE                                      06550023
065200       WHEN 'R'                                                   06560023
065300            MOVE SPACES         TO DL-TRAN-TYPE                   06570023
065400       WHEN LOW-VALUES                                            06580023
065500            MOVE SPACES         TO DL-TRAN-TYPE                   06590023
065600       WHEN 'A'                                                   06600023
065700            MOVE '*ADJ*'        TO DL-TRAN-TYPE                   06610023
065800     END-EVALUATE.                                                06620023
065900     EJECT                                                        06630023
066000                                                                  06630123
066100 3010-GET-OPER-UNIT.                                              06630204
066200******************************************************************06630323
066300*  GET THE DC DESCRIPTION.                                        06630423
066400******************************************************************06630523
066500                                                                  06630604
066600     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.                 
066700                                                                        07
066800     EVALUATE TRUE                                                        
066900         WHEN XL071-NO-ERRORS                                             
067000         WHEN XL071-LOC-NOT-FOUND                                       07
067100         WHEN XL071-DC-ASGMT-NOT-FND                                    07
067200             CONTINUE                                                   07
067300         WHEN XL071-BAD-DB2-RETURN                                        
067400             DISPLAY '** ABEND ** IN RVKRP011'                    06633023
067500             MOVE '3010-GET-OPER-UNIT      '                      06634023
067600                     TO WS-PARAGRAPH-NAME                         06635023
067700              MOVE 'SELECT             '                          06636023
067800                     TO WS-DB2-OPERATION-ATTEMPTED                06637023
067900             MOVE XL071-SQLCA             TO SQLCA                      07
068000             PERFORM 9800-SQL-ABEND                                     11
068100     END-EVALUATE.                                                      07
068200                                                                  06631404
068300                                                                  06637323
068400 3100-PRINT-DC-BREAK.                                             06637423
068500     MOVE PV-DC-QUANTITY        TO DL-TOTAL-QUANTITY.             06637523
068600     MOVE PV-DC-EXTD-RTL-AMT    TO DL-TOTAL-EXT-RETAIL.           06637623
068700     PERFORM 8125-WRITE-DC-TOTAL-LINE.                            06637723
068800     ADD  PV-DC-QUANTITY        TO PV-CO-QUANTITY.                06637823
068900     ADD  PV-DC-EXTD-RTL-AMT    TO PV-CO-EXTD-RTL-AMT.            06637923
069000     MOVE  ZEROS                TO PV-DC-QUANTITY                 06638023
069100                                   PV-DC-EXTD-RTL-AMT.            06639023
069200     MOVE  ZEROS                TO PV-PAGE-COUNT.                 06640023
069300     MOVE  +84                  TO PV-LINES-CNT.                  06650023
069400     MOVE  ZEROS                TO PV-READ-CNT.                   06660023
069500     EJECT                                                        06670023
069600 3150-PRINT-STORE-BREAK.                                          06680023
069700     MOVE PV-STORE-QUANTITY     TO TL3-TOTAL-QUANTITY.            06690023
069800     MOVE PV-STORE-EXTD-RTL-AMT TO TL3-TOTAL-EXT-RETAIL.          06700023
069900     PERFORM 8130-WRITE-STORE-TOTAL-LINE.                         06710023
070000     ADD  PV-STORE-QUANTITY     TO PV-DC-QUANTITY.                06720023
070100     ADD  PV-STORE-EXTD-RTL-AMT TO PV-DC-EXTD-RTL-AMT.            06730023
070200     MOVE  ZEROS                TO PV-STORE-QUANTITY              06740023
070300                                   PV-STORE-EXTD-RTL-AMT.         06750023
070400     MOVE  ZEROS                TO PV-PAGE-COUNT.                 06760023
070500                                                                  06770023
070600     IF  PS-NO-MORE-SKUS                                          06780023
070700         CONTINUE                                                 06790023
070800     ELSE                                                         06800023
070900         IF  PV-CURR-DC = PV-PREV-DC                              06810023
071000         AND PV-CURR-OPER-UNT-ID = PV-PREV-OPER-UNT-ID            06820023
071100             MOVE +84               TO PV-LINES-CNT               06830023
071200         END-IF                                                   06840023
071300     END-IF.                                                      06850023
071400     EJECT                                                        06860023
071500 3200-ADD-TO-CONTROL.                                             06870023
071600     ADD  SE-RETAIL-UNITS-MARK    TO POT-DET-QUANTITY (POT-IDX).  06880023
071700*    MOVE SE-UNIT-RETAIL      TO POT-DET-UNIT-RTL-AMT (POT-IDX).  06890023
071700     MOVE SE-LOWEST-RETAIL    TO POT-DET-UNIT-RTL-AMT (POT-IDX).  06890023
071800     EJECT                                                        06900023
071900 3300-PRINT-DETAIL-LINE.                                          06910023
072000     PERFORM                                                      06920023
072100             VARYING PRINT-IDX FROM 1 BY 1                        06930023
072200             UNTIL PRINT-IDX > 1000  OR                           06940023
072300                  (POT-SRC-KEY (PRINT-IDX) = SPACES)              06950023
072400        IF PRINT-IDX = 1                                          06960023
072500           MOVE '0'                TO PV-SPACE-CNTL               06970023
072600        ELSE                                                      06980023
072700           MOVE SPACES             TO PV-SPACE-CNTL               06990023
1022RM*- BUSINESS REQUESTED PO-RCV AND VENDOR NAME TO PRINT                     
1022RM*- ON EVERY LINE                                                          
1022RM*          MOVE SPACES             TO POT-PO-RCV (PRINT-IDX)      07000023
1022RM*                                     POT-VENDOR-NAME-DUNN        07010023
1022RM*                                         (PRINT-IDX)             07020023
073100        END-IF                                                    07030023
073200        MOVE POT-DET-QUANTITY (PRINT-IDX)                         07040023
073300                                      TO POT-QUANTITY (PRINT-IDX) 07050023
073400        MOVE POT-DET-UNIT-RTL-AMT (PRINT-IDX)                     07060023
073500                                      TO POT-UNIT-RTL-AMT         07070023
073600                                          (PRINT-IDX)             07080023
073700     SKIP1                                                        07090023
073800     COMPUTE POT-DET-EXTD-RTL-AMT (PRINT-IDX) =                   07100023
073900            (POT-DET-QUANTITY (PRINT-IDX) *                       07110023
074000                              POT-DET-UNIT-RTL-AMT (PRINT-IDX))   07120023
074100     MOVE POT-DET-EXTD-RTL-AMT (PRINT-IDX)  TO                    07130023
074200                              POT-EXTD-RTL-AMT (PRINT-IDX)        07140023
074300     PERFORM 8100-WRITE-STORE-SUMMARY-DTL                         07150023
074400     COMPUTE PV-STORE-QUANTITY =                                  07160023
074500            (PV-STORE-QUANTITY + POT-DET-QUANTITY (PRINT-IDX))    07170023
074600     COMPUTE PV-STORE-EXTD-RTL-AMT =                              07180023
074700            (PV-STORE-EXTD-RTL-AMT +                              07190023
074800                              POT-DET-EXTD-RTL-AMT (PRINT-IDX))   07200023
074900     END-PERFORM.                                                 07210023
075000     EJECT                                                        07220023
075100 4000-LOAD-CURRENT-KEY.                                           07230023
075200     MOVE SE-RECEIVING-LOCATION TO PV-CURR-DC.                    07240023
075300     MOVE SE-CURR-OPER-UNT-ID   TO PV-CURR-OPER-UNT-ID.           07250023
075400     MOVE SE-LOC-NBR            TO PV-CURR-STORE.                 07260026
075500     MOVE SE-PO                 TO PV-CURR-PO.                    07270023
075600     MOVE SE-REC-SEQ-NBR        TO PV-CURR-RECV-SEQ.              07280023
075700     MOVE SE-POLINENO           TO PV-CURR-LINE-NM.               07290023
075800     MOVE SE-REC-SRC-CDE        TO PV-CURR-SRC-CDE.               07300023
075900     EJECT                                                        07310023
076000 6000-GET-WEEK-END-DATE.                                          07320023
076100                                                                  07330023
076200     INITIALIZE DPG51                                             07340023
076300                DPG52                                             07350023
076400                DPG53                                             07360023
076500                DPG54                                             07370023
076600                DPG55                                             07380023
076700                DPG56.                                            07390023
076800                                                                  07400023
076900     MOVE SE-DV-MM               TO PV-RF-MM.                     07410023
077000     MOVE SE-DV-DD               TO PV-RF-DD.                     07420023
077100     IF  SE-DV-YY > 90                                            07430023
077200         MOVE '19'               TO PV-RF-CC                      07440023
077300     ELSE                                                         07450023
077400         MOVE '20'               TO PV-RF-CC                      07460023
077500     END-IF.                                                      07470023
077600     MOVE SE-DV-YY               TO PV-RF-YY.                     07480023
077700     MOVE PC-SLASH               TO PV-RF-SLASH-1                 07490023
077800                                    PV-RF-SLASH-2.                07500023
077900     MOVE PV-REFORMAT-DTE        TO DPG52-LK-DATE-INPUT.          07510023
078000     SET DPG51-ACTUAL-CALENDAR-ONLY                               07520023
078100         DPG51-DO-NOT-INCR-DECR-DATE                              07530023
078200         DPG52-LK-DTE-GREG-CC-FMT TO TRUE.                        07540023
078300                                                                  07550023
078400     CALL DP500-KOHLS-CALENDAR-ROUTINE                            07560023
078500                USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.        07570023
078600                                                                  07580023
078700     EVALUATE TRUE                                                07590023
078800         WHEN DPG54-SEVERE-ERROR                                  07600023
078900             DISPLAY '** ABEND **'                                07610023
079000             DISPLAY '** PGM = RVKRP011'                          07620023
079100             DISPLAY '** 6000-GET-WEEK-END-DATE.        '         07630023
079200             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '  07640023
079300             DISPLAY '** ERROR MESSAGE = '                        07650023
079400                     DPG54-ERROR-MESSAGE                          07660023
079500             DISPLAY '** DPG51 = ' DPG51                          07670023
079600             DISPLAY '** DPG52 = ' DPG52                          07680023
079700             DISPLAY '** DPG53 = ' DPG53                          07690023
079800             DISPLAY '** DPG54 = ' DPG54                          07700023
079900             MOVE +4003 TO ABEND-CODE                             07710023
080000             CALL 'ILBOABN0' USING ABEND-CODE                     07720023
080100         WHEN OTHER                                               07730023
080200             CONTINUE                                             07740023
080300     END-EVALUATE.                                                07750023
080400                                                                  07760023
080500     IF DPG54-DATE-VALID                                          07770023
080600         MOVE DPG55-LAST-WKDY-GREG-CC-MO TO PV-RF-MM              07780023
080700         MOVE DPG55-LAST-WKDY-GREG-CC-DY TO PV-RF-DD              07790023
080800         MOVE DPG55-LAST-WKDY-GREG-CC-YR TO PV-RF-CCYY            07800023
080900         MOVE PC-SLASH                   TO PV-RF-SLASH-1         07810023
081000                                            PV-RF-SLASH-2         07820023
081100         MOVE PV-REFORMAT-DTE            TO HL1-HL2-WK-END        07830023
081200     END-IF.                                                      07840023
081300     EJECT                                                        07850023
081400 7000-GET-ADJUSTMENT-RECORD.                                      07860023
081500***************************************************************** 07870023
081600*  CONTROL THE READ SO THAT IT SELECTS EITHER A VALID RECORD    * 07880023
081700*  TO BE REPORTED ON OR REACHES THE END OF FILE.                * 07890023
081800***************************************************************** 07900023
081900     SET PS-IS-NOT-A-RTV-RECORD TO TRUE.                          07910023
082000                                                                  07920023
082100     PERFORM 7100-READ-ADJUSTMENT-RECORD                          07930023
082200       UNTIL PS-NO-MORE-SKUS                                      07940023
082300          OR PS-IS-A-RTV-RECORD.                                  07950023
082400     EJECT                                                        07960023
082500 7100-READ-ADJUSTMENT-RECORD.                                     07970023
082600***************************************************************** 07980023
082700*  READ THE STYLE SUMMARY EXTRACT RECORDS.                      * 07990023
082800***************************************************************** 08000023
082900     READ ADJUSTMENT-EXTRACT                                      08010023
083000          INTO STORE-EXTRACT-LINE                                 08020023
083100         AT END                                                   08030023
083200              SET PS-NO-MORE-SKUS TO TRUE                         08040023
083300     END-READ.                                                    08050023
083400                                                                  08060023
083500     IF  PS-NO-MORE-SKUS                                          08070023
083600         CONTINUE                                                 08080023
083700     ELSE                                                         08090023
083800         SET RTV-IDX TO +1                                        08100023
083900         PERFORM 7200-SEARCH-RTV-TABLE                            08110023
084000         IF  PS-IS-A-RTV-RECORD                                   08120023
084100             ADD +1   TO  PV-READ-CNT                             08130023
084200             MOVE PV-CURRENT-KEY   TO PV-PREVIOUS-KEY             08140023
084300             PERFORM 4000-LOAD-CURRENT-KEY                        08150023
084400         END-IF                                                   08160023
084500     END-IF.                                                      08170023
084600     EJECT                                                        08180023
084700 7200-SEARCH-RTV-TABLE.                                           08190023
084800     SEARCH RTV-TABLE                                             08200023
084900       VARYING RTV-IDX                                            08210023
085000         AT END                                                   08220023
085100             SET PS-IS-NOT-A-RTV-RECORD TO TRUE                   08230023
085200         WHEN RTV-NMBR (RTV-IDX) = SE-LOC-NBR                     08240026
085300             SET PS-IS-A-RTV-RECORD   TO TRUE                     08250023
085400             MOVE RTV-NMBR (RTV-IDX)  TO PV-CURR-PRINT-STORE-NUM  08260023
085500             MOVE RTV-DESC-CHAR10 (RTV-IDX)                       08270023
085600                                      TO PV-CURR-PRINT-STORE-DSC  08280023
085700             MOVE SE-RECEIVING-LOCATION                           08290023
085800                                      TO PV-CURR-PRINT-DC         08300023
085900     END-SEARCH.                                                  08310023
086000     EJECT                                                        08320023
086100 8000-WRITE-PAGE-HEADINGS.                                        08330023
086200***************************************************************** 08340023
086300*  PRINT THE HEADINGS ON EACH PAGE.  PUT A SEPARATOR PAGE       * 08350023
086400*  BETWEEN DEPARTMENT LISTINGS.                                 * 08360023
086500***************************************************************** 08370023
086600     ADD 1                         TO PV-PAGE-COUNT.              08380023
086700     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         08390023
086800*                                                                 08400023
086900     MOVE PC-HEADING-SIZE          TO PV-LINES-NEEDED             08410023
087000                                      PV-LINES-USED.              08420023
087100     SET PS-DONT-PRINT-BLANK-LINE  TO TRUE.                       08430023
087200*                                                                 08440023
087300     WRITE STORE-SUMMARY-REPORT-RECORD                            08450023
087400       FROM DP132O-STANDRD-HEADER-132-COLS                        08460023
087500         AFTER ADVANCING PAGE.                                    08470023
087600*                                                                 08480023
087700     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   08490023
087800     WRITE STORE-SUMMARY-REPORT-RECORD                            08500023
087900       FROM HL1-HEADING-LINE-1                                    08510023
088000         AFTER ADVANCING 2 LINE.                                  08520023
088100*                                                                 08530023
088200     WRITE STORE-SUMMARY-REPORT-RECORD                            08540023
088300       FROM HL1-HEADING-LINE-2                                    08550023
088400         AFTER ADVANCING 1 LINE.                                  08560023
088500*                                                                 08570023
088600     MOVE PV-PREV-PRINT-STORE-NUM    TO DH1-STORE-NUMBER          08580023
1022RM                                        DL-DC-LOC.                        
088700     MOVE PV-PREV-PRINT-STORE-DSC    TO DH1-STORE-CHAR10.         08590023
088800     SKIP1                                                        08600023
088900     EVALUATE TRUE                                                08610023
089000         WHEN PV-PREV-PRINT-DC = 'DS'                             08620023
089100              MOVE 'DIRECT SHIP'     TO DH1-DC-NAME               08630023
089200              MOVE ZEROS             TO DH1-STORE-NUMBER          08640023
089300              MOVE SPACES            TO DH1-STORE-CHAR10          08650023
1022RM                                        DL-DC-LOC                         
089400         WHEN PV-PREV-PRINT-DC = 'CO'                             08660023
089500              MOVE 'CORPORATE'       TO DH1-DC-NAME               08670023
089600              MOVE ZEROS             TO DH1-STORE-NUMBER          08680023
089700              MOVE SPACES            TO DH1-STORE-CHAR10          08690023
1022RM                                        DL-DC-LOC                         
089800         WHEN PV-PREV-PRINT-DC = 'DC'                             08700023
089900              MOVE PV-PREV-OPER-UNT-ID   TO XL071-LOCATION-NUMBER 08710023
090000              PERFORM 3010-GET-OPER-UNIT                          08720023
090100              MOVE XL071-LOC-NM      TO DH1-DC-NAME               08730023
090200         WHEN PS-NO-MORE-SKUS                                     08740023
090300              MOVE PV-CURR-PRINT-STORE-NUM    TO DH1-STORE-NUMBER 08750023
090400              MOVE PV-CURR-PRINT-STORE-DSC    TO DH1-STORE-CHAR10 08760023
090500              MOVE PV-CURR-OPER-UNT-ID   TO XL071-LOCATION-NUMBER 08770023
090600              PERFORM 3010-GET-OPER-UNIT                          08780023
090700              MOVE XL071-LOC-NM      TO DH1-DC-NAME               08790023
090800         WHEN OTHER                                               08800023
090900              MOVE '          '      TO DH1-DC-NAME               08810023
091000              MOVE ZEROS             TO DH1-STORE-NUMBER          08820023
091100              MOVE SPACES            TO DH1-STORE-CHAR10          08830023
091200     END-EVALUATE.                                                08840023
091300      SKIP1                                                       08850023
091400     WRITE STORE-SUMMARY-REPORT-RECORD                            08860023
091500       FROM DH1-DETAIL-HEADING-LINE-1                             08870023
091600         AFTER ADVANCING 1 LINES.                                 08880023
091700     SKIP1                                                        08890023
091800     WRITE STORE-SUMMARY-REPORT-RECORD                            08900023
091900       FROM DH1-DETAIL-HEADING-LINE-2                             08910023
092000         AFTER ADVANCING 2 LINES.                                 08920023
092100     SKIP1                                                        08930023
092200     WRITE STORE-SUMMARY-REPORT-RECORD                            08940023
092300       FROM DH2-DETAIL-HEADING-LINE-2                             08950023
092400         AFTER ADVANCING 2 LINES.                                 08960023
092500*                                                                 08970023
092600     WRITE STORE-SUMMARY-REPORT-RECORD                            08980023
092700       FROM DH3-DETAIL-HEADING-LINE-3                             08990023
092800         AFTER ADVANCING 1 LINES.                                 09000023
092900*                                                                 09010023
1022RM*    WRITE STORE-SUMMARY-REPORT-RECORD                            09020023
1022RM*      FROM PV-BLANK-LINE                                         09030023
1022RM*        AFTER ADVANCING 1 LINES.                                 09040023
093300     SKIP1                                                        09050023
           MOVE +10            TO PV-LINES-CNT.                         09060023
093500     EJECT                                                        09070023
093600 8100-WRITE-STORE-SUMMARY-DTL.                                    09080023
093700******************************************************************09090023
093800*  WRITE THE STYLE SUMMARY DETAIL RECORD.                         09100023
093900******************************************************************09110023
094000     IF PS-NO-MORE-SKUS AND PV-CURR-PO-SEQ = PV-PREV-PO-SEQ       09120023
094100         NEXT SENTENCE                                            09130023
094200     ELSE                                                         09140023
094300     IF PS-NO-MORE-SKUS                                           09150023
094400         MOVE +84               TO PV-LINES-CNT.                  09160023
094500     IF PV-LINES-CNT  > PC-MAX-PAGE-SIZE                          09170023
094600        PERFORM 8000-WRITE-PAGE-HEADINGS                          09180023
094700     END-IF.                                                      09190023
094800                                                                  09200023
094900     EVALUATE PV-SPACE-CNTL                                       09210023
095000        WHEN SPACES                                               09220023
095100         WRITE STORE-SUMMARY-REPORT-RECORD                        09230023
095200             FROM POT-PRINT-LINE (PRINT-IDX)                      09240023
095300                 AFTER ADVANCING 1 LINE                           09250023
095400             ADD 1 TO PV-LINES-CNT                                09260023
095500        WHEN '0'                                                  09270023
095600         WRITE STORE-SUMMARY-REPORT-RECORD                        09280023
095700             FROM POT-PRINT-LINE (PRINT-IDX)                      09290023
095800                 AFTER ADVANCING 2 LINE                           09300023
095900             ADD 2 TO PV-LINES-CNT                                09310023
096000        WHEN '3'                                                  09320023
096100         WRITE STORE-SUMMARY-REPORT-RECORD                        09330023
096200             FROM POT-PRINT-LINE (PRINT-IDX)                      09340023
096300                 AFTER ADVANCING 3 LINE                           09350023
096400             ADD 3 TO PV-LINES-CNT                                09360023
096500     END-EVALUATE.                                                09370023
096600     EJECT                                                        09380023
096700 8125-WRITE-DC-TOTAL-LINE.                                        09390023
096800******************************************************************09400023
096900*  WRITE THE STYLE SUMMARY DETAIL RECORD.                         09410023
097000******************************************************************09420023
097100     IF PV-LINES-CNT  > PC-MAX-PAGE-SIZE                          09430023
097200        PERFORM 8000-WRITE-PAGE-HEADINGS                          09440023
097300     END-IF.                                                      09450023
097400                                                                  09460023
097500     WRITE STORE-SUMMARY-REPORT-RECORD                            09470023
097600         FROM DL-TOTAL-LINE-1                                     09480023
097700             AFTER ADVANCING 2 LINE.                              09490023
097800                                                                  09500023
097900     ADD 2 TO PV-LINES-CNT.                                       09510023
098000     EJECT                                                        09520023
098100 8130-WRITE-STORE-TOTAL-LINE.                                     09530023
098200******************************************************************09540023
098300*  WRITE THE STYLE SUMMARY DETAIL RECORD.                         09550023
098400******************************************************************09560023
098500     IF PV-LINES-CNT  > PC-MAX-PAGE-SIZE                          09570023
098600        PERFORM 8000-WRITE-PAGE-HEADINGS                          09580023
098700     END-IF.                                                      09590023
098800                                                                  09600023
098900     WRITE STORE-SUMMARY-REPORT-RECORD                            09610023
099000         FROM DL-TOTAL-LINE-3                                     09620023
099100             AFTER ADVANCING 2 LINE.                              09630023
099200                                                                  09640023
099300     ADD 2 TO PV-LINES-CNT.                                       09650023
099400     EJECT                                                        09660023
099500 8150-WRITE-CO-TOTAL-LINE.                                        09670023
099600******************************************************************09680023
099700*  WRITE THE FINAL TOTAL LINE RECORD.                             09690023
099800******************************************************************09700023
099900     IF PV-LINES-CNT  > PC-MAX-PAGE-SIZE                          09710023
100000        MOVE SPACES            TO DH1-DC-NAME                     09720023
100100        PERFORM 8000-WRITE-PAGE-HEADINGS                          09730023
100200     END-IF.                                                      09740023
100300                                                                  09750023
100400     WRITE STORE-SUMMARY-REPORT-RECORD                            09760023
100500         FROM DL-TOTAL-LINE-2                                     09770023
100600             AFTER ADVANCING 2 LINE.                              09780023
100700                                                                  09790023
100800     ADD 2 TO PV-LINES-CNT.                                       09800023
100900     EJECT                                                        09810023
101000 8200-NO-INPUT-ROUTINE.                                           09820023
101100     ADD 1                         TO PV-PAGE-COUNT.              09830023
101200     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         09840023
101300     SKIP1                                                        09850023
101400     WRITE STORE-SUMMARY-REPORT-RECORD                            09860023
101500       FROM DP132O-STANDRD-HEADER-132-COLS                        09870023
101600         AFTER ADVANCING PAGE.                                    09880023
101700     SKIP1                                                        09890023
101800     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   09900023
101900     WRITE STORE-SUMMARY-REPORT-RECORD                            09910023
102000       FROM HL1-HEADING-LINE-1                                    09920023
102100         AFTER ADVANCING 2 LINE.                                  09930023
102200     SKIP1                                                        09940023
102300     WRITE STORE-SUMMARY-REPORT-RECORD                            09950023
102400       FROM ER-NO-INPUT-LINE                                      09960023
102500         AFTER ADVANCING 3 LINE.                                  09970023
102600     EJECT                                                        09980023
102700 9000-EOJ-ROUTINE.                                                09990023
102800******************************************************************10000023
102900*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  10010023
103000*  THE CURSOR.                                                    10020023
103100******************************************************************10030023
103200                                                                  10040023
103300     IF  PV-CO-QUANTITY > ZEROS                                   10050023
103400         MOVE PV-CO-QUANTITY TO                                   10060023
103500              TL2-TOTAL-QUANTITY                                  10070023
103600         MOVE PV-CO-EXTD-RTL-AMT TO                               10080023
103700              TL2-TOTAL-EXT-RETAIL                                10090023
103800         MOVE 'CO'  TO PV-PREV-PRINT-DC                           10100023
103900         PERFORM 8150-WRITE-CO-TOTAL-LINE                         10110023
104000     ELSE                                                         10120023
104100         NEXT SENTENCE                                            10130023
104200     END-IF.                                                      10140023
104300                                                                  10150023
104400     ADD 3 TO PV-LINES-NEEDED.                                    10160023
104500                                                                  10170023
104600     IF PV-LINES-NEEDED > PC-MAX-PAGE-SIZE                        10180023
104700        PERFORM 8000-WRITE-PAGE-HEADINGS                          10190023
104800     END-IF.                                                      10200023
104900                                                                  10210023
105000     WRITE STORE-SUMMARY-REPORT-RECORD                            10220023
105100         FROM DL-BLANK-LINE                                       10230023
105200             AFTER ADVANCING 2 LINES.                             10240023
105300                                                                  10250023
105400     WRITE STORE-SUMMARY-REPORT-RECORD                            10260023
105500         FROM ER-END-OF-REPORT-LINE                               10270023
105600             AFTER ADVANCING 2 LINES.                             10280023
105700                                                                  10290023
105800     CLOSE ADJUSTMENT-EXTRACT                                     10300023
105900           STORE-SUMMARY-REPORT.                                  10310023
106000******************************************************************10320023
106100* 9800-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      10330023
106200* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 10340023
106300******************************************************************10350023
106400 9800-SQL-ABEND.                                                  10360023
106500     DISPLAY '** ABEND     **'.                                   10370023
106600     DISPLAY '** PROGRAM   ** = RVKRP011'.                        10380023
106700     DISPLAY '** PARAGRAPH ** = ' WS-PARAGRAPH-NAME.              10390023
106800     DISPLAY '** OPERATION ** = ' WS-DB2-OPERATION-ATTEMPTED.     10400023
106900                                                                  10410023
107000******************************************************************10420023
107100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    10430023
107200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         10440023
107300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     10450023
107400* FORMAT.                                                         10460023
107500******************************************************************10470023
107600     COPY DPPD004.                                                10480026
107700                                                                  10490023
107800     MOVE +4013 TO ABEND-CODE.                                    10500023
107900     CALL 'ILBOABN0' USING ABEND-CODE.                            10510023
108000                                                                  10520023
108100*9800-EXIT.                                                       10530023
