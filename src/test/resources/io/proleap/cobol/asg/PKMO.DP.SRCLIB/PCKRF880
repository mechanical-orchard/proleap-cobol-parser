000100 IDENTIFICATION DIVISION.                                         00010001
000200******************************************************************00020001
000300 PROGRAM-ID.             PCKRF880.                                00030001
000400 AUTHOR.                 PATRICK BURKE.                           00040001
000500 INSTALLATION.           KOHLS.                                   00050001
000600 DATE-WRITTEN.           APRIL 2001.                              00060001
000700 DATE-COMPILED.                                                   00070001
000800******************************************************************00080001
000900* THIS PROGRAM ALLOWS AN ASSOCIATE TO SCAN/KEY ANY BARCODE AND    00090001
001000* DISPLAY THE CURRENT STATUS ABOUT THE PARTICULAR CONTAINER       00100001
001100******************************************************************00110001
001200 ENVIRONMENT DIVISION.                                            00120001
001300 DATA DIVISION.                                                   00130001
001400******************************************************************00140001
001500 WORKING-STORAGE SECTION.                                         00150001
001600******************************************************************00160001
001700 01  DK-DB2-KEYS.                                                 00170001
001800     05  DK-CARTON-ID               PIC S9(18) COMP-3             00180001
001900                                               VALUE ZERO.        00190001
002000     05  DK-CARTON-ID-XREF          PIC S9(18) COMP-3             00200001
002100                                               VALUE ZERO.        00210001
002200     05  DK-SHIPT-UNT-ID-LOC        PIC S9(18) COMP-3             00220001
002300                                               VALUE ZERO.        00230001
002400     05  DK-SHIPT-UNT-ID            PIC S9(18)V COMP-3            00240001
002500                                               VALUE ZERO.        00250001
002600     05  DK-CARTON-ID-2             PIC  X(22) VALUE SPACES.      00260001
002700     05  DK-CARTON-ID-2-R  REDEFINES  DK-CARTON-ID-2.             00270001
002800         10  DK-CRTNID2-01-02       PIC  9(02).                   00280001
002900         10  DK-CRTNID2-03-20       PIC  9(18).                   00290001
003000         10  DK-CRTNID2-21-22       PIC  X(02).                   00300001
003100                                                                  00310001
003200 01  PC-PROGRAM-CONSTANTS.                                        00320001
003300     05  PC-TRANID                  PIC X(04)  VALUE 'E880'.      00330001
003400     05  PC-LOGON-TRAN-ID           PIC X(04)  VALUE 'Z028'.      00340001
003500                                                                  00350001
003600     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'PCKRF880'.  00360001
003700     05  PC-MANIFEST-NBR-MODULE     PIC X(08)  VALUE 'PCKCS721'.  00370001
003800     05  PC-SHIPPING-MENU-PGM       PIC X(08)  VALUE 'PCKRF868'.  00380001
003900     05  PC-CARTON-FUNCTN-PGM       PIC X(08)  VALUE 'PCKRF884'.  00390001
004000     05  PC-CARTON-DIVERT-PGM       PIC X(08)  VALUE 'PCKRF887'.  00400001
004100     05  PC-HELP-SCREEN             PIC X(08)  VALUE 'PCKRF278'.  00410001
004200     05  PC-CARTONS-LAST-ACTIVITY   PIC X(08)  VALUE 'PCKRF881'.  00420001
004300                                                                  00430001
004400     05  PC-0                            PIC  X(01)  VALUE '0'.   00440001
004500     05  PC-3                            PIC  X(01)  VALUE '3'.   00450027
004600     05  PC-4                            PIC  X(01)  VALUE '4'.   00460001
004700     05  PC-5                            PIC  X(01)  VALUE '5'.   00470003
004800     05  PC-6                            PIC  X(01)  VALUE '6'.   00480024
004900     05  PC-7                            PIC  X(01)  VALUE '7'.   00490024
005000     05  PC-18                           PIC S9(04)  VALUE 18.    00500001
005100     05  PC-20                           PIC S9(04)  VALUE 20     00510001
005200                                                     COMP SYNC.   00520001
005300                                                                  00530001
005400* ERROR MESSAGES                                                 *00540001
005500 01  PM-PROGRAM-MESSAGES.                                         00550001
005600     05  PM-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00560001
005700                                           'UNRECOGNIZED PF KEY'. 00570001
005800     05  PM-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00580001
005900                                           'ENTER THROUGH MENU '. 00590001
006000     05  PM-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00600001
006100                                           'TRANS NOT AVAILABLE'. 00610001
006200                                                                  00620001
006300 01  PS-PROGRAM-SWITCHES.                                         00630001
006400     05  PS-NO-REC-FOUND-SW           PIC  X(01)  VALUE 'Y'.      00640001
006500         88  PS-NO-REC-FOUND                      VALUE 'N'.      00650001
006600         88  PS-REC-FOUND                         VALUE 'Y'.      00660001
006700     05  PS-ERROR-SW                  PIC  X(01)  VALUE 'N'.      00670001
006800         88  PS-ERRORS-YES                        VALUE 'Y'.      00680001
006900         88  PS-ERRORS-NO                         VALUE 'N'.      00690001
007000     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'Y'.      00700001
007100         88  PS-VALID-INPUT                       VALUE 'Y'.      00710001
007200         88  PS-INVALID-INPUT                     VALUE 'N'.      00720001
007300     05  PS-INITIALIZE-SCREEN-SW      PIC  X(01)  VALUE 'N'.      00730001
007400         88  PS-INITIALIZE-SCREEN                 VALUE 'Y'.      00740001
007500         88  PS-PROCESS-SCREEN                    VALUE 'N'.      00750001
007600     05  PS-KOHLS-BARCODE-SW          PIC X(01)   VALUE 'N'.      00760001
007700         88  PS-KOHLS-BARCODE                     VALUE 'Y'.      00770001
007800         88  PS-NOT-KOHLS-BARCODE                 VALUE 'N'.      00780001
007900     05  PS-CHECK-DIGIT-IND              PIC  X(01)  VALUE 'N'.   00790001
008000         88  PS-VALID-CHECK-DIGIT                    VALUE 'Y'.   00800001
008100         88  PS-INVALID-CHECK-DIGIT                  VALUE 'N'.   00810001
008200     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00820001
008300         88  PS-XCTL-E881                         VALUE 'E881'.   00830001
008400     05  PS-OTBND-LOC-FOUND-SW           PIC  X(01)  VALUE 'N'.   00840001
008500         88  PS-OTBND-LOC-FOUND                      VALUE 'Y'.   00850001
008600         88  PS-OTBND-LOC-NOT-FOUND                  VALUE 'N'.   00860001
008700                                                                  00870001
008800*----------------------------------------------------------------*00880001
008900*  PROGRAM VARIABLES                                             *00890001
009000*----------------------------------------------------------------*00900001
009100 01  PV-PROGRAM-VARIABLES.                                        00910001
009200     05  PV-SYSID                     PIC  X(04)  VALUE SPACE.    00920001
009300     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   00930001
009400                                                     COMP.        00940001
009500     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   00950001
009600                                                     COMP SYNC.   00960001
009700                                                                  00970029
009800     05  PV-BARCODE                   PIC X(20).                  00980001
009900     05  PV-BARCODE-R REDEFINES PV-BARCODE.                       00990001
010000         10  PV-BARCODE-1-2           PIC 9(02).                  01000001
010100         10  PV-BARCODE-3-20          PIC 9(18).                  01010001
010200     05  PV-BARCODE-22                PIC X(22).                  01020001
010300     05  PV-BARCODE-R22 REDEFINES PV-BARCODE-22.                  01030001
010400         10  PV-BARCODE-22-1-2        PIC 9(02).                  01040001
010500         10  PV-BARCODE-22-3-20       PIC 9(18).                  01050001
010600         10  PV-BARCODE-22-22-2       PIC 9(02).                  01060001
010700                                                                  01070029
010800     05  PV-CARTON-ID                 PIC X(22).                  01080007
010900     05  PV-CARTON-ID-ENTERED         PIC S9(18)V  COMP-3.        01090001
011000     05  PV-SOURCE-ID                 PIC X(03).                  01100001
011100     05  PV-STATUS                    PIC X(02).                  01110001
011200                                                                  01120001
011300     05  PV-TMST                      PIC X(26).                  01130001
011400     05  PV-CHAR-COUNT                PIC S9(04)  VALUE ZEROS     01140001
011500                                                 COMP SYNC.       01150001
011600     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  01160001
011700                                                     COMP SYNC.   01170001
011800     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 01180001
011900     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 01190001
012000     05  PV-TOTAL                        PIC  9(04).              01200001
012100     05  FILLER REDEFINES PV-TOTAL.                               01210001
012200         10  FILLER                      PIC  9(03).              01220001
012300         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              01230001
012400     05  PV-CHECK-DIGIT                  PIC  9(01).              01240001
012500     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    01250001
012600                                                     COMP SYNC.   01260001
012700     05  PV-RBA                          PIC S9(08)  VALUE +0     01270001
012800                                                     COMP SYNC.   01280001
012900     05  PV-9999-9                       PIC  9(04)  VALUE 0000.  01290001
013000     05  PV-9999-X REDEFINES PV-9999-9.                           01300001
013100         10  PV-9999-1-2                 PIC  X(02).              01310001
013200         10  PV-9999-3-4                 PIC  X(02).              01320001
013300     05  PV-CTN-X                        PIC  X(18).              01330001
013400     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              01340001
013500     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          01350001
013600         10  PV-CTN-9-1                  PIC  9(01).              01360001
013700         10  PV-CTN-9-2                  PIC  9(01).              01370001
013800         10  PV-CTN-9-3                  PIC  9(01).              01380001
013900         10  PV-CTN-9-4                  PIC  9(01).              01390001
014000         10  PV-CTN-9-5                  PIC  9(01).              01400001
014100         10  PV-CTN-9-6                  PIC  9(01).              01410001
014200         10  PV-CTN-9-7                  PIC  9(01).              01420001
014300         10  PV-CTN-9-8                  PIC  9(01).              01430001
014400         10  PV-CTN-9-9                  PIC  9(01).              01440001
014500         10  PV-CTN-9-10                 PIC  9(01).              01450001
014600         10  PV-CTN-9-11                 PIC  9(01).              01460001
014700         10  PV-CTN-9-12                 PIC  9(01).              01470001
014800         10  PV-CTN-9-13                 PIC  9(01).              01480001
014900         10  PV-CTN-9-14                 PIC  9(01).              01490001
015000         10  PV-CTN-9-15                 PIC  9(01).              01500001
015100         10  PV-CTN-9-16                 PIC  9(01).              01510001
015200         10  PV-CTN-9-17                 PIC  9(01).              01520001
015300         10  PV-CTN-9-18                 PIC  9(01).              01530001
015400     05  PV-128-CARTON.                                           01540001
015500         10  PV-128-CARTON-13            PIC  9(13).              01550001
015600         10  PV-128-CARTON-5             PIC  9(05).              01560001
015700         10  PV-CTN.                                              01570001
015800             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              01580001
015900             15  PV-CTN-LAST-17          PIC  X(17).              01590001
016000             15  PV-CTN-FILLER           PIC  X(02).              01600001
016100         10  FILLER REDEFINES PV-CTN.                             01610001
016200             15  PV-CTN-SCAN-00          PIC  X(02).              01620001
016300             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              01630001
016400             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              01640001
016500         10  FILLER REDEFINES PV-CTN.                             01650001
016600             15  PV-CTN-SCAN-00          PIC  X(02).              01660001
016700             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              01670001
016800                                                                  01680001
016900     05  PV-SUB                       PIC S9(4) COMP              01690001
017000                                                VALUE ZERO.       01700001
017100                                                                  01710001
017200     05  PV-NULL-IND                  PIC S9(4)   VALUE ZERO      01720001
017300                                                     COMP SYNC.   01730001
017400     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        01740001
017500                                                     COMP SYNC.   01750001
017600     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    01760001
017700     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     01770001
017800                                                     COMP SYNC.   01780001
017900     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    01790001
018000     05  PV-MANIFEST-START            PIC S9(9) COMP-3.           01800001
018100     05  PV-MANIFEST-END              PIC S9(9) COMP-3.           01810001
018200     05  PV-OTBND-LOC-DATE            PIC X(10).                  01820001
018300     05  PV-OTBND-LOC-TIME            PIC X(08).                  01830001
018400     05  PV-DISPLAY-SHIPT-UNT-ID      PIC 9(18) VALUE ZEROS.      01840001
018500 01  PV-LOG-MSG.                                                  01850001
018600     05  FILLER                       PIC X(12) VALUE             01860001
018700         ' E880 ERROR '.                                          01870001
018800     05  FILLER                       PIC X(09) VALUE             01880001
018900         'SQLCODE= '.                                             01890001
019000     05  PV-SQLCODE                   PIC -9(03).                 01900001
019100     05  FILLER                       PIC X(06) VALUE             01910001
019200         ' ERR= '.                                                01920001
019300     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01930001
019400     05  FILLER                       PIC X(07) VALUE             01940001
019500         ' FAST= '.                                               01950001
019600     05  PV-DISPLAY-FAST              PIC X(14) VALUE ZEROES.     01960012
019700     05  FILLER                       PIC X(05) VALUE             01970001
019800         ' PO= '.                                                 01980001
019900     05  PV-DISPLAY-PO                PIC 9(09) VALUE ZEROES.     01990001
020000     05  FILLER                       PIC X(07) VALUE             02000001
020100         ' RCVR= '.                                               02010001
020200     05  PV-DISPLAY-RCVR              PIC 9(04) VALUE ZEROES.     02020001
020300     05  FILLER                       PIC X(07) VALUE             02030001
020400         ' LINE= '.                                               02040001
020500     05  PV-DISPLAY-PO-LNE-NBR        PIC 9(04) VALUE ZEROES.     02050001
020600     05  FILLER                       PIC X(06) VALUE             02060001
020700         ' STR= '.                                                02070001
020800     05  PV-DISPLAY-STORE             PIC 9(04) VALUE ZEROES.     02080001
020900                                                                  02090001
021000 01  PV-EDITING-FIELDS.                                           02100001
021100     05  PV-PROGRAM-DATA.                                         02110001
022100                                                                  02210001
022200         10  PV-PO-LINE-N                  PIC 9(09).             02220001
022300         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 02230001
022400             15 FILLER                     PIC X(05).             02240001
022500             15 PV-PO-LINE-OUT             PIC X(04).             02250001
022600                                                                  02260001
022700         10  PV-PO-LINE-LBL.                                      02270001
022800             15  PV-LINE-LBL-1           PIC 9(01).               02280001
022900             15  PV-LINE-LBL-3           PIC 9(03).               02290001
023000                                                                  02300001
023200 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  02320001
023300     05  TS-INFO-QUEUE-NAME.                                      02330001
023400         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 02340001
023500         10  FILLER                      PIC  X(04)  VALUE 'INFO'.02350001
023600                                                                  02360001
023700* COMMAREA FOR PCRF88X SCREENS                                    02370029
023800 01  CA-COMMAREA.                                                 02380001
023900     COPY PCWS038.                                                02390001
024000   02 CA-PC233.                                                   02400001
024100     COPY PCWS233.                                                02410001
024200   02  CA-COMMAREA-SW           PIC X(1).                         02420001
024300       88  CA-USE-PCWS233-COMMAREA    VALUE 'A'.                  02430001
024400       88  CA-USE-PCWS038-COMMAREA    VALUE 'B'.                  02440001
024500   02  CA-LAST-PROGRAM          PIC X(8).                         02450001
024600       88  CA-LAST-PROG-PCKRF868      VALUE 'PCKRF868'.           02460001
024700       88  CA-LAST-PROG-PCKRF884      VALUE 'PCKRF884'.           02470001
024800                                                                  02480001
024900*  RF SCREEN ERROR MESSAGES                                       02490001
025000     COPY PCWS034.                                                02500001
025100                                                                  02510001
025200*  TEMPORARY STORAGE QUEUE LAYOUT FOR LOGON/UNIT RELATED          02520001
025300*  INFORMATION CAPTURED BY THE NAVIGATOR AT LOGON TIME            02530001
025400     COPY DPWS026.                                                02540001
025500                                                                  02550001
025600*  MAP LAYOUT                                                     02560001
025700     COPY PCKM880.                                                02570001
025800                                                                  02580001
025900* HELP SCREEN WORK AREA                                           02590001
026000     COPY PCWS188.                                                02600001
026100                                                                  02610001
026200* HELP SCREEN COMMAREA                                            02620001
026300     COPY PCWS192.                                                02630001
026400                                                                  02640001
026500* NUMERIC EDIT LAYOUT                                             02650001
026600     COPY DPWS010I.                                               02660001
026700                                                                  02670001
026800*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02680001
026900     COPY DPWS015.                                                02690001
027000                                                                  02700001
027100*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02710001
027200     COPY DFHAID.                                                 02720001
027300                                                                  02730001
027400*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02740001
027500     COPY DPWS013.                                                02750001
027600*                                                                 02760001
027700******************************************************************02770001
027800*  OUTBOUND CARTON TABLE                                          02780001
027900******************************************************************02790001
028000     EXEC SQL                                                     02800001
028100         INCLUDE SUT00024                                         02810001
028200     END-EXEC.                                                    02820001
028300                                                                  02830029
028400******************************************************************02840001
028500*  OUTBOUND CARTON LOCATION TABLE                                 02850001
028600******************************************************************02860001
028700     EXEC SQL                                                     02870001
028800         INCLUDE SUT00027                                         02880001
028900     END-EXEC.                                                    02890001
029000                                                                  02900029
029100******************************************************************02910001
029200*  SHIPMENT UNIT/UPC ASSOCIATION TABLE.                           02920001
029300******************************************************************02930001
029400     EXEC SQL                                                     02940001
029500         INCLUDE TSHUUPC                                          02950001
029600     END-EXEC.                                                    02960001
029700                                                                  02970029
029800******************************************************************02980001
029900*  CARTON DIVERT TABLE.                                           02990001
030000******************************************************************03000001
030100     EXEC SQL                                                     03010001
030200         INCLUDE TSUCRDV                                          03020001
030300     END-EXEC.                                                    03030001
030400                                                                  03040029
030500******************************************************************03050001
030600*  CROSS REFERENCE TABLE                                          03060001
030700******************************************************************03070001
030800     EXEC SQL                                                     03080001
030900         INCLUDE TSULBXF                                          03090001
031000     END-EXEC.                                                    03100001
031100                                                                  03110016
031200******************************************************************03120016
031300*  TSPHUNT TABLE                                                  03130016
031400******************************************************************03140016
031500     EXEC SQL                                                     03150016
031600         INCLUDE TSHPUNT                                          03160016
031700     END-EXEC.                                                    03170016
031800                                                                  03180016
031900******************************************************************03190001
032000*  CROSS REFERENCE CURSOR                                         03200001
032100******************************************************************03210001
032200                                                                  03220001
032300     EXEC SQL                                                     03230001
032400          DECLARE DUP-ACTIVE-CSR CURSOR FOR                       03240001
032500          SELECT  BRCDE_NBR                                       03250001
032600             ,    LAST_STAT_CHG_TMST                              03260001
032700            FROM  TSULBXF                                         03270001
032800            WHERE SHIPT_UNT_ID = :DK-CARTON-ID                    03280001
032900           ORDER BY LAST_STAT_CHG_TMST DESC                       03290001
033000     END-EXEC.                                                    03300001
033100                                                                  03310001
033300******************************************************************03330001
033400*  DB2 AREA FOR COMMUNICATIONS.                                   03340001
033500******************************************************************03350001
033600     EXEC SQL                                                     03360001
033700         INCLUDE SQLCA                                            03370001
033800     END-EXEC.                                                    03380001
033900                                                                  03390029
034000******************************************************************03400001
034100 LINKAGE SECTION.                                                 03410001
034200 01  DFHCOMMAREA.                                                 03420001
034300     05  FILLER                         OCCURS  1 TO 4072 TIMES   03430001
034400                                      DEPENDING ON EIBCALEN.      03440001
034500         10  FILLER                   PIC X.                      03450001
034600                                                                  03460029
034700******************************************************************03470001
034800 PROCEDURE DIVISION.                                              03480001
034900******************************************************************03490001
035000 0000-PROGRAM-MAINLINE.                                           03500001
035100                                                                  03510001
035200     INITIALIZE CA-COMMAREA.                                      03520001
035300     IF EIBTRNID = 'E868' OR                                      03530001
035400        EIBTRNID = 'E884' OR                                      03540001
035500        EIBTRNID = 'E887'                                         03550001
035600         MOVE DFHCOMMAREA   TO CA-COMMAREA                        03560001
035700         INITIALIZE PC038-SHPUNT-FIELDS                           03570001
035800                    PC038-SULBXF-FIELDS                           03580001
035900         SET PS-INITIALIZE-SCREEN TO TRUE                         03590001
036000         SET CA-USE-PCWS038-COMMAREA TO TRUE                      03600001
036100         IF EIBTRNID = 'E868'                                     03610001
036200            SET CA-LAST-PROG-PCKRF868 TO TRUE                     03620001
036300         ELSE                                                     03630001
036400             IF EIBTRNID = 'E884'                                 03640001
036500                SET CA-LAST-PROG-PCKRF884 TO TRUE                 03650001
036600             END-IF                                               03660001
036700         END-IF                                                   03670001
036800     ELSE                                                         03680001
036900         IF EIBTRNID = 'E870' OR                                  03690001
037000            EIBTRNID = 'E872' OR                                  03700001
037100            EIBTRNID = 'E873' OR                                  03710001
037200            EIBTRNID = 'E874' OR                                  03720001
037300            EIBTRNID = 'E876' OR                                  03730001
037400            EIBTRNID = 'E878' OR                                  03740001
037500            EIBTRNID = 'E879'                                     03750001
037600             MOVE DFHCOMMAREA   TO CA-PC233                       03760001
037700             SET PS-INITIALIZE-SCREEN TO TRUE                     03770001
037800             SET CA-USE-PCWS233-COMMAREA TO TRUE                  03780001
037900         ELSE                                                     03790001
038000             IF EIBTRNID = 'E881' OR                              03800001
038100                EIBTRNID = 'E882' OR                              03810001
038200                EIBTRNID = 'E883'                                 03820001
038300                 MOVE DFHCOMMAREA   TO CA-COMMAREA                03830001
038400                 INITIALIZE PC038-SHPUNT-FIELDS                   03840001
038500                            PC038-SULBXF-FIELDS                   03850001
038600                 SET PS-INITIALIZE-SCREEN TO TRUE                 03860001
038700             ELSE                                                 03870001
038800                 MOVE DFHCOMMAREA   TO CA-COMMAREA                03880001
038900                 SET PS-PROCESS-SCREEN TO TRUE                    03890001
039000         END-IF                                                   03900001
039100     END-IF.                                                      03910001
039200     EVALUATE TRUE                                                03920001
039300         WHEN EIBCALEN = ZERO                                     03930001
039400             MOVE PM-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    03940001
039500             PERFORM 8110-RETURN                                  03950001
039600                                                                  03960001
039700****************************************************************  03970001
039800* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        03980001
039900****************************************************************  03990001
040000         WHEN EIBTRNID = 'Z278'                                   04000001
040100             MOVE DFHCOMMAREA          TO PC192-COMMAREA          04010001
040200             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             04020001
040400             SET PS-PROCESS-SCREEN TO TRUE                        04040001
040500             MOVE PC192-HOST-SAVE-MAP  TO PC880AO                 04050001
040600             MOVE -1                   TO ACARTNL                 04060001
040700             PERFORM 8000-SEND-MAP                                04070001
040800             PERFORM 8100-RETURN-TRANID                           04080001
040900                                                                  04090001
041100         WHEN PS-INITIALIZE-SCREEN                                04110001
041200         WHEN EIBAID = DFHCLEAR                                   04120001
041400             IF CA-USE-PCWS038-COMMAREA                           04140001
041500                 PERFORM 1000-INITIALIZE                          04150001
041600             END-IF                                               04160001
041700             PERFORM 1300-FIND-SYSTEM-ID                          04170001
041800             PERFORM 1400-FIND-LOGON-INFO                         04180001
042000             MOVE -1                  TO ACARTNL                  04200001
042100             PERFORM 8000-SEND-MAP                                04210001
042200             PERFORM 8100-RETURN-TRANID                           04220001
042300                                                                  04230001
042400         WHEN EIBAID = DFHPF3                                     04240001
042500             IF CA-USE-PCWS038-COMMAREA                           04250001
042600               IF CA-LAST-PROG-PCKRF868                           04260001
042700                 MOVE PC-SHIPPING-MENU-PGM TO PV-TRANSFER-PROGRAM 04270001
042800               ELSE                                               04280001
042900                 IF CA-LAST-PROG-PCKRF884                         04290001
043000                   MOVE PC-CARTON-FUNCTN-PGM                      04300001
043100                                           TO PV-TRANSFER-PROGRAM 04310001
043200                 ELSE                                             04320001
043300                   MOVE PC-CARTON-DIVERT-PGM                      04330001
043400                                           TO PV-TRANSFER-PROGRAM 04340001
043500                 END-IF                                           04350001
043600               END-IF                                             04360001
043700               PERFORM 8200-XCTL                                  04370001
043800             ELSE                                                 04380001
043900               MOVE PC233-LAST-PROGRAM     TO PV-TRANSFER-PROGRAM 04390001
044000               PERFORM 8210-XCTL                                  04400001
044100             END-IF                                               04410001
044200                                                                  04420001
044300         WHEN EIBAID = DFHENTER                                   04430001
044400             PERFORM 2000-PROCESS-SCREEN-FIELDS                   04440001
044500             IF PS-ERRORS-NO                                      04450001
044600                     MOVE 'PCKRF881'  TO PV-TRANSFER-PROGRAM      04460001
044700                     PERFORM 8230-XCTL-TO-E881                    04470001
044800             ELSE                                                 04480001
044900                 PERFORM 8010-SEND-DATA-ONLY                      04490001
045000                 PERFORM 8100-RETURN-TRANID                       04500001
045100             END-IF                                               04510001
045200                                                                  04520001
045300         WHEN EIBAID = DFHPF1                                     04530001
045400             PERFORM 8020-RECEIVE-MAP                             04540001
045500             MOVE PC880AO  TO PC192-HOST-SAVE-MAP                 04550001
045600             PERFORM 1200-HELP-SCREEN                             04560001
045700                                                                  04570001
045800         WHEN OTHER                                               04580001
045900             MOVE -1  TO ACARTNL                                  04590001
046000             MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO AMSGLNO          04600001
046100             MOVE SPACES                      TO ACRTMS1O         04610001
046200                                                 ACRTMS2O         04620001
046300             PERFORM 8000-SEND-MAP                                04630001
046500             PERFORM 8100-RETURN-TRANID                           04650001
046600     END-EVALUATE.                                                04660001
046700                                                                  04670001
046800     GOBACK.                                                      04680001
046900                                                                  04690001
047000 1000-INITIALIZE.                                                 04700001
047100                                                                  04710001
047200     EXEC CICS                                                    04720001
047300         ASSIGN USERID  (PC038-USER-ID)                           04730001
047400                RESP    (PV-CICS-RESPONSE)                        04740001
047500     END-EXEC.                                                    04750001
047600                                                                  04760001
047700     EVALUATE TRUE                                                04770001
047800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04780001
047900             CONTINUE                                             04790001
048000         WHEN OTHER                                               04800001
048100             MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH      04810001
048200             MOVE 'PCKRF880 - UNABLE TO ASSIGN USER-ID'           04820001
048300                                      TO DP013-MESSAGE-TEXT (1)   04830001
048400             SET DP013-LOGIC-ABEND                                04840001
048500                 DP013-ROLLBACK       TO TRUE                     04850001
048600            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                04860001
048700     END-EVALUATE.                                                04870001
048800                                                                  04880001
048900 1200-HELP-SCREEN.                                                04890001
049000     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      04900001
049100     MOVE 'PCKRF880'                  TO PC192-PROGRAM-NAME       04910001
049200     COPY PCPD188.                                                04920001
049300     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      04930001
049400     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     04940001
049500     PERFORM 8220-XCTL-TO-HELP.                                   04950001
049600                                                                  04960001
049700******************************************************************04970001
049800* DETERMINE IF WE ARE RUNNING IN A SINGLE CICS REGION (CICST1),   04980001
049900* OR IF WE ARE RUNNING IN A SPLIT CICS REGION (CICSP1 AND CICSP4).04990001
050000* PV-SYSID WILL BE SPACES IF WE ARE RUNNING IN A SINGLE REGION.   05000001
050100******************************************************************05010001
050200 1300-FIND-SYSTEM-ID.                                             05020001
050300     EXEC CICS                                                    05030001
050400         INQUIRE                                                  05040001
050500             TRANSACTION   (PC-LOGON-TRAN-ID)                     05050001
050600             REMOTESYSTEM  (PV-SYSID)                             05060001
050700             RESP          (PV-CICS-RESPONSE)                     05070001
050800     END-EXEC.                                                    05080001
050900                                                                  05090001
051000     EVALUATE TRUE                                                05100001
051100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05110001
051200             CONTINUE                                             05120001
051300         WHEN OTHER                                               05130001
051400             MOVE '1300-FIND-SYSTEM-ID'                           05140001
051500                 TO DP013-PARAGRAPH                               05150001
051600             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 05160001
051700                 TO DP013-MESSAGE-TEXT (1)                        05170001
051800             SET DP013-CICS-ABEND      TO  TRUE                   05180001
051900             SET DP013-NO-ROLLBACK     TO  TRUE                   05190001
052000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               05200001
052100             MOVE 'CICS ERR/HELP DESK ' TO AMSGLNO                05210001
052200             MOVE SPACES                TO ACRTMS1O               05220001
052300                                           ACRTMS2O               05230001
052400             PERFORM 8010-SEND-DATA-ONLY                          05240001
052500             PERFORM 8110-RETURN                                  05250001
052600     END-EVALUATE.                                                05260001
052700                                                                  05270029
052800                                                                  05280029
052900******************************************************************05290001
053000*  FIND THE LOCATION OF THE TERMINAL OR PC AND THE USERID OF THE  05300001
053100*  PERSON THAT IS CURRENTLY LOGGED ON.  IF WE ARE RUNNING IN      05310001
053200*  CICST1, PV-SYSID WILL BE SPACES BECAUSE THE TERMINAL AND       05320001
053300*  APPLICATION REGIONS ARE BOTH CICST1.  IF WE ARE IN PRODUCTION, 05330001
053400*  PV-SYSID WILL NOT BE SPACES BECAUSE OF THE SPLIT REGION        05340001
053500*  PROCESSING.  IN PRODUCTION, THE APPLICATION REGION IS CICSP4,  05350001
053600*  WHILE THE TERMINAL REGION (WHERE WE NEED TO GET OUR REQUESTED  05360001
053700*  INFORMATION) IS CICSP1.                                        05370001
053800******************************************************************05380001
053900 1400-FIND-LOGON-INFO.                                            05390001
054000     MOVE LENGTH OF DP026-SIGN-ON-INFO                            05400001
054100                    TO  PV-SIGN-ON-INFO-LENGTH.                   05410001
054200     MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   05420001
054300     MOVE +1        TO  PV-TS-ITEM.                               05430001
054400                                                                  05440001
054500     IF PV-SYSID = SPACES                                         05450001
054600         EXEC CICS                                                05460001
054700             READQ TS                                             05470001
054800                 QUEUE  (TS-INFO-QUEUE-NAME)                      05480001
054900                 ITEM   (PV-TS-ITEM)                              05490001
055000                 INTO   (DP026-SIGN-ON-INFO)                      05500001
055100                 RESP   (PV-CICS-RESPONSE)                        05510001
055200         END-EXEC                                                 05520001
055300     ELSE                                                         05530001
055400         EXEC CICS                                                05540001
055500             READQ TS                                             05550001
055600                 QUEUE   (TS-INFO-QUEUE-NAME)                     05560001
055700                 SYSID   (PV-SYSID)                               05570001
055800                 ITEM    (PV-TS-ITEM)                             05580001
055900                 INTO    (DP026-SIGN-ON-INFO)                     05590001
056000                 LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 05600001
056100                 RESP    (PV-CICS-RESPONSE)                       05610001
056200         END-EXEC                                                 05620001
056300     END-IF.                                                      05630001
056400                                                                  05640001
056500     EVALUATE TRUE                                                05650001
056600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05660001
056700             MOVE DP026-LOCATION-NBR  TO  PC038-CURR-OPER-UNT     05670012
056800         WHEN OTHER                                               05680001
056900             MOVE '1400-FIND-LOGON-INFO'                          05690001
057000                 TO DP013-PARAGRAPH                               05700001
057100             MOVE 'UNABLE TO READ LOGON TSQ'                      05710001
057200                 TO DP013-MESSAGE-TEXT (1)                        05720001
057300             SET DP013-CICS-ABEND     TO TRUE                     05730001
057400             SET DP013-NO-ROLLBACK    TO TRUE                     05740001
057500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               05750001
057600             MOVE 'SYSTEM ERR/HELP DES' TO AMSGLNO                05760001
057700             MOVE SPACES                TO ACRTMS1O               05770001
057800                                           ACRTMS2O               05780001
057900             PERFORM 8010-SEND-DATA-ONLY                          05790001
058000             PERFORM 8110-RETURN                                  05800001
058100     END-EVALUATE.                                                05810001
058200                                                                  05820001
058300                                                                  05830029
058400 2000-PROCESS-SCREEN-FIELDS.                                      05840001
058500                                                                  05850001
058600     PERFORM 8020-RECEIVE-MAP                                     05860001
058700     PERFORM 2100-EDIT-INPUT.                                     05870001
058800                                                                  05880001
058900     IF PS-VALID-INPUT                                            05890001
059000         SET PS-ERRORS-NO TO TRUE                                 05900001
059100     ELSE                                                         05910001
059200         PERFORM 8010-SEND-DATA-ONLY                              05920001
059300         PERFORM 8100-RETURN-TRANID                               05930001
059400     END-IF.                                                      05940001
059500                                                                  05950001
059600 2100-EDIT-INPUT.                                                 05960001
059700                                                                  05970001
059800     INITIALIZE PC038-SHPUNT-FIELDS                               05980001
059900                PC038-SULBXF-FIELDS                               05990001
060000                PC038-PURCHASE-ORD-INFO.                          06000001
060100                                                                  06010001
060200     MOVE ACARTNI TO PV-CTN                                       06020001
060300     PERFORM 2230-EDIT-CTN                                        06030001
060400     IF  PS-ERRORS-NO                                             06040001
060500         PERFORM 3100-SELECT-OTBND-CART                           06050001
060600     END-IF.                                                      06060001
060700                                                                  06070001
060800******************************************************************06080001
060900* EDIT THE CARTON ID ENTERED.                                     06090001
061000******************************************************************06100001
061100 2230-EDIT-CTN.                                                   06110001
061200     MOVE 0 TO PV-CHAR-COUNT.                                     06120001
061300*    SET SU001-GOOD-CHECK-DIGIT TO TRUE.                          06130001
061400     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         06140001
061500                 BEFORE INITIAL SPACE.                            06150001
061600     EVALUATE TRUE                                                06160001
061700         WHEN PV-CTN = SPACES                                     06170001
061800             SET PS-ERRORS-YES                                    06180001
061900                 PS-INVALID-INPUT        TO TRUE                  06190001
062000             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               06200001
062100             MOVE -1                     TO ACARTNL               06210001
062200             MOVE PC034-PLS-ENT-FLD-MSG  TO AMSGLNO               06220001
062300             MOVE SPACES                 TO ACRTMS1O              06230001
062400                                            ACRTMS2O              06240001
062500                                                                  06250029
063600         WHEN PV-CHAR-COUNT < PC-18                               06360001
063700             SET PS-ERRORS-YES                                    06370001
063800                 PS-INVALID-INPUT        TO TRUE                  06380001
063900             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               06390001
064000             MOVE -1                     TO ACARTNL               06400001
064100             MOVE PC034-MORE-DIGITS-REQD TO AMSGLNO               06410001
064200             MOVE SPACES                 TO ACRTMS1O              06420001
064300                                            ACRTMS2O              06430001
064400         WHEN OTHER                                               06440001
064500             IF PV-CHAR-COUNT = PC-18                             06450001
064600                 MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD06460001
064700             ELSE                                                 06470001
064800                 IF PV-CHAR-COUNT < PC-18                         06480001
064900                     MOVE PV-CTN          TO DP010I-UNEDITED-FIELD06490001
065000                 ELSE                                             06500001
065100                     MOVE PV-CTN-SCAN-LAST-17                     06510001
065200                                          TO DP010I-UNEDITED-FIELD06520001
065300                 END-IF                                           06530001
065400             END-IF                                               06540001
065500             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 06550001
065600             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               06560001
065700                                                                  06570001
065810             CALL DP010I-NUMERIC-EDIT-ROUTINE                     06581028
065820                         USING DP010I-NUMERIC-EDIT-AREA           06582028
065900                                                                  06590001
066000             IF  DP010I-ERROR-DETECTED                            06600001
066100                 SET PS-ERRORS-YES                                06610001
066200                     PS-INVALID-INPUT        TO TRUE              06620001
066300                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           06630001
066400                 MOVE -1                     TO ACARTNL           06640001
066500                 MOVE PC034-NUMERIC-VALUE-REQ-MSG TO AMSGLNO      06650001
066600                 MOVE SPACES                 TO ACRTMS1O          06660001
066700                                                ACRTMS2O          06670001
066800             ELSE                                                 06680001
066900                 IF DP010I-NUMERIC-FIELD = ZEROES                 06690001
067000                     SET PS-ERRORS-YES                            06700001
067100                         PS-INVALID-INPUT        TO TRUE          06710001
067200                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       06720001
067300                     MOVE -1                     TO ACARTNL       06730001
067400                     MOVE PC034-MUST-BE-GT-0-MSG  TO AMSGLNO      06740001
067500                     MOVE SPACES                 TO ACRTMS1O      06750001
067600                                                    ACRTMS2O      06760001
067700                 ELSE                                             06770001
067800                      COMPUTE PC038-CARTON-ID-ENTERED  ROUNDED =  06780001
067900                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         06790001
068000                      COMPUTE PV-CTN-N          ROUNDED =         06800001
068100                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         06810001
068200                      SET PS-NOT-KOHLS-BARCODE  TO TRUE           06820001
068300                      EVALUATE TRUE                               06830001
068400                          WHEN PV-CHAR-COUNT = PC-20              06840001
068500                             IF PV-CTN-SCAN-THIRD-DGT  = PC-4     06850004
068700                                SET PS-KOHLS-BARCODE TO TRUE      06870001
068800                                MOVE PV-CTN-SCAN-LAST-18 TO       06880001
068900                                                    PV-CTN-N      06890001
069000                             ELSE                                 06900022
069100                                MOVE PV-CTN-SCAN-LAST-18 TO       06910023
069200                                                    PV-CTN-N      06920023
069300                             END-IF                               06930001
069400                          WHEN PV-CHAR-COUNT = PC-18              06940001
069500                             IF PV-CTN-FIRST-DIGIT  = PC-4        06950004
069700                                SET PS-KOHLS-BARCODE TO TRUE      06970001
069800                                MOVE PV-CTN  TO PV-CTN-N          06980001
069900                             ELSE                                 06990009
070000                                MOVE PV-CTN  TO PV-CTN-N          07000009
070100                             END-IF                               07010009
070200                          END-EVALUATE                            07020001
070300                     MOVE PV-CTN-N      TO ACARTNO                07030001
070400                                           DK-CARTON-ID           07040001
070500                                           DK-CRTNID2-03-20       07050001
070600                                           PC038-CARTON-ID-ENTERED07060001
070700                     MOVE ZEROES        TO DK-CRTNID2-01-02       07070001
070800                     MOVE SPACES        TO DK-CRTNID2-21-22       07080001
070900                 END-IF                                           07090001
071000             END-IF                                               07100001
071100     END-EVALUATE.                                                07110001
071200     IF PS-KOHLS-BARCODE AND                                      07120001
071300        (PC038-SULBXF-BARCODE = SPACES  OR                        07130001
071400         PC038-SULBXF-BARCODE = LOW-VALUES)                       07140001
071500         MOVE DK-CARTON-ID-2 TO PC038-SULBXF-BARCODE              07150001
071600     END-IF.                                                      07160001
071700                                                                  07170001
071800*----------------------------------------------------------------*07180001
071900*  CHECK THE SHIPPING UNIT TABLE TO VERIFY THE CARTON ID/BARCODE *07190001
072000*  ENTERED IS VALID.                                              07200001
072100*----------------------------------------------------------------*07210001
072200 3100-SELECT-OTBND-CART.                                          07220001
072300                                                                  07230001
072400     EXEC SQL                                                     07240001
072500        SELECT   SHIPT_UNT_ID                                     07250001
072600                ,ORGN_LOC_NBR                                     07260001
072700                ,DEST_LOC_NBR                                     07270001
072800                ,CART_SRC_CDE                                     07280001
072900                ,MSTR_CART_IND                                    07290001
073000                ,PRNT_CART_ID                                     07300001
073100                ,ORIG_CART_ID                                     07310001
073200                ,ACTV_IND                                         07320001
073300                ,CRE_DTE                                          07330001
073400                ,CRE_TM                                           07340001
073500                ,CRE_USR_ID                                       07350001
073600                ,CART_TYP_CDE                                     07360001
073700           INTO :SUT00024-SHIPT-UNT-ID,                           07370001
073800                :SUT00024-ORGN-LOC-NBR,                           07380001
073900                :SUT00024-DEST-LOC-NBR,                           07390001
074000                :SUT00024-CART-SRC-CDE,                           07400001
074100                :SUT00024-MSTR-CART-IND,                          07410001
074200                :SUT00024-PRNT-CART-ID,                           07420001
074300                :SUT00024-ORIG-CART-ID,                           07430001
074400                :SUT00024-ACTV-IND,                               07440001
074500                :SUT00024-CRE-DTE,                                07450001
074600                :SUT00024-CRE-TM,                                 07460001
074700                :SUT00024-CRE-USR-ID,                             07470001
074800                :SUT00024-CART-TYP-CDE                            07480001
074900          FROM  SUT_OTBND_CART                                    07490001
075000         WHERE  SHIPT_UNT_ID   = :DK-CARTON-ID                    07500001
075100                                                                  07510001
075200     END-EXEC.                                                    07520001
075300                                                                  07530001
075400     EVALUATE TRUE                                                07540001
075500         WHEN SQLCODE = +0                                        07550001
075600              SET PC038-ON-TSHPUNT      TO TRUE                   07560001
075700              MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID       07570001
075800              MOVE SUT00024-SHIPT-UNT-ID TO                       07580001
075900                                  PC038-SHPUNT-SHIPT-UNT-ID       07590001
076100              IF  SUT00024-CART-SRC-CDE  =  'ASN'                 07610001
076200                  MOVE 'CKN'                                      07620001
076300                    TO  SUT00024-CART-SRC-CDE                     07630001
076400              END-IF                                              07640001
076600              PERFORM 3200-MOVE-OTBD-CART-TO-PCWS038              07660001
076610                                                                  07661029
076700         WHEN SQLCODE = +100                                      07670001
076800              PERFORM 3300-SELECT-OTBND-CART                      07680001
076900                                                                  07690001
077000         WHEN SQLWARN0 NOT = SPACES                               07700001
077100         WHEN SQLCODE < +0                                        07710001
077200         WHEN SQLCODE > +0                                        07720001
077300             MOVE '3100-SELECT-OTBND-CART' TO DP013-PARAGRAPH     07730001
077400             MOVE 'VALIDATE CARTON ID/BARCODE'                    07740001
077500                                        TO DP013-MESSAGE-TEXT (1) 07750001
077600             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          07760001
077700             MOVE SQLCA      TO DP013-SQLCA                       07770001
077800             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)          07780001
077900             SET DP013-DB2-ABEND                                  07790001
078000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               07800001
078100     END-EVALUATE.                                                07810001
078200                                                                  07820001
078300*----------------------------------------------------------------*07830001
078400*  MOVE DATA FROM SUT_OTBND_CART TO PC038-SHPUNT-FIELDS.         *07840001
078500*----------------------------------------------------------------*07850001
078600 3200-MOVE-OTBD-CART-TO-PCWS038.                                  07860001
078700                                                                  07870001
078900     MOVE SUT00024-ORGN-LOC-NBR   TO PC038-SHPUNT-ORGN-OPER.      07890001
079000     MOVE SUT00024-DEST-LOC-NBR   TO PC038-SHPUNT-DEST-OPER.      07900001
079100     MOVE SUT00024-CART-SRC-CDE   TO PC038-SOURCE-ID              07910001
079200                                     PC038-SHPUNT-SOURCE-ID.      07920001
079300     MOVE SUT00024-MSTR-CART-IND  TO PC038-SHPUNT-HIER-LVL-CDE.   07930001
079400     MOVE SUT00024-PRNT-CART-ID   TO PC038-NEXT-SHIPT-UNT-ID.     07940001
079500     MOVE SUT00024-ORIG-CART-ID    TO PC038-ORIG-SHIPT-UNT-ID.    07950001
079600     MOVE SUT00024-ACTV-IND        TO PC038-SHPUNT-ACTV-IND.      07960001
079700                                                                  07970001
079800     IF  SUT00024-CART-SRC-CDE = 'ASN'                            07980001
079900     OR  SUT00024-CART-SRC-CDE = 'CKN'                            07990001
079910     OR  SUT00024-CART-SRC-CDE = '3WD'                            07991030
080000         MOVE SUT00024-SHIPT-UNT-ID TO                            08000001
080100              DK-SHIPT-UNT-ID-LOC                                 08010001
080200         SET PS-OTBND-LOC-NOT-FOUND TO TRUE                       08020001
080300         PERFORM 3400-SELECT-OTBND-LOC                            08030001
080400     END-IF.                                                      08040001
080500                                                                  08050001
080600     IF  PS-OTBND-LOC-FOUND                                       08060001
080700         MOVE PV-OTBND-LOC-DATE TO                                08070001
080800              PC038-SHPUNT-CRE-DATE                               08080001
080900         MOVE PV-OTBND-LOC-TIME TO                                08090001
081000              PC038-SHPUNT-CRE-TIME                               08100001
081100     ELSE                                                         08110001
081200         MOVE SUT00024-CRE-DTE     TO                             08120001
081300              PC038-SHPUNT-CRE-DATE                               08130001
081400         MOVE SUT00024-CRE-TM      TO                             08140001
081500              PC038-SHPUNT-CRE-TIME                               08150001
081600     END-IF.                                                      08160001
081700                                                                  08170001
081800     MOVE SUT00024-CRE-USR-ID      TO PC038-SHPUNT-CRE-USR-ID.    08180001
081900     MOVE SUT00024-CART-TYP-CDE    TO PC038-SHPUNT-CART-TYP-CDE.  08190001
082000                                                                  08200001
082100                                                                  08210001
082200*----------------------------------------------------------------*08220001
082300*  CHECK THE SHIPPING UNIT CROSS REFERENCE TABLE TO CHECK IF THE  08230001
082400*  CARTON ID/BARCODE ENTERED IS THERE                             08240001
082500*----------------------------------------------------------------*08250001
082600 3300-SELECT-OTBND-CART.                                          08260001
082700                                                                  08270001
082800     EXEC SQL                                                     08280001
082900        SELECT   SHIPT_UNT_ID                                     08290001
083000                ,ORGN_LOC_NBR                                     08300001
083100                ,DEST_LOC_NBR                                     08310001
083200                ,CART_SRC_CDE                                     08320001
083300                ,MSTR_CART_IND                                    08330001
083400                ,PRNT_CART_ID                                     08340001
083500                ,ORIG_CART_ID                                     08350001
083600                ,ACTV_IND                                         08360001
083700                ,CRE_DTE                                          08370001
083800                ,CRE_TM                                           08380001
083900                ,CRE_USR_ID                                       08390001
084000                ,CART_TYP_CDE                                     08400001
084100           INTO :SUT00024-SHIPT-UNT-ID,                           08410001
084200                :SUT00024-ORGN-LOC-NBR,                           08420001
084300                :SUT00024-DEST-LOC-NBR,                           08430001
084400                :SUT00024-CART-SRC-CDE,                           08440001
084500                :SUT00024-MSTR-CART-IND,                          08450001
084600                :SUT00024-PRNT-CART-ID,                           08460001
084700                :SUT00024-ORIG-CART-ID,                           08470001
084800                :SUT00024-ACTV-IND,                               08480001
084900                :SUT00024-CRE-DTE,                                08490001
085000                :SUT00024-CRE-TM,                                 08500001
085100                :SUT00024-CRE-USR-ID,                             08510001
085200                :SUT00024-CART-TYP-CDE                            08520001
085300          FROM  SUT_OTBND_CART                                    08530001
085400         WHERE  ORIG_CART_ID   = :DK-CARTON-ID                    08540001
085500           AND  ACTV_IND       = 'Y'                              08550002
085600                                                                  08560001
085700     END-EXEC.                                                    08570001
085800                                                                  08580001
085900     EVALUATE TRUE                                                08590001
086000         WHEN SQLCODE = +0                                        08600001
086100              MOVE SUT00024-ORIG-CART-ID TO DK-SHIPT-UNT-ID       08610001
086200              MOVE SUT00024-ORIG-CART-ID TO                       08620001
086300                                  PC038-SHPUNT-SHIPT-UNT-ID       08630001
086500              MOVE  ZEROES                                        08650001
086600                TO  PV-BARCODE-1-2                                08660001
086700              MOVE  SUT00024-SHIPT-UNT-ID                         08670001
086800                TO  PV-BARCODE-3-20                               08680001
086900              MOVE  PV-BARCODE                                    08690001
087000                TO  PC038-SULBXF-BARCODE                          08700001
087200              PERFORM 3200-MOVE-OTBD-CART-TO-PCWS038              08720001
087300         WHEN SQLCODE = -811                                      08730001
087400              SET PS-REC-FOUND TO TRUE                            08740001
087500              PERFORM 3310-PROCESS-DUPLICATE                      08750001
087600              IF PS-NO-REC-FOUND                                  08760001
087700                  PERFORM 3350-SELECT-TSULBXF                     08770001
087800              END-IF                                              08780001
087900         WHEN SQLCODE = +100                                      08790001
088000              PERFORM 3350-SELECT-TSULBXF                         08800001
088100                                                                  08810001
088200         WHEN SQLWARN0 NOT = SPACES                               08820001
088300         WHEN SQLCODE < +0                                        08830001
088400         WHEN SQLCODE > +0                                        08840001
088500             MOVE '3300-SELECT-OTBND-CART' TO DP013-PARAGRAPH     08850001
088600             MOVE 'VALIDATE CARTON ID'                            08860001
088700                                        TO DP013-MESSAGE-TEXT (1) 08870001
088800             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          08880001
088900             MOVE SQLCA      TO DP013-SQLCA                       08890001
089000             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)          08900001
089100             SET DP013-DB2-ABEND                                  08910001
089200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08920001
089300     END-EVALUATE.                                                08930001
089400                                                                  08940001
089500 3310-PROCESS-DUPLICATE.                                          08950001
089600     PERFORM 3320-OPEN-DUPLICATE-CURSOR.                          08960001
089700     PERFORM 3325-FETCH-DUPLICATE-CURSOR.                         08970001
089800     PERFORM 3340-CLOSE-DUPLICATE-CURSOR.                         08980001
089810                                                                  08981029
089900 3320-OPEN-DUPLICATE-CURSOR.                                      08990001
090000     EXEC SQL                                                     09000001
090100         OPEN DUP-ACTIVE-CSR                                      09010001
090200     END-EXEC.                                                    09020001
090300                                                                  09030001
090400     EVALUATE TRUE                                                09040001
090500          WHEN SQLCODE = +0                                       09050001
090600                 CONTINUE                                         09060001
090700          WHEN SQLCODE NOT EQUAL +0                               09070001
090800               MOVE '3320-OPEN-DUPLICATE-CURSOR'                  09080001
090900                                               TO DP013-PARAGRAPH 09090001
091000               MOVE 'ERROR OPENING THE CURSOR'                    09100001
091100                                        TO DP013-MESSAGE-TEXT (1) 09110001
091200               MOVE SQLCA        TO DP013-SQLCA                   09120001
091300               MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)      09130001
091400               SET DP013-DB2-ABEND                                09140001
091500                   DP013-ROLLBACK   TO TRUE                       09150001
091600               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             09160001
091700     END-EVALUATE.                                                09170001
091800                                                                  09180001
091900 3325-FETCH-DUPLICATE-CURSOR.                                     09190001
092000                                                                  09200001
092100     EXEC SQL                                                     09210001
092200         FETCH DUP-ACTIVE-CSR                                     09220001
092300         INTO :SULBXF-BRCDE-NBR                                   09230001
092400         ,    :SULBXF-LAST-STAT-CHG-TMST                          09240001
092500     END-EXEC.                                                    09250001
092600                                                                  09260001
092700     EVALUATE TRUE                                                09270001
092800         WHEN SQLCODE = +0                                        09280001
092900             MOVE SULBXF-BRCDE-NBR   TO PV-BARCODE-22             09290001
093000             MOVE PV-BARCODE-22-3-20    TO DK-CARTON-ID-XREF      09300001
093100             PERFORM 3330-SELECT-WITH-TSULBXF                     09310001
093200         WHEN SQLCODE = +100                                      09320001
093300             SET PS-NO-REC-FOUND TO TRUE                          09330001
093400         WHEN OTHER                                               09340001
093500           MOVE '3325-FETCH-DUPLICATE-CURSOR'                     09350001
093600                                           TO DP013-PARAGRAPH     09360001
093700           MOVE 'ERROR FETCHING THE CURSOR'                       09370001
093800                                    TO DP013-MESSAGE-TEXT (1)     09380001
093900           MOVE SQLCA        TO DP013-SQLCA                       09390001
094000           MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)          09400001
094100           SET DP013-DB2-ABEND                                    09410001
094200               DP013-ROLLBACK   TO TRUE                           09420001
094300           PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                 09430001
094400             CONTINUE                                             09440001
094500     END-EVALUATE.                                                09450001
094600                                                                  09460001
094700*----------------------------------------------------------------*09470001
094800*  CHECK THE SHIPPING UNIT CROSS REFERENCE TABLE TO CHECK IF THE  09480001
094900*  CARTON ID/BARCODE ENTERED IS THERE                             09490001
095000*----------------------------------------------------------------*09500001
095100 3330-SELECT-WITH-TSULBXF.                                        09510001
095200                                                                  09520001
095300     EXEC SQL                                                     09530001
095400        SELECT   A.SHIPT_UNT_ID                                   09540001
095500                ,A.ORGN_LOC_NBR                                   09550001
095600                ,A.DEST_LOC_NBR                                   09560001
095700                ,A.CART_SRC_CDE                                   09570001
095800                ,A.MSTR_CART_IND                                  09580001
095900                ,A.PRNT_CART_ID                                   09590001
096000                ,A.ORIG_CART_ID                                   09600001
096100                ,A.ACTV_IND                                       09610001
096200                ,A.CRE_DTE                                        09620001
096300                ,A.CRE_TM                                         09630001
096400                ,A.CRE_USR_ID                                     09640001
096500                ,A.CART_TYP_CDE                                   09650001
096600           INTO :SUT00024-SHIPT-UNT-ID,                           09660001
096700                :SUT00024-ORGN-LOC-NBR,                           09670001
096800                :SUT00024-DEST-LOC-NBR,                           09680001
096900                :SUT00024-CART-SRC-CDE,                           09690001
097000                :SUT00024-MSTR-CART-IND,                          09700001
097100                :SUT00024-PRNT-CART-ID,                           09710001
097200                :SUT00024-ORIG-CART-ID,                           09720001
097300                :SUT00024-ACTV-IND,                               09730001
097400                :SUT00024-CRE-DTE,                                09740001
097500                :SUT00024-CRE-TM,                                 09750001
097600                :SUT00024-CRE-USR-ID,                             09760001
097700                :SUT00024-CART-TYP-CDE                            09770001
097800          FROM  SUT_OTBND_CART A                                  09780001
097900         WHERE  A.SHIPT_UNT_ID   = :DK-CARTON-ID-XREF             09790001
098000           AND  A.ACTV_IND       = 'Y'                            09800001
098100                                                                  09810001
098200     END-EXEC.                                                    09820001
098300                                                                  09830001
098400     EVALUATE TRUE                                                09840001
098500         WHEN SQLCODE = +0                                        09850001
098600              MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID       09860001
098700              MOVE SUT00024-SHIPT-UNT-ID TO                       09870001
098800                                  PC038-SHPUNT-SHIPT-UNT-ID       09880001
099000              MOVE  ZEROES                                        09900001
099100                TO  PV-BARCODE-1-2                                09910001
099200              MOVE  SUT00024-SHIPT-UNT-ID                         09920001
099300                TO  PV-BARCODE-3-20                               09930001
099400              MOVE  PV-BARCODE                                    09940001
099500                TO  PC038-SULBXF-BARCODE                          09950001
099700              PERFORM 3200-MOVE-OTBD-CART-TO-PCWS038              09970001
099800         WHEN SQLCODE = +100                                      09980001
099900              PERFORM 3350-SELECT-TSULBXF                         09990001
100000                                                                  10000001
100100         WHEN SQLWARN0 NOT = SPACES                               10010001
100200         WHEN SQLCODE < +0                                        10020001
100300         WHEN SQLCODE > +0                                        10030001
100400             MOVE '3330-SELECT-WITH-TSULBXF' TO DP013-PARAGRAPH   10040001
100500             MOVE 'VALIDATE CARTON ID'                            10050001
100600                                        TO DP013-MESSAGE-TEXT (1) 10060001
100700             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          10070001
100800             MOVE SQLCA      TO DP013-SQLCA                       10080001
100900             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)          10090001
101000             SET DP013-DB2-ABEND                                  10100001
101100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10110001
101200     END-EVALUATE.                                                10120001
101300                                                                  10130001
101400 3340-CLOSE-DUPLICATE-CURSOR.                                     10140001
101500                                                                  10150001
101600     EXEC SQL                                                     10160001
101700         CLOSE DUP-ACTIVE-CSR                                     10170001
101800     END-EXEC                                                     10180001
101900                                                                  10190001
102000     EVALUATE TRUE                                                10200001
102100          WHEN SQLCODE = +0                                       10210001
102200                 CONTINUE                                         10220001
102300          WHEN SQLCODE NOT EQUAL +0                               10230001
102400               MOVE '3340-CLOSE-DUPLICATE-CURSOR'                 10240001
102500                                               TO DP013-PARAGRAPH 10250001
102600               MOVE 'ERROR CLOSING THE CURSOR'                    10260001
102700                                        TO DP013-MESSAGE-TEXT (1) 10270001
102800               MOVE SQLCA        TO DP013-SQLCA                   10280001
102900               MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)      10290001
103000               SET DP013-DB2-ABEND                                10300001
103100                   DP013-ROLLBACK   TO TRUE                       10310001
103200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             10320001
103300     END-EVALUATE.                                                10330001
103400                                                                  10340001
103500*----------------------------------------------------------------*10350001
103600*  CHECK IF VENDOR CARTON CHECKED IN AND CREATED P2L LABEL        10360001
103700*----------------------------------------------------------------*10370001
103800 3350-SELECT-TSULBXF.                                             10380001
103900                                                                  10390001
104000     EXEC SQL                                                     10400001
104100        SELECT BRCDE_NBR                                          10410001
104200              ,CRE_TMST                                           10420001
104300              ,CART_LBL_TYP_CDE                                   10430001
104400              ,DEST_OPER_UNT_ID                                   10440001
104500              ,STAT_CDE                                           10450001
104600          INTO :SULBXF-BRCDE-NBR                                  10460001
104700              ,:SULBXF-CRE-TMST                                   10470001
104800              ,:SULBXF-CART-LBL-TYP-CDE                           10480001
104900              ,:SULBXF-DEST-OPER-UNT-ID                           10490001
105000              ,:SULBXF-STAT-CDE                                   10500001
105100          FROM  TSULBXF                                           10510001
105200         WHERE  SHIPT_UNT_ID     = :DK-CARTON-ID                  10520001
105300     END-EXEC.                                                    10530001
105400                                                                  10540001
105500     EVALUATE TRUE                                                10550001
105600         WHEN SQLCODE = +0                                        10560001
105700              MOVE SULBXF-BRCDE-NBR                               10570001
105800                TO PC038-SULBXF-BARCODE                           10580001
105900              SET  PC038-CHECKED-IN                               10590001
106000                TO  TRUE                                          10600001
106100              MOVE 'ASN'                                          10610001
106200                TO  SUT00024-CART-SRC-CDE                         10620001
106300                    PC038-SOURCE-ID                               10630001
106400              MOVE  DK-CARTON-ID                                  10640001
106500                TO  PC038-SHPUNT-SHIPT-UNT-ID                     10650001
106600              MOVE  SULBXF-CRE-TMST                               10660001
106700                TO  PC038-SHPUNT-CRE-DATE                         10670001
106800              MOVE  SULBXF-CART-LBL-TYP-CDE                       10680001
106900                TO  PC038-SULBXF-CART-TYP-CDE                     10690001
107000              MOVE  SULBXF-DEST-OPER-UNT-ID                       10700001
107100                TO  PC038-SULBXF-DEST-OPER-UNT                    10710001
107200                    PC038-SHPUNT-DEST-OPER                        10720001
107300              MOVE  SULBXF-STAT-CDE                               10730001
107400                TO  PC038-SULBXF-ACTV-IND                         10740001
107500               SET  PC038-4-BY-4-LABEL  TO  TRUE                  10750011
107600                                                                  10760001
107700         WHEN SQLCODE = +100                                      10770001
107800              PERFORM 3600-SELECT-TSUCRDV                         10780001
107900                                                                  10790001
108000         WHEN SQLWARN0 NOT = SPACES                               10800001
108100         WHEN SQLCODE < +0                                        10810001
108200         WHEN SQLCODE > +0                                        10820001
108300             MOVE '3600-SELECT-TSUCRDV' TO DP013-PARAGRAPH        10830001
108400             MOVE 'SELECT DIVERT TABLE'                           10840001
108500                             TO DP013-MESSAGE-TEXT (1)            10850001
108600             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          10860001
108700             MOVE SQLCA      TO DP013-SQLCA                       10870001
108800             MOVE 'TSUCRDV'  TO DP013-DB2-TABLE-NAME (1)          10880001
108900             SET DP013-DB2-ABEND                                  10890001
109000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10900001
109100     END-EVALUATE.                                                10910001
109200                                                                  10920001
109300*----------------------------------------------------------------*10930001
109400*  CHECK THE OUTBOUND LOCATION TABLE FOR CARTONS WITH A SOURCE    10940001
109500*  CODE OF 'ASN', 'CKN' OR '3WD' TO GET THE DATE/TIME THAT THE SML10950030
109600*  NUMBER WAS CREATED (DO NOT WANT THE DATE/TIME THAT THE         10960001
109700*  INBOUND CARTON WAS CREATED).  WHEN WE DID THE CONVERSION TO    10970001
109800*  THE OUTBOUND TABLES, WE CARRIED THE DATE AND TIME THAT THE     10980001
109900*  INBOUND CARTON WAS CREATED FROM THE ASN LOAD TO THE OUTBOUND   10990001
110000*  CARTON TABLE FOR THOSE CARTONS THAT HAD BEEN CHECKED IN AND    11000001
110100*  ASSIGNED AN SML NUMBER.                                        11010001
110200*----------------------------------------------------------------*11020001
110300 3400-SELECT-OTBND-LOC.                                           11030001
110400                                                                  11040001
110500     EXEC SQL                                                     11050001
110600          SELECT  DATE(A.CRE_TMST),                               11060001
110700                  TIME(A.CRE_TMST)                                11070001
110800            INTO :PV-OTBND-LOC-DATE,                              11080001
110900                 :PV-OTBND-LOC-TIME                               11090001
111000            FROM  SUT_OTBND_LOC A                                 11100001
111100           WHERE  A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID-LOC           11110001
111200             AND  A.SCN_CDE      = 'RECV'                         11120001
111300             AND  A.ACTV_CDE     = 'A'                            11130001
111400             AND  A.CRE_TMST     =                                11140001
111500                  (SELECT  MAX(B.CRE_TMST)                        11150001
111600                     FROM  SUT_OTBND_LOC B                        11160001
111700                    WHERE  B.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID-LOC) 11170001
111800     END-EXEC.                                                    11180001
111900                                                                  11190001
112000     EVALUATE TRUE                                                11200001
112100         WHEN SQLCODE = +0                                        11210001
112200              SET PS-OTBND-LOC-FOUND                              11220001
112300                TO  TRUE                                          11230001
112400                                                                  11240001
112500         WHEN SQLCODE = +100                                      11250001
112600              SET PS-OTBND-LOC-NOT-FOUND                          11260001
112700                TO  TRUE                                          11270001
112800                                                                  11280001
112900         WHEN SQLWARN0 NOT = SPACES                               11290001
113000         WHEN SQLCODE < +0                                        11300001
113100         WHEN SQLCODE > +0                                        11310001
113200             MOVE '3400-SELECT-OTBND-LOC' TO DP013-PARAGRAPH      11320001
113300             MOVE 'SELECT OUTBOUND LOCATION TABLE'                11330001
113400                             TO DP013-MESSAGE-TEXT (1)            11340001
113500             MOVE DK-SHIPT-UNT-ID-LOC TO                          11350001
113600                  PV-DISPLAY-SHIPT-UNT-ID                         11360001
113700             MOVE PV-DISPLAY-SHIPT-UNT-ID TO                      11370001
113800                  DP013-MESSAGE-TEXT (2)                          11380001
113900             MOVE SQLCA      TO DP013-SQLCA                       11390001
114000             MOVE 'SUT_OTBND_LOC'  TO DP013-DB2-TABLE-NAME (1)    11400001
114100             SET DP013-DB2-ABEND                                  11410001
114200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11420001
114300     END-EVALUATE.                                                11430001
114400*----------------------------------------------------------------*11440001
114500*  CHECK THE CARTON DIVERT TABLE TO SEE IF THE CARTON WAS DIVERTED11450001
114600*  AND NOT ON THE SUT_OTBND_CART TABLE.                           11460001
114700*----------------------------------------------------------------*11470001
114800 3600-SELECT-TSUCRDV.                                             11480001
114900                                                                  11490001
115000     EXEC SQL                                                     11500001
115100        SELECT   ACTV_CDE                                         11510001
115200          INTO :SUCRDV-ACTV-CDE                                   11520001
115300          FROM  TSUCRDV                                           11530001
115400         WHERE  BRCDE_NBR        = :DK-CARTON-ID-2                11540001
115500     END-EXEC.                                                    11550001
115600                                                                  11560001
115700     EVALUATE TRUE                                                11570001
115800         WHEN SQLCODE = +0                                        11580001
115900              MOVE 'DIVERTED CARTON'      TO ACRTMS1O             11590001
116000              MOVE 'NO CARTON INFO '      TO ACRTMS2O             11600001
116100              SET  PS-ERRORS-YES                                  11610001
116200                   PS-INVALID-INPUT       TO TRUE                 11620001
116300         WHEN SQLCODE = +100                                      11630001
116400                                                                  11640015
116600              PERFORM 3700-SELECT-TSHPUNT                         11660015
117300                                                                  11730015
117400         WHEN SQLWARN0 NOT = SPACES                               11740001
117500         WHEN SQLCODE < +0                                        11750001
117600         WHEN SQLCODE > +0                                        11760001
117700             MOVE '3600-SELECT-TSUCRDV' TO DP013-PARAGRAPH        11770001
117800             MOVE 'SELECT DIVERT TABLE'                           11780001
117900                             TO DP013-MESSAGE-TEXT (1)            11790001
118000             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          11800001
118100             MOVE SQLCA      TO DP013-SQLCA                       11810001
118200             MOVE 'TSUCRDV'  TO DP013-DB2-TABLE-NAME (1)          11820001
118300             SET DP013-DB2-ABEND                                  11830001
118400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11840001
118500     END-EVALUATE.                                                11850001
118600                                                                  11860001
118700*----------------------------------------------------------------*11870015
118800*  CHECK THE SHIPPING UNIT TABLE TO VERIFY THE CARTON ID/BARCODE *11880015
118900*  ENTERED IS VALID.                                              11890015
119000*  PARAGRAPH ADD - 2/14/05 - DMH                                  11900015
119100*----------------------------------------------------------------*11910015
119200 3700-SELECT-TSHPUNT.                                             11920015
119300                                                                  11930015
119400     EXEC SQL                                                     11940015
119500        SELECT   SHIPT_UNT_ID                                     11950015
119600                ,ORGN_OPER_UNT_ID                                 11960020
119700                ,DEST_OPER_UNT_ID                                 11970015
119800                ,ACTV_IND                                         11980015
119900                ,CRE_DTE                                          11990015
120000                ,CRE_TM                                           12000015
120100                ,CRE_USR_ID                                       12010015
120200           INTO :SHPUNT-SHIPT-UNT-ID,                             12020017
120300                :SHPUNT-ORGN-OPER-UNT-ID,                         12030018
120400                :SHPUNT-DEST-OPER-UNT-ID,                         12040017
120500                :SHPUNT-ACTV-IND,                                 12050017
120600                :SHPUNT-CRE-DTE,                                  12060017
120700                :SHPUNT-CRE-TM,                                   12070017
120800                :SHPUNT-CRE-USR-ID                                12080019
120900          FROM  TSHPUNT                                           12090015
121000         WHERE  SHIPT_UNT_ID   = :DK-CARTON-ID                    12100015
121100                                                                  12110015
121200     END-EXEC.                                                    12120015
121300                                                                  12130015
121400     EVALUATE TRUE                                                12140015
121500         WHEN SQLCODE = +0                                        12150015
121600              SET PC038-ON-TSHPUNT      TO TRUE                   12160015
121700              MOVE SHPUNT-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID        12170017
121800              MOVE SHPUNT-SHIPT-UNT-ID  TO                        12180017
121900                                  PC038-SHPUNT-SHIPT-UNT-ID       12190015
122000                                                                  12200015
122100     MOVE  SHPUNT-ORGN-OPER-UNT-ID TO PC038-SHPUNT-ORGN-OPER      12210018
122200     MOVE SHPUNT-DEST-OPER-UNT-ID  TO PC038-SHPUNT-DEST-OPER      12220017
122300     MOVE 'ASN'                    TO PC038-SOURCE-ID             12230015
122400                                      PC038-SHPUNT-SOURCE-ID      12240015
122500     MOVE SHPUNT-SHIPT-UNT-ID      TO PC038-ORIG-SHIPT-UNT-ID     12250017
122600                                      DK-SHIPT-UNT-ID-LOC         12260015
122700     MOVE SHPUNT-ACTV-IND          TO PC038-SHPUNT-ACTV-IND       12270017
122800                                                                  12280015
122900     MOVE SHPUNT-CRE-DTE           TO PC038-SHPUNT-CRE-DATE       12290017
123000     MOVE SHPUNT-CRE-TM            TO PC038-SHPUNT-CRE-TIME       12300017
123100                                                                  12310015
123200     MOVE SHPUNT-CRE-USR-ID        TO PC038-SHPUNT-CRE-USR-ID     12320017
123300     SET  PC038-SHPUNT-CRTN-UNKNOWN   TO  TRUE                    12330015
123400                                                                  12340015
123500         WHEN SQLCODE = +100                                      12350015
123600              MOVE PC034-INVALID-CRTN-ID  TO ACRTMS1O             12360015
123700              MOVE SPACES                 TO ACRTMS2O             12370015
123800                                             AMSGLNO              12380015
123900              SET  PS-ERRORS-YES                                  12390015
124000                   PS-INVALID-INPUT       TO TRUE                 12400015
124100                                                                  12410015
124200         WHEN SQLWARN0 NOT = SPACES                               12420015
124300         WHEN SQLCODE < +0                                        12430015
124400         WHEN SQLCODE > +0                                        12440015
124500             MOVE '3700-SELECT-TSHPUNT   ' TO DP013-PARAGRAPH     12450015
124600             MOVE 'VALIDATE CARTON ID/BARCODE'                    12460015
124700                                        TO DP013-MESSAGE-TEXT (1) 12470015
124800             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          12480015
124900             MOVE SQLCA      TO DP013-SQLCA                       12490015
125000             MOVE 'TSHPUNT ' TO DP013-DB2-TABLE-NAME (1)          12500015
125100             SET DP013-DB2-ABEND                                  12510015
125200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12520015
125300     END-EVALUATE.                                                12530015
125400                                                                  12540015
125500                                                                  12550015
125600*----------------------------------------------------------------*12560001
125700 8000-SEND-MAP.                                                   12570001
125800                                                                  12580001
125900     EXEC CICS                                                    12590001
126000         SEND MAP       ('PC880A')                                12600001
126100              MAPSET    ('PCKM880')                               12610001
126200              ERASE                                               12620001
126300              CURSOR                                              12630001
126400              RESP      (PV-CICS-RESPONSE)                        12640001
126500     END-EXEC.                                                    12650001
126600                                                                  12660001
126700     EVALUATE TRUE                                                12670001
126800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12680001
126900             CONTINUE                                             12690001
127000         WHEN OTHER                                               12700001
127100             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          12710001
127200             MOVE 'PCKRF880 - UNABLE TO SEND MAP'                 12720001
127300                                      TO DP013-MESSAGE-TEXT (1)   12730001
127400             SET DP013-CICS-ABEND                                 12740001
127500                 DP013-ROLLBACK       TO TRUE                     12750001
127600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12760001
127700     END-EVALUATE.                                                12770001
127800                                                                  12780001
127900 8010-SEND-DATA-ONLY.                                             12790001
128000                                                                  12800001
128100     MOVE -1                          TO ACARTNL                  12810001
128200     EXEC CICS                                                    12820001
128300         SEND MAP       ('PC880A')                                12830001
128400              MAPSET    ('PCKM880')                               12840001
128500              CURSOR                                              12850001
128600              DATAONLY                                            12860001
128700              RESP      (PV-CICS-RESPONSE)                        12870001
128800     END-EXEC.                                                    12880001
128900                                                                  12890001
129000     EVALUATE TRUE                                                12900001
129100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12910001
129200             CONTINUE                                             12920001
129300         WHEN OTHER                                               12930001
129400             MOVE '8010-SEND-DATA-ONLY'                           12940001
129500                                      TO DP013-PARAGRAPH          12950001
129600             MOVE 'PCKRF880 - UNABLE TO SEND DATA'                12960001
129700                                      TO DP013-MESSAGE-TEXT (1)   12970001
129800             SET DP013-CICS-ABEND                                 12980001
129900                 DP013-ROLLBACK       TO TRUE                     12990001
130000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13000001
130100     END-EVALUATE.                                                13010001
130200                                                                  13020001
130300 8020-RECEIVE-MAP.                                                13030001
130400                                                                  13040001
130500     EXEC CICS                                                    13050001
130600         RECEIVE MAP    ('PC880A')                                13060001
130700                 MAPSET ('PCKM880')                               13070001
130800                 RESP   (PV-CICS-RESPONSE)                        13080001
130900     END-EXEC.                                                    13090001
131000                                                                  13100001
131100     EVALUATE TRUE                                                13110001
131200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13120001
131300             CONTINUE                                             13130001
131400         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                13140001
131500             CONTINUE                                             13150001
131600         WHEN OTHER                                               13160001
131700            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       13170001
131800            MOVE 'PCKRF880 - UNABLE TO RECEIVE MAP'               13180001
131900                                         TO DP013-MESSAGE-TEXT (1)13190001
132000            SET DP013-LOGIC-ABEND        TO TRUE                  13200001
132100            SET DP013-ROLLBACK           TO TRUE                  13210001
132200            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                13220001
132300     END-EVALUATE.                                                13230001
132400                                                                  13240001
132500 8100-RETURN-TRANID.                                              13250001
132600                                                                  13260001
132700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       13270001
132800     EXEC CICS                                                    13280001
132900         RETURN TRANSID  (PC-TRANID)                              13290001
133000                COMMAREA (CA-COMMAREA)                            13300001
133100                LENGTH   (PV-COMMAREA-LENGTH)                     13310001
133200                RESP     (PV-CICS-RESPONSE)                       13320001
133300     END-EXEC.                                                    13330001
133400                                                                  13340001
133500     EVALUATE TRUE                                                13350001
133600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13360001
133700             CONTINUE                                             13370001
133800         WHEN OTHER                                               13380001
133900             MOVE '8100-RETURN-TRANIND' TO DP013-PARAGRAPH        13390001
134000             MOVE 'PCKRF880 - UNABLE TO RETURN TO TRANID'         13400001
134100                 TO DP013-MESSAGE-TEXT (1)                        13410001
134200             SET DP013-CICS-ABEND       TO TRUE                   13420001
134300             SET DP013-ROLLBACK         TO TRUE                   13430001
134400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13440001
134500     END-EVALUATE.                                                13450001
134600                                                                  13460001
134700 8110-RETURN.                                                     13470001
134800                                                                  13480001
134900     EXEC CICS                                                    13490001
135000         SEND FROM (PV-MESSAGE-AREA)                              13500001
135100              LENGTH (19)                                         13510001
135200              ERASE                                               13520001
135300     END-EXEC.                                                    13530001
135400                                                                  13540001
135500     EXEC CICS                                                    13550001
135600         RETURN                                                   13560001
135700     END-EXEC.                                                    13570001
135800                                                                  13580001
135900 8200-XCTL.                                                       13590001
136000     SET PC038-INITIALIZE-SCREEN      TO TRUE.                    13600001
136100     MOVE PC-CURRENT-PROGRAM-NAME     TO PC038-LAST-PROGRAM.      13610001
136200     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       13620001
136300                                                                  13630001
136400     EXEC CICS                                                    13640001
136500         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    13650001
136600               COMMAREA  (CA-COMMAREA)                            13660001
136700               LENGTH    (PV-COMMAREA-LENGTH)                     13670001
136800               RESP      (PV-CICS-RESPONSE)                       13680001
136900     END-EXEC.                                                    13690001
137000                                                                  13700001
137100     EVALUATE TRUE                                                13710001
137200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13720001
137300             CONTINUE                                             13730001
137400         WHEN OTHER                                               13740001
137500             MOVE '8200-XCTL'                                     13750001
137600                                      TO DP013-PARAGRAPH          13760001
137700             MOVE 'PCKRF880 - UNABLE TO XCTL TO PROGRAM: '        13770001
137800                                      TO DP013-MESSAGE-TEXT (1)   13780001
137900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   13790001
138000             SET DP013-CICS-ABEND                                 13800001
138100                 DP013-ROLLBACK       TO TRUE                     13810001
138200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13820001
138300             MOVE PM-TRANS-UNAVAILABLE-MSG                        13830001
138400                                      TO AMSGLNO                  13840001
138500             MOVE SPACES              TO ACRTMS1O                 13850001
138600                                         ACRTMS2O                 13860001
138700             MOVE -1                  TO ACARTNL                  13870001
138800             SET PC038-PROCESS-SCREEN TO TRUE                     13880001
138900             MOVE -1                  TO ACARTNL                  13890001
139000             PERFORM 8000-SEND-MAP                                13900001
139100             PERFORM 8100-RETURN-TRANID                           13910001
139200     END-EVALUATE.                                                13920001
139300                                                                  13930001
139400 8210-XCTL.                                                       13940001
139500     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    13950001
139600     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      13960001
139700     MOVE LENGTH OF CA-PC233          TO PV-COMMAREA-LENGTH       13970001
139800                                                                  13980001
140100*    THIS IS A TEMPORARY PATCH UNTIL WE FIGURE OUT WHY THE        14010001
140200*    COMMAREA IS BEING CORRUPTED.                                 14020001
140300     IF PV-TRANSFER-PROGRAM = SPACES                              14030001
140400         MOVE 'MPKCS027' TO PV-TRANSFER-PROGRAM                   14040001
140500     END-IF                                                       14050001
140600                                                                  14060001
140700                                                                  14070001
140800     EXEC CICS                                                    14080001
140900         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    14090001
141000               COMMAREA  (CA-PC233)                               14100001
141100               LENGTH    (PV-COMMAREA-LENGTH)                     14110001
141200               RESP      (PV-CICS-RESPONSE)                       14120001
141300     END-EXEC.                                                    14130001
141400                                                                  14140001
141500     EVALUATE TRUE                                                14150001
141600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14160001
141700             CONTINUE                                             14170001
141800         WHEN OTHER                                               14180001
141900             MOVE '8210-XCTL'                                     14190001
142000                                      TO DP013-PARAGRAPH          14200001
142100             MOVE 'PCKRF880 - UNABLE TO XCTL TO PROGRAM: '        14210001
142200                                      TO DP013-MESSAGE-TEXT (1)   14220001
142300             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14230001
142400             SET DP013-CICS-ABEND                                 14240001
142500                 DP013-ROLLBACK       TO TRUE                     14250001
142600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14260001
142700             MOVE PM-TRANS-UNAVAILABLE-MSG                        14270001
142800                                      TO AMSGLNO                  14280001
142900             MOVE SPACES              TO ACRTMS1O                 14290001
143000                                         ACRTMS2O                 14300001
143100             MOVE -1                  TO ACARTNL                  14310001
143200             SET PC038-PROCESS-SCREEN TO TRUE                     14320001
143300             MOVE -1                  TO ACARTNL                  14330001
143400             PERFORM 8000-SEND-MAP                                14340001
143500             PERFORM 8100-RETURN-TRANID                           14350001
143600     END-EVALUATE.                                                14360001
143700                                                                  14370001
143800 8220-XCTL-TO-HELP.                                               14380001
143900                                                                  14390001
144000     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       14400001
144100                                                                  14410001
144200     EXEC CICS                                                    14420001
144300         XCTL                                                     14430001
144400             PROGRAM   (PV-TRANSFER-PROGRAM)                      14440001
144500             COMMAREA  (PC192-COMMAREA)                           14450001
144600             LENGTH    (PV-COMMAREA-LENGTH)                       14460001
144700             RESP      (PV-CICS-RESPONSE)                         14470001
144800     END-EXEC.                                                    14480001
144900                                                                  14490001
145000     EVALUATE TRUE                                                14500001
145100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14510001
145200              CONTINUE                                            14520001
145300         WHEN OTHER                                               14530001
145400             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          14540001
145500             MOVE 'PCKRF880 - UNABLE TO XCTL TO PROGRAM: '        14550001
145600                                      TO DP013-MESSAGE-TEXT (1)   14560001
145700             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14570001
145800             SET DP013-CICS-ABEND                                 14580001
145900                 DP013-ROLLBACK       TO TRUE                     14590001
146000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14600001
146100             MOVE PM-TRANS-UNAVAILABLE-MSG                        14610001
146200                                      TO AMSGLNO                  14620001
146300             MOVE SPACES              TO ACRTMS1O                 14630001
146400                                         ACRTMS2O                 14640001
146500             SET PC038-PROCESS-SCREEN TO TRUE                     14650001
146600             MOVE -1                  TO ACARTNL                  14660001
146700             PERFORM 8000-SEND-MAP                                14670001
146800             PERFORM 8100-RETURN-TRANID                           14680001
146900     END-EVALUATE.                                                14690001
147000                                                                  14700029
147100 8230-XCTL-TO-E881.                                               14710001
147200                                                                  14720001
147300     SET PC038-INITIALIZE-SCREEN      TO TRUE.                    14730001
147400     MOVE PC-CURRENT-PROGRAM-NAME     TO PC038-LAST-PROGRAM.      14740001
147500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       14750001
147600     MOVE 'PCKRF881'                  TO PV-TRANSFER-PROGRAM      14760001
147700                                                                  14770001
147800     EXEC CICS                                                    14780001
147900         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    14790001
148000               COMMAREA  (CA-COMMAREA)                            14800001
148100               LENGTH    (PV-COMMAREA-LENGTH)                     14810001
148200               RESP      (PV-CICS-RESPONSE)                       14820001
148300     END-EXEC.                                                    14830001
148400                                                                  14840001
148500     EVALUATE TRUE                                                14850001
148600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14860001
148700             CONTINUE                                             14870001
148800         WHEN OTHER                                               14880001
148900             MOVE '8230-XCTL-TO-E881'                             14890001
149000                                      TO DP013-PARAGRAPH          14900001
149100             MOVE 'PCKRF880 - UNABLE TO XCTL TO PROGRAM: '        14910001
149200                                      TO DP013-MESSAGE-TEXT (1)   14920001
149300             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14930001
149400             SET DP013-CICS-ABEND                                 14940001
149500                 DP013-ROLLBACK       TO TRUE                     14950001
149600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14960001
149700             MOVE PM-TRANS-UNAVAILABLE-MSG                        14970001
149800                                      TO AMSGLNO                  14980001
149900             MOVE SPACES              TO ACRTMS1O                 14990001
150000                                         ACRTMS2O                 15000001
150100             MOVE -1                  TO ACARTNL                  15010001
150200             SET PC038-PROCESS-SCREEN TO TRUE                     15020001
150300             PERFORM 8000-SEND-MAP                                15030001
150400             PERFORM 8100-RETURN-TRANID                           15040001
150500     END-EVALUATE.                                                15050001
150600                                                                  15060029
150700 9000-SOFT-ABORT.                                                 15070001
150800                                                                  15080001
150900     EXEC CICS                                                    15090001
151000         SYNCPOINT ROLLBACK                                       15100001
151100     END-EXEC                                                     15110001
151200                                                                  15120001
151300     MOVE 'DB2 ACCESS ERROR'          TO AMSGLNO.                 15130001
151400     MOVE SPACES                      TO ACRTMS1O                 15140001
151500                                         ACRTMS2O                 15150001
151600     PERFORM 8010-SEND-DATA-ONLY                                  15160001
151700     PERFORM 8100-RETURN-TRANID.                                  15170001
151800                                                                  15180001
151900 9903-WRITE-CICS-LOG.                                             15190001
152000                                                                  15200001
152200     STRING PC038-SOURCE-ID '-'                                   15220001
152300            PC038-STATUS DELIMITED BY SIZE                        15230001
152400                                      INTO PV-DISPLAY-FAST        15240001
152500     MOVE PC038-CARTON-ID-ENTERED     TO PV-CARTON-ID-ENTERED     15250001
152600     MOVE PC038-SOURCE-ID             TO PV-SOURCE-ID             15260001
152700     MOVE PC038-STATUS                TO PV-STATUS                15270001
152800                                                                  15280001
152900     EXEC CICS                                                    15290001
153000         WRITEQ TD                                                15300001
153100             QUEUE  ('CSSL')                                      15310001
153200             FROM   (PV-LOG-MSG)                                  15320001
153300             RESP   (PV-CICS-RESPONSE)                            15330001
153400     END-EXEC.                                                    15340001
153500                                                                  15350001
153600 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  15360001
153700                                                                  15370001
153800     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           15380001
153900     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          15390001
154000     INITIALIZE DP013-SRC-TASK-NUMBER                             15400001
154100                DP013-STACK.                                      15410001
154200     SET DP013-LINK-RETURN            TO TRUE.                    15420001
154300                                                                  15430001
154400     EXEC CICS                                                    15440001
154500         LINK                                                     15450001
154600             PROGRAM   (DP013-NAME)                               15460001
154700             COMMAREA  (DP013-PARAMETERS)                         15470001
154800             LENGTH    (DP013-LENGTH)                             15480001
154900     END-EXEC.                                                    15490001
155000                                                                  15500001
155100*----------------------------------------------------------------*15510001
155200*    ABEND PROCESSOR MODULE                                      *15520001
155300*----------------------------------------------------------------*15530001
155400                                                                  15540001
155500     COPY DPPD014.                                                15550001
155600                                                                  15560001
