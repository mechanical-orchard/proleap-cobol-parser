000100 IDENTIFICATION DIVISION.                                         00010005
000200 PROGRAM-ID.             TMKRP016.                                00020005
000300 AUTHOR.                 VIRGENE LENNEMAN.                        00030005
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040005
000500 DATE-WRITTEN            01/07/98.                                00050005
000600 DATE-COMPILED.                                                   00060005
000700                                                                  00070005
000800 ENVIRONMENT DIVISION.                                            00080005
000900 INPUT-OUTPUT SECTION.                                            00090005
001000                                                                  00100005
001100 FILE-CONTROL.                                                    00110005
001200                                                                  00120005
001300     SELECT TROUBLE-EXTRACT-FILE      ASSIGN TO INP01.            00130005
001400     SELECT TROUBLE-REPORT            ASSIGN TO RPT01.            00140035
001500     SELECT NOTIFICATION-REPORT       ASSIGN TO RPT02.            00150005
001600                                                                  00160005
001700                                                                  00170005
001800 DATA DIVISION.                                                   00180005
001900                                                                  00190005
002000 FILE SECTION.                                                    00200005
002100 FD  TROUBLE-EXTRACT-FILE                                         00210005
002200     RECORDING MODE IS F                                          00220005
002300     LABEL RECORDS ARE STANDARD                                   00230005
002400     BLOCK CONTAINS 0 RECORDS.                                    00240005
002500                                                                  00250005
002600 01  TROUBLE-EXTRACT-RECORD         PIC X(400).                   00260005
002700                                                                  00270005
002800 FD  TROUBLE-REPORT                                               00280036
002900     RECORDING MODE IS F                                          00290036
003000     LABEL RECORDS ARE STANDARD                                   00300036
003100     BLOCK CONTAINS 0 RECORDS.                                    00310036
003200                                                                  00320036
003300 01  TROUBLE-RECORD                 PIC X(132).                   00330036
003400                                                                  00340036
003500 FD  NOTIFICATION-REPORT                                          00350005
003600     RECORDING MODE IS F                                          00360005
003700     LABEL RECORDS ARE STANDARD                                   00370005
003800     BLOCK CONTAINS 0 RECORDS.                                    00380005
003900                                                                  00390005
004000 01  NOTIFICATION-RECORD            PIC X(132).                   00400005
004100                                                                  00410005
004200 WORKING-STORAGE SECTION.                                         00420005
004300 01  PS-SWITCHES.                                                 00430005
004400     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     00440005
004500         88  PS-EOF                                VALUE 'Y'.     00450005
004600         88  PS-NOT-EOF                            VALUE 'N'.     00460005
004700                                                                  00470036
004800 01  PC-PROGRAM-CONSTANTS.                                        00480036
004900     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00490036
005000                                    'TMKRP010'.                   00500036
005100     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00510036
005200                                                   COMP SYNC.     00520036
005300     05  PC-SPECIAL-RUN-NOTE         PIC X(27)     VALUE          00530036
005400                                    '** SPECIAL REQUESTED RUN **'.00540036
005500     05  PC-ONE                      PIC 9(01)     VALUE  1.      00550036
005600     05  PC-TWO                      PIC 9(01)     VALUE  2.      00560036
005700******  13 BYTE FIELDS USED IN HL2-REPORT-PERIOD FIELD            00570036
005800     05  PC-CAL-YR13            PIC X(13)  VALUE 'CALENDAR YEAR'. 00580036
005900     05  PC-FIS-YR13            PIC X(13)  VALUE '  FISCAL YEAR'. 00590036
006000     05  PC-SPRING-SEAS13       PIC X(13)  VALUE 'SPRING SEASON'. 00600036
006100     05  PC-FALL-SEAS13         PIC X(13)  VALUE '  FALL SEASON'. 00610036
006200     05  PC-MONTH13             PIC X(13)  VALUE '        MONTH'. 00620036
006300     05  PC-WEEK13              PIC X(13)  VALUE '         WEEK'. 00630036
006400******  11 BYTE FIELDS USED IN TL1-REPORT-PERIOD FIELD            00640036
006500     05  PC-CAL-YR11            PIC X(11)  VALUE 'CALENDAR YR'.   00650036
006600     05  PC-FIS-YR11            PIC X(11)  VALUE '  FISCAL YR'.   00660036
006700     05  PC-SEASON11            PIC X(11)  VALUE '     SEASON'.   00670036
006800     05  PC-MONTH11             PIC X(11)  VALUE '      MONTH'.   00680036
006900     05  PC-WEEK11              PIC X(11)  VALUE '       WEEK'.   00690036
007000     05  PC-AVERAGE                  PIC X(07)   VALUE 'AVERAGE'. 00700036
007100     05  PC-TIME-TO-RESOLVE          PIC X(15)   VALUE            00710036
007200                                         'TIME TO RESOLVE'.       00720036
007300     05  PC-PERCENT                  PIC X(01)   VALUE '%'.       00730036
007400     05  PC-TOTAL               PIC X(12)  VALUE '       TOTAL'.  00740036
007500     05  PC-NTFY-TOTAL          PIC X(12)  VALUE 'TOTAL NOTIFY'.  00750036
007600                                                                  00760036
007700 01  PV-PROGRAM-VARIABLES.                                        00770036
007800     05  PV-SPECIAL-RUN-DATES.                                    00780036
007900         10  FILLER                  PIC X(02)     VALUE '* '.    00790036
008000         10  PV-SPECIAL-START-DT     PIC X(10)     VALUE SPACES.  00800036
008100         10  FILLER                  PIC X(03)     VALUE ' - '.   00810036
008200         10  PV-SPECIAL-END-DT       PIC X(10)     VALUE SPACES.  00820036
008300         10  FILLER                  PIC X(02)     VALUE ' *'.    00830036
008400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00840037
008500                                                   COMP SYNC.     00850037
008600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  00860037
008700     05  PV-ABEND-SQLCODE            PIC  X(10)    VALUE SPACES.  00870037
008800     05  PV-TRBL-LINE-COUNT          PIC S9(04)    VALUE +80      00880036
008900                                                   COMP SYNC.     00890036
009000     05  PV-TRBL-PAGE-COUNT          PIC S9(04)    VALUE 0        00900036
009100                                                   COMP SYNC.     00910036
009200     05  PV-NTFY-LINE-COUNT          PIC S9(04)    VALUE +80      00920036
009300                                                   COMP SYNC.     00930036
009400     05  PV-NTFY-PAGE-COUNT          PIC S9(04)    VALUE 0        00940036
009500                                                   COMP SYNC.     00950036
009600     05  PV-VER-REC-COUNT            PIC S9(10)    VALUE 0        00960036
009700                                                   COMP-3.        00970036
009800     05  PV-VER-INTRBL-COUNT         PIC S9(10)    VALUE 0        00980036
009900                                                   COMP-3.        00990036
010000     05  PV-RCVRS-IN-TRBL-COUNT      PIC S9(10)    VALUE 0        01000037
010100                                                   COMP-3.        01010037
010200     05  PV-START-DATE               PIC  X(10)    VALUE SPACE.   01020036
010300     05  PV-END-DATE                 PIC  X(10)    VALUE SPACE.   01030036
010400     05  PV-REPORT-NAME              PIC  X(08)  VALUE 'TMKRP016'.01040044
010500     05  PV-START-EXTRACT.                                        01050036
010600         10 PV-START-YYYY.                                        01060036
010700            15 PV-START-CC           PIC 9(02)     VALUE 0.       01070036
010800            15 PV-START-YY           PIC 9(02)     VALUE 0.       01080036
010900         10 FILLER                   PIC X(01)     VALUE SPACE.   01090036
011000         10 PV-START-MM              PIC 9(02)     VALUE 0.       01100036
011100         10 FILLER                   PIC X(01)     VALUE SPACE.   01110036
011200         10 PV-START-DD              PIC 9(02)     VALUE 0.       01120036
011300         10 FILLER                   PIC X(01)     VALUE SPACE.   01130036
011400     05  PV-END-EXTRACT.                                          01140036
011500         10 PV-END-YYYY.                                          01150036
011600            15 PV-END-CC             PIC 9(02)     VALUE 0.       01160036
011700            15 PV-END-YY             PIC 9(02)     VALUE 0.       01170036
011800         10 FILLER                   PIC X(01)     VALUE SPACE.   01180036
011900         10 PV-END-MM                PIC 9(02)     VALUE 0.       01190036
012000         10 FILLER                   PIC X(01)     VALUE SPACE.   01200036
012100         10 PV-END-DD                PIC 9(02)     VALUE 0.       01210036
012200         10 FILLER                   PIC X(01)     VALUE SPACE.   01220036
012300     05  PV-PER-TO-TOT              PIC 9(3)V99  VALUE 0 COMP-3.  01230036
012400     05  PV-PER-OF-VER-REC          PIC 9(3)V99  VALUE 0 COMP-3.  01240036
012500     05  PV-TOT-TROUBLE-SAVE        PIC S9(9)    VALUE 0 COMP-3.  01250036
012600     05  PV-FIN-TOT-TRBL            PIC S9(07)   VALUE 0 COMP-3.  01260036
012700     05  PV-FIN-TOT-NTFY            PIC S9(07)   VALUE 0 COMP-3.  01270036
012800     05  PV-TIME-OF-TMST            PIC  X(16)   VALUE            01280045
012900                                          '-00.00.00.000000'.     01290045
013000     05  PV-START-TMST              PIC  X(26)   VALUE SPACE.     01300045
013100     05  PV-END-TMST                PIC  X(26)   VALUE SPACE.     01310045
013200                                                                  01320036
013300 01  CT-CPU-TIME.                                                 01330036
013400     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    01340036
013500     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    01350036
013600     03  FILLER                      PIC  9(04)    VALUE ZERO.    01360036
013700                                                                  01370036
013800 01  CD-CPU-DATE.                                                 01380036
013900     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    01390036
014000     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    01400036
014100     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    01410036
014200                                                                  01420036
014300 01  FF-FIELD-FORMATS.                                            01430036
014400     05  FF-ONES.                                                 01440036
014500         10  FILLER                  PIC   X(01)  VALUE '('.      01450036
014600         10  FF-ONES-QTY             PIC   9(01).                 01460036
014700         10  FILLER                  PIC   X(07)  VALUE ')      '.01470036
014800     05  FF-TENS.                                                 01480036
014900         10  FILLER                  PIC   X(01)  VALUE '('.      01490036
015000         10  FF-TENS-QTY             PIC   9(02).                 01500036
015100         10  FILLER                  PIC   X(06)  VALUE ')     '. 01510036
015200     05  FF-HUNDREDS.                                             01520036
015300         10  FILLER                  PIC   X(01)  VALUE '('.      01530036
015400         10  FF-HUNDREDS-QTY         PIC   9(03).                 01540036
015500         10  FILLER                  PIC   X(05)  VALUE ')    '.  01550036
015600     05  FF-THOUSANDS.                                            01560036
015700         10  FILLER                  PIC   X(01)  VALUE '('.      01570036
015800         10  FF-THOUSANDS-QTY        PIC   9,999.                 01580036
015900         10  FILLER                  PIC   X(03)  VALUE ')  '.    01590036
016000     05  FF-10-THOUSANDS.                                         01600036
016100         10  FILLER                  PIC   X(01)  VALUE '('.      01610036
016200         10  FF-10-THOUSANDS-QTY     PIC   99,999.                01620036
016300         10  FILLER                  PIC   X(02)  VALUE ') '.     01630036
016400     05  FF-100-THOUSANDS.                                        01640036
016500         10  FILLER                  PIC   X(01)  VALUE '('.      01650036
016600         10  FF-100-THOUSANDS-QTY    PIC   999,999.               01660036
016700         10  FILLER                  PIC   X(01)  VALUE ')'.      01670036
016800     05  FF-MILLIONS.                                             01680036
016900         10  FILLER                  PIC   X(01)  VALUE '('.      01690036
017000         10  FF-MILLIONS-QTY         PIC   9,999,999.             01700036
017100         10  FILLER                  PIC   X(01)  VALUE ')'.      01710036
017200                                                                  01720036
017300     COPY DPWS132O.                                               01730036
017400                                                                  01740036
017500***** TROUBLE HEADING LINE                                        01750036
017600 01  HL1-HEADING-LINE-1A.                                         01760036
017700     05  FILLER                      PIC  X(02)    VALUE SPACES.  01770036
017800     05  HL1A-SPECIAL-RUN-NOTE       PIC  X(27)    VALUE SPACES.  01780036
017900     05  FILLER                      PIC  X(23)    VALUE SPACES.  01790036
018000     05  FILLER                      PIC  X(30)    VALUE          01800036
018100                              'TROUBLE SUMMARY BY REASON CODE'.   01810036
018200     05  FILLER                      PIC  X(50)    VALUE SPACES.  01820036
018300                                                                  01830036
018400***** NOTIFICATION HEADING LINE                                   01840036
018500 01  HL1-HEADING-LINE-1B.                                         01850036
018600     05  FILLER                      PIC  X(02)    VALUE SPACES.  01860036
018700     05  HL1B-SPECIAL-RUN-NOTE       PIC  X(27)    VALUE SPACES.  01870036
018800     05  FILLER                      PIC  X(20)    VALUE SPACES.  01880036
018900     05  FILLER                      PIC  X(35)    VALUE          01890036
019000                  'NOTIFICATION SUMMARY BY REASON CODE'.          01900036
019100     05  FILLER                      PIC  X(48)    VALUE SPACES.  01910036
019200                                                                  01920036
019300 01  HL2-HEADING-LINE-2.                                          01930036
019400     05  FILLER                      PIC  X(02)    VALUE SPACES.  01940036
019500     05  HL2-SPECIAL-RUN-DATES       PIC  X(27)    VALUE SPACES.  01950036
019600     05  FILLER                      PIC  X(18)    VALUE SPACES.  01960036
019700     05  HL2-REPORT-PERIOD           PIC  X(13)    VALUE SPACES.  01970036
019800     05  FILLER                      PIC  X(01)    VALUE SPACES.  01980036
019900     05  FILLER                      PIC  X(06)    VALUE          01990036
020000                                      'ENDING'.                   02000036
020100     05  FILLER                      PIC  X(01)    VALUE SPACES.  02010036
020200     05  HL2-END-DATE                PIC  X(10)    VALUE SPACES.  02020036
020300     05  FILLER                      PIC  X(48)    VALUE SPACES.  02030036
020400                                                                  02040036
020500 01  HL3-HEADING-LINE-3.                                          02050036
020600     05  FILLER                      PIC  X(30)    VALUE SPACES.  02060036
020700     05  FILLER                      PIC  X(07)    VALUE          02070036
020800                                                     'TROUBLE'.   02080036
020900     05  FILLER                      PIC  X(27)    VALUE SPACE.   02090036
021000     05  FILLER                      PIC  X(07)    VALUE          02100036
021100                                                     'CREATED'.   02110036
021200     05  FILLER                      PIC  X(23)   VALUE SPACES.   02120036
021300     05  HL3-AVERAGE                 PIC  X(07)   VALUE 'AVERAGE'.02130036
021400     05  FILLER                      PIC  X(31)    VALUE SPACES.  02140036
021500                                                                  02150036
021600 01  HL4-HEADING-LINE-4.                                          02160036
021700     05  FILLER                      PIC  X(30)    VALUE SPACES.  02170036
021800     05  FILLER                      PIC  X(06)    VALUE 'REASON'.02180036
021900     05  FILLER                      PIC  X(03)    VALUE SPACE.   02190036
022000     05  FILLER                      PIC  X(19)    VALUE          02200036
022100                                            'TROUBLE DESCRIPTION'.02210036
022200     05  FILLER                      PIC  X(06)    VALUE SPACES.  02220036
022300     05  FILLER                      PIC  X(08)    VALUE          02230036
022400                                            'QUANTITY'.           02240036
022500     05  FILLER                      PIC  X(06)    VALUE SPACES.  02250036
022600     05  FILLER                      PIC  X(10)    VALUE          02260036
022700                                            '% TO TOTAL'.         02270036
022800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02280036
022900     05  HL4-TIME-TO-RESOLVE         PIC  X(15)    VALUE SPACES.  02290036
023000     05  FILLER                      PIC  X(27)    VALUE SPACES.  02300036
023100                                                                  02310036
023200 01  DL1-AVG-TIME-FIELDS.                                         02320036
023300     05  DL1-AVG-RESOLVE-HHH         PIC  Z(2)9    VALUE ZEROS.   02330036
023400     05  DL1-COLON                   PIC  X(01)    VALUE ':'.     02340036
023500     05  DL1-AVG-RESOLVE-MM          PIC  9(02)    VALUE ZEROS.   02350036
023600                                                                  02360036
023700 01  DL1-DETAIL-LINE-1.                                           02370036
023800     05  FILLER                      PIC  X(31)    VALUE SPACES.  02380036
023900     05  DL1-TROUBLE-NBR             PIC  Z(3)9    VALUE ZEROS.   02390036
024000     05  FILLER                      PIC  X(04)    VALUE SPACES.  02400036
024100     05  DL1-TROUBLE-DESCRIPTION     PIC  X(20)    VALUE SPACES.  02410036
024200     05  FILLER                      PIC  X(04)    VALUE SPACE.   02420036
024300     05  DL1-ASSIGNED-QTY            PIC  Z,ZZZ,ZZ9   VALUE ZEROS.02430036
024400     05  FILLER                      PIC  X(07)    VALUE SPACE.   02440036
024500     05  DL1-PER-TO-TOTAL            PIC  ZZ9.99   VALUE ZEROS.   02450036
024600     05  DL1-PERCENT                 PIC  X(01)    VALUE '%'.     02460036
024700     05  FILLER                      PIC  X(08)    VALUE SPACE.   02470036
024800     05  DL1-AVG-TIME                PIC  X(06)    VALUE SPACES.  02480036
024900     05  FILLER                      PIC  X(32)    VALUE SPACE.   02490036
025000                                                                  02500036
025100 01  TL1-TOTAL-LINE-1.                                            02510036
025200     05  FILLER                      PIC X(02)  VALUE SPACES.     02520036
025300     05  FILLER                      PIC X(26)  VALUE             02530036
025400                             'TOTAL TROUBLE CREATED FOR '.        02540036
025500     05  TL1-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     02550036
025600     05  FILLER                      PIC X(08)  VALUE             02560036
025700                                                      ' ENDING '. 02570036
025800     05  TL1-DATE                    PIC X(10)  VALUE SPACES.     02580036
025900     05  FILLER                      PIC X(08)  VALUE SPACES.     02590036
026000     05  FILLER                      PIC X(01)  VALUE '-'.        02600036
026100     05  FILLER                      PIC X(01)  VALUE SPACE.      02610036
026200     05  TL1-TROUBLE-TOTAL           PIC Z,ZZZ,ZZ9.               02620036
026300     05  FILLER                      PIC X(49)  VALUE SPACE.      02630036
026400                                                                  02640036
026500 01  TL2-TOTAL-LINE-2.                                            02650036
026600     05  FILLER                      PIC X(02)  VALUE SPACES.     02660036
026700     05  FILLER                      PIC X(34)  VALUE             02670036
026800                           'TOTAL NOTIFY TROUBLE CREATED FOR '.   02680036
026900     05  TL2-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     02690036
027000     05  FILLER                      PIC X(08)  VALUE             02700036
027100                                                      ' ENDING '. 02710036
027200     05  TL2-DATE                    PIC X(10)  VALUE SPACES.     02720036
027300     05  FILLER                      PIC X(01)  VALUE SPACES.     02730036
027400     05  FILLER                      PIC X(01)  VALUE '-'.        02740036
027500     05  FILLER                      PIC X(01)  VALUE SPACE.      02750036
027600     05  TL2-TROUBLE-TOTAL           PIC Z,ZZZ,ZZ9.               02760036
027700     05  FILLER                      PIC X(49)  VALUE SPACE.      02770036
027800                                                                  02780036
027900                                                                  02790036
028000 01  TL3-TOTAL-LINE-3.                                            02800036
028100     05  FILLER                      PIC X(02)  VALUE SPACES.     02810036
028200     05  FILLER                      PIC X(29)  VALUE             02820036
028300                             'TOTAL RECEIVERS VERIFIED FOR '.     02830036
028400     05  TL3-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     02840036
028500     05  FILLER                      PIC X(08)  VALUE ' ENDING '. 02850036
028600     05  TL3-DATE                    PIC X(10)  VALUE SPACES.     02860036
028700     05  FILLER                      PIC X(05)  VALUE SPACES.     02870036
028800     05  FILLER                      PIC X(01)  VALUE '-'.        02880036
028900     05  FILLER                      PIC X(01)  VALUE SPACE.      02890036
029000     05  TL3-VER-REC-TOTAL           PIC Z,ZZZ,ZZ9.               02900036
029100     05  FILLER                      PIC X(49)  VALUE SPACE.      02910036
029200                                                                  02920036
029300 01  TL4-TOTAL-LINE-4.                                            02930036
029400     05  FILLER                      PIC X(02)  VALUE SPACES.     02940036
029500     05  FILLER                      PIC X(41)  VALUE             02950036
029600                  'PERCENT OF VERIFIED RECEIVERS IN TROUBLE'.     02960036
029700     05  FILLER                      PIC X(22)  VALUE SPACES.     02970036
029800     05  FILLER                      PIC X(01)  VALUE '-'.        02980036
029900     05  FILLER                      PIC X(04)  VALUE SPACE.      02990036
030000     05  TL4-PER-OF-VER-REC          PIC Z(02)9.99.               03000036
030100     05  FILLER                      PIC X(02)  VALUE SPACES.     03010036
030200     05  TL4-RCVRS-VER-TRBL          PIC X(09)  VALUE SPACES.     03020036
030300     05  FILLER                      PIC X(56)  VALUE SPACE.      03030036
030400                                                                  03040036
030500 01  TL5-TOTAL-LINE-5.                                            03050036
030600     05  FILLER                      PIC X(02)  VALUE SPACES.     03060036
030700     05  FILLER                      PIC X(41)  VALUE             03070036
030800                  'TOTAL RECEIVERS IN TROUBLE              '.     03080036
030900     05  FILLER                      PIC X(22)  VALUE SPACES.     03090036
031000     05  FILLER                      PIC X(01)  VALUE '-'.        03100036
031100     05  FILLER                      PIC X(01)  VALUE SPACES.     03110036
031200     05  TL5-RCVRS-IN-TRBL           PIC Z,ZZZ,ZZ9.               03120036
031300     05  FILLER                      PIC X(67)  VALUE SPACE.      03130036
031400                                                                  03140036
031500 01  FT1-FINAL-TRBL-TOTLINE.                                      03150036
031600     05  FILLER                      PIC X(30)  VALUE SPACES.     03160036
031700     05  FT1-LEGEND                  PIC X(12)  VALUE SPACES.     03170036
031800     05  FILLER                      PIC X(17)  VALUE             03180036
031900                  ' TROUBLE CREATED:'.                            03190036
032000     05  FILLER                      PIC X(04)  VALUE SPACES.     03200036
032100     05  FT1-TOTAL-TROUBLE           PIC Z,ZZZ,ZZ9.               03210036
032200     05  FILLER                      PIC X(60)  VALUE SPACES.     03220036
032300                                                                  03230036
032400 01  FN1-FINAL-NTFY-TOTLINE.                                      03240036
032500     05  FILLER                      PIC X(30)  VALUE SPACES.     03250036
032600     05  FN1-LEGEND                  PIC X(12)  VALUE SPACES.     03260036
032700     05  FILLER                      PIC X(17)  VALUE             03270036
032800                  ' TROUBLE CREATED:'.                            03280036
032900     05  FILLER                      PIC X(04)  VALUE SPACES.     03290036
033000     05  FN1-TOTAL-NTFY-TROUBLE      PIC Z,ZZZ,ZZ9.               03300036
033100     05  FILLER                      PIC X(60)  VALUE SPACES.     03310036
033200                                                                  03320036
033300 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  03330036
033400                                                                  03340036
033500 01  ER-END-REPORT-LINE.                                          03350036
033600     05  FILLER                      PIC X(56)  VALUE SPACE.      03360036
033700     05  FILLER                      PIC X(19)  VALUE             03370036
033800                                     '** END OF REPORT **'.       03380036
033900     05  FILLER                      PIC X(57) VALUE SPACE.       03390036
034000                                                                  03400036
034100******************************************************************03410040
034200*  DB2 TABLE DECLARATIONS                                         03420040
034300******************************************************************03430040
034400*    TTRBRCN                                                      03440040
034500                                                                  03450040
034600     EXEC SQL                                                     03460040
034700         INCLUDE TTRBRCN                                          03470040
034800     END-EXEC                                                     03480040
034900                                                                  03490040
035000*    TTRBNTF                                                      03500046
035100                                                                  03510046
035200     EXEC SQL                                                     03520046
035300         INCLUDE TTRBNTF                                          03530046
035400     END-EXEC                                                     03540046
035500                                                                  03550046
035600******************************************************************03560040
035700*  COPYBOOKS                                                      03570040
035800******************************************************************03580040
035900                                                                  03590040
036000     COPY DPWS004.                                                03600036
036100                                                                  03610036
036200     COPY TMRD001.                                                03620036
036300                                                                  03630036
036400*---------------------------------------------------------------* 03640036
036500*    DB2 AREA FOR COMMUNICATIONS                                * 03650036
036600*---------------------------------------------------------------* 03660036
036700     EXEC SQL                                                     03670036
036800          INCLUDE SQLCA                                           03680036
036900     END-EXEC.                                                    03690036
037000***************************************************************** 03700036
037100 PROCEDURE DIVISION.                                              03710036
037200***************************************************************** 03720036
037300                                                                  03730036
037400 0000-MAINLINE.                                                   03740036
037500***************************************************************** 03750036
037600*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 03760036
037700***************************************************************** 03770036
037800     PERFORM 0100-INITIALIZE.                                     03780036
037900                                                                  03790036
038000     PERFORM 0200-MAIN-PROCESS                                    03800036
038100           UNTIL  PS-EOF.                                         03810036
038200                                                                  03820036
038300     PERFORM 9999-EOJ.                                            03830036
038400     STOP RUN.                                                    03840036
038500                                                                  03850036
038600                                                                  03860036
038700 0100-INITIALIZE.                                                 03870036
038800      OPEN INPUT  TROUBLE-EXTRACT-FILE                            03880036
038900           OUTPUT TROUBLE-REPORT                                  03890036
039000                  NOTIFICATION-REPORT.                            03900036
039100                                                                  03910036
039200**** READING THE HEADER RECORD.                                   03920036
039300      PERFORM 8000-READ-INPUT.                                    03930036
039400                                                                  03940036
039500      MOVE TM001-RCVRS-VRFYD-QTY TO PV-VER-REC-COUNT              03950036
039600                                    TL3-VER-REC-TOTAL.            03960036
039700*TCR  MOVE TM001-RCVRS-TRBL-QTY  TO TL5-RCVRS-IN-TRBL.            03970036
039900      MOVE TM001-VRFYD-TRBL-QTY  TO PV-VER-INTRBL-COUNT.          03990036
040000      MOVE TM001-RUN-BEGIN-DATE  TO PV-START-EXTRACT.             04000036
040100      MOVE TM001-RUN-END-DATE    TO PV-END-EXTRACT.               04010036
040200      STRING                                                      04020036
040300            PV-END-MM                                             04030036
040400              '/'                                                 04040036
040500            PV-END-DD                                             04050036
040600              '/'                                                 04060036
040700            PV-END-YYYY                                           04070036
040800            DELIMITED BY SIZE                                     04080036
040900                INTO PV-END-DATE                                  04090036
041000      END-STRING.                                                 04100036
041100                                                                  04110045
041200      STRING                                                      04120045
041300           PV-END-YYYY                                            04130045
041400             '-'                                                  04140045
041500           PV-END-MM                                              04150045
041600             '-'                                                  04160045
041700           PV-END-DD                                              04170045
041800           PV-TIME-OF-TMST                                        04180045
041900           DELIMITED BY SIZE                                      04190045
042000               INTO PV-END-TMST                                   04200045
042100      END-STRING.                                                 04210045
042200                                                                  04220036
042300      STRING                                                      04230036
042400            PV-START-MM                                           04240036
042500              '/'                                                 04250036
042600            PV-START-DD                                           04260036
042700              '/'                                                 04270036
042800            PV-START-YYYY                                         04280036
042900            DELIMITED BY SIZE                                     04290036
043000                INTO PV-START-DATE                                04300036
043100      END-STRING.                                                 04310036
043200                                                                  04320045
043300      STRING                                                      04330045
043400           PV-START-YYYY                                          04340045
043500             '-'                                                  04350045
043600           PV-START-MM                                            04360045
043700             '-'                                                  04370045
043800           PV-START-DD                                            04380045
043900           PV-TIME-OF-TMST                                        04390045
044000           DELIMITED BY SIZE                                      04400045
044100               INTO PV-START-TMST                                 04410045
044200      END-STRING.                                                 04420045
044300                                                                  04430036
044310      PERFORM 0150-COUNT-RCVRS-IN-TRBL.                           04431051
044320                                                                  04432051
044400      MOVE PV-END-DATE        TO TL1-DATE                         04440036
044500                                 TL2-DATE                         04450036
044600                                 TL3-DATE                         04460036
044700                                 HL2-END-DATE.                    04470036
044800                                                                  04480036
044900     ACCEPT CT-CPU-TIME          FROM TIME.                       04490036
045000     MOVE   CT-HOUR              TO DP132O-RUN-HOUR.              04500036
045100     MOVE   CT-MINUTE            TO DP132O-RUN-MINUTE.            04510036
045200                                                                  04520036
045300     ACCEPT CD-CPU-DATE          FROM DATE.                       04530036
045400     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              04540036
045500     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             04550036
045600     MOVE CD-DAY                 TO DP132O-RUN-DAY.               04560036
045700                                                                  04570036
045800     MOVE 'TMKRP016'             TO DP132O-PROGRAM-NAME.          04580036
045900                                                                  04590036
046000     EVALUATE TRUE                                                04600036
046100         WHEN TM001-RUN-WEEKLY                                    04610036
046200             MOVE PC-WEEK13       TO HL2-REPORT-PERIOD            04620036
046300             MOVE PC-WEEK11       TO TL1-REPORT-PERIOD            04630036
046400                                     TL2-REPORT-PERIOD            04640036
046500                                     TL3-REPORT-PERIOD            04650036
046600                                                                  04660036
046700         WHEN TM001-RUN-MONTHLY                                   04670036
046800             MOVE PC-MONTH13  TO HL2-REPORT-PERIOD                04680036
046900             MOVE PC-MONTH11  TO TL1-REPORT-PERIOD                04690036
047000                                 TL2-REPORT-PERIOD                04700036
047100                                 TL3-REPORT-PERIOD                04710036
047200                                                                  04720036
047300         WHEN TM001-RUN-FISCAL-YR                                 04730036
047400             MOVE PC-FIS-YR13 TO HL2-REPORT-PERIOD                04740036
047500             MOVE PC-FIS-YR11 TO TL1-REPORT-PERIOD                04750036
047600                                 TL2-REPORT-PERIOD                04760036
047700                                 TL3-REPORT-PERIOD                04770036
047800                                                                  04780036
047900         WHEN TM001-RUN-CALENDAR-YR                               04790036
048000             MOVE PC-CAL-YR13 TO HL2-REPORT-PERIOD                04800036
048100             MOVE PC-CAL-YR11 TO TL1-REPORT-PERIOD                04810036
048200                                 TL2-REPORT-PERIOD                04820036
048300                                 TL3-REPORT-PERIOD                04830036
048400                                                                  04840036
048500         WHEN TM001-RUN-SEASONAL                                  04850036
048600             IF TM001-SPRING-SEASON                               04860036
048700                 MOVE PC-SPRING-SEAS13 TO HL2-REPORT-PERIOD       04870036
048800             ELSE                                                 04880036
048900                 MOVE PC-FALL-SEAS13   TO HL2-REPORT-PERIOD       04890036
049000             END-IF                                               04900036
049100             MOVE PC-SEASON11      TO TL1-REPORT-PERIOD           04910036
049200                                      TL2-REPORT-PERIOD           04920036
049300                                      TL3-REPORT-PERIOD           04930036
049400     END-EVALUATE.                                                04940036
049500                                                                  04950036
049600     IF TM001-RUN-SPECIAL                                         04960036
049700         MOVE PC-SPECIAL-RUN-NOTE TO HL1A-SPECIAL-RUN-NOTE        04970036
049800         MOVE PC-SPECIAL-RUN-NOTE TO HL1B-SPECIAL-RUN-NOTE        04980036
049900         MOVE PV-START-DATE       TO PV-SPECIAL-START-DT          04990036
050000         MOVE PV-END-DATE         TO PV-SPECIAL-END-DT            05000036
050100         MOVE PV-SPECIAL-RUN-DATES TO HL2-SPECIAL-RUN-DATES       05010036
050200     ELSE                                                         05020036
050300         MOVE SPACE               TO HL1A-SPECIAL-RUN-NOTE        05030036
050400         MOVE SPACE               TO HL1B-SPECIAL-RUN-NOTE        05040036
050500         MOVE SPACE               TO HL2-SPECIAL-RUN-DATES        05050036
050600     END-IF.                                                      05060036
050700                                                                  05070036
050800 0150-COUNT-RCVRS-IN-TRBL.                                        05080041
050900                                                                  05090036
050910     EXEC SQL                                                     05091049
051000      SELECT COUNT (*) AS TOT2                                    05100050
051100      INTO  :PV-RCVRS-IN-TRBL-COUNT                               05110049
051300      FROM (SELECT COUNT (*)                                      05130049
051400            FROM   TTRBNTF A                                      05140049
051500                 , TTRBRCN B                                      05150049
051600            WHERE  RPT_PGM_NM     = :PV-REPORT-NAME               05160049
051700            AND   B.TRBL_RSN_CDE  = A.TRBL_RSN_CDE                05170049
051710            AND   NOTIF_TMST      BETWEEN :PV-START-TMST AND      05171049
051720                                          :PV-END-TMST            05172049
052000            GROUP BY                                              05200049
052100                  PO_NBR                                          05210049
052200                , REC_SEQ_NBR ) AS TOT1                           05220050
052210     END-EXEC.                                                    05221049
053600                                                                  05360036
053700     EVALUATE TRUE                                                05370036
053800         WHEN SQLCODE = +0                                        05380039
053900             MOVE PV-RCVRS-IN-TRBL-COUNT TO TL5-RCVRS-IN-TRBL     05390037
054000                                                                  05400037
054100         WHEN SQLCODE = +100                                      05410039
054200             CONTINUE                                             05420038
054300                                                                  05430037
054400         WHEN OTHER                                               05440036
054500              MOVE '0150-COUNT-RCVRS-IN-TRBL' TO                  05450041
054600                   PV-ABEND-PARAGRAPH                             05460037
054700              DISPLAY '******************************'            05470037
054800              DISPLAY 'ABEND IN TMKRP016 '                        05480038
054900              DISPLAY 'PARAGRAPH:0150-COUNT-RCVRS-IN-TBL'         05490038
055000              DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRBRCN'05500038
055100              DISPLAY 'SQLCODE:  ' PV-ABEND-SQLCODE               05510037
055200              DISPLAY '******************************'            05520038
055300              DISPLAY ' '                                         05530042
055400              PERFORM 9998-SQL-ERROR                              05540037
055500      END-EVALUATE.                                               05550036
055600                                                                  05560037
055700 0200-MAIN-PROCESS.                                               05570036
055800     PERFORM 8000-READ-INPUT.                                     05580036
055900                                                                  05590036
056000     IF PS-NOT-EOF                                                05600036
056100         EVALUATE TRUE                                            05610036
056200             WHEN TM001-RECORD-TYPE-FINTOT                        05620036
056300                 IF TM001-REPORT-TROUBLE                          05630036
056400                     PERFORM 0300-TRBL-TOT-LINES                  05640036
056500                 ELSE                                             05650036
056600                     PERFORM 0400-NTFY-TOT-LINES                  05660036
056700                 END-IF                                           05670036
056800             WHEN TM001-RECORD-TYPE-RSNTOT                        05680036
056900                 PERFORM 0600-WRITE-DETAIL-LINES                  05690036
057000         END-EVALUATE                                             05700036
057100     END-IF.                                                      05710036
057200                                                                  05720036
057300 0300-TRBL-TOT-LINES.                                             05730036
057400     IF PV-TRBL-LINE-COUNT > PC-LINE-LIMIT                        05740036
057500         PERFORM 1100-PRINT-COMMON-HEADINGS                       05750036
057600     END-IF.                                                      05760036
057700                                                                  05770036
057800     MOVE TM001-ATL-ASSIGN-TOT-QTY TO TL1-TROUBLE-TOTAL           05780036
057900                                      PV-TOT-TROUBLE-SAVE.        05790036
058000     WRITE TROUBLE-RECORD FROM TL1-TOTAL-LINE-1                   05800036
058100          AFTER ADVANCING 4 LINES.                                05810036
058200     WRITE TROUBLE-RECORD FROM TL3-TOTAL-LINE-3                   05820036
058300          AFTER ADVANCING 1 LINES.                                05830036
058400     IF PV-TOT-TROUBLE-SAVE      > 0                              05840036
058500         IF  PV-VER-REC-COUNT > 0                                 05850036
058600             COMPUTE PV-PER-OF-VER-REC =                          05860036
058700                     PV-VER-INTRBL-COUNT * 100 /                  05870036
058800                     PV-VER-REC-COUNT                             05880036
058900         ELSE                                                     05890036
059000             MOVE 0   TO PV-PER-OF-VER-REC                        05900036
059100         END-IF                                                   05910036
059200     ELSE                                                         05920036
059300         MOVE 0   TO PV-PER-OF-VER-REC                            05930036
059400     END-IF                                                       05940036
059500     MOVE  PV-PER-OF-VER-REC   TO TL4-PER-OF-VER-REC.             05950036
059600     PERFORM 0500-MOVE-INTRBL.                                    05960036
059700     WRITE TROUBLE-RECORD FROM TL4-TOTAL-LINE-4                   05970036
059800          AFTER ADVANCING 1 LINES.                                05980036
059900     WRITE TROUBLE-RECORD FROM TL5-TOTAL-LINE-5                   05990036
060000          AFTER ADVANCING 1 LINES.                                06000036
060100     ADD 7   TO PV-TRBL-LINE-COUNT.                               06010036
060200     PERFORM 1200-PRINT-SPECIFIC-HEADINGS.                        06020036
060300                                                                  06030036
060400 0400-NTFY-TOT-LINES.                                             06040036
060500     IF PV-NTFY-LINE-COUNT > PC-LINE-LIMIT                        06050036
060600         PERFORM 1100-PRINT-COMMON-HEADINGS                       06060036
060700     END-IF.                                                      06070036
060800                                                                  06080036
060900     MOVE TM001-ATL-ASSIGN-TOT-QTY TO TL2-TROUBLE-TOTAL.          06090036
061000     WRITE NOTIFICATION-RECORD FROM TL2-TOTAL-LINE-2              06100036
061100          AFTER ADVANCING 4 LINES.                                06110036
061200     ADD 1   TO PV-NTFY-LINE-COUNT.                               06120036
061300     PERFORM 1200-PRINT-SPECIFIC-HEADINGS.                        06130036
061400                                                                  06140036
061500 0500-MOVE-INTRBL.                                                06150036
061600                                                                  06160036
061700     IF  PV-VER-INTRBL-COUNT < 10                                 06170036
061800         MOVE PV-VER-INTRBL-COUNT TO                              06180036
061900              FF-ONES-QTY                                         06190036
062000         MOVE FF-ONES TO                                          06200036
062100              TL4-RCVRS-VER-TRBL                                  06210036
062200     ELSE                                                         06220036
062300     IF  PV-VER-INTRBL-COUNT < 100                                06230036
062400         MOVE PV-VER-INTRBL-COUNT TO                              06240036
062500              FF-TENS-QTY                                         06250036
062600         MOVE FF-TENS TO                                          06260036
062700              TL4-RCVRS-VER-TRBL                                  06270036
062800     ELSE                                                         06280036
062900     IF  PV-VER-INTRBL-COUNT < 1000                               06290036
063000         MOVE PV-VER-INTRBL-COUNT TO                              06300036
063100              FF-HUNDREDS-QTY                                     06310036
063200         MOVE FF-HUNDREDS TO                                      06320036
063300              TL4-RCVRS-VER-TRBL                                  06330036
063400     ELSE                                                         06340036
063500     IF  PV-VER-INTRBL-COUNT < 10000                              06350036
063600         MOVE PV-VER-INTRBL-COUNT TO                              06360036
063700              FF-THOUSANDS-QTY                                    06370036
063800         MOVE FF-THOUSANDS TO                                     06380036
063900              TL4-RCVRS-VER-TRBL                                  06390036
064000     ELSE                                                         06400036
064100     IF  PV-VER-INTRBL-COUNT < 100000                             06410036
064200         MOVE PV-VER-INTRBL-COUNT TO                              06420036
064300              FF-10-THOUSANDS-QTY                                 06430036
064400         MOVE FF-10-THOUSANDS TO                                  06440036
064500              TL4-RCVRS-VER-TRBL                                  06450036
064600     ELSE                                                         06460036
064700     IF  PV-VER-INTRBL-COUNT < 1000000                            06470036
064800         MOVE PV-VER-INTRBL-COUNT TO                              06480036
064900              FF-100-THOUSANDS-QTY                                06490036
065000         MOVE FF-100-THOUSANDS TO                                 06500036
065100              TL4-RCVRS-VER-TRBL                                  06510036
065200     ELSE                                                         06520036
065300         MOVE PV-VER-INTRBL-COUNT TO                              06530036
065400              FF-MILLIONS-QTY                                     06540036
065500         MOVE FF-MILLIONS TO                                      06550036
065600              TL4-RCVRS-VER-TRBL.                                 06560036
065700                                                                  06570036
065800 0600-WRITE-DETAIL-LINES.                                         06580036
065900     MOVE TM001-RTL-TRBL-RSN-CDE    TO DL1-TROUBLE-NBR.           06590036
066000     MOVE TM001-RTL-TRBL-RSN-CDE-DESC TO DL1-TROUBLE-DESCRIPTION. 06600036
066100     MOVE TM001-RTL-RSN-CDE-TOT-QTY TO DL1-ASSIGNED-QTY.          06610036
066200     IF PV-TOT-TROUBLE-SAVE > 0                                   06620036
066300         COMPUTE PV-PER-TO-TOT =                                  06630036
066400                 TM001-RTL-RSN-CDE-TOT-QTY * 100 /                06640036
066500                 PV-TOT-TROUBLE-SAVE                              06650036
066600     ELSE                                                         06660036
066700         MOVE 0 TO PV-PER-TO-TOT                                  06670036
066800     END-IF.                                                      06680036
066900     MOVE PV-PER-TO-TOT            TO DL1-PER-TO-TOTAL.           06690036
067000     MOVE PC-PERCENT               TO DL1-PERCENT.                06700036
067100                                                                  06710036
067200     EVALUATE TRUE                                                06720036
067300         WHEN TM001-REPORT-TROUBLE                                06730036
067400             IF PV-TRBL-LINE-COUNT > PC-LINE-LIMIT                06740036
067500                PERFORM 1000-PRINT-HEADINGS                       06750036
067600             END-IF                                               06760036
067700             ADD TM001-RTL-RSN-CDE-TOT-QTY TO PV-FIN-TOT-TRBL     06770036
067800             MOVE TM001-RTL-AVG-RESOLVE-HRS                       06780036
067900                                      TO DL1-AVG-RESOLVE-HHH      06790036
068000             MOVE TM001-RTL-AVG-RESOLVE-MINS                      06800036
068100                                      TO DL1-AVG-RESOLVE-MM       06810036
068200             MOVE DL1-AVG-TIME-FIELDS    TO DL1-AVG-TIME          06820036
068300             WRITE TROUBLE-RECORD FROM DL1-DETAIL-LINE-1          06830036
068400                  AFTER ADVANCING 1 LINE                          06840036
068500             ADD 1 TO PV-TRBL-LINE-COUNT                          06850036
068600             INITIALIZE DL1-DETAIL-LINE-1                         06860036
068700         WHEN TM001-REPORT-NOTIFY                                 06870036
068800             IF PV-NTFY-LINE-COUNT > PC-LINE-LIMIT                06880036
068900                PERFORM 1000-PRINT-HEADINGS                       06890036
069000             END-IF                                               06900036
069100             ADD TM001-RTL-RSN-CDE-TOT-QTY TO PV-FIN-TOT-NTFY     06910036
069200             WRITE NOTIFICATION-RECORD FROM DL1-DETAIL-LINE-1     06920036
069300                  AFTER ADVANCING 1 LINE                          06930036
069400             ADD 1 TO PV-NTFY-LINE-COUNT                          06940036
069500             INITIALIZE DL1-DETAIL-LINE-1                         06950036
069600     END-EVALUATE.                                                06960036
069700                                                                  06970036
069800                                                                  06980036
069900 1000-PRINT-HEADINGS.                                             06990036
070000     PERFORM 1100-PRINT-COMMON-HEADINGS.                          07000036
070100     PERFORM 1200-PRINT-SPECIFIC-HEADINGS.                        07010036
070200                                                                  07020036
070300                                                                  07030036
070400 1100-PRINT-COMMON-HEADINGS.                                      07040036
070500     EVALUATE TRUE                                                07050036
070600         WHEN TM001-REPORT-TROUBLE                                07060036
070700             MOVE 0              TO PV-TRBL-LINE-COUNT            07070036
070800             ADD  1              TO PV-TRBL-PAGE-COUNT            07080036
070900             MOVE PV-TRBL-PAGE-COUNT  TO DP132O-PAGE-NUMBER       07090036
071000             MOVE PC-ONE TO DP132O-REPORT-NUMBER                  07100036
071100                                                                  07110036
071200             WRITE TROUBLE-RECORD                                 07120036
071300                  FROM DP132O-STANDRD-HEADER-132-COLS             07130036
071400                      AFTER ADVANCING PAGE                        07140036
071500             WRITE TROUBLE-RECORD                                 07150036
071600                  FROM HL1-HEADING-LINE-1A                        07160036
071700                      AFTER ADVANCING 2 LINES                     07170036
071800             WRITE TROUBLE-RECORD                                 07180036
071900                  FROM HL2-HEADING-LINE-2                         07190036
072000                      AFTER ADVANCING 1 LINES                     07200036
072100             ADD 4  TO PV-TRBL-LINE-COUNT                         07210036
072200                                                                  07220036
072300         WHEN TM001-REPORT-NOTIFY                                 07230036
072400             MOVE 0              TO PV-NTFY-LINE-COUNT            07240036
072500             ADD  1              TO PV-NTFY-PAGE-COUNT            07250036
072600             MOVE PV-NTFY-PAGE-COUNT  TO DP132O-PAGE-NUMBER       07260036
072700             MOVE PC-TWO TO DP132O-REPORT-NUMBER                  07270036
072800                                                                  07280036
072900             WRITE NOTIFICATION-RECORD                            07290036
073000                  FROM DP132O-STANDRD-HEADER-132-COLS             07300036
073100                      AFTER ADVANCING PAGE                        07310036
073200             WRITE NOTIFICATION-RECORD                            07320036
073300                  FROM HL1-HEADING-LINE-1B                        07330036
073400                      AFTER ADVANCING 2 LINES                     07340036
073500             WRITE NOTIFICATION-RECORD                            07350036
073600                  FROM HL2-HEADING-LINE-2                         07360036
073700                      AFTER ADVANCING 1 LINES                     07370036
073800             ADD 4  TO PV-NTFY-LINE-COUNT                         07380036
073900     END-EVALUATE.                                                07390036
074000                                                                  07400036
074100 1200-PRINT-SPECIFIC-HEADINGS.                                    07410036
074200     EVALUATE TRUE                                                07420036
074300        WHEN TM001-REPORT-TROUBLE                                 07430036
074400            MOVE PC-AVERAGE         TO HL3-AVERAGE                07440036
074500            MOVE PC-TIME-TO-RESOLVE TO HL4-TIME-TO-RESOLVE        07450036
074600            WRITE TROUBLE-RECORD FROM HL3-HEADING-LINE-3          07460036
074700                 AFTER ADVANCING 3 LINES                          07470036
074800            WRITE TROUBLE-RECORD FROM HL4-HEADING-LINE-4          07480036
074900                 AFTER ADVANCING 1 LINE                           07490036
075000            WRITE TROUBLE-RECORD FROM BL-BLANK-LINE               07500036
075100                 AFTER ADVANCING 1 LINES                          07510036
075200           ADD 5  TO PV-TRBL-LINE-COUNT                           07520036
075300        WHEN TM001-REPORT-NOTIFY                                  07530036
075400            MOVE SPACES             TO HL3-AVERAGE                07540036
075500            MOVE SPACES             TO HL4-TIME-TO-RESOLVE        07550036
075600            WRITE NOTIFICATION-RECORD FROM HL3-HEADING-LINE-3     07560036
075700                 AFTER ADVANCING 3 LINES                          07570036
075800            WRITE NOTIFICATION-RECORD FROM HL4-HEADING-LINE-4     07580036
075900                 AFTER ADVANCING 1 LINE                           07590036
076000            WRITE NOTIFICATION-RECORD FROM BL-BLANK-LINE          07600036
076100                 AFTER ADVANCING 1 LINES                          07610036
076200           ADD 5  TO PV-NTFY-LINE-COUNT                           07620036
076300     END-EVALUATE.                                                07630036
076400                                                                  07640036
076500 8000-READ-INPUT.                                                 07650005
076600      READ TROUBLE-EXTRACT-FILE INTO TM001-TROUBLE-EXT-RECORD     07660005
076700          AT END SET PS-EOF  TO TRUE.                             07670005
076800                                                                  07680005
076900 9998-SQL-ERROR.                                                  07690037
077000                                                                  07700037
077100     COPY DPPD004.                                                07710037
077200                                                                  07720037
077300     MOVE +4013 TO PV-ABEND-CODE.                                 07730037
077400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07740037
077500                                                                  07750037
077600 9999-EOJ.                                                        07760005
077700     MOVE PC-TOTAL TO FT1-LEGEND.                                 07770030
077800     MOVE PV-FIN-TOT-TRBL TO FT1-TOTAL-TROUBLE.                   07780030
077900     WRITE TROUBLE-RECORD                                         07790030
078000           FROM FT1-FINAL-TRBL-TOTLINE                            07800030
078100                AFTER ADVANCING 2 LINES.                          07810005
078200     WRITE TROUBLE-RECORD                                         07820030
078300           FROM ER-END-REPORT-LINE                                07830030
078400                AFTER ADVANCING 2 LINES.                          07840030
078500                                                                  07850030
078600     MOVE PC-NTFY-TOTAL TO FN1-LEGEND.                            07860030
078700     MOVE PV-FIN-TOT-NTFY TO FN1-TOTAL-NTFY-TROUBLE.              07870030
078800     WRITE NOTIFICATION-RECORD                                    07880005
078900           FROM FN1-FINAL-NTFY-TOTLINE                            07890030
079000                AFTER ADVANCING 2 LINES.                          07900005
079100     WRITE NOTIFICATION-RECORD                                    07910030
079200           FROM ER-END-REPORT-LINE                                07920030
079300                AFTER ADVANCING 2 LINES.                          07930030
079400                                                                  07940005
079500     CLOSE  TROUBLE-EXTRACT-FILE                                  07950005
079600            TROUBLE-REPORT                                        07960005
079700            NOTIFICATION-REPORT.                                  07970009
079800                                                                  07980005
079900******************** END OF TMKRP016 **************************** 07990005
