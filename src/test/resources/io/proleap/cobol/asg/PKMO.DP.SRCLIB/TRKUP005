000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.    TRKUP005.                                         00050099
000600 AUTHOR.        ALICE EBERT.                                      00060099
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070099
000800 DATE-WRITTEN   MAY, 1996.                                        00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200* THIS PROGRAM CREATES THE 'CON' TRANSMISSION FILE FROM THE PO    00120099
001300* TABLES. IT EXTRACTS A FILE TO A WORK TABLE TO BE TRANSMITTED    00130099
001400* AS IMPORT DC SPLIT INFORMATION TO THE DECONSOLIDATOR. TWO ERROR 00140099
001500* REPORTS AND A DETAIL REPORT ARE ALSO WRITTEN TO A WORK TABLE.   00150099
001600******************************************************************00160099
001700* MM/DD/YYYY WHO & WHAT                                           00170099
001800* ---------- -----------------------------------------------------00180099
001900* 03/10/2010 FRANK WALA                                           00190099
002000*            REPLACE HARD-CODED EFC NUMBER 870 WITH XLT_LOC TABLE 00200099
002100*            TO CHECK THE E_BUS_IND IN PARA 2410.                 00210099
002200*                                                                 00220099
002300******************************************************************00230099
002310* 04/12/2012 GERMAN BANDA                                         00240099
002320*            THE NEW SYSTEM OF RECORD FOR INNER AND OUTER         00250099
002330*            QUANTITIES WILL BE THE PO THROUGH RMS.               00260099
002340*            ADDED SELECT OF OUTR_PK_QTY FROM TPURITM TO          00270099
002341*            BULK_UPC CURSOR. CHANGED PARA 2420-                  00280099
002342*            CHANGE PURITM_TUPC_CUR TO SELECT SELECT OTPK FROM    00290099
002343*            TPURITM                                              00300099
002344*            CHANGE UPC-OUTR-PK-QTY TO PURITM-OUTR-PK-QTY         00310099
002350******************************************************************00320099
002400 ENVIRONMENT DIVISION.                                            00330099
002500******************************************************************00340099
002600                                                                  00350099
002700 CONFIGURATION SECTION.                                           00360099
002800                                                                  00370099
002900 SOURCE-COMPUTER.        IBM-3090.                                00380099
003000 OBJECT-COMPUTER.        IBM-3090.                                00390099
003100                                                                  00400099
003200 INPUT-OUTPUT SECTION.                                            00410099
003300                                                                  00420099
003400 FILE-CONTROL.                                                    00430099
003500                                                                  00440099
003600******************************************************************00450099
003700 DATA DIVISION.                                                   00460099
003800******************************************************************00470099
003900                                                                  00480099
004000 FILE SECTION.                                                    00490099
004100                                                                  00500099
004200******************************************************************00510099
004300 WORKING-STORAGE SECTION.                                         00520099
004400******************************************************************00530099
004500*                                                                 00540099
004600*                                                                 00550099
004700******************************************************************00560099
004800*  DB2 FORMATTED MESSAGE AREA                                     00570099
004900******************************************************************00580099
005000     COPY DPWS004.                                                00590099
005100*                                                                 00600099
005200******************************************************************00610099
005300*  COMMUNICATIONS AREA FOR DB2                                    00620099
005400******************************************************************00630099
005500     EXEC SQL                                                     00640099
005600          INCLUDE SQLCA                                           00650099
005700     END-EXEC.                                                    00660099
005800*                                                                 00670099
005900******************************************************************00680099
006000*  DB2 TABLE DECLARATION - UPC SKU TABLE                          00690099
006100******************************************************************00700099
006200     EXEC SQL                                                     00710099
006300          INCLUDE TUPCSKU                                         00720099
006400     END-EXEC.                                                    00730099
006500*                                                                 00740099
006600******************************************************************00750099
006700*  DB2 TABLE DECLARATION - UPC TABLE                              00760099
006800******************************************************************00770099
006900     EXEC SQL                                                     00780099
007000          INCLUDE TUPC                                            00790099
007100     END-EXEC.                                                    00800099
007200*                                                                 00810099
007300******************************************************************00820099
007400*  DB2 TABLE DECLARATION - TRIP TABLE (TVHTRIP)                   00830099
007500******************************************************************00840099
007600     EXEC SQL                                                     00850099
007700          INCLUDE TVHTRIP                                         00860099
007800     END-EXEC.                                                    00870099
007900*                                                                 00880099
008000******************************************************************00890099
008100*  DB2 TABLE DECLARATION - SHIPMENT TO PURCHASE ORDER ASSOCIATION 00900099
008200*      TABLE (TSHPTPO)                                            00910099
008300******************************************************************00920099
008400     EXEC SQL                                                     00930099
008500          INCLUDE TSHPTPO                                         00940099
008600     END-EXEC.                                                    00950099
008700*                                                                 00960099
008800******************************************************************00970099
008900*  DB2 TABLE DECLARATION - SHIPMENT TABLE  (TSHIPMT)              00980099
009000******************************************************************00990099
009100     EXEC SQL                                                     01000099
009200          INCLUDE TSHIPMT                                         01010099
009300     END-EXEC.                                                    01020099
009400*                                                                 01030099
009500******************************************************************01040099
009600*  DB2 TABLE DECLARATION - SHIPMENT STATUS TABLE LAYOUT           01050099
009700*                               (TSHIPST)                         01060099
009800******************************************************************01070099
009900     EXEC SQL                                                     01080099
010000          INCLUDE TSHIPST                                         01090099
010100     END-EXEC.                                                    01100099
010200*                                                                 01110099
010300******************************************************************01120099
010400*  DB2 TABLE DECLARATION - SHIPMENT STATUS TYPE TABLE LAYOUT      01130099
010500*                               (TSHSTYP)                         01140099
010600******************************************************************01150099
010700     EXEC SQL                                                     01160099
010800          INCLUDE TSHSTYP                                         01170099
010900     END-EXEC.                                                    01180099
011000*                                                                 01190099
011100******************************************************************01200099
011200*  DB2 TABLE DECLARATION - PURCHASE ORDER PLANNED SHIPMENT        01210099
011300*      TABLE  (TPLNSHP)                                           01220099
011400******************************************************************01230099
011500     EXEC SQL                                                     01240099
011600          INCLUDE TPLNSHP                                         01250099
011700     END-EXEC.                                                    01260099
011800*                                                                 01270099
011900******************************************************************01280099
012000*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE TABLE (TPURCHS)01290099
012100******************************************************************01300099
012200     EXEC SQL                                                     01310099
012300          INCLUDE TPURCHS                                         01320099
012400     END-EXEC.                                                    01330099
012500*                                                                 01340099
012600******************************************************************01350099
012700*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE ITEM TABLE     01360099
012800*      (TPURITM)                                                  01370099
012900******************************************************************01380099
013000     EXEC SQL                                                     01390099
013100          INCLUDE TPURITM                                         01400099
013200     END-EXEC.                                                    01410099
013300*                                                                 01420099
013400******************************************************************01430099
013500*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01440099
013600******************************************************************01450099
013700     EXEC SQL                                                     01460099
013800          INCLUDE XLT00003                                        01470099
013900     END-EXEC.                                                    01480099
014000*                                                                 01490099
014100******************************************************************01500099
014200*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01510099
014300******************************************************************01520099
014400     EXEC SQL                                                     01530099
014500          INCLUDE XLT00004                                        01540099
014600     END-EXEC.                                                    01550099
014700*                                                                 01560099
014800******************************************************************01570099
014900*  DB2 TABLE DECLARATION - IMPORT PURCHASE ORDER RELEASE TABLE    01580099
015000*      (TIMPORL)                                                  01590099
015100******************************************************************01600099
015200     EXEC SQL                                                     01610099
015300          INCLUDE TIMPORL                                         01620099
015400     END-EXEC.                                                    01630099
015500*                                                                 01640099
015600******************************************************************01650099
015700*  DB2 TABLE DECLARATION - TRAFFIC TRIP STATUS TABLE (TTRIPST)    01660099
015800******************************************************************01670099
015900     EXEC SQL                                                     01680099
016000          INCLUDE TTRIPST                                         01690099
016100     END-EXEC.                                                    01700099
016200*                                                                 01710099
016300******************************************************************01720099
016400*  DB2 TABLE DECLARATION - TRAFFIC TRIP STATUS TYPE TBL (TTRSTYP) 01730099
016500******************************************************************01740099
016600     EXEC SQL                                                     01750099
016700          INCLUDE TTRSTYP                                         01760099
016800     END-EXEC.                                                    01770099
016900*                                                                 01780099
017000******************************************************************01790099
017100*  DB2 TABLE DECLARATION - PURCHASE ORDER ALLOCATION PLAN TABLE   01800099
017200*      (TALLPLN)                                                  01810099
017300******************************************************************01820099
017400     EXEC SQL                                                     01830099
017500          INCLUDE TALLPLN                                         01840099
017600     END-EXEC.                                                    01850099
017700*                                                                 01860099
017800******************************************************************01870099
017900*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE NAME TABLE         01880099
018000*      (TENTNME)                                                  01890099
018100******************************************************************01900099
018200     EXEC SQL                                                     01910099
018300          INCLUDE TENTNME                                         01920099
018400     END-EXEC.                                                    01930099
018500*                                                                 01940099
018600******************************************************************01950099
018700*  DB2 TABLE DECLARATION - PURCHASE ORDER INSTRUCTION CODES TABLE 01960099
018800*      (TINSTCD)                                                  01970099
018900******************************************************************01980099
019000     EXEC SQL                                                     01990099
019100          INCLUDE TINSTCD                                         02000099
019200     END-EXEC.                                                    02010099
019300*                                                                 02020099
019400******************************************************************02030099
019500*  DB2 TABLE DECLARATION - PURCHASE INSTRUCTION TABLE (TPOINST)   02040099
019600******************************************************************02050099
019700     EXEC SQL                                                     02060099
019800          INCLUDE TPOINST                                         02070099
019900     END-EXEC.                                                    02080099
020000                                                                  02090099
020100******************************************************************02100099
020200*  DB2 TABLE DECLARATION - TRAFFIC VEHICLE TABLE (TVEHICL)        02110099
020300******************************************************************02120099
020400     EXEC SQL                                                     02130099
020500          INCLUDE TVEHICL                                         02140099
020600     END-EXEC.                                                    02150099
020700                                                                  02160099
020800******************************************************************02170099
020900*  DB2 TABLE DECLARATION - TABLE (TSKXREF)                        02180099
021000******************************************************************02190099
021100     EXEC SQL                                                     02200099
021200          INCLUDE TSKXREF                                         02210099
021300     END-EXEC.                                                    02220099
021400******************************************************************02230099
021500*  DB2 TABLE DECLARATION - SHPMNT/PO ASSOCIATN AUDT TBL (TAUSHPO) 02240099
021600******************************************************************02250099
021700     EXEC SQL                                                     02260099
021800          INCLUDE TAUSHPO                                         02270099
021900     END-EXEC.                                                    02280099
022000******************************************************************02290099
022100*  DB2 TABLE DECLARATION - TRIP AUDIT TABLE       (TAUTRIP)       02300099
022200******************************************************************02310099
022300     EXEC SQL                                                     02320099
022400          INCLUDE TAUTRIP                                         02330099
022500     END-EXEC.                                                    02340099
022600******************************************************************02350099
022700*  DB2 TABLE DECLARATION - PO PREPACK TABLE       (TPOPRPK)       02360099
022800******************************************************************02370099
022900     EXEC SQL                                                     02380099
023000          INCLUDE TPOPRPK                                         02390099
023100     END-EXEC.                                                    02400099
023200******************************************************************02410099
023300*  DB2 TABLE DECLARATION - PO TABLE             (TOUTTR2)         02420099
023400******************************************************************02430099
023500     EXEC SQL                                                     02440099
023600          INCLUDE TOUTTR2                                         02450099
023700     END-EXEC.                                                    02460099
023800******************************************************************02470099
023900*  DB2 TABLE DECLARATION - ERROR RPT TABLE       (TOUTTR3)        02480099
024000******************************************************************02490099
024100     EXEC SQL                                                     02500099
024200          INCLUDE TOUTTR3                                         02510099
024300     END-EXEC.                                                    02520099
024400******************************************************************02530099
024500*  DB2 TABLE DECLARATION - DETAIL RPT TABLE      (TOUTTR4)        02540099
024600******************************************************************02550099
024700     EXEC SQL                                                     02560099
024800          INCLUDE TOUTTR4                                         02570099
024900     END-EXEC.                                                    02580099
025000******************************************************************02590099
025100*  DB2 TABLE DECLARATION - CHECKPOINT RESTART INFO TBL(TCKRSTINF) 02600099
025200*  THIS TABLE IS USED TO STORE WORKING STOREAGE INFORMATION FOR   02610099
025300*  CHECKPOINT RESTARTS.                                           02620099
025400******************************************************************02630099
025500     EXEC SQL                                                     02640099
025600         INCLUDE TCKRSTIN                                         02650099
025700     END-EXEC.                                                    02660099
025800*                                                                 02670099
025900******************************************************************02680099
026000*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)02690099
026100*  THIS TABLE IS USED FOR CHECKPOINT RESTARTS.                    02700099
026200******************************************************************02710099
026300     EXEC SQL                                                     02720099
026400         INCLUDE TCKRSTCN                                         02730099
026500     END-EXEC.                                                    02740099
026600*                                                                 02750099
026700******************************************************************02760099
026800*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - CONTAINER 02770099
026900*  RELEASE SPLITS TABLE.                                          02780099
027000******************************************************************02790099
027100     EXEC SQL                                                     02800099
027200         INCLUDE TIMCNRL                                          02810099
027300     END-EXEC.                                                    02820099
027400*                                                                 02830099
027500******************************************************************02840099
027600*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - PORT OF   02850099
027700*  ENTRY CODE TABLE.                                              02860099
027800******************************************************************02870099
027900     EXEC SQL                                                     02880099
028000         INCLUDE TIMPOE                                           02890099
028100     END-EXEC.                                                    02900099
028200*                                                                 02910099
028300******************************************************************02920099
028400*  DB2 TABLE DECLARATION - IT-UPC PHYSICAL LOCATION STATUS        02930099
028500******************************************************************02940099
028600     EXEC SQL                                                     02950099
028700         INCLUDE TUPCPLS                                          02960099
028800     END-EXEC.                                                    02970099
028900*                                                                 02980099
029000******************************************************************02990099
029100*  DB2 TABLE DECLARATION - WEB ITEM TABLE FOR E-COMMERCE          03000099
029200******************************************************************03010099
029300     EXEC SQL                                                     03020099
029400         INCLUDE TWEBITM                                          03030099
029500     END-EXEC.                                                    03040099
029510*FJW 03/10/10 BEGIN                                               03050099
029520******************************************************************03060099
029530*  DB2 TABLE DECLARATION - EFC2 LOC TABLE FOR E-COMMERCE          03070099
029540******************************************************************03080099
029550     EXEC SQL                                                     03090099
029560         INCLUDE XLT00010                                         03100099
029570     END-EXEC.                                                    03110099
029580*FJW 03/10/10 END                                                 03120099
029581*---------------------------------------------------------------* 03130099
029582*    PARM TABLE                                                   03140099
029583*---------------------------------------------------------------* 03150099
029585** PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM             03160099
029586     EXEC SQL                                                     03170099
029587          INCLUDE TKRPRPM                                         03180099
029588     END-EXEC.                                                    03190099
029589                                                                  03200099
139868******************************************************************03210099
139868* DB2 TABLE DECLARATION - PURCHASE ORDER STORE ALLOCATION TABLE   03220099
139868*     (TMESTDS)                                                   03230099
139868******************************************************************03240099
139868     EXEC SQL                                                     03250099
139868          INCLUDE TMESTDS                                         03260099
139868     END-EXEC.                                                    03270099
029590*                                                                 03280099
155029******************************************************************03290099
155029* DB2 TABLE DECLARATION - TIMCNUP TABLE                           03300099
155029******************************************************************03310099
155029     EXEC SQL                                                     03320099
155029          INCLUDE TIMCNUP                                         03330099
155029     END-EXEC.                                                    03340099
155029*                                                                 03350099
155029******************************************************************03360099
155029* DB2 TABLE DECLARATION - WST_INTGRTN_TYP TABLE                   03370099
155029******************************************************************03380099
155029     EXEC SQL                                                     03390099
155029          INCLUDE WST00008                                        03400099
155029     END-EXEC.                                                    03410099
155029*                                                                 03420099
155029******************************************************************03430099
155029* DB2 TABLE DECLARATION - WST_ATTR_DEFN TABLE                     03440099
155029******************************************************************03450099
155029     EXEC SQL                                                     03460099
155029          INCLUDE WST00009                                        03470099
155029     END-EXEC.                                                    03480099
155029*                                                                 03490099
155029******************************************************************03500099
155029* DB2 TABLE DECLARATION - WST_ATTR_ELEM TABLE                     03510099
155029******************************************************************03520099
155029     EXEC SQL                                                     03530099
155029          INCLUDE WST00010                                        03540099
155029     END-EXEC.                                                    03550099
155029*                                                                 03560099
029600******************************************************************03570099
029700*    IMPORT TRIP RECORD LAYOUT                                    03580099
029800******************************************************************03590099
029900     COPY TRRD004.                                                03600099
030000 EJECT                                                            03610099
030100                                                                  03620099
030200******************************************************************03630099
030300*    ERROR REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION        03640099
030400*    TRANSMISSION AND RETRANSMISSION.                             03650099
030500******************************************************************03660099
030600     COPY TRRD006.                                                03670099
030700 EJECT                                                            03680099
030800                                                                  03690099
030900******************************************************************03700099
031000*    DETAIL REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION       03710099
031100*    TRANSMISSION AND RETRANSMISSION.                             03720099
031200******************************************************************03730099
031300     COPY TRRD020.                                                03740099
031400 EJECT                                                            03750099
031500                                                                  03760099
031600 01  ABEND-CODE                      PIC S9(04)    VALUE +0       03770099
031700                                                   COMP SYNC.     03780099
031800*                                                                 03790099
031900 01  PA-PROGRAM-ACCUMULATORS.                                     03800099
032000     05  PA-TOTALS.                                               03810099
032100         10 PA-TOTAL-CURR-SPLIT-QTY   PIC  S9(13)  VALUE +0       03820099
032200                                                     COMP-3.      03830099
155029         10 PA-TOTAL-STR-SPLIT-QTY    PIC  S9(13)  VALUE +0       03840099
155029                                                     COMP-3.      03850099
032300         10 PA-TOTAL-OUTPUT-REC-COUNT PIC  S9(13)  VALUE +0       03860099
032400                                                     COMP-3.      03870099
032500         10 PA-TOTAL-PACK-UNITS       PIC  S9(13)  VALUE +0       03880099
032600                                                     COMP-3.      03890099
032700         10 PA-TOTAL-PACK-CARTONS     PIC  S9(13)  VALUE +0       03900099
032800                                                     COMP-3.      03910099
032900         10 PA-TOTAL-OTPK-ORD-QTY     PIC  S9(13)  VALUE +0       03920099
033000                                                     COMP-3.      03930099
033100         10 PA-TOTAL-INPK-ORD-QTY     PIC  S9(13)  VALUE +0       03940099
033200                                                     COMP-3.      03950099
033300         10 PA-PDC-SPLIT-QTY          PIC  S9(13)  VALUE +0       03960099
033400                                                     COMP-3.      03970099
033500         10 PA-TOTAL-PACK-SPLIT-QTY   PIC S9(13) VALUE +0         03980099
033600                                                     COMP-3.      03990099
033700     05  PA-ERROR-COUNT               PIC  S9(13)    VALUE +0     04000099
033800                                                     COMP-3.      04010099
033900                                                                  04020099
034000 01  PS-PROGRAM-SWITCHES.                                         04030099
034100     05  PS-EOC-DRIVER-CURSOR-SW       PIC  X(01)    VALUE 'N'.   04040099
034200         88  PS-EOC-DRIVER-CURSOR                    VALUE 'Y'.   04050099
034300         88  PS-NOT-EOC-DRIVER-CURSOR                VALUE 'N'.   04060099
034400     05  PS-EOC-CONT-CURSOR-SW         PIC  X(01)    VALUE 'N'.   04070099
034500         88  PS-EOC-CONT-CURSOR                      VALUE 'Y'.   04080099
034600         88  PS-EOC-CONT-CURSOR-NO                   VALUE 'N'.   04090099
034700     05  PS-EOC-PO-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04100099
034800         88  PS-EOC-PO-CURSOR                        VALUE 'Y'.   04110099
034900         88  PS-EOC-PO-CURSOR-NO                     VALUE 'N'.   04120099
035000     05  PS-UNPROCESSED-PO-FOUND-SW    PIC  X(01)    VALUE 'N'.   04130099
035100         88  PS-UNPROCESSED-PO-FOUND                 VALUE 'Y'.   04140099
035200         88  PS-UNPROCESSED-PO-FOUND-NO              VALUE 'N'.   04150099
035300     05  PS-EOC-INSTR-CURSOR-SW        PIC  X(01)    VALUE 'N'.   04160099
035400         88  PS-EOC-INSTR-CURSOR                     VALUE 'Y'.   04170099
035500         88  PS-EOC-INSTR-CURSOR-NO                  VALUE 'N'.   04180099
035600     05  PS-EOC-BULK-UPC-CUR-SW        PIC  X(01)    VALUE 'N'.   04190099
035700         88  PS-EOC-BULK-UPC-CUR                     VALUE 'Y'.   04200099
035800         88  PS-EOC-BULK-UPC-CUR-NO                  VALUE 'N'.   04210099
035900     05  PS-EOC-PREPACK-DC-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04220099
036000         88  PS-EOC-PREPACK-DC-CURSOR                VALUE 'Y'.   04230099
036100         88  PS-EOC-PREPACK-DC-CURSOR-NO             VALUE 'N'.   04240099
036200     05  PS-EOC-PREPACK-CM-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04250099
036300         88  PS-EOC-PREPACK-CM-CURSOR                VALUE 'Y'.   04260099
036400         88  PS-EOC-PREPACK-CM-CURSOR-NO             VALUE 'N'.   04270099
036500     05  PS-EOC-DC-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04280099
036600         88  PS-EOC-DC-CURSOR                        VALUE 'Y'.   04290099
036700         88  PS-EOC-DC-CURSOR-NO                     VALUE 'N'.   04300099
036800     05  PS-EOC-POE-CURSOR-SW PIC           X(01)    VALUE 'N'.   04310099
036900         88  PS-EOC-POE-CURSOR                       VALUE 'Y'.   04320099
037000         88  PS-EOC-POE-CURSOR-NO                    VALUE 'N'.   04330099
037100     05  PS-EOC-PACK-CURSOR-SW PIC X(01)             VALUE 'N'.   04340099
037200         88  PS-EOC-PACK-CURSOR                      VALUE 'Y'.   04350099
037300         88  PS-EOC-PACK-CURSOR-NO                   VALUE 'N'.   04360099
037400     05  PS-EOC-POPRPK-FOR-PO-CUR-SW PIC X(01)       VALUE 'N'.   04370099
037500         88  PS-EOC-POPRPK-FOR-PO-CUR                VALUE 'Y'.   04380099
037600         88  PS-EOC-POPRPK-FOR-PO-CUR-NO             VALUE 'N'.   04390099
037700     05  PS-EOC-PURITM-TUPC-CUR-SW    PIC X(01)      VALUE 'N'.   04400099
037800         88  PS-EOC-PURITM-TUPC-CUR                  VALUE 'Y'.   04410099
037900         88  PS-EOC-PURITM-TUPC-CUR-NO               VALUE 'N'.   04420099
038000     05  PS-EOC-PREPACK-CURSOR-SW       PIC X(01)    VALUE 'N'.   04430099
038100         88  PS-EOC-PREPACK-CURSOR                   VALUE 'Y'.   04440099
038200         88  PS-EOC-PREPACK-CURSOR-NO                VALUE 'N'.   04450099
038300     05  PS-EOC-PDC-UNITS-CURSOR-SW     PIC X(01)    VALUE 'N'.   04460099
038400         88  PS-EOC-PDC-UNITS-CURSOR                 VALUE 'Y'.   04470099
038500         88  PS-EOC-PDC-UNITS-CURSOR-NO              VALUE 'N'.   04480099
038600     05  PS-EOC-PACK-UPC-CURSOR-SW      PIC X(01)    VALUE 'N'.   04490099
038700         88  PS-EOC-PACK-UPC-CURSOR                  VALUE 'Y'.   04500099
038800         88  PS-EOC-PACK-UPC-CURSOR-NO               VALUE 'N'.   04510099
038900     05  PS-LINES-ON-TPURITM-SW        PIC  X(01)    VALUE 'N'.   04520099
039000         88  PS-LINES-ON-TPURITM                     VALUE 'Y'.   04530099
039100         88  PS-LINES-ON-TPURITM-NO                  VALUE 'N'.   04540099
039200     05  PS-PREPACKS-ON-TPURITM-SW     PIC  X(01)    VALUE 'N'.   04550099
039300         88  PS-PREPACKS-ON-TPURITM                  VALUE 'Y'.   04560099
039400         88  PS-PREPACKS-ON-TPURITM-NO               VALUE 'N'.   04570099
039500     05  PS-DC-SPLIT-INFO-PRESENT-SW   PIC  X(01)    VALUE 'N'.   04580099
039600         88  PS-DC-SPLIT-INFO-PRESENT                VALUE 'Y'.   04590099
039700         88  PS-DC-SPLIT-INFO-PRESENT-NO             VALUE 'N'.   04600099
039800     05  PS-CONT-INFO-PRESENT-SW       PIC  X(01)    VALUE 'N'.   04610099
039900         88  PS-CONT-INFO-PRESENT                    VALUE 'Y'.   04620099
040000         88  PS-CONT-INFO-PRESENT-NO                 VALUE 'N'.   04630099
040100     05  PS-PO-CUR-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   04640099
040200         88  PS-PO-CUR-INFO-PRESENT                  VALUE 'Y'.   04650099
040300         88  PS-PO-CUR-INFO-PRESENT-NO               VALUE 'N'.   04660099
040400     05  PS-CURR-SPLIT-QTY-PRESENT-SW  PIC  X(01)    VALUE 'N'.   04670099
040500         88  PS-CURR-SPLIT-QTY-PRESENT               VALUE 'Y'.   04680099
040600         88  PS-CURR-SPLIT-QTY-PRESENT-NO            VALUE 'N'.   04690099
040700     05  PS-PO-SEL-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   04700099
040800         88  PS-PO-SEL-INFO-PRESENT                  VALUE 'Y'.   04710099
040900         88  PS-PO-SEL-INFO-PRESENT-NO               VALUE 'N'.   04720099
041000     05  PS-SELECT-PACK-SUM-OK-SW      PIC  X(01)    VALUE 'N'.   04730099
041100         88  PS-SELECT-PACK-SUM-OK                   VALUE 'Y'.   04740099
041200         88  PS-SELECT-PACK-SUM-OK-NO                VALUE 'N'.   04750099
041300     05  PS-GOOD-STATUS-CDE-FOUND-SW   PIC  X(01)    VALUE 'N'.   04760099
041400         88  PS-GOOD-STATUS-CDE-FOUND                VALUE 'Y'.   04770099
041500         88  PS-GOOD-STATUS-CDE-FOUND-NO             VALUE 'N'.   04780099
041600     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   04790099
041700         88  PS-NORMAL-RUN                           VALUE '0'.   04800099
041800         88  PS-RESTART-RUN                          VALUE '9'.   04810099
041900     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.   04820099
042000         88  PS-COMMITS-TAKEN                        VALUE 'Y'.   04830099
042100         88  PS-COMMITS-TAKEN-NO                     VALUE 'N'.   04840099
042200     05  PS-PROBLEM-SO-SET-RETRANS-SW  PIC  X(01)    VALUE 'N'.   04850099
042300         88  PS-PROBLEM-SO-SET-RETRANS               VALUE 'Y'.   04860099
042400         88  PS-PROBLEM-SO-SET-RETRANS-NO            VALUE 'N'.   04870099
042500     05  PS-ZERO-OUTR-PACK-QTY-SW      PIC  X(01)    VALUE 'N'.   04880099
042600         88  PS-ZERO-OUTR-PACK-QTY                   VALUE 'Y'.   04890099
042700         88  PS-ZERO-OUTR-PACK-QTY-NO                VALUE 'N'.   04900099
042800     05  PS-TSHPTPO-UPDATED-SW         PIC  X(01)    VALUE 'N'.   04910099
042900         88  PS-TSHPTPO-UPDATED                      VALUE 'Y'.   04920099
043000         88  PS-TSHPTPO-UPDATED-NO                   VALUE 'N'.   04930099
043100     05  PS-FIRST-DC-SW                PIC  X(01)    VALUE 'N'.   04940099
043200         88  PS-FIRST-DC                             VALUE 'Y'.   04950099
043300         88  PS-FIRST-DC-NO                          VALUE 'N'.   04960099
043400     05  PS-COUNT-DCS-OK-SW            PIC  X(01)    VALUE 'N'.   04970099
043500         88  PS-COUNT-DCS-OK                         VALUE 'Y'.   04980099
043600         88  PS-COUNT-DCS-OK-NO                      VALUE 'N'.   04990099
043700     05  PS-UPC-PASSESED-EDITS-SW      PIC  X(01)    VALUE 'N'.   05000099
043800         88  PS-UPC-PASSESED-EDITS                   VALUE 'Y'.   05010099
043900         88  PS-UPC-PASSESED-EDITS-NO                VALUE 'N'.   05020099
044000     05  PS-THERE-ARE-E-COM-DCS-SW     PIC  X(01)    VALUE 'N'.   05030099
044100         88  PS-THERE-ARE-E-COM-DCS                  VALUE 'Y'.   05040099
044200         88  PS-THERE-ARE-E-COM-DCS-NO               VALUE 'N'.   05050099
044300     05  PS-THIS-IS-E-COM-UPC-SW       PIC  X(01)    VALUE 'N'.   05060099
044400         88  PS-THIS-IS-E-COM-UPC                    VALUE 'Y'.   05070099
044500         88  PS-THIS-IS-E-COM-UPC-NO                 VALUE 'N'.   05080099
044600     05  PS-EOC-E-COM-PACK-UPC-CUR-SW  PIC  X(01)    VALUE 'N'.   05090099
044700         88  PS-EOC-E-COM-PACK-UPC-CUR               VALUE 'Y'.   05100099
044800         88  PS-EOC-E-COM-PACK-UPC-CUR-NO            VALUE 'N'.   05110099
044900     05  PS-PASSED-E-COM-CHECK-SW      PIC  X(01)    VALUE 'N'.   05120099
045000         88  PS-PASSED-E-COM-CHECK                   VALUE 'Y'.   05130099
045100         88  PS-PASSED-E-COM-CHECK-NO                VALUE 'N'.   05140099
045200     05  PS-PO-PASSED-EDITS-SW         PIC  X(01)    VALUE 'N'.   05150099
045300         88  PS-PO-PASSED-EDITS                      VALUE 'Y'.   05160099
045400         88  PS-PO-PASSED-EDITS-NO                   VALUE 'N'.   05170099
045500     05  PS-PO-HAS-UNTIED-LINES-SW     PIC  X(01)    VALUE 'N'.   05180099
045600         88  PS-PO-HAS-UNTIED-LINES                  VALUE 'Y'.   05190099
045700         88  PS-PO-HAS-UNTIED-LINES-NO               VALUE 'N'.   05200099
045800     05  PS-PREV-SENT-AS-CMN-SW      PIC  X(01)      VALUE 'N'.   05210099
045900         88  PS-PREV-SENT-AS-CMN                     VALUE 'Y'.   05220099
046000         88  PS-PREV-SENT-AS-CMN-NO                  VALUE 'N'.   05230099
046100     05  PS-UNCONFIRMED-PACK-SW      PIC  X(01)      VALUE 'N'.   05240099
046200         88  PS-UNCONFIRMED-PACK                     VALUE 'Y'.   05250099
046300         88  PS-UNCONFIRMED-PACK-NO                  VALUE 'N'.   05260099
046400                                                                  05270099
046500     05  PS-POE-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05280099
046600         88  PS-POE-WRITTEN                          VALUE 'Y'.   05290099
046700         88  PS-POE-WRITTEN-NO                       VALUE 'N'.   05300099
046800     05  PS-VES-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05310099
046900         88  PS-VES-WRITTEN                          VALUE 'Y'.   05320099
047000         88  PS-VES-WRITTEN-NO                       VALUE 'N'.   05330099
047100     05  PS-ETA-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05340099
047200         88  PS-ETA-WRITTEN                          VALUE 'Y'.   05350099
047300         88  PS-ETA-WRITTEN-NO                       VALUE 'N'.   05360099
047400     05  PS-CON-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05370099
047500         88  PS-CON-WRITTEN                          VALUE 'Y'.   05380099
047600         88  PS-CON-WRITTEN-NO                       VALUE 'N'.   05390099
047700     05  PS-EOT-EXTRACT-SW             PIC  X(01)    VALUE 'N'.   05400099
047800         88  PS-EOT-EXTRACT                          VALUE 'Y'.   05410099
047900         88  PS-EOT-EXTRACT-NO                       VALUE 'N'.   05420099
048000                                                                  05430099
048100     05  PS-SPLITS-ENTERED-SW          PIC  X(01)    VALUE 'Y'.   05440099
048200         88  PS-SPLITS-ENTERED                       VALUE 'Y'.   05450099
048300         88  PS-SPLITS-ENTERED-NO                    VALUE 'N'.   05460099
048400                                                                  05470099
048500     05  PS-PO-ALREADY-SENT-SW         PIC  X(01)    VALUE 'N'.   05480099
048600         88  PS-PO-ALREADY-SENT                      VALUE 'Y'.   05490099
048700         88  PS-PO-ALREADY-SENT-NO                   VALUE 'N'.   05500099
048800                                                                  05510099
048900     05  PS-FIRST-TRIP-SW              PIC  X(01)    VALUE 'Y'.   05520099
049000         88  PS-FIRST-TRIP                           VALUE 'Y'.   05530099
049100         88  PS-FIRST-TRIP-NO                        VALUE 'N'.   05540099
049200     05  PS-BAD-TRIP-SW                PIC  X(01)    VALUE 'N'.   05550099
049300         88  PS-BAD-TRIP                             VALUE 'Y'.   05560099
049400         88  PS-BAD-TRIP-NO                          VALUE 'N'.   05570099
139868     05  PS-OUTLET-STORE-SW            PIC  X(01)    VALUE 'N'.   05580099
139868         88  PS-OUTLET-STORE                         VALUE 'Y'.   05590099
139868         88  PS-OUTLET-STORE-NO                      VALUE 'N'.   05600099
139868     05  PS-FIRST-STORE-SW             PIC  X(01)    VALUE 'N'.   05610099
139868         88  PS-FIRST-STORE                          VALUE 'Y'.   05620099
139868         88  PS-FIRST-STORE-NO                       VALUE 'N'.   05630099
139868     05  PS-EOC-STORE-CURSOR-SW        PIC  X(01)    VALUE 'N'.   05640099
139868         88  PS-EOC-STORE-CURSOR                     VALUE 'Y'.   05650099
139868         88  PS-EOC-STORE-CURSOR-NO                  VALUE 'N'.   05660099
155029     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.   05670099
155029         88  PS-NEW-UPC-YES                          VALUE 'Y'.   05680099
155029         88  PS-NEW-UPC-NO                           VALUE 'N'.   05690099
155029     05  PS-FIRST-UPC-SW               PIC  X(01)    VALUE 'N'.   05700099
155029         88  PS-FIRST-UPC-YES                        VALUE 'Y'.   05710099
155029         88  PS-FIRST-UPC-NO                         VALUE 'N'.   05720099
049500                                                                  05730099
049600 01  PC-PROGRAM-CONSTANTS.                                        05740099
049700     05  PC-SYSTEM-CD                PIC  X(02)    VALUE 'RV'.    05750099
049800     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          05760099
049900         'TRKUP005'.                                              05770099
050000     05  PC-CURRENT-JOB-NAME         PIC  X(06)    VALUE 'TRK030'.05780099
050100     05  PC-EN                       PIC X(02)     VALUE 'EN'.    05790099
050200     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     05800099
050300     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     05810099
050400     05  PC-A                        PIC X(01)     VALUE 'A'.     05820099
050500     05  PC-B                        PIC X(01)     VALUE 'B'.     05830099
050600     05  PC-C                        PIC X(01)     VALUE 'C'.     05840099
050700     05  PC-I                        PIC X(01)     VALUE 'I'.     05850099
050800     05  PC-M                        PIC X(01)     VALUE 'M'.     05860099
050900     05  PC-N                        PIC X(01)     VALUE 'N'.     05870099
051000     05  PC-O                        PIC X(01)     VALUE 'O'.     05880099
051100     05  PC-S                        PIC X(01)     VALUE 'S'.     05890099
051200     05  PC-U                        PIC X(01)     VALUE 'U'.     05900099
051300     05  PC-Y                        PIC X(01)     VALUE 'Y'.     05910099
051400     05  PC-NA                       PIC X(02)     VALUE 'NA'.    05920099
051500     05  PC-MULTI                    PIC X(05)     VALUE 'MULTI'. 05930099
051600     05  PC-NO-SIZE                  PIC X(07)     VALUE          05940099
051700                                                   'NO SIZE'.     05950099
051800     05  PC-NULL-DTE                PIC X(10) VALUE '9999-09-09'. 05960099
051900     05  PC-LOW-VALUE                PIC X(01)     VALUE          05970099
052000                                                   LOW-VALUE.     05980099
052100     05  PC-EXTRACT-TBL-LIMIT        PIC S9(08) VALUE +50000.     05990099
052110     05  PC-MAX-RETRIES              PIC 9(3)   VALUE 5.          06000099
052200*                                                                 06010099
052300 01  PV-PROGRAM-VARIABLES.                                        06020099
052310     05  PV-RETRY-COUNTER            PIC 9(3)      VALUE 0.       06030099
052400     05  PV-HOLD-PORT-OF-ENTRY-CTY   PIC X(30)     VALUE SPACE.   06040099
052500     05  PV-HOLD-POE-CDE             PIC X(3)      VALUE 'XXX'.   06050099
052600     05  PV-HOLD-VHTRIP-EST-AR-TMST  PIC X(10)     VALUE SPACE.   06060099
052700     05  PV-HOLD-VHTRIP-VEH-NBR      PIC X(10)     VALUE SPACE.   06070099
052800     05  PV-HOLD-VHTRIP-TRIP-ID    PIC S9(9) COMP  VALUE ZERO.    06080099
155029     05  PV-DEPT-NBR                 PIC S9(4)V    VALUE ZEROES   06090099
155029                                                   COMP-3.        06100099
155029     05  PV-FAST-E-BUS-IND           PIC X(01)     VALUE SPACES.  06110099
155029     05  PV-FAST-RDC-IND             PIC X(01)     VALUE SPACES.  06120099
155029     05  PV-FAST-EFC-IND             PIC X(01)     VALUE SPACES.  06130099
155029     05  PV-HOLD-OUT-RECORD.                                      06140099
155029         10  FILLER                  PIC X(03)     VALUE SPACES.  06150099
155029         10  PV-HOLD-DIST-CNTR       PIC X(04)     VALUE SPACES.  06160099
155029         10  FILLER                  PIC X(243)    VALUE SPACES.  06170099
052900     05  PV-QUOTIENT-ORDER-PERCENT   PIC S9(09)V99 COMP-3         06180099
053000                                                   VALUE ZERO.    06190099
053100     05  PV-QUOTIENT-PDC-PERCNT      PIC S9(09)V99 COMP-3         06200099
053200                                                   VALUE ZERO.    06210099
053300     05  PV-HOLD-PO-NBR              PIC S9(09)    COMP-3         06220099
053400                                                   VALUE ZERO.    06230099
053500     05  PV-HOLD-PLAN-NBR            PIC S9(04)    COMP-3         06240099
053600                                                   VALUE ZERO.    06250099
053700     05  PV-HOLD-PO-PREPK-ID         PIC  9(08)    VALUE ZEROES.  06260099
053800     05  PV-DEST-NBR                 PIC  9(04)    VALUE ZEROES.  06270099
053900     05  PV-CURRENT-TIME             PIC  X(26)    VALUE SPACES.  06280099
054000     05  PV-REMAINDER                PIC S9(5)     VALUE +0.      06290099
054100     05  PV-TMST                     PIC X(26)     VALUE SPACES.  06300099
054200     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  06310099
054300     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACE.   06320099
054400     05  PV-HOLD-TR020-PO-NBR        PIC 9(09)     VALUE ZERO.    06330099
054500     05  PV-HOLD-TR020-PROCESS-DATE  PIC X(08)     VALUE SPACE.   06340099
054600     05  PV-HOLD-TR020-CONTNR-ID     PIC X(12)     VALUE SPACE.   06350099
054700     05  PV-ETA-BEGIN-TMST           PIC X(26)     VALUE SPACE.   06360099
054800     05  PV-ETA-END-TMST             PIC X(26)     VALUE SPACE.   06370099
054900     05  PV-ETA-BEGIN-DTE            PIC X(10)     VALUE SPACE.   06380099
055000     05  PV-ETA-END-DTE              PIC X(10)     VALUE SPACE.   06390099
055100     05  PV-WORK-FIELDS-CART-PER-PO.                              06400099
055200         10  PV-CART-PER-PO             PIC S9(13) VALUE +0       06410099
055300                                                     COMP-3.      06420099
055400         10  PV-SUM-PURITM-UNT-QTY      PIC S9(13) VALUE +0       06430099
055500                                                     COMP-3.      06440099
055600         10  PV-PURITM-UNT-QTY-TOT      PIC S9(13) VALUE +0       06450099
055700                                                     COMP-3.      06460099
055800         10  PV-CART-PER-PREPACK        PIC S9(13) VALUE +0       06470099
055900                                                     COMP-3.      06480099
056000         10  PV-CART-PER-ITEM           PIC S9(13) VALUE +0       06490099
056100                                                     COMP-3.      06500099
056200     05  PV-EDIT-DEST                PIC ZZZ9.                    06510099
056300     05  PV-EDIT-PREPK-ID            PIC ZZZ9.                    06520099
056400                                                                  06530099
056500     05  PV-E-COM-WORK-FIELDS.                                    06540099
056600         10  PV-NBR-OF-E-COM-DCS       PIC S9(04)  VALUE +0       06550099
056700                                                     COMP SYNC.   06560099
056800         10  PV-NBR-OF-E-COM-ROWS      PIC S9(04)  VALUE +0       06570099
056900                                                     COMP SYNC.   06580099
057000         10  PV-TTL-BAD-PACK-UPCS       PIC S9(04)  VALUE +0      06590099
057100                                                    COMP SYNC.    06600099
057200         10  PV-TTL-E-COM-PACK-UPCS     PIC S9(04)  VALUE +0      06610099
057300                                                    COMP SYNC.    06620099
057400         10  PV-TTL-PACK-UPCS           PIC S9(04)  VALUE +0      06630099
057500                                                    COMP SYNC.    06640099
057600                                                                  06650099
057700     05  PV-ADJUST-ROUNDED-DC-WRK-FLDS.                           06660099
057800         10  PV-TTL-ALL-DCS-PCT         PIC S9(03) VALUE +0.      06670099
057900         10  PV-TTL-ALL-DCS-UNITS       PIC S9(15) VALUE +0.      06680099
058000         10  PV-TTL-ALL-DCS-CARTS       PIC S9(15) VALUE +0.      06690099
058100         10  PV-TOTAL-NBR-OF-DCS        PIC S9(04) VALUE +0       06700099
058200                                                     COMP SYNC.   06710099
058300         10  PV-DCS-TO-SKIP             PIC S9(05) VALUE +0.      06720099
058400         10  PV-TOTAL-CARTONS           PIC  9(09) VALUE  0.      06730099
139868     05  PV-HOLD-PCK-UNIT-QTY           PIC  9(12) VALUE ZERO.    06740099
139868     05  PV-HOLD-PCK-CART-CT            PIC  9(12) VALUE ZERO.    06750099
139868     05  PV-HOLD-PCK-UNIT-PER-CTN       PIC  9(12) VALUE ZERO.    06760099
058500                                                                  06770099
058600     05  PV-UPC-CARTONS                 PIC S9(15) VALUE +0.      06780099
058700     05  PV-DB2-COUNT                   PIC S9(04) VALUE +0       06790099
058800                                                  COMP SYNC.      06800099
058900     05  PV-OUTR-PK-QTY                 PIC S9(04).               06810099
059000     05  PV-TR006-DEPT-NBR              PIC  9(04).               06820099
059100     05  PV-TR006-DEPT-NBR-X REDEFINES                            06830099
059200         PV-TR006-DEPT-NBR.                                       06840099
059300         10  FILLER                     PIC  X(01).               06850099
059400         10  PV-TR006-DEPT-NBR-3        PIC  X(03).               06860099
059500                                                                  06870099
059600 01  PV-NULLS-TABLE.                                              06880099
059700     05  PV-VHTRIP-VEH-NBR-NULL       PIC S9(04)     VALUE +0     06890099
059800                                                     COMP SYNC.   06900099
059900     05  PV-VHTRIP-EST-AR-NULL        PIC S9(4)      VALUE +0     06910099
060000                                                     COMP SYNC.   06920099
060100 01  PV-CKPT-RESTART-INFO.                                        06930099
060200     05  PV-RESTART-TOT-OUT-REC-COUNT    PIC  S9(13)  VALUE +0    06940099
060300                                                     COMP-3.      06950099
060400     05  PV-RESTART-ERROR-COUNT          PIC S9(13)  VALUE +0     06960099
060500                                                     COMP SYNC.   06970099
060600                                                                  06980099
060700 01  PV-EXTRACT-TABLE.                                            06990099
060800     05  PV-TBL-EXT-ROW                                           07000099
060900              OCCURS 50000 TIMES                                  07010099
061000                  INDEXED BY EXT-INDEX.                           07020099
061100         10  PV-TBL-EXT-TYPE       PIC X(03).                     07030099
061200         10  FILLER                PIC X(247).                    07040099
061300*                                                                 07050099
061400*                                                                 07060099
061500*                                                                 07070099
061600*  DECLARATION FOR TRIP/VESSEL (DRIVER) CURSOR                    07080099
061700*                                                                 07090099
061800*                                                                 07100099
061900     EXEC SQL                                                     07110099
062000          DECLARE TRIP_CUR CURSOR WITH HOLD FOR                   07120099
062100           SELECT DISTINCT                                        07130099
062200                  T.EST_AR_TMST                                   07140099
062300                , T.VEH_NBR                                       07150099
062400                , T.TRIP_ID                                       07160099
062500                , S.TRIP_STATUS_CDE                               07170099
062600                , V.VEH_TYP_CDE                                   07180099
062700                , O.POE_CDE                                       07190099
062800                , T.OWNER_SCAC_ID                                 07200099
062900             FROM                                                 07210099
063000                  TVHTRIP   T                                     07220099
063100                , TVEHICL   V                                     07230099
063200                , TTRSTYP   Y                                     07240099
063300                , TTRIPST   S                                     07250099
063400                , TSHIPMT   M                                     07260099
063500                , TSHPTPO   N                                     07270099
063600                , TPLNSHP   O                                     07280099
063700                , TPURCHS   P                                     07290099
063800             WHERE                                                07300099
      ***               ((P.PO_TYP_CDE        = 'LD'                    07310099
      **PRB0063437 **START                                              07320099
                        ((P.PO_TYP_CDE      IN ('LD', 'LE','EC')        07330099
      **PRB0063437 ** END                                               07340099
064000                    AND O.DONT_SHIP_BEF_DTE BETWEEN               07350099
064100                        :PV-ETA-BEGIN-DTE AND                     07360099
064200                        :PV-ETA-END-DTE)                          07370099
064300                  OR                                              07380099
064400                   (P.PO_TYP_CDE IN ('IM','IE','IF')              07390099
064500                    AND T.EST_AR_TMST BETWEEN                     07400099
064600                        :PV-ETA-BEGIN-TMST AND                    07410099
064700                        :PV-ETA-END-TMST))                        07420099
064800               AND  V.VEH_TYP_CDE      IN ('VS', 'AV')            07430099
064900               AND  T.SPLT_XMIT_IND    = ' '                      07440099
065000               AND  T.VEH_NBR          = V.VEH_NBR                07450099
065100               AND  Y.TRIP_STATUS_CDE  = S.TRIP_STATUS_CDE        07460099
065200               AND  T.TRIP_ID          = S.TRIP_ID                07470099
065300               AND  T.TRIP_ID          = M.TRIP_ID                07480099
065400               AND  M.SHIPT_ID         = N.SHIPT_ID               07490099
065500               AND  N.PO_NBR           = O.PO_NBR                 07500099
065600               AND  O.VER_STATUS_CDE   = 'A'                      07510099
065700               AND  N.PO_NBR           = P.PO_NBR                 07520099
065800               AND  P.VER_STATUS_CDE   = 'A'                      07530099
065900               AND  T.OWNER_SCAC_ID    = V.OWNER_SCAC_ID          07540099
066000               AND  Y.PRTY_CDE         =                          07550099
066100                    (SELECT MAX(PRTY_CDE)                         07560099
066200                       FROM TTRIPST  ST                           07570099
066300                          , TTRSTYP  TY                           07580099
066400                     WHERE ST.TRIP_ID = T.TRIP_ID                 07590099
066500                       AND ST.TRIP_STATUS_CDE =                   07600099
066600                           TY.TRIP_STATUS_CDE)                    07610099
066700               AND  Y.PRTY_CDE         < '95'                     07620099
066800             ORDER BY O.POE_CDE, T.EST_AR_TMST ,V.VEH_TYP_CDE     07630099
066900     END-EXEC.                                                    07640099
067000*                                                                 07650099
067100*                                                                 07660099
067200*  CURSOR DECLARATION FOR POE CITY                                07670099
067300*                                                                 07680099
067400*  NOTE PO_ASGMT_ALWD_IND  MUST = 'Y' BECAUSE ...                 07690099
067500*                                                                 07700099
067600*                                                                 07710099
067700     EXEC SQL                                                     07720099
067800          DECLARE POE_CUR CURSOR FOR                              07730099
067900           SELECT P.POE_CTY_NM                                    07740099
068000                 ,P.POE_STD_EDI_CDE                               07750099
068100             FROM                                                 07760099
068200                TIMPOE    P                                       07770099
068300             WHERE P.POE_CDE  = :PLNSHP-POE-CDE                   07780099
068400               AND P.TRIP_TYP_CDE = 'O'                           07790099
068500               AND P.PO_ASGMT_ALWD_IND = 'Y'                      07800099
068600               AND P.STAT_CDE = 'A'                               07810099
068700        ORDER BY  P.POE_STD_EDI_CDE                               07820099
068800     END-EXEC.                                                    07830099
068900*                                                                 07840099
069000*                                                                 07850099
069100*  CURSOR DECLARATION TO OBTAIN CONTAINER INFORMATION.            07860099
069200*                                                                 07870099
069300*                                                                 07880099
069400     EXEC SQL                                                     07890099
069500          DECLARE CONT_CUR CURSOR FOR                             07900099
069600           SELECT                                                 07910099
069700                  SH.PRO_NBR                                      07920099
069800                , SH.SHIPT_ID                                     07930099
069900             FROM                                                 07940099
070000                  TVHTRIP   T                                     07950099
070100                , TSHIPMT   SH                                    07960099
070200                , TSHSTYP   Y                                     07970099
070300                , TSHIPST   S                                     07980099
070400             WHERE T.TRIP_ID  = SH.TRIP_ID                        07990099
070500               AND SH.SHIPT_ID = S.SHIPT_ID                       08000099
070600               AND Y.SHIPT_STATUS_CDE = S.SHIPT_STATUS_CDE        08010099
070700               AND SH.TRIP_ID = :VHTRIP-TRIP-ID                   08020099
070800               AND  Y.PRTY_CDE =                                  08030099
070900                    (SELECT MAX(TY.PRTY_CDE)                      08040099
071000                       FROM TSHIPST  ST                           08050099
071100                          , TSHSTYP  TY                           08060099
071200                     WHERE ST.SHIPT_ID = S.SHIPT_ID               08070099
071300                       AND ST.SHIPT_STATUS_CDE =                  08080099
071400                           TY.SHIPT_STATUS_CDE)                   08090099
071500               AND  Y.PRTY_CDE < '95'                             08100099
071600     END-EXEC.                                                    08110099
071700*                                                                 08120099
071800*                                                                 08130099
071900*  CURSOR DECLARATION TO OBTAIN PURCHASE ORDERS FOR EACH CONTAINER08140099
072000*                                                                 08150099
072100*                                                                 08160099
072200     EXEC SQL                                                     08170099
072300          DECLARE PO_CUR CURSOR FOR                               08180099
072400           SELECT                                                 08190099
072500                  SP.PO_NBR                                       08200099
072600                , SP.EXPTED_CART_CNT                              08210099
072700                , SP.SPLT_XMIT_IND                                08220099
072800             FROM                                                 08230099
072900                  TSHPTPO   SP                                    08240099
073000                , TSHIPMT   SH                                    08250099
073100             WHERE SP.SHIPT_ID      = :SHIPMT-SHIPT-ID            08260099
073200               AND SH.SHIPT_ID      =  SP.SHIPT_ID                08270099
073300     END-EXEC.                                                    08280099
073400*                                                                 08290099
073500*                                                                 08300099
073600*                                                                 08310099
073700*  CURSOR DECLARATION TO OBTAIN SPECIAL INSTRUCTIONS FOR PURCHASE 08320099
073800* ORDERS                                                          08330099
073900*                                                                 08340099
074000*                                                                 08350099
074100     EXEC SQL                                                     08360099
074200          DECLARE INSTR_CUR CURSOR FOR                            08370099
074300           SELECT                                                 08380099
074400                  CD.INSTR_DESC                                   08390099
074500                , CD.INSTR_NBR                                    08400099
074600                , PI.RECIP_CDE                                    08410099
074700             FROM                                                 08420099
074800                  TPOINST   PI                                    08430099
074900                , TINSTCD   CD                                    08440099
075000             WHERE PI.PO_NBR   =  :PURCHS-PO-NBR                  08450099
P40877*              AND (PI.RECIP_CDE = 'DC'                           08460099
P40877*               OR  PI.RECIP_CDE = 'DE')                          08470099
P40877               AND PI.RECIP_CDE = 'DE'                            08480099
075300               AND PI.INSTR_NBR  =  CD.INSTR_NBR                  08490099
075400         ORDER BY PI.RECIP_CDE DESC                               08500099
075500                , CD.INSTR_NBR                                    08510099
075600     END-EXEC.                                                    08520099
075700*                                                                 08530099
075800*                                                                 08540099
075900*  CURSOR DECLARATION TO OBTAIN ALL LINES FOR PURCHASE ORDERS     08550099
076000*                                                                 08560099
076100*                                                                 08570099
076200     EXEC SQL                                                     08580099
076300          DECLARE BULK_UPC_CUR CURSOR FOR                         08590099
076400           SELECT                                                 08600099
076500                  LN.APP_PO_LNE_NBR                               08610099
076600                , LN.PO_LNE_NBR                                   08620099
076700                , XVS.VS_NBR                                      08630099
076800                , XS.CSTM_CLOR_DESC                               08640099
076900                , XS.SIZE_DESC                                    08650099
077000                , XS.NRF_CLOR_CDE                                 08660099
077100                , XS.SKU_DESC                                     08670099
077200                , LN.ITM_NBR                                      08680099
077300                , LN.PO_NBR                                       08690099
077400                , LN.STATUS_CDE                                   08700099
077500                , LN.UNT_QTY                                      08710099
077600                , LN.PREPK_RATO_QTY                               08720099
077700                , SKU.UPC_NBR                                     08730099
077800                , SKX.DEPT                                        08740099
077900                , SKX.CLASS                                       08750099
078000                , SKX.SUBCLASS                                    08760099
078100                , SKX.SKU                                         08770099
078110                , LN.OUTR_PK_QTY                                  08780099
078200             FROM                                                 08790099
078300                  TPURITM      LN                                 08800099
078400                 ,TPURCHS      PO                                 08810099
078500                 ,TUPCSKU      SKU                                08820099
078600                 ,TUPC         UPC                                08830099
078700                 ,TSKXREF      SKX                                08840099
078800                 ,XLT_VND_STYL XVS                                08850099
078900                 ,XLT_SKU      XS                                 08860099
079000             WHERE LN.PO_NBR   =  :PURCHS-PO-NBR                  08870099
079100               AND PO.PO_NBR   =  LN.PO_NBR                       08880099
079200               AND LN.ITM_NBR  =  XS.ITM_NBR                      08890099
079300               AND XS.STYL_ID  =  XVS.STYL_ID                     08900099
079400               AND LN.VER_STATUS_CDE = 'A'                        08910099
079500               AND LN.STATUS_CDE  IN ('AC', 'AP')                 08920099
079600               AND PO.VER_STATUS_CDE = 'A'                        08930099
079700               AND SKU.ITEM_NBR   = LN.ITM_NBR                    08940099
079800               AND SKU.UPC_NBR    = UPC.UPC_NBR                   08950099
079900               AND UPC.UPC_TYP_CDE = 'I'                          08960099
080000               AND UPC.EFF_END_DTE IS NULL                        08970099
080100               AND LN.ITM_NBR      = SKX.ITM_NBR                  08980099
080200             ORDER BY LN.APP_PO_LNE_NBR                           08990099
080300     END-EXEC.                                                    09000099
080400*                                                                 09010099
080500*                                                                 09020099
080600*  CURSOR DECLARATION TO OBTAIN ALL DISTRIBUTION CENTERS FOR LINES09030099
080700*  ON PURCHASE ORDER.                                             09040099
080800*                                                                 09050099
080900*                                                                 09060099
081000     EXEC SQL                                                     09070099
081100          DECLARE DC_CUR CURSOR FOR                               09080099
081200           SELECT                                                 09090099
081300                  AL.DEST_NBR                                     09100099
081400                , AL.DC_SPLIT_QTY                                 09110099
081500                , AL.CURR_SPLIT_QTY                               09120099
081600                , AL.PLAN_NBR                                     09130099
155029                , XL.E_BUS_IND                                    09140099
081700             FROM                                                 09150099
081800                  TPURITM   LN                                    09160099
081900                , TALLPLN   AL                                    09170099
155029                , XLT_LOC   XL                                    09180099
082000             WHERE AL.PO_NBR         = :PURITM-PO-NBR             09190099
082100               AND AL.PO_NBR         =  LN.PO_NBR                 09200099
082200               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         09210099
082300               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             09220099
155029               AND AL.DEST_NBR       =  XL.LOC_NBR                09230099
082400               AND AL.CURR_SPLIT_QTY > 0                          09240099
082500               AND LN.VER_STATUS_CDE = 'A'                        09250099
082600               AND LN.STATUS_CDE    IN ('AC', 'AP')               09260099
155029             ORDER BY XL.E_BUS_IND                                09270099
082700                     ,AL.CURR_SPLIT_QTY                           09280099
082800     END-EXEC.                                                    09290099
082900*                                                                 09300099
083000*                                                                 09310099
083100*  CURSOR DECLARATION TO OBTAIN CARTONS PER PO FOR PREPACK ORDERS 09320099
083200*  (THIS IS NOT THE MAIN PREPACK CURSOR)                          09330099
083300*                                                                 09340099
083400     EXEC SQL                                                     09350099
083500          DECLARE POPRPK_FOR_PO_CUR CURSOR FOR                    09360099
083600           SELECT                                                 09370099
083700                  A.PO_PREPK_ID                                   09380099
083800                 ,A.OTPK_UNT_QTY                                  09390099
083900                 ,A.INPK_UNT_QTY                                  09400099
083900                 ,A.PREPK_TYP_CDE                                 09410099
084000             FROM                                                 09420099
084100                  TPOPRPK  A                                      09430099
084200             WHERE A.PO_NBR         = :PURCHS-PO-NBR              09440099
084300             ORDER BY A.PO_PREPK_ID                               09450099
084400     END-EXEC.                                                    09460099
084500*                                                                 09470099
084600*                                                                 09480099
084700*  CURSOR DECLARATION TO OBTAIN CARTONS PER PO FOR BULK ORDERS    09490099
084800*                                                                 09500099
084900*                                                                 09510099
085000     EXEC SQL                                                     09520099
085100          DECLARE PURITM_TUPC_CUR CURSOR FOR                      09530099
085200           SELECT                                                 09540099
085300                I.OUTR_PK_QTY                                     09550099
085400               ,I.UNT_QTY                                         09560099
085500             FROM                                                 09570099
085600                  TPURITM  I                                      09580099
085900             WHERE I.PO_NBR         = :PURCHS-PO-NBR              09590099
086300             AND   I.VER_STATUS_CDE = 'A'                         09600099
086400             AND   I.STATUS_CDE     IN ('AC', 'AP')               09610099
086500             ORDER BY I.ITM_NBR                                   09620099
086600     END-EXEC.                                                    09630099
086700*                                                                 09640099
086800*                                                                 09650099
086900*  CURSOR DECLARATION - MAIN PREPACK CURSOR                       09660099
087000*                                                                 09670099
087100*                                                                 09680099
087200     EXEC SQL                                                     09690099
087300          DECLARE POPRPK_FOR_PCK_CUR CURSOR FOR                   09700099
087400           SELECT POP.PO_PREPK_ID                                 09710099
087500                , POP.INPK_UNT_QTY                                09720099
087600                , POP.OTPK_UNT_QTY                                09730099
087700                , POP.PREPK_DESC                                  09740099
087800                , POP.PREPK_UPC_NBR                               09750099
087900                , POP.PK_SKU_NBR                                  09760099
087900                , POP.PREPK_TYP_CDE                               09770099
088000             FROM TPOPRPK  POP                                    09780099
088100            WHERE POP.PO_NBR       = :PURCHS-PO-NBR               09790099
088200              AND EXISTS                                          09800099
088300                (SELECT *                                         09810099
088400                   FROM TPURITM      A                            09820099
088500                       ,TUPCSKU      B                            09830099
088600                       ,TUPC         C                            09840099
088700                       ,TSKXREF      D                            09850099
088800                       ,XLT_VND_STYL XVS                          09860099
088900                       ,XLT_SKU      XS                           09870099
089000                   WHERE A.PO_NBR    =  :PURCHS-PO-NBR            09880099
089100                     AND A.ITM_NBR   =  XS.ITM_NBR                09890099
089200                     AND XS.STYL_ID  =  XVS.STYL_ID               09900099
089300                     AND A.VER_STATUS_CDE = 'A'                   09910099
089400                     AND A.STATUS_CDE IN ('AC', 'AP')             09920099
089500                     AND A.PO_PREPK_ID = POP.PO_PREPK_ID          09930099
089600                     AND B.ITEM_NBR     = A.ITM_NBR               09940099
089700                     AND B.UPC_NBR      = C.UPC_NBR               09950099
089800                     AND C.UPC_TYP_CDE = 'I'                      09960099
089900                     AND C.EFF_END_DTE IS NULL                    09970099
090000                     AND A.ITM_NBR     = D.ITM_NBR                09980099
090100                 )                                                09990099
090200             ORDER BY POP.PO_PREPK_ID                             10000099
090300     END-EXEC.                                                    10010099
090400*                                                                 10020099
090500*                                                                 10030099
090600*  CURSOR DECLARATION TO OBTAIN PACK DC INFORMATION FOR           10040099
090700*  PURCHASE ORDER                                                 10050099
090800*                                                                 10060099
090900     EXEC SQL                                                     10070099
091000          DECLARE PREPACK_DC_CUR CURSOR FOR                       10080099
091100           SELECT DISTINCT                                        10090099
091200              SUM (A.CURR_SPLIT_QTY) AS SUMSPLIT                  10100099
091300                 ,A.DEST_NBR                                      10110099
155029                 ,X.E_BUS_IND                                     10120099
091400             FROM                                                 10130099
091500                  TALLPLN  A                                      10140099
091600                 ,TPURITM  B                                      10150099
155029                 ,XLT_LOC  X                                      10160099
091700             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                10170099
091800               AND A.PO_NBR      =  B.PO_NBR                      10180099
091900               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  10190099
155029               AND A.DEST_NBR    =  X.LOC_NBR                     10200099
092000               AND A.CURR_SPLIT_QTY > 0                           10210099
092100               AND B.VER_STATUS_CDE = 'A'                         10220099
092200               AND B.STATUS_CDE IN ('AC', 'AP')                   10230099
092300               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           10240099
092400          GROUP BY A.DEST_NBR                                     10250099
155029                  ,X.E_BUS_IND                                    10260099
155029          ORDER BY X.E_BUS_IND                                    10270099
092500                  ,SUMSPLIT                                       10280099
092600                  ,A.DEST_NBR                                     10290099
092700     END-EXEC.                                                    10300099
092800*                                                                 10310099
092900*                                                                 10320099
093000*  CURSOR DECLARATION TO OBTAIN PREPACK PO LINE LEVEL INFO FOR    10330099
093100*  PURCHASE ORDER.                                                10340099
093200*                                                                 10350099
093300*                                                                 10360099
093400     EXEC SQL                                                     10370099
093500          DECLARE PACK_UPC_CUR CURSOR FOR                         10380099
093600           SELECT                                                 10390099
093700                  A.PO_NBR                                        10400099
093800                , A.APP_PO_LNE_NBR                                10410099
093900                , A.PO_LNE_NBR                                    10420099
094000                , XVS.VS_NBR                                      10430099
094100                , XS.CSTM_CLOR_DESC                               10440099
094200                , XS.SIZE_DESC                                    10450099
094300                , XS.NRF_CLOR_CDE                                 10460099
094400                , XS.SKU_DESC                                     10470099
094500                , A.ITM_NBR                                       10480099
094600                , A.STATUS_CDE                                    10490099
094700                , A.UNT_QTY                                       10500099
094800                , A.PREPK_RATO_QTY                                10510099
094900                , C.UPC_NBR                                       10520099
095000                , D.DEPT                                          10530099
095100                , D.CLASS                                         10540099
095200                , D.SUBCLASS                                      10550099
095300                , D.SKU                                           10560099
095400             FROM                                                 10570099
095500                  TPURITM      A                                  10580099
095600                 ,TUPCSKU      B                                  10590099
095700                 ,TUPC         C                                  10600099
095800                 ,TSKXREF      D                                  10610099
095900                 ,XLT_VND_STYL XVS                                10620099
096000                 ,XLT_SKU      XS                                 10630099
096100             WHERE A.PO_NBR    =  :PURCHS-PO-NBR                  10640099
096200               AND A.ITM_NBR   =  XS.ITM_NBR                      10650099
096300               AND XS.STYL_ID  =  XVS.STYL_ID                     10660099
096400               AND A.VER_STATUS_CDE = 'A'                         10670099
096500               AND A.STATUS_CDE IN ('AC', 'AP')                   10680099
096600               AND A.PO_PREPK_ID = :POPRPK-PO-PREPK-ID            10690099
096700               AND B.ITEM_NBR     = A.ITM_NBR                     10700099
096800               AND B.UPC_NBR      = C.UPC_NBR                     10710099
096900               AND C.UPC_TYP_CDE = 'I'                            10720099
097000               AND C.EFF_END_DTE IS NULL                          10730099
097100               AND A.ITM_NBR     = D.ITM_NBR                      10740099
097200             ORDER BY A.PO_LNE_NBR                                10750099
097300     END-EXEC.                                                    10760099
097400*                                                                 10770099
097500*                                                                 10780099
097600*  CURSOR DECLRATION TO OBTAIN E-COMMERCE PREPACK UPC LEVEL DATA  10790099
097700*                                                                 10800099
097800*                                                                 10810099
097900     EXEC SQL                                                     10820099
098000          DECLARE E_COM_PACK_UPC_CUR CURSOR FOR                   10830099
098100           SELECT                                                 10840099
098200                  C.UPC_NBR                                       10850099
098300                 ,A.PO_LNE_NBR                                    10860099
098400             FROM                                                 10870099
098500                  TPURITM  A                                      10880099
098600                 ,TUPCSKU  B                                      10890099
098700                 ,TUPC     C                                      10900099
098800                 ,TPOPRPK  D                                      10910099
098900             WHERE A.PO_NBR       = :PURCHS-PO-NBR                10920099
099000               AND A.VER_STATUS_CDE = 'A'                         10930099
099100               AND A.STATUS_CDE  IN ('AC', 'AP')                  10940099
099200               AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID           10950099
099300               AND B.ITEM_NBR     = A.ITM_NBR                     10960099
099400               AND B.UPC_NBR      = C.UPC_NBR                     10970099
099500               AND C.UPC_TYP_CDE  = 'I'                           10980099
099600               AND C.EFF_END_DTE IS NULL                          10990099
099700               AND D.PO_PREPK_ID  = A.PO_PREPK_ID                 11000099
099800               AND D.PO_NBR       = A.PO_NBR                      11010099
099900             ORDER BY B.UPC_NBR                                   11020099
100000     END-EXEC.                                                    11030099
139868*                                                                 11040099
139868*                                                                 11050099
139868* CURSOR DECLARATION TO OBTAIN ALL OUTLET STORES FOR LINES ON     11060099
139868* THE PURCHASE ORDER.                                             11070099
139868*                                                                 11080099
139868*                                                                 11090099
139868     EXEC SQL                                                     11100099
139868          DECLARE DC_OUT_CUR CURSOR FOR                           11110099
139868           SELECT                                                 11120099
139868                  ES.STR_NBR                                      11130099
139868                , ES.STR_DISTRO_QTY                               11140099
139868             FROM                                                 11150099
139868                  TPURITM   LN                                    11160099
139868                , TMESTDS   ES                                    11170099
155029                , TALLPLN   PL                                    11180099
139868             WHERE ES.PO_NBR         = :PURITM-PO-NBR             11190099
155029               AND ES.PLAN_NBR       = :ALLPLN-PLAN-NBR           11200099
155029               AND PL.PLAN_NBR       =  ES.PLAN_NBR               11210099
139868               AND ES.PO_NBR         =  LN.PO_NBR                 11220099
155029               AND ES.PO_NBR         = PL.PO_NBR                  11230099
139868               AND ES.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         11240099
139868               AND ES.PO_LNE_NBR     =  LN.PO_LNE_NBR             11250099
155029               AND ES.PO_LNE_NBR     =  PL.PO_LNE_NBR             11260099
139868               AND ES.STR_DISTRO_QTY > 0                          11270099
139868               AND LN.VER_STATUS_CDE = 'A'                        11280099
139868               AND LN.STATUS_CDE    IN ('AC', 'AP')               11290099
139868             ORDER BY ES.STR_DISTRO_QTY                           11300099
139868     END-EXEC.                                                    11310099
139868*                                                                 11320099
139868*                                                                 11330099
139868* CURSOR DECLARATION TO OBTAIN OUTLET STORE PACK DC INFORMATION   11340099
139868* FOR THE PURCHASE ORDER                                          11350099
139868*                                                                 11360099
139868     EXEC SQL                                                     11370099
139868          DECLARE PRPACK_DC_OUT_CUR CURSOR FOR                    11380099
139868           SELECT DISTINCT                                        11390099
139868                  ES.STR_NBR                                      11400099
139868                 ,SUM (ES.STR_DISTRO_QTY) AS SUMSPLIT             11410099
139868             FROM                                                 11420099
139868                  TMESTDS  ES                                     11430099
139868                 ,TPURITM  PU                                     11440099
139868             WHERE ES.PO_NBR         = :PURCHS-PO-NBR             11450099
155029               AND ES.PLAN_NBR       = :ALLPLN-PLAN-NBR           11460099
139868               AND ES.PO_NBR         = PU.PO_NBR                  11470099
139868               AND ES.PO_LNE_NBR     = PU.PO_LNE_NBR              11480099
139868               AND ES.STR_DISTRO_QTY > 0                          11490099
139868               AND PU.VER_STATUS_CDE = 'A'                        11500099
139868               AND PU.STATUS_CDE  IN   ('AC', 'AP')               11510099
139868               AND PU.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID        11520099
139868          GROUP BY ES.STR_NBR                                     11530099
139868          ORDER BY SUMSPLIT                                       11540099
139868                  ,ES.STR_NBR                                     11550099
139868     END-EXEC.                                                    11560099
139868                                                                  11570099
100100******************************************************************11580099
100200 LINKAGE SECTION.                                                 11590099
100300******************************************************************11600099
100400                                                                  11610099
100500******************************************************************11620099
100600 PROCEDURE DIVISION.                                              11630099
100700******************************************************************11640099
100800                                                                  11650099
100900******************************************************************11660099
101000 0000-PROGRAM-MAINLINE.                                           11670099
101100                                                                  11680099
101400     PERFORM 1000-INITIALIZE.                                     11690099
101500                                                                  11700099
101600     PERFORM 2000-CREATE-EXTRACT-FILES                            11710099
101700         UNTIL PS-EOC-DRIVER-CURSOR                               11720099
101800                                                                  11730099
101900     PERFORM 9000-EOJ-ROUTINE.                                    11740099
102000     STOP RUN.                                                    11750099
102100                                                                  11760099
102200******************************************************************11770099
102300*  FIRST OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO  11780099
102400*  REPORT FILES.                                                  11790099
102500******************************************************************11800099
102600 1000-INITIALIZE.                                                 11810099
102700                                                                  11820099
102800     PERFORM 1100-RETREVE-CURRENT-TIMESTAMP.                      11830099
102900                                                                  11840099
103000     INITIALIZE PA-TOTAL-OUTPUT-REC-COUNT.                        11850099
103100     INITIALIZE PV-HOLD-TR020-PO-NBR                              11860099
103200                PV-HOLD-TR020-CONTNR-ID                           11870099
103300                PV-HOLD-TR020-PROCESS-DATE.                       11880099
103400                                                                  11890099
103500     PERFORM 6500-GET-CHECKPOINT-CNTL.                            11900099
103600     MOVE PV-CKPT-STAT-CODE       TO                              11910099
103700         PS-RUN-TYPE-SW.                                          11920099
103800                                                                  11930099
103900     IF PS-RESTART-RUN                                            11940099
104000         PERFORM 6550-CHECKPOINT-RESTART                          11950099
104100     END-IF.                                                      11960099
104200                                                                  11970099
104300     MOVE SPACES TO PV-EXTRACT-TABLE.                             11980099
104400     SET EXT-INDEX TO +1.                                         11990099
104500                                                                  12000099
104600     INITIALIZE TR004-REC-TYPE-POE                                12010099
104700                TR004-REC-TYPE-ETA                                12020099
104800                TR004-REC-TYPE-VES                                12030099
104900                TR004-REC-TYPE-CONTAINER                          12040099
105000                TR004-REC-TYPE-PO                                 12050099
105100                TR004-REC-TYPE-INS                                12060099
105200                TR004-REC-TYPE-UPC                                12070099
105300                TR004-REC-TYPE-DC                                 12080099
105400                TR004-REC-TYPE-PCK                                12090099
105500                TR004-REC-TYPE-PDC                                12100099
105600                TR020-REC-TYPE-PO                                 12110099
105700                TR020-REC-TYPE-CONTNR                             12120099
105800                TR020-REC-TYPE-INS                                12130099
105900                TR020-REC-TYPE-UPC                                12140099
106000                TR020-REC-TYPE-PCK                                12150099
106100                TR020-REC-TYPE-PDC                                12160099
106200                DCLTPLNSHP.                                       12170099
106300                                                                  12180099
106400     INITIALIZE TR006-RECORD.                                     12190099
106500     MOVE 'T'                     TO TR006-REPORT-TYPE.           12200099
106600     MOVE PV-CURRENT-TIME (6:2)   TO TR006-PROCESS-MM.            12210099
106700     MOVE PV-CURRENT-TIME (9:2)   TO TR006-PROCESS-DD.            12220099
106800     MOVE PV-CURRENT-TIME (1:4)   TO TR006-PROCESS-YYYY.          12230099
106900     MOVE TR006-PROCESS-DATE      TO PV-HOLD-TR020-PROCESS-DATE.  12240099
107000                                                                  12250099
107100     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    12260099
107200                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   12270099
107300                                                                  12280099
107311*    *** PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM       12290099
107320     MOVE 90          TO KRPRPM-LOC-ID.                           12300099
107330     MOVE 'IMP'       TO KRPRPM-INTFC-SYS-CDE.                    12310099
107340     MOVE 'AC'        TO KRPRPM-FUNC-PRC-STAT-CDE.                12320099
107350                                                                  12330099
107360     MOVE 'PODYBK'    TO KRPRPM-SYS-PRC-FUNC-CDE.                 12340099
107370     PERFORM 1110-SELECT-PARMS.                                   12350099
107380     PERFORM 1200-RETRIEVE-BEGIN-ETA-TMST.                        12360099
107500     DISPLAY '**********    TRKUP005      **********'             12370099
107600     DISPLAY 'PV-ETA-BEGIN-TMST = '  PV-ETA-BEGIN-TMST.           12380099
107700     DISPLAY 'PV-ETA-BEGIN-DTE  = '  PV-ETA-BEGIN-DTE.            12390099
107710                                                                  12400099
107720     MOVE 'PODYFW'    TO KRPRPM-SYS-PRC-FUNC-CDE.                 12410099
107730     PERFORM 1110-SELECT-PARMS.                                   12420099
107800     PERFORM 1300-RETRIEVE-END-ETA-TMST.                          12430099
107900     DISPLAY 'PV-ETA-END-TMST = '    PV-ETA-END-TMST.             12440099
107910                                                                  12450099
107920     MOVE 'PODYFL'    TO KRPRPM-SYS-PRC-FUNC-CDE.                 12460099
107921     PERFORM 1110-SELECT-PARMS.                                   12470099
107930     PERFORM 1310-RETRIEVE-END-LANDED_DATE.                       12480099
107930                                                                  12490099
108000     DISPLAY 'PV-ETA-END-DTE  = '    PV-ETA-END-DTE.              12500099
108100     DISPLAY '**************************************'             12510099
108110*    PRB0040274 - END                                             12520099
107910                                                                  12530099
108300     PERFORM 7000-OPEN-DRIVER-CURSOR.                             12540099
108400                                                                  12550099
108500     SET PS-GOOD-STATUS-CDE-FOUND-NO    TO TRUE.                  12560099
108600     PERFORM 7020-FETCH-DRIVER-CURSOR UNTIL                       12570099
108700        PS-GOOD-STATUS-CDE-FOUND  OR                              12580099
108800        PS-EOC-DRIVER-CURSOR                                      12590099
108900                                                                  12600099
109000     IF PS-EOC-DRIVER-CURSOR                                      12610099
109100         CONTINUE                                                 12620099
109200     ELSE                                                         12630099
109300         PERFORM 4600-SET-CHECKPOINT-TIME                         12640099
109400     END-IF.                                                      12650099
109500                                                                  12660099
109600******************************************************************12670099
109700 1100-RETREVE-CURRENT-TIMESTAMP.                                  12680099
109800                                                                  12690099
109900     EXEC SQL                                                     12700099
110000         SET  :PV-CURRENT-TIME =                                  12710099
110100                 CURRENT TIMESTAMP                                12720099
110200     END-EXEC.                                                    12730099
110300                                                                  12740099
110400     EVALUATE TRUE                                                12750099
110500         WHEN SQLWARN0 NOT EQUAL SPACE                            12760099
110600         WHEN SQLCODE NOT EQUAL ZERO                              12770099
110700             DISPLAY '** ABEND **'                                12780099
110800             DISPLAY '** PROGRAM = TRKUP005 **'                   12790099
110900             DISPLAY '** PARAGRAPH = 1100-RETREVE-CURRENT-TIME**' 12800099
111000             DISPLAY '** UNSUCCESSFUL SELECT OF TIME**'           12810099
111100             PERFORM 9100-SQL-ABEND                               12820099
111200     END-EVALUATE.                                                12830099
111300                                                                  12840099
111400 EJECT                                                            12850099
111410******************************************************************12860099
111420** SELECT PARM - NUMBER OF DAYS TO BE USED IN DATE RANGE CALC   **12870099
111431** PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM             12880099
111440******************************************************************12890099
111450 1110-SELECT-PARMS.                                               12900099
111460                                                                  12910099
111470        EXEC SQL                                                  12920099
111480            SELECT FUNC_QTY                                       12930099
111490              INTO :KRPRPM-FUNC-QTY                               12940099
111491              FROM  TKRPRPM                                       12950099
111492             WHERE  LOC_ID            = :KRPRPM-LOC-ID            12960099
111493               AND  SYS_PRC_FUNC_CDE  = :KRPRPM-SYS-PRC-FUNC-CDE  12970099
111494               AND  INTFC_SYS_CDE     = :KRPRPM-INTFC-SYS-CDE     12980099
111495               AND  FUNC_PRC_STAT_CDE = :KRPRPM-FUNC-PRC-STAT-CDE 12990099
111496             WITH UR                                              13000099
111497        END-EXEC.                                                 13010099
111498                                                                  13020099
111499        EVALUATE TRUE                                             13030099
111500            WHEN SQLCODE = +0                                     13040099
111501                CONTINUE                                          13050099
111502                                                                  13060099
111503            WHEN SQLWARN0 NOT = SPACES                            13070099
111504            WHEN SQLCODE < +0                                     13080099
111505            WHEN SQLCODE > +0                                     13090099
111506             DISPLAY '** ABEND **'                                13100099
111507             DISPLAY '** PROGRAM = TRKUP005 **'                   13110099
111508             DISPLAY '** PARAGRAPH = 1110-SELECT-PARMS **'        13120099
111510             DISPLAY '** KRPRPM-LOC-ID = '                        13130099
111511                           KRPRPM-LOC-ID                          13140099
111512             DISPLAY '** KRPRPM-SYS-PRC-FUNC-CDE = '              13150099
111513                           KRPRPM-SYS-PRC-FUNC-CDE                13160099
111514             DISPLAY '** KRPRPM-INTFC-SYS-CDE = '                 13170099
111515                           KRPRPM-INTFC-SYS-CDE                   13180099
111516             DISPLAY '** KRPRPM-FUNC-PRC-STAT-CDE = '             13190099
111518                           KRPRPM-FUNC-PRC-STAT-CDE               13200099
111519             DISPLAY '** UNSUCCESSFUL SELECT OF PARM**'           13210099
111520             PERFORM 9100-SQL-ABEND                               13220099
111521        END-EVALUATE.                                             13230099
111522                                                                  13240099
139868******************************************************************13250099
139868** SELECT PARM - CHECK IF THIS IS AN OUTLET STORE              ** 13260099
139868******************************************************************13270099
139868 1120-CHECK-IF-OUTLET-DC.                                         13280099
139868                                                                  13290099
139868     MOVE 'TRCNSP'             TO KRPRPM-SYS-PRC-FUNC-CDE.        13300099
139868     MOVE 'KHL'                TO KRPRPM-INTFC-SYS-CDE.           13310099
139868     MOVE 'AC'                 TO KRPRPM-FUNC-PRC-STAT-CDE.       13320099
139868     MOVE 'Y'                  TO KRPRPM-FUNC-TXT.                13330099
139868                                                                  13340099
139868        EXEC SQL                                                  13350099
139868            SELECT LOC_ID                                         13360099
139868              INTO :KRPRPM-LOC-ID                                 13370099
139868              FROM  TKRPRPM                                       13380099
139868             WHERE  LOC_ID            = :KRPRPM-LOC-ID            13390099
139868               AND  SYS_PRC_FUNC_CDE  = :KRPRPM-SYS-PRC-FUNC-CDE  13400099
139868               AND  INTFC_SYS_CDE     = :KRPRPM-INTFC-SYS-CDE     13410099
139868               AND  FUNC_PRC_STAT_CDE = :KRPRPM-FUNC-PRC-STAT-CDE 13420099
139868               AND  FUNC_TXT          = :KRPRPM-FUNC-TXT          13430099
139868             WITH UR                                              13440099
139868        END-EXEC.                                                 13450099
139868                                                                  13460099
139868        EVALUATE TRUE                                             13470099
139868            WHEN SQLCODE = +0                                     13480099
139868            WHEN SQLCODE = +0                                     13490099
139868                SET PS-OUTLET-STORE     TO TRUE                   13500099
139868                                                                  13510099
139868            WHEN SQLCODE = +100                                   13520099
139868                SET PS-OUTLET-STORE-NO  TO TRUE                   13530099
139868                                                                  13540099
139868            WHEN SQLWARN0 NOT = SPACES                            13550099
139868            WHEN SQLCODE < +0                                     13560099
139868            WHEN SQLCODE > +0                                     13570099
139868             DISPLAY '** ABEND **'                                13580099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   13590099
139868             DISPLAY '** PARAGRAPH = 1120-CHECK-IF-OUTLET-DC **'  13600099
139868             DISPLAY '** KRPRPM-LOC-ID            = '             13610099
139868                                          KRPRPM-LOC-ID           13620099
139868             DISPLAY '** KRPRPM-SYS-PRC-FUNC-CDE  = '             13630099
139868                                          KRPRPM-SYS-PRC-FUNC-CDE 13640099
139868             DISPLAY '** KRPRPM-INTFC-SYS-CDE     = '             13650099
139868                                          KRPRPM-INTFC-SYS-CDE    13660099
139868             DISPLAY '** KRPRPM-FUNC-PRC-STAT-CDE = '             13670099
139868                                          KRPRPM-FUNC-PRC-STAT-CDE13680099
139868             DISPLAY '** UNSUCCESSFUL SELECT OF PARM**'           13690099
139868             PERFORM 9100-SQL-ABEND                               13700099
139868        END-EVALUATE.                                             13710099
139868                                                                  13720099
111600      EJECT                                                       13730099
111600******************************************************************13740099
111600 1200-RETRIEVE-BEGIN-ETA-TMST.                                    13750099
111610                                                                  13760099
111630** PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM             13770099
111700                                                                  13780099
111800     EXEC SQL                                                     13790099
111900         SELECT                                                   13800099
111910                CURRENT_TIMESTAMP - (:KRPRPM-FUNC-QTY) DAYS       13810099
111920               ,CURRENT_DATE - (:KRPRPM-FUNC-QTY) DAYS            13820099
112200          INTO :PV-ETA-BEGIN-TMST,                                13830099
112300               :PV-ETA-BEGIN-DTE                                  13840099
112400          FROM TCKRSTCNTL                                         13850099
112500         WHERE JOB_NAME  = :PC-CURRENT-JOB-NAME                   13860099
112600           AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME               13870099
112700     END-EXEC.                                                    13880099
112800                                                                  13890099
112900     EVALUATE TRUE                                                13900099
113000         WHEN SQLWARN0 NOT EQUAL SPACE                            13910099
113100         WHEN SQLCODE NOT EQUAL ZERO                              13920099
113200            DISPLAY '** ABEND **'                                 13930099
113300            DISPLAY '** PROGRAM = TRKUP005 **'                    13940099
113400            DISPLAY '** PARAGRAPH = 1200-RETRIEVE-BEGIN-ETA-TMST' 13950099
113500            DISPLAY '** UNSUCCESSFUL SELECT OF CALCULATED TIME**' 13960099
113510            DISPLAY '** KRPRPM-FUNC-QTY = ' KRPRPM-FUNC-QTY       13970099
113600            PERFORM 9100-SQL-ABEND                                13980099
113700     END-EVALUATE.                                                13990099
113800                                                                  14000099
113900******************************************************************14010099
114000******************************************************************14020099
114100 1300-RETRIEVE-END-ETA-TMST.                                      14030099
114200                                                                  14040099
114310** PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM             14050099
114400                                                                  14060099
114500     EXEC SQL                                                     14070099
114600         SELECT                                                   14080099
114700          CURRENT_TIMESTAMP + (:KRPRPM-FUNC-QTY) DAYS             14090099
114800          INTO :PV-ETA-END-TMST                                   14100099
114900          FROM TCKRSTCNTL                                         14110099
115000         WHERE JOB_NAME  = :PC-CURRENT-JOB-NAME                   14120099
115100           AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME               14130099
115200     END-EXEC.                                                    14140099
115300                                                                  14150099
115400     EVALUATE TRUE                                                14160099
115500         WHEN SQLWARN0 NOT EQUAL SPACE                            14170099
115600         WHEN SQLCODE NOT EQUAL ZERO                              14180099
115700            DISPLAY '** ABEND **'                                 14190099
115800            DISPLAY '** PROGRAM = TRKUP005 **'                    14200099
115900            DISPLAY '** PARAGRAPH = 1300-RETRIEVE-END-ETA-TMST'   14210099
116000            DISPLAY '** UNSUCCESSFUL SELECT OF CALCULATED TIME**' 14220099
116100            DISPLAY 'KRPRPM-FUNC-QTY = ' KRPRPM-FUNC-QTY          14230099
116200            PERFORM 9100-SQL-ABEND                                14240099
116300     END-EVALUATE.                                                14250099
116400                                                                  14260099
116500******************************************************************14270099
116510 1310-RETRIEVE-END-LANDED_DATE.                                   14280099
116520                                                                  14290099
116531** PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM             14300099
116540                                                                  14310099
116550     EXEC SQL                                                     14320099
116560         SELECT                                                   14330099
116570          CURRENT_DATE + (:KRPRPM-FUNC-QTY) DAYS                  14340099
116580          INTO :PV-ETA-END-DTE                                    14350099
116590          FROM TCKRSTCNTL                                         14360099
116591         WHERE JOB_NAME  = :PC-CURRENT-JOB-NAME                   14370099
116592           AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME               14380099
116593     END-EXEC.                                                    14390099
116594                                                                  14400099
116595     EVALUATE TRUE                                                14410099
116596         WHEN SQLWARN0 NOT EQUAL SPACE                            14420099
116597         WHEN SQLCODE NOT EQUAL ZERO                              14430099
116598            DISPLAY '** ABEND **'                                 14440099
116599            DISPLAY '** PROGRAM = TRKUP005 **'                    14450099
116600            DISPLAY '** PARAGRAPH = 1310-RETRIEVE-END-LANDED_DATE'14460099
116601            DISPLAY '** UNSUCCESSFUL SELECT OF CALCULATED DATE**' 14470099
116602            DISPLAY 'KRPRPM-FUNC-QTY = ' KRPRPM-FUNC-QTY          14480099
116603            PERFORM 9100-SQL-ABEND                                14490099
116604     END-EVALUATE.                                                14500099
116605                                                                  14510099
116606 EJECT                                                            14520099
116610******************************************************************14530099
116700* PROCESS:  THIS PARAGRAPH WILL SET UP AND WRITE EXTRACT RECORDS  14540099
116800******************************************************************14550099
116900 2000-CREATE-EXTRACT-FILES.                                       14560099
117000                                                                  14570099
117100     IF PLNSHP-POE-CDE = SPACES                                   14580099
117200         EVALUATE TRUE                                            14590099
117300             WHEN VHTRIP-OWNER-SCAC-ID = 'OCEE'                   14600099
117400                 MOVE 'NY' TO PLNSHP-POE-CDE                      14610099
117500             WHEN VHTRIP-OWNER-SCAC-ID = 'OCEW'                   14620099
117600                 MOVE 'LA' TO PLNSHP-POE-CDE                      14630099
117700             WHEN VHTRIP-OWNER-SCAC-ID = 'OCEN'                   14640099
117800                 MOVE 'CH' TO PLNSHP-POE-CDE                      14650099
117900             WHEN VHTRIP-OWNER-SCAC-ID = 'OCES'                   14660099
118000                 MOVE 'MI' TO PLNSHP-POE-CDE                      14670099
118100             WHEN VHTRIP-OWNER-SCAC-ID = 'OCNW'                   14680099
118200                 MOVE 'SE' TO PLNSHP-POE-CDE                      14690099
118300             WHEN VHTRIP-OWNER-SCAC-ID = 'OCEG'                   14700099
118400                 MOVE 'SA' TO PLNSHP-POE-CDE                      14710099
118500         END-EVALUATE                                             14720099
118600     END-IF.                                                      14730099
118700                                                                  14740099
118800     IF PLNSHP-POE-CDE = PV-HOLD-POE-CDE                          14750099
118900         CONTINUE                                                 14760099
119000     ELSE                                                         14770099
119100         MOVE PLNSHP-POE-CDE   TO PV-HOLD-POE-CDE                 14780099
119200                                  TR020-POE-CDE-CONTNR            14790099
119300         PERFORM 7100-OPEN-POE-CURSOR                             14800099
119400         PERFORM 7120-FETCH-POE-CURSOR                            14810099
119500         PERFORM 7110-CLOSE-POE-CURSOR                            14820099
119600         IF PS-EOC-POE-CURSOR                                     14830099
119700           MOVE 'POE CODE NOT ON TABLE - '                        14840099
119800                              TO TR004-PORT-OF-ENTRY-CTY (1:24)   14850099
119900           IF PLNSHP-POE-CDE < SPACES                             14860099
120000             MOVE SPACES TO TR004-PORT-OF-ENTRY-CTY (24:3)        14870099
120100           ELSE                                                   14880099
120200             MOVE PLNSHP-POE-CDE                                  14890099
120300                              TO TR004-PORT-OF-ENTRY-CTY (24:3)   14900099
120400           END-IF                                                 14910099
120500           SET PS-EOC-POE-CURSOR-NO TO TRUE                       14920099
120600         ELSE                                                     14930099
120700           MOVE IMPOE-POE-CTY-NM TO TR004-PORT-OF-ENTRY-CTY       14940099
120800         END-IF                                                   14950099
120900*        ******************************************************** 14960099
121000*        * EVEN THOUGH THE PORT OF ENTRY CODES ARE UNEQUAL, THE * 14970099
121100*        * PROCESS CAN TURN UP THE SAME POE CITY NAME.          * 14980099
121200*        ******************************************************** 14990099
121300         IF TR004-PORT-OF-ENTRY-CTY = PV-HOLD-PORT-OF-ENTRY-CTY   15000099
121400           CONTINUE                                               15010099
121500         ELSE                                                     15020099
121600           SET TR004-PROCESS-POE-TRANSMISSION TO TRUE             15030099
121700           MOVE TR004-PORT-OF-ENTRY-CTY                           15040099
121800                                  TO PV-HOLD-PORT-OF-ENTRY-CTY    15050099
121900           SET PS-POE-WRITTEN-NO TO TRUE                          15060099
122000           SET PS-ETA-WRITTEN-NO TO TRUE                          15070099
122100           SET PS-VES-WRITTEN-NO TO TRUE                          15080099
122200           SET PS-CON-WRITTEN-NO TO TRUE                          15090099
122300         END-IF                                                   15100099
122400     END-IF.                                                      15110099
122500                                                                  15120099
122600     IF VHTRIP-EST-AR-TMST (1:10) = PV-HOLD-VHTRIP-EST-AR-TMST    15130099
122700         CONTINUE                                                 15140099
122800     ELSE                                                         15150099
122900         INITIALIZE TR004-REC-TYPE-ETA                            15160099
123000         SET TR004-PROCESS-ETA-TRANSMISSION TO TRUE               15170099
123100         INITIALIZE TR006-RECORD                                  15180099
123200         MOVE 'T'                     TO TR006-REPORT-TYPE        15190099
123300         MOVE PV-CURRENT-TIME (6:2)   TO TR006-PROCESS-MM         15200099
123400         MOVE PV-CURRENT-TIME (9:2)   TO TR006-PROCESS-DD         15210099
123500         MOVE PV-CURRENT-TIME (1:4)   TO TR006-PROCESS-YYYY       15220099
123600         MOVE TR006-PROCESS-DATE  TO PV-HOLD-TR020-PROCESS-DATE   15230099
123700                                                                  15240099
123800         MOVE VHTRIP-EST-AR-TMST (1:4)  TO                        15250099
123900             TR004-VESSEL-ETA-DATE (1:4)                          15260099
124000             TR006-ETA-DATE (1:4)                                 15270099
124100         MOVE VHTRIP-EST-AR-TMST (6:2)  TO                        15280099
124200             TR004-VESSEL-ETA-DATE (5:2)                          15290099
124300             TR006-ETA-DATE (5:2)                                 15300099
124400         MOVE VHTRIP-EST-AR-TMST (9:2)  TO                        15310099
124500             TR004-VESSEL-ETA-DATE (7:2)                          15320099
124600             TR006-ETA-DATE (7:2)                                 15330099
124700         MOVE TR004-VESSEL-ETA-DATE     TO                        15340099
124800             TR020-VESSEL-ETA-DATE-CONTNR                         15350099
124900         MOVE VHTRIP-EST-AR-TMST (1:10) TO                        15360099
125000             PV-HOLD-VHTRIP-EST-AR-TMST                           15370099
125100         SET PS-ETA-WRITTEN-NO TO TRUE                            15380099
125200         SET PS-VES-WRITTEN-NO TO TRUE                            15390099
125300         SET PS-CON-WRITTEN-NO TO TRUE                            15400099
125400     END-IF.                                                      15410099
125500                                                                  15420099
125600     IF VHTRIP-VEH-NBR = PV-HOLD-VHTRIP-VEH-NBR                   15430099
125700         CONTINUE                                                 15440099
125800     ELSE                                                         15450099
125900         MOVE VHTRIP-VEH-NBR   TO PV-HOLD-VHTRIP-VEH-NBR          15460099
126000         INITIALIZE TR004-REC-TYPE-VES                            15470099
126100         SET TR004-PROCESS-VES-TRANSMISSION TO TRUE               15480099
126200         INITIALIZE TR006-VESSEL-NAME                             15490099
126300                                                                  15500099
126400         MOVE VHTRIP-VEH-NBR             TO                       15510099
126500             TR006-VESSEL-NAME                                    15520099
126600             TR004-VESSEL-NAME                                    15530099
126700                                                                  15540099
126800         EVALUATE VEHICL-VEH-TYP-CDE                              15550099
126900             WHEN 'VS'                                            15560099
127000                 MOVE PC-O               TO                       15570099
127100                     TR004-TRIP-TYP-CDE                           15580099
127200             WHEN 'AV'                                            15590099
127300                 MOVE PC-A               TO                       15600099
127400                     TR004-TRIP-TYP-CDE                           15610099
127500             WHEN 'TR'                                            15620099
127600                 MOVE PC-M               TO                       15630099
127700                     TR004-TRIP-TYP-CDE                           15640099
127800             WHEN OTHER                                           15650099
127900                 MOVE SPACE              TO                       15660099
128000                     TR004-TRIP-TYP-CDE                           15670099
128100         END-EVALUATE                                             15680099
128200         SET PS-VES-WRITTEN-NO TO TRUE                            15690099
128300         SET PS-CON-WRITTEN-NO TO TRUE                            15700099
128400     END-IF.                                                      15710099
128500                                                                  15720099
128600     MOVE VEHICL-VEH-TYP-CDE                                      15730099
128700                        TO TR020-TRIP-TYP-CDE-CONTNR.             15740099
128800     MOVE VHTRIP-VEH-NBR                                          15750099
128900                        TO TR020-VESSEL-NAME-CONTNR.              15760099
129000                                                                  15770099
129100     IF VHTRIP-TRIP-ID  = PV-HOLD-VHTRIP-TRIP-ID                  15780099
129200       CONTINUE                                                   15790099
129300     ELSE                                                         15800099
129400       IF PS-FIRST-TRIP                                           15810099
129500         SET PS-FIRST-TRIP-NO   TO TRUE                           15820099
129600       ELSE                                                       15830099
129700         IF PS-BAD-TRIP                                           15840099
129800            CONTINUE                                              15850099
129900         ELSE                                                     15860099
130000            PERFORM 2290-UPDATE-TVHTRIP                           15870099
130100         END-IF                                                   15880099
130200       END-IF                                                     15890099
130300                                                                  15900099
130400       MOVE VHTRIP-TRIP-ID  TO PV-HOLD-VHTRIP-TRIP-ID             15910099
130500       SET PS-BAD-TRIP-NO   TO TRUE                               15920099
130600     END-IF.                                                      15930099
130700                                                                  15940099
130800     PERFORM 7300-OPEN-CONT-CURSOR.                               15950099
130900                                                                  15960099
131000     PERFORM 2100-PROCESS-CONTAINERS UNTIL                        15970099
131100         PS-EOC-CONT-CURSOR.                                      15980099
131200     SET PS-EOC-CONT-CURSOR-NO    TO TRUE.                        15990099
131300                                                                  16000099
131400     PERFORM 4400-CHECKPOINT-CHECK.                               16010099
131500                                                                  16020099
131600     SET PS-GOOD-STATUS-CDE-FOUND-NO    TO TRUE.                  16030099
131700     PERFORM 7020-FETCH-DRIVER-CURSOR UNTIL                       16040099
131800        PS-GOOD-STATUS-CDE-FOUND  OR                              16050099
131900        PS-EOC-DRIVER-CURSOR.                                     16060099
132000                                                                  16070099
132100******************************************************************16080099
132200*  PROCESS ALL CONTAINERS FOR THIS TRIP.                          16090099
132300******************************************************************16100099
132400 2100-PROCESS-CONTAINERS.                                         16110099
132600     INITIALIZE TR004-REC-TYPE-CONTAINER.                         16120099
132700                                                                  16130099
132800     PERFORM 7500-FETCH-CONT-CURSOR.                              16140099
132900                                                                  16150099
133000     IF PS-EOC-CONT-CURSOR                                        16160099
133100         PERFORM 7400-CLOSE-CONT-CURSOR                           16170099
133200     ELSE                                                         16180099
133300         INITIALIZE TR006-CONTAINER-NUMBER                        16190099
133400         MOVE SHIPMT-PRO-NBR          TO                          16200099
133500             TR004-CONTNR-ID                                      16210099
133600             TR006-CONTAINER-NUMBER                               16220099
133700             PV-HOLD-TR020-CONTNR-ID                              16230099
133800         SET PS-CON-WRITTEN-NO TO TRUE                            16240099
133900         PERFORM 7600-OPEN-PO-CURSOR                              16250099
134000         PERFORM 2200-PROCESS-PO UNTIL                            16260099
134100             PS-EOC-PO-CURSOR                                     16270099
134200         SET PS-EOC-PO-CURSOR-NO      TO TRUE                     16280099
134300     END-IF.                                                      16290099
134400                                                                  16300099
134500******************************************************************16310099
134600* PROCESS ALL PURCHASE ORDERS FOR THIS CONTAINER.                *16320099
134700******************************************************************16330099
134800 2200-PROCESS-PO.                                                 16340099
135000     SET PS-UNPROCESSED-PO-FOUND-NO   TO TRUE.                    16350099
135010     PERFORM 7800-FETCH-PO-CURSOR                                 16360099
135020       UNTIL PS-UNPROCESSED-PO-FOUND                              16370099
135030          OR PS-EOC-PO-CURSOR.                                    16380099
135040                                                                  16390099
135050     IF PS-EOC-PO-CURSOR                                          16400099
135060         PERFORM 7700-CLOSE-PO-CURSOR                             16410099
135070     ELSE                                                         16420099
135080         INITIALIZE TR004-REC-TYPE-PO                             16430099
135090                    TR006-DONT-SHIP-BEFORE-DATE                   16440099
135100                    PV-HOLD-PO-NBR                                16450099
135200         MOVE SHPTPO-PO-NBR           TO                          16460099
135300             TR006-PO-NBR                                         16470099
135400         SET PS-PO-PASSED-EDITS-NO    TO TRUE                     16480099
135500         PERFORM 2240-PO-EDITS                                    16490099
135600                                                                  16500099
135700         IF PS-PO-PASSED-EDITS                                    16510099
135800           PERFORM 2220-GET-CARTONS-PER-PO                        16520099
135900         ELSE                                                     16530099
136000           SET  PS-BAD-TRIP  TO TRUE                              16540099
136100           MOVE ZERO         TO TR004-CART-PER-PO                 16550099
136200         END-IF                                                   16560099
136300                                                                  16570099
136400         IF PS-PO-PASSED-EDITS                                    16580099
136500           PERFORM 2260-SELECT-PLNSHP-DATES                       16590099
136600           SET PS-PROBLEM-SO-SET-RETRANS-NO TO TRUE               16600099
136700           SET PS-SPLITS-ENTERED            TO TRUE               16610099
136800                                                                  16620099
136900           EVALUATE TRUE                                          16630099
137000*             **********************************************      16640099
137100*             * FOR POS PREVIOUSLY SENT AS CMNS -          *      16650099
137200*             * ALWAYS SEND SPLITS EVEN IF THE PO WAS      *      16660099
137300*             * ALREADY PROCESSED ON ANOTHER CON CONTAINER.*      16670099
137400*             **********************************************      16680099
137500              WHEN PS-PREV-SENT-AS-CMN                            16690099
137600*             **********************************************      16700099
137700*             * BUT IF  NOT  PREVIOUSLY SENT AS CMN -      *      16710099
137800*             *   ONLY SEND SPLITS IF THE PO HAS NOT YET   *      16720099
137900*             *   BEEN PROCESSED ON ANOTHER CON CONTAINER. *      16730099
138000*             **********************************************      16740099
138100              WHEN IMPORL-DCONSLR-RLSE-CDE = 'N'                  16750099
138200              WHEN IMPORL-DCONSLR-RLSE-CDE = 'D'                  16760099
138300                  AND IMPORL-DCONSLR-ACTL-DTE = PC-NULL-DTE       16770099
138400                                                                  16780099
138500                PERFORM 2210-CREATE-PO                            16790099
138600                                                                  16800099
138700              WHEN OTHER                                          16810099
138800                                                                  16820099
138900                SET PS-PO-ALREADY-SENT TO TRUE                    16830099
139000                MOVE SHPTPO-PO-NBR  TO TR004-PO-NBR               16840099
139100                INITIALIZE TR004-EXTL-REF-NBR                     16850099
139200                           TR004-VENDOR-NAME                      16860099
139300                           TR004-DO-NOT-SHIP-BEF-DTE              16870099
139400                           TR004-CANCEL-DATE                      16880099
139500                           TR004-OPEN-TO-BUY-PERIOD               16890099
139600                           TR004-PKGNG-CDE                        16900099
139700                           TR004-PO-TYP-CDE                       16910099
139800                           TR004-CART-PER-PO                      16920099
139900                           TR004-PO-UNIT-QTY                      16930099
140000                           TR004-AD-DATE                          16940099
140100                PERFORM 5400-WRITE-PO-RECORD                      16950099
140200                PERFORM 3000-WRITE-OUT-GOOD-PO-RECS               16960099
140300                MOVE SPACES TO PV-EXTRACT-TABLE                   16970099
140400                SET EXT-INDEX TO +1                               16980099
140500                SET PS-PO-ALREADY-SENT-NO  TO TRUE                16990099
140600           END-EVALUATE                                           17000099
140700                                                                  17010099
140800*          ************************************************       17020099
140900*          * NOTE: CONCERNING THE SHPTPO-SPLT-XMIT-IND:   *       17030099
141000*          * IF THE PO NEEDS TO BE RETRANSMITTED THE      *       17040099
141100*          * SHPTPO-SPLT-XMIT-IND IS SET TO 'S' IN PARA   *       17050099
141200*          * 2210-CREATE-PO AFTER ALL THE LINES ARE       *       17060099
141300*          * PROCESSED.  OTHERWISE IT IS SET TO 'Y' HERE. *       17070099
141400*          * THIS WOULD INCLUDE UPDATING THE              *       17080099
141500*          * SHPTPO-SPLT-XMIT-IND FOR THE FIRST SHIPMENT  *       17090099
141600*          * /CONTAINER TRANSMITTED FOR THE PO AND LATER  *       17100099
141700*          * UPDATING THE INDICATOR FOR ADIFFERENT ROW    *       17110099
141800*          * (SAME PO NUMBER BUT DIFFERENT SHIPMENT       *       17120099
141900*          * /CONTAINER FOR THE SAME TRIP).  THE PO WITH  *       17130099
142000*          * IT'S LINES AND SPLITS IS ONLY TRANSMITTED ONCE       17140099
142100*          * IN TRKUP005 EVEN THOUGH MULTIPLE SHIPMENT/   *       17150099
142200*          * CONTAINER RECORDS CAN BE TRANSMITTED FOR     *       17160099
142300*          * THE SAME PO DURING THE SAME TRANSMISSION OR  *       17170099
142400*          * MULTIPLE TRANSMISSIONS.                              17180099
142500*          ************************************************       17190099
142600           IF PS-TSHPTPO-UPDATED                                  17200099
142700               SET PS-TSHPTPO-UPDATED-NO TO TRUE                  17210099
142800           ELSE                                                   17220099
142900               IF IMPORL-DCONSLR-RLSE-CDE = 'S'                   17230099
143000*                ****************************************         17240099
143100*                * THIS WOULD BE TRUE IF THE PO WERE ON *         17250099
143200*                * A PREV CONTAINER AND MISSING SPLITS. *         17260099
143300*                ****************************************         17270099
143400                 MOVE 'S' TO SHPTPO-SPLT-XMIT-IND                 17280099
143500               ELSE                                               17290099
143600                 MOVE 'Y' TO SHPTPO-SPLT-XMIT-IND                 17300099
143700               END-IF                                             17310099
143800               PERFORM 2270-UPDATE-TSHPTPO                        17320099
143900           END-IF                                                 17330099
144000                                                                  17340099
144100         END-IF                                                   17350099
144200*        ABOVE END-IF FOR - 'IF PO-PASSED-EDITS'                  17360099
144300                                                                  17370099
144400     END-IF.                                                      17380099
144500*    ABOVE END-IF FOR - 'IF PS-EOC-PO-CURSOR'                     17390099
144600                                                                  17400099
144700******************************************************************17410099
144800* CREATE PURCHASE ORDER RECORDS FOR EXTRACT (TOUTTR2).           *17420099
144900******************************************************************17430099
145000 2210-CREATE-PO.                                                  17440099
145200     MOVE SHPTPO-PO-NBR           TO                              17450099
145300         TR004-PO-NBR                                             17460099
145400         PV-HOLD-TR020-PO-NBR.                                    17470099
145500                                                                  17480099
145600     PERFORM 2215-SELECT-ENTITY-NAME-DESCR.                       17490099
145700                                                                  17500099
145800     PERFORM 2217-SELECT-AD-DATE.                                 17510099
145900                                                                  17520099
146000     MOVE PURCHS-OTB-PER-NBR TO                                   17530099
146100         TR004-OPEN-TO-BUY-PERIOD.                                17540099
146200                                                                  17550099
146300     MOVE PURCHS-PKGNG-CDE        TO TR004-PKGNG-CDE.             17560099
146400     MOVE PURCHS-PO-TYP-CDE       TO TR004-PO-TYP-CDE.            17570099
146500                                                                  17580099
146600     PERFORM 5400-WRITE-PO-RECORD.                                17590099
146700                                                                  17600099
146800*    ***************************************************          17610099
146900*    * FROM THIS POINT ON ONLY DO THIS ONCE PER PO     *          17620099
147000*    ***************************************************          17630099
147100     PERFORM 2300-PROCESS-INSTRUCTION-LINES.                      17640099
147200                                                                  17650099
147300     IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           17660099
147400         PERFORM 8735-OPEN-POPRPK-FOR-PCK-CUR                     17670099
147500         PERFORM 2350-PROCESS-PACKS-IDS                           17680099
147600                UNTIL PS-EOC-PACK-CURSOR                          17690099
147700         SET PS-EOC-PACK-CURSOR-NO TO TRUE                        17700099
147800     ELSE                                                         17710099
147900         PERFORM 8200-OPEN-BULK-UPC-CUR                           17720099
148000         SET PS-LINES-ON-TPURITM-NO       TO TRUE                 17730099
148100         PERFORM 2400-PROCESS-UPC-FOR-BULK UNTIL                  17740099
148200                 PS-EOC-BULK-UPC-CUR                              17750099
148300         SET PS-EOC-BULK-UPC-CUR-NO       TO TRUE                 17760099
148400     END-IF.                                                      17770099
148500                                                                  17780099
148600*    **********************************************************   17790099
148700*    * NOTE: CONCERNING THE TIMPORL DCONSLR_RLSE_CDE:         *   17800099
148800*    *                                                        *   17810099
148900*    * IF ANY LINES FOR THE PO DON'T HAVE SPLITS OR SPLIT     *   17820099
149000*    *  TOTALS = ZERO                                         *   17830099
149100*    *  AN 'S' IS MOVED TO TIMPORL.DCONSLR_RLSE_CDE.          *   17840099
149200*    *                                                        *   17850099
149300*    * IF ALL THE LINES FOR THE PO DO HAVE SPLITS             *   17860099
149400*    *   A 'Y' IS MOVED TO TIMPORL.DCONSLR_RLSE_CDE           *   17870099
149500*    *   ONLY IF THERE ARE NO ERRORS -                        *   17880099
149600*    *         (PS-PROBLEM-SO-SET-RETRANS-NO)                     17890099
149700*    *                                                        *   17900099
149800*    * THE ONLY TIME THE TIMPORL DCONSLR_RLSE_CDE IS 'N' IS   *   17910099
149900*    * WHEN THERE IS AN ERROR TO CAUSE                        *   17920099
150000*    *   PS-PROBLEM-SO-SET-RETRANS  TO BE TRUE                *   17930099
150100*    *                                                        *   17940099
150200*    * THE S ALLOWS THE ONLINE PROGRAM TO DISPLAY ALL THOSE   *   17950099
150300*    * PO'S NEEDING SPLITS BY THE ANALYSTS.  AND S IS ONE OF  *   17960099
150400*    * THE SIGNALS FOR THE RETRANSMIT PROGRAM TO RETRY THIS   *   17970099
150500*    * PO PERFORMING THE EDITS AGAIN AND RETRANSMITTING.      *   17980099
150600*    **********************************************************   17990099
150700     PERFORM 2275-SELECT-TIMPORL.                                 18000099
150800                                                                  18010099
150900     EVALUATE TRUE                                                18020099
151000                                                                  18030099
151100        WHEN PS-PROBLEM-SO-SET-RETRANS                            18040099
151200                                                                  18050099
151300           SET PS-TSHPTPO-UPDATED      TO TRUE                    18060099
151400           SET PS-BAD-TRIP             TO TRUE                    18070099
151500                                                                  18080099
151600*       **********************************************            18090099
151700*       * IN THE CASE WHERE A PO WAS PREVIOUSLY SENT *            18100099
151800*       * AS A CMN, WE NEED TO SEND TRIANGLE SPLITS  *            18110099
151900*       * FOR EACH CONTAINER THE PO APPEARS ON SINCE *            18120099
152000*       * WE DON'T KNOW WHICH CONTAINER THEY WORKED  *            18130099
152100*       * WHEN THE PO FIRST WENT AS A CMN.  HOWEVER, *            18140099
152200*       * WE ONLY WANT TO UPDATE TIMPORL ONCE.       *            18150099
152300*       **********************************************            18160099
152400                                                                  18170099
152500        WHEN PS-PREV-SENT-AS-CMN                                  18180099
152600                                                                  18190099
152700           IF PS-SPLITS-ENTERED                                   18200099
152800             IF IMPORL-DCONSLR-RLSE-CDE = 'Y'                     18210099
152900               CONTINUE                                           18220099
153000             ELSE                                                 18230099
153100               PERFORM 2280-INACTIVATE-TIMPORL                    18240099
153200               ADD  +1  TO IMPORL-VER-NBR                         18250099
153300               MOVE 'Y' TO IMPORL-DCONSLR-RLSE-CDE                18260099
153400               PERFORM 2285-INSERT-TIMPORL                        18270099
153500             END-IF                                               18280099
153600           END-IF                                                 18290099
153700                                                                  18300099
153800           IF PS-SPLITS-ENTERED-NO                                18310099
153900             IF IMPORL-DCONSLR-RLSE-CDE = 'S'                     18320099
154000               CONTINUE                                           18330099
154100             ELSE                                                 18340099
154200               PERFORM 2280-INACTIVATE-TIMPORL                    18350099
154300               ADD  +1  TO IMPORL-VER-NBR                         18360099
154400               MOVE 'S' TO IMPORL-DCONSLR-RLSE-CDE                18370099
154500               PERFORM 2285-INSERT-TIMPORL                        18380099
154600             END-IF                                               18390099
154700           END-IF                                                 18400099
154800                                                                  18410099
154900           PERFORM 3000-WRITE-OUT-GOOD-PO-RECS                    18420099
155000                                                                  18430099
155100        WHEN PS-SPLITS-ENTERED-NO                                 18440099
155200                                                                  18450099
155300           MOVE 'S' TO SHPTPO-SPLT-XMIT-IND                       18460099
155400           PERFORM 2270-UPDATE-TSHPTPO                            18470099
155500           SET PS-TSHPTPO-UPDATED      TO TRUE                    18480099
155600                                                                  18490099
155700           PERFORM 2280-INACTIVATE-TIMPORL                        18500099
155800           ADD  +1  TO IMPORL-VER-NBR                             18510099
155900           MOVE 'S' TO IMPORL-DCONSLR-RLSE-CDE                    18520099
156000           PERFORM 2285-INSERT-TIMPORL                            18530099
156100                                                                  18540099
156200           PERFORM 3000-WRITE-OUT-GOOD-PO-RECS                    18550099
156300                                                                  18560099
156400        WHEN OTHER                                                18570099
156500                                                                  18580099
156600           PERFORM 2280-INACTIVATE-TIMPORL                        18590099
156700           ADD  +1  TO IMPORL-VER-NBR                             18600099
156800           MOVE 'Y' TO IMPORL-DCONSLR-RLSE-CDE                    18610099
156900           PERFORM 2285-INSERT-TIMPORL                            18620099
157000                                                                  18630099
157100           PERFORM 3000-WRITE-OUT-GOOD-PO-RECS                    18640099
157200                                                                  18650099
157300     END-EVALUATE.                                                18660099
157400                                                                  18670099
157500     MOVE SPACES TO PV-EXTRACT-TABLE.                             18680099
157600     SET EXT-INDEX TO +1.                                         18690099
157700                                                                  18700099
157800******************************************************************18710099
157900 2215-SELECT-ENTITY-NAME-DESCR.                                   18720099
158000*                                                                 18730099
158100     EXEC SQL                                                     18740099
158200           SELECT DISTINCT                                        18750099
158300                  EN.ENT_NAME_DESC                                18760099
158400             INTO                                                 18770099
158500                  :ENTNME-ENT-NAME-DESC                           18780099
158600             FROM                                                 18790099
158700                  TENTNME   EN                                    18800099
158800                , TPURCHS   PO                                    18810099
158900             WHERE PO.PO_NBR     =  :SHPTPO-PO-NBR                18820099
159000               AND PO.ENT_ID     =  EN.ENT_ID                     18830099
159100               AND PO.VER_STATUS_CDE = 'A'                        18840099
159200               AND EN.TYPE_CDE = '01'                             18850099
159300     END-EXEC                                                     18860099
159400                                                                  18870099
159500     EVALUATE TRUE                                                18880099
159600         WHEN SQLCODE = ZERO                                      18890099
159700             MOVE ENTNME-ENT-NAME-DESC  TO                        18900099
159800                 TR004-VENDOR-NAME                                18910099
159900                                                                  18920099
160000         WHEN SQLCODE = +100                                      18930099
160100             CONTINUE                                             18940099
160200         WHEN SQLWARN0 NOT EQUAL SPACE                            18950099
160300         WHEN SQLCODE NOT EQUAL ZERO                              18960099
160400             DISPLAY '** ABEND **'                                18970099
160500             DISPLAY '** PROGRAM = TRKUP005 **'                   18980099
160600          DISPLAY '** PARAGRAPH = 2215-SELECT-ENTITY-NAME-DESCR'  18990099
160700             PERFORM 9100-SQL-ABEND                               19000099
160800     END-EVALUATE.                                                19010099
160900******************************************************************19020099
161000*  GET THE EARLIEST ADVERTISING DATE                              19030099
161100******************************************************************19040099
161200 2217-SELECT-AD-DATE.                                             19050099
161300*                                                                 19060099
161400     EXEC SQL                                                     19070099
161500         SELECT  MIN(AD_EVNT_DTE)                                 19080099
161600           INTO  :PURITM-AD-EVNT-DTE                              19090099
161700           FROM  TPURITM                                          19100099
161800          WHERE  PO_NBR         = :SHPTPO-PO-NBR                  19110099
161900            AND  AD_EVNT_DTE   <> '0001-01-01'                    19120099
162000            AND  VER_STATUS_CDE = 'A'                             19130099
162100            AND  STATUS_CDE    IN ('AC', 'AP')                    19140099
162200     END-EXEC                                                     19150099
162300                                                                  19160099
162400     EVALUATE TRUE                                                19170099
162500         WHEN SQLCODE = +0                                        19180099
162600              MOVE PURITM-AD-EVNT-DTE (1:4)                       19190099
162700                                   TO TR004-AD-DATE (1:4)         19200099
162800              MOVE PURITM-AD-EVNT-DTE (6:2)                       19210099
162900                                   TO TR004-AD-DATE (5:2)         19220099
163000              MOVE PURITM-AD-EVNT-DTE (9:2)                       19230099
163100                                   TO TR004-AD-DATE (7:2)         19240099
163200                                                                  19250099
163300         WHEN SQLCODE =  100                                      19260099
163400         WHEN SQLCODE = -305                                      19270099
163500              MOVE SPACES     TO TR004-AD-DATE                    19280099
163600                                                                  19290099
163700         WHEN SQLWARN0 NOT = SPACE                                19300099
163800         WHEN SQLCODE  NOT = +0                                   19310099
163900             DISPLAY '** ABEND **'                                19320099
164000             DISPLAY '** PROGRAM = TRKUP005 **'                   19330099
164100             DISPLAY '** PARAGRAPH = 2217-SELECT-AD-DATE'         19340099
164200             PERFORM 9100-SQL-ABEND                               19350099
164300     END-EVALUATE.                                                19360099
164400                                                                  19370099
164500******************************************************************19380099
164600* THIS USED ONLY TO GET TR004-CART-PER-PO                        *19390099
164700******************************************************************19400099
164800 2220-GET-CARTONS-PER-PO.                                         19410099
165000     MOVE ZEROS TO  PV-CART-PER-PO                                19420099
165100                    PV-SUM-PURITM-UNT-QTY                         19430099
165200                    PV-PURITM-UNT-QTY-TOT                         19440099
165300                    PV-CART-PER-PREPACK                           19450099
165400                    PV-CART-PER-ITEM.                             19460099
165500     IF PURCHS-PKGNG-CDE = PC-I OR PC-M                           19470099
165600       PERFORM 8715-OPEN-POPRPK-FOR-PO-CUR                        19480099
165700       PERFORM 2222-SUM-PO-CARTONS-PREPACK                        19490099
165800              UNTIL PS-EOC-POPRPK-FOR-PO-CUR                      19500099
165900       SET PS-EOC-POPRPK-FOR-PO-CUR-NO TO TRUE                    19510099
166000       PERFORM 8717-CLOSE-POPRPK-FOR-PO-CUR                       19520099
166100     ELSE                                                         19530099
166200       PERFORM 8725-OPEN-PURITM-TUPC-CUR                          19540099
166300       PERFORM 2230-SUM-PO-CARTONS-BULK                           19550099
166400              UNTIL PS-EOC-PURITM-TUPC-CUR                        19560099
166500       SET PS-EOC-PURITM-TUPC-CUR-NO TO TRUE                      19570099
166600       PERFORM 8727-CLOSE-PURITM-TUPC-CUR                         19580099
166700     END-IF.                                                      19590099
166800     MOVE PV-CART-PER-PO          TO TR004-CART-PER-PO.           19600099
166900     MOVE PV-PURITM-UNT-QTY-TOT   TO TR004-PO-UNIT-QTY.           19610099
167000                                                                  19620099
167100******************************************************************19630099
167200 2222-SUM-PO-CARTONS-PREPACK.                                     19640099
167300                                                                  19650099
167400     PERFORM 8720-FETCH-POPRPK-FOR-PO-CUR.                        19660099
167500     IF PS-EOC-POPRPK-FOR-PO-CUR                                  19670099
167600       CONTINUE                                                   19680099
167700     ELSE                                                         19690099
167800       EVALUATE TRUE                                              19700099
167900                                                                  19710099
168000** BUD * WHEN PURCHS-PKGNG-CDE = PC-M                             19720099
168000         WHEN POPRPK-PREPK-TYP-CDE = PC-M                         19730099
168100           IF POPRPK-INPK-UNT-QTY = ZERO                          19740099
168200             CONTINUE                                             19750099
168300           ELSE                                                   19760099
168400             PERFORM 2225-SELECT-PURITM-UNT-QTY                   19770099
168500             COMPUTE PV-CART-PER-PREPACK =                        19780099
168600               (PV-SUM-PURITM-UNT-QTY / POPRPK-INPK-UNT-QTY)      19790099
168700             ADD PV-CART-PER-PREPACK   TO PV-CART-PER-PO          19800099
168800             ADD PV-SUM-PURITM-UNT-QTY TO PV-PURITM-UNT-QTY-TOT   19810099
168900           END-IF                                                 19820099
169000                                                                  19830099
168000** BUD * WHEN PURCHS-PKGNG-CDE = PC-I                             19840099
168000         WHEN POPRPK-PREPK-TYP-CDE = PC-I                         19850099
169200           IF POPRPK-OTPK-UNT-QTY = ZERO                          19860099
169300             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 19870099
169400             INITIALIZE TR006-ERROR-MSG                           19880099
169500                        TR006-UPC-NBR                             19890099
169600                        TR006-SKU                                 19900099
169700             STRING 'POPRPK-OTPK-UNT-QTY '                        19910099
169800                    'FLD IS 0-PO'                                 19920099
169900                 DELIMITED BY SIZE                                19930099
170000                 INTO TR006-ERROR-MSG                             19940099
170100             PERFORM 8830-WRITE-ERROR-LINE                        19950099
170200           ELSE                                                   19960099
170300             PERFORM 2225-SELECT-PURITM-UNT-QTY                   19970099
170400             COMPUTE PV-CART-PER-PREPACK =                        19980099
170500               (PV-SUM-PURITM-UNT-QTY / POPRPK-OTPK-UNT-QTY)      19990099
170600             ADD PV-CART-PER-PREPACK   TO PV-CART-PER-PO          20000099
170700             ADD PV-SUM-PURITM-UNT-QTY TO PV-PURITM-UNT-QTY-TOT   20010099
170800           END-IF                                                 20020099
170900                                                                  20030099
171000       END-EVALUATE                                               20040099
171100                                                                  20050099
171200     END-IF.                                                      20060099
171300                                                                  20070099
171400******************************************************************20080099
171500 2225-SELECT-PURITM-UNT-QTY.                                      20090099
171600                                                                  20100099
171700     EXEC SQL                                                     20110099
171800           SELECT                                                 20120099
171900                 SUM (A.UNT_QTY)                                  20130099
172000             INTO                                                 20140099
172100                :PV-SUM-PURITM-UNT-QTY                            20150099
172200             FROM                                                 20160099
172300                  TPURITM  A                                      20170099
172400             WHERE A.PO_NBR         = :PURCHS-PO-NBR              20180099
172500               AND A.VER_STATUS_CDE = :PC-A                       20190099
172600               AND A.STATUS_CDE    IN ('AC', 'AP')                20200099
172700               AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID         20210099
172800     END-EXEC.                                                    20220099
172900                                                                  20230099
173000     EVALUATE TRUE                                                20240099
173100         WHEN SQLCODE = ZERO                                      20250099
173200             CONTINUE                                             20260099
173300                                                                  20270099
173400         WHEN SQLCODE = +100                                      20280099
173500         WHEN SQLCODE = -305                                      20290099
173600               MOVE ZERO     TO PV-SUM-PURITM-UNT-QTY             20300099
173700                                                                  20310099
173800         WHEN SQLWARN0 NOT EQUAL SPACE                            20320099
173900         WHEN SQLCODE NOT EQUAL ZERO                              20330099
174000             DISPLAY '** ABEND **'                                20340099
174100             DISPLAY '** PROGRAM = TRKUP005 **'                   20350099
174200             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          20360099
174300             DISPLAY '** PARA = 2225-SELECT-PURITM-UNT-QTY**'     20370099
174400             PERFORM 9100-SQL-ABEND                               20380099
174500     END-EVALUATE.                                                20390099
174600 EJECT                                                            20400099
174700******************************************************************20410099
174800 2230-SUM-PO-CARTONS-BULK.                                        20420099
174900                                                                  20430099
175000     PERFORM 8730-FETCH-PURITM-TUPC-CUR.                          20440099
175100     IF PS-EOC-PURITM-TUPC-CUR                                    20450099
175200       CONTINUE                                                   20460099
175300     ELSE                                                         20470099
175400       MOVE PURITM-OUTR-PK-QTY TO  PV-OUTR-PK-QTY                 20480099
175500       IF PV-OUTR-PK-QTY    NOT NUMERIC                           20490099
175600         OR PURITM-OUTR-PK-QTY = ZERO                             20500099
175700          CONTINUE                                                20510099
175800       ELSE                                                       20520099
175900          COMPUTE PV-CART-PER-ITEM =                              20530099
176000              (PURITM-UNT-QTY / PURITM-OUTR-PK-QTY )              20540099
176100          ADD PV-CART-PER-ITEM TO PV-CART-PER-PO                  20550099
176200          ADD PURITM-UNT-QTY   TO PV-PURITM-UNT-QTY-TOT           20560099
176300     END-IF.                                                      20570099
176400                                                                  20580099
176500******************************************************************20590099
176600 2240-PO-EDITS.                                                   20600099
176700                                                                  20610099
176800         SET PS-PO-SEL-INFO-PRESENT-NO      TO TRUE.              20620099
176900         PERFORM 2250-SELECT-TPURCHS-INFO.                        20630099
155029         PERFORM 6600-FAST-PARM-CHECK                             20640099
177000                                                                  20650099
177100         IF PS-PO-SEL-INFO-PRESENT                                20660099
177200           IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                    20670099
177300             CONTINUE                                             20680099
177400           ELSE                                                   20690099
177500               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            20700099
177600               SET TR006-ERROR-TYPE-ERROR      TO TRUE            20710099
177700               INITIALIZE TR006-UPC-NBR                           20720099
177800                          TR006-SKU                               20730099
177900                          TR006-ERROR-MSG                         20740099
178000               STRING  'PO-INVALID STATUS-NOT SENT-',             20750099
178100                       PURCHS-STATUS-CDE                          20760099
178200                   DELIMITED BY SIZE                              20770099
178300                   INTO TR006-ERROR-MSG                           20780099
178400               PERFORM 8830-WRITE-ERROR-LINE                      20790099
178500           END-IF                                                 20800099
178600         END-IF.                                                  20810099
178700                                                                  20820099
178800         IF PS-PO-SEL-INFO-PRESENT                                20830099
178900           IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-B             20840099
179000                              OR PC-C OR PC-S OR SPACE            20850099
179100             CONTINUE                                             20860099
179200           ELSE                                                   20870099
179300               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            20880099
179400               SET TR006-ERROR-TYPE-ERROR      TO TRUE            20890099
179500               INITIALIZE TR006-UPC-NBR                           20900099
179600                          TR006-SKU                               20910099
179700                          TR006-ERROR-MSG                         20920099
179800               STRING  'PO-INVALID PKG CODE-NOT SENT-',           20930099
179900                       PURCHS-PKGNG-CDE                           20940099
180000                   DELIMITED BY SIZE                              20950099
180100                   INTO TR006-ERROR-MSG                           20960099
180200               PERFORM 8830-WRITE-ERROR-LINE                      20970099
180300         END-IF.                                                  20980099
180400                                                                  20990099
180500         IF PS-PO-SEL-INFO-PRESENT                                21000099
180600           IF PURCHS-PKGNG-CDE = PC-M OR PC-I                     21010099
180700             SET PS-UNCONFIRMED-PACK-NO  TO TRUE                  21020099
180800             PERFORM 2258-CHECK-UNCONFIRMED-PACKS                 21030099
180900             IF PS-UNCONFIRMED-PACK                               21040099
181000               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            21050099
181100               SET TR006-ERROR-TYPE-ERROR      TO TRUE            21060099
181200               INITIALIZE TR006-UPC-NBR                           21070099
181300                          TR006-SKU                               21080099
181400                          TR006-ERROR-MSG                         21090099
181500               STRING  'UNCONFIRMED PACKS'                        21100099
181600                   DELIMITED BY SIZE                              21110099
181700                   INTO TR006-ERROR-MSG                           21120099
181800               PERFORM 8830-WRITE-ERROR-LINE                      21130099
181900             END-IF                                               21140099
182000           END-IF                                                 21150099
182100         END-IF.                                                  21160099
182200                                                                  21170099
182300         IF PS-PO-SEL-INFO-PRESENT                                21180099
182400                                                                  21190099
182500           SET PS-PO-HAS-UNTIED-LINES-NO   TO TRUE                21200099
182600           PERFORM 2255-SELECT-UNTIED-LINES                       21210099
182700           IF PS-PO-HAS-UNTIED-LINES                              21220099
182800               SET TR006-ERROR-TYPE-ERROR  TO TRUE                21230099
182900               INITIALIZE TR006-ERROR-MSG                         21240099
183000               MOVE POPRPK-PK-SKU-NBR      TO TR006-SKU           21250099
183100               MOVE POPRPK-PREPK-UPC-NBR   TO TR006-UPC-NBR       21260099
183200               STRING 'PCK-DTL UPCS NOT TIED TO PCK-FIX'          21270099
183300                   DELIMITED BY SIZE                              21280099
183400                   INTO TR006-ERROR-MSG                           21290099
183500               PERFORM 8830-WRITE-ERROR-LINE                      21300099
183600           ELSE                                                   21310099
183700               SET PS-PO-PASSED-EDITS       TO TRUE               21320099
183800               SET PS-PREV-SENT-AS-CMN-NO   TO TRUE               21330099
183900               PERFORM 2320-CHECK-IF-SENT-AS-CMN                  21340099
184000           END-IF                                                 21350099
184100                                                                  21360099
184200         END-IF.                                                  21370099
184300                                                                  21380099
184400******************************************************************21390099
184500 2250-SELECT-TPURCHS-INFO.                                        21400099
184600*                                                                 21410099
184700     EXEC SQL                                                     21420099
184800           SELECT DISTINCT                                        21430099
184900                  PO.STATUS_CDE                                   21440099
185000                , PO.PO_NBR                                       21450099
185100                , PO.OTB_PER_NBR                                  21460099
185200                , PO.NEW_STR_PO_IND                               21470099
185300                , PO.PKGNG_CDE                                    21480099
185400                , PO.DEPT_NBR                                     21490099
185500                , PO_TYP_CDE                                      21500099
185600                , RL.DCONSLR_RLSE_CDE                             21510099
185700                , RL.DCONSLR_ACTL_DTE                             21520099
185800             INTO                                                 21530099
185900                  :PURCHS-STATUS-CDE                              21540099
186000                , :PURCHS-PO-NBR                                  21550099
186100                , :PURCHS-OTB-PER-NBR                             21560099
186200                , :PURCHS-NEW-STR-PO-IND                          21570099
186300                , :PURCHS-PKGNG-CDE                               21580099
186400                , :PURCHS-DEPT-NBR                                21590099
186500                , :PURCHS-PO-TYP-CDE                              21600099
186600                , :IMPORL-DCONSLR-RLSE-CDE                        21610099
186700                , :IMPORL-DCONSLR-ACTL-DTE                        21620099
186800             FROM                                                 21630099
186900                  TPURCHS   PO                                    21640099
187000                , TSHPTPO   SP                                    21650099
187100                , TIMPORL   RL                                    21660099
187200             WHERE PO.PO_NBR     =  :SHPTPO-PO-NBR                21670099
187300               AND SP.PO_NBR     =  PO.PO_NBR                     21680099
187400               AND PO.PO_NBR     =  RL.PO_NBR                     21690099
187500               AND PO.VER_STATUS_CDE = 'A'                        21700099
187600               AND RL.VER_STATUS_CDE = 'A'                        21710099
187700     END-EXEC                                                     21720099
187800                                                                  21730099
187900     EVALUATE TRUE                                                21740099
188000         WHEN SQLCODE = ZERO                                      21750099
188100             SET PS-PO-SEL-INFO-PRESENT TO TRUE                   21760099
188200             INITIALIZE TR006-DEPT-NBR                            21770099
188300                        PV-TR006-DEPT-NBR                         21780099
188400             MOVE PURCHS-DEPT-NBR   TO PV-TR006-DEPT-NBR-3        21790099
188500             MOVE PV-TR006-DEPT-NBR TO TR006-DEPT-NBR             21800099
188600             MOVE PURCHS-PKGNG-CDE  TO TR006-PKGNG-CDE            21810099
188700                                                                  21820099
188800         WHEN SQLCODE = +100                                      21830099
188900             INITIALIZE TR006-DEPT-NBR                            21840099
189000                        TR006-UPC-NBR                             21850099
189100                        TR006-SKU                                 21860099
189200                        TR006-PKGNG-CDE                           21870099
189300                        TR006-ERROR-MSG                           21880099
189400             SET TR006-ERROR-TYPE-ERROR      TO TRUE              21890099
189500             STRING 'DCONSLR/PO INFO MISSING-NOT SENT'            21900099
189600                 DELIMITED BY SIZE                                21910099
189700                 INTO TR006-ERROR-MSG                             21920099
189800             PERFORM 8830-WRITE-ERROR-LINE                        21930099
189900                                                                  21940099
190000         WHEN SQLWARN0 NOT EQUAL SPACE                            21950099
190100         WHEN SQLCODE NOT EQUAL ZERO                              21960099
190200             DISPLAY '** ABEND **'                                21970099
190300             DISPLAY '** PROGRAM = TRKUP005 **'                   21980099
190400             DISPLAY '** PARAGRAPH = 2250-SELECT-TPURCHS-INFO***' 21990099
190500             DISPLAY 'SHPTPO-PO-NBR = ' SHPTPO-PO-NBR             22000099
190600             PERFORM 9100-SQL-ABEND                               22010099
190700     END-EVALUATE.                                                22020099
190800                                                                  22030099
190900******************************************************************22040099
191000 2255-SELECT-UNTIED-LINES.                                        22050099
191100                                                                  22060099
191200     EXEC SQL                                                     22070099
191300         SELECT A.PO_NBR                                          22080099
191400           INTO :PURITM-PO-NBR                                    22090099
191500           FROM TPURITM  A                                        22100099
191600               ,TPURCHS  B                                        22110099
191700          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 22120099
191800            AND A.VER_STATUS_CDE = :PC-A                          22130099
191900            AND A.STATUS_CDE    IN ('AC', 'AP')                   22140099
192000            AND A.PO_PREPK_ID    =  0                             22150099
192100            AND B.PO_NBR         =  A.PO_NBR                      22160099
192200            AND B.VER_STATUS_CDE = :PC-A                          22170099
192300            AND B.PKGNG_CDE     IN ('M','I')                      22180099
192400     END-EXEC                                                     22190099
192500                                                                  22200099
192600     EVALUATE TRUE                                                22210099
192700         WHEN SQLCODE = ZERO                                      22220099
192800         WHEN SQLCODE = -811                                      22230099
192900             SET PS-PO-HAS-UNTIED-LINES TO TRUE                   22240099
193000                                                                  22250099
193100         WHEN SQLCODE = +100                                      22260099
193200             CONTINUE                                             22270099
193300                                                                  22280099
193400         WHEN SQLWARN0 NOT EQUAL SPACE                            22290099
193500         WHEN SQLCODE NOT EQUAL ZERO                              22300099
193600             DISPLAY '**************************************'     22310099
193700             DISPLAY '** ABEND                            **'     22320099
193800             DISPLAY '** PROGRAM = TRKUP005               **'     22330099
193900             DISPLAY '** PARAGRAPH = 2255-SELECT-UNTIED-LINES'    22340099
194000             DISPLAY '** SELECT TPURITM                   **'     22350099
194100             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              22360099
194200             DISPLAY '**************************************'     22370099
194300             PERFORM 9100-SQL-ABEND                               22380099
194400     END-EVALUATE.                                                22390099
194500                                                                  22400099
194600******************************************************************22410099
194700 2258-CHECK-UNCONFIRMED-PACKS.                                    22420099
194800                                                                  22430099
194900     INITIALIZE  PV-DB2-COUNT.                                    22440099
195000                                                                  22450099
195100     EXEC SQL                                                     22460099
195200          SELECT COUNT (*)                                        22470099
195300            INTO :PV-DB2-COUNT                                    22480099
195400            FROM TPURITM A                                        22490099
195500           WHERE A.PO_NBR          = :PURCHS-PO-NBR               22500099
195600             AND A.VER_STATUS_CDE  = 'A'                          22510099
195700             AND A.STATUS_CDE   = 'RV'                            22520099
195800     END-EXEC                                                     22530099
195900                                                                  22540099
196000                                                                  22550099
196100     EVALUATE TRUE                                                22560099
196200         WHEN SQLCODE = ZERO                                      22570099
196300         WHEN SQLCODE = -811                                      22580099
196400           IF PV-DB2-COUNT = ZERO                                 22590099
196500             CONTINUE                                             22600099
196600           ELSE                                                   22610099
196700             SET PS-UNCONFIRMED-PACK TO TRUE                      22620099
196800           END-IF                                                 22630099
196900                                                                  22640099
197000         WHEN SQLCODE = +100                                      22650099
197100             CONTINUE                                             22660099
197200                                                                  22670099
197300         WHEN SQLWARN0 NOT EQUAL SPACE                            22680099
197400         WHEN SQLCODE NOT EQUAL ZERO                              22690099
197500             DISPLAY '**************************************'     22700099
197600             DISPLAY '** ABEND                            **'     22710099
197700             DISPLAY '** PROGRAM = TRKUP005               **'     22720099
197800             DISPLAY '** PARAGRAPH = 2258-CHECK-UNCONFIRMED-PACKS'22730099
197900             DISPLAY '** SELECT TPURITM                   **'     22740099
198000             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              22750099
198100             DISPLAY '**************************************'     22760099
198200             PERFORM 9100-SQL-ABEND                               22770099
198300     END-EVALUATE.                                                22780099
198400                                                                  22790099
198500******************************************************************22800099
198600 2260-SELECT-PLNSHP-DATES.                                        22810099
198700*                                                                 22820099
198800     EXEC SQL                                                     22830099
198900           SELECT DISTINCT                                        22840099
199000                  PL.DONT_SHIP_BEF_DTE                            22850099
199100                , PL.CAN_IFNOT_SHIP_DTE                           22860099
199200                , PL.EXT_CAN_DTE                                  22870099
199300             INTO                                                 22880099
199400                  :PLNSHP-DONT-SHIP-BEF-DTE                       22890099
199500                , :PLNSHP-CAN-IFNOT-SHIP-DTE                      22900099
199600                , :PLNSHP-EXT-CAN-DTE                             22910099
199700             FROM                                                 22920099
199800                  TPLNSHP   PL                                    22930099
199900                , TSHPTPO   SP                                    22940099
200000             WHERE PL.PO_NBR     =  :SHPTPO-PO-NBR                22950099
200100               AND SP.PO_NBR     =  PL.PO_NBR                     22960099
200200               AND PL.VER_STATUS_CDE = 'A'                        22970099
200300     END-EXEC                                                     22980099
200400                                                                  22990099
200500     EVALUATE TRUE                                                23000099
200600         WHEN SQLCODE = ZERO                                      23010099
200700             MOVE PLNSHP-DONT-SHIP-BEF-DTE (1:4) TO               23020099
200800                 TR004-DO-NOT-SHIP-BEF-DTE (1:4)                  23030099
200900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               23040099
201000                 TR004-DO-NOT-SHIP-BEF-DTE (5:2)                  23050099
201100             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               23060099
201200                 TR004-DO-NOT-SHIP-BEF-DTE (7:2)                  23070099
201300                                                                  23080099
201400             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               23090099
201500             MOVE PLNSHP-DONT-SHIP-BEF-DTE (3:2) TO               23100099
201600                 TR006-DONT-SHIP-BEFORE-DATE (5:2)                23110099
201700             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               23120099
201800                 TR006-DONT-SHIP-BEFORE-DATE (1:2)                23130099
201900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               23140099
202000                 TR006-DONT-SHIP-BEFORE-DATE (3:2)                23150099
202100                                                                  23160099
202200             IF PLNSHP-EXT-CAN-DTE = '0001-01-01'                 23170099
202300                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(1:4) TO           23180099
202400                     TR004-CANCEL-DATE (1:4)                      23190099
202500                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(6:2) TO           23200099
202600                     TR004-CANCEL-DATE (5:2)                      23210099
202700                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(9:2) TO           23220099
202800                     TR004-CANCEL-DATE (7:2)                      23230099
202900              ELSE                                                23240099
203000                 MOVE PLNSHP-EXT-CAN-DTE(1:4) TO                  23250099
203100                     TR004-CANCEL-DATE (1:4)                      23260099
203200                 MOVE PLNSHP-EXT-CAN-DTE(6:2) TO                  23270099
203300                     TR004-CANCEL-DATE (5:2)                      23280099
203400                 MOVE PLNSHP-EXT-CAN-DTE(9:2) TO                  23290099
203500                     TR004-CANCEL-DATE (7:2)                      23300099
203600              END-IF                                              23310099
203700                                                                  23320099
203800         WHEN SQLCODE = +100                                      23330099
203900             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               23340099
204000                        TR004-CANCEL-DATE                         23350099
204100                        TR004-DO-NOT-SHIP-BEF-DTE                 23360099
204200                                                                  23370099
204300                                                                  23380099
204400         WHEN SQLWARN0 NOT EQUAL SPACE                            23390099
204500         WHEN SQLCODE NOT EQUAL ZERO                              23400099
204600             DISPLAY '** ABEND **'                                23410099
204700             DISPLAY '** PROGRAM = TRKUP005 **'                   23420099
204800             DISPLAY '** PARAGRAPH = 2260-SELECT-PLNSHP-DATES**'  23430099
204900             PERFORM 9100-SQL-ABEND                               23440099
205000     END-EVALUATE.                                                23450099
205100                                                                  23460099
205200******************************************************************23470099
205300 2270-UPDATE-TSHPTPO.                                             23480099
205400                                                                  23490099
205500         EXEC SQL                                                 23500099
205600             UPDATE TSHPTPO                                       23510099
205700                SET SPLT_XMIT_IND    = :SHPTPO-SPLT-XMIT-IND      23520099
205800                 ,  SPLT_XMIT_DTE    = (CURRENT DATE)             23530099
205900                 ,  SPLT_XMIT_TM     = (CURRENT TIME)             23540099
206000                 ,  LAST_UPD_DTE     = (CURRENT DATE)             23550099
206100                 ,  LAST_UPD_TIME    = (CURRENT TIME)             23560099
206200                 ,  LAST_UPD_USER_ID = :PC-CURRENT-PROGRAM-NAME   23570099
206300                 ,  LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME   23580099
206400              WHERE SHIPT_ID         = :SHIPMT-SHIPT-ID           23590099
206500                AND PO_NBR           = :SHPTPO-PO-NBR             23600099
206600         END-EXEC                                                 23610099
206700                                                                  23620099
206800     EVALUATE TRUE                                                23630099
206900         WHEN SQLCODE = ZERO                                      23640099
207000             PERFORM 4000-CREATE-SHPTPO-AUDIT-TRAIL               23650099
207100                                                                  23660099
207200         WHEN SQLCODE = +100                                      23670099
207300             CONTINUE                                             23680099
207400                                                                  23690099
207500         WHEN SQLWARN0 NOT EQUAL SPACE                            23700099
207600         WHEN SQLCODE NOT EQUAL ZERO                              23710099
207700             DISPLAY '** ABEND **'                                23720099
207800             DISPLAY '** PROGRAM = TRKUP005 **'                   23730099
207900             DISPLAY '** PARAGRAPH = 2270-UPDATE-TSHPTPO**'       23740099
208000             PERFORM 9100-SQL-ABEND                               23750099
208100     END-EVALUATE.                                                23760099
208200                                                                  23770099
208300******************************************************************23780099
208400 2275-SELECT-TIMPORL.                                             23790099
208500                                                                  23800099
208600         EXEC SQL                                                 23810099
208700             SELECT PO_NBR                                        23820099
208800                  , VER_NBR                                       23830099
208900                  , VER_STATUS_CDE                                23840099
209000                  , CONSLR_RLSE_CDE                               23850099
209100                  , CONSLR_REQR_DTE                               23860099
209200                  , CONSLR_ACTL_DTE                               23870099
209300                  , CONSLR_ACTL_TM                                23880099
209400                  , CSTM_BKR_RLSE_CDE                             23890099
209500                  , CSTM_BKR_REQR_DTE                             23900099
209600                  , CSTM_BKR_ACTL_DTE                             23910099
209700                  , CSTM_BKR_ACTL_TM                              23920099
209800                  , TKT_PRTR_RLSE_CDE                             23930099
209900                  , TKT_PRTR_REQR_DTE                             23940099
210000                  , TKT_PRTR_ACTL_DTE                             23950099
210100                  , TKT_PRTR_ACTL_TM                              23960099
210200                  , DCONSLR_RLSE_CDE                              23970099
210300                  , DCONSLR_REQR_DTE                              23980099
210400                  , DCONSLR_ACTL_DTE                              23990099
210500                  , DCONSLR_ACTL_TM                               24000099
210600                  , LAST_UPD_TMST                                 24010099
210700                  , LAST_UPD_BY_UID                               24020099
210800                  , DCONSLR_ENT_ID                                24030099
210900             INTO  :IMPORL-PO-NBR                                 24040099
211000                  ,:IMPORL-VER-NBR                                24050099
211100                  ,:IMPORL-VER-STATUS-CDE                         24060099
211200                  ,:IMPORL-CONSLR-RLSE-CDE                        24070099
211300                  ,:IMPORL-CONSLR-REQR-DTE                        24080099
211400                  ,:IMPORL-CONSLR-ACTL-DTE                        24090099
211500                  ,:IMPORL-CONSLR-ACTL-TM                         24100099
211600                  ,:IMPORL-CSTM-BKR-RLSE-CDE                      24110099
211700                  ,:IMPORL-CSTM-BKR-REQR-DTE                      24120099
211800                  ,:IMPORL-CSTM-BKR-ACTL-DTE                      24130099
211900                  ,:IMPORL-CSTM-BKR-ACTL-TM                       24140099
212000                  ,:IMPORL-TKT-PRTR-RLSE-CDE                      24150099
212100                  ,:IMPORL-TKT-PRTR-REQR-DTE                      24160099
212200                  ,:IMPORL-TKT-PRTR-ACTL-DTE                      24170099
212300                  ,:IMPORL-TKT-PRTR-ACTL-TM                       24180099
212400                  ,:IMPORL-DCONSLR-RLSE-CDE                       24190099
212500                  ,:IMPORL-DCONSLR-REQR-DTE                       24200099
212600                  ,:IMPORL-DCONSLR-ACTL-DTE                       24210099
212700                  ,:IMPORL-DCONSLR-ACTL-TM                        24220099
212800                  ,:IMPORL-LAST-UPD-TMST                          24230099
212900                  ,:IMPORL-LAST-UPD-BY-UID                        24240099
213000                  ,:IMPORL-DCONSLR-ENT-ID                         24250099
213100             FROM  TIMPORL                                        24260099
213200             WHERE PO_NBR          = :SHPTPO-PO-NBR               24270099
213300                AND VER_STATUS_CDE  = :PC-A                       24280099
213400         END-EXEC                                                 24290099
213500                                                                  24300099
213600     EVALUATE TRUE                                                24310099
213700         WHEN SQLCODE = ZERO                                      24320099
213800             CONTINUE                                             24330099
213900                                                                  24340099
214000         WHEN SQLCODE = +100                                      24350099
214100             CONTINUE                                             24360099
214200                                                                  24370099
214300         WHEN SQLWARN0 NOT EQUAL SPACE                            24380099
214400         WHEN SQLCODE NOT EQUAL ZERO                              24390099
214500             DISPLAY '** ABEND **'                                24400099
214600             DISPLAY '** PROGRAM = TRKUP005 **'                   24410099
214700             DISPLAY '** PARAGRAPH = 2275-SELECT-TIMPORL**'       24420099
214800             DISPLAY '** PO-NBR = ' SHPTPO-PO-NBR                 24430099
214900             PERFORM 9100-SQL-ABEND                               24440099
215000     END-EVALUATE.                                                24450099
215100                                                                  24460099
215200******************************************************************24470099
215300 2280-INACTIVATE-TIMPORL.                                         24480099
215400                                                                  24490099
215500         EXEC SQL                                                 24500099
215600             UPDATE TIMPORL                                       24510099
215700                SET VER_STATUS_CDE     = :PC-I                    24520099
215800             WHERE PO_NBR          = :SHPTPO-PO-NBR               24530099
215900                AND VER_STATUS_CDE  = :PC-A                       24540099
216000         END-EXEC                                                 24550099
216100                                                                  24560099
216200     EVALUATE TRUE                                                24570099
216300         WHEN SQLCODE = ZERO                                      24580099
216400             CONTINUE                                             24590099
216500                                                                  24600099
216600         WHEN SQLWARN0 NOT EQUAL SPACE                            24610099
216700         WHEN SQLCODE NOT EQUAL ZERO                              24620099
216800             DISPLAY '** ABEND **'                                24630099
216900             DISPLAY '** PROGRAM = TRKUP005 **'                   24640099
217000             DISPLAY '** PARAGRAPH = 2280-INACTIVATE-TIMPORL**'   24650099
217100             DISPLAY '** PO-NBR = ' SHPTPO-PO-NBR                 24660099
217200             PERFORM 9100-SQL-ABEND                               24670099
217300     END-EVALUATE.                                                24680099
217400                                                                  24690099
217500******************************************************************24700099
217600 2285-INSERT-TIMPORL.                                             24710099
217700                                                                  24720099
217800         EXEC SQL                                                 24730099
217900             INSERT INTO TIMPORL                                  24740099
218000                   (PO_NBR                                        24750099
218100                  , VER_NBR                                       24760099
218200                  , VER_STATUS_CDE                                24770099
218300                  , CONSLR_RLSE_CDE                               24780099
218400                  , CONSLR_REQR_DTE                               24790099
218500                  , CONSLR_ACTL_DTE                               24800099
218600                  , CONSLR_ACTL_TM                                24810099
218700                  , CSTM_BKR_RLSE_CDE                             24820099
218800                  , CSTM_BKR_REQR_DTE                             24830099
218900                  , CSTM_BKR_ACTL_DTE                             24840099
219000                  , CSTM_BKR_ACTL_TM                              24850099
219100                  , TKT_PRTR_RLSE_CDE                             24860099
219200                  , TKT_PRTR_REQR_DTE                             24870099
219300                  , TKT_PRTR_ACTL_DTE                             24880099
219400                  , TKT_PRTR_ACTL_TM                              24890099
219500                  , DCONSLR_RLSE_CDE                              24900099
219600                  , DCONSLR_REQR_DTE                              24910099
219700                  , DCONSLR_ACTL_DTE                              24920099
219800                  , DCONSLR_ACTL_TM                               24930099
219900                  , LAST_UPD_TMST                                 24940099
220000                  , LAST_UPD_BY_UID                               24950099
220100                  , DCONSLR_ENT_ID)                               24960099
220200            VALUES (:IMPORL-PO-NBR                                24970099
220300                  , :IMPORL-VER-NBR                               24980099
220400                  , :IMPORL-VER-STATUS-CDE                        24990099
220500                  , :IMPORL-CONSLR-RLSE-CDE                       25000099
220600                  , :IMPORL-CONSLR-REQR-DTE                       25010099
220700                  , :IMPORL-CONSLR-ACTL-DTE                       25020099
220800                  , :IMPORL-CONSLR-ACTL-TM                        25030099
220900                  , :IMPORL-CSTM-BKR-RLSE-CDE                     25040099
221000                  , :IMPORL-CSTM-BKR-REQR-DTE                     25050099
221100                  , :IMPORL-CSTM-BKR-ACTL-DTE                     25060099
221200                  , :IMPORL-CSTM-BKR-ACTL-TM                      25070099
221300                  , :IMPORL-TKT-PRTR-RLSE-CDE                     25080099
221400                  , :IMPORL-TKT-PRTR-REQR-DTE                     25090099
221500                  , :IMPORL-TKT-PRTR-ACTL-DTE                     25100099
221600                  , :IMPORL-TKT-PRTR-ACTL-TM                      25110099
221700                  , :IMPORL-DCONSLR-RLSE-CDE                      25120099
221800                  , :IMPORL-DCONSLR-REQR-DTE                      25130099
221900                  ,  CURRENT DATE                                 25140099
222000                  ,  CURRENT TIME                                 25150099
222100                  ,  CURRENT TIMESTAMP                            25160099
222200                  , :PC-CURRENT-PROGRAM-NAME                      25170099
222300                  , :IMPORL-DCONSLR-ENT-ID)                       25180099
222400         END-EXEC                                                 25190099
222500                                                                  25200099
222600     EVALUATE TRUE                                                25210099
222700         WHEN SQLCODE = ZERO                                      25220099
222800             CONTINUE                                             25230099
222900                                                                  25240099
223000         WHEN SQLWARN0 NOT EQUAL SPACE                            25250099
223100         WHEN SQLCODE NOT EQUAL ZERO                              25260099
223200             DISPLAY '** ABEND **'                                25270099
223300             DISPLAY '** PROGRAM = TRKUP005 **'                   25280099
223400             DISPLAY '** PARAGRAPH = 2285-INSERT-TIMPORL**'       25290099
223500             DISPLAY '** PO-NBR = ' SHPTPO-PO-NBR                 25300099
223600             PERFORM 9100-SQL-ABEND                               25310099
223700     END-EVALUATE.                                                25320099
223800                                                                  25330099
223900******************************************************************25340099
224000 2290-UPDATE-TVHTRIP.                                             25350099
224100                                                                  25360099
224200         EXEC SQL                                                 25370099
224300             UPDATE TVHTRIP                                       25380099
224400                SET SPLT_XMIT_IND  = 'T'                          25390099
224500                 ,  SPLT_XMIT_DTE  = (CURRENT DATE)               25400099
224600                 ,  SPLT_XMIT_TM   = (CURRENT TIME)               25410099
224700                 ,  LAST_UPD_DTE   = (CURRENT DATE)               25420099
224800                 ,  LAST_UPD_TME   = (CURRENT TIME)               25430099
224900                 ,  LAST_UPD_UID   = :PC-CURRENT-PROGRAM-NAME     25440099
225000              WHERE TRIP_ID        = :PV-HOLD-VHTRIP-TRIP-ID      25450099
225100         END-EXEC                                                 25460099
225200                                                                  25470099
225300     EVALUATE TRUE                                                25480099
225400         WHEN SQLCODE = ZERO                                      25490099
225500             PERFORM 4100-CREATE-VHTRIP-AUDIT-TRAIL               25500099
225600                                                                  25510099
225700         WHEN SQLCODE = +100                                      25520099
225800             CONTINUE                                             25530099
225900                                                                  25540099
226000         WHEN SQLWARN0 NOT EQUAL SPACE                            25550099
226100         WHEN SQLCODE NOT EQUAL ZERO                              25560099
226200             DISPLAY '** ABEND **'                                25570099
226300             DISPLAY '** PROGRAM = TRKUP005 **'                   25580099
226400             DISPLAY '** PARAGRAPH = 2290-UPDATE-TVHTRIP**'       25590099
226500             PERFORM 9100-SQL-ABEND                               25600099
226600     END-EVALUATE.                                                25610099
226700                                                                  25620099
226800******************************************************************25630099
226900 2300-PROCESS-INSTRUCTION-LINES.                                  25640099
227000                                                                  25650099
227100     PERFORM 7900-OPEN-INSTR-CURSOR.                              25660099
227200                                                                  25670099
227300     PERFORM 8100-FETCH-INSTR-CURSOR.                             25680099
227400                                                                  25690099
227500     IF PS-EOC-INSTR-CURSOR                                       25700099
227600         PERFORM 8000-CLOSE-INSTR-CURSOR                          25710099
227700     ELSE                                                         25720099
227800         PERFORM 2310-FINISH-INSTRUCTION-LINES                    25730099
227900         PERFORM 8000-CLOSE-INSTR-CURSOR                          25740099
228000     END-IF.                                                      25750099
228100                                                                  25760099
228200     SET PS-EOC-INSTR-CURSOR-NO TO TRUE.                          25770099
228300                                                                  25780099
228400******************************************************************25790099
228500 2310-FINISH-INSTRUCTION-LINES.                                   25800099
228600                                                                  25810099
228700     INITIALIZE TR004-REC-TYPE-INS.                               25820099
228800     MOVE INSTCD-INSTR-DESC TO TR004-SPEC-INSTR.                  25830099
228900     PERFORM 5500-WRITE-INS-REC.                                  25840099
229000                                                                  25850099
229100******************************************************************25860099
229200* A ROW ON EITHER THE TIMCNRL OR ITS AUDIT TABLE MATCHING THE    *25870099
229300* CRITERIAL IN WHERE CLAUSE INDICATES PO WAS ALREADY SENT AS CMN.*25880099
229400******************************************************************25890099
229500 2320-CHECK-IF-SENT-AS-CMN.                                       25900099
229600                                                                  25910099
229700     EXEC SQL                                                     25920099
229800         SELECT DISTINCT                                          25930099
229900           COALESCE(IMCNRL.PO_NBR,                                25940099
230000                    AUCNRL.PO_NBR)   AS CNRL_PO                   25950099
230100           INTO :IMCNRL-PO-NBR                                    25960099
230200         FROM                                                     25970099
230300                                                                  25980099
230400            (SELECT DISTINCT                                      25990099
230500                 RL.PO_NBR                                        26000099
230600             FROM                                                 26010099
230700                 TIMCNRL   RL                                     26020099
230800             WHERE  RL.PO_NBR   = :PURCHS-PO-NBR                  26030099
230900               AND (DCONSLR_RLSE_CDE  IN ('S', 'R', 'Y') OR       26040099
231000                    (DCONSLR_RLSE_CDE = 'D' AND                   26050099
231100                     DCONSLR_ACTL_DTE <> :PC-NULL-DTE)))          26060099
231200             AS IMCNRL                                            26070099
231300                                                                  26080099
231400         FULL JOIN                                                26090099
231500                                                                  26100099
231600            (SELECT DISTINCT                                      26110099
231700                 RL.PO_NBR                                        26120099
231800             FROM                                                 26130099
231900                 TAUCNRL   RL                                     26140099
232000             WHERE  RL.PO_NBR   = :PURCHS-PO-NBR                  26150099
232100               AND (DCONSLR_RLSE_CDE  IN ('S', 'R', 'Y') OR       26160099
232200                    (DCONSLR_RLSE_CDE = 'D' AND                   26170099
232300                     DCONSLR_ACTL_DTE <> :PC-NULL-DTE)))          26180099
232400             AS AUCNRL                                            26190099
232500                                                                  26200099
232600         ON IMCNRL.PO_NBR  =  AUCNRL.PO_NBR                       26210099
232700                                                                  26220099
232800     END-EXEC.                                                    26230099
232900                                                                  26240099
233000                                                                  26250099
233100                                                                  26260099
233200     EVALUATE TRUE                                                26270099
233300         WHEN SQLCODE = ZERO                                      26280099
233400         WHEN SQLCODE = -811                                      26290099
233500             SET PS-PREV-SENT-AS-CMN        TO TRUE               26300099
233600             SET TR006-ERROR-TYPE-ERROR     TO TRUE               26310099
233700             INITIALIZE  TR006-ERROR-MSG                          26320099
233800             STRING 'ALREADY SNT CMN-OVERRODE'                    26330099
233900                 DELIMITED BY SIZE                                26340099
234000                 INTO TR006-ERROR-MSG                             26350099
234100             PERFORM 8830-WRITE-ERROR-LINE                        26360099
234200                                                                  26370099
234300                                                                  26380099
234400         WHEN SQLCODE = +100                                      26390099
234500             CONTINUE                                             26400099
234600                                                                  26410099
234700         WHEN SQLWARN0 NOT EQUAL SPACE                            26420099
234800         WHEN SQLCODE NOT EQUAL ZERO                              26430099
234900             DISPLAY '** ABEND **'                                26440099
235000             DISPLAY '** PROGRAM = TRKUP005 **'                   26450099
235100             DISPLAY '** PARAGRAPH = 2320-CHECK-IF-SENT-AS-CMN'   26460099
235200             DISPLAY '** PO NBR = ' PURCHS-PO-NBR                 26470099
235300             PERFORM 9100-SQL-ABEND                               26480099
235400     END-EVALUATE.                                                26490099
235500                                                                  26500099
235600******************************************************************26510099
235700 2350-PROCESS-PACKS-IDS.                                          26520099
235800                                                                  26530099
235900     PERFORM 8745-FETCH-POPRPK-FOR-PCK-CUR.                       26540099
236000                                                                  26550099
236100     IF PS-EOC-PACK-CURSOR                                        26560099
236200       PERFORM 8740-CLOSE-POPRPK-FOR-PCK-CUR                      26570099
236300       INITIALIZE TR006-UPC-NBR                                   26580099
236400                  TR006-PACK-ID                                   26590099
236500                  TR006-SKU                                       26600099
236600     ELSE                                                         26610099
236700       MOVE POPRPK-PO-PREPK-ID   TO TR006-PACK-ID                 26620099
236800       MOVE POPRPK-PK-SKU-NBR    TO TR006-SKU                     26630099
236900       MOVE POPRPK-PREPK-UPC-NBR TO TR006-UPC-NBR                 26640099
237000       PERFORM 8470-OPEN-E-COM-PACK-UPC-CUR                       26650099
237100       SET PS-EOC-E-COM-PACK-UPC-CUR-NO TO TRUE                   26660099
237200       SET PS-PASSED-E-COM-CHECK-NO     TO TRUE                   26670099
237300       PERFORM 2352-CHECK-PACK-FOR-E-COM                          26680099
237400            UNTIL PS-EOC-E-COM-PACK-UPC-CUR                       26690099
237500       PERFORM 8474-CLOSE-E-COM-PACK-UPC-CUR                      26700099
237600                                                                  26710099
237700       IF PS-PASSED-E-COM-CHECK                                   26720099
237800         INITIALIZE TR004-REC-TYPE-PCK                            26730099
237900         MOVE POPRPK-PO-PREPK-ID    TO                            26740099
238000                   TR004-PACK-ID                                  26750099
238100*        **********************************************           26760099
238200*        *             PROCESS PREPACKS               *           26770099
238300*        **********************************************           26780099
238400*        * THE NEXT 3 PERFORMS ARE SELECT DISTINCTS   *           26790099
238500*        * ON THE SAME TABLE WITH SAME WHERE CLAUSES. *           26800099
238600*        * THEY MUST BE KEPT SEPARATE SO THAT WE KNOW *           26810099
238700*        * WHETHER WE HAVE MULTI ROWS (-811) DUE TO   *           26820099
238800*        * STYLE, COLOR OR SIZE.  UNITS MUST BE DONE  *           26830099
238900*        * SEPARATELY BECAUSE -811 ISN'T CHECKED.     *           26840099
239000*        **********************************************           26850099
239100         PERFORM 2360-SELECT-VENDOR-STYLE-PCK                     26860099
239200         PERFORM 2361-SELECT-COLOR-PCK                            26870099
239300         PERFORM 2362-SELECT-SIZE-PCK                             26880099
239400*        *********** END PROCESS PREPACKS *************           26890099
239500         MOVE POPRPK-PREPK-DESC TO TR004-PACK-DESC                26900099
239600         PERFORM 2364-CARTON-COUNTS-PCK                           26910099
239700**BUD ** IF PURCHS-PKGNG-CDE = PC-M                               26920099
239700         IF POPRPK-PREPK-TYP-CDE = PC-M                           26930099
239800            MOVE 1    TO TR004-PACKS-PER-CART                     26940099
239900         ELSE                                                     26950099
240000            IF POPRPK-INPK-UNT-QTY = ZERO                         26960099
240100              MOVE ZERO TO TR004-PACKS-PER-CART                   26970099
240200*             *************************************************   26980099
240300*             * A MESSAGE GETS PRINTED FOR ZERO INPK-UNIT-QTY *   26990099
240400*             * IN PARAGRAPGH 2364-CARTON-COUNTS-PCK SO DON'T *   27000099
240500*             * NEED ONE HERE.                                *   27010099
240600*             *************************************************   27020099
240700            ELSE                                                  27030099
240800              COMPUTE TR004-PACKS-PER-CART =                      27040099
240900                   (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY)    27050099
241000            END-IF                                                27060099
241100         END-IF                                                   27070099
241200                                                                  27080099
241300         IF POPRPK-PK-SKU-NBR IS ZERO                             27090099
241400            SET TR006-ERROR-TYPE-ERROR  TO TRUE                   27100099
241500            SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                 27110099
241600            INITIALIZE TR006-ERROR-MSG                            27120099
241700            MOVE POPRPK-PK-SKU-NBR      TO TR006-SKU              27130099
241800            MOVE POPRPK-PREPK-UPC-NBR   TO TR006-UPC-NBR          27140099
241900            STRING 'NO PCK SKU FOR PACK PO-NOT SENT'              27150099
242000                DELIMITED BY SIZE                                 27160099
242100                INTO TR006-ERROR-MSG                              27170099
242200            PERFORM 8830-WRITE-ERROR-LINE                         27180099
242300         END-IF                                                   27190099
242400                                                                  27200099
242500         IF POPRPK-PREPK-UPC-NBR IS ZERO                          27210099
242600            SET TR006-ERROR-TYPE-ERROR    TO TRUE                 27220099
242700            SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                 27230099
242800            INITIALIZE TR006-ERROR-MSG                            27240099
242900            MOVE POPRPK-PK-SKU-NBR        TO TR006-SKU            27250099
243000            MOVE POPRPK-PREPK-UPC-NBR     TO TR006-UPC-NBR        27260099
243100            STRING 'NO PCK UPC FOR PACK PO-NOT SENT'              27270099
243200                DELIMITED BY SIZE                                 27280099
243300                INTO TR006-ERROR-MSG                              27290099
243400            PERFORM 8830-WRITE-ERROR-LINE                         27300099
243500         END-IF                                                   27310099
243600                                                                  27320099
243700         MOVE POPRPK-PREPK-UPC-NBR TO TR004-PACK-UPC-NBR          27330099
243800         MOVE POPRPK-PK-SKU-NBR    TO TR004-PACK-SKU              27340099
243900                                                                  27350099
244000         PERFORM 5755-WRITE-PCK-REC                               27360099
244100                                                                  27370099
244200         SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE                 27380099
244300         PERFORM 2380-SELECT-PACK-SUM                             27390099
244400                                                                  27400099
244500         IF PS-SELECT-PACK-SUM-OK                                 27410099
244600           SET PS-COUNT-DCS-OK-NO         TO TRUE                 27420099
244700           PERFORM 2384-COUNT-DCS-FOR-PACK                        27430099
244800         END-IF                                                   27440099
244900                                                                  27450099
245000         IF PS-SELECT-PACK-SUM-OK                                 27460099
245100          AND PS-COUNT-DCS-OK                                     27470099
245200            PERFORM 8420-OPEN-PACK-DC-CURSOR                      27480099
245300            SET PS-FIRST-DC                 TO TRUE               27490099
245400            SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE               27500099
139868            SET PS-OUTLET-STORE-NO          TO TRUE               27510099
245500            PERFORM 2370-PROCESS-PREPACK-DC UNTIL                 27520099
245600                    PS-EOC-PREPACK-DC-CURSOR                      27530099
245700            SET PS-EOC-PREPACK-DC-CURSOR-NO TO TRUE               27540099
245800         END-IF                                                   27550099
245900                                                                  27560099
246000         PERFORM 8450-OPEN-PACK-UPC-CUR                           27570099
246100         SET PS-LINES-ON-TPURITM-NO       TO TRUE                 27580099
246200         PERFORM 2402-PROCESS-PACK-UPC UNTIL                      27590099
246300                  PS-EOC-PACK-UPC-CURSOR                          27600099
246400         SET PS-EOC-PACK-UPC-CURSOR-NO TO TRUE                    27610099
246500                                                                  27620099
246600       END-IF                                                     27630099
246700                                                                  27640099
246800     END-IF.                                                      27650099
246900                                                                  27660099
247000******************************************************************27670099
247100* GO THRU ALL UPCS ON PACK - IF THERE ARE ANY SPLITS FOR E-COM-  *27680099
247200* MERCE FULFILLMENT CENTER, ALL OF THE UPCS ON THE PACK MUST BE  *27690099
247300* E-COM TYPE OR THE SPLITS WILL NOT BE SENT.                     *27700099
247400******************************************************************27710099
247500 2352-CHECK-PACK-FOR-E-COM.                                       27720099
247600                                                                  27730099
247700     PERFORM 8472-FETCH-E-COM-PACK-UPC-CUR.                       27740099
247800                                                                  27750099
247900     IF PS-EOC-E-COM-PACK-UPC-CUR                                 27760099
248000                                                                  27770099
248100        EVALUATE TRUE                                             27780099
248200                                                                  27790099
248300           WHEN PV-TTL-E-COM-PACK-UPCS = ZERO                     27800099
248400             AND PV-TTL-BAD-PACK-UPCS = ZERO                      27810099
248500           WHEN PV-TTL-E-COM-PACK-UPCS  = PV-TTL-PACK-UPCS        27820099
248600                                                                  27830099
248700             SET PS-PASSED-E-COM-CHECK TO TRUE                    27840099
248800                                                                  27850099
248900           WHEN OTHER                                             27860099
249000                                                                  27870099
249100             INITIALIZE TR006-ERROR-MSG                           27880099
249200             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            27890099
249300             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        27900099
249400             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 27910099
249500             STRING 'PACK-E-COM DC-NOT E-COM SKU-FIX'             27920099
249600                 DELIMITED BY SIZE                                27930099
249700                 INTO TR006-ERROR-MSG                             27940099
249800             PERFORM 8830-WRITE-ERROR-LINE                        27950099
249900             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                27960099
250000                                                                  27970099
250100        END-EVALUATE                                              27980099
250200                                                                  27990099
250300        INITIALIZE  PV-TTL-E-COM-PACK-UPCS                        28000099
250400        INITIALIZE  PV-TTL-PACK-UPCS                              28010099
250500        INITIALIZE  PV-TTL-BAD-PACK-UPCS                          28020099
250600                                                                  28030099
250700     ELSE                                                         28040099
250800                                                                  28050099
250900       ADD +1   TO PV-TTL-PACK-UPCS                               28060099
251000       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                     28070099
251100       PERFORM 2410-CHECK-FOR-E-COM-DCS                           28080099
251200                                                                  28090099
251300       IF PS-THERE-ARE-E-COM-DCS                                  28100099
251400          SET PS-THIS-IS-E-COM-UPC-NO  TO TRUE                    28110099
251500          PERFORM 2415-SELECT-UPC-FROM-TWEBITM                    28120099
251600             IF PS-THIS-IS-E-COM-UPC                              28130099
251700               ADD +1   TO PV-TTL-E-COM-PACK-UPCS                 28140099
251800             ELSE                                                 28150099
251900               ADD +1   TO PV-TTL-BAD-PACK-UPCS                   28160099
252000             END-IF                                               28170099
252100       END-IF                                                     28180099
252200                                                                  28190099
252300     END-IF.                                                      28200099
252400                                                                  28210099
252500******************************************************************28220099
252600* SELECT THE VENDOR STYLE NAME FROM TPURITM.                     *28230099
252700******************************************************************28240099
252800 2360-SELECT-VENDOR-STYLE-PCK.                                    28250099
252900                                                                  28260099
253000     EXEC SQL                                                     28270099
253100         SELECT DISTINCT                                          28280099
253200                XVS.VS_NBR                                        28290099
253300           INTO :XLT00004-VS-NBR                                  28300099
253400           FROM TPURITM      A                                    28310099
253500               ,XLT_VND_STYL XVS                                  28320099
253600               ,XLT_SKU      XS                                   28330099
253700          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 28340099
253800            AND A.ITM_NBR        =  XS.ITM_NBR                    28350099
253900            AND XS.STYL_ID       =  XVS.STYL_ID                   28360099
254000            AND A.VER_STATUS_CDE = :PC-A                          28370099
254100            AND A.STATUS_CDE    IN ('AC', 'AP')                   28380099
254200            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            28390099
254300     END-EXEC                                                     28400099
254400                                                                  28410099
254500     EVALUATE TRUE                                                28420099
254600         WHEN SQLCODE = ZERO                                      28430099
254700             MOVE XLT00004-VS-NBR       TO                        28440099
254800                   TR004-PACK-VEND-STYL-NAME                      28450099
254900                                                                  28460099
255000         WHEN SQLCODE = +100                                      28470099
255100             MOVE SPACES TO TR004-PACK-VEND-STYL-NAME             28480099
255200                                                                  28490099
255300         WHEN SQLCODE = -811                                      28500099
255400             MOVE PC-MULTI TO TR004-PACK-VEND-STYL-NAME           28510099
255500             MOVE POPRPK-PO-PREPK-ID TO TR004-PACK-ID             28520099
255600                                                                  28530099
255700         WHEN SQLWARN0 NOT EQUAL SPACE                            28540099
255800         WHEN SQLCODE NOT EQUAL ZERO                              28550099
255900             DISPLAY '**************************************'     28560099
256000             DISPLAY '** ABEND                            **'     28570099
256100             DISPLAY '** PROGRAM = TRKUP005               **'     28580099
256200             DISPLAY '** PARAGRAPH = 2360-SELECT-VENDOR-  **'     28590099
256300             DISPLAY '**                  STYLE-PCK       **'     28600099
256400             DISPLAY '** SELECT TPURITM                   **'     28610099
256500             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              28620099
256600             DISPLAY '**************************************'     28630099
256700             PERFORM 9100-SQL-ABEND                               28640099
256800     END-EVALUATE.                                                28650099
256900                                                                  28660099
257000******************************************************************28670099
257100* SELECT THE COLOR CODE AND DESCRIPTION FROM TPURITM.            *28680099
257200******************************************************************28690099
257300 2361-SELECT-COLOR-PCK.                                           28700099
257400                                                                  28710099
257500     EXEC SQL                                                     28720099
257600         SELECT DISTINCT                                          28730099
257700                XS.NRF_CLOR_CDE                                   28740099
257800              , XS.CSTM_CLOR_DESC                                 28750099
257900           INTO :XLT00003-NRF-CLOR-CDE                            28760099
258000              , :XLT00003-CSTM-CLOR-DESC                          28770099
258100           FROM TPURITM  A                                        28780099
258200               ,XLT_SKU  XS                                       28790099
258300          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                28800099
258400            AND A.ITM_NBR        =  XS.ITM_NBR                    28810099
258500            AND A.VER_STATUS_CDE = :PC-A                          28820099
258600            AND A.STATUS_CDE    IN ('AC', 'AP')                   28830099
258700            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            28840099
258800     END-EXEC                                                     28850099
258900                                                                  28860099
259000     EVALUATE TRUE                                                28870099
259100         WHEN SQLCODE = ZERO                                      28880099
259200             MOVE XLT00003-NRF-CLOR-CDE   TO TR004-PACK-COLOR-CDE 28890099
259300             MOVE XLT00003-CSTM-CLOR-DESC TO TR004-PACK-COLOR-DESC28900099
259400                                                                  28910099
259500         WHEN SQLCODE = +100                                      28920099
259600             MOVE SPACES TO TR004-PACK-COLOR-CDE                  28930099
259700                            TR004-PACK-COLOR-DESC                 28940099
259800                                                                  28950099
259900         WHEN SQLCODE = -811                                      28960099
260000             MOVE PC-MULTI TO TR004-PACK-COLOR-CDE                28970099
260100                              TR004-PACK-COLOR-DESC               28980099
260200                                                                  28990099
260300         WHEN SQLWARN0 NOT EQUAL SPACE                            29000099
260400         WHEN SQLCODE NOT EQUAL ZERO                              29010099
260500             DISPLAY '**************************************'     29020099
260600             DISPLAY '** ABEND                            **'     29030099
260700             DISPLAY '** PROGRAM = TRKUP005               **'     29040099
260800             DISPLAY '** PARAGRAPH = 2361-SELECT-COLOR-PCK**'     29050099
260900             DISPLAY '** SELECT TPURITM                   **'     29060099
261000             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              29070099
261100             DISPLAY '**************************************'     29080099
261200             PERFORM 9100-SQL-ABEND                               29090099
261300     END-EVALUATE.                                                29100099
261400                                                                  29110099
261500******************************************************************29120099
261600* SELECT THE SIZE DESCRIPTION FROM TPURITM.                      *29130099
261700******************************************************************29140099
261800 2362-SELECT-SIZE-PCK.                                            29150099
261900                                                                  29160099
262000     EXEC SQL                                                     29170099
262100         SELECT DISTINCT                                          29180099
262200                XS.SIZE_DESC                                      29190099
262300           INTO :XLT00003-SIZE-DESC                               29200099
262400           FROM TPURITM  A                                        29210099
262500               ,XLT_SKU  XS                                       29220099
262600          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                29230099
262700            AND A.ITM_NBR        =  XS.ITM_NBR                    29240099
262800            AND A.VER_STATUS_CDE = :PC-A                          29250099
262900            AND A.STATUS_CDE    IN ('AC', 'AP')                   29260099
263000            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            29270099
263100     END-EXEC                                                     29280099
263200                                                                  29290099
263300     EVALUATE TRUE                                                29300099
263400         WHEN SQLCODE = ZERO                                      29310099
263500             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         29320099
263600                 MOVE PC-NO-SIZE         TO TR004-PACK-SIZE-DESC  29330099
263700             ELSE                                                 29340099
263800                 MOVE XLT00003-SIZE-DESC TO TR004-PACK-SIZE-DESC  29350099
263900             END-IF                                               29360099
264000                                                                  29370099
264100         WHEN SQLCODE = +100                                      29380099
264200             MOVE SPACES  TO TR004-PACK-SIZE-DESC                 29390099
264300                                                                  29400099
264400         WHEN SQLCODE = -811                                      29410099
264500             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         29420099
264600                 MOVE PC-NO-SIZE TO TR004-PACK-SIZE-DESC          29430099
264700             ELSE                                                 29440099
264800                 MOVE PC-MULTI TO TR004-PACK-SIZE-DESC            29450099
264900             END-IF                                               29460099
265000                                                                  29470099
265100         WHEN SQLWARN0 NOT EQUAL SPACE                            29480099
265200         WHEN SQLCODE NOT EQUAL ZERO                              29490099
265300             DISPLAY '**************************************'     29500099
265400             DISPLAY '** ABEND                            **'     29510099
265500             DISPLAY '** PROGRAM = TRKUP005               **'     29520099
265600             DISPLAY '** PARAGRAPH = 2362-SELECT-SIZE-PCK **'     29530099
265700             DISPLAY '** SELECT TPURITM                   **'     29540099
265800             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              29550099
265900             DISPLAY '**************************************'     29560099
266000             PERFORM 9100-SQL-ABEND                               29570099
266100     END-EVALUATE.                                                29580099
266200                                                                  29590099
266300******************************************************************29600099
266400* CALCULATE ORDER QTY, CARTON COUNTS, AND UNITS PER CARTON.      *29610099
266500******************************************************************29620099
266600 2364-CARTON-COUNTS-PCK.                                          29630099
266700                                                                  29640099
266800*BUD*EVALUATE PURCHS-PKGNG-CDE                                    29650099
266800     EVALUATE POPRPK-PREPK-TYP-CDE                                29660099
266900         WHEN PC-I                                                29670099
267000             MOVE POPRPK-OTPK-UNT-QTY TO                          29680099
267100                  TR004-PACK-UNITS-PER-CTN                        29690099
139868                  PV-HOLD-PCK-UNIT-PER-CTN                        29700099
267200         WHEN PC-M                                                29710099
267300             MOVE POPRPK-INPK-UNT-QTY TO                          29720099
267400                  TR004-PACK-UNITS-PER-CTN                        29730099
139868                  PV-HOLD-PCK-UNIT-PER-CTN                        29740099
267500     END-EVALUATE.                                                29750099
267600                                                                  29760099
267700     PERFORM 2365-PACK-UNITS-PCK.                                 29770099
267800                                                                  29780099
267900     IF TR004-PACK-UNITS-PER-CTN  = ZERO                          29790099
268000       MOVE ZERO TO TR004-PACK-CART-CT                            29800099
139868                    PV-HOLD-PCK-CART-CT                           29810099
268100             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 29820099
268200             INITIALIZE TR006-ERROR-MSG                           29830099
268300             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            29840099
268400             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        29850099
268500**BUD**      IF PURCHS-PKGNG-CDE = PC-I                           29860099
268500             IF POPRPK-PREPK-TYP-CDE = PC-I                       29870099
268600               STRING 'PCK POPRPK-OTPK-UNT-QTY FLD IS 0'          29880099
268700                   DELIMITED BY SIZE                              29890099
268800                   INTO TR006-ERROR-MSG                           29900099
268900             ELSE                                                 29910099
269000               STRING 'PCK POPRPK-INPK-UNT-QTY FLD IS 0'          29920099
269100                   DELIMITED BY SIZE                              29930099
269200                   INTO TR006-ERROR-MSG                           29940099
269300             END-IF                                               29950099
269400             PERFORM 8830-WRITE-ERROR-LINE                        29960099
269500     ELSE                                                         29970099
269600       INITIALIZE PV-REMAINDER                                    29980099
 69700       DIVIDE TR004-PACK-UNITS-PER-CTN INTO                       29990099
269800              PA-TOTAL-PACK-UNITS GIVING                          30000099
269900              TR004-PACK-CART-CT ROUNDED                          30010099
270000              REMAINDER PV-REMAINDER                              30020099
139868       MOVE TR004-PACK-CART-CT      TO PV-HOLD-PCK-CART-CT        30030099
270100     END-IF.                                                      30040099
270200                                                                  30050099
270300     IF PV-REMAINDER = ZERO                                       30060099
270400       CONTINUE                                                   30070099
270500     ELSE                                                         30080099
270600       SET TR006-ERROR-TYPE-ERROR      TO TRUE                    30090099
270700       INITIALIZE TR006-ERROR-MSG                                 30100099
270800       MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU                  30110099
270900       MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR              30120099
271000       STRING                                                     30130099
271100          'SUM UNTS/PCK QTY NOT EVEN-FIX'                         30140099
271200           DELIMITED BY SIZE                                      30150099
271300           INTO TR006-ERROR-MSG                                   30160099
271400       PERFORM 8830-WRITE-ERROR-LINE                              30170099
271500       SET PS-PROBLEM-SO-SET-RETRANS   TO TRUE                    30180099
271600     END-IF.                                                      30190099
271700                                                                  30200099
271800******************************************************************30210099
271900* CALCULATE PACK UNITS.                                          *30220099
272000******************************************************************30230099
272100 2365-PACK-UNITS-PCK.                                             30240099
272200                                                                  30250099
272300     EXEC SQL                                                     30260099
272400           SELECT                                                 30270099
272500                  SUM (A.UNT_QTY)                                 30280099
272600             INTO                                                 30290099
272700                  :PA-TOTAL-PACK-UNITS                            30300099
272800             FROM                                                 30310099
272900                  TPURITM  A                                      30320099
273000             WHERE A.PO_NBR         = :PURCHS-PO-NBR              30330099
273100               AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID         30340099
273200               AND A.VER_STATUS_CDE = 'A'                         30350099
273300               AND A.STATUS_CDE    IN ('AC', 'AP')                30360099
273400     END-EXEC.                                                    30370099
273500                                                                  30380099
273600     EVALUATE TRUE                                                30390099
273700         WHEN SQLCODE = ZERO                                      30400099
273800             MOVE PA-TOTAL-PACK-UNITS TO                          30410099
273900                   TR004-PACK-UNIT-QTY                            30420099
139868                   PV-HOLD-PCK-UNIT-QTY                           30430099
274000                                                                  30440099
274100         WHEN SQLCODE = +100                                      30450099
274200         WHEN SQLCODE = -305                                      30460099
274300             MOVE ZEROES TO TR004-PACK-UNIT-QTY                   30470099
139868                            PV-HOLD-PCK-UNIT-QTY                  30480099
274400                                                                  30490099
274500         WHEN SQLWARN0 NOT EQUAL SPACE                            30500099
274600         WHEN SQLCODE NOT EQUAL ZERO                              30510099
274700             DISPLAY '** ABEND **'                                30520099
274800             DISPLAY '** PROGRAM = TRKUP005 **'                   30530099
274900             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          30540099
275000             DISPLAY '** PREPACK ID    = ' PURITM-PO-PREPK-ID     30550099
275100             DISPLAY '** PARA = 2365-PACK-UNITS-PCK**'            30560099
275200             PERFORM 9100-SQL-ABEND                               30570099
275300     END-EVALUATE.                                                30580099
275400 EJECT                                                            30590099
275500******************************************************************30600099
275600* PROCESS PREPACK DC INFORMATION.                                *30610099
275700******************************************************************30620099
275800 2370-PROCESS-PREPACK-DC.                                         30630099
275900                                                                  30640099
276000     PERFORM 8430-FETCH-PACK-DC-CURSOR.                           30650099
276100                                                                  30660099
218300     IF PS-EOC-PREPACK-DC-CURSOR                                  30670099
139868        PERFORM 2371-PROCESS-PREPACK-CONT                         30680099
139868     ELSE                                                         30690099
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     30700099
139868        PERFORM 1120-CHECK-IF-OUTLET-DC                           30710099
139868        IF PS-OUTLET-STORE                                        30720099
139868           SET PS-FIRST-STORE  TO TRUE                            30730099
139868           PERFORM 8890-OUTLET-STORE-PREPACK                      30740099
139868        ELSE                                                      30750099
155029           EVALUATE TRUE                                          30760099
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       30770099
155029               AND  PV-FAST-E-BUS-IND = 'N')                      30780099
155029                 IF PS-FIRST-UPC-YES                              30790099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 30800099
155029                    SET PS-FIRST-STORE    TO TRUE                 30810099
155029                 END-IF                                           30820099
155029                 SET PS-OUTLET-STORE   TO TRUE                    30830099
155029                 PERFORM 8890-OUTLET-STORE-PREPACK                30840099
155029                                                                  30850099
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       30860099
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      30870099
155029                 IF PS-FIRST-UPC-YES                              30880099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 30890099
155029                    SET PS-FIRST-STORE    TO TRUE                 30900099
155029                 END-IF                                           30910099
155029                 SET PS-OUTLET-STORE   TO TRUE                    30920099
155029                 PERFORM 8890-OUTLET-STORE-PREPACK                30930099
155029                                                                  30940099
155029              WHEN OTHER                                          30950099
139868                 PERFORM 2371-PROCESS-PREPACK-CONT                30960099
155029           END-EVALUATE                                           30970099
139868        END-IF                                                    30980099
139868     END-IF.                                                      30990099
279800                                                                  31000099
275700******************************************************************31010099
275800 2371-PROCESS-PREPACK-CONT.                                       31020099
275900                                                                  31030099
276200     IF PS-EOC-PREPACK-DC-CURSOR                                  31040099
276300         PERFORM 8425-CLOSE-PACK-DC-CURSOR                        31050099
276400         IF PS-DC-SPLIT-INFO-PRESENT                              31060099
139868            IF PS-OUTLET-STORE                                    31070099
139868               CONTINUE                                           31080099
139868            ELSE                                                  31090099
276500               PERFORM 2386-ADJUST-ROUNDED-PDC-DIST               31100099
276600               PERFORM 5756-WRITE-PDC-REC                         31110099
139868            END-IF                                                31120099
276700         END-IF                                                   31130099
276800     ELSE                                                         31140099
276900         IF PS-FIRST-DC                                           31150099
277000           SET PS-FIRST-DC-NO     TO TRUE                         31160099
277100*          ***************************************************    31170099
277200*          * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO       31180099
277300*          * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.        31190099
277400*          ***************************************************    31200099
277500           COMPUTE PV-DCS-TO-SKIP =                               31210099
277600             (TR004-PACK-CART-CT - PV-TOTAL-NBR-OF-DCS)           31220099
277700              * (-1)                                              31230099
277800                                                                  31240099
277900             INITIALIZE PV-TTL-ALL-DCS-PCT                        31250099
278000                      PV-TTL-ALL-DCS-UNITS                        31260099
278100                      PV-TTL-ALL-DCS-CARTS                        31270099
278200         ELSE                                                     31280099
278300*            *******************************************          31290099
278400*            * IF NOT EOC OR FIRST DC, WRITE THE DTL   *          31300099
278500*            * EXTRACT & REPORT RECS FROM THE PRIOR DC *          31310099
278600*            *******************************************          31320099
278700             PERFORM 5756-WRITE-PDC-REC                           31330099
278800         END-IF                                                   31340099
278900         INITIALIZE TR004-REC-TYPE-PDC                            31350099
279000         MOVE ALLPLN-DEST-NBR TO TR004-PDC-DIST-CNTR              31360099
279100         PERFORM 2372-ORDER-PERCENT-PDC                           31370099
279200         PERFORM 2374-ORDER-UNIT-CNT-PDC                          31380099
279300         PERFORM 2376-ORDER-CART-CNT-PDC                          31390099
279400         IF PV-DCS-TO-SKIP  > ZERO                                31400099
279500           SUBTRACT 1 FROM PV-DCS-TO-SKIP                         31410099
279600         END-IF                                                   31420099
279700     END-IF.                                                      31430099
279800                                                                  31440099
279900 EJECT                                                            31450099
280000******************************************************************31460099
280100* CALCULATE THE DC ORDER PERCENT.                                *31470099
280200*   NOTE: NO MSG. DIVIDE BY ZERO - MSG IS ALREADY DONE IN SELECT *31480099
280300******************************************************************31490099
280400 2372-ORDER-PERCENT-PDC.                                          31500099
280500                                                                  31510099
280600     IF PA-TOTAL-PACK-SPLIT-QTY = ZERO                            31520099
280700       CONTINUE                                                   31530099
280800     ELSE                                                         31540099
280900       DIVIDE PA-TOTAL-PACK-SPLIT-QTY                             31550099
281000         INTO PA-PDC-SPLIT-QTY                                    31560099
281100       GIVING PV-QUOTIENT-PDC-PERCNT ROUNDED                      31570099
281200     END-IF.                                                      31580099
281300                                                                  31590099
281400     MULTIPLY PV-QUOTIENT-PDC-PERCNT                              31600099
281500           BY +100                                                31610099
281600       GIVING TR004-PDC-PERCNT ROUNDED.                           31620099
281700                                                                  31630099
281800     IF TR004-PDC-PERCNT = ZERO                                   31640099
281900        MOVE +1 TO TR004-PDC-PERCNT                               31650099
282000     END-IF.                                                      31660099
282100                                                                  31670099
282200     ADD  TR004-PDC-PERCNT        TO PV-TTL-ALL-DCS-PCT.          31680099
282300                                                                  31690099
282400******************************************************************31700099
282500* CALCULATE THE DC ORDER UNIT COUNT.                             *31710099
282600******************************************************************31720099
282700 2374-ORDER-UNIT-CNT-PDC.                                         31730099
282800                                                                  31740099
282900     MOVE PA-PDC-SPLIT-QTY     TO TR004-PDC-UNIT-QTY.             31750099
283000                                                                  31760099
283100     IF PV-DCS-TO-SKIP  > ZERO                                    31770099
283200       MOVE ZERO    TO TR004-PDC-CART-CT                          31780099
283300     END-IF.                                                      31790099
283400                                                                  31800099
283500     ADD  TR004-PDC-UNIT-QTY   TO PV-TTL-ALL-DCS-UNITS.           31810099
283600                                                                  31820099
283700******************************************************************31830099
283800* CALCULATE THE DC ORDER CART COUNT.                             *31840099
283900******************************************************************31850099
284000 2376-ORDER-CART-CNT-PDC.                                         31860099
284100                                                                  31870099
284200*BUD*EVALUATE PURCHS-PKGNG-CDE                                    31880099
28420      EVALUATE POPRPK-PREPK-TYP-CDE                                31890099
284300                                                                  31900099
284400         WHEN PC-I                                                31910099
284500           IF POPRPK-OTPK-UNT-QTY = ZERO                          31920099
284600             MOVE ZERO TO TR004-PDC-CART-CT                       31930099
284700             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 31940099
284800             INITIALIZE TR006-ERROR-MSG                           31950099
284900             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            31960099
285000             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        31970099
285100             STRING 'POPRPK-OTPK-UNT-QTY FLD IS 0-DC'             31980099
285200                 DELIMITED BY SIZE                                31990099
285300                 INTO TR006-ERROR-MSG                             32000099
285400             PERFORM 8830-WRITE-ERROR-LINE                        32010099
285500           ELSE                                                   32020099
285600             INITIALIZE PV-REMAINDER                              32030099
285700             DIVIDE POPRPK-OTPK-UNT-QTY                           32040099
285800               INTO PA-PDC-SPLIT-QTY                              32050099
285900             GIVING TR004-PDC-CART-CT                             32060099
286000             REMAINDER PV-REMAINDER                               32070099
286100           END-IF                                                 32080099
286200                                                                  32090099
286300         WHEN PC-M                                                32100099
286400           IF POPRPK-INPK-UNT-QTY = ZERO                          32110099
286500             MOVE ZERO TO TR004-PDC-CART-CT                       32120099
286600             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 32130099
286700             INITIALIZE TR006-ERROR-MSG                           32140099
286800             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            32150099
286900             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        32160099
287000             STRING 'POPRPK-INPK-UNT-QTY FLD IS 0-DC'             32170099
287100                 DELIMITED BY SIZE                                32180099
287200                 INTO TR006-ERROR-MSG                             32190099
287300             PERFORM 8830-WRITE-ERROR-LINE                        32200099
287400           ELSE                                                   32210099
287500             INITIALIZE PV-REMAINDER                              32220099
287600             DIVIDE POPRPK-INPK-UNT-QTY                           32230099
287700               INTO PA-PDC-SPLIT-QTY                              32240099
287800             GIVING TR004-PDC-CART-CT                             32250099
287900             REMAINDER PV-REMAINDER                               32260099
288000           END-IF                                                 32270099
288100                                                                  32280099
288200     END-EVALUATE.                                                32290099
288300                                                                  32300099
288400     IF PV-DCS-TO-SKIP  > ZERO                                    32310099
288500       MOVE ZERO    TO TR004-PDC-CART-CT                          32320099
288600     END-IF.                                                      32330099
288700                                                                  32340099
288800     IF TR004-PDC-CART-CT = ZERO                                  32350099
288900       IF PURCHS-NEW-STR-PO-IND = 'Y'                             32360099
289000         INITIALIZE TR006-ERROR-MSG                               32370099
289100         MOVE POPRPK-PK-SKU-NBR      TO TR006-SKU                 32380099
289200         MOVE POPRPK-PREPK-UPC-NBR   TO TR006-UPC-NBR             32390099
289300         MOVE ALLPLN-DEST-NBR        TO PV-DEST-NBR               32400099
289400         SET TR006-ERROR-TYPE-ERROR  TO TRUE                      32410099
289500         STRING                                                   32420099
289600         'DC-'                                                    32430099
289700              PV-DEST-NBR                                         32440099
289800         '-0 CARTONS-PCK NEW STR PO'                              32450099
289900              DELIMITED BY SIZE                                   32460099
290000            INTO TR006-ERROR-MSG                                  32470099
290100         PERFORM 8830-WRITE-ERROR-LINE                            32480099
290200       END-IF                                                     32490099
290300     ELSE                                                         32500099
290400       IF PV-REMAINDER = ZERO                                     32510099
290500          CONTINUE                                                32520099
290600       ELSE                                                       32530099
290700*         ****************************************                32540099
290800*         * THE CARTON QUANTITY IS GREATER THAN  *                32550099
290900*         * ZERO, BUT THE REMAINDER FROM THE     *                32560099
291000*         * DIVIDE BY UNITS IS GREATER THAN ZERO *                32570099
291100*         * SO ISSUE MESSAGE BELOW & DON'T SEND. *                32580099
291200*         ****************************************                32590099
291300          INITIALIZE TR006-ERROR-MSG                              32600099
291400          MOVE POPRPK-PK-SKU-NBR    TO TR006-SKU                  32610099
291500          MOVE POPRPK-PREPK-UPC-NBR TO TR006-UPC-NBR              32620099
291600          SET TR006-ERROR-TYPE-ERROR      TO TRUE                 32630099
291700          STRING                                                  32640099
291800             'DC '                                                32650099
291900              TR004-PDC-DIST-CNTR                                 32660099
292000             ' PCK UNTS NT DVBL/OTR-FIX'                          32670099
292100              DELIMITED BY SIZE                                   32680099
292200              INTO TR006-ERROR-MSG                                32690099
292300          PERFORM 8830-WRITE-ERROR-LINE                           32700099
292400          SET PS-PROBLEM-SO-SET-RETRANS  TO TRUE                  32710099
292500       END-IF                                                     32720099
292600     END-IF.                                                      32730099
292700                                                                  32740099
292800     ADD  TR004-PDC-CART-CT       TO PV-TTL-ALL-DCS-CARTS.        32750099
292900                                                                  32760099
293000******************************************************************32770099
293100* SELECT PREPACK SUM LINE.                                       *32780099
293200******************************************************************32790099
293300 2380-SELECT-PACK-SUM.                                            32800099
293400                                                                  32810099
293500     EXEC SQL                                                     32820099
293600           SELECT                                                 32830099
293700                  SUM (A.CURR_SPLIT_QTY)                          32840099
293800             INTO                                                 32850099
293900                  :PA-TOTAL-PACK-SPLIT-QTY                        32860099
294000             FROM                                                 32870099
294100                  TALLPLN  A                                      32880099
294200                 ,TPURITM  B                                      32890099
294300                                                                  32900099
294400             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                32910099
294500               AND A.PO_NBR      =  B.PO_NBR                      32920099
294600               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  32930099
294700               AND A.CURR_SPLIT_QTY > 0                           32940099
294800               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           32950099
294900               AND B.VER_STATUS_CDE = 'A'                         32960099
295000               AND B.STATUS_CDE IN ('AC', 'AP')                   32970099
295100     END-EXEC.                                                    32980099
295200                                                                  32990099
295300     EVALUATE TRUE                                                33000099
295400         WHEN SQLCODE = ZERO AND PA-TOTAL-PACK-SPLIT-QTY > 0      33010099
295500           SET PS-SELECT-PACK-SUM-OK     TO TRUE                  33020099
295600                                                                  33030099
295700         WHEN SQLCODE = ZERO AND PA-TOTAL-PACK-SPLIT-QTY = 0      33040099
295800         WHEN SQLCODE = +100                                      33050099
295900         WHEN SQLCODE = -305                                      33060099
296000             MOVE ZEROES TO TR004-PDC-PERCNT                      33070099
296100             INITIALIZE TR006-ERROR-MSG                           33080099
296200             MOVE POPRPK-PK-SKU-NBR          TO TR006-SKU         33090099
296300             MOVE POPRPK-PREPK-UPC-NBR       TO TR006-UPC-NBR     33100099
296400             SET TR006-ERROR-TYPE-MISS-SPLT  TO TRUE              33110099
296500             STRING 'PCK PO MISSING SPLIT-FIX'                    33120099
296600                 DELIMITED BY SIZE                                33130099
296700                 INTO TR006-ERROR-MSG                             33140099
296800             PERFORM 8830-WRITE-ERROR-LINE                        33150099
296900             SET PS-SPLITS-ENTERED-NO      TO TRUE                33160099
297000                                                                  33170099
297100                                                                  33180099
297200         WHEN SQLWARN0 NOT EQUAL SPACE                            33190099
297300         WHEN SQLCODE NOT EQUAL ZERO                              33200099
297400             DISPLAY '** ABEND **'                                33210099
297500             DISPLAY '** PROGRAM = TRKUP005 **'                   33220099
297600             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          33230099
297700             DISPLAY '** PREPACK ID    = ' PURITM-PO-PREPK-ID     33240099
297800             DISPLAY '** PARA = 2380-SELECT-PACK-SUM'             33250099
297900             PERFORM 9100-SQL-ABEND                               33260099
298000     END-EVALUATE.                                                33270099
298100                                                                  33280099
298200******************************************************************33290099
298300* COUNT THE DCS FOR THIS PACK.                                   *33300099
298400******************************************************************33310099
298500 2384-COUNT-DCS-FOR-PACK.                                         33320099
298600                                                                  33330099
298700     EXEC SQL                                                     33340099
298800           SELECT                                                 33350099
298900                  COUNT(DISTINCT A.DEST_NBR)                      33360099
299000             INTO                                                 33370099
299100                  :PV-TOTAL-NBR-OF-DCS                            33380099
299200             FROM                                                 33390099
299300                  TALLPLN  A                                      33400099
299400                 ,TPURITM  B                                      33410099
299500                                                                  33420099
299600             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                33430099
299700               AND A.PO_NBR      =  B.PO_NBR                      33440099
299800               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  33450099
299900               AND A.CURR_SPLIT_QTY > 0                           33460099
300000               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           33470099
300100               AND B.VER_STATUS_CDE = 'A'                         33480099
300200               AND B.STATUS_CDE IN ('AC', 'AP')                   33490099
300300     END-EXEC.                                                    33500099
300400                                                                  33510099
300500     EVALUATE TRUE                                                33520099
300600         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-DCS  > 0         33530099
300700*          ***************************************************    33540099
300800*          * IF THERE ARE MORE DCS THAN CARTONS, WE'VE GOT A      33550099
300900*          * PROBLEM AND WE DON'T WANT TO SEND THE SPLIT.         33560099
301000*          ***************************************************    33570099
301100           IF TR004-PACK-CART-CT  < PV-TOTAL-NBR-OF-DCS           33580099
301200             INITIALIZE   TR006-ERROR-MSG                         33590099
301300             MOVE POPRPK-PK-SKU-NBR        TO TR006-SKU           33600099
301400             MOVE POPRPK-PREPK-UPC-NBR     TO TR006-UPC-NBR       33610099
301500             SET TR006-ERROR-TYPE-ERROR    TO TRUE                33620099
301600             STRING 'PACK CARTONS < NBR DCS-FIX'                  33630099
301700                 DELIMITED BY SIZE                                33640099
301800                 INTO TR006-ERROR-MSG                             33650099
301900             PERFORM 8830-WRITE-ERROR-LINE                        33660099
302000             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                33670099
302100           ELSE                                                   33680099
302200             SET PS-COUNT-DCS-OK           TO TRUE                33690099
302300           END-IF                                                 33700099
302400                                                                  33710099
302500         WHEN SQLCODE = +100                                      33720099
302600         WHEN SQLCODE = -305                                      33730099
302700             MOVE ZEROES TO TR004-PDC-PERCNT                      33740099
302800             INITIALIZE TR006-ERROR-MSG                           33750099
302900             MOVE POPRPK-PK-SKU-NBR          TO TR006-SKU         33760099
303000             MOVE POPRPK-PREPK-UPC-NBR       TO TR006-UPC-NBR     33770099
303100             SET TR006-ERROR-TYPE-MISS-SPLT  TO TRUE              33780099
303200             STRING 'PCK PO MISSING SPLIT-FIX'                    33790099
303300                 DELIMITED BY SIZE                                33800099
303400                 INTO TR006-ERROR-MSG                             33810099
303500             PERFORM 8830-WRITE-ERROR-LINE                        33820099
303600             SET PS-SPLITS-ENTERED-NO      TO TRUE                33830099
303700                                                                  33840099
303800                                                                  33850099
303900         WHEN SQLWARN0 NOT EQUAL SPACE                            33860099
304000         WHEN SQLCODE NOT EQUAL ZERO                              33870099
304100             DISPLAY '** ABEND **'                                33880099
304200             DISPLAY '** PROGRAM = TRKUP005 **'                   33890099
304300             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          33900099
304400             DISPLAY '** PREPACK ID    = ' PURITM-PO-PREPK-ID     33910099
304500             DISPLAY '** PARA = 2384-COUNT-DCS-FOR-PACK'          33920099
304600             PERFORM 9100-SQL-ABEND                               33930099
304700     END-EVALUATE.                                                33940099
304800                                                                  33950099
304900******************************************************************33960099
305000 2386-ADJUST-ROUNDED-PDC-DIST.                                    33970099
305100                                                                  33980099
305200     IF PV-TTL-ALL-DCS-PCT = 100                                  33990099
305300       CONTINUE                                                   34000099
305400     ELSE                                                         34010099
305500       COMPUTE TR004-PDC-PERCNT =                                 34020099
305600            TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)         34030099
305700     END-IF.                                                      34040099
305800                                                                  34050099
305900***  *******************************************************      34060099
306000***  * DOES IT MAKE SENSE TO TRY TO ADJUST CARTONS WHEN THE       34070099
306100***  * TOTAL YOU WOULD COMPARE TO IS CALCULATED?                  34080099
306200***  *******************************************************      34090099
306300***  IF PV-TTL-ALL-DCS-CARTS = TR004-PACK-CART-CT                 34100099
306400***    CONTINUE                                                   34110099
306500***  ELSE                                                         34120099
306600***    COMPUTE TR004-PDC-CART-CT =                                34130099
306700***       TR004-PDC-CART-CT +                                     34140099
306800***          (TR004-PACK-CART-CT - PV-TTL-ALL-DCS-CARTS)          34150099
306900***  END-IF.                                                      34160099
307000                                                                  34170099
307100     IF PV-TTL-ALL-DCS-UNITS = PA-TOTAL-PACK-SPLIT-QTY            34180099
307200       CONTINUE                                                   34190099
307300     ELSE                                                         34200099
307400       COMPUTE TR004-DC-UNIT-QTY =                                34210099
307500          TR004-DC-UNIT-QTY +                                     34220099
307600             (PA-TOTAL-PACK-SPLIT-QTY - PV-TTL-ALL-DCS-UNITS)     34230099
307700     END-IF.                                                      34240099
307800                                                                  34250099
307900 EJECT                                                            34260099
308000******************************************************************34270099
308100 2400-PROCESS-UPC-FOR-BULK.                                       34280099
308200                                                                  34290099
308300     PERFORM 8400-FETCH-BULK-UPC-CUR                              34300099
308400                                                                  34310099
308500     IF PS-EOC-BULK-UPC-CUR                                       34320099
308600         PERFORM 8300-CLOSE-BULK-UPC-CUR                          34330099
308700     ELSE                                                         34340099
308800                                                                  34350099
308900       SET PS-UPC-PASSESED-EDITS      TO TRUE                     34360099
309000       PERFORM 2405-BULK-UPC-EDITS                                34370099
309100                                                                  34380099
309200       IF PS-UPC-PASSESED-EDITS                                   34390099
309300                                                                  34400099
309400         INITIALIZE TR004-REC-TYPE-UPC                            34410099
309500         MOVE XLT00004-VS-NBR       TO                            34420099
309600             TR004-VEND-STYL-NAME                                 34430099
309700         MOVE XLT00003-CSTM-CLOR-DESC TO                          34440099
309800             TR004-UPC-COLOR-DESC                                 34450099
309900         MOVE XLT00003-SIZE-DESC      TO                          34460099
310000             TR004-UPC-SIZE-DESC                                  34470099
310100         MOVE XLT00003-SKU-DESC       TO                          34480099
310200             TR004-SKU-DESC                                       34490099
310300         MOVE XLT00003-NRF-CLOR-CDE   TO                          34500099
310400             TR004-UPC-COLOR-CDE                                  34510099
310500         MOVE SKXREF-CLASS            TO                          34520099
310600             TR004-CLASS                                          34530099
310700         MOVE SKXREF-SUBCLASS         TO                          34540099
310800             TR004-SUB-CLASS                                      34550099
310900         MOVE SKXREF-SKU              TO                          34560099
311000             TR004-SKU-SEQ-NBR                                    34570099
311100         MOVE SKXREF-DEPT             TO                          34580099
311200             TR004-DEPT-NBR                                       34590099
311300         MOVE PURITM-UNT-QTY   TO TR004-UPC-UNIT-QTY              34600099
139868                                  PV-HOLD-PCK-UNIT-QTY            34610099
311400         SET PS-ZERO-OUTR-PACK-QTY-NO  TO TRUE                    34620099
311500         INITIALIZE PV-UPC-CARTONS                                34630099
311600**GB 4/10/12  PERFORM 2420-SELECT-VEND-OUTR-PACK-QTY              34640099
311610         PERFORM 2420-EDIT-VEND-OUTR-PACK-QTY                     34650099
311700                                                                  34660099
311800         MOVE UPC-UPC-NBR      TO TR004-UPC-NBR                   34670099
311900                                                                  34680099
312000         MOVE ZERO             TO TR004-PACK-RATIO-QTY            34690099
312100                                                                  34700099
312200         PERFORM 5600-WRITE-UPC-REC                               34710099
312300                                                                  34720099
312400         IF PS-ZERO-OUTR-PACK-QTY                                 34730099
312500           CONTINUE                                               34740099
312600         ELSE                                                     34750099
312700           SET PS-CURR-SPLIT-QTY-PRESENT-NO   TO TRUE             34760099
312800           PERFORM 2520-SUM-DC-SPLIT-QTY                          34770099
312900                                                                  34780099
313000           IF PS-CURR-SPLIT-QTY-PRESENT                           34790099
313100             SET PS-COUNT-DCS-OK-NO      TO TRUE                  34800099
313200             PERFORM 2524-COUNT-DCS-FOR-BULK                      34810099
313300           END-IF                                                 34820099
313400                                                                  34830099
313500           IF PS-CURR-SPLIT-QTY-PRESENT                           34840099
313600            AND PS-COUNT-DCS-OK                                   34850099
313700             SET PS-FIRST-DC                 TO TRUE              34860099
313800             SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE              34870099
139868             SET PS-OUTLET-STORE-NO          TO TRUE              34880099
313900             PERFORM 8500-OPEN-DC-CURSOR                          34890099
314000             PERFORM 2500-PROCESS-DC-CURSOR UNTIL                 34900099
314100                 PS-EOC-DC-CURSOR                                 34910099
314200             SET PS-EOC-DC-CURSOR-NO TO TRUE                      34920099
314300           END-IF                                                 34930099
314400                                                                  34940099
314500       END-IF                                                     34950099
314600                                                                  34960099
314700     END-IF.                                                      34970099
314800                                                                  34980099
314900******************************************************************34990099
315000 2402-PROCESS-PACK-UPC.                                           35000099
315100                                                                  35010099
315200     PERFORM 8460-FETCH-PACK-UPC-CUR.                             35020099
315300                                                                  35030099
315400     IF PS-EOC-PACK-UPC-CURSOR                                    35040099
315500         PERFORM 8455-CLOSE-PACK-UPC-CUR                          35050099
315600     ELSE                                                         35060099
315700         INITIALIZE TR004-REC-TYPE-UPC                            35070099
315800         MOVE XLT00004-VS-NBR       TO                            35080099
315900             TR004-VEND-STYL-NAME                                 35090099
316000         MOVE XLT00003-CSTM-CLOR-DESC TO                          35100099
316100             TR004-UPC-COLOR-DESC                                 35110099
316200         MOVE XLT00003-SIZE-DESC      TO                          35120099
316300             TR004-UPC-SIZE-DESC                                  35130099
316400         MOVE XLT00003-SKU-DESC       TO                          35140099
316500             TR004-SKU-DESC                                       35150099
316600         MOVE XLT00003-NRF-CLOR-CDE   TO                          35160099
316700             TR004-UPC-COLOR-CDE                                  35170099
316800         MOVE SKXREF-CLASS            TO                          35180099
316900             TR004-CLASS                                          35190099
317000         MOVE SKXREF-SUBCLASS         TO                          35200099
317100             TR004-SUB-CLASS                                      35210099
317200         MOVE SKXREF-SKU              TO                          35220099
317300             TR004-SKU-SEQ-NBR                                    35230099
317400         MOVE SKXREF-DEPT             TO                          35240099
317500             TR004-DEPT-NBR                                       35250099
317600         MOVE 1                TO TR004-UPC-UNIT-QTY              35260099
317700         MOVE 1                TO TR004-OUTR-PK-QTY               35270099
317800                                                                  35280099
317900         MOVE UPC-UPC-NBR      TO TR004-UPC-NBR                   35290099
318000                                                                  35300099
318100*BUD*    IF PURCHS-PKGNG-CDE = PC-M                               35310099
318100         IF POPRPK-PREPK-TYP-CDE = PC-M                           35320099
318200            MOVE PURITM-PREPK-RATO-QTY                            35330099
318300                                  TO TR004-PACK-RATIO-QTY         35340099
318400         ELSE                                                     35350099
318500           IF POPRPK-INPK-UNT-QTY = ZERO                          35360099
318600             MOVE ZERO TO TR004-PACK-RATIO-QTY                    35370099
318700             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 35380099
318800             INITIALIZE TR006-ERROR-MSG                           35390099
318900             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            35400099
319000             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        35410099
319100             STRING 'POPRPK-INPK-UNT-QTY FLD IS 0-DTL'            35420099
319200                 DELIMITED BY SIZE                                35430099
319300                 INTO TR006-ERROR-MSG                             35440099
319400             PERFORM 8830-WRITE-ERROR-LINE                        35450099
319500           ELSE                                                   35460099
319600             COMPUTE  TR004-PACK-RATIO-QTY =                      35470099
319700              (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY) *       35480099
319800                 PURITM-PREPK-RATO-QTY                            35490099
319900           END-IF                                                 35500099
320000         END-IF                                                   35510099
320100                                                                  35520099
320200         PERFORM 5600-WRITE-UPC-REC                               35530099
320300                                                                  35540099
320400     END-IF.                                                      35550099
320500******************************************************************35560099
320600* ANY EDITS THAT MIGHT CAUSE A UPC NOT TO BE SENT SHOULD BE DONE *35570099
320700* HERE.  CURRENTLY ONLY CHECKS FOR E-COMMERCE ARE DONE.          *35580099
320800******************************************************************35590099
320900 2405-BULK-UPC-EDITS.                                             35600099
321000                                                                  35610099
321100       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE.                    35620099
321200       PERFORM 2410-CHECK-FOR-E-COM-DCS.                          35630099
321300                                                                  35640099
321400       IF PS-THERE-ARE-E-COM-DCS                                  35650099
321500         SET PS-THIS-IS-E-COM-UPC-NO   TO TRUE                    35660099
321600         PERFORM 2415-SELECT-UPC-FROM-TWEBITM                     35670099
321700                                                                  35680099
321800         IF PS-THIS-IS-E-COM-UPC                                  35690099
321900           CONTINUE                                               35700099
322000         ELSE                                                     35710099
322100             INITIALIZE TR006-ERROR-MSG                           35720099
322200             MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                   35730099
322300             MOVE SKXREF-SKU   TO TR006-SKU                       35740099
322400             SET TR006-ERROR-TYPE-ERROR       TO TRUE             35750099
322500             STRING 'E-COM DC-NOT E-COM SKU-FIX'                  35760099
322600                 DELIMITED BY SIZE                                35770099
322700                 INTO TR006-ERROR-MSG                             35780099
322800             PERFORM 8830-WRITE-ERROR-LINE                        35790099
322900             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                35800099
323000             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                35810099
323100         END-IF                                                   35820099
323200                                                                  35830099
323300       END-IF.                                                    35840099
323400                                                                  35850099
323500******************************************************************35860099
323600 2410-CHECK-FOR-E-COM-DCS.                                        35870099
323700*                                                                 35880099
323800     INITIALIZE PV-NBR-OF-E-COM-DCS.                              35890099
323900*                                                                 35900099
324000     EXEC SQL                                                     35910099
324100           SELECT                                                 35920099
324200                   COUNT(*)                                       35930099
324300             INTO                                                 35940099
324400                  :PV-NBR-OF-E-COM-DCS                            35950099
324500             FROM                                                 35960099
324600                  TUPCSKU   SKU                                   35970099
324700                 ,TPURITM   PUR                                   35980099
324800                 ,TALLPLN   AL                                    35990099
324900*FJW 03/10/10 BEGIN                                               36000099
325000                 ,XLT_LOC   LOC                                   36010099
325100*FJW 03/10/10 END                                                 36020099
325200             WHERE SKU.UPC_NBR        = :UPC-UPC-NBR              36030099
325300               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             36040099
325400               AND PUR.PO_NBR         = :PURCHS-PO-NBR            36050099
325500               AND PUR.PO_LNE_NBR     = :PURITM-PO-LNE-NBR        36060099
325600               AND PUR.VER_STATUS_CDE = 'A'                       36070099
325700               AND PUR.STATUS_CDE     IN ('AC', 'AP')             36080099
325800               AND AL.PO_LNE_NBR      =  PUR.PO_LNE_NBR           36090099
325900               AND AL.PO_NBR          =  PUR.PO_NBR               36100099
326000               AND AL.CURR_SPLIT_QTY  >  0                        36110099
326100*FJW 03/10/10 BEGIN                                               36120099
326200*              AND AL.DEST_NBR        =  870                      36130099
326300               AND AL.DEST_NBR        =  LOC.LOC_NBR              36140099
326400               AND LOC.LOC_TYP_CDE    = 'DC'                      36150099
326500               AND LOC.E_BUS_IND      = 'Y'                       36160099
326600*FJW 03/10/10 END                                                 36170099
326700     END-EXEC                                                     36180099
326800                                                                  36190099
326810     EVALUATE TRUE                                                36200099
326820         WHEN SQLCODE = ZERO                                      36210099
326830         WHEN SQLCODE = -811                                      36220099
326840            IF PV-NBR-OF-E-COM-DCS > 0                            36230099
326850              SET PS-THERE-ARE-E-COM-DCS  TO TRUE                 36240099
326860            END-IF                                                36250099
326870                                                                  36260099
326880         WHEN SQLCODE = +100                                      36270099
326890              CONTINUE                                            36280099
326900                                                                  36290099
327000         WHEN SQLWARN0 NOT EQUAL SPACE                            36300099
327100         WHEN SQLCODE NOT EQUAL ZERO                              36310099
327200             DISPLAY '** ABEND **'                                36320099
327300             DISPLAY '** PROGRAM = TRKUP005 **'                   36330099
327400             DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          36340099
327500             DISPLAY '** UPC-UPC-NBR = '   UPC-UPC-NBR            36350099
327600             DISPLAY '** PARAGRAPH = 2410-CHECK-FOR-E-COM-DCS'    36360099
327700             PERFORM 9100-SQL-ABEND                               36370099
327800     END-EVALUATE.                                                36380099
327900                                                                  36390099
328000******************************************************************36400099
328100 2415-SELECT-UPC-FROM-TWEBITM.                                    36410099
328200*                                                                 36420099
328300     INITIALIZE PV-NBR-OF-E-COM-ROWS.                             36430099
328400                                                                  36440099
328500     EXEC SQL                                                     36450099
328600           SELECT COUNT (*)                                       36460099
328700           INTO   :PV-NBR-OF-E-COM-ROWS                           36470099
328800           FROM TUPCPLS A                                         36480099
328900              , TWEBITM B                                         36490099
329000              , TUPCSKU   SKU                                     36500099
329100              , TPURITM   PUR                                     36510099
329200           WHERE SKU.UPC_NBR          = :UPC-UPC-NBR              36520099
329300               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             36530099
329400               AND PUR.PO_NBR         = :PURCHS-PO-NBR            36540099
329500               AND PUR.VER_STATUS_CDE = 'A'                       36550099
329600               AND PUR.STATUS_CDE    IN ('AC', 'AP')              36560099
329700               AND A.ITM_NBR          =  PUR.ITM_NBR              36570099
329800               AND A.OPERCO_NBR       = '03'                      36580099
329900               AND A.STR_NBR          = 0                         36590099
330000               AND ((A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      36600099
330100                       A.EFF_END_TMST IS NULL) OR                 36610099
330200                      (A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND    36620099
330300                       A.EFF_END_TMST  > CURRENT TIMESTAMP))      36630099
330400               AND A.UPC_ID        = B.INTR_UPC_ID                36640099
330500               AND (B.EFF_BEG_TMST <= CURRENT TIMESTAMP AND       36650099
330600                         B.EFF_END_TMST IS NULL)                  36660099
330610           WITH UR                                                36670099
330700     END-EXEC                                                     36680099
330800                                                                  36690099
330900     EVALUATE TRUE                                                36700099
331000         WHEN SQLCODE = ZERO                                      36710099
331100         WHEN SQLCODE = -811                                      36720099
331200            IF PV-NBR-OF-E-COM-ROWS > ZERO                        36730099
331300              SET PS-THIS-IS-E-COM-UPC    TO TRUE                 36740099
331400            END-IF                                                36750099
331500                                                                  36760099
331600         WHEN SQLCODE = +100                                      36770099
331700              CONTINUE                                            36780099
331800                                                                  36790099
331900         WHEN SQLWARN0 NOT EQUAL SPACE                            36800099
332000         WHEN SQLCODE NOT EQUAL ZERO                              36810099
332100             DISPLAY '** ABEND **'                                36820099
332200             DISPLAY '** PROGRAM = TRKUP005 **'                   36830099
332300             DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          36840099
332400             DISPLAY '** UPC-UPC-NBR = '   UPC-UPC-NBR            36850099
332500             DISPLAY '** PARAGRAPH = 2415-SELECT-UPC-FROM-TWEBITM'36860099
332600             PERFORM 9100-SQL-ABEND                               36870099
332700     END-EVALUATE.                                                36880099
332800                                                                  36890099
332900                                                                  36900099
332910 2420-EDIT-VEND-OUTR-PACK-QTY.                                    36910099
332911                                                                  36920099
332920      IF PURITM-OUTR-PK-QTY = ZERO                                36930099
332930          INITIALIZE TR006-ERROR-MSG                              36940099
332940          MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                      36950099
332950          MOVE SKXREF-SKU   TO TR006-SKU                          36960099
332960          SET TR006-ERROR-TYPE-ERROR      TO TRUE                 36970099
332970          STRING 'BULK-ZERO OUTR PCK QTY-FIX'                     36980099
332980              DELIMITED BY SIZE                                   36990099
332990              INTO TR006-ERROR-MSG                                37000099
332991          PERFORM 8830-WRITE-ERROR-LINE                           37010099
332992          SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                   37020099
332993          SET PS-ZERO-OUTR-PACK-QTY     TO TRUE                   37030099
332994      ELSE                                                        37040099
332995          MOVE PURITM-OUTR-PK-QTY TO                              37050099
332996              TR004-OUTR-PK-QTY                                   37060099
139868              PV-HOLD-PCK-CART-CT                                 37070099
332997          DIVIDE PURITM-OUTR-PK-QTY                               37080099
332998            INTO TR004-UPC-UNIT-QTY                               37090099
332999          GIVING PV-UPC-CARTONS   ROUNDED                         37100099
333000       END-IF.                                                    37110099
333001                                                                  37120099
333002                                                                  37130099
333010******************************************************************37140099
333100*2420-SELECT-VEND-OUTR-PACK-QTY.                                  37150099
333200*                                                                 37160099
333300*    EXEC SQL                                                     37170099
333400*          SELECT                                                 37180099
333500*                 UPC.OUTR_PK_QTY                                 37190099
333600*            INTO                                                 37200099
333700*                 :UPC-OUTR-PK-QTY                                37210099
333800*            FROM                                                 37220099
333900*                 TSKXREF  SKX                                    37230099
334000*                ,TUPC     UPC                                    37240099
334100*          WHERE  SKX.ITM_NBR      =  :PURITM-ITM-NBR             37250099
334200*            AND  SKX.INTR_UPC_ID  =  UPC.INTR_UPC_ID             37260099
334300*            AND  UPC.UPC_TYP_CDE  = 'I'                          37270099
334400*    END-EXEC                                                     37280099
334500*                                                                 37290099
334600*    EVALUATE TRUE                                                37300099
334700*        WHEN SQLCODE = ZERO                                      37310099
334800*            IF UPC-OUTR-PK-QTY = ZERO                            37320099
334900*                INITIALIZE TR006-ERROR-MSG                       37330099
335000*                MOVE UPC-UPC-NBR  TO TR006-UPC-NBR               37340099
335100*                MOVE SKXREF-SKU   TO TR006-SKU                   37350099
335200*                SET TR006-ERROR-TYPE-ERROR      TO TRUE          37360099
335300*                STRING 'BULK-ZERO OUTR PCK QTY-FIX'              37370099
335400*                    DELIMITED BY SIZE                            37380099
335500*                    INTO TR006-ERROR-MSG                         37390099
335600*                PERFORM 8830-WRITE-ERROR-LINE                    37400099
335700*                SET PS-PROBLEM-SO-SET-RETRANS TO TRUE            37410099
335800*                SET PS-ZERO-OUTR-PACK-QTY     TO TRUE            37420099
335900*            ELSE                                                 37430099
336000*                MOVE UPC-OUTR-PK-QTY   TO                        37440099
336100*                    TR004-OUTR-PK-QTY                            37450099
336200*                DIVIDE UPC-OUTR-PK-QTY                           37460099
336300*                  INTO TR004-UPC-UNIT-QTY                        37470099
336400*                GIVING PV-UPC-CARTONS   ROUNDED                  37480099
336500*            END-IF                                               37490099
336600*                                                                 37500099
336700*        WHEN SQLCODE = +100                                      37510099
336800*            MOVE 0 TO TR004-OUTR-PK-QTY                          37520099
336900*            MOVE 0 TO UPC-OUTR-PK-QTY                            37530099
337000*            INITIALIZE TR006-ERROR-MSG                           37540099
337100*            MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                   37550099
337200*            MOVE SKXREF-SKU   TO TR006-SKU                       37560099
337300*            SET TR006-ERROR-TYPE-ERROR      TO TRUE              37570099
337400*            STRING 'BULK SKU NOT FOUND-FIX'                      37580099
337500*                DELIMITED BY SIZE                                37590099
337600*                INTO TR006-ERROR-MSG                             37600099
337700*            PERFORM 8830-WRITE-ERROR-LINE                        37610099
337800*            SET PS-PROBLEM-SO-SET-RETRANS     TO TRUE            37620099
337900*            SET PS-ZERO-OUTR-PACK-QTY         TO TRUE            37630099
338000*                                                                 37640099
338100*        WHEN SQLWARN0 NOT EQUAL SPACE                            37650099
338200*        WHEN SQLCODE NOT EQUAL ZERO                              37660099
338300*            DISPLAY '** ABEND **'                                37670099
338400*            DISPLAY '** PROGRAM = TRKUP005 **'                   37680099
338500*            DISPLAY '** PARAGRAPH = 2420-SEL-VEND-OUTR-PACK-QTY*'37690099
338600*            DISPLAY '** PURITM-ITM-NBR = ' PURITM-ITM-NBR        37700099
338700*            DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          37710099
338800*            DISPLAY '** PURITM-PO-LNE-NBR = '                    37720099
338900*                 PURITM-PO-LNE-NBR                               37730099
339000*            PERFORM 9100-SQL-ABEND                               37740099
339100*    END-EVALUATE.                                                37750099
339200*                                                                 37760099
339300******************************************************************37770099
339400 2500-PROCESS-DC-CURSOR.                                          37780099
339500                                                                  37790099
339600     PERFORM 8700-FETCH-DC-CURSOR.                                37800099
339700                                                                  37810099
339800     IF PS-EOC-DC-CURSOR                                          37820099
139868        PERFORM 2505-PROCESS-DC-CONTINUE                          37830099
139868     ELSE                                                         37840099
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     37850099
139868        PERFORM 1120-CHECK-IF-OUTLET-DC                           37860099
139868        IF PS-OUTLET-STORE                                        37870099
139868           SET PS-FIRST-STORE    TO TRUE                          37880099
155029           PERFORM 2522-SUM-STORE-SPLIT-QTY                       37890099
139868           PERFORM 8900-OUTLET-STORE-DC                           37900099
139868        ELSE                                                      37910099
155029           EVALUATE TRUE                                          37920099
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       37930099
155029               AND  PV-FAST-E-BUS-IND = 'N')                      37940099
155029                 IF PS-FIRST-UPC-YES                              37950099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 37960099
155029                    SET PS-FIRST-STORE    TO TRUE                 37970099
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              37980099
155029                 END-IF                                           37990099
155029                 SET PS-OUTLET-STORE   TO TRUE                    38000099
155029                 PERFORM 8900-OUTLET-STORE-DC                     38010099
155029                                                                  38020099
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       38030099
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      38040099
155029                 IF PS-FIRST-UPC-YES                              38050099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 38060099
155029                    SET PS-FIRST-STORE    TO TRUE                 38070099
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              38080099
155029                 END-IF                                           38090099
155029                 SET PS-OUTLET-STORE   TO TRUE                    38100099
155029                 PERFORM 8900-OUTLET-STORE-DC                     38110099
155029                                                                  38120099
155029              WHEN OTHER                                          38130099
139868                 PERFORM 2505-PROCESS-DC-CONTINUE                 38140099
155029           END-EVALUATE                                           38150099
340300        END-IF                                                    38160099
344200     END-IF.                                                      38170099
344300                                                                  38180099
339300******************************************************************38190099
139868 2505-PROCESS-DC-CONTINUE.                                        38200099
339500                                                                  38210099
339800     IF PS-EOC-DC-CURSOR                                          38220099
339900        PERFORM 8600-CLOSE-DC-CURSOR                              38230099
340000        IF PS-DC-SPLIT-INFO-PRESENT                               38240099
139868           IF PS-OUTLET-STORE                                     38250099
139868              CONTINUE                                            38260099
139868           ELSE                                                   38270099
340100              PERFORM 2515-ADJUST-ROUNDED-DC-DIST                 38280099
340200              PERFORM 5700-WRITE-DC-RECORD                        38290099
139868           END-IF                                                 38300099
340300        END-IF                                                    38310099
340400     ELSE                                                         38320099
340500        IF PS-FIRST-DC                                            38330099
340600          SET PS-FIRST-DC-NO     TO TRUE                          38340099
340700          INITIALIZE PV-TTL-ALL-DCS-PCT                           38350099
340800                     PV-TTL-ALL-DCS-UNITS                         38360099
340900                     PV-TTL-ALL-DCS-CARTS                         38370099
341000*         ***************************************************     38380099
341100*         * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO        38390099
341200*         * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.         38400099
341300*         ***************************************************     38410099
341400          IF PURITM-OUTR-PK-QTY = ZERO                            38420099
341500            MOVE ZERO TO PV-DCS-TO-SKIP                           38430099
341600          ELSE                                                    38440099
341700              DIVIDE PURITM-OUTR-PK-QTY                           38450099
341800                INTO PA-TOTAL-CURR-SPLIT-QTY                      38460099
341900              GIVING PV-TOTAL-CARTONS   ROUNDED                   38470099
342000              COMPUTE PV-DCS-TO-SKIP =                            38480099
342100               (PV-TOTAL-CARTONS - PV-TOTAL-NBR-OF-DCS) * (-1)    38490099
342200          END-IF                                                  38500099
342300                                                                  38510099
342400        ELSE                                                      38520099
342500*           *******************************************           38530099
342600*           * IF NOT EOC OR FIRST DC, WRITE THE DTL   *           38540099
342700*           * EXTRACT & REPORT RECS FROM THE PRIOR DC *           38550099
342800*           * (AND NOT ZERO-OUTR-PACK-QTY)            *           38560099
342900*           *******************************************           38570099
343000            PERFORM 5700-WRITE-DC-RECORD                          38580099
343100        END-IF                                                    38590099
343200                                                                  38600099
343300        INITIALIZE TR004-REC-TYPE-DC                              38610099
343400        MOVE ALLPLN-DEST-NBR TO                                   38620099
343500            TR004-DIST-CNTR                                       38630099
343600        MOVE ALLPLN-CURR-SPLIT-QTY             TO                 38640099
343700            TR004-DC-UNIT-QTY                                     38650099
343800        PERFORM 2510-DC-CALCULATIONS                              38660099
343900****    IF ALLPLN-DC-SPLIT-QTY = 0                                38670099
344000****        PERFORM 2540-UPDATE-TALLPLN                           38680099
344100****    END-IF                                                    38690099
344200     END-IF.                                                      38700099
344300                                                                  38710099
344400******************************************************************38720099
344500* NOTE: NO NEED FOR MSG FOR DIVIDE BY ZERO BECAUSE DIVISORS      *38730099
344600*       CHECKED IN PREVIOUS ROUTINES.                            *38740099
344700******************************************************************38750099
344800 2510-DC-CALCULATIONS.                                            38760099
344900                                                                  38770099
345000     IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                            38780099
345100       CONTINUE                                                   38790099
345200     ELSE                                                         38800099
345300       DIVIDE PA-TOTAL-CURR-SPLIT-QTY    INTO                     38810099
345400         ALLPLN-CURR-SPLIT-QTY         GIVING                     38820099
345500         PV-QUOTIENT-ORDER-PERCENT ROUNDED                        38830099
345600       MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                      38840099
345700             100 GIVING TR004-DC-PERCNT ROUNDED                   38850099
345800     END-IF.                                                      38860099
345800                                                                  38870099
345900     IF TR004-DC-PERCNT = ZERO                                    38880099
346000        MOVE +1 TO TR004-DC-PERCNT                                38890099
346100     END-IF.                                                      38900099
346200     ADD  TR004-DC-PERCNT      TO PV-TTL-ALL-DCS-PCT.             38910099
346300                                                                  38920099
346400     INITIALIZE PV-REMAINDER.                                     38930099
346500     IF PURITM-OUTR-PK-QTY = ZERO                                 38940099
346600       CONTINUE                                                   38950099
346700     ELSE                                                         38960099
346800       DIVIDE PURITM-OUTR-PK-QTY   INTO                           38970099
346900         ALLPLN-CURR-SPLIT-QTY     GIVING                         38980099
347000         TR004-DC-CART-CT                                         38990099
347100         REMAINDER PV-REMAINDER                                   39000099
347200     END-IF.                                                      39010099
347300     ADD  TR004-DC-CART-CT     TO PV-TTL-ALL-DCS-CARTS.           39020099
347400                                                                  39030099
347500     IF PV-REMAINDER = ZERO                                       39040099
347600        CONTINUE                                                  39050099
347700     ELSE                                                         39060099
347800        INITIALIZE TR006-ERROR-MSG                                39070099
347900        MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                        39080099
348000        MOVE SKXREF-SKU   TO TR006-SKU                            39090099
348100        SET TR006-ERROR-TYPE-ERROR      TO TRUE                   39100099
348200        STRING                                                    39110099
348300           'DC '                                                  39120099
348400           TR004-DIST-CNTR                                        39130099
348500           ' UNITS NOT DIVBL/OUTR-FIX'                            39140099
348600            DELIMITED BY SIZE                                     39150099
348700            INTO TR006-ERROR-MSG                                  39160099
348800        PERFORM 8830-WRITE-ERROR-LINE                             39170099
348900        SET PS-PROBLEM-SO-SET-RETRANS  TO TRUE                    39180099
349000     END-IF.                                                      39190099
349100                                                                  39200099
349200     IF TR004-DC-CART-CT = ZERO                                   39210099
349300       IF PURCHS-NEW-STR-PO-IND = 'Y'                             39220099
349400             AND TR004-DC-CART-CT = ZERO                          39230099
349500           INITIALIZE TR006-ERROR-MSG                             39240099
349600           MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                     39250099
349700           MOVE SKXREF-SKU   TO TR006-SKU                         39260099
349800           MOVE ALLPLN-DEST-NBR TO                                39270099
349900                      PV-DEST-NBR                                 39280099
350000           SET TR006-ERROR-TYPE-ERROR                             39290099
350100                                    TO TRUE                       39300099
350200           STRING                                                 39310099
350300           'DC-'                                                  39320099
350400                PV-DEST-NBR                                       39330099
350500           '-BULK-0 CARTONS-NEW STR PO'                           39340099
350600                DELIMITED BY SIZE                                 39350099
350700              INTO TR006-ERROR-MSG                                39360099
350800           PERFORM 8830-WRITE-ERROR-LINE                          39370099
350900       END-IF                                                     39380099
351000     END-IF.                                                      39390099
351100                                                                  39400099
344700******************************************************************39410099
139868 2512-DC-OUT-CALCULATIONS.                                        39420099
139868                                                                  39430099
139868     IF TR004-DC-PERCNT = ZERO                                    39440099
139868        MOVE +1 TO TR004-DC-PERCNT                                39450099
139868     END-IF.                                                      39460099
139868     ADD  TR004-DC-PERCNT      TO PV-TTL-ALL-DCS-PCT.             39470099
139868                                                                  39480099
139868     INITIALIZE PV-REMAINDER.                                     39490099
139868     IF PURITM-OUTR-PK-QTY = ZERO                                 39500099
139868       CONTINUE                                                   39510099
139868     ELSE                                                         39520099
139868       DIVIDE PURITM-OUTR-PK-QTY   INTO                           39530099
139868         MESTDS-STR-DISTRO-QTY     GIVING                         39540099
139868         TR004-DC-CART-CT                                         39550099
139868         REMAINDER PV-REMAINDER                                   39560099
139868     END-IF.                                                      39570099
139868     ADD  TR004-DC-CART-CT     TO PV-TTL-ALL-DCS-CARTS.           39580099
139868                                                                  39590099
139868     IF PV-REMAINDER = ZERO                                       39600099
139868        CONTINUE                                                  39610099
139868     ELSE                                                         39620099
139868        INITIALIZE TR006-ERROR-MSG                                39630099
139868        MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                        39640099
139868        MOVE SKXREF-SKU   TO TR006-SKU                            39650099
139868        SET TR006-ERROR-TYPE-ERROR      TO TRUE                   39660099
139868        STRING                                                    39670099
139868           'DC '                                                  39680099
139868           TR004-DIST-CNTR                                        39690099
139868           ' UNITS NOT DIVBL/OUTR-FIX'                            39700099
139868            DELIMITED BY SIZE                                     39710099
139868            INTO TR006-ERROR-MSG                                  39720099
139868        PERFORM 8830-WRITE-ERROR-LINE                             39730099
139868        SET PS-PROBLEM-SO-SET-RETRANS  TO TRUE                    39740099
139868     END-IF.                                                      39750099
139868                                                                  39760099
139868     IF TR004-DC-CART-CT = ZERO                                   39770099
139868       IF PURCHS-NEW-STR-PO-IND = 'Y'                             39780099
139868             AND TR004-DC-CART-CT = ZERO                          39790099
139868           INITIALIZE TR006-ERROR-MSG                             39800099
139868           MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                     39810099
139868           MOVE SKXREF-SKU   TO TR006-SKU                         39820099
139868           MOVE MESTDS-STR-NBR TO                                 39830099
139868                      PV-DEST-NBR                                 39840099
139868           SET TR006-ERROR-TYPE-ERROR                             39850099
139868                                    TO TRUE                       39860099
139868           STRING                                                 39870099
139868           'DC-'                                                  39880099
139868                PV-DEST-NBR                                       39890099
139868           '-BULK-0 CARTONS-NEW STR PO'                           39900099
139868                DELIMITED BY SIZE                                 39910099
139868              INTO TR006-ERROR-MSG                                39920099
139868           PERFORM 8830-WRITE-ERROR-LINE                          39930099
139868       END-IF                                                     39940099
139868     END-IF.                                                      39950099
139868                                                                  39960099
351200******************************************************************39970099
351300 2515-ADJUST-ROUNDED-DC-DIST.                                     39980099
351400                                                                  39990099
351500     IF PV-TTL-ALL-DCS-PCT = 100                                  40000099
351600       CONTINUE                                                   40010099
351700     ELSE                                                         40020099
351800       COMPUTE TR004-DC-PERCNT =                                  40030099
351900            TR004-DC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)          40040099
352000     END-IF.                                                      40050099
352100                                                                  40060099
352200***  IF PV-TTL-ALL-DCS-CARTS = PV-UPC-CARTONS                     40070099
352300***    CONTINUE                                                   40080099
352400***  ELSE                                                         40090099
352500***    COMPUTE TR004-PDC-CART-CT =                                40100099
352600***       TR004-PDC-CART-CT +                                     40110099
352700***          (PV-UPC-CARTONS  - PV-TTL-ALL-DCS-CARTS)             40120099
352800***  END-IF.                                                      40130099
352900                                                                  40140099
139868******************************************************************40150099
139868 2516-ADJUST-ROUNDED-OUT-DIST.                                    40160099
139868                                                                  40170099
155029     IF  PS-EOC-STORE-CURSOR                                      40180099
155029     AND PS-OUTLET-STORE-NO                                       40190099
155029        DIVIDE PA-TOTAL-STR-SPLIT-QTY                             40200099
155029          INTO MESTDS-STR-DISTRO-QTY                              40210099
155029            GIVING PV-QUOTIENT-ORDER-PERCENT                      40220099
155029        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     40230099
155029            100 GIVING TR004-DC-PERCNT ROUNDED                    40240099
155029                                                                  40250099
155029        IF TR004-DC-PERCNT = ZERO                                 40260099
155029           MOVE +1 TO TR004-DC-PERCNT                             40270099
155029        END-IF                                                    40280099
155029                                                                  40290099
155029     ELSE                                                         40300099
139868        IF PV-TTL-ALL-DCS-PCT = 100                               40310099
139868           CONTINUE                                               40320099
139868        ELSE                                                      40330099
139868           COMPUTE TR004-PDC-PERCNT =                             40340099
139868               TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)      40350099
155029        END-IF                                                    40360099
139868     END-IF.                                                      40370099
139868                                                                  40380099
353000******************************************************************40390099
353100 2520-SUM-DC-SPLIT-QTY.                                           40400099
353200*                                                                 40410099
353300     EXEC SQL                                                     40420099
353400           SELECT                                                 40430099
353500                  SUM (AL.CURR_SPLIT_QTY)                         40440099
353600             INTO                                                 40450099
353700                  :PA-TOTAL-CURR-SPLIT-QTY                        40460099
353800             FROM                                                 40470099
353900                  TALLPLN   AL                                    40480099
354000                , TPURITM   LN                                    40490099
354100             WHERE AL.PO_NBR         = :PURITM-PO-NBR             40500099
354200               AND AL.PO_NBR         =  LN.PO_NBR                 40510099
354300               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         40520099
354400               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             40530099
354500               AND AL.CURR_SPLIT_QTY >  0                         40540099
354600               AND LN.VER_STATUS_CDE = 'A'                        40550099
354700               AND LN.STATUS_CDE    IN ('AC', 'AP')               40560099
354800     END-EXEC                                                     40570099
354900                                                                  40580099
355000     EVALUATE TRUE                                                40590099
355100         WHEN SQLCODE = ZERO AND PA-TOTAL-CURR-SPLIT-QTY = ZERO   40600099
355200         WHEN SQLCODE = -305                                      40610099
355300         WHEN SQLCODE = +100                                      40620099
355400             INITIALIZE        TR006-ERROR-MSG                    40630099
355500                               TR006-UPC-NBR                      40640099
355600                               TR006-SKU                          40650099
355700             STRING 'BULK PO MISSING SPLITS-FIX'                  40660099
355800                 DELIMITED BY SIZE                                40670099
355900             INTO TR006-ERROR-MSG                                 40680099
356000             PERFORM 8710-MISSING-SPLIT-ERROR                     40690099
356100                                                                  40700099
356200         WHEN SQLCODE = ZERO                                      40710099
356300             SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE                40720099
356400                                                                  40730099
356500         WHEN SQLWARN0 NOT EQUAL SPACE                            40740099
356600         WHEN SQLCODE NOT EQUAL ZERO                              40750099
356700             DISPLAY '** ABEND **'                                40760099
356800             DISPLAY '** PROGRAM = TRKUP005 **'                   40770099
356900             DISPLAY '** PURITM-PO-NBR = ' PURITM-PO-NBR          40780099
357000             DISPLAY '** PURITM-PO-LNE-NBR = '                    40790099
357100                 PURITM-PO-LNE-NBR                                40800099
357200             DISPLAY '** PARAGRAPH = 2520-SUM-DC-SPLIT-QTY**'     40810099
357300             PERFORM 9100-SQL-ABEND                               40820099
357400     END-EVALUATE.                                                40830099
357400                                                                  40840099
353000******************************************************************40850099
155029 2521-SUM-SPLIT-QTY.                                              40860099
155029                                                                  40870099
155029     EXEC SQL                                                     40880099
155029           SELECT SUM (EST.STR_DISTRO_QTY)                        40890099
155029             INTO :PA-TOTAL-STR-SPLIT-QTY                         40900099
155029             FROM TMESTDS   EST                                   40910099
155029                , TALLPLN   TAL                                   40920099
155029                , TPURITM   PUR                                   40930099
155029             WHERE PUR.PO_NBR         = :PURCHS-PO-NBR            40940099
155029               AND PUR.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID       40950099
155029               AND PUR.VER_STATUS_CDE = 'A'                       40960099
155029               AND PUR.STATUS_CDE     IN ('AC', 'AP')             40970099
155029               AND EST.PO_LNE_NBR     =  PUR.PO_LNE_NBR           40980099
155029               AND EST.PO_NBR         =  PUR.PO_NBR               40990099
155029               AND EST.PO_NBR         =  TAL.PO_NBR               41000099
155029               AND EST.PO_LNE_NBR     =  TAL.PO_LNE_NBR           41010099
155029               AND EST.PLAN_NBR       =  TAL.PLAN_NBR             41020099
155029               AND TAL.DEST_NBR       = :ALLPLN-DEST-NBR          41030099
155029               AND EST.STR_DISTRO_QTY >  0                        41040099
155029     END-EXEC                                                     41050099
155029                                                                  41060099
155029     EVALUATE TRUE                                                41070099
155029         WHEN SQLCODE = ZERO AND PA-TOTAL-STR-SPLIT-QTY = ZERO    41080099
155029         WHEN SQLCODE = -305                                      41090099
155029         WHEN SQLCODE = +100                                      41100099
155029             INITIALIZE        TR006-ERROR-MSG                    41110099
155029                               TR006-UPC-NBR                      41120099
155029                               TR006-SKU                          41130099
155029             STRING 'BULK PO MISSING SPLITS-FIX'                  41140099
155029                 DELIMITED BY SIZE                                41150099
155029             INTO TR006-ERROR-MSG                                 41160099
155029             PERFORM 8710-MISSING-SPLIT-ERROR                     41170099
155029                                                                  41180099
155029         WHEN SQLCODE = ZERO                                      41190099
155029             CONTINUE                                             41200099
155029                                                                  41210099
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            41220099
155029         WHEN SQLCODE NOT EQUAL ZERO                              41230099
155029             DISPLAY '** ABEND **'                                41240099
155029             DISPLAY '** PROGRAM = TRKUP005 **'                   41250099
155029             DISPLAY '** PURCHS-PO-NBR     = ' PURCHS-PO-NBR      41260099
155029             DISPLAY '** POPRPK-PO-PREPK-ID= ' POPRPK-PO-PREPK-ID 41270099
155029             DISPLAY '** ALLPLN-DEST-NBR   = ' ALLPLN-DEST-NBR    41280099
155029             DISPLAY '** PARAGRAPH = 2521-SUM-SPLIT-QTY**'        41290099
155029             PERFORM 9100-SQL-ABEND                               41300099
155029     END-EVALUATE.                                                41310099
155029                                                                  41320099
139868******************************************************************41330099
139868* RETRIEVE THE TOTAL QUANTITY FOR THE OUTLET STORE                41340099
139868******************************************************************41350099
139868 2522-SUM-STORE-SPLIT-QTY.                                        41360099
139868                                                                  41370099
139868     EXEC SQL                                                     41380099
139868           SELECT SUM (ES.STR_DISTRO_QTY)                         41390099
139868             INTO :PA-TOTAL-CURR-SPLIT-QTY                        41400099
139868             FROM TMESTDS   ES                                    41410099
139868                , TPURITM   LN                                    41420099
139868             WHERE ES.PO_NBR         = :PURITM-PO-NBR             41430099
139868               AND ES.PO_NBR         =  LN.PO_NBR                 41440099
139868               AND ES.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         41450099
139868               AND ES.PO_LNE_NBR     =  LN.PO_LNE_NBR             41460099
139868               AND ES.STR_DISTRO_QTY >  0                         41470099
139868               AND LN.VER_STATUS_CDE = 'A'                        41480099
139868               AND LN.STATUS_CDE    IN ('AC', 'AP')               41490099
139868              WITH UR                                             41500099
139868     END-EXEC                                                     41510099
139868                                                                  41520099
139868     EVALUATE TRUE                                                41530099
139868         WHEN SQLCODE = ZERO                                      41540099
139868         WHEN SQLCODE = -305                                      41550099
139868                                                                  41560099
139868             IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                    41570099
139868             OR PA-TOTAL-CURR-SPLIT-QTY NOT NUMERIC               41580099
139868                 MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT        41590099
139868                 PERFORM 8710-MISSING-SPLIT-ERROR                 41600099
139868             ELSE                                                 41610099
139868                 SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE            41620099
139868             END-IF                                               41630099
139868                                                                  41640099
139868         WHEN SQLCODE = +100                                      41650099
139868             MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT            41660099
139868             PERFORM 8710-MISSING-SPLIT-ERROR                     41670099
139868                                                                  41680099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            41690099
139868         WHEN SQLCODE NOT EQUAL ZERO                              41700099
139868             DISPLAY '** ABEND **'                                41710099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   41720099
139868             DISPLAY '** PURITM-PO-NBR    = '  PURITM-PO-NBR      41730099
139868             DISPLAY '** PURITM-PO-LNE-NBR= '  PURITM-PO-LNE-NBR  41740099
139868             DISPLAY '** PARAGRAPH = 2522-SUM-STORE-SPLIT-QTY**'  41750099
139868             PERFORM 9100-SQL-ABEND                               41760099
139868     END-EVALUATE.                                                41770099
139868                                                                  41780099
357600******************************************************************41790099
357700 2524-COUNT-DCS-FOR-BULK.                                         41800099
357800*                                                                 41810099
357900     EXEC SQL                                                     41820099
358000           SELECT                                                 41830099
358100                  COUNT(DISTINCT AL.DEST_NBR)                     41840099
358200             INTO                                                 41850099
358300                  :PV-TOTAL-NBR-OF-DCS                            41860099
358400             FROM                                                 41870099
358500                  TALLPLN   AL                                    41880099
358600                , TPURITM   LN                                    41890099
358700             WHERE AL.PO_NBR         = :PURITM-PO-NBR             41900099
358800               AND AL.PO_NBR         =  LN.PO_NBR                 41910099
358900               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         41920099
359000               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             41930099
359100               AND AL.CURR_SPLIT_QTY >  0                         41940099
359200               AND LN.VER_STATUS_CDE = 'A'                        41950099
359300               AND LN.STATUS_CDE    IN ('AC', 'AP')               41960099
359400     END-EXEC                                                     41970099
359500                                                                  41980099
359600     EVALUATE TRUE                                                41990099
359700         WHEN SQLCODE = ZERO                                      42000099
359800*          ***************************************************    42010099
359900*          * IF THERE ARE MORE DCS THAN CARTONS, WE'VE GOT A      42020099
360000*          * PROBLEM AND WE DON'T WANT TO SEND THE SPLIT.         42030099
360100*          ***************************************************    42040099
360200           IF PV-UPC-CARTONS  <  PV-TOTAL-NBR-OF-DCS              42050099
360300             INITIALIZE                                           42060099
360400                 TR006-ERROR-MSG                                  42070099
360500             MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                   42080099
360600             MOVE SKXREF-SKU   TO TR006-SKU                       42090099
360700             SET TR006-ERROR-TYPE-ERROR       TO TRUE             42100099
360800             STRING 'CARTS < NBR DCS-FIX'                         42110099
360900                 DELIMITED BY SIZE                                42120099
361000                 INTO TR006-ERROR-MSG                             42130099
361100             PERFORM 8830-WRITE-ERROR-LINE                        42140099
361200             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                42150099
361300           ELSE                                                   42160099
361400             SET PS-COUNT-DCS-OK         TO TRUE                  42170099
361500           END-IF                                                 42180099
361600                                                                  42190099
361700         WHEN SQLCODE = +100                                      42200099
361800         WHEN SQLCODE = -305                                      42210099
361900             INITIALIZE        TR006-ERROR-MSG                    42220099
362000                               TR006-UPC-NBR                      42230099
362100                               TR006-SKU                          42240099
362200             STRING 'BULK PO MISSING SPLITS-FIX'                  42250099
362300                 DELIMITED BY SIZE                                42260099
362400             INTO TR006-ERROR-MSG                                 42270099
362500             PERFORM 8710-MISSING-SPLIT-ERROR                     42280099
362600                                                                  42290099
362700         WHEN SQLWARN0 NOT EQUAL SPACE                            42300099
362800         WHEN SQLCODE NOT EQUAL ZERO                              42310099
362900             DISPLAY '** ABEND **'                                42320099
363000             DISPLAY '** PROGRAM = TRKUP005 **'                   42330099
363100             DISPLAY '** PURITM-PO-NBR = ' PURITM-PO-NBR          42340099
363200             DISPLAY '** PURITM-PO-LNE-NBR = '                    42350099
363300                 PURITM-PO-LNE-NBR                                42360099
363400             DISPLAY '** PARAGRAPH = 2524-COUNT-DCS-FOR-BULK'     42370099
363500             PERFORM 9100-SQL-ABEND                               42380099
363600     END-EVALUATE.                                                42390099
363700                                                                  42400099
363800******************************************************************42410099
363900*2540-UPDATE-TALLPLN.                                             42420099
364000*                                                                 42430099
364100*        EXEC SQL                                                 42440099
364200*            UPDATE TALLPLN                                       42450099
364300*               SET DC_SPLIT_QTY    = :ALLPLN-CURR-SPLIT-QTY      42460099
364400*             WHERE PO_NBR          = :PURITM-PO-NBR              42470099
364500*               AND PO_LNE_NBR      = :PURITM-PO-LNE-NBR          42480099
364600*               AND PLAN_NBR        = :ALLPLN-PLAN-NBR            42490099
364700*        END-EXEC.                                                42500099
364800*                                                                 42510099
364900*    EVALUATE TRUE                                                42520099
365000*        WHEN SQLCODE = ZERO                                      42530099
365100*            CONTINUE                                             42540099
365200*                                                                 42550099
365300*        WHEN SQLCODE = +100                                      42560099
365400*            CONTINUE                                             42570099
365500*                                                                 42580099
365600*        WHEN SQLWARN0 NOT EQUAL SPACE                            42590099
365700*        WHEN SQLCODE NOT EQUAL ZERO                              42600099
365800*            DISPLAY '** ABEND **'                                42610099
365900*            DISPLAY '** PROGRAM = TRKUP005 **'                   42620099
366000*            DISPLAY '** PARAGRAPH = 2540-UPDATE-TALPLAN**'       42630099
366100*            PERFORM 9100-SQL-ABEND                               42640099
366200*    END-EVALUATE.                                                42650099
366300*                                                                 42660099
366400******************************************************************42670099
366500* IF A PO IS OK FOR TRANSMISSION - WRITE UNWRITTEN UPPER LEVEL    42680099
366600* RECORDS THAT RESIDE IN COPYBOOK TRRD020 AREA AND THEN WRITE THE 42690099
366700* LOWER LEVEL PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL 42700099
366800* PROGRAM TABLE.                                                  42710099
366900******************************************************************42720099
367000                                                                  42730099
367100 3000-WRITE-OUT-GOOD-PO-RECS.                                     42740099
367200                                                                  42750099
367300     IF PS-POE-WRITTEN-NO                                         42760099
367400       PERFORM 5100-WRITE-POE-RECORD                              42770099
367500       SET PS-POE-WRITTEN TO TRUE                                 42780099
367600     END-IF.                                                      42790099
367700                                                                  42800099
367800     IF PS-ETA-WRITTEN-NO                                         42810099
367900       PERFORM 5000-WRITE-ETA-RECORD                              42820099
368000       SET PS-ETA-WRITTEN TO TRUE                                 42830099
368100     END-IF.                                                      42840099
368200                                                                  42850099
368300     IF PS-VES-WRITTEN-NO                                         42860099
368400       PERFORM 5200-WRITE-VES-RECORD                              42870099
368500       SET PS-VES-WRITTEN TO TRUE                                 42880099
368600     END-IF.                                                      42890099
368700                                                                  42900099
368800     IF PS-CON-WRITTEN-NO                                         42910099
368900       PERFORM 5300-WRITE-CON-RECORD                              42920099
369000       SET PS-CON-WRITTEN TO TRUE                                 42930099
369100     END-IF.                                                      42940099
369200                                                                  42950099
369300     SET EXT-INDEX TO +1.                                         42960099
369400     SET PS-EOT-EXTRACT-NO  TO TRUE.                              42970099
369500     PERFORM 3100-UNLOAD-EXT-TABLE                                42980099
369600         UNTIL  PS-EOT-EXTRACT                                    42990099
369700            OR EXT-INDEX > PC-EXTRACT-TBL-LIMIT.                  43000099
369800                                                                  43010099
369900******************************************************************43020099
370000* IF A PO IS OK FOR RETRANSMISSION - WRITE UNWRITTEN UPPER LEVEL  43030099
370100* RECORDS PLUS PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL43040099
370200* PROGRAM TABLE.                                                  43050099
370300******************************************************************43060099
370400                                                                  43070099
370500 3100-UNLOAD-EXT-TABLE.                                           43080099
370600                                                                  43090099
370700     EVALUATE TRUE                                                43100099
370800                                                                  43110099
370900         WHEN PV-TBL-EXT-ROW (EXT-INDEX) = SPACES                 43120099
371000                                                                  43130099
371100            SET PS-EOT-EXTRACT TO TRUE                            43140099
371200                                                                  43150099
371300         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PO '                 43160099
371400                                                                  43170099
371500            PERFORM 3110-PO-EXTRACT-AND-DETAIL                    43180099
371600            SET EXT-INDEX UP BY +1                                43190099
371700                                                                  43200099
371800         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'INS'                 43210099
371900                                                                  43220099
372000            PERFORM 3120-INS-EXTRACT-AND-DETAIL                   43230099
372100            SET EXT-INDEX UP BY +1                                43240099
372200                                                                  43250099
372300         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PCK'                 43260099
372400                                                                  43270099
372500            PERFORM 3130-PCK-EXTRACT-AND-DETAIL                   43280099
372600            SET EXT-INDEX UP BY +1                                43290099
372700                                                                  43300099
372800         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'UPC'                 43310099
372900                                                                  43320099
373000            PERFORM 3140-UPC-EXTRACT-AND-DETAIL                   43330099
373100            SET EXT-INDEX UP BY +1                                43340099
373200                                                                  43350099
373300         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PDC'                 43360099
373400                                                                  43370099
373500*           ***********************************                   43380099
373600*           * ONLY CREATE EXTRACT & DETAIL DC *                   43390099
373700*           * RECS IF SPLITS ENTERED.         *                   43400099
373800*           ***********************************                   43410099
373900            IF PS-SPLITS-ENTERED                                  43420099
374000               PERFORM 3150-PDC-EXTRACT-AND-DETAIL                43430099
374100            END-IF                                                43440099
374200            SET EXT-INDEX UP BY +1                                43450099
374300                                                                  43460099
374400         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'DC '                 43470099
374500                                                                  43480099
374600            IF PS-SPLITS-ENTERED                                  43490099
374700               PERFORM 3160-DC-EXTRACT-AND-DETAIL                 43500099
374800            END-IF                                                43510099
374900            SET EXT-INDEX UP BY +1                                43520099
375000                                                                  43530099
375100         WHEN OTHER                                               43540099
375200                                                                  43550099
375300            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    43560099
375400            DISPLAY  '&& TABLE ERROR                       &&'    43570099
375500            DISPLAY  '&& FOUND REC TYPE  - '                      43580099
375600                               PV-TBL-EXT-TYPE (EXT-INDEX)        43590099
375700            DISPLAY                          '             &&'    43600099
375800            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    43610099
375900                                                                  43620099
376000            SET EXT-INDEX UP BY +1                                43630099
376100                                                                  43640099
376200     END-EVALUATE.                                                43650099
376300                                                                  43660099
376400******************************************************************43670099
376500* PO  DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *43680099
376600******************************************************************43690099
376700                                                                  43700099
376800 3110-PO-EXTRACT-AND-DETAIL.                                      43710099
376900                                                                  43720099
377000     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PO         43730099
377100                                        OUTTR2-TRGL-EDI-PO-ODR.   43740099
377200     PERFORM 6000-INSERT-EXTRACT-REC.                             43750099
377300*    ******************************************************       43760099
377400*    * FOR PO'S WHERE SPLITS WERE ALREADY SENT ON ANOTHER *       43770099
377500*    * CONTAINER, DON'T WRITE THE REPORT RECORDS.         *       43780099
377600*    ******************************************************       43790099
377700     IF PS-PO-ALREADY-SENT                                        43800099
377800         CONTINUE                                                 43810099
377900     ELSE                                                         43820099
378000*        *************************************************        43830099
378100*        * A CON RECORD IS WRITTEN TO THE REPORT DETAIL  *        43840099
378200*        * FILE FOR EACH PO BECAUSE REPORTING IS BY PO,  *        43850099
378300*        * NOT CONTAINER.                                *        43860099
378400*        *************************************************        43870099
378500         PERFORM 8856-WRITE-DTL-RPT-CON-RECORD                    43880099
378600         PERFORM 8850-WRITE-DTL-RPT-PO-RECORD                     43890099
378700     END-IF.                                                      43900099
378800                                                                  43910099
378900******************************************************************43920099
379000* INS DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *43930099
379100******************************************************************43940099
379200                                                                  43950099
379300 3120-INS-EXTRACT-AND-DETAIL.                                     43960099
379400                                                                  43970099
379500     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-INS        43980099
379600                                        OUTTR2-TRGL-EDI-PO-ODR.   43990099
379700     PERFORM 6000-INSERT-EXTRACT-REC.                             44000099
379800     PERFORM 8852-WRITE-DTL-RPT-INS-RECORD.                       44010099
379900                                                                  44020099
380000******************************************************************44030099
380100* PCK DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *44040099
380200******************************************************************44050099
380300                                                                  44060099
380400 3130-PCK-EXTRACT-AND-DETAIL.                                     44070099
380500                                                                  44080099
380600     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PCK        44090099
380700                                        OUTTR2-TRGL-EDI-PO-ODR.   44100099
380800     PERFORM 6000-INSERT-EXTRACT-REC.                             44110099
380900     PERFORM 8847-WRITE-DTL-RPT-PCK-RECORD.                       44120099
381000                                                                  44130099
381100******************************************************************44140099
381200* UPC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *44150099
381300******************************************************************44160099
381400                                                                  44170099
381500 3140-UPC-EXTRACT-AND-DETAIL.                                     44180099
381600                                                                  44190099
381700     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-UPC        44200099
381800                                        OUTTR2-TRGL-EDI-PO-ODR.   44210099
381900     PERFORM 6000-INSERT-EXTRACT-REC.                             44220099
382000     PERFORM 8854-WRITE-DTL-RPT-UPC-RECORD.                       44230099
382100                                                                  44240099
382200******************************************************************44250099
382300* PDC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *44260099
382400******************************************************************44270099
382500                                                                  44280099
382600 3150-PDC-EXTRACT-AND-DETAIL.                                     44290099
382700                                                                  44300099
382800     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PDC        44310099
382900                                        OUTTR2-TRGL-EDI-PO-ODR.   44320099
383000     PERFORM 6000-INSERT-EXTRACT-REC.                             44330099
383100     PERFORM 8848-WRITE-DTL-RPT-PDC-RECORD.                       44340099
383200                                                                  44350099
383300******************************************************************44360099
383400* DC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT   *44370099
383500******************************************************************44380099
383600                                                                  44390099
383700 3160-DC-EXTRACT-AND-DETAIL.                                      44400099
383800                                                                  44410099
383900     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-DC         44420099
384000                                        OUTTR2-TRGL-EDI-PO-ODR.   44430099
384100     PERFORM 6000-INSERT-EXTRACT-REC.                             44440099
384200     PERFORM 8870-WRITE-DTL-RPT-DC-RECORD.                        44450099
384300                                                                  44460099
384400******************************************************************44470099
384500* INSERT A COPY OF THE SHPTPO ROW TO THE AUDIT TRAIL TABLE       *44480099
384600* AFTER UPDATING THE SHPTPO TABLE.                               *44490099
384700******************************************************************44500099
384800 4000-CREATE-SHPTPO-AUDIT-TRAIL.                                  44510099
384900                                                                  44520099
385000         EXEC SQL                                                 44530099
385100             SELECT SHIPT_ID,                                     44540099
385200                    PO_NBR,                                       44550099
385300                    REC_SEQ_NBR,                                  44560099
385400                    EXPTED_CART_CNT,                              44570099
385500                    ACTL_CART_CNT,                                44580099
385600                    DMG_CART_CNT,                                 44590099
385700                    PKSL_IND,                                     44600099
385800                    VEND_NAME,                                    44610099
385900                    FRGT_CHG_AMT,                                 44620099
386000                    LAST_UPD_PGM_ID,                              44630099
386100                    CRE_USER_ID,                                  44640099
386200                    CARR_CART_CT,                                 44650099
386300                    CARR_LAST_UPD_DTE,                            44660099
386400                    CARR_LAST_UPD_TIME,                           44670099
386500                    VEND_CART_CT,                                 44680099
386600                    VEND_LAST_UPD_DTE,                            44690099
386700                    VEND_LAST_UPD_TIME,                           44700099
386800                    CRE_TMST,                                     44710099
386900                    LAST_UPD_DTE,                                 44720099
387000                    LAST_UPD_TIME,                                44730099
387100                    LAST_UPD_USER_ID,                             44740099
387200                    PRIM_SHIPT_IND,                               44750099
387300                    SPLT_XMIT_IND,                                44760099
387400                    SPLT_XMIT_DTE,                                44770099
387500                    SPLT_XMIT_TM                                  44780099
387600               INTO :SHPTPO-SHIPT-ID,                             44790099
387700                    :SHPTPO-PO-NBR,                               44800099
387800                    :SHPTPO-REC-SEQ-NBR,                          44810099
387900                    :SHPTPO-EXPTED-CART-CNT,                      44820099
388000                    :SHPTPO-ACTL-CART-CNT,                        44830099
388100                    :SHPTPO-DMG-CART-CNT,                         44840099
388200                    :SHPTPO-PKSL-IND,                             44850099
388300                    :SHPTPO-VEND-NAME,                            44860099
388400                    :SHPTPO-FRGT-CHG-AMT,                         44870099
388500                    :SHPTPO-LAST-UPD-PGM-ID,                      44880099
388600                    :SHPTPO-CRE-USER-ID,                          44890099
388700                    :SHPTPO-CARR-CART-CT,                         44900099
388800                    :SHPTPO-CARR-LAST-UPD-DTE,                    44910099
388900                    :SHPTPO-CARR-LAST-UPD-TIME,                   44920099
389000                    :SHPTPO-VEND-CART-CT,                         44930099
389100                    :SHPTPO-VEND-LAST-UPD-DTE,                    44940099
389200                    :SHPTPO-VEND-LAST-UPD-TIME,                   44950099
389300                    :SHPTPO-CRE-TMST,                             44960099
389400                    :SHPTPO-LAST-UPD-DTE,                         44970099
389500                    :SHPTPO-LAST-UPD-TIME,                        44980099
389600                    :SHPTPO-LAST-UPD-USER-ID,                     44990099
389700                    :SHPTPO-PRIM-SHIPT-IND,                       45000099
389800                    :SHPTPO-SPLT-XMIT-IND,                        45010099
389900                    :SHPTPO-SPLT-XMIT-DTE,                        45020099
390000                    :SHPTPO-SPLT-XMIT-TM                          45030099
390100               FROM TSHPTPO                                       45040099
390200              WHERE SHIPT_ID         = :SHIPMT-SHIPT-ID           45050099
390300                AND PO_NBR           = :SHPTPO-PO-NBR             45060099
390400         END-EXEC                                                 45070099
390500                                                                  45080099
390600         EVALUATE TRUE                                            45090099
390700         WHEN SQLCODE = ZERO                                      45100099
390800              CONTINUE                                            45110099
390900                                                                  45120099
391000         WHEN SQLCODE = +100                                      45130099
391100             DISPLAY '*****************************************'  45140099
391200             DISPLAY '4000-CREATE-SHPTPO-AUDIT-TRAIL'             45150099
391300             DISPLAY 'WHEN INSERTING ROW TO TAUSHPO, AUDIT TRAIL' 45160099
391400             DISPLAY 'FOR TSHPTPO, RETURNED A NOT FOUND +100'     45170099
391500             DISPLAY 'SHIPMT-SHIPT-ID = ' SHIPMT-SHIPT-ID         45180099
391600             DISPLAY 'SHIPTPO-PO-NBR  = ' SHPTPO-PO-NBR           45190099
391700             DISPLAY '*****************************************'  45200099
391800                                                                  45210099
391900                                                                  45220099
392000         WHEN SQLWARN0 NOT EQUAL SPACE                            45230099
392100         WHEN SQLCODE NOT EQUAL ZERO                              45240099
392200             DISPLAY '** ABEND **'                                45250099
392300             DISPLAY '** PROGRAM = TRKUP005 **'                   45260099
392400             DISPLAY '** PARAGRAPH = 4000-CREATE-SHPTPO-AUD**'    45270099
392500             DISPLAY '** SELECT TSHPTPO'                          45280099
392600             PERFORM 9100-SQL-ABEND                               45290099
392700         END-EVALUATE                                             45300099
392800                                                                  45310099
392900                                                                  45320099
393000         EXEC SQL                                                 45330099
393100             INSERT INTO TAUSHPO                                  45340099
393200                   (SHIPT_ID,                                     45350099
393300                    PO_NBR,                                       45360099
393400                    REC_SEQ_NBR,                                  45370099
393500                    EXPTED_CART_CNT,                              45380099
393600                    ACTL_CART_CNT,                                45390099
393700                    DMG_CART_CNT,                                 45400099
393800                    PKSL_IND,                                     45410099
393900                    VEND_NAME,                                    45420099
394000                    FRGT_CHG_AMT,                                 45430099
394100                    LAST_UPD_PGM_ID,                              45440099
394200                    CRE_USER_ID,                                  45450099
394300                    CARR_CART_CT,                                 45460099
394400                    CARR_LAST_UPD_DTE,                            45470099
394500                    CARR_LAST_UPD_TIME,                           45480099
394600                    VEND_CART_CT,                                 45490099
394700                    VEND_LAST_UPD_DTE,                            45500099
394800                    VEND_LAST_UPD_TIME,                           45510099
394900                    CRE_TMST,                                     45520099
395000                    LAST_UPD_DTE,                                 45530099
395100                    LAST_UPD_TIME,                                45540099
395200                    LAST_UPD_USER_ID,                             45550099
395300                    PRIM_SHIPT_IND,                               45560099
395400                    SPLT_XMIT_IND,                                45570099
395500                    SPLT_XMIT_DTE,                                45580099
395600                    SPLT_XMIT_TM,                                 45590099
395700                    TRN_CDE )                                     45600099
395800             VALUES                                               45610099
395900                  (:SHPTPO-SHIPT-ID,                              45620099
396000                   :SHPTPO-PO-NBR,                                45630099
396100                   :SHPTPO-REC-SEQ-NBR,                           45640099
396200                   :SHPTPO-EXPTED-CART-CNT,                       45650099
396300                   :SHPTPO-ACTL-CART-CNT,                         45660099
396400                   :SHPTPO-DMG-CART-CNT,                          45670099
396500                   :SHPTPO-PKSL-IND,                              45680099
396600                   :SHPTPO-VEND-NAME,                             45690099
396700                   :SHPTPO-FRGT-CHG-AMT,                          45700099
396800                   :SHPTPO-LAST-UPD-PGM-ID,                       45710099
396900                   :SHPTPO-CRE-USER-ID,                           45720099
397000                   :SHPTPO-CARR-CART-CT,                          45730099
397100                   :SHPTPO-CARR-LAST-UPD-DTE,                     45740099
397200                   :SHPTPO-CARR-LAST-UPD-TIME,                    45750099
397300                   :SHPTPO-VEND-CART-CT,                          45760099
397400                   :SHPTPO-VEND-LAST-UPD-DTE,                     45770099
397500                   :SHPTPO-VEND-LAST-UPD-TIME,                    45780099
397600                   :SHPTPO-CRE-TMST,                              45790099
397700                   :SHPTPO-LAST-UPD-DTE,                          45800099
397800                   :SHPTPO-LAST-UPD-TIME,                         45810099
397900                   :SHPTPO-LAST-UPD-USER-ID,                      45820099
398000                   :SHPTPO-PRIM-SHIPT-IND,                        45830099
398100                   :SHPTPO-SPLT-XMIT-IND,                         45840099
398200                   :SHPTPO-SPLT-XMIT-DTE,                         45850099
398300                   :SHPTPO-SPLT-XMIT-TM,                          45860099
398400                   :PC-U )                                        45870099
398500         END-EXEC                                                 45880099
398600                                                                  45890099
398700         EVALUATE TRUE                                            45900099
398800                                                                  45910099
398900         WHEN SQLCODE = ZERO                                      45920099
399000              CONTINUE                                            45930099
399100                                                                  45940099
399200         WHEN SQLWARN0 NOT EQUAL SPACE                            45950099
399300         WHEN SQLCODE NOT EQUAL ZERO                              45960099
399400                 DISPLAY '** ABEND **'                            45970099
399500                 DISPLAY '** PROGRAM = TRKUP005 **'               45980099
399600                 DISPLAY '** PARAGRAPH = 4000-CREATE-SHPTPO-AUD**'45990099
399700                 DISPLAY '** INSERT INTO TAUSHPO'                 46000099
399800                 PERFORM 9100-SQL-ABEND                           46010099
399900         END-EVALUATE.                                            46020099
400000                                                                  46030099
400100******************************************************************46040099
400200* INSERT A COPY OF THE SHPTPO ROW TO THE AUDIT TRAIL TABLE       *46050099
400300* AFTER INSERTING THE SHPTPO TABLE.                              *46060099
400400******************************************************************46070099
400500 4100-CREATE-VHTRIP-AUDIT-TRAIL.                                  46080099
400600                                                                  46090099
400700         EXEC SQL                                                 46100099
400800             SELECT OWNER_SCAC_ID,                                46110099
400900                    VEH_NBR,                                      46120099
401000                    TRIP_ID,                                      46130099
401100                    TRIP_BEG_DTE,                                 46140099
401200                    TRIP_BEG_TME,                                 46150099
401300                    CRT_SRC_CDE,                                  46160099
401400                    LAST_UPD_DTE,                                 46170099
401500                    LAST_UPD_TME,                                 46180099
401600                    LAST_UPD_UID,                                 46190099
401700                    MANIFEST_NBR,                                 46200099
401800                    PLND_TRIP_SEQ,                                46210099
401900                    PLND_ACTVY_CDE,                               46220099
402000                    OWNR_SCAC_SHIP_DTE,                           46230099
402100                    REF_TRIP_ID,                                  46240099
402200                    EST_AR_TMST,                                  46250099
402300                    SPLT_XMIT_IND,                                46260099
402400                    SPLT_XMIT_DTE,                                46270099
402500                    SPLT_XMIT_TM                                  46280099
402600               INTO :VHTRIP-OWNER-SCAC-ID,                        46290099
402700                    :VHTRIP-VEH-NBR  :PV-VHTRIP-VEH-NBR-NULL,     46300099
402800                    :VHTRIP-TRIP-ID,                              46310099
402900                    :VHTRIP-TRIP-BEG-DTE,                         46320099
403000                    :VHTRIP-TRIP-BEG-TME,                         46330099
403100                    :VHTRIP-CRT-SRC-CDE,                          46340099
403200                    :VHTRIP-LAST-UPD-DTE,                         46350099
403300                    :VHTRIP-LAST-UPD-TME,                         46360099
403400                    :VHTRIP-LAST-UPD-UID,                         46370099
403500                    :VHTRIP-MANIFEST-NBR,                         46380099
403600                    :VHTRIP-PLND-TRIP-SEQ,                        46390099
403700                    :VHTRIP-PLND-ACTVY-CDE,                       46400099
403800                    :VHTRIP-OWNR-SCAC-SHIP-DTE,                   46410099
403900                    :VHTRIP-REF-TRIP-ID,                          46420099
404000                    :VHTRIP-EST-AR-TMST   :PV-VHTRIP-EST-AR-NULL, 46430099
404100                    :VHTRIP-SPLT-XMIT-IND,                        46440099
404200                    :VHTRIP-SPLT-XMIT-DTE,                        46450099
404300                    :VHTRIP-SPLT-XMIT-TM                          46460099
404400               FROM TVHTRIP                                       46470099
404500              WHERE TRIP_ID = :VHTRIP-TRIP-ID                     46480099
404600         END-EXEC                                                 46490099
404700                                                                  46500099
404800         EVALUATE TRUE                                            46510099
404900         WHEN SQLCODE = ZERO                                      46520099
405000             CONTINUE                                             46530099
405100                                                                  46540099
405200         WHEN SQLCODE = +100                                      46550099
405300             DISPLAY '*****************************************'  46560099
405400             DISPLAY '4100-CREATE-VHTRIP-AUDIT-TRAIL'             46570099
405500             DISPLAY 'WHEN INSERTING ROW TO TAUTRIP, AUDIT TRAIL' 46580099
405600             DISPLAY 'FOR TVHTRIP, RETURNED A NOT FOUND +100'     46590099
405700             DISPLAY 'VHTRIP-TRIP-ID = ' VHTRIP-TRIP-ID           46600099
405800             DISPLAY '*****************************************'  46610099
405900                                                                  46620099
406000                                                                  46630099
406100         WHEN SQLWARN0 NOT EQUAL SPACE                            46640099
406200         WHEN SQLCODE NOT EQUAL ZERO                              46650099
406300                 DISPLAY '** ABEND **'                            46660099
406400                 DISPLAY '** PROGRAM = TRKUP005 **'               46670099
406500                 DISPLAY '** PARAGRAPH = 4100-CREATE-VHTRIP-AUD**'46680099
406600                 DISPLAY '** SELECT TVHTRIP'                      46690099
406700                 PERFORM 9100-SQL-ABEND                           46700099
406800         END-EVALUATE                                             46710099
406900                                                                  46720099
407000         EXEC SQL                                                 46730099
407100             INSERT INTO TAUTRIP                                  46740099
407200                   (OWNER_SCAC_ID,                                46750099
407300                    VEH_NBR,                                      46760099
407400                    TRIP_ID,                                      46770099
407500                    TRIP_BEG_DTE,                                 46780099
407600                    TRIP_BEG_TME,                                 46790099
407700                    CRT_SRC_CDE,                                  46800099
407800                    LAST_UPD_DTE,                                 46810099
407900                    LAST_UPD_TME,                                 46820099
408000                    LAST_UPD_UID,                                 46830099
408100                    MANIFEST_NBR,                                 46840099
408200                    PLND_TRIP_SEQ,                                46850099
408300                    PLND_ACTVY_CDE,                               46860099
408400                    OWNR_SCAC_SHIP_DTE,                           46870099
408500                    REF_TRIP_ID,                                  46880099
408600                    EST_AR_TMST,                                  46890099
408700                    AUD_STATUS_CDE,                               46900099
408800                    SPLT_XMIT_IND,                                46910099
408900                    SPLT_XMIT_DTE,                                46920099
409000                    SPLT_XMIT_TM )                                46930099
409100             VALUES                                               46940099
409200                  (:VHTRIP-OWNER-SCAC-ID,                         46950099
409300                   :VHTRIP-VEH-NBR  :PV-VHTRIP-VEH-NBR-NULL,      46960099
409400                   :VHTRIP-TRIP-ID,                               46970099
409500                   :VHTRIP-TRIP-BEG-DTE,                          46980099
409600                   :VHTRIP-TRIP-BEG-TME,                          46990099
409700                   :VHTRIP-CRT-SRC-CDE,                           47000099
409800                   :VHTRIP-LAST-UPD-DTE,                          47010099
409900                   :VHTRIP-LAST-UPD-TME,                          47020099
410000                   :VHTRIP-LAST-UPD-UID,                          47030099
410100                   :VHTRIP-MANIFEST-NBR,                          47040099
410200                   :VHTRIP-PLND-TRIP-SEQ,                         47050099
410300                   :VHTRIP-PLND-ACTVY-CDE,                        47060099
410400                   :VHTRIP-OWNR-SCAC-SHIP-DTE,                    47070099
410500                   :VHTRIP-REF-TRIP-ID,                           47080099
410600                   :VHTRIP-EST-AR-TMST   :PV-VHTRIP-EST-AR-NULL,  47090099
410700                   :TRIPST-TRIP-STATUS-CDE,                       47100099
410800                   :VHTRIP-SPLT-XMIT-IND,                         47110099
410900                   :VHTRIP-SPLT-XMIT-DTE ,                        47120099
411000                   :VHTRIP-SPLT-XMIT-TM )                         47130099
411100         END-EXEC                                                 47140099
411200                                                                  47150099
411300         EVALUATE TRUE                                            47160099
411400         WHEN SQLCODE = ZERO                                      47170099
411500              CONTINUE                                            47180099
411600                                                                  47190099
411700         WHEN SQLWARN0 NOT EQUAL SPACE                            47200099
411800         WHEN SQLCODE NOT EQUAL ZERO                              47210099
411900             DISPLAY '** ABEND **'                                47220099
412000             DISPLAY '** PROGRAM = TRKUP005 **'                   47230099
412100             DISPLAY '** PARAGRAPH = 4100-CREATE-VHTRIP-AUD**'    47240099
412200             DISPLAY '** INSERT INTO TAUTRIP'                     47250099
412300             PERFORM 9100-SQL-ABEND                               47260099
412400         END-EVALUATE.                                            47270099
412500                                                                  47280099
412600*----------------------------------------------------------------*47290099
412700*    CHECK TO SEE IF A CHECKPOINT SHOULD BE TAKEN.               *47300099
412800*----------------------------------------------------------------*47310099
412900 4400-CHECKPOINT-CHECK.                                           47320099
413000                                                                  47330099
413100     EXEC SQL                                                     47340099
413200       SET :PV-TMST = CURRENT TIMESTAMP                           47350099
413300     END-EXEC.                                                    47360099
413400                                                                  47370099
413500     EVALUATE TRUE                                                47380099
413600         WHEN SQLWARN0 NOT EQUAL SPACE                            47390099
413700         WHEN SQLCODE NOT EQUAL ZERO                              47400099
413800             DISPLAY '** ABEND **'                                47410099
413900             DISPLAY '** PROGRAM = TRKUP005 **'                   47420099
414000             DISPLAY '** PARAGRAPH = 4400-CHEKPOINT-CHECK**'      47430099
414100             DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'          47440099
414200             PERFORM 9100-SQL-ABEND                               47450099
414300     END-EVALUATE.                                                47460099
414400                                                                  47470099
414500     IF PV-TMST > PV-HOLD-TMST                                    47480099
414600        IF PS-COMMITS-TAKEN                                       47490099
414700            CONTINUE                                              47500099
414800        ELSE                                                      47510099
414900            MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE          47520099
415000            PERFORM 6570-UPDATE-TCKRSTCNTL                        47530099
415100            SET PS-COMMITS-TAKEN   TO TRUE                        47540099
415200        END-IF                                                    47550099
415300        PERFORM 6580-UPDATE-TCKRSTINF                             47560099
415400        PERFORM 4500-COMMIT                                       47570099
415500        DISPLAY 'COMMIT TAKEN AT '                                47580099
415600        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)47590099
415700         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)47600099
415800        PERFORM 4600-SET-CHECKPOINT-TIME                          47610099
415900     END-IF.                                                      47620099
416000                                                                  47630099
416100 EJECT                                                            47640099
416200******************************************************************47650099
416300* EXECUTES AN SQL COMMIT AFTER ALL TABLES FOR TRIP ARE UPDATED.   47660099
416400******************************************************************47670099
416500 4500-COMMIT.                                                     47680099
416600                                                                  47690099
416700     EXEC SQL                                                     47700099
416800         COMMIT                                                   47710099
416900     END-EXEC.                                                    47720099
417000                                                                  47730099
417100     EVALUATE TRUE                                                47740099
417200         WHEN SQLWARN0 NOT EQUAL SPACE                            47750099
417300         WHEN SQLCODE NOT EQUAL ZERO                              47760099
417400       DISPLAY '***********CHECKPOINT*************'               47770099
417500          DISPLAY 'SHPTPO-PO-NBR = ' SHPTPO-PO-NBR                47780099
417600          DISPLAY 'SHIPMT-SHIPT-ID = ' SHIPMT-SHIPT-ID            47790099
417700          DISPLAY 'VHTRIP-TRIP-ID = ' VHTRIP-TRIP-ID              47800099
417800          DISPLAY 'TVTRIP-VEH-NBR = '    VHTRIP-VEH-NBR           47810099
417900          DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                  47820099
418000              PA-TOTAL-OUTPUT-REC-COUNT                           47830099
418100          DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT              47840099
418200          DISPLAY '**********************************'            47850099
418300                                                                  47860099
418400             DISPLAY '** ABEND **'                                47870099
418500             DISPLAY '** PROGRAM = TRKUP005 **'                   47880099
418600             DISPLAY '** PARAGRAPH = 4500-COMMIT**'               47890099
418700             DISPLAY '**UNSUCCESSFUL COMMIT**'                    47900099
418800             PERFORM 9100-SQL-ABEND                               47910099
418900     END-EVALUATE.                                                47920099
419000 EJECT                                                            47930099
419100******************************************************************47940099
419200* SET THE TIME FOR THE NEXT CHECKPOINT.                           47950099
419300******************************************************************47960099
419400 4600-SET-CHECKPOINT-TIME.                                        47970099
419500                                                                  47980099
419600      EXEC SQL                                                    47990099
419700          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    48000099
419800          INTO :PV-HOLD-TMST                                      48010099
419900          FROM TCKRSTCNTL                                         48020099
420000          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              48030099
420100      END-EXEC.                                                   48040099
420200                                                                  48050099
420300     EVALUATE TRUE                                                48060099
420400         WHEN SQLWARN0 NOT EQUAL SPACE                            48070099
420500         WHEN SQLCODE NOT EQUAL ZERO                              48080099
420600             DISPLAY '** ABEND **'                                48090099
420700             DISPLAY '** PROGRAM = TRKUP005 **'                   48100099
420800             DISPLAY '** PARAGRAPH = 4600-SET-CHECKPOINT-TIME**'  48110099
420900             DISPLAY '**UNSUCESSFUL SET OF CHECKPOINT INTERVAL**' 48120099
421000             PERFORM 9100-SQL-ABEND                               48130099
421100     END-EVALUATE.                                                48140099
421200 EJECT                                                            48150099
421300******************************************************************48160099
421400* WRITE ESTIMATE TIME OF ARRIVAL RECORD TYPE FOR VESSEL EXTRACT  *48170099
421500* FILE                                                           *48180099
421600******************************************************************48190099
421700 5000-WRITE-ETA-RECORD.                                           48200099
421800                                                                  48210099
421900     MOVE 'ETA'   TO TR004-REC-TYPE-CDE-ETA.                      48220099
422000     MOVE TR004-REC-TYPE-ETA      TO                              48230099
422100         OUTTR2-TRGL-EDI-PO-ODR.                                  48240099
422200                                                                  48250099
422300     PERFORM 6000-INSERT-EXTRACT-REC.                             48260099
422400                                                                  48270099
422500******************************************************************48280099
422600* WRITE PORT OF ENTRY RECORD TYPE FOR EXTRACT FILE.              *48290099
422700******************************************************************48300099
422800 5100-WRITE-POE-RECORD.                                           48310099
422900                                                                  48320099
423000     MOVE 'POE'   TO TR004-REC-TYPE-CDE-POE.                      48330099
423100     MOVE TR004-REC-TYPE-POE      TO                              48340099
423200         OUTTR2-TRGL-EDI-PO-ODR.                                  48350099
423300                                                                  48360099
423400     PERFORM 6000-INSERT-EXTRACT-REC.                             48370099
423500                                                                  48380099
423600******************************************************************48390099
423700* WRITE VESSEL RECORD TYPE FOR EXTRACT FILE.                     *48400099
423800******************************************************************48410099
423900 5200-WRITE-VES-RECORD.                                           48420099
424000                                                                  48430099
424100     MOVE 'VES'     TO TR004-REC-TYPE-CDE-VES.                    48440099
424200     MOVE TR004-REC-TYPE-VES      TO                              48450099
424300         OUTTR2-TRGL-EDI-PO-ODR.                                  48460099
424400                                                                  48470099
424500     PERFORM 6000-INSERT-EXTRACT-REC.                             48480099
424600                                                                  48490099
424700******************************************************************48500099
424800* WRITE CONTAINER RECORD TYPE FOR EXTRACT FILE.                  *48510099
424900******************************************************************48520099
425000 5300-WRITE-CON-RECORD.                                           48530099
425100                                                                  48540099
425200     SET TR004-REC-TYPE-CDE-CON        TO TRUE.                   48550099
425300     MOVE TR004-REC-TYPE-CONTAINER  TO                            48560099
425400         OUTTR2-TRGL-EDI-PO-ODR.                                  48570099
425500                                                                  48580099
425600     PERFORM 6000-INSERT-EXTRACT-REC.                             48590099
425700                                                                  48600099
425800******************************************************************48610099
425900* WRITE PO RECORD TYPE FOR EXTRACT FILE.                         *48620099
426000******************************************************************48630099
426100 5400-WRITE-PO-RECORD.                                            48640099
426200                                                                  48650099
426300     MOVE 'PO '     TO TR004-REC-TYPE-CDE-PO.                     48660099
426400     MOVE TR004-REC-TYPE-PO     TO PV-TBL-EXT-ROW (EXT-INDEX).    48670099
426500     PERFORM 5900-CHECK-OVERFLOW.                                 48680099
426600                                                                  48690099
426700******************************************************************48700099
426800* WRITE INSTRUCTION RECORD TYPE FOR EXTRACT FILE.                *48710099
426900******************************************************************48720099
427000 5500-WRITE-INS-REC.                                              48730099
427100                                                                  48740099
427200     MOVE 'INS'     TO TR004-REC-TYPE-CDE-INS.                    48750099
427300     MOVE TR004-REC-TYPE-INS    TO PV-TBL-EXT-ROW (EXT-INDEX).    48760099
427400     PERFORM 5900-CHECK-OVERFLOW.                                 48770099
427500                                                                  48780099
427600******************************************************************48790099
427700* WRITE PURCHASE ORDER LINE RECORD TYPE FOR EXTRACT FILE.        *48800099
427800******************************************************************48810099
427900 5600-WRITE-UPC-REC.                                              48820099
428000                                                                  48830099
428100     MOVE 'UPC'    TO TR004-REC-TYPE-CDE-UPC.                     48840099
428200     MOVE TR004-REC-TYPE-UPC    TO PV-TBL-EXT-ROW (EXT-INDEX).    48850099
428300     PERFORM 5900-CHECK-OVERFLOW.                                 48860099
428400                                                                  48870099
428500******************************************************************48880099
428600* WRITE DISTRIBUTION CENTER RECORD TYPE FOR EXTRACT FILE.        *48890099
428700******************************************************************48900099
428800 5700-WRITE-DC-RECORD.                                            48910099
428900                                                                  48920099
429000     MOVE 'DC '    TO TR004-REC-TYPE-CDE-DC.                      48930099
429100     MOVE TR004-REC-TYPE-DC     TO PV-TBL-EXT-ROW (EXT-INDEX).    48940099
429200     PERFORM 5900-CHECK-OVERFLOW.                                 48950099
429300                                                                  48960099
429400******************************************************************48970099
429500* WRITE PACK RECORD TYPE (PCK) FOR EXTRACT FILE.                 *48980099
429600******************************************************************48990099
429700 5755-WRITE-PCK-REC.                                              49000099
429800                                                                  49010099
429900     MOVE 'PCK'    TO TR004-REC-TYPE-CDE-PCK.                     49020099
430000     MOVE TR004-REC-TYPE-PCK    TO PV-TBL-EXT-ROW (EXT-INDEX).    49030099
430100     PERFORM 5900-CHECK-OVERFLOW.                                 49040099
430200                                                                  49050099
430300******************************************************************49060099
430400* WRITE PACK DC (PDC) RECORD TYPE FOR EXTRACT FILE.              *49070099
430500******************************************************************49080099
430600 5756-WRITE-PDC-REC.                                              49090099
430700                                                                  49100099
155029     IF TR004-PDC-DIST-CNTR = PV-HOLD-DIST-CNTR                   49110099
155029        CONTINUE                                                  49120099
155029     ELSE                                                         49130099
430800        MOVE 'PDC'    TO TR004-REC-TYPE-CDE-PDC                   49140099
155029        MOVE TR004-REC-TYPE-PDC    TO PV-HOLD-OUT-RECORD          49150099
430900        MOVE TR004-REC-TYPE-PDC    TO PV-TBL-EXT-ROW (EXT-INDEX)  49160099
431000        PERFORM 5900-CHECK-OVERFLOW                               49170099
155029     END-IF.                                                      49180099
431100                                                                  49190099
431200******************************************************************49200099
431300* WRITE TRAILER RECORD FOR EXTRACT FILE.                         *49210099
431400******************************************************************49220099
431500 5800-WRITE-CTT-REC.                                              49230099
431600                                                                  49240099
431700     MOVE 'CTT'    TO TR004-REC-TYPE-CDE-CTT.                     49250099
431800     MOVE TR004-REC-TYPE-CTT      TO                              49260099
431900         OUTTR2-TRGL-EDI-PO-ODR.                                  49270099
432000                                                                  49280099
432100     PERFORM 6000-INSERT-EXTRACT-REC.                             49290099
432200                                                                  49300099
432300******************************************************************49310099
432400* CHECK IF INTERNAL TABLE FILLED UP.                             *49320099
432500******************************************************************49330099
432600                                                                  49340099
432700 5900-CHECK-OVERFLOW.                                             49350099
432800                                                                  49360099
432900     SET EXT-INDEX UP BY +1.                                      49370099
433000                                                                  49380099
433100     IF EXT-INDEX > PC-EXTRACT-TBL-LIMIT                          49390099
433200       DISPLAY  '***********************************************' 49400099
433300       DISPLAY  '** THIS IS NON-SQL ABEND                     **' 49410099
433400       DISPLAY  '** PROGRAM = TRKUP005                        **' 49420099
433500       DISPLAY  '** PARAGRAPGH  - 5900-CHECK-OVERFLOW         **' 49430099
433600       DISPLAY  '**                                           **' 49440099
433700       DISPLAY  '** INTERNAL TABLE IS FULL.                   **' 49450099
433800       DISPLAY  '**                                           **' 49460099
433900       DISPLAY  '**    INCREASE NUMBER OF OCCURS IN TABLE -   **' 49470099
434000       DISPLAY  '**                                           **' 49480099
434100       DISPLAY  '**              PV-EXTRACT-TABLE             **' 49490099
434200       DISPLAY  '**                                           **' 49500099
434300       DISPLAY  '**    AND CHANGE THE VALUE IN WS FIELD -     **' 49510099
434400       DISPLAY  '**                                           **' 49520099
434500       DISPLAY  '**              PC-EXTRACT-TBL-LIMIT         **' 49530099
434600       DISPLAY  '**                                           **' 49540099
434700       DISPLAY  '** SHIPMENT ID  = ' SHIPMT-SHIPT-ID              49550099
434800       DISPLAY  '** CONTAINER ID = ' SHIPMT-PRO-NBR               49560099
434900       DISPLAY  '** PO NUMBER    = ' SHPTPO-PO-NBR                49570099
435000       DISPLAY  '**                                           **' 49580099
435100       DISPLAY  '***********************************************' 49590099
435200       PERFORM 9100-SQL-ABEND                                     49600099
435300     END-IF.                                                      49610099
435400                                                                  49620099
435500******************************************************************49630099
435600 6000-INSERT-EXTRACT-REC.                                         49640099
435700                                                                  49650099
435800     EXEC SQL                                                     49660099
435900         INSERT INTO TOUTTR2                                      49670099
436000             (TRGL_EDI_PO_ODR)                                    49680099
436100            VALUES  (:OUTTR2-TRGL-EDI-PO-ODR)                     49690099
436200     END-EXEC                                                     49700099
436300                                                                  49710099
436400     EVALUATE TRUE                                                49720099
436500                                                                  49730099
436600         WHEN SQLCODE = ZERO                                      49740099
436700             MOVE SPACES       TO  OUTTR2-TRGL-EDI-PO-ODR         49750099
436800                                                                  49760099
436900         WHEN SQLWARN0 NOT EQUAL SPACE                            49770099
437000         WHEN SQLCODE NOT EQUAL ZERO                              49780099
437100             DISPLAY '** ABEND **'                                49790099
437200             DISPLAY '** PROGRAM = TRKUP005 **'                   49800099
437300             DISPLAY '** PARAGRAPH = 6000-INSERT-EXTRACT-REC**'   49810099
437400             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR2**'         49820099
437500             PERFORM 9100-SQL-ABEND                               49830099
437600     END-EVALUATE.                                                49840099
437700                                                                  49850099
437800     ADD +1 TO PA-TOTAL-OUTPUT-REC-COUNT.                         49860099
437900                                                                  49870099
438000 EJECT                                                            49880099
438100******************************************************************49890099
438200*    SELECT CHECKPOINT RESTART CONTROL INFO.                     *49900099
438300******************************************************************49910099
438400 6500-GET-CHECKPOINT-CNTL.                                        49920099
438500                                                                  49930099
438600     EXEC SQL                                                     49940099
438700      SELECT CKPT_STAT_CODE                                       49950099
438800       INTO :PV-CKPT-STAT-CODE                                    49960099
438900       FROM TCKRSTCNTL                                            49970099
439000       WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 49980099
439100     END-EXEC.                                                    49990099
439200                                                                  50000099
439300                                                                  50010099
439400     EVALUATE TRUE                                                50020099
439500         WHEN SQLWARN0 NOT EQUAL SPACE                            50030099
439600         WHEN SQLCODE NOT EQUAL ZERO                              50040099
439700             DISPLAY '** ABEND **'                                50050099
439800             DISPLAY '** PROGRAM = TRKUP005 **'                   50060099
439900             DISPLAY '** PARAGRAPH = 6500-GET-CHECKPOINT-CNTL**'  50070099
440000             DISPLAY '** CHECKING IF RUN IS NORMAL OR RESTART*'   50080099
440100             PERFORM 9100-SQL-ABEND                               50090099
440200     END-EVALUATE.                                                50100099
440300                                                                  50110099
440400 EJECT                                                            50120099
440500******************************************************************50130099
440600 6550-CHECKPOINT-RESTART.                                         50140099
440700                                                                  50150099
440800     PERFORM 6560-GET-CHECKPOINT-INFO.                            50160099
440900     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO PV-CKPT-RESTART-INFO.  50170099
441000                                                                  50180099
441100     DISPLAY '** TRKUP005 CHECKPOINT RESTART **'.                 50190099
441200     DISPLAY '** TOTAL OUTPUT RECORD COUNT AT RESTART = '         50200099
441300              PV-RESTART-TOT-OUT-REC-COUNT.                       50210099
441400     DISPLAY '***********************************************'    50220099
441500                                                                  50230099
441600     MOVE PV-RESTART-TOT-OUT-REC-COUNT    TO                      50240099
441700         PA-TOTAL-OUTPUT-REC-COUNT.                               50250099
441800                                                                  50260099
441900     MOVE PV-RESTART-ERROR-COUNT          TO                      50270099
442000         PA-ERROR-COUNT.                                          50280099
442100                                                                  50290099
442200                                                                  50300099
442300******************************************************************50310099
442400*    SELECT CHECKPOINT RESTART WORKING STORAGE INFORMATION.      *50320099
442500******************************************************************50330099
442600 6560-GET-CHECKPOINT-INFO.                                        50340099
442700                                                                  50350099
442800     EXEC SQL                                                     50360099
442900      SELECT WORK_STRG_DESC                                       50370099
443000       INTO :TCKRSTINF-WORK-STRG-DESC                             50380099
443100       FROM TCKRSTINF                                             50390099
443200      WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                  50400099
443300     END-EXEC.                                                    50410099
443400                                                                  50420099
443500     EVALUATE TRUE                                                50430099
443600         WHEN SQLWARN0 NOT EQUAL SPACE                            50440099
443700         WHEN SQLCODE NOT EQUAL ZERO                              50450099
443800             DISPLAY '** ABEND **'                                50460099
443900             DISPLAY '** PROGRAM = TRKUP005 **'                   50470099
444000             DISPLAY '** PARAGRAPH = 6560-GET-CHECKPOINT-INFO**'  50480099
444100             DISPLAY '** GETTING RESTART WORKING STORAGE INFO**'  50490099
444200             PERFORM 9100-SQL-ABEND                               50500099
444300     END-EVALUATE.                                                50510099
444400                                                                  50520099
444500 EJECT                                                            50530099
444600******************************************************************50540099
444700*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *50550099
444800*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *50560099
444900******************************************************************50570099
445000 6570-UPDATE-TCKRSTCNTL.                                          50580099
445100                                                                  50590099
445200     EXEC SQL                                                     50600099
445300       UPDATE TCKRSTCNTL                                          50610099
445400       SET CKPT_STAT_CODE   = :PV-CKPT-STAT-CODE                  50620099
445500       WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME            50630099
445600     END-EXEC.                                                    50640099
445700                                                                  50650099
445800     EVALUATE TRUE                                                50660099
445900         WHEN SQLWARN0 NOT EQUAL SPACE                            50670099
446000         WHEN SQLCODE NOT EQUAL ZERO                              50680099
446100             DISPLAY '** ABEND **'                                50690099
446200             DISPLAY '** PROGRAM = TRKUP005 **'                   50700099
446300             DISPLAY '** PARAGRAPH = 6570-UPDATE-TCKRSTCNTL**'    50710099
446400             DISPLAY '** GETTING RESTART INFORMATION AFTER ABEND*'50720099
446500             PERFORM 9100-SQL-ABEND                               50730099
446600     END-EVALUATE.                                                50740099
446700                                                                  50750099
446800 EJECT                                                            50760099
446900******************************************************************50770099
447000*    UPDATES THE CHECKPOINT RESTART INFORMATION TABLE.  THIS     *50780099
447100*    INFORMATION WOULD BE USED TO RESTART JOB IN CASE OF AN ABEND*50790099
447200******************************************************************50800099
447300 6580-UPDATE-TCKRSTINF.                                           50810099
447400                                                                  50820099
447500     MOVE PA-TOTAL-OUTPUT-REC-COUNT       TO                      50830099
447600         PV-RESTART-TOT-OUT-REC-COUNT.                            50840099
447700     MOVE PA-ERROR-COUNT                  TO                      50850099
447800         PV-RESTART-ERROR-COUNT.                                  50860099
447900     MOVE PV-CKPT-RESTART-INFO            TO                      50870099
448000         TCKRSTINF-WORK-STRG-DESC-TEXT.                           50880099
448100     MOVE 4022                            TO                      50890099
448200         TCKRSTINF-WORK-STRG-DESC-LEN.                            50900099
448300                                                                  50910099
448400     EXEC SQL                                                     50920099
448500        UPDATE TCKRSTINF                                          50930099
448600         SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC         50940099
448700         WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME          50950099
448800     END-EXEC.                                                    50960099
448900                                                                  50970099
449000     EVALUATE TRUE                                                50980099
449100         WHEN SQLWARN0 NOT EQUAL SPACE                            50990099
449200         WHEN SQLCODE NOT EQUAL ZERO                              51000099
449300             DISPLAY '** ABEND **'                                51010099
449400             DISPLAY '** PROGRAM = TRKUP005 **'                   51020099
449500             DISPLAY '** PARAGRAPH = 6580-UPDATE-TCKRSTINF**'     51030099
449600             DISPLAY '** UNSUCCESSFUL UPDATE TCKRSTINF**'         51040099
449700             PERFORM 9100-SQL-ABEND                               51050099
449800     END-EVALUATE.                                                51060099
449900                                                                  51070099
450000 EJECT                                                            51080099
155029******************************************************************51090099
155029*  FOR FAST FASHION CHECK TO SEE IF THIS DEPARTMENT NUMBER IS    *51100099
155029*  ONE OF THE FAST FASHION DEPARTMENT NUMBERS                    *51110099
155029******************************************************************51120099
155029 6600-FAST-PARM-CHECK.                                            51130099
155029                                                                  51140099
155029     MOVE PURCHS-DEPT-NBR  TO PV-DEPT-NBR.                        51150099
155029     MOVE SPACES           TO PV-FAST-RDC-IND                     51160099
155029                              PV-FAST-EFC-IND.                    51170099
155029                                                                  51180099
155029     EXEC SQL                                                     51190099
155029         SELECT  D.ATTR_ELEM_TXT AS RDC_IND                       51200099
155029                ,E.ATTR_ELEM_TXT AS EFC_IND                       51210099
155029           INTO :PV-FAST-RDC-IND                                  51220099
155029               ,:PV-FAST-EFC-IND                                  51230099
155029           FROM WST_INTGRTN_TYP A                                 51240099
155029               ,WST_ATTR_DEFN   B                                 51250099
155029               ,WST_ATTR_ELEM   C                                 51260099
155029               ,WST_ATTR_ELEM   D                                 51270099
155029               ,WST_ATTR_ELEM   E                                 51280099
155029               ,WST_ATTR_ELEM   F                                 51290099
155029               ,WST_ATTR_ELEM   G                                 51300099
155029          WHERE A.INTGRTN_TYP_CDE   = 'FASTFSHDPT'                51310099
155029            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           51320099
155029            AND B.ATTR_DEFN_SEQ_NBR = 1                           51330099
155029            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           51340099
155029            AND C.ATTR_DEFN_SEQ_NBR = 1                           51350099
155029            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           51360099
155029            AND D.ATTR_DEFN_SEQ_NBR = 2                           51370099
155029            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           51380099
155029            AND E.ATTR_DEFN_SEQ_NBR = 3                           51390099
155029            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           51400099
155029            AND F.ATTR_DEFN_SEQ_NBR = 4                           51410099
155029            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           51420099
155029            AND G.ATTR_DEFN_SEQ_NBR = 5                           51430099
155029            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         51440099
155029            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         51450099
155029            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         51460099
155029            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         51470099
155029            AND C.ATTR_ELEM_NBR     = :PV-DEPT-NBR                51480099
155029            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           51490099
155029            AND G.ATTR_ELEM_TMST = '9999-12-31-23.59.59.999999'   51500099
155029          WITH UR                                                 51510099
155029     END-EXEC.                                                    51520099
155029                                                                  51530099
155029     EVALUATE TRUE                                                51540099
155029          WHEN SQLCODE = +0                                       51550099
155029               CONTINUE                                           51560099
155029                                                                  51570099
155029          WHEN SQLCODE = +100                                     51580099
155029               MOVE 'N'          TO PV-FAST-RDC-IND               51590099
155029                                    PV-FAST-EFC-IND               51600099
155029                                                                  51610099
155029          WHEN OTHER                                              51620099
155029            DISPLAY '** ABEND **'                                 51630099
155029            DISPLAY '** PROGRAM = TRKUP005 **'                    51640099
155029            DISPLAY '** PARAGRAPH = 6600-FAST-PARM-CHECK **'      51650099
155029            DISPLAY '** PURCHS-PO-NBR   = ' PURCHS-PO-NBR         51660099
155029            DISPLAY '** PURCHS-DEPT-NBR = ' PURCHS-DEPT-NBR       51670099
155029            DISPLAY '** UNSUCCESSFUL SELECT OF FAST PARM**'       51680099
155029            PERFORM 9100-SQL-ABEND                                51690099
155029     END-EVALUATE.                                                51700099
155029                                                                  51710099
155029 EJECT                                                            51720099
450100******************************************************************51730099
450200* OPEN DRIVER (TRIP) CURSOR FOR CON TRANSMISSIONS.                51740099
450300******************************************************************51750099
450400 7000-OPEN-DRIVER-CURSOR.                                         51760099
450500                                                                  51770099
450510     PERFORM                                                      51780099
450520        WITH TEST AFTER                                           51790099
450530        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      51800099
450540        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR             51810099
450550                SQLCODE = 0                                       51820099
450560                                                                  51830099
450600        EXEC SQL                                                  51840099
450700             OPEN TRIP_CUR                                        51850099
450800        END-EXEC                                                  51860099
450900                                                                  51870099
451000        EVALUATE TRUE                                             51880099
451100           WHEN SQLCODE = 0                                       51890099
451101           WHEN SQLCODE = -911                                    51900099
451102              CONTINUE                                            51910099
451110           WHEN SQLWARN0 NOT EQUAL SPACE                          51920099
451200           WHEN SQLCODE NOT EQUAL ZERO                            51930099
451300               DISPLAY '** ABEND **'                              51940099
451400               DISPLAY '** PROGRAM = TRKUP005 **'                 51950099
451500               DISPLAY                                            51960099
451600                  '** PARAGRAPH = 7000-OPEN-DRIVER-CURSOR **'     51970099
451700               PERFORM 9100-SQL-ABEND                             51980099
451800        END-EVALUATE                                              51990099
451810     END-PERFORM.                                                 52000099
451900                                                                  52010099
451910     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    52020099
451920         SQLCODE NOT = ZERO                                       52030099
451930         DISPLAY '**************************************'         52040099
451931         DISPLAY '* ABEND '                                       52050099
451932         DISPLAY '* PROGRAM = TRKUP005 '                          52060099
451940         DISPLAY '* MAX RETRIES EXCEEDED ATTEMPTING TO  '         52070099
451950         DISPLAY '* OPEN TRIP_CUR CURSOR                '         52080099
451952         DISPLAY '*'                                              52090099
451953         DISPLAY '* PARAGRAPH = 7000-OPEN-DRIVER-CURSOR '         52100099
451954         DISPLAY '*'                                              52110099
451960         DISPLAY '* PLEASE SEE INPUT DATES ABOVE        '         52120099
451991         DISPLAY '**************************************'         52130099
451992         PERFORM 9100-SQL-ABEND                                   52140099
451993     END-IF.                                                      52150099
452000*                                                                 52160099
452100******************************************************************52170099
452200* CLOSE CURSOR FOR COM TRANSMISSIONS.                            *52180099
452300******************************************************************52190099
452400 7010-CLOSE-DRIVER-CURSOR.                                        52200099
452500                                                                  52210099
452600                                                                  52220099
452700     EXEC SQL                                                     52230099
452800         CLOSE TRIP_CUR                                           52240099
452900     END-EXEC.                                                    52250099
453000                                                                  52260099
453100     EVALUATE TRUE                                                52270099
453200         WHEN SQLWARN0 NOT EQUAL SPACE                            52280099
453300         WHEN SQLCODE NOT EQUAL ZERO                              52290099
453400             DISPLAY '** ABEND **'                                52300099
453500             DISPLAY '** PROGRAM = TRKUP005 **'                   52310099
453600             DISPLAY                                              52320099
453700               '** PARAGRAPH = 7010-CLOSE-DRIVER-CURSOR**'        52330099
453800             PERFORM 9100-SQL-ABEND                               52340099
453900     END-EVALUATE.                                                52350099
454000                                                                  52360099
454100*                                                                 52370099
454200******************************************************************52380099
454300* FETCH CURSOR FOR COM TRANSMISSIONS                             *52390099
454400******************************************************************52400099
454500 7020-FETCH-DRIVER-CURSOR.                                        52410099
454700     EXEC SQL                                                     52420099
454800          FETCH TRIP_CUR                                          52430099
454900          INTO                                                    52440099
455000                  :VHTRIP-EST-AR-TMST                             52450099
455100                , :VHTRIP-VEH-NBR                                 52460099
455200                , :VHTRIP-TRIP-ID                                 52470099
455300                , :TRIPST-TRIP-STATUS-CDE                         52480099
455400                , :VEHICL-VEH-TYP-CDE                             52490099
455500                , :PLNSHP-POE-CDE                                 52500099
455600                , :VHTRIP-OWNER-SCAC-ID                           52510099
455700     END-EXEC.                                                    52520099
455800                                                                  52530099
455900     EVALUATE TRUE                                                52540099
456000         WHEN SQLCODE = ZERO                                      52550099
456100             IF TRIPST-TRIP-STATUS-CDE = 'DE' OR 'ET'             52560099
456200                 CONTINUE                                         52570099
456300             ELSE                                                 52580099
456400                 SET PS-GOOD-STATUS-CDE-FOUND TO TRUE             52590099
456500             END-IF                                               52600099
456600                                                                  52610099
456700         WHEN SQLCODE = +100                                      52620099
456800              SET PS-EOC-DRIVER-CURSOR                            52630099
456900                               TO  TRUE                           52640099
457000                                                                  52650099
457100         WHEN SQLWARN0 NOT EQUAL SPACE                            52660099
457200         WHEN SQLCODE NOT EQUAL ZERO                              52670099
457300             DISPLAY '** ABEND **'                                52680099
457400             DISPLAY '** PROGRAM = TRKUP005 **'                   52690099
457500             DISPLAY                                              52700099
457600                 '** PARAGRAPH = 7020-FETCH-DRIVER-CURSOR**'      52710099
457700             PERFORM 9100-SQL-ABEND                               52720099
457800     END-EVALUATE.                                                52730099
457900                                                                  52740099
458000 EJECT                                                            52750099
458100******************************************************************52760099
458200* OPEN CURSOR TO OBTAIN POE CITY FROM TIMPOE.                    *52770099
458300******************************************************************52780099
458400 7100-OPEN-POE-CURSOR.                                            52790099
458500                                                                  52800099
458600     EXEC SQL                                                     52810099
458700          OPEN POE_CUR                                            52820099
458800     END-EXEC.                                                    52830099
458900                                                                  52840099
459000     EVALUATE TRUE                                                52850099
459100         WHEN SQLWARN0 NOT EQUAL SPACE                            52860099
459200         WHEN SQLCODE NOT EQUAL ZERO                              52870099
459300             DISPLAY '** ABEND **'                                52880099
459400             DISPLAY '** PROGRAM = TRKUP005 **'                   52890099
459500             DISPLAY                                              52900099
459600                '** PARAGRAPH = 7100-OPEN-POE-CURSOR **'          52910099
459700             PERFORM 9100-SQL-ABEND                               52920099
459800     END-EVALUATE.                                                52930099
459900*                                                                 52940099
460000 EJECT                                                            52950099
460100******************************************************************52960099
460200* CLOSE CURSOR FOR TIMPOE.                                       *52970099
460300******************************************************************52980099
460400 7110-CLOSE-POE-CURSOR.                                           52990099
460500                                                                  53000099
460600                                                                  53010099
460700     EXEC SQL                                                     53020099
460800         CLOSE POE_CUR                                            53030099
460900     END-EXEC.                                                    53040099
461000                                                                  53050099
461100     EVALUATE TRUE                                                53060099
461200         WHEN SQLWARN0 NOT EQUAL SPACE                            53070099
461300         WHEN SQLCODE NOT EQUAL ZERO                              53080099
461400             DISPLAY '** ABEND **'                                53090099
461500             DISPLAY '** PROGRAM = TRKUP005 **'                   53100099
461600             DISPLAY                                              53110099
461700               '** PARAGRAPH = 7110-CLOSE-POE-CURSOR**'           53120099
461800             PERFORM 9100-SQL-ABEND                               53130099
461900     END-EVALUATE.                                                53140099
462000                                                                  53150099
462100*                                                                 53160099
462200******************************************************************53170099
462300* FETCH CURSOR FOR POE CITY FROM TIMPOE.                         *53180099
462400******************************************************************53190099
462500 7120-FETCH-POE-CURSOR.                                           53200099
462600                                                                  53210099
462700     EXEC SQL                                                     53220099
462800          FETCH POE_CUR                                           53230099
462900          INTO                                                    53240099
463000                 :IMPOE-POE-CTY-NM                                53250099
463100                ,:IMPOE-POE-STD-EDI-CDE                           53260099
463200     END-EXEC.                                                    53270099
463300                                                                  53280099
463400     EVALUATE TRUE                                                53290099
463500         WHEN SQLCODE = ZERO                                      53300099
463600                 CONTINUE                                         53310099
463700                                                                  53320099
463800         WHEN SQLCODE = +100                                      53330099
463900              SET PS-EOC-POE-CURSOR                               53340099
464000                               TO  TRUE                           53350099
464100                                                                  53360099
464200         WHEN SQLWARN0 NOT EQUAL SPACE                            53370099
464300         WHEN SQLCODE NOT EQUAL ZERO                              53380099
464400             DISPLAY '** ABEND **'                                53390099
464500             DISPLAY '** PROGRAM = TRKUP005 **'                   53400099
464600             DISPLAY                                              53410099
464700                 '** PARAGRAPH = 7120-FETCH-POE-CURSOR**'         53420099
464800             PERFORM 9100-SQL-ABEND                               53430099
464900     END-EVALUATE.                                                53440099
465000                                                                  53450099
465100 EJECT                                                            53460099
465200******************************************************************53470099
465300 7300-OPEN-CONT-CURSOR.                                           53480099
465400                                                                  53490099
465500     EXEC SQL                                                     53500099
465600          OPEN CONT_CUR                                           53510099
465700     END-EXEC.                                                    53520099
465800                                                                  53530099
465900     EVALUATE TRUE                                                53540099
466000         WHEN SQLWARN0 NOT EQUAL SPACE                            53550099
466100         WHEN SQLCODE NOT EQUAL ZERO                              53560099
466200             DISPLAY '** ABEND **'                                53570099
466300             DISPLAY '** PROGRAM = TRKUP005 **'                   53580099
466400             DISPLAY '** PARAGRAPH = 7300-OPEN-CONT-CURSOR **'    53590099
466500             PERFORM 9100-SQL-ABEND                               53600099
466600     END-EVALUATE.                                                53610099
466700                                                                  53620099
466800*                                                                 53630099
466900******************************************************************53640099
467000 7400-CLOSE-CONT-CURSOR.                                          53650099
467100                                                                  53660099
467200                                                                  53670099
467300     EXEC SQL                                                     53680099
467400         CLOSE CONT_CUR                                           53690099
467500     END-EXEC.                                                    53700099
467600                                                                  53710099
467700     EVALUATE TRUE                                                53720099
467800         WHEN SQLWARN0 NOT EQUAL SPACE                            53730099
467900         WHEN SQLCODE NOT EQUAL ZERO                              53740099
468000             DISPLAY '** ABEND **'                                53750099
468100             DISPLAY '** PROGRAM = TRKUP005 **'                   53760099
468200             DISPLAY '** PARAGRAPH = 7400-CLOSE-CONT-CURSOR**'    53770099
468300             PERFORM 9100-SQL-ABEND                               53780099
468400     END-EVALUATE.                                                53790099
468500                                                                  53800099
468600*                                                                 53810099
468700******************************************************************53820099
468800 7500-FETCH-CONT-CURSOR.                                          53830099
469000     EXEC SQL                                                     53840099
469100          FETCH CONT_CUR                                          53850099
469200          INTO                                                    53860099
469300                  :SHIPMT-PRO-NBR                                 53870099
469400                , :SHIPMT-SHIPT-ID                                53880099
469500     END-EXEC.                                                    53890099
469600                                                                  53900099
469700     EVALUATE TRUE                                                53910099
469800         WHEN SQLCODE = ZERO                                      53920099
469900              SET PS-CONT-INFO-PRESENT TO TRUE                    53930099
470000                                                                  53940099
470100         WHEN SQLCODE = +100                                      53950099
470200              IF PS-CONT-INFO-PRESENT                             53960099
470300                  SET PS-CONT-INFO-PRESENT-NO TO TRUE             53970099
470400              ELSE                                                53980099
470500                  INITIALIZE TR006-UPC-NBR                        53990099
470600                             TR006-SKU                            54000099
470700                             TR006-ERROR-MSG                      54010099
470800                             TR006-CONTAINER-NUMBER               54020099
470900                             TR006-PO-NBR                         54030099
471000                  SET TR006-ERROR-TYPE-ERROR     TO TRUE          54040099
471100                  STRING 'NO CONTAINERS FOR VESSL-NOT SENT'       54050099
471200                      DELIMITED BY SIZE                           54060099
471300                      INTO TR006-ERROR-MSG                        54070099
471400                  PERFORM 8830-WRITE-ERROR-LINE                   54080099
471500              END-IF                                              54090099
471600                                                                  54100099
471700              SET PS-EOC-CONT-CURSOR          TO TRUE             54110099
471800                                                                  54120099
471900         WHEN SQLWARN0 NOT EQUAL SPACE                            54130099
472000         WHEN SQLCODE NOT EQUAL ZERO                              54140099
472100             DISPLAY '** ABEND **'                                54150099
472200             DISPLAY '** PROGRAM = TRKUP005 **'                   54160099
472300             DISPLAY '** PARAGRAPH = 7500-FETCH-CONT-CURSOR**'    54170099
472400             PERFORM 9100-SQL-ABEND                               54180099
472500     END-EVALUATE.                                                54190099
472600                                                                  54200099
472700 EJECT                                                            54210099
472800******************************************************************54220099
472900 7600-OPEN-PO-CURSOR.                                             54230099
473000                                                                  54240099
473100     EXEC SQL                                                     54250099
473200          OPEN PO_CUR                                             54260099
473300     END-EXEC.                                                    54270099
473400                                                                  54280099
473500     EVALUATE TRUE                                                54290099
473600         WHEN SQLWARN0 NOT EQUAL SPACE                            54300099
473700         WHEN SQLCODE NOT EQUAL ZERO                              54310099
473800             DISPLAY '** ABEND **'                                54320099
473900             DISPLAY '** PROGRAM = TRKUP005 **'                   54330099
474000             DISPLAY '** PARAGRAPH = 7600-OPEN-PO-CURSOR **'      54340099
474100             PERFORM 9100-SQL-ABEND                               54350099
474200     END-EVALUATE.                                                54360099
474300                                                                  54370099
474400*                                                                 54380099
474500******************************************************************54390099
474600 7700-CLOSE-PO-CURSOR.                                            54400099
474700                                                                  54410099
474800                                                                  54420099
474900     EXEC SQL                                                     54430099
475000         CLOSE PO_CUR                                             54440099
475100     END-EXEC.                                                    54450099
475200                                                                  54460099
475300     EVALUATE TRUE                                                54470099
475400         WHEN SQLWARN0 NOT EQUAL SPACE                            54480099
475500         WHEN SQLCODE NOT EQUAL ZERO                              54490099
475600             DISPLAY '** ABEND **'                                54500099
475700             DISPLAY '** PROGRAM = TRKUP005 **'                   54510099
475800             DISPLAY '** PARAGRAPH = 7700-CLOSE-PO-CURSOR**'      54520099
475900             PERFORM 9100-SQL-ABEND                               54530099
476000     END-EVALUATE.                                                54540099
476100                                                                  54550099
476200*                                                                 54560099
476300******************************************************************54570099
476400 7800-FETCH-PO-CURSOR.                                            54580099
476500                                                                  54590099
476600     EXEC SQL                                                     54600099
476700          FETCH PO_CUR                                            54610099
476800          INTO                                                    54620099
476900                  :SHPTPO-PO-NBR                                  54630099
477000                , :SHPTPO-EXPTED-CART-CNT                         54640099
477100                , :SHPTPO-SPLT-XMIT-IND                           54650099
477200     END-EXEC.                                                    54660099
477300                                                                  54670099
477400     EVALUATE TRUE                                                54680099
477500         WHEN SQLCODE = ZERO                                      54690099
477540                                                                  54700099
477600              SET PS-PO-CUR-INFO-PRESENT    TO TRUE               54710099
477700              IF SHPTPO-SPLT-XMIT-IND = ' '                       54720099
477800                SET PS-UNPROCESSED-PO-FOUND TO TRUE               54730099
477900              END-IF                                              54740099
478000                                                                  54750099
478100         WHEN SQLCODE = +100                                      54760099
478200              IF PS-PO-CUR-INFO-PRESENT                           54770099
478300                  SET PS-PO-CUR-INFO-PRESENT-NO TO TRUE           54780099
478400              ELSE                                                54790099
478500                  INITIALIZE TR006-UPC-NBR                        54800099
478600                             TR006-SKU                            54810099
478700                             TR006-ERROR-MSG                      54820099
478800                             TR006-DONT-SHIP-BEFORE-DATE          54830099
478900                             TR006-DEPT-NBR                       54840099
479000                             TR006-PO-NBR                         54850099
479100                  SET TR006-ERROR-TYPE-ERROR     TO TRUE          54860099
479200                  STRING 'NO PO FOR CONTAINER-NOT SENT'           54870099
479300                      DELIMITED BY SIZE                           54880099
479400                      INTO TR006-ERROR-MSG                        54890099
479500                  PERFORM 8830-WRITE-ERROR-LINE                   54900099
479600              END-IF                                              54910099
479700                                                                  54920099
479800              SET PS-EOC-PO-CURSOR          TO TRUE               54930099
479900                                                                  54940099
480000         WHEN SQLWARN0 NOT EQUAL SPACE                            54950099
480100         WHEN SQLCODE NOT EQUAL ZERO                              54960099
480200             DISPLAY '** ABEND **'                                54970099
480300             DISPLAY '** PROGRAM = TRKUP005 **'                   54980099
480400             DISPLAY '** PARAGRAPH = 7800-FETCH-PO-CURSOR**'      54990099
480500             PERFORM 9100-SQL-ABEND                               55000099
480600     END-EVALUATE.                                                55010099
480700                                                                  55020099
480800 EJECT                                                            55030099
155029******************************************************************55040099
155029 7830-RETRIEVE-PLAN-NBR.                                          55050099
155029                                                                  55060099
155029     EXEC SQL                                                     55070099
155029           SELECT DISTINCT AL.PLAN_NBR                            55080099
155029             INTO :ALLPLN-PLAN-NBR                                55090099
155029             FROM TIMCNUP   CNUP                                  55100099
155029                 ,TUPCSKU   SKU                                   55110099
155029                 ,TPURITM   PUR                                   55120099
155029                 ,TALLPLN   AL                                    55130099
155029                 ,TMESTDS   ES                                    55140099
155029             WHERE CNUP.CONTNR_ID      = :VHTRIP-VEH-NBR          55150099
155029               AND SKU.UPC_NBR         = :UPC-UPC-NBR             55160099
155029               AND AL.DEST_NBR         = :ALLPLN-DEST-NBR         55170099
155029               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            55180099
155029               AND PUR.PO_NBR          = :PURCHS-PO-NBR           55190099
155029               AND PUR.VER_STATUS_CDE  = 'A'                      55200099
155029               AND PUR.STATUS_CDE     IN ('AC', 'AP')             55210099
155029               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          55220099
155029               AND AL.PO_LNE_NBR       =  ES.PO_LNE_NBR           55230099
155029               AND AL.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         55240099
155029               AND AL.PO_NBR           =  PUR.PO_NBR              55250099
155029               AND AL.PO_NBR           =  CNUP.PO_NBR             55260099
155029               AND AL.PLAN_NBR         =  ES.PLAN_NBR             55270099
155029               AND PUR.PO_NBR          =  ES.PO_NBR               55280099
155029               AND ES.STR_DISTRO_QTY  >  0                        55290099
155029     END-EXEC.                                                    55300099
155029                                                                  55310099
155029     EVALUATE TRUE                                                55320099
155029         WHEN SQLCODE = ZERO                                      55330099
155029             CONTINUE                                             55340099
155029                                                                  55350099
155029         WHEN SQLCODE = +100                                      55360099
155029             MOVE ZEROES TO TR004-PDC-PERCNT                      55370099
155029             INITIALIZE TR006-ERROR-MSG                           55380099
155029             MOVE POPRPK-PK-SKU-NBR          TO TR006-SKU         55390099
155029             MOVE POPRPK-PREPK-UPC-NBR       TO TR006-UPC-NBR     55400099
155029             SET TR006-ERROR-TYPE-MISS-SPLT  TO TRUE              55410099
155029             STRING 'BLK PO MISSING SPLIT-FIX/FAST'               55420099
155029                 DELIMITED BY SIZE                                55430099
155029                 INTO TR006-ERROR-MSG                             55440099
155029             PERFORM 8830-WRITE-ERROR-LINE                        55450099
155029             SET PS-SPLITS-ENTERED-NO      TO TRUE                55460099
155029                                                                  55470099
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            55480099
155029         WHEN SQLCODE NOT EQUAL ZERO                              55490099
155029             DISPLAY '**************************************'     55500099
155029             DISPLAY '** ABEND                            **'     55510099
155029             DISPLAY '** PROGRAM = TRKUP005               **'     55520099
155029             DISPLAY '** PARAGRAPH = 7830-RETRIEVE-PLAN-NBR'      55530099
155029             DISPLAY '** CONTAINER = ' VHTRIP-VEH-NBR             55540099
155029             DISPLAY '** UPC NBR   = ' UPC-UPC-NBR                55550099
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            55560099
155029             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              55570099
155029             DISPLAY '**************************************'     55580099
155029             PERFORM 9100-SQL-ABEND                               55590099
155029     END-EVALUATE.                                                55600099
155029                                                                  55610099
155029 EJECT                                                            55620099
155029******************************************************************55630099
155029 7835-RETRIEVE-PLAN-NBR.                                          55640099
155029                                                                  55650099
155029     EXEC SQL                                                     55660099
155029         SELECT DISTINCT(PLAN_NBR)                                55670099
155029           INTO :ALLPLN-PLAN-NBR                                  55680099
155029           FROM TALLPLN                                           55690099
155029          WHERE PO_NBR         = :PURCHS-PO-NBR                   55700099
155029            AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR               55710099
155029            AND DEST_NBR       = :ALLPLN-DEST-NBR                 55720099
155029            AND CURR_SPLIT_QTY >  0                               55730099
155029     END-EXEC.                                                    55740099
155029                                                                  55750099
155029     EVALUATE TRUE                                                55760099
155029         WHEN SQLCODE = ZERO                                      55770099
155029             CONTINUE                                             55780099
155029                                                                  55790099
155029         WHEN SQLCODE = +100                                      55800099
155029             MOVE ZEROES TO TR004-PDC-PERCNT                      55810099
155029             INITIALIZE TR006-ERROR-MSG                           55820099
155029             MOVE POPRPK-PK-SKU-NBR          TO TR006-SKU         55830099
155029             MOVE POPRPK-PREPK-UPC-NBR       TO TR006-UPC-NBR     55840099
155029             SET TR006-ERROR-TYPE-MISS-SPLT  TO TRUE              55850099
155029             STRING 'PCK PO MISSING SPLIT-FIX/FAST'               55860099
155029                 DELIMITED BY SIZE                                55870099
155029                 INTO TR006-ERROR-MSG                             55880099
155029             PERFORM 8830-WRITE-ERROR-LINE                        55890099
155029             SET PS-SPLITS-ENTERED-NO      TO TRUE                55900099
155029                                                                  55910099
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            55920099
155029         WHEN SQLCODE NOT EQUAL ZERO                              55930099
155029             DISPLAY '**************************************'     55940099
155029             DISPLAY '** ABEND                            **'     55950099
155029             DISPLAY '** PROGRAM = TRKUP005               **'     55960099
155029             DISPLAY '** PARAGRAPH = 7835-RETRIEVE-PLAN-NBR'      55970099
155029             DISPLAY '** CONTAINER = ' VHTRIP-VEH-NBR             55980099
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            55990099
155029             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              56000099
155029             DISPLAY '** LINE NBR  = ' PURITM-PO-LNE-NBR          56010099
155029             DISPLAY '**************************************'     56020099
155029             PERFORM 9100-SQL-ABEND                               56030099
155029     END-EVALUATE.                                                56040099
155029                                                                  56050099
155029 EJECT                                                            56060099
480900******************************************************************56070099
481000 7900-OPEN-INSTR-CURSOR.                                          56080099
481100                                                                  56090099
481200     EXEC SQL                                                     56100099
481300          OPEN INSTR_CUR                                          56110099
481400     END-EXEC.                                                    56120099
481500                                                                  56130099
481600     EVALUATE TRUE                                                56140099
481700         WHEN SQLWARN0 NOT EQUAL SPACE                            56150099
481800         WHEN SQLCODE NOT EQUAL ZERO                              56160099
481900             DISPLAY '** ABEND **'                                56170099
482000             DISPLAY '** PROGRAM = TRKUP005 **'                   56180099
482100             DISPLAY '** PARAGRAPH = 7900-OPEN-INSTR-CURSOR **'   56190099
482200             PERFORM 9100-SQL-ABEND                               56200099
482300     END-EVALUATE.                                                56210099
482400                                                                  56220099
482500*                                                                 56230099
482600******************************************************************56240099
482700 8000-CLOSE-INSTR-CURSOR.                                         56250099
482800                                                                  56260099
482900                                                                  56270099
483000     EXEC SQL                                                     56280099
483100         CLOSE INSTR_CUR                                          56290099
483200     END-EXEC.                                                    56300099
483300                                                                  56310099
483400     EVALUATE TRUE                                                56320099
483500         WHEN SQLWARN0 NOT EQUAL SPACE                            56330099
483600         WHEN SQLCODE NOT EQUAL ZERO                              56340099
483700             DISPLAY '** ABEND **'                                56350099
483800             DISPLAY '** PROGRAM = TRKUP005 **'                   56360099
483900             DISPLAY '** PARAGRAPH = 8000-CLOSE-INSTR-CURSOR**'   56370099
484000             PERFORM 9100-SQL-ABEND                               56380099
484100     END-EVALUATE.                                                56390099
484200                                                                  56400099
484300*                                                                 56410099
484400******************************************************************56420099
484500 8100-FETCH-INSTR-CURSOR.                                         56430099
484600                                                                  56440099
484700     EXEC SQL                                                     56450099
484800          FETCH INSTR_CUR                                         56460099
484900          INTO                                                    56470099
485000                  :INSTCD-INSTR-DESC                              56480099
485100                , :INSTCD-INSTR-NBR                               56490099
485200                , :POINST-RECIP-CDE                               56500099
485300     END-EXEC.                                                    56510099
485400                                                                  56520099
485500     EVALUATE TRUE                                                56530099
485600         WHEN SQLCODE = ZERO                                      56540099
485700             CONTINUE                                             56550099
485800                                                                  56560099
485900         WHEN SQLCODE = +100                                      56570099
486000              SET PS-EOC-INSTR-CURSOR                             56580099
486100                                   TO  TRUE                       56590099
486200                                                                  56600099
486300         WHEN SQLWARN0 NOT EQUAL SPACE                            56610099
486400         WHEN SQLCODE NOT EQUAL ZERO                              56620099
486500             DISPLAY '** ABEND **'                                56630099
486600             DISPLAY '** PROGRAM = TRKUP005 **'                   56640099
486700             DISPLAY '** PARAGRAPH = 8100-FETCH-INSTR-CURSOR**'   56650099
486800             PERFORM 9100-SQL-ABEND                               56660099
486900     END-EVALUATE.                                                56670099
487000                                                                  56680099
487100 EJECT                                                            56690099
487200******************************************************************56700099
487300 8200-OPEN-BULK-UPC-CUR.                                          56710099
487400                                                                  56720099
487500     EXEC SQL                                                     56730099
487600          OPEN BULK_UPC_CUR                                       56740099
487700     END-EXEC.                                                    56750099
487800                                                                  56760099
487900     EVALUATE TRUE                                                56770099
488000         WHEN SQLWARN0 NOT EQUAL SPACE                            56780099
488100         WHEN SQLCODE NOT EQUAL ZERO                              56790099
488200             DISPLAY '** ABEND **'                                56800099
488300             DISPLAY '** PROGRAM = TRKUP005 **'                   56810099
488400             DISPLAY '** PARAGRAPH = 8200-OPEN-BULK-UPC-CUR **'   56820099
488500             PERFORM 9100-SQL-ABEND                               56830099
488600     END-EVALUATE.                                                56840099
488700                                                                  56850099
488800*                                                                 56860099
488900******************************************************************56870099
489000 8300-CLOSE-BULK-UPC-CUR.                                         56880099
489100                                                                  56890099
489200                                                                  56900099
489300     EXEC SQL                                                     56910099
489400         CLOSE BULK_UPC_CUR                                       56920099
489500     END-EXEC.                                                    56930099
489600                                                                  56940099
489700     EVALUATE TRUE                                                56950099
489800         WHEN SQLWARN0 NOT EQUAL SPACE                            56960099
489900         WHEN SQLCODE NOT EQUAL ZERO                              56970099
490000             DISPLAY '** ABEND **'                                56980099
490100             DISPLAY '** PROGRAM = TRKUP005 **'                   56990099
490200             DISPLAY '** PARAGRAPH = 8300-CLOSE-BULK-UPC-CUR**'   57000099
490300             PERFORM 9100-SQL-ABEND                               57010099
490400     END-EVALUATE.                                                57020099
490500                                                                  57030099
490600*                                                                 57040099
490700******************************************************************57050099
490800 8400-FETCH-BULK-UPC-CUR.                                         57060099
490900                                                                  57070099
491000     EXEC SQL                                                     57080099
491100          FETCH BULK_UPC_CUR                                      57090099
491200          INTO                                                    57100099
491300                  :PURITM-APP-PO-LNE-NBR                          57110099
491400                , :PURITM-PO-LNE-NBR                              57120099
491500                , :XLT00004-VS-NBR                                57130099
491600                , :XLT00003-CSTM-CLOR-DESC                        57140099
491700                , :XLT00003-SIZE-DESC                             57150099
491800                , :XLT00003-NRF-CLOR-CDE                          57160099
491900                , :XLT00003-SKU-DESC                              57170099
492000                , :PURITM-ITM-NBR                                 57180099
492100                , :PURITM-PO-NBR                                  57190099
492200                , :PURITM-STATUS-CDE                              57200099
492300                , :PURITM-UNT-QTY                                 57210099
492400                , :PURITM-PREPK-RATO-QTY                          57220099
492500                , :UPC-UPC-NBR                                    57230099
492600                , :SKXREF-DEPT                                    57240099
492700                , :SKXREF-CLASS                                   57250099
492800                , :SKXREF-SUBCLASS                                57260099
492900                , :SKXREF-SKU                                     57270099
492910                , :PURITM-OUTR-PK-QTY                             57280099
493000     END-EXEC.                                                    57290099
493100                                                                  57300099
493200     EVALUATE TRUE                                                57310099
493300         WHEN SQLCODE = ZERO                                      57320099
155029             SET PS-NEW-UPC-YES      TO TRUE                      57330099
155029             MOVE SPACES             TO PV-HOLD-OUT-RECORD        57340099
493400             SET PS-LINES-ON-TPURITM TO TRUE                      57350099
493500             IF SKXREF-DEPT NUMERIC                               57360099
493600              IF SKXREF-DEPT > ZEROES                             57370099
493700                 MOVE SKXREF-DEPT TO TR006-DEPT-NBR               57380099
493800              END-IF                                              57390099
493900             END-IF                                               57400099
494000                                                                  57410099
494100         WHEN SQLCODE = +100                                      57420099
494200              IF PS-LINES-ON-TPURITM                              57430099
494300                  CONTINUE                                        57440099
494400              ELSE                                                57450099
494500                  INITIALIZE TR006-UPC-NBR                        57460099
494600                             TR006-SKU                            57470099
494700                             TR006-ERROR-MSG                      57480099
494800                  SET TR006-ERROR-TYPE-ERROR   TO TRUE            57490099
494900                  STRING 'NO UPCS FOR BULK PO-NOT SENT'           57500099
495000                      DELIMITED BY SIZE                           57510099
495100                      INTO TR006-ERROR-MSG                        57520099
495200                  PERFORM 8830-WRITE-ERROR-LINE                   57530099
495300              END-IF                                              57540099
495400                                                                  57550099
495500              SET PS-EOC-BULK-UPC-CUR TO TRUE                     57560099
495600                                                                  57570099
495700         WHEN SQLWARN0 NOT EQUAL SPACE                            57580099
495800         WHEN SQLCODE NOT EQUAL ZERO                              57590099
495900             DISPLAY '** ABEND **'                                57600099
496000             DISPLAY '** PROGRAM = TRKUP005 **'                   57610099
496100             DISPLAY '** PARAGRAPH = 8400-FETCH-BULK-UPC-CUR**'   57620099
496200             PERFORM 9100-SQL-ABEND                               57630099
496300     END-EVALUATE.                                                57640099
496400                                                                  57650099
496500 EJECT                                                            57660099
496600******************************************************************57670099
496700 8420-OPEN-PACK-DC-CURSOR.                                        57680099
496800                                                                  57690099
496900     EXEC SQL                                                     57700099
497000          OPEN PREPACK_DC_CUR                                     57710099
497100     END-EXEC.                                                    57720099
497200                                                                  57730099
497300     EVALUATE TRUE                                                57740099
497400         WHEN SQLWARN0 NOT EQUAL SPACE                            57750099
497500         WHEN SQLCODE NOT EQUAL ZERO                              57760099
497600             DISPLAY '** ABEND **'                                57770099
497700             DISPLAY '** PROGRAM = TRKUP005 **'                   57780099
497800             DISPLAY '** PARAGRAPH = 8420-OPEN-PACK-DC-CURSOR***' 57790099
497900             PERFORM 9100-SQL-ABEND                               57800099
498000     END-EVALUATE.                                                57810099
498100                                                                  57820099
498200******************************************************************57830099
498300 8425-CLOSE-PACK-DC-CURSOR.                                       57840099
498400                                                                  57850099
498500     EXEC SQL                                                     57860099
498600         CLOSE PREPACK_DC_CUR                                     57870099
498700     END-EXEC.                                                    57880099
498800                                                                  57890099
498900     EVALUATE TRUE                                                57900099
499000         WHEN SQLWARN0 NOT EQUAL SPACE                            57910099
499100         WHEN SQLCODE NOT EQUAL ZERO                              57920099
499200             DISPLAY '** ABEND **'                                57930099
499300             DISPLAY '** PROGRAM = TRKUP005 **'                   57940099
499400             DISPLAY '** PARAGRAPH = 8425-CLOSE-PACK-DC-CURSOR***'57950099
499500             PERFORM 9100-SQL-ABEND                               57960099
499600     END-EVALUATE.                                                57970099
499700                                                                  57980099
499800******************************************************************57990099
499900 8430-FETCH-PACK-DC-CURSOR.                                       58000099
500000                                                                  58010099
500100     EXEC SQL                                                     58020099
500200          FETCH PREPACK_DC_CUR                                    58030099
500300          INTO                                                    58040099
500400               :PA-PDC-SPLIT-QTY                                  58050099
500500             , :ALLPLN-DEST-NBR                                   58060099
155029             , :PV-FAST-E-BUS-IND                                 58070099
500600     END-EXEC.                                                    58080099
500700                                                                  58090099
500800     EVALUATE TRUE                                                58100099
500900         WHEN SQLCODE = ZERO                                      58110099
501000             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 58120099
155029             IF PS-NEW-UPC-YES                                    58130099
155029                SET PS-NEW-UPC-NO      TO TRUE                    58140099
155029                SET PS-FIRST-UPC-YES   TO TRUE                    58150099
155029             END-IF                                               58160099
501100                                                                  58170099
501200         WHEN SQLCODE = +100                                      58180099
501300              SET PS-EOC-PREPACK-DC-CURSOR TO TRUE                58190099
501400              IF PS-DC-SPLIT-INFO-PRESENT                         58200099
501500                  CONTINUE                                        58210099
501600              ELSE                                                58220099
501700                  INITIALIZE TR006-ERROR-MSG                      58230099
501800                  MOVE POPRPK-PK-SKU-NBR         TO TR006-SKU     58240099
501900                  MOVE POPRPK-PREPK-UPC-NBR      TO TR006-UPC-NBR 58250099
502000                  SET TR006-ERROR-TYPE-MISS-SPLT TO TRUE          58260099
502100                  STRING 'PCK PO MISSING SPLIT-FIX'               58270099
502200                      DELIMITED BY SIZE                           58280099
502300                      INTO TR006-ERROR-MSG                        58290099
502400                  PERFORM 8830-WRITE-ERROR-LINE                   58300099
502500                  SET PS-SPLITS-ENTERED-NO      TO TRUE           58310099
502600              END-IF                                              58320099
502700                                                                  58330099
502800         WHEN SQLWARN0 NOT EQUAL SPACE                            58340099
502900         WHEN SQLCODE NOT EQUAL ZERO                              58350099
503000             DISPLAY '** ABEND **'                                58360099
503100             DISPLAY '** PROGRAM = TRKUP005 **'                   58370099
503200             DISPLAY '** PARAGRAPH = 8430-FETCH-PACK-DC-CURSOR**' 58380099
503300             PERFORM 9100-SQL-ABEND                               58390099
503400     END-EVALUATE.                                                58400099
503500                                                                  58410099
503600 EJECT                                                            58420099
503700******************************************************************58430099
503800 8450-OPEN-PACK-UPC-CUR.                                          58440099
503900                                                                  58450099
504000     EXEC SQL                                                     58460099
504100          OPEN PACK_UPC_CUR                                       58470099
504200     END-EXEC.                                                    58480099
504300                                                                  58490099
504400     EVALUATE TRUE                                                58500099
504500         WHEN SQLWARN0 NOT EQUAL SPACE                            58510099
504600         WHEN SQLCODE NOT EQUAL ZERO                              58520099
504700             DISPLAY '** ABEND **'                                58530099
504800             DISPLAY '** PROGRAM = TRKUP005 **'                   58540099
504900             DISPLAY '** PARAGRAPH = 8450-OPEN-PACK-UPC-CUR*'     58550099
505000             PERFORM 9100-SQL-ABEND                               58560099
505100     END-EVALUATE.                                                58570099
505200                                                                  58580099
505300******************************************************************58590099
505400 8455-CLOSE-PACK-UPC-CUR.                                         58600099
505500                                                                  58610099
505600     EXEC SQL                                                     58620099
505700         CLOSE PACK_UPC_CUR                                       58630099
505800     END-EXEC.                                                    58640099
505900                                                                  58650099
506000     EVALUATE TRUE                                                58660099
506100         WHEN SQLWARN0 NOT EQUAL SPACE                            58670099
506200         WHEN SQLCODE NOT EQUAL ZERO                              58680099
506300             DISPLAY '** ABEND **'                                58690099
506400             DISPLAY '** PROGRAM = TRKUP005 **'                   58700099
506500             DISPLAY '** PARAGRAPH = 8455-CLOSE-PACK-UPC-CUR*'    58710099
506600             PERFORM 9100-SQL-ABEND                               58720099
506700     END-EVALUATE.                                                58730099
506800                                                                  58740099
506900******************************************************************58750099
507000 8460-FETCH-PACK-UPC-CUR.                                         58760099
507100                                                                  58770099
507200     EXEC SQL                                                     58780099
507300          FETCH PACK_UPC_CUR                                      58790099
507400          INTO                                                    58800099
507500               :PURITM-PO-NBR                                     58810099
507600             , :PURITM-APP-PO-LNE-NBR                             58820099
507700             , :PURITM-PO-LNE-NBR                                 58830099
507800             , :XLT00004-VS-NBR                                   58840099
507900             , :XLT00003-CSTM-CLOR-DESC                           58850099
508000             , :XLT00003-SIZE-DESC                                58860099
508100             , :XLT00003-NRF-CLOR-CDE                             58870099
508200             , :XLT00003-SKU-DESC                                 58880099
508300             , :PURITM-ITM-NBR                                    58890099
508400             , :PURITM-STATUS-CDE                                 58900099
508500             , :PURITM-UNT-QTY                                    58910099
508600             , :PURITM-PREPK-RATO-QTY                             58920099
508700             , :UPC-UPC-NBR                                       58930099
508800             , :SKXREF-DEPT                                       58940099
508900             , :SKXREF-CLASS                                      58950099
509000             , :SKXREF-SUBCLASS                                   58960099
509100             , :SKXREF-SKU                                        58970099
509200     END-EXEC.                                                    58980099
509300                                                                  58990099
509400     EVALUATE TRUE                                                59000099
509500         WHEN SQLCODE = ZERO                                      59010099
509600             SET PS-LINES-ON-TPURITM TO TRUE                      59020099
509700             IF SKXREF-DEPT NUMERIC                               59030099
509800              IF SKXREF-DEPT > ZEROES                             59040099
509900                  MOVE SKXREF-DEPT TO TR006-DEPT-NBR              59050099
510000              END-IF                                              59060099
510100             END-IF                                               59070099
510200                                                                  59080099
510300         WHEN SQLCODE = +100                                      59090099
510400              IF PS-LINES-ON-TPURITM                              59100099
510500                  CONTINUE                                        59110099
510600              ELSE                                                59120099
510700                  INITIALIZE TR006-ERROR-MSG                      59130099
510800                  MOVE POPRPK-PK-SKU-NBR      TO TR006-SKU        59140099
510900                  MOVE POPRPK-PREPK-UPC-NBR   TO TR006-UPC-NBR    59150099
511000                  SET TR006-ERROR-TYPE-ERROR  TO TRUE             59160099
511100                  STRING 'NO DTL UPC/SKUS FR PCK PO-NT SNT'       59170099
511200                      DELIMITED BY SIZE                           59180099
511300                      INTO TR006-ERROR-MSG                        59190099
511400                  PERFORM 8830-WRITE-ERROR-LINE                   59200099
511500              END-IF                                              59210099
511600                                                                  59220099
511700              SET PS-EOC-PACK-UPC-CURSOR TO TRUE                  59230099
511800                                                                  59240099
511900         WHEN SQLWARN0 NOT EQUAL SPACE                            59250099
512000         WHEN SQLCODE NOT EQUAL ZERO                              59260099
512100             DISPLAY '** ABEND **'                                59270099
512200             DISPLAY '** PROGRAM = TRKUP005 **'                   59280099
512300             DISPLAY '** PARAGRAPH = 8460-FETCH-PACK-UPC-CUR'     59290099
512400             PERFORM 9100-SQL-ABEND                               59300099
512500     END-EVALUATE.                                                59310099
512600                                                                  59320099
512700 EJECT                                                            59330099
512800******************************************************************59340099
512900 8470-OPEN-E-COM-PACK-UPC-CUR.                                    59350099
513000                                                                  59360099
513100     EXEC SQL                                                     59370099
513200         OPEN E_COM_PACK_UPC_CUR                                  59380099
513300     END-EXEC.                                                    59390099
513400                                                                  59400099
513500     EVALUATE TRUE                                                59410099
513600         WHEN SQLWARN0 NOT EQUAL SPACE                            59420099
513700         WHEN SQLCODE NOT EQUAL ZERO                              59430099
513800            DISPLAY '** ABEND **'                                 59440099
513900            DISPLAY '** PROGRAM = TRKUP005 **'                    59450099
514000            DISPLAY '** PARAGRAPH = 8470-OPEN-E-COM-PACK-UPC-CUR' 59460099
514100            PERFORM 9100-SQL-ABEND                                59470099
514200     END-EVALUATE.                                                59480099
514300                                                                  59490099
514400******************************************************************59500099
514500 8472-FETCH-E-COM-PACK-UPC-CUR.                                   59510099
514600                                                                  59520099
514700     EXEC SQL                                                     59530099
514800          FETCH E_COM_PACK_UPC_CUR                                59540099
514900          INTO                                                    59550099
515000               :UPC-UPC-NBR                                       59560099
515100              ,:PURITM-PO-LNE-NBR                                 59570099
515200     END-EXEC.                                                    59580099
515300                                                                  59590099
515400     EVALUATE TRUE                                                59600099
515500         WHEN SQLCODE = ZERO                                      59610099
515600             CONTINUE                                             59620099
515700                                                                  59630099
515800         WHEN SQLCODE = +100                                      59640099
515900              SET PS-EOC-E-COM-PACK-UPC-CUR  TO TRUE              59650099
516000                                                                  59660099
516100         WHEN SQLWARN0 NOT EQUAL SPACE                            59670099
516200         WHEN SQLCODE NOT EQUAL ZERO                              59680099
516300            DISPLAY '** ABEND **'                                 59690099
516400            DISPLAY '** PROGRAM = TRKUP005 **'                    59700099
516500            DISPLAY '** PARAGRAPH = 8472-FETCH-E-COM-PACK-UPC-CUR'59710099
516600            PERFORM 9100-SQL-ABEND                                59720099
516700     END-EVALUATE.                                                59730099
516800                                                                  59740099
516900******************************************************************59750099
517000 8474-CLOSE-E-COM-PACK-UPC-CUR.                                   59760099
517100                                                                  59770099
517200     EXEC SQL                                                     59780099
517300         CLOSE E_COM_PACK_UPC_CUR                                 59790099
517400     END-EXEC.                                                    59800099
517500                                                                  59810099
517600     EVALUATE TRUE                                                59820099
517700         WHEN SQLWARN0 NOT EQUAL SPACE                            59830099
517800         WHEN SQLCODE NOT EQUAL ZERO                              59840099
517900          DISPLAY '** ABEND **'                                   59850099
518000          DISPLAY '** PROGRAM = TRKUP005 **'                      59860099
518100          DISPLAY '** PARAGRAPH = 8474-CLOSE-E-COM-PACK-UPC-CUR'  59870099
518200            PERFORM 9100-SQL-ABEND                                59880099
518300     END-EVALUATE.                                                59890099
518400                                                                  59900099
518500 EJECT                                                            59910099
518600******************************************************************59920099
518700 8500-OPEN-DC-CURSOR.                                             59930099
518800                                                                  59940099
518900     EXEC SQL                                                     59950099
519000          OPEN DC_CUR                                             59960099
519100     END-EXEC.                                                    59970099
519200                                                                  59980099
519300     EVALUATE TRUE                                                59990099
519400         WHEN SQLWARN0 NOT EQUAL SPACE                            60000099
519500         WHEN SQLCODE NOT EQUAL ZERO                              60010099
519600             DISPLAY '** ABEND **'                                60020099
519700             DISPLAY '** PROGRAM = TRKUP005 **'                   60030099
519800             DISPLAY '** PARAGRAPH = 8500-OPEN-DC-CURSOR **'      60040099
519900             PERFORM 9100-SQL-ABEND                               60050099
520000     END-EVALUATE.                                                60060099
520100                                                                  60070099
520200*                                                                 60080099
520300******************************************************************60090099
520400 8600-CLOSE-DC-CURSOR.                                            60100099
520500                                                                  60110099
520600                                                                  60120099
520700     EXEC SQL                                                     60130099
520800         CLOSE DC_CUR                                             60140099
520900     END-EXEC.                                                    60150099
521000                                                                  60160099
521100     EVALUATE TRUE                                                60170099
521200         WHEN SQLWARN0 NOT EQUAL SPACE                            60180099
521300         WHEN SQLCODE NOT EQUAL ZERO                              60190099
521400             DISPLAY '** ABEND **'                                60200099
521500             DISPLAY '** PROGRAM = TRKUP005 **'                   60210099
521600             DISPLAY '** PARAGRAPH = 8600-CLOSE-DC-CURSOR**'      60220099
521700             PERFORM 9100-SQL-ABEND                               60230099
521800     END-EVALUATE.                                                60240099
521900                                                                  60250099
522000*                                                                 60260099
522100******************************************************************60270099
522200 8700-FETCH-DC-CURSOR.                                            60280099
522300                                                                  60290099
522400     EXEC SQL                                                     60300099
522500          FETCH DC_CUR                                            60310099
522600          INTO                                                    60320099
522700                  :ALLPLN-DEST-NBR                                60330099
522800                , :ALLPLN-DC-SPLIT-QTY                            60340099
522900                , :ALLPLN-CURR-SPLIT-QTY                          60350099
523000                , :ALLPLN-PLAN-NBR                                60360099
155029                , :PV-FAST-E-BUS-IND                              60370099
523100     END-EXEC.                                                    60380099
523200                                                                  60390099
523300     EVALUATE TRUE                                                60400099
523400         WHEN SQLCODE = ZERO                                      60410099
523500             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 60420099
155029             IF PS-NEW-UPC-YES                                    60430099
155029                SET PS-NEW-UPC-NO      TO TRUE                    60440099
155029                SET PS-FIRST-UPC-YES   TO TRUE                    60450099
155029             END-IF                                               60460099
523600                                                                  60470099
523700         WHEN SQLCODE = +100                                      60480099
523800              IF PS-DC-SPLIT-INFO-PRESENT                         60490099
523900                  CONTINUE                                        60500099
524000              ELSE                                                60510099
524100                  INITIALIZE TR006-ERROR-MSG                      60520099
524200                  MOVE UPC-UPC-NBR  TO TR006-UPC-NBR              60530099
524300                  MOVE SKXREF-SKU   TO TR006-SKU                  60540099
524400               STRING 'BLK UPC MISSING SPLT-SPLT NT SNT'          60550099
524500                      DELIMITED BY SIZE                           60560099
524600                      INTO TR006-ERROR-MSG                        60570099
524700                  PERFORM 8710-MISSING-SPLIT-ERROR                60580099
524800              END-IF                                              60590099
524900                                                                  60600099
525000              SET PS-EOC-DC-CURSOR TO TRUE                        60610099
525100                                                                  60620099
525200         WHEN SQLWARN0 NOT EQUAL SPACE                            60630099
525300         WHEN SQLCODE NOT EQUAL ZERO                              60640099
525400             DISPLAY '** ABEND **'                                60650099
525500             DISPLAY '** PROGRAM = TRKUP005 **'                   60660099
525600             DISPLAY '** PARAGRAPH = 8700-FETCH-DC-CURSOR**'      60670099
525700             PERFORM 9100-SQL-ABEND                               60680099
525800     END-EVALUATE.                                                60690099
525900                                                                  60700099
526000******************************************************************60710099
526100 8710-MISSING-SPLIT-ERROR.                                        60720099
526200                                                                  60730099
526300     SET PS-SPLITS-ENTERED-NO      TO TRUE.                       60740099
526400     IF SHPTPO-PO-NBR  = PV-HOLD-PO-NBR                           60750099
526500         CONTINUE                                                 60760099
526600     ELSE                                                         60770099
526700         MOVE SHPTPO-PO-NBR  TO PV-HOLD-PO-NBR                    60780099
526800         SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE                 60790099
526900         PERFORM 8830-WRITE-ERROR-LINE                            60800099
527000     END-IF.                                                      60810099
527100                                                                  60820099
527200 EJECT                                                            60830099
527300                                                                  60840099
527400******************************************************************60850099
527500 8715-OPEN-POPRPK-FOR-PO-CUR.                                     60860099
527600                                                                  60870099
527700     EXEC SQL                                                     60880099
527800          OPEN POPRPK_FOR_PO_CUR                                  60890099
527900     END-EXEC.                                                    60900099
528000                                                                  60910099
528100     EVALUATE TRUE                                                60920099
528200         WHEN SQLWARN0 NOT EQUAL SPACE                            60930099
528300         WHEN SQLCODE NOT EQUAL ZERO                              60940099
528400             DISPLAY '** ABEND **'                                60950099
528500             DISPLAY '** PROGRAM = TRKUP005 **'                   60960099
528600             DISPLAY '** PARAGRAPH = 8715-OPEN-POPRPK-FOR-PO-CUR' 60970099
528700             PERFORM 9100-SQL-ABEND                               60980099
528800     END-EVALUATE.                                                60990099
528900                                                                  61000099
529000******************************************************************61010099
529100 8717-CLOSE-POPRPK-FOR-PO-CUR.                                    61020099
529200                                                                  61030099
529300     EXEC SQL                                                     61040099
529400         CLOSE POPRPK_FOR_PO_CUR                                  61050099
529500     END-EXEC.                                                    61060099
529600                                                                  61070099
529700     EVALUATE TRUE                                                61080099
529800         WHEN SQLWARN0 NOT EQUAL SPACE                            61090099
529900         WHEN SQLCODE NOT EQUAL ZERO                              61100099
530000             DISPLAY '** ABEND **'                                61110099
530100             DISPLAY '** PROGRAM = TRKUP005 **'                   61120099
530200             DISPLAY '** PARAGRAPH =8717-CLOSE-POPRPK-FOR-PO-CUR' 61130099
530300             PERFORM 9100-SQL-ABEND                               61140099
530400     END-EVALUATE.                                                61150099
530500                                                                  61160099
530600******************************************************************61170099
530700 8720-FETCH-POPRPK-FOR-PO-CUR.                                    61180099
530800                                                                  61190099
530900     EXEC SQL                                                     61200099
531000          FETCH POPRPK_FOR_PO_CUR                                 61210099
531100          INTO                                                    61220099
531200               :POPRPK-PO-PREPK-ID                                61230099
531300              ,:POPRPK-OTPK-UNT-QTY                               61240099
531400              ,:POPRPK-INPK-UNT-QTY                               61250099
531400              ,:POPRPK-PREPK-TYP-CDE                              61260099
531500     END-EXEC.                                                    61270099
531600                                                                  61280099
531700     EVALUATE TRUE                                                61290099
531800         WHEN SQLCODE = ZERO                                      61300099
531900             CONTINUE                                             61310099
532000                                                                  61320099
532100         WHEN SQLCODE = +100                                      61330099
532200              SET PS-EOC-POPRPK-FOR-PO-CUR TO TRUE                61340099
532300                                                                  61350099
532400         WHEN SQLWARN0 NOT EQUAL SPACE                            61360099
532500         WHEN SQLCODE NOT EQUAL ZERO                              61370099
532600            DISPLAY '** ABEND **'                                 61380099
532700            DISPLAY '** PROGRAM = TRKUP005 **'                    61390099
532800            DISPLAY '** PARAGRAPH = 8720-FETCH-POPRPK-FOR-PO-CUR' 61400099
532900            PERFORM 9100-SQL-ABEND                                61410099
533000     END-EVALUATE.                                                61420099
533100                                                                  61430099
533200 EJECT                                                            61440099
533300******************************************************************61450099
533400 8725-OPEN-PURITM-TUPC-CUR.                                       61460099
533500                                                                  61470099
533600     EXEC SQL                                                     61480099
533700          OPEN PURITM_TUPC_CUR                                    61490099
533800     END-EXEC.                                                    61500099
533900                                                                  61510099
534000     EVALUATE TRUE                                                61520099
534100         WHEN SQLWARN0 NOT EQUAL SPACE                            61530099
534200         WHEN SQLCODE NOT EQUAL ZERO                              61540099
534300             DISPLAY '** ABEND **'                                61550099
534400             DISPLAY '** PROGRAM = TRKUP005 **'                   61560099
534500             DISPLAY '** PARAGRAPH = 8725-OPEN-PURITM-TUPC-CUR'   61570099
534600             PERFORM 9100-SQL-ABEND                               61580099
534700     END-EVALUATE.                                                61590099
534800                                                                  61600099
534900                                                                  61610099
535000******************************************************************61620099
535100 8727-CLOSE-PURITM-TUPC-CUR.                                      61630099
535200                                                                  61640099
535300     EXEC SQL                                                     61650099
535400         CLOSE PURITM_TUPC_CUR                                    61660099
535500     END-EXEC.                                                    61670099
535600                                                                  61680099
535700     EVALUATE TRUE                                                61690099
535800         WHEN SQLWARN0 NOT EQUAL SPACE                            61700099
535900         WHEN SQLCODE NOT EQUAL ZERO                              61710099
536000             DISPLAY '** ABEND **'                                61720099
536100             DISPLAY '** PROGRAM = TRKUP005 **'                   61730099
536200             DISPLAY '** PARAGRAPH = 8727-CLOSE-PURITM-TUPC-CUR'  61740099
536300             PERFORM 9100-SQL-ABEND                               61750099
536400     END-EVALUATE.                                                61760099
536500                                                                  61770099
536600******************************************************************61780099
536700 8730-FETCH-PURITM-TUPC-CUR.                                      61790099
536800                                                                  61800099
536900     EXEC SQL                                                     61810099
537000          FETCH PURITM_TUPC_CUR                                   61820099
537100          INTO                                                    61830099
537200              :PURITM-OUTR-PK-QTY                                 61840099
537300             ,:PURITM-UNT-QTY                                     61850099
537400     END-EXEC.                                                    61860099
537500                                                                  61870099
537600     EVALUATE TRUE                                                61880099
537700         WHEN SQLCODE = ZERO                                      61890099
537800             CONTINUE                                             61900099
537900                                                                  61910099
538000         WHEN SQLCODE = +100                                      61920099
538100              SET PS-EOC-PURITM-TUPC-CUR TO TRUE                  61930099
538200                                                                  61940099
538300         WHEN SQLWARN0 NOT EQUAL SPACE                            61950099
538400         WHEN SQLCODE NOT EQUAL ZERO                              61960099
538500            DISPLAY '** ABEND **'                                 61970099
538600            DISPLAY '** PROGRAM = TRKUP005 **'                    61980099
538700            DISPLAY '** PARAGRAPH = 8730-FETCH-PURITM-TUPC-CUR'   61990099
538800            PERFORM 9100-SQL-ABEND                                62000099
538900     END-EVALUATE.                                                62010099
539000                                                                  62020099
539100 EJECT                                                            62030099
539200******************************************************************62040099
539300 8735-OPEN-POPRPK-FOR-PCK-CUR.                                    62050099
539400                                                                  62060099
539500     EXEC SQL                                                     62070099
539600          OPEN POPRPK_FOR_PCK_CUR                                 62080099
539700     END-EXEC.                                                    62090099
539800                                                                  62100099
539900     EVALUATE TRUE                                                62110099
540000         WHEN SQLWARN0 NOT EQUAL SPACE                            62120099
540100         WHEN SQLCODE NOT EQUAL ZERO                              62130099
540200            DISPLAY '** ABEND **'                                 62140099
540300            DISPLAY '** PROGRAM = TRKUP005 **'                    62150099
540400            DISPLAY '** PARAGRAPH = 8735-OPEN-POPRPK-FOR-PCK-CUR' 62160099
540500            PERFORM 9100-SQL-ABEND                                62170099
540600     END-EVALUATE.                                                62180099
540700                                                                  62190099
540800******************************************************************62200099
540900 8740-CLOSE-POPRPK-FOR-PCK-CUR.                                   62210099
541000                                                                  62220099
541100     EXEC SQL                                                     62230099
541200         CLOSE POPRPK_FOR_PCK_CUR                                 62240099
541300     END-EXEC.                                                    62250099
541400                                                                  62260099
541500     EVALUATE TRUE                                                62270099
541600         WHEN SQLWARN0 NOT EQUAL SPACE                            62280099
541700         WHEN SQLCODE NOT EQUAL ZERO                              62290099
541800           DISPLAY '** ABEND **'                                  62300099
541900           DISPLAY '** PROGRAM = TRKUP005 **'                     62310099
542000           DISPLAY '** PARAGRAPH =8740-CLOSE-POPRPK-FOR-PCK-CUR'  62320099
542100           PERFORM 9100-SQL-ABEND                                 62330099
542200     END-EVALUATE.                                                62340099
542300                                                                  62350099
542400******************************************************************62360099
542500 8745-FETCH-POPRPK-FOR-PCK-CUR.                                   62370099
542600                                                                  62380099
542700     EXEC SQL                                                     62390099
542800          FETCH POPRPK_FOR_PCK_CUR                                62400099
542900          INTO                                                    62410099
543000               :POPRPK-PO-PREPK-ID                                62420099
543100             , :POPRPK-INPK-UNT-QTY                               62430099
543200             , :POPRPK-OTPK-UNT-QTY                               62440099
543300             , :POPRPK-PREPK-DESC                                 62450099
543400             , :POPRPK-PREPK-UPC-NBR                              62460099
543500             , :POPRPK-PK-SKU-NBR                                 62470099
543500             , :POPRPK-PREPK-TYP-CDE                              62480099
543600     END-EXEC.                                                    62490099
543700                                                                  62500099
543800     EVALUATE TRUE                                                62510099
543900         WHEN SQLCODE = ZERO                                      62520099
155029              SET PS-NEW-UPC-YES      TO TRUE                     62530099
155029              MOVE SPACES             TO PV-HOLD-OUT-RECORD       62540099
544100                                                                  62550099
544200         WHEN SQLCODE = +100                                      62560099
544300              SET PS-EOC-PACK-CURSOR TO TRUE                      62570099
544400                                                                  62580099
544500         WHEN SQLWARN0 NOT EQUAL SPACE                            62590099
544600         WHEN SQLCODE NOT EQUAL ZERO                              62600099
544700          DISPLAY '** ABEND **'                                   62610099
544800          DISPLAY '** PROGRAM = TRKUP005 **'                      62620099
544900          DISPLAY '** PARAGRAPH = 8745-FETCH-POPRPK-FOR-PCK-CUR'  62630099
545000          PERFORM 9100-SQL-ABEND                                  62640099
545100     END-EVALUATE.                                                62650099
545200                                                                  62660099
545300******************************************************************62670099
545400 8830-WRITE-ERROR-LINE.                                           62680099
545500                                                                  62690099
545600     SET TR006-XMIT-RPT               TO TRUE.                    62700099
545700     MOVE 'VS'                        TO TR006-TRIP-TYPE.         62710099
545800     MOVE PC-CURRENT-PROGRAM-NAME     TO TR006-PGM-NAME.          62720099
545900                                                                  62730099
546000     MOVE TR006-RECORD                TO OUTTR3-TRGL-ERR-RPT-ODR. 62740099
546100     ADD +1                           TO PA-ERROR-COUNT.          62750099
546200                                                                  62760099
546300     PERFORM 8840-INSERT-ERROR.                                   62770099
546400                                                                  62780099
546500******************************************************************62790099
546600 8840-INSERT-ERROR.                                               62800099
546700                                                                  62810099
546800     EXEC SQL                                                     62820099
546900         INSERT INTO TOUTTR3                                      62830099
547000             (TRGL_ERR_RPT_ODR)                                   62840099
547100            VALUES  (:OUTTR3-TRGL-ERR-RPT-ODR)                    62850099
547200     END-EXEC                                                     62860099
547300                                                                  62870099
547400     EVALUATE TRUE                                                62880099
547500         WHEN SQLWARN0 NOT EQUAL SPACE                            62890099
547600         WHEN SQLCODE NOT EQUAL ZERO                              62900099
547700             DISPLAY '** ABEND **'                                62910099
547800             DISPLAY '** PROGRAM = TRKUP005 **'                   62920099
547900             DISPLAY '** PARAGRAPH = 8840-INSERT-ERROR**'         62930099
548000             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR3**'         62940099
548100             PERFORM 9100-SQL-ABEND                               62950099
548200     END-EVALUATE.                                                62960099
548300                                                                  62970099
548400 EJECT                                                            62980099
548500******************************************************************62990099
548600* WRITE PACK (PCK) RECORD TYPE FOR DETAIL REPORT RECORD.         *63000099
548700******************************************************************63010099
548800 8847-WRITE-DTL-RPT-PCK-RECORD.                                   63020099
548900                                                                  63030099
549000     MOVE '40PCK'                     TO TR020-REC-TYPE-CDE-PCK.  63040099
549100     SET TR020-XMIT-RPT-PCK           TO TRUE.                    63050099
549200     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PCK.        63060099
549300     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PCK.  63070099
549400     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PCK.     63080099
549500     MOVE TR004-PACK-ID               TO TR020-PACK-ID-PCK.       63090099
549600     MOVE TR004-PACK-UNITS-PER-CTN    TO TR020-UNITS-PER-CTN-PCK. 63100099
549700     MOVE TR004-PACK-CART-CT          TO TR020-CART-CT-PCK.       63110099
549800     MOVE TR004-PACK-UNIT-QTY         TO TR020-UNIT-QTY-PCK.      63120099
549900     MOVE TR004-PACK-DESC             TO TR020-DESC-PCK.          63130099
550000     MOVE TR004-PACKS-PER-CART       TO TR020-PACKS-PER-CART-PCK. 63140099
550100     MOVE TR004-PACK-UPC-NBR         TO TR020-UPC-NBR-PCK.        63150099
550200     MOVE TR004-PACK-SKU             TO TR020-SKU-PCK.            63160099
550300     MOVE PC-NA                      TO TR020-ASN-PKGNG-CDE-PCK.  63170099
550400                                                                  63180099
550500     MOVE TR020-REC-TYPE-PCK    TO OUTTR4-TRGL-DTL-RPT-1-ODR.     63190099
550600                                                                  63200099
550700     PERFORM 8880-INSERT-DETAIL.                                  63210099
550800                                                                  63220099
550900******************************************************************63230099
551000* WRITE PACK DC (PDC) RECORD TYPE FOR DETAIL REPORT RECORD.      *63240099
551100******************************************************************63250099
551200 8848-WRITE-DTL-RPT-PDC-RECORD.                                   63260099
551300                                                                  63270099
551400     MOVE '50PDC'                     TO TR020-REC-TYPE-CDE-PDC.  63280099
551500     SET TR020-XMIT-RPT-PDC           TO TRUE.                    63290099
551600     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PDC.        63300099
551700     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PDC.  63310099
551800     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PDC.     63320099
551900     MOVE TR020-PACK-ID-PCK           TO TR020-PACK-ID-PDC.       63330099
552000     MOVE TR004-PDC-DIST-CNTR         TO TR020-DIST-CNTR-PDC.     63340099
552100     MOVE TR004-PDC-UNIT-QTY          TO TR020-UNIT-QTY-PDC.      63350099
552200     MOVE TR004-PDC-PERCNT            TO TR020-PERCNT-PDC.        63360099
552300     MOVE TR004-PDC-CART-CT           TO TR020-CART-CT-PDC.       63370099
552400                                                                  63380099
552500     MOVE TR020-REC-TYPE-PDC     TO OUTTR4-TRGL-DTL-RPT-1-ODR.    63390099
552600                                                                  63400099
552700     PERFORM 8880-INSERT-DETAIL.                                  63410099
552800                                                                  63420099
552900******************************************************************63430099
553000* WRITE PURCHASE ORDER RECORD TYPE FOR DETAIL REPORT RECORD.     *63440099
553100******************************************************************63450099
553200 8850-WRITE-DTL-RPT-PO-RECORD.                                    63460099
553300                                                                  63470099
553400     MOVE '10PO '                     TO TR020-REC-TYPE-CDE-PO.   63480099
553500     SET TR020-XMIT-RPT-PO            TO TRUE.                    63490099
553600     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PO.         63500099
553700     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PO.   63510099
553800     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PO.      63520099
553900     MOVE TR004-VENDOR-NAME           TO TR020-VENDOR-NAME-PO.    63530099
554000     MOVE TR006-DONT-SHIP-BEFORE-DATE                             63540099
554100                               TO TR020-DO-NOT-SHIP-BEF-DTE-PO.   63550099
554200     MOVE TR004-CANCEL-DATE           TO TR020-CANCEL-DATE-PO.    63560099
554300     MOVE TR004-OPEN-TO-BUY-PERIOD                                63570099
554400                                 TO TR020-OPEN-TO-BUY-PERIOD-PO.  63580099
554500     MOVE TR004-PKGNG-CDE        TO TR020-PKGNG-CDE-PO.           63590099
554600     MOVE TR004-PO-TYP-CDE       TO TR020-PO-TYP-CDE-PO.          63600099
554700                                                                  63610099
554800     MOVE TR004-AD-DATE               TO TR020-AD-DATE-PO.        63620099
554900     MOVE PC-CURRENT-PROGRAM-NAME     TO TR020-PGM-NAME.          63630099
555000                                                                  63640099
555100     MOVE TR020-REC-TYPE-PO        TO OUTTR4-TRGL-DTL-RPT-1-ODR.  63650099
555200                                                                  63660099
555300     PERFORM 8880-INSERT-DETAIL.                                  63670099
555400                                                                  63680099
555500******************************************************************63690099
555600* WRITE INSTURCTIONS RECORD TYPE FOR DETAIL REPORT RECORD.       *63700099
555700******************************************************************63710099
555800 8852-WRITE-DTL-RPT-INS-RECORD.                                   63720099
555900                                                                  63730099
556000     MOVE '20INS'                     TO TR020-REC-TYPE-CDE-INS.  63740099
556100     SET TR020-XMIT-RPT-INS           TO TRUE.                    63750099
556200     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-INS.        63760099
556300     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-INS.  63770099
556400     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-INS.     63780099
556500     MOVE TR004-SPEC-INSTR            TO TR020-SPEC-INSTR-INS.    63790099
556600                                                                  63800099
556700     MOVE TR020-REC-TYPE-INS-1  TO OUTTR4-TRGL-DTL-RPT-1-ODR.     63810099
556800     MOVE TR020-REC-TYPE-INS-2  TO OUTTR4-TRGL-DTL-RPT-2-ODR.     63820099
556900                                                                  63830099
557000     PERFORM 8880-INSERT-DETAIL.                                  63840099
557100                                                                  63850099
557200******************************************************************63860099
557300* WRITE PURCHASE ORDER LINE RECORD TYPE FOR DETAIL REPORT RECORD.*63870099
557400******************************************************************63880099
557500 8854-WRITE-DTL-RPT-UPC-RECORD.                                   63890099
557600                                                                  63900099
557700     MOVE '60UPC'                     TO TR020-REC-TYPE-CDE-UPC.  63910099
557800     SET TR020-XMIT-RPT-UPC           TO TRUE.                    63920099
557900     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-UPC.        63930099
558000     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-UPC.  63940099
558100     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-UPC.     63950099
558200     IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           63960099
558300         MOVE TR020-PACK-ID-PCK       TO TR020-PACK-ID-UPC        63970099
558400     ELSE                                                         63980099
558500         MOVE ZEROS                   TO TR020-PACK-ID-UPC        63990099
558600     END-IF.                                                      64000099
558700     MOVE TR004-VEND-STYL-NAME       TO TR020-VEND-STYL-NAME-UPC. 64010099
558800     MOVE TR004-UPC-COLOR-CDE         TO TR020-COLOR-CDE-UPC.     64020099
558900     MOVE TR004-UPC-SIZE-DESC         TO TR020-SIZE-DESC-UPC.     64030099
559000     MOVE TR004-UPC-NBR               TO TR020-UPC-NBR-UPC.       64040099
559100     MOVE TR004-UPC-COLOR-DESC        TO TR020-COLOR-DESC-UPC.    64050099
559200     MOVE TR004-SKU-DESC              TO TR020-SKU-DESC-UPC.      64060099
559300     MOVE TR004-DEPT-NBR              TO TR020-DEPT-NBR-UPC.      64070099
559400     MOVE TR004-CLASS                 TO TR020-CLASS-UPC.         64080099
559500     MOVE TR004-SUB-CLASS             TO TR020-SUB-CLASS-UPC.     64090099
559600     MOVE TR004-SKU-SEQ-NBR           TO TR020-SKU-UPC.           64100099
559700     MOVE TR004-OUTR-PK-QTY           TO TR020-OUTR-PK-QTY-UPC.   64110099
559800     MOVE TR004-PACK-RATIO-QTY        TO TR020-PACK-RATIO-QTY-UPC.64120099
559900     MOVE TR004-UPC-UNIT-QTY          TO TR020-UNIT-QTY-UPC.      64130099
560000     MOVE PC-NA                       TO TR020-ASN-PKGNG-CDE-UPC. 64140099
560100                                                                  64150099
560200     MOVE TR020-REC-TYPE-UPC     TO OUTTR4-TRGL-DTL-RPT-1-ODR.    64160099
560300                                                                  64170099
560400     PERFORM 8880-INSERT-DETAIL.                                  64180099
560500                                                                  64190099
560600                                                                  64200099
560700******************************************************************64210099
560800* WRITE CONTAINER/VESSEL RECORD TYPE FOR DETAIL REPORT RECORD.   *64220099
560900******************************************************************64230099
561000 8856-WRITE-DTL-RPT-CON-RECORD.                                   64240099
561100                                                                  64250099
561200     SET TR020-REC-TYPE-CDE-CON-CONTNR   TO TRUE.                 64260099
561300     SET TR020-XMIT-RPT-CONTNR           TO TRUE.                 64270099
561400     MOVE PV-HOLD-TR020-PROCESS-DATE                              64280099
561500                                   TO TR020-PROCESS-DATE-CONTNR.  64290099
561600     MOVE TR004-CART-PER-PO        TO TR020-EXP-CART-CT-CONTNR.   64300099
561700     MOVE PV-HOLD-TR020-CONTNR-ID  TO TR020-CONTNR-ID-CONTNR.     64310099
561800     MOVE PV-HOLD-TR020-PO-NBR     TO TR020-PO-NBR-CONTNR.        64320099
561900     MOVE TR004-PO-UNIT-QTY        TO TR020-UNIT-QTY-CONTNR.      64330099
562000                                                                  64340099
562100     MOVE TR020-REC-TYPE-CONTNR    TO OUTTR4-TRGL-DTL-RPT-1-ODR.  64350099
562200                                                                  64360099
562300     PERFORM 8880-INSERT-DETAIL.                                  64370099
562400                                                                  64380099
562500******************************************************************64390099
562600 8870-WRITE-DTL-RPT-DC-RECORD.                                    64400099
562700                                                                  64410099
562800     MOVE '70DC '                  TO TR020-REC-TYPE-CDE-DC.      64420099
562900     SET  TR020-XMIT-RPT-DC        TO TRUE.                       64430099
563000     MOVE PV-HOLD-TR020-PROCESS-DATE                              64440099
563100                                   TO TR020-PROCESS-DATE-DC.      64450099
563200     MOVE TR020-PO-NBR-UPC         TO TR020-PO-NBR-DC.            64460099
563300     MOVE TR020-CONTNR-ID-UPC      TO TR020-CONTNR-ID-DC.         64470099
563400     MOVE ZERO                     TO TR020-PACK-ID-DC.           64480099
563500     MOVE TR020-VEND-STYL-NAME-UPC TO TR020-VEND-STYL-NAME-DC.    64490099
563600     MOVE TR020-COLOR-CDE-UPC      TO TR020-COLOR-CDE-DC.         64500099
563700     MOVE TR020-SIZE-DESC-UPC      TO TR020-SIZE-DESC-DC.         64510099
563800     MOVE TR004-DIST-CNTR          TO TR020-DIST-CNTR-DC.         64520099
563900**** **********  UPC NUMBER FOR FUTURE USE  ************          64530099
564000**** MOVE XXX                      TO TR020-UPC-NBR-DC.           64540099
564100     MOVE TR004-DC-UNIT-QTY        TO TR020-UNIT-QTY-DC.          64550099
564200     MOVE TR004-DC-PERCNT          TO TR020-PERCNT-DC.            64560099
564300     MOVE TR004-DC-CART-CT         TO TR020-CART-CT-DC.           64570099
564400                                                                  64580099
564500     MOVE TR020-REC-TYPE-DC     TO OUTTR4-TRGL-DTL-RPT-1-ODR.     64590099
564600                                                                  64600099
564700     PERFORM 8880-INSERT-DETAIL.                                  64610099
564800                                                                  64620099
564900******************************************************************64630099
565000 8880-INSERT-DETAIL.                                              64640099
565100                                                                  64650099
565200     EXEC SQL                                                     64660099
565300         INSERT INTO TOUTTR4                                      64670099
565400             (TRGL_DTL_RPT_1_ODR                                  64680099
565500             ,TRGL_DTL_RPT_2_ODR)                                 64690099
565600            VALUES  (:OUTTR4-TRGL-DTL-RPT-1-ODR                   64700099
565700                    ,:OUTTR4-TRGL-DTL-RPT-2-ODR)                  64710099
565800     END-EXEC                                                     64720099
565900                                                                  64730099
566000     EVALUATE TRUE                                                64740099
566100                                                                  64750099
566200         WHEN SQLWARN0 NOT EQUAL SPACE                            64760099
566300         WHEN SQLCODE NOT EQUAL ZERO                              64770099
566400             DISPLAY '** ABEND **'                                64780099
566500             DISPLAY '** PROGRAM = TRKUP005 **'                   64790099
566600             DISPLAY '** PARAGRAPH = 8880-INSERT-DETAIL*'         64800099
566700             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR4**'         64810099
566800             PERFORM 9100-SQL-ABEND                               64820099
566900     END-EVALUATE.                                                64830099
567000                                                                  64840099
567100     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    64850099
567200                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   64860099
567300 EJECT                                                            64870099
139868******************************************************************64880099
139868 8890-OUTLET-STORE-PREPACK.                                       64890099
139868                                                                  64900099
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     64910099
155029     PERFORM 7835-RETRIEVE-PLAN-NBR.                              64920099
155029                                                                  64930099
155029     PERFORM 2521-SUM-SPLIT-QTY.                                  64940099
155029                                                                  64950099
139868     PERFORM 8906-OPEN-PRPACK-DC-STR-CSR.                         64960099
139868                                                                  64970099
139868     PERFORM 8920-PROCESS-STORE-PRPK-CSR                          64980099
139868       UNTIL PS-EOC-STORE-CURSOR.                                 64990099
139868                                                                  65000099
139868     PERFORM 8911-CLOSE-PRPACK-DC-STR-CSR.                        65010099
139868                                                                  65020099
139868******************************************************************65030099
139868 8900-OUTLET-STORE-DC.                                            65040099
139868                                                                  65050099
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     65060099
155029     PERFORM 7835-RETRIEVE-PLAN-NBR.                              65070099
139868     PERFORM 8905-OPEN-DC-STORE-CSR.                              65080099
139868                                                                  65090099
139868     PERFORM 8950-PROCESS-STORE-DC-CURSOR                         65100099
139868       UNTIL PS-EOC-STORE-CURSOR.                                 65110099
139868                                                                  65120099
139868     PERFORM 8910-CLOSE-DC-STORE-CSR.                             65130099
139868                                                                  65140099
139868******************************************************************65150099
139868 8905-OPEN-DC-STORE-CSR.                                          65160099
139868                                                                  65170099
139868     EXEC SQL                                                     65180099
139868          OPEN DC_OUT_CUR                                         65190099
139868     END-EXEC.                                                    65200099
139868                                                                  65210099
139868     EVALUATE TRUE                                                65220099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65230099
139868         WHEN SQLCODE NOT EQUAL ZERO                              65240099
139868             DISPLAY '** ABEND **'                                65250099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   65260099
139868             DISPLAY '** PARAGRAPH = 8905-OPEN-DC-STORE-CSR **'   65270099
139868             DISPLAY '**PO_NBR     = '  PURITM-PO-NBR             65280099
139868             DISPLAY '**PO_LNE_NBR = '  PURITM-PO-LNE-NBR         65290099
155029             DISPLAY '**PLAN_NBR   = '  ALLPLN-PLAN-NBR           65300099
139868             PERFORM 9100-SQL-ABEND                               65310099
139868     END-EVALUATE.                                                65320099
139868                                                                  65330099
139868******************************************************************65340099
139868 8906-OPEN-PRPACK-DC-STR-CSR.                                     65350099
139868                                                                  65360099
139868     EXEC SQL                                                     65370099
139868          OPEN PRPACK_DC_OUT_CUR                                  65380099
139868     END-EXEC.                                                    65390099
139868                                                                  65400099
139868     EVALUATE TRUE                                                65410099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65420099
139868         WHEN SQLCODE NOT EQUAL ZERO                              65430099
139868             DISPLAY '** ABEND **'                                65440099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   65450099
139868             DISPLAY '** PARAGRAPH = 8906-OPEN-PRPACK-DC-STR-CSR' 65460099
139868             DISPLAY 'PO-NBR       = ' PURCHS-PO-NBR              65470099
139868             DISPLAY 'PO-PREPK-ID  = ' POPRPK-PO-PREPK-ID         65480099
155029             DISPLAY 'PLAN-NBR     = ' ALLPLN-PLAN-NBR            65490099
139868             PERFORM 9100-SQL-ABEND                               65500099
139868     END-EVALUATE.                                                65510099
139868                                                                  65520099
139868******************************************************************65530099
139868 8910-CLOSE-DC-STORE-CSR.                                         65540099
139868                                                                  65550099
139868     EXEC SQL                                                     65560099
139868         CLOSE DC_OUT_CUR                                         65570099
139868     END-EXEC.                                                    65580099
139868                                                                  65590099
139868     EVALUATE TRUE                                                65600099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65610099
139868         WHEN SQLCODE NOT EQUAL ZERO                              65620099
139868             DISPLAY '** ABEND **'                                65630099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   65640099
139868             DISPLAY '** PARAGRAPH = 8910-CLOSE-DC-STORE-CSR**'   65650099
139868             PERFORM 9100-SQL-ABEND                               65660099
139868     END-EVALUATE.                                                65670099
139868                                                                  65680099
139868******************************************************************65690099
139868 8911-CLOSE-PRPACK-DC-STR-CSR.                                    65700099
139868                                                                  65710099
139868     EXEC SQL                                                     65720099
139868         CLOSE PRPACK_DC_OUT_CUR                                  65730099
139868     END-EXEC.                                                    65740099
139868                                                                  65750099
139868     EVALUATE TRUE                                                65760099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65770099
139868         WHEN SQLCODE NOT EQUAL ZERO                              65780099
139868             DISPLAY '** ABEND **'                                65790099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   65800099
139868             DISPLAY '** PARAGRAPH = 8911-CLOSE-PRPACK-DC-STR-CSR'65810099
139868             PERFORM 9100-SQL-ABEND                               65820099
139868     END-EVALUATE.                                                65830099
139868                                                                  65840099
139868******************************************************************65850099
139868 8915-FETCH-DC-STORE-CSR.                                         65860099
139868                                                                  65870099
139868     EXEC SQL                                                     65880099
139868          FETCH DC_OUT_CUR                                        65890099
139868           INTO :MESTDS-STR-NBR                                   65900099
139868              , :MESTDS-STR-DISTRO-QTY                            65910099
139868     END-EXEC.                                                    65920099
139868                                                                  65930099
139868     EVALUATE TRUE                                                65940099
139868         WHEN SQLCODE = ZERO                                      65950099
139868             CONTINUE                                             65960099
139868                                                                  65970099
139868         WHEN SQLCODE = +100                                      65980099
139868              SET PS-EOC-STORE-CURSOR     TO TRUE                 65990099
139868              IF PS-FIRST-STORE                                   66000099
139868                  SET PS-EOC-DC-CURSOR                            66010099
139868                      PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE         66020099
139868                  PERFORM 8600-CLOSE-DC-CURSOR                    66030099
139868                  INITIALIZE TR006-ERROR-MSG                      66040099
139868                  MOVE POPRPK-PK-SKU-NBR         TO TR006-SKU     66050099
139868                  MOVE POPRPK-PREPK-UPC-NBR      TO TR006-UPC-NBR 66060099
139868                  SET TR006-ERROR-TYPE-MISS-SPLT TO TRUE          66070099
139868                  STRING 'BLK PO MISSING SPLIT-FIX/OUTLET'        66080099
139868                      DELIMITED BY SIZE                           66090099
139868                      INTO TR006-ERROR-MSG                        66100099
139868                  PERFORM 8830-WRITE-ERROR-LINE                   66110099
139868                  SET PS-SPLITS-ENTERED-NO      TO TRUE           66120099
139868              END-IF                                              66130099
139868                                                                  66140099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            66150099
139868         WHEN SQLCODE NOT EQUAL ZERO                              66160099
139868             DISPLAY '** ABEND **'                                66170099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   66180099
139868             DISPLAY '** PARAGRAPH = 8915-FETCH-DC-STORE-CSR**'   66190099
139868             DISPLAY '**PO_NBR     = '  PURITM-PO-NBR             66200099
139868             DISPLAY '**PO_LNE_NBR = '  PURITM-PO-LNE-NBR         66210099
155029             DISPLAY '**PLAN_NBR   = '  ALLPLN-PLAN-NBR           66220099
139868             PERFORM 9100-SQL-ABEND                               66230099
139868     END-EVALUATE.                                                66240099
139868                                                                  66250099
139868******************************************************************66260099
139868 8916-FETCH-PRPACK-DC-STR-CSR.                                    66270099
139868                                                                  66280099
139868     EXEC SQL                                                     66290099
139868          FETCH PRPACK_DC_OUT_CUR                                 66300099
139868           INTO :MESTDS-STR-NBR                                   66310099
139868               ,:MESTDS-STR-DISTRO-QTY                            66320099
139868     END-EXEC.                                                    66330099
139868                                                                  66340099
139868     EVALUATE TRUE                                                66350099
139868         WHEN SQLCODE = ZERO                                      66360099
139868             CONTINUE                                             66370099
139868                                                                  66380099
139868         WHEN SQLCODE = +100                                      66390099
139868              SET PS-EOC-STORE-CURSOR     TO TRUE                 66400099
139868              IF PS-FIRST-STORE                                   66410099
141519**                SET PS-EOC-DC-CURSOR                            66420099
141519                  SET PS-EOC-PREPACK-DC-CURSOR                    66430099
139868                      PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE         66440099
139868                  PERFORM 8425-CLOSE-PACK-DC-CURSOR               66450099
139868                  INITIALIZE TR006-ERROR-MSG                      66460099
139868                  MOVE POPRPK-PK-SKU-NBR         TO TR006-SKU     66470099
139868                  MOVE POPRPK-PREPK-UPC-NBR      TO TR006-UPC-NBR 66480099
139868                  SET TR006-ERROR-TYPE-MISS-SPLT TO TRUE          66490099
139868                  STRING 'PCK PO MISSING SPLIT-FIX/OUTLET'        66500099
139868                      DELIMITED BY SIZE                           66510099
139868                      INTO TR006-ERROR-MSG                        66520099
139868                  PERFORM 8830-WRITE-ERROR-LINE                   66530099
139868                  SET PS-SPLITS-ENTERED-NO      TO TRUE           66540099
139868              END-IF                                              66550099
139868                                                                  66560099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            66570099
139868         WHEN SQLCODE NOT EQUAL ZERO                              66580099
139868             DISPLAY '** ABEND **'                                66590099
139868             DISPLAY '** PROGRAM = TRKUP005 **'                   66600099
139868             DISPLAY '** PARAGRAPH = 8916-FETCH-PRPACK-DC-STR-CSR'66610099
139868             DISPLAY 'PO-NBR       = ' PURCHS-PO-NBR              66620099
139868             DISPLAY 'PO-PREPK-ID  = ' POPRPK-PO-PREPK-ID         66630099
155029             DISPLAY 'PLAN-NBR     = ' ALLPLN-PLAN-NBR            66640099
139868             PERFORM 9100-SQL-ABEND                               66650099
139868     END-EVALUATE.                                                66660099
139868                                                                  66670099
139868******************************************************************66680099
139868 8920-PROCESS-STORE-PRPK-CSR.                                     66690099
139868                                                                  66700099
139868     PERFORM 8916-FETCH-PRPACK-DC-STR-CSR.                        66710099
139868                                                                  66720099
139868     IF PS-EOC-STORE-CURSOR                                       66730099
139868         IF PS-DC-SPLIT-INFO-PRESENT                              66740099
155029            SET PS-OUTLET-STORE-NO TO TRUE                        66750099
139868            PERFORM 2516-ADJUST-ROUNDED-OUT-DIST                  66760099
139868            PERFORM 5756-WRITE-PDC-REC                            66770099
139868         END-IF                                                   66780099
139868     ELSE                                                         66790099
139868         IF PS-FIRST-STORE                                        66800099
139868           SET PS-FIRST-STORE-NO     TO TRUE                      66810099
155029           SET PS-FIRST-DC-NO        TO TRUE                      66820099
139868           INITIALIZE PV-TTL-ALL-DCS-PCT                          66830099
139868                      PV-TTL-ALL-DCS-UNITS                        66840099
139868                      PV-TTL-ALL-DCS-CARTS                        66850099
139868         ELSE                                                     66860099
139868*           **********************************************        66870099
139868*           * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *        66880099
139868*           * FROM THE PRIOR STORE                       *        66890099
139868*           **********************************************        66900099
139868             PERFORM 5756-WRITE-PDC-REC                           66910099
139868         END-IF                                                   66920099
139868                                                                  66930099
139868         INITIALIZE TR004-REC-TYPE-PDC                            66940099
139868         MOVE MESTDS-STR-NBR         TO TR004-PDC-DIST-CNTR       66950099
139868                                                                  66960099
139868         MOVE MESTDS-STR-DISTRO-QTY  TO TR004-PDC-UNIT-QTY        66970099
139868                                                                  66980099
155029         IF PV-FAST-E-BUS-IND = 'Y'                               66990099
155029            DIVIDE PA-TOTAL-CURR-SPLIT-QTY                        67000099
155029              INTO MESTDS-STR-DISTRO-QTY                          67010099
155029                GIVING PV-QUOTIENT-ORDER-PERCENT                  67020099
155029         ELSE                                                     67030099
140332             DIVIDE PV-HOLD-PCK-UNIT-QTY                          67040099
140332               INTO MESTDS-STR-DISTRO-QTY                         67050099
140332                 GIVING PV-QUOTIENT-ORDER-PERCENT                 67060099
155029         END-IF                                                   67070099
140332         MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                    67080099
140332             100 GIVING TR004-PDC-PERCNT ROUNDED                  67090099
139868                                                                  67100099
139868         IF TR004-PDC-PERCNT = ZERO                               67110099
139868            MOVE +1 TO TR004-PDC-PERCNT                           67120099
139868         END-IF                                                   67130099
139868         ADD  TR004-PDC-PERCNT       TO PV-TTL-ALL-DCS-PCT        67140099
139868                                                                  67150099
139868         DIVIDE PV-HOLD-PCK-UNIT-PER-CTN                          67160099
139868           INTO MESTDS-STR-DISTRO-QTY                             67170099
139868              GIVING TR004-PDC-CART-CT ROUNDED                    67180099
139868                                                                  67190099
139868     END-IF.                                                      67200099
139868                                                                  67210099
139868******************************************************************67220099
139868 8950-PROCESS-STORE-DC-CURSOR.                                    67230099
139868                                                                  67240099
139868     PERFORM 8915-FETCH-DC-STORE-CSR.                             67250099
139868                                                                  67260099
139868     IF PS-EOC-STORE-CURSOR                                       67270099
139868        IF PS-DC-SPLIT-INFO-PRESENT                               67280099
155029          SET PS-OUTLET-STORE-NO TO TRUE                          67290099
139868          PERFORM 2515-ADJUST-ROUNDED-DC-DIST                     67300099
139868          PERFORM 5700-WRITE-DC-RECORD                            67310099
139868        END-IF                                                    67320099
139868     ELSE                                                         67330099
139868        IF PS-FIRST-STORE                                         67340099
139868          SET PS-FIRST-STORE-NO     TO TRUE                       67350099
155029          SET PS-FIRST-DC-NO        TO TRUE                       67360099
139868          INITIALIZE PV-TTL-ALL-DCS-PCT                           67370099
139868                     PV-TTL-ALL-DCS-UNITS                         67380099
139868                     PV-TTL-ALL-DCS-CARTS                         67390099
139868                                                                  67400099
139868        ELSE                                                      67410099
139868*          **********************************************         67420099
139868*          * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *         67430099
139868*          * FROM THE PRIOR STORE                       *         67440099
139868*          **********************************************         67450099
139868            PERFORM 5700-WRITE-DC-RECORD                          67460099
139868        END-IF                                                    67470099
139868                                                                  67480099
139868        INITIALIZE TR004-REC-TYPE-DC                              67490099
139868        MOVE MESTDS-STR-NBR        TO TR004-DIST-CNTR             67500099
139868        MOVE MESTDS-STR-DISTRO-QTY TO TR004-DC-UNIT-QTY           67510099
139868                                                                  67520099
155029        IF PV-FAST-E-BUS-IND = 'Y'                                67530099
155029           DIVIDE PA-TOTAL-CURR-SPLIT-QTY                         67540099
155029             INTO MESTDS-STR-DISTRO-QTY                           67550099
155029               GIVING PV-QUOTIENT-ORDER-PERCENT                   67560099
155029        ELSE                                                      67570099
139868           DIVIDE PV-HOLD-PCK-UNIT-QTY                            67580099
139868             INTO MESTDS-STR-DISTRO-QTY                           67590099
139868               GIVING PV-QUOTIENT-ORDER-PERCENT                   67600099
155029        END-IF                                                    67610099
139868        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     67620099
139868            100 GIVING TR004-DC-PERCNT ROUNDED                    67630099
139868                                                                  67640099
139868        PERFORM 2512-DC-OUT-CALCULATIONS                          67650099
139868                                                                  67660099
139868     END-IF.                                                      67670099
139868                                                                  67680099
567400******************************************************************67690099
567500* END OF JOB ROUTINE                                              67700099
567600******************************************************************67710099
567700 9000-EOJ-ROUTINE.                                                67720099
567800                                                                  67730099
567900     IF PA-TOTAL-OUTPUT-REC-COUNT = ZERO                          67740099
568000         CONTINUE                                                 67750099
568100     ELSE                                                         67760099
568200         INITIALIZE TR004-REC-TYPE-CTT                            67770099
568300         MOVE PA-TOTAL-OUTPUT-REC-COUNT TO                        67780099
568400             TR004-HASH-TOTALS                                    67790099
568500         PERFORM 5800-WRITE-CTT-REC                               67800099
568600     END-IF                                                       67810099
568700                                                                  67820099
568800     DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                       67830099
568900         PA-TOTAL-OUTPUT-REC-COUNT.                               67840099
569000     DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT.                  67850099
569100                                                                  67860099
569200*    ****************************************                     67870099
569300*    * IF THERE WERE ANY TRIPS TO PROCESS,  *                     67880099
569400*    * CHECK IF THE ONE YOU WERE ON AT THE  *                     67890099
569500*    * END OF THE DRIVER CURSOR WAS A GOOD  *                     67900099
569600*    * TRIP AND UPDATE VHTRIP IF IT WAS.    *                     67910099
569700*    ****************************************                     67920099
569800     IF PS-FIRST-TRIP                                             67930099
569900       CONTINUE                                                   67940099
570000     ELSE                                                         67950099
570100       IF PS-BAD-TRIP                                             67960099
570200          CONTINUE                                                67970099
570300       ELSE                                                       67980099
570400          PERFORM 2290-UPDATE-TVHTRIP                             67990099
570500       END-IF                                                     68000099
570600     END-IF.                                                      68010099
570700                                                                  68020099
570800     PERFORM 7010-CLOSE-DRIVER-CURSOR.                            68030099
570900                                                                  68040099
571000     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              68050099
571100     PERFORM 6570-UPDATE-TCKRSTCNTL.                              68060099
571200                                                                  68070099
571300******************************************************************68080099
571400* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      68090099
571500* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 68100099
571600******************************************************************68110099
571700 9100-SQL-ABEND.                                                  68120099
571800******************************************************************68130099
571900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    68140099
572000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         68150099
572100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     68160099
572200* FORMAT.                                                         68170099
572300******************************************************************68180099
572400*    COPY DPPD004.                                                68190099
572500     COPY DPPD004.                                                68200099
572600                                                                  68210099
572700     MOVE +4013 TO ABEND-CODE.                                    68220099
572800     CALL 'ILBOABN0' USING ABEND-CODE.                            68230099
