000100******************************************************************00010029
000200 IDENTIFICATION DIVISION.                                         00020029
000300******************************************************************00030029
000400 PROGRAM-ID.    CEKCS610.                                         00040029
000500 AUTHOR.        DENISE HAHN.                                      00050029
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060029
000700 DATE-WRITTEN   01-04-2000.                                       00070029
000800 DATE-COMPILED.                                                   00080029
000900*---------------------------------------------------------------* 00090029
001000*    S610 - CENTRAL STOCK INTERFACE - CONFIRMATION MODULE       * 00100029
001100*---------------------------------------------------------------* 00110029
001200                                                                  00120029
001300***** NOTE:    THIS PROGRAM USES MQ SERIES AND MUST BE COMPILED   00130048
001400*****          WITH THE MQ SERIES SWITCH SET TO 'Y'.              00140048
001500******************************************************************00150029
001600 ENVIRONMENT DIVISION.                                            00160029
001700******************************************************************00170029
001800 CONFIGURATION SECTION.                                           00180029
001900*                                                                 00190029
002000 SOURCE-COMPUTER.        IBM-3090.                                00200029
002100 OBJECT-COMPUTER.        IBM-3090.                                00210029
002200*                                                                 00220029
002300******************************************************************00230029
002400 DATA DIVISION.                                                   00240029
002500******************************************************************00250029
002600                                                                  00260029
002700 WORKING-STORAGE SECTION.                                         00270029
002800                                                                  00280029
002900*----------------------------------------------------------------*00290029
003000*    ABEND PROCESSING COPYBOOK.                                  *00300029
003100*----------------------------------------------------------------*00310029
003200     COPY DPWS013.                                                00320029
003300                                                                  00330029
003400     COPY EPWS000.                                                00340029
003500                                                                  00350029
003600                                                                  00360029
003700*----------------------------------------------------------------*00370029
003800*    COMMAREA LAYOUT FOR THE CONFIRMATION ROUTINE               * 00380029
003900*----------------------------------------------------------------*00390029
004000     COPY CEWS005.                                                00400029
004100                                                                  00410029
004200                                                                  00420029
004300*    API CONTROL BLOCKS                                           00430029
004400                                                                  00440029
004500 01  MQM-OBJECT-DESCRIPTOR.                                       00450029
004600     COPY CMQODV.                                                 00460029
004700 01  MQM-MESSAGE-DESCRIPTOR.                                      00470029
004800     COPY CMQMDV.                                                 00480029
004900 01  MQM-GET-MESSAGE-OPTIONS.                                     00490029
005000     COPY CMQGMOV.                                                00500029
005100 01  MQM-PUT-MESSAGE-OPTIONS.                                     00510029
005200     COPY CMQPMOV.                                                00520029
005300                                                                  00530029
005400*    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   00540029
005500*    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          00550029
005600                                                                  00560029
005700 01  MQM-CONSTANTS.                                               00570029
005800     COPY CMQV.                                                   00580029
005900                                                                  00590029
006000                                                                  00600029
006100*---------------------------------------------------------------* 00610029
006200* MQ SERIES MESSAGE LAYOUT                                        00620029
006300*---------------------------------------------------------------* 00630029
006400     COPY CERD016.                                                00640029
006500*                                                                 00650094
006600*-----------------------------------------------------------------00660029
006700*  LOGISTICS DOMAIN ITEM ACCESS MODULE LAYOUT      WR/IR# 230ZZ   00670066
006800*-----------------------------------------------------------------00680029
006900     COPY XLWS001.                                                00690063
006901                                                                  00690194
006902*-----------------------------------------------------------------00690229
006903*   LOCATION DOMAIN ACCESS MODULE                                 00690366
006904*-----------------------------------------------------------------00690429
006905     COPY XLWS071.                                                00690563
006906                                                                  00690694
007000*---------------------------------------------------------------* 00700063
007100* CHANGES MADE ENDS HERE                                          00710063
007200*---------------------------------------------------------------* 00720063
007300*                                                                 00730063
007400*-----------------------------------------------------------------00740063
007500*  DB2 KEYS                                                       00750063
007600*-----------------------------------------------------------------00760063
007700 01  DK-DB2-KEYS.                                                 00770029
007800                                                                  00780029
007900     05  DK-PULL-NUMBER                 PIC S9(09)  COMP VALUE +0.00790029
008000     05  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACE.  00800029
008100     05  DK-LINE-NUMBER                 PIC S9(04)  COMP VALUE +0.00810029
008600     05  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00860057
008700                                                                  00870029
008800                                                                  00880029
008900*----------------------------------------------------------------*00890029
009000*  PROGRAM SWITCHES                                              *00900029
009100*----------------------------------------------------------------*00910029
009200 01  PS-PROGRAM-SWITCHES.                                         00920029
009300                                                                  00930029
009400     05  PS-ERROR-SW                     PIC X(01)   VALUE 'N'.   00940029
009500         88  PS-NO-ERROR                             VALUE 'N'.   00950029
009600         88  PS-ERROR                                VALUE 'Y'.   00960029
009700     05  PS-CNCL-PULL-CSR-SW             PIC X(01)   VALUE 'N'.   00970029
009800         88  PS-NOT-EOF-CNCL-PULL-CSR                VALUE 'N'.   00980029
009900         88  PS-EOF-CNCL-PULL-CSR                    VALUE 'Y'.   00990029
010000     05  PS-UNCNCL-PULL-CSR-SW           PIC X(01)   VALUE 'N'.   01000029
010100         88  PS-NOT-EOF-UNCNCL-PULL-CSR              VALUE 'N'.   01010029
010200         88  PS-EOF-UNCNCL-PULL-CSR                  VALUE 'Y'.   01020029
010300     05  PS-CNFM-DIST-PULL-CSR-SW        PIC X(01)   VALUE 'N'.   01030029
010400         88  PS-NOT-EOF-CNFM-DIST-PULL               VALUE 'N'.   01040029
010500         88  PS-EOF-CNFM-DIST-PULL                   VALUE 'Y'.   01050029
010600     05  PS-UNCNFM-DIST-PULL-CSR-SW      PIC X(01)   VALUE 'N'.   01060029
010700         88  PS-NOT-EOF-UNCNFM-DIST-PULL             VALUE 'N'.   01070029
010800         88  PS-EOF-UNCNFM-DIST-PULL                 VALUE 'Y'.   01080029
010900     05  PS-EOF-DIST-DETAIL-CSR-SW       PIC X(01)   VALUE 'N'.   01090029
011000         88  PS-NOT-EOF-DIST-DETAIL-CSR              VALUE 'N'.   01100029
011100         88  PS-EOF-DIST-DETAIL-CSR                  VALUE 'Y'.   01110029
011200     05  PS-MQ-ERROR-SW                  PIC  X(01)  VALUE 'N'.   01120029
011300         88  PS-MQ-ERROR                             VALUE 'Y'.   01130029
011400         88  PS-NO-MQ-ERROR                          VALUE 'N'.   01140029
011500     05  PS-MQ-SETUP-SW                  PIC  X(01)  VALUE 'N'.   01150029
011600         88  PS-MQ-SETUP-COMPLETE                    VALUE 'Y'.   01160029
011700         88  PS-MQ-SETUP-NOT-COMPLETE                VALUE 'N'.   01170029
011701     05  PS-PROCESS-MQ-SW                PIC  X(01)  VALUE 'N'.   01170194
011702         88  PS-PROCESS-MQ-YES                       VALUE 'Y'.   01170229
011703         88  PS-PROCESS-MQ-NO                        VALUE 'N'.   01170329
011800                                                                  01180029
011900                                                                  01190029
012000*---------------------------------------------------------------* 01200029
012100*    STANDARD COMMAREA.                                         * 01210029
012200*---------------------------------------------------------------* 01220029
012300                                                                  01230029
012400     COPY DPWS020.                                                01240029
012500                                                                  01250029
012600                                                                  01260029
012700*----------------------------------------------------------------*01270029
012800* PROGRAM CONSTANTS                                              *01280029
012900*----------------------------------------------------------------*01290029
013000 01  PC-PROGRAM-CONSTANTS.                                        01300029
013100     05  PC-CANCEL               PIC  X(02)   VALUE 'CA'.         01310029
013200     05  PC-UN-CANCEL            PIC  X(02)   VALUE 'UC'.         01320029
013300     05  PC-IN-PROCESS           PIC  X(02)   VALUE 'IP'.         01330029
013400     05  PC-DISTRIBUTED          PIC  X(02)   VALUE 'DS'.         01340029
013500     05  PC-UN-DISTRIBUTED       PIC  X(02)   VALUE 'UD'.         01350029
013600     05  PC-NEW                  PIC  X(02)   VALUE 'NW'.         01360029
013700     05  PC-POSTED               PIC  X(02)   VALUE 'PD'.         01370029
013800     05  PC-UN-POSTED            PIC  X(02)   VALUE 'UT'.         01380029
013900     05  PC-CURRENT-PROGRAM-NAME PIC  X(08)   VALUE 'CEKCS610'.   01390029
014000     05  PC-MQCOMMIT             PIC X(08)    VALUE 'CSQBCOMM'.   01400029
014100     05  PC-MQCONN               PIC X(08)    VALUE 'CSQCCONN'.   01410029
014200     05  PC-MQOPEN               PIC X(08)    VALUE 'CSQCOPEN'.   01420029
014300     05  PC-MQINQ                PIC X(08)    VALUE 'CSQCINQ'.    01430029
014400     05  PC-MQGET                PIC X(08)    VALUE 'CSQCGET'.    01440029
014500     05  PC-MQPUT                PIC X(08)    VALUE 'CSQCPUT'.    01450029
014600     05  PC-MQPUT1               PIC X(08)    VALUE 'CSQCPUT1'.   01460029
014700     05  PC-MQCLOSE              PIC X(08)    VALUE 'CSQCCLOS'.   01470029
014800     05  PC-MQDISC               PIC X(08)    VALUE 'CSQCDISC'.   01480029
014900     05  PC-QMGR-NAME            PIC X(04)    VALUE SPACES.       01490029
015000         88  PC-PROD-QMGR-NAME                VALUE 'QKSP'.       01500029
015100         88  PC-TEST-QMGR-NAME                VALUE 'QKST'.       01510029
015200         88  PC-QA-QMGR-NAME                  VALUE 'QKSQ'.       01520029
015300     05  PC-ONE                  PIC S9(01)   VALUE +1.           01530033
015400                                                                  01540029
015500                                                                  01550029
015600*----------------------------------------------------------------*01560029
015700* PROGRAM VARIABLES                                              *01570029
015800*----------------------------------------------------------------*01580029
015900 01  PV-PROGRAM-VARIABLES.                                        01590029
016000     05  PV-CEPLIT-REQ-QTY       PIC S9(09)  VALUE ZEROES         01600053
016100                                              COMP.               01610053
016200     05  PV-CEPLDS-DISTRB-QTY    PIC S9(09) VALUE ZEROES          01620053
016300                                              COMP.               01630053
016400     05  PV-CEPLMF-MANIF-QTY     PIC S9(09) VALUE ZEROES          01640053
016500                                              COMP.               01650053
016600     05  PV-CEPLAU-ADJUST-QTY    PIC S9(09) VALUE ZEROES          01660053
016700                                              COMP.               01670053
016800     05  PV-TRANS-AVAIL-QTY      PIC S9(09)  VALUE ZEROES         01680051
016900                                              COMP SYNC.          01690051
017000     05  PV-COMPUTE-DISTRB-QTY   PIC S9(09) VALUE ZEROES          01700053
017100                                              COMP.               01710053
017200     05  PV-CICS-RESPONSE        PIC S9(08)  VALUE ZEROES         01720033
017300                                              COMP SYNC.          01730033
017400     05  PV-COMMAREA-LENGTH      PIC S9(04)   VALUE +0            01740029
017500                                              COMP SYNC.          01750029
017600     05  PV-PULL-STATUS          PIC  X(02)   VALUE SPACES.       01760055
017700     05  PV-CICS-RESP            PIC S9(08)   VALUE ZEROES        01770029
017800                                              COMP SYNC.          01780029
017900     05  PV-READ-LENGTH          PIC S9(04)   VALUE +0            01790029
018000                                              COMP SYNC.          01800029
018100     05  PV-CICS-MSG-AREA        PIC  X(100)  VALUE ZEROES.       01810029
018200     05  PV-DISPLAY-PULL         PIC  Z(09)   VALUE ZEROES.       01820029
018300     05  PV-DISPLAY-REF          PIC  X(15)   VALUE SPACES.       01830029
018400     05  PV-DISPLAY-LINE         PIC  Z(04)   VALUE SPACES.       01840029
018500     05  PV-DISPLAY-RET-CDE      PIC  Z(09)-  VALUE ZEROES.       01850029
018600                                                                  01860029
018700     05  PV-CNSTK-REQ-PL-NBR     PIC  S9(9)   VALUE ZEROES.       01870029
018800     05  PV-PL-LNE-NBR           PIC  S9(4)   VALUE ZEROES.       01880029
018900     05  PV-LNE-NBR-COUNT        PIC S9(09)   COMP.               01890029
019000     05  PV-LNE-CNCL-COUNT       PIC S9(09)   COMP.               01900029
019100     05  PV-LNE-NOT-CNCL-COUNT   PIC S9(09)   COMP.               01910029
019200     05  PV-LNE-POST-DIST-COUNT  PIC S9(09)   COMP.               01920029
019300     05  PV-LNE-POST-COUNT       PIC S9(09)   COMP.               01930029
019400     05  PV-NULL-IND-1           PIC S9(04)   VALUE +0            01940029
019500                                              COMP.               01950029
019600     05  PV-NULL-IND-2           PIC S9(04)   VALUE +0            01960029
019700                                              COMP.               01970029
019800     05  PV-NULL-IND-3           PIC S9(04)   VALUE +0            01980053
019900                                              COMP.               01990053
020000     05  PV-NULL-IND-4           PIC S9(04)   VALUE +0            02000053
020100                                              COMP.               02010053
020200     05  PV-SKU-NUMBER                   PIC  X(08) VALUE SPACES. 02020029
020300*    05  PV-SKU-NUMBER-R REDEFINES  PV-SKU-NUMBER.   WR/IR# 230ZZ 02030066
020400*        10  PV-SKU-DEPT                 PIC  9(03). WR/IR# 230ZZ 02040066
020500*        10  PV-SKU-CLASS                PIC  9(02). WR/IR# 230ZZ 02050066
020600*        10  PV-SKU-SEQ                  PIC  9(03). WR/IR# 230ZZ 02060066
020700     05  PV-SKU-NUMBER-R REDEFINES  PV-SKU-NUMBER.                02070063
020800*        10  PV-SKU-DEPT                 PIC  9(03). WR/IR# 230ZZ 02080066
020900*        10  PV-SKU-CLASS                PIC  9(02). WR/IR# 230ZZ 02090066
021000         10  PV-SKU-SEQ                  PIC  9(08).              02100063
021100     05  PV-QM-NAME                     PIC X(48).                02110029
021200     05  PV-MSGLENGTH            PIC S9(9) BINARY VALUE +1083.    02120029
021300     05  PV-DATA-LENGTH          PIC S9(9) BINARY.                02130029
021400     05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        02140029
021500     05  PV-GQ-HANDLE            PIC S9(9) BINARY VALUE 0.        02150029
021600     05  PV-PQ-HANDLE            PIC S9(9) BINARY VALUE 0.        02160029
021700     05  PV-OPEN-OPTIONS         PIC S9(9) BINARY.                02170029
021800     05  PV-COMPLETION-CODE      PIC S9(9) BINARY.                02180029
021900     05  PV-REASON               PIC S9(9) BINARY.                02190029
022000     05  PV-CON-REASON           PIC S9(9) BINARY.                02200029
022100     05  PV-OBJECTNAME           PIC X(48).                       02210029
022200     05  PV-OBJECTQMGRNAME       PIC X(48).                       02220029
022300     05  PV-CURRENT-DATE         PIC  X(10)  VALUE SPACES.        02230030
022400     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             02240030
022500         10  PV-CURRENT-YY       PIC  9(04).                      02250030
022600         10  FILLER              PIC  X(01).                      02260030
022700         10  PV-CURRENT-MM       PIC  9(02).                      02270030
022800         10  FILLER              PIC  X(01).                      02280030
022900         10  PV-CURRENT-DD       PIC  9(02).                      02290030
023000     05  PV-TRANS-SOURCE-DESC.                                    02300030
023100         10  FILLER              PIC  X(21)                       02310033
023200                          VALUE 'ADJUSTMENTS FOR PULL '.          02320030
023300         10  PV-TRANS-PULL-NBR   PIC  9(09).                      02330039
023400         10  FILLER              PIC  X(10)   VALUE SPACES.       02340033
023500     05  PV-TSK-ITEM-NMBR        PIC  9(15).                      02350033
023600     05  WS-MQCHECK              PIC  X(08)   VALUE 'MQR2C'.      02360044
023700     05  PV-MQ-REASON-TEXT       PIC  X(30)   VALUE SPACES.       02370043
023800                                                                  02380029
023900*                    MQ CALL ERROR MESSAGES                       02390029
024000 01  PE-PROGRAM-ERROR-MESSAGES.                                   02400029
024100     05  PE-MQ-ERROR-NUMBER           PIC X(02) VALUE '01'.       02410029
024200     05  PE-MQ-ERROR-MESSAGE.                                     02420029
024300         10  FILLER                   PIC X(08) VALUE             02430043
024400                                                'MQ ERR: '.       02440043
024500         10  PE-MQ-CALL-TYPE          PIC X(7)  VALUE SPACES.     02450029
024600             88  PE-MQ-CONNECT                  VALUE 'MQCONN '.  02460029
024700             88  PE-MQ-OPEN                     VALUE 'MQOPEN '.  02470029
024800             88  PE-MQ-INQ                      VALUE 'MQINQ  '.  02480029
024900             88  PE-MQ-GET                      VALUE 'MQGET  '.  02490029
025000             88  PE-MQ-PUT                      VALUE 'MQPUT  '.  02500029
025100             88  PE-MQ-PUT1                     VALUE 'MQPUT1 '.  02510029
025200             88  PE-MQ-CLOSE                    VALUE 'MQCLOSE'.  02520029
025300             88  PE-MQ-DISCONNECT               VALUE 'MQDISC '.  02530029
025400         10  FILLER                   PIC X(04) VALUE ' OF '.     02540029
025500         10  PE-MQ-QMANAGER           PIC X(05) VALUE SPACES.     02550029
025600         10  FILLER                   PIC X(01) VALUE SPACES.     02560043
025700         10  PE-MQ-QNAME              PIC X(20) VALUE SPACES.     02570029
025800         10  FILLER                   PIC X(10) VALUE             02580043
025900                                        'COMP CDE: '.             02590043
026000         10  PE-MQ-COMPLETION-CODE    PIC 9(04) VALUE ZEROS.      02600029
026100         10  FILLER                   PIC X(01) VALUE SPACES.     02610043
026200         10  FILLER                   PIC X(12) VALUE             02620043
026300                                      'REASON CDE: '.             02630043
026400         10  PE-MQ-REASON-CODE        PIC 9(04) VALUE ZEROS.      02640029
026500         10  FILLER                   PIC X(01) VALUE ' '.        02650043
026600         10  PE-MQ-REASON-DESC        PIC X(30) VALUE SPACES.     02660043
026700     05  PE-MQ-INFORMATIONAL-NUMBER   PIC X(02) VALUE '02'.       02670029
026800     05  PE-MQ-INFO-MESSAGE.                                      02680029
026900         10  FILLER                   PIC X(06) VALUE             02690029
027000                                                'QMGR: '.         02700029
027100         10  PE-MQ-QMGR               PIC X(10) VALUE SPACES.     02710029
027200         10  FILLER                   PIC X(18) VALUE             02720029
027300                                          'STORE STATS MSG: '.    02730029
027400         10  PE-MQ-STATS-MSG          PIC X(1032) VALUE SPACES.   02740029
027500     05  PE-DB2-ERROR-NUMBER          PIC X(02) VALUE '02'.       02750029
027600     05  PE-DB2-ERROR-MESSAGE.                                    02760029
027700         10  FILLER                   PIC X(11) VALUE             02770029
027800                                                'DB2 ERROR: '.    02780029
027900         10  FILLER                   PIC X(08) VALUE             02790029
028000                                                'SQLWARN='.       02800029
028100         10  PE-DB2-WARNING           PIC X(8)  VALUE SPACES.     02810029
028200         10  FILLER                   PIC X(08) VALUE             02820029
028300                                                'SQLCODE='.       02830029
028400         10  PE-DB2-CODE              PIC Z(8)9-  VALUE SPACES.   02840029
028500         10  FILLER                   PIC X(06) VALUE             02850029
028600                                                ' PARA='.         02860029
028700         10  PE-DB2-PARAGRAPH         PIC X(18)  VALUE SPACES.    02870029
028800         10  FILLER                   PIC X(08) VALUE             02880029
028900                                                ' ACTION='.       02890029
029000         10  PE-DB2-ACTION            PIC X(20)  VALUE SPACES.    02900029
029100                                                                  02910029
029200                                                                  02920029
029300*----------------------------------------------------------------*02930029
029400*  DB2 AREA FOR TCEPLRQ -- CENTRAL STOCK PULL REQUEST TABLE      *02940029
029500*----------------------------------------------------------------*02950029
029600     EXEC SQL                                                     02960029
029700          INCLUDE TCEPLRQ                                         02970029
029800     END-EXEC.                                                    02980029
029900                                                                  02990029
030000*---------------------------------------------------------------* 03000054
030100*    TCEPLAU - CENTRAL STOCK PULL ADJUSTMENT                    * 03010054
030200*---------------------------------------------------------------* 03020054
030300     EXEC SQL                                                     03030054
030400          INCLUDE TCEPLAU                                         03040054
030500     END-EXEC.                                                    03050054
030600                                                                  03060029
030700*----------------------------------------------------------------*03070029
030800*  DB2 AREA FOR TCEPLST  - CENTRAL STOCK PULL STATUS TABLE       *03080029
030900*----------------------------------------------------------------*03090029
031000     EXEC SQL                                                     03100029
031100          INCLUDE TCEPLST                                         03110029
031200     END-EXEC.                                                    03120029
031300                                                                  03130029
031400*---------------------------------------------------------------* 03140054
031500*    TCEPLDS - CENTRAL STOCK PULL MANIFESTING                   * 03150054
031600*---------------------------------------------------------------* 03160054
031700     EXEC SQL                                                     03170054
031800          INCLUDE TCEPLMF                                         03180054
031900     END-EXEC.                                                    03190054
032000                                                                  03200029
032100*----------------------------------------------------------------*03210029
032200*  DB2 AREA FOR TCEPLIT -- CENTRAL STOCK PULL LINE ITEM TABLE    *03220029
032300*----------------------------------------------------------------*03230029
032400     EXEC SQL                                                     03240029
032500          INCLUDE TCEPLIT                                         03250029
032600     END-EXEC.                                                    03260029
032700                                                                  03270029
032800                                                                  03280029
032900*----------------------------------------------------------------*03290029
033000*  DB2 AREA FOR TCEPLDS -- CENTRAL STOCK PULL DISTRIBUTION TABLE *03300029
033100*----------------------------------------------------------------*03310029
033200     EXEC SQL                                                     03320029
033300          INCLUDE TCEPLDS                                         03330029
033400     END-EXEC.                                                    03340029
033500                                                                  03350029
034200                                                                  03420029
034300*-----------------------------------------------------------------03430029
034400*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 03440029
034500*-----------------------------------------------------------------03450029
034600     EXEC SQL                                                     03460029
034700          INCLUDE TKRPRPM                                         03470029
034800     END-EXEC.                                                    03480029
034900                                                                  03490029
035000*---------------------------------------------------------------* 03500029
035100*    TSK - SKU TABLE                            WR/IR# 230ZZ      03510066
035200*---------------------------------------------------------------* 03520029
035300*    EXEC SQL                                                     03530062
035400*         INCLUDE TSK                                             03540062
035500*    END-EXEC.                                                    03550062
035600*-----------------------------------------------------------------03560029
035700*  CURSOR FOR THE "CANCEL PULL" OPTION                            03570029
035800*-----------------------------------------------------------------03580029
035900     EXEC SQL                                                     03590029
036000         DECLARE  CNCL-PULL-CSR CURSOR WITH HOLD FOR              03600041
036100          SELECT  CNSTK_REQ_PL_NBR                                03610029
036200                 ,PL_LNE_NBR                                      03620029
036300                 ,ITM_NBR                                         03630029
036400                 ,PL_REQ_QTY                                      03640029
036500            FROM  TCEPLIT                                         03650029
036600           WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER            03660029
036700             AND  STAT_CDE         IN   ('IP', 'NW')              03670029
036800          ORDER BY PL_LNE_NBR                                     03680029
036900     END-EXEC.                                                    03690029
037000                                                                  03700029
037100                                                                  03710029
037200*-----------------------------------------------------------------03720029
037300*  CURSOR FOR THE "UN-CANCEL PULL" OPTION                         03730029
037400*-----------------------------------------------------------------03740029
037500     EXEC SQL                                                     03750029
037600         DECLARE  UNCNCL-PULL-CSR CURSOR WITH HOLD FOR            03760041
037700          SELECT  CNSTK_REQ_PL_NBR                                03770029
037800                 ,PL_LNE_NBR                                      03780029
037900                 ,ITM_NBR                                         03790029
038000                 ,PL_REQ_QTY                                      03800029
038100            FROM  TCEPLIT                                         03810029
038200           WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER            03820029
038300             AND  STAT_CDE         IN   ('CA')                    03830029
038400          ORDER BY PL_LNE_NBR                                     03840029
038500     END-EXEC.                                                    03850029
038600                                                                  03860029
038700                                                                  03870029
038800*-----------------------------------------------------------------03880029
038900*  CURSOR FOR THE "CONFIRM DISTRIBUTION PULL" OPTION              03890029
039000*-----------------------------------------------------------------03900029
039100     EXEC SQL                                                     03910029
039200         DECLARE  CNFM-DIST-PULL-CSR CURSOR WITH HOLD FOR         03920041
039300          SELECT  CNSTK_REQ_PL_NBR                                03930029
039400                 ,PL_LNE_NBR                                      03940029
039500                 ,PL_REQ_QTY                                      03950029
039600                 ,ACTL_PL_QTY                                     03960029
039700            FROM  TCEPLIT                                         03970029
039800           WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER            03980029
039900             AND  STAT_CDE         IN   ('IP')                    03990029
040000          ORDER BY PL_LNE_NBR                                     04000029
040100     END-EXEC.                                                    04010029
040200                                                                  04020029
040300                                                                  04030029
040400*-----------------------------------------------------------------04040029
040500*  CURSOR FOR THE "UNCONFIRM DISTRIBUTION PULL" OPTION            04050029
040600*-----------------------------------------------------------------04060029
040700     EXEC SQL                                                     04070029
040800         DECLARE  UNCNFM-DIST-PL-CSR CURSOR WITH HOLD FOR         04080041
040900          SELECT  CNSTK_REQ_PL_NBR                                04090029
041000                 ,PL_LNE_NBR                                      04100029
041100                 ,PL_REQ_QTY                                      04110029
041200                 ,ACTL_PL_QTY                                     04120029
041300            FROM  TCEPLIT                                         04130029
041400           WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER            04140029
041500             AND  STAT_CDE         IN   ('DS')                    04150029
041600          ORDER BY PL_LNE_NBR                                     04160029
041700     END-EXEC.                                                    04170029
041800                                                                  04180029
041900                                                                  04190029
042000*-----------------------------------------------------------------04200029
042100*  CURSOR FOR THE "CONFIRM DISTRIBUTION PULL" DETAIL              04210029
042200*-----------------------------------------------------------------04220029
042300     EXEC SQL                                                     04230029
042400         DECLARE  DIST-DETAIL-CSR CURSOR WITH HOLD FOR            04240041
042500          SELECT  CNSTK_REQ_PL_NBR                                04250029
042600                 ,PL_LNE_NBR                                      04260029
042700                 ,STR_NBR                                         04270029
042800                 ,REQ_ORD_QTY                                     04280029
042900                 ,ACTL_DISTRB_QTY                                 04290029
043000            FROM  TCEPLDS                                         04300029
043100           WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER            04310029
043200             AND  PL_LNE_NBR        =  :DK-LINE-NUMBER            04320029
043300           ORDER BY STR_NBR                                       04330029
043400     END-EXEC.                                                    04340029
043500                                                                  04350029
043600                                                                  04360029
043700*----------------------------------------------------------------*04370029
043800*  DB2 AREA FOR COMMUNICATIONS                                   *04380029
043900*----------------------------------------------------------------*04390029
044000     EXEC SQL                                                     04400029
044100          INCLUDE SQLCA                                           04410029
044200     END-EXEC.                                                    04420029
044300                                                                  04430029
044400                                                                  04440029
044500 LINKAGE SECTION.                                                 04450029
044600*----------------------------------------------------------------*04460029
044700*   SUBROUTINE FIELDS                                            *04470029
044800*----------------------------------------------------------------*04480029
044900 01  DFHCOMMAREA                 PIC  X(200).                     04490029
045000                                                                  04500029
045100                                                                  04510029
045200*----------------------------------------------------------------*04520029
045300 PROCEDURE DIVISION.                                              04530029
045400*----------------------------------------------------------------*04540029
045500                                                                  04550029
045600 0000-PROGRAM-MAINLINE.                                           04560029
045700                                                                  04570029
045800     PERFORM 1000-INITIAL-PROCESS.                                04580029
045900                                                                  04590094
046000     EXEC SQL                                                     04600094
046100         SET :PV-CURRENT-DATE = CURRENT DATE                      04610094
046200     END-EXEC.                                                    04620094
046201                                                                  04620194
046202                                                                  04620229
046203     PERFORM 2000-PROCESS-REQUEST.                                04620329
046204                                                                  04620429
046205     PERFORM 5000-RETURN-CALL.                                    04620529
046300                                                                  04630029
046400                                                                  04640029
046500*----------------------------------------------------------------*04650029
046600*                                                                *04660029
046700*----------------------------------------------------------------*04670029
046800 1000-INITIAL-PROCESS.                                            04680029
046900                                                                  04690029
047000     MOVE DFHCOMMAREA             TO CE005-INTER-APPL-COMMAREA.   04700029
047100     MOVE SPACES                  TO CE005-RETURN-MSG.            04710029
047200     SET  CE005-FUNC-SUCCESSFUL   TO TRUE.                        04720029
047300                                                                  04730029
047400     MOVE LENGTH OF CE005-INTER-APPL-COMMAREA                     04740029
047500                                  TO  PV-READ-LENGTH.             04750029
047510     MOVE CE005-CURR-OPER-UNT-ID-N TO KRPRPM-LOC-ID               04751094
047600                                                                  04760029
047700     EXEC SQL                                                     04770094
047800        SELECT FUNC_TXT                                           04780094
047900          INTO :KRPRPM-FUNC-TXT                                   04790094
048000          FROM TKRPRPM                                            04800094
048100         WHERE   LOC_ID            = :KRPRPM-LOC-ID               04810094
048200           AND   INTFC_SYS_CDE     = 'KHL'                        04820094
048300           AND   SYS_PRC_FUNC_CDE  = 'CEPLMQ'                     04830094
048400           AND   FUNC_PRC_STAT_CDE = 'AC'                         04840094
375700           AND (CURRENT DATE                                      37570029
375800       BETWEEN DATE(FUNC_BEG_TMST) AND                            37580029
375900               DATE(FUNC_END_TMST) )                              37590029
375901     END-EXEC.                                                    37590194
375902                                                                  37590229
376200     EVALUATE SQLCODE                                             37620029
376300         WHEN ZERO                                                37630029
376400             MOVE KRPRPM-FUNC-TXT TO PS-PROCESS-MQ-SW             37640029
376401         WHEN +100                                                37640194
376402             SET PS-PROCESS-MQ-NO TO TRUE                         37640229
376500         WHEN OTHER                                               37650029
376600              MOVE '1000-INITIAL-PROCESS'                         37660030
376700                               TO DP013-PARAGRAPH                 37670029
376800              MOVE 'SELECT MQ PROCESS PARM'                       37680029
376900                               TO DP013-MESSAGE-TEXT (1)          37690029
377000              MOVE SQLCA       TO DP013-SQLCA                     37700029
377100              SET DP013-DB2-ABEND                                 37710029
377200                               TO TRUE                            37720029
377300              PERFORM DP013-0000-PROCESS-ABEND                    37730029
377400     END-EVALUATE.                                                37740029
377401*----------------------------------------------------------------*37740194
377402*  DETERMINE WHAT FUNCTION IS BEING REQUESTED.                   *37740229
377403*----------------------------------------------------------------*37740329
377404 2000-PROCESS-REQUEST.                                            37740429
377405     PERFORM 4300-GET-STORE-IND.                                  37740529
377406     EVALUATE TRUE                                                37740629
377407         WHEN CE005-CNCL-PULL                                     37740729
377408              PERFORM 2100-CNCL-PULL                              37740829
377409                                                                  37740929
377410         WHEN CE005-UNCNCL-PULL                                   37741029
377411              PERFORM 2110-UNCNCL-PULL                            37741129
377412                                                                  37741229
377413         WHEN  CE005-CNFM-DIST-PULL                               37741329
377414              PERFORM 2120-CNFM-DIST-PULL                         37741429
377415                                                                  37741529
377416         WHEN  CE005-UNCNFM-DIST-PULL                             37741629
377417              PERFORM 2130-UNCNFM-DIST-PULL                       37741729
377418                                                                  37741829
377419         WHEN CE005-CNFM-PULL                                     37741929
377420              PERFORM 2140-CNFM-PULL                              37742029
377421                                                                  37742129
377422         WHEN CE005-UNCNFM-PULL                                   37742229
377423              PERFORM 2150-UNCNFM-PULL                            37742329
377424                                                                  37742429
377425         WHEN CE005-CNCL-ITEM                                     37742529
377426              PERFORM 2160-CNCL-ITEM                              37742629
377427                                                                  37742729
377428         WHEN CE005-UNCNCL-ITEM                                   37742829
377429              PERFORM 2170-UNCNCL-ITEM                            37742929
377430                                                                  37743029
377431         WHEN CE005-CNFM-DIST-ITEM                                37743129
377432              PERFORM 2180-CNFM-DIST-ITEM                         37743229
377433                                                                  37743329
377434         WHEN CE005-UNCNFM-DIST-ITEM                              37743429
377435              PERFORM 2190-UNCNFM-DIST-ITEM                       37743529
377436                                                                  37743629
377437         WHEN CE005-CNFM-ITEM                                     37743729
377438              PERFORM 2200-CNFM-ITEM                              37743829
377439                                                                  37743929
377440         WHEN CE005-UNCNFM-ITEM                                   37744029
377441              PERFORM 2210-UNCNFM-ITEM                            37744129
377442                                                                  37744229
377443         WHEN CE005-POST-ITEM                                     37744329
377444              PERFORM 2220-POST-ITEM                              37744429
377445                                                                  37744529
377446         WHEN CE005-UNPOST-ITEM                                   37744629
377447              PERFORM 2230-UNPOST-ITEM                            37744729
377448                                                                  37744829
377449     END-EVALUATE.                                                37744929
377450                                                                  37745029
377451                                                                  37745129
377452*----------------------------------------------------------------*37745229
377453* CANCEL PULL                                                    *37745329
377454*----------------------------------------------------------------*37745429
377455 2100-CNCL-PULL.                                                  37745529
377456                                                                  37745629
377457     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37745729
377458     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37745829
377459     PERFORM 4000-OPEN-CURSOR.                                    37745929
377460     IF XL071-E-BUS-IND = 'Y' AND                                 37746047
377470        XL071-LOC-TYP-CDE = 'DS' AND                              37747047
377471        PS-PROCESS-MQ-YES                                         37747194
377472         PERFORM 8100-MQ-SETUP                                    37747230
377473     END-IF.                                                      37747330
377474     IF PS-MQ-ERROR                                               37747449
377475         SET CE005-FUNC-INVALID TO TRUE                           37747549
377476         MOVE 'MQ SERIES ERROR' TO CE005-RETURN-MSG               37747649
377477     END-IF.                                                      37747749
377478                                                                  37747829
377479     IF  PS-NO-ERROR                                              37747929
377480         PERFORM 4010-FETCH-CURSOR                                37748029
377481     END-IF.                                                      37748129
377482                                                                  37748229
377483     IF  PS-NO-ERROR                                              37748329
377484         IF  PS-EOF-CNCL-PULL-CSR                                 37748429
377485             MOVE  PC-CANCEL                                      37748529
377486               TO  CEPLST-STAT-CDE                                37748629
377487                   CEPLRQ-STAT-CDE                                37748729
377488         ELSE                                                     37748829
377489             PERFORM                                              37748929
377490               UNTIL PS-EOF-CNCL-PULL-CSR  OR                     37749029
377491                     PS-ERROR                                     37749129
377492                     MOVE  CEPLIT-CNSTK-REQ-PL-NBR                37749229
377493                           TO  PV-CNSTK-REQ-PL-NBR                37749329
377494                               DK-PULL-NUMBER                     37749429
377495                     MOVE  CEPLIT-PL-LNE-NBR                      37749529
377496                           TO  PV-PL-LNE-NBR                      37749629
377497                               DK-LINE-NUMBER                     37749729
377498                     MOVE  PC-CANCEL                              37749829
377499                           TO  CEPLIT-STAT-CDE                    37749929
377500                               CEPLST-STAT-CDE                    37750029
377501                               CEPLRQ-STAT-CDE                    37750129
377502                                                                  37750229
377503                     IF  PS-NO-ERROR                              37750329
377504                         PERFORM 4100-UPDATE-TCEPLIT              37750429
377505                     END-IF                                       37750529
377506                     IF  PS-NO-ERROR                              37750629
377507                         PERFORM 4110-INSERT-TCEPLST              37750729
377508                     END-IF                                       37750829
377509                     IF  PS-NO-ERROR AND                          37750929
377510                        XL071-E-BUS-IND = 'Y' AND                 37751047
377511                        XL071-LOC-TYP-CDE = 'DS'                  37751147
377512                         INITIALIZE CE016-INV-TRANS-RECORD        37751236
377513*                        PERFORM 4400-SELECT-SKU                  37751362
377514                         PERFORM 4400-CALL-CICS-API-ARCH          37751462
377515                         MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER 37751530
377516                         MOVE CE005-CS-LOCATION                   37751630
377517                                          TO CE016-STORE-NUMBER   37751732
377518                         SET CE016-TRANS-TYPE-ADJ TO TRUE         37751830
377519                         SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE37751930
377520                         MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE37752030
377521                         MOVE ZERO        TO CE016-TRANS-AVAIL-QTY37752137
377522                         COMPUTE CE016-TRANS-RESV-QTY =           37752237
377523                                 (CEPLIT-PL-REQ-QTY * -1)         37752337
377524                         MOVE DK-PULL-NUMBER  TO PV-TRANS-PULL-NBR37752440
377525                         MOVE PV-TRANS-SOURCE-DESC                37752530
377526                                        TO CE016-TRANS-SOURCE-DESC37752630
377527                         IF PS-PROCESS-MQ-YES                     37752794
377528                             PERFORM 8200-MQ-PUT1                 37752830
377529                         END-IF                                   37752994
377530                     END-IF                                       37753029
377531                     IF  PS-NO-ERROR                              37753129
377532                         PERFORM 4010-FETCH-CURSOR                37753229
377533                     END-IF                                       37753329
377534             END-PERFORM                                          37753429
377535     END-IF.                                                      37753529
377536                                                                  37753629
377537     IF  PS-NO-ERROR                                              37753729
377538         PERFORM 4020-CLOSE-CURSOR                                37753829
377539     END-IF.                                                      37753929
377540                                                                  37754029
377541     IF  PS-NO-ERROR                                              37754129
377542         PERFORM 4130-UPDATE-TCEPLRQ                              37754229
377543     END-IF.                                                      37754329
377544                                                                  37754429
377545     IF  PS-NO-ERROR                                              37754529
377546         MOVE  ZEROES  TO  DK-LINE-NUMBER                         37754629
377547         PERFORM 4110-INSERT-TCEPLST                              37754729
377548     END-IF.                                                      37754829
377549                                                                  37754929
377550     IF  PS-NO-ERROR                                              37755029
377551         PERFORM 8000-SYNCPOINT                                   37755129
377552     END-IF.                                                      37755229
377553                                                                  37755329
377554     IF PS-PROCESS-MQ-YES                                         37755494
377555         PERFORM 8700-MQ-DISCONNECT                               37755530
377556     END-IF.                                                      37755694
377557                                                                  37755729
377558*----------------------------------------------------------------*37755829
377559* UN-CANCEL PULL                                                 *37755929
377560*----------------------------------------------------------------*37756029
377561 2110-UNCNCL-PULL.                                                37756129
377562                                                                  37756229
377563     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37756329
377564     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37756429
377565     PERFORM 4000-OPEN-CURSOR.                                    37756529
377566                                                                  37756629
377567     IF XL071-E-BUS-IND = 'Y' AND                                 37756747
377568        XL071-LOC-TYP-CDE = 'DS' AND                              37756847
377569        PS-PROCESS-MQ-YES                                         37756994
377570         PERFORM 8100-MQ-SETUP                                    37757030
377571     END-IF.                                                      37757130
377572                                                                  37757230
377573     IF  PS-NO-ERROR                                              37757329
377574         PERFORM 4010-FETCH-CURSOR                                37757429
377575     END-IF.                                                      37757529
377576                                                                  37757629
377577     IF  PS-NO-ERROR                                              37757729
377578         IF  PS-EOF-UNCNCL-PULL-CSR                               37757829
377579             MOVE  PC-IN-PROCESS                                  37757929
377580               TO  CEPLRQ-STAT-CDE                                37758029
377581             MOVE  PC-UN-CANCEL                                   37758129
377582               TO  CEPLST-STAT-CDE                                37758229
377583         ELSE                                                     37758329
377584             PERFORM                                              37758429
377585               UNTIL PS-EOF-UNCNCL-PULL-CSR  OR                   37758529
377586                     PS-ERROR                                     37758629
377587                     MOVE  CEPLIT-CNSTK-REQ-PL-NBR                37758729
377588                           TO  PV-CNSTK-REQ-PL-NBR                37758829
377589                               DK-PULL-NUMBER                     37758929
377590                     MOVE  CEPLIT-PL-LNE-NBR                      37759029
377591                           TO  PV-PL-LNE-NBR                      37759129
377592                               DK-LINE-NUMBER                     37759229
377593                     MOVE  PC-IN-PROCESS                          37759329
377594                           TO  CEPLIT-STAT-CDE                    37759429
377595                               CEPLRQ-STAT-CDE                    37759529
377596                     MOVE  PC-UN-CANCEL                           37759629
377597                           TO  CEPLST-STAT-CDE                    37759729
377598                                                                  37759829
377599                     IF  PS-NO-ERROR                              37759929
377600                         PERFORM 4100-UPDATE-TCEPLIT              37760029
377601                     END-IF                                       37760129
377602                     IF  PS-NO-ERROR                              37760229
377603                         PERFORM 4110-INSERT-TCEPLST              37760329
377604                     END-IF                                       37760429
377605                     IF  PS-NO-ERROR AND                          37760529
377606                        XL071-E-BUS-IND = 'Y' AND                 37760647
377607                        XL071-LOC-TYP-CDE = 'DS'                  37760747
377608                         INITIALIZE CE016-INV-TRANS-RECORD        37760836
377609*                        PERFORM 4400-SELECT-SKU                  37760962
377610                         PERFORM 4400-CALL-CICS-API-ARCH          37761062
377611                         MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER 37761130
377612                         MOVE CE005-CS-LOCATION                   37761230
377613                                          TO CE016-STORE-NUMBER   37761332
377614                         SET CE016-TRANS-TYPE-X-TRANSFER TO TRUE  37761437
377615                         SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE37761530
377616                         MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE37761630
377617                         MOVE ZERO        TO CE016-TRANS-AVAIL-QTY37761737
377618                         MOVE CEPLIT-PL-REQ-QTY                   37761830
377619                                          TO CE016-TRANS-RESV-QTY 37761937
377620                         MOVE DK-PULL-NUMBER  TO PV-TRANS-PULL-NBR37762040
377621                         MOVE PV-TRANS-SOURCE-DESC                37762130
377622                                        TO CE016-TRANS-SOURCE-DESC37762230
377623                         IF PS-PROCESS-MQ-YES                     37762394
377624                             PERFORM 8200-MQ-PUT1                 37762430
377625                         END-IF                                   37762594
377626                     END-IF                                       37762629
377627                     IF  PS-NO-ERROR                              37762729
377628                         PERFORM 4010-FETCH-CURSOR                37762829
377629                     END-IF                                       37762929
377630             END-PERFORM                                          37763029
377631     END-IF.                                                      37763129
377632                                                                  37763229
377633     IF  PS-NO-ERROR                                              37763329
377634         PERFORM 4020-CLOSE-CURSOR                                37763429
377635     END-IF.                                                      37763529
377636                                                                  37763629
377637     IF  PS-NO-ERROR                                              37763729
377638         PERFORM 4130-UPDATE-TCEPLRQ                              37763829
377639     END-IF.                                                      37763929
377640                                                                  37764029
377641     IF  PS-NO-ERROR                                              37764129
377642         MOVE  ZEROES  TO  DK-LINE-NUMBER                         37764229
377643         PERFORM 4110-INSERT-TCEPLST                              37764329
377644     END-IF.                                                      37764429
377645                                                                  37764529
377646     IF  PS-NO-ERROR                                              37764629
377647         PERFORM 8000-SYNCPOINT                                   37764729
377648     END-IF.                                                      37764829
377649                                                                  37764929
377650     IF PS-PROCESS-MQ-YES                                         37765094
377660         PERFORM 8700-MQ-DISCONNECT                               37766030
377661     END-IF.                                                      37766194
377662                                                                  37766229
377663*----------------------------------------------------------------*37766329
377664* CONFIRM DISTRIBUTION FOR PULL                                  *37766429
377665*----------------------------------------------------------------*37766529
377666 2120-CNFM-DIST-PULL.                                             37766629
377667                                                                  37766729
377668     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37766829
377669     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37766929
377670     PERFORM 4000-OPEN-CURSOR.                                    37767029
377671                                                                  37767129
377672     IF  PS-NO-ERROR                                              37767229
377673         PERFORM 4010-FETCH-CURSOR                                37767329
377674     END-IF.                                                      37767429
377675                                                                  37767529
377676     IF  PS-NO-ERROR                                              37767629
377677         IF  PS-EOF-CNFM-DIST-PULL                                37767729
377678             CONTINUE                                             37767829
377679         ELSE                                                     37767929
377680             PERFORM                                              37768029
377681               UNTIL PS-EOF-CNFM-DIST-PULL OR                     37768129
377682                     PS-ERROR                                     37768229
377683                     MOVE  CEPLIT-CNSTK-REQ-PL-NBR                37768329
377684                           TO  PV-CNSTK-REQ-PL-NBR                37768429
377685                               DK-PULL-NUMBER                     37768529
377686                     MOVE  CEPLIT-PL-LNE-NBR                      37768629
377687                           TO  PV-PL-LNE-NBR                      37768729
377688                               DK-LINE-NUMBER                     37768829
377689                     MOVE  PC-DISTRIBUTED                         37768929
377690                           TO  CEPLIT-STAT-CDE                    37769029
377691                               CEPLST-STAT-CDE                    37769129
377692                                                                  37769229
377693                     IF  PS-NO-ERROR                              37769329
377694                         PERFORM 4105-UPDATE-TCEPLIT              37769429
377695                     END-IF                                       37769529
377696                     IF  PS-NO-ERROR                              37769629
377697                         PERFORM 4110-INSERT-TCEPLST              37769729
377698                     END-IF                                       37769829
377699                     SET PS-NOT-EOF-DIST-DETAIL-CSR  TO  TRUE     37769929
377700                     IF  PS-NO-ERROR                              37770029
377701                         PERFORM 2125-CNFM-DIST-TCEPLDS           37770129
377702                     END-IF                                       37770229
377703                     IF  PS-NO-ERROR                              37770329
377704                         PERFORM 4010-FETCH-CURSOR                37770429
377705                     END-IF                                       37770529
377706             END-PERFORM                                          37770629
377707     END-IF.                                                      37770729
377708                                                                  37770829
377709     IF  PS-NO-ERROR                                              37770929
377710         PERFORM 4020-CLOSE-CURSOR                                37771029
377711     END-IF.                                                      37771129
377712                                                                  37771229
377713     IF  PS-NO-ERROR                                              37771329
377714         PERFORM 8000-SYNCPOINT                                   37771429
377715     END-IF.                                                      37771529
377716                                                                  37771629
377717     IF  PS-NO-ERROR                                              37771729
377718         PERFORM 4220-CHECK-PULL-STATUS                           37771829
377719     END-IF.                                                      37771929
377720                                                                  37772029
377721     IF  PS-NO-ERROR                                              37772129
377722         PERFORM 4230-CNT-NOT-CNCL-LINES                          37772229
377723     END-IF.                                                      37772329
377724                                                                  37772429
377725     IF  PS-NO-ERROR                                              37772529
377726         PERFORM 4240-CNT-POST-DIST-LINES                         37772629
377727     END-IF.                                                      37772729
377728                                                                  37772829
377729     IF  PS-NO-ERROR                                              37772929
377730         IF  PV-LNE-NOT-CNCL-COUNT  =  PV-LNE-POST-DIST-COUNT     37773029
377731             MOVE  PC-DISTRIBUTED  TO  CEPLRQ-STAT-CDE            37773129
377732                                       CEPLST-STAT-CDE            37773229
377733             IF  PS-NO-ERROR                                      37773329
377734                 PERFORM 4130-UPDATE-TCEPLRQ                      37773429
377735             END-IF                                               37773529
377736             IF  PS-NO-ERROR                                      37773629
377737                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37773729
377738                 PERFORM 4110-INSERT-TCEPLST                      37773829
377739             END-IF                                               37773929
377740         ELSE                                                     37774029
377741         IF  CEPLRQ-STAT-CDE   =  PC-NEW                          37774129
377742             MOVE  PC-IN-PROCESS   TO  CEPLRQ-STAT-CDE            37774229
377743                                       CEPLST-STAT-CDE            37774329
377744             IF  PS-NO-ERROR                                      37774429
377745                 PERFORM 4130-UPDATE-TCEPLRQ                      37774529
377746             END-IF                                               37774629
377747             IF  PS-NO-ERROR                                      37774729
377748                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37774829
377749                 PERFORM 4110-INSERT-TCEPLST                      37774929
377750             END-IF                                               37775029
377751         END-IF                                                   37775129
377752         END-IF                                                   37775229
377753     END-IF.                                                      37775329
377754                                                                  37775429
377755     IF  PS-NO-ERROR                                              37775529
377756         PERFORM 8000-SYNCPOINT                                   37775629
377757     END-IF.                                                      37775729
377758                                                                  37775829
377759                                                                  37775929
377760*----------------------------------------------------------------*37776029
377761* CONFIRM DISTRIBUTION FOR PULL - UPDATE DISTRIBUTION TABLE      *37776129
377762*----------------------------------------------------------------*37776229
377763 2125-CNFM-DIST-TCEPLDS.                                          37776329
377764                                                                  37776429
377765     PERFORM 4005-OPEN-DETAIL-CSR.                                37776529
377766                                                                  37776629
377767     IF  PS-NO-ERROR                                              37776729
377768         PERFORM 4015-FETCH-CURSOR                                37776829
377769     END-IF.                                                      37776929
377770                                                                  37777029
377771     IF  PS-NO-ERROR                                              37777129
377772         IF  PS-EOF-DIST-DETAIL-CSR                               37777229
377773             CONTINUE                                             37777329
377774         ELSE                                                     37777429
377775             PERFORM                                              37777529
377776               UNTIL PS-EOF-DIST-DETAIL-CSR OR                    37777629
377777                     PS-ERROR                                     37777729
377778                                                                  37777829
377779                     IF  PV-NULL-IND-2 < +0                       37777929
377780                         MOVE  CEPLDS-REQ-ORD-QTY                 37778029
377781                           TO  CEPLDS-ACTL-DISTRB-QTY             37778129
377782                         PERFORM 4135-UPDATE-TCEPLDS              37778229
377783                     END-IF                                       37778329
377784                                                                  37778429
377785                     IF  PS-NO-ERROR                              37778529
377786                         PERFORM 4015-FETCH-CURSOR                37778629
377787                     END-IF                                       37778729
377788             END-PERFORM                                          37778829
377789     END-IF.                                                      37778929
377790                                                                  37779029
377791     IF  PS-NO-ERROR                                              37779129
377792         PERFORM 4025-CLOSE-CURSOR                                37779229
377793     END-IF.                                                      37779329
377794                                                                  37779429
377795                                                                  37779529
377796*----------------------------------------------------------------*37779629
377797* UN-CONFIRM DISTRIBUTION FOR PULL                               *37779729
377798*----------------------------------------------------------------*37779829
377799 2130-UNCNFM-DIST-PULL.                                           37779929
377800                                                                  37780029
377801     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37780129
377802     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37780229
377803     PERFORM 4000-OPEN-CURSOR.                                    37780329
377804                                                                  37780429
377805     IF  PS-NO-ERROR                                              37780529
377806         PERFORM 4010-FETCH-CURSOR                                37780629
377807     END-IF.                                                      37780729
377808                                                                  37780829
377809     IF  PS-NO-ERROR                                              37780929
377810         IF  PS-EOF-UNCNFM-DIST-PULL                              37781029
377811             CONTINUE                                             37781129
377812         ELSE                                                     37781229
377813             PERFORM                                              37781329
377814               UNTIL PS-EOF-UNCNFM-DIST-PULL OR                   37781429
377815                     PS-ERROR                                     37781529
377816                     MOVE  CEPLIT-CNSTK-REQ-PL-NBR                37781629
377817                           TO  PV-CNSTK-REQ-PL-NBR                37781729
377818                               DK-PULL-NUMBER                     37781829
377819                     MOVE  CEPLIT-PL-LNE-NBR                      37781929
377820                           TO  PV-PL-LNE-NBR                      37782029
377821                               DK-LINE-NUMBER                     37782129
377822                     MOVE  PC-IN-PROCESS                          37782229
377823                           TO  CEPLIT-STAT-CDE                    37782329
377824                     MOVE  PC-UN-DISTRIBUTED                      37782429
377825                           TO  CEPLST-STAT-CDE                    37782529
377826                                                                  37782629
377827                     IF  PS-NO-ERROR                              37782729
377828                         PERFORM 4105-UPDATE-TCEPLIT              37782829
377829                     END-IF                                       37782929
377830                                                                  37783029
377831                     IF  PS-NO-ERROR                              37783129
377832                         PERFORM 4110-INSERT-TCEPLST              37783229
377833                     END-IF                                       37783329
377834                     SET PS-NOT-EOF-DIST-DETAIL-CSR  TO  TRUE     37783429
377835                     IF  PS-NO-ERROR                              37783529
377836                         PERFORM 2135-UNCNFM-DIST-TCEPLDS         37783629
377837                     END-IF                                       37783729
377838                     IF  PS-NO-ERROR                              37783829
377839                         PERFORM 4010-FETCH-CURSOR                37783929
377840                     END-IF                                       37784029
377841             END-PERFORM                                          37784129
377842     END-IF.                                                      37784229
377843                                                                  37784329
377844     IF  PS-NO-ERROR                                              37784429
377845         PERFORM 4020-CLOSE-CURSOR                                37784529
377846     END-IF.                                                      37784629
377847                                                                  37784729
377848     IF  PS-NO-ERROR                                              37784829
377849         PERFORM 8000-SYNCPOINT                                   37784929
377850     END-IF.                                                      37785029
377851                                                                  37785129
377852     IF  PS-NO-ERROR                                              37785229
377853         PERFORM 4220-CHECK-PULL-STATUS                           37785329
377854     END-IF.                                                      37785429
377855                                                                  37785529
377856     IF  CEPLRQ-STAT-CDE   =  PC-DISTRIBUTED                      37785629
377857         MOVE  PC-IN-PROCESS     TO CEPLRQ-STAT-CDE               37785729
377858         MOVE  PC-UN-DISTRIBUTED TO CEPLST-STAT-CDE               37785829
377859         IF  PS-NO-ERROR                                          37785929
377860             PERFORM 4130-UPDATE-TCEPLRQ                          37786029
377861         END-IF                                                   37786129
377862         IF  PS-NO-ERROR                                          37786229
377863             MOVE  ZEROES  TO  DK-LINE-NUMBER                     37786329
377864             PERFORM 4110-INSERT-TCEPLST                          37786429
377865         END-IF                                                   37786529
377866     END-IF.                                                      37786629
377867                                                                  37786729
377868     IF  PS-NO-ERROR                                              37786829
377869         PERFORM 8000-SYNCPOINT                                   37786929
377870     END-IF.                                                      37787029
377871                                                                  37787129
377872                                                                  37787229
377873*----------------------------------------------------------------*37787329
377874* UNCONFIRM DISTRIBUTION FOR PULL - UPDATE DISTRIBUTION TABLE    *37787429
377875*----------------------------------------------------------------*37787529
377876 2135-UNCNFM-DIST-TCEPLDS.                                        37787629
377877                                                                  37787729
377878     PERFORM 4005-OPEN-DETAIL-CSR.                                37787829
377879                                                                  37787929
377880     IF  PS-NO-ERROR                                              37788029
377881         PERFORM 4015-FETCH-CURSOR                                37788129
377882     END-IF.                                                      37788229
377883                                                                  37788329
377884     IF  PS-NO-ERROR                                              37788429
377885         IF  PS-EOF-DIST-DETAIL-CSR                               37788529
377886             CONTINUE                                             37788629
377887         ELSE                                                     37788729
377888             PERFORM                                              37788829
377889               UNTIL PS-EOF-DIST-DETAIL-CSR OR                    37788929
377890                     PS-ERROR                                     37789029
377891                                                                  37789129
377892                     IF  CEPLDS-REQ-ORD-QTY                       37789229
377893                            =  CEPLDS-ACTL-DISTRB-QTY             37789329
377894                         PERFORM 4136-UPDATE-TCEPLDS-NULL         37789429
377895                     END-IF                                       37789529
377896                                                                  37789629
377897                     IF  PS-NO-ERROR                              37789729
377898                         PERFORM 4015-FETCH-CURSOR                37789829
377899                     END-IF                                       37789929
377900             END-PERFORM                                          37790029
377901     END-IF.                                                      37790129
377902                                                                  37790229
377903     IF  PS-NO-ERROR                                              37790329
377904         PERFORM 4025-CLOSE-CURSOR                                37790429
377905     END-IF.                                                      37790529
377906                                                                  37790629
377907                                                                  37790729
377908                                                                  37790829
377909                                                                  37790929
377910                                                                  37791029
377911*----------------------------------------------------------------*37791129
377912* CONFIRM PULL                                                   *37791229
377913*----------------------------------------------------------------*37791329
377914 2140-CNFM-PULL.                                                  37791429
377915                                                                  37791529
377916                                                                  37791629
377917                                                                  37791729
377918*----------------------------------------------------------------*37791829
377919* UN-CONFIRM PULL                                                *37791929
377920*----------------------------------------------------------------*37792029
377921 2150-UNCNFM-PULL.                                                37792129
377922                                                                  37792229
377923                                                                  37792329
377924                                                                  37792429
377925                                                                  37792529
377926*----------------------------------------------------------------*37792629
377927* CANCEL LINE ITEM                                               *37792729
377928*----------------------------------------------------------------*37792829
377929 2160-CNCL-ITEM.                                                  37792929
377930                                                                  37793029
377931     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37793129
377932     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37793229
377933     MOVE  CE005-LNE-NBR   TO  DK-LINE-NUMBER.                    37793329
377934                                                                  37793429
377935     MOVE  PC-CANCEL       TO  CEPLIT-STAT-CDE                    37793529
377936                               CEPLST-STAT-CDE.                   37793629
377937                                                                  37793729
377938                                                                  37793829
377939     PERFORM 4100-UPDATE-TCEPLIT                                  37793929
377940                                                                  37794029
377941     IF  PS-NO-ERROR                                              37794129
377942         PERFORM 4110-INSERT-TCEPLST                              37794229
377943     END-IF                                                       37794329
377944                                                                  37794429
377945     IF  PS-NO-ERROR AND                                          37794529
377946        XL071-E-BUS-IND = 'Y' AND                                 37794647
377947        XL071-LOC-TYP-CDE = 'DS'                                  37794747
377948         INITIALIZE CE016-INV-TRANS-RECORD                        37794836
377949         IF PS-PROCESS-MQ-YES                                     37794994
377950             PERFORM 8100-MQ-SETUP                                37795030
377951         END-IF                                                   37795194
377952         PERFORM 4140-SELECT-TCEPLIT                              37795230
377953*        PERFORM 4400-SELECT-SKU                                  37795362
377954         PERFORM 4400-CALL-CICS-API-ARCH                          37795462
377955         MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER                 37795530
377956         MOVE CE005-CS-LOCATION                                   37795630
377957                               TO CE016-STORE-NUMBER              37795732
377958         SET CE016-TRANS-TYPE-ADJ TO TRUE                         37795830
377959         SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE                37795930
377960         MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE                37796030
377961         MOVE ZERO        TO CE016-TRANS-AVAIL-QTY                37796137
377962         COMPUTE CE016-TRANS-RESV-QTY =                           37796237
377963                 (CEPLIT-PL-REQ-QTY * -1)                         37796337
377964         MOVE DK-PULL-NUMBER  TO PV-TRANS-PULL-NBR                37796440
377965         MOVE PV-TRANS-SOURCE-DESC                                37796530
377966                        TO CE016-TRANS-SOURCE-DESC                37796630
377967         IF PS-PROCESS-MQ-YES                                     37796794
377968             PERFORM 8200-MQ-PUT1                                 37796830
377969         END-IF                                                   37796994
377970     END-IF.                                                      37797029
377971                                                                  37797130
377972                                                                  37797229
377973     IF  PS-NO-ERROR                                              37797329
377974         PERFORM 8000-SYNCPOINT                                   37797429
377975     END-IF.                                                      37797529
377976                                                                  37797629
377977     IF PS-PROCESS-MQ-YES                                         37797794
377978         PERFORM 8700-MQ-DISCONNECT                               37797830
377979     END-IF.                                                      37797994
377980                                                                  37798030
377981     IF  PS-NO-ERROR                                              37798129
377982         PERFORM 4200-CNT-LINE-ITEMS                              37798229
377983     END-IF.                                                      37798329
377984                                                                  37798429
377985     IF  PS-NO-ERROR                                              37798529
377986         PERFORM 4210-CNT-CNCL-LINE-ITEMS                         37798629
377987     END-IF.                                                      37798729
377988                                                                  37798829
377989     IF  PS-NO-ERROR                                              37798929
377990         IF  PV-LNE-NBR-COUNT  =  PV-LNE-CNCL-COUNT               37799029
377991             MOVE  PC-CANCEL  TO  CEPLRQ-STAT-CDE                 37799129
377992                                  CEPLST-STAT-CDE                 37799229
377993             PERFORM 4130-UPDATE-TCEPLRQ                          37799329
377994                                                                  37799429
377995             IF  PS-NO-ERROR                                      37799529
377996                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37799629
377997                 PERFORM 4110-INSERT-TCEPLST                      37799729
377998             END-IF                                               37799829
377999         END-IF                                                   37799929
378000     END-IF.                                                      37800029
378001                                                                  37800129
378002     IF  PS-NO-ERROR                                              37800229
378003         PERFORM 8000-SYNCPOINT                                   37800329
378004     END-IF.                                                      37800429
378005                                                                  37800529
378006* CHECK TO SEE IF LINES NOT CANCELLED ARE ALL DISTRIBUTED/POSTED  37800629
378007* CHANGE PULL STATUS                                              37800729
378008                                                                  37800829
378009     IF  PS-NO-ERROR                                              37800929
378010         PERFORM 4220-CHECK-PULL-STATUS                           37801029
378011     END-IF.                                                      37801129
378012                                                                  37801229
378013     IF  PS-NO-ERROR                                              37801329
378014         PERFORM 4230-CNT-NOT-CNCL-LINES                          37801429
378015     END-IF.                                                      37801529
378016                                                                  37801629
378017     IF  PS-NO-ERROR                                              37801729
378018         PERFORM 4235-CNT-POST-LINES                              37801829
378019     END-IF.                                                      37801929
378020                                                                  37802029
378021     IF  PS-NO-ERROR                                              37802129
378022         PERFORM 4240-CNT-POST-DIST-LINES                         37802229
378023     END-IF.                                                      37802329
378024                                                                  37802429
378025     IF  PS-NO-ERROR                                              37802529
378026         IF  PV-LNE-NOT-CNCL-COUNT  =  PV-LNE-POST-COUNT AND      37802629
378027             PV-LNE-POST-COUNT      >  ZEROES                     37802729
378028             MOVE  PC-POSTED       TO  CEPLRQ-STAT-CDE            37802829
378029                                       CEPLST-STAT-CDE            37802929
378030             IF  PS-NO-ERROR                                      37803029
378031                 PERFORM 4130-UPDATE-TCEPLRQ                      37803129
378032             END-IF                                               37803229
378033             IF  PS-NO-ERROR                                      37803329
378034                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37803429
378035                 PERFORM 4110-INSERT-TCEPLST                      37803529
378036             END-IF                                               37803629
378037         ELSE                                                     37803729
378038         IF  PV-LNE-NOT-CNCL-COUNT  =  PV-LNE-POST-DIST-COUNT AND 37803829
378039             PV-LNE-POST-DIST-COUNT >  ZEROES                     37803929
378040             MOVE  PC-DISTRIBUTED  TO  CEPLRQ-STAT-CDE            37804029
378041                                       CEPLST-STAT-CDE            37804129
378042             IF  PS-NO-ERROR                                      37804229
378043                 PERFORM 4130-UPDATE-TCEPLRQ                      37804329
378044             END-IF                                               37804429
378045             IF  PS-NO-ERROR                                      37804529
378046                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37804629
378047                 PERFORM 4110-INSERT-TCEPLST                      37804729
378048             END-IF                                               37804829
378049         END-IF                                                   37804929
378050         END-IF                                                   37805029
378051     END-IF.                                                      37805129
378052                                                                  37805229
378053     IF  PS-NO-ERROR                                              37805329
378054         PERFORM 8000-SYNCPOINT                                   37805429
378055     END-IF.                                                      37805529
378056                                                                  37805629
378057                                                                  37805729
378058                                                                  37805829
378059*----------------------------------------------------------------*37805929
378060* UN-CANCEL LINE ITEM                                            *37806029
378061*----------------------------------------------------------------*37806129
378062 2170-UNCNCL-ITEM.                                                37806254
378063                                                                  37806329
378064     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37806429
378065     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37806529
378066     MOVE  CE005-LNE-NBR   TO  DK-LINE-NUMBER.                    37806629
378067                                                                  37806729
378068                                                                  37806829
378069     IF  PS-NO-ERROR AND                                          37806929
378070        XL071-E-BUS-IND = 'Y' AND                                 37807047
378071        XL071-LOC-TYP-CDE = 'DS'                                  37807147
378072         INITIALIZE CE016-INV-TRANS-RECORD                        37807236
378073         IF PS-PROCESS-MQ-YES                                     37807394
378074             PERFORM 8100-MQ-SETUP                                37807430
378075         END-IF                                                   37807594
378076         PERFORM 4140-SELECT-TCEPLIT                              37807630
378077*        PERFORM 4400-SELECT-SKU                                  37807764
378078         PERFORM 4400-CALL-CICS-API-ARCH                          37807862
378079         MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER                 37807930
378080         MOVE CE005-CS-LOCATION                                   37808030
378081                               TO CE016-STORE-NUMBER              37808132
378082                                                                  37808250
378083         SET CE016-TRANS-TYPE-GET TO TRUE                         37808350
378084         SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE                37808450
378085         MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE                37808550
378086         MOVE ZERO             TO CE016-TRANS-RESV-QTY            37808650
378087                                  CE016-TRANS-AVAIL-QTY           37808750
378088         MOVE DK-PULL-NUMBER   TO PV-TRANS-PULL-NBR               37808850
378089         MOVE PV-TRANS-SOURCE-DESC                                37808950
378090                               TO CE016-TRANS-SOURCE-DESC         37809050
378091         IF PS-PROCESS-MQ-YES                                     37809194
378092             PERFORM 8200-MQ-PUT1                                 37809250
378093         END-IF                                                   37809394
378094                                                                  37809450
378095         MOVE CE016-TRANS-AVAIL-QTY TO PV-TRANS-AVAIL-QTY         37809551
378096         IF PS-PROCESS-MQ-YES AND                                 37809694
378097            PV-TRANS-AVAIL-QTY < CEPLIT-PL-REQ-QTY                37809751
378098             SET CE005-FUNC-INVALID TO TRUE                       37809851
378099             SET PS-ERROR           TO TRUE                       37809951
378100             MOVE 'UNITS ARE NOT AVAILABLE' TO CE005-RETURN-MSG   37810051
378101         ELSE                                                     37810150
378102             MOVE  PC-IN-PROCESS   TO  CEPLIT-STAT-CDE            37810250
378103             MOVE  PC-UN-CANCEL    TO  CEPLST-STAT-CDE            37810350
378104             PERFORM 4100-UPDATE-TCEPLIT                          37810450
378105                                                                  37810550
378106             IF  PS-NO-ERROR                                      37810650
378107                 PERFORM 4110-INSERT-TCEPLST                      37810750
378108             END-IF                                               37810850
378109                                                                  37810950
378110             INITIALIZE CE016-INV-TRANS-RECORD                    37811050
378111             MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER             37811150
378112             MOVE CE005-CS-LOCATION                               37811250
378113                                   TO CE016-STORE-NUMBER          37811350
378114                                                                  37811450
378115             SET CE016-TRANS-TYPE-X-TRANSFER TO TRUE              37811550
378116             SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE            37811650
378117             MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE            37811750
378118             MOVE ZERO        TO CE016-TRANS-AVAIL-QTY            37811850
378119             MOVE CEPLIT-PL-REQ-QTY                               37811950
378120                              TO CE016-TRANS-RESV-QTY             37812050
378121             MOVE DK-PULL-NUMBER  TO PV-TRANS-PULL-NBR            37812150
378122             MOVE PV-TRANS-SOURCE-DESC                            37812250
378123                            TO CE016-TRANS-SOURCE-DESC            37812350
378124             IF PS-PROCESS-MQ-YES                                 37812494
378125                 PERFORM 8200-MQ-PUT1                             37812550
378126             END-IF                                               37812694
378127         END-IF                                                   37812750
378128         IF  PS-NO-ERROR                                          37812854
378129             PERFORM 8000-SYNCPOINT                               37812954
378130         END-IF                                                   37813054
378140                                                                  37814054
378141         IF PS-PROCESS-MQ-YES                                     37814194
378142             PERFORM 8700-MQ-DISCONNECT                           37814254
378143         END-IF                                                   37814394
378144                                                                  37814454
378145     ELSE                                                         37814552
378146         MOVE  PC-IN-PROCESS   TO  CEPLIT-STAT-CDE                37814652
378147         MOVE  PC-UN-CANCEL    TO  CEPLST-STAT-CDE                37814752
378148         PERFORM 4100-UPDATE-TCEPLIT                              37814852
378149                                                                  37814952
378150         IF  PS-NO-ERROR                                          37815052
378151             PERFORM 4110-INSERT-TCEPLST                          37815152
378152         END-IF                                                   37815252
378153         IF  PS-NO-ERROR                                          37815354
378154             PERFORM 8000-SYNCPOINT                               37815454
378155         END-IF                                                   37815554
378156     END-IF.                                                      37815650
378157     IF  PS-NO-ERROR                                              37815729
378158         PERFORM 4220-CHECK-PULL-STATUS                           37815829
378159     END-IF.                                                      37815929
378160                                                                  37816029
378161     IF  PS-NO-ERROR                                              37816129
378162         IF  CEPLRQ-STAT-CDE  =  PC-CANCEL                        37816229
378163             MOVE  PC-IN-PROCESS  TO  CEPLRQ-STAT-CDE             37816329
378164             MOVE  PC-UN-CANCEL   TO  CEPLST-STAT-CDE             37816429
378165             PERFORM 4130-UPDATE-TCEPLRQ                          37816529
378166                                                                  37816629
378167             IF  PS-NO-ERROR                                      37816729
378168                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37816829
378169                 PERFORM 4110-INSERT-TCEPLST                      37816929
378170             END-IF                                               37817029
378171         END-IF                                                   37817129
378172     END-IF.                                                      37817229
378173                                                                  37817329
378174     IF  PS-NO-ERROR                                              37817429
378175         PERFORM 8000-SYNCPOINT                                   37817529
378176     END-IF.                                                      37817629
378177                                                                  37817729
378178                                                                  37817829
378179*----------------------------------------------------------------*37817929
378180* CONFIRM DISTRIBUTION FOR LINE ITEM                             *37818029
378181*----------------------------------------------------------------*37818129
378182 2180-CNFM-DIST-ITEM.                                             37818229
378183                                                                  37818329
378184     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37818429
378185     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37818529
378186     MOVE  CE005-LNE-NBR   TO  DK-LINE-NUMBER.                    37818629
378187                                                                  37818729
378188     IF  PS-NO-ERROR                                              37818829
378189         PERFORM 4140-SELECT-TCEPLIT                              37818929
378190     END-IF.                                                      37819029
378191                                                                  37819129
378192     IF  PS-NO-ERROR                                              37819229
378193         MOVE  PC-DISTRIBUTED         TO  CEPLIT-STAT-CDE         37819329
378194                                          CEPLST-STAT-CDE         37819429
378195                                                                  37819529
378196         IF  PS-NO-ERROR                                          37819629
378197             PERFORM 4105-UPDATE-TCEPLIT                          37819729
378198         END-IF                                                   37819829
378199                                                                  37819929
378200         IF  PS-NO-ERROR                                          37820029
378201             PERFORM 4110-INSERT-TCEPLST                          37820129
378202         END-IF                                                   37820229
378203                                                                  37820329
378204         SET PS-NOT-EOF-DIST-DETAIL-CSR  TO  TRUE                 37820429
378205                                                                  37820529
378206         IF  PS-NO-ERROR                                          37820629
378207             PERFORM 2125-CNFM-DIST-TCEPLDS                       37820729
378208         END-IF                                                   37820829
378209     END-IF.                                                      37820929
378210                                                                  37821029
378211     IF  PS-NO-ERROR                                              37821129
378212         PERFORM 8000-SYNCPOINT                                   37821229
378213     END-IF.                                                      37821329
378214                                                                  37821429
378215     IF  PS-NO-ERROR                                              37821529
378216         PERFORM 4220-CHECK-PULL-STATUS                           37821629
378217     END-IF.                                                      37821729
378218                                                                  37821829
378219     IF  PS-NO-ERROR                                              37821929
378220         PERFORM 4230-CNT-NOT-CNCL-LINES                          37822029
378221     END-IF.                                                      37822129
378222                                                                  37822229
378223     IF  PS-NO-ERROR                                              37822329
378224         PERFORM 4240-CNT-POST-DIST-LINES                         37822429
378225     END-IF.                                                      37822529
378226                                                                  37822629
378227     IF  PS-NO-ERROR                                              37822729
378228         IF  PV-LNE-NOT-CNCL-COUNT  =  PV-LNE-POST-DIST-COUNT     37822829
378229             MOVE  PC-DISTRIBUTED  TO  CEPLRQ-STAT-CDE            37822929
378230                                       CEPLST-STAT-CDE            37823029
378231             IF  PS-NO-ERROR                                      37823129
378232                 PERFORM 4130-UPDATE-TCEPLRQ                      37823229
378233             END-IF                                               37823329
378234             IF  PS-NO-ERROR                                      37823429
378235                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37823529
378236                 PERFORM 4110-INSERT-TCEPLST                      37823629
378237             END-IF                                               37823729
378238         ELSE                                                     37823829
378239         IF  CEPLRQ-STAT-CDE   =  PC-NEW                          37823929
378240             MOVE  PC-IN-PROCESS   TO  CEPLRQ-STAT-CDE            37824029
378241                                       CEPLST-STAT-CDE            37824129
378242             IF  PS-NO-ERROR                                      37824229
378243                 PERFORM 4130-UPDATE-TCEPLRQ                      37824329
378244             END-IF                                               37824429
378245             IF  PS-NO-ERROR                                      37824529
378246                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37824629
378247                 PERFORM 4110-INSERT-TCEPLST                      37824729
378248             END-IF                                               37824829
378249         END-IF                                                   37824929
378250         END-IF                                                   37825029
378251     END-IF.                                                      37825129
378252                                                                  37825229
378253     IF  PS-NO-ERROR                                              37825329
378254         PERFORM 8000-SYNCPOINT                                   37825429
378255     END-IF.                                                      37825529
378256                                                                  37825629
378257                                                                  37825729
378258*----------------------------------------------------------------*37825829
378259* UN-CONFIRM DISTRIBUTION FOR LINE ITEM                          *37825929
378260*----------------------------------------------------------------*37826029
378261 2190-UNCNFM-DIST-ITEM.                                           37826129
378262                                                                  37826229
378263     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37826329
378264     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37826429
378265     MOVE  CE005-LNE-NBR   TO  DK-LINE-NUMBER.                    37826529
378266                                                                  37826629
378267     IF  PS-NO-ERROR                                              37826729
378268         PERFORM 4140-SELECT-TCEPLIT                              37826829
378269     END-IF.                                                      37826929
378270                                                                  37827029
378271     IF  PS-NO-ERROR                                              37827129
378272         MOVE  PC-IN-PROCESS      TO  CEPLIT-STAT-CDE             37827229
378273         MOVE  PC-UN-DISTRIBUTED  TO  CEPLST-STAT-CDE             37827329
378274                                                                  37827429
378275         PERFORM 4105-UPDATE-TCEPLIT                              37827529
378276     END-IF.                                                      37827629
378277                                                                  37827729
378278     IF  PS-NO-ERROR                                              37827829
378279         PERFORM 4110-INSERT-TCEPLST                              37827929
378280     END-IF.                                                      37828029
378281                                                                  37828129
378282     SET PS-NOT-EOF-DIST-DETAIL-CSR  TO  TRUE.                    37828229
378283     IF  PS-NO-ERROR                                              37828329
378284         PERFORM 2135-UNCNFM-DIST-TCEPLDS                         37828429
378285     END-IF.                                                      37828529
378286                                                                  37828629
378287     IF  PS-NO-ERROR                                              37828729
378288         PERFORM 8000-SYNCPOINT                                   37828829
378289     END-IF.                                                      37828929
378290                                                                  37829029
378291     IF  PS-NO-ERROR                                              37829129
378292         PERFORM 4220-CHECK-PULL-STATUS                           37829229
378293     END-IF.                                                      37829329
378294                                                                  37829429
378295     IF  CEPLRQ-STAT-CDE   =  PC-DISTRIBUTED                      37829529
378296         MOVE  PC-IN-PROCESS     TO CEPLRQ-STAT-CDE               37829629
378297         MOVE  PC-UN-DISTRIBUTED TO CEPLST-STAT-CDE               37829729
378298         IF  PS-NO-ERROR                                          37829829
378299             PERFORM 4130-UPDATE-TCEPLRQ                          37829929
378300         END-IF                                                   37830029
378301         IF  PS-NO-ERROR                                          37830129
378302             MOVE  ZEROES  TO  DK-LINE-NUMBER                     37830229
378303             PERFORM 4110-INSERT-TCEPLST                          37830329
378304         END-IF                                                   37830429
378305     END-IF.                                                      37830529
378306                                                                  37830629
378307     IF  PS-NO-ERROR                                              37830729
378308         PERFORM 8000-SYNCPOINT                                   37830829
378309     END-IF.                                                      37830929
378310                                                                  37831029
378311                                                                  37831129
378312*----------------------------------------------------------------*37831229
378313* CONFIRM LINE ITEM                                              *37831329
378314*----------------------------------------------------------------*37831429
378315 2200-CNFM-ITEM.                                                  37831529
378316                                                                  37831629
378317                                                                  37831729
378318                                                                  37831829
378319*----------------------------------------------------------------*37831929
378320* UN-CONFIRM LINE ITEM                                           *37832029
378321*----------------------------------------------------------------*37832129
378322 2210-UNCNFM-ITEM.                                                37832229
378323                                                                  37832329
378324                                                                  37832429
378325                                                                  37832529
378326                                                                  37832629
378327                                                                  37832729
378328                                                                  37832829
378329*----------------------------------------------------------------*37832929
378330* POST LINE ITEM                                                 *37833029
378331*----------------------------------------------------------------*37833129
378332 2220-POST-ITEM.                                                  37833229
378333                                                                  37833329
378334     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37833429
378335     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37833529
378336     MOVE  CE005-LNE-NBR   TO  DK-LINE-NUMBER.                    37833629
378337                                                                  37833729
378338     MOVE  PC-POSTED       TO  CEPLIT-STAT-CDE                    37833829
378339                               CEPLST-STAT-CDE.                   37833929
378340                                                                  37834029
378341     PERFORM 4100-UPDATE-TCEPLIT.                                 37834158
378342                                                                  37834229
378343     IF  PS-NO-ERROR                                              37834329
378344         PERFORM 4110-INSERT-TCEPLST                              37834429
378345     END-IF.                                                      37834553
378346                                                                  37834629
378347     IF  PS-NO-ERROR                                              37834753
378348         PERFORM 8000-SYNCPOINT                                   37834853
378349     END-IF.                                                      37834953
378350                                                                  37835053
378351     IF  PS-NO-ERROR AND                                          37835153
378352        XL071-E-BUS-IND = 'Y' AND                                 37835253
378353        XL071-LOC-TYP-CDE = 'DS'                                  37835353
378354         PERFORM 4500-GET-PULL-ITEM                               37835458
378355         MOVE PV-PULL-STATUS  TO DK-LINE-STATUS                   37835556
378356         PERFORM 4600-GET-ITEM-DISTRO                             37835653
378357         PERFORM 4700-GET-PULL-MANIFEST                           37835753
378358         PERFORM 4800-GET-PULL-ADJUST                             37835853
378359         COMPUTE PV-COMPUTE-DISTRB-QTY =                          37835953
378360                 (PV-CEPLDS-DISTRB-QTY +                          37836053
378361                  PV-CEPLMF-MANIF-QTY  +                          37836153
378362                  PV-CEPLAU-ADJUST-QTY)                           37836253
378363         IF PV-COMPUTE-DISTRB-QTY < PV-CEPLIT-REQ-QTY             37836353
378364                                                                  37836453
378365             INITIALIZE CE016-INV-TRANS-RECORD                    37836553
378366             IF PS-PROCESS-MQ-YES                                 37836694
378367                 PERFORM 8100-MQ-SETUP                            37836753
378368             END-IF                                               37836894
378369             PERFORM 4140-SELECT-TCEPLIT                          37836953
378370*            PERFORM 4400-SELECT-SKU                              37837062
378371             PERFORM 4400-CALL-CICS-API-ARCH                      37837162
378372             MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER             37837262
378373             MOVE CE005-CS-LOCATION                               37837362
378374                                   TO CE016-STORE-NUMBER          37837462
378375             SET CE016-TRANS-TYPE-ADJ TO TRUE                     37837562
378376             SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE            37837662
378377             MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE            37837762
378378             MOVE ZERO        TO CE016-TRANS-AVAIL-QTY            37837862
378379             COMPUTE CE016-TRANS-RESV-QTY =                       37837962
378380              ((PV-CEPLIT-REQ-QTY - PV-COMPUTE-DISTRB-QTY) * -1)  37838053
378381             MOVE DK-PULL-NUMBER  TO PV-TRANS-PULL-NBR            37838153
378382             MOVE PV-TRANS-SOURCE-DESC                            37838253
378383                            TO CE016-TRANS-SOURCE-DESC            37838353
378384             IF PS-PROCESS-MQ-YES                                 37838494
378385                 PERFORM 8200-MQ-PUT1                             37838553
378386             END-IF                                               37838694
378387         END-IF                                                   37838753
378388     END-IF.                                                      37838853
378389                                                                  37838953
378390                                                                  37839053
378391     IF  PS-NO-ERROR                                              37839153
378392         PERFORM 8000-SYNCPOINT                                   37839253
378393     END-IF.                                                      37839353
378394                                                                  37839453
378395     IF PS-PROCESS-MQ-YES                                         37839594
378396         PERFORM 8700-MQ-DISCONNECT                               37839653
378397     END-IF.                                                      37839794
378398                                                                  37839829
378399     IF  PS-NO-ERROR                                              37839929
378400         PERFORM 4200-CNT-LINE-ITEMS                              37840029
378401     END-IF.                                                      37840129
378402                                                                  37840229
378403     IF  PS-NO-ERROR                                              37840329
378404         PERFORM 4235-CNT-POST-LINES                              37840429
378405     END-IF.                                                      37840529
378406                                                                  37840629
378407     IF  PS-NO-ERROR                                              37840729
378408         PERFORM 4230-CNT-NOT-CNCL-LINES                          37840829
378409     END-IF.                                                      37840929
378410                                                                  37841029
378411     IF  PS-NO-ERROR                                              37841129
378412         IF  (PV-LNE-NBR-COUNT       =  PV-LNE-POST-COUNT AND     37841229
378413              PV-LNE-POST-COUNT      >  ZEROES)   OR              37841329
378414             (PV-LNE-NOT-CNCL-COUNT  =  PV-LNE-POST-COUNT AND     37841429
378415              PV-LNE-POST-COUNT      >  ZEROES)                   37841529
378416             MOVE  PC-POSTED  TO  CEPLRQ-STAT-CDE                 37841629
378417                                  CEPLST-STAT-CDE                 37841729
378418             PERFORM 4130-UPDATE-TCEPLRQ                          37841829
378419                                                                  37841929
378420             IF  PS-NO-ERROR                                      37842029
378421                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37842129
378422                 PERFORM 4110-INSERT-TCEPLST                      37842229
378423             END-IF                                               37842329
378424         END-IF                                                   37842429
378425     END-IF.                                                      37842529
378426                                                                  37842629
378427     IF  PS-NO-ERROR                                              37842729
378428         PERFORM 8000-SYNCPOINT                                   37842829
378429     END-IF.                                                      37842929
378430                                                                  37843029
378431                                                                  37843129
378432*----------------------------------------------------------------*37843229
378433* UN-POST LINE ITEM                                              *37843329
378434*----------------------------------------------------------------*37843429
378435 2230-UNPOST-ITEM.                                                37843529
378436                                                                  37843629
378437     MOVE  CE005-PULL-NBR  TO  DK-PULL-NUMBER.                    37843729
378438     MOVE  CE005-REF-NBR   TO  DK-REF-NUMBER.                     37843829
378439     MOVE  CE005-LNE-NBR   TO  DK-LINE-NUMBER.                    37843929
378440                                                                  37844029
378441     IF  PS-NO-ERROR AND                                          37844153
378442        XL071-E-BUS-IND = 'Y' AND                                 37844253
378443        XL071-LOC-TYP-CDE = 'DS'                                  37844353
378444         PERFORM 4500-GET-PULL-ITEM                               37844459
378445         MOVE PV-PULL-STATUS  TO DK-LINE-STATUS                   37844559
378446         PERFORM 4600-GET-ITEM-DISTRO                             37844654
378447         PERFORM 4700-GET-PULL-MANIFEST                           37844754
378448         PERFORM 4800-GET-PULL-ADJUST                             37844854
378449         COMPUTE PV-COMPUTE-DISTRB-QTY =                          37844954
378450                 (PV-CEPLDS-DISTRB-QTY +                          37845054
378451                  PV-CEPLMF-MANIF-QTY  +                          37845154
378452                  PV-CEPLAU-ADJUST-QTY)                           37845254
378453         IF PV-COMPUTE-DISTRB-QTY < PV-CEPLIT-REQ-QTY             37845359
378454           INITIALIZE CE016-INV-TRANS-RECORD                      37845459
378455           IF PS-PROCESS-MQ-YES                                   37845594
378456               PERFORM 8100-MQ-SETUP                              37845659
378457           END-IF                                                 37845794
378458           PERFORM 4140-SELECT-TCEPLIT                            37845859
378459*          PERFORM 4400-SELECT-SKU                                37845962
378460           PERFORM 4400-CALL-CICS-API-ARCH                        37846062
378461           MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER               37846162
378462           MOVE CE005-CS-LOCATION                                 37846262
378463                                 TO CE016-STORE-NUMBER            37846362
378464                                                                  37846462
378465           SET CE016-TRANS-TYPE-GET TO TRUE                       37846562
378466           SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE              37846662
378467           MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE              37846762
378468           MOVE ZERO             TO CE016-TRANS-RESV-QTY          37846862
378469                                    CE016-TRANS-AVAIL-QTY         37846962
378470           MOVE DK-PULL-NUMBER   TO PV-TRANS-PULL-NBR             37847062
378471           MOVE PV-TRANS-SOURCE-DESC                              37847162
378472                                 TO CE016-TRANS-SOURCE-DESC       37847262
378473           IF PS-PROCESS-MQ-YES                                   37847394
378474               PERFORM 8200-MQ-PUT1                               37847462
378475           END-IF                                                 37847594
378476                                                                  37847662
378477           MOVE CE016-TRANS-AVAIL-QTY TO PV-TRANS-AVAIL-QTY       37847762
378478                                                                  37847894
378479* DMH - ADDED "IF PS-PROCESS-MQ-YES AND"   6/7/2021               37847994
378480           IF PS-PROCESS-MQ-YES AND                               37848094
378481*                                                                 37848194
378482              PV-TRANS-AVAIL-QTY <                                37848294
378483                 (PV-CEPLIT-REQ-QTY - PV-COMPUTE-DISTRB-QTY)      37848362
378484               SET CE005-FUNC-INVALID TO TRUE                     37848462
378485               SET PS-ERROR           TO TRUE                     37848562
378486               MOVE 'UNITS ARE NOT AVAILABLE' TO CE005-RETURN-MSG 37848662
378487               MOVE  PC-IN-PROCESS   TO  CEPLIT-STAT-CDE          37848762
378488               MOVE  PC-UN-POSTED    TO  CEPLST-STAT-CDE          37848862
378489                                                                  37848962
378490           ELSE                                                   37849059
378491               MOVE  PC-IN-PROCESS   TO  CEPLIT-STAT-CDE          37849159
378492               MOVE  PC-UN-POSTED    TO  CEPLST-STAT-CDE          37849259
378493                                                                  37849359
378494               PERFORM 4100-UPDATE-TCEPLIT                        37849459
378495                                                                  37849559
378496               IF  PS-NO-ERROR                                    37849659
378497                   PERFORM 4110-INSERT-TCEPLST                    37849759
378498               END-IF                                             37849859
378499                                                                  37849959
378500               INITIALIZE CE016-INV-TRANS-RECORD                  37850059
378501               MOVE PV-SKU-NUMBER   TO CE016-SKU-NUMBER           37850159
378502               MOVE CE005-CS-LOCATION                             37850259
378503                                     TO CE016-STORE-NUMBER        37850359
378504                                                                  37850459
378505               SET CE016-TRANS-TYPE-X-TRANSFER TO TRUE            37850559
378506               SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE          37850659
378507               MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE          37850759
378508               MOVE ZERO        TO CE016-TRANS-AVAIL-QTY          37850859
378509               COMPUTE CE016-TRANS-RESV-QTY =                     37850959
378510                 (PV-CEPLIT-REQ-QTY - PV-COMPUTE-DISTRB-QTY)      37851059
378511               MOVE DK-PULL-NUMBER  TO PV-TRANS-PULL-NBR          37851159
378512               MOVE PV-TRANS-SOURCE-DESC                          37851259
378520                              TO CE016-TRANS-SOURCE-DESC          37852059
378521               IF PS-PROCESS-MQ-YES                               37852194
378522                   PERFORM 8200-MQ-PUT1                           37852259
378523               END-IF                                             37852394
378524           END-IF                                                 37852459
378525           IF  PS-NO-ERROR                                        37852559
378526               PERFORM 8000-SYNCPOINT                             37852659
378527           END-IF                                                 37852759
378528                                                                  37852859
378529           IF PS-PROCESS-MQ-YES                                   37852994
378530               PERFORM 8700-MQ-DISCONNECT                         37853059
378531           END-IF                                                 37853194
378532         ELSE                                                     37853259
378533           MOVE  PC-IN-PROCESS   TO  CEPLIT-STAT-CDE              37853359
378534           MOVE  PC-UN-POSTED    TO  CEPLST-STAT-CDE              37853459
378535                                                                  37853559
378536           PERFORM 4100-UPDATE-TCEPLIT                            37853659
378537                                                                  37853759
378538           IF  PS-NO-ERROR                                        37853859
378539               PERFORM 4110-INSERT-TCEPLST                        37853959
378540           END-IF                                                 37854059
378541           IF  PS-NO-ERROR                                        37854159
378542               PERFORM 8000-SYNCPOINT                             37854259
378543           END-IF                                                 37854359
378544                                                                  37854459
378545         END-IF                                                   37854559
378546     ELSE                                                         37854653
378547         MOVE  PC-IN-PROCESS   TO  CEPLIT-STAT-CDE                37854758
378548         MOVE  PC-UN-POSTED    TO  CEPLST-STAT-CDE                37854858
378549                                                                  37854954
378550         PERFORM 4100-UPDATE-TCEPLIT                              37855054
378551                                                                  37855154
378552         IF  PS-NO-ERROR                                          37855254
378553             PERFORM 4110-INSERT-TCEPLST                          37855354
378554         END-IF                                                   37855454
378555         IF  PS-NO-ERROR                                          37855554
378556             PERFORM 8000-SYNCPOINT                               37855654
378557         END-IF                                                   37855754
378558                                                                  37855854
378559     END-IF.                                                      37855953
378560                                                                  37856054
378561     IF  PS-NO-ERROR                                              37856129
378562         PERFORM 4220-CHECK-PULL-STATUS                           37856229
378563     END-IF.                                                      37856329
378564                                                                  37856429
378565     IF  PS-NO-ERROR                                              37856529
378566         IF  CEPLRQ-STAT-CDE  =  PC-POSTED                        37856629
378567             MOVE  PC-IN-PROCESS  TO  CEPLRQ-STAT-CDE             37856729
378568             MOVE  PC-UN-POSTED   TO  CEPLST-STAT-CDE             37856829
378569             PERFORM 4130-UPDATE-TCEPLRQ                          37856929
378570                                                                  37857029
378571             IF  PS-NO-ERROR                                      37857129
378572                 MOVE  ZEROES  TO  DK-LINE-NUMBER                 37857229
378573                 PERFORM 4110-INSERT-TCEPLST                      37857329
378574             END-IF                                               37857429
378575         END-IF                                                   37857529
378576     END-IF.                                                      37857629
378577                                                                  37857729
378578     IF  PS-NO-ERROR                                              37857829
378579         PERFORM 8000-SYNCPOINT                                   37857929
378580     END-IF.                                                      37858029
378581                                                                  37858129
378582                                                                  37858229
378583*----------------------------------------------------------------*37858329
378584* OPEN CURSOR                                                    *37858429
378585*   IN THIS PARTICULAR APPLICATION THERE ARE MANY DIFFERENT      *37858529
378586*   CURSORS THAT COULD BE OPENED DEPENDING ON THE CRITERIA       *37858629
378587*   SPECIFIED BY THE USER                                        *37858729
378588*----------------------------------------------------------------*37858829
378589                                                                  37858929
378590 4000-OPEN-CURSOR.                                                37859029
378591                                                                  37859129
378592     EVALUATE TRUE                                                37859229
378593         WHEN CE005-CNCL-PULL                                     37859329
378594              MOVE 'OPEN:CNCL-PULL-CSR'                           37859429
378595                                TO CE005-RETURN-MSG               37859529
378596              EXEC SQL                                            37859629
378597                   OPEN CNCL-PULL-CSR                             37859729
378598              END-EXEC                                            37859829
378599                                                                  37859929
378600         WHEN CE005-UNCNCL-PULL                                   37860029
378601              MOVE 'OPEN:UNCNCL-PULL-CSR'                         37860129
378602                                TO CE005-RETURN-MSG               37860229
378603              EXEC SQL                                            37860329
378604                   OPEN UNCNCL-PULL-CSR                           37860429
378605              END-EXEC                                            37860529
378606                                                                  37860629
378607         WHEN CE005-CNFM-DIST-PULL                                37860729
378608              MOVE 'OPEN:CNFM-DIST-PULL-CSR'                      37860829
378609                                TO CE005-RETURN-MSG               37860929
378610              EXEC SQL                                            37861029
378611                   OPEN CNFM-DIST-PULL-CSR                        37861129
378612              END-EXEC                                            37861229
378613                                                                  37861329
378614         WHEN CE005-UNCNFM-DIST-PULL                              37861429
378615              MOVE 'OPEN:UNCNFM-DIST-PL-CSR'                      37861529
378616                                TO CE005-RETURN-MSG               37861629
378617              EXEC SQL                                            37861729
378618                   OPEN UNCNFM-DIST-PL-CSR                        37861829
378619              END-EXEC                                            37861929
378620                                                                  37862029
378621*        WHEN CE005-CNFM-PULL                                     37862129
378622*        WHEN CE005-UNCNFM-PULL                                   37862229
378623                                                                  37862329
378624     END-EVALUATE.                                                37862429
378625                                                                  37862529
378626     EVALUATE TRUE                                                37862629
378627         WHEN SQLCODE = ZERO                                      37862729
378628              CONTINUE                                            37862829
378629         WHEN SQLWARN0 NOT = SPACES                               37862929
378630         WHEN SQLCODE < ZERO                                      37863029
378631         WHEN SQLCODE > ZERO                                      37863129
378632              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37863229
378633                                PV-DISPLAY-RET-CDE                37863329
378634              SET  CE005-FUNC-INVALID                             37863429
378635                   PS-ERROR            TO  TRUE                   37863529
378636              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37863629
378637                     ' 4000-OPEN-CURSOR - ' DELIMITED BY SIZE     37863729
378638                     CE005-RETURN-MSG       DELIMITED BY SIZE     37863829
378639                                            INTO PV-CICS-MSG-AREA 37863929
378640             MOVE LENGTH OF PV-CICS-MSG-AREA                      37864029
378641               TO PV-COMMAREA-LENGTH                              37864129
378642             EXEC CICS                                            37864229
378643                  WRITEQ TD                                       37864329
378644                   QUEUE  ('CSSL')                                37864429
378645                    FROM  (PV-CICS-MSG-AREA)                      37864529
378646                  LENGTH  (PV-COMMAREA-LENGTH)                    37864629
378647                    RESP  (PV-CICS-RESP)                          37864729
378648             END-EXEC                                             37864829
378649                                                                  37864929
378650             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37865029
378651             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37865129
378652             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37865229
378653              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37865329
378654                     ' 4000-OPEN-CURSOR -'  DELIMITED BY SIZE     37865429
378655                     ' PULL-'               DELIMITED BY SIZE     37865529
378656                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37865629
378657                     '  REF-'               DELIMITED BY SIZE     37865729
378658                     PV-DISPLAY-REF         DELIMITED BY SIZE     37865829
378659                     '  LINE-'              DELIMITED BY SIZE     37865929
378660                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37866029
378661                     '  SQLCODE = '         DELIMITED BY SIZE     37866129
378662                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37866229
378663                                            INTO PV-CICS-MSG-AREA 37866329
378664             MOVE LENGTH OF PV-CICS-MSG-AREA                      37866429
378665               TO PV-COMMAREA-LENGTH                              37866529
378666             EXEC CICS                                            37866629
378667                  WRITEQ TD                                       37866729
378668                   QUEUE  ('CSSL')                                37866829
378669                    FROM  (PV-CICS-MSG-AREA)                      37866929
378670                  LENGTH  (PV-COMMAREA-LENGTH)                    37867029
378671                    RESP  (PV-CICS-RESP)                          37867129
378672             END-EXEC                                             37867229
378673             MOVE '4000-OPEN-CURSOR'                              37867329
378674                              TO DP013-PARAGRAPH                  37867429
378675             MOVE 'OPEN CURSOR             '                      37867529
378676                              TO DP013-MESSAGE-TEXT (1)           37867629
378677             MOVE SQLCA       TO DP013-SQLCA                      37867729
378678             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37867829
378679             SET DP013-DB2-ABEND                                  37867929
378680                 DP013-XCTL-DISPLAY-RESTART                       37868029
378681                                  TO TRUE                         37868129
378682             PERFORM DP013-0000-PROCESS-ABEND                     37868229
378683     END-EVALUATE.                                                37868329
378684                                                                  37868429
378685                                                                  37868529
378686*----------------------------------------------------------------*37868629
378687* OPEN CURSOR - DISTRIBUTION DETAIL                              *37868729
378688*----------------------------------------------------------------*37868829
378689                                                                  37868929
378690 4005-OPEN-DETAIL-CSR.                                            37869029
378691                                                                  37869129
378692     EXEC SQL                                                     37869229
378693          OPEN DIST-DETAIL-CSR                                    37869329
378694     END-EXEC                                                     37869429
378695                                                                  37869529
378696                                                                  37869629
378697     EVALUATE TRUE                                                37869729
378698         WHEN SQLCODE = ZERO                                      37869829
378699              CONTINUE                                            37869929
378700         WHEN SQLWARN0 NOT = SPACES                               37870029
378701         WHEN SQLCODE < ZERO                                      37870129
378702         WHEN SQLCODE > ZERO                                      37870229
378703              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37870329
378704                                PV-DISPLAY-RET-CDE                37870429
378705              SET  CE005-FUNC-INVALID                             37870529
378706                   PS-ERROR            TO  TRUE                   37870629
378707              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37870729
378708                     ' 4005-OPEN-DETAIL   ' DELIMITED BY SIZE     37870829
378709                     CE005-RETURN-MSG       DELIMITED BY SIZE     37870929
378710                                            INTO PV-CICS-MSG-AREA 37871029
378711             MOVE LENGTH OF PV-CICS-MSG-AREA                      37871129
378712               TO PV-COMMAREA-LENGTH                              37871229
378713             EXEC CICS                                            37871329
378714                  WRITEQ TD                                       37871429
378715                   QUEUE  ('CSSL')                                37871529
378716                    FROM  (PV-CICS-MSG-AREA)                      37871629
378717                  LENGTH  (PV-COMMAREA-LENGTH)                    37871729
378718                    RESP  (PV-CICS-RESP)                          37871829
378719             END-EXEC                                             37871929
378720                                                                  37872029
378721             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37872129
378722             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37872229
378723             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37872329
378724              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37872429
378725                     ' 4000-OPEN-CURSOR -'  DELIMITED BY SIZE     37872529
378726                     ' PULL-'               DELIMITED BY SIZE     37872629
378727                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37872729
378728                     '  REF-'               DELIMITED BY SIZE     37872829
378729                     PV-DISPLAY-REF         DELIMITED BY SIZE     37872929
378730                     '  LINE-'              DELIMITED BY SIZE     37873029
378731                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37873129
378732                     '  SQLCODE = '         DELIMITED BY SIZE     37873229
378733                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37873329
378734                                            INTO PV-CICS-MSG-AREA 37873429
378735             MOVE LENGTH OF PV-CICS-MSG-AREA                      37873529
378736               TO PV-COMMAREA-LENGTH                              37873629
378737             EXEC CICS                                            37873729
378738                  WRITEQ TD                                       37873829
378739                   QUEUE  ('CSSL')                                37873929
378740                    FROM  (PV-CICS-MSG-AREA)                      37874029
378741                  LENGTH  (PV-COMMAREA-LENGTH)                    37874129
378742                    RESP  (PV-CICS-RESP)                          37874229
378743             END-EXEC                                             37874329
378744             MOVE '4005-OPEN-CURSOR'                              37874429
378745                              TO DP013-PARAGRAPH                  37874529
378746             MOVE 'OPEN DETAIL CURSOR      '                      37874629
378747                              TO DP013-MESSAGE-TEXT (1)           37874729
378748             MOVE SQLCA       TO DP013-SQLCA                      37874829
378749             MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (1)         37874929
378750             SET DP013-DB2-ABEND                                  37875029
378751                 DP013-XCTL-DISPLAY-RESTART                       37875129
378752                                  TO TRUE                         37875229
378753             PERFORM DP013-0000-PROCESS-ABEND                     37875329
378754     END-EVALUATE.                                                37875429
378755                                                                  37875529
378756                                                                  37875629
378757*----------------------------------------------------------------*37875729
378758* FETCH CURSOR                                                   *37875829
378759*----------------------------------------------------------------*37875929
378760 4010-FETCH-CURSOR.                                               37876029
378761                                                                  37876129
378762     EVALUATE TRUE                                                37876229
378763         WHEN CE005-CNCL-PULL                                     37876329
378764              MOVE 'FETCH:CNCL-PULL-CSR'                          37876429
378765                                TO CE005-RETURN-MSG               37876529
378766              EXEC SQL                                            37876629
378767                   FETCH CNCL-PULL-CSR                            37876729
378768                    INTO :CEPLIT-CNSTK-REQ-PL-NBR                 37876829
378769                        ,:CEPLIT-PL-LNE-NBR                       37876929
378770                        ,:CEPLIT-ITM-NBR                          37877029
378771                        ,:CEPLIT-PL-REQ-QTY                       37877129
378772              END-EXEC                                            37877229
378773                                                                  37877329
378774         WHEN CE005-UNCNCL-PULL                                   37877429
378775              MOVE 'FETCH:UNCNCL-PULL-CSR'                        37877529
378776                                TO CE005-RETURN-MSG               37877629
378777              EXEC SQL                                            37877729
378778                   FETCH UNCNCL-PULL-CSR                          37877829
378779                    INTO :CEPLIT-CNSTK-REQ-PL-NBR                 37877929
378780                        ,:CEPLIT-PL-LNE-NBR                       37878029
378781                        ,:CEPLIT-ITM-NBR                          37878129
378782                        ,:CEPLIT-PL-REQ-QTY                       37878229
378783              END-EXEC                                            37878329
378784                                                                  37878429
378785         WHEN CE005-CNFM-DIST-PULL                                37878529
378786              MOVE 'FETCH:CNFM-DIST-PULL-CSR'                     37878629
378787                                TO CE005-RETURN-MSG               37878729
378788              EXEC SQL                                            37878829
378789                   FETCH CNFM-DIST-PULL-CSR                       37878929
378790                    INTO :CEPLIT-CNSTK-REQ-PL-NBR                 37879029
378791                        ,:CEPLIT-PL-LNE-NBR                       37879129
378792                        ,:CEPLIT-PL-REQ-QTY                       37879229
378793                        ,:CEPLIT-ACTL-PL-QTY :PV-NULL-IND-1       37879329
378794              END-EXEC                                            37879429
378795                                                                  37879529
378796         WHEN CE005-UNCNFM-DIST-PULL                              37879629
378797              MOVE 'FETCH:UNCNFM-DIST-PL-CSR'                     37879729
378798                                TO CE005-RETURN-MSG               37879829
378799              EXEC SQL                                            37879929
378800                   FETCH UNCNFM-DIST-PL-CSR                       37880029
378801                    INTO :CEPLIT-CNSTK-REQ-PL-NBR                 37880129
378802                        ,:CEPLIT-PL-LNE-NBR                       37880229
378803                        ,:CEPLIT-PL-REQ-QTY                       37880329
378804                        ,:CEPLIT-ACTL-PL-QTY                      37880429
378805              END-EXEC                                            37880529
378806                                                                  37880629
378807*        WHEN CE005-CNFM-PULL                                     37880729
378808*        WHEN CE005-UNCNFM-PULL                                   37880829
378809                                                                  37880929
378810     END-EVALUATE.                                                37881029
378811                                                                  37881129
378812     EVALUATE TRUE                                                37881229
378813         WHEN SQLCODE = ZERO                                      37881329
378814              CONTINUE                                            37881429
378815         WHEN SQLCODE = +100                                      37881529
378816              EVALUATE TRUE                                       37881629
378817                  WHEN CE005-CNCL-PULL                            37881729
378818                       SET  PS-EOF-CNCL-PULL-CSR       TO  TRUE   37881829
378819                  WHEN CE005-UNCNCL-PULL                          37881929
378820                       SET  PS-EOF-UNCNCL-PULL-CSR     TO  TRUE   37882029
378821                  WHEN CE005-CNFM-DIST-PULL                       37882129
378822                       SET  PS-EOF-CNFM-DIST-PULL      TO  TRUE   37882229
378823                  WHEN CE005-UNCNFM-DIST-PULL                     37882329
378824                       SET  PS-EOF-UNCNFM-DIST-PULL    TO  TRUE   37882429
378825                                                                  37882529
378826*                 WHEN CE005-CNFM-PULL                            37882629
378827*                 WHEN CE005-UNCNFM-PULL                          37882729
378828                                                                  37882829
378829              END-EVALUATE                                        37882929
378830                                                                  37883029
378831         WHEN SQLWARN0 NOT = SPACES                               37883129
378832         WHEN SQLCODE < ZERO                                      37883229
378833         WHEN SQLCODE > ZERO                                      37883329
378834              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37883429
378835                                PV-DISPLAY-RET-CDE                37883529
378836              SET  CE005-FUNC-INVALID                             37883629
378837                   PS-ERROR            TO  TRUE                   37883729
378838              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37883829
378839                     ' 4010-FETCH-CURSOR - ' DELIMITED BY SIZE    37883929
378840                     CE005-RETURN-MSG        DELIMITED BY SIZE    37884029
378841                                             INTO PV-CICS-MSG-AREA37884129
378842             MOVE LENGTH OF PV-CICS-MSG-AREA                      37884229
378843               TO PV-COMMAREA-LENGTH                              37884329
378844             EXEC CICS                                            37884429
378845                  WRITEQ TD                                       37884529
378846                   QUEUE  ('CSSL')                                37884629
378847                    FROM  (PV-CICS-MSG-AREA)                      37884729
378848                  LENGTH  (PV-COMMAREA-LENGTH)                    37884829
378849                    RESP  (PV-CICS-RESP)                          37884929
378850             END-EXEC                                             37885029
378851                                                                  37885129
378852             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37885229
378853             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37885329
378854             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37885429
378855              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37885529
378856                     ' 4000-OPEN-CURSOR -'  DELIMITED BY SIZE     37885629
378857                     ' PULL-'               DELIMITED BY SIZE     37885729
378858                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37885829
378859                     '  REF-'               DELIMITED BY SIZE     37885929
378860                     PV-DISPLAY-REF         DELIMITED BY SIZE     37886029
378861                     '  LINE-'              DELIMITED BY SIZE     37886129
378862                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37886229
378863                     '  SQLCODE = '         DELIMITED BY SIZE     37886329
378864                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37886429
378865                                            INTO PV-CICS-MSG-AREA 37886529
378866             MOVE LENGTH OF PV-CICS-MSG-AREA                      37886629
378867               TO PV-COMMAREA-LENGTH                              37886729
378868             EXEC CICS                                            37886829
378869                  WRITEQ TD                                       37886929
378870                   QUEUE  ('CSSL')                                37887029
378871                    FROM  (PV-CICS-MSG-AREA)                      37887129
378872                  LENGTH  (PV-COMMAREA-LENGTH)                    37887229
378873                    RESP  (PV-CICS-RESP)                          37887329
378874             END-EXEC                                             37887429
378875             MOVE '4010-FETCH-CURSOR'                             37887529
378876                              TO DP013-PARAGRAPH                  37887629
378877             MOVE 'FETCH CURSOR            '                      37887729
378878                              TO DP013-MESSAGE-TEXT (1)           37887829
378879             MOVE SQLCA       TO DP013-SQLCA                      37887929
378880             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37888029
378881             SET DP013-DB2-ABEND                                  37888129
378882                 DP013-XCTL-DISPLAY-RESTART                       37888229
378883                                  TO TRUE                         37888329
378884             PERFORM DP013-0000-PROCESS-ABEND                     37888429
378885     END-EVALUATE.                                                37888529
378886                                                                  37888629
378887                                                                  37888729
378888*----------------------------------------------------------------*37888829
378889* FETCH DISTRIBUTION DETAIL CURSOR                               *37888929
378890*----------------------------------------------------------------*37889029
378891 4015-FETCH-CURSOR.                                               37889129
378892                                                                  37889229
378893     EXEC SQL                                                     37889329
378894          FETCH DIST-DETAIL-CSR                                   37889429
378895           INTO :CEPLDS-CNSTK-REQ-PL-NBR                          37889529
378896               ,:CEPLDS-PL-LNE-NBR                                37889629
378897               ,:CEPLDS-STR-NBR                                   37889729
378898               ,:CEPLDS-REQ-ORD-QTY                               37889829
378899               ,:CEPLDS-ACTL-DISTRB-QTY :PV-NULL-IND-2            37889929
378900     END-EXEC.                                                    37890029
378901                                                                  37890129
378902                                                                  37890229
378903     EVALUATE TRUE                                                37890329
378904         WHEN SQLCODE = ZERO                                      37890429
378905              CONTINUE                                            37890529
378906         WHEN SQLCODE = +100                                      37890629
378907              SET  PS-EOF-DIST-DETAIL-CSR     TO  TRUE            37890729
378908                                                                  37890829
378909         WHEN SQLWARN0 NOT = SPACES                               37890929
378910         WHEN SQLCODE < ZERO                                      37891029
378911         WHEN SQLCODE > ZERO                                      37891129
378912              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37891229
378913                                PV-DISPLAY-RET-CDE                37891329
378914              SET  CE005-FUNC-INVALID                             37891429
378915                   PS-ERROR            TO  TRUE                   37891529
378916              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37891629
378917                     ' 4015-FETCH-CURSOR - ' DELIMITED BY SIZE    37891729
378918                     CE005-RETURN-MSG        DELIMITED BY SIZE    37891829
378919                                             INTO PV-CICS-MSG-AREA37891929
378920             MOVE LENGTH OF PV-CICS-MSG-AREA                      37892029
378921               TO PV-COMMAREA-LENGTH                              37892129
378922             EXEC CICS                                            37892229
378923                  WRITEQ TD                                       37892329
378924                   QUEUE  ('CSSL')                                37892429
378925                    FROM  (PV-CICS-MSG-AREA)                      37892529
378926                  LENGTH  (PV-COMMAREA-LENGTH)                    37892629
378927                    RESP  (PV-CICS-RESP)                          37892729
378928             END-EXEC                                             37892829
378929                                                                  37892929
378930             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37893029
378931             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37893129
378932             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37893229
378933              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37893329
378934                     ' 4015-FETCH-CURSOR-'  DELIMITED BY SIZE     37893429
378935                     ' PULL-'               DELIMITED BY SIZE     37893529
378936                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37893629
378937                     '  REF-'               DELIMITED BY SIZE     37893729
378938                     PV-DISPLAY-REF         DELIMITED BY SIZE     37893829
378939                     '  LINE-'              DELIMITED BY SIZE     37893929
378940                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37894029
378941                     '  SQLCODE = '         DELIMITED BY SIZE     37894129
378942                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37894229
378943                                            INTO PV-CICS-MSG-AREA 37894329
378944             MOVE LENGTH OF PV-CICS-MSG-AREA                      37894429
378945               TO PV-COMMAREA-LENGTH                              37894529
378946             EXEC CICS                                            37894629
378947                  WRITEQ TD                                       37894729
378948                   QUEUE  ('CSSL')                                37894829
378949                    FROM  (PV-CICS-MSG-AREA)                      37894929
378950                  LENGTH  (PV-COMMAREA-LENGTH)                    37895029
378951                    RESP  (PV-CICS-RESP)                          37895129
378952             END-EXEC                                             37895229
378953             MOVE '4015-FETCH-CURSOR'                             37895329
378954                              TO DP013-PARAGRAPH                  37895429
378955             MOVE 'FETCH CURSOR            '                      37895529
378956                              TO DP013-MESSAGE-TEXT (1)           37895629
378957             MOVE SQLCA       TO DP013-SQLCA                      37895729
378958             MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (1)         37895829
378959             SET DP013-DB2-ABEND                                  37895929
378960                 DP013-XCTL-DISPLAY-RESTART                       37896029
378961                                  TO TRUE                         37896129
378962             PERFORM DP013-0000-PROCESS-ABEND                     37896229
378963     END-EVALUATE.                                                37896329
378964                                                                  37896429
378965                                                                  37896529
378966*----------------------------------------------------------------*37896629
378967* CLOSE CURSOR                                                   *37896729
378968*----------------------------------------------------------------*37896829
378969 4020-CLOSE-CURSOR.                                               37896929
378970                                                                  37897029
378971     EVALUATE TRUE                                                37897129
378972         WHEN CE005-CNCL-PULL                                     37897229
378973              MOVE 'CLOSE:CNCL-PULL-CSR'                          37897329
378974                                TO CE005-RETURN-MSG               37897429
378975              EXEC SQL                                            37897529
378976                   CLOSE CNCL-PULL-CSR                            37897629
378977              END-EXEC                                            37897729
378978                                                                  37897829
378979         WHEN CE005-UNCNCL-PULL                                   37897929
378980              MOVE 'CLOSE:UNCNCL-PULL-CSR'                        37898029
378981                                TO CE005-RETURN-MSG               37898129
378982              EXEC SQL                                            37898229
378983                   CLOSE UNCNCL-PULL-CSR                          37898329
378984              END-EXEC                                            37898429
378985                                                                  37898529
378986         WHEN CE005-CNFM-DIST-PULL                                37898629
378987              MOVE 'CLOSE:CNFM-DIST-PULL-CSR'                     37898729
378988                                TO CE005-RETURN-MSG               37898829
378989              EXEC SQL                                            37898929
378990                   CLOSE CNFM-DIST-PULL-CSR                       37899029
378991              END-EXEC                                            37899129
378992                                                                  37899229
378993         WHEN CE005-UNCNFM-DIST-PULL                              37899329
378994              MOVE 'CLOSE:UNCNFM-DIST-PL-CSR'                     37899429
378995                                TO CE005-RETURN-MSG               37899529
378996              EXEC SQL                                            37899629
378997                   CLOSE UNCNFM-DIST-PL-CSR                       37899729
378998              END-EXEC                                            37899829
378999                                                                  37899929
379000*        WHEN CE005-CNFM-PULL                                     37900029
379001*        WHEN CE005-UNCNFM-PULL                                   37900129
379002                                                                  37900229
379003     END-EVALUATE.                                                37900329
379004                                                                  37900429
379005     EVALUATE TRUE                                                37900529
379006         WHEN SQLCODE = ZERO                                      37900629
379007              CONTINUE                                            37900729
379008         WHEN SQLWARN0 NOT = SPACES                               37900829
379009         WHEN SQLCODE < ZERO                                      37900929
379010         WHEN SQLCODE > ZERO                                      37901029
379011              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37901129
379012                                PV-DISPLAY-RET-CDE                37901229
379013              SET  CE005-FUNC-INVALID                             37901329
379014                   PS-ERROR            TO  TRUE                   37901429
379015              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37901529
379016                     ' 4020-CLOSE-CURSOR -' DELIMITED BY SIZE     37901629
379017                     CE005-RETURN-MSG       DELIMITED BY SIZE     37901729
379018                                            INTO PV-CICS-MSG-AREA 37901829
379019             MOVE LENGTH OF PV-CICS-MSG-AREA                      37901929
379020               TO PV-COMMAREA-LENGTH                              37902029
379021             EXEC CICS                                            37902129
379022                  WRITEQ TD                                       37902229
379023                   QUEUE  ('CSSL')                                37902329
379024                    FROM  (PV-CICS-MSG-AREA)                      37902429
379025                  LENGTH  (PV-COMMAREA-LENGTH)                    37902529
379026                    RESP  (PV-CICS-RESP)                          37902629
379027             END-EXEC                                             37902729
379028                                                                  37902829
379029             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37902929
379030             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37903029
379031             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37903129
379032              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37903229
379033                     ' 4020-CLOSE-CURSOR -' DELIMITED BY SIZE     37903329
379034                     ' PULL-'               DELIMITED BY SIZE     37903429
379035                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37903529
379036                     '  REF-'               DELIMITED BY SIZE     37903629
379037                     PV-DISPLAY-REF         DELIMITED BY SIZE     37903729
379038                     '  LINE-'              DELIMITED BY SIZE     37903829
379039                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37903929
379040                     '  SQLCODE = '         DELIMITED BY SIZE     37904029
379041                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37904129
379042                                            INTO PV-CICS-MSG-AREA 37904229
379043             MOVE LENGTH OF PV-CICS-MSG-AREA                      37904329
379044               TO PV-COMMAREA-LENGTH                              37904429
379045             EXEC CICS                                            37904529
379046                  WRITEQ TD                                       37904629
379047                   QUEUE  ('CSSL')                                37904729
379048                    FROM  (PV-CICS-MSG-AREA)                      37904829
379049                  LENGTH  (PV-COMMAREA-LENGTH)                    37904929
379050                    RESP  (PV-CICS-RESP)                          37905029
379051             END-EXEC                                             37905129
379052             MOVE '4020-CLOSE-CURSOR'                             37905229
379053                              TO DP013-PARAGRAPH                  37905329
379054             MOVE 'CLOSE CURSOR            '                      37905429
379055                              TO DP013-MESSAGE-TEXT (1)           37905529
379056             MOVE SQLCA       TO DP013-SQLCA                      37905629
379057             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37905729
379058             SET DP013-DB2-ABEND                                  37905829
379059                 DP013-XCTL-DISPLAY-RESTART                       37905929
379060                                  TO TRUE                         37906029
379061             PERFORM DP013-0000-PROCESS-ABEND                     37906129
379062     END-EVALUATE.                                                37906229
379063                                                                  37906329
379064                                                                  37906429
379065*----------------------------------------------------------------*37906529
379066* CLOSE DISTRIBUTION DETAIL CURSOR                               *37906629
379067*----------------------------------------------------------------*37906729
379068 4025-CLOSE-CURSOR.                                               37906829
379069                                                                  37906929
379070     EXEC SQL                                                     37907029
379071          CLOSE DIST-DETAIL-CSR                                   37907129
379072     END-EXEC.                                                    37907229
379073                                                                  37907329
379074     EVALUATE TRUE                                                37907429
379075         WHEN SQLCODE = ZERO                                      37907529
379076              CONTINUE                                            37907629
379077         WHEN SQLWARN0 NOT = SPACES                               37907729
379078         WHEN SQLCODE < ZERO                                      37907829
379079         WHEN SQLCODE > ZERO                                      37907929
379080              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37908029
379081                                PV-DISPLAY-RET-CDE                37908129
379082              SET  CE005-FUNC-INVALID                             37908229
379083                   PS-ERROR            TO  TRUE                   37908329
379084              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37908429
379085                     ' 4025-CLOSE-CURSOR -' DELIMITED BY SIZE     37908529
379086                     CE005-RETURN-MSG       DELIMITED BY SIZE     37908629
379087                                            INTO PV-CICS-MSG-AREA 37908729
379088             MOVE LENGTH OF PV-CICS-MSG-AREA                      37908829
379089               TO PV-COMMAREA-LENGTH                              37908929
379090             EXEC CICS                                            37909029
379091                  WRITEQ TD                                       37909129
379092                   QUEUE  ('CSSL')                                37909229
379093                    FROM  (PV-CICS-MSG-AREA)                      37909329
379094                  LENGTH  (PV-COMMAREA-LENGTH)                    37909429
379095                    RESP  (PV-CICS-RESP)                          37909529
379096             END-EXEC                                             37909629
379097                                                                  37909729
379098             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37909829
379099             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37909929
379100             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37910029
379101              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37910129
379102                     ' 4025-CLOSE-CURSOR -' DELIMITED BY SIZE     37910229
379103                     ' PULL-'               DELIMITED BY SIZE     37910329
379104                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37910429
379105                     '  REF-'               DELIMITED BY SIZE     37910529
379106                     PV-DISPLAY-REF         DELIMITED BY SIZE     37910629
379107                     '  LINE-'              DELIMITED BY SIZE     37910729
379108                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37910829
379109                     '  SQLCODE = '         DELIMITED BY SIZE     37910929
379110                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37911029
379111                                            INTO PV-CICS-MSG-AREA 37911129
379112             MOVE LENGTH OF PV-CICS-MSG-AREA                      37911229
379113               TO PV-COMMAREA-LENGTH                              37911329
379114             EXEC CICS                                            37911429
379115                  WRITEQ TD                                       37911529
379116                   QUEUE  ('CSSL')                                37911629
379117                    FROM  (PV-CICS-MSG-AREA)                      37911729
379118                  LENGTH  (PV-COMMAREA-LENGTH)                    37911829
379119                    RESP  (PV-CICS-RESP)                          37911929
379120             END-EXEC                                             37912029
379121             MOVE '4025-CLOSE-CURSOR'                             37912129
379122                              TO DP013-PARAGRAPH                  37912229
379123             MOVE 'CLOSE CURSOR            '                      37912329
379124                              TO DP013-MESSAGE-TEXT (1)           37912429
379125             MOVE SQLCA       TO DP013-SQLCA                      37912529
379126             MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (1)         37912629
379127             SET DP013-DB2-ABEND                                  37912729
379128                 DP013-XCTL-DISPLAY-RESTART                       37912829
379129                                  TO TRUE                         37912929
379130             PERFORM DP013-0000-PROCESS-ABEND                     37913029
379131     END-EVALUATE.                                                37913129
379132                                                                  37913229
379133                                                                  37913329
379134*----------------------------------------------------------------*37913429
379135* UPDATE STATUS CODE IN LINE ITEM TABLE                          *37913529
379136*----------------------------------------------------------------*37913629
379137 4100-UPDATE-TCEPLIT.                                             37913729
379138                                                                  37913829
379139     EXEC SQL                                                     37913929
379140          UPDATE TCEPLIT                                          37914029
379141             SET                                                  37914129
379142                 STAT_CDE          = :CEPLIT-STAT-CDE             37914229
379143           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              37914329
379144             AND PL_LNE_NBR        = :DK-LINE-NUMBER              37914429
379145     END-EXEC.                                                    37914529
379146                                                                  37914629
379147     EVALUATE TRUE                                                37914729
379148         WHEN SQLCODE = ZERO                                      37914829
379149              CONTINUE                                            37914929
379150                                                                  37915029
379151         WHEN SQLWARN0 NOT = SPACES                               37915129
379152         WHEN SQLCODE < ZERO                                      37915229
379153         WHEN SQLCODE > ZERO                                      37915329
379154              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37915429
379155                                PV-DISPLAY-RET-CDE                37915529
379156              SET  CE005-FUNC-INVALID                             37915629
379157                   PS-ERROR            TO  TRUE                   37915729
379158              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37915829
379159                     ' 4100-UPDATE-TCEPLIT ' DELIMITED BY SIZE    37915929
379160                     CE005-RETURN-MSG        DELIMITED BY SIZE    37916029
379161                                             INTO PV-CICS-MSG-AREA37916129
379162             MOVE LENGTH OF PV-CICS-MSG-AREA                      37916229
379163               TO PV-COMMAREA-LENGTH                              37916329
379164             EXEC CICS                                            37916429
379165                  WRITEQ TD                                       37916529
379166                   QUEUE  ('CSSL')                                37916629
379167                    FROM  (PV-CICS-MSG-AREA)                      37916729
379168                  LENGTH  (PV-COMMAREA-LENGTH)                    37916829
379169                    RESP  (PV-CICS-RESP)                          37916929
379170             END-EXEC                                             37917029
379171                                                                  37917129
379172             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37917229
379173             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37917329
379174             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37917429
379175              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37917529
379176                     ' PULL-'               DELIMITED BY SIZE     37917629
379177                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37917729
379178                     '  REF-'               DELIMITED BY SIZE     37917829
379179                     PV-DISPLAY-REF         DELIMITED BY SIZE     37917929
379180                     '  LINE-'              DELIMITED BY SIZE     37918029
379181                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37918129
379182                     '  SQLCODE = '         DELIMITED BY SIZE     37918229
379183                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37918329
379184                                            INTO PV-CICS-MSG-AREA 37918429
379185             MOVE LENGTH OF PV-CICS-MSG-AREA                      37918529
379186               TO PV-COMMAREA-LENGTH                              37918629
379187             EXEC CICS                                            37918729
379188                  WRITEQ TD                                       37918829
379189                   QUEUE  ('CSSL')                                37918929
379190                    FROM  (PV-CICS-MSG-AREA)                      37919029
379191                  LENGTH  (PV-COMMAREA-LENGTH)                    37919129
379192                    RESP  (PV-CICS-RESP)                          37919229
379193             END-EXEC                                             37919329
379194             MOVE '4100-UPDATE-TCEPLIT'                           37919429
379195                              TO DP013-PARAGRAPH                  37919529
379196             MOVE 'UPDATE PULL ITEM TABLE  '                      37919629
379197                              TO DP013-MESSAGE-TEXT (1)           37919729
379198             MOVE SQLCA       TO DP013-SQLCA                      37919829
379199             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37919929
379200             SET DP013-DB2-ABEND                                  37920029
379201                 DP013-XCTL-DISPLAY-RESTART                       37920129
379202                                  TO TRUE                         37920229
379203             PERFORM DP013-0000-PROCESS-ABEND                     37920329
379204     END-EVALUATE.                                                37920429
379205                                                                  37920529
379206                                                                  37920629
379207*----------------------------------------------------------------*37920729
379208* UPDATE STATUS CODE & ACTUAL PULL QUANTITY IN ITEM TABLE        *37920829
379209*----------------------------------------------------------------*37920929
379210 4105-UPDATE-TCEPLIT.                                             37921029
379211                                                                  37921129
379212     EXEC SQL                                                     37921229
379213          UPDATE TCEPLIT                                          37921329
379214             SET                                                  37921429
379215                 STAT_CDE          = :CEPLIT-STAT-CDE             37921529
379216                ,ACTL_PL_QTY       = :CEPLIT-ACTL-PL-QTY          37921629
379217           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              37921729
379218             AND PL_LNE_NBR        = :DK-LINE-NUMBER              37921829
379219     END-EXEC.                                                    37921929
379220                                                                  37922029
379221     EVALUATE TRUE                                                37922129
379222         WHEN SQLCODE = ZERO                                      37922229
379223              CONTINUE                                            37922329
379224                                                                  37922429
379225         WHEN SQLWARN0 NOT = SPACES                               37922529
379226         WHEN SQLCODE < ZERO                                      37922629
379227         WHEN SQLCODE > ZERO                                      37922729
379228              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37922829
379229                                PV-DISPLAY-RET-CDE                37922929
379230              SET  CE005-FUNC-INVALID                             37923029
379231                   PS-ERROR            TO  TRUE                   37923129
379232              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37923229
379233                     ' 4105-UPDATE-TCEPLIT ' DELIMITED BY SIZE    37923329
379234                     CE005-RETURN-MSG        DELIMITED BY SIZE    37923429
379235                                             INTO PV-CICS-MSG-AREA37923529
379236             MOVE LENGTH OF PV-CICS-MSG-AREA                      37923629
379237               TO PV-COMMAREA-LENGTH                              37923729
379238             EXEC CICS                                            37923829
379239                  WRITEQ TD                                       37923929
379240                   QUEUE  ('CSSL')                                37924029
379241                    FROM  (PV-CICS-MSG-AREA)                      37924129
379242                  LENGTH  (PV-COMMAREA-LENGTH)                    37924229
379243                    RESP  (PV-CICS-RESP)                          37924329
379244             END-EXEC                                             37924429
379245                                                                  37924529
379246             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37924629
379247             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37924729
379248             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37924829
379249              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37924929
379250                     ' PULL-'               DELIMITED BY SIZE     37925029
379251                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37925129
379252                     '  REF-'               DELIMITED BY SIZE     37925229
379253                     PV-DISPLAY-REF         DELIMITED BY SIZE     37925329
379254                     '  LINE-'              DELIMITED BY SIZE     37925429
379255                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37925529
379256                     '  SQLCODE = '         DELIMITED BY SIZE     37925629
379257                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37925729
379258                                            INTO PV-CICS-MSG-AREA 37925829
379259             MOVE LENGTH OF PV-CICS-MSG-AREA                      37925929
379260               TO PV-COMMAREA-LENGTH                              37926029
379261             EXEC CICS                                            37926129
379262                  WRITEQ TD                                       37926229
379263                   QUEUE  ('CSSL')                                37926329
379264                    FROM  (PV-CICS-MSG-AREA)                      37926429
379265                  LENGTH  (PV-COMMAREA-LENGTH)                    37926529
379266                    RESP  (PV-CICS-RESP)                          37926629
379267             END-EXEC                                             37926729
379268             MOVE '4105-UPDATE-TCEPLIT'                           37926829
379269                              TO DP013-PARAGRAPH                  37926929
379270             MOVE 'UPDATE PULL ITEM TABLE  '                      37927029
379271                              TO DP013-MESSAGE-TEXT (1)           37927129
379272             MOVE SQLCA       TO DP013-SQLCA                      37927229
379273             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37927329
379274             SET DP013-DB2-ABEND                                  37927429
379275                 DP013-XCTL-DISPLAY-RESTART                       37927529
379276                                  TO TRUE                         37927629
379277             PERFORM DP013-0000-PROCESS-ABEND                     37927729
379278     END-EVALUATE.                                                37927829
379279                                                                  37927929
379280                                                                  37928029
379281*----------------------------------------------------------------*37928129
379282* UPDATE STATUS CODE & ACTUAL PULL QUANTITY IN ITEM TABLE        *37928229
379283*----------------------------------------------------------------*37928329
379284 4106-UPDATE-TCEPLIT-NULL.                                        37928429
379285                                                                  37928529
379286     EXEC SQL                                                     37928629
379287          UPDATE TCEPLIT                                          37928729
379288             SET                                                  37928829
379289                 STAT_CDE          = :CEPLIT-STAT-CDE             37928929
379290                ,ACTL_PL_QTY       = NULL                         37929029
379291           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              37929129
379292             AND PL_LNE_NBR        = :DK-LINE-NUMBER              37929229
379293     END-EXEC.                                                    37929329
379294                                                                  37929429
379295     EVALUATE TRUE                                                37929529
379296         WHEN SQLCODE = ZERO                                      37929629
379297              CONTINUE                                            37929729
379298                                                                  37929829
379299         WHEN SQLWARN0 NOT = SPACES                               37929929
379300         WHEN SQLCODE < ZERO                                      37930029
379301         WHEN SQLCODE > ZERO                                      37930129
379302              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37930229
379303                                PV-DISPLAY-RET-CDE                37930329
379304              SET  CE005-FUNC-INVALID                             37930429
379305                   PS-ERROR            TO  TRUE                   37930529
379306              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37930629
379307                     ' 4106-UPDATE-TCEPLIT ' DELIMITED BY SIZE    37930729
379308                     CE005-RETURN-MSG        DELIMITED BY SIZE    37930829
379309                                             INTO PV-CICS-MSG-AREA37930929
379310             MOVE LENGTH OF PV-CICS-MSG-AREA                      37931029
379311               TO PV-COMMAREA-LENGTH                              37931129
379312             EXEC CICS                                            37931229
379313                  WRITEQ TD                                       37931329
379314                   QUEUE  ('CSSL')                                37931429
379315                    FROM  (PV-CICS-MSG-AREA)                      37931529
379316                  LENGTH  (PV-COMMAREA-LENGTH)                    37931629
379317                    RESP  (PV-CICS-RESP)                          37931729
379318             END-EXEC                                             37931829
379319                                                                  37931929
379320             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37932029
379321             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37932129
379322             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37932229
379323              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37932329
379324                     ' PULL-'               DELIMITED BY SIZE     37932429
379325                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37932529
379326                     '  REF-'               DELIMITED BY SIZE     37932629
379327                     PV-DISPLAY-REF         DELIMITED BY SIZE     37932729
379328                     '  LINE-'              DELIMITED BY SIZE     37932829
379329                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37932929
379330                     '  SQLCODE = '         DELIMITED BY SIZE     37933029
379331                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37933129
379332                                            INTO PV-CICS-MSG-AREA 37933229
379333             MOVE LENGTH OF PV-CICS-MSG-AREA                      37933329
379334               TO PV-COMMAREA-LENGTH                              37933429
379335             EXEC CICS                                            37933529
379336                  WRITEQ TD                                       37933629
379337                   QUEUE  ('CSSL')                                37933729
379338                    FROM  (PV-CICS-MSG-AREA)                      37933829
379339                  LENGTH  (PV-COMMAREA-LENGTH)                    37933929
379340                    RESP  (PV-CICS-RESP)                          37934029
379341             END-EXEC                                             37934129
379342             MOVE '4106-UPDATE-TCEPLIT'                           37934229
379343                              TO DP013-PARAGRAPH                  37934329
379344             MOVE 'UPDATE PULL ITEM TABLE  '                      37934429
379345                              TO DP013-MESSAGE-TEXT (1)           37934529
379346             MOVE SQLCA       TO DP013-SQLCA                      37934629
379347             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37934729
379348             SET DP013-DB2-ABEND                                  37934829
379349                 DP013-XCTL-DISPLAY-RESTART                       37934929
379350                                  TO TRUE                         37935029
379351             PERFORM DP013-0000-PROCESS-ABEND                     37935129
379352     END-EVALUATE.                                                37935229
379353                                                                  37935329
379354                                                                  37935429
379355*----------------------------------------------------------------*37935529
379356* INSERT ROW INTO STATUS TABLE                                   *37935629
379357*----------------------------------------------------------------*37935729
379358 4110-INSERT-TCEPLST.                                             37935829
379359                                                                  37935929
379360     EXEC SQL                                                     37936029
379361          INSERT                                                  37936129
379362          INTO  TCEPLST                                           37936229
379363               (CNSTK_REQ_PL_NBR                                  37936329
379364               ,PL_LNE_NBR                                        37936429
379365               ,CRE_TMST                                          37936529
379366               ,STAT_CDE                                          37936629
379367               ,CRE_BY_USR_ID)                                    37936729
379368        VALUES                                                    37936829
379369              (:DK-PULL-NUMBER                                    37936929
379370              ,:DK-LINE-NUMBER                                    37937029
379371              , CURRENT TIMESTAMP                                 37937129
379372              ,:CEPLST-STAT-CDE                                   37937229
379373              ,:CE005-USER-ID)                                    37937329
379374     END-EXEC.                                                    37937429
379375                                                                  37937529
379376     EVALUATE TRUE                                                37937629
379377         WHEN SQLCODE = ZERO                                      37937729
379378              CONTINUE                                            37937829
379379                                                                  37937929
379380         WHEN SQLWARN0 NOT = SPACES                               37938029
379381         WHEN SQLCODE < ZERO                                      37938129
379382         WHEN SQLCODE > ZERO                                      37938229
379383              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37938329
379384                                PV-DISPLAY-RET-CDE                37938429
379385              SET  CE005-FUNC-INVALID                             37938529
379386                   PS-ERROR            TO  TRUE                   37938629
379387              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37938729
379388                     ' 4110-INSERT-TCEPLST ' DELIMITED BY SIZE    37938829
379389                     CE005-RETURN-MSG        DELIMITED BY SIZE    37938929
379390                                             INTO PV-CICS-MSG-AREA37939029
379391             MOVE LENGTH OF PV-CICS-MSG-AREA                      37939129
379392               TO PV-COMMAREA-LENGTH                              37939229
379393             EXEC CICS                                            37939329
379394                  WRITEQ TD                                       37939429
379395                   QUEUE  ('CSSL')                                37939529
379396                    FROM  (PV-CICS-MSG-AREA)                      37939629
379397                  LENGTH  (PV-COMMAREA-LENGTH)                    37939729
379398                    RESP  (PV-CICS-RESP)                          37939829
379399             END-EXEC                                             37939929
379400                                                                  37940029
379401             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37940129
379402             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37940229
379403             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37940329
379404              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37940429
379405                     ' PULL-'               DELIMITED BY SIZE     37940529
379406                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37940629
379407                     '  REF-'               DELIMITED BY SIZE     37940729
379408                     PV-DISPLAY-REF         DELIMITED BY SIZE     37940829
379409                     '  LINE-'              DELIMITED BY SIZE     37940929
379410                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37941029
379411                     '  SQLCODE = '         DELIMITED BY SIZE     37941129
379412                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37941229
379413                                            INTO PV-CICS-MSG-AREA 37941329
379414             MOVE LENGTH OF PV-CICS-MSG-AREA                      37941429
379415               TO PV-COMMAREA-LENGTH                              37941529
379416             EXEC CICS                                            37941629
379417                  WRITEQ TD                                       37941729
379418                   QUEUE  ('CSSL')                                37941829
379419                    FROM  (PV-CICS-MSG-AREA)                      37941929
379420                  LENGTH  (PV-COMMAREA-LENGTH)                    37942029
379421                    RESP  (PV-CICS-RESP)                          37942129
379422             END-EXEC                                             37942229
379423             MOVE '4110-INSERT-TCEPLST'                           37942329
379424                              TO DP013-PARAGRAPH                  37942429
379425             MOVE 'INSERT PULL STATUS TABLE'                      37942529
379426                              TO DP013-MESSAGE-TEXT (1)           37942629
379427             MOVE SQLCA       TO DP013-SQLCA                      37942729
379428             MOVE 'TCEPLST '  TO DP013-DB2-TABLE-NAME (1)         37942829
379429             SET DP013-DB2-ABEND                                  37942929
379430                 DP013-XCTL-DISPLAY-RESTART                       37943029
379431                                  TO TRUE                         37943129
379432             PERFORM DP013-0000-PROCESS-ABEND                     37943229
379433     END-EVALUATE.                                                37943329
379434                                                                  37943429
379435                                                                  37943529
379436*----------------------------------------------------------------*37943629
379437* UPDATE STATUS CODE IN PULL REQUEST TABLE                       *37943729
379438*----------------------------------------------------------------*37943829
379439 4130-UPDATE-TCEPLRQ.                                             37943929
379440                                                                  37944029
379441     EXEC SQL                                                     37944129
379442          UPDATE TCEPLRQ                                          37944229
379443             SET                                                  37944329
379444                 STAT_CDE          = :CEPLRQ-STAT-CDE             37944429
379445           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              37944529
379446     END-EXEC.                                                    37944629
379447                                                                  37944729
379448     EVALUATE TRUE                                                37944829
379449         WHEN SQLCODE = ZERO                                      37944929
379450              CONTINUE                                            37945029
379451                                                                  37945129
379452         WHEN SQLWARN0 NOT = SPACES                               37945229
379453         WHEN SQLCODE < ZERO                                      37945329
379454         WHEN SQLCODE > ZERO                                      37945429
379455              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37945529
379456                                PV-DISPLAY-RET-CDE                37945629
379457              SET  CE005-FUNC-INVALID                             37945729
379458                   PS-ERROR            TO  TRUE                   37945829
379459              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37945929
379460                     ' 4103-UPDATE-TCEPLRQ ' DELIMITED BY SIZE    37946029
379461                     CE005-RETURN-MSG        DELIMITED BY SIZE    37946129
379462                                             INTO PV-CICS-MSG-AREA37946229
379463             MOVE LENGTH OF PV-CICS-MSG-AREA                      37946329
379464               TO PV-COMMAREA-LENGTH                              37946429
379465             EXEC CICS                                            37946529
379466                  WRITEQ TD                                       37946629
379467                   QUEUE  ('CSSL')                                37946729
379468                    FROM  (PV-CICS-MSG-AREA)                      37946829
379469                  LENGTH  (PV-COMMAREA-LENGTH)                    37946929
379470                    RESP  (PV-CICS-RESP)                          37947029
379471             END-EXEC                                             37947129
379472                                                                  37947229
379473             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37947329
379474             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37947429
379475             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37947529
379476              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37947629
379477                     ' PULL-'               DELIMITED BY SIZE     37947729
379478                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37947829
379479                     '  REF-'               DELIMITED BY SIZE     37947929
379480                     PV-DISPLAY-REF         DELIMITED BY SIZE     37948029
379481                     '  LINE-'              DELIMITED BY SIZE     37948129
379482                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37948229
379483                     '  SQLCODE = '         DELIMITED BY SIZE     37948329
379484                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37948429
379485                                            INTO PV-CICS-MSG-AREA 37948529
379486             MOVE LENGTH OF PV-CICS-MSG-AREA                      37948629
379487               TO PV-COMMAREA-LENGTH                              37948729
379488             EXEC CICS                                            37948829
379489                  WRITEQ TD                                       37948929
379490                   QUEUE  ('CSSL')                                37949029
379491                    FROM  (PV-CICS-MSG-AREA)                      37949129
379492                  LENGTH  (PV-COMMAREA-LENGTH)                    37949229
379493                    RESP  (PV-CICS-RESP)                          37949329
379494             END-EXEC                                             37949429
379495             MOVE '4130-UPDATE-TCEPLRQ'                           37949529
379496                              TO DP013-PARAGRAPH                  37949629
379497             MOVE 'UPDATE PULL REQUEST TABLE'                     37949729
379498                              TO DP013-MESSAGE-TEXT (1)           37949829
379499             MOVE SQLCA       TO DP013-SQLCA                      37949929
379500             MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)         37950029
379501             SET DP013-DB2-ABEND                                  37950129
379502                 DP013-XCTL-DISPLAY-RESTART                       37950229
379503                                  TO TRUE                         37950329
379504             PERFORM DP013-0000-PROCESS-ABEND                     37950429
379505     END-EVALUATE.                                                37950529
379506                                                                  37950629
379507                                                                  37950729
379508*----------------------------------------------------------------*37950829
379509* UPDATE DISTRIBUTION DETAIL TABLE                               *37950929
379510*----------------------------------------------------------------*37951029
379511 4135-UPDATE-TCEPLDS.                                             37951129
379512                                                                  37951229
379513     EXEC SQL                                                     37951329
379514          UPDATE TCEPLDS                                          37951429
379515             SET ACTL_DISTRB_QTY   = :CEPLDS-ACTL-DISTRB-QTY      37951529
379516           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              37951629
379517             AND PL_LNE_NBR        = :DK-LINE-NUMBER              37951729
379518             AND STR_NBR           = :CEPLDS-STR-NBR              37951829
379519     END-EXEC.                                                    37951929
379520                                                                  37952029
379521     EVALUATE TRUE                                                37952129
379522         WHEN SQLCODE = ZERO                                      37952229
379523              CONTINUE                                            37952329
379524                                                                  37952429
379525         WHEN SQLWARN0 NOT = SPACES                               37952529
379526         WHEN SQLCODE < ZERO                                      37952629
379527         WHEN SQLCODE > ZERO                                      37952729
379528              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37952829
379529                                PV-DISPLAY-RET-CDE                37952929
379530              SET  CE005-FUNC-INVALID                             37953029
379531                   PS-ERROR            TO  TRUE                   37953129
379532              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37953229
379533                     ' 4135-UPDATE-TCEPLDS ' DELIMITED BY SIZE    37953329
379534                     CE005-RETURN-MSG        DELIMITED BY SIZE    37953429
379535                                             INTO PV-CICS-MSG-AREA37953529
379536             MOVE LENGTH OF PV-CICS-MSG-AREA                      37953629
379537               TO PV-COMMAREA-LENGTH                              37953729
379538             EXEC CICS                                            37953829
379539                  WRITEQ TD                                       37953929
379540                   QUEUE  ('CSSL')                                37954029
379541                    FROM  (PV-CICS-MSG-AREA)                      37954129
379542                  LENGTH  (PV-COMMAREA-LENGTH)                    37954229
379543                    RESP  (PV-CICS-RESP)                          37954329
379544             END-EXEC                                             37954429
379545                                                                  37954529
379546             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37954629
379547             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37954729
379548             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37954829
379549              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37954929
379550                     ' PULL-'               DELIMITED BY SIZE     37955029
379551                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37955129
379552                     '  REF-'               DELIMITED BY SIZE     37955229
379553                     PV-DISPLAY-REF         DELIMITED BY SIZE     37955329
379554                     '  LINE-'              DELIMITED BY SIZE     37955429
379555                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37955529
379556                     '  SQLCODE = '         DELIMITED BY SIZE     37955629
379557                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37955729
379558                                            INTO PV-CICS-MSG-AREA 37955829
379559             MOVE LENGTH OF PV-CICS-MSG-AREA                      37955929
379560               TO PV-COMMAREA-LENGTH                              37956029
379561             EXEC CICS                                            37956129
379562                  WRITEQ TD                                       37956229
379563                   QUEUE  ('CSSL')                                37956329
379564                    FROM  (PV-CICS-MSG-AREA)                      37956429
379565                  LENGTH  (PV-COMMAREA-LENGTH)                    37956529
379566                    RESP  (PV-CICS-RESP)                          37956629
379567             END-EXEC                                             37956729
379568             MOVE '4135-UPDATE-TCEPLDS'                           37956829
379569                              TO DP013-PARAGRAPH                  37956929
379570             MOVE 'UPDATE DISTRIBUTION DETAIL TABLE'              37957029
379571                              TO DP013-MESSAGE-TEXT (1)           37957129
379572             MOVE SQLCA       TO DP013-SQLCA                      37957229
379573             MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (1)         37957329
379574             SET DP013-DB2-ABEND                                  37957429
379575                 DP013-XCTL-DISPLAY-RESTART                       37957529
379576                                  TO TRUE                         37957629
379577             PERFORM DP013-0000-PROCESS-ABEND                     37957729
379578     END-EVALUATE.                                                37957829
379579                                                                  37957929
379580                                                                  37958029
379581*----------------------------------------------------------------*37958129
379582* UPDATE DISTRIBUTION DETAIL TABLE - NULL                        *37958229
379583*----------------------------------------------------------------*37958329
379584 4136-UPDATE-TCEPLDS-NULL.                                        37958429
379585                                                                  37958529
379586     EXEC SQL                                                     37958629
379587          UPDATE TCEPLDS                                          37958729
379588             SET ACTL_DISTRB_QTY   = NULL                         37958829
379589           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              37958929
379590             AND PL_LNE_NBR        = :DK-LINE-NUMBER              37959029
379591             AND STR_NBR           = :CEPLDS-STR-NBR              37959129
379592     END-EXEC.                                                    37959229
379593                                                                  37959329
379594     EVALUATE TRUE                                                37959429
379595         WHEN SQLCODE = ZERO                                      37959529
379596              CONTINUE                                            37959629
379597                                                                  37959729
379598         WHEN SQLWARN0 NOT = SPACES                               37959829
379599         WHEN SQLCODE < ZERO                                      37959929
379600         WHEN SQLCODE > ZERO                                      37960029
379601              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37960129
379602                                PV-DISPLAY-RET-CDE                37960229
379603              SET  CE005-FUNC-INVALID                             37960329
379604                   PS-ERROR            TO  TRUE                   37960429
379605              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37960529
379606                     ' 4136-UPDATE-TCEPLDS ' DELIMITED BY SIZE    37960629
379607                     CE005-RETURN-MSG        DELIMITED BY SIZE    37960729
379608                                             INTO PV-CICS-MSG-AREA37960829
379609             MOVE LENGTH OF PV-CICS-MSG-AREA                      37960929
379610               TO PV-COMMAREA-LENGTH                              37961029
379611             EXEC CICS                                            37961129
379612                  WRITEQ TD                                       37961229
379613                   QUEUE  ('CSSL')                                37961329
379614                    FROM  (PV-CICS-MSG-AREA)                      37961429
379615                  LENGTH  (PV-COMMAREA-LENGTH)                    37961529
379616                    RESP  (PV-CICS-RESP)                          37961629
379617             END-EXEC                                             37961729
379618                                                                  37961829
379619             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37961929
379620             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37962029
379621             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37962129
379622              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37962229
379623                     ' PULL-'               DELIMITED BY SIZE     37962329
379624                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37962429
379625                     '  REF-'               DELIMITED BY SIZE     37962529
379626                     PV-DISPLAY-REF         DELIMITED BY SIZE     37962629
379627                     '  LINE-'              DELIMITED BY SIZE     37962729
379628                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37962829
379629                     '  SQLCODE = '         DELIMITED BY SIZE     37962929
379630                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37963029
379631                                            INTO PV-CICS-MSG-AREA 37963129
379632             MOVE LENGTH OF PV-CICS-MSG-AREA                      37963229
379633               TO PV-COMMAREA-LENGTH                              37963329
379634             EXEC CICS                                            37963429
379635                  WRITEQ TD                                       37963529
379636                   QUEUE  ('CSSL')                                37963629
379637                    FROM  (PV-CICS-MSG-AREA)                      37963729
379638                  LENGTH  (PV-COMMAREA-LENGTH)                    37963829
379639                    RESP  (PV-CICS-RESP)                          37963929
379640             END-EXEC                                             37964029
379641             MOVE '4136-UPDATE-TCEPLDS-NULL'                      37964129
379642                              TO DP013-PARAGRAPH                  37964229
379643             MOVE 'UPDATE DISTRIBUTION DETAIL TABLE'              37964329
379644                              TO DP013-MESSAGE-TEXT (1)           37964429
379645             MOVE SQLCA       TO DP013-SQLCA                      37964529
379646             MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (1)         37964629
379647             SET DP013-DB2-ABEND                                  37964729
379648                 DP013-XCTL-DISPLAY-RESTART                       37964829
379649                                  TO TRUE                         37964929
379650             PERFORM DP013-0000-PROCESS-ABEND                     37965029
379651     END-EVALUATE.                                                37965129
379652                                                                  37965229
379653                                                                  37965329
379654*----------------------------------------------------------------*37965429
379655* SELECT ACTUAL PULL QUANTITY FROM LINE ITEM TABLE (TCEPLIT)     *37965529
379656*----------------------------------------------------------------*37965629
379657 4140-SELECT-TCEPLIT.                                             37965729
379658                                                                  37965829
379659     EXEC SQL                                                     37965929
379660          SELECT ITM_NBR                                          37966029
379661               , PL_REQ_QTY                                       37966129
379662               , ACTL_PL_QTY                                      37966229
379663          INTO   :CEPLIT-ITM-NBR                                  37966329
379664               , :CEPLIT-PL-REQ-QTY                               37966429
379665               , :CEPLIT-ACTL-PL-QTY :PV-NULL-IND-1               37966529
379666            FROM TCEPLIT                                          37966629
379667           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              37966729
379668             AND PL_LNE_NBR        = :DK-LINE-NUMBER              37966829
379669     END-EXEC.                                                    37966929
379670                                                                  37967029
379671     EVALUATE TRUE                                                37967129
379672         WHEN SQLCODE = ZERO                                      37967229
379673              CONTINUE                                            37967329
379674                                                                  37967429
379675         WHEN SQLWARN0 NOT = SPACES                               37967529
379676         WHEN SQLCODE < ZERO                                      37967629
379677         WHEN SQLCODE > ZERO                                      37967729
379678              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37967829
379679                                PV-DISPLAY-RET-CDE                37967929
379680              SET  CE005-FUNC-INVALID                             37968029
379681                   PS-ERROR            TO  TRUE                   37968129
379682              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37968229
379683                     ' 4140-SELECT-TCEPLIT ' DELIMITED BY SIZE    37968329
379684                     CE005-RETURN-MSG        DELIMITED BY SIZE    37968429
379685                                             INTO PV-CICS-MSG-AREA37968529
379686             MOVE LENGTH OF PV-CICS-MSG-AREA                      37968629
379687               TO PV-COMMAREA-LENGTH                              37968729
379688             EXEC CICS                                            37968829
379689                  WRITEQ TD                                       37968929
379690                   QUEUE  ('CSSL')                                37969029
379691                    FROM  (PV-CICS-MSG-AREA)                      37969129
379692                  LENGTH  (PV-COMMAREA-LENGTH)                    37969229
379693                    RESP  (PV-CICS-RESP)                          37969329
379694             END-EXEC                                             37969429
379695                                                                  37969529
379696             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37969629
379697             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37969729
379698             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37969829
379699              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37969929
379700                     ' PULL-'               DELIMITED BY SIZE     37970029
379701                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37970129
379702                     '  REF-'               DELIMITED BY SIZE     37970229
379703                     PV-DISPLAY-REF         DELIMITED BY SIZE     37970329
379704                     '  LINE-'              DELIMITED BY SIZE     37970429
379705                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37970529
379706                     '  SQLCODE = '         DELIMITED BY SIZE     37970629
379707                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37970729
379708                                            INTO PV-CICS-MSG-AREA 37970829
379709             MOVE LENGTH OF PV-CICS-MSG-AREA                      37970929
379710               TO PV-COMMAREA-LENGTH                              37971029
379711             EXEC CICS                                            37971129
379712                  WRITEQ TD                                       37971229
379713                   QUEUE  ('CSSL')                                37971329
379714                    FROM  (PV-CICS-MSG-AREA)                      37971429
379715                  LENGTH  (PV-COMMAREA-LENGTH)                    37971529
379716                    RESP  (PV-CICS-RESP)                          37971629
379717             END-EXEC                                             37971729
379718             MOVE '4140-SELECT-TCEPLIT'                           37971829
379719                              TO DP013-PARAGRAPH                  37971929
379720             MOVE 'SELECT PULL ITEM TABLE  '                      37972029
379721                              TO DP013-MESSAGE-TEXT (1)           37972129
379722             MOVE SQLCA       TO DP013-SQLCA                      37972229
379723             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37972329
379724             SET DP013-DB2-ABEND                                  37972429
379725                 DP013-XCTL-DISPLAY-RESTART                       37972529
379726                                  TO TRUE                         37972629
379727             PERFORM DP013-0000-PROCESS-ABEND                     37972729
379728     END-EVALUATE.                                                37972829
379729                                                                  37972929
379730                                                                  37973029
379731                                                                  37973129
379732*----------------------------------------------------------------*37973229
379733* COUNT THE TOTAL NUMBER OF LINES FOR PULL                       *37973329
379734*----------------------------------------------------------------*37973429
379735 4200-CNT-LINE-ITEMS.                                             37973529
379736                                                                  37973629
379737     EXEC SQL                                                     37973729
379738         SELECT COUNT(*)                                          37973829
379739           INTO :PV-LNE-NBR-COUNT                                 37973929
379740           FROM TCEPLIT                                           37974029
379741          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              37974129
379742     END-EXEC.                                                    37974229
379743                                                                  37974329
379744     EVALUATE TRUE                                                37974429
379745         WHEN SQLCODE = ZERO                                      37974529
379746              CONTINUE                                            37974629
379747                                                                  37974729
379748         WHEN SQLWARN0 NOT = SPACES                               37974829
379749         WHEN SQLCODE < ZERO                                      37974929
379750         WHEN SQLCODE > ZERO                                      37975029
379751              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37975129
379752                                PV-DISPLAY-RET-CDE                37975229
379753              SET  CE005-FUNC-INVALID                             37975329
379754                   PS-ERROR            TO  TRUE                   37975429
379755              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37975529
379756                     ' 4200-CNT-LINE-ITEMS ' DELIMITED BY SIZE    37975629
379757                     CE005-RETURN-MSG        DELIMITED BY SIZE    37975729
379758                                             INTO PV-CICS-MSG-AREA37975829
379759             MOVE LENGTH OF PV-CICS-MSG-AREA                      37975929
379760               TO PV-COMMAREA-LENGTH                              37976029
379761             EXEC CICS                                            37976129
379762                  WRITEQ TD                                       37976229
379763                   QUEUE  ('CSSL')                                37976329
379764                    FROM  (PV-CICS-MSG-AREA)                      37976429
379765                  LENGTH  (PV-COMMAREA-LENGTH)                    37976529
379766                    RESP  (PV-CICS-RESP)                          37976629
379767             END-EXEC                                             37976729
379768                                                                  37976829
379769             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37976929
379770             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37977029
379771             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37977129
379772              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37977229
379773                     ' PULL-'               DELIMITED BY SIZE     37977329
379774                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37977429
379775                     '  REF-'               DELIMITED BY SIZE     37977529
379776                     PV-DISPLAY-REF         DELIMITED BY SIZE     37977629
379777                     '  LINE-'              DELIMITED BY SIZE     37977729
379778                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37977829
379779                     '  SQLCODE = '         DELIMITED BY SIZE     37977929
379780                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37978029
379781                                            INTO PV-CICS-MSG-AREA 37978129
379782             MOVE LENGTH OF PV-CICS-MSG-AREA                      37978229
379783               TO PV-COMMAREA-LENGTH                              37978329
379784             EXEC CICS                                            37978429
379785                  WRITEQ TD                                       37978529
379786                   QUEUE  ('CSSL')                                37978629
379787                    FROM  (PV-CICS-MSG-AREA)                      37978729
379788                  LENGTH  (PV-COMMAREA-LENGTH)                    37978829
379789                    RESP  (PV-CICS-RESP)                          37978929
379790             END-EXEC                                             37979029
379791             MOVE '4200-CNT-LINE-ITEMS'                           37979129
379792                              TO DP013-PARAGRAPH                  37979229
379793             MOVE 'COUNTING NBR LINS FOR PULL'                    37979329
379794                              TO DP013-MESSAGE-TEXT (1)           37979429
379795             MOVE SQLCA       TO DP013-SQLCA                      37979529
379796             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37979629
379797             SET DP013-DB2-ABEND                                  37979729
379798                 DP013-XCTL-DISPLAY-RESTART                       37979829
379799                                  TO TRUE                         37979929
379800             PERFORM DP013-0000-PROCESS-ABEND                     37980029
379801     END-EVALUATE.                                                37980129
379802                                                                  37980229
379803                                                                  37980329
379804*----------------------------------------------------------------*37980429
379805* COUNT THE NUMBER OF CANCELLED LINES FOR A PULL                 *37980529
379806*----------------------------------------------------------------*37980629
379807 4210-CNT-CNCL-LINE-ITEMS.                                        37980729
379808                                                                  37980829
379809     EXEC SQL                                                     37980929
379810         SELECT COUNT(*)                                          37981029
379811           INTO :PV-LNE-CNCL-COUNT                                37981129
379812           FROM TCEPLIT                                           37981229
379813          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              37981329
379814            AND STAT_CDE          =  'CA'                         37981429
379815     END-EXEC.                                                    37981529
379816                                                                  37981629
379817     EVALUATE TRUE                                                37981729
379818         WHEN SQLCODE = ZERO                                      37981829
379819              CONTINUE                                            37981929
379820                                                                  37982029
379821         WHEN SQLWARN0 NOT = SPACES                               37982129
379822         WHEN SQLCODE < ZERO                                      37982229
379823         WHEN SQLCODE > ZERO                                      37982329
379824              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37982429
379825                                PV-DISPLAY-RET-CDE                37982529
379826              SET  CE005-FUNC-INVALID                             37982629
379827                   PS-ERROR            TO  TRUE                   37982729
379828              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37982829
379829                     ' 4210-CNT-CNCL-LINE-ITEMS '                 37982929
379830                                             DELIMITED BY SIZE    37983029
379831                     CE005-RETURN-MSG        DELIMITED BY SIZE    37983129
379832                                             INTO PV-CICS-MSG-AREA37983229
379833             MOVE LENGTH OF PV-CICS-MSG-AREA                      37983329
379834               TO PV-COMMAREA-LENGTH                              37983429
379835             EXEC CICS                                            37983529
379836                  WRITEQ TD                                       37983629
379837                   QUEUE  ('CSSL')                                37983729
379838                    FROM  (PV-CICS-MSG-AREA)                      37983829
379839                  LENGTH  (PV-COMMAREA-LENGTH)                    37983929
379840                    RESP  (PV-CICS-RESP)                          37984029
379841             END-EXEC                                             37984129
379842                                                                  37984229
379843             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37984329
379844             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37984429
379845             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37984529
379846              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37984629
379847                     ' PULL-'               DELIMITED BY SIZE     37984729
379848                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37984829
379849                     '  REF-'               DELIMITED BY SIZE     37984929
379850                     PV-DISPLAY-REF         DELIMITED BY SIZE     37985029
379851                     '  LINE-'              DELIMITED BY SIZE     37985129
379852                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37985229
379853                     '  SQLCODE = '         DELIMITED BY SIZE     37985329
379854                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37985429
379855                                            INTO PV-CICS-MSG-AREA 37985529
379856             MOVE LENGTH OF PV-CICS-MSG-AREA                      37985629
379857               TO PV-COMMAREA-LENGTH                              37985729
379858             EXEC CICS                                            37985829
379859                  WRITEQ TD                                       37985929
379860                   QUEUE  ('CSSL')                                37986029
379861                    FROM  (PV-CICS-MSG-AREA)                      37986129
379862                  LENGTH  (PV-COMMAREA-LENGTH)                    37986229
379863                    RESP  (PV-CICS-RESP)                          37986329
379864             END-EXEC                                             37986429
379865             MOVE '4210-CNT-CNCL-LINE-ITEMS'                      37986529
379866                              TO DP013-PARAGRAPH                  37986629
379867             MOVE 'COUNT NBR CANCELLED LINES FOR PULL'            37986729
379868                              TO DP013-MESSAGE-TEXT (1)           37986829
379869             MOVE SQLCA       TO DP013-SQLCA                      37986929
379870             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         37987029
379871             SET DP013-DB2-ABEND                                  37987129
379872                 DP013-XCTL-DISPLAY-RESTART                       37987229
379873                                  TO TRUE                         37987329
379874             PERFORM DP013-0000-PROCESS-ABEND                     37987429
379875     END-EVALUATE.                                                37987529
379876                                                                  37987629
379877                                                                  37987729
379878*----------------------------------------------------------------*37987829
379879*  CHECK CURRENT PULL STATUS                                     *37987929
379880*----------------------------------------------------------------*37988029
379881 4220-CHECK-PULL-STATUS.                                          37988129
379882                                                                  37988229
379883     EXEC SQL                                                     37988329
379884         SELECT STAT_CDE                                          37988429
379885           INTO :CEPLRQ-STAT-CDE                                  37988529
379886           FROM TCEPLRQ                                           37988629
379887          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              37988729
379888     END-EXEC.                                                    37988829
379889                                                                  37988929
379890     EVALUATE TRUE                                                37989029
379891         WHEN SQLCODE = ZERO                                      37989129
379892              CONTINUE                                            37989229
379893                                                                  37989329
379894         WHEN SQLWARN0 NOT = SPACES                               37989429
379895         WHEN SQLCODE < ZERO                                      37989529
379896         WHEN SQLCODE > ZERO                                      37989629
379897              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37989729
379898                                PV-DISPLAY-RET-CDE                37989829
379899              SET  CE005-FUNC-INVALID                             37989929
379900                   PS-ERROR            TO  TRUE                   37990029
379901              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37990129
379902                     ' 4220-CHECK-PULL-STATUS   '                 37990229
379903                                             DELIMITED BY SIZE    37990329
379904                     CE005-RETURN-MSG        DELIMITED BY SIZE    37990429
379905                                             INTO PV-CICS-MSG-AREA37990529
379906             MOVE LENGTH OF PV-CICS-MSG-AREA                      37990629
379907               TO PV-COMMAREA-LENGTH                              37990729
379908             EXEC CICS                                            37990829
379909                  WRITEQ TD                                       37990929
379910                   QUEUE  ('CSSL')                                37991029
379911                    FROM  (PV-CICS-MSG-AREA)                      37991129
379912                  LENGTH  (PV-COMMAREA-LENGTH)                    37991229
379913                    RESP  (PV-CICS-RESP)                          37991329
379914             END-EXEC                                             37991429
379915                                                                  37991529
379916             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37991629
379917             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37991729
379918             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37991829
379919              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37991929
379920                     ' PULL-'               DELIMITED BY SIZE     37992029
379921                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37992129
379922                     '  REF-'               DELIMITED BY SIZE     37992229
379923                     PV-DISPLAY-REF         DELIMITED BY SIZE     37992329
379924                     '  LINE-'              DELIMITED BY SIZE     37992429
379925                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37992529
379926                     '  SQLCODE = '         DELIMITED BY SIZE     37992629
379927                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     37992729
379928                                            INTO PV-CICS-MSG-AREA 37992829
379929             MOVE LENGTH OF PV-CICS-MSG-AREA                      37992929
379930               TO PV-COMMAREA-LENGTH                              37993029
379931             EXEC CICS                                            37993129
379932                  WRITEQ TD                                       37993229
379933                   QUEUE  ('CSSL')                                37993329
379934                    FROM  (PV-CICS-MSG-AREA)                      37993429
379935                  LENGTH  (PV-COMMAREA-LENGTH)                    37993529
379936                    RESP  (PV-CICS-RESP)                          37993629
379937             END-EXEC                                             37993729
379938             MOVE '4220-CHECK-PULL-STATUS  '                      37993829
379939                              TO DP013-PARAGRAPH                  37993929
379940             MOVE 'GET CURRENT PULL STATUS           '            37994029
379941                              TO DP013-MESSAGE-TEXT (1)           37994129
379942             MOVE SQLCA       TO DP013-SQLCA                      37994229
379943             MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)         37994329
379944             SET DP013-DB2-ABEND                                  37994429
379945                 DP013-XCTL-DISPLAY-RESTART                       37994529
379946                                  TO TRUE                         37994629
379947             PERFORM DP013-0000-PROCESS-ABEND                     37994729
379948     END-EVALUATE.                                                37994829
379949                                                                  37994929
379950                                                                  37995029
379951*----------------------------------------------------------------*37995129
379952* COUNT THE NUMBER OF LINES NOT CANCELLED FOR THE PULL           *37995229
379953*----------------------------------------------------------------*37995329
379954 4230-CNT-NOT-CNCL-LINES.                                         37995429
379955                                                                  37995529
379956     EXEC SQL                                                     37995629
379957         SELECT COUNT(*)                                          37995729
379958           INTO :PV-LNE-NOT-CNCL-COUNT                            37995829
379959           FROM TCEPLIT                                           37995929
379960          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              37996029
379961            AND STAT_CDE         IN  ('NW','IP','DS','PD')        37996129
379962     END-EXEC.                                                    37996229
379963                                                                  37996329
379964     EVALUATE TRUE                                                37996429
379965         WHEN SQLCODE = ZERO                                      37996529
379966              CONTINUE                                            37996629
379967                                                                  37996729
379968         WHEN SQLWARN0 NOT = SPACES                               37996829
379969         WHEN SQLCODE < ZERO                                      37996929
379970         WHEN SQLCODE > ZERO                                      37997029
379971              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 37997129
379972                                PV-DISPLAY-RET-CDE                37997229
379973              SET  CE005-FUNC-INVALID                             37997329
379974                   PS-ERROR            TO  TRUE                   37997429
379975              STRING ' CEKCS610 -'           DELIMITED BY SIZE    37997529
379976                     ' 4230-CNT-NOT-CNCL-LINES'                   37997629
379977                                             DELIMITED BY SIZE    37997729
379978                     CE005-RETURN-MSG        DELIMITED BY SIZE    37997829
379979                                             INTO PV-CICS-MSG-AREA37997929
379980             MOVE LENGTH OF PV-CICS-MSG-AREA                      37998029
379981               TO PV-COMMAREA-LENGTH                              37998129
379982             EXEC CICS                                            37998229
379983                  WRITEQ TD                                       37998329
379984                   QUEUE  ('CSSL')                                37998429
379985                    FROM  (PV-CICS-MSG-AREA)                      37998529
379986                  LENGTH  (PV-COMMAREA-LENGTH)                    37998629
379987                    RESP  (PV-CICS-RESP)                          37998729
379988             END-EXEC                                             37998829
379989                                                                  37998929
379990             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             37999029
379991             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              37999129
379992             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             37999229
379993              STRING ' CEKCS610 -'          DELIMITED BY SIZE     37999329
379994                     ' PULL-'               DELIMITED BY SIZE     37999429
379995                     PV-DISPLAY-PULL        DELIMITED BY SIZE     37999529
379996                     '  REF-'               DELIMITED BY SIZE     37999629
379997                     PV-DISPLAY-REF         DELIMITED BY SIZE     37999729
379998                     '  LINE-'              DELIMITED BY SIZE     37999829
379999                     PV-DISPLAY-LINE        DELIMITED BY SIZE     37999929
380000                     '  SQLCODE = '         DELIMITED BY SIZE     38000029
380001                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     38000129
380002                                            INTO PV-CICS-MSG-AREA 38000229
380003             MOVE LENGTH OF PV-CICS-MSG-AREA                      38000329
380004               TO PV-COMMAREA-LENGTH                              38000429
380005             EXEC CICS                                            38000529
380006                  WRITEQ TD                                       38000629
380007                   QUEUE  ('CSSL')                                38000729
380008                    FROM  (PV-CICS-MSG-AREA)                      38000829
380009                  LENGTH  (PV-COMMAREA-LENGTH)                    38000929
380010                    RESP  (PV-CICS-RESP)                          38001029
380011             END-EXEC                                             38001129
380012             MOVE '4230-CNT-NOT-CNCL-LINES'                       38001229
380013                              TO DP013-PARAGRAPH                  38001329
380014             MOVE 'COUNTING NBR LINE NOT CANCELLED '              38001429
380015                              TO DP013-MESSAGE-TEXT (1)           38001529
380016             MOVE SQLCA       TO DP013-SQLCA                      38001629
380017             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         38001729
380018             SET DP013-DB2-ABEND                                  38001829
380019                 DP013-XCTL-DISPLAY-RESTART                       38001929
380020                                  TO TRUE                         38002029
380021             PERFORM DP013-0000-PROCESS-ABEND                     38002129
380022     END-EVALUATE.                                                38002229
380023                                                                  38002329
380024*----------------------------------------------------------------*38002429
380025* COUNT THE NUMBER OF LINES POSTED FOR THE PULL                  *38002529
380026*----------------------------------------------------------------*38002629
380027 4235-CNT-POST-LINES.                                             38002729
380028                                                                  38002829
380029     EXEC SQL                                                     38002929
380030         SELECT COUNT(*)                                          38003029
380031           INTO :PV-LNE-POST-COUNT                                38003129
380032           FROM TCEPLIT                                           38003229
380033          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              38003329
380034            AND STAT_CDE         IN  ('PD')                       38003429
380035     END-EXEC.                                                    38003529
380036                                                                  38003629
380037     EVALUATE TRUE                                                38003729
380038         WHEN SQLCODE = ZERO                                      38003829
380039              CONTINUE                                            38003929
380040                                                                  38004029
380041         WHEN SQLWARN0 NOT = SPACES                               38004129
380042         WHEN SQLCODE < ZERO                                      38004229
380043         WHEN SQLCODE > ZERO                                      38004329
380044              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 38004429
380045                                PV-DISPLAY-RET-CDE                38004529
380046              SET  CE005-FUNC-INVALID                             38004629
380047                   PS-ERROR            TO  TRUE                   38004729
380048              STRING ' CEKCS610 -'           DELIMITED BY SIZE    38004829
380049                     ' 4235-CNT-POST-LINES'                       38004929
380050                                             DELIMITED BY SIZE    38005029
380051                     CE005-RETURN-MSG        DELIMITED BY SIZE    38005129
380052                                             INTO PV-CICS-MSG-AREA38005229
380053             MOVE LENGTH OF PV-CICS-MSG-AREA                      38005329
380054               TO PV-COMMAREA-LENGTH                              38005429
380055             EXEC CICS                                            38005529
380056                  WRITEQ TD                                       38005629
380057                   QUEUE  ('CSSL')                                38005729
380058                    FROM  (PV-CICS-MSG-AREA)                      38005829
380059                  LENGTH  (PV-COMMAREA-LENGTH)                    38005929
380060                    RESP  (PV-CICS-RESP)                          38006029
380061             END-EXEC                                             38006129
380062                                                                  38006229
380063             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             38006329
380064             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              38006429
380065             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             38006529
380066              STRING ' CEKCS610 -'          DELIMITED BY SIZE     38006629
380067                     ' PULL-'               DELIMITED BY SIZE     38006729
380068                     PV-DISPLAY-PULL        DELIMITED BY SIZE     38006829
380069                     '  REF-'               DELIMITED BY SIZE     38006929
380070                     PV-DISPLAY-REF         DELIMITED BY SIZE     38007029
380071                     '  LINE-'              DELIMITED BY SIZE     38007129
380072                     PV-DISPLAY-LINE        DELIMITED BY SIZE     38007229
380073                     '  SQLCODE = '         DELIMITED BY SIZE     38007329
380074                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     38007429
380075                                            INTO PV-CICS-MSG-AREA 38007529
380076             MOVE LENGTH OF PV-CICS-MSG-AREA                      38007629
380077               TO PV-COMMAREA-LENGTH                              38007729
380078             EXEC CICS                                            38007829
380079                  WRITEQ TD                                       38007929
380080                   QUEUE  ('CSSL')                                38008029
380081                    FROM  (PV-CICS-MSG-AREA)                      38008129
380082                  LENGTH  (PV-COMMAREA-LENGTH)                    38008229
380083                    RESP  (PV-CICS-RESP)                          38008329
380084             END-EXEC                                             38008429
380085             MOVE '4235-CNT-POST-LINES'                           38008529
380086                              TO DP013-PARAGRAPH                  38008629
380087             MOVE 'COUNTING NBR LINES POSTED'                     38008729
380088                              TO DP013-MESSAGE-TEXT (1)           38008829
380089             MOVE SQLCA       TO DP013-SQLCA                      38008929
380090             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         38009029
380091             SET DP013-DB2-ABEND                                  38009129
380092                 DP013-XCTL-DISPLAY-RESTART                       38009229
380093                                  TO TRUE                         38009329
380094             PERFORM DP013-0000-PROCESS-ABEND                     38009429
380095     END-EVALUATE.                                                38009529
380096                                                                  38009629
380097                                                                  38009729
380098*----------------------------------------------------------------*38009829
380099* COUNT THE NUMBER OF LINES POSTED/DISTRIBUTED FOR THE PULL      *38009929
380100*----------------------------------------------------------------*38010029
380101 4240-CNT-POST-DIST-LINES.                                        38010129
380102                                                                  38010229
380103     EXEC SQL                                                     38010329
380104         SELECT COUNT(*)                                          38010429
380105           INTO :PV-LNE-POST-DIST-COUNT                           38010529
380106           FROM TCEPLIT                                           38010629
380107          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              38010729
380108            AND STAT_CDE         IN  ('DS','PD')                  38010829
380109     END-EXEC.                                                    38010929
380110                                                                  38011029
380111     EVALUATE TRUE                                                38011129
380112         WHEN SQLCODE = ZERO                                      38011229
380113              CONTINUE                                            38011329
380114                                                                  38011429
380115         WHEN SQLWARN0 NOT = SPACES                               38011529
380116         WHEN SQLCODE < ZERO                                      38011629
380117         WHEN SQLCODE > ZERO                                      38011729
380118              MOVE SQLCODE  TO  CE005-DB2-SQLCODE                 38011829
380119                                PV-DISPLAY-RET-CDE                38011929
380120              SET  CE005-FUNC-INVALID                             38012029
380121                   PS-ERROR            TO  TRUE                   38012129
380122              STRING ' CEKCS610 -'           DELIMITED BY SIZE    38012229
380123                     ' 4240-CNT-POST-DIST-LINES'                  38012329
380124                                             DELIMITED BY SIZE    38012429
380125                     CE005-RETURN-MSG        DELIMITED BY SIZE    38012529
380126                                             INTO PV-CICS-MSG-AREA38012629
380127             MOVE LENGTH OF PV-CICS-MSG-AREA                      38012729
380128               TO PV-COMMAREA-LENGTH                              38012829
380129             EXEC CICS                                            38012929
380130                  WRITEQ TD                                       38013029
380131                   QUEUE  ('CSSL')                                38013129
380132                    FROM  (PV-CICS-MSG-AREA)                      38013229
380133                  LENGTH  (PV-COMMAREA-LENGTH)                    38013329
380134                    RESP  (PV-CICS-RESP)                          38013429
380135             END-EXEC                                             38013529
380136                                                                  38013629
380137             MOVE DK-PULL-NUMBER  TO  PV-DISPLAY-PULL             38013729
380138             MOVE DK-REF-NUMBER   TO  PV-DISPLAY-REF              38013829
380139             MOVE DK-LINE-NUMBER  TO  PV-DISPLAY-LINE             38013929
380140              STRING ' CEKCS610 -'          DELIMITED BY SIZE     38014029
380141                     ' PULL-'               DELIMITED BY SIZE     38014129
380142                     PV-DISPLAY-PULL        DELIMITED BY SIZE     38014229
380143                     '  REF-'               DELIMITED BY SIZE     38014329
380144                     PV-DISPLAY-REF         DELIMITED BY SIZE     38014429
380145                     '  LINE-'              DELIMITED BY SIZE     38014529
380146                     PV-DISPLAY-LINE        DELIMITED BY SIZE     38014629
380147                     '  SQLCODE = '         DELIMITED BY SIZE     38014729
380148                     PV-DISPLAY-RET-CDE     DELIMITED BY SIZE     38014829
380149                                            INTO PV-CICS-MSG-AREA 38014929
380150             MOVE LENGTH OF PV-CICS-MSG-AREA                      38015029
380151               TO PV-COMMAREA-LENGTH                              38015129
380152             EXEC CICS                                            38015229
380153                  WRITEQ TD                                       38015329
380154                   QUEUE  ('CSSL')                                38015429
380155                    FROM  (PV-CICS-MSG-AREA)                      38015529
380156                  LENGTH  (PV-COMMAREA-LENGTH)                    38015629
380157                    RESP  (PV-CICS-RESP)                          38015729
380158             END-EXEC                                             38015829
380159             MOVE '4240-CNT-POST-DIST-LINES'                      38015929
380160                              TO DP013-PARAGRAPH                  38016029
380161             MOVE 'COUNTING NBR LINES POSTED/DISTRIBUTED'         38016129
380162                              TO DP013-MESSAGE-TEXT (1)           38016229
380163             MOVE SQLCA       TO DP013-SQLCA                      38016329
380164             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         38016429
380165             SET DP013-DB2-ABEND                                  38016529
380166                 DP013-XCTL-DISPLAY-RESTART                       38016629
380167                                  TO TRUE                         38016729
380168             PERFORM DP013-0000-PROCESS-ABEND                     38016829
380169     END-EVALUATE.                                                38016929
380170                                                                  38017029
380180                                                                  38018094
380190****************************************************************  38019094
380200*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  38020094
380201*                                                              *  38020194
380202*    GET STORE E BUSINESS LOC ID                               *  38020229
380203****************************************************************  38020394
380204 4300-GET-STORE-IND.                                              38020494
380205                                                                  38020594
380206     INITIALIZE XL071-COMMAREA.                                   38020694
380207     MOVE CE005-CS-LOCATION TO XL071-LOCATION-NUMBER.             38020794
380208                                                                  38020894
380209     CALL XL071-LOCATION-MODULE USING                             38020994
380210                                DFHEIBLK                          38021094
380220                                XL071-COMMAREA                    38022094
380230                                XL071-COMMAREA-REC.               38023094
380240                                                                  38024094
380250     EVALUATE TRUE                                                38025094
380260         WHEN XL071-NO-ERRORS                                     38026094
380270              CONTINUE                                            38027094
380280                                                                  38028094
380290         WHEN XL071-LOC-NOT-FOUND                                 38029094
380300              CONTINUE                                            38030094
380400                                                                  38040094
380500         WHEN OTHER                                               38050094
380600              MOVE XL071-SQLCODE  TO  CE005-DB2-SQLCODE           38060094
380601                                      PV-DISPLAY-RET-CDE          38060194
380602              SET  CE005-FUNC-INVALID                             38060229
380603                   PS-ERROR            TO  TRUE                   38060329
380604              STRING ' CEKCS610 -'                                38060494
380605                     ' 4300-GET-STORE-IND-'                       38060594
380606                      CE005-RETURN-MSG                            38060694
380607                      DELIMITED BY SIZE                           38060794
380608                      INTO PV-CICS-MSG-AREA                       38060894
380609              MOVE LENGTH OF PV-CICS-MSG-AREA                     38060994
380610                TO PV-COMMAREA-LENGTH                             38061094
380620              EXEC CICS                                           38062094
380630                   WRITEQ TD                                      38063094
380640                    QUEUE  ('CSSL')                               38064094
380650                     FROM  (PV-CICS-MSG-AREA)                     38065094
380660                   LENGTH  (PV-COMMAREA-LENGTH)                   38066094
380670                     RESP  (PV-CICS-RESP)                         38067094
380680              END-EXEC                                            38068094
380690              STRING ' CEKCS610 -'                                38069094
380700                     ' 4300-GET-STORE-IND-'                       38070094
380800                     ' STORE - '                                  38080094
380900                      XL071-LOCATION-NUMBER                       38090094
381000                      DELIMITED BY SIZE                           38100094
381100                      INTO PV-CICS-MSG-AREA                       38110094
381200              MOVE LENGTH OF PV-CICS-MSG-AREA                     38120094
381300                TO PV-COMMAREA-LENGTH                             38130094
381400              EXEC CICS                                           38140094
381500                   WRITEQ TD                                      38150094
381600                    QUEUE  ('CSSL')                               38160094
381700                     FROM  (PV-CICS-MSG-AREA)                     38170094
381800                   LENGTH  (PV-COMMAREA-LENGTH)                   38180094
381900                     RESP  (PV-CICS-RESP)                         38190094
381901              END-EXEC                                            38190194
381902                                                                  38190229
381903              MOVE '4300-GET-STORE-IND'                           38190394
381904                               TO DP013-PARAGRAPH                 38190494
381905              MOVE 'SELECT STORE IND'                             38190594
381906                               TO DP013-MESSAGE-TEXT (1)          38190694
381907              MOVE SQLCA       TO DP013-SQLCA                     38190794
381908              MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)        38190894
381909              SET DP013-DB2-ABEND                                 38190994
381910                  DP013-XCTL-DISPLAY-RESTART                      38191094
381920                                   TO TRUE                        38192094
381930              PERFORM DP013-0000-PROCESS-ABEND                    38193094
381940                                                                  38194094
381950     END-EVALUATE.                                                38195094
381951                                                                  38195194
381952                                                                  38195229
381953* REPLACED THE CALL TO TSK USING THE LOGISTICS       WR/IR# 230ZZ 38195366
381954* MODULE.                                            WR/IR# 230ZZ 38195466
381955*4400-SELECT-SKU.                                                 38195562
381956 4400-CALL-CICS-API-ARCH.                                         38195662
381957     INITIALIZE XL001-ITEM-COMMAREA                               38195764
381958                PV-SKU-SEQ.                                       38195864
381959                                                                  38195964
381960     MOVE CEPLIT-ITM-NBR  TO  XL001-KEY-ITM-NBR.                  38196063
381961                                                                  38196163
381962     SET  XL001-BY-ITEM                                           38196263
381963          XL001-SELECT-SKU TO TRUE.                               38196363
381964                                                                  38196463
381965     CALL XL001-VSM-PGM USING  DFHEIBLK                           38196563
381966                               XL001-COMMAREA                     38196663
381967                               XL001-ITEM-COMMAREA.               38196763
381968                                                                  38196863
381969     EVALUATE TRUE                                                38196929
381970         WHEN XL001-SKU-SQLCODE = +0                              38197063
381971              MOVE  XL001-SKU-NBR      TO  PV-SKU-SEQ             38197163
381972                                                                  38197263
381973         WHEN OTHER                                               38197329
381974              MOVE XL001-SKU-SQLCODE   TO  CE005-DB2-SQLCODE      38197463
381975                                           PV-DISPLAY-RET-CDE     38197563
381976              SET  CE005-FUNC-INVALID                             38197629
381977                   PS-ERROR            TO  TRUE                   38197729
381978              STRING ' CEKCS610 -'           DELIMITED BY SIZE    38197829
381979                     ' 4400-CALL-CICS-API-ARCH - '                38197963
381980                                             DELIMITED BY SIZE    38198063
381981                     CE005-RETURN-MSG        DELIMITED BY SIZE    38198129
381982                                             INTO PV-CICS-MSG-AREA38198229
381983             MOVE LENGTH OF PV-CICS-MSG-AREA                      38198329
381984               TO PV-COMMAREA-LENGTH                              38198429
381985             EXEC CICS                                            38198529
381986                  WRITEQ TD                                       38198629
381987                   QUEUE  ('CSSL')                                38198729
381988                    FROM  (PV-CICS-MSG-AREA)                      38198829
381989                  LENGTH  (PV-COMMAREA-LENGTH)                    38198929
381990                    RESP  (PV-CICS-RESP)                          38199029
381991             END-EXEC                                             38199129
381992             MOVE XL001-KEY-ITM-NBR     TO PV-TSK-ITEM-NMBR       38199263
381993             STRING ' CEKCS610 -'          DELIMITED BY SIZE      38199329
381994                    ' 4400-CALL-CICS-API-ARCH - '                 38199463
381995                                           DELIMITED BY SIZE      38199563
381996                    ' ITEM NUMBER - '      DELIMITED BY SIZE      38199631
381997                    PV-TSK-ITEM-NMBR       DELIMITED BY SIZE      38199733
381998                                           INTO PV-CICS-MSG-AREA  38199829
381999             MOVE LENGTH OF PV-CICS-MSG-AREA                      38199929
382000               TO PV-COMMAREA-LENGTH                              38200029
382001             EXEC CICS                                            38200129
382002                  WRITEQ TD                                       38200229
382003                   QUEUE  ('CSSL')                                38200329
382004                    FROM  (PV-CICS-MSG-AREA)                      38200429
382005                  LENGTH  (PV-COMMAREA-LENGTH)                    38200529
382006                    RESP  (PV-CICS-RESP)                          38200629
382007             END-EXEC                                             38200729
382008                                                                  38200829
382009             MOVE '4400-CALL-CICS-API-ARCH'                       38200962
382010                              TO DP013-PARAGRAPH                  38201029
382011             MOVE 'SELECT SKU NUMBER       '                      38201129
382012                              TO DP013-MESSAGE-TEXT (1)           38201229
382013             MOVE SQLCA       TO DP013-SQLCA                      38201329
382014             MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)         38201462
382015             SET DP013-DB2-ABEND                                  38201529
382016                 DP013-XCTL-DISPLAY-RESTART                       38201629
382017                                  TO TRUE                         38201729
382018             PERFORM DP013-0000-PROCESS-ABEND                     38201829
382019     END-EVALUATE.                                                38201929
382020                                                                  38202029
382021*                                                                 38202163
382022*----------------------------------------------------------------*38202263
382023* GET PULL ITEM QTYS                                             *38202363
382024*----------------------------------------------------------------*38202463
382025 4500-GET-PULL-ITEM.                                              38202563
382026                                                                  38202663
382027     INITIALIZE  PV-CEPLIT-REQ-QTY.                               38202753
382028                                                                  38202853
382029     EXEC SQL                                                     38202953
382030         SELECT  PL_REQ_QTY                                       38203055
382031             ,   STAT_CDE                                         38203155
382032           INTO  :PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               38203253
382033             ,   :PV-PULL-STATUS                                  38203355
382034           FROM  TCEPLIT                                          38203453
382035          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             38203553
382036            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             38203661
382037            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    38203755
382038     END-EXEC.                                                    38203855
382039                                                                  38203955
382040     EVALUATE TRUE                                                38204053
382041         WHEN SQLCODE = +0                                        38204153
382042              CONTINUE                                            38204253
382043         WHEN OTHER                                               38204353
382044              MOVE '4500-GET-PULL-ITEM'                           38204453
382045                               TO DP013-PARAGRAPH                 38204553
382046              MOVE 'GET PULL STATUS ITEM QTYS'                    38204653
382047                               TO DP013-MESSAGE-TEXT (1)          38204753
382048              MOVE SQLCA       TO DP013-SQLCA                     38204853
382049              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        38204953
382050              SET DP013-DB2-ABEND                                 38205053
382051                  DP013-XCTL-DISPLAY-RESTART                      38205153
382052                  DP013-ROLLBACK                                  38205261
382053                                   TO TRUE                        38205353
382054                  PERFORM DP013-0000-PROCESS-ABEND                38205453
382055     END-EVALUATE.                                                38205553
382056                                                                  38205653
382057                                                                  38205753
382058*----------------------------------------------------------------*38205853
382059* GET LINE ITEM DISTRIBUTION QTY & STORE COUNT                   *38205953
382060*----------------------------------------------------------------*38206053
382061 4600-GET-ITEM-DISTRO.                                            38206153
382062     INITIALIZE  PV-CEPLDS-DISTRB-QTY.                            38206253
382063                                                                  38206353
382064     EXEC SQL                                                     38206453
382065          SELECT  SUM(A.ACTL_DISTRB_QTY)                          38206553
382066            INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1            38206653
382067            FROM  TCEPLDS A                                       38206753
382068           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           38206853
382069             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           38206953
382070             AND  :DK-LINE-STATUS  IN  ('DS','PD')                38207053
382071     END-EXEC                                                     38207153
382072                                                                  38207253
382073                                                                  38207353
382074     EVALUATE TRUE                                                38207453
382075         WHEN SQLCODE = +0                                        38207553
382076              CONTINUE                                            38207653
382077         WHEN OTHER                                               38207753
382078              MOVE '4600-GET-ITEM-DISTRO'                         38207853
382079                               TO DP013-PARAGRAPH                 38207953
382080              MOVE 'GET LINE DISTRIBTION     '                    38208053
382081                               TO DP013-MESSAGE-TEXT (1)          38208153
382082              MOVE SQLCA       TO DP013-SQLCA                     38208253
382083              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        38208353
382084              SET DP013-DB2-ABEND                                 38208453
382085                  DP013-XCTL-DISPLAY-RESTART                      38208553
382086                  DP013-ROLLBACK                                  38208661
382087                                   TO TRUE                        38208753
382088                  PERFORM DP013-0000-PROCESS-ABEND                38208853
382089     END-EVALUATE.                                                38208953
382090                                                                  38209053
382091*----------------------------------------------------------------*38209153
382092* GET LINE ITEM MANIFESTED UNIT QUANTITY                         *38209253
382093*----------------------------------------------------------------*38209353
382094 4700-GET-PULL-MANIFEST.                                          38209453
382095     INITIALIZE  PV-CEPLMF-MANIF-QTY.                             38209553
382096                                                                  38209653
382097     EXEC SQL                                                     38209753
382098          SELECT  SUM(A.MFST_UNT_QTY)                             38209853
382099            INTO  :PV-CEPLMF-MANIF-QTY :PV-NULL-IND-3             38209953
382100            FROM  TCEPLMF A                                       38210053
382101               ,  TCEPLIT B                                       38210153
382102           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           38210253
382103             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           38210353
382104             AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR        38210453
382105             AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR              38210553
382106             AND  B.STAT_CDE         NOT IN ('CA', 'PD')          38210653
382107     END-EXEC                                                     38210753
382108                                                                  38210853
382109                                                                  38210953
382110     EVALUATE TRUE                                                38211053
382111         WHEN SQLCODE = +0                                        38211153
382112              CONTINUE                                            38211253
382113         WHEN OTHER                                               38211353
382114              MOVE '4700-GET-PULL-MANIFEST'                       38211453
382115                               TO DP013-PARAGRAPH                 38211553
382116              MOVE 'GET LINE MANIFEST QTY    '                    38211653
382117                               TO DP013-MESSAGE-TEXT (1)          38211753
382118              MOVE SQLCA       TO DP013-SQLCA                     38211853
382119              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (2)        38211953
382120              SET DP013-DB2-ABEND                                 38212053
382121                  DP013-XCTL-DISPLAY-RESTART                      38212153
382122                  DP013-ROLLBACK                                  38212261
382123                                   TO TRUE                        38212353
382124                  PERFORM DP013-0000-PROCESS-ABEND                38212453
382125     END-EVALUATE.                                                38212553
382126                                                                  38212653
382127                                                                  38212753
382128*----------------------------------------------------------------*38212853
382129* GET LINE ITEM ADJUSTED UNIT QUANTITY                           *38212953
382130*----------------------------------------------------------------*38213053
382131 4800-GET-PULL-ADJUST.                                            38213153
382132     INITIALIZE  PV-CEPLAU-ADJUST-QTY.                            38213253
382133                                                                  38213353
382134     EXEC SQL                                                     38213453
382135          SELECT  SUM(A.AFT_ADJ_UNT_QTY - A.BEF_ADJ_UNT_QTY)      38213553
382136            INTO  :PV-CEPLAU-ADJUST-QTY :PV-NULL-IND-4            38213653
382137            FROM  TCEPLAU A                                       38213753
382138               ,  TCEPLIT B                                       38213853
382139           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           38213953
382140             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           38214053
382141             AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR        38214153
382142             AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR              38214253
382143             AND  B.STAT_CDE         NOT IN ('CA', 'PD')          38214353
382144     END-EXEC                                                     38214453
382145                                                                  38214553
382146                                                                  38214653
382147     EVALUATE TRUE                                                38214753
382148         WHEN SQLCODE = +0                                        38214853
382149              CONTINUE                                            38214953
382150         WHEN OTHER                                               38215053
382151              MOVE '4800-GET-PULL-ADJUST'                         38215153
382152                               TO DP013-PARAGRAPH                 38215253
382153              MOVE 'GET LINE ADJUSTMENT QTY  '                    38215353
382154                               TO DP013-MESSAGE-TEXT (1)          38215453
382155              MOVE SQLCA       TO DP013-SQLCA                     38215553
382156              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (2)        38215653
382157              SET DP013-DB2-ABEND                                 38215753
382158                  DP013-XCTL-DISPLAY-RESTART                      38215853
382159                                   TO TRUE                        38215953
382160                  PERFORM DP013-0000-PROCESS-ABEND                38216053
382161     END-EVALUATE.                                                38216153
382162                                                                  38216253
382163                                                                  38216353
382164                                                                  38216453
382165*----------------------------------------------------------------*38216529
382166*  PREPARES INFO TO BE RETURNED TO THE 'CALLING' PROGRAM.        *38216629
382167*----------------------------------------------------------------*38216729
382168 5000-RETURN-CALL.                                                38216829
382169                                                                  38216929
382170     MOVE CE005-INTER-APPL-COMMAREA  TO  DFHCOMMAREA.             38217029
382171                                                                  38217129
382172     EXEC CICS                                                    38217229
382173         SYNCPOINT                                                38217329
382174     END-EXEC.                                                    38217429
382175                                                                  38217529
382176     EXEC CICS                                                    38217629
382177         RETURN                                                   38217729
382178     END-EXEC.                                                    38217829
382179                                                                  38217929
382180                                                                  38218029
382181*----------------------------------------------------------------*38218129
382182*  SYNCPOINT                                                     *38218229
382183*----------------------------------------------------------------*38218329
382184 8000-SYNCPOINT.                                                  38218429
382185                                                                  38218529
382186     EXEC CICS                                                    38218629
382187          SYNCPOINT                                               38218729
382188     END-EXEC.                                                    38218829
382189                                                                  38218929
382190                                                                  38219029
382191 8100-MQ-SETUP.                                                   38219129
382192                                                                  38219229
382193* DETERMINE THE SYSTEM                                            38219329
382194                                                                  38219429
382195     PERFORM EP000-0000-INITIALIZE.                               38219529
382196     IF EP000-PV-KOHLS-PROD-SYSTEM                                38219629
382197         SET PC-PROD-QMGR-NAME     TO TRUE                        38219729
382198     ELSE                                                         38219829
382199          IF EP000-PV-KOHLS-QA-SYSTEM                             38219929
382200              SET PC-QA-QMGR-NAME  TO TRUE                        38220029
382201          ELSE                                                    38220129
382202              SET PC-TEST-QMGR-NAME                               38220229
382203                                   TO TRUE                        38220329
382204          END-IF                                                  38220429
382205     END-IF.                                                      38220529
382206                                                                  38220629
382207* CONNECT TO THE QUEUE                                            38220729
382208                                                                  38220829
382209     SET PS-NO-MQ-ERROR            TO TRUE.                       38220929
382210     MOVE PC-QMGR-NAME             TO PV-QM-NAME.                 38221029
382211     CALL PC-MQCONN USING PV-QM-NAME                              38221129
382212                          PV-HCONN                                38221229
382213                          PV-COMPLETION-CODE                      38221329
382214                          PV-REASON.                              38221429
382215                                                                  38221529
382216*    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              38221629
382217*    AND EXIT                                                     38221729
382218                                                                  38221829
382219     MOVE PV-REASON TO PV-CON-REASON.                             38221929
382220     IF (PV-COMPLETION-CODE = MQCC-OK)                            38222029
382221         CONTINUE                                                 38222129
382222     ELSE                                                         38222229
382223         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       38222343
382224         MOVE PV-QM-NAME           TO PE-MQ-QMANAGER              38222429
382225         SET  PE-MQ-CONNECT        TO TRUE                        38222529
382226         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       38222629
382227         MOVE PV-REASON            TO PE-MQ-REASON-CODE           38222729
382228         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           38222843
382229         PERFORM 9900-MQ-ERROR                                    38222929
382230         SET PS-MQ-ERROR           TO TRUE                        38223029
382231     END-IF.                                                      38223129
382232                                                                  38223229
382233                                                                  38223329
382234*----------------------------------------------------------------*38223429
382235*  PUT THE MQ MESSAGE ONTO THE QUEUE                              38223530
382236*----------------------------------------------------------------*38223629
382237                                                                  38223729
382238 8200-MQ-PUT1.                                                    38223830
382239                                                                  38223930
382240     PERFORM 8800-GET-QUEUE-NAME.                                 38224030
382241     MOVE PV-OBJECTNAME            TO MQOD-OBJECTNAME.            38224130
382242     PERFORM 8900-GET-QMGR-NAME.                                  38224230
382243     MOVE PV-OBJECTQMGRNAME        TO MQOD-OBJECTQMGRNAME.        38224330
382244     COMPUTE MQPMO-OPTIONS         = MQPMO-FAIL-IF-QUIESCING      38224430
382245                                   + MQPMO-SYNCPOINT.             38224530
382246     MOVE MQFMT-STRING             TO MQMD-FORMAT.                38224630
382247     MOVE LENGTH OF CE016-INV-TRANS-RECORD                        38224730
382248                                   TO PV-MSGLENGTH.               38224830
382249                                                                  38224930
382250                                                                  38225030
382251     CALL PC-MQPUT1 USING PV-HCONN                                38225130
382252                          MQM-OBJECT-DESCRIPTOR                   38225230
382253                          MQM-MESSAGE-DESCRIPTOR                  38225330
382254                          MQM-PUT-MESSAGE-OPTIONS                 38225430
382255                          PV-MSGLENGTH                            38225530
382256                          CE016-INV-TRANS-RECORD                  38225630
382257                          PV-COMPLETION-CODE                      38225730
382258                          PV-REASON.                              38225830
382259                                                                  38225930
382260     IF (PV-COMPLETION-CODE = MQCC-OK)                            38226030
382261         CONTINUE                                                 38226130
382262     ELSE                                                         38226230
382263                                                                  38226343
382264         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       38226443
382265         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              38226530
382266         SET  PE-MQ-PUT1           TO TRUE                        38226630
382267         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       38226730
382268         MOVE PV-REASON            TO PE-MQ-REASON-CODE           38226830
382269         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           38226943
382270         MOVE PV-REASON            TO  DP013-MESSAGE-TEXT(1)      38227046
382271         MOVE PV-MQ-REASON-TEXT    TO  DP013-MESSAGE-TEXT(2)      38227146
382272         MOVE PV-OBJECTNAME        TO  DP013-MESSAGE-TEXT(3)      38227230
382273         MOVE PV-OBJECTQMGRNAME    TO  DP013-MESSAGE-TEXT(4)      38227330
382274         PERFORM 9900-MQ-ERROR                                    38227430
382275         PERFORM 8700-MQ-DISCONNECT                               38227533
382276         SET PS-MQ-ERROR           TO TRUE                        38227630
382277         MOVE '8200-MQ-PUT1'                                      38227750
382278                                   TO  DP013-PARAGRAPH            38227830
382279         PERFORM DP013-0000-PROCESS-ABEND                         38227930
382280     END-IF.                                                      38228030
382281                                                                  38228130
382282     IF PS-NO-MQ-ERROR                                            38228230
382283         PERFORM 8300-CICS-MQ-COMMIT                              38228342
382284     ELSE                                                         38228430
382285         PERFORM 8700-MQ-DISCONNECT                               38228530
382286     END-IF.                                                      38228630
382287                                                                  38228729
382288*--------------------------------------------------------------*  38228829
382289*  COMMIT THE MQ PUT BY USING A CICS SYNCPOINT COMMAND.           38228929
382290*  (MQ COMMIT DOES NOT WORK IN CICS, THE SYNCPOINT MUST BE     *  38229029
382291*  USED)                                                          38229129
382292*--------------------------------------------------------------*  38229229
382293 8300-CICS-MQ-COMMIT.                                             38229330
382294                                                                  38229429
382295     EXEC CICS                                                    38229529
382296         SYNCPOINT                                                38229629
382297     END-EXEC.                                                    38229729
382298                                                                  38229829
382299     PERFORM 8400-MQ-GET-OPEN.                                    38229930
382300                                                                  38230029
382301*----------------------------------------------------------------*38230129
382302*  OPEN THE MESSAGE QUEUE THAT WILL GET THE RESPONSE MESSAGE     *38230229
382303*----------------------------------------------------------------*38230329
382304                                                                  38230429
382305 8400-MQ-GET-OPEN.                                                38230530
382306                                                                  38230629
382307     MOVE PV-SKU-NUMBER            TO CE016-SKU-NUMBER.           38230729
382308     MOVE CE005-CS-LOCATION        TO CE016-STORE-NUMBER.         38230832
382309     SET CE016-TRANS-TYPE-ADJ TO TRUE.                            38230929
382310     MOVE CEPLIT-PL-REQ-QTY        TO CE016-TRANS-RESV-QTY        38231029
382311     MOVE PV-CURRENT-DATE          TO CE016-TRANS-DATE.           38231133
382312     PERFORM 8850-GET-QUEUE-NAME.                                 38231230
382313     MOVE PV-OBJECTNAME            TO MQOD-OBJECTNAME.            38231329
382314     COMPUTE PV-OPEN-OPTIONS       = MQOO-INPUT-SHARED            38231429
382315                                   + MQOO-FAIL-IF-QUIESCING.      38231529
382316     MOVE PC-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        38231629
382317                                                                  38231729
382318     CALL PC-MQOPEN USING PV-HCONN                                38231829
382319                          MQM-OBJECT-DESCRIPTOR                   38231929
382320                          PV-OPEN-OPTIONS                         38232029
382321                          PV-GQ-HANDLE                            38232129
382322                          PV-COMPLETION-CODE                      38232229
382323                          PV-REASON.                              38232329
382324                                                                  38232429
382325     IF (PV-COMPLETION-CODE = MQCC-OK)                            38232529
382326         CONTINUE                                                 38232629
382327     ELSE                                                         38232729
382328         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       38232843
382329         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           38232943
382330         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              38233029
382331         MOVE PV-OBJECTNAME        TO PE-MQ-QNAME                 38233129
382332         SET  PE-MQ-OPEN           TO TRUE                        38233229
382333         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       38233329
382334         MOVE PV-REASON            TO PE-MQ-REASON-CODE           38233429
382335         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           38233543
382336         PERFORM 9900-MQ-ERROR                                    38233629
382337         SET PS-MQ-ERROR           TO TRUE                        38233729
382338         MOVE PV-REASON            TO  DP013-MESSAGE-TEXT(1)      38233846
382339         MOVE PV-MQ-REASON-TEXT    TO  DP013-MESSAGE-TEXT(2)      38233946
382340         MOVE PV-OBJECTNAME        TO  DP013-MESSAGE-TEXT(3)      38234029
382341         MOVE PC-QMGR-NAME         TO  DP013-MESSAGE-TEXT(4)      38234129
382342         MOVE '8400-MQ-GET-OPEN'                                  38234230
382343                                   TO  DP013-PARAGRAPH            38234329
382344         PERFORM DP013-0000-PROCESS-ABEND                         38234429
382345     END-IF.                                                      38234529
382346     IF PS-NO-MQ-ERROR                                            38234629
382347         PERFORM 8500-MQ-GET                                      38234730
382348     ELSE                                                         38234829
382349         PERFORM 8700-MQ-DISCONNECT                               38234930
382350     END-IF.                                                      38235029
382351                                                                  38235129
382352*----------------------------------------------------------------*38235229
382353*  WAIT FOR THE MESSAGE TO COME BACK FROM THE LOADER PROGRAM     *38235329
382354*  INDICATING THAT THE DATABSE LOAD WAS SUCCESSFUL                38235429
382355*----------------------------------------------------------------*38235529
382356                                                                  38235629
382357 8500-MQ-GET.                                                     38235730
382358                                                                  38235829
382359     MOVE 60000                    TO MQGMO-WAITINTERVAL.         38235929
382360     MOVE MQMD-MSGID               TO MQMD-CORRELID.              38236029
382361     MOVE MQMI-NONE                TO MQMD-MSGID.                 38236129
382362     COMPUTE MQGMO-OPTIONS         = MQGMO-WAIT                   38236229
382363                                   + MQGMO-FAIL-IF-QUIESCING      38236335
382364                                   + MQGMO-CONVERT.               38236435
382365     MOVE PC-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        38236529
382366                                                                  38236629
382367                                                                  38236729
382368     CALL PC-MQGET USING PV-HCONN                                 38236829
382369                         PV-GQ-HANDLE                             38236929
382370                         MQM-MESSAGE-DESCRIPTOR                   38237029
382371                         MQM-GET-MESSAGE-OPTIONS                  38237129
382372                         PV-MSGLENGTH                             38237229
382373                         CE016-INV-TRANS-RECORD                   38237329
382374                         PV-DATA-LENGTH                           38237429
382375                         PV-COMPLETION-CODE                       38237529
382376                         PV-REASON.                               38237629
382377                                                                  38237729
382378     IF (PV-COMPLETION-CODE = MQCC-OK)                            38237829
382379         CONTINUE                                                 38237929
382380     ELSE                                                         38238029
382381         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       38238143
382382         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              38238229
382383         MOVE PV-OBJECTNAME        TO PE-MQ-QNAME                 38238329
382384         SET  PE-MQ-GET            TO TRUE                        38238429
382385         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       38238529
382386         MOVE PV-REASON            TO PE-MQ-REASON-CODE           38238629
382387         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           38238743
382388         PERFORM 9900-MQ-ERROR                                    38238829
382389         SET PS-MQ-ERROR           TO TRUE                        38238929
382390         MOVE PV-REASON            TO  DP013-MESSAGE-TEXT(1)      38239046
382391         MOVE PV-MQ-REASON-TEXT    TO  DP013-MESSAGE-TEXT(2)      38239146
382392         MOVE '8500-MQ-GET'                                       38239230
382393                                   TO  DP013-PARAGRAPH            38239329
382394         MOVE PV-OBJECTNAME        TO  DP013-MESSAGE-TEXT(3)      38239429
382395         MOVE PC-QMGR-NAME         TO  DP013-MESSAGE-TEXT(4)      38239529
382396         PERFORM DP013-0000-PROCESS-ABEND                         38239629
382397     END-IF.                                                      38239729
382398     PERFORM 8600-MQ-GET-CLOSE.                                   38239830
382399                                                                  38239929
382400*----------------------------------------------------------------*38240029
382401*  CLOSE THE QUEUE THAT WAS OPENED TO GET THE RESPONSE MESSAGE   *38240129
382402*----------------------------------------------------------------*38240229
382403                                                                  38240329
382404 8600-MQ-GET-CLOSE.                                               38240430
382405                                                                  38240529
382406     CALL PC-MQCLOSE USING PV-HCONN                               38240629
382407                           PV-GQ-HANDLE                           38240729
382408                           MQCO-NONE                              38240829
382409                           PV-COMPLETION-CODE                     38240929
382410                           PV-REASON.                             38241029
382411                                                                  38241129
382412     IF (PV-COMPLETION-CODE = MQCC-OK)                            38241229
382413         CONTINUE                                                 38241329
382414     ELSE                                                         38241429
382415         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       38241543
382416         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              38241629
382417         MOVE PV-OBJECTNAME        TO PE-MQ-QNAME                 38241729
382418         SET  PE-MQ-CLOSE          TO TRUE                        38241829
382419         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       38241929
382420         MOVE PV-REASON            TO PE-MQ-REASON-CODE           38242029
382421         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           38242143
382422         PERFORM 9900-MQ-ERROR                                    38242229
382423         MOVE PV-REASON            TO  DP013-MESSAGE-TEXT(1)      38242346
382424         MOVE PV-MQ-REASON-TEXT    TO  DP013-MESSAGE-TEXT(2)      38242446
382425         MOVE PV-OBJECTNAME        TO  DP013-MESSAGE-TEXT(3)      38242529
382426         MOVE PC-QMGR-NAME         TO  DP013-MESSAGE-TEXT(4)      38242629
382427         MOVE '8600-MQ-GET-CLOSE'                                 38242730
382428                                   TO  DP013-PARAGRAPH            38242829
382429         PERFORM DP013-0000-PROCESS-ABEND                         38242929
382430     END-IF.                                                      38243029
382431                                                                  38243129
382432                                                                  38243229
382433                                                                  38243329
382434*----------------------------------------------------------------*38243429
382435*  DISCONNECT FROM THE QUEUE                                      38243529
382436*----------------------------------------------------------------*38243629
382437                                                                  38243729
382438 8700-MQ-DISCONNECT.                                              38243830
382439                                                                  38243929
382440     IF PV-CON-REASON              NOT EQUAL                      38244029
382441                                   MQRC-ALREADY-CONNECTED         38244129
382442         CALL PC-MQDISC USING PV-HCONN                            38244229
382443                              PV-COMPLETION-CODE                  38244329
382444                              PV-REASON                           38244429
382445         IF (PV-COMPLETION-CODE = MQCC-OK)                        38244529
382446             SET PS-MQ-SETUP-NOT-COMPLETE TO TRUE                 38244629
382447         ELSE                                                     38244729
382448                                                                  38244843
382449             CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT   38244943
382450             MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER          38245043
382451             MOVE PV-OBJECTNAME        TO PE-MQ-QNAME             38245143
382452             SET  PE-MQ-DISCONNECT TO TRUE                        38245243
382453             MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE   38245343
382454             MOVE PV-REASON            TO PE-MQ-REASON-CODE       38245443
382455             MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC       38245543
382456             PERFORM 9900-MQ-ERROR                                38245643
382457         END-IF                                                   38245729
382458     END-IF.                                                      38245829
382459                                                                  38245929
382460***************************************************************** 38246029
382461 8800-GET-QUEUE-NAME.                                             38246130
382462*     SELECT THE GET QUEUE NAME.                                  38246229
382463***************************************************************** 38246329
382464                                                                  38246429
382465     MOVE SPACES             TO PV-OBJECTNAME.                    38246529
382466     EXEC SQL                                                     38246629
382467         SELECT FUNC_TXT                                          38246729
382468           INTO :KRPRPM-FUNC-TXT                                  38246829
382469           FROM TKRPRPM B                                         38246929
382470          WHERE SYS_PRC_FUNC_CDE  = 'RDMGQU'                      38247029
382471            AND LOC_ID            = 090                           38247129
382472            AND INTFC_SYS_CDE     = 'RDM'                         38247229
382473            AND FUNC_PRC_STAT_CDE = 'AC'                          38247329
382474            AND (CURRENT DATE                                     38247429
382475        BETWEEN DATE(FUNC_BEG_TMST) AND                           38247529
382476                DATE(FUNC_END_TMST) )                             38247629
382477     END-EXEC.                                                    38247729
382478                                                                  38247829
382479     EVALUATE SQLCODE                                             38247929
382480         WHEN ZERO                                                38248029
382481             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTNAME            38248129
382482         WHEN OTHER                                               38248229
382483              MOVE '8800-GET-QUEUE-NAME'                          38248330
382484                               TO DP013-PARAGRAPH                 38248429
382485              MOVE 'SELECT QUEUE NAME'                            38248529
382486                               TO DP013-MESSAGE-TEXT (1)          38248629
382487              MOVE SQLCA       TO DP013-SQLCA                     38248729
382488              SET DP013-DB2-ABEND                                 38248829
382489                               TO TRUE                            38248929
382490              PERFORM DP013-0000-PROCESS-ABEND                    38249029
382491     END-EVALUATE.                                                38249129
382492                                                                  38249229
382493***************************************************************** 38249330
382494 8850-GET-QUEUE-NAME.                                             38249430
382495*     SELECT THE PUT QUEUE NAME.                                  38249530
382496***************************************************************** 38249630
382497                                                                  38249730
382498     MOVE SPACES             TO PV-OBJECTNAME.                    38249830
382499     EXEC SQL                                                     38249930
382500         SELECT FUNC_TXT                                          38250030
382501           INTO :KRPRPM-FUNC-TXT                                  38250130
382502           FROM TKRPRPM B                                         38250230
382503          WHERE SYS_PRC_FUNC_CDE  = 'RDMPQU'                      38250330
382504            AND LOC_ID            = 090                           38250430
382505            AND INTFC_SYS_CDE     = 'RDM'                         38250530
382506            AND FUNC_PRC_STAT_CDE = 'AC'                          38250630
382507            AND (CURRENT DATE                                     38250730
382508        BETWEEN DATE(FUNC_BEG_TMST) AND                           38250830
382509                DATE(FUNC_END_TMST) )                             38250930
382510     END-EXEC.                                                    38251030
382511                                                                  38251130
382512     EVALUATE SQLCODE                                             38251230
382513         WHEN ZERO                                                38251330
382514             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTNAME            38251430
382515         WHEN OTHER                                               38251530
382516              MOVE '8850-GET-QUEUE-NAME'                          38251630
382517                               TO DP013-PARAGRAPH                 38251730
382518              MOVE 'SELECT QUEUE NAME'                            38251830
382519                               TO DP013-MESSAGE-TEXT (1)          38251930
382520              MOVE SQLCA       TO DP013-SQLCA                     38252030
382521              SET DP013-DB2-ABEND                                 38252130
382522                               TO TRUE                            38252230
382523              PERFORM DP013-0000-PROCESS-ABEND                    38252330
382524     END-EVALUATE.                                                38252430
382525                                                                  38252530
382526                                                                  38252629
382527***************************************************************** 38252729
382528 8900-GET-QMGR-NAME.                                              38252830
382529*     SELECT QUEUE NAME.                                          38252929
382530***************************************************************** 38253029
382531                                                                  38253129
382532     MOVE SPACES             TO PV-OBJECTQMGRNAME.                38253229
382533     EXEC SQL                                                     38253329
382534         SELECT FUNC_TXT                                          38253429
382535           INTO :KRPRPM-FUNC-TXT                                  38253529
382536           FROM TKRPRPM B                                         38253629
382537          WHERE SYS_PRC_FUNC_CDE  = 'RDMQMG'                      38253729
382538            AND LOC_ID            = 090                           38253829
382539            AND INTFC_SYS_CDE     = 'RDM'                         38253929
382540            AND FUNC_PRC_STAT_CDE = 'AC'                          38254029
382541            AND (CURRENT DATE                                     38254129
382542        BETWEEN DATE(FUNC_BEG_TMST) AND                           38254229
382600                DATE(FUNC_END_TMST) )                             38260029
382700     END-EXEC.                                                    38270029
382800                                                                  38280029
382900     EVALUATE SQLCODE                                             38290029
383000         WHEN ZERO                                                38300029
383100             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTQMGRNAME        38310029
383200         WHEN OTHER                                               38320029
383300              MOVE '8900-GET-QMGR-NAME'                           38330030
383400                               TO DP013-PARAGRAPH                 38340029
383500              MOVE 'SELECT QUEUE MANAGER NAME'                    38350029
383600                               TO DP013-MESSAGE-TEXT (1)          38360029
383700              MOVE SQLCA       TO DP013-SQLCA                     38370029
383800              SET DP013-DB2-ABEND                                 38380029
383900                               TO TRUE                            38390029
384000              PERFORM DP013-0000-PROCESS-ABEND                    38400029
384100     END-EVALUATE.                                                38410029
384200                                                                  38420029
384300                                                                  38430029
384400                                                                  38440029
384500*-----------------------------------------------------------------38450029
384600*  MQ ERROR                                                       38460029
384700*-----------------------------------------------------------------38470029
384800 9900-MQ-ERROR.                                                   38480029
384900                                                                  38490029
385000     MOVE PE-MQ-ERROR-NUMBER TO EP000-SL-PI-MESSAGE-NUMBER.       38500029
385100     SET  EP000-SL-ERROR  TO  TRUE.                               38510029
385200     MOVE PC-ONE TO EP000-MESSAGE-LINE-COUNTER.                   38520029
385300     MOVE PE-MQ-ERROR-MESSAGE                                     38530029
385400           TO  EP000-MD-SYSTEM-LOG-MESSAGE                        38540029
385500               (EP000-MESSAGE-LINE-COUNTER).                      38550029
385600     PERFORM EP000-1000-POST-MESSAGE.                             38560029
385700                                                                  38570029
385800*----------------------------------------------------------------*38580029
385900*    ABEND PROCESSOR MODULE                                      *38590029
386000*----------------------------------------------------------------*38600029
386100                                                                  38610029
386200     COPY DPPD013.                                                38620029
386300     COPY EPPD000.                                                38630029
