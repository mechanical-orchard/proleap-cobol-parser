000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT039.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   APRIL, 2003.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM WILL USE THE COMBINE FILE FROM XLKUT038 AND       00100000
001100*  TPOPRPK, TO CREATE PO DOMAIN TEMPLATES:  XXT_PO_SKU, XXT_      00110000
001200*  PO_PK_SKU, AND XXT_PO_PK_LOC.                                  00120000
001300***************************************************************** 00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT XLKUT038-FILE                                         00190000
002000         ASSIGN TO INP01.                                         00200000
002100                                                                  00210000
002200     SELECT TPOPRPK-FILE                                          00220000
002300         ASSIGN TO INP02.                                         00230000
002400                                                                  00240000
002500     SELECT XL18-OUT-FILE                                         00250000
002600         ASSIGN TO OUT01.                                         00260000
002700                                                                  00270000
002800     SELECT XL21-OUT-FILE                                         00280000
002900         ASSIGN TO OUT02.                                         00290000
003000                                                                  00300000
003100***************************************************************** 00310000
003200 DATA DIVISION.                                                   00320000
003300***************************************************************** 00330000
003400 FILE SECTION.                                                    00340000
003500                                                                  00350000
003600 FD  XLKUT038-FILE                                                00360000
003700     RECORDING MODE IS F                                          00370000
003800     BLOCK CONTAINS 0 RECORDS                                     00380000
003900     LABEL RECORDS ARE STANDARD.                                  00390000
004000                                                                  00400000
004100 01  XLKUT038-RECORD              PIC X(530).                     00410000
004200                                                                  00420000
004300 FD  TPOPRPK-FILE                                                 00430000
004400     RECORDING MODE IS F                                          00440000
004500     BLOCK CONTAINS 0 RECORDS                                     00450000
004600     LABEL RECORDS ARE STANDARD.                                  00460000
004700                                                                  00470000
004800 01  TPOPRPK-RECORD               PIC X(104).                     00480000
004900                                                                  00490000
005000 FD  XL18-OUT-FILE                                                00500000
005100     RECORDING MODE IS F                                          00510000
005200     BLOCK CONTAINS 0 RECORDS                                     00520000
005300     LABEL RECORDS ARE STANDARD.                                  00530000
005400                                                                  00540000
005500 01  XL18-OUT-REC                 PIC X(215).                     00550001
005600                                                                  00560000
005700 FD  XL21-OUT-FILE                                                00570000
005800     RECORDING MODE IS F                                          00580000
005900     BLOCK CONTAINS 0 RECORDS                                     00590000
006000     LABEL RECORDS ARE STANDARD.                                  00600000
006100                                                                  00610000
006200 01  XL21-OUT-REC                 PIC X(121).                     00620000
006300                                                                  00630000
006400***************************************************************** 00640000
006500 WORKING-STORAGE SECTION.                                         00650000
006600                                                                  00660000
006700 01  PS-PROGRAM-SWITCHES.                                         00670000
006800     05  PS-EOF-XLKUT038-SW           PIC X(01)  VALUE 'N'.       00680000
006900         88  PS-EOF-XLKUT038-YES                 VALUE 'Y'.       00690000
007000         88  PS-EOF-XLKUT038-NO                  VALUE 'N'.       00700000
007100     05  PS-EOF-TPOPRPK-SW            PIC X(01)  VALUE 'N'.       00710000
007200         88  PS-EOF-TPOPRPK-YES                  VALUE 'Y'.       00720000
007300         88  PS-EOF-TPOPRPK-NO                   VALUE 'N'.       00730000
007400     05  PS-TPOPRPK-FOUND-SW          PIC X(01)  VALUE 'N'.       00740000
007500         88  PS-TPOPRPK-FOUND                    VALUE 'Y'.       00750000
007600         88  PS-TPOPRPK-NOT-FOUND                VALUE 'N'.       00760000
007700     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       00770000
007800         88  PS-FIRST-TIME                       VALUE 'Y'.       00780000
007900         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       00790000
008000                                                                  00800000
008100 01  PC-PROGRAM-CONSTANTS.                                        00810000
008200     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT039'.00820000
008300                                                                  00830000
008400 01  PV-PROGRAM-VARIABLES.                                        00840000
008500     05  PV-RECS-READ-XLKUT038        PIC  9(09) VALUE  0.        00850000
008600     05  PV-18-RECS-WRITTEN           PIC  9(09) VALUE  0.        00860000
008700     05  PV-21-RECS-WRITTEN           PIC  9(09) VALUE  0.        00870000
008800     05  PV-22-RECS-WRITTEN           PIC  9(09) VALUE  0.        00880000
008900     05  PV-PREV-KEY.                                             00890000
009000         10  PV-PO-NBR-OLD            PIC  9(09) VALUE  0.        00900000
009100         10  PV-PO-LNE-OLD            PIC  9(09) VALUE  0.        00910000
009200     05  PV-CURR-KEY.                                             00920000
009300         10  PV-PO-NBR-CUR            PIC  9(09) VALUE  0.        00930000
009400         10  PV-PO-LNE-CUR            PIC  9(09) VALUE  0.        00940000
009500     05  PV-PKGNG-CDE                 PIC  X(01) VALUE ' '.       00950000
009600     05  PV-PO-PREPK-ID               PIC S9(04) COMP VALUE 0.    00960000
009700     05  PV-PO-TYP-CDE                PIC  X(02) VALUE ' '.       00970000
009800     05  PV-REC-TYP-OLD               PIC  X(01) VALUE ' '.       00980000
009900     05  PV-REC-TYP-CUR               PIC  X(01) VALUE ' '.       00990000
010000                                                                  01000000
010100 01  PV-ABEND-FIELDS.                                             01010000
010200     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT039'.01020000
010300     05  FILLER                       PIC  X(01) VALUE SPACES.    01030000
010400     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    01040000
010500     05  FILLER                       PIC  X(01) VALUE SPACES.    01050000
010600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01060000
010700     05  FILLER                       PIC  X(01) VALUE SPACES.    01070000
010800     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01080000
010900                                                                  01090000
011000 01  RF-REFORMAT-DATE.                                            01100000
011100     05  RF-YEAR                      PIC  X(04) VALUE SPACES.    01110000
011200     05  RF-MONTH                     PIC  X(02) VALUE SPACES.    01120000
011300     05  RF-DAY                       PIC  X(02) VALUE SPACES.    01130000
011400                                                                  01140000
011500 01  OR-ORIGINAL-DATE.                                            01150000
011600     05  OR-YEAR                      PIC  X(04) VALUE SPACES.    01160000
011700     05  FILLER                       PIC  X(01) VALUE SPACES.    01170000
011800     05  OR-MONTH                     PIC  X(02) VALUE SPACES.    01180000
011900     05  FILLER                       PIC  X(01) VALUE SPACES.    01190000
012000     05  OR-DAY                       PIC  X(02) VALUE SPACES.    01200000
012100                                                                  01210000
012200 01  PS-REFORMAT-FIELDS.                                          01220000
012300     05  PS-REFORMAT-CNCLD-QTY        PIC  9(09) VALUE ZEROES.    01230000
012400***********************************************************       01240000
012500*  COPYBOOK USED FOR THE XLKUT038 INPUT FILE              *       01250000
012600***********************************************************       01260000
012700     COPY XLRD029.                                                01270000
012800                                                                  01280000
012900***********************************************************       01290000
013000*  COPYBOOK USED FOR THE TPOPRPK INPUT FILE               *       01300000
013100***********************************************************       01310000
013200     EXEC SQL                                                     01320000
013300         INCLUDE TPOPRPK                                          01330000
013400     END-EXEC.                                                    01340000
013500                                                                  01350000
013600***********************************************************       01360000
013700*  COPYBOOK USED FOR THE XXT_PO_SKU OUTPUT FILE                   01370000
013800***********************************************************       01380000
013900 01  PC-18-OUT-RECORD.                                            01390000
014000     COPY XLRD018.                                                01400000
014100                                                                  01410000
014200***********************************************************       01420000
014300*  COPYBOOK USED FOR THE XXT_PO_PK_SKU OUTPUT FILE                01430000
014400***********************************************************       01440000
014500 01  PC-21-OUT-RECORD.                                            01450000
014600     COPY XLRD021.                                                01460000
014700                                                                  01470000
014800***************************************************************** 01480000
014900 PROCEDURE DIVISION.                                              01490000
015000***************************************************************** 01500000
015100     DISPLAY '**** BEGINNING XLKUT039 ****'.                      01510000
015200     DISPLAY ' '.                                                 01520000
015300                                                                  01530000
015400     OPEN INPUT  XLKUT038-FILE                                    01540000
015500*                TPOPRPK-FILE                                     01550000
015600          OUTPUT XL18-OUT-FILE                                    01560000
015700                 XL21-OUT-FILE.                                   01570000
015800                                                                  01580000
015900     PERFORM 1000-READ-XLKUT038-INPUT-FILE.                       01590000
016000     MOVE XL029-PO-NBR      TO  PV-PO-NBR-OLD                     01600000
016100                                PV-PO-NBR-CUR.                    01610000
016200     MOVE XL029-PO-LNE-NBR  TO  PV-PO-LNE-OLD                     01620000
016300                                PV-PO-LNE-CUR.                    01630000
016400                                                                  01640000
016500     INITIALIZE XL018-DATA-AREA.                                  01650000
016600     INITIALIZE XL021-DATA-AREA.                                  01660000
016700                                                                  01670000
016800     PERFORM 2000-PROCESS-INPUT-FILE                              01680000
016900       UNTIL PS-EOF-XLKUT038-YES.                                 01690000
017000                                                                  01700000
017100     CLOSE XLKUT038-FILE                                          01710000
017200*          TPOPRPK-FILE                                           01720000
017300           XL18-OUT-FILE                                          01730000
017400           XL21-OUT-FILE.                                         01740000
017500                                                                  01750000
017600     DISPLAY '  INPUT XLKUT038 RECS    = ' PV-RECS-READ-XLKUT038. 01760000
017700     DISPLAY '  OUTPUT XLRD018 RECS    = ' PV-18-RECS-WRITTEN.    01770000
017800     DISPLAY '  OUTPUT XLRD021 RECS    = ' PV-21-RECS-WRITTEN.    01780000
017900     DISPLAY '  OUTPUT XLRD022 RECS    = ' PV-22-RECS-WRITTEN.    01790000
018000     DISPLAY ' '.                                                 01800000
018100     DISPLAY '****  END OF  XLKUT039  ****'.                      01810000
018200                                                                  01820000
018300     GOBACK.                                                      01830000
018400                                                                  01840000
018500***************************************************************** 01850000
018600*  READ A XLKUT038 RECORD                                         01860000
018700***************************************************************** 01870000
018800 1000-READ-XLKUT038-INPUT-FILE.                                   01880000
018900                                                                  01890000
019000     MOVE '1000-READ-XLKUT038-INPUT-FILE' TO PV-ABEND-PARAGRAPH.  01900000
019100                                                                  01910000
019200     INITIALIZE XL029-DATA.                                       01920000
019300                                                                  01930000
019400     READ XLKUT038-FILE                                           01940000
019500          INTO XL029-DATA                                         01950000
019600            AT END                                                01960000
019700               SET PS-EOF-XLKUT038-YES TO TRUE                    01970000
019800     END-READ.                                                    01980000
019900                                                                  01990000
020000     IF PS-EOF-XLKUT038-YES                                       02000000
020100         CONTINUE                                                 02010000
020200     ELSE                                                         02020000
020300        ADD +1 TO PV-RECS-READ-XLKUT038                           02030000
020400        MOVE XL029-PO-NBR      TO PV-PO-NBR-CUR                   02040000
020500        MOVE XL029-PO-LNE-NBR  TO PV-PO-LNE-CUR                   02050000
020600        MOVE XL029-RECORD-TYPE TO PV-REC-TYP-CUR                  02060000
020700     END-IF.                                                      02070000
020800                                                                  02080000
020900***************************************************************** 02090000
021000*  PROCESS INPUT FILE                                           * 02100000
021100***************************************************************** 02110000
021200 2000-PROCESS-INPUT-FILE.                                         02120000
021300                                                                  02130000
021400     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       02140000
021500                                                                  02150000
021600     IF PV-CURR-KEY   =  PV-PREV-KEY                              02160000
021700         PERFORM 3000-CHECK-REC-TYPE                              02170000
021800     ELSE                                                         02180000
021900         IF PV-CURR-KEY   >  PV-PREV-KEY                          02190000
022000             PERFORM 4000-CHECK-LINE-NBR                          02200000
022100         END-IF                                                   02210000
022200     END-IF.                                                      02220000
022300                                                                  02230000
022400     MOVE PV-CURR-KEY   TO  PV-PREV-KEY.                          02240000
022500     PERFORM 1000-READ-XLKUT038-INPUT-FILE.                       02250000
022600                                                                  02260000
022700***************************************************************** 02270000
022800*  EVALUATE CUR RECORD TYPE.                                    * 02280000
022900***************************************************************** 02290000
023000 3000-CHECK-REC-TYPE.                                             02300000
023100                                                                  02310000
023200     MOVE '3000-CHECK-REC-TYPE' TO PV-ABEND-PARAGRAPH.            02320000
023300                                                                  02330000
023400     EVALUATE XL029-RECORD-TYPE                                   02340000
023500         WHEN '1'                                                 02350000
023600             INITIALIZE XL018-DATA-AREA                           02360000
023700             INITIALIZE XL021-DATA-AREA                           02370000
023800             MOVE XL029-PURCHS-PO-NBR     TO XL018-PO-NBR         02380000
023900                                             XL021-PO-NBR         02390000
024000             MOVE XL029-PURCHS-PKGNG-CDE  TO PV-PKGNG-CDE         02400000
024100             MOVE XL029-PURCHS-PO-TYP-CDE TO PV-PO-TYP-CDE        02410000
024200             MOVE ' '                     TO PV-REC-TYP-OLD       02420000
024300         WHEN '2'                                                 02430000
024400             MOVE XL029-PURITM-PO-PREPK-ID TO PV-PO-PREPK-ID      02440000
024500             PERFORM 3100-MOVE-TPURITM-INFO                       02450000
024600             MOVE '2'                      TO PV-REC-TYP-OLD      02460000
024700     END-EVALUATE.                                                02470000
024800                                                                  02480000
024900***************************************************************** 02490000
025000*  MOVE TPURITM INFO TO EXTRACT FILE                            * 02500000
025100***************************************************************** 02510000
025200 3100-MOVE-TPURITM-INFO.                                          02520000
025300                                                                  02530000
025400     MOVE '3100-MOVE-TPURITM-INFO ' TO PV-ABEND-PARAGRAPH.        02540000
025500                                                                  02550000
025600     MOVE XL029-PURITM-PO-NBR           TO XL018-PO-NBR.          02560000
025700     MOVE XL029-PURITM-PIC-ITM-IND      TO XL018-PIC-SKU-IND.     02570000
025707     IF XL029-PURITM-AD-EVNT-DTE = '0001-01-01'                   02570700
025708         MOVE SPACES                   TO  XL018-PROMO-STRT-DTE   02570800
025709     ELSE                                                         02570900
025710         MOVE XL029-PURITM-AD-EVNT-DTE TO OR-ORIGINAL-DATE        02571000
025711         MOVE OR-YEAR                  TO RF-YEAR                 02571100
025712         MOVE OR-MONTH                 TO RF-MONTH                02571200
025720         MOVE OR-DAY                   TO RF-DAY                  02572000
025730         MOVE RF-REFORMAT-DATE         TO XL018-PROMO-STRT-DTE    02573000
025740     END-IF.                                                      02574000
025750     IF PV-PO-PREPK-ID > 0                                        02575000
025760         MOVE XL029-PURITM-PO-NBR           TO XL018-PO-NBR       02576000
025770                                               XL021-PO-NBR       02577000
025780         MOVE XL029-PURITM-RMS-PO-SKU-NBR   TO XL021-SKU-NBR      02578000
025790         MOVE 'Y'                           TO XL018-PK-SKU-IND   02579000
025800         MOVE ZEROES                        TO XL018-UNT-COST-AMT 02580000
025900                                               XL018-FRST-COST-AMT02590000
026000         MOVE XL029-PURITM-UNT-COST-AMT     TO XL021-UNT-COST-AMT 02600000
026100         IF PV-PO-TYP-CDE = 'IE' OR 'IF' OR 'IM'                  02610000
026200             MOVE XL029-PURITM-PRD-1ST-COST-AMT TO                02620000
026300                                              XL021-FRST-COST-AMT 02630000
026400         ELSE                                                     02640000
026500             MOVE ZEROES                 TO   XL021-FRST-COST-AMT 02650000
026600         END-IF                                                   02660000
026700         MOVE XL029-PURITM-PREPK-RATO-QTY   TO XL021-RATO-UNT-QTY 02670000
026800         MOVE XL029-PURITM-UNT-RTL-PR-AMT   TO XL021-UNT-RTL-AMT  02680000
026900         IF  XL029-PURITM-GP-QTY  < 2                             02690000
027000             MOVE ZEROES                    TO XL021-GP-RTL-QTY   02700000
027100                                               XL021-GP-RTL-AMT   02710000
027200         ELSE                                                     02720000
027300             MOVE XL029-PURITM-GP-QTY       TO XL021-GP-RTL-QTY   02730000
027400             MOVE XL029-PURITM-GP-RTL-AMT   TO XL021-GP-RTL-AMT   02740000
027500         END-IF                                                   02750000
027600         IF XL029-PURITM-PREPK-RATO-QTY > 0                       02760000
027700            COMPUTE XL018-ORD-QTY = XL029-PURITM-UNT-QTY /        02770000
027800                                 XL029-PURITM-PREPK-RATO-QTY      02780000
027900            COMPUTE XL018-CNCLD-QTY = XL029-PURITM-CNCLD-UNT-QTY /02790000
028000                                 XL029-PURITM-PREPK-RATO-QTY      02800000
028100         ELSE                                                     02810000
028200             MOVE ZEROES  TO XL018-ORD-QTY                        02820000
028300                             XL018-CNCLD-QTY                      02830000
028400         END-IF                                                   02840000
028410**GB 3/20/12                                                      02841003
028420         MOVE XL029-PURITM-INNR-PK-QTY      TO XL021-INPK-QTY     02842003
028430         MOVE XL029-PURITM-OUTR-PK-QTY      TO XL021-OTPK-QTY     02843003
028440**GB 3/20/12                                                      02844003
028500     ELSE                                                         02850000
028600         MOVE XL029-PURITM-PO-NBR           TO XL018-PO-NBR       02860000
028700         MOVE XL029-PURITM-RMS-PO-SKU-NBR   TO XL018-SKU-NBR      02870000
028800         MOVE XL029-PURITM-UNT-COST-AMT     TO XL018-UNT-COST-AMT 02880000
028900         MOVE XL029-PURITM-CNCLD-UNT-QTY    TO XL018-CNCLD-QTY    02890000
029000         IF PV-PO-TYP-CDE = 'IE' OR 'IF' OR 'IM'                  02900000
029100             MOVE XL029-PURITM-PRD-1ST-COST-AMT TO                02910000
029200                                              XL018-FRST-COST-AMT 02920000
029300         ELSE                                                     02930000
029400             MOVE ZEROES                   TO XL018-FRST-COST-AMT 02940000
029500         END-IF                                                   02950000
029600         MOVE XL029-PURITM-UNT-QTY          TO XL018-ORD-QTY      02960000
029700         MOVE XL029-PURITM-UNT-RTL-PR-AMT   TO XL018-UNT-RTL-AMT  02970000
029800         IF XL029-PURITM-GP-QTY < 2                               02980000
029900             MOVE ZEROES                    TO XL018-GP-RTL-QTY   02990000
030000                                               XL018-GP-RTL-AMT   03000000
030100         ELSE                                                     03010000
030200             MOVE XL029-PURITM-GP-QTY       TO XL018-GP-RTL-QTY   03020000
030300             MOVE XL029-PURITM-GP-RTL-AMT   TO XL018-GP-RTL-AMT   03030000
030400         END-IF                                                   03040000
030500         MOVE 'N'                           TO XL018-PK-SKU-IND   03050000
030600         MOVE SPACES                        TO XL018-PK-SKU-DESC  03060000
030602**GB 3/20/12                                                      03060203
030610         MOVE XL029-PURITM-INNR-PK-QTY      TO XL018-INPK-QTY     03061003
030630         MOVE XL029-PURITM-OUTR-PK-QTY      TO XL018-OTPK-QTY     03063003
030640**GB 3/20/12                                                      03064003
030700     END-IF.                                                      03070000
030800     IF PV-PO-PREPK-ID > 0                                        03080000
030900         SET PS-TPOPRPK-NOT-FOUND TO TRUE                         03090000
031000         SET PS-EOF-TPOPRPK-NO    TO TRUE                         03100000
031100         IF XL029-PURITM-PO-NBR NOT = POPRPK-PO-NBR               03110000
031200             OPEN INPUT  TPOPRPK-FILE                             03120000
031300             PERFORM 5000-READ-TPOPRPK-INPUT-FILE                 03130000
031400                                           UNTIL PS-TPOPRPK-FOUND 03140000
031500             CLOSE TPOPRPK-FILE                                   03150000
031600         ELSE                                                     03160000
031700             IF XL029-PURITM-PO-NBR = POPRPK-PO-NBR               03170000
031800                 IF XL029-PURITM-PO-PREPK-ID = POPRPK-PO-PREPK-ID 03180000
031900                      PERFORM 5100-MOVE-TPOPRPK-INFO              03190000
032000                 ELSE                                             03200000
032100                     OPEN INPUT  TPOPRPK-FILE                     03210000
032200                     PERFORM 5000-READ-TPOPRPK-INPUT-FILE         03220000
032300                                           UNTIL PS-TPOPRPK-FOUND 03230000
032400                     CLOSE TPOPRPK-FILE                           03240000
032500                 END-IF                                           03250000
032600             END-IF                                               03260000
032700         END-IF                                                   03270000
032800     END-IF.                                                      03280000
032900     PERFORM 7000-WRITE-OUTPUT.                                   03290000
033000     IF PV-PO-PREPK-ID > 0                                        03300000
033100         PERFORM 7100-WRITE-OUTPUT                                03310000
033200     END-IF.                                                      03320000
033300                                                                  03330000
033400***************************************************************** 03340000
033500*  EVALUATE PREV LINE NUMBER.                                   * 03350000
033600***************************************************************** 03360000
033700 4000-CHECK-LINE-NBR.                                             03370000
033800                                                                  03380000
033900     MOVE '4000-CHECK-LINE-NBR' TO PV-ABEND-PARAGRAPH.            03390000
034000*** THERE USED TO BE MORE LOGIC HERE IS WHY IT LOOKS ODD. 5/2004  03400000
034100     PERFORM 3000-CHECK-REC-TYPE.                                 03410000
034200                                                                  03420000
034300***************************************************************** 03430000
034400*  READ A TPOPRPK RECORD                                          03440000
034500***************************************************************** 03450000
034600 5000-READ-TPOPRPK-INPUT-FILE.                                    03460000
034700                                                                  03470000
034800     MOVE '5000-READ-TPOPRPK-INPUT-FILE' TO PV-ABEND-PARAGRAPH.   03480000
034900                                                                  03490000
035000     IF PS-EOF-TPOPRPK-YES                                        03500000
035100         SET PS-TPOPRPK-FOUND TO TRUE                             03510000
035200     ELSE                                                         03520000
035300         INITIALIZE DCLTPOPRPK                                    03530000
035400         READ TPOPRPK-FILE                                        03540000
035500              INTO DCLTPOPRPK                                     03550000
035600                AT END                                            03560000
035700                   SET PS-EOF-TPOPRPK-YES TO TRUE                 03570000
035800         END-READ                                                 03580000
035900         IF XL029-PURITM-PO-NBR = POPRPK-PO-NBR                   03590000
036000             IF XL029-PURITM-PO-PREPK-ID = POPRPK-PO-PREPK-ID     03600000
036100                 PERFORM 5100-MOVE-TPOPRPK-INFO                   03610000
036200                 SET PS-TPOPRPK-FOUND TO TRUE                     03620000
036300             END-IF                                               03630000
036400         ELSE                                                     03640000
036500             IF PS-EOF-TPOPRPK-YES                                03650000
036600                 SET PS-TPOPRPK-FOUND TO TRUE                     03660000
036700             END-IF                                               03670000
036800         END-IF                                                   03680000
036900     END-IF.                                                      03690000
037000                                                                  03700000
037100***************************************************************** 03710000
037200*  MOVE TPOPRPK INFO TO EXTRACT FILE                            * 03720000
037300***************************************************************** 03730000
037400 5100-MOVE-TPOPRPK-INFO.                                          03740000
037500                                                                  03750000
037600     MOVE '5100-MOVE-TPOPRPK-INFO ' TO PV-ABEND-PARAGRAPH.        03760000
037700                                                                  03770000
037800     MOVE POPRPK-PO-NBR   TO  XL018-PO-NBR.                       03780000
037900     IF PV-PO-PREPK-ID > 0                                        03790000
038000         MOVE POPRPK-PO-NBR        TO  XL021-PO-NBR               03800000
038100         MOVE POPRPK-PK-SKU-NBR    TO  XL018-SKU-NBR              03810000
038200                                       XL021-PK-SKU-NBR           03820000
038300         IF POPRPK-PREPK-DESC(1:3) = '   '                        03830000
038400             MOVE POPRPK-PREPK-DESC(4:37) TO  XL018-PK-SKU-DESC   03840000
038500         END-IF                                                   03850000
038600         IF POPRPK-PREPK-DESC(1:2) = '  '                         03860000
038700             MOVE POPRPK-PREPK-DESC(3:38) TO  XL018-PK-SKU-DESC   03870000
038800         END-IF                                                   03880000
038900         IF POPRPK-PREPK-DESC(1:1) = '  '                         03890000
039000             MOVE POPRPK-PREPK-DESC(2:39) TO  XL018-PK-SKU-DESC   03900000
039100         ELSE                                                     03910000
039200             MOVE POPRPK-PREPK-DESC       TO  XL018-PK-SKU-DESC   03920000
039300         END-IF                                                   03930000
039400     END-IF.                                                      03940000
039500                                                                  03950000
039600***************************************************************** 03960000
039700*  WRITE A RECORDS TO THE LOGISTICS SKU OUTPUT FILE             * 03970000
039800***************************************************************** 03980000
039900 7000-WRITE-OUTPUT.                                               03990000
040000                                                                  04000000
040100     WRITE XL18-OUT-REC  FROM                                     04010000
040200         XL018-RECORD                                             04020000
040300     END-WRITE.                                                   04030000
040400     ADD +1            TO PV-18-RECS-WRITTEN.                     04040000
040500     INITIALIZE XL018-DATA-AREA.                                  04050000
040600                                                                  04060000
040700***************************************************************** 04070000
040800*  WRITE RECORDS TO THE LOGISTICS SKU OUTPUT FILE                 04080000
040900***************************************************************** 04090000
041000 7100-WRITE-OUTPUT.                                               04100000
041100                                                                  04110000
041200     WRITE XL21-OUT-REC  FROM                                     04120000
041300         XL021-RECORD                                             04130000
041400     END-WRITE.                                                   04140000
041500     ADD +1            TO PV-21-RECS-WRITTEN.                     04150000
041600     INITIALIZE XL021-DATA-AREA.                                  04160000
041700                                                                  04170000
041800                                                                  04180000
