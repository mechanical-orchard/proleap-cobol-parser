000100*************************                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*************************                                         00030001
000400 PROGRAM-ID.    DPKUT052.                                         00040001
000500 AUTHOR.        MIKE FURLICK.                                     00050001
000600 DATE-WRITTEN.  MAY 1991.                                         00060001
000700                                                                  00070001
001200*                                                                 00120001
001300*    THIS PROGRAM IS A SUBROUTINE THAT CONVERTS EBCDIC CHARACTER  00130001
001400*    DATA INTO ASCII OR VICE VERSA.                               00140001
001500*                                                                 00150001
001600*    THERE ARE 5 PARAMETERS REQUIRED FOR THIS SUBROUTINE.         00160001
001700*                                                                 00170001
001800*    PARM 1 = CONVERSION TYPE - 1 BYTE CHARACTER,                 00180001
001900*                      VALUES:  1 = EBCDIC TO ASCII               00190001
002000*                               2 = ASCII TO EBCDIC               00200001
002100*                                                                 00210001
002200*    PARM 2 = LENGTH OF FIELD TO BE CONVERTED - 2 BYTES PACKED.   00220001
002300*                                                                 00230001
002400*    PARM 3 = INPUT FIELD TO BE CONVERTED.                        00240001
002500*                                                                 00250001
002600*    PARM 4 = OUTPUT FIELD WHERE CONVERTED DATA IS RETURNED.      00260001
002700*                                                                 00270001
002800*    PARM 5 = RETURN CODE - 2 BYTES CHARACTER.                    00280001
002900*             VALUES:  00 - SUCCESSFUL COMPLETION.                00290001
003000*             VALUES:  04 - PARAMETER LENGTH NOT NUMERIC OR       00300001
003100*                           OUT OF RANGE.                         00310001
003200*             VALUES:  08 - CONVERSION TYPE NOT '1' OR '2'.       00320001
003300*             VALUES:  12 - CHARACTER NOT FOUND FOR CONVERSION OR 00330001
003400*                           ASCII CHARACTER GREATER THAN 127.     00340001
000200*                                                                 00341013
000200*  USE COPYBOOK DPWS053 FOR THE PARAMETER LIST TO USE BY A        00341113
000200*  CALLING PROGRAM.                                               00341213
000520*                                                                 00342013
000600*  USE "DP053-EBCDIC-ASCII-ROUTINE" AS THE VARIABLE FOR THE       00343013
000700*  SUBROUTINE NAME FOR ALL DYNAMIC CALLS.                         00344013
000701*                                                                 00345013
000702*  CALL DP053-EBCDIC-ASCII-ROUTINE USING DP053-CONVERSION-TYPE    00346013
000703*                                        DP053-FIELD-LENGTH       00347013
000705*                                        DP053-INPUT-FIELD        00348013
000706*                                        DP053-OUTPUT-FIELD       00349013
000707*                                        DP053-RETURN-CODE.       00349113
003500*                                                                 00350001
003600 ENVIRONMENT DIVISION.                                            00360001
003700 CONFIGURATION SECTION.                                           00370001
003800 SOURCE-COMPUTER. IBM-3090.                                       00380001
003900 OBJECT-COMPUTER. IBM-3090.                                       00390001
004000*                                                                 00400001
004100 INPUT-OUTPUT SECTION.                                            00410001
004200 FILE-CONTROL.                                                    00420001
004300 DATA DIVISION.                                                   00430001
004400 FILE SECTION.                                                    00440001
004500 EJECT                                                            00450001
004600 WORKING-STORAGE SECTION.                                         00460001
004710                                                                  00471004
004720*                                                                 00472004
004730*  PARAMETER LIST FOR CALLING THE EBCDIC-ASCII CONVERSION ROUTINE 00473004
004750*                                                                 00475004
004760                                                                  00476004
004770     COPY DPWS053.                                                00477004
004780                                                                  00478004
004790 01  PV-PROGRAM-VARIABLES.                                        00479004
004791     05  PV-INPUT-FIELD          PIC X(50) VALUE SPACES.          00479104
004792     05  FILLER                  REDEFINES PV-INPUT-FIELD.        00479204
004793         10  PV-INPUT-BYTE       OCCURS 50 TIMES                  00479306
004795                                 PIC X(1).                        00479504
004796     05  PV-OUTPUT-FIELD         PIC X(50) VALUE SPACES.          00479604
004797     05  FILLER                  REDEFINES PV-OUTPUT-FIELD.       00479704
004798         10  PV-OUTPUT-BYTE      OCCURS 50 TIMES                  00479806
004799                                 PIC X(1).                        00479904
005010     05  PV-SUB2                 PIC S9(4)    VALUE ZEROS         00501005
005020                                              COMP.               00502005
005030     05  PV-SUB                  PIC S9(4)    VALUE ZEROS         00503005
005040                                              COMP.               00504005
005300     05  FILLER                  REDEFINES PV-SUB.                00530005
005400         10  PV-SUB-LV           PIC X(1).                        00540005
005500         10  PV-SUB-CHAR         PIC X(1).                        00550005
005600*                                                                 00560001
005700*    THIS TABLE IS ACCESSED FOR EBCDIC TO ASCII CONVERSIONS.      00570001
005800*    THE EBCDIC BYTE BEING PROCESSED IS THE SUBSCRIPT INTO THE    00580001
005900*    TABLE.  THE ENTRY IN THE TABLE IS THE ASCII EQUIVALENT.      00590001
006000*    IN OTHER WORDS, AT DISPLACEMENT X'40' (THE EBCDIC SPACE) THE 00600001
006100*    TABLE WILL HAVE A X'20' (THE ASCII SPACE).                   00610001
006200*                                                                 00620001
006300 01  EBCDIC-TO-ASCII-TABLE.                                       00630001
006400     05  ASCII-00              PIC S9(4) VALUE 00                 00640001
006500                                         COMP.                    00650001
006600     05  ASCII-01              PIC S9(4) VALUE 32                 00660001
006700                                         COMP.                    00670001
006800     05  ASCII-02              PIC S9(4) VALUE 32                 00680001
006900                                         COMP.                    00690001
007000     05  ASCII-03              PIC S9(4) VALUE 32                 00700001
007100                                         COMP.                    00710001
007200     05  ASCII-04              PIC S9(4) VALUE 32                 00720001
007300                                         COMP.                    00730001
007400     05  ASCII-05              PIC S9(4) VALUE 32                 00740001
007500                                         COMP.                    00750001
007600     05  ASCII-06              PIC S9(4) VALUE 32                 00760001
007700                                         COMP.                    00770001
007800     05  ASCII-07              PIC S9(4) VALUE 32                 00780001
007900                                         COMP.                    00790001
008000     05  ASCII-08              PIC S9(4) VALUE 32                 00800001
008100                                         COMP.                    00810001
008200     05  ASCII-09              PIC S9(4) VALUE 32                 00820001
008300                                         COMP.                    00830001
008400     05  ASCII-10              PIC S9(4) VALUE 32                 00840001
008500                                         COMP.                    00850001
008600     05  ASCII-11              PIC S9(4) VALUE 32                 00860001
008700                                         COMP.                    00870001
008800     05  ASCII-12              PIC S9(4) VALUE 32                 00880001
008900                                         COMP.                    00890001
009000     05  ASCII-13              PIC S9(4) VALUE 32                 00900001
009100                                         COMP.                    00910001
009200     05  ASCII-14              PIC S9(4) VALUE 32                 00920001
009300                                         COMP.                    00930001
009400     05  ASCII-15              PIC S9(4) VALUE 32                 00940001
009500                                         COMP.                    00950001
009600     05  ASCII-16              PIC S9(4) VALUE 32                 00960001
009700                                         COMP.                    00970001
009800     05  ASCII-17              PIC S9(4) VALUE 32                 00980001
009900                                         COMP.                    00990001
010000     05  ASCII-18              PIC S9(4) VALUE 32                 01000001
010100                                         COMP.                    01010001
010200     05  ASCII-19              PIC S9(4) VALUE 32                 01020001
010300                                         COMP.                    01030001
010400     05  ASCII-20              PIC S9(4) VALUE 32                 01040001
010500                                         COMP.                    01050001
010600     05  ASCII-21              PIC S9(4) VALUE 32                 01060001
010700                                         COMP.                    01070001
010800     05  ASCII-22              PIC S9(4) VALUE 32                 01080001
010900                                         COMP.                    01090001
011000     05  ASCII-23              PIC S9(4) VALUE 32                 01100001
011100                                         COMP.                    01110001
011200     05  ASCII-24              PIC S9(4) VALUE 32                 01120001
011300                                         COMP.                    01130001
011400     05  ASCII-25              PIC S9(4) VALUE 32                 01140001
011500                                         COMP.                    01150001
011600     05  ASCII-26              PIC S9(4) VALUE 32                 01160001
011700                                         COMP.                    01170001
011800     05  ASCII-27              PIC S9(4) VALUE 32                 01180001
011900                                         COMP.                    01190001
012000     05  ASCII-28              PIC S9(4) VALUE 32                 01200001
012100                                         COMP.                    01210001
012200     05  ASCII-29              PIC S9(4) VALUE 32                 01220001
012300                                         COMP.                    01230001
012400     05  ASCII-30              PIC S9(4) VALUE 32                 01240001
012500                                         COMP.                    01250001
012600     05  ASCII-31              PIC S9(4) VALUE 32                 01260001
012700                                         COMP.                    01270001
012800     05  ASCII-32              PIC S9(4) VALUE 32                 01280001
012900                                         COMP.                    01290001
013000     05  ASCII-33              PIC S9(4) VALUE 32                 01300001
013100                                         COMP.                    01310001
013200     05  ASCII-34              PIC S9(4) VALUE 32                 01320001
013300                                         COMP.                    01330001
013400     05  ASCII-35              PIC S9(4) VALUE 32                 01340001
013500                                         COMP.                    01350001
013600     05  ASCII-36              PIC S9(4) VALUE 32                 01360001
013700                                         COMP.                    01370001
013800     05  ASCII-37              PIC S9(4) VALUE 32                 01380001
013900                                         COMP.                    01390001
014000     05  ASCII-38              PIC S9(4) VALUE 32                 01400001
014100                                         COMP.                    01410001
014200     05  ASCII-39              PIC S9(4) VALUE 32                 01420001
014300                                         COMP.                    01430001
014400     05  ASCII-40              PIC S9(4) VALUE 32                 01440001
014500                                         COMP.                    01450001
014600     05  ASCII-41              PIC S9(4) VALUE 32                 01460001
014700                                         COMP.                    01470001
014800     05  ASCII-42              PIC S9(4) VALUE 32                 01480001
014900                                         COMP.                    01490001
015000     05  ASCII-43              PIC S9(4) VALUE 32                 01500001
015100                                         COMP.                    01510001
015200     05  ASCII-44              PIC S9(4) VALUE 32                 01520001
015300                                         COMP.                    01530001
015400     05  ASCII-45              PIC S9(4) VALUE 32                 01540001
015500                                         COMP.                    01550001
015600     05  ASCII-46              PIC S9(4) VALUE 32                 01560001
015700                                         COMP.                    01570001
015800     05  ASCII-47              PIC S9(4) VALUE 32                 01580001
015900                                         COMP.                    01590001
016000     05  ASCII-48              PIC S9(4) VALUE 32                 01600001
016100                                         COMP.                    01610001
016200     05  ASCII-49              PIC S9(4) VALUE 32                 01620001
016300                                         COMP.                    01630001
016400     05  ASCII-50              PIC S9(4) VALUE 32                 01640001
016500                                         COMP.                    01650001
016600     05  ASCII-51              PIC S9(4) VALUE 32                 01660001
016700                                         COMP.                    01670001
016800     05  ASCII-52              PIC S9(4) VALUE 32                 01680001
016900                                         COMP.                    01690001
017000     05  ASCII-53              PIC S9(4) VALUE 32                 01700001
017100                                         COMP.                    01710001
017200     05  ASCII-54              PIC S9(4) VALUE 32                 01720001
017300                                         COMP.                    01730001
017400     05  ASCII-55              PIC S9(4) VALUE 32                 01740001
017500                                         COMP.                    01750001
017600     05  ASCII-56              PIC S9(4) VALUE 32                 01760001
017700                                         COMP.                    01770001
017800     05  ASCII-57              PIC S9(4) VALUE 32                 01780001
017900                                         COMP.                    01790001
018000     05  ASCII-58              PIC S9(4) VALUE 32                 01800001
018100                                         COMP.                    01810001
018200     05  ASCII-59              PIC S9(4) VALUE 32                 01820001
018300                                         COMP.                    01830001
018400     05  ASCII-60              PIC S9(4) VALUE 32                 01840001
018500                                         COMP.                    01850001
018600     05  ASCII-61              PIC S9(4) VALUE 32                 01860001
018700                                         COMP.                    01870001
018800     05  ASCII-62              PIC S9(4) VALUE 32                 01880001
018900                                         COMP.                    01890001
019000     05  ASCII-63              PIC S9(4) VALUE 32                 01900001
019100                                         COMP.                    01910001
019200     05  ASCII-64-SPACE        PIC S9(4) VALUE 32                 01920001
019300                                         COMP.                    01930001
019400     05  ASCII-65              PIC S9(4) VALUE 32                 01940001
019500                                         COMP.                    01950001
019600     05  ASCII-66              PIC S9(4) VALUE 32                 01960001
019700                                         COMP.                    01970001
019800     05  ASCII-67              PIC S9(4) VALUE 32                 01980001
019900                                         COMP.                    01990001
020000     05  ASCII-68              PIC S9(4) VALUE 32                 02000001
020100                                         COMP.                    02010001
020200     05  ASCII-69              PIC S9(4) VALUE 32                 02020001
020300                                         COMP.                    02030001
020400     05  ASCII-70              PIC S9(4) VALUE 32                 02040001
020500                                         COMP.                    02050001
020600     05  ASCII-71              PIC S9(4) VALUE 32                 02060001
020700                                         COMP.                    02070001
020800     05  ASCII-72              PIC S9(4) VALUE 32                 02080001
020900                                         COMP.                    02090001
021000     05  ASCII-73              PIC S9(4) VALUE 32                 02100001
021100                                         COMP.                    02110001
021200     05  ASCII-74-CENT-SIGN    PIC S9(4) VALUE 32                 02120001
021300                                         COMP.                    02130001
021400     05  ASCII-75-PERIOD       PIC S9(4) VALUE 46                 02140001
021500                                         COMP.                    02150001
021600     05  ASCII-76-LESSTHAN     PIC S9(4) VALUE 60                 02160001
021700                                         COMP.                    02170001
021800     05  ASCII-77-LEFT-PAREN   PIC S9(4) VALUE 40                 02180001
021900                                         COMP.                    02190001
022000     05  ASCII-78-PLUS-SIGN    PIC S9(4) VALUE 43                 02200001
022100                                         COMP.                    02210001
022200     05  ASCII-79-VERTICLE-BAR PIC S9(4) VALUE 124                02220001
022300                                         COMP.                    02230001
022400     05  ASCII-80-AMPERSAND    PIC S9(4) VALUE 38                 02240001
022500                                         COMP.                    02250001
022600     05  ASCII-81              PIC S9(4) VALUE 32                 02260001
022700                                         COMP.                    02270001
022800     05  ASCII-82              PIC S9(4) VALUE 32                 02280001
022900                                         COMP.                    02290001
023000     05  ASCII-83              PIC S9(4) VALUE 32                 02300001
023100                                         COMP.                    02310001
023200     05  ASCII-84              PIC S9(4) VALUE 32                 02320001
023300                                         COMP.                    02330001
023400     05  ASCII-85              PIC S9(4) VALUE 32                 02340001
023500                                         COMP.                    02350001
023600     05  ASCII-86              PIC S9(4) VALUE 32                 02360001
023700                                         COMP.                    02370001
023800     05  ASCII-87              PIC S9(4) VALUE 32                 02380001
023900                                         COMP.                    02390001
024000     05  ASCII-88              PIC S9(4) VALUE 32                 02400001
024100                                         COMP.                    02410001
024200     05  ASCII-89              PIC S9(4) VALUE 32                 02420001
024300                                         COMP.                    02430001
024400     05  ASCII-90-EXCLAMATION  PIC S9(4) VALUE 33                 02440001
024500                                         COMP.                    02450001
024600     05  ASCII-91-DOLLAR-SIGN  PIC S9(4) VALUE 36                 02460001
024700                                         COMP.                    02470001
024800     05  ASCII-92-ASTERISK     PIC S9(4) VALUE 42                 02480001
024900                                         COMP.                    02490001
025000     05  ASCII-93-RIGHT-PAREN  PIC S9(4) VALUE 41                 02500001
025100                                         COMP.                    02510001
025200     05  ASCII-94-SEMI-COLON   PIC S9(4) VALUE 59                 02520001
025300                                         COMP.                    02530001
025400     05  ASCII-95-NOT-SIGN     PIC S9(4) VALUE 32                 02540001
025500                                         COMP.                    02550001
025600     05  ASCII-96-DASH         PIC S9(4) VALUE 45                 02560001
025700                                         COMP.                    02570001
025800     05  ASCII-97-SLASH        PIC S9(4) VALUE 47                 02580001
025900                                         COMP.                    02590001
026000     05  ASCII-98              PIC S9(4) VALUE 32                 02600001
026100                                         COMP.                    02610001
026200     05  ASCII-99              PIC S9(4) VALUE 32                 02620001
026300                                         COMP.                    02630001
026400     05  ASCII-100             PIC S9(4) VALUE 32                 02640001
026500                                         COMP.                    02650001
026600     05  ASCII-101             PIC S9(4) VALUE 32                 02660001
026700                                         COMP.                    02670001
026800     05  ASCII-102             PIC S9(4) VALUE 32                 02680001
026900                                         COMP.                    02690001
027000     05  ASCII-103             PIC S9(4) VALUE 32                 02700001
027100                                         COMP.                    02710001
027200     05  ASCII-104             PIC S9(4) VALUE 32                 02720001
027300                                         COMP.                    02730001
027400     05  ASCII-105             PIC S9(4) VALUE 32                 02740001
027500                                         COMP.                    02750001
027600     05  ASCII-106-DBL-VERTBAR PIC S9(4) VALUE 124                02760001
027700                                         COMP.                    02770001
027800     05  ASCII-107-COMMA       PIC S9(4) VALUE 44                 02780001
027900                                         COMP.                    02790001
028000     05  ASCII-108-PCT-SIGN    PIC S9(4) VALUE 37                 02800001
028100                                         COMP.                    02810001
028200     05  ASCII-109-UNDERSCORE  PIC S9(4) VALUE 95                 02820001
028300                                         COMP.                    02830001
028400     05  ASCII-110-GREATER-THN PIC S9(4) VALUE 62                 02840001
028500                                         COMP.                    02850001
028600     05  ASCII-111-QUESTION-MK PIC S9(4) VALUE 63                 02860001
028700                                         COMP.                    02870001
028800     05  ASCII-112             PIC S9(4) VALUE 32                 02880001
028900                                         COMP.                    02890001
029000     05  ASCII-113             PIC S9(4) VALUE 32                 02900001
029100                                         COMP.                    02910001
029200     05  ASCII-114             PIC S9(4) VALUE 32                 02920001
029300                                         COMP.                    02930001
029400     05  ASCII-115             PIC S9(4) VALUE 32                 02940001
029500                                         COMP.                    02950001
029600     05  ASCII-116             PIC S9(4) VALUE 32                 02960001
029700                                         COMP.                    02970001
029800     05  ASCII-117             PIC S9(4) VALUE 32                 02980001
029900                                         COMP.                    02990001
030000     05  ASCII-118             PIC S9(4) VALUE 32                 03000001
030100                                         COMP.                    03010001
030200     05  ASCII-119             PIC S9(4) VALUE 32                 03020001
030300                                         COMP.                    03030001
030400     05  ASCII-120             PIC S9(4) VALUE 32                 03040001
030500                                         COMP.                    03050001
030600     05  ASCII-121-BKWRD-APOST PIC S9(4) VALUE 96                 03060001
030700                                         COMP.                    03070001
030800     05  ASCII-122-COLON       PIC S9(4) VALUE 58                 03080001
030900                                         COMP.                    03090001
031000     05  ASCII-123-POUND-SIGN  PIC S9(4) VALUE 35                 03100001
031100                                         COMP.                    03110001
031200     05  ASCII-124-AT-SIGN     PIC S9(4) VALUE 64                 03120001
031300                                         COMP.                    03130001
031400     05  ASCII-125-APOSTROPHE  PIC S9(4) VALUE 39                 03140001
031500                                         COMP.                    03150001
031600     05  ASCII-126-EQUAL-SIGN  PIC S9(4) VALUE 61                 03160001
031700                                         COMP.                    03170001
031800     05  ASCII-127-DBL-QUOTE   PIC S9(4) VALUE 34                 03180001
031900                                         COMP.                    03190001
032000     05  ASCII-128             PIC S9(4) VALUE 32                 03200001
032100                                         COMP.                    03210001
032200     05  ASCII-129-SMALL-A     PIC S9(4) VALUE 97                 03220001
032300                                         COMP.                    03230001
032400     05  ASCII-130-SMALL-B     PIC S9(4) VALUE 98                 03240001
032500                                         COMP.                    03250001
032600     05  ASCII-131-SMALL-C     PIC S9(4) VALUE 99                 03260001
032700                                         COMP.                    03270001
032800     05  ASCII-132-SMALL-D     PIC S9(4) VALUE 100                03280001
032900                                         COMP.                    03290001
033000     05  ASCII-133-SMALL-E     PIC S9(4) VALUE 101                03300001
033100                                         COMP.                    03310001
033200     05  ASCII-134-SMALL-F     PIC S9(4) VALUE 102                03320001
033300                                         COMP.                    03330001
033400     05  ASCII-135-SMALL-G     PIC S9(4) VALUE 103                03340001
033500                                         COMP.                    03350001
033600     05  ASCII-136-SMALL-H     PIC S9(4) VALUE 104                03360001
033700                                         COMP.                    03370001
033800     05  ASCII-137-SMALL-I     PIC S9(4) VALUE 105                03380001
033900                                         COMP.                    03390001
034000     05  ASCII-138             PIC S9(4) VALUE 32                 03400001
034100                                         COMP.                    03410001
034200     05  ASCII-139             PIC S9(4) VALUE 32                 03420001
034300                                         COMP.                    03430001
034400     05  ASCII-140             PIC S9(4) VALUE 32                 03440001
034500                                         COMP.                    03450001
034600     05  ASCII-141             PIC S9(4) VALUE 32                 03460001
034700                                         COMP.                    03470001
034800     05  ASCII-142             PIC S9(4) VALUE 32                 03480001
034900                                         COMP.                    03490001
035000     05  ASCII-143             PIC S9(4) VALUE 32                 03500001
035100                                         COMP.                    03510001
035200     05  ASCII-144             PIC S9(4) VALUE 32                 03520001
035300                                         COMP.                    03530001
035400     05  ASCII-145-SMALL-J     PIC S9(4) VALUE 106                03540001
035500                                         COMP.                    03550001
035600     05  ASCII-146-SMALL-K     PIC S9(4) VALUE 107                03560001
035700                                         COMP.                    03570001
035800     05  ASCII-147-SMALL-L     PIC S9(4) VALUE 108                03580001
035900                                         COMP.                    03590001
036000     05  ASCII-148-SMALL-M     PIC S9(4) VALUE 109                03600001
036100                                         COMP.                    03610001
036200     05  ASCII-149-SMALL-N     PIC S9(4) VALUE 110                03620001
036300                                         COMP.                    03630001
036400     05  ASCII-150-SMALL-O     PIC S9(4) VALUE 111                03640001
036500                                         COMP.                    03650001
036600     05  ASCII-151-SMALL-P     PIC S9(4) VALUE 112                03660001
036700                                         COMP.                    03670001
036800     05  ASCII-152-SMALL-Q     PIC S9(4) VALUE 113                03680001
036900                                         COMP.                    03690001
037000     05  ASCII-153-SMALL-R     PIC S9(4) VALUE 114                03700001
037100                                         COMP.                    03710001
037200     05  ASCII-154             PIC S9(4) VALUE 32                 03720001
037300                                         COMP.                    03730001
037400     05  ASCII-155             PIC S9(4) VALUE 32                 03740001
037500                                         COMP.                    03750001
037600     05  ASCII-156             PIC S9(4) VALUE 32                 03760001
037700                                         COMP.                    03770001
037800     05  ASCII-157             PIC S9(4) VALUE 32                 03780001
037900                                         COMP.                    03790001
038000     05  ASCII-158             PIC S9(4) VALUE 32                 03800001
038100                                         COMP.                    03810001
038200     05  ASCII-159             PIC S9(4) VALUE 32                 03820001
038300                                         COMP.                    03830001
038400     05  ASCII-160             PIC S9(4) VALUE 32                 03840001
038500                                         COMP.                    03850001
038600     05  ASCII-161-TILDE       PIC S9(4) VALUE 126                03860001
038700                                         COMP.                    03870001
038800     05  ASCII-162-SMALL-S     PIC S9(4) VALUE 115                03880001
038900                                         COMP.                    03890001
039000     05  ASCII-163-SMALL-T     PIC S9(4) VALUE 116                03900001
039100                                         COMP.                    03910001
039200     05  ASCII-164-SMALL-U     PIC S9(4) VALUE 117                03920001
039300                                         COMP.                    03930001
039400     05  ASCII-165-SMALL-V     PIC S9(4) VALUE 118                03940001
039500                                         COMP.                    03950001
039600     05  ASCII-166-SMALL-W     PIC S9(4) VALUE 119                03960001
039700                                         COMP.                    03970001
039800     05  ASCII-167-SMALL-X     PIC S9(4) VALUE 120                03980001
039900                                         COMP.                    03990001
040000     05  ASCII-168-SMALL-Y     PIC S9(4) VALUE 121                04000001
040100                                         COMP.                    04010001
040200     05  ASCII-169-SMALL-Z     PIC S9(4) VALUE 122                04020001
040300                                         COMP.                    04030001
040400     05  ASCII-170             PIC S9(4) VALUE 32                 04040001
040500                                         COMP.                    04050001
040600     05  ASCII-171             PIC S9(4) VALUE 32                 04060001
040700                                         COMP.                    04070001
040800     05  ASCII-172             PIC S9(4) VALUE 32                 04080001
040900                                         COMP.                    04090001
041000     05  ASCII-173             PIC S9(4) VALUE 32                 04100001
041100                                         COMP.                    04110001
041200     05  ASCII-174             PIC S9(4) VALUE 32                 04120001
041300                                         COMP.                    04130001
041400     05  ASCII-175             PIC S9(4) VALUE 32                 04140001
041500                                         COMP.                    04150001
041600     05  ASCII-176             PIC S9(4) VALUE 32                 04160001
041700                                         COMP.                    04170001
041800     05  ASCII-177             PIC S9(4) VALUE 32                 04180001
041900                                         COMP.                    04190001
042000     05  ASCII-178             PIC S9(4) VALUE 32                 04200001
042100                                         COMP.                    04210001
042200     05  ASCII-179             PIC S9(4) VALUE 32                 04220001
042300                                         COMP.                    04230001
042400     05  ASCII-180             PIC S9(4) VALUE 32                 04240001
042500                                         COMP.                    04250001
042600     05  ASCII-181             PIC S9(4) VALUE 32                 04260001
042700                                         COMP.                    04270001
042800     05  ASCII-182             PIC S9(4) VALUE 32                 04280001
042900                                         COMP.                    04290001
043000     05  ASCII-183             PIC S9(4) VALUE 32                 04300001
043100                                         COMP.                    04310001
043200     05  ASCII-184             PIC S9(4) VALUE 32                 04320001
043300                                         COMP.                    04330001
043400     05  ASCII-185             PIC S9(4) VALUE 32                 04340001
043500                                         COMP.                    04350001
043600     05  ASCII-186             PIC S9(4) VALUE 32                 04360001
043700                                         COMP.                    04370001
043800     05  ASCII-187             PIC S9(4) VALUE 32                 04380001
043900                                         COMP.                    04390001
044000     05  ASCII-188             PIC S9(4) VALUE 32                 04400001
044100                                         COMP.                    04410001
044200     05  ASCII-189             PIC S9(4) VALUE 32                 04420001
044300                                         COMP.                    04430001
044400     05  ASCII-190             PIC S9(4) VALUE 32                 04440001
044500                                         COMP.                    04450001
044600     05  ASCII-191             PIC S9(4) VALUE 32                 04460001
044700                                         COMP.                    04470001
044800     05  ASCII-192-LEFT-BRACE  PIC S9(4) VALUE 123                04480001
044900                                         COMP.                    04490001
045000     05  ASCII-193-CAPITAL-A   PIC S9(4) VALUE 65                 04500001
045100                                         COMP.                    04510001
045200     05  ASCII-194-CAPITAL-B   PIC S9(4) VALUE 66                 04520001
045300                                         COMP.                    04530001
045400     05  ASCII-195-CAPITAL-C   PIC S9(4) VALUE 67                 04540001
045500                                         COMP.                    04550001
045600     05  ASCII-196-CAPITAL-D   PIC S9(4) VALUE 68                 04560001
045700                                         COMP.                    04570001
045800     05  ASCII-197-CAPITAL-E   PIC S9(4) VALUE 69                 04580001
045900                                         COMP.                    04590001
046000     05  ASCII-198-CAPITAL-F   PIC S9(4) VALUE 70                 04600001
046100                                         COMP.                    04610001
046200     05  ASCII-199-CAPITAL-G   PIC S9(4) VALUE 71                 04620001
046300                                         COMP.                    04630001
046400     05  ASCII-200-CAPITAL-H   PIC S9(4) VALUE 72                 04640001
046500                                         COMP.                    04650001
046600     05  ASCII-201-CAPITAL-I   PIC S9(4) VALUE 73                 04660001
046700                                         COMP.                    04670001
046800     05  ASCII-202             PIC S9(4) VALUE 32                 04680001
046900                                         COMP.                    04690001
047000     05  ASCII-203             PIC S9(4) VALUE 32                 04700001
047100                                         COMP.                    04710001
047200     05  ASCII-204             PIC S9(4) VALUE 32                 04720001
047300                                         COMP.                    04730001
047400     05  ASCII-205             PIC S9(4) VALUE 32                 04740001
047500                                         COMP.                    04750001
047600     05  ASCII-206             PIC S9(4) VALUE 32                 04760001
047700                                         COMP.                    04770001
047800     05  ASCII-207             PIC S9(4) VALUE 32                 04780001
047900                                         COMP.                    04790001
048000     05  ASCII-208-RIGHT-BRACE PIC S9(4) VALUE 125                04800001
048100                                         COMP.                    04810001
048200     05  ASCII-209-CAPITAL-J   PIC S9(4) VALUE 74                 04820001
048300                                         COMP.                    04830001
048400     05  ASCII-210-CAPITAL-K   PIC S9(4) VALUE 75                 04840001
048500                                         COMP.                    04850001
048600     05  ASCII-211-CAPITAL-L   PIC S9(4) VALUE 76                 04860001
048700                                         COMP.                    04870001
048800     05  ASCII-212-CAPITAL-M   PIC S9(4) VALUE 77                 04880001
048900                                         COMP.                    04890001
049000     05  ASCII-213-CAPITAL-N   PIC S9(4) VALUE 78                 04900001
049100                                         COMP.                    04910001
049200     05  ASCII-214-CAPTIAL-O   PIC S9(4) VALUE 79                 04920001
049300                                         COMP.                    04930001
049400     05  ASCII-215-CAPITAL-P   PIC S9(4) VALUE 80                 04940001
049500                                         COMP.                    04950001
049600     05  ASCII-216-CAPITAL-Q   PIC S9(4) VALUE 81                 04960001
049700                                         COMP.                    04970001
049800     05  ASCII-217-CAPTIAL-R   PIC S9(4) VALUE 82                 04980001
049900                                         COMP.                    04990001
050000     05  ASCII-218             PIC S9(4) VALUE 32                 05000001
050100                                         COMP.                    05010001
050200     05  ASCII-219             PIC S9(4) VALUE 32                 05020001
050300                                         COMP.                    05030001
050400     05  ASCII-220             PIC S9(4) VALUE 32                 05040001
050500                                         COMP.                    05050001
050600     05  ASCII-221             PIC S9(4) VALUE 32                 05060001
050700                                         COMP.                    05070001
050800     05  ASCII-222             PIC S9(4) VALUE 32                 05080001
050900                                         COMP.                    05090001
051000     05  ASCII-223             PIC S9(4) VALUE 32                 05100001
051100                                         COMP.                    05110001
051200     05  ASCII-224             PIC S9(4) VALUE 92                 05120001
051300                                         COMP.                    05130001
051400     05  ASCII-225             PIC S9(4) VALUE 32                 05140001
051500                                         COMP.                    05150001
051600     05  ASCII-226-CAPITAL-S   PIC S9(4) VALUE 83                 05160001
051700                                         COMP.                    05170001
051800     05  ASCII-227-CAPITAL-T   PIC S9(4) VALUE 84                 05180001
051900                                         COMP.                    05190001
052000     05  ASCII-228-CAPITAL-U   PIC S9(4) VALUE 85                 05200001
052100                                         COMP.                    05210001
052200     05  ASCII-229-CAPITAL-V   PIC S9(4) VALUE 86                 05220001
052300                                         COMP.                    05230001
052400     05  ASCII-230-CAPITAL-W   PIC S9(4) VALUE 87                 05240001
052500                                         COMP.                    05250001
052600     05  ASCII-231-CAPITAL-X   PIC S9(4) VALUE 88                 05260001
052700                                         COMP.                    05270001
052800     05  ASCII-232-CAPITAL-Y   PIC S9(4) VALUE 89                 05280001
052900                                         COMP.                    05290001
053000     05  ASCII-233-CAPITAL-Z   PIC S9(4) VALUE 90                 05300001
053100                                         COMP.                    05310001
053200     05  ASCII-234             PIC S9(4) VALUE 32                 05320001
053300                                         COMP.                    05330001
053400     05  ASCII-235             PIC S9(4) VALUE 32                 05340001
053500                                         COMP.                    05350001
053600     05  ASCII-236             PIC S9(4) VALUE 32                 05360001
053700                                         COMP.                    05370001
053800     05  ASCII-237             PIC S9(4) VALUE 32                 05380001
053900                                         COMP.                    05390001
054000     05  ASCII-238             PIC S9(4) VALUE 32                 05400001
054100                                         COMP.                    05410001
054200     05  ASCII-239             PIC S9(4) VALUE 32                 05420001
054300                                         COMP.                    05430001
054400     05  ASCII-240-ZERO        PIC S9(4) VALUE 48                 05440001
054500                                         COMP.                    05450001
054600     05  ASCII-241-ONE         PIC S9(4) VALUE 49                 05460001
054700                                         COMP.                    05470001
054800     05  ASCII-242-TWO         PIC S9(4) VALUE 50                 05480001
054900                                         COMP.                    05490001
055000     05  ASCII-243-THREE       PIC S9(4) VALUE 51                 05500001
055100                                         COMP.                    05510001
055200     05  ASCII-244-FOUR        PIC S9(4) VALUE 52                 05520001
055300                                         COMP.                    05530001
055400     05  ASCII-245-FIVE        PIC S9(4) VALUE 53                 05540001
055500                                         COMP.                    05550001
055600     05  ASCII-246-SIX         PIC S9(4) VALUE 54                 05560001
055700                                         COMP.                    05570001
055800     05  ASCII-247-SEVEN       PIC S9(4) VALUE 55                 05580001
055900                                         COMP.                    05590001
056000     05  ASCII-248-EIGHT       PIC S9(4) VALUE 56                 05600001
056100                                         COMP.                    05610001
056200     05  ASCII-249-NINE        PIC S9(4) VALUE 57                 05620001
056300                                         COMP.                    05630001
056400     05  ASCII-250             PIC S9(4) VALUE 32                 05640001
056500                                         COMP.                    05650001
056600     05  ASCII-251             PIC S9(4) VALUE 32                 05660001
056700                                         COMP.                    05670001
056800     05  ASCII-252             PIC S9(4) VALUE 32                 05680001
056900                                         COMP.                    05690001
057000     05  ASCII-253             PIC S9(4) VALUE 32                 05700001
057100                                         COMP.                    05710001
057200     05  ASCII-254             PIC S9(4) VALUE 32                 05720001
057300                                         COMP.                    05730001
057400     05  ASCII-255             PIC S9(4) VALUE 32                 05740001
057500                                         COMP.                    05750001
057600 01  FILLER  REDEFINES  EBCDIC-TO-ASCII-TABLE.                    05760001
057700     05  ASCII-BYTE-TABLE      OCCURS 256 TIMES.                  05770001
057800         10  FILLER            PIC X.                             05780001
057900         10  ASCII-BYTE        PIC X.                             05790001
058000 EJECT                                                            05800001
058100*                                                                 05810001
058200*    THIS TABLE IS ACCESSED FOR ASCII TO EBCDIC CONVERSIONS.      05820001
058300*    THE ASCII BYTE BEING PROCESSED IS THE SUBSCRIPT INTO THE     05830001
058400*    TABLE.  THE ENTRY IN THE TABLE IS THE EBCDIC EQUIVALENT.     05840001
058500*    IN OTHER WORDS, AT DISPLACEMENT X'20' (THE ASCII SPACE) THE  05850001
058600*    TABLE WILL HAVE A X'40' (THE EBCDIC SPACE).                  05860001
058700*                                                                 05870001
058800 01  ASCII-TO-EBCDIC-TABLE.                                       05880001
058900     05  EBCDIC-00             PIC S9(4) VALUE 64                 05890001
059000                                         COMP.                    05900001
059100     05  EBCDIC-01             PIC S9(4) VALUE 64                 05910001
059200                                         COMP.                    05920001
059300     05  EBCDIC-02             PIC S9(4) VALUE 64                 05930001
059400                                         COMP.                    05940001
059500     05  EBCDIC-03             PIC S9(4) VALUE 64                 05950001
059600                                         COMP.                    05960001
059700     05  EBCDIC-04             PIC S9(4) VALUE 64                 05970001
059800                                         COMP.                    05980001
059900     05  EBCDIC-05             PIC S9(4) VALUE 64                 05990001
060000                                         COMP.                    06000001
060100     05  EBCDIC-06             PIC S9(4) VALUE 64                 06010001
060200                                         COMP.                    06020001
060300     05  EBCDIC-07             PIC S9(4) VALUE 64                 06030001
060400                                         COMP.                    06040001
060500     05  EBCDIC-08             PIC S9(4) VALUE 64                 06050001
060600                                         COMP.                    06060001
060700     05  EBCDIC-09             PIC S9(4) VALUE 64                 06070001
060800                                         COMP.                    06080001
060900     05  EBCDIC-10             PIC S9(4) VALUE 64                 06090001
061000                                         COMP.                    06100001
061100     05  EBCDIC-11             PIC S9(4) VALUE 64                 06110001
061200                                         COMP.                    06120001
061300     05  EBCDIC-12             PIC S9(4) VALUE 64                 06130001
061400                                         COMP.                    06140001
061500     05  EBCDIC-13             PIC S9(4) VALUE 64                 06150001
061600                                         COMP.                    06160001
061700     05  EBCDIC-14             PIC S9(4) VALUE 64                 06170001
061800                                         COMP.                    06180001
061900     05  EBCDIC-15             PIC S9(4) VALUE 64                 06190001
062000                                         COMP.                    06200001
062100     05  EBCDIC-16             PIC S9(4) VALUE 64                 06210001
062200                                         COMP.                    06220001
062300     05  EBCDIC-17             PIC S9(4) VALUE 64                 06230001
062400                                         COMP.                    06240001
062500     05  EBCDIC-18             PIC S9(4) VALUE 64                 06250001
062600                                         COMP.                    06260001
062700     05  EBCDIC-19             PIC S9(4) VALUE 64                 06270001
062800                                         COMP.                    06280001
062900     05  EBCDIC-20             PIC S9(4) VALUE 64                 06290001
063000                                         COMP.                    06300001
063100     05  EBCDIC-21             PIC S9(4) VALUE 64                 06310001
063200                                         COMP.                    06320001
063300     05  EBCDIC-22             PIC S9(4) VALUE 64                 06330001
063400                                         COMP.                    06340001
063500     05  EBCDIC-23             PIC S9(4) VALUE 64                 06350001
063600                                         COMP.                    06360001
063700     05  EBCDIC-24             PIC S9(4) VALUE 64                 06370001
063800                                         COMP.                    06380001
063900     05  EBCDIC-25             PIC S9(4) VALUE 64                 06390001
064000                                         COMP.                    06400001
064100     05  EBCDIC-26             PIC S9(4) VALUE 64                 06410001
064200                                         COMP.                    06420001
064300     05  EBCDIC-27             PIC S9(4) VALUE 64                 06430001
064400                                         COMP.                    06440001
064500     05  EBCDIC-28             PIC S9(4) VALUE 64                 06450001
064600                                         COMP.                    06460001
064700     05  EBCDIC-29             PIC S9(4) VALUE 64                 06470001
064800                                         COMP.                    06480001
064900     05  EBCDIC-30             PIC S9(4) VALUE 64                 06490001
065000                                         COMP.                    06500001
065100     05  EBCDIC-31             PIC S9(4) VALUE 64                 06510001
065200                                         COMP.                    06520001
065300     05  EBCDIC-32-SPACE       PIC S9(4) VALUE 64                 06530001
065400                                         COMP.                    06540001
065500     05  EBCDIC-33-EXCLAMATION PIC S9(4) VALUE 90                 06550001
065600                                         COMP.                    06560001
065700     05  EBCDIC-34-DBL-QUOTE   PIC S9(4) VALUE 127                06570001
065800                                         COMP.                    06580001
065900     05  EBCDIC-35-POUND-SIGN  PIC S9(4) VALUE 123                06590001
066000                                         COMP.                    06600001
066100     05  EBCDIC-36-DOLLAR-SIGN PIC S9(4) VALUE 91                 06610001
066200                                         COMP.                    06620001
066300     05  EBCDIC-37-PCT-SIGN    PIC S9(4) VALUE 108                06630001
066400                                         COMP.                    06640001
066500     05  EBCDIC-38-AMPERSAND   PIC S9(4) VALUE 80                 06650001
066600                                         COMP.                    06660001
066700     05  EBCDIC-39-QUOTE       PIC S9(4) VALUE 125                06670001
066800                                         COMP.                    06680001
066900     05  EBCDIC-40-LEFT-PAREN  PIC S9(4) VALUE 77                 06690001
067000                                         COMP.                    06700001
067100     05  EBCDIC-41-RIGHT-PAREN PIC S9(4) VALUE 93                 06710001
067200                                         COMP.                    06720001
067300     05  EBCDIC-42-ASTERISK    PIC S9(4) VALUE 92                 06730001
067400                                         COMP.                    06740001
067500     05  EBCDIC-43-PLUS-SIGN   PIC S9(4) VALUE 78                 06750001
067600                                         COMP.                    06760001
067700     05  EBCDIC-44-COMMA       PIC S9(4) VALUE 107                06770001
067800                                         COMP.                    06780001
067900     05  EBCDIC-45-DASH        PIC S9(4) VALUE 96                 06790001
068000                                         COMP.                    06800001
068100     05  EBCDIC-46-PERIOD      PIC S9(4) VALUE 75                 06810001
068200                                         COMP.                    06820001
068300     05  EBCDIC-47-SLASH       PIC S9(4) VALUE 97                 06830001
068400                                         COMP.                    06840001
068500     05  EBCDIC-48-ZERO        PIC S9(4) VALUE 240                06850001
068600                                         COMP.                    06860001
068700     05  EBCDIC-49-ONE         PIC S9(4) VALUE 241                06870001
068800                                         COMP.                    06880001
068900     05  EBCDIC-50-TWO         PIC S9(4) VALUE 242                06890001
069000                                         COMP.                    06900001
069100     05  EBCDIC-51-THREE       PIC S9(4) VALUE 243                06910001
069200                                         COMP.                    06920001
069300     05  EBCDIC-52-FOUR        PIC S9(4) VALUE 244                06930001
069400                                         COMP.                    06940001
069500     05  EBCDIC-53-FIVE        PIC S9(4) VALUE 245                06950001
069600                                         COMP.                    06960001
069700     05  EBCDIC-54-SIX         PIC S9(4) VALUE 246                06970001
069800                                         COMP.                    06980001
069900     05  EBCDIC-55-SEVEN       PIC S9(4) VALUE 247                06990001
070000                                         COMP.                    07000001
070100     05  EBCDIC-56-EIGHT       PIC S9(4) VALUE 248                07010001
070200                                         COMP.                    07020001
070300     05  EBCDIC-57-NINE        PIC S9(4) VALUE 249                07030001
070400                                         COMP.                    07040001
070500     05  EBCDIC-58-COLON       PIC S9(4) VALUE 122                07050001
070600                                         COMP.                    07060001
070700     05  EBCDIC-59-SEMI-COLON  PIC S9(4) VALUE 94                 07070001
070800                                         COMP.                    07080001
070900     05  EBCDIC-60-LESS-THAN   PIC S9(4) VALUE 76                 07090001
071000                                         COMP.                    07100001
071100     05  EBCDIC-61-EQUAL-SIGN  PIC S9(4) VALUE 126                07110001
071200                                         COMP.                    07120001
071300     05  EBCDIC-62-GTR-THAN    PIC S9(4) VALUE 110                07130001
071400                                         COMP.                    07140001
071500     05  EBCDIC-63-QUESTION-MK PIC S9(4) VALUE 111                07150001
071600                                         COMP.                    07160001
071700     05  EBCDIC-64-AT-SIGN     PIC S9(4) VALUE 124                07170001
071800                                         COMP.                    07180001
071900     05  EBCDIC-65-CAPITAL-A   PIC S9(4) VALUE 193                07190001
072000                                         COMP.                    07200001
072100     05  EBCDIC-66-CAPITAL-B   PIC S9(4) VALUE 194                07210001
072200                                         COMP.                    07220001
072300     05  EBCDIC-67-CAPITAL-C   PIC S9(4) VALUE 195                07230001
072400                                         COMP.                    07240001
072500     05  EBCDIC-68-CAPITAL-D   PIC S9(4) VALUE 196                07250001
072600                                         COMP.                    07260001
072700     05  EBCDIC-69-CAPITAL-E   PIC S9(4) VALUE 197                07270001
072800                                         COMP.                    07280001
072900     05  EBCDIC-70-CAPITAL-F   PIC S9(4) VALUE 198                07290001
073000                                         COMP.                    07300001
073100     05  EBCDIC-71-CAPITAL-G   PIC S9(4) VALUE 199                07310001
073200                                         COMP.                    07320001
073300     05  EBCDIC-72-CAPITAL-H   PIC S9(4) VALUE 200                07330001
073400                                         COMP.                    07340001
073500     05  EBCDIC-73-CAPITAL-I   PIC S9(4) VALUE 201                07350001
073600                                         COMP.                    07360001
073700     05  EBCDIC-74-CAPITAL-J   PIC S9(4) VALUE 209                07370001
073800                                         COMP.                    07380001
073900     05  EBCDIC-75-CAPITAL-K   PIC S9(4) VALUE 210                07390001
074000                                         COMP.                    07400001
074100     05  EBCDIC-76-CAPITAL-L   PIC S9(4) VALUE 211                07410001
074200                                         COMP.                    07420001
074300     05  EBCDIC-77-CAPITAL-M   PIC S9(4) VALUE 212                07430001
074400                                         COMP.                    07440001
074500     05  EBCDIC-78-CAPITAL-N   PIC S9(4) VALUE 213                07450001
074600                                         COMP.                    07460001
074700     05  EBCDIC-79-CAPITAL-O   PIC S9(4) VALUE 214                07470001
074800                                         COMP.                    07480001
074900     05  EBCDIC-80-CAPITAL-P   PIC S9(4) VALUE 215                07490001
075000                                         COMP.                    07500001
075100     05  EBCDIC-81-CAPITAL-Q   PIC S9(4) VALUE 216                07510001
075200                                         COMP.                    07520001
075300     05  EBCDIC-82-CAPITAL-R   PIC S9(4) VALUE 217                07530001
075400                                         COMP.                    07540001
075500     05  EBCDIC-83-CAPITAL-S   PIC S9(4) VALUE 226                07550001
075600                                         COMP.                    07560001
075700     05  EBCDIC-84-CAPITAL-T   PIC S9(4) VALUE 227                07570001
075800                                         COMP.                    07580001
075900     05  EBCDIC-85-CAPITAL-U   PIC S9(4) VALUE 228                07590001
076000                                         COMP.                    07600001
076100     05  EBCDIC-86-CAPITAL-V   PIC S9(4) VALUE 229                07610001
076200                                         COMP.                    07620001
076300     05  EBCDIC-87-CAPITAL-W   PIC S9(4) VALUE 230                07630001
076400                                         COMP.                    07640001
076500     05  EBCDIC-88-CAPITAL-X   PIC S9(4) VALUE 231                07650001
076600                                         COMP.                    07660001
076700     05  EBCDIC-89-CAPITAL-Y   PIC S9(4) VALUE 232                07670001
076800                                         COMP.                    07680001
076900     05  EBCDIC-90-CAPITAL-Z   PIC S9(4) VALUE 233                07690001
077000                                         COMP.                    07700001
077100     05  EBCDIC-91-LFT-BRACKET PIC S9(4) VALUE 192                07710001
077200                                         COMP.                    07720001
077300     05  EBCDIC-92-BACK-SLASH  PIC S9(4) VALUE 224                07730001
077400                                         COMP.                    07740001
077500     05  EBCDIC-93-RIT-BRACKET PIC S9(4) VALUE 208                07750001
077600                                         COMP.                    07760001
077700     05  EBCDIC-94-CARET       PIC S9(4) VALUE 64                 07770001
077800                                         COMP.                    07780001
077900     05  EBCDIC-95-UNDER-SCORE PIC S9(4) VALUE 109                07790001
078000                                         COMP.                    07800001
078100     05  EBCDIC-96-BACK-APOST  PIC S9(4) VALUE 121                07810001
078200                                         COMP.                    07820001
078300     05  EBCDIC-97-SMALL-A     PIC S9(4) VALUE 129                07830001
078400                                         COMP.                    07840001
078500     05  EBCDIC-98-SMALL-B     PIC S9(4) VALUE 130                07850001
078600                                         COMP.                    07860001
078700     05  EBCDIC-99-SMALL-C     PIC S9(4) VALUE 131                07870001
078800                                         COMP.                    07880001
078900     05  EBCDIC-100-SMALL-D    PIC S9(4) VALUE 132                07890001
079000                                         COMP.                    07900001
079100     05  EBCDIC-101-SMALL-E    PIC S9(4) VALUE 133                07910001
079200                                         COMP.                    07920001
079300     05  EBCDIC-102-SMALL-F    PIC S9(4) VALUE 134                07930001
079400                                         COMP.                    07940001
079500     05  EBCDIC-103-SMALL-G    PIC S9(4) VALUE 135                07950001
079600                                         COMP.                    07960001
079700     05  EBCDIC-104-SMALL-H    PIC S9(4) VALUE 136                07970001
079800                                         COMP.                    07980001
079900     05  EBCDIC-105-SMALL-I    PIC S9(4) VALUE 137                07990001
080000                                         COMP.                    08000001
080100     05  EBCDIC-106-SMALL-J    PIC S9(4) VALUE 145                08010001
080200                                         COMP.                    08020001
080300     05  EBCDIC-107-SMALL-K    PIC S9(4) VALUE 146                08030001
080400                                         COMP.                    08040001
080500     05  EBCDIC-108-SMALL-L    PIC S9(4) VALUE 147                08050001
080600                                         COMP.                    08060001
080700     05  EBCDIC-109-SMALL-M    PIC S9(4) VALUE 148                08070001
080800                                         COMP.                    08080001
080900     05  EBCDIC-110-SMALL-N    PIC S9(4) VALUE 149                08090001
081000                                         COMP.                    08100001
081100     05  EBCDIC-111-SMALL-O    PIC S9(4) VALUE 150                08110001
081200                                         COMP.                    08120001
081300     05  EBCDIC-112-SMALL-P    PIC S9(4) VALUE 151                08130001
081400                                         COMP.                    08140001
081500     05  EBCDIC-113-SMALL-Q    PIC S9(4) VALUE 152                08150003
081600                                         COMP.                    08160001
081700     05  EBCDIC-114-SMALL-R    PIC S9(4) VALUE 153                08170001
081800                                         COMP.                    08180001
081900     05  EBCDIC-115-SMALL-S    PIC S9(4) VALUE 162                08190001
082000                                         COMP.                    08200001
082100     05  EBCDIC-116-SMALL-T    PIC S9(4) VALUE 163                08210001
082200                                         COMP.                    08220001
082300     05  EBCDIC-117-SMALL-U    PIC S9(4) VALUE 164                08230001
082400                                         COMP.                    08240001
082500     05  EBCDIC-118-SMALL-V    PIC S9(4) VALUE 165                08250001
082600                                         COMP.                    08260001
082700     05  EBCDIC-119-SMALL-W    PIC S9(4) VALUE 166                08270001
082800                                         COMP.                    08280001
082900     05  EBCDIC-120-SMALL-X    PIC S9(4) VALUE 167                08290001
083000                                         COMP.                    08300001
083100     05  EBCDIC-121-SMALL-Y    PIC S9(4) VALUE 168                08310001
083200                                         COMP.                    08320001
083300     05  EBCDIC-122-SMALL-Z    PIC S9(4) VALUE 169                08330001
083400                                         COMP.                    08340001
083500     05  EBCDIC-123-LEFT-BRACE PIC S9(4) VALUE 192                08350001
083600                                         COMP.                    08360001
083700     05  EBCDIC-124-DBL-VERBAR PIC S9(4) VALUE 106                08370001
083800                                         COMP.                    08380001
083900     05  EBCDIC-125-RITE-BRACE PIC S9(4) VALUE 208                08390001
084000                                         COMP.                    08400001
084100     05  EBCDIC-126-TILDE      PIC S9(4) VALUE 161                08410001
084200                                         COMP.                    08420001
084300     05  EBCDIC-127            PIC S9(4) VALUE 64                 08430001
084400                                         COMP.                    08440001
084500 01  FILLER  REDEFINES  ASCII-TO-EBCDIC-TABLE.                    08450001
084600     05  EBCDIC-BYTE-TABLE     OCCURS 128 TIMES.                  08460001
084700         10  FILLER            PIC X.                             08470001
084800         10  EBCDIC-BYTE       PIC X.                             08480001
084900 EJECT                                                            08490001
085000 LINKAGE SECTION.                                                 08500001
085100*                                                                 08510001
085200*    THE FOLLOWING ARE THE CALLING PROGRAM WORK AREAS USED        08520001
085300*    BY THIS SUBROUTINE.                                          08530001
085400*                                                                 08540001
085500 01  LS-CONVERSION-TYPE        PIC X.                             08550001
085600     88  EBCDIC-TO-ASCII-CONVERSION      VALUE '1'.               08560001
085700     88  ASCII-TO-EBCDIC-CONVERSION      VALUE '2'.               08570001
085800 01  LS-FIELD-LENGTH           PIC S9(3) COMP-3.                  08580006
085900 01  LS-INPUT-FIELD            PIC X(50).                         08590006
086300 01  LS-OUTPUT-FIELD           PIC X(50).                         08630006
086700 01  LS-RETURN-CODE            PIC XX.                            08670001
086800 EJECT                                                            08680001
086900 PROCEDURE DIVISION USING LS-CONVERSION-TYPE                      08690001
087000                          LS-FIELD-LENGTH                         08700008
087100                          LS-INPUT-FIELD                          08710008
087200                          LS-OUTPUT-FIELD                         08720008
087300                          LS-RETURN-CODE.                         08730001
087400 0000-MAINLINE.                                                   08740001
087500*                                                                 08750001
087600     INITIALIZE DP053-OUTPUT-FIELD.                               08760011
087610     SET DP053-RC-SUCCESSFUL TO TRUE.                             08761011
087700*                                                                 08770004
087800     IF ((LS-FIELD-LENGTH NOT NUMERIC)                            08780010
087900            OR (LS-FIELD-LENGTH < ZERO)                           08790010
088000            OR (LS-FIELD-LENGTH > (LENGTH OF DP053-INPUT-FIELD))) 08800010
088010         SET DP053-RC-INVALID-LENGTH TO TRUE                      08801010
088200     ELSE                                                         08820001
088300         MOVE LS-CONVERSION-TYPE TO DP053-CONVERSION-TYPE         08830010
088400         MOVE LS-FIELD-LENGTH TO DP053-FIELD-LENGTH               08840010
088410         MOVE LS-INPUT-FIELD TO DP053-INPUT-FIELD                 08841010
088420         MOVE LS-OUTPUT-FIELD TO DP053-OUTPUT-FIELD               08842010
088500     END-IF.                                                      08850001
088600*                                                                 08860001
088700     EVALUATE TRUE                                                08870004
088800         WHEN (NOT DP053-RC-SUCCESSFUL)                           08880004
088900             CONTINUE                                             08890004
089100         WHEN (DP053-CT-EBCDIC-TO-ASCII)                          08910004
089110             MOVE DP053-INPUT-FIELD TO PV-INPUT-FIELD             08911005
089120             INITIALIZE PV-OUTPUT-FIELD                           08912012
089200             PERFORM 1000-EBCDIC-TO-ASCII                         08920004
089300             VARYING PV-SUB2 FROM 1 BY 1                          08930005
089400                     UNTIL PV-SUB2 > DP053-FIELD-LENGTH           08940005
089500             MOVE PV-OUTPUT-FIELD TO DP053-OUTPUT-FIELD           08950009
089600         WHEN (DP053-CT-ASCII-TO-EBCDIC)                          08960004
089610             MOVE DP053-INPUT-FIELD TO PV-INPUT-FIELD             08961005
089620             INITIALIZE PV-OUTPUT-FIELD                           08962012
089700             PERFORM 2000-ASCII-TO-EBCDIC                         08970001
089800             VARYING PV-SUB2 FROM 1 BY 1                          08980005
089900                     UNTIL PV-SUB2 > DP053-FIELD-LENGTH           08990005
089910             MOVE PV-OUTPUT-FIELD TO DP053-OUTPUT-FIELD           08991009
090000         WHEN OTHER                                               09000007
090100             SET DP053-RC-INVALID-CONV-TYPE TO TRUE               09010004
090300     END-EVALUATE.                                                09030004
090400*                                                                 09040001
090410     MOVE DP053-OUTPUT-FIELD TO LS-OUTPUT-FIELD                   09041005
090420     MOVE DP053-RETURN-CODE TO LS-RETURN-CODE                     09042005
090500     GOBACK.                                                      09050001
090600                                                                  09060004
090700 1000-EBCDIC-TO-ASCII.                                            09070001
090800**************************************************************    09080001
090900*                                                            *    09090001
091000*    THE CONVERSION TAKES PLACE ONE BYTE AT A TIME.  THE     *    09100001
091100*    INPUT BYTE IS USED AS A SUBSCRIPT TO FIND THE OUTPUT    *    09110001
091200*    BYTE.  SINCE THE TABLE ENTRIES ARE DEFINED AS 9(4) COMP *    09120001
091300*    TWO BYTES OCCUPY THE DESIRED POSITION.  THE OCCURS      *    09130001
091400*    FIELD IS REDEFINED TO MOVE ONLY THE LOW ORDER BYTE TO   *    09140001
091500*    THE OUTPUT FIELD.  SINCE BYTE VALUES ARE RELATIVE TO    *    09150001
091600*    ZERO, THE SUBSCRIPT MUST BE ADJUSTED BY 1 BEFORE        *    09160001
091700*    ACCESSING THE TABLE.                                    *    09170001
091800*                                                            *    09180001
091900**************************************************************    09190001
092000*                                                                 09200001
092100     MOVE PV-INPUT-BYTE (PV-SUB2)   TO PV-SUB-CHAR.               09210005
092200     IF  PV-SUB-CHAR EQUAL ''                                    09220005
092300         SET DP053-RC-CHARACTER-NOT-FOUND TO TRUE                 09230004
092400     END-IF.                                                      09240001
092500*                                                                 09250001
092600     MOVE LOW-VALUES               TO PV-SUB-LV.                  09260005
092700     ADD 1                         TO PV-SUB.                     09270005
092800     MOVE ASCII-BYTE (PV-SUB)      TO PV-OUTPUT-BYTE (PV-SUB2).   09280005
092900*                                                                 09290001
093000     EJECT                                                        09300001
093100 2000-ASCII-TO-EBCDIC.                                            09310001
093200**************************************************************    09320001
093300*                                                            *    09330001
093400*    THE CONVERSION TAKES PLACE ONE BYTE AT A TIME.  THE     *    09340001
093500*    INPUT BYTE IS USED AS A SUBSCRIPT TO FIND THE OUTPUT    *    09350001
093600*    BYTE.  SINCE THE TABLE ENTRIES ARE DEFINED A S9(4) COMP *    09360001
093700*    TWO BYTES OCCURPY THE DESIRED POSITION.  THE OCCURS     *    09370001
093800*    FIELD IS REDEFINED TO MOVE ONLY THE LOW ORDER BYTE TO   *    09380001
093900*    THE OUTPUT FIELD.  WHEN THE SUBSCRIPT IS BUILT, IT IS   *    09390001
094000*    VALIDATED TO ENSURE IT DOES NOT EXCEED THE TABLE SIZE   *    09400001
094100*    OF 128.  EXCEPT FOR ASCII GRAPHICS, ONLY BYTE VALUES    *    09410001
094200*    OF 00 TO 127 ARE VALID.  SINCE BYTE VALUES ARE RELATIVE *    09420001
094300*    TO ZERO, THE SUBSCRIPT MUST BE ADJUSTED BY 1 BEFORE     *    09430001
094400*    ACCESSING THE TABLE.                                    *    09440001
094500*                                                            *    09450001
094600**************************************************************    09460001
094700*                                                                 09470001
094800     MOVE PV-INPUT-BYTE (PV-SUB2)  TO PV-SUB-CHAR.                09480005
094900     MOVE LOW-VALUES               TO PV-SUB-LV.                  09490005
095000     ADD 1                         TO PV-SUB.                     09500005
095100*                                                                 09510001
095200     IF  PV-SUB GREATER THAN 128                                  09520005
095210         SET DP053-RC-CHARACTER-NOT-FOUND TO TRUE                 09521004
095400         MOVE SPACE                TO PV-OUTPUT-BYTE (PV-SUB2)    09540005
095500     ELSE                                                         09550001
095600         MOVE EBCDIC-BYTE (PV-SUB) TO PV-OUTPUT-BYTE (PV-SUB2)    09560005
095700     END-IF.                                                      09570001
095800*                                                                 09580001
