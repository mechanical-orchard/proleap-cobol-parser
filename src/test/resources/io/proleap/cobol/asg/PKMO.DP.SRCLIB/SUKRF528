000100******************************************************************00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300******************************************************************00030002
000400                                                                  00040002
000500 PROGRAM-ID.             SUKRF528.                                00050002
000600 AUTHOR.                 DENISE HAHN.                             00060002
000700 INSTALLATION.           KOHLS.                                   00070002
000800 DATE-WRITTEN.           JULY, 1999.                              00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100******************************************************************00110002
001200* THIS PROGRAM DISPLAYS THE LABEL WARNING SCREEN (ON LRT LASER    00120002
001300* RADIO TERMINAL).  IF USER EXITS CHECK IN APPLICATION AND THERE  00130002
001400* ARE STILL LABELS TO BE PRINTED.                                 00140002
001500******************************************************************00150002
001600                                                                  00160002
001700                                                                  00170002
001800******************************************************************00180002
001900 ENVIRONMENT DIVISION.                                            00190002
002000******************************************************************00200002
002100                                                                  00210002
002200******************************************************************00220002
002300 DATA DIVISION.                                                   00230002
002400******************************************************************00240002
002500                                                                  00250002
002600******************************************************************00260002
002700 WORKING-STORAGE SECTION.                                         00270002
002800******************************************************************00280002
002900*                                                                 00290002
003000 01  CA-COMMAREA.                                                 00300004
003100     COPY SUWS001.                                                00310009
003200                                                                  00320002
003300*                                                                 00330002
003400 01  PC-PROGRAM-CONSTANTS.                                        00340002
003500     05  PC-TRANID                  PIC  X(04) VALUE 'S528'.      00350002
003600*    05  PC-COMMAREA-LENGTH         PIC S9(04) VALUE +300         00360006
003700     05  PV-COMMAREA-LENGTH         PIC S9(04) VALUE +0           00370007
003800                                                     COMP SYNC.   00380002
003900                                                                  00390002
004000     05  PC-TRAILER-STOP-PGM        PIC  X(08) VALUE 'SUKRF503'.  00400002
004100     05  PC-SU-LBL-PRT-PGM          PIC  X(08) VALUE 'SUKRF527'.  00410002
004200     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08) VALUE 'SUKRF528'.  00420002
004300                                                                  00430002
004400     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC  X(19) VALUE              00440002
004500                                          'UNRECOGNIZED PF KEY'.  00450002
004600     05  PC-TRANS-UNAVAILABLE-MSG   PIC  X(19) VALUE              00460002
004700                                           'TRANS NOT AVAILABLE'. 00470002
004800                                                                  00480002
004900 01  PV-PROGRAM-VARIABLES.                                        00490002
005000     05  PV-CICS-RESPONSE           PIC S9(09) VALUE ZEROS        00500002
005100                                                COMP SYNC.        00510002
005200     05  PV-TRANSFER-PROGRAM        PIC  X(08) VALUE SPACE.       00520002
005300                                                                  00530002
005400*                                                                 00540002
005500*  GENERATED DSECT FOR THE SUKM528 MAPSET                         00550002
005600*                                                                 00560002
005700     COPY SUKM528.                                                00570002
005800                                                                  00580002
005900*                                                                 00590002
006000*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00600002
006100*                                                                 00610002
006200     COPY DPWS013.                                                00620009
006300                                                                  00630002
006400*                                                                 00640002
006500*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00650002
006600*                                                                 00660002
006700     COPY DFHAID.                                                 00670002
006800                                                                  00680002
006900***************************************************************** 00690002
007000 LINKAGE SECTION.                                                 00700002
007100******************************************************************00710002
007200*01  DFHCOMMAREA                   PIC  X(300).                   00720006
007300 01  DFHCOMMAREA.                                                 00730008
007400     05  FILLER                       OCCURS 1 TO 4072 TIMES      00740008
007500                                      DEPENDING ON EIBCALEN.      00750008
007600         10  FILLER                   PIC X.                      00760008
007700                                                                  00770002
007800******************************************************************00780002
007900 PROCEDURE DIVISION.                                              00790002
008000******************************************************************00800002
008100 0000-PROGRAM-MAINLINE.                                           00810002
008200                                                                  00820009
008300     INITIALIZE CA-COMMAREA                                       00830008
008400     MOVE DFHCOMMAREA TO CA-COMMAREA.                             00840004
008500                                                                  00850002
008600     EVALUATE TRUE                                                00860002
008700         WHEN EIBAID = DFHPF4                                     00870002
008800             SET  SU001-INITIALIZE-SCREEN TO TRUE                 00880004
008900             MOVE PC-SU-LBL-PRT-PGM TO PV-TRANSFER-PROGRAM        00890004
009000             MOVE SPACES            TO SU001-TURN-PRINTER-ON-IND  00900004
009100             PERFORM 4000-XCTL-LRT-MENU                           00910002
009200                                                                  00920002
009300                                                                  00930002
009400         WHEN SU001-INITIALIZE-SCREEN                             00940004
009500         WHEN EIBAID = DFHCLEAR                                   00950002
009600             SET SU001-PROCESS-SCREEN TO TRUE                     00960004
009700             PERFORM 8000-SEND-MAP                                00970002
009800             PERFORM 8200-RETURN-TRANID                           00980002
009900                                                                  00990002
010000                                                                  01000002
010100         WHEN EIBAID = DFHENTER                                   01010002
010200             MOVE PC-TRAILER-STOP-PGM  TO PV-TRANSFER-PROGRAM     01020002
010300             PERFORM 4000-XCTL-LRT-MENU                           01030002
010400                                                                  01040002
010500                                                                  01050002
010600         WHEN OTHER                                               01060002
010700             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           01070002
010800             PERFORM 8100-SEND-DATA-ONLY                          01080002
010900             PERFORM 8200-RETURN-TRANID                           01090002
011000     END-EVALUATE.                                                01100002
011100                                                                  01110002
011200     GOBACK.                                                      01120002
011300                                                                  01130002
011400 4000-XCTL-LRT-MENU.                                              01140002
011500     SET SU001-INITIALIZE-SCREEN  TO TRUE.                        01150004
011600     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          01160004
011700                                                                  01170002
011900     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           01190008
012000     EXEC CICS                                                    01200002
012100         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    01210002
012200               COMMAREA  (CA-COMMAREA)                            01220002
012400               LENGTH    (PV-COMMAREA-LENGTH)                     01240008
012500               RESP      (PV-CICS-RESPONSE)                       01250002
012600     END-EXEC.                                                    01260002
012700                                                                  01270002
012800     EVALUATE TRUE                                                01280002
012900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01290002
013000             CONTINUE                                             01300002
013100         WHEN OTHER                                               01310002
013200             MOVE '4000-XCTL-TO-LRT-MENU'                         01320002
013300                 TO DP013-PARAGRAPH                               01330002
013400             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   01340002
013500                 TO DP013-MESSAGE-TEXT (1)                        01350002
013600             MOVE PV-TRANSFER-PROGRAM                             01360002
013700                 TO DP013-MESSAGE-TEXT (2)                        01370002
013800             SET DP013-CICS-ABEND  TO TRUE                        01380002
013900             SET DP013-NO-ROLLBACK TO TRUE                        01390002
014000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               01400002
014100             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             01410002
014200             SET SU001-PROCESS-SCREEN TO TRUE                     01420004
014300             PERFORM 8000-SEND-MAP                                01430002
014400             PERFORM 8200-RETURN-TRANID                           01440002
014500     END-EVALUATE.                                                01450002
014600                                                                  01460002
014700 8000-SEND-MAP.                                                   01470002
014800                                                                  01480002
014900     EXEC CICS                                                    01490002
015000         SEND MAP       ('SU528A')                                01500002
015100              MAPSET    ('SUKM528')                               01510002
015200              ERASE                                               01520002
015300              RESP      (PV-CICS-RESPONSE)                        01530002
015400     END-EXEC.                                                    01540002
015500                                                                  01550002
015600     EVALUATE TRUE                                                01560002
015700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01570002
015800             CONTINUE                                             01580002
015900         WHEN OTHER                                               01590002
016000             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         01600002
016100             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  01610002
016200             SET DP013-CICS-ABEND      TO TRUE                    01620002
016300             SET DP013-NO-ROLLBACK     TO TRUE                    01630002
016400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               01640002
016500     END-EVALUATE.                                                01650002
016600                                                                  01660002
016700*                                                                 01670002
016800 8100-SEND-DATA-ONLY.                                             01680002
016900                                                                  01690002
017000     EXEC CICS                                                    01700002
017100         SEND MAP       ('SU528A')                                01710002
017200              MAPSET    ('SUKM528')                               01720002
017300              CURSOR                                              01730002
017400              DATAONLY                                            01740002
017500              RESP      (PV-CICS-RESPONSE)                        01750002
017600     END-EXEC.                                                    01760002
017700                                                                  01770002
017800     EVALUATE TRUE                                                01780002
017900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01790002
018000             CONTINUE                                             01800002
018100         WHEN OTHER                                               01810002
018200             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        01820002
018300             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 01830002
018400             SET DP013-CICS-ABEND       TO TRUE                   01840002
018500             SET DP013-NO-ROLLBACK      TO TRUE                   01850002
018600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               01860002
018700     END-EVALUATE.                                                01870002
018800                                                                  01880002
018900*                                                                 01890002
019000 8200-RETURN-TRANID.                                              01900002
019100                                                                  01910002
019300     MOVE LENGTH OF CA-COMMAREA     TO PV-COMMAREA-LENGTH         01930008
019400     EXEC CICS                                                    01940002
019500         RETURN TRANSID  (PC-TRANID)                              01950002
019600                COMMAREA (CA-COMMAREA)                            01960002
019800                LENGTH   (PV-COMMAREA-LENGTH)                     01980008
019900                RESP     (PV-CICS-RESPONSE)                       01990002
020000     END-EXEC.                                                    02000002
020100                                                                  02010002
020200     EVALUATE TRUE                                                02020002
020300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02030002
020400             CONTINUE                                             02040002
020500         WHEN OTHER                                               02050002
020600             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        02060002
020700             MOVE 'UNABLE TO RETURN TO TRANID'                    02070002
020800                 TO DP013-MESSAGE-TEXT (1)                        02080002
020900             SET DP013-CICS-ABEND       TO TRUE                   02090002
021000             SET DP013-NO-ROLLBACK      TO TRUE                   02100002
021100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               02110002
021200     END-EVALUATE.                                                02120002
021300                                                                  02130002
021400 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  02140002
021500                                                                  02150002
021600     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              02160002
021700     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             02170002
021800     INITIALIZE DP013-SRC-TASK-NUMBER                             02180002
021900                DP013-STACK.                                      02190002
022000     SET DP013-LINK-RETURN TO TRUE.                               02200002
022100                                                                  02210002
022200     EXEC CICS                                                    02220002
022300         LINK                                                     02230002
022400             PROGRAM   (DP013-NAME)                               02240002
022500             COMMAREA  (DP013-PARAMETERS)                         02250002
022600             LENGTH    (DP013-LENGTH)                             02260002
022700     END-EXEC.                                                    02270002
022800                                                                  02280002
022900                                                                  02290002
023000*----------------------------------------------------------------*02300002
023100*    ABEND PROCESSOR MODULE                                      *02310002
023200*----------------------------------------------------------------*02320002
023300                                                                  02330002
023400     COPY DPPD014.                                                02340009
023500                                                                  02350002
