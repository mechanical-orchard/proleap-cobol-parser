000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRP009.                                00050000
000600 AUTHOR.                 MICHAEL WALTERS.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997.                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM WILL PRINT THE AUDIT SUMMARY REPORT FOR THE  00120000
001300*  UCC128 CARTON AUDITING SYSTEM.                                 00130000
001400******************************************************************00140000
001500*  CHANGED 10/05/09 BY SAURABH DUDDALWAR                        * 00150099
001600*   CHANGES ARE DONE TO HANDLE DATA CONTENTION ERRORS IN THE    * 00160099
001700*            PROGRAM WHILE REPORT GENERATION.                   * 00170099
001800*  CHANGED 11/22/13 BY SHOBHIT BAIJAL                           * 00180099
001900*   PR# 5148D  ADDED NEW LOGIC TO PRINT RFID ERROR REPORT FOR   * 00190099
002000*              RFID AUDIT OR MANUAL AUDIT                       * 00200099
002100*  CHANGED 12/26/13 BY RAMYA SREEDHAREN                         * 00210099
002200*   PR# 5148D  ADDED NEW LOGIC TO DISPLAY TOTAL UNITS AUDITED   * 00220099
002300*              FOR RFID AUDIT                                   * 00230099
002400*  CHANGED 01/10/14 BY RAMYA SREEDHAREN                         * 00240099
002500*   PR# 5148D  ADDED NEW LOGIC TO DISPLAY TOTAL UNITS AUDITED   * 00250099
002600*              FOR RFID AUDIT                                   * 00260099
002700*  CHANGED 03/19/14 BY SHOBHIT BAIJAL                           * 00270099
002800*   PR# 5148D  CHANGED THE LAYOUT OF PAGE HEADERS AND ADDED NEW * 00280099
002900*              HEADER FIELDS FOR 'AUDIT' AND 'DESIGNATION'      * 00290099
003000*  CHANGED 04/28/14 BY SHOBHIT BAIJAL                           * 00300099
003010*   PR# 5148D  ADDED LOGIC TO IDENTIFY IF DEPARTMENT IS RFID    * 00301099
003020*              TAGGING OR NOT AND DISPLAY COMBO ACCORDINGLY.    * 00302099
003030*  CHANGED 10/02/14 BY CHERI PARMLEY   CHG#0094517              * 00303099
003040*              EXPANDED PO FROM 7 TO 8 DIGITS                   * 00304099
003100***************************************************************** 00310000
003110*  CHANGED 07/08/22 BY DENISE HAHN                              * 00311099
003120*              TO ALLOW REPORT TO BE SENT TO A FILE INSTEAD OF  * 00312099
003130*              ACTUALLY PRINTING THE REPORT                     * 00313099
003140*              ADDED A 3RD "RPT" FILE THAT WILL ACTUALLY BE THE * 00314099
003150*              REPORT SENT TO A FLAT FILE.                      * 00315099
003160***************************************************************** 00316099
003110*  CHANGED 02/14/23 BY JEAN KURK           CHG0281369           * 00317099
003120*              REMOVED COPYBOOK FOR UPC CHECK DIGIT ROUTINE     * 00318099
003160***************************************************************** 00319399
003200                                                                  00320000
003300******************************************************************00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500******************************************************************00350000
003600                                                                  00360000
003700 CONFIGURATION SECTION.                                           00370000
003800                                                                  00380000
003900 SOURCE-COMPUTER.        IBM-3090.                                00390000
004000 OBJECT-COMPUTER.        IBM-3090.                                00400000
004100                                                                  00410000
004200 INPUT-OUTPUT SECTION.                                            00420000
004300                                                                  00430000
004400 FILE-CONTROL.                                                    00440000
004500                                                                  00450000
004600     SELECT AS-AUDIT-SUM-EXTRACT-FILE                             00460000
004700         ASSIGN TO INP01.                                         00470000
004800                                                                  00480000
004900     SELECT AS-AUDIT-SUM-REPORT-FILE                              00490000
005000         ASSIGN TO RPT01.                                         00500000
005100                                                                  00510000
005200     SELECT AS-AUDIT-SUM-REPORT-FILE-LOG                          00520000
005300         ASSIGN TO RPT02.                                         00530000
005400                                                                  00540000
005410     SELECT AS-AUDIT-SUM-REPORT-FLAT-FILE                         00541099
005420         ASSIGN TO RPT03.                                         00542099
005440                                                                  00544099
005500******************************************************************00550000
005600 DATA DIVISION.                                                   00560000
005700******************************************************************00570000
005800                                                                  00580000
005900 FILE SECTION.                                                    00590000
006000                                                                  00600000
006100 FD  AS-AUDIT-SUM-EXTRACT-FILE                                    00610000
006200     RECORDING MODE IS F                                          00620000
006300     LABEL RECORDS ARE STANDARD                                   00630000
006400     BLOCK CONTAINS 0 RECORDS.                                    00640000
006500                                                                  00650000
006600 01  AS-AUDIT-SUM-EXTRACT-RECORD         PIC  X(200).             00660000
006700                                                                  00670000
006800 FD  AS-AUDIT-SUM-REPORT-FILE                                     00680000
006900     RECORDING MODE IS F                                          00690000
007000     LABEL RECORDS ARE STANDARD                                   00700000
007100     BLOCK CONTAINS 0 RECORDS.                                    00710000
007200                                                                  00720000
007300 01  AS-AUDIT-SUM-REPORT-LINE            PIC  X(132).             00730000
007400                                                                  00740000
007500 FD  AS-AUDIT-SUM-REPORT-FILE-LOG                                 00750000
007600     RECORDING MODE IS F                                          00760000
007700     LABEL RECORDS ARE STANDARD                                   00770000
007800     BLOCK CONTAINS 0 RECORDS.                                    00780000
007900                                                                  00790000
008000 01  AS-AUDIT-SUM-REPORT-LINE-LOG        PIC  X(132).             00800000
008100                                                                  00810000
008110 FD  AS-AUDIT-SUM-REPORT-FLAT-FILE                                00811099
008120     RECORDING MODE IS F                                          00812099
008130     LABEL RECORDS ARE STANDARD                                   00813099
008140     BLOCK CONTAINS 0 RECORDS.                                    00814099
008150                                                                  00815099
008160 01  AS-AUDIT-SUM-REPORT-LINE-FLAT       PIC  X(132).             00816099
008170                                                                  00817099
008200******************************************************************00820000
008300 WORKING-STORAGE SECTION.                                         00830000
008400******************************************************************00840000
008500                                                                  00850000
008600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00860000
008700*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                00870000
008800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00880000
008900     COPY DPWS132O.                                               00890000
009000                                                                  00900000
009100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00910000
009200*  RECORD LAYOUT FOR THE AUDIT SUMMARY EXTRACT FILE             * 00920000
009300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00930000
009400     COPY SURD005.                                                00940000
009500                                                                  00950000
009600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00960000
009700*  COPYBOOK MEMBER OF PRINTER LINE COMMANDS TO BE SUED WITH     * 00970000
009800*  PRINTEK PRINTERS                                             * 00980000
009900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00990000
010000     COPY DSWS004.                                                01000000
010100                                                                  01010000
010200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01020000
010300*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01030000
010400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01040000
010500     COPY DPWS004.                                                01050000
010600                                                                  01060000
010700 01  ABEND-CODE                          PIC S9(04) VALUE +0      01070000
010800                                                     COMP SYNC.   01080000
010900******************************************************************01090000
011000*     PAGE HEADINGS        PAGE HEADINGS         PAGE HEADING    *01100000
011100******************************************************************01110000
011200 01  PH2-PAGE-HEADING-2.                                          01120000
011300     05  FILLER                          PIC  X(52)  VALUE SPACE. 01130000
011400     05  FILLER                          PIC  X(28)  VALUE        01140000
011500         'VENDOR ACCURACY CARTON AUDIT'.                          01150000
011600     05  FILLER                          PIC  X(52)  VALUE SPACE. 01160000
011700                                                                  01170000
011800 01  PH3-PAGE-HEADING-3-PBS.                                      01180000
011900     05  FILLER                          PIC  X(53)  VALUE SPACE. 01190000
012000     05  FILLER                          PIC  X(26)  VALUE        01200000
012100         'PACK-BY-STORE CARTON AUDIT'.                            01210000
012200     05  FILLER                          PIC  X(53)  VALUE SPACE. 01220000
012300                                                                  01230000
012400 01  PH3-PAGE-HEADING-3-CP.                                       01240000
012500     05  FILLER                          PIC  X(55)  VALUE SPACE. 01250000
012600     05  FILLER                          PIC  X(22)  VALUE        01260000
012700         'CASEPACK CARTON AUDIT '.                                01270000
012800     05  FILLER                          PIC  X(55)  VALUE SPACE. 01280000
012900                                                                  01290000
013000 01  PH4-PAGE-HEADING-4.                                          01300000
013100     05  FILLER                          PIC  X(59)  VALUE SPACE. 01310000
013200     05  FILLER                          PIC  X(14)  VALUE        01320000
013300         'SUMMARY REPORT'.                                        01330000
013400     05  FILLER                          PIC  X(59)  VALUE SPACE. 01340000
013500                                                                  01350000
013600***************************************************************** 01360000
013700 01  AH1-AUDIT-HEADING-1.                                         01370000
013800     05  FILLER                          PIC  X(02)  VALUE SPACE. 01380000
014000     05  FILLER                          PIC  X(17)  VALUE        01400000
014100         'AUDIT CONTROL #: '.                                     01410000
014200     05  AH1-AUD-CNTL-NBR                PIC  Z(9)9  VALUE SPACE. 01420000
014600     05  FILLER                          PIC  X(17)  VALUE SPACE. 01460000
014800     05  FILLER                          PIC  X(17)  VALUE        01480000
014900         'AUDIT STATUS...: '.                                     01490000
014910     05  AH1-AUDIT-STATUS                PIC  X(15)  VALUE SPACE. 01491000
015000     05  FILLER                          PIC  X(11)  VALUE SPACE. 01500000
015100     05  FILLER                          PIC  X(19)  VALUE        01510000
015110         'FACILITY.........: '.                                   01511000
015120     05  AH1-OPER-UNT-ID                 PIC Z9(03)  VALUE SPACE. 01512000
015130     05  FILLER                          PIC  X(01)  VALUE '-'.   01513000
015140     05  AH1-FCLTY-DESC                  PIC  X(19)  VALUE SPACE. 01514099
015150                                                                  01515099
015160***************************************************************** 01516099
019300 01  AH2-AUDIT-HEADING-2.                                         01930000
019400     05  FILLER                          PIC  X(02)  VALUE SPACE. 01940000
019600     05  FILLER                          PIC  X(17)  VALUE        01960000
019700         'VENDOR NAME....: '.                                     01970000
019800     05  AH2-VENDOR-NAME                 PIC  X(20)  VALUE SPACE. 01980000
020000     05  FILLER                          PIC  X(07)  VALUE SPACE. 02000000
020110     05  FILLER                          PIC  X(17)  VALUE        02011000
020120         'DEPARTMENT.....: '.                                     02012000
020140     05  AH2-DEPT-NBR                    PIC  Z(03)  VALUE ZERO.  02014000
020150     05  FILLER                          PIC  X(66)  VALUE SPACE. 02015099
022300                                                                  02230000
022400***************************************************************** 02240000
022500 01  AH3-AUDIT-HEADING-3.                                         02250000
022600     05  FILLER                          PIC  X(02)  VALUE SPACE. 02260000
022610     05  FILLER                          PIC  X(17)  VALUE        02261000
022620         'PO/RECEIVER....: '.                                     02262000
022640     05  AH3-PO                          PIC  9(08)  VALUE ZERO.  02264099
022650     05  FILLER                          PIC  X      VALUE '-'.   02265000
022660     05  AH3-RECEIVER                    PIC  9(03)  VALUE ZERO.  02266000
023400     05  FILLER                          PIC  X(15)  VALUE SPACE. 02340099
023410     05  FILLER                          PIC  X(17)  VALUE        02341000
023420         'PRETICKET IND..: '.                                     02342000
023440     05  AH3-PRETICKET-IND               PIC  X(01)  VALUE SPACE. 02344000
023450         88  AH3-PRETICKET               VALUE 'Y'.               02345000
023460         88  AH3-NOT-PRETICKET           VALUE 'N'.               02346000
023600     05  FILLER                          PIC  X(25)  VALUE SPACE. 02360000
023610     05  FILLER                          PIC  X(19)  VALUE        02361000
023700         'AUDIT AREA.......: '.                                   02370000
023900     05  AH3-AUDIT-AREA                  PIC  X(04)  VALUE SPACE. 02390000
024000     05  FILLER                          PIC  X(20)  VALUE SPACE. 02400099
025700                                                                  02570000
025800***************************************************************** 02580000
025900 01  AH4-RECEIVER-HEADING-4.                                      02590000
026000     05  FILLER                          PIC  X(02)  VALUE SPACE. 02600000
026200     05  FILLER                          PIC  X(17)  VALUE        02620000
026300         'AUDIT TYPE.....: '.                                     02630000
026500     05  AH4-AUDIT-TYPE                  PIC  X(16)  VALUE SPACE. 02650000
026900     05  FILLER                          PIC  X(11)  VALUE SPACE. 02690000
027100     05  FILLER                          PIC  X(17)  VALUE        02710000
027200         'HANGER IND.....: '.                                     02720000
027300     05  AH4-HANGER-IND                  PIC  X(01)  VALUE SPACE. 02730000
027310         88  AH4-HANGER                  VALUE 'Y'.               02731000
027320         88  AH4-NOT-HANGER              VALUE 'N'.               02732000
027500     05  FILLER                          PIC  X(25)  VALUE SPACE. 02750000
027700     05  FILLER                          PIC  X(19)  VALUE        02770000
027800         'UNITS TRANSCRIBED: '.                                   02780000
027900     05  AH4-UNITS-TRANSCRIBED       PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  02790000
028000     05  FILLER                          PIC  X(13)  VALUE SPACE. 02800099
028500                                                                  02850000
028600***************************************************************** 02860000
028700 01  AH5-RECEIVER-HEADING-5.                                      02870000
028800     05  FILLER                          PIC  X(02)  VALUE SPACE. 02880000
029000     05  FILLER                          PIC  X(17)  VALUE        02900000
029100         'RECEIPT DATE...: '.                                     02910000
029300     05  AH5-RECIPT-DATE                 PIC  X(10)  VALUE SPACE. 02930000
029500     05  FILLER                          PIC  X(17)  VALUE SPACE. 02950000
029700     05  FILLER                          PIC  X(17)  VALUE        02970000
029800         'NEW STORE IND..: '.                                     02980000
030000     05  AH5-NEW-STORE-IND               PIC  X(01)  VALUE SPACE. 03000000
030100         88  AH5-NEW-STORE               VALUE 'Y'.               03010000
030200         88  AH5-NOT-NEW-STORE           VALUE 'N'.               03020000
030400     05  FILLER                          PIC  X(25)  VALUE SPACE. 03040000
030600     05  FILLER                          PIC  X(19)  VALUE        03060000
030700         'EXP CARTON COUNT.: '.                                   03070000
030800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03080000
030900     05  AH5-EST-CART-COUNT          PIC  ZZ,ZZZ,ZZ9 VALUE ZERO.  03090000
031000     05  FILLER                          PIC  X(13)  VALUE SPACE. 03100099
032100                                                                  03210000
032200***************************************************************** 03220000
032300 01  AH6-RECEIVER-HEADING-6.                                      03230000
032400     05  FILLER                          PIC  X(02)  VALUE SPACE. 03240000
032510     05  FILLER                          PIC  X(17)  VALUE        03251000
032520         'AUDIT CATEGORY.: '.                                     03252000
032540     05  AH6-AUDIT-CATEGORY              PIC  X(04)  VALUE SPACE. 03254000
033100     05  FILLER                          PIC  X(23)  VALUE SPACE. 03310000
033201     05  FILLER                          PIC  X(17)  VALUE        03320100
033202         'AUDIT START....: '.                                     03320200
033203     05  AH6-AUDIT-START-DATE            PIC  X(10)  VALUE SPACE. 03320300
033204     05  FILLER                          PIC  X(01)  VALUE SPACE. 03320400
033205     05  AH6-AUDIT-START-TIME            PIC  X(05)  VALUE SPACE. 03320500
033207     05  FILLER                          PIC  X(10)  VALUE SPACE. 03320700
033209     05  FILLER                          PIC  X(19)  VALUE        03320900
033210         'CARTONS AUDITED..: '.                                   03321000
033212     05  AH6-CARTONS-AUDITED         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  03321200
033213     05  FILLER                          PIC  X(13)  VALUE SPACE. 03321399
034700                                                                  03470000
034800***************************************************************** 03480000
034900 01  AH7-RECEIVER-HEADING-7.                                      03490000
035000     05  FILLER                          PIC  X(02)  VALUE SPACE. 03500000
035200     05  FILLER                          PIC  X(17)  VALUE        03520000
035300         'AUDIT..........: '.                                     03530000
035500     05  AH7-SYS-MAN-AUDIT               PIC  X(08)  VALUE SPACE. 03550000
035510         88 AH7-PROMPTED-AUDIT           VALUE 'PROMPTED'.        03551000
035520         88 AH7-MANUAL-AUDIT             VALUE 'MANUAL  '.        03552000
035700     05  FILLER                          PIC  X(19)  VALUE SPACE. 03570000
035801     05  FILLER                          PIC  X(17)  VALUE        03580100
035802         'AUDIT STOP.....: '.                                     03580200
035803     05  AH7-AUDIT-STOP-DATE             PIC  X(10)  VALUE SPACE. 03580300
035804     05  FILLER                          PIC  X(01)  VALUE SPACE. 03580400
035805     05  AH7-AUDIT-STOP-TIME             PIC  X(05)  VALUE SPACE. 03580500
036400     05  FILLER                          PIC  X(10)  VALUE SPACE. 03640000
036501     05  FILLER                          PIC  X(19)  VALUE        03650100
036502         'ADJ CARTON COUNT.: '.                                   03650200
036503     05  FILLER                          PIC  X(01)  VALUE SPACE. 03650300
036504     05  AH7-ADJ-CART-COUNT           PIC ZZ,ZZZ,ZZ9 VALUE ZERO.  03650400
036505     05  FILLER                          PIC  X(13)  VALUE SPACE. 03650599
036510                                                                  03651099
037310***************************************************************** 03731000
037320 01  AH8-RECEIVER-HEADING-8.                                      03732000
037330     05  FILLER                          PIC  X(02)  VALUE SPACE. 03733000
037341     05  FILLER                          PIC  X(17)  VALUE        03734100
037342         'DESIGNATION....: '.                                     03734200
037350     05  AH8-COMBO-AUDIT-IND             PIC  X(05)  VALUE SPACE. 03735000
037360         88 AH8-COMBO                    VALUE 'COMBO'.           03736000
037370         88 AH8-NOT-COMBO                VALUE '     '.           03737000
037391     05  FILLER                          PIC  X(22)  VALUE SPACE. 03739100
037393     05  FILLER                          PIC  X(17)  VALUE        03739300
037394         'DURATION(HH:MM): '.                                     03739400
037396     05  AH8-DURATION.                                            03739600
037397         15  AH8-DURATION-HOURS          PIC  ZZ99.               03739700
037398         15  FILLER                      PIC  X      VALUE ':'.   03739800
037399         15  AH8-DURATION-MINUTES        PIC  99.                 03739900
037400     05  AH8-DURATION-X REDEFINES AH8-DURATION                    03740000
037401                                         PIC  X(07).              03740100
037403     05  FILLER                          PIC  X(19)  VALUE SPACE. 03740300
037405     05  FILLER                          PIC  X(19)  VALUE        03740500
037406         'UNITS AUDITED....: '.                                   03740600
037408     05  AH8-UNITS-AUDITED           PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  03740800
037409     05  FILLER                          PIC  X(13)  VALUE SPACE. 03740999
037410                                                                  03741000
037411******************************************************************03741100
037420 01  AH9-RECEIVER-HEADING-9.                                      03742000
037500     05  FILLER                          PIC  X(02)  VALUE SPACE. 03750000
037600     05  FILLER                          PIC  X(21)  VALUE        03760000
037700         'AUDITING ASSOCIATES: '.                                 03770000
037800     05  AH9-USERID-TABLE.                                        03780000
037900       07 FILLER  OCCURS 12 TIMES                                 03790000
038000                  INDEXED BY AH9-UID-IDX.                         03800000
038100         10 AH9-USER-ID                  PIC  X(07) VALUE SPACE.  03810000
038200         10 AH9-COMMA                    PIC  X(01) VALUE SPACE.  03820000
038300         10 FILLER                       PIC  X(01) VALUE SPACE.  03830000
038310     05  FILLER                          PIC  X(01)  VALUE SPACE. 03831099
038400                                                                  03840000
038410***************************************************************** 03841000
038420 01  AH9-AUDIT-HEADING-9A.                                        03842000
038430     05  FILLER                          PIC  X(02)  VALUE SPACE. 03843000
038440     05  FILLER                          PIC  X(20)  VALUE        03844000
038450         'PROCESS AREA/SHIFT: '.                                  03845000
038460     05  FILLER                          PIC  X(25)  VALUE        03846000
038470         '________________________'.                              03847000
038480     05  FILLER                          PIC  X(05)  VALUE SPACE. 03848000
038490     05  FILLER                          PIC  X(15)  VALUE        03849000
038491         'VIOLATION NO.: '.                                       03849100
038492     05  FILLER                          PIC  X(35)  VALUE        03849200
038493         '___________________________________'.                   03849300
038494     05  FILLER                          PIC  X(30)  VALUE        03849400
038495         '_____________________________'.                         03849500
038496                                                                  03849699
038497***************************************************************** 03849700
038498 01  AH9-AUDIT-HEADING-DASH.                                      03849800
038499     05  FILLER                          PIC  X(02)  VALUE SPACE. 03849900
038500     05  FILLER                          PIC  X(20)  VALUE SPACES.03850000
038501     05  FILLER                          PIC  X(25)  VALUE SPACES.03850100
038502     05  FILLER                          PIC  X(05)  VALUE SPACE. 03850200
038503     05  FILLER                          PIC  X(15)  VALUE SPACES.03850300
038504     05  FILLER                          PIC  X(35)  VALUE        03850400
038505         '___________________________________'.                   03850500
038506     05  FILLER                          PIC  X(30)  VALUE        03850600
038507         '_____________________________'.                         03850700
038510                                                                  03851000
038600******************************************************************03860000
038700*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *03870000
038800******************************************************************03880000
038900******************************************************************03890000
039000 01  PDH1-PICKING-DETAIL-HEADING-1.                               03900000
039100     05  FILLER                          PIC  X(52)  VALUE SPACE. 03910000
039200     05  FILLER                          PIC  X(27)  VALUE        03920000
039300         'P I C K I N G   E R R O R S'.                           03930000
039400     05  FILLER                          PIC  X(53)  VALUE SPACE. 03940000
039500                                                                  03950000
039600******************************************************************03960000
039700 01  PDH1-PICKING-DETAIL-HEADING-1A.                              03970000
039900     05  FILLER                          PIC  X(43)  VALUE SPACES.03990000
040000     05  FILLER                          PIC  X(36)  VALUE        04000000
040100         'VA-029 VA-030  VA-031 VA-020        '.                  04010000
040200     05  FILLER                          PIC  X(53)  VALUE SPACES.04020000
040400                                                                  04040000
040500******************************************************************04050000
040600 01  PDH2-PICKING-DETAIL-HEADING-2.                               04060000
040700     05  FILLER                          PIC  X(19)  VALUE SPACES.04070000
040800     05  FILLER                          PIC  X(08)  VALUE        04080000
040900         'STR NBR '.                                              04090000
041100     05  FILLER                          PIC  X(02)  VALUE SPACES.04110000
041300     05  FILLER                          PIC  X(11)  VALUE        04130000
041400         '--VENDOR-- '.                                           04140000
041500     05  FILLER                          PIC  X(05)  VALUE SPACES.04150000
041600     05  FILLER                          PIC  X(11)  VALUE        04160000
041700         '-RECEIVER- '.                                           04170000
041800     05  FILLER                          PIC  X(02)  VALUE SPACES.04180000
041900     05  FILLER                          PIC  X(05)  VALUE        04190000
042000         'STYLE'.                                                 04200000
042200     05  FILLER                          PIC  X(02)  VALUE SPACES.04220000
042400     05  FILLER                          PIC  X(07)  VALUE        04240000
042500         'DAMAGED'.                                               04250000
042700     05  FILLER                          PIC  X(09)  VALUE SPACES.04270000
043200     05  FILLER                          PIC  X(07)  VALUE        04320000
043300         '  TOTAL'.                                               04330000
043400     05  FILLER                          PIC  X(01)  VALUE SPACES.04340000
043500     05  FILLER                          PIC  X(09)  VALUE        04350000
043600         'TOT UNITS'.                                             04360000
043700     05  FILLER                          PIC  X(03)  VALUE SPACES.04370000
043800     05  FILLER                          PIC  X(09)  VALUE        04380000
043900         'TOT UNITS'.                                             04390000
044000     05  FILLER                          PIC  X(03)  VALUE SPACES.04400000
044100     05  FILLER                          PIC  X(09)  VALUE        04410000
044200         'TOT UNITS'.                                             04420000
044300     05  FILLER                          PIC  X(03)  VALUE SPACES.04430000
044400     05  FILLER                          PIC  X(07)  VALUE        04440000
044500         'ERROR  '.                                               04450000
044510                                                                  04451099
044600******************************************************************04460000
044700 01  PDH3-PICKING-DETAIL-HEADING-3.                               04470000
044800     05  FILLER                          PIC  X(19)  VALUE SPACES.04480000
044900     05  FILLER                          PIC  X(08)  VALUE        04490000
045000         'W/ERRORS'.                                              04500000
045200     05  FILLER                          PIC  X(02)  VALUE SPACES.04520000
045400     05  FILLER                          PIC  X(11)  VALUE        04540000
045500         'OVER  SHORT'.                                           04550000
045600     05  FILLER                          PIC  X(05)  VALUE SPACES.04560000
045700     05  FILLER                          PIC  X(11)  VALUE        04570000
045800         'OVER  SHORT'.                                           04580000
045900     05  FILLER                          PIC  X(02)  VALUE SPACES.04590000
046000     05  FILLER                          PIC  X(05)  VALUE        04600000
046100         ' SUBS'.                                                 04610000
046200     05  FILLER                          PIC  X(02)  VALUE SPACES.04620000
046300     05  FILLER                          PIC  X(07)  VALUE        04630000
046400         ' UNITS '.                                               04640000
046600     05  FILLER                          PIC  X(09)  VALUE SPACES.04660000
047100     05  FILLER                          PIC  X(07)  VALUE        04710000
047200         ' ERRORS'.                                               04720000
047300     05  FILLER                          PIC  X(01)  VALUE SPACES.04730000
047400     05  FILLER                          PIC  X(09)  VALUE        04740000
047500         ' IN ERROR'.                                             04750000
047600     05  FILLER                          PIC  X(03)  VALUE SPACES.04760000
047700     05  FILLER                          PIC  X(09)  VALUE        04770000
047800         'TRANSCRIB'.                                             04780000
047900     05  FILLER                          PIC  X(03)  VALUE SPACES.04790000
048000     05  FILLER                          PIC  X(09)  VALUE        04800000
048100         ' AUDITED '.                                             04810000
048200     05  FILLER                          PIC  X(03)  VALUE SPACES.04820000
048300     05  FILLER                          PIC  X(07)  VALUE        04830000
048400         'RATIO  '.                                               04840000
048500                                                                  04850000
048600******************************************************************04860000
048700 01  PDL-PICKING-DETAIL-LINE.                                     04870000
048800     05  FILLER                          PIC  X(22)  VALUE SPACES.04880000
048900     05  PDL-STORE-NBR                   PIC  9(03).              04890000
049000     05  PDL-STORE-NBR-X REDEFINES PDL-STORE-NBR                  04900000
049100                                         PIC  X(03).              04910000
049300     05  FILLER                          PIC  X(04)  VALUE SPACES.04930000
049500     05  PDL-VND-OVER                    PIC  ZZZ9.               04950000
049600     05  FILLER                          PIC  X(03)  VALUE SPACES.04960000
049700     05  PDL-VND-SHORT                   PIC  ZZZ9.               04970000
049800     05  FILLER                          PIC  X(04)  VALUE SPACES.04980000
049900     05  PDL-RCVR-OVER                   PIC  ZZZ9.               04990000
050000     05  PDL-RCVR-OVER-X REDEFINES                                05000000
050100         PDL-RCVR-OVER                   PIC  X(04).              05010000
050200     05  FILLER                          PIC  X(03)  VALUE SPACES.05020000
050300     05  PDL-RCVR-SHORT                  PIC  ZZZ9.               05030000
050400     05  PDL-RCVR-SHORT-X REDEFINES                               05040000
050500         PDL-RCVR-SHORT                  PIC  X(04).              05050000
050600     05  FILLER                          PIC  X(03)  VALUE SPACES.05060000
050700     05  PDL-STYLE-SUB                   PIC  ZZZ9.               05070000
050800     05  FILLER                          PIC  X(04)  VALUE SPACES.05080000
050900     05  PDL-DAMAGED-UNITS               PIC  ZZZ9.               05090000
051100     05  FILLER                          PIC  X(11)  VALUE SPACES.05110000
051500     05  PDL-TOTAL-ERRORS                PIC  ZZ,ZZ9.             05150000
051600     05  FILLER                          PIC  X(04)  VALUE SPACES.05160000
051700     05  PDL-TOTAL-UNITS-IN-ERROR        PIC  ZZ,ZZ9.             05170000
051800     05  FILLER                          PIC  X(04)  VALUE SPACES.05180000
051900     05  PDL-TOTAL-UNITS-TRNSCRBD        PIC  ZZZ,ZZ9.            05190000
052000     05  FILLER                          PIC  X(04)  VALUE SPACES.05200000
052100     05  PDL-TOTAL-UNITS-AUDITED         PIC  ZZZ,ZZ9.            05210000
052200     05  FILLER                          PIC  X(04)  VALUE SPACES.05220000
052300     05  PDL-ERROR-RATIO                 PIC  ZZ9.99.             05230000
052400     05  PDL-ERROR-RATIO-X  REDEFINES PDL-ERROR-RATIO             05240000
052500                                         PIC  X(6).               05250000
052600     05  PDL-PERCENT                     PIC  X(1)  VALUE '%'.    05260000
052610     05  FILLER                          PIC  X(02)  VALUE SPACES.05261099
052700                                                                  05270000
052800******************************************************************05280000
052900 01  PTL-PICKING-TOTAL-LINE.                                      05290000
053000     05  FILLER                          PIC  X(05)  VALUE SPACES.05300000
053100     05  PTL-TOTAL-DESCRIPTION           PIC  X(13)  VALUE SPACES.05310000
053200     05  FILLER                          PIC  X(03)  VALUE SPACES.05320000
053300     05  PTL-STORE-NBR                   PIC  ZZZ9.               05330000
053400     05  FILLER                          PIC  X(02)  VALUE SPACES.05340000
053500     05  PTL-VND-OVER                    PIC  ZZ,ZZ9.             05350000
053600     05  FILLER                          PIC  X(01)  VALUE SPACES.05360000
053700     05  PTL-VND-SHORT                   PIC  ZZ,ZZ9.             05370000
053800     05  FILLER                          PIC  X(02)  VALUE SPACES.05380000
053900     05  PTL-RCVR-OVER                   PIC  ZZ,ZZ9.             05390000
054000     05  PTL-RCVR-OVER-X REDEFINES                                05400000
054100         PTL-RCVR-OVER                   PIC  X(06).              05410000
054200     05  FILLER                          PIC  X(01)  VALUE SPACES.05420000
054300     05  PTL-RCVR-SHORT                  PIC  ZZ,ZZ9.             05430000
054400     05  PTL-RCVR-SHORT-X REDEFINES                               05440000
054500         PTL-RCVR-SHORT                  PIC  X(06).              05450000
054600     05  FILLER                          PIC  X(01)  VALUE SPACES.05460000
054700     05  PTL-STYLE-SUB                   PIC  ZZ,ZZ9.             05470000
054800     05  FILLER                          PIC  X(02)  VALUE SPACES.05480000
054900     05  PTL-DAMAGED-UNITS               PIC  ZZ,ZZ9.             05490000
055000     05  FILLER                          PIC  X(08)  VALUE SPACES.05500000
055500     05  PTL-TOTAL-ERRORS                PIC  Z,ZZZ,ZZ9.          05550000
055600     05  FILLER                          PIC  X(01)  VALUE SPACES.05560000
055700     05  PTL-TOTAL-UNITS-IN-ERROR        PIC  Z,ZZZ,ZZ9.          05570000
055800     05  FILLER                          PIC  X(02)  VALUE SPACES.05580000
055900     05  PTL-TOTAL-UNITS-TRNSCRBD        PIC  Z,ZZZ,ZZ9.          05590000
056000     05  FILLER                          PIC  X(02)  VALUE SPACES.05600000
056100     05  PTL-TOTAL-UNITS-AUDITED         PIC  Z,ZZZ,ZZ9.          05610000
056200     05  FILLER                          PIC  X(04)  VALUE SPACES.05620000
056300     05  PTL-ERROR-RATIO                 PIC  ZZ9.99.             05630000
056400     05  PTL-ERROR-RATIO-X REDEFINES PTL-ERROR-RATIO              05640000
056500                                         PIC  X(6).               05650000
056600     05  PTL-PERCENT                     PIC  X(1)  VALUE '%'.    05660000
056610     05  FILLER                          PIC  X(02)  VALUE SPACES.05661099
056700                                                                  05670000
056800******************************************************************05680000
056900*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *05690000
057000******************************************************************05700000
057200 01  TDH1-TICK-DETAIL-HEADING-1.                                  05720000
057300     05  FILLER                          PIC  X(42)  VALUE SPACE. 05730000
057400     05  FILLER                          PIC  X(31)  VALUE        05740000
057500         'T I C K E T I N G   E R R O R S'.                       05750000
057600     05  FILLER                          PIC  X(59)  VALUE SPACE. 05760000
057610                                                                  05761099
057700******************************************************************05770000
057800 01  TDH1-TICK-DETAIL-HEADING-1A.                                 05780000
057900     05  FILLER                          PIC  X(25)  VALUE SPACE. 05790000
058000     05  FILLER                          PIC  X(56)  VALUE        05800000
058100      'VA-008  VA-032  VA-034   VA-003   VA-004  VA-006  VA-005'. 05810000
058200     05  FILLER                          PIC  X(51)  VALUE SPACE. 05820000
058210                                                                  05821099
058300******************************************************************05830000
058400 01  TDH2-TICK-DETAIL-HEADING-2.                                  05840000
058500     05  FILLER                          PIC  X(14)  VALUE SPACES.05850000
058600     05  FILLER                          PIC  X(08)  VALUE        05860000
058700         'STR NBR '.                                              05870000
058800     05  FILLER                          PIC  X(03)  VALUE SPACES.05880000
058900     05  FILLER                          PIC  X(07)  VALUE        05890000
059000         'MISSING'.                                               05900000
059100     05  FILLER                          PIC  X(01)  VALUE SPACES.05910000
059200     05  FILLER                          PIC  X(06)  VALUE        05920000
059300         ' WRONG'.                                                05930000
059400     05  FILLER                          PIC  X(02)  VALUE SPACES.05940000
059500     05  FILLER                          PIC  X(07)  VALUE        05950000
059600         'WRG LBL'.                                               05960000
059700     05  FILLER                          PIC  X(02)  VALUE SPACES.05970000
059800     05  FILLER                          PIC  X(07)  VALUE        05980000
059900         '  NO   '.                                               05990000
060000     05  FILLER                          PIC  X(02)  VALUE SPACES.06000000
060100     05  FILLER                          PIC  X(07)  VALUE        06010000
060200         'DAMAGED'.                                               06020000
060300     05  FILLER                          PIC  X(02)  VALUE SPACES.06030000
060400     05  FILLER                          PIC  X(05)  VALUE        06040000
060500         'WRONG'.                                                 06050000
060600     05  FILLER                          PIC  X(02)  VALUE SPACES.06060000
060700     05  FILLER                          PIC  X(06)  VALUE        06070000
060800         '      '.                                                06080000
060900     05  FILLER                          PIC  X(02)  VALUE SPACES.06090000
061000     05  FILLER                          PIC  X(07)  VALUE        06100000
061100         '  TOTAL'.                                               06110000
061200     05  FILLER                          PIC  X(01)  VALUE SPACES.06120000
061300     05  FILLER                          PIC  X(09)  VALUE        06130000
061400         'TOT UNITS'.                                             06140000
061500     05  FILLER                          PIC  X(03)  VALUE SPACES.06150000
061600     05  FILLER                          PIC  X(09)  VALUE        06160000
061700         'TOT UNITS'.                                             06170000
061800     05  FILLER                          PIC  X(03)  VALUE SPACES.06180000
061900     05  FILLER                          PIC  X(09)  VALUE        06190000
062000         'TOT UNITS'.                                             06200000
062100     05  FILLER                          PIC  X(03)  VALUE SPACES.06210000
062200     05  FILLER                          PIC  X(05)  VALUE        06220099
062300         'ERROR'.                                                 06230099
062400                                                                  06240000
062500******************************************************************06250000
062600 01  TDH3-TICK-DETAIL-HEADING-3.                                  06260000
062700     05  FILLER                          PIC  X(14)  VALUE SPACES.06270000
062800     05  FILLER                          PIC  X(08)  VALUE        06280000
062900         'W/ERRORS'.                                              06290000
063000     05  FILLER                          PIC  X(03)  VALUE SPACES.06300000
063100     05  FILLER                          PIC  X(07)  VALUE        06310000
063200         'TICKET '.                                               06320000
063300     05  FILLER                          PIC  X(01)  VALUE SPACES.06330000
063400     05  FILLER                          PIC  X(06)  VALUE        06340000
063500         'TICKET'.                                                06350000
063600     05  FILLER                          PIC  X(02)  VALUE SPACES.06360000
063700     05  FILLER                          PIC  X(07)  VALUE        06370000
063800         'ON MDSE'.                                               06380000
063900     05  FILLER                          PIC  X(02)  VALUE SPACES.06390000
064000     05  FILLER                          PIC  X(07)  VALUE        06400000
064100         'BARCODE'.                                               06410000
064200     05  FILLER                          PIC  X(02)  VALUE SPACES.06420000
064300     05  FILLER                          PIC  X(07)  VALUE        06430000
064400         'BARCODE'.                                               06440000
064500     05  FILLER                          PIC  X(02)  VALUE SPACES.06450000
064600     05  FILLER                          PIC  X(05)  VALUE        06460000
064700         ' UPC '.                                                 06470000
064800     05  FILLER                          PIC  X(02)  VALUE SPACES.06480000
064900     05  FILLER                          PIC  X(06)  VALUE        06490000
065000         'NO UPC'.                                                06500000
065100     05  FILLER                          PIC  X(02)  VALUE SPACES.06510000
065200     05  FILLER                          PIC  X(07)  VALUE        06520000
065300         ' ERRORS'.                                               06530000
065400     05  FILLER                          PIC  X(01)  VALUE SPACES.06540000
065500     05  FILLER                          PIC  X(09)  VALUE        06550000
065600         ' IN ERROR'.                                             06560000
065700     05  FILLER                          PIC  X(03)  VALUE SPACES.06570000
065800     05  FILLER                          PIC  X(09)  VALUE        06580000
065900         'TRANSCRIB'.                                             06590000
066000     05  FILLER                          PIC  X(03)  VALUE SPACES.06600000
066100     05  FILLER                          PIC  X(09)  VALUE        06610000
066200         ' AUDITED '.                                             06620000
066300     05  FILLER                          PIC  X(03)  VALUE SPACES.06630000
066400     05  FILLER                          PIC  X(05)  VALUE        06640099
066500         'RATIO'.                                                 06650099
066600                                                                  06660000
066700******************************************************************06670000
066800 01  TDL-TICKETING-DETAIL-LINE.                                   06680000
066900     05  FILLER                          PIC  X(17)  VALUE SPACES.06690000
067000     05  TDL-STORE-NBR                   PIC  9(03).              06700000
067100     05  TDL-STORE-NBR-X REDEFINES TDL-STORE-NBR                  06710000
067200                                         PIC  X(03).              06720000
067300     05  FILLER                          PIC  X(05)  VALUE SPACES.06730000
067400     05  TDL-MISSING-TICKET              PIC  ZZZ9.               06740000
067500     05  FILLER                          PIC  X(05)  VALUE SPACES.06750000
067600     05  TDL-WRONG-TICKET                PIC  ZZZ9.               06760000
067700     05  FILLER                          PIC  X(04)  VALUE SPACES.06770000
067800     05  TDL-WRONG-LABEL                 PIC  ZZZ9.               06780000
067900     05  FILLER                          PIC  X(04)  VALUE SPACES.06790000
068000     05  TDL-NO-BARCODE                  PIC  ZZZ9.               06800000
068100     05  FILLER                          PIC  X(05)  VALUE SPACES.06810000
068200     05  TDL-DAMAGED-BARCODE             PIC  ZZZ9.               06820000
068300     05  FILLER                          PIC  X(04)  VALUE SPACES.06830000
068400     05  TDL-WRONG-UPC                   PIC  ZZZ9.               06840000
068500     05  FILLER                          PIC  X(04)  VALUE SPACES.06850000
068600     05  TDL-NO-UPC                      PIC  ZZZ9.               06860000
068700     05  FILLER                          PIC  X(04)  VALUE SPACES.06870000
068800     05  TDL-TOTAL-ERRORS                PIC  ZZ,ZZ9.             06880000
068900     05  FILLER                          PIC  X(04)  VALUE SPACES.06890000
069000     05  TDL-TOTAL-UNITS-IN-ERROR        PIC  ZZ,ZZ9.             06900000
069100     05  FILLER                          PIC  X(04)  VALUE SPACES.06910000
069200     05  TDL-TOTAL-UNITS-TRNSCRBD        PIC  ZZZ,ZZ9.            06920000
069300     05  FILLER                          PIC  X(04)  VALUE SPACES.06930000
069400     05  TDL-TOTAL-UNITS-AUDITED         PIC  ZZZ,ZZ9.            06940000
069500     05  FILLER                          PIC  X(04)  VALUE SPACES.06950000
069600     05  TDL-ERROR-RATIO                 PIC  ZZ9.99.             06960000
069700     05  TDL-ERROR-RATIO-X  REDEFINES TDL-ERROR-RATIO             06970000
069800                                         PIC  X(06).              06980000
069900     05  TDL-PERCENT                     PIC  X(1)  VALUE '%'.    06990000
070000                                                                  07000000
070100******************************************************************07010000
070200 01  TTL-TICKETING-TOTAL-LINE.                                    07020000
070300     05  TTL-TOTAL-DESCRIPTION           PIC  X(13).              07030000
070400     05  FILLER                          PIC  X(03)  VALUE SPACES.07040000
070500     05  TTL-STORE-NBR                   PIC  ZZZ9.               07050000
070600     05  FILLER                          PIC  X(03)  VALUE SPACES.07060000
070700     05  TTL-MISSING-TICKET              PIC  ZZ,ZZ9.             07070000
070800     05  FILLER                          PIC  X(03)  VALUE SPACES.07080000
070900     05  TTL-WRONG-TICKET                PIC  ZZ,ZZ9.             07090000
071000     05  FILLER                          PIC  X(02)  VALUE SPACES.07100000
071100     05  TTL-WRONG-LABEL                 PIC  ZZ,ZZ9.             07110000
071200     05  FILLER                          PIC  X(02)  VALUE SPACES.07120000
071300     05  TTL-NO-BARCODE                  PIC  ZZ,ZZ9.             07130000
071400     05  FILLER                          PIC  X(03)  VALUE SPACES.07140000
071500     05  TTL-DAMAGED-BARCODE             PIC  ZZ,ZZ9.             07150000
071600     05  FILLER                          PIC  X(02)  VALUE SPACES.07160000
071700     05  TTL-WRONG-UPC                   PIC  ZZ,ZZ9.             07170000
071800     05  FILLER                          PIC  X(02)  VALUE SPACES.07180000
071900     05  TTL-NO-UPC                      PIC  ZZ,ZZ9.             07190000
072000     05  FILLER                          PIC  X(01)  VALUE SPACES.07200000
072100     05  TTL-TOTAL-ERRORS                PIC  Z,ZZZ,ZZ9.          07210000
072200     05  FILLER                          PIC  X(01)  VALUE SPACES.07220000
072300     05  TTL-TOTAL-UNITS-IN-ERROR        PIC  Z,ZZZ,ZZ9.          07230000
072400     05  FILLER                          PIC  X(02)  VALUE SPACES.07240000
072500     05  TTL-TOTAL-UNITS-TRNSCRBD        PIC  Z,ZZZ,ZZ9.          07250000
072600     05  FILLER                          PIC  X(02)  VALUE SPACES.07260000
072700     05  TTL-TOTAL-UNITS-AUDITED         PIC  Z,ZZZ,ZZ9.          07270000
072800     05  FILLER                          PIC  X(04)  VALUE SPACES.07280000
072900     05  TTL-ERROR-RATIO                 PIC  ZZ9.99.             07290000
073000     05  TTL-ERROR-RATIO-X  REDEFINES TTL-ERROR-RATIO             07300000
073100                                         PIC  X(06).              07310000
073200     05  TTL-PERCENT                     PIC  X(1)  VALUE '%'.    07320000
073300                                                                  07330000
073400                                                                  07340000
073500******************************************************************07350000
073600*     TOTAL FOOTERS        TOTAL FOOTERS         TOTAL FOOTERS   *07360000
073700******************************************************************07370000
073800******************************************************************07380000
073900 01  TRL-TOTAL-RATIO-LINE.                                        07390000
074000     05  TRL-TOTAL-RATIO-DESC            PIC  X(31).              07400000
074100     05  TRL-TOTAL-RATIO                 PIC  ZZ9.99.             07410000
074200     05  FILLER                          PIC  X(01)  VALUE '%'.   07420000
074300     05  FILLER                          PIC  X(94)  VALUE SPACES.07430099
074900                                                                  07490000
075100******************************************************************07510000
075200*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *07520000
075300******************************************************************07530000
075500 01  RDH1-RFID-DETAIL-HEADING-1.                                  07550000
075600     05  FILLER                          PIC  X(52)  VALUE SPACE. 07560000
075700     05  FILLER                          PIC  X(21)  VALUE        07570000
075800         'R F I D   E R R O R S'.                                 07580000
075900     05  FILLER                          PIC  X(59)  VALUE SPACE. 07590000
075910                                                                  07591099
076000******************************************************************07600000
076100 01  RDH1-RFID-DETAIL-HEADING-1A.                                 07610000
076200     05  FILLER                          PIC  X(25)  VALUE SPACE. 07620000
076300     05  FILLER                          PIC  X(40)  VALUE        07630000
076400      'VA-038  VA-039  VA-040   VA-041   VA-042'.                 07640000
076500     05  FILLER                          PIC  X(67)  VALUE SPACE. 07650000
076510                                                                  07651099
076600******************************************************************07660000
076700 01  RDH2-RFID-DETAIL-HEADING-2.                                  07670000
076800     05  FILLER                          PIC  X(14)  VALUE SPACES.07680000
076900     05  FILLER                          PIC  X(08)  VALUE        07690000
077000         'STR NBR '.                                              07700000
077100     05  FILLER                          PIC  X(03)  VALUE SPACES.07710000
077200     05  FILLER                          PIC  X(06)  VALUE        07720000
077300         '  UPC '.                                                07730000
077400     05  FILLER                          PIC  X(02)  VALUE SPACES.07740000
077500     05  FILLER                          PIC  X(06)  VALUE        07750000
077600         ' WRONG'.                                                07760000
077700     05  FILLER                          PIC  X(02)  VALUE SPACES.07770000
077800     05  FILLER                          PIC  X(06)  VALUE        07780000
077900         ' WRONG'.                                                07790000
078000     05  FILLER                          PIC  X(03)  VALUE SPACES.07800000
078100     05  FILLER                          PIC  X(06)  VALUE        07810000
078200         ' WRONG'.                                                07820000
078300     05  FILLER                          PIC  X(03)  VALUE SPACES.07830000
078400     05  FILLER                          PIC  X(07)  VALUE        07840000
078500         'MISSING'.                                               07850000
078600     05  FILLER                          PIC  X(02)  VALUE SPACES.07860000
078700     05  FILLER                          PIC  X(05)  VALUE        07870000
078800         '     '.                                                 07880000
078900     05  FILLER                          PIC  X(02)  VALUE SPACES.07890000
079000     05  FILLER                          PIC  X(06)  VALUE        07900000
079100         '      '.                                                07910000
079200     05  FILLER                          PIC  X(02)  VALUE SPACES.07920000
079300     05  FILLER                          PIC  X(07)  VALUE        07930000
079400         '  TOTAL'.                                               07940000
079500     05  FILLER                          PIC  X(01)  VALUE SPACES.07950000
079600     05  FILLER                          PIC  X(09)  VALUE        07960000
079700         'TOT UNITS'.                                             07970000
079800     05  FILLER                          PIC  X(03)  VALUE SPACES.07980000
079900     05  FILLER                          PIC  X(09)  VALUE        07990000
080000         'TOT UNITS'.                                             08000000
080100     05  FILLER                          PIC  X(03)  VALUE SPACES.08010000
080200     05  FILLER                          PIC  X(09)  VALUE        08020000
080300         'TOT UNITS'.                                             08030000
080400     05  FILLER                          PIC  X(03)  VALUE SPACES.08040000
080500     05  FILLER                          PIC  X(05)  VALUE        08050099
080600         'ERROR'.                                                 08060099
080700                                                                  08070000
080800******************************************************************08080000
080900 01  RDH3-RFID-DETAIL-HEADING-3.                                  08090000
081000     05  FILLER                          PIC  X(14)  VALUE SPACES.08100000
081100     05  FILLER                          PIC  X(08)  VALUE        08110000
081200         'W/ERRORS'.                                              08120000
081300     05  FILLER                          PIC  X(03)  VALUE SPACES.08130000
081400     05  FILLER                          PIC  X(07)  VALUE        08140000
081500         ' MISPCK'.                                               08150000
081600     05  FILLER                          PIC  X(02)  VALUE SPACES.08160000
081700     05  FILLER                          PIC  X(06)  VALUE        08170000
081800         'COLOR '.                                                08180000
081900     05  FILLER                          PIC  X(02)  VALUE SPACES.08190000
082000     05  FILLER                          PIC  X(07)  VALUE        08200000
082100         'SIZE   '.                                               08210000
082200     05  FILLER                          PIC  X(02)  VALUE SPACES.08220000
082300     05  FILLER                          PIC  X(07)  VALUE        08230000
082400         'STYLE  '.                                               08240000
082500     05  FILLER                          PIC  X(01)  VALUE SPACES.08250000
082600     05  FILLER                          PIC  X(07)  VALUE        08260000
082700         'TICKET '.                                               08270000
082800     05  FILLER                          PIC  X(02)  VALUE SPACES.08280000
082900     05  FILLER                          PIC  X(05)  VALUE        08290000
083000         '     '.                                                 08300000
083100     05  FILLER                          PIC  X(02)  VALUE SPACES.08310000
083200     05  FILLER                          PIC  X(06)  VALUE        08320000
083300         '      '.                                                08330000
083400     05  FILLER                          PIC  X(02)  VALUE SPACES.08340000
083500     05  FILLER                          PIC  X(07)  VALUE        08350000
083600         ' ERRORS'.                                               08360000
083700     05  FILLER                          PIC  X(01)  VALUE SPACES.08370000
083800     05  FILLER                          PIC  X(09)  VALUE        08380000
083900         ' IN ERROR'.                                             08390000
084000     05  FILLER                          PIC  X(03)  VALUE SPACES.08400000
084100     05  FILLER                          PIC  X(09)  VALUE        08410000
084200         'TRANSCRIB'.                                             08420000
084300     05  FILLER                          PIC  X(03)  VALUE SPACES.08430000
084400     05  FILLER                          PIC  X(09)  VALUE        08440000
084500         ' AUDITED '.                                             08450000
084600     05  FILLER                          PIC  X(03)  VALUE SPACES.08460000
084700     05  FILLER                          PIC  X(05)  VALUE        08470099
084800         'RATIO'.                                                 08480099
084900                                                                  08490000
085000******************************************************************08500000
085100 01  RDL-RFID-DETAIL-LINE.                                        08510000
085200     05  FILLER                          PIC  X(17)  VALUE SPACES.08520000
085300     05  RDL-STORE-NBR                   PIC  9(03).              08530000
085400     05  RDL-STORE-NBR-X REDEFINES RDL-STORE-NBR                  08540000
085500                                         PIC  X(03).              08550000
085600     05  FILLER                          PIC  X(05)  VALUE SPACES.08560000
085700     05  RDL-NO-EPC-LOGO                 PIC  ZZZ9.               08570000
085800     05  FILLER                          PIC  X(05)  VALUE SPACES.08580000
085900     05  RDL-WRONG-COLOR                 PIC  ZZZ9.               08590000
086000     05  FILLER                          PIC  X(04)  VALUE SPACES.08600000
086100     05  RDL-WRONG-SIZE                  PIC  ZZZ9.               08610000
086200     05  FILLER                          PIC  X(04)  VALUE SPACES.08620000
086300     05  RDL-WRONG-STYLE                 PIC  ZZZ9.               08630000
086400     05  FILLER                          PIC  X(05)  VALUE SPACES.08640000
086500     05  RDL-NO-RFID-TICKET              PIC  ZZZ9.               08650000
086600     05  FILLER                          PIC  X(04)  VALUE SPACES.08660000
086700     05  FILLER                          PIC  X(04)  VALUE SPACES.08670000
086800     05  FILLER                          PIC  X(04)  VALUE SPACES.08680000
086900     05  FILLER                          PIC  X(04)  VALUE SPACES.08690000
087000     05  FILLER                          PIC  X(04)  VALUE SPACES.08700000
087100     05  RDL-TOTAL-ERRORS                PIC  ZZ,ZZ9.             08710000
087200     05  FILLER                          PIC  X(04)  VALUE SPACES.08720000
087300     05  RDL-TOTAL-UNITS-IN-ERROR        PIC  ZZ,ZZ9.             08730000
087400     05  FILLER                          PIC  X(04)  VALUE SPACES.08740000
087500     05  RDL-TOTAL-UNITS-TRNSCRBD        PIC  ZZZ,ZZ9.            08750000
087600     05  FILLER                          PIC  X(04)  VALUE SPACES.08760000
087700     05  RDL-TOTAL-UNITS-AUDITED         PIC  ZZZ,ZZ9.            08770000
087800     05  FILLER                          PIC  X(04)  VALUE SPACES.08780000
087900     05  RDL-ERROR-RATIO                 PIC  ZZ9.99.             08790000
088000     05  RDL-ERROR-RATIO-X  REDEFINES RDL-ERROR-RATIO             08800000
088100                                         PIC  X(06).              08810000
088200     05  RDL-PERCENT                     PIC  X(1)  VALUE '%'.    08820000
088300                                                                  08830000
088400******************************************************************08840000
088500 01  RTL-RFID-TOTAL-LINE.                                         08850000
088600     05  RTL-TOTAL-DESCRIPTION           PIC  X(13).              08860000
088700     05  FILLER                          PIC  X(03)  VALUE SPACES.08870000
088800     05  RTL-STORE-NBR                   PIC  ZZZ9.               08880000
088900     05  FILLER                          PIC  X(03)  VALUE SPACES.08890000
089000     05  RTL-NO-EPC-LOGO                 PIC  ZZ,ZZ9.             08900000
089100     05  FILLER                          PIC  X(03)  VALUE SPACES.08910000
089200     05  RTL-WRONG-COLOR                 PIC  ZZ,ZZ9.             08920000
089300     05  FILLER                          PIC  X(02)  VALUE SPACES.08930000
089400     05  RTL-WRONG-SIZE                  PIC  ZZ,ZZ9.             08940000
089500     05  FILLER                          PIC  X(02)  VALUE SPACES.08950000
089600     05  RTL-WRONG-STYLE                 PIC  ZZ,ZZ9.             08960000
089700     05  FILLER                          PIC  X(03)  VALUE SPACES.08970000
089800     05  RTL-NO-RFID-TICKET              PIC  ZZ,ZZ9.             08980000
089900     05  FILLER                          PIC  X(02)  VALUE SPACES.08990000
090000     05  FILLER                          PIC  X(06)  VALUE SPACES.09000000
090100     05  FILLER                          PIC  X(02)  VALUE SPACES.09010000
090200     05  FILLER                          PIC  X(06)  VALUE SPACES.09020000
090300     05  FILLER                          PIC  X(01)  VALUE SPACES.09030000
090400     05  RTL-TOTAL-ERRORS                PIC  Z,ZZZ,ZZ9.          09040000
090500     05  FILLER                          PIC  X(01)  VALUE SPACES.09050000
090600     05  RTL-TOTAL-UNITS-IN-ERROR        PIC  Z,ZZZ,ZZ9.          09060000
090700     05  FILLER                          PIC  X(02)  VALUE SPACES.09070000
090800     05  RTL-TOTAL-UNITS-TRNSCRBD        PIC  Z,ZZZ,ZZ9.          09080000
090900     05  FILLER                          PIC  X(02)  VALUE SPACES.09090000
091000     05  RTL-TOTAL-UNITS-AUDITED         PIC  Z,ZZZ,ZZ9.          09100000
091100     05  FILLER                          PIC  X(04)  VALUE SPACES.09110000
091200     05  RTL-ERROR-RATIO                 PIC  ZZ9.99.             09120000
091300     05  RTL-ERROR-RATIO-X  REDEFINES RTL-ERROR-RATIO             09130000
091400                                         PIC  X(06).              09140000
091500     05  RTL-PERCENT                     PIC  X(1)  VALUE '%'.    09150000
091700                                                                  09170000
091800******************************************************************09180000
091900 01  ARL1-AUDITING-REQUIRED-LINE-1.                               09190000
092000     05  FILLER                          PIC X(132) VALUE ALL '*'.09200000
092010                                                                  09201099
092100******************************************************************09210000
092200 01  ARL2-AUDITING-REQUIRED-LINE-2.                               09220000
092300     05  FILLER                          PIC X(043) VALUE ALL '*'.09230000
092400     05  FILLER                          PIC X(045) VALUE         09240000
092500         '   AUDITING REQUIRED ON ADDITIONAL CARTONS   '.         09250000
092600     05  FILLER                          PIC X(044) VALUE ALL '*'.09260000
092700                                                                  09270000
092800******************************************************************09280000
092900 01  AS1-AUDITED-STORES-1.                                        09290000
093000     05  AS1-AUDITED-STORE-DESC          PIC  X(16) VALUE SPACES. 09300000
093100     05  AS1-AUDITED-STORES-TABLE.                                09310000
093200       07 FILLER  OCCURS 20 TIMES                                 09320000
093300                  INDEXED BY AS1-AUD-STR-IDX.                     09330000
093400         10 AS1-STR-NBR                  PIC  X(03) VALUE SPACE.  09340000
093500         10 AS1-COMMA                    PIC  X(01) VALUE SPACE.  09350000
093600         10 FILLER                       PIC  X(01) VALUE SPACE.  09360000
093610                                                                  09361099
093700******************************************************************09370000
093800 01  PV-AUDITED-STORES.                                           09380000
093900     05  PV-MAX-STORES                   PIC S9(04) COMP          09390000
094000                                                    VALUE +200.   09400000
094100     05  PV-STR-COUNT                    PIC S9(04) COMP.         09410000
094200     05  PV-STR-REMAINDER                PIC S9(04) COMP.         09420000
094300     05  PV-STR-LINES                    PIC S9(04) COMP.         09430000
094400     05  PV-AUDITED-STORES-TABLE.                                 09440000
094500       07  FILLER  OCCURS 200 TIMES                               09450000
094600                  INDEXED BY PV-AUD-STR-IDX.                      09460000
094700         10  PV-STR-NBR                  PIC  9(03) VALUE 0.      09470000
094800******************************************************************09480000
094900                                                                  09490000
095000 01  BLANK-LINE.                                                  09500000
095100     05  FILLER                          PIC  X(132) VALUE SPACE. 09510000
095200                                                                  09520000
095300 01  END-OF-REPORT-LINE.                                          09530000
095400     05  FILLER                          PIC  X(53)  VALUE SPACE. 09540099
095500     05  FILLER                          PIC  X(25)  VALUE        09550000
095600         '***** END OF REPORT *****'.                             09560000
095700     05  FILLER                          PIC  X(54)  VALUE SPACE. 09570099
095800                                                                  09580000
095900 01  NO-DATA-LINE.                                                09590000
096000     05  FILLER                          PIC  X(48)  VALUE SPACE. 09600099
096100     05  FILLER                          PIC  X(35)  VALUE        09610000
096200         '********* NO DATA TO REPORT *******'.                   09620000
096300     05  FILLER                          PIC  X(49)  VALUE SPACE. 09630099
096400                                                                  09640000
096500                                                                  09650000
096600                                                                  09660000
096700 01  DK-DB2-KEY-VALUE.                                            09670000
096800     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         09680000
096900     05  DK-AUD-CNTL-NBR                 PIC S9(09) COMP.         09690000
097000     05  DK-PO-NBR                       PIC S9(09) COMP.         09700000
097100     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP.         09710000
097200                                                                  09720000
097300 01  PA-PROGRAM-ACCUMULATORS.                                     09730000
097400     05  PA-RECEIVER-ACCUM.                                       09740000
097500         10 PA-VENDOR-OVER             PIC  S9(5) COMP-3.         09750000
097600         10 PA-VENDOR-SHORT            PIC  S9(6) COMP-3.         09760000
097700         10 PA-RECEIVER-OVER           PIC  S9(5) COMP-3.         09770000
097800         10 PA-RECEIVER-SHORT          PIC  S9(5) COMP-3.         09780000
097900         10 PA-STYLE-SUB               PIC  S9(5) COMP-3.         09790000
098000         10 PA-DAMAGED-UNITS           PIC  S9(5) COMP-3.         09800000
098400         10 PA-MISSING-TICKET          PIC  S9(5) COMP-3.         09840000
098500         10 PA-WRONG-TICKET            PIC  S9(5) COMP-3.         09850000
098600         10 PA-WRONG-LABEL             PIC  S9(5) COMP-3.         09860000
098700         10 PA-NO-BARCODE              PIC  S9(5) COMP-3.         09870000
098800         10 PA-DAMAGED-BARCODE         PIC  S9(5) COMP-3.         09880000
098900         10 PA-WRONG-UPC               PIC  S9(5) COMP-3.         09890000
099000         10 PA-NO-UPC                  PIC  S9(5) COMP-3.         09900000
099100         10 PA-NET-UNTS-IN-ERROR       PIC  S9(7) COMP-3.         09910000
099300         10 PA-NO-EPC-LOGO             PIC  S9(5) COMP-3.         09930000
099400         10 PA-WRONG-COLOR             PIC  S9(5) COMP-3.         09940000
099500         10 PA-WRONG-SIZE              PIC  S9(5) COMP-3.         09950000
099600         10 PA-WRONG-STYLE             PIC  S9(5) COMP-3.         09960000
099700         10 PA-NO-RFID-TICKET          PIC  S9(5) COMP-3.         09970000
099900                                                                  09990000
100000*         PICKING TOTAL FIELDS                                    10000000
100100         10 PA-TOT-ERRS-PIC            PIC  S9(7) COMP-3.         10010000
100200         10 PA-TOT-UNTS-IN-ERR-PIC     PIC  S9(7) COMP-3.         10020000
100300         10 PA-STRS-W-ERRS-PIC         PIC  S9(5) COMP-3.         10030000
100400         10 PA-STRS-W-NO-ERRS-PIC      PIC  S9(5) COMP-3.         10040000
100500         10 PA-STR-COUNT-PIC           PIC  S9(5) COMP-3.         10050000
100600         10 PA-UNTS-TRNS-PIC           PIC  S9(7) COMP-3.         10060000
100700         10 PA-UNTS-AUD-PIC            PIC  S9(7) COMP-3.         10070000
100800         10 PA-TOT-UNTS-TRNS-IE-PIC    PIC  S9(7) COMP-3.         10080000
100900         10 PA-TOT-UNTS-AUD-IE-PIC     PIC  S9(7) COMP-3.         10090000
101000         10 PA-TOT-UNTS-TRNS-NE-PIC    PIC  S9(7) COMP-3.         10100000
101100         10 PA-TOT-UNTS-AUD-NE-PIC     PIC  S9(7) COMP-3.         10110000
101200                                                                  10120000
101300*        TICKETING TOTAL FIELDS                                   10130000
101400         10 PA-TOT-ERRS-TIC            PIC  S9(7) COMP-3.         10140000
101500         10 PA-TOT-UNTS-IN-ERR-TIC     PIC  S9(7) COMP-3.         10150000
101600         10 PA-STRS-W-ERRS-TIC         PIC  S9(5) COMP-3.         10160000
101700         10 PA-STRS-W-NO-ERRS-TIC      PIC  S9(5) COMP-3.         10170000
101800         10 PA-STR-COUNT-TIC           PIC  S9(5) COMP-3.         10180000
101900         10 PA-UNTS-TRNS-TIC           PIC  S9(7) COMP-3.         10190000
102000         10 PA-UNTS-AUD-TIC            PIC  S9(7) COMP-3.         10200000
102100         10 PA-TOT-UNTS-TRNS-IE-TIC    PIC  S9(7) COMP-3.         10210000
102200         10 PA-TOT-UNTS-AUD-IE-TIC     PIC  S9(7) COMP-3.         10220000
102300         10 PA-TOT-UNTS-TRNS-NE-TIC    PIC  S9(7) COMP-3.         10230000
102400         10 PA-TOT-UNTS-AUD-NE-TIC     PIC  S9(7) COMP-3.         10240000
102500                                                                  10250000
102700*        RFID TOTAL FIELDS                                        10270000
102800         10 PA-TOT-ERRS-RFID           PIC  S9(7) COMP-3.         10280000
102900         10 PA-TOT-UNTS-IN-ERR-RFID    PIC  S9(7) COMP-3.         10290000
103000         10 PA-STRS-W-ERRS-RFID        PIC  S9(5) COMP-3.         10300000
103100         10 PA-STRS-W-NO-ERRS-RFID     PIC  S9(5) COMP-3.         10310000
103200         10 PA-STR-COUNT-RFID          PIC  S9(5) COMP-3.         10320000
103300         10 PA-UNTS-TRNS-RFID          PIC  S9(7) COMP-3.         10330000
103400         10 PA-UNTS-AUD-RFID           PIC  S9(7) COMP-3.         10340000
103500         10 PA-TOT-UNTS-TRNS-IE-RFID   PIC  S9(7) COMP-3.         10350000
103600         10 PA-TOT-UNTS-AUD-IE-RFID    PIC  S9(7) COMP-3.         10360000
103700         10 PA-TOT-UNTS-TRNS-NE-RFID   PIC  S9(7) COMP-3.         10370000
103800         10 PA-TOT-UNTS-AUD-NE-RFID    PIC  S9(7) COMP-3.         10380000
103900         10 PA-TOT-UNTS-AUDITED-RFID   PIC  S9(7) COMP-3.         10390000
104100                                                                  10410000
104200 01  PC-CONSTANTS.                                                10420000
104300     05  PC-MAX-STRS-PER-LINE            PIC S9(04) COMP          10430000
104400                                                    VALUE +20.    10440000
104500     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    10450000
104600                                                     COMP SYNC.   10460000
104700     05  PC-ZERO                         PIC  9(01)  VALUE 0.     10470000
104800     05  PC-ONE                          PIC  9(01)  VALUE 1.     10480000
104900     05  PC-TWO                          PIC  9(01)  VALUE 2.     10490000
105000     05  PC-THREE                        PIC  9(01)  VALUE 3.     10500000
105100     05  PC-FOUR                         PIC  9(01)  VALUE 4.     10510000
105200     05  PC-EIGHT                        PIC  9(01)  VALUE 8.     10520000
105300     05  PC-NINE                         PIC  9(01)  VALUE 9.     10530000
105400     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  10540000
105500     05  PC-NINES-TIMESTAMP              PIC  X(26)  VALUE        10550000
105600         '9999-09-09-09.09.09.999999'.                            10560000
105700     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        10570000
105800         'SUKRP009'.                                              10580000
105900     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        10590000
106000         'SUK905  '.                                              10600000
106100                                                                  10610000
106200 01  CC-CONTROL-CARD.                                             10620000
106300     05  CC-PRINTER-ID                PIC  X(08)  VALUE SPACES.   10630000
106310         88 CC-FLAT-FILE                          VALUE 'FILE'.   10631099
106400     05  CC-PRTR-CNTL-IND             PIC  X(01)  VALUE SPACE.    10640000
106500     05  CC-TRACK-NBR                 PIC  9(01)  VALUE ZERO.     10650000
106700     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    10670000
106800     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    10680000
106801*                                                                 10680199
106810     05  CC-CNTL-CARD-OPER            PIC  9(04)  VALUE ZEROES.   10681099
106820     05  CC-CNTL-CARD-USERID          PIC  X(08)  VALUE SPACES.   10682099
106830     05  CC-CNTL-CARD-AUD-NBR         PIC  9(09)  VALUE ZEROES.   10683099
106860     05  FILLER                       PIC  X(48)  VALUE SPACES.   10686099
106900                                                                  10690000
107000 01  PS-PROGRAM-SWITCHES.                                         10700000
107100     05  PS-DATA-IND                     PIC  X(01)  VALUE 'N'.   10710000
107200         88  PS-DATA                                 VALUE 'Y'.   10720000
107300         88  PS-NO-DATA                              VALUE 'N'.   10730000
107400     05  PS-EOF-AUDIT-SUM-EXTRACT-IND    PIC  X(01)  VALUE 'N'.   10740000
107500         88  PS-EOF-AUDIT-SUM-EXTRACT                VALUE 'Y'.   10750000
107600         88  PS-NOT-EOF-AUDIT-SUM-EXTRACT            VALUE 'N'.   10760000
107700     05  PS-EOF-AUD-STR-CURSOR-IND       PIC  X(01)  VALUE 'N'.   10770000
107800         88  PS-EOF-AUD-STR-CURSOR                   VALUE 'Y'.   10780000
107900         88  PS-NOT-EOF-AUD-STR-CURSOR               VALUE 'N'.   10790000
108000     05  PS-EOF-RECEIVER-CURSOR-IND      PIC  X(01)  VALUE 'N'.   10800000
108100         88  PS-EOF-RECEIVER-CURSOR                  VALUE 'Y'.   10810000
108200         88  PS-NOT-EOF-RECEIVER-CURSOR              VALUE 'N'.   10820000
108300     05  PS-EOF-UID-CURSOR-IND           PIC  X(01)  VALUE 'N'.   10830000
108400         88  PS-EOF-UID-CURSOR                       VALUE 'Y'.   10840000
108500         88  PS-NOT-EOF-UID-CURSOR                   VALUE 'N'.   10850000
108600     05  PS-PRINT-PICK-HEADING-IND       PIC  X(01)  VALUE 'N'.   10860000
108700         88  PS-PRINT-PICK-HEADING                   VALUE 'Y'.   10870000
108800         88  PS-DONT-PRINT-PICK-HEADING              VALUE 'N'.   10880000
108900     05  PS-PRINT-TICK-HEADING-IND       PIC  X(01)  VALUE 'N'.   10890000
109000         88  PS-PRINT-TICK-HEADING                   VALUE 'Y'.   10900000
109100         88  PS-DONT-PRINT-TICK-HEADING              VALUE 'N'.   10910000
109300     05  PS-PRINT-RFID-HEADING-IND       PIC  X(01)  VALUE 'N'.   10930000
109400         88  PS-PRINT-RFID-HEADING                   VALUE 'Y'.   10940000
109500         88  PS-DONT-PRINT-RFID-HEADING              VALUE 'N'.   10950000
109700     05  PS-PRINT-DETAIL-IND             PIC  X(01)  VALUE 'N'.   10970000
109800         88  PS-PRINT-DETAIL                         VALUE 'Y'.   10980000
109900         88  PS-DONT-PRINT-DETAIL                    VALUE 'N'.   10990000
109910     05  PS-PO-EXCEPTION-SW              PIC  X(01)  VALUE SPACE. 10991000
109920         88 PS-PO-EXCEPTION              VALUE 'Y'.               10992000
109930         88 PS-NO-PO-EXCEPTION           VALUE 'N'.               10993000
109931     05  PS-VENDOR-RFID-AGRMNT-SW        PIC  X(01)  VALUE SPACE. 10993100
109932         88 PS-VENDOR-TAGGING            VALUE 'T'.               10993200
109933         88 PS-VENDOR-COMPLIANT          VALUE 'C'.               10993300
109934         88 PS-VENDOR-NOT-TAGGING        VALUE 'N'.               10993400
109951     05  PS-DEPT-RFID-TAGGING-SW         PIC  X(01)  VALUE SPACE. 10995100
109952         88 PS-DEPT-TAGGING              VALUE 'Y'.               10995200
109953         88 PS-DEPT-NOT-TAGGING          VALUE 'N'.               10995300
110000                                                                  11000000
110100 01  PV-PROGRAM-VARIABLES.                                        11010000
110200     05  PV-DISP-AUD-CNTL-NBR            PIC  9(09).              11020000
110300     05  PV-DISP-PO-NBR                  PIC  9(09).              11030000
110400     05  PV-DISP-REC-SEQ-NBR             PIC  9(09).              11040000
110500     05  PV-DISP-OPER-UNT-ID             PIC  9(09).              11050000
110600     05  PV-SPOT-PERCENT                 PIC S9(3)V9(4) COMP.     11060000
110700     05  PV-ERROR-RATIO                  PIC S9(3)V9(4) COMP.     11070000
110800     05  PV-CARTONS-LEFT                 PIC S9(09)  VALUE ZERO   11080000
110900                                                     COMP.        11090000
111000     05  PV-OPER-UNT-ID                  PIC  9(03).              11100000
111100     05  PV-HOLD-PO-NBR                  PIC S9(09)  VALUE ZERO   11110000
111200                                                     COMP.        11120000
111300     05  PV-HOLD-REC-SEQ-NBR             PIC S9(09)  VALUE ZERO   11130000
111400                                                     COMP.        11140000
111500     05  PV-VENDOR-NAME                  PIC  X(19)  VALUE SPACES.11150000
111600     05  PV-HOLD-UID                     PIC  X(07)  VALUE SPACES.11160000
111700     05  PV-HOUR-COUNT                   PIC S9(09)  VALUE ZERO   11170000
111800                                                     COMP.        11180000
111900     05  PV-DAY-COUNT                    PIC S9(09)  VALUE ZERO   11190000
112000                                                     COMP.        11200000
112100     05  PV-MINUTE-COUNT                 PIC S9(09)  VALUE ZERO   11210000
112200                                                     COMP.        11220000
112300     05  PV-RECEIPT-DATE                 PIC  X(10)  VALUE SPACES.11230000
112400     05  PV-UNITS-TRNSCRBD               PIC S9(09)  VALUE ZERO   11240000
112500                                                     COMP.        11250000
112600     05  PV-AUDIT-CARTON-COUNT           PIC S9(09)  VALUE ZERO   11260000
112700                                                     COMP.        11270000
112800     05  PV-AUDIT-UNIT-COUNT             PIC S9(09)  VALUE ZERO   11280000
112900                                                     COMP.        11290000
113100     05  PV-AUDIT-UNIT-COUNT-RFID        PIC S9(09)  VALUE ZERO   11310000
113200                                                     COMP.        11320000
113210     05  PV-AUDIT-NOT-TAGGED-RFID        PIC S9(09)  VALUE ZERO   11321000
113220                                                     COMP.        11322000
113400     05  PV-DURATION-TOTAL               PIC S9(09)  VALUE +0     11340000
113500                                                     COMP.        11350000
113600     05  PV-DURATION-HOURS               PIC S9(09)  VALUE +0     11360000
113700                                                     COMP.        11370000
113800     05  PV-DURATION-MINUTES             PIC S9(09)  VALUE +0     11380000
113900                                                     COMP.        11390000
114000     05  PV-TIMESTAMP.                                            11400000
114100         10 PV-TIMESTAMP-DATE            PIC  X(10)  VALUE SPACES.11410000
114200         10 FILLER                       PIC  X(01)  VALUE SPACES.11420000
114300         10 PV-TIMESTAMP-TIME            PIC  X(08)  VALUE SPACES.11430000
114400         10 FILLER                       PIC  X(07)  VALUE SPACES.11440000
114500     05  PV-CURR-TMST                    PIC  X(26)  VALUE SPACES.11450000
114600     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.11460000
114700     05  PV-PREV-DEPT                    PIC  X(03)  VALUE SPACES.11470000
114800     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.11480000
114900     05  PV-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.11490000
115000     05  PV-SORT-RETURN              PIC  9(02)      VALUE ZERO.  11500000
115100     05  PV-DETAIL-PAGE-COUNT            PIC S9(04)  VALUE +0     11510000
115200                                                     COMP SYNC.   11520000
115300     05  PV-DETAIL-LINE-COUNT            PIC S9(04)  VALUE +0     11530000
115400                                                     COMP SYNC.   11540000
115500     05  PV-SUM-PAGE-COUNT               PIC S9(04)  VALUE +0     11550000
115600                                                     COMP SYNC.   11560000
115700     05  PV-SUM-LINE-COUNT               PIC S9(04)  VALUE +0     11570000
115800                                                     COMP SYNC.   11580000
115900     05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     11590000
116000                                                     COMP SYNC.   11600000
116100     05  PV-TOTAL-APPROVED-DOLLARS       PIC S9(09)V9(02)         11610000
116200                                                     VALUE +0     11620000
116300                                                     COMP-3.      11630000
116400     05  PV-TOTAL-DECLINED-DOLLARS       PIC S9(09)V9(02)         11640000
116500                                                     VALUE +0     11650000
116600                                                     COMP-3.      11660000
116700     05  PV-TOTAL-APPROVED-REFERRALS     PIC  9(09)  VALUE ZEROS  11670000
116800                                                     COMP-3.      11680000
116900     05  PV-TOTAL-DECLINED-REFERRALS     PIC  9(09)  VALUE ZEROS  11690000
117000                                                     COMP-3.      11700000
117100     05  PV-DOLLARS                      PIC  9(04)V9(02)         11710000
117200                                                     VALUE ZEROS. 11720000
117300                                                                  11730000
117400     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 11740000
117500     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 11750000
117600     05  PV-DB2-FIELD-1                  PIC  X(30)  VALUE SPACE. 11760000
117700     05  PV-DB2-FIELD-2                  PIC  X(30)  VALUE SPACE. 11770000
117800     05  PV-DB2-FIELD-3                  PIC  X(30)  VALUE SPACE. 11780000
117900     05  PV-DB2-OPER-UNT-ID              PIC  X(03).              11790000
118000     05  PV-DB2-CURR-TIMESTAMP           PIC  X(26).              11800000
118100     05  PV-CURR-TIMESTAMP.                                       11810000
118200         10  PV-CURR-DATE.                                        11820000
118300             15  PV-CURR-CC              PIC  X(02).              11830000
118400             15  PV-CURR-YY              PIC  X(02).              11840000
118500             15  FILLER                  PIC  X.                  11850000
118600             15  PV-CURR-MM              PIC  X(02).              11860000
118700             15  FILLER                  PIC  X.                  11870000
118800             15  PV-CURR-DD              PIC  X(02).              11880000
118900         10  FILLER                      PIC  X(01).              11890000
119000         10  PV-CURR-TIME.                                        11900000
119100             15  PV-CURR-HH              PIC  X(02).              11910000
119200             15  FILLER                  PIC  X.                  11920000
119300             15  PV-CURR-MIN             PIC  X(02).              11930000
119400             15  FILLER                  PIC  X.                  11940000
119500             15  PV-CURR-SS              PIC  X(02).              11950000
119600         10  FILLER                      PIC  X(07).              11960000
119700     05  PV-WORK-DATE.                                            11970000
119800         10  PV-WORK-MONTH               PIC  9(02).              11980000
119900         10  FILLER                      PIC  X(01) VALUE '/'.    11990000
120000         10  PV-WORK-DAY                 PIC  9(02).              12000000
120100         10  FILLER                      PIC  X(01) VALUE '/'.    12010000
120200         10  PV-WORK-YEAR                PIC  9(02).              12020000
120300     05  PV-AUDIT-TYPE                   PIC  X(02)  VALUE SPACE. 12030000
120400         88  PV-100-AUDIT-CHECK          VALUE '01'.              12040000
120500         88  PV-SPOT-AUDIT-CHECK         VALUE '02'.              12050000
120600         88  PV-REWORK-AUDIT-CHECK       VALUE '03'.              12060000
120700     05  PV-AUDIT-STATUS                 PIC  X(02)  VALUE SPACE. 12070000
120800         88  PV-AUDIT-INPROCESS          VALUE 'IP'.              12080000
120900         88  PV-AUDIT-COMPLETE           VALUE 'CM'.              12090000
121000         88  PV-AUDIT-POSTPONE           VALUE 'PP'.              12100000
121010     05  PV-COUNT                        PIC S9(04)  COMP.        12101000
121100                                                                  12110099
121200*  LOGISTICS DOMAIN LOCATION MODULE                               12120000
121300     COPY XLWS071.                                                12130000
121400                                                                  12140099
121500*                                                                 12150000
122100******************************************************************12210000
122200*  WORK FIELDS FOR THE MBS SUBROUTINE                             12220000
122300******************************************************************12230000
122400     COPY DPWS003.                                                12240000
122500*                                                                 12250000
122600******************************************************************12260000
122700*  DB2 COMMUNICATION AREA.                                        12270000
122800******************************************************************12280000
122900     EXEC SQL                                                     12290000
123000          INCLUDE SQLCA                                           12300000
123100     END-EXEC.                                                    12310000
123200*                                                                 12320000
123300*                                                                 12330000
123400******************************************************************12340000
123500*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     12350000
123600*  AUDIT TABLE (TSUNAUD)                                          12360000
123700******************************************************************12370000
123800     EXEC SQL                                                     12380000
123900          INCLUDE TSUNAUD                                         12390000
124000     END-EXEC.                                                    12400000
124100*                                                                 12410000
124200*                                                                 12420000
124300******************************************************************12430000
124400*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     12440000
124500*  AUDIT TRANSACTIONS TABLE (TSUATRN)                             12450000
124600******************************************************************12460000
124700     EXEC SQL                                                     12470000
124800          INCLUDE TSUATRN                                         12480000
124900     END-EXEC.                                                    12490000
125000*                                                                 12500000
125100*                                                                 12510000
125200******************************************************************12520000
125300*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     12530000
125400*  UPC TRANSACTIONS TABLE (TSUAUPC)                               12540000
125500******************************************************************12550000
125600     EXEC SQL                                                     12560000
125700          INCLUDE TSUAUPC                                         12570000
125800     END-EXEC.                                                    12580000
125900*                                                                 12590000
126000*                                                                 12600000
126100******************************************************************12610000
126200*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE                   12620000
126300*  RC-RECEIPT DISTRIBUTION TABLE                                  12630000
126400******************************************************************12640000
126500     EXEC SQL                                                     12650000
126600          INCLUDE TRECDIS                                         12660000
126700     END-EXEC.                                                    12670000
126800*                                                                 12680000
126900******************************************************************12690000
127000*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE COMPANY CONTROL   12700000
127100*  TABLE (TCOCNTL)                                                12710000
127200******************************************************************12720000
127300     EXEC SQL                                                     12730000
127400          INCLUDE TCOCNTL                                         12740000
127500     END-EXEC.                                                    12750000
127600*                                                                 12760000
127700*                                                                 12770000
127800******************************************************************12780000
127900*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE PURCHASE ORDER    12790000
128000*  HEADER TABLE (TPURCHS)                                         12800000
128100******************************************************************12810000
128200     EXEC SQL                                                     12820000
128300          INCLUDE TPURCHS                                         12830000
128400     END-EXEC.                                                    12840000
128500*                                                                 12850000
128600*                                                                 12860000
128700******************************************************************12870000
128800*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE EXTERNAL ENTERPRIS12880000
128900*  NAME TABLE (TENTNME)                                           12890000
129000******************************************************************12900000
129100     EXEC SQL                                                     12910000
129200          INCLUDE TENTNME                                         12920000
129300     END-EXEC.                                                    12930000
129400*                                                                 12940000
129500*                                                                 12950000
129600******************************************************************12960000
129700*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE RECEIVING TABLE   12970000
129800******************************************************************12980000
129900     EXEC SQL                                                     12990000
130000          INCLUDE TRECEIV                                         13000000
130100     END-EXEC.                                                    13010000
130200                                                                  13020000
130210******************************************************************13021000
130220*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE EXCEPTION TABLE   13022000
130230******************************************************************13023000
130240     EXEC SQL                                                     13024000
130250          INCLUDE TSUEXCP                                         13025000
130260     END-EXEC.                                                    13026000
130270                                                                  13027000
130280*----------------------------------------------------------------*13028000
130290*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             13029000
130291*    (SUT_PO_AUD_REQ)                                             13029100
130292*----------------------------------------------------------------*13029200
130293     EXEC SQL                                                     13029300
130294          INCLUDE SUT00015                                        13029400
130295     END-EXEC.                                                    13029500
130296                                                                  13029600
130298*----------------------------------------------------------------*13029800
130299*    DB2 DCLGEN FOR THE VENDOR PO AUDIT EXCEPTION TABLE           13029900
130300*    (SUT_PO_AUD_EXC)                                             13030000
130301*----------------------------------------------------------------*13030100
130302     EXEC SQL                                                     13030200
130303          INCLUDE SUT00014                                        13030300
130304     END-EXEC.                                                    13030400
130305                                                                  13030500
130306*----------------------------------------------------------------*13030600
130307*    DB2 DCLGEN FOR THE VENDOR AGREEMENT TABLE                    13030700
130308*    (TVNDAGR)                                                    13030800
130309*----------------------------------------------------------------*13030900
130310     EXEC SQL                                                     13031000
130311          INCLUDE TVNDAGR                                         13031100
130312     END-EXEC.                                                    13031200
130315                                                                  13031500
130317******************************************************************13031700
130318*    DB2 AREA FOR THE RIT_RFID_VRFN TABLE                       * 13031800
130319******************************************************************13031900
130320     EXEC SQL                                                     13032000
130321         INCLUDE RIT00000                                         13032100
130322     END-EXEC.                                                    13032200
130324                                                                  13032400
130330******************************************************************13033000
130400*   DB2 COMMUNICATIONS AREA2                                      13040000
130500******************************************************************13050000
130600     COPY SQLCA2.                                                 13060000
130700 EJECT                                                            13070000
130800                                                                  13080000
130900***************************************************************** 13090000
131000*    AUDIT ASSOCIATE USERID CURSOR -- THIS CURSOR WILL RETRIEVE   13100000
131100*  THE USERIDS OF ALL THE ASSOCIATES THAT WORKED ON THIS AUDIT    13110000
131200***************************************************************** 13120000
131300     EXEC SQL                                                     13130000
131400         DECLARE UID_CURSOR CURSOR FOR                            13140000
131500             SELECT                                               13150000
131600                     A.AUD_USR_ID                                 13160000
131700             FROM                                                 13170000
131800                    TSUNAUD A                                     13180000
131900             WHERE                                                13190000
132000                 A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13200000
132100         UNION ALL                                                13210000
132200             SELECT                                               13220000
132300                    DISTINCT( B.UNT_AUD_USR_ID)                   13230000
132400             FROM                                                 13240000
132500                    TSUATRN B                                     13250000
132600             WHERE                                                13260000
132700                 B.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13270000
132800             AND B.TRN_NBR      = :DK-PO-NBR                      13280000
132900             AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 13290000
133000         UNION ALL                                                13300000
133100             SELECT                                               13310000
133200                    DISTINCT( D.AUD_USR_ID  )                     13320000
133300             FROM                                                 13330000
133400                    TSUATRN C                                     13340000
133500                  , TSUAUPC D                                     13350000
133600             WHERE                                                13360000
133700                 C.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13370000
133800             AND C.TRN_NBR      = :DK-PO-NBR                      13380000
133900             AND C.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 13390000
134000             AND C.AUD_CNTL_NBR = D.AUD_CNTL_NBR                  13400000
134100             AND C.SHIPT_UNT_ID = D.SHIPT_UNT_ID                  13410000
134200         ORDER BY 1                                               13420000
134300     END-EXEC.                                                    13430000
134400                                                                  13440000
134500***************************************************************** 13450000
134600*    AUDITED STORES CURSOR -- THIS CURSOR WILL RETRIEVE ALL THE   13460000
134700*  STORES THAT WERE AUDITED FOR THIS RECEIVER                     13470000
134800***************************************************************** 13480000
134900     EXEC SQL                                                     13490000
135000         DECLARE AUD_STR_CURSOR CURSOR FOR                        13500000
135100             SELECT                                               13510000
135200                     DISTINCT (A.DEST_OPER_UNT_ID)                13520000
135300             FROM                                                 13530000
135400                    TSUATRN A                                     13540000
135500                  , TSUAUPC B                                     13550000
135600             WHERE                                                13560000
135700                 A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                13570000
135800             AND A.TRN_NBR      = :DK-PO-NBR                      13580000
135900             AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 13590000
136000             AND A.SHIPT_UNT_ID =  B.SHIPT_UNT_ID                 13600000
136100             AND A.AUD_CNTL_NBR =  B.AUD_CNTL_NBR                 13610000
136200             AND B.SCN_TYP_CDE  <> 'E'                            13620000
136300         ORDER BY 1                                               13630000
136400     END-EXEC.                                                    13640000
136500 EJECT                                                            13650000
136600                                                                  13660000
136700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 13670000
136800 PROCEDURE DIVISION.                                              13680000
136900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 13690000
137000                                                                  13700000
137100******************************************************************13710000
137200*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    13720000
137300******************************************************************13730000
137400 0000-PROGRAM-MAINLINE.                                           13740000
137500                                                                  13750000
137600     PERFORM 1000-INITIALIZE.                                     13760000
137700                                                                  13770000
137800     PERFORM 2000-CREATE-REPORT                                   13780000
137900         UNTIL PS-EOF-AUDIT-SUM-EXTRACT.                          13790000
138000                                                                  13800000
138100     PERFORM 9000-EOJ-ROUTINE.                                    13810000
138200     STOP RUN.                                                    13820000
138400                                                                  13840000
138500                                                                  13850000
138600******************************************************************13860000
138700*  1000-INITIALIZE                                                13870000
138800*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.          13880000
138900*       - OPEN ALL INPUT/OUTPUT FILES                             13890000
139000*       - SELECT ALL HEADER INFORMATION                           13900000
139100******************************************************************13910000
139200 1000-INITIALIZE.                                                 13920000
139300                                                                  13930000
139400     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          13940000
139500                                                                  13950099
139510     DISPLAY ' '.                                                 13951099
139520     DISPLAY 'SUKRP009 - START'.                                  13952099
139600     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           13960000
139700     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   13970000
139800                                                                  13980099
139900     OPEN INPUT  AS-AUDIT-SUM-EXTRACT-FILE                        13990000
140000          OUTPUT AS-AUDIT-SUM-REPORT-FILE                         14000000
140100                 AS-AUDIT-SUM-REPORT-FILE-LOG                     14010099
140110                 AS-AUDIT-SUM-REPORT-FLAT-FILE.                   14011099
140200                                                                  14020000
140300     SET PS-NOT-EOF-AUDIT-SUM-EXTRACT   TO TRUE.                  14030000
140400                                                                  14040000
140410     MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT.              14041099
140420                                                                  14042099
140500     PERFORM 8001-READ-EXTRACT-FILE.                              14050000
140600                                                                  14060000
140700*    IF THERE IS NO DATA, PRINT NO DATA MESSAGE TO THE REPORT,    14070000
140800*    OTHERWISE SET-UP THE PAGE HEADINGS                           14080000
140900     IF PS-EOF-AUDIT-SUM-EXTRACT                                  14090000
141000         SET PS-NO-DATA                 TO TRUE                   14100000
141100         DISPLAY '*******  NO DATA TO REPORT IN SUKRP009 ******'  14110000
141200     ELSE                                                         14120000
141300         SET PS-DATA                    TO TRUE                   14130000
141400*        IF THIS IS A PRINTEK PRINTER, LOAD THE FORM              14140000
141500*        WILL NOT PRINT TO THE LOGISTICS PRINTER -- ASSUMING IT   14150000
141600*        IS NOT A PRINTEK PRINTER                                 14160000
141700         IF CC-PRTR-CNTL-IND = 'P'                                14170000
141800             MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR 14180000
141900             MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI      14190000
142000                                                                  14200000
142100             WRITE AS-AUDIT-SUM-REPORT-LINE                       14210000
142200                 FROM DS004-PLC-LOAD-FORM                         14220000
142300             AFTER ADVANCING 1 LINE                               14230000
142310                                                                  14231099
142320                                                                  14232099
142400         END-IF                                                   14240000
142500         PERFORM 1100-SET-UP-HEADER                               14250000
142600     END-IF.                                                      14260000
142700                                                                  14270000
142800                                                                  14280000
142900                                                                  14290000
143000                                                                  14300000
143100******************************************************************14310000
143200*  1100-SET-UP-HEADER                                             14320000
143300*       - SELECTS ALL THE AUDIT LEVEL INFORMATION.                14330000
143400*       - MOVES ALL INFO TO THE HEADER FIELDS                     14340000
143500******************************************************************14350000
143600 1100-SET-UP-HEADER.                                              14360000
143700                                                                  14370000
143800     MOVE SU005-AUD-CNTL-NBR            TO AH1-AUD-CNTL-NBR       14380000
143900                                           DK-AUD-CNTL-NBR.       14390000
144000                                                                  14400000
144100     MOVE PC-CURRENT-PROGRAM-NAME       TO DP132O-PROGRAM-NAME.   14410000
144200                                                                  14420000
144300     PERFORM 1200-SELECT-HEADER-INFORMATION.                      14430000
144310                                                                  14431099
144311     PERFORM 1300-SELECT-AUDIT-TYPE.                              14431100
144320                                                                  14432099
144400                                                                  14440000
144500     MOVE PV-CURR-YY                    TO DP132O-RUN-YEAR.       14450000
144600     MOVE PV-CURR-MM                    TO DP132O-RUN-MONTH.      14460000
144700     MOVE PV-CURR-DD                    TO DP132O-RUN-DAY.        14470000
144800                                                                  14480000
144900     MOVE PV-CURR-HH                    TO DP132O-RUN-HOUR.       14490000
145000     MOVE PV-CURR-MIN                   TO DP132O-RUN-MINUTE.     14500000
145100                                                                  14510000
145200     MOVE SUNAUD-AUD-STRT-TMST          TO PV-TIMESTAMP.          14520000
145300     MOVE PV-TIMESTAMP-DATE             TO  AH6-AUDIT-START-DATE. 14530000
145400     MOVE PV-TIMESTAMP-TIME             TO  AH6-AUDIT-START-TIME. 14540000
145500                                                                  14550000
145600     IF SUNAUD-AUD-STP-TMST = PC-NINES-TIMESTAMP                  14560000
145700         MOVE SPACES                    TO  AH8-DURATION-X        14570000
145800                                            AH7-AUDIT-STOP-DATE   14580000
145900                                            AH7-AUDIT-STOP-TIME   14590000
146000                                                                  14600000
146100     ELSE                                                         14610000
146200         MOVE SUNAUD-AUD-STP-TMST       TO PV-TIMESTAMP           14620000
146300         MOVE PV-TIMESTAMP-DATE         TO  AH7-AUDIT-STOP-DATE   14630000
146400         MOVE PV-TIMESTAMP-TIME         TO  AH7-AUDIT-STOP-TIME   14640000
146500                                                                  14650000
146600*        CONVERT THE NUMBER OF DAYS AND HOURS TO MINUTES...ADD    14660000
146700*        IT TO THE REMINDER OF THE MINUTES, AND SUBRACT ANY MIN.  14670000
146800*        THAT THE AUDIT WAS POSTPONED TO GET THE TOTAL NUMBER OF  14680000
146900*        MINUTES TO PROCESS                                       14690000
147000         COMPUTE PV-DURATION-TOTAL =                              14700000
147100             ((PV-DAY-COUNT   * 1440) +                           14710000
147200              (PV-HOUR-COUNT  *   60) +                           14720000
147300               PV-MINUTE-COUNT ) - SUNAUD-AUD-PSPND-MNIT-QTY      14730000
147400                                                                  14740000
147500*        DIVIDE THE TOTAL NUMBER OF MINUTES BY 60 TO COME UP WITH 14750000
147600*        THE NNUMBER OF HOURS...THE REMAINDER IS THE MINUTES.     14760000
147700         DIVIDE PV-DURATION-TOTAL BY 60                           14770000
147800         GIVING    PV-DURATION-HOURS                              14780000
147900         REMAINDER PV-DURATION-MINUTES                            14790000
148000                                                                  14800000
148100         MOVE PV-DURATION-HOURS         TO AH8-DURATION-HOURS     14810000
148200         MOVE PV-DURATION-MINUTES       TO AH8-DURATION-MINUTES   14820000
148300     END-IF.                                                      14830000
148400                                                                  14840000
149300     MOVE SUNAUD-OPER-UNT-ID            TO AH1-OPER-UNT-ID        14930000
149400                                           PV-OPER-UNT-ID         14940000
149500                                           DK-OPER-UNT-ID.        14950000
149600     PERFORM 1110-GET-FCLTY-DESC                                  14960000
149700                                                                  14970000
149800     MOVE SUNAUD-PRC-FCLTY-AREA-ID      TO AH3-AUDIT-AREA.        14980000
149900     MOVE SUNAUD-AUD-STAT-CDE           TO PV-AUDIT-STATUS.       14990000
150000     MOVE SUNAUD-AUD-TYP-CDE            TO PV-AUDIT-TYPE.         15000000
150100                                                                  15010000
150200     EVALUATE TRUE                                                15020000
150300       WHEN  PV-100-AUDIT-CHECK                                   15030000
150400             MOVE '100% CHECK      '    TO AH4-AUDIT-TYPE         15040000
150500       WHEN  PV-SPOT-AUDIT-CHECK                                  15050000
150600             MOVE 'SPOT CHECK      '    TO AH4-AUDIT-TYPE         15060000
150700       WHEN  PV-REWORK-AUDIT-CHECK                                15070000
150800             MOVE 'REWORK          '    TO AH4-AUDIT-TYPE         15080000
150900     END-EVALUATE.                                                15090000
151000                                                                  15100000
151100     EVALUATE TRUE                                                15110000
151200       WHEN  PV-AUDIT-INPROCESS                                   15120000
151300             MOVE 'INPROCESS      '     TO AH1-AUDIT-STATUS       15130000
151400       WHEN  PV-AUDIT-COMPLETE                                    15140000
151500             MOVE 'COMPLETE       '     TO AH1-AUDIT-STATUS       15150000
151600       WHEN  PV-AUDIT-POSTPONE                                    15160000
151700             MOVE 'POSTPONED      '     TO AH1-AUDIT-STATUS       15170000
151800     END-EVALUATE.                                                15180000
151900                                                                  15190000
152000                                                                  15200000
152100******************************************************************15210000
152200* 1110-GET-FCLTY-DESC                                             15220000
152300*    THIS PARAGRAPH WILL SELECT THE FACLITY DESC                  15230000
152400******************************************************************15240000
152500 1110-GET-FCLTY-DESC.                                             15250000
152600                                                                  15260000
152700     INITIALIZE XL071-COMMAREA-REC.                               15270000
152800     MOVE DK-OPER-UNT-ID        TO XL071-LOCATION-NUMBER          15280000
152900                                                                  15290000
153000     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         15300000
153100                                                                  15310000
153200     EVALUATE TRUE                                                15320000
153300     WHEN XL071-NO-ERRORS                                         15330000
153400         MOVE XL071-LOC-NM          TO AH1-FCLTY-DESC             15340000
153500     WHEN XL071-LOC-NOT-FOUND                                     15350000
153600     WHEN XL071-DC-ASGMT-NOT-FND                                  15360000
153700         MOVE 'UNKNOWN'             TO AH1-FCLTY-DESC             15370000
153800     WHEN XL071-BAD-DB2-RETURN                                    15380000
153900         DISPLAY '1110-GET-FCLTY-DESC'                            15390000
154000         DISPLAY 'CALL LOCATION MOD '                             15400000
154100         DISPLAY 'XLT00010'                                       15410000
154200         MOVE XL071-SQLCA             TO SQLCA                    15420000
154300         MOVE '1110-GET-FCLTY-DESC'   TO PV-PARAGRAPH-NAME        15430000
154400         MOVE 'CALL TO XLKUT071'     TO PV-DB2-OPERATION-ATTEMPTED15440000
154500         MOVE DK-OPER-UNT-ID          TO PV-DISP-OPER-UNT-ID      15450000
154600         MOVE PV-DISP-OPER-UNT-ID     TO PV-DB2-FIELD-1           15460000
154700         MOVE SPACES                  TO PV-DB2-FIELD-2           15470000
154800                                         PV-DB2-FIELD-3           15480000
154900         PERFORM 9999-SQL-ABEND                                   15490000
155000     END-EVALUATE.                                                15500000
155100/                                                                 15510000
155200******************************************************************15520000
155300* 1200-SELECT-HEADER-INFORMATION                                  15530000
155400*    THIS PARAGRAPH WILL SELECT ALL THE HEADER INFORMATION FOR    15540000
155500*    THE REPORT                                                   15550000
155600******************************************************************15560000
155700 1200-SELECT-HEADER-INFORMATION.                                  15570000
155800                                                                  15580000
155900     EXEC SQL                                                     15590000
156000         SELECT                                                   15600000
156100                AUD_STRT_TMST                                     15610000
156200              , AUD_STP_TMST                                      15620000
156300              , DAYS(AUD_STP_TMST)   - DAYS(AUD_STRT_TMST)        15630000
156400              , HOUR(AUD_STP_TMST)   - HOUR(AUD_STRT_TMST)        15640000
156500              , MINUTE(AUD_STP_TMST) - MINUTE(AUD_STRT_TMST)      15650000
156600              , AUD_PSPND_MNIT_QTY                                15660000
156700              , AUD_CLO_MNIT_QTY                                  15670000
156800              , OPER_UNT_ID                                       15680000
156900              , PRC_FCLTY_AREA_ID                                 15690000
157000              , AUD_STAT_CDE                                      15700000
157100              , AUD_TYP_CDE                                       15710000
157200              , CURRENT TIMESTAMP                                 15720000
157300         INTO                                                     15730000
157400                :SUNAUD-AUD-STRT-TMST                             15740000
157500              , :SUNAUD-AUD-STP-TMST                              15750000
157600              , :PV-DAY-COUNT                                     15760000
157700              , :PV-HOUR-COUNT                                    15770000
157800              , :PV-MINUTE-COUNT                                  15780000
157900              , :SUNAUD-AUD-PSPND-MNIT-QTY                        15790000
158000              , :SUNAUD-AUD-CLO-MNIT-QTY                          15800000
158100              , :SUNAUD-OPER-UNT-ID                               15810000
158200              , :SUNAUD-PRC-FCLTY-AREA-ID                         15820000
158300              , :SUNAUD-AUD-STAT-CDE                              15830000
158400              , :SUNAUD-AUD-TYP-CDE                               15840000
158500              , :PV-DB2-CURR-TIMESTAMP                            15850000
158600         FROM                                                     15860000
158700                TSUNAUD                                           15870000
158800         WHERE                                                    15880000
158900             AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                      15890000
159000     END-EXEC.                                                    15900000
159100                                                                  15910000
159200     EVALUATE TRUE                                                15920000
159300         WHEN SQLCODE = ZERO                                      15930000
159400              MOVE PV-DB2-CURR-TIMESTAMP                          15940000
159500                               TO PV-CURR-TIMESTAMP               15950000
159600         WHEN OTHER                                               15960000
159700              MOVE '1200-SELECT-HEADER-INFO.'                     15970000
159800                               TO  PV-PARAGRAPH-NAME              15980000
159900              MOVE 'SELECT OF TSUNAUD'                            15990000
160000                               TO  PV-DB2-OPERATION-ATTEMPTED     16000000
160100              MOVE DK-AUD-CNTL-NBR    TO PV-DISP-AUD-CNTL-NBR     16010000
160200              MOVE PV-DISP-AUD-CNTL-NBR                           16020000
160300                                      TO PV-DB2-FIELD-1           16030000
160400              MOVE SPACES             TO PV-DB2-FIELD-2           16040000
160500                                         PV-DB2-FIELD-3           16050000
160600              PERFORM 9999-SQL-ABEND                              16060000
160700     END-EVALUATE.                                                16070000
160800                                                                  16080000
160810******************************************************************16081000
160820* 1300-SELECT-AUDIT-TYPE                                          16082000
160830*    THIS PARAGRAPH WILL SELECT FROM SUT_PO_AUD_REQ TO CHECK IF   16083000
160840*    THE AUDIT IS PROMPTED OR MANUAL                              16084000
160850******************************************************************16085000
160860 1300-SELECT-AUDIT-TYPE.                                          16086000
160861                                                                  16086100
160862     INITIALIZE DCLSUT00015.                                      16086200
160863                                                                  16086300
160864     EXEC SQL                                                     16086400
160865         SELECT PKGNG_TYP_CDE                                     16086500
160866               ,VALUE(RWRK_AUD_CNTL_NBR,0)                        16086600
160867         INTO  :SUT00015-PKGNG-TYP-CDE                            16086700
160868              ,:SUT00015-RWRK-AUD-CNTL-NBR                        16086800
160869         FROM   SUT_PO_AUD_REQ                                    16086900
160870         WHERE  AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                 16087000
160871     END-EXEC.                                                    16087100
160872                                                                  16087200
160873     EVALUATE TRUE                                                16087300
160874       WHEN SQLCODE = +0                                          16087400
160875            SET AH7-PROMPTED-AUDIT TO TRUE                        16087500
160876       WHEN SQLCODE = +100                                        16087600
160877            SET AH7-MANUAL-AUDIT   TO TRUE                        16087700
160878       WHEN OTHER                                                 16087800
160879            DISPLAY DK-AUD-CNTL-NBR                               16087900
160880            MOVE '1300-SELECT-AUDIT-TYPE'                         16088000
160881                                   TO  PV-PARAGRAPH-NAME          16088100
160882            MOVE 'SELECT OF SUT_PO_AUD_REQ'                       16088200
160883                                   TO PV-DB2-OPERATION-ATTEMPTED  16088300
160884            MOVE DK-AUD-CNTL-NBR   TO PV-DISP-AUD-CNTL-NBR        16088400
160885            MOVE PV-DISP-AUD-CNTL-NBR                             16088500
160886                                   TO PV-DB2-FIELD-1              16088600
160887            MOVE SPACES            TO PV-DB2-FIELD-2              16088700
160888                                      PV-DB2-FIELD-3              16088800
160889            PERFORM 9999-SQL-ABEND                                16088900
160890     END-EVALUATE.                                                16089000
160891                                                                  16089100
161012                                                                  16101200
161020******************************************************************16102000
161100* 2000-CREATE-REPORT -- CREATE THE AUDIT SUMMARY REPORT FOR A     16110000
161200*    PARTICULAR RECEIVER -- THIS PARAGRAPH WILL REPEAT UNTIL THE  16120000
161300*    END OF THE EXTRACT FILE                                      16130000
161400*                                                                 16140000
161500*    -GET THE RECEIVER LEVEL INFO AND START A NEW PAGE PRINTING   16150000
161600*     THE RECEIVER INFORMATION                                    16160000
161700*    -SPIN THROUGH THE PICKING ERRORS FIRST, PRINTING DETAIL LINES16170000
161800*     OR ACCUMULATING COUNT OF STORE WITH NO ERRORS.              16180000
161900*    -THEN SPIN THORUGH THE TICKETING ERRORS DOING THE SAME THING 16190000
162000*    -AFTER ALL DETAIL, CALCULATE THE ERROR RATIO'S, AND DISPLAY  16200000
162100*     THE STORE LIST                                              16210000
162200******************************************************************16220000
162300 2000-CREATE-REPORT.                                              16230000
162400                                                                  16240000
162500     INITIALIZE PA-RECEIVER-ACCUM.                                16250000
162600     MOVE SU005-PO-NBR                  TO PV-HOLD-PO-NBR.        16260000
162700     MOVE SU005-REC-SEQ-NBR             TO PV-HOLD-REC-SEQ-NBR.   16270000
162800                                                                  16280000
162900*    GET INFORMATION                                              16290000
163000     PERFORM 3110-SELECT-RECEIVER-INFO.                           16300000
163100                                                                  16310099
163200     IF SU005-PICKING-ERRORS  OR                                  16320000
163300        SU005-TICKETING-ERRORS                                    16330000
163400*    PRINT THE PAGE AND RECEIVER HEADINGS                         16340000
163500        MOVE 'QC  ' TO AH6-AUDIT-CATEGORY                         16350000
163600                                                                  16360099
163700        PERFORM 3000-PRINT-PAGE-HEADING                           16370000
163900                                                                  16390000
164000*    CREATE THE PICKING ERROR DETAIL UNTIL THE END OF THE INPUT   16400000
164100*    FILE, OR THE END OF THE PICKING ERRORS, OR UNTIL THE RECEIVER16410000
164200*    NUMBER CHANGES                                               16420000
164300        PERFORM 2200-CREATE-PICKING-DETAIL                        16430000
164400            UNTIL  PS-EOF-AUDIT-SUM-EXTRACT                       16440000
164500               OR  SU005-TICKETING-ERRORS                         16450000
164600               OR  SU005-RFID-ERRORS                              16460000
164700               OR  SU005-PO-NBR        > PV-HOLD-PO-NBR           16470000
164800               OR  SU005-REC-SEQ-NBR   > PV-HOLD-REC-SEQ-NBR      16480000
164900                                                                  16490000
165000        PERFORM 2210-CREATE-PICKING-SUMMARY                       16500000
165100                                                                  16510000
165200*   CREATE THE TICKETING ERROR DETAIL UNTIL THE END OF THE INPUT  16520000
165300*    FILE, OR THE END OF THE TICKETING ERRORS, OR UNTIL THE       16530000
165400*    RECEIVER NUMBER CHANGES                                      16540000
165500        PERFORM 2300-CREATE-TICKETING-DETAIL                      16550000
165600            UNTIL PS-EOF-AUDIT-SUM-EXTRACT                        16560000
165700               OR  SU005-RFID-ERRORS                              16570000
165800               OR  SU005-PO-NBR        > PV-HOLD-PO-NBR           16580000
165900               OR  SU005-REC-SEQ-NBR   > PV-HOLD-REC-SEQ-NBR      16590000
166000                                                                  16600000
166100        PERFORM 2310-CREATE-TICKETING-SUMMARY                     16610000
166200                                                                  16620000
166300*    BY THIS POINT, ALL THE DETAIL FOR A PARTICULAR RECEIVING HAS 16630000
166400*    BE PRINTED, NOW CALCULATE THE VARIOUS ERROR RATIO FIGURES    16640000
166500*    AND PRINT THE REPORT FOOTERS.                                16650000
166600        PERFORM 2400-PRINT-FOOTER                                 16660000
166700     END-IF.                                                      16670000
166800                                                                  16680000
167000     IF SU005-RFID-ERRORS                                         16700000
167100        MOVE 'RFID' TO AH6-AUDIT-CATEGORY                         16710000
167200        PERFORM 3000-PRINT-PAGE-HEADING                           16720000
167400                                                                  16740000
167500*    CREATE THE RFID ERROR DETAIL UNTIL THE END OF THE INPUT      16750000
167600*    FILE, OR THE END OF THE RFID ERRORS, OR UNTIL THE REFCEIVER  16760000
167700*    NUMBER CHANGES                                               16770000
167800        PERFORM 2500-CREATE-RFID-DETAIL                           16780000
167900            UNTIL PS-EOF-AUDIT-SUM-EXTRACT                        16790000
168000               OR  SU005-PO-NBR        > PV-HOLD-PO-NBR           16800000
168100               OR  SU005-REC-SEQ-NBR   > PV-HOLD-REC-SEQ-NBR      16810000
168200                                                                  16820000
168300        PERFORM 2510-CREATE-RFID-SUMMARY                          16830000
168400                                                                  16840000
168500*    BY THIS POINT, ALL THE DETAIL FOR A PARTICULAR RECEIVING HAS 16850000
168600*    BE PRINTED, NOW CALCULATE THE VARIOUS ERROR RATIO FIGURES    16860000
168700*    AND PRINT THE REPORT FOOTERS.                                16870000
168800        PERFORM 2600-PRINT-FOOTER                                 16880000
168900     END-IF.                                                      16890000
169000                                                                  16900099
169100                                                                  16910000
169200******************************************************************16920000
169300* 2200-CREATE-PICKING-DETAIL                                      16930000
169400*  -CHECK EACH ERROR DETAIL BUCKET -- IF FOUND, MOVE TO THE DETAIL16940000
169500*  --- IF ANY FOUND, MOVE THE NUMBER TO THE DETAIL LINE, AND ADD  16950000
169600*      IT TO THE APPROPRIATE REPORT BUCKET -- IF ERRORS           16960000
169700*  -IF ANY ERRORS FOUND, PRINT THE REPORT LINE, OTHERWISE ADD     16970000
169800*   TO THE STORE COUNT WITH NO ERRORS                             16980000
169900******************************************************************16990000
170000 2200-CREATE-PICKING-DETAIL.                                      17000000
170100                                                                  17010000
170200     IF PS-PRINT-PICK-HEADING                                     17020000
170300         PERFORM 2220-PRINT-PICK-HEADINGS                         17030000
170400     END-IF.                                                      17040000
170500                                                                  17050000
170600     INITIALIZE PDL-PICKING-DETAIL-LINE.                          17060000
170700                                                                  17070000
170800     SET   PS-DONT-PRINT-DETAIL       TO TRUE.                    17080000
170900                                                                  17090000
171000     MOVE SU005-DEST-OPER-UNT-ID      TO PDL-STORE-NBR.           17100000
171100                                                                  17110000
171200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17120000
171300*  *  VENDOR OVER *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17130000
171400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17140000
171500     IF  SU005-VENDOR-OVER             > ZERO                     17150000
171600         MOVE  SU005-VENDOR-OVER      TO PDL-VND-OVER             17160000
171700         SET   PS-PRINT-DETAIL        TO TRUE                     17170000
171800                                                                  17180000
171900         MOVE 'PA-VENDOR-OVER'        TO PV-FIELD-NAME            17190000
172000         COMPUTE PA-VENDOR-OVER =                                 17200000
172100                 PA-VENDOR-OVER + SU005-VENDOR-OVER               17210000
172200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      17220000
172300         END-COMPUTE                                              17230000
172400     END-IF.                                                      17240000
172500                                                                  17250000
172600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17260000
172700*  *  VENDOR SHORT   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17270000
172800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17280000
172900     IF  SU005-VENDOR-SHORT            > ZERO                     17290000
173000         MOVE  SU005-VENDOR-SHORT     TO PDL-VND-SHORT            17300000
173100         SET   PS-PRINT-DETAIL        TO TRUE                     17310000
173200                                                                  17320000
173300         MOVE 'PA-VENDOR-SHORT'       TO PV-FIELD-NAME            17330000
173400         COMPUTE PA-VENDOR-SHORT =                                17340000
173500                 PA-VENDOR-SHORT + SU005-VENDOR-SHORT             17350000
173600             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      17360000
173700         END-COMPUTE                                              17370000
173800     END-IF.                                                      17380000
173900                                                                  17390000
174000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17400000
174100*  *  RECEIVER OVER  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17410000
174200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17420000
174300*    CAN ONLY HAVE A RECEIVER OVER/SHORT ON A FULL/REWORKED AUDIT 17430000
174400     IF  PV-SPOT-AUDIT-CHECK                                      17440000
174500        MOVE ' N/A'                   TO PDL-RCVR-OVER-X          17450000
174600     ELSE                                                         17460000
174700        IF  SU005-RECEIVER-OVER           > ZERO                  17470000
174800            MOVE  SU005-RECEIVER-OVER TO PDL-RCVR-OVER            17480000
174900            SET   PS-PRINT-DETAIL     TO TRUE                     17490000
175000                                                                  17500000
175100            MOVE 'PA-RECEIVER-OVER'   TO PV-FIELD-NAME            17510000
175200            COMPUTE PA-RECEIVER-OVER =                            17520000
175300                    PA-RECEIVER-OVER + SU005-RECEIVER-OVER        17530000
175400                ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR   17540000
175500            END-COMPUTE                                           17550000
175600        END-IF                                                    17560000
175700     END-IF.                                                      17570000
175800                                                                  17580000
175900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17590000
176000*  *  RECEIVER SHORT *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17600000
176100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17610000
176200*    CAN ONLY HAVE A RECEIVER OVER/SHORT ON A FULL/REWORKED AUDIT 17620000
176300     IF  PV-SPOT-AUDIT-CHECK                                      17630000
176400        MOVE ' N/A'                   TO PDL-RCVR-SHORT-X         17640000
176500     ELSE                                                         17650000
176600        IF  SU005-RECEIVER-SHORT          > ZERO                  17660000
176700            MOVE SU005-RECEIVER-SHORT TO PDL-RCVR-SHORT           17670000
176800            SET  PS-PRINT-DETAIL      TO TRUE                     17680000
176900                                                                  17690000
177000            MOVE 'PA-RECEIVER-SHORT'  TO PV-FIELD-NAME            17700000
177100            COMPUTE PA-RECEIVER-SHORT =                           17710000
177200                    PA-RECEIVER-SHORT + SU005-RECEIVER-SHORT      17720000
177300                ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR   17730000
177400            END-COMPUTE                                           17740000
177500        END-IF                                                    17750000
177600     END-IF.                                                      17760000
177700                                                                  17770000
177800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17780000
177900*  *  STYLE SUB   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17790000
178000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17800000
178100     IF  SU005-STYLE-SUB               > ZERO                     17810000
178200         MOVE  SU005-STYLE-SUB        TO PDL-STYLE-SUB            17820000
178300         SET   PS-PRINT-DETAIL        TO TRUE                     17830000
178400                                                                  17840000
178500         MOVE 'PA-STYLE-SUB'          TO PV-FIELD-NAME            17850000
178600         COMPUTE PA-STYLE-SUB  =                                  17860000
178700                 PA-STYLE-SUB  + SU005-STYLE-SUB                  17870000
178800             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      17880000
178900         END-COMPUTE                                              17890000
179000     END-IF.                                                      17900000
179100                                                                  17910000
179200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17920000
179300*  *  DAMAGED UNITS  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17930000
179400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  17940000
179500     IF  SU005-DAMAGED-UNITS           > ZERO                     17950000
179600         MOVE  SU005-DAMAGED-UNITS    TO PDL-DAMAGED-UNITS        17960000
179700         SET   PS-PRINT-DETAIL        TO TRUE                     17970000
179800                                                                  17980000
179900         MOVE 'PA-DAMAGED-UNITS'      TO PV-FIELD-NAME            17990000
180000         COMPUTE PA-DAMAGED-UNITS =                               18000000
180100                 PA-DAMAGED-UNITS + SU005-DAMAGED-UNITS           18010000
180200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18020000
180300         END-COMPUTE                                              18030000
180400     END-IF.                                                      18040000
180500                                                                  18050000
182200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18220000
182300*  *  TOTAL ERRORS   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18230000
182400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18240000
182500     IF  SU005-TOT-PIC-ERR             > ZERO                     18250000
182600         MOVE  SU005-TOT-PIC-ERR      TO PDL-TOTAL-ERRORS         18260000
182700         SET   PS-PRINT-DETAIL        TO TRUE                     18270000
182800                                                                  18280000
182900         MOVE 'PA-TOT-ERRS-PIC'       TO PV-FIELD-NAME            18290000
183000         COMPUTE PA-TOT-ERRS-PIC  =                               18300000
183100                 PA-TOT-ERRS-PIC  + SU005-TOT-PIC-ERR             18310000
183200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18320000
183300         END-COMPUTE                                              18330000
183400     END-IF.                                                      18340000
183500                                                                  18350000
183600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18360000
183700*  *  UNITS IN ERROR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18370000
183800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18380000
183900     IF  SU005-TOT-UNITS-IN-PIC-ERR    > ZERO                     18390000
184000         MOVE  SU005-TOT-UNITS-IN-PIC-ERR                         18400000
184100                                      TO PDL-TOTAL-UNITS-IN-ERROR 18410000
184200         SET   PS-PRINT-DETAIL        TO TRUE                     18420000
184300                                                                  18430000
184400         MOVE 'PA-TOT-UNTS-IN-ERR-PIC' TO PV-FIELD-NAME           18440000
184500         COMPUTE PA-TOT-UNTS-IN-ERR-PIC =                         18450000
184600                 PA-TOT-UNTS-IN-ERR-PIC +                         18460000
184700                 SU005-TOT-UNITS-IN-PIC-ERR                       18470000
184800             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18480000
184900         END-COMPUTE                                              18490000
185000     END-IF.                                                      18500000
185100                                                                  18510000
185200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18520000
185300*  *  UNITS TRANSCRIBED *  *  *  *  *  *  *  *  *  *  *  *  *  *  18530000
185400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18540000
185500     IF  SU005-UNITS-TRNSCRBD          > ZERO                     18550000
185600         MOVE  SU005-UNITS-TRNSCRBD   TO PDL-TOTAL-UNITS-TRNSCRBD 18560000
185700                                                                  18570000
185800*        IF THERE ARE ERRORS, ADD THE UNITS TRANSCRIBED TO THE    18580000
185900*        TOTAL FOR THOSE STORES WITH ERRORS.                      18590000
186000         IF PS-PRINT-DETAIL                                       18600000
186100             MOVE 'PA-TOT-UNTS-TRNS-IE-PIC' TO PV-FIELD-NAME      18610000
186200             COMPUTE PA-TOT-UNTS-TRNS-IE-PIC =                    18620000
186300                     PA-TOT-UNTS-TRNS-IE-PIC +                    18630000
186400                     SU005-UNITS-TRNSCRBD                         18640000
186500                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  18650000
186600             END-COMPUTE                                          18660000
186700         ELSE                                                     18670000
186800*        OTHERWISE ADD TO THOSE STORES WITH NO ERRORS             18680000
186900             MOVE 'PA-TOT-UNTS-TRNS-NE-PIC' TO PV-FIELD-NAME      18690000
187000             COMPUTE PA-TOT-UNTS-TRNS-NE-PIC =                    18700000
187100                     PA-TOT-UNTS-TRNS-NE-PIC +                    18710000
187200                     SU005-UNITS-TRNSCRBD                         18720000
187300                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  18730000
187400             END-COMPUTE                                          18740000
187500         END-IF                                                   18750000
187600*        EITHER WAY ADD TO THE OVERALL TOTAL                      18760000
187700         MOVE 'PA-UNTS-TRNS-PIC'             TO PV-FIELD-NAME     18770000
187800         COMPUTE PA-UNTS-TRNS-PIC =                               18780000
187900                 PA-UNTS-TRNS-PIC +                               18790000
188000                 SU005-UNITS-TRNSCRBD                             18800000
188100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      18810000
188200         END-COMPUTE                                              18820000
188300     END-IF.                                                      18830000
188400                                                                  18840000
188500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18850000
188600*  *  UNITS AUDITED  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18860000
188700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  18870000
188800     IF  SU005-UNITS-AUDITED           > ZERO                     18880000
188900         MOVE  SU005-UNITS-AUDITED    TO PDL-TOTAL-UNITS-AUDITED  18890000
189000                                                                  18900000
189100*        IF THERE ARE ERRORS, ADD THE UNITS AUDITED TO THE BUCKET 18910000
189200*        TOTAL FOR THOSE STORES WITH ERRORS.                      18920000
189300         IF PS-PRINT-DETAIL                                       18930000
189400             MOVE 'PA-TOT-UNTS-AUD-IE-PIC' TO PV-FIELD-NAME       18940000
189500             COMPUTE PA-TOT-UNTS-AUD-IE-PIC =                     18950000
189600                     PA-TOT-UNTS-AUD-IE-PIC +                     18960000
189700                     SU005-UNITS-AUDITED                          18970000
189800                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  18980000
189900             END-COMPUTE                                          18990000
190000         ELSE                                                     19000000
190100*        OTHERWISE ADD TO THOSE STORES WITH NO ERRORS             19010000
190200             MOVE 'PA-TOT-UNTS-AUD-NE-PIC' TO PV-FIELD-NAME       19020000
190300             COMPUTE PA-TOT-UNTS-AUD-NE-PIC =                     19030000
190400                     PA-TOT-UNTS-AUD-NE-PIC +                     19040000
190500                     SU005-UNITS-AUDITED                          19050000
190600                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  19060000
190700             END-COMPUTE                                          19070000
190800         END-IF                                                   19080000
190900*        EITHER WAY ADD TO THE OVERALL TOTAL                      19090000
191000         MOVE 'PA-UNTS-AUD-PIC'             TO PV-FIELD-NAME      19100000
191100         COMPUTE PA-UNTS-AUD-PIC       =                          19110000
191200                 PA-UNTS-AUD-PIC       +                          19120000
191300                 SU005-UNITS-AUDITED                              19130000
191400             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      19140000
191500         END-COMPUTE                                              19150000
191600     END-IF.                                                      19160000
191700                                                                  19170000
191800*    ADD THE NET NUMBER OF UNITS IN ERROR -- EVEN THOUGH THIS     19180000
191900*    FIELD IS IN THE "HEADER" SECTION OF SURD005, IT CAN ONLY BE  19190000
192000*    ACCULUATED ONCE FOR EACH TYPE OF RECORD (EACH STORE WILL HAVE19200000
192100*    A PICKING AND TICKETING SECTION)                             19210000
192200     MOVE 'PA-NET-UNTS-IN-ERROR'           TO PV-FIELD-NAME.      19220000
192300     COMPUTE PA-NET-UNTS-IN-ERROR   =                             19230000
192400             PA-NET-UNTS-IN-ERROR  +                              19240000
192500             SU005-TOT-UNITS-IN-ERROR                             19250000
192600     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             19260000
192700                                                                  19270000
192800*    IF ANY ERRORS FOUND, PRINT THE DETAIL...IF NOT, ADD TO THE   19280000
192900*    TOTALS OF THE STORES WITH NO ERRORS                          19290000
193000     IF PS-PRINT-DETAIL                                           19300000
193100*        IF A SPOT AUDIT, USE THE UNITS AUDITED, OTHERWISE USE THE19310000
193200*        UNITS TRANSCRIBED                                        19320000
193300         IF PV-SPOT-AUDIT-CHECK                                   19330000
193400             IF SU005-UNITS-AUDITED > ZERO                        19340000
193500                 COMPUTE PV-ERROR-RATIO  =                        19350000
193600                     (SU005-TOT-UNITS-IN-PIC-ERR /                19360000
193700                      SU005-UNITS-AUDITED)  * 100                 19370000
193800                 MOVE PV-ERROR-RATIO    TO PDL-ERROR-RATIO        19380000
193900             ELSE                                                 19390000
194000                 IF SU005-TOT-UNITS-IN-PIC-ERR > ZERO             19400000
194100                     MOVE 100           TO PDL-ERROR-RATIO        19410000
194200                 ELSE                                             19420000
194300                     MOVE ZERO          TO PDL-ERROR-RATIO        19430000
194400                 END-IF                                           19440000
194500             END-IF                                               19450000
194600         ELSE                                                     19460000
194700             IF SU005-UNITS-TRNSCRBD > ZERO                       19470000
194800                 COMPUTE PV-ERROR-RATIO  =                        19480000
194900                     (SU005-TOT-UNITS-IN-PIC-ERR /                19490000
195000                      SU005-UNITS-TRNSCRBD)  * 100                19500000
195100                 MOVE PV-ERROR-RATIO    TO PDL-ERROR-RATIO        19510000
195200             ELSE                                                 19520000
195300                 IF SU005-TOT-UNITS-IN-PIC-ERR > ZERO             19530000
195400                     MOVE 100           TO PDL-ERROR-RATIO        19540000
195500                 ELSE                                             19550000
195600                     MOVE ZERO          TO PDL-ERROR-RATIO        19560000
195700                 END-IF                                           19570000
195800             END-IF                                               19580000
195900         END-IF                                                   19590000
196000                                                                  19600000
196100         MOVE '%'                   TO PDL-PERCENT                19610000
196200                                                                  19620000
196300         IF (PV-DETAIL-LINE-COUNT + 1) > PC-MAX-REPORT-LINES      19630000
196400             PERFORM 3000-PRINT-PAGE-HEADING                      19640000
196500                                                                  19650099
196600             PERFORM 2220-PRINT-PICK-HEADINGS                     19660000
196700         END-IF                                                   19670000
196800                                                                  19680000
196820         IF  CC-FLAT-FILE                                         19682099
196852             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  19685299
196860              FROM PDL-PICKING-DETAIL-LINE                        19686099
196870         ELSE                                                     19687099
196900             WRITE AS-AUDIT-SUM-REPORT-LINE                       19690099
197000              FROM PDL-PICKING-DETAIL-LINE                        19700099
197100             AFTER ADVANCING 1 LINES                              19710000
197200             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   19720099
197300              FROM PDL-PICKING-DETAIL-LINE                        19730099
197400             AFTER ADVANCING 1 LINES                              19740000
197410         END-IF                                                   19741099
197420                                                                  19742099
197500         ADD +1                     TO PV-DETAIL-LINE-COUNT       19750000
197600                                       PA-STRS-W-ERRS-PIC         19760000
197700                                       PA-STR-COUNT-PIC           19770000
197800     ELSE                                                         19780000
197900         ADD +1                     TO PA-STRS-W-NO-ERRS-PIC      19790000
198000                                       PA-STR-COUNT-PIC           19800000
198100     END-IF.                                                      19810000
198200                                                                  19820000
198300     PERFORM 8001-READ-EXTRACT-FILE.                              19830000
198400                                                                  19840000
198500                                                                  19850000
198600******************************************************************19860000
198700* 2210-CREATE-PICKING-SUMMARY                                     19870000
198800*  -PRINT THE ERROR AND NO-ERROR SUB TOTALS AND A PICK TOTAL LINE 19880000
198900******************************************************************19890000
199000 2210-CREATE-PICKING-SUMMARY.                                     19900000
199100                                                                  19910000
199200*    IF THE SUMMARY WON'T FIT ON THE PAGE, GO TO THE NEXT ONE     19920000
199300     IF (PV-DETAIL-LINE-COUNT + 4) > PC-MAX-REPORT-LINES          19930000
199400         PERFORM 3000-PRINT-PAGE-HEADING                          19940000
199600     END-IF.                                                      19960000
199700                                                                  19970000
199800*    WRITE SUMMARY LINE FOR THE STORES WITH ERRORS                19980000
199900     INITIALIZE PTL-PICKING-TOTAL-LINE.                           19990000
200000     MOVE '  STRS W/ERRS'             TO PTL-TOTAL-DESCRIPTION.   20000000
200100     MOVE PA-STRS-W-ERRS-PIC          TO PTL-STORE-NBR.           20010000
200200     MOVE PA-VENDOR-OVER              TO PTL-VND-OVER.            20020000
200300     MOVE PA-VENDOR-SHORT             TO PTL-VND-SHORT.           20030000
200400     IF PV-SPOT-AUDIT-CHECK                                       20040000
200500         MOVE '   N/A'                TO PTL-RCVR-OVER-X          20050000
200600                                         PTL-RCVR-SHORT-X         20060000
200700     ELSE                                                         20070000
200800         MOVE PA-RECEIVER-OVER        TO PTL-RCVR-OVER            20080000
200900         MOVE PA-RECEIVER-SHORT       TO PTL-RCVR-SHORT           20090000
201000     END-IF.                                                      20100000
201100     MOVE PA-STYLE-SUB                TO PTL-STYLE-SUB.           20110000
201200     MOVE PA-DAMAGED-UNITS            TO PTL-DAMAGED-UNITS.       20120000
201600     MOVE PA-TOT-ERRS-PIC             TO PTL-TOTAL-ERRORS.        20160000
201700     MOVE PA-TOT-UNTS-IN-ERR-PIC      TO PTL-TOTAL-UNITS-IN-ERROR.20170000
201800     MOVE PA-TOT-UNTS-TRNS-IE-PIC     TO PTL-TOTAL-UNITS-TRNSCRBD.20180000
201900     MOVE PA-TOT-UNTS-AUD-IE-PIC      TO PTL-TOTAL-UNITS-AUDITED. 20190000
202000     MOVE SPACES                      TO PTL-PERCENT              20200000
202100                                         PTL-ERROR-RATIO-X.       20210000
202200                                                                  20220000
202210     IF  CC-FLAT-FILE                                             20221099
202241         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           20224199
202242         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      20224299
202250         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      20225099
202260          FROM PTL-PICKING-TOTAL-LINE                             20226099
202270     ELSE                                                         20227099
202300         WRITE AS-AUDIT-SUM-REPORT-LINE                           20230099
202400          FROM PTL-PICKING-TOTAL-LINE                             20240099
202500         AFTER ADVANCING 2 LINES                                  20250099
202600         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       20260099
202700          FROM PTL-PICKING-TOTAL-LINE                             20270099
202800         AFTER ADVANCING 2 LINES                                  20280099
202810     END-IF.                                                      20281099
202820                                                                  20282099
202900     ADD +2                           TO PV-DETAIL-LINE-COUNT.    20290000
203000                                                                  20300000
203100*    WRITE SUMMARY LINE FOR THE STORES WITH NO ERRORS             20310000
203200     INITIALIZE PTL-PICKING-TOTAL-LINE.                           20320000
203300     MOVE ' STRS WO/ERRS'             TO PTL-TOTAL-DESCRIPTION.   20330000
203400     MOVE PA-STRS-W-NO-ERRS-PIC       TO PTL-STORE-NBR.           20340000
203500     IF PV-SPOT-AUDIT-CHECK                                       20350000
203600         MOVE '   N/A'                TO PTL-RCVR-OVER-X          20360000
203700                                         PTL-RCVR-SHORT-X         20370000
203800     END-IF.                                                      20380000
203900     MOVE PA-TOT-UNTS-TRNS-NE-PIC     TO PTL-TOTAL-UNITS-TRNSCRBD.20390000
204000     MOVE PA-TOT-UNTS-AUD-NE-PIC      TO PTL-TOTAL-UNITS-AUDITED. 20400000
204100     MOVE SPACES                      TO PTL-PERCENT              20410000
204200                                         PTL-ERROR-RATIO-X.       20420000
204201                                                                  20420199
204210     IF  CC-FLAT-FILE                                             20421099
204231         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      20423199
204240          FROM PTL-PICKING-TOTAL-LINE                             20424099
204250     ELSE                                                         20425099
204300         WRITE AS-AUDIT-SUM-REPORT-LINE                           20430099
204400          FROM PTL-PICKING-TOTAL-LINE                             20440099
204500         AFTER ADVANCING 1 LINES                                  20450099
204600         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       20460099
204700          FROM PTL-PICKING-TOTAL-LINE                             20470099
204800         AFTER ADVANCING 1 LINES                                  20480099
204810     END-IF.                                                      20481099
204820                                                                  20482099
204900     ADD +1                           TO PV-DETAIL-LINE-COUNT.    20490000
205000                                                                  20500000
205100*    WRITE SUMMARY LINE FOR THE PICK TOTALS                       20510000
205200     INITIALIZE PTL-PICKING-TOTAL-LINE.                           20520000
205300     MOVE '   PICK TOTAL'             TO PTL-TOTAL-DESCRIPTION.   20530000
205400     MOVE PA-STR-COUNT-PIC            TO PTL-STORE-NBR.           20540000
205500     MOVE PA-VENDOR-OVER              TO PTL-VND-OVER.            20550000
205600     MOVE PA-VENDOR-SHORT             TO PTL-VND-SHORT.           20560000
205700     IF PV-SPOT-AUDIT-CHECK                                       20570000
205800         MOVE '   N/A'                TO PTL-RCVR-OVER-X          20580000
205900                                         PTL-RCVR-SHORT-X         20590000
206000     ELSE                                                         20600000
206100         MOVE PA-RECEIVER-OVER        TO PTL-RCVR-OVER            20610000
206200         MOVE PA-RECEIVER-SHORT       TO PTL-RCVR-SHORT           20620000
206300     END-IF.                                                      20630000
206400     MOVE PA-STYLE-SUB                TO PTL-STYLE-SUB.           20640000
206500     MOVE PA-DAMAGED-UNITS            TO PTL-DAMAGED-UNITS.       20650000
206900     MOVE PA-TOT-ERRS-PIC             TO PTL-TOTAL-ERRORS.        20690000
207000     MOVE PA-TOT-UNTS-IN-ERR-PIC      TO PTL-TOTAL-UNITS-IN-ERROR.20700000
207100     MOVE PA-UNTS-TRNS-PIC            TO PTL-TOTAL-UNITS-TRNSCRBD.20710000
207200     MOVE PA-UNTS-AUD-PIC             TO PTL-TOTAL-UNITS-AUDITED. 20720000
207300     MOVE '%'                         TO PTL-PERCENT.             20730000
207400                                                                  20740000
207500*    IF A SPOT CHECK, USE THE UNITS AUDITED TO CALCULATE THE ERROR20750000
207600*    RATIO, OTHERWISE USE THE UNITS TRANSCRIBED                   20760000
207700     IF PV-SPOT-AUDIT-CHECK                                       20770000
207800         IF PA-TOT-UNTS-AUD-IE-PIC > ZERO                         20780000
207900           COMPUTE PV-ERROR-RATIO  =                              20790000
208000              (PA-TOT-UNTS-IN-ERR-PIC /                           20800000
208100               PA-UNTS-AUD-PIC ) * 100                            20810000
208200           MOVE PV-ERROR-RATIO            TO PTL-ERROR-RATIO      20820000
208300         ELSE                                                     20830000
208400             IF PA-TOT-UNTS-IN-ERR-PIC > ZERO                     20840000
208500                 MOVE 100                 TO PTL-ERROR-RATIO      20850000
208600             ELSE                                                 20860000
208700                 MOVE ZERO                TO PTL-ERROR-RATIO      20870000
208800             END-IF                                               20880000
208900         END-IF                                                   20890000
209000     ELSE                                                         20900000
209100         IF PA-TOT-UNTS-TRNS-IE-PIC > ZERO                        20910000
209200           COMPUTE PV-ERROR-RATIO  =                              20920000
209300              (PA-TOT-UNTS-IN-ERR-PIC /                           20930000
209400               PA-UNTS-TRNS-PIC) * 100                            20940000
209500           MOVE PV-ERROR-RATIO            TO PTL-ERROR-RATIO      20950000
209600         ELSE                                                     20960000
209700             IF PA-TOT-UNTS-IN-ERR-PIC > ZERO                     20970000
209800                 MOVE 100                 TO PTL-ERROR-RATIO      20980000
209900             ELSE                                                 20990000
210000                 MOVE ZERO                TO PTL-ERROR-RATIO      21000000
210100             END-IF                                               21010000
210200         END-IF                                                   21020000
210300     END-IF.                                                      21030000
210400                                                                  21040000
210410     IF  CC-FLAT-FILE                                             21041099
210431         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21043199
210440          FROM PTL-PICKING-TOTAL-LINE                             21044099
210450     ELSE                                                         21045099
210500         WRITE AS-AUDIT-SUM-REPORT-LINE                           21050099
210600          FROM PTL-PICKING-TOTAL-LINE                             21060099
210700         AFTER ADVANCING 1 LINES                                  21070099
210800         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21080099
210900         FROM PTL-PICKING-TOTAL-LINE                              21090000
211000         AFTER ADVANCING 1 LINES                                  21100099
211010     END-IF.                                                      21101099
211100                                                                  21110000
211200     ADD +1                           TO PV-DETAIL-LINE-COUNT.    21120000
211300                                                                  21130000
211400                                                                  21140000
211500******************************************************************21150000
211600* 2220-PRINT-PICK-HEADINGS                                        21160000
211700*  -PRINT THE DETAIL HEADINGS FOR THE PICKING ERRORS              21170000
211800******************************************************************21180000
211900 2220-PRINT-PICK-HEADINGS.                                        21190000
212000                                                                  21200000
212100*    IF THE HEADINGS + 1 DETAIL LINE WON'T FIT, GOTO THE NEXT PGE 21210000
212200     IF (PV-DETAIL-LINE-COUNT + 8) > PC-MAX-REPORT-LINES          21220000
212300         PERFORM 3000-PRINT-PAGE-HEADING                          21230000
212500     END-IF                                                       21250000
212600     SET PS-DONT-PRINT-PICK-HEADING   TO TRUE                     21260000
212700                                                                  21270000
212710     IF  CC-FLAT-FILE                                             21271099
212731         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           21273199
212732         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21273299
212740         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21274099
212750          FROM PDH1-PICKING-DETAIL-HEADING-1                      21275099
212760     ELSE                                                         21276099
212800         WRITE AS-AUDIT-SUM-REPORT-LINE                           21280099
212900          FROM PDH1-PICKING-DETAIL-HEADING-1                      21290099
213000         AFTER ADVANCING 2 LINES                                  21300099
213100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21310099
213200          FROM PDH1-PICKING-DETAIL-HEADING-1                      21320099
213300         AFTER ADVANCING 2 LINES                                  21330099
213310     END-IF.                                                      21331099
213400                                                                  21340000
213410     IF  CC-FLAT-FILE                                             21341099
213440         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21344099
213450          FROM PDH1-PICKING-DETAIL-HEADING-1A                     21345099
213460     ELSE                                                         21346099
213500         WRITE AS-AUDIT-SUM-REPORT-LINE                           21350099
213600         FROM PDH1-PICKING-DETAIL-HEADING-1A                      21360000
213700         AFTER ADVANCING 2 LINES                                  21370099
213800         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21380099
213900         FROM PDH1-PICKING-DETAIL-HEADING-1A                      21390000
214000         AFTER ADVANCING 2 LINES                                  21400099
214010     END-IF.                                                      21401099
214100                                                                  21410000
214110     IF  CC-FLAT-FILE                                             21411099
214120         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           21412099
214132         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21413299
214140          FROM PDH2-PICKING-DETAIL-HEADING-2                      21414099
214150     ELSE                                                         21415099
214200         WRITE AS-AUDIT-SUM-REPORT-LINE                           21420099
214300         FROM PDH2-PICKING-DETAIL-HEADING-2                       21430000
214400         AFTER ADVANCING 1 LINES                                  21440099
214410         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21441099
214600         FROM PDH2-PICKING-DETAIL-HEADING-2                       21460000
214700         AFTER ADVANCING 1 LINES                                  21470099
214710     END-IF.                                                      21471099
214800                                                                  21480000
214810     IF  CC-FLAT-FILE                                             21481099
214820         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           21482099
214830         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      21483099
214840          FROM PDH3-PICKING-DETAIL-HEADING-3                      21484099
214850     ELSE                                                         21485099
214900         WRITE AS-AUDIT-SUM-REPORT-LINE                           21490099
215000          FROM PDH3-PICKING-DETAIL-HEADING-3                      21500099
215100         AFTER ADVANCING 1 LINES                                  21510099
215200         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       21520099
215300          FROM PDH3-PICKING-DETAIL-HEADING-3                      21530099
215400         AFTER ADVANCING 1 LINES                                  21540099
215410     END-IF.                                                      21541099
215420                                                                  21542099
215500     ADD +6                           TO PV-DETAIL-LINE-COUNT.    21550000
215600                                                                  21560000
215700                                                                  21570000
215800******************************************************************21580000
215900* 2300-CREATE-TICKETING-DETAIL                                    21590000
216000*  -DETERMINE IF THERE ARE ANY ERRORS TO REPORT FOR THIS STORE    21600000
216100*      -IF SO, PRINT THE DETAIL REPORT, ADDING THE QUANTITES TO   21610000
216200*       THE ERROR ACCUMULATOR FIELDS.                             21620000
216300*      -OTHERWISE ADD TO THE "STORE WITH NO ERROR" BUCKETS        21630000
216400******************************************************************21640000
216500 2300-CREATE-TICKETING-DETAIL.                                    21650000
216600                                                                  21660000
216700     IF PS-PRINT-TICK-HEADING                                     21670000
216800         PERFORM 2320-PRINT-TICK-HEADINGS                         21680000
216900     END-IF.                                                      21690000
217000                                                                  21700000
217100     INITIALIZE TDL-TICKETING-DETAIL-LINE.                        21710000
217200                                                                  21720000
217300     SET   PS-DONT-PRINT-DETAIL       TO TRUE.                    21730000
217400                                                                  21740000
217500     MOVE SU005-DEST-OPER-UNT-ID      TO TDL-STORE-NBR.           21750000
217600                                                                  21760000
217700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21770000
217800*  *  MISSING TICKET *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21780000
217900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21790000
218000     IF  SU005-MISSING-TICKET          > ZERO                     21800000
218100         MOVE  SU005-MISSING-TICKET   TO TDL-MISSING-TICKET       21810000
218200         SET   PS-PRINT-DETAIL        TO TRUE                     21820000
218300                                                                  21830000
218400         MOVE 'PA-MISSING-TICKET'     TO PV-FIELD-NAME            21840000
218500         COMPUTE PA-MISSING-TICKET =                              21850000
218600                 PA-MISSING-TICKET + SU005-MISSING-TICKET         21860000
218700             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      21870000
218800         END-COMPUTE                                              21880000
218900     END-IF.                                                      21890000
219000                                                                  21900000
219100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21910000
219200*  *  WRONG TICKET   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21920000
219300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  21930000
219400     IF  SU005-WRONG-TICKET            > ZERO                     21940000
219500         MOVE  SU005-WRONG-TICKET     TO TDL-WRONG-TICKET         21950000
219600         SET   PS-PRINT-DETAIL        TO TRUE                     21960000
219700                                                                  21970000
219800         MOVE 'PA-WRONG-TICKET'       TO PV-FIELD-NAME            21980000
219900         COMPUTE PA-WRONG-TICKET =                                21990000
220000                 PA-WRONG-TICKET + SU005-WRONG-TICKET             22000000
220100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22010000
220200         END-COMPUTE                                              22020000
220300     END-IF.                                                      22030000
220400                                                                  22040000
220500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22050000
220600*  *  WRONG LABEL ON TICKET   *  *  *  *  *  *  *  *  *  *  *  *  22060000
220700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22070000
220800     IF  SU005-WRONG-LABEL             > ZERO                     22080000
220900         MOVE  SU005-WRONG-LABEL           TO TDL-WRONG-LABEL     22090000
221000         SET   PS-PRINT-DETAIL        TO TRUE                     22100000
221100                                                                  22110000
221200         MOVE 'PA-WRONG-LABEL' TO PV-FIELD-NAME                   22120000
221300         COMPUTE PA-WRONG-LABEL =                                 22130000
221400                 PA-WRONG-LABEL +                                 22140000
221500                 SU005-WRONG-LABEL                                22150000
221600             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22160000
221700         END-COMPUTE                                              22170000
221800     END-IF.                                                      22180000
221900                                                                  22190000
222000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22200000
222100*  *  NO BARCODE  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22210000
222200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22220000
222300     IF  SU005-NO-BARCODE              > ZERO                     22230000
222400         MOVE  SU005-NO-BARCODE TO TDL-NO-BARCODE                 22240000
222500         SET   PS-PRINT-DETAIL        TO TRUE                     22250000
222600                                                                  22260000
222700         MOVE 'PA-NO-BARCODE' TO PV-FIELD-NAME                    22270000
222800         COMPUTE PA-NO-BARCODE = PA-NO-BARCODE + SU005-NO-BARCODE 22280000
222900             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22290000
223000         END-COMPUTE                                              22300000
223100     END-IF.                                                      22310000
223200                                                                  22320000
223300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22330000
223400*  *  DAMAGED BARCODE   *  *  *  *  *  *  *  *  *  *  *  *  *  *  22340000
223500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22350000
223600     IF  SU005-DAMAGED-BARCODE         > ZERO                     22360000
223700         MOVE  SU005-DAMAGED-BARCODE TO TDL-DAMAGED-BARCODE       22370000
223800         SET   PS-PRINT-DETAIL        TO TRUE                     22380000
223900                                                                  22390000
224000         MOVE 'PA-DAMAGED-BARCODE' TO PV-FIELD-NAME               22400000
224100         COMPUTE PA-DAMAGED-BARCODE =                             22410000
224200                 PA-DAMAGED-BARCODE + SU005-DAMAGED-BARCODE       22420000
224300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22430000
224400         END-COMPUTE                                              22440000
224500     END-IF.                                                      22450000
224600                                                                  22460000
224700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22470000
224800*  *  WRONG UPC   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22480000
224900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22490000
225000     IF  SU005-WRONG-UPC               > ZERO                     22500000
225100         MOVE  SU005-WRONG-UPC       TO TDL-WRONG-UPC             22510000
225200         SET   PS-PRINT-DETAIL        TO TRUE                     22520000
225300                                                                  22530000
225400         MOVE 'PA-WRONG-UPC'       TO PV-FIELD-NAME               22540000
225500         COMPUTE PA-WRONG-UPC       =                             22550000
225600                 PA-WRONG-UPC       + SU005-WRONG-UPC             22560000
225700             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22570000
225800         END-COMPUTE                                              22580000
225900     END-IF.                                                      22590000
226000                                                                  22600000
226100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22610000
226200*  *  NO UPC      *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22620000
226300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22630000
226400     IF  SU005-NO-UPC                  > ZERO                     22640000
226500         MOVE  SU005-NO-UPC          TO TDL-NO-UPC                22650000
226600         SET   PS-PRINT-DETAIL        TO TRUE                     22660000
226700                                                                  22670000
226800         MOVE 'PA-NO-UPC'          TO PV-FIELD-NAME               22680000
226900         COMPUTE PA-NO-UPC          =                             22690000
227000                 PA-NO-UPC          + SU005-NO-UPC                22700000
227100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22710000
227200         END-COMPUTE                                              22720000
227300     END-IF.                                                      22730000
227400                                                                  22740000
227500                                                                  22750000
227600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22760000
227700*  *  TOTAL ERRORS   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22770000
227800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22780000
227900     IF  SU005-TOT-TIC-ERR             > ZERO                     22790000
228000         MOVE  SU005-TOT-TIC-ERR      TO TDL-TOTAL-ERRORS         22800000
228100         SET   PS-PRINT-DETAIL        TO TRUE                     22810000
228200                                                                  22820000
228300         MOVE 'PA-TOT-ERRS-TIC'       TO PV-FIELD-NAME            22830000
228400         COMPUTE PA-TOT-ERRS-TIC  =                               22840000
228500                 PA-TOT-ERRS-TIC  + SU005-TOT-TIC-ERR             22850000
228600             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      22860000
228700         END-COMPUTE                                              22870000
228800     END-IF.                                                      22880000
228900                                                                  22890000
229000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22900000
229100*  *  UNITS IN ERROR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22910000
229200*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  22920000
229300     IF  SU005-TOT-UNITS-IN-TIC-ERR    > ZERO                     22930000
229400         MOVE  SU005-TOT-UNITS-IN-TIC-ERR                         22940000
229500                                      TO TDL-TOTAL-UNITS-IN-ERROR 22950000
229600         SET   PS-PRINT-DETAIL        TO TRUE                     22960000
229700                                                                  22970000
229800         MOVE 'PA-TOT-UNTS-IN-ERR-TIC' TO PV-FIELD-NAME           22980000
229900         COMPUTE PA-TOT-UNTS-IN-ERR-TIC =                         22990000
230000                 PA-TOT-UNTS-IN-ERR-TIC +                         23000000
230100                 SU005-TOT-UNITS-IN-TIC-ERR                       23010000
230200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      23020000
230300         END-COMPUTE                                              23030000
230400     END-IF.                                                      23040000
230500                                                                  23050000
230600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23060000
230700*  *  UNITS TRANSCRIBED *  *  *  *  *  *  *  *  *  *  *  *  *  *  23070000
230800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23080000
230900     IF  SU005-UNITS-TRNSCRBD          > ZERO                     23090000
231000         MOVE  SU005-UNITS-TRNSCRBD   TO TDL-TOTAL-UNITS-TRNSCRBD 23100000
231100                                                                  23110000
231200*        IF THERE ARE ERRORS, ADD THE UNITS TRANSCRIBED TO THE    23120000
231300*        TOTAL FOR THOSE STORES WITH ERRORS.                      23130000
231400         IF PS-PRINT-DETAIL                                       23140000
231500             MOVE 'PA-TOT-UNTS-TRNS-IE-TIC' TO PV-FIELD-NAME      23150000
231600             COMPUTE PA-TOT-UNTS-TRNS-IE-TIC =                    23160000
231700                     PA-TOT-UNTS-TRNS-IE-TIC +                    23170000
231800                     SU005-UNITS-TRNSCRBD                         23180000
231900                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23190000
232000             END-COMPUTE                                          23200000
232100         ELSE                                                     23210000
232200*        OTHERWISE ADD TO THOSE STORES WITH NO ERRORS             23220000
232300             MOVE 'PA-TOT-UNTS-TRNS-IE-TIC' TO PV-FIELD-NAME      23230000
232400             COMPUTE PA-TOT-UNTS-TRNS-NE-TIC =                    23240000
232500                     PA-TOT-UNTS-TRNS-NE-TIC +                    23250000
232600                     SU005-UNITS-TRNSCRBD                         23260000
232700                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23270000
232800             END-COMPUTE                                          23280000
232900         END-IF                                                   23290000
233000*        EITHER WAY ADD TO THE OVERALL TOTAL                      23300000
233100         MOVE 'PA-UNTS-TRNS-TIC'             TO PV-FIELD-NAME     23310000
233200         COMPUTE PA-UNTS-TRNS-TIC =                               23320000
233300                 PA-UNTS-TRNS-TIC +                               23330000
233400                 SU005-UNITS-TRNSCRBD                             23340000
233500             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      23350000
233600         END-COMPUTE                                              23360000
233700     END-IF.                                                      23370000
233800                                                                  23380000
233900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23390000
234000*  *  UNITS AUDITED  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23400000
234100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  23410000
234200     IF  SU005-UNITS-AUDITED           > ZERO                     23420000
234300         MOVE  SU005-UNITS-AUDITED    TO TDL-TOTAL-UNITS-AUDITED  23430000
234400                                                                  23440000
234500*        IF THERE ARE ERRORS, ADD THE UNITS AUDITED TO THE BUCKET 23450000
234600*        TOTAL FOR THOSE STORES WITH ERRORS.                      23460000
234700         IF PS-PRINT-DETAIL                                       23470000
234800             MOVE 'PA-TOT-UNTS-AUD-IE-TIC' TO PV-FIELD-NAME       23480000
234900             COMPUTE PA-TOT-UNTS-AUD-IE-TIC =                     23490000
235000                     PA-TOT-UNTS-AUD-IE-TIC +                     23500000
235100                     SU005-UNITS-AUDITED                          23510000
235200                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23520000
235300             END-COMPUTE                                          23530000
235400         ELSE                                                     23540000
235500*        OTHERWISE ADD TO THOSE STORES WITH NO ERRORS             23550000
235600             MOVE 'PA-TOT-UNTS-AUD-NE-TIC' TO PV-FIELD-NAME       23560000
235700             COMPUTE PA-TOT-UNTS-AUD-NE-TIC =                     23570000
235800                     PA-TOT-UNTS-AUD-NE-TIC +                     23580000
235900                     SU005-UNITS-AUDITED                          23590000
236000                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  23600000
236100             END-COMPUTE                                          23610000
236200         END-IF                                                   23620000
236300*        EITHER WAY ADD TO THE OVERALL TOTAL                      23630000
236400         MOVE 'PA-UNTS-AUD-PIC'             TO PV-FIELD-NAME      23640000
236500         COMPUTE PA-UNTS-AUD-TIC       =                          23650000
236600                 PA-UNTS-AUD-TIC       +                          23660000
236700                 SU005-UNITS-AUDITED                              23670000
236800             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      23680000
236900         END-COMPUTE                                              23690000
237000     END-IF.                                                      23700000
237100                                                                  23710000
237200*    IF ANY ERRORS FOUND, PRINT THE DETAIL...IF NOT, ADD TO THE   23720000
237300*    TOTALS OF THE STORES WITH NO ERRORS                          23730000
237400     IF PS-PRINT-DETAIL                                           23740000
237500*        IF A SPOT CHECK, USE THE UNITS AUDITED TO CALCULATE THE  23750000
237600*        ERROR RATIO, OTHERWISE USE THE UNITS TRANSCRIBED         23760000
237700         IF PV-SPOT-AUDIT-CHECK                                   23770000
237800             IF SU005-UNITS-AUDITED > ZERO                        23780000
237900                 COMPUTE PV-ERROR-RATIO  =                        23790000
238000                     (SU005-TOT-UNITS-IN-TIC-ERR /                23800000
238100                      SU005-UNITS-AUDITED)  * 100                 23810000
238200                 MOVE PV-ERROR-RATIO    TO TDL-ERROR-RATIO        23820000
238300             ELSE                                                 23830000
238400                 IF SU005-TOT-UNITS-IN-TIC-ERR > ZERO             23840000
238500                     MOVE 100           TO TDL-ERROR-RATIO        23850000
238600                 ELSE                                             23860000
238700                     MOVE ZERO          TO TDL-ERROR-RATIO        23870000
238800                 END-IF                                           23880000
238900             END-IF                                               23890000
239000         ELSE                                                     23900000
239100             IF SU005-UNITS-TRNSCRBD > ZERO                       23910000
239200                 COMPUTE PV-ERROR-RATIO  =                        23920000
239300                     (SU005-TOT-UNITS-IN-TIC-ERR /                23930000
239400                      SU005-UNITS-TRNSCRBD)  * 100                23940000
239500                 MOVE PV-ERROR-RATIO    TO TDL-ERROR-RATIO        23950000
239600             ELSE                                                 23960000
239700                 IF SU005-TOT-UNITS-IN-TIC-ERR > ZERO             23970000
239800                     MOVE 100           TO TDL-ERROR-RATIO        23980000
239900                 ELSE                                             23990000
240000                     MOVE ZERO          TO TDL-ERROR-RATIO        24000000
240100                 END-IF                                           24010000
240200             END-IF                                               24020000
240300         END-IF                                                   24030000
240400                                                                  24040000
240500         MOVE '%'                   TO TDL-PERCENT                24050000
240600                                                                  24060000
240700         IF (PV-DETAIL-LINE-COUNT + 1) > PC-MAX-REPORT-LINES      24070000
240800             PERFORM 3000-PRINT-PAGE-HEADING                      24080000
241000             PERFORM 2320-PRINT-TICK-HEADINGS                     24100000
241100         END-IF                                                   24110000
241200                                                                  24120000
241210                                                                  24121099
241220         IF  CC-FLAT-FILE                                         24122099
241241             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  24124199
241250              FROM TDL-TICKETING-DETAIL-LINE                      24125099
241260         ELSE                                                     24126099
241300             WRITE AS-AUDIT-SUM-REPORT-LINE                       24130099
241400              FROM TDL-TICKETING-DETAIL-LINE                      24140099
241500             AFTER ADVANCING 1 LINES                              24150000
241600             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   24160099
241700              FROM TDL-TICKETING-DETAIL-LINE                      24170099
241800             AFTER ADVANCING 1 LINES                              24180000
241810         END-IF                                                   24181099
241820                                                                  24182099
241900         ADD +1                     TO PV-DETAIL-LINE-COUNT       24190000
242000                                       PA-STRS-W-ERRS-TIC         24200000
242100                                       PA-STR-COUNT-TIC           24210000
242200     ELSE                                                         24220000
242300         ADD +1                     TO PA-STRS-W-NO-ERRS-TIC      24230000
242400                                       PA-STR-COUNT-TIC           24240000
242500     END-IF.                                                      24250000
242600                                                                  24260000
242700     PERFORM 8001-READ-EXTRACT-FILE.                              24270000
242800                                                                  24280000
242900                                                                  24290000
243000******************************************************************24300000
243100* 2310-CREATE-TICKETING-SUMMARY.                                  24310000
243200*  -PRINT THE ERROR AND NO-ERROR SUB TOTALS AND A PICK TOTAL LINE 24320000
243300******************************************************************24330000
243400 2310-CREATE-TICKETING-SUMMARY.                                   24340000
243500                                                                  24350000
243600*    IF THE SUMMARY WON'T FIT ON THE PAGE, GO TO THE NEXT ONE     24360000
243700     IF (PV-DETAIL-LINE-COUNT + 4) > PC-MAX-REPORT-LINES          24370000
243800         PERFORM 3000-PRINT-PAGE-HEADING                          24380000
244000     END-IF                                                       24400000
244100                                                                  24410000
244200*    WRITE SUMMARY LINE FOR THE STORES WITH ERRORS                24420000
244300     INITIALIZE TTL-TICKETING-TOTAL-LINE.                         24430000
244400     MOVE '  STRS W/ERRS'             TO TTL-TOTAL-DESCRIPTION.   24440000
244500     MOVE PA-STRS-W-ERRS-TIC          TO TTL-STORE-NBR.           24450000
244600     MOVE PA-MISSING-TICKET           TO TTL-MISSING-TICKET.      24460000
244700     MOVE PA-WRONG-TICKET             TO TTL-WRONG-TICKET.        24470000
244800     MOVE PA-WRONG-LABEL              TO TTL-WRONG-LABEL.         24480000
244900     MOVE PA-NO-BARCODE               TO TTL-NO-BARCODE.          24490000
245000     MOVE PA-DAMAGED-BARCODE          TO TTL-DAMAGED-BARCODE.     24500000
245100     MOVE PA-WRONG-UPC                TO TTL-WRONG-UPC.           24510000
245200     MOVE PA-NO-UPC                   TO TTL-NO-UPC.              24520000
245300     MOVE PA-TOT-ERRS-TIC             TO TTL-TOTAL-ERRORS.        24530000
245400     MOVE PA-TOT-UNTS-IN-ERR-TIC      TO TTL-TOTAL-UNITS-IN-ERROR.24540000
245500     MOVE PA-TOT-UNTS-TRNS-IE-TIC     TO TTL-TOTAL-UNITS-TRNSCRBD.24550000
245600     MOVE PA-TOT-UNTS-AUD-IE-TIC      TO TTL-TOTAL-UNITS-AUDITED. 24560000
245700     MOVE SPACES                      TO TTL-PERCENT              24570000
245800                                         TTL-ERROR-RATIO-X.       24580000
249000                                                                  24900000
249010     IF  CC-FLAT-FILE                                             24901099
249031         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           24903199
249032         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      24903299
249040         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      24904099
249050          FROM TTL-TICKETING-TOTAL-LINE                           24905099
249060     ELSE                                                         24906099
249100         WRITE AS-AUDIT-SUM-REPORT-LINE                           24910099
249200          FROM TTL-TICKETING-TOTAL-LINE                           24920099
249300         AFTER ADVANCING 2 LINES                                  24930099
249400         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       24940099
249500          FROM TTL-TICKETING-TOTAL-LINE                           24950099
249600         AFTER ADVANCING 2 LINES                                  24960099
249610     END-IF.                                                      24961099
249620                                                                  24962099
249700     ADD +2                           TO PV-DETAIL-LINE-COUNT.    24970000
249800                                                                  24980000
249900*    WRITE SUMMARY LINE FOR THE STORES WITH NO ERRORS             24990000
250000     INITIALIZE TTL-TICKETING-TOTAL-LINE.                         25000000
250100     MOVE ' STRS WO/ERRS'             TO TTL-TOTAL-DESCRIPTION.   25010000
250200     MOVE PA-STRS-W-NO-ERRS-TIC       TO TTL-STORE-NBR.           25020000
250300     MOVE PA-TOT-UNTS-TRNS-NE-TIC     TO TTL-TOTAL-UNITS-TRNSCRBD.25030000
250400     MOVE PA-TOT-UNTS-AUD-NE-TIC      TO TTL-TOTAL-UNITS-AUDITED. 25040000
250500     MOVE SPACES                      TO TTL-PERCENT              25050000
250600                                         TTL-ERROR-RATIO-X.       25060000
250610                                                                  25061099
250620     IF  CC-FLAT-FILE                                             25062099
250641         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25064199
250650          FROM TTL-TICKETING-TOTAL-LINE                           25065099
250660     ELSE                                                         25066099
250700         WRITE AS-AUDIT-SUM-REPORT-LINE                           25070099
250800          FROM TTL-TICKETING-TOTAL-LINE                           25080099
250900         AFTER ADVANCING 1 LINES                                  25090099
251000         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       25100099
251100          FROM TTL-TICKETING-TOTAL-LINE                           25110099
251200         AFTER ADVANCING 1 LINES                                  25120099
251210     END-IF.                                                      25121099
251220                                                                  25122099
251300     ADD +1                           TO PV-DETAIL-LINE-COUNT.    25130000
251400                                                                  25140000
251500*    WRITE SUMMARY LINE FOR THE TICKETING TOTALS                  25150000
251600     INITIALIZE TTL-TICKETING-TOTAL-LINE.                         25160000
251700     MOVE '   TICK TOTAL'             TO TTL-TOTAL-DESCRIPTION.   25170000
251800     MOVE PA-STR-COUNT-TIC            TO TTL-STORE-NBR.           25180000
251900     MOVE PA-MISSING-TICKET           TO TTL-MISSING-TICKET.      25190000
252000     MOVE PA-WRONG-TICKET             TO TTL-WRONG-TICKET.        25200000
252100     MOVE PA-WRONG-LABEL              TO TTL-WRONG-LABEL.         25210000
252200     MOVE PA-NO-BARCODE               TO TTL-NO-BARCODE.          25220000
252300     MOVE PA-DAMAGED-BARCODE          TO TTL-DAMAGED-BARCODE.     25230000
252400     MOVE PA-WRONG-UPC                TO TTL-WRONG-UPC.           25240000
252500     MOVE PA-NO-UPC                   TO TTL-NO-UPC.              25250000
252600     MOVE PA-TOT-ERRS-TIC             TO TTL-TOTAL-ERRORS.        25260000
252700     MOVE PA-TOT-UNTS-IN-ERR-TIC      TO TTL-TOTAL-UNITS-IN-ERROR.25270000
252800     MOVE PA-UNTS-TRNS-TIC            TO TTL-TOTAL-UNITS-TRNSCRBD.25280000
252900     MOVE PA-UNTS-AUD-TIC             TO TTL-TOTAL-UNITS-AUDITED. 25290000
253000     MOVE '%'                         TO TTL-PERCENT.             25300000
253100                                                                  25310000
253200*    IF A SPOT AUDIT, USE THE UNITS AUDITED TO CALCULATE THE ERROR25320000
253300*    RATIO, OTHERWISE USE THE UNITS TRANSCRIBED                   25330000
253400     IF PV-SPOT-AUDIT-CHECK                                       25340000
253500         IF PA-UNTS-AUD-TIC > ZERO                                25350000
253600             COMPUTE PV-ERROR-RATIO  =                            25360000
253700                (PA-TOT-UNTS-IN-ERR-TIC /                         25370000
253800                 PA-UNTS-AUD-TIC) * 100                           25380000
253900             MOVE PV-ERROR-RATIO          TO TTL-ERROR-RATIO      25390000
254000         ELSE                                                     25400000
254100             IF PA-TOT-UNTS-IN-ERR-TIC > ZERO                     25410000
254200                 MOVE 100                 TO TTL-ERROR-RATIO      25420000
254300             ELSE                                                 25430000
254400                 MOVE ZERO                TO TTL-ERROR-RATIO      25440000
254500             END-IF                                               25450000
254600         END-IF                                                   25460000
254700     ELSE                                                         25470000
254800         IF PA-UNTS-TRNS-TIC > ZERO                               25480000
254900             COMPUTE PV-ERROR-RATIO  =                            25490000
255000                (PA-TOT-UNTS-IN-ERR-TIC /                         25500000
255100                 PA-UNTS-TRNS-TIC) * 100                          25510000
255200             MOVE PV-ERROR-RATIO          TO TTL-ERROR-RATIO      25520000
255300         ELSE                                                     25530000
255400             IF PA-TOT-UNTS-IN-ERR-TIC > ZERO                     25540000
255500                 MOVE 100                 TO TTL-ERROR-RATIO      25550000
255600             ELSE                                                 25560000
255700                 MOVE ZERO                TO TTL-ERROR-RATIO      25570000
255800             END-IF                                               25580000
255900         END-IF                                                   25590000
256000     END-IF.                                                      25600000
256100                                                                  25610000
256110     IF  CC-FLAT-FILE                                             25611099
256131         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25613199
256140          FROM TTL-TICKETING-TOTAL-LINE                           25614099
256150     ELSE                                                         25615099
256200         WRITE AS-AUDIT-SUM-REPORT-LINE                           25620099
256300          FROM TTL-TICKETING-TOTAL-LINE                           25630099
256400         AFTER ADVANCING 1 LINES                                  25640099
256500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       25650099
256600          FROM TTL-TICKETING-TOTAL-LINE                           25660099
256700         AFTER ADVANCING 1 LINES                                  25670099
256710     END-IF.                                                      25671099
256720                                                                  25672099
256800     ADD +1                           TO PV-DETAIL-LINE-COUNT.    25680000
256900                                                                  25690000
257000                                                                  25700000
257100******************************************************************25710000
257200* 2320-PRINT-TICK-HEADINGS                                        25720000
257300*  -PRINT THE DETAIL HEADINGS FOR THE TICKETING ERRORS            25730000
257400******************************************************************25740000
257500 2320-PRINT-TICK-HEADINGS.                                        25750000
257600                                                                  25760000
257700*    IF THE HEADINGS + 1 DETAIL LINE WON'T FIT, GOTO THE NEXT PGE 25770000
257800     IF (PV-DETAIL-LINE-COUNT + 8) > PC-MAX-REPORT-LINES          25780000
257900         PERFORM 3000-PRINT-PAGE-HEADING                          25790000
258100     END-IF                                                       25810000
258110                                                                  25811099
258200     SET PS-DONT-PRINT-TICK-HEADING TO TRUE                       25820000
258300                                                                  25830000
258310     IF  CC-FLAT-FILE                                             25831099
258331         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           25833199
258332         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25833299
258340         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25834099
258350          FROM TDH1-TICK-DETAIL-HEADING-1                         25835099
258360     ELSE                                                         25836099
258400         WRITE AS-AUDIT-SUM-REPORT-LINE                           25840099
258500          FROM TDH1-TICK-DETAIL-HEADING-1                         25850099
258600         AFTER ADVANCING 2 LINES                                  25860099
258700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       25870099
258800          FROM TDH1-TICK-DETAIL-HEADING-1                         25880099
258900         AFTER ADVANCING 2 LINES                                  25890099
258910     END-IF.                                                      25891099
259000                                                                  25900000
259010     IF  CC-FLAT-FILE                                             25901099
259040         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25904099
259050          FROM TDH1-TICK-DETAIL-HEADING-1A                        25905099
259060     ELSE                                                         25906099
259100         WRITE AS-AUDIT-SUM-REPORT-LINE                           25910099
259200          FROM TDH1-TICK-DETAIL-HEADING-1A                        25920099
259300         AFTER ADVANCING 2 LINES                                  25930099
259400         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       25940099
259500          FROM TDH1-TICK-DETAIL-HEADING-1A                        25950099
259600         AFTER ADVANCING 2 LINES                                  25960099
259610     END-IF.                                                      25961099
259700                                                                  25970000
259710     IF  CC-FLAT-FILE                                             25971099
259720         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           25972099
259733         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      25973399
259740          FROM TDH2-TICK-DETAIL-HEADING-2                         25974099
259750     ELSE                                                         25975099
259800         WRITE AS-AUDIT-SUM-REPORT-LINE                           25980099
259900          FROM TDH2-TICK-DETAIL-HEADING-2                         25990099
260000         AFTER ADVANCING 1 LINES                                  26000099
260100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       26010099
260200          FROM TDH2-TICK-DETAIL-HEADING-2                         26020099
260300         AFTER ADVANCING 1 LINES                                  26030099
260310     END-IF.                                                      26031099
260400                                                                  26040000
260410     IF  CC-FLAT-FILE                                             26041099
260420         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           26042099
260430         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      26043099
260440          FROM TDH3-TICK-DETAIL-HEADING-3                         26044099
260450     ELSE                                                         26045099
260500         WRITE AS-AUDIT-SUM-REPORT-LINE                           26050099
260600          FROM TDH3-TICK-DETAIL-HEADING-3                         26060099
260700         AFTER ADVANCING 1 LINES                                  26070099
260800         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       26080099
260900          FROM TDH3-TICK-DETAIL-HEADING-3                         26090099
261000         AFTER ADVANCING 1 LINES                                  26100099
261010     END-IF.                                                      26101099
261100                                                                  26110000
261200     ADD +6                           TO PV-DETAIL-LINE-COUNT.    26120000
261300                                                                  26130000
261400                                                                  26140000
261500                                                                  26150000
261600******************************************************************26160000
261700* 2400-PRINT-FOOTER.                                              26170000
261800******************************************************************26180000
261900 2400-PRINT-FOOTER.                                               26190000
262000                                                                  26200000
262100*    IF THE FOOTER LINE WON'T FIT, GOTO THE NEXT PGE              26210000
262200     IF (PV-DETAIL-LINE-COUNT + 5) > PC-MAX-REPORT-LINES          26220000
262300         PERFORM 3000-PRINT-PAGE-HEADING                          26230000
262500     END-IF.                                                      26250000
262600                                                                  26260000
262700     INITIALIZE TRL-TOTAL-RATIO-LINE.                             26270000
262800     MOVE '  TOTAL PICKING ERROR RATIO -  '                       26280000
262900                                TO TRL-TOTAL-RATIO-DESC.          26290000
263000*    IF A SPOT CHECK, USE THE UNITS AUDIT TO CALCULATE THE ERROR  26300000
263100*    RATIO, OTHERWISE USE THE UNITS TRANSCRIBED                   26310000
263200     IF PV-SPOT-AUDIT-CHECK                                       26320000
263300         IF PA-UNTS-AUD-PIC > ZERO                                26330000
263400             COMPUTE PV-ERROR-RATIO  =                            26340000
263500                (PA-TOT-UNTS-IN-ERR-PIC /                         26350000
263600                 PA-UNTS-AUD-PIC) * 100                           26360000
263700             MOVE PV-ERROR-RATIO    TO TRL-TOTAL-RATIO            26370000
263800         ELSE                                                     26380000
263900             IF PA-TOT-UNTS-IN-ERR-PIC > ZERO                     26390000
264000                 MOVE 100           TO TRL-TOTAL-RATIO            26400000
264100             ELSE                                                 26410000
264200                 MOVE ZERO          TO TRL-TOTAL-RATIO            26420000
264300             END-IF                                               26430000
264400         END-IF                                                   26440000
264500     ELSE                                                         26450000
264600         IF PA-UNTS-TRNS-PIC > ZERO                               26460000
264700             COMPUTE PV-ERROR-RATIO  =                            26470000
264800                (PA-TOT-UNTS-IN-ERR-PIC /                         26480000
264900                 PA-UNTS-TRNS-PIC) * 100                          26490000
265000             MOVE PV-ERROR-RATIO    TO TRL-TOTAL-RATIO            26500000
265100         ELSE                                                     26510000
265200             IF PA-TOT-UNTS-IN-ERR-PIC > ZERO                     26520000
265300                 MOVE 100           TO TRL-TOTAL-RATIO            26530000
265400             ELSE                                                 26540000
265500                 MOVE ZERO          TO TRL-TOTAL-RATIO            26550000
265600             END-IF                                               26560000
265700         END-IF                                                   26570000
265800     END-IF.                                                      26580000
265900                                                                  26590099
265910     IF  CC-FLAT-FILE                                             26591099
265931         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           26593199
265932         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      26593299
265940         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      26594099
265950          FROM TRL-TOTAL-RATIO-LINE                               26595099
265960     ELSE                                                         26596099
266000         WRITE AS-AUDIT-SUM-REPORT-LINE                           26600099
266100          FROM TRL-TOTAL-RATIO-LINE                               26610099
266200         AFTER ADVANCING 2 LINES                                  26620099
266300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       26630099
266400          FROM TRL-TOTAL-RATIO-LINE                               26640099
266500         AFTER ADVANCING 2 LINES                                  26650099
266510     END-IF.                                                      26651099
266520                                                                  26652099
266600     ADD +2                           TO PV-DETAIL-LINE-COUNT.    26660000
266700                                                                  26670000
266800                                                                  26680000
266900     INITIALIZE TRL-TOTAL-RATIO-LINE.                             26690000
267000     MOVE 'TOTAL TICKETING ERROR RATIO -  '                       26700000
267100                                TO TRL-TOTAL-RATIO-DESC.          26710000
267200                                                                  26720000
267300*    IF A SPOT AUDIT, USE THE UNITS AUDITED TO CALCULATE THE ERROR26730000
267400*    RATIO, OTHERWISE USE THE UNITS TRANSCRIBED                   26740000
267500     IF PV-SPOT-AUDIT-CHECK                                       26750000
267600         IF PA-UNTS-AUD-TIC > ZERO                                26760000
267700             COMPUTE PV-ERROR-RATIO  =                            26770000
267800                (PA-TOT-UNTS-IN-ERR-TIC /                         26780000
267900                 PA-UNTS-AUD-TIC) * 100                           26790000
268000             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      26800000
268100         ELSE                                                     26810000
268200             IF PA-TOT-UNTS-IN-ERR-TIC > ZERO                     26820000
268300                 MOVE 100                 TO TRL-TOTAL-RATIO      26830000
268400             ELSE                                                 26840000
268500                 MOVE ZERO                TO TRL-TOTAL-RATIO      26850000
268600             END-IF                                               26860000
268700         END-IF                                                   26870000
268800     ELSE                                                         26880000
268900         IF PA-UNTS-TRNS-TIC > ZERO                               26890000
269000             COMPUTE PV-ERROR-RATIO  =                            26900000
269100                (PA-TOT-UNTS-IN-ERR-TIC /                         26910000
269200                 PA-UNTS-TRNS-TIC) * 100                          26920000
269300             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      26930000
269400         ELSE                                                     26940000
269500             IF PA-TOT-UNTS-IN-ERR-TIC > ZERO                     26950000
269600                 MOVE 100                 TO TRL-TOTAL-RATIO      26960000
269700             ELSE                                                 26970000
269800                 MOVE ZERO                TO TRL-TOTAL-RATIO      26980000
269900             END-IF                                               26990000
270000         END-IF                                                   27000000
270100     END-IF.                                                      27010000
270200                                                                  27020000
270300                                                                  27030099
270310     IF  CC-FLAT-FILE                                             27031099
270341         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27034199
270350          FROM TRL-TOTAL-RATIO-LINE                               27035099
270360     ELSE                                                         27036099
270400         WRITE AS-AUDIT-SUM-REPORT-LINE                           27040099
270500          FROM TRL-TOTAL-RATIO-LINE                               27050099
270600         AFTER ADVANCING 1 LINES                                  27060099
270700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27070099
270800          FROM TRL-TOTAL-RATIO-LINE                               27080099
270900         AFTER ADVANCING 1 LINES                                  27090099
270910     END-IF.                                                      27091099
270920                                                                  27092099
271000     ADD +1                           TO PV-DETAIL-LINE-COUNT.    27100000
271100                                                                  27110000
271200                                                                  27120000
271300     INITIALIZE TRL-TOTAL-RATIO-LINE.                             27130000
271400     MOVE '          TOTAL ERROR RATIO -  '                       27140000
271500                                TO TRL-TOTAL-RATIO-DESC.          27150000
271600*    IF A SPOT CHECK, CALCULATE THE ERROR RATIO USING THE NUMBER  27160000
271700*    OF UNITS TRANSCRIBED, AND THE TOTAL NUMBER OF UNITS IN       27170000
271800*    ERROR                                                        27180000
271900     IF PV-SPOT-AUDIT-CHECK                                       27190000
272000         IF PV-AUDIT-UNIT-COUNT > ZERO                            27200000
272100             COMPUTE PV-ERROR-RATIO  =                            27210000
272200                ( PA-NET-UNTS-IN-ERROR  /                         27220000
272300                  PV-AUDIT-UNIT-COUNT) * 100                      27230000
272400             MOVE PV-ERROR-RATIO    TO TRL-TOTAL-RATIO            27240000
272500         ELSE                                                     27250000
272600             IF PA-NET-UNTS-IN-ERROR > ZERO                       27260000
272700                 MOVE 100                 TO TRL-TOTAL-RATIO      27270000
272800             ELSE                                                 27280000
272900                 MOVE ZERO                TO TRL-TOTAL-RATIO      27290000
273000             END-IF                                               27300000
273100         END-IF                                                   27310000
273200     ELSE                                                         27320000
273300         IF PV-UNITS-TRNSCRBD > ZERO                              27330000
273400             COMPUTE PV-ERROR-RATIO  =                            27340000
273500                ( PA-NET-UNTS-IN-ERROR  /                         27350000
273600                  PV-UNITS-TRNSCRBD) * 100                        27360000
273700             MOVE PV-ERROR-RATIO    TO TRL-TOTAL-RATIO            27370000
273800         ELSE                                                     27380000
273900             IF PA-NET-UNTS-IN-ERROR > ZERO                       27390000
274000                 MOVE 100                 TO TRL-TOTAL-RATIO      27400000
274100             ELSE                                                 27410000
274200                 MOVE ZERO                TO TRL-TOTAL-RATIO      27420000
274300             END-IF                                               27430000
274400         END-IF                                                   27440000
274500     END-IF.                                                      27450000
274600                                                                  27460099
274610     IF  CC-FLAT-FILE                                             27461099
274631         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           27463199
274632         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27463299
274640         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27464099
274650          FROM TRL-TOTAL-RATIO-LINE                               27465099
274660     ELSE                                                         27466099
274700         WRITE AS-AUDIT-SUM-REPORT-LINE                           27470099
274800          FROM TRL-TOTAL-RATIO-LINE                               27480099
274900         AFTER ADVANCING 2 LINES                                  27490099
275000         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27500099
275100          FROM TRL-TOTAL-RATIO-LINE                               27510099
275200         AFTER ADVANCING 2 LINES                                  27520099
275210     END-IF.                                                      27521099
275220                                                                  27522099
275300     ADD +2                           TO PV-DETAIL-LINE-COUNT.    27530000
275400                                                                  27540000
275500*    BLANK LINE BETWEEN SUMMAY AND THE AUDITED STORE LIST         27550000
275510                                                                  27551099
275520     IF  CC-FLAT-FILE                                             27552099
275530         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           27553099
275540         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27554099
275550          FROM BLANK-LINE                                         27555099
275560     ELSE                                                         27556099
275600         WRITE AS-AUDIT-SUM-REPORT-LINE                           27560099
275700          FROM BLANK-LINE                                         27570099
275800         AFTER ADVANCING 1 LINES                                  27580099
275900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27590099
276000          FROM BLANK-LINE                                         27600099
276100         AFTER ADVANCING 1 LINES                                  27610099
276110     END-IF.                                                      27611099
276120                                                                  27612099
276200     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    27620000
276300                                                                  27630000
276400*    LIST THE STORES THAT WERE CHECKED IN THIS AUDIT              27640000
276500     PERFORM 2420-PRINT-AUD-STR-LIST.                             27650000
276600                                                                  27660000
276700*    BLANK LINE BETWEEN THE AUDITED STORE LIST AND SPOT PERCENT   27670000
276710                                                                  27671099
276720     IF  CC-FLAT-FILE                                             27672099
276730         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           27673099
276740         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      27674099
276750          FROM BLANK-LINE                                         27675099
276760     ELSE                                                         27676099
276800         WRITE AS-AUDIT-SUM-REPORT-LINE                           27680099
276900          FROM BLANK-LINE                                         27690099
277000         AFTER ADVANCING 1 LINES                                  27700099
277100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       27710099
277200          FROM BLANK-LINE                                         27720099
277300         AFTER ADVANCING 1 LINES                                  27730099
277310     END-IF.                                                      27731099
277320                                                                  27732099
277400     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    27740000
277500                                                                  27750000
277600     PERFORM 2410-GET-SPOT-PERCENT.                               27760000
277700                                                                  27770000
277800*    IF MORE AUDITING NEEDS TO BE DONE (THE MIN IS MORE THAN WHAT 27780000
277900*    HAS BEEN AUDITED) TO SATISFY A SPOT-CHECK, WRITE A MESSAGE   27790000
278000*    TELLING THE USER THAT MORE NEEDS TO BE CHECKED.              27800000
278100     IF ((RECEIV-ACTL-CART-CNT * PV-SPOT-PERCENT) >               27810000
278200          PV-AUDIT-CARTON-COUNT)                                  27820000
278300     AND PV-SPOT-AUDIT-CHECK                                      27830000
278310                                                                  27831099
278320         IF  CC-FLAT-FILE                                         27832099
278341             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  27834199
278350              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27835099
278360         ELSE                                                     27836099
278400             WRITE AS-AUDIT-SUM-REPORT-LINE                       27840099
278500              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27850099
278600             AFTER ADVANCING 1 LINES                              27860000
278700             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   27870099
278800              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27880099
278900             AFTER ADVANCING 1 LINES                              27890000
278910         END-IF                                                   27891099
279000                                                                  27900000
279010         IF  CC-FLAT-FILE                                         27901099
279031             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  27903199
279040              FROM ARL2-AUDITING-REQUIRED-LINE-2                  27904099
279050         ELSE                                                     27905099
279100             WRITE AS-AUDIT-SUM-REPORT-LINE                       27910099
279200              FROM ARL2-AUDITING-REQUIRED-LINE-2                  27920099
279300             AFTER ADVANCING 1 LINES                              27930000
279400             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   27940099
279500              FROM ARL2-AUDITING-REQUIRED-LINE-2                  27950099
279600             AFTER ADVANCING 1 LINES                              27960000
279610         END-IF                                                   27961099
279700                                                                  27970000
279710         IF  CC-FLAT-FILE                                         27971099
279731             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  27973199
279740              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27974099
279750         ELSE                                                     27975099
279800             WRITE AS-AUDIT-SUM-REPORT-LINE                       27980099
279900              FROM ARL1-AUDITING-REQUIRED-LINE-1                  27990099
280000             AFTER ADVANCING 1 LINES                              28000000
280100             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   28010099
280200              FROM ARL1-AUDITING-REQUIRED-LINE-1                  28020099
280300             AFTER ADVANCING 1 LINES                              28030000
280310         END-IF                                                   28031099
280400     END-IF.                                                      28040000
280500                                                                  28050000
280600                                                                  28060000
280700******************************************************************28070000
280800* 2410-GET-SPOT-PERCENT                                           28080000
280900*    THIS PARAGRAPH WILL SELECT THE SPOT PERCENT                  28090000
281000******************************************************************28100000
281100 2410-GET-SPOT-PERCENT.                                           28110000
281200                                                                  28120000
281300     EXEC SQL                                                     28130000
281400         SELECT                                                   28140000
281500                 CA_SPTCK_DFLT_PCT / 100                          28150000
281600         INTO                                                     28160000
281700                :PV-SPOT-PERCENT                                  28170000
281800         FROM                                                     28180000
281900                TCOCNTL                                           28190000
282000         WHERE                                                    28200000
282100             OPER_UNT_ID  = :DK-OPER-UNT-ID                       28210000
282200         AND FCLTY_ID     = 1                                     28220000
282300     END-EXEC.                                                    28230000
282400                                                                  28240000
282500     EVALUATE TRUE                                                28250000
282600         WHEN SQLCODE = ZERO                                      28260000
282700              CONTINUE                                            28270000
282800         WHEN OTHER                                               28280000
282900              DISPLAY DK-OPER-UNT-ID                              28290000
283000              MOVE '2410-GET-SPOT-PERCENT'                        28300000
283100                               TO  PV-PARAGRAPH-NAME              28310000
283200              MOVE 'SELECT OF TCOCNTL'                            28320000
283300                               TO  PV-DB2-OPERATION-ATTEMPTED     28330000
283400              MOVE DK-OPER-UNT-ID     TO PV-DISP-OPER-UNT-ID      28340000
283500              MOVE PV-DISP-OPER-UNT-ID                            28350000
283600                                      TO PV-DB2-FIELD-1           28360000
283700              MOVE SPACES             TO PV-DB2-FIELD-2           28370000
283800                                         PV-DB2-FIELD-3           28380000
283900              PERFORM 9999-SQL-ABEND                              28390000
284000     END-EVALUATE.                                                28400000
284100                                                                  28410000
284200                                                                  28420000
284300******************************************************************28430000
284400* 2420-PRINT-AUD-STR-LIST.                                        28440000
284500*    THIS PARAGRAPH WILL PRINT THE LIST OF STORES THAT WERE       28450000
284600*    AUDITED IN THIS AUDIT/PO/RECEIVER                            28460000
284700******************************************************************28470000
284800 2420-PRINT-AUD-STR-LIST.                                         28480000
284900                                                                  28490000
285000     INITIALIZE  AS1-AUDITED-STORES-1.                            28500000
285100                                                                  28510000
285200     DIVIDE PV-STR-COUNT BY PC-MAX-STRS-PER-LINE                  28520000
285300     GIVING PV-STR-LINES                                          28530000
285400     REMAINDER PV-STR-REMAINDER.                                  28540000
285500                                                                  28550000
285600     IF PV-STR-REMAINDER > +0                                     28560000
285700        ADD +1           TO PV-STR-LINES                          28570000
285800     END-IF.                                                      28580000
285900                                                                  28590000
286000*    IF THE LIST OF STORES WON'T FIT, GOTO THE NEXT PAGE          28600000
286100     IF (PV-DETAIL-LINE-COUNT + PV-STR-LINES)                     28610000
286200                              > PC-MAX-REPORT-LINES               28620000
286300         PERFORM 3000-PRINT-PAGE-HEADING                          28630000
286500     END-IF.                                                      28650000
286600                                                                  28660000
286700     SET  PV-AUD-STR-IDX                                          28670000
286800          AS1-AUD-STR-IDX       TO +1.                            28680000
286900     SET  PV-AUD-STR-IDX                                          28690000
287000          AS1-AUD-STR-IDX DOWN BY  +1.                            28700000
287100                                                                  28710000
287200     MOVE 'STORES AUDITED: '    TO AS1-AUDITED-STORE-DESC.        28720000
287300                                                                  28730000
287400     PERFORM UNTIL PV-AUD-STR-IDX >= PV-STR-COUNT                 28740000
287500         IF AS1-AUD-STR-IDX > +0                                  28750000
287600             MOVE ','           TO AS1-COMMA (AS1-AUD-STR-IDX)    28760000
287700         END-IF                                                   28770000
287800                                                                  28780000
287900         SET AS1-AUD-STR-IDX                                      28790000
288000             PV-AUD-STR-IDX     UP BY +1                          28800000
288100                                                                  28810000
288200*        IF THE CURRENT DETAIL PRINT LINE IS FULL, PRINT IT OUT.  28820000
288300         IF AS1-AUD-STR-IDX > PC-MAX-STRS-PER-LINE                28830000
288400             PERFORM 2421-PRINT-AUDITED-STORE-LINE                28840000
288500                                                                  28850000
288600             INITIALIZE AS1-AUDITED-STORES-1                      28860000
288700             SET AS1-AUD-STR-IDX   TO +1                          28870000
288800         END-IF                                                   28880000
288900                                                                  28890000
289000*        MOVE THIS STORE NUMBER TO THE NEXT DETAIL LINE BUCKET    28900000
289100         MOVE PV-STR-NBR (PV-AUD-STR-IDX)                         28910000
289200                                TO AS1-STR-NBR (AS1-AUD-STR-IDX)  28920000
289300     END-PERFORM.                                                 28930000
289400                                                                  28940000
289500     PERFORM 2421-PRINT-AUDITED-STORE-LINE.                       28950000
289600                                                                  28960000
289700                                                                  28970000
289800******************************************************************28980000
289900*  2421-PRINT-AUDITED-STORE-LINE                                  28990000
290000******************************************************************29000000
290100 2421-PRINT-AUDITED-STORE-LINE.                                   29010000
290200                                                                  29020000
290210     IF  CC-FLAT-FILE                                             29021099
290231         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      29023199
290240          FROM AS1-AUDITED-STORES-1                               29024099
290250     ELSE                                                         29025099
290300         WRITE AS-AUDIT-SUM-REPORT-LINE                           29030099
290400          FROM AS1-AUDITED-STORES-1                               29040099
290500         AFTER ADVANCING 1 LINES                                  29050099
290600         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       29060099
290700          FROM AS1-AUDITED-STORES-1                               29070099
290800         AFTER ADVANCING 1 LINES                                  29080099
290810     END-IF.                                                      29081099
290820                                                                  29082099
290900     ADD  +1                  TO PV-DETAIL-LINE-COUNT.            29090000
291000                                                                  29100000
291100                                                                  29110099
291200******************************************************************29120000
291300* 2500-CREATE-RFID-DETAIL                                         29130000
291400*  -DETERMINE IF THERE ARE ANY ERRORS TO REPORT FOR THIS STORE    29140000
291500*      -IF SO, PRINT THE DETAIL REPORT, ADDING THE QUANTITES TO   29150000
291600*       THE ERROR ACCUMULATOR FIELDS.                             29160000
291700*      -OTHERWISE ADD TO THE "STORE WITH NO ERROR" BUCKETS        29170000
291800******************************************************************29180000
291900 2500-CREATE-RFID-DETAIL.                                         29190000
292000                                                                  29200000
292100     IF PS-PRINT-RFID-HEADING                                     29210000
292200         PERFORM 2520-PRINT-RFID-HEADINGS                         29220000
292300     END-IF.                                                      29230000
292400                                                                  29240000
292500     INITIALIZE RDL-RFID-DETAIL-LINE.                             29250000
292600                                                                  29260000
292700     SET   PS-DONT-PRINT-DETAIL       TO TRUE.                    29270000
292800                                                                  29280000
292900     MOVE SU005-DEST-OPER-UNT-ID      TO RDL-STORE-NBR.           29290000
293000                                                                  29300000
293100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29310000
293200*  *  NO EPC LOGO *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29320000
293300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29330000
293400     IF  SU005-WRG-TKT-NO-EPC-LOGO    > ZERO                      29340000
293500         MOVE  SU005-WRG-TKT-NO-EPC-LOGO  TO RDL-NO-EPC-LOGO      29350000
293600         SET   PS-PRINT-DETAIL        TO TRUE                     29360000
293700                                                                  29370000
293800         MOVE 'PA-NO-EPC-LOGO'     TO PV-FIELD-NAME               29380000
293900         COMPUTE PA-NO-EPC-LOGO =                                 29390000
294000                 PA-NO-EPC-LOGO + SU005-WRG-TKT-NO-EPC-LOGO       29400000
294100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29410000
294200         END-COMPUTE                                              29420000
294300     END-IF.                                                      29430000
294400                                                                  29440000
294500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29450000
294600*  *  WRONG COLOR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29460000
294700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29470000
294800     IF  SU005-WRG-RFID-TKT-CLR          > ZERO                   29480000
294900         MOVE  SU005-WRG-RFID-TKT-CLR   TO RDL-WRONG-COLOR        29490000
295000         SET   PS-PRINT-DETAIL        TO TRUE                     29500000
295100                                                                  29510000
295200         MOVE 'PA-WRONG-COLOR'        TO PV-FIELD-NAME            29520000
295300         COMPUTE PA-WRONG-COLOR =                                 29530000
295400                 PA-WRONG-COLOR + SU005-WRG-RFID-TKT-CLR          29540000
295500             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29550000
295600         END-COMPUTE                                              29560000
295700     END-IF.                                                      29570000
295800                                                                  29580000
295900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29590000
296000*  *  WRONG SIZE  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29600000
296100*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29610000
296200     IF  SU005-WRG-RFID-TKT-SIZE           > ZERO                 29620000
296300         MOVE  SU005-WRG-RFID-TKT-SIZE         TO RDL-WRONG-SIZE  29630000
296400         SET   PS-PRINT-DETAIL        TO TRUE                     29640000
296500                                                                  29650000
296600         MOVE 'PA-WRONG-SIZE' TO PV-FIELD-NAME                    29660000
296700         COMPUTE PA-WRONG-SIZE =                                  29670000
296800                 PA-WRONG-SIZE +                                  29680000
296900                 SU005-WRG-RFID-TKT-SIZE                          29690000
297000             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29700000
297100         END-COMPUTE                                              29710000
297200     END-IF.                                                      29720000
297300                                                                  29730000
297400*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29740000
297500*  *  WRONG STYLE *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29750000
297600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29760000
297700     IF  SU005-WRG-RFID-TKT-STYLE          > ZERO                 29770000
297800         MOVE  SU005-WRG-RFID-TKT-STYLE TO RDL-WRONG-STYLE        29780000
297900         SET   PS-PRINT-DETAIL        TO TRUE                     29790000
298000                                                                  29800000
298100         MOVE 'PA-WRONG-STYLE' TO PV-FIELD-NAME                   29810000
298200         COMPUTE PA-WRONG-STYLE =  PA-WRONG-STYLE +               29820000
298300                                   SU005-WRG-RFID-TKT-STYLE       29830000
298400             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29840000
298500         END-COMPUTE                                              29850000
298600     END-IF.                                                      29860000
298700                                                                  29870000
298800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29880000
298900*  *  NO RFID TICKET *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29890000
299000*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  29900000
299100     IF  SU005-NO-RFID-TICKET          > ZERO                     29910000
299200         MOVE  SU005-NO-RFID-TICKET  TO RDL-NO-RFID-TICKET        29920000
299300         SET   PS-PRINT-DETAIL        TO TRUE                     29930000
299400                                                                  29940000
299500         MOVE 'PA-NO-RFID-TICKET' TO PV-FIELD-NAME                29950000
299600         COMPUTE PA-NO-RFID-TICKET =                              29960000
299700                 PA-NO-RFID-TICKET + SU005-NO-RFID-TICKET         29970000
299800             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      29980000
299900         END-COMPUTE                                              29990000
300000     END-IF.                                                      30000000
300100                                                                  30010000
300200                                                                  30020000
300300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30030000
300400*  *  TOTAL ERRORS   *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30040000
300500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30050000
300600     IF  SU005-TOT-RFID-ERR             > ZERO                    30060000
300700         MOVE  SU005-TOT-RFID-ERR      TO RDL-TOTAL-ERRORS        30070000
300800         SET   PS-PRINT-DETAIL        TO TRUE                     30080000
300900                                                                  30090000
301000         MOVE 'PA-TOT-ERRS-TIC'       TO PV-FIELD-NAME            30100000
301100         COMPUTE PA-TOT-ERRS-RFID =                               30110000
301200                 PA-TOT-ERRS-RFID + SU005-TOT-RFID-ERR            30120000
301300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30130000
301400         END-COMPUTE                                              30140000
301500     END-IF.                                                      30150000
301600                                                                  30160000
301700*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30170000
301800*  *  UNITS IN ERROR *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30180000
301900*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30190000
302000     IF  SU005-TOT-UNITS-IN-RFID-ERR    > ZERO                    30200000
302100         MOVE  SU005-TOT-UNITS-IN-RFID-ERR                        30210000
302200                                      TO RDL-TOTAL-UNITS-IN-ERROR 30220000
302300         SET   PS-PRINT-DETAIL        TO TRUE                     30230000
302400                                                                  30240000
302500         MOVE 'PA-TOT-UNTS-IN-ERR-RFID' TO PV-FIELD-NAME          30250000
302600         COMPUTE PA-TOT-UNTS-IN-ERR-RFID =                        30260000
302700                 PA-TOT-UNTS-IN-ERR-RFID +                        30270000
302800                 SU005-TOT-UNITS-IN-RFID-ERR                      30280000
302900             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30290000
303000         END-COMPUTE                                              30300000
303100     END-IF.                                                      30310000
303200                                                                  30320000
303300*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30330000
303400*  *  UNITS TRANSCRIBED *  *  *  *  *  *  *  *  *  *  *  *  *  *  30340000
303500*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30350000
303600     IF  SU005-UNITS-TRNSCRBD          > ZERO                     30360000
303700         MOVE  SU005-UNITS-TRNSCRBD   TO RDL-TOTAL-UNITS-TRNSCRBD 30370000
303800                                                                  30380000
303900*        IF THERE ARE ERRORS, ADD THE UNITS TRANSCRIBED TO THE    30390000
304000*        TOTAL FOR THOSE STORES WITH ERRORS.                      30400000
304100         IF PS-PRINT-DETAIL                                       30410000
304200             MOVE 'PA-TOT-UNTS-TRNS-IE-RFID' TO PV-FIELD-NAME     30420000
304300             COMPUTE PA-TOT-UNTS-TRNS-IE-RFID =                   30430000
304400                     PA-TOT-UNTS-TRNS-IE-RFID +                   30440000
304500                     SU005-UNITS-TRNSCRBD                         30450000
304600                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  30460000
304700             END-COMPUTE                                          30470000
304800         ELSE                                                     30480000
304900*        OTHERWISE ADD TO THOSE STORES WITH NO ERRORS             30490000
305000             MOVE 'PA-TOT-UNTS-TRNS-NE-RFID' TO PV-FIELD-NAME     30500000
305100             COMPUTE PA-TOT-UNTS-TRNS-NE-RFID =                   30510000
305200                     PA-TOT-UNTS-TRNS-NE-RFID +                   30520000
305300                     SU005-UNITS-TRNSCRBD                         30530000
305400                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  30540000
305500             END-COMPUTE                                          30550000
305600         END-IF                                                   30560000
305700*        EITHER WAY ADD TO THE OVERALL TOTAL                      30570000
305800         MOVE 'PA-UNTS-TRNS-RFID'             TO PV-FIELD-NAME    30580000
305900         COMPUTE PA-UNTS-TRNS-RFID =                              30590000
306000                 PA-UNTS-TRNS-RFID +                              30600000
306100                 SU005-UNITS-TRNSCRBD                             30610000
306200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30620000
306300         END-COMPUTE                                              30630000
306400     END-IF.                                                      30640000
306500                                                                  30650000
306600*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30660000
306700*  *  UNITS AUDITED  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30670000
306800*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  30680000
306900     IF  SU005-UNITS-AUDITED           > ZERO                     30690000
307100         MOVE 'PA-TOT-UNTS-AUDITED-RFID' TO PV-FIELD-NAME         30710000
307200         COMPUTE PA-TOT-UNTS-AUDITED-RFID =                       30720000
307300                 PA-TOT-UNTS-AUDITED-RFID +                       30730000
307400                 SU005-UNITS-AUDITED                              30740000
307500                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  30750000
307600         END-COMPUTE                                              30760000
307700         MOVE PA-TOT-UNTS-AUDITED-RFID                            30770000
307800                                       TO RDL-TOTAL-UNITS-AUDITED 30780000
308100                                                                  30810000
308200*        IF THERE ARE ERRORS, ADD THE UNITS AUDITED TO THE BUCKET 30820000
308300*        TOTAL FOR THOSE STORES WITH ERRORS.                      30830000
308400         IF PS-PRINT-DETAIL                                       30840000
308500             MOVE 'PA-TOT-UNTS-AUD-IE-RFID' TO PV-FIELD-NAME      30850000
308600             COMPUTE PA-TOT-UNTS-AUD-IE-RFID =                    30860000
308700                     PA-TOT-UNTS-AUD-IE-RFID +                    30870000
308800                     SU005-UNITS-AUDITED                          30880000
309200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      30920000
309300             END-COMPUTE                                          30930000
309400         ELSE                                                     30940000
309500*        OTHERWISE ADD TO THOSE STORES WITH NO ERRORS             30950000
309600             MOVE 'PA-TOT-UNTS-AUD-NE-RFID' TO PV-FIELD-NAME      30960000
309700             COMPUTE PA-TOT-UNTS-AUD-NE-RFID =                    30970000
309800                     PA-TOT-UNTS-AUD-NE-RFID +                    30980000
309900                     SU005-UNITS-AUDITED                          30990000
310000                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  31000000
310100             END-COMPUTE                                          31010000
310200         END-IF                                                   31020000
310300*        EITHER WAY ADD TO THE OVERALL TOTAL                      31030000
310400         MOVE 'PA-UNTS-AUD-RFID'             TO PV-FIELD-NAME     31040000
310500         COMPUTE PA-UNTS-AUD-RFID      =                          31050000
310600                 PA-UNTS-AUD-RFID      +                          31060000
310700                 SU005-UNITS-AUDITED                              31070000
311100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      31110000
311200         END-COMPUTE                                              31120000
311300     END-IF.                                                      31130000
311400                                                                  31140000
311500*    IF ANY ERRORS FOUND, PRINT THE DETAIL...IF NOT, ADD TO THE   31150000
311600*    TOTALS OF THE STORES WITH NO ERRORS                          31160000
311700     IF PS-PRINT-DETAIL                                           31170000
311800*        IF A SPOT CHECK, USE THE UNITS AUDITED TO CALCULATE THE  31180000
311900*        ERROR RATIO, OTHERWISE USE THE UNITS TRANSCRIBED         31190000
312000         IF PV-SPOT-AUDIT-CHECK                                   31200000
312100             IF SU005-UNITS-AUDITED > ZERO                        31210000
312200                 COMPUTE PV-ERROR-RATIO  =                        31220000
312300                     (SU005-TOT-UNITS-IN-RFID-ERR /               31230000
312700                      SU005-UNITS-AUDITED) * 100                  31270000
312800                 MOVE PV-ERROR-RATIO    TO RDL-ERROR-RATIO        31280000
312900             ELSE                                                 31290000
313000                 IF SU005-TOT-UNITS-IN-RFID-ERR > ZERO            31300000
313100                     MOVE 100           TO RDL-ERROR-RATIO        31310000
313200                 ELSE                                             31320000
313300                     MOVE ZERO          TO RDL-ERROR-RATIO        31330000
313400                 END-IF                                           31340000
313500             END-IF                                               31350000
313600         ELSE                                                     31360000
313700             IF SU005-UNITS-TRNSCRBD > ZERO                       31370000
313800                 COMPUTE PV-ERROR-RATIO  =                        31380000
313900                     (SU005-TOT-UNITS-IN-RFID-ERR /               31390000
314000                      SU005-UNITS-TRNSCRBD)  * 100                31400000
314100                 MOVE PV-ERROR-RATIO    TO RDL-ERROR-RATIO        31410000
314200             ELSE                                                 31420000
314300                 IF SU005-TOT-UNITS-IN-RFID-ERR > ZERO            31430000
314400                     MOVE 100           TO RDL-ERROR-RATIO        31440000
314500                 ELSE                                             31450000
314600                     MOVE ZERO          TO RDL-ERROR-RATIO        31460000
314700                 END-IF                                           31470000
314800             END-IF                                               31480000
314900         END-IF                                                   31490000
315000                                                                  31500000
315100         MOVE '%'                   TO RDL-PERCENT                31510000
315200                                                                  31520000
315300         IF (PV-DETAIL-LINE-COUNT + 1) > PC-MAX-REPORT-LINES      31530000
315400             PERFORM 3000-PRINT-PAGE-HEADING                      31540000
315600             PERFORM 2520-PRINT-RFID-HEADINGS                     31560000
315700         END-IF                                                   31570000
315800                                                                  31580000
315810         IF  CC-FLAT-FILE                                         31581099
315831             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  31583199
315840              FROM RDL-RFID-DETAIL-LINE                           31584099
315850         ELSE                                                     31585099
315900             WRITE AS-AUDIT-SUM-REPORT-LINE                       31590099
316000              FROM RDL-RFID-DETAIL-LINE                           31600099
316100             AFTER ADVANCING 1 LINES                              31610000
316200             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   31620099
316300              FROM RDL-RFID-DETAIL-LINE                           31630099
316400             AFTER ADVANCING 1 LINES                              31640000
316410         END-IF                                                   31641099
316420                                                                  31642099
316500         ADD +1                     TO PV-DETAIL-LINE-COUNT       31650000
316600                                       PA-STRS-W-ERRS-RFID        31660000
316700                                       PA-STR-COUNT-RFID          31670000
316800     ELSE                                                         31680000
316900         ADD +1                     TO PA-STRS-W-NO-ERRS-RFID     31690000
317000                                       PA-STR-COUNT-RFID          31700000
317100     END-IF.                                                      31710000
317200                                                                  31720000
317300     PERFORM 8001-READ-EXTRACT-FILE.                              31730000
317400                                                                  31740000
317500                                                                  31750000
317600******************************************************************31760000
317700* 2510-CREATE-RFID-SUMMARY.                                       31770000
317800*  -PRINT THE ERROR AND NO-ERROR SUB TOTALS AND A RFID TOTAL LINE 31780000
317900******************************************************************31790000
318000 2510-CREATE-RFID-SUMMARY.                                        31800000
318100                                                                  31810000
318200*    IF THE SUMMARY WON'T FIT ON THE PAGE, GO TO THE NEXT ONE     31820000
318300     IF (PV-DETAIL-LINE-COUNT + 4) > PC-MAX-REPORT-LINES          31830000
318400         PERFORM 3000-PRINT-PAGE-HEADING                          31840000
318600     END-IF                                                       31860000
318700                                                                  31870000
318800*    WRITE SUMMARY LINE FOR THE STORES WITH ERRORS                31880000
318900     INITIALIZE RTL-RFID-TOTAL-LINE.                              31890000
319000     MOVE '  STRS W/ERRS'             TO RTL-TOTAL-DESCRIPTION.   31900000
319100     MOVE PA-STRS-W-ERRS-RFID         TO RTL-STORE-NBR.           31910000
319200     MOVE PA-NO-EPC-LOGO              TO RTL-NO-EPC-LOGO.         31920000
319300     MOVE PA-WRONG-COLOR              TO RTL-WRONG-COLOR.         31930000
319400     MOVE PA-WRONG-SIZE               TO RTL-WRONG-SIZE.          31940000
319500     MOVE PA-WRONG-STYLE              TO RTL-WRONG-STYLE.         31950000
319600     MOVE PA-NO-RFID-TICKET           TO RTL-NO-RFID-TICKET.      31960000
319900     MOVE PA-TOT-ERRS-RFID            TO RTL-TOTAL-ERRORS.        31990000
320000     MOVE PA-TOT-UNTS-IN-ERR-RFID     TO RTL-TOTAL-UNITS-IN-ERROR.32000000
320100     MOVE PA-TOT-UNTS-TRNS-IE-RFID    TO RTL-TOTAL-UNITS-TRNSCRBD.32010000
320200     MOVE PA-TOT-UNTS-AUD-IE-RFID     TO RTL-TOTAL-UNITS-AUDITED. 32020000
320300     MOVE SPACES                      TO RTL-PERCENT              32030000
320400                                         RTL-ERROR-RATIO-X.       32040000
323600                                                                  32360000
323610     IF  CC-FLAT-FILE                                             32361099
323631         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           32363199
323632         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      32363299
323640         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      32364099
323650          FROM RTL-RFID-TOTAL-LINE                                32365099
323660     ELSE                                                         32366099
323700         WRITE AS-AUDIT-SUM-REPORT-LINE                           32370099
323800          FROM RTL-RFID-TOTAL-LINE                                32380099
323900         AFTER ADVANCING 2 LINES                                  32390099
324000         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       32400099
324100          FROM RTL-RFID-TOTAL-LINE                                32410099
324200         AFTER ADVANCING 2 LINES                                  32420099
324210     END-IF.                                                      32421099
324220                                                                  32422099
324300     ADD +2                           TO PV-DETAIL-LINE-COUNT.    32430000
324400                                                                  32440000
324500*    WRITE SUMMARY LINE FOR THE STORES WITH NO ERRORS             32450000
324600     INITIALIZE RTL-RFID-TOTAL-LINE.                              32460000
324700     MOVE ' STRS WO/ERRS'             TO RTL-TOTAL-DESCRIPTION.   32470000
324800     MOVE PA-STRS-W-NO-ERRS-RFID      TO RTL-STORE-NBR.           32480000
324900     MOVE PA-TOT-UNTS-TRNS-NE-RFID    TO RTL-TOTAL-UNITS-TRNSCRBD.32490000
325000     MOVE PA-TOT-UNTS-AUD-NE-RFID     TO RTL-TOTAL-UNITS-AUDITED. 32500000
325100     MOVE SPACES                      TO RTL-PERCENT              32510000
325200                                         RTL-ERROR-RATIO-X.       32520000
325210                                                                  32521099
325220     IF  CC-FLAT-FILE                                             32522099
325251         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      32525199
325260          FROM RTL-RFID-TOTAL-LINE                                32526099
325270     ELSE                                                         32527099
325300         WRITE AS-AUDIT-SUM-REPORT-LINE                           32530099
325400          FROM RTL-RFID-TOTAL-LINE                                32540099
325500         AFTER ADVANCING 1 LINES                                  32550099
325600         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       32560099
325700          FROM RTL-RFID-TOTAL-LINE                                32570099
325800         AFTER ADVANCING 1 LINES                                  32580099
325810     END-IF                                                       32581099
325820                                                                  32582099
325900     ADD +1                           TO PV-DETAIL-LINE-COUNT.    32590000
326000                                                                  32600000
326100*    WRITE SUMMARY LINE FOR THE RFID TOTALS                       32610000
326200     INITIALIZE RTL-RFID-TOTAL-LINE.                              32620000
326300     MOVE '   RFID TOTAL'             TO RTL-TOTAL-DESCRIPTION.   32630000
326400     MOVE PA-STR-COUNT-RFID           TO RTL-STORE-NBR.           32640000
326500     MOVE PA-NO-EPC-LOGO              TO RTL-NO-EPC-LOGO.         32650000
326600     MOVE PA-WRONG-COLOR              TO RTL-WRONG-COLOR.         32660000
326700     MOVE PA-WRONG-SIZE               TO RTL-WRONG-SIZE.          32670000
326800     MOVE PA-WRONG-STYLE              TO RTL-WRONG-STYLE.         32680000
326900     MOVE PA-NO-RFID-TICKET           TO RTL-NO-RFID-TICKET.      32690000
327200     MOVE PA-TOT-ERRS-RFID            TO RTL-TOTAL-ERRORS.        32720000
327300     MOVE PA-TOT-UNTS-IN-ERR-RFID     TO RTL-TOTAL-UNITS-IN-ERROR.32730000
327400     MOVE PA-UNTS-TRNS-RFID           TO RTL-TOTAL-UNITS-TRNSCRBD.32740000
327500     MOVE PA-UNTS-AUD-RFID            TO RTL-TOTAL-UNITS-AUDITED. 32750000
327600     MOVE '%'                         TO RTL-PERCENT.             32760000
327700                                                                  32770000
327800*    IF A SPOT AUDIT, USE THE UNITS AUDITED TO CALCULATE THE ERROR32780000
327900*    RATIO, OTHERWISE USE THE UNITS TRANSCRIBED                   32790000
328000     IF PV-SPOT-AUDIT-CHECK                                       32800000
328100         IF PA-UNTS-AUD-RFID > ZERO                               32810000
328200             COMPUTE PV-ERROR-RATIO  =                            32820000
328300                (PA-TOT-UNTS-IN-ERR-RFID /                        32830000
328400                 PA-UNTS-AUD-RFID) * 100                          32840000
328500             MOVE PV-ERROR-RATIO          TO RTL-ERROR-RATIO      32850000
328600         ELSE                                                     32860000
328700             IF PA-TOT-UNTS-IN-ERR-RFID > ZERO                    32870000
328800                 MOVE 100                 TO RTL-ERROR-RATIO      32880000
328900             ELSE                                                 32890000
329000                 MOVE ZERO                TO RTL-ERROR-RATIO      32900000
329100             END-IF                                               32910000
329200         END-IF                                                   32920000
329300     ELSE                                                         32930000
329400         IF PA-UNTS-TRNS-RFID > ZERO                              32940000
329500             COMPUTE PV-ERROR-RATIO  =                            32950000
329600                (PA-TOT-UNTS-IN-ERR-RFID /                        32960000
329700                 PA-UNTS-TRNS-RFID) * 100                         32970000
329800             MOVE PV-ERROR-RATIO          TO RTL-ERROR-RATIO      32980000
329900         ELSE                                                     32990000
330000             IF PA-TOT-UNTS-IN-ERR-RFID > ZERO                    33000000
330100                 MOVE 100                 TO RTL-ERROR-RATIO      33010000
330200             ELSE                                                 33020000
330300                 MOVE ZERO                TO RTL-ERROR-RATIO      33030000
330400             END-IF                                               33040000
330500         END-IF                                                   33050000
330600     END-IF.                                                      33060000
330700                                                                  33070000
330710     IF  CC-FLAT-FILE                                             33071099
330731         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33073199
330740          FROM RTL-RFID-TOTAL-LINE                                33074099
330750     ELSE                                                         33075099
330800         WRITE AS-AUDIT-SUM-REPORT-LINE                           33080099
330900          FROM RTL-RFID-TOTAL-LINE                                33090099
331000         AFTER ADVANCING 1 LINES                                  33100099
331100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33110099
331200          FROM RTL-RFID-TOTAL-LINE                                33120099
331300         AFTER ADVANCING 1 LINES                                  33130099
331310     END-IF.                                                      33131099
331320                                                                  33132099
331400     ADD +1                           TO PV-DETAIL-LINE-COUNT.    33140000
331500                                                                  33150000
331600                                                                  33160000
331700******************************************************************33170000
331800* 2520-PRINT-RFID-HEADINGS                                        33180000
331900*  -PRINT THE DETAIL HEADINGS FOR THE RFID ERRORS                 33190000
332000******************************************************************33200000
332100 2520-PRINT-RFID-HEADINGS.                                        33210000
332200                                                                  33220000
332300*    IF THE HEADINGS + 1 DETAIL LINE WON'T FIT, GOTO THE NEXT PGE 33230000
332400     IF (PV-DETAIL-LINE-COUNT + 8) > PC-MAX-REPORT-LINES          33240000
332500         PERFORM 3000-PRINT-PAGE-HEADING                          33250000
332700     END-IF                                                       33270000
332710                                                                  33271099
332800     SET PS-DONT-PRINT-RFID-HEADING TO TRUE                       33280000
332900                                                                  33290000
332910     IF  CC-FLAT-FILE                                             33291099
332931         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           33293199
332932         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33293299
332940         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33294099
332950          FROM RDH1-RFID-DETAIL-HEADING-1                         33295099
332960     ELSE                                                         33296099
333000         WRITE AS-AUDIT-SUM-REPORT-LINE                           33300099
333100          FROM RDH1-RFID-DETAIL-HEADING-1                         33310099
333200         AFTER ADVANCING 2 LINES                                  33320099
333300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33330099
333400          FROM RDH1-RFID-DETAIL-HEADING-1                         33340099
333500         AFTER ADVANCING 2 LINES                                  33350099
333510     END-IF.                                                      33351099
333600                                                                  33360000
333920     IF  CC-FLAT-FILE                                             33392099
333930         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           33393099
333940         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33394099
333941         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           33394199
333942         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33394299
333950         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33395099
333960          FROM RDH1-RFID-DETAIL-HEADING-1A                        33396099
333970     ELSE                                                         33397099
333990         WRITE AS-AUDIT-SUM-REPORT-LINE                           33399099
333991          FROM RDH1-RFID-DETAIL-HEADING-1A                        33399199
333992         AFTER ADVANCING 2 LINES                                  33399299
334000         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33400099
334100          FROM RDH1-RFID-DETAIL-HEADING-1A                        33410099
334200         AFTER ADVANCING 2 LINES                                  33420099
334210     END-IF.                                                      33421099
334300                                                                  33430000
334310     IF  CC-FLAT-FILE                                             33431099
334341         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           33434199
334342         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33434299
334343         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33434399
334350          FROM RDH2-RFID-DETAIL-HEADING-2                         33435099
334360     ELSE                                                         33436099
334400         WRITE AS-AUDIT-SUM-REPORT-LINE                           33440099
334500          FROM RDH2-RFID-DETAIL-HEADING-2                         33450099
334600         AFTER ADVANCING 1 LINES                                  33460099
334700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33470099
334800          FROM RDH2-RFID-DETAIL-HEADING-2                         33480099
334900         AFTER ADVANCING 1 LINES                                  33490099
334910     END-IF.                                                      33491099
334920                                                                  33492099
334930     IF  CC-FLAT-FILE                                             33493099
334951         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      33495199
334960          FROM RDH3-RFID-DETAIL-HEADING-3                         33496099
334970     ELSE                                                         33497099
335100         WRITE AS-AUDIT-SUM-REPORT-LINE                           33510099
335200          FROM RDH3-RFID-DETAIL-HEADING-3                         33520099
335300         AFTER ADVANCING 1 LINES                                  33530099
335400         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       33540099
335500          FROM RDH3-RFID-DETAIL-HEADING-3                         33550099
335600         AFTER ADVANCING 1 LINES                                  33560099
335610     END-IF.                                                      33561099
335700                                                                  33570000
335800     ADD +6                           TO PV-DETAIL-LINE-COUNT.    33580000
335900                                                                  33590000
336000                                                                  33600000
336100                                                                  33610000
336200******************************************************************33620000
336300* 2600-PRINT-FOOTER.                                              33630000
336400******************************************************************33640000
336500 2600-PRINT-FOOTER.                                               33650000
336600                                                                  33660000
336700*    IF THE FOOTER LINE WON'T FIT, GOTO THE NEXT PGE              33670000
336800     IF (PV-DETAIL-LINE-COUNT + 5) > PC-MAX-REPORT-LINES          33680000
336900         PERFORM 3000-PRINT-PAGE-HEADING                          33690000
337100     END-IF.                                                      33710000
337200                                                                  33720000
337300     INITIALIZE TRL-TOTAL-RATIO-LINE.                             33730000
337400     MOVE 'TOTAL RFID ERROR RATIO -  '                            33740000
337500                                TO TRL-TOTAL-RATIO-DESC.          33750000
337600                                                                  33760000
337700*    IF A SPOT AUDIT, USE THE UNITS AUDITED TO CALCULATE THE ERROR33770000
337800*    RATIO, OTHERWISE USE THE UNITS TRANSCRIBED                   33780000
337900     IF PV-SPOT-AUDIT-CHECK                                       33790000
338000         IF PA-UNTS-AUD-RFID > ZERO                               33800000
338100             COMPUTE PV-ERROR-RATIO  =                            33810000
338200                (PA-TOT-UNTS-IN-ERR-RFID /                        33820000
338300                 PA-UNTS-AUD-RFID) * 100                          33830000
338400             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      33840000
338500         ELSE                                                     33850000
338600             IF PA-TOT-UNTS-IN-ERR-RFID > ZERO                    33860000
338700                 MOVE 100                 TO TRL-TOTAL-RATIO      33870000
338800             ELSE                                                 33880000
338900                 MOVE ZERO                TO TRL-TOTAL-RATIO      33890000
339000             END-IF                                               33900000
339100         END-IF                                                   33910000
339200     ELSE                                                         33920000
339300         IF PA-UNTS-TRNS-RFID > ZERO                              33930000
339400             COMPUTE PV-ERROR-RATIO  =                            33940000
339500                (PA-TOT-UNTS-IN-ERR-RFID /                        33950000
339600                 PA-UNTS-TRNS-RFID) * 100                         33960000
339700             MOVE PV-ERROR-RATIO          TO TRL-TOTAL-RATIO      33970000
339800         ELSE                                                     33980000
339900             IF PA-TOT-UNTS-IN-ERR-RFID > ZERO                    33990000
340000                 MOVE 100                 TO TRL-TOTAL-RATIO      34000000
340100             ELSE                                                 34010000
340200                 MOVE ZERO                TO TRL-TOTAL-RATIO      34020000
340300             END-IF                                               34030000
340400         END-IF                                                   34040000
340500     END-IF.                                                      34050000
340600                                                                  34060000
340700                                                                  34070099
340710     IF  CC-FLAT-FILE                                             34071099
340731         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      34073199
340740          FROM TRL-TOTAL-RATIO-LINE                               34074099
340750     ELSE                                                         34075099
340800         WRITE AS-AUDIT-SUM-REPORT-LINE                           34080099
340900          FROM TRL-TOTAL-RATIO-LINE                               34090099
341000         AFTER ADVANCING 1 LINES                                  34100099
341100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       34110099
341200          FROM TRL-TOTAL-RATIO-LINE                               34120099
341300         AFTER ADVANCING 1 LINES                                  34130099
341310     END-IF.                                                      34131099
341320                                                                  34132099
341400     ADD +1                           TO PV-DETAIL-LINE-COUNT.    34140000
341500                                                                  34150000
341600                                                                  34160000
345800                                                                  34580000
345900*    BLANK LINE BETWEEN SUMMAY AND THE AUDITED STORE LIST         34590000
345910                                                                  34591099
345920     IF  CC-FLAT-FILE                                             34592099
345930         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           34593099
345940         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      34594099
345950          FROM BLANK-LINE                                         34595099
345960     ELSE                                                         34596099
346000         WRITE AS-AUDIT-SUM-REPORT-LINE                           34600099
346100          FROM BLANK-LINE                                         34610099
346200         AFTER ADVANCING 1 LINES                                  34620099
346300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       34630099
346400          FROM BLANK-LINE                                         34640099
346500         AFTER ADVANCING 1 LINES                                  34650099
346510     END-IF.                                                      34651099
346520                                                                  34652099
346600     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    34660000
346700                                                                  34670000
346800*    LIST THE STORES THAT WERE CHECKED IN THIS AUDIT              34680000
346900     PERFORM 2420-PRINT-AUD-STR-LIST.                             34690000
347000                                                                  34700000
347100*    BLANK LINE BETWEEN THE AUDITED STORE LIST AND SPOT PERCENT   34710000
347110                                                                  34711099
347120     IF  CC-FLAT-FILE                                             34712099
347130         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           34713099
347140         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      34714099
347150          FROM BLANK-LINE                                         34715099
347160     ELSE                                                         34716099
347200         WRITE AS-AUDIT-SUM-REPORT-LINE                           34720099
347300          FROM BLANK-LINE                                         34730099
347400         AFTER ADVANCING 1 LINES                                  34740099
347500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       34750099
347600          FROM BLANK-LINE                                         34760099
347700         AFTER ADVANCING 1 LINES                                  34770099
347710     END-IF.                                                      34771099
347720                                                                  34772099
347800     ADD  +1                          TO PV-DETAIL-LINE-COUNT.    34780000
347900                                                                  34790000
348000     PERFORM 2410-GET-SPOT-PERCENT.                               34800000
348100                                                                  34810000
348200*    IF MORE AUDITING NEEDS TO BE DONE (THE MIN IS MORE THAN WHAT 34820000
348300*    HAS BEEN AUDITED) TO SATISFY A SPOT-CHECK, WRITE A MESSAGE   34830000
348400*    TELLING THE USER THAT MORE NEEDS TO BE CHECKED.              34840000
348500     IF ((RECEIV-ACTL-CART-CNT * PV-SPOT-PERCENT) >               34850000
348600          PV-AUDIT-CARTON-COUNT)                                  34860000
348700     AND PV-SPOT-AUDIT-CHECK                                      34870000
348710                                                                  34871099
348720         IF  CC-FLAT-FILE                                         34872099
348741             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  34874199
348750              FROM ARL1-AUDITING-REQUIRED-LINE-1                  34875099
348760         ELSE                                                     34876099
348800             WRITE AS-AUDIT-SUM-REPORT-LINE                       34880099
348900              FROM ARL1-AUDITING-REQUIRED-LINE-1                  34890099
349000             AFTER ADVANCING 1 LINES                              34900000
349100             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   34910099
349200              FROM ARL1-AUDITING-REQUIRED-LINE-1                  34920099
349300             AFTER ADVANCING 1 LINES                              34930000
349310         END-IF                                                   34931099
349320                                                                  34932099
349330         IF  CC-FLAT-FILE                                         34933099
349351             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  34935199
349360              FROM ARL2-AUDITING-REQUIRED-LINE-2                  34936099
349370         ELSE                                                     34937099
349500             WRITE AS-AUDIT-SUM-REPORT-LINE                       34950099
349600              FROM ARL2-AUDITING-REQUIRED-LINE-2                  34960099
349700             AFTER ADVANCING 1 LINES                              34970000
349800             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   34980099
349900              FROM ARL2-AUDITING-REQUIRED-LINE-2                  34990099
350000             AFTER ADVANCING 1 LINES                              35000000
350010         END-IF                                                   35001099
350100                                                                  35010000
350110         IF  CC-FLAT-FILE                                         35011099
350131             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  35013199
350140              FROM ARL1-AUDITING-REQUIRED-LINE-1                  35014099
350150         ELSE                                                     35015099
350200             WRITE AS-AUDIT-SUM-REPORT-LINE                       35020099
350300              FROM ARL1-AUDITING-REQUIRED-LINE-1                  35030099
350400             AFTER ADVANCING 1 LINES                              35040000
350500             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   35050099
350600              FROM ARL1-AUDITING-REQUIRED-LINE-1                  35060099
350700             AFTER ADVANCING 1 LINES                              35070000
350710         END-IF                                                   35071099
350800     END-IF.                                                      35080000
350900                                                                  35090099
351000                                                                  35100000
351100******************************************************************35110000
351200*  3000-PRINT-PAGE-HEADING --  CREATES THE PAGE HEADING           35120000
351300*  FOR THE REPORT AT A BREAK IN RECEIVER                          35130000
351400*     - PRINT THE PAGE HEADING                                    35140000
351500*     - SETUP/PRINT THE RECEIVER HEADING                          35150000
351600******************************************************************35160000
351700 3000-PRINT-PAGE-HEADING.                                         35170000
351800                                                                  35180000
351900     ADD 1                     TO PV-DETAIL-PAGE-COUNT.           35190000
352000     MOVE +23                  TO PV-DETAIL-LINE-COUNT.           35200000
352100     MOVE 1                    TO DP132O-REPORT-NUMBER.           35210000
352200     MOVE PV-DETAIL-PAGE-COUNT TO DP132O-PAGE-NUMBER.             35220000
352300                                                                  35230000
352310     IF  CC-FLAT-FILE                                             35231099
352351         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35235199
352360          FROM DP132O-STANDRD-HEADER-132-COLS                     35236099
352361*                                                                 35236199
352362***  11-10-2022 BEGIN - DMH                                       35236299
352363*                                                                 35236399
352364         AFTER ADVANCING PAGE                                     35236499
352365*                                                                 35236599
352366***  11-10-2022 END   - DMH                                       35236699
352367*                                                                 35236799
352370     ELSE                                                         35237099
352400         WRITE AS-AUDIT-SUM-REPORT-LINE                           35240099
352500          FROM DP132O-STANDRD-HEADER-132-COLS                     35250099
352600         AFTER ADVANCING PAGE                                     35260099
352700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35270099
352800          FROM DP132O-STANDRD-HEADER-132-COLS                     35280099
352900         AFTER ADVANCING PAGE                                     35290099
352910     END-IF.                                                      35291099
352920                                                                  35292099
353000                                                                  35300000
353100*    "VENDOR ACCURACY CARTON AUDIT"                               35310000
353110                                                                  35311099
353120     IF  CC-FLAT-FILE                                             35312099
353150         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35315099
353160          FROM PH2-PAGE-HEADING-2                                 35316099
353170     ELSE                                                         35317099
353200         WRITE AS-AUDIT-SUM-REPORT-LINE                           35320099
353300          FROM PH2-PAGE-HEADING-2                                 35330099
353400         AFTER ADVANCING 2 LINES                                  35340099
353500         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35350099
353600          FROM PH2-PAGE-HEADING-2                                 35360099
353700         AFTER ADVANCING 2 LINES                                  35370099
353710     END-IF.                                                      35371099
353800                                                                  35380000
353900*    "PACK-BY-STORE CARTON AUDIT"                                 35390000
353910                                                                  35391099
353920     IF  CC-FLAT-FILE                                             35392099
353930         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           35393099
353940         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35394099
353950          FROM PH3-PAGE-HEADING-3-PBS                             35395099
353960     ELSE                                                         35396099
354000         WRITE AS-AUDIT-SUM-REPORT-LINE                           35400099
354100          FROM PH3-PAGE-HEADING-3-PBS                             35410099
354200         AFTER ADVANCING 1 LINES                                  35420099
354300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35430099
354400          FROM PH3-PAGE-HEADING-3-PBS                             35440099
354500         AFTER ADVANCING 1 LINES                                  35450099
354510     END-IF.                                                      35451099
354600                                                                  35460000
354700*    "SUMMARY REPORT"                                             35470000
354710                                                                  35471099
354720     IF  CC-FLAT-FILE                                             35472099
354730         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           35473099
354740         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35474099
354750          FROM PH4-PAGE-HEADING-4                                 35475099
354760     ELSE                                                         35476099
354800         WRITE AS-AUDIT-SUM-REPORT-LINE                           35480099
354900          FROM PH4-PAGE-HEADING-4                                 35490099
355000         AFTER ADVANCING 1 LINE                                   35500099
355100         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35510099
355200          FROM PH4-PAGE-HEADING-4                                 35520099
355300         AFTER ADVANCING 1 LINE                                   35530099
355310     END-IF.                                                      35531099
355400                                                                  35540000
355500*    "AUDIT CONTROL NBR - AUDIT STATUS - FACILITY"                35550000
355510                                                                  35551099
355520     IF  CC-FLAT-FILE                                             35552099
355541         MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT           35554199
355542         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35554299
355543         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35554399
355550          FROM AH1-AUDIT-HEADING-1                                35555099
355560     ELSE                                                         35556099
355600         WRITE AS-AUDIT-SUM-REPORT-LINE                           35560099
355700          FROM AH1-AUDIT-HEADING-1                                35570099
355800         AFTER ADVANCING 2 LINES                                  35580099
355900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35590099
356000          FROM AH1-AUDIT-HEADING-1                                35600099
356100         AFTER ADVANCING 2 LINES                                  35610099
356110     END-IF.                                                      35611099
356200                                                                  35620000
356210*    "VENDOR NAME - DEPARTMENT"                                   35621000
356211                                                                  35621199
356212     IF  CC-FLAT-FILE                                             35621299
356215         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35621599
356216          FROM AH2-AUDIT-HEADING-2                                35621699
356217     ELSE                                                         35621799
356220         WRITE AS-AUDIT-SUM-REPORT-LINE                           35622099
356230          FROM AH2-AUDIT-HEADING-2                                35623099
356240         AFTER ADVANCING 1 LINES                                  35624099
356250         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35625099
356260          FROM AH2-AUDIT-HEADING-2                                35626099
356270         AFTER ADVANCING 1 LINES                                  35627099
356271     END-IF.                                                      35627199
356280                                                                  35628000
356290*    "PO/REC - PRETICKET IND - AUDIT AREA"                        35629000
356291                                                                  35629199
356292     IF  CC-FLAT-FILE                                             35629299
356295         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35629599
356296          FROM AH3-AUDIT-HEADING-3                                35629699
356297     ELSE                                                         35629799
356298         WRITE AS-AUDIT-SUM-REPORT-LINE                           35629899
356299          FROM AH3-AUDIT-HEADING-3                                35629999
356300         AFTER ADVANCING 1 LINES                                  35630099
356302         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35630299
356303          FROM AH3-AUDIT-HEADING-3                                35630399
356304         AFTER ADVANCING 1 LINES                                  35630499
356305     END-IF.                                                      35630599
356306                                                                  35630600
356307*    "AUDIT TYPE - HANGER IND - UNITS TRANSCRIBED"                35630700
356308                                                                  35630899
356309     IF  CC-FLAT-FILE                                             35630999
356312         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35631299
356313          FROM AH4-RECEIVER-HEADING-4                             35631399
356314     ELSE                                                         35631499
356315         WRITE AS-AUDIT-SUM-REPORT-LINE                           35631599
356316          FROM AH4-RECEIVER-HEADING-4                             35631699
356317         AFTER ADVANCING 1 LINES                                  35631799
356319         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35631999
356320          FROM AH4-RECEIVER-HEADING-4                             35632099
356321         AFTER ADVANCING 1 LINES                                  35632199
356322     END-IF.                                                      35632299
356323                                                                  35632300
356324*    RECEIPT DATE - NEW STORE IND - EXP CARTON COUNT              35632400
356325                                                                  35632599
356326     IF  CC-FLAT-FILE                                             35632699
356329         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35632999
356330          FROM AH5-RECEIVER-HEADING-5                             35633099
356331     ELSE                                                         35633199
356332         WRITE AS-AUDIT-SUM-REPORT-LINE                           35633299
356333          FROM AH5-RECEIVER-HEADING-5                             35633399
356334         AFTER ADVANCING 1 LINE                                   35633499
356335         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35633599
356336          FROM AH5-RECEIVER-HEADING-5                             35633699
356337         AFTER ADVANCING 1 LINE                                   35633799
356338     END-IF.                                                      35633899
356339                                                                  35633900
356340*    AUDIT CATEGORY - AUDIT START - CARTONS AUDITED               35634000
356342                                                                  35634299
356345     IF  CC-FLAT-FILE                                             35634599
356349         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35634999
356350          FROM AH6-RECEIVER-HEADING-6                             35635099
356351     ELSE                                                         35635199
356352         WRITE AS-AUDIT-SUM-REPORT-LINE                           35635299
356353          FROM AH6-RECEIVER-HEADING-6                             35635399
356354         AFTER ADVANCING 2 LINE                                   35635499
356357         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35635799
356358          FROM AH6-RECEIVER-HEADING-6                             35635899
356359         AFTER ADVANCING 2 LINE                                   35635999
356360     END-IF.                                                      35636099
356362                                                                  35636299
356363*    AUDIT - AUDIT STOP - ADJ CARTON COUNT                        35636399
356364                                                                  35636499
356365     IF  CC-FLAT-FILE                                             35636599
356368         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35636899
356369          FROM AH7-RECEIVER-HEADING-7                             35636999
356370     ELSE                                                         35637099
356371         WRITE AS-AUDIT-SUM-REPORT-LINE                           35637199
356372          FROM AH7-RECEIVER-HEADING-7                             35637299
356373         AFTER ADVANCING 1 LINE                                   35637399
356375         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35637599
356376          FROM AH7-RECEIVER-HEADING-7                             35637699
356377         AFTER ADVANCING 1 LINE                                   35637799
356378     END-IF.                                                      35637899
356379                                                                  35637999
356380*    DESIGNATION - DURATION - UNITS AUDITED                       35638099
356381                                                                  35638199
356382     IF  CC-FLAT-FILE                                             35638299
356385         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35638599
356386          FROM AH8-RECEIVER-HEADING-8                             35638699
356387     ELSE                                                         35638799
356388         WRITE AS-AUDIT-SUM-REPORT-LINE                           35638899
356389          FROM AH8-RECEIVER-HEADING-8                             35638999
356390         AFTER ADVANCING 1 LINE                                   35639099
356392         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35639299
356393          FROM AH8-RECEIVER-HEADING-8                             35639399
356394         AFTER ADVANCING 1 LINE                                   35639499
356395     END-IF.                                                      35639599
356396                                                                  35639699
356397*    AUDITING ASSOCIATES                                          35639799
356398                                                                  35639899
356399     IF  CC-FLAT-FILE                                             35639999
356403         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35640399
356404          FROM AH9-RECEIVER-HEADING-9                             35640499
356405     ELSE                                                         35640599
356406         WRITE AS-AUDIT-SUM-REPORT-LINE                           35640699
356407          FROM AH9-RECEIVER-HEADING-9                             35640799
356408         AFTER ADVANCING 2 LINE                                   35640899
356409         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35640999
356410          FROM AH9-RECEIVER-HEADING-9                             35641099
356411         AFTER ADVANCING 2 LINE                                   35641199
356412     END-IF.                                                      35641299
356413                                                                  35641399
356414*    "PROCESS AREA/ SHIFT.."                                      35641400
356415                                                                  35641599
356416     IF  CC-FLAT-FILE                                             35641699
356419         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35641999
356420          FROM AH9-AUDIT-HEADING-9A                               35642099
356421     ELSE                                                         35642199
356430         WRITE AS-AUDIT-SUM-REPORT-LINE                           35643099
356500          FROM AH9-AUDIT-HEADING-9A                               35650099
356600         AFTER ADVANCING 2 LINES                                  35660099
356700         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35670099
356800          FROM AH9-AUDIT-HEADING-9A                               35680099
356900         AFTER ADVANCING 2 LINES                                  35690099
356910     END-IF.                                                      35691099
356920                                                                  35692099
356930                                                                  35693099
356940     IF  CC-FLAT-FILE                                             35694099
356970         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35697099
356980          FROM AH9-AUDIT-HEADING-DASH                             35698099
356990     ELSE                                                         35699099
357000         WRITE AS-AUDIT-SUM-REPORT-LINE                           35700099
357100          FROM AH9-AUDIT-HEADING-DASH                             35710099
357200         AFTER ADVANCING 2 LINES                                  35720099
357300         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35730099
357400          FROM AH9-AUDIT-HEADING-DASH                             35740099
357500         AFTER ADVANCING 2 LINES                                  35750099
357501     END-IF.                                                      35750199
357510                                                                  35751099
357520                                                                  35752099
357530     IF  CC-FLAT-FILE                                             35753099
357560         WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                      35756099
357570          FROM AH9-AUDIT-HEADING-DASH                             35757099
357580     ELSE                                                         35758099
357600         WRITE AS-AUDIT-SUM-REPORT-LINE                           35760099
357700          FROM AH9-AUDIT-HEADING-DASH                             35770099
357800         AFTER ADVANCING 2 LINES                                  35780099
357900         WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                       35790099
358000          FROM AH9-AUDIT-HEADING-DASH                             35800099
358100         AFTER ADVANCING 2 LINES                                  35810099
358110     END-IF.                                                      35811099
358200                                                                  35820000
358210*    SET FLAGS SO THE NEXT DETAIL OF EITHER TYPE WILL PRINT THEIR 35821000
358220*    SECTION HEADINGS FIRST                                       35822000
358230                                                                  35823099
358300     SET PS-PRINT-PICK-HEADING                                    35830000
358400         PS-PRINT-TICK-HEADING                                    35840000
358500         PS-PRINT-RFID-HEADING          TO TRUE.                  35850000
359900                                                                  35990000
365700                                                                  36570000
365800******************************************************************36580000
365900*  3110-SELECT-RECEIVER-INFO.                                     36590000
366000******************************************************************36600000
366100 3110-SELECT-RECEIVER-INFO.                                       36610000
366200                                                                  36620000
366300     IF SU005-REC-SEQ-NBR > 0                                     36630000
366400*        SELECT INFO FROM THE RECEIVER TABLE                      36640000
366500         PERFORM 3120-SELECT-RCVR-HEADER-INFO                     36650000
366600*        SELECT THE UNITS TRANSCRIBED FROM THE RECEIVING          36660000
366700*        DISTRO TABLE                                             36670000
366800         PERFORM 3130-SELECT-UNITS-TRNSCRBD                       36680000
366900     ELSE                                                         36690000
367000         INITIALIZE PV-RECEIPT-DATE                               36700000
367100                    PV-UNITS-TRNSCRBD                             36710000
367200                    RECEIV-EXPTED-CART-CNT                        36720000
367300                    RECEIV-ACTL-CART-CNT                          36730000
367400                    RECEIV-PRE-TKT-IND                            36740000
367500                    RECEIV-GOH-IND                                36750000
367600                    PURCHS-DEPT-NBR                               36760000
367700                    PURCHS-NEW-STR-PO-IND                         36770000
367800                    ENTNME-ENT-NAME-DESC                          36780000
367900     END-IF.                                                      36790000
368000                                                                  36800000
368100                                                                  36810000
368200*    SELECT RECEIVER LEVEL INFO FROM THE CARTON AUDITING TABLES   36820000
368300                                                                  36830099
368400     IF SU005-RFID-ERRORS                                         36840000
368500        PERFORM 3135-SELECT-AUDIT-COUNTS                          36850000
368600     ELSE                                                         36860000
368700        PERFORM 3140-SELECT-AUDIT-COUNTS                          36870000
368800     END-IF                                                       36880000
368900                                                                  36890099
369000                                                                  36900000
369100*    SELECT ALL THE ASSOCIATE USER-IDS THAT HAVE WORKED ON THIS   36910000
369200*    AUDIT/RECEIVER.                                              36920000
369300     PERFORM 3150-SELECT-AUDIT-UIDS.                              36930000
369400                                                                  36940000
369500*    MOVE SQL FIELDS TO THE REPORT LINE FIELDS                    36950000
369600     MOVE SU005-PO-NBR                TO AH3-PO.                  36960000
369700     MOVE SU005-REC-SEQ-NBR           TO AH3-RECEIVER.            36970000
369800     MOVE ENTNME-ENT-NAME-DESC        TO PV-VENDOR-NAME.          36980000
369900     MOVE PV-VENDOR-NAME              TO AH2-VENDOR-NAME.         36990000
370000     MOVE PURCHS-DEPT-NBR             TO AH2-DEPT-NBR.            37000000
370100                                                                  37010000
370200     MOVE PV-RECEIPT-DATE             TO AH5-RECIPT-DATE.         37020000
370300     MOVE PURCHS-NEW-STR-PO-IND       TO AH5-NEW-STORE-IND.       37030000
370400     MOVE RECEIV-PRE-TKT-IND          TO AH3-PRETICKET-IND.       37040000
370500     MOVE RECEIV-GOH-IND              TO AH4-HANGER-IND.          37050000
370600                                                                  37060000
370700     MOVE RECEIV-EXPTED-CART-CNT      TO AH5-EST-CART-COUNT.      37070000
370800     MOVE RECEIV-ACTL-CART-CNT        TO AH7-ADJ-CART-COUNT.      37080000
370900     MOVE PV-UNITS-TRNSCRBD           TO AH4-UNITS-TRANSCRIBED.   37090000
371000*                                                                 37100000
371100     MOVE PV-AUDIT-CARTON-COUNT       TO AH6-CARTONS-AUDITED.     37110000
372300     MOVE PV-AUDIT-UNIT-COUNT         TO AH8-UNITS-AUDITED        37230000
372700                                                                  37270000
372800*    SELECT ALL THE STORES THAT WERE AUDITED FOR THIS AUDIT/      37280000
372900*    RECEIVER.                                                    37290000
373000     PERFORM 3160-SELECT-AUD-STR-NBRS.                            37300000
373001                                                                  37300199
373010     PERFORM 3170-CHECK-COMBO.                                    37301000
373020                                                                  37302099
373100                                                                  37310000
373200******************************************************************37320000
373300*  3120-SELECT-RCVR-HEADER-INFO                                   37330000
373400******************************************************************37340000
373500 3120-SELECT-RCVR-HEADER-INFO.                                    37350000
373600                                                                  37360000
373700     MOVE SU005-PO-NBR                TO DK-PO-NBR.               37370000
373800     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          37380000
373900                                                                  37390000
374000     EXEC SQL                                                     37400000
374100         SELECT                                                   37410000
374200               CHAR (DATE (A.REC_TMST), USA)                      37420000
374300             , A.EXPTED_CART_CNT                                  37430000
374400             , A.ACTL_CART_CNT                                    37440000
374500             , A.PRE_TKT_IND                                      37450000
374600             , A.GOH_IND                                          37460000
374700             , B.DEPT_NBR                                         37470000
374800             , B.NEW_STR_PO_IND                                   37480000
374900             , C.ENT_NAME_DESC                                    37490000
375000         INTO                                                     37500000
375100               :PV-RECEIPT-DATE                                   37510000
375200             , :RECEIV-EXPTED-CART-CNT                            37520000
375300             , :RECEIV-ACTL-CART-CNT                              37530000
375400             , :RECEIV-PRE-TKT-IND                                37540000
375500             , :RECEIV-GOH-IND                                    37550000
375600             , :PURCHS-DEPT-NBR                                   37560000
375700             , :PURCHS-NEW-STR-PO-IND                             37570000
375800             , :ENTNME-ENT-NAME-DESC                              37580000
375900         FROM                                                     37590000
376000               TRECEIV A                                          37600000
376100             , TPURCHS B                                          37610000
376200             , TENTNME C                                          37620000
376300         WHERE                                                    37630000
376400               A.ORD_NBR        = :DK-PO-NBR                      37640000
376500           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 37650000
376600           AND A.ORD_NBR        = B.PO_NBR                        37660000
376700           AND B.VER_STATUS_CDE = 'A'                             37670000
376800           AND B.ENT_ID         = C.ENT_ID                        37680000
376900           AND C.TYPE_CDE       = '01'                            37690000
377000     END-EXEC.                                                    37700000
377100                                                                  37710000
377200     EVALUATE TRUE                                                37720000
377300         WHEN SQLCODE = ZERO                                      37730000
377400              CONTINUE                                            37740000
377500         WHEN SQLWARN0 NOT EQUAL SPACE                            37750000
377600         WHEN SQLCODE NOT EQUAL ZERO                              37760000
377700              DISPLAY 'PO NBR: ' DK-PO-NBR                        37770000
377800              DISPLAY 'REC SEQ NBR: ' DK-REC-SEQ-NBR              37780000
377900              MOVE '3120-SELECT-RECVR-HEADER-INFO'                37790000
378000                               TO  PV-PARAGRAPH-NAME              37800000
378100              MOVE 'SELECT RECIVER INFORMATION'                   37810000
378200                               TO  PV-DB2-OPERATION-ATTEMPTED     37820000
378300              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           37830000
378400              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      37840000
378500              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-1           37850000
378600              MOVE PV-DISP-REC-SEQ-NBR                            37860000
378700                                      TO PV-DB2-FIELD-2           37870000
378800              MOVE SPACES             TO PV-DB2-FIELD-3           37880000
378900              PERFORM 9999-SQL-ABEND                              37890000
379000     END-EVALUATE.                                                37900000
379100                                                                  37910000
379200                                                                  37920000
379300******************************************************************37930000
379400*  3130-SELECT-UNITS-TRNSCRBD.                                    37940000
379500******************************************************************37950000
379600 3130-SELECT-UNITS-TRNSCRBD.                                      37960000
379700                                                                  37970000
379800     MOVE SU005-PO-NBR                TO DK-PO-NBR.               37980000
379900     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          37990000
380000                                                                  38000000
380100     EXEC SQL                                                     38010000
380200         SELECT                                                   38020000
380300               SUM(EXPTED_ITM_QTY)                                38030000
380400         INTO                                                     38040000
380500               :PV-UNITS-TRNSCRBD                                 38050000
380600         FROM                                                     38060000
380700               TRECDIS A                                          38070000
380800         WHERE                                                    38080000
380900               A.ORD_NBR        = :DK-PO-NBR                      38090000
381000           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 38100000
381200     END-EXEC.                                                    38120000
381300                                                                  38130000
381400     EVALUATE TRUE                                                38140000
381500         WHEN SQLCODE = ZERO                                      38150000
381600              CONTINUE                                            38160000
381700         WHEN SQLCODE = +100                                      38170000
381800         WHEN SQLCODE = -305                                      38180000
381900              MOVE +0  TO PV-UNITS-TRNSCRBD                       38190000
382000         WHEN SQLWARN0 NOT EQUAL SPACE                            38200000
382100         WHEN SQLCODE NOT EQUAL ZERO                              38210000
382200              MOVE '3130-SELECT-UNITS-TRNSCRBD.'                  38220000
382300                               TO  PV-PARAGRAPH-NAME              38230000
382400              MOVE 'SELECT RECDIS INFORMATION'                    38240000
382500                               TO  PV-DB2-OPERATION-ATTEMPTED     38250000
382600              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           38260000
382700              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      38270000
382800              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-1           38280000
382900              MOVE PV-DISP-REC-SEQ-NBR                            38290000
383000                                      TO PV-DB2-FIELD-2           38300000
383100              MOVE SPACES             TO PV-DB2-FIELD-3           38310000
383200              PERFORM 9999-SQL-ABEND                              38320000
383300     END-EVALUATE.                                                38330000
383400                                                                  38340000
383500                                                                  38350099
383600******************************************************************38360000
383700*  3135-SELECT-AUDIT-COUNTS.                                      38370000
383800******************************************************************38380000
383900 3135-SELECT-AUDIT-COUNTS.                                        38390000
384000** CHANGES SELECT TO SUM RFID_TGD_QTY RATHER THAN                 38400000
384100** COUNT THE TOTAL ROWS, ALSO, IGNORE 'E' SCN_TYPE CODES          38410000
384200** WHICH ARE UPC'S EXPECTED ON THE ASN BUT NOT RECEIVED           38420000
384300                                                                  38430000
384400     MOVE SU005-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR.         38440000
384500     MOVE SU005-PO-NBR                TO DK-PO-NBR.               38450000
384600     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          38460000
384700                                                                  38470000
384800     EXEC SQL                                                     38480000
384900         SELECT                                                   38490000
385000               COUNT(DISTINCT A.SHIPT_UNT_ID)                     38500000
385100             , SUM(RFID_TGD_QTY)                                  38510000
385200         INTO                                                     38520000
385300               :PV-AUDIT-CARTON-COUNT                             38530000
385400            ,  :PV-AUDIT-UNIT-COUNT                               38540000
385500         FROM                                                     38550000
385600               TSUAUPC A                                          38560000
385700             , TSUATRN B                                          38570000
385800         WHERE                                                    38580000
385900               A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                38590000
386000           AND A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR                  38600000
386100           AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  38610000
386200           AND B.TRN_NBR        = :DK-PO-NBR                      38620000
386300           AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 38630000
386400           AND A.SCN_TYP_CDE   <> 'E'                             38640000
386500     END-EXEC.                                                    38650000
386600                                                                  38660000
386700     EVALUATE TRUE                                                38670000
386800         WHEN SQLCODE = ZERO                                      38680000
386900              CONTINUE                                            38690000
387000         WHEN SQLCODE = -305                                      38700000
387100              MOVE 0            TO PV-AUDIT-CARTON-COUNT          38710000
387200                                   PV-AUDIT-UNIT-COUNT            38720000
387300         WHEN SQLWARN0 NOT EQUAL SPACE                            38730000
387400         WHEN SQLCODE NOT EQUAL ZERO                              38740000
387500              MOVE '3135-SELECT-AUDIT-COUNTS.'                    38750000
387600                               TO  PV-PARAGRAPH-NAME              38760000
387700              MOVE 'SELECT COUNTS OF AUDIT CARTONS AND UNITS'     38770000
387800                               TO  PV-DB2-OPERATION-ATTEMPTED     38780000
387900              MOVE SU005-AUD-CNTL-NBR TO PV-DISP-AUD-CNTL-NBR     38790000
388000              MOVE SU005-PO-NBR       TO PV-DISP-PO-NBR           38800000
388100              MOVE SU005-REC-SEQ-NBR  TO PV-DISP-REC-SEQ-NBR      38810000
388200              MOVE PV-DISP-AUD-CNTL-NBR                           38820000
388300                                      TO PV-DB2-FIELD-1           38830000
388400              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           38840000
388500              MOVE PV-DISP-REC-SEQ-NBR                            38850000
388600                                      TO PV-DB2-FIELD-3           38860000
388700              PERFORM 9999-SQL-ABEND                              38870000
388800     END-EVALUATE.                                                38880000
388801                                                                  38880100
388810     EXEC SQL                                                     38881000
388820         SELECT                                                   38882000
388840               SUM(SCND_UNT_QTY) - SUM (RFID_TGD_QTY)             38884000
388850         INTO                                                     38885000
388870               :PV-AUDIT-NOT-TAGGED-RFID                          38887000
388880         FROM                                                     38888000
388890               TSUAUPC A                                          38889000
388891             , TSUATRN B                                          38889100
388892             , TSUEXCP C                                          38889200
388893         WHERE                                                    38889300
388894               A.AUD_CNTL_NBR    = :DK-AUD-CNTL-NBR               38889400
388895           AND A.AUD_CNTL_NBR    = B.AUD_CNTL_NBR                 38889500
388896           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 38889600
388897           AND B.TRN_NBR         = :DK-PO-NBR                     38889700
388898           AND B.REC_SEQ_NBR     = :DK-REC-SEQ-NBR                38889800
388899           AND A.SCN_TYP_CDE     = 'E'                            38889900
388900           AND A.AUD_CNTL_NBR    = C.AUD_CNTL_NBR                 38890000
388901           AND A.SCN_TMST        = C.SCN_TMST                     38890100
388902           AND C.VILN_GP_CDE     = 'VA'                           38890200
388903           AND C.VILN_GP_SEQ_NBR = 42                             38890300
388904     END-EXEC.                                                    38890400
388905                                                                  38890500
388906     EVALUATE TRUE                                                38890600
388907         WHEN SQLCODE = ZERO                                      38890700
388908              ADD PV-AUDIT-NOT-TAGGED-RFID TO PV-AUDIT-UNIT-COUNT 38890800
388909         WHEN SQLCODE = -305                                      38890900
388910              CONTINUE                                            38891000
388912         WHEN SQLWARN0 NOT EQUAL SPACE                            38891200
388913         WHEN SQLCODE NOT EQUAL ZERO                              38891300
388914              MOVE '3135-SELECT-AUDIT-COUNTS.'                    38891400
388915                               TO  PV-PARAGRAPH-NAME              38891500
388916              MOVE 'SELECT COUNTS OF NOT TAGGED UNITS'            38891600
388917                               TO  PV-DB2-OPERATION-ATTEMPTED     38891700
388918              MOVE SU005-AUD-CNTL-NBR TO PV-DISP-AUD-CNTL-NBR     38891800
388919              MOVE SU005-PO-NBR       TO PV-DISP-PO-NBR           38891900
388920              MOVE SU005-REC-SEQ-NBR  TO PV-DISP-REC-SEQ-NBR      38892000
388921              MOVE PV-DISP-AUD-CNTL-NBR                           38892100
388922                                      TO PV-DB2-FIELD-1           38892200
388923              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           38892300
388924              MOVE PV-DISP-REC-SEQ-NBR                            38892400
388925                                      TO PV-DB2-FIELD-3           38892500
388926              PERFORM 9999-SQL-ABEND                              38892600
388927     END-EVALUATE.                                                38892700
388930                                                                  38893099
389000                                                                  38900000
389100******************************************************************38910000
389200*  3140-SELECT-AUDIT-COUNTS.                                      38920000
389300******************************************************************38930000
389400 3140-SELECT-AUDIT-COUNTS.                                        38940000
389500** CHANGED SELECT TO SUM SCN_UNT-QTY RATHER THAN                  38950099
389600** COUNT THE TOTAL ROWS, ALSO, IGNORE 'E' SCN_TYPE CODES          38960000
389700** WHICH ARE UPC'S EXPECTED ON THE ASN BUT NOT RECEIVED           38970000
389800                                                                  38980000
389900     MOVE SU005-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR.         38990000
390000     MOVE SU005-PO-NBR                TO DK-PO-NBR.               39000000
390100     MOVE SU005-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.          39010000
390200                                                                  39020000
390300     EXEC SQL                                                     39030000
390400         SELECT                                                   39040000
390500               COUNT(DISTINCT A.SHIPT_UNT_ID)                     39050000
390600             , SUM(SCND_UNT_QTY)                                  39060000
390700         INTO                                                     39070000
390800               :PV-AUDIT-CARTON-COUNT                             39080000
390900            ,  :PV-AUDIT-UNIT-COUNT                               39090000
391000         FROM                                                     39100000
391100               TSUAUPC A                                          39110000
391200             , TSUATRN B                                          39120000
391300         WHERE                                                    39130000
391400               A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                39140000
391500           AND A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR                  39150000
391600           AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  39160000
391700           AND B.TRN_NBR        = :DK-PO-NBR                      39170000
391800           AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 39180000
391900           AND A.SCN_TYP_CDE   <> 'E'                             39190000
392000     END-EXEC.                                                    39200000
392100                                                                  39210000
392200     EVALUATE TRUE                                                39220000
392300         WHEN SQLCODE = ZERO                                      39230000
392400              CONTINUE                                            39240000
392500         WHEN SQLCODE = -305                                      39250000
392600              MOVE 0            TO PV-AUDIT-CARTON-COUNT          39260000
392700                                   PV-AUDIT-UNIT-COUNT            39270000
392800         WHEN SQLWARN0 NOT EQUAL SPACE                            39280000
392900         WHEN SQLCODE NOT EQUAL ZERO                              39290000
393000              MOVE '3140-SELECT-AUDIT-COUNTS.'                    39300000
393100                               TO  PV-PARAGRAPH-NAME              39310000
393200              MOVE 'SELECT COUNTS OF AUDIT CARTONS AND UNITS'     39320000
393300                               TO  PV-DB2-OPERATION-ATTEMPTED     39330000
393400              MOVE SU005-AUD-CNTL-NBR TO PV-DISP-AUD-CNTL-NBR     39340000
393500              MOVE SU005-PO-NBR       TO PV-DISP-PO-NBR           39350000
393600              MOVE SU005-REC-SEQ-NBR  TO PV-DISP-REC-SEQ-NBR      39360000
393700              MOVE PV-DISP-AUD-CNTL-NBR                           39370000
393800                                      TO PV-DB2-FIELD-1           39380000
393900              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           39390000
394000              MOVE PV-DISP-REC-SEQ-NBR                            39400000
394100                                      TO PV-DB2-FIELD-3           39410000
394200              PERFORM 9999-SQL-ABEND                              39420000
394300     END-EVALUATE.                                                39430000
394400                                                                  39440000
394500                                                                  39450000
394600******************************************************************39460000
394700*  3150-SELECT-AUDIT-UIDS.                                        39470000
394800* OPEN A CURSOR TO SELECT ALL THE USERIDS OF ALL THE ASSOCIATES   39480000
394900* THAT HAVE TOUCHED THIS AUDIT.                                   39490000
395000******************************************************************39500000
395100 3150-SELECT-AUDIT-UIDS.                                          39510000
395200                                                                  39520000
395300     INITIALIZE AH9-USERID-TABLE                                  39530000
395400                PV-HOLD-UID.                                      39540000
395500     SET AH9-UID-IDX TO +1.                                       39550000
395600     SET AH9-UID-IDX DOWN BY +1.                                  39560000
395700                                                                  39570000
395800     MOVE SU005-PO-NBR              TO DK-PO-NBR                  39580000
395900     MOVE SU005-REC-SEQ-NBR         TO DK-REC-SEQ-NBR             39590000
396000     MOVE SU005-AUD-CNTL-NBR        TO DK-AUD-CNTL-NBR            39600000
396100                                                                  39610000
396200     PERFORM 4000-OPEN-UID-CURSOR.                                39620000
396300     PERFORM 4020-FETCH-UID-CURSOR.                               39630000
396400                                                                  39640099
396500     PERFORM UNTIL PS-EOF-UID-CURSOR                              39650000
396600         IF SUNAUD-AUD-USR-ID = PV-HOLD-UID                       39660000
396700             CONTINUE                                             39670000
396800         ELSE                                                     39680000
396900             IF AH9-UID-IDX > 0                                   39690000
397000                 MOVE ','          TO AH9-COMMA (AH9-UID-IDX)     39700000
397100             END-IF                                               39710000
397200                                                                  39720000
397300             SET AH9-UID-IDX UP BY +1                             39730000
397400             MOVE SUNAUD-AUD-USR-ID TO                            39740000
397500                             AH9-USER-ID (AH9-UID-IDX)            39750000
397600             MOVE SUNAUD-AUD-USR-ID TO PV-HOLD-UID                39760000
397700         END-IF                                                   39770000
397800         PERFORM 4020-FETCH-UID-CURSOR                            39780000
397900     END-PERFORM                                                  39790000
398000                                                                  39800000
398100     PERFORM 4010-CLOSE-UID-CURSOR.                               39810000
398200                                                                  39820000
398300                                                                  39830000
398400******************************************************************39840000
398500*  3160-SELECT-AUD-STR-NBRS.                                      39850000
398600* OPEN A CURSOR TO SELECT ALL THE USERIDS OF ALL THE ASSOCIATES   39860000
398700* THAT HAVE TOUCHED THIS AUDIT.                                   39870000
398800******************************************************************39880000
398900 3160-SELECT-AUD-STR-NBRS.                                        39890000
399000                                                                  39900000
399100     INITIALIZE PV-AUDITED-STORES-TABLE.                          39910000
399200     SET PV-AUD-STR-IDX TO +1.                                    39920000
399300     SET PV-AUD-STR-IDX DOWN BY +1.                               39930000
399400                                                                  39940000
399500     MOVE SU005-PO-NBR              TO DK-PO-NBR.                 39950000
399600     MOVE SU005-REC-SEQ-NBR         TO DK-REC-SEQ-NBR.            39960000
399700     MOVE SU005-AUD-CNTL-NBR        TO DK-AUD-CNTL-NBR.           39970000
399800                                                                  39980000
399900     PERFORM 4100-OPEN-AUD-STR-CURSOR.                            39990000
400000     PERFORM 4120-FETCH-AUD-STR-CURSOR.                           40000000
400100                                                                  40010099
400200     PERFORM UNTIL PS-EOF-AUD-STR-CURSOR                          40020000
400300         SET PV-AUD-STR-IDX UP BY +1                              40030000
400400         IF PV-AUD-STR-IDX > PV-MAX-STORES                        40040000
400500             DISPLAY '** ABEND     **'                            40050000
400600             DISPLAY '** PROGRAM   ** = SUKRP009'                 40060000
400700             DISPLAY '** AUDITED STORE TABLE OVERFLOW **'         40070000
400800             DISPLAY '** CURRENT SIZE OF THE TABLE: '             40080000
400900                      PV-MAX-STORES                               40090000
401000             DISPLAY '** CURRENT SIZE OF THE TABLE '              40100000
401100                      'MUST BE INCREASED'                         40110000
401200             MOVE +4004 TO ABEND-CODE                             40120000
401300             CALL 'ILBOABN0' USING ABEND-CODE                     40130000
401400         END-IF                                                   40140000
401500         MOVE SUATRN-DEST-OPER-UNT-ID                             40150000
401600                             TO PV-STR-NBR (PV-AUD-STR-IDX)       40160000
401700                                                                  40170000
401800         PERFORM 4120-FETCH-AUD-STR-CURSOR                        40180000
401900     END-PERFORM.                                                 40190000
402000                                                                  40200000
402100     PERFORM 4110-CLOSE-AUD-STR-CURSOR.                           40210000
402200                                                                  40220000
402300     SET PV-STR-COUNT        TO PV-AUD-STR-IDX.                   40230000
402400                                                                  40240000
402501                                                                  40250199
402510******************************************************************40251000
402520* 3170-CHECK-COMBO                                                40252000
402530*    THIS PARAGRAPH WILL CHECK IF THE AUDIT WAS PART OF A COMBO   40253000
402540*    AUDIT OR NOT.                                                40254000
402550******************************************************************40255000
402560 3170-CHECK-COMBO.                                                40256000
402570                                                                  40257000
402580     IF AH7-PROMPTED-AUDIT                                        40258000
402590*       SYSTEM GENERATED AUDIT                                    40259000
402591        IF SUT00015-PKGNG-TYP-CDE = 'RF'                          40259100
402592*          RFID AUDIT                                             40259200
402593           INITIALIZE PV-COUNT                                    40259300
402594           PERFORM 3180-CHECK-REWORK-AUD                          40259400
402595           IF PV-COUNT > 0                                        40259500
402596*             AUDIT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT     40259600
402597              SET AH8-COMBO     TO TRUE                           40259700
402598           ELSE                                                   40259800
402599*             AUDIT NOT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT 40259900
402600              SET AH8-NOT-COMBO TO TRUE                           40260000
402601           END-IF                                                 40260100
402602        ELSE                                                      40260200
402603*          QC AUDIT                                               40260300
402604           IF SUT00015-RWRK-AUD-CNTL-NBR > 0                      40260400
402605*             PART OF COMBO                                       40260500
402606              SET AH8-COMBO     TO TRUE                           40260600
402607           ELSE                                                   40260700
402608*             NOT PART OF COMBO                                   40260800
402609              SET AH8-NOT-COMBO TO TRUE                           40260900
402610           END-IF                                                 40261000
402611        END-IF                                                    40261100
402612     ELSE                                                         40261200
402613*       MANUAL AUDIT                                              40261300
402614        PERFORM 3190-CHECK-PO-EXCEPTION                           40261400
402615        PERFORM 3195-CHECK-VENDOR-TAGGING                         40261500
402616        IF PS-VENDOR-TAGGING  OR                                  40261600
402617           PS-VENDOR-COMPLIANT                                    40261700
402618           PERFORM 3200-CHECK-DEPT-TAGGING                        40261800
402619        END-IF                                                    40261900
402620        IF PS-PO-EXCEPTION                                        40262000
402621*          THERE ARE PO EXCEPTIONS DEFINED FOR PO/DC              40262100
402622           EVALUATE SUT00014-AUD-TYP-CDE                          40262200
402623             WHEN 'Q'                                             40262300
402624             WHEN 'R'                                             40262400
402625*                 QC/RF ONLY EXCEPTION DEFINED                    40262500
402626                  SET AH8-NOT-COMBO     TO TRUE                   40262600
402627             WHEN 'A'                                             40262700
402628*                 100% EXCEPTION DEFINED                          40262800
402629                  IF (PS-VENDOR-TAGGING  OR                       40262900
402630                     PS-VENDOR-COMPLIANT) AND PS-DEPT-TAGGING     40263000
402631*                    VENDOR IS RFID TAGGING OR COMPLIANT          40263100
402632                     SET AH8-COMBO     TO TRUE                    40263200
402633                  ELSE                                            40263300
402634*                    VENDOR IS NOT RFID TAGGING OR COMPLIANT      40263400
402635                     SET AH8-NOT-COMBO     TO TRUE                40263500
402636                  END-IF                                          40263600
402637             WHEN 'N'                                             40263700
402638*                 NONE EXCEPTION DEFINED                          40263800
402639                  IF PS-VENDOR-TAGGING AND PS-DEPT-TAGGING        40263900
402640*                    VENDOR IS RFID TAGGING                       40264000
402641                     SET AH8-COMBO     TO TRUE                    40264100
402642                  ELSE                                            40264200
402643*                    VENDOR IS NOT RFID TAGGING                   40264300
402644                     SET AH8-NOT-COMBO     TO TRUE                40264400
402645                  END-IF                                          40264500
402646           END-EVALUATE                                           40264600
402647        ELSE                                                      40264700
402648*          THERE ARE NO PO EXCEPTIONS DEFINED FOR PO/DC           40264800
402649           IF PS-VENDOR-TAGGING AND PS-DEPT-TAGGING               40264900
402650*             VENDOR IS RFID TAGGING                              40265000
402651              SET AH8-COMBO     TO TRUE                           40265100
402652           ELSE                                                   40265200
402653*             VENDOR IS NOT RFID TAGGING                          40265300
402654              SET AH8-NOT-COMBO     TO TRUE                       40265400
402655           END-IF                                                 40265500
402656        END-IF                                                    40265600
402657     END-IF.                                                      40265700
402658                                                                  40265800
402659******************************************************************40265900
402660* 3180-CHECK-REWORK-AUD.                                          40266099
402661*    THIS PARAGRAPH WILL CHECK IF THE RFID AUDIT IS PRESENT IN THE40266100
402662*    REWORK AUDIT CONTROL NUMBER FOR ANY OTHER AUDIT. IF SO, IT   40266200
402663*    WILL BE A COMBO.                                             40266300
402664******************************************************************40266400
402665 3180-CHECK-REWORK-AUD.                                           40266500
402666                                                                  40266600
402667     EXEC SQL                                                     40266700
402668         SELECT VALUE(COUNT(*), 0)                                40266800
402669         INTO  :PV-COUNT                                          40266900
402670         FROM   SUT_PO_AUD_REQ                                    40267000
402671         WHERE  RWRK_AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              40267100
402672     END-EXEC.                                                    40267200
402673                                                                  40267300
402674     EVALUATE TRUE                                                40267400
402675         WHEN SQLCODE = ZERO                                      40267500
402676         WHEN SQLCODE = +100                                      40267600
402677         WHEN SQLCODE = -811                                      40267700
402678              CONTINUE                                            40267800
402679         WHEN SQLWARN0 NOT = SPACES                               40267900
402680         WHEN SQLCODE < +0                                        40268000
402681         WHEN SQLCODE > ZERO                                      40268100
402682            DISPLAY DK-AUD-CNTL-NBR                               40268200
402683            MOVE '3180-CHECK-REWORK-AUD'                          40268300
402684                                   TO  PV-PARAGRAPH-NAME          40268400
402685            MOVE 'SELECT OF SUT_PO_AUD_REQ'                       40268500
402686                                   TO PV-DB2-OPERATION-ATTEMPTED  40268600
402687            MOVE DK-AUD-CNTL-NBR   TO PV-DISP-AUD-CNTL-NBR        40268700
402688            MOVE PV-DISP-AUD-CNTL-NBR                             40268800
402689                                   TO PV-DB2-FIELD-1              40268900
402690            MOVE SPACES            TO PV-DB2-FIELD-2              40269000
402691                                      PV-DB2-FIELD-3              40269100
402692            PERFORM 9999-SQL-ABEND                                40269200
402693     END-EVALUATE.                                                40269300
402694                                                                  40269400
402695 3190-CHECK-PO-EXCEPTION.                                         40269500
402696                                                                  40269600
402697     INITIALIZE DCLSUT00014.                                      40269700
402698     MOVE SU005-PO-NBR    TO SUT00014-PO-NBR                      40269800
402699     MOVE DK-OPER-UNT-ID  TO SUT00014-OPER-UNT-ID                 40269900
402700                                                                  40270000
402701     EXEC SQL                                                     40270100
402702         SELECT AUD_TYP_CDE                                       40270200
402703         INTO   :SUT00014-AUD-TYP-CDE                             40270300
402704         FROM  SUT_PO_AUD_EXC                                     40270400
402705         WHERE PO_NBR      = :SUT00014-PO-NBR                     40270500
402706         AND   OPER_UNT_ID = :SUT00014-OPER-UNT-ID                40270600
402707     END-EXEC.                                                    40270700
402708                                                                  40270800
402709     EVALUATE SQLCODE                                             40270900
402710         WHEN 0                                                   40271000
402711             SET PS-PO-EXCEPTION    TO TRUE                       40271100
402712         WHEN 100                                                 40271200
402713             SET PS-NO-PO-EXCEPTION TO TRUE                       40271300
402714         WHEN OTHER                                               40271400
402715            DISPLAY DK-AUD-CNTL-NBR                               40271500
402716            MOVE '3190-CHECK-PO-EXCEPTION'                        40271600
402717                                   TO  PV-PARAGRAPH-NAME          40271700
402718            MOVE 'SELECT OF SUT_PO_AUD_EXC'                       40271800
402719                                   TO PV-DB2-OPERATION-ATTEMPTED  40271900
402720            MOVE SUT00014-PO-NBR   TO PV-DISP-PO-NBR              40272000
402721            MOVE SUT00014-OPER-UNT-ID                             40272100
402722                                   TO PV-DISP-OPER-UNT-ID         40272200
402723            MOVE PV-DISP-PO-NBR                                   40272300
402724                                   TO PV-DB2-FIELD-1              40272400
402725            MOVE PV-DISP-OPER-UNT-ID                              40272500
402726                                   TO PV-DB2-FIELD-2              40272600
402727            MOVE SPACES            TO PV-DB2-FIELD-3              40272700
402728            PERFORM 9999-SQL-ABEND                                40272800
402729     END-EVALUATE.                                                40272900
402730                                                                  40273000
402731 3195-CHECK-VENDOR-TAGGING.                                       40273100
402732                                                                  40273200
402733     INITIALIZE DCLTPURCHS                                        40273300
402734                DCLTVNDAGR.                                       40273400
402735                                                                  40273500
402736     MOVE SU005-PO-NBR    TO PURCHS-PO-NBR                        40273600
402737                                                                  40273700
402738     EXEC SQL                                                     40273800
402739         SELECT DEPT_NBR                                          40273900
402740               ,ENT_ID                                            40274000
402741         INTO   :PURCHS-DEPT-NBR                                  40274100
402742               ,:PURCHS-ENT-ID                                    40274200
402743         FROM TPURCHS                                             40274300
402744         WHERE PO_NBR = :PURCHS-PO-NBR                            40274400
402745         AND   VER_STATUS_CDE = 'A'                               40274500
402746     END-EXEC.                                                    40274600
402747                                                                  40274700
402748     EVALUATE SQLCODE                                             40274800
402749        WHEN 0                                                    40274900
402750             MOVE PURCHS-DEPT-NBR TO VNDAGR-DEPT-NBR              40275000
402751             MOVE PURCHS-ENT-ID   TO VNDAGR-ENT-ID                40275100
402752             EXEC SQL                                             40275200
402753                  SELECT TYP_CDE                                  40275300
402754                  INTO :VNDAGR-TYP-CDE                            40275400
402755                  FROM TVNDAGR                                    40275500
402756                  WHERE ENT_ID        = :VNDAGR-ENT-ID            40275600
402757                  AND DEPT_NBR        = :VNDAGR-DEPT-NBR          40275700
402758                  AND AGRMT_TYP_ID    = '4'                       40275800
402759                  AND TYP_CDE         IN (11,12)                  40275900
402760                  AND EFFECTIVE_DATE <= CURRENT DATE              40276000
402761                  AND EXPIRATION_DATE > CURRENT DATE              40276100
402762                  ORDER BY TYP_CDE                                40276200
402763                  FETCH FIRST 1 ROW ONLY                          40276300
402764             END-EXEC                                             40276400
402765                                                                  40276500
402766             EVALUATE SQLCODE                                     40276600
402767                WHEN 0                                            40276700
402768                     IF VNDAGR-TYP-CDE = 11                       40276800
402769                        SET PS-VENDOR-TAGGING     TO TRUE         40276900
402770                     ELSE                                         40277000
402771                        SET PS-VENDOR-COMPLIANT   TO TRUE         40277100
402772                     END-IF                                       40277200
402773                WHEN 100                                          40277300
402774                     SET PS-VENDOR-NOT-TAGGING    TO TRUE         40277400
402775                WHEN OTHER                                        40277500
402776                     DISPLAY DK-AUD-CNTL-NBR                      40277600
402777                     MOVE '3195-CHECK-VENDOR-TAGGING'             40277700
402778                                    TO  PV-PARAGRAPH-NAME         40277800
402779                     MOVE 'SELECT OF TVNDAGR'                     40277900
402780                                    TO PV-DB2-OPERATION-ATTEMPTED 40278000
402781                     MOVE SPACES    TO PV-DB2-FIELD-1             40278100
402782                                       PV-DB2-FIELD-2             40278200
402783                                       PV-DB2-FIELD-3             40278300
402784                     PERFORM 9999-SQL-ABEND                       40278400
402785             END-EVALUATE                                         40278500
402786                                                                  40278600
402787        WHEN 100                                                  40278700
402788             SET PS-VENDOR-NOT-TAGGING TO TRUE                    40278800
402789        WHEN OTHER                                                40278900
402790            DISPLAY DK-AUD-CNTL-NBR                               40279000
402791            MOVE '3195-CHECK-VENDOR-TAGGING'                      40279100
402792                                   TO  PV-PARAGRAPH-NAME          40279200
402793            MOVE 'SELECT OF TPURCHS'                              40279300
402794                                   TO PV-DB2-OPERATION-ATTEMPTED  40279400
402795            MOVE PURCHS-PO-NBR     TO PV-DISP-PO-NBR              40279500
402796            MOVE PV-DISP-PO-NBR                                   40279600
402797                                   TO PV-DB2-FIELD-1              40279700
402798            MOVE SPACES            TO PV-DB2-FIELD-2              40279800
402799                                      PV-DB2-FIELD-3              40279900
402800            PERFORM 9999-SQL-ABEND                                40280000
402801     END-EVALUATE.                                                40280100
402802                                                                  40280299
402803                                                                  40280399
402804 3200-CHECK-DEPT-TAGGING.                                         40280400
402805                                                                  40280500
402806     MOVE PURCHS-DEPT-NBR TO RIT00000-DEPT-NBR                    40280600
402807                                                                  40280700
402808     EXEC SQL                                                     40280800
402809          SELECT  'Y'                                             40280900
402810          INTO   :PS-DEPT-RFID-TAGGING-SW                         40281000
402811          FROM RIT_RFID_VRFN A                                    40281100
402812          WHERE RFID_LVL_CDE = 'STRDPT'                           40281200
402813            AND DEPT_NBR     = :RIT00000-DEPT-NBR                 40281300
402814            AND (CURRENT TIMESTAMP BETWEEN EFF_STRT_TMST          40281400
402815                AND EFF_END_TMST)                                 40281500
402816          FETCH FIRST ROW ONLY                                    40281600
402817     END-EXEC                                                     40281700
402818                                                                  40281800
402819     EVALUATE TRUE                                                40281900
402820         WHEN SQLCODE = +0                                        40282000
402821         WHEN SQLCODE = -811                                      40282100
402822             SET PS-DEPT-TAGGING TO TRUE                          40282200
402823         WHEN SQLCODE = +100                                      40282300
402824             SET PS-DEPT-NOT-TAGGING TO TRUE                      40282400
402825         WHEN OTHER                                               40282500
402826            DISPLAY DK-AUD-CNTL-NBR                               40282600
402827            MOVE '3200-CHECK-DEPT-TAGGING'                        40282700
402828                                   TO  PV-PARAGRAPH-NAME          40282800
402829            MOVE 'SELECT OF RIT_RFID_VRFN'                        40282900
402830                                   TO PV-DB2-OPERATION-ATTEMPTED  40283000
402831            MOVE PURCHS-PO-NBR     TO PV-DISP-PO-NBR              40283100
402832            MOVE PV-DISP-PO-NBR                                   40283200
402833                                   TO PV-DB2-FIELD-1              40283300
402834            MOVE SPACES            TO PV-DB2-FIELD-2              40283400
402835                                      PV-DB2-FIELD-3              40283500
402836            PERFORM 9999-SQL-ABEND                                40283600
402848     END-EVALUATE.                                                40284800
402849                                                                  40284999
402850                                                                  40285000
402851******************************************************************40285100
402852* 4000-OPEN-UID-CURSOR.                                          *40285200
402860*  THIS PROCEDURE WILL OPEN THE UID CURSOR.                       40286000
402900******************************************************************40290000
403000 4000-OPEN-UID-CURSOR.                                            40300000
403100                                                                  40310000
403200     EXEC SQL                                                     40320000
403300          OPEN UID_CURSOR                                         40330000
403400     END-EXEC.                                                    40340000
403500                                                                  40350000
403600     EVALUATE TRUE                                                40360000
403700         WHEN SQLCODE = ZERO                                      40370000
403800              SET PS-NOT-EOF-UID-CURSOR                           40380000
403900                               TO  TRUE                           40390000
404000         WHEN SQLWARN0 NOT EQUAL SPACE                            40400000
404100         WHEN SQLCODE NOT EQUAL ZERO                              40410000
404200              MOVE '4000-OPEN-UID-CURSOR'                         40420000
404300                               TO  PV-PARAGRAPH-NAME              40430000
404400              MOVE 'OPEN UID_CURSOR'                              40440000
404500                               TO  PV-DB2-OPERATION-ATTEMPTED     40450000
404600              MOVE DK-AUD-CNTL-NBR    TO PV-DISP-AUD-CNTL-NBR     40460000
404700              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           40470000
404800              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      40480000
404900              MOVE PV-DISP-AUD-CNTL-NBR                           40490000
405000                                      TO PV-DB2-FIELD-1           40500000
405100              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           40510000
405200              MOVE PV-DISP-REC-SEQ-NBR                            40520000
405300                                      TO PV-DB2-FIELD-3           40530000
405400              PERFORM 9999-SQL-ABEND                              40540000
405500     END-EVALUATE.                                                40550000
405600                                                                  40560099
405700******************************************************************40570000
405800* 4010-CLOSE-UID-CURSOR.                                         *40580000
405900*  THIS PROCEDURE WILL CLOSE THE UID_CURSOR.                      40590000
406000******************************************************************40600000
406100 4010-CLOSE-UID-CURSOR.                                           40610000
406200                                                                  40620000
406300     EXEC SQL                                                     40630000
406400         CLOSE UID_CURSOR                                         40640000
406500     END-EXEC.                                                    40650000
406600                                                                  40660000
406700     EVALUATE TRUE                                                40670000
406800         WHEN SQLWARN0 NOT EQUAL SPACE                            40680000
406900         WHEN SQLCODE NOT EQUAL ZERO                              40690000
407000              MOVE '4010-CLOSE-UID-CURSOR'                        40700000
407100                               TO  PV-PARAGRAPH-NAME              40710000
407200              MOVE 'CLOSE UID_CURSOR'                             40720000
407300                               TO  PV-DB2-OPERATION-ATTEMPTED     40730000
407400              MOVE DK-AUD-CNTL-NBR    TO PV-DISP-AUD-CNTL-NBR     40740000
407500              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           40750000
407600              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      40760000
407700              MOVE PV-DISP-AUD-CNTL-NBR                           40770000
407800                                      TO PV-DB2-FIELD-1           40780000
407900              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           40790000
408000              MOVE PV-DISP-REC-SEQ-NBR                            40800000
408100                                      TO PV-DB2-FIELD-3           40810000
408200              PERFORM 9999-SQL-ABEND                              40820000
408300     END-EVALUATE.                                                40830000
408400                                                                  40840000
408500                                                                  40850099
408600******************************************************************40860000
408700* 4020-FETCH-UID-CURSOR                                          *40870000
408800*  THIS PROCEDURE WILL FETCH THE UID-CURSOR.                      40880000
408900******************************************************************40890000
409000 4020-FETCH-UID-CURSOR.                                           40900000
409100                                                                  40910000
409200     EXEC SQL                                                     40920000
409300          FETCH UID_CURSOR                                        40930000
409400          INTO                                                    40940000
409500                 :SUNAUD-AUD-USR-ID                               40950000
409600     END-EXEC.                                                    40960000
409700                                                                  40970000
409800     EVALUATE TRUE                                                40980000
409900         WHEN SQLCODE = ZERO                                      40990000
410000              CONTINUE                                            41000000
410100                                                                  41010000
410200         WHEN SQLCODE = +100                                      41020000
410300              SET PS-EOF-UID-CURSOR                               41030000
410400                               TO  TRUE                           41040000
410500                                                                  41050000
410600         WHEN SQLWARN0 NOT EQUAL SPACE                            41060000
410700         WHEN SQLCODE NOT EQUAL ZERO                              41070000
410800              MOVE '4020-FETCH-UID-CURSOR'                        41080000
410900                               TO  PV-PARAGRAPH-NAME              41090000
411000              MOVE 'FETCH UID_CURSOR'                             41100000
411100                               TO  PV-DB2-OPERATION-ATTEMPTED     41110000
411200              MOVE DK-AUD-CNTL-NBR    TO PV-DISP-AUD-CNTL-NBR     41120000
411300              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           41130000
411400              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      41140000
411500              MOVE PV-DISP-AUD-CNTL-NBR                           41150000
411600                                      TO PV-DB2-FIELD-1           41160000
411700              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           41170000
411800              MOVE PV-DISP-REC-SEQ-NBR                            41180000
411900                                      TO PV-DB2-FIELD-3           41190000
412000              PERFORM 9999-SQL-ABEND                              41200000
412100     END-EVALUATE.                                                41210000
412200                                                                  41220000
412300                                                                  41230000
412400******************************************************************41240000
412500* 4100-OPEN-AUD-STR-CURSOR.                                      *41250000
412600*  THIS PROCEDURE WILL OPEN THE AUDITED STORE CURSOR              41260000
412700******************************************************************41270000
412800 4100-OPEN-AUD-STR-CURSOR.                                        41280000
412900                                                                  41290000
413000     EXEC SQL                                                     41300000
413100          OPEN AUD_STR_CURSOR                                     41310000
413200     END-EXEC.                                                    41320000
413300                                                                  41330000
413400     EVALUATE TRUE                                                41340000
413500         WHEN SQLCODE = ZERO                                      41350000
413600              SET PS-NOT-EOF-AUD-STR-CURSOR                       41360000
413700                               TO  TRUE                           41370000
413800         WHEN SQLWARN0 NOT EQUAL SPACE                            41380000
413900         WHEN SQLCODE NOT EQUAL ZERO                              41390000
414000              MOVE '4100-OPEN-AUD-STR-CURSOR'                     41400000
414100                               TO  PV-PARAGRAPH-NAME              41410000
414200              MOVE 'OPEN AUD_STR_CURSOR'                          41420000
414300                               TO  PV-DB2-OPERATION-ATTEMPTED     41430000
414400              MOVE DK-AUD-CNTL-NBR    TO PV-DISP-AUD-CNTL-NBR     41440000
414500              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           41450000
414600              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      41460000
414700              MOVE PV-DISP-AUD-CNTL-NBR                           41470000
414800                                      TO PV-DB2-FIELD-1           41480000
414900              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           41490000
415000              MOVE PV-DISP-REC-SEQ-NBR                            41500000
415100                                      TO PV-DB2-FIELD-3           41510000
415200              PERFORM 9999-SQL-ABEND                              41520000
415300     END-EVALUATE.                                                41530000
415400                                                                  41540099
415500******************************************************************41550000
415600* 4110-CLOSE-AUD-STR-CURSOR.                                     *41560000
415700*  THIS PROCEDURE WILL CLOSE THE AUD-STR_CURSOR.                  41570000
415800******************************************************************41580000
415900 4110-CLOSE-AUD-STR-CURSOR.                                       41590000
416000                                                                  41600000
416100     EXEC SQL                                                     41610000
416200         CLOSE AUD_STR_CURSOR                                     41620000
416300     END-EXEC.                                                    41630000
416400                                                                  41640000
416500     EVALUATE TRUE                                                41650000
416600         WHEN SQLWARN0 NOT EQUAL SPACE                            41660000
416700         WHEN SQLCODE NOT EQUAL ZERO                              41670000
416800              MOVE '4110-CLOSE-AUD-STR-CURSOR'                    41680000
416900                               TO  PV-PARAGRAPH-NAME              41690000
417000              MOVE 'CLOSE AUD_STR_CURSOR'                         41700000
417100                               TO  PV-DB2-OPERATION-ATTEMPTED     41710000
417200              MOVE DK-AUD-CNTL-NBR    TO PV-DISP-AUD-CNTL-NBR     41720000
417300              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           41730000
417400              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      41740000
417500              MOVE PV-DISP-AUD-CNTL-NBR                           41750000
417600                                      TO PV-DB2-FIELD-1           41760000
417700              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           41770000
417800              MOVE PV-DISP-REC-SEQ-NBR                            41780000
417900                                      TO PV-DB2-FIELD-3           41790000
418000              PERFORM 9999-SQL-ABEND                              41800000
418100     END-EVALUATE.                                                41810000
418200                                                                  41820000
418300                                                                  41830099
418400******************************************************************41840000
418500* 4120-FETCH-AUD-STR-CURSOR                                      *41850000
418600*  THIS PROCEDURE WILL FETCH THE AUD-STR-CURSOR.                  41860000
418700******************************************************************41870000
418800 4120-FETCH-AUD-STR-CURSOR.                                       41880000
418900                                                                  41890000
419000     EXEC SQL                                                     41900000
419100          FETCH AUD_STR_CURSOR                                    41910000
419200          INTO                                                    41920000
419300                 :SUATRN-DEST-OPER-UNT-ID                         41930000
419400     END-EXEC.                                                    41940000
419500                                                                  41950000
419600     EVALUATE TRUE                                                41960000
419700         WHEN SQLCODE = ZERO                                      41970000
419800              CONTINUE                                            41980000
419900                                                                  41990000
420000         WHEN SQLCODE = +100                                      42000000
420100              SET PS-EOF-AUD-STR-CURSOR                           42010000
420200                               TO  TRUE                           42020000
420300                                                                  42030000
420400         WHEN SQLWARN0 NOT EQUAL SPACE                            42040000
420500         WHEN SQLCODE NOT EQUAL ZERO                              42050000
420600              MOVE '4020-FETCH-AUD-STR-CURSOR'                    42060000
420700                               TO  PV-PARAGRAPH-NAME              42070000
420800              MOVE 'FETCH AUD-STR_CURSOR'                         42080000
420900                               TO  PV-DB2-OPERATION-ATTEMPTED     42090000
421000              MOVE DK-AUD-CNTL-NBR    TO PV-DISP-AUD-CNTL-NBR     42100000
421100              MOVE DK-PO-NBR          TO PV-DISP-PO-NBR           42110000
421200              MOVE DK-REC-SEQ-NBR     TO PV-DISP-REC-SEQ-NBR      42120000
421300              MOVE PV-DISP-AUD-CNTL-NBR                           42130000
421400                                      TO PV-DB2-FIELD-1           42140000
421500              MOVE PV-DISP-PO-NBR     TO PV-DB2-FIELD-2           42150000
421600              MOVE PV-DISP-REC-SEQ-NBR                            42160000
421700                                      TO PV-DB2-FIELD-3           42170000
421800              PERFORM 9999-SQL-ABEND                              42180000
421900     END-EVALUATE.                                                42190000
422000                                                                  42200000
422100                                                                  42210099
422200******************************************************************42220000
422300* 8001-READ-EXTRACT-FILE - READS THE NEXT RECORD FROM THE AUDIT   42230000
422400* SUMMARY EXTRACT FILE.                                           42240000
422500******************************************************************42250000
422600 8001-READ-EXTRACT-FILE.                                          42260000
422700                                                                  42270000
422800     READ AS-AUDIT-SUM-EXTRACT-FILE                               42280000
422900         INTO SU005-EXTRACT-RECORD                                42290000
423000     AT END                                                       42300000
423100         SET PS-EOF-AUDIT-SUM-EXTRACT  TO TRUE                    42310000
423200     END-READ.                                                    42320000
423300                                                                  42330099
423400                                                                  42340000
423500******************************************************************42350000
423600* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  42360000
423700* CURSOR AND THE REPORT FILE.                                     42370000
423800******************************************************************42380000
423900 9000-EOJ-ROUTINE.                                                42390000
424000                                                                  42400000
424100     IF PS-DATA                                                   42410000
424110                                                                  42411099
424120         IF  CC-FLAT-FILE                                         42412099
424130             MOVE SPACES  TO  AS-AUDIT-SUM-REPORT-LINE-FLAT       42413099
424140             WRITE AS-AUDIT-SUM-REPORT-LINE-FLAT                  42414099
424150              FROM END-OF-REPORT-LINE                             42415099
424151                                                                  42415199
424152             MOVE 4051 TO RETURN-CODE                             42415299
424160         ELSE                                                     42416099
424200             WRITE AS-AUDIT-SUM-REPORT-LINE                       42420099
424300              FROM END-OF-REPORT-LINE                             42430099
424400             AFTER ADVANCING 1 LINES                              42440000
424500             WRITE AS-AUDIT-SUM-REPORT-LINE-LOG                   42450099
424600              FROM END-OF-REPORT-LINE                             42460099
424700             AFTER ADVANCING 1 LINES                              42470000
424710         END-IF                                                   42471099
424800                                                                  42480000
424900*        IF THIS IS A PRINTEK PRINTER, CUT THE PAPER              42490000
425000*        DONT PRINT LOGISTICS COPY -- ASSUME IT IS NOT A PRINTEK  42500000
425100                                                                  42510099
425200         IF CC-PRTR-CUT-IND = 'Y'                                 42520000
425300             WRITE AS-AUDIT-SUM-REPORT-LINE                       42530000
425400                 FROM DS004-PLC-CUT-FORM                          42540000
425500             AFTER ADVANCING 1 LINE                               42550000
425600         END-IF                                                   42560000
425700     END-IF.                                                      42570000
425800                                                                  42580000
425810     DISPLAY 'SUKRP009 - END  '.                                  42581099
425820     DISPLAY ' '.                                                 42582099
425900     CLOSE  AS-AUDIT-SUM-EXTRACT-FILE                             42590000
426000            AS-AUDIT-SUM-REPORT-FILE                              42600000
426100            AS-AUDIT-SUM-REPORT-FILE-LOG.                         42610000
426200                                                                  42620000
426400******************************************************************42640000
426500* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *42650000
426600* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *42660000
426700* WILL ABEND THE PROGRAM                                         *42670000
426800******************************************************************42680000
426900 9100-FIELD-OVERFLOW-ERROR.                                       42690000
427000     DISPLAY '** ABEND     **'.                                   42700000
427100     DISPLAY '** PROGRAM   ** = SUKRP009'.                        42710000
427200     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          42720000
427300     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   42730000
427400     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   42740000
427500     DISPLAY '** THE FOLLOWING FIELD WAS TOO SMALL: '.            42750000
427600     DISPLAY PV-FIELD-NAME.                                       42760000
427700                                                                  42770000
427800     MOVE +4004 TO ABEND-CODE.                                    42780000
427900     CALL 'ILBOABN0' USING ABEND-CODE.                            42790000
428000                                                                  42800000
428100******************************************************************42810000
428200* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE *    42820000
428300* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS. *               42830000
428400******************************************************************42840000
428500 9999-SQL-ABEND.                                                  42850000
428600                                                                  42860099
428700*  DATA CONTENTION CHANGES START                                  42870099
428800     IF SQLCODE                  = -904 OR -911 OR -913           42880000
428900        MOVE +4050               TO RETURN-CODE                   42890000
429000        STOP RUN                                                  42900000
429100     ELSE                                                         42910000
429200        PERFORM 9998-ABEND-PROGRAM                                42920000
429300     END-IF.                                                      42930000
429400                                                                  42940099
429600                                                                  42960099
429700*  DATA CONTENTION CHANGES END                                    42970099
429800 9998-ABEND-PROGRAM.                                              42980000
429900     DISPLAY '** ABEND      **'.                                  42990000
430000     DISPLAY '** PROGRAM    ** = SUKRP009'.                       43000000
430100     DISPLAY '** PARAGRAPH  ** = ' PV-PARAGRAPH-NAME.             43010000
430200     DISPLAY '** OPERATION  ** = ' PV-DB2-OPERATION-ATTEMPTED.    43020000
430300     DISPLAY '** FIELD 1    ** = ' PV-DB2-FIELD-1.                43030000
430400     DISPLAY '** FIELD 2    ** = ' PV-DB2-FIELD-2.                43040000
430500     DISPLAY '** FIELD 3    ** = ' PV-DB2-FIELD-3.                43050000
430600                                                                  43060000
430700******************************************************************43070000
430800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *43080000
430900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *43090000
431000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *43100000
431100* FORMAT.                                                        *43110000
431200******************************************************************43120000
431300     COPY DPPD004.                                                43130000
431400                                                                  43140000
431500     MOVE +4013 TO ABEND-CODE.                                    43150000
431600     CALL 'ILBOABN0' USING ABEND-CODE.                            43160000
