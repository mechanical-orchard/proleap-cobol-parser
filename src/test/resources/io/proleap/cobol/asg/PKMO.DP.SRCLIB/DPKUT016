000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      DPKUT016.                                       00040000
000500 AUTHOR.          D.MEDORA, CAP GEMINI AMERICA.                   00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    AUGUST 18, 1988.                                00070000
000800 DATE-COMPILED.                                                   00080000
000900*                                                                 00090000
001000*             THIS PROGRAM USES THE OUTPUT FROM UTILITY IEBPTPCH, 00100000
001100*             THAT CONTAINS THE PKMO.JOBLIB DATA.  THE PROGRAM    00110000
001200*             WILL SEARCH FOR JOB AND EXEC JCL STATEMENTS AND     00120000
001300*             CREATE THE JOBNAME/PROCNAME ASSOCIATION TABLE TO BE 00130000
001400*             USED TO LOAD THE DBII TABLE.                        00140000
001500*                                                                 00150000
001600*************************                                         00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800*************************                                         00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER. IBM-3090.                                       00200000
002100 OBJECT-COMPUTER. IBM-3090.                                       00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT JOBLIB-IEBPTPCH-FILE       ASSIGN TO INP01.           00250000
002600     SELECT JOBNAME-PROCNAME-FILE      ASSIGN TO OUT01.           00260000
002700                                                                  00270000
002800***************                                                   00280000
002900 DATA DIVISION.                                                   00290000
003000***************                                                   00300000
003100 FILE SECTION.                                                    00310000
003200 FD  JOBLIB-IEBPTPCH-FILE                                         00320000
003300                         BLOCK CONTAINS 0 RECORDS                 00330000
003400                         RECORD CONTAINS 31 CHARACTERS            00340003
003500                         LABEL RECORDS ARE STANDARD               00350000
003600                         RECORDING MODE F                         00360000
003700                         DATA RECORD IS JOBLIB-IEBPTPCH-RECORD.   00370000
003800 01  JOBLIB-IEBPTPCH-RECORD      PIC X(31).                       00380003
003900                                                                  00390000
004000 FD  JOBNAME-PROCNAME-FILE                                        00400000
004100                         BLOCK CONTAINS 0 RECORDS                 00410000
004200                         RECORD CONTAINS 16 CHARACTERS            00420000
004300                         LABEL RECORDS ARE STANDARD               00430000
004400                         RECORDING MODE F                         00440000
004500                         DATA RECORD IS JOBNAME-PROCNAME-RECORD.  00450000
004600 01  JOBNAME-PROCNAME-RECORD     PIC X(16).                       00460003
004700                                                                  00470000
004800 WORKING-STORAGE SECTION.                                         00480000
004900                                                                  00490000
005000**   JOBLIB-IEBPTPCH-FILE LAYOUT (INPUT)    **                    00500000
005100                                                                  00510000
005200 01  JI-JOBLIB-IEBPTPCH-RECORD.                                   00520001
005300     05  JI-IEBPTPCH-MACHINE-CHAR                                 00530003
005400                                 PIC X(1)       VALUE SPACES.     00540003
005500     05  JI-JOBLIB-LINE          PIC X(30)      VALUE SPACES.     00550003
005600     05  FILLER                  REDEFINES JI-JOBLIB-LINE.        00560003
005700         10  FILLER              PIC X(11).                       00570003
005800             88  JI-IEBPTPCH-MEMBER-NAME-LIT    VALUE             00580003
005900                 'MEMBER NAME'.                                   00590003
006000         10  FILLER              PIC X(2).                        00600003
006100         10  JI-JOBNAME          PIC X(8).                        00610003
006200         10  FILLER              PIC X(9).                        00620003
006300     05  FILLER                  REDEFINES JI-JOBLIB-LINE.        00630003
006400         10  JI-DELIMITER        PIC X(2).                        00640012
006500             88  JI-JCL                         VALUE '//'.       00650001
006600             88  JI-JES2-OR-EOF-INSTREAM        VALUE '/*'.       00660004
006700         10  FILLER              PIC X(28).                       00670000
006800     05  FILLER                  REDEFINES JI-JOBLIB-LINE.        00680003
006900         10  FILLER              PIC X(3).                        00690003
007000             88  JI-COMMENT                     VALUE '//*'.      00700001
007100             88  JI-CONTINUATION                VALUE '// '.      00710003
007200         10  FILLER              PIC X(27).                       00720000
007210     05  FILLER                  REDEFINES JI-JOBLIB-LINE.        00721014
007220         10  FILLER              PIC X(9).                        00722014
007230             88  JI-ESP-INCLUDE-STMT            VALUE '%INCLUDE '.00723014
007240             88  JI-ESP-END-INCLUDE-STMT        VALUE '%ENDINCL '.00724014
007241             88  JI-ESP-EXCLUDE-STMT            VALUE '%EXCLUDE '.00724114
007242             88  JI-ESP-END-EXCLUDE-STMT        VALUE '%ENDEXCL '.00724214
007243         10  FILLER              PIC X(21).                       00724318
007250                                                                  00725014
007400**   JOBNAME-PROCNAME-FILE LAYOUT (OUTPUT)  **                    00740000
007500                                                                  00750000
007600 01  JP-JOBNAME-PROCNAME-RECORD.                                  00760001
007700     05  JP-JOBNAME              PIC X(8)       VALUE SPACES.     00770001
007800     05  JP-PROCNAME             PIC X(8)       VALUE SPACES.     00780001
007900                                                                  00790000
008000 01  ABEND-CODE                  PIC S9(4)      VALUE ZEROS       00800003
008100                                                COMP SYNC.        00810003
008200     88  AC-TABLE-OVERFLOW-ERROR                VALUE +4004.      00820007
008300     88  AC-FILE-SEQUENCE-ERROR                 VALUE +4007.      00830007
008400                                                                  00840000
008500 01  PS-PROGRAM-SWITCHES.                                         00850003
008600     05  PS-EOF-JOBLIB           PIC X(1)       VALUE 'N'.        00860001
008700         88  EOF-JOBLIB                         VALUE 'Y'.        00870001
009100     05  PS-JOB-CARD-FOUND-IND   PIC X(1)       VALUE 'N'.        00910003
009200         88  PS-JOB-CARD-FOUND                  VALUE 'Y'.        00920003
009300         88  PS-NO-JOB-CARD-FOUND               VALUE 'N'.        00930003
009400     05  PS-INSTREAM-DD-IND      PIC X(1)       VALUE 'N'.        00940004
009500         88  PS-INSTREAM-DD                     VALUE 'Y'.        00950004
009600         88  PS-NO-INSTREAM-DD                  VALUE 'N'.        00960004
009610     05  PS-DATA-INSTREAM-DD-IND PIC X(1)       VALUE 'N'.        00961012
009620         88  PS-DATA-INSTREAM-DD                VALUE 'Y'.        00962012
009630         88  PS-NO-DATA-INSTREAM-DD             VALUE 'N'.        00963012
009700                                                                  00970000
009800 01  PC-PROGRAM-CONSTANTS.                                        00980003
009900     05  PC-CURRENT-PROGRAM-NAME PIC X(8)       VALUE 'DPKUT016'. 00990003
010000     05  PC-MAXIMUM-PROCNAME-ENTRIES                              01000003
010100                                 PIC S9(4)      VALUE +100        01010011
010200                                                COMP SYNC.        01020003
010210     05  PC-ESP-SYMBOLIC-CHARACTER                                01021014
010220                                 PIC X(1)       VALUE '%'.        01022014
010230     05  PC-STANDARD-INSTREAM-DD-CHAR                             01023014
010240                                 PIC X(1)       VALUE '*'.        01024014
010300                                                                  01030000
010400 01  PV-PROGRAM-VARIABLES.                                        01040003
010500     05  PV-IEBPTPCH-JOBNAME     PIC X(8)       VALUE SPACES.     01050003
010600     05  PV-JOB-CARD-JOBNAME     PIC X(8)       VALUE SPACES.     01060003
010610     05  PV-DATA-DLM             PIC X(2)       VALUE SPACES.     01061012
010620         88  PV-DEFAULT-DLM                     VALUE '/*'.       01062012
010650     05  PV-BASE-JOBNAME         PIC X(8)       VALUE SPACES.     01065014
010700     05  PV-UNSTRUNG-JOB-LINE.                                    01070003
010800         10  PV-UJ-LABEL.                                         01080003
010900             15  FILLER          PIC X(2).                        01090003
011000             15  PV-UJ-JOBNAME   PIC X(8).                        01100003
011100         10  PV-UJ-COMMAND       PIC X(4).                        01110003
011200             88  PV-UJ-JOB                      VALUE 'JOB '.     01120003
011300             88  PV-UJ-EXEC                     VALUE 'EXEC'.     01130003
011400             88  PV-UJ-DD                       VALUE 'DD  '.     01140003
011500         10  PV-UJ-PARMS         PIC X(16).                       01150003
011510             88  PV-UJ-INSTREAM-DD              VALUE '*'.        01151010
011520         10  FILLER              REDEFINES PV-UJ-PARMS.           01152013
011521             15  FILLER          PIC X(9).                        01152112
011530                 88  PV-UJ-DATA-INSTREAM-DD     VALUE 'DATA,DLM='.01153012
011531             15  PV-UJ-DATA-DLM-AREA                              01153121
011532                                 PIC X(4).                        01153221
011533             15  FILLER          REDEFINES PV-UJ-DATA-DLM-AREA.   01153321
011540                 20  FILLER      PIC X(1).                        01154021
011550                     88  PV-UJ-DATA-DLM-QUOTE-1 VALUE QUOTE.      01155021
011560                 20  PV-UJ-DATA-DLM-W-QUOTES                      01156021
011570                                 PIC X(2).                        01157021
011580                 20  FILLER      PIC X(1).                        01158021
011590                     88  PV-UJ-DATA-DLM-QUOTE-2 VALUE QUOTE.      01159021
011591             15  FILLER          REDEFINES PV-UJ-DATA-DLM-AREA.   01159121
011594                 20  PV-UJ-DATA-DLM-W-O-QUOTES                    01159421
011595                                 PIC X(2).                        01159521
011596                 20  FILLER      PIC X(1).                        01159621
011597                     88  PV-UJ-VALID-END-OF-DLM VALUES ' ', ','.  01159721
011598                 20  FILLER      PIC X(1).                        01159821
011599             15  FILLER          PIC X(3).                        01159922
011600     05  PV-UNSTRUNG-PARMS       PIC X(13).                       01160025
011601     05  FILLER                  REDEFINES PV-UNSTRUNG-PARMS.     01160125
011602         10  FILLER              PIC X(4).                        01160225
011603             88  PV-UP-PROGRAM-EXEC             VALUE 'PGM='.     01160325
011604         10  FILLER              PIC X(9).                        01160425
011610     05  FILLER                  REDEFINES PV-UNSTRUNG-PARMS.     01161025
011710         10  PV-UP-IMPLICIT-PROCNAME                              01171025
011720                                 PIC X(8).                        01172025
011800         10  FILLER              PIC X(5).                        01180025
011900     05  FILLER                  REDEFINES PV-UNSTRUNG-PARMS.     01190025
012100         10  FILLER              PIC X(5).                        01210025
012200             88  PV-UP-EXPLICIT-PROC-EXEC       VALUE 'PROC='.    01220025
012300         10  PV-UP-EXPLICIT-PROCNAME                              01230025
012310                                 PIC X(8).                        01231025
012320     05  PV-CURRENT-PROCNAME     PIC X(8).                        01232025
012400                                                                  01240000
012500 01  TP-TABLE-PROCNAME.                                           01250001
012600     05  TP-PROCNAME-ENTRY       OCCURS 100 TIMES                 01260001
012700                                 INDEXED BY TP-PROC-INDEX         01270001
012800                                 PIC X(8).                        01280001
012900                                                                  01290001
013000********************                                              01300000
013100 PROCEDURE DIVISION.                                              01310000
013200********************                                              01320000
013300                                                                  01330000
013400     OPEN INPUT  JOBLIB-IEBPTPCH-FILE                             01340000
013500          OUTPUT JOBNAME-PROCNAME-FILE.                           01350000
013600                                                                  01360000
013700     PERFORM 9100-READ-JOBLIB-IEBPTPCH-FILE.                      01370000
013800                                                                  01380000
013900     PERFORM 1000-PROCESS-JOBLIB-FILE                             01390001
014000         UNTIL EOF-JOBLIB.                                        01400003
014100                                                                  01410000
014200     PERFORM 8000-BUILD-JOBNAME-PROCNAME                          01420001
014300         VARYING TP-PROC-INDEX FROM 1 BY 1                        01430005
014400         UNTIL TP-PROCNAME-ENTRY (TP-PROC-INDEX) = SPACES         01440001
014500                                                                  01450000
014600     CLOSE       JOBLIB-IEBPTPCH-FILE                             01460000
014700                 JOBNAME-PROCNAME-FILE.                           01470000
014800                                                                  01480000
014900     GOBACK.                                                      01490000
015000                                                                  01500000
015100 1000-PROCESS-JOBLIB-FILE.                                        01510000
015200                                                                  01520000
015300     IF (NOT JI-IEBPTPCH-MEMBER-NAME-LIT)                         01530007
015400         DISPLAY '** ABEND **'                                    01540007
015500         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - IEBPTPCH FILE IS '  01550007
015600                   'OUT OF SEQUENCE'                              01560007
015700         SET AC-FILE-SEQUENCE-ERROR TO TRUE                       01570007
015800         CALL 'ILBOABN0' USING ABEND-CODE                         01580007
015900     END-IF.                                                      01590007
016000                                                                  01600007
016100     MOVE JI-JOBNAME       TO PV-IEBPTPCH-JOBNAME.                01610007
016200     MOVE SPACES           TO PV-UNSTRUNG-JOB-LINE                01620007
016300                              PV-UNSTRUNG-PARMS                   01630007
016400                              TP-TABLE-PROCNAME.                  01640007
016500     SET PS-NO-JOB-CARD-FOUND                                     01650007
016600         PS-NO-INSTREAM-DD                                        01660012
016610         PS-NO-DATA-INSTREAM-DD TO TRUE.                          01661012
016611                                                                  01661114
016620     SET PV-DEFAULT-DLM TO TRUE.                                  01662014
016700                                                                  01670007
016800     PERFORM 9100-READ-JOBLIB-IEBPTPCH-FILE.                      01680007
016900                                                                  01690007
017000     PERFORM                                                      01700007
017100             UNTIL ((EOF-JOBLIB)                                  01710007
017200                     OR (JI-IEBPTPCH-MEMBER-NAME-LIT))            01720007
017300         EVALUATE TRUE                                            01730007
017403             WHEN ((PS-DATA-INSTREAM-DD)                          01740316
017404                     AND (NOT PV-DEFAULT-DLM))                    01740416
017405                 IF JI-DELIMITER = PV-DATA-DLM                    01740516
017406                     SET PS-NO-DATA-INSTREAM-DD                   01740616
017407                         PV-DEFAULT-DLM TO TRUE                   01740716
017408                 END-IF                                           01740816
017409*                                                                 01740916
017410*  DEFAULT INSTREAM DD DELIMITERS CAN BE MISSING, AND THE DATA    01741016
017411*  STREAM TERMINATED BY THE NEXT STATEMENT.  THE OTHER CHECK FOR  01741116
017412*  EOF OF INSTREAM REMAINS AS A CATCH-ALL FOR INVALID JCL.        01741216
017413*                                                                 01741316
017414             WHEN ((PS-DATA-INSTREAM-DD)                          01741416
017415                     AND (JI-DELIMITER = PV-DATA-DLM))            01741516
017416                 SET PS-NO-DATA-INSTREAM-DD                       01741616
017417                     PV-DEFAULT-DLM TO TRUE                       01741716
017418             WHEN ((PS-INSTREAM-DD)                               01741817
017419                     AND (JI-DELIMITER = PV-DATA-DLM))            01741917
017420                 SET PS-NO-INSTREAM-DD                            01742017
017421                     PV-DEFAULT-DLM TO TRUE                       01742117
017430             WHEN JI-COMMENT                                      01743016
017600             WHEN JI-JES2-OR-EOF-INSTREAM                         01760007
017700                 SET PS-NO-INSTREAM-DD TO TRUE                    01770007
017701*                                                                 01770115
017702*  "CONTINUATION" LINES MUST BE EVALUATED, SINCE IT CAN BE        01770215
017703*  A NEW DD IN A CONCATENATION, AND IT CAN BE AN INSTREAM DD.     01770315
017704*                                                                 01770415
017710             WHEN JI-CONTINUATION                                 01771015
017800             WHEN JI-JCL                                          01780007
017810                 SET PS-NO-INSTREAM-DD TO TRUE                    01781016
017900                 PERFORM 1100-UNSTRING-JOBLIB-LINE                01790007
018000             WHEN PS-DATA-INSTREAM-DD                             01800017
018010             WHEN PS-INSTREAM-DD                                  01801017
018100                 CONTINUE                                         01810007
018110             WHEN JI-ESP-INCLUDE-STMT                             01811014
018120             WHEN JI-ESP-END-INCLUDE-STMT                         01812014
018130             WHEN JI-ESP-EXCLUDE-STMT                             01813014
018140             WHEN JI-ESP-END-EXCLUDE-STMT                         01814014
018150                 CONTINUE                                         01815014
018200             WHEN OTHER                                           01820007
018300                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID JCL'01830016
018400                           ' LINE FOUND IN JOB '                  01840016
018500                           PV-IEBPTPCH-JOBNAME  ' - ('            01850016
018510                           JI-JOBLIB-LINE  ')'                    01851016
018600         END-EVALUATE                                             01860007
018700         PERFORM 9100-READ-JOBLIB-IEBPTPCH-FILE                   01870007
018800     END-PERFORM.                                                 01880007
018900                                                                  01890007
019000     PERFORM 8000-BUILD-JOBNAME-PROCNAME                          01900007
019100         VARYING TP-PROC-INDEX FROM 1 BY 1                        01910007
019200         UNTIL ((TP-PROC-INDEX > PC-MAXIMUM-PROCNAME-ENTRIES)     01920007
019300                OR (TP-PROCNAME-ENTRY (TP-PROC-INDEX) = SPACES)). 01930007
019400*1000-EXIT.                                                       01940001
019500                                                                  01950007
019600 1100-UNSTRING-JOBLIB-LINE.                                       01960007
019700                                                                  01970000
019800     UNSTRING JI-JOBLIB-LINE                                      01980001
019900       DELIMITED BY ALL SPACES                                    01990000
020000       INTO PV-UJ-LABEL                                           02000003
020100            PV-UJ-COMMAND                                         02010003
020200            PV-UJ-PARMS                                           02020003
020300     END-UNSTRING.                                                02030000
020400                                                                  02040000
020500     IF PV-UJ-JOB                                                 02050003
020600         SET PS-NO-INSTREAM-DD TO TRUE                            02060004
020700         IF PS-JOB-CARD-FOUND                                     02070003
020800             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - TWO JOB CARDS ' 02080003
020900                       'FOUND IN ONE JOB, BROWSE MEMBER '         02090003
021000                       PV-IEBPTPCH-JOBNAME                        02100003
021100         ELSE                                                     02110000
021200             SET PS-JOB-CARD-FOUND TO TRUE                        02120003
021300             IF PV-UJ-JOBNAME = PV-IEBPTPCH-JOBNAME               02130003
021400                 MOVE PV-UJ-JOBNAME TO PV-JOB-CARD-JOBNAME        02140003
021410                                       PV-BASE-JOBNAME            02141014
021500             ELSE                                                 02150000
021510                 UNSTRING PV-UJ-JOBNAME                           02151014
021520                     DELIMITED BY PC-ESP-SYMBOLIC-CHARACTER       02152014
021530                     INTO PV-BASE-JOBNAME                         02153014
021550                 IF PV-BASE-JOBNAME = PV-IEBPTPCH-JOBNAME         02155014
021560                     MOVE PV-BASE-JOBNAME TO PV-JOB-CARD-JOBNAME  02156014
021570                 ELSE                                             02157014
021600                     MOVE PV-IEBPTPCH-JOBNAME TO                  02160014
021610                               PV-JOB-CARD-JOBNAME                02161014
021700                     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - JOB '   02170014
021800                           'NAME DOES NOT MATCH THE JOB CARD JOB '02180014
021900                           'NAME.  MBR='  PV-IEBPTPCH-JOBNAME     02190014
022000                           '  JOB CARD='  PV-UJ-JOBNAME           02200014
022100                           '  BASE NAME='  PV-BASE-JOBNAME        02210014
022200             END-IF                                               02220000
022300         END-IF                                                   02230000
022400     END-IF.                                                      02240000
022500                                                                  02250000
022600     IF PV-UJ-EXEC                                                02260003
022700         SET PS-NO-INSTREAM-DD TO TRUE                            02270004
022800         UNSTRING PV-UJ-PARMS                                     02280003
022900             DELIMITED BY ALL SPACES OR ','                       02290003
023000             INTO PV-UNSTRUNG-PARMS                               02300003
023100         END-UNSTRING                                             02310000
023101         EVALUATE TRUE                                            02310125
023102             WHEN PV-UP-PROGRAM-EXEC                              02310225
023103                 INITIALIZE PV-CURRENT-PROCNAME                   02310325
023104             WHEN PV-UP-EXPLICIT-PROC-EXEC                        02310425
023105                 MOVE PV-UP-EXPLICIT-PROCNAME TO                  02310525
023106                           PV-CURRENT-PROCNAME                    02310625
023107                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '           02310726
023108                           'EXPLICIT PROC= FOR PROC '             02310826
023109                           PV-CURRENT-PROCNAME                    02310926
023110                           ' FOUND IN JOB '  PV-IEBPTPCH-JOBNAME  02311026
023112             WHEN OTHER                                           02311225
023113                 MOVE PV-UP-IMPLICIT-PROCNAME TO                  02311325
023114                           PV-CURRENT-PROCNAME                    02311425
023115         END-EVALUATE                                             02311525
023116                                                                  02311625
023120*  IDENTIFY ANY PROCS THAT ARE NOT TO BE EXPANDED AS A PART OF    02312014
023130*  THIS IF CONDITION.  THERE ARE NO LONGER ANY THAT QUALIFY.      02313014
023140*                                                                 02314014
023300         IF (NOT PV-UP-PROGRAM-EXEC)                              02330014
023400             PERFORM                                              02340007
023500                     VARYING TP-PROC-INDEX FROM 1 BY 1            02350007
023600                     UNTIL ((TP-PROC-INDEX >                      02360007
023700                               PC-MAXIMUM-PROCNAME-ENTRIES)       02370007
023800                         OR (PV-CURRENT-PROCNAME =                02380025
023900                               TP-PROCNAME-ENTRY (TP-PROC-INDEX)) 02390007
024000                         OR (TP-PROCNAME-ENTRY (TP-PROC-INDEX) =  02400007
024100                               SPACES))                           02410007
024200             END-PERFORM                                          02420007
024300             IF TP-PROC-INDEX > PC-MAXIMUM-PROCNAME-ENTRIES       02430007
024400                 DISPLAY '** ABEND **'                            02440007
024500                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM '   02450007
024600                           'NUMBER OF PROC ENTRIES EXCEEDED'      02460007
024700                 SET AC-TABLE-OVERFLOW-ERROR TO TRUE              02470007
024800                 CALL 'ILBOABN0' USING ABEND-CODE                 02480007
024900             ELSE                                                 02490007
025000                 IF TP-PROCNAME-ENTRY (TP-PROC-INDEX) = SPACES    02500007
025100                     MOVE PV-CURRENT-PROCNAME TO                  02510025
025200                               TP-PROCNAME-ENTRY (TP-PROC-INDEX)  02520007
025210                     IF PS-NO-JOB-CARD-FOUND                      02521009
025211                         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '   02521109
025212                                   'EXEC OF PROC '                02521225
025213                                   PV-CURRENT-PROCNAME            02521325
025214                                   ' FOUND BEFORE JOB CARD IN '   02521409
025215                                   PV-IEBPTPCH-JOBNAME            02521509
025220                     END-IF                                       02522009
025300                 END-IF                                           02530007
025400             END-IF                                               02540007
025500         END-IF                                                   02550007
025600     END-IF.                                                      02560003
025700                                                                  02570004
025710     EVALUATE TRUE                                                02571012
025720         WHEN (NOT PV-UJ-DD)                                      02572012
025730             CONTINUE                                             02573012
025740         WHEN PV-UJ-INSTREAM-DD                                   02574012
025900             SET PS-INSTREAM-DD TO TRUE                           02590012
025910         WHEN PV-UJ-DATA-INSTREAM-DD                              02591021
025911             EVALUATE TRUE                                        02591121
025920                 WHEN ((PV-UJ-DATA-DLM-QUOTE-1)                   02592021
025921                         AND (PV-UJ-DATA-DLM-QUOTE-2))            02592121
025922                     SET PS-DATA-INSTREAM-DD TO TRUE              02592221
025923                     MOVE PV-UJ-DATA-DLM-W-QUOTES TO PV-DATA-DLM  02592322
025924                 WHEN ((NOT PV-UJ-DATA-DLM-QUOTE-1)               02592421
025925                         AND (PV-UJ-VALID-END-OF-DLM))            02592521
025926                     SET PS-DATA-INSTREAM-DD TO TRUE              02592621
025927                     MOVE PV-UJ-DATA-DLM-W-O-QUOTES TO PV-DATA-DLM02592722
025928                 WHEN OTHER                                       02592821
025929                     SET PS-DATA-INSTREAM-DD TO TRUE              02592921
025930                     SET PV-DEFAULT-DLM TO TRUE                   02593023
025931                     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '       02593121
025932                               'INSTREAM DATA DELIMITER IN '      02593221
025933                               'JOB '  PV-IEBPTPCH-JOBNAME        02593321
025934                               'COULD NOT BE PARSED.  DLM='       02593421
025935                               PV-UJ-DATA-DLM-AREA                02593521
025936             END-EVALUATE                                         02593621
025937* INSTREAM, WITH OTHER DD PARMS SPECIFIED                         02593721
025938         WHEN (PV-UJ-PARMS(1:1) = PC-STANDARD-INSTREAM-DD-CHAR)   02593821
025940             SET PS-INSTREAM-DD TO TRUE                           02594014
026000     END-EVALUATE.                                                02600012
026100*1100-EXIT.                                                       02610007
026200                                                                  02620000
026300 8000-BUILD-JOBNAME-PROCNAME.                                     02630000
026400                                                                  02640000
026500     MOVE PV-IEBPTPCH-JOBNAME               TO JP-JOBNAME.        02650009
026600     MOVE TP-PROCNAME-ENTRY (TP-PROC-INDEX) TO JP-PROCNAME.       02660003
026700                                                                  02670000
026800     PERFORM 9200-WRITE-JOBNAME-PROCNAME.                         02680001
026900*8000-EXIT.                                                       02690001
027000                                                                  02700000
027100 9100-READ-JOBLIB-IEBPTPCH-FILE.                                  02710000
027200                                                                  02720000
027300     READ JOBLIB-IEBPTPCH-FILE                                    02730003
027400         INTO JI-JOBLIB-IEBPTPCH-RECORD                           02740003
027500         AT END                                                   02750000
027600             SET EOF-JOBLIB TO TRUE                               02760003
027700     END-READ.                                                    02770003
027800*9100-EXIT.                                                       02780001
027900                                                                  02790000
028000 9200-WRITE-JOBNAME-PROCNAME.                                     02800000
028100                                                                  02810000
028200     WRITE JOBNAME-PROCNAME-RECORD                                02820003
028300         FROM JP-JOBNAME-PROCNAME-RECORD.                         02830003
028400*9200-EXIT.                                                       02840001
