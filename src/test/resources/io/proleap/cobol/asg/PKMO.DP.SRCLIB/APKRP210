000100 IDENTIFICATION DIVISION.                                         00020001
000200                                                                          
000300 PROGRAM-ID.     APKRP210.                                        00030001
000400                                                                          
000500 AUTHOR.         W A EHMKE - KOHLS.                                       
000600                                                                          
000700 DATE-WRITTEN.   05/04/2000.                                      00050001
000800                                                                          
000900 DATE-COMPILED.                                                   00060001
001000*************************************************************     00070001
001100*    COBOL 2 BATCH                                          *     00080001
001200*       --- IMPORT READY TO JOURNALIZE SUMMARY REPORTS ---  *     00090001
001300*                                                           *     00100001
001400*    THIS PROGRAM INPUTS THE PO COST VARIANCE FILE.         *     00110001
001500*    1 DETAIL LINE FOR EACH VENDOR WILL BE GENERATED.  TOTALS     00120001
001600*    WILL BE ACCUMULATED FOR PO-COST-AMT, RCV-COST-AMT,     *     00130001
001700*    INV-COST-AMT, AND EST-COST-AMT.  A FINAL TOTAL LINE    *     00140001
001800*    WILL BE GENERATED FOR NON-LI & FUNG VENDORS AND 1 LINE *     00150001
001900*    FOR ALL VENDORS.                                       *     00160001
002000*                                                           *     00160001
002100*                                                           *     00160001
002200* INPUT:                                                    *     00170001
002300*  1. PKMO.AP.APRD036.POCOST.VARIANCE(+0)                   *     00180001
002400*     LI & FUNG - NON-LI & FUNG RECORDS                     *     00200001
002500*                                                           *     00200001
002600* OUTPUT:                                                   *     00210001
002700*  1. IMPORT PO COST VARIANCE REPORT                        *     00220001
002800*                                                           *     00230001
002900*************************************************************     00240001
003000                                                                  00250001
003100*---------------------------------------------------------------* 00260001
003200*                                                               * 00270001
003300*  08/08/2002 COLBY HANGER EXPENSE PROCESSING.  RECOMPILE FROM  *         
003400*             PRODUCTION TO INCORPORATE COPYBOOK CHANGES.       *         
003500*         BY: KEVIN CATLIN                   WR#: 23254         *         
003600*                                                               * 00270001
003700*  DATE  01/26/2005                                             *         
003800*      CHANGE MADE: REMOVED THE 88 LEVEL FROM PV-VENDOR-NAME-   *         
003900*             HOLD FIELD.  ALSO CHANGED TL1-MESSAGE TO USE      *         
004000*             LI & FUNG INSTEAD OF COLBY.  ADDED PV-HOLD-VENDOR-*         
004100*             NBR FIELD AND AN 88 LEVEL USING THE LI & FUNG     *         
004200*             NUMBER ISTEAD OF THE PREVIOUSLY USED 88 LEVEL     *         
004300*             VENDOR NAME REFERRING TO COLBY.                   *         
004400*      MADE BY: MIKE BESKE              WR/IR #: WR28114        *         
004450*                                                               *         
004460*   DATE  03/16/2009                                            *         
004470*     CHANGE MADE: RECOMPILE FOR ADDITION OF DMA-NBR TO         *         
004480*     APRD036.                                                  *         
004490*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR31546         *         
004500*---------------------------------------------------------------* 00310001
004600                                                                  00320001
004700     EJECT                                                        00320001
004800                                                                  00330001
004900 ENVIRONMENT DIVISION.                                            00340001
005000                                                                  00330001
005100 CONFIGURATION SECTION.                                           00350001
005200                                                                  00330001
005300 SOURCE-COMPUTER.    IBM-3090.                                    00360001
005400 OBJECT-COMPUTER.    IBM-3090.                                    00370001
005500                                                                  00380001
005600 INPUT-OUTPUT SECTION.                                            00390001
005700                                                                  00380001
005800 FILE-CONTROL.                                                    00400001
005900                                                                  00380001
006000     SELECT PO-COST-VARIANCE-FILE  ASSIGN TO UT-S-INP01.                  
006100                                                                          
006200     SELECT VENDOR-VARIANCE-REPORT ASSIGN TO UT-S-RPT01.                  
006300                                                                  00430001
006400     EJECT                                                        00430001
006500                                                                  00430001
006600 DATA DIVISION.                                                   00440001
006700                                                                  00430001
006800 FILE SECTION.                                                    00450001
006900                                                                  00460001
007000 FD  PO-COST-VARIANCE-FILE                                        00470001
007100     RECORDING MODE IS F                                          00480001
007200     LABEL RECORDS ARE STANDARD                                   00490001
007300     RECORD CONTAINS 170 CHARACTERS                               00500001
007400     BLOCK CONTAINS 0 RECORDS                                     00500001
007500     DATA RECORD IS PO-COST-VARIANCE-RECORD.                      00510001
007600                                                                  00460001
007700 01  PO-COST-VARIANCE-RECORD          PIC  X(170).                00520001
007800                                                                  00530001
007900                                                                  00530001
008000 FD  VENDOR-VARIANCE-REPORT                                       00540001
008100     RECORDING MODE IS F                                          00550001
008200     LABEL RECORDS ARE STANDARD                                   00560001
008300     RECORD CONTAINS 132 CHARACTERS                               00500001
008400     BLOCK CONTAINS 0 RECORDS                                     00570001
008500     DATA RECORD IS EXCEPTION-RPT-REC.                            00580001
008600                                                                  00530001
008700 01  VENDOR-VARIANCE-LINE             PIC  X(132).                00590001
008800                                                                  00530001
008900 EJECT                                                            00600001
009000                                                                  00610001
009100 WORKING-STORAGE SECTION.                                         00620001
009200                                                                  00630001
009300 01  PV-PROGRAM-VARIABLES.                                        00640001
009400     05  FILLER                      PIC  X(30)  VALUE            00650001
009500         '** BEGINING OF APKRP210 W/S **'.                        00660001
009600     05  PV-CURRENT-PARAGRAPH        PIC  X(35).                  00670001
009700     05  PV-PROGRAM-NAME             PIC  X(08)  VALUE 'APKRP210'.00680001
009800     05  PV-VENDOR-PO-NUMB-HOLD      PIC X(09)  VALUE SPACES.             
009900     05  PV-VENDOR-NAME-HOLD         PIC  X(30)  VALUE SPACES.            
010000     05  PV-VENDOR-NUMBER-HOLD.                                           
010100         10  PV-VENDOR-NUMBER        PIC  X(09)  VALUE SPACES.            
010200             88  PV-VENDOR-NBR-LIFUNG       VALUE '009206194'.            
010300                                                                          
010400                                                                          
010500     05  PV-DATE-TIME-FIELDS.                                             
010600                                                                          
010700         10  PV-CURRENT-DATE.                                     00710001
010800             15  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.     00720001
010900             15  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.     00730001
011000             15  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.     00740001
011100                                                                          
011200         10  PV-CURRENT-TIME.                                     00750001
011300             15  PV-CURRENT-HOURS    PIC  9(02)  VALUE ZEROS.     00760001
011400             15  PV-CURRENT-MIN      PIC  9(02)  VALUE ZEROS.     00770001
011500             15  PV-CURRENT-SEC      PIC  9(02)  VALUE ZEROS.     00780001
011600             15  PV-CURRENT-HUN      PIC  9(02)  VALUE ZEROS.     00790001
011700                                                                  00800001
011800     05  PV-COUNTERS.                                             00810001
011900         10  PV-LINE-COUNT           PIC S9(03)  VALUE +61        00820001
012000                                                 COMP-3.          00830001
012100         10  PV-PAGE-COUNT           PIC S9(05)  VALUE ZEROS      00840001
012200                                                 COMP-3.          00850001
012300                                                                          
012400     05  PV-ALL-TOT-TOTALS.                                               
012500                                                                          
012600         10  PV-AL-PO-COST-AMT-TOTAL    PIC S9(13)V99 VALUE ZERO          
012700                                                   COMP-3.                
012800         10  PV-AL-EST-COST-AMT-TOTAL   PIC S9(13)V99 VALUE ZERO          
012900                                                   COMP-3.                
013000         10  PV-AL-RCV-COST-AMT-TOTAL   PIC S9(13)V99 VALUE ZERO          
013100                                                   COMP-3.                
013200         10  PV-AL-INV-COST-AMT-TOTAL   PIC S9(13)V99 VALUE ZERO          
013300                                                   COMP-3.                
013400         10  PV-AL-PO-TOTAL         PIC  9(5)    VALUE ZERO               
013500                                                   COMP-3.                
013600                                                                          
013700     EJECT                                                                
013800                                                                          
013900     05  PV-NON-COLBY-TOT-TOTALS.                                         
014000                                                                          
014100         10  PV-NC-PO-COST-AMT-TOTAL    PIC S9(13)V99 VALUE ZERO          
014200                                                   COMP-3.                
014300         10  PV-NC-EST-COST-AMT-TOTAL   PIC S9(13)V99 VALUE ZERO          
014400                                                   COMP-3.                
014500         10  PV-NC-RCV-COST-AMT-TOTAL   PIC S9(13)V99 VALUE ZERO          
014600                                                   COMP-3.                
014700         10  PV-NC-INV-COST-AMT-TOTAL   PIC S9(13)V99 VALUE ZERO          
014800                                                   COMP-3.                
014900         10  PV-NC-PO-TOTAL             PIC  9(5)    VALUE ZERO           
015000                                                   COMP-3.                
015100                                                                          
015200     EJECT                                                                
015300                                                                          
015400     05  PV-DETAIL-TOTALS.                                                
015500                                                                          
015600         10  PV-PO-COST-AMT-DETAIL   PIC S9(11)V99 VALUE ZERO     00870001
015700                                                   COMP-3.        00880001
015800         10  PV-EST-COST-AMT-DETAIL  PIC S9(11)V99 VALUE ZERO             
015900                                                   COMP-3.        00940001
016000         10  PV-RCV-COST-AMT-DETAIL  PIC S9(11)V99 VALUE ZERO     00890001
016100                                                   COMP-3.        00900001
016200         10  PV-INV-COST-AMT-DETAIL  PIC S9(11)V99 VALUE ZERO     00910001
016300                                                   COMP-3.        00920001
016400         10  PV-PO-DTL-CNT-DETAIL    PIC  9(5)    VALUE ZERO      00950001
016500                                                   COMP-3.        00960001
016600                                                                          
016700 01  PC-PROGRAM-CONSTANTS.                                        01000001
016800     05  PC-MAX-LINES            PIC S9(03)  VALUE +60            01010001
016900                                             COMP-3.              01020001
017000     05  PC-END-LINES            PIC S9(03)  VALUE +44            01010001
017100                                             COMP-3.              01020001
017200                                                                  01030001
017300 01  PS-PROGRAM-SWITCHES.                                         01040001
017400     05  PS-EOF-IN-FILE          PIC  X(01)  VALUE ' '.           01050001
017500         88  PS-EOF-IN-FILE-YES              VALUE 'Y'.           01060001
017600         88  PS-EOF-IN-FILE-NO               VALUE 'N'.           01070001
017700                                                                  01080001
017800     05  PS-FIRST-READ           PIC  X(01)  VALUE ' '.           01050001
017900         88  PS-FIRST-READ-YES               VALUE 'Y'.           01060001
018000         88  PS-FIRST-READ-NO                VALUE 'N'.           01070001
018100                                                                  01080001
018200     EJECT                                                        01080001
018300                                                                  01310001
018400*----------------------------------------------------------------*01340001
018500*  INPUT RECORD LAYOUT                                           *01350001
018600*----------------------------------------------------------------*01360001
018700                                                                  01310001
018800     COPY APRD036.                                                01370001
018900                                                                  01380001
019000                                                                  01390001
019100 EJECT                                                            01330001
019200                                                                  01390001
019300*----------------------------------------------------------------*01340001
019400*  STANDARD HEADER LAYOUT                                        *01350001
019500*----------------------------------------------------------------*01360001
019600                                                                  01390001
019700     COPY DPWS132O.                                               01370001
019800                                                                  01380001
019900                                                                  01390001
020000 EJECT                                                            01330001
020100                                                                  01390001
020200 01  H2-HEADER.                                                   01400001
020300     05  FILLER                  PIC  X(45) VALUE SPACES.         01410001
020400     05  FILLER                  PIC  X(41) VALUE                 01420001
020500             'IMPORT READY TO JOURNALIZE SUMMARY REPORT'.                 
020600     05  FILLER                  PIC  X(46) VALUE SPACES.         01410001
020700                                                                  01440001
020800 01  H3-HEADER.                                                   01400001
020900     05  FILLER                  PIC  X(06) VALUE 'VENDOR'.       01410001
021000     05  FILLER                  PIC  X(29) VALUE SPACES.         01420001
021100     05  FILLER                  PIC  X(04) VALUE 'P.O.'.         01410001
021200     05  FILLER                  PIC  X(93) VALUE SPACES.         01420001
021300                                                                  01440001
021400 01  H4-HEADER.                                                   01400001
021500     05  FILLER                  PIC  X(04) VALUE 'NAME'.         01410001
021600     05  FILLER                  PIC  X(31) VALUE SPACES.         01420001
021700     05  FILLER                  PIC  X(05) VALUE 'COUNT'.        01410001
021800     05  FILLER                  PIC  X(12) VALUE SPACES.         01420001
021900     05  FILLER                  PIC  X(11) VALUE                         
022000             'PO COST AMT'.                                               
022100     05  FILLER                  PIC  X(11) VALUE SPACES.         01420001
022200     05  FILLER                  PIC  X(12) VALUE                         
022300             'EST COST AMT'.                                              
022400     05  FILLER                  PIC  X(11) VALUE SPACES.         01420001
022500     05  FILLER                  PIC  X(12) VALUE                         
022600             'RCV COST AMT'.                                              
022700     05  FILLER                  PIC  X(11) VALUE SPACES.         01420001
022800     05  FILLER                  PIC  X(12) VALUE                         
022900             'INV COST AMT'.                                              
023000                                                                  01390001
023100 EJECT                                                            01330001
023200                                                                  01390001
023300 01  DETAIL-LINE.                                                 01630001
023400     05  DL-VEND-NAME            PIC  X(30)  VALUE SPACES.        01650001
023500     05  FILLER                  PIC  X(05)  VALUE SPACES.        01660001
023600     05  DL-VEND-PO-CNT          PIC  ZZ,ZZ9 VALUE ZEROES.        01670001
023700     05  FILLER                  PIC  X(05)  VALUE SPACES.        01680001
023800     05  DL-PO-COST-AMT          PIC  ZZ,ZZZ,ZZZ,ZZ9.99           01670001
023900                                             VALUE ZEROES.        01680001
024000     05  FILLER                  PIC  X(06)  VALUE SPACES.        01680001
024100     05  DL-PO-EST-COST-AMT      PIC  ZZ,ZZZ,ZZZ,ZZ9.99           01670001
024200                                             VALUE ZEROES.        01680001
024300     05  FILLER                  PIC  X(06)  VALUE SPACES.        01680001
024400     05  DL-PO-RCV-COST-AMT      PIC  ZZ,ZZZ,ZZZ,ZZ9.99           01670001
024500                                             VALUE ZEROES.        01680001
024600     05  FILLER                  PIC  X(06)  VALUE SPACES.        01680001
024700     05  DL-PO-INV-COST-AMT      PIC  ZZ,ZZZ,ZZZ,ZZ9.99           01670001
024800                                             VALUE ZEROES.        01680001
024900                                                                  01720001
025000     EJECT                                                        01720001
025100                                                                  01720001
025200 01  TOTAL-LINE1.                                                 01730001
025300     05  TL1-MESSAGE             PIC  X(30)  VALUE                        
025400           'NON - LI & FUNG              ='.                              
025500     05  FILLER                  PIC  X(02)  VALUE SPACE.         01750001
025600     05  TL1-NC-PO-CNT           PIC  Z,ZZZ,ZZ9.                          
025700     05  FILLER                  PIC  X(02)  VALUE SPACE.         01750001
025800     05  TL1-NC-PO-COST-AMT      PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
025900     05  FILLER                  PIC  X(03)  VALUE SPACE.         01750001
026000     05  TL1-NC-EST-COST-AMT     PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
026100     05  FILLER                  PIC  X(03)  VALUE SPACE.         01750001
026200     05  TL1-NC-RCV-COST-AMT     PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
026300     05  FILLER                  PIC  X(03)  VALUE SPACE.         01750001
026400     05  TL1-NC-INV-COST-AMT     PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
026500                                                                  01780001
026600                                                                  01720001
026700 01  TOTAL-LINE2.                                                 01730001
026800     05  TL2-MESSAGE             PIC  X(30)  VALUE                        
026900           'ALL - VENDORS                ='.                              
027000     05  FILLER                  PIC  X(02)  VALUE SPACE.         01750001
027100     05  TL2-NC-PO-CNT           PIC  Z,ZZZ,ZZ9.                          
027200     05  FILLER                  PIC  X(02)  VALUE SPACE.         01750001
027300     05  TL2-NC-PO-COST-AMT      PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
027400     05  FILLER                  PIC  X(03)  VALUE SPACE.         01750001
027500     05  TL2-NC-EST-COST-AMT     PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
027600     05  FILLER                  PIC  X(03)  VALUE SPACE.         01750001
027700     05  TL2-NC-RCV-COST-AMT     PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
027800     05  FILLER                  PIC  X(03)  VALUE SPACE.         01750001
027900     05  TL2-NC-INV-COST-AMT     PIC  Z,ZZZ,ZZZ,ZZZ,ZZ9.99.               
028000                                                                  01780001
028100     EJECT                                                        01780001
028200                                                                  01780001
028300                                                                  01780001
028400 01  DASH-LINE.                                                           
028500     05  FILLER                  PIC  X(34)  VALUE SPACES.        01780001
028600     05  FILLER                  PIC  X(07)  VALUE ALL '-'.               
028700     05  FILLER                  PIC  X(05)  VALUE SPACES.        01780001
028800     05  FILLER                  PIC  X(17)  VALUE ALL '-'.               
028900     05  FILLER                  PIC  X(06)  VALUE SPACES.        01780001
029000     05  FILLER                  PIC  X(17)  VALUE ALL '-'.               
029100     05  FILLER                  PIC  X(06)  VALUE SPACES.        01780001
029200     05  FILLER                  PIC  X(17)  VALUE ALL '-'.               
029300     05  FILLER                  PIC  X(06)  VALUE SPACES.        01780001
029400     05  FILLER                  PIC  X(17)  VALUE ALL '-'.               
029500                                                                  01780001
029600                                                                  01780001
029700 01  EOR-LINE.                                                            
029800     05  FILLER                  PIC  X(54)  VALUE SPACES.        01800001
029900     05  FILLER                  PIC  X(25)  VALUE                01810001
030000           'E N D   O F   R E P O R T'.                                   
030100     05  FILLER                  PIC  X(53)  VALUE SPACES.        01800001
030200                                                                  01840001
030300     EJECT                                                        01720001
030400                                                                  01720001
030500*----------------------------------------------------------------*02030001
030600*  ABEND DATA AREAS                                              *02040001
030700*----------------------------------------------------------------*02050001
030800                                                                  01720001
030900 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          02060001
031000                                             COMP SYNC.           02070001
031100     88  AC-NO-INPUT-ERR                     VALUE +2750.         02080001
031200                                                                  02090001
031300                                                                  02100001
031400 01  ABEND-AREAS.                                                 02110001
031500     05  AA-ABEND-LIT            PIC  X(40)  VALUE                02120001
031600             '*****       ABEND'.                                 02130001
031700     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                02140001
031800             '*****   PROGRAM: APKRP275'.                         02150001
031900     05  AA-PARAGRAPH-LIT.                                        02160001
032000         10  FILLER              PIC  X(17)  VALUE                02170001
032100             '***** PARAGRAPH: '.                                 02180001
032200         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        02190001
032300     05  AA-MESSAGE-LINE.                                         02200001
032400         10  FILLER              PIC  X(06)  VALUE '*****'.       02210001
032500         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        02220001
032600                                                                  02100001
032700 EJECT                                                            02230001
032800                                                                  02100001
032900 PROCEDURE DIVISION.                                              02240001
033000                                                                  02100001
033100 A100-MAIN.                                                       02250001
033200                                                                  02260001
033300     MOVE 'A100-MAIN' TO PV-CURRENT-PARAGRAPH.                    02270001
033400                                                                  02280001
033500     PERFORM B100-INITIALIZE.                                     02290001
033600                                                                  02300001
033700     PERFORM R100-READ-VARIANCE-FILE.                                     
033800                                                                  02300001
033900     IF PS-EOF-IN-FILE-YES                                        02320001
034000         MOVE 'EMPTY INPUT FILE' TO AA-MESSAGE                    02330001
034100         SET AC-NO-INPUT-ERR         TO TRUE                      02340001
034200         PERFORM Z999-ABEND                                       02350001
034300     END-IF.                                                      02360001
034400                                                                  02370001
034500     PERFORM B200-PROCESS-VENDOR-COUNTS                           02380001
034600         UNTIL PS-EOF-IN-FILE-YES.                                02390001
034700                                                                  02400001
034800     PERFORM C200-PROCESS-DETAIL-LINE.                                    
034900                                                                  02400001
035000     PERFORM W100-WRITE-DETAIL-LINE.                                      
035100                                                                  02400001
035200     PERFORM W200-WRITE-TOTAL-LINES.                                      
035300                                                                  02420001
035400     CLOSE PO-COST-VARIANCE-FILE                                  02430001
035500           VENDOR-VARIANCE-REPORT.                                02440001
035600                                                                  02450001
035700     GOBACK.                                                      02460001
035800                                                                  02450001
035900                                                                  02450001
036000 EJECT                                                            02470001
036100                                                                  02450001
036200*----------------------------------------------------------------*02480001
036300*    INITIALIZATION PROCESSING                                   *02490001
036400*    CALLED FROM A100-MAIN                                       *02500001
036500*----------------------------------------------------------------*02510001
036600                                                                  02450001
036700 B100-INITIALIZE.                                                 02520001
036800                                                                  02530001
036900     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              02540001
037000                                                                  02550001
037100     OPEN INPUT  PO-COST-VARIANCE-FILE.                           02560001
037200     OPEN OUTPUT VENDOR-VARIANCE-REPORT.                                  
037300                                                                  02580001
037400     MOVE PV-PROGRAM-NAME   TO DP132O-PROGRAM-NAME.               02590001
037500                                                                  02600001
037600     ACCEPT PV-CURRENT-TIME FROM TIME.                            02610001
037700                                                                  02600001
037800     MOVE PV-CURRENT-HOURS  TO DP132O-RUN-HOUR.                   02620001
037900     MOVE PV-CURRENT-MIN    TO DP132O-RUN-MINUTE.                 02630001
038000                                                                  02640001
038100     ACCEPT PV-CURRENT-DATE FROM DATE.                            02650001
038200                                                                  02640001
038300     MOVE PV-CURRENT-YEAR   TO DP132O-RUN-YEAR.                   02660001
038400     MOVE PV-CURRENT-MONTH  TO DP132O-RUN-MONTH.                  02670001
038500     MOVE PV-CURRENT-DAY    TO DP132O-RUN-DAY.                    02680001
038600                                                                  02690001
038700     INITIALIZE PV-ALL-TOT-TOTALS                                 02690001
038800                PV-NON-COLBY-TOT-TOTALS                                   
038900                PV-DETAIL-TOTALS.                                 02690001
039000                                                                  02690001
039100     SET PS-EOF-IN-FILE-NO  TO TRUE.                                      
039200     SET PS-FIRST-READ-YES  TO TRUE.                                      
039300                                                                  02690001
039400     PERFORM X100-PRINT-HEADERS.                                  02700001
039500                                                                  02690001
039600 EJECT                                                            02710001
039700                                                                  02690001
039800*----------------------------------------------------------------*02720001
039900*    PROCESS THE SORTED EXTRACTED VENDOR FILE. COUNT THE PO. AND *02730001
040000*    TOTAL THE VALUES.                                           *02740001
040100*                                                                         
040200*----------------------------------------------------------------*02760001
040300                                                                  02690001
040400 B200-PROCESS-VENDOR-COUNTS.                                              
040500                                                                  02780001
040600     MOVE 'B200-PROCESS-VENDOR-COUNTS  ' TO PV-CURRENT-PARAGRAPH. 02790001
040700                                                                  02800001
040800     IF PS-FIRST-READ-YES                                                 
040900         SET PS-FIRST-READ-NO   TO TRUE                                   
041000         MOVE AP036-VENDOR-NAME      TO PV-VENDOR-NAME-HOLD               
041100         MOVE AP036-HDR-VENDOR-NBR   TO PV-VENDOR-NUMBER-HOLD             
041200         MOVE AP036-PO-NBR           TO PV-VENDOR-PO-NUMB-HOLD            
041300         PERFORM C100-COMPUTE-VENDOR-TOTALS                               
041400     END-IF.                                                              
041500                                                                          
041600     IF (AP036-VENDOR-NAME = PV-VENDOR-NAME-HOLD) AND                     
041700        (AP036-PO-NBR      = PV-VENDOR-PO-NUMB-HOLD)                      
041800         CONTINUE                                                         
041900     ELSE                                                                 
042000         IF AP036-VENDOR-NAME = PV-VENDOR-NAME-HOLD                       
042100             IF AP036-PO-NBR NOT = PV-VENDOR-PO-NUMB-HOLD                 
042200                 PERFORM C100-COMPUTE-VENDOR-TOTALS                       
042300                 MOVE AP036-PO-NBR TO PV-VENDOR-PO-NUMB-HOLD              
042400             END-IF                                                       
042500         ELSE                                                             
042600             PERFORM C200-PROCESS-DETAIL-LINE                             
042700             PERFORM W100-WRITE-DETAIL-LINE                               
042800             INITIALIZE PV-DETAIL-TOTALS                                  
042900             MOVE AP036-VENDOR-NAME      TO PV-VENDOR-NAME-HOLD           
043000             MOVE AP036-HDR-VENDOR-NBR   TO PV-VENDOR-NUMBER-HOLD         
043100             MOVE AP036-PO-NBR           TO PV-VENDOR-PO-NUMB-HOLD        
043200             PERFORM C100-COMPUTE-VENDOR-TOTALS                           
043300         END-IF                                                           
043400     END-IF                                                               
043500                                                                  02840001
043600     PERFORM R100-READ-VARIANCE-FILE.                                     
043700                                                                  02690001
043800 EJECT                                                            02860001
043900                                                                  02870001
044000*-----------------------------------------------------------------02880001
044100* CALCULATE THE PO CNTS, AMT CNTS FOR DETAIL AND TOTALS           02890001
044200* WITH LI & FUNG CHECK.                                                   
044300*-----------------------------------------------------------------02900001
044400                                                                  02870001
044500 C100-COMPUTE-VENDOR-TOTALS.                                              
044600                                                                  02870001
044700                                                                  03170001
044800     MOVE 'C100-COMPUTE-VENDOR-TOT' TO PV-CURRENT-PARAGRAPH.              
044900                                                                          
045000     ADD 1 TO PV-PO-DTL-CNT-DETAIL                                        
045100              PV-AL-PO-TOTAL.                                             
045200                                                                  03120001
045300     IF NOT PV-VENDOR-NBR-LIFUNG                                          
045400         ADD 1 TO PV-NC-PO-TOTAL                                          
045500     END-IF.                                                      03120001
045600                                                                  03120001
045700     ADD AP036-PO-COST-AMT   TO PV-PO-COST-AMT-DETAIL                     
045800                                PV-AL-PO-COST-AMT-TOTAL.                  
045900                                                                          
046000     ADD AP036-EST-COST-AMT  TO PV-EST-COST-AMT-DETAIL                    
046100                                PV-AL-EST-COST-AMT-TOTAL.                 
046200                                                                          
046300     ADD AP036-RCV-COST-AMT  TO PV-RCV-COST-AMT-DETAIL                    
046400                                PV-AL-RCV-COST-AMT-TOTAL.                 
046500                                                                          
046600     ADD AP036-INV-COST-AMT  TO PV-INV-COST-AMT-DETAIL                    
046700                                PV-AL-INV-COST-AMT-TOTAL.                 
046800                                                                          
046900     IF NOT PV-VENDOR-NBR-LIFUNG                                          
047000         ADD AP036-PO-COST-AMT   TO                                       
047100                                PV-NC-PO-COST-AMT-TOTAL                   
047200                                                                          
047300         ADD AP036-EST-COST-AMT  TO                                       
047400                                 PV-NC-EST-COST-AMT-TOTAL                 
047500                                                                          
047600         ADD AP036-RCV-COST-AMT  TO                                       
047700                                 PV-NC-RCV-COST-AMT-TOTAL                 
047800                                                                          
047900         ADD AP036-INV-COST-AMT  TO                                       
048000                                 PV-NC-INV-COST-AMT-TOTAL                 
048100     END-IF.                                                              
048200                                                                          
048300     EJECT                                                                
048400                                                                          
048500                                                                          
048600*----------------------------------------------------------------*03130001
048700*    LOAD THE DETAIL LINE PRIOR TO PRINTING.                              
048800*----------------------------------------------------------------*03150001
048900                                                                          
049000 C200-PROCESS-DETAIL-LINE.                                                
049100                                                                          
049200                                                                  03170001
049300     MOVE 'C200-PROCESS-DETAIL-LIN' TO PV-CURRENT-PARAGRAPH.              
049400                                                                          
049500     MOVE PV-VENDOR-NAME-HOLD  TO DL-VEND-NAME.                           
049600                                                                          
049700     MOVE PV-PO-DTL-CNT-DETAIL TO DL-VEND-PO-CNT.                         
049800                                                                          
049900     MOVE PV-PO-COST-AMT-DETAIL TO DL-PO-COST-AMT.                        
050000                                                                          
050100     MOVE PV-EST-COST-AMT-DETAIL TO DL-PO-EST-COST-AMT.                   
050200                                                                          
050300     MOVE PV-RCV-COST-AMT-DETAIL TO DL-PO-RCV-COST-AMT.                   
050400                                                                          
050500     MOVE PV-INV-COST-AMT-DETAIL TO DL-PO-INV-COST-AMT.                   
050600                                                                          
050700     EJECT                                                                
050800                                                                          
050900*----------------------------------------------------------------*03130001
051000*    READS THE SORTED EXTRACTED VARIANCE FILE.                            
051100*----------------------------------------------------------------*03150001
051200                                                                  03120001
051300 R100-READ-VARIANCE-FILE.                                                 
051400                                                                          
051500                                                                  03170001
051600     MOVE 'R100-READ-VARIANCE-FILE' TO PV-CURRENT-PARAGRAPH.              
051700                                                                  03190001
051800     READ PO-COST-VARIANCE-FILE INTO                                      
051900              AP036-IMPORT-REPORT-RECORD                                  
052000                  AT END                                                  
052100                        SET PS-EOF-IN-FILE-YES TO TRUE                    
052200     END-READ.                                                            
052300                                                                  03190001
052400                                                                  03190001
052500     EJECT                                                        03190001
052600                                                                  03190001
052700***************************************************************** 03230001
052800*                                                                         
052900* W100-WRITE-DETAIL-LINE                                                  
053000*                                                                         
053100***************************************************************** 03260001
053200                                                                  03270001
053300 W100-WRITE-DETAIL-LINE.                                                  
053400                                                                  03290001
053500     MOVE 'W100-WRITE-DETAIL-LINE          '  TO                          
053600                                         PV-CURRENT-PARAGRAPH.            
053700                                                                  03310001
053800     IF PV-LINE-COUNT > PC-MAX-LINES                              03320001
053900         PERFORM X100-PRINT-HEADERS                                       
054000     END-IF.                                                      03340001
054100                                                                  03350001
054200       WRITE VENDOR-VARIANCE-LINE                                         
054300             FROM DETAIL-LINE                                             
054400                 AFTER 2                                                  
054500       END-WRITE.                                                 03490001
054600                                                                  03490001
054700       ADD +2 TO PV-LINE-COUNT.                                           
054800                                                                  03510001
054900                                                                          
055000 EJECT                                                            03530001
055100                                                                          
055200*----------------------------------------------------------------*03540001
055300*    PRINTS THE TOTAL REPORT LINES                                        
055400*----------------------------------------------------------------*03560001
055500                                                                          
055600 W200-WRITE-TOTAL-LINES.                                                  
055700                                                                  03580001
055800     MOVE 'W200-WRITE-TOTAL-LINES             '  TO                       
055900                                            PV-CURRENT-PARAGRAPH. 03590001
056000                                                                  03600001
056100     IF PV-LINE-COUNT > PC-END-LINES                              03610001
056200         PERFORM X100-PRINT-HEADERS                                       
056300     END-IF.                                                      03630001
056400                                                                          
056500       WRITE VENDOR-VARIANCE-LINE                                         
056600             FROM DASH-LINE                                               
056700                  AFTER 3.                                                
056800                                                                          
056900       ADD +3 TO PV-LINE-COUNT.                                           
057000                                                                          
057100       MOVE PV-NC-PO-TOTAL            TO  TL1-NC-PO-CNT.                  
057200                                                                          
057300       MOVE PV-NC-PO-COST-AMT-TOTAL   TO  TL1-NC-PO-COST-AMT.             
057400       MOVE PV-NC-EST-COST-AMT-TOTAL  TO  TL1-NC-EST-COST-AMT.            
057500       MOVE PV-NC-RCV-COST-AMT-TOTAL  TO  TL1-NC-RCV-COST-AMT.            
057600       MOVE PV-NC-INV-COST-AMT-TOTAL  TO  TL1-NC-INV-COST-AMT.            
057700                                                                          
057800       WRITE VENDOR-VARIANCE-LINE                                         
057900             FROM TOTAL-LINE1                                             
058000                  AFTER 1.                                                
058100                                                                          
058200       ADD +1 TO PV-LINE-COUNT.                                           
058300                                                                          
058400       MOVE PV-AL-PO-TOTAL            TO  TL2-NC-PO-CNT.                  
058500                                                                          
058600       MOVE PV-AL-PO-COST-AMT-TOTAL   TO  TL2-NC-PO-COST-AMT.             
058700       MOVE PV-AL-EST-COST-AMT-TOTAL  TO  TL2-NC-EST-COST-AMT.            
058800       MOVE PV-AL-RCV-COST-AMT-TOTAL  TO  TL2-NC-RCV-COST-AMT.            
058900       MOVE PV-AL-INV-COST-AMT-TOTAL  TO  TL2-NC-INV-COST-AMT.            
059000                                                                          
059100       WRITE VENDOR-VARIANCE-LINE                                         
059200             FROM TOTAL-LINE2                                             
059300                  AFTER 3.                                                
059400                                                                          
059500       ADD +3 TO PV-LINE-COUNT.                                           
059600                                                                          
059700                                                                          
059800       WRITE VENDOR-VARIANCE-LINE                                         
059900             FROM EOR-LINE                                                
060000                  AFTER 6.                                                
060100                                                                          
060200       ADD +6 TO PV-LINE-COUNT.                                           
060300                                                                          
060400     DISPLAY ' '.                                                         
060500     DISPLAY '*************************************************'.         
060600     DISPLAY '*'.                                                         
060700     DISPLAY 'PV-LINE-COUNT   = '   PV-LINE-COUNT.                        
060800     DISPLAY '*'.                                                         
060900     DISPLAY '*************************************************'.         
061000                                                                          
061100                                                                          
061200 EJECT                                                                    
061300                                                                  03980001
061400*----------------------------------------------------------------*03780001
061500*    PRINTS HEADERS FOR THE IMPORT READY TO JOURNALIZE           *03790001
061600*           SUMMARY REPORT                                                
061700*----------------------------------------------------------------*03820001
061800                                                                  03770001
061900 X100-PRINT-HEADERS.                                                      
062000                                                                  03840001
062100     MOVE 'X100-PRINT-HEADERS                 ' TO                        
062200                                  PV-CURRENT-PARAGRAPH.           03850001
062300                                                                  03860001
062400     ADD 1              TO PV-PAGE-COUNT.                         03870001
062500                                                                  03840001
062600     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    03880001
062700                                                                  03840001
062800     MOVE 1             TO DP132O-REPORT-NUMBER.                  03890001
062900                                                                  03900001
063000     WRITE VENDOR-VARIANCE-LINE                                   03910001
063100           FROM DP132O-STANDRD-HEADER-132-COLS                            
063200                AFTER PAGE.                                               
063300                                                                  03900001
063400     MOVE 1                           TO PV-LINE-COUNT.           03990001
063500                                                                  03900001
063600     WRITE VENDOR-VARIANCE-LINE                                           
063700           FROM H2-HEADER                                                 
063800                AFTER 2.                                                  
063900                                                                  03940001
064000     ADD 2                            TO PV-LINE-COUNT.           03990001
064100                                                                  03900001
064200     WRITE VENDOR-VARIANCE-LINE                                           
064300           FROM H3-HEADER                                                 
064400                AFTER 2.                                                  
064500                                                                  03940001
064600     ADD 2                            TO PV-LINE-COUNT.           03990001
064700                                                                  03900001
064800     WRITE VENDOR-VARIANCE-LINE                                           
064900           FROM H4-HEADER                                                 
065000                AFTER 1.                                                  
065100                                                                  03940001
065200     ADD 1                            TO PV-LINE-COUNT.           03990001
065300                                                                  03900001
065400     INITIALIZE VENDOR-VARIANCE-LINE.                             03960001
065500                                                                  03940001
065600     WRITE VENDOR-VARIANCE-LINE AFTER 1.                          03970001
065700                                                                  03980001
065800     ADD 1                            TO PV-LINE-COUNT.           03990001
065900                                                                  03980001
066000  EJECT                                                           04280001
066100                                                                  03980001
066200*----------------------------------------------------------------*04290001
066300*    ABEND ROUTINE                                               *04300001
066400*----------------------------------------------------------------*04310001
066500                                                                  03980001
066600 Z999-ABEND.                                                      04320001
066700                                                                  04330001
066800     DISPLAY AA-ABEND-LIT.                                        04340001
066900     DISPLAY AA-PROGRAM-LIT.                                      04350001
067000     DISPLAY AA-PARAGRAPH-LIT.                                    04360001
067100     DISPLAY AA-MESSAGE-LINE.                                     04370001
067200                                                                  04330001
067300     CALL 'ILBOABN0' USING ABEND-CODE.                            04380001
067400                                                                          
067500*                                                                         
067600****************************************************************          
